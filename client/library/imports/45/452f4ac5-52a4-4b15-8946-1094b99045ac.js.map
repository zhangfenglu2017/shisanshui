{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "AAAA,IAAM,aAAa,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;AAC/C,IAAM,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;AACjC,EAAE,CAAC,KAAK,CAAC;AACL,eAAS,EAAE,CAAC,SAAS;;AAErB,cAAU,EAAE;AACR,kBAAU,EAAC,EAAE,CAAC,IAAI;AAClB,kBAAU,EAAC,EAAE,CAAC,MAAM;KAkBvB;;;;;;;;;;;;;;;;;;;;AAGD,UAAM,EAAE,kBAAY;;;;;;;;AAQhB,YAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC;AAC7E,YAAI,CAAC,oBAAoB,EAAE,CAAC;KAC/B;;AAED,wBAAoB,EAAE,gCAAY;AAChC,qBAAa,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,CAAC;;KAEzE;;AAED,sBAAkB,EAAC,4BAAS,QAAQ,EAAE;;;;;;;;;AASlC,YAAI,CAAC,iBAAiB,CAAC,iBAAiB,EAAE,CAAC;AAC3C,YAAI,KAAK,GAAG,CAAC,CAAC;AACd,gBAAQ,CAAC,IAAI,CAAC,MAAM,CAAE,UAAU,MAAM,EAAE;AAAC,mBAAO,MAAM,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC;SAAC,CAAC,CAAC,OAAO,CAAC,CAAA,UAAU,UAAU,EAAE;AAC3G,iBAAK,EAAE,CAAC;AACR,gBAAI,IAAI,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AAC3C,gBAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;AACtC,gBAAI,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;AAC3C,gBAAI,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;AACzB,gBAAI,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;AACzD,qBAAS,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,eAAe,GAAG,UAAU,CAAC;;;;;;;SAOzD,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KACjB;;AAED,eAAW,EAAC,uBAAW;AACnB,YAAI,IAAI,CAAC,SAAS,EAAE;AAChB,gBAAI,CAAC,SAAS,GAAG,KAAK,CAAC;AACvB,gBAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAK,CAAC;AAClC,gBAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;SACjC,MACI;AACD,gBAAI,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,aAAa,EAAE,CAAC;SACnD;KACJ;CAoFJ,CAAC,CAAC",
  "file": "unknown",
  "sourcesContent": [
    "const KQGlobalEvent = require('KQGlobalEvent');\r\nconst Socket = require('socket');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        scrollView:cc.Node,\r\n        recordItem:cc.Prefab,\r\n        //subScrollView:cc.Node,\r\n        //subRecordItem:cc.Node,\r\n        //splash:cc.Prefab,\r\n        //reordInfo:cc.Node,\r\n        //\r\n        //jifen:cc.Label,\r\n        //head:cc.Node,\r\n        //id:cc.Label,\r\n        //nickname:cc.Label,\r\n        //creat:cc.Label,        // 创房人\r\n        //createUser:cc.Node,     //  头像\r\n        //\r\n        //timeLabel:cc.Label,   // 时间\r\n        //jushuLabel:cc.Label,  // 局数\r\n        ////createUser:cc.Node,   // 房主\r\n        //roomId:cc.Label,      // 房间号\r\n        //_records:null,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        //this.isSubPage = false;\r\n        //this.subScrollView.active = false;\r\n        //\r\n        //this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;\r\n        //console.log( this.subScrollViewContent );\r\n        //this.recordInfo = this.subScrollViewContent.children[0];\r\n        //this.reords = this.subScrollViewContent.children[0].children[3];\r\n        this.scrollViewContent = this.scrollView.getComponent(cc.ScrollView).content;\r\n        this._registerSocketEvent();\r\n    },\r\n\r\n    _registerSocketEvent: function () {\r\n      KQGlobalEvent.on(Socket.Event.GetRecord, this._ReceiveRecordInfo, this);\r\n      //KQGlobalEvent.on(Socket.Event.GetItemRecord, this._ReceiveRecordItem, this);\r\n    },\r\n\r\n    _ReceiveRecordInfo:function(response) {\r\n        //cc.log(response)\r\n        //cc.log('------78')\r\n        //console.log(response);\r\n        //this._records = response.data;\r\n        //this.isSubPage = false;\r\n        //this.subScrollView.active = false;\r\n        //this.scrollView.active = true;\r\n\r\n        this.scrollViewContent.removeAllChildren();\r\n        var index = 0;\r\n        response.data.filter( function (record) {return record.playersInfo.length > 0;}).forEach(function (recordInfo) {\r\n            index++;\r\n            var item = cc.instantiate(this.recordItem);\r\n            this.scrollViewContent.addChild(item);\r\n            var comp = item.getComponent('recordInfo');\r\n            comp.setInfo(recordInfo);\r\n            var recordBtn = item.children[7].getComponent(cc.Button);\r\n            recordBtn.clickEvents[0].customEventData = recordInfo;\r\n            // var eventHandler = new cc.Component.EventHandler();\r\n            // eventHandler.target = comp.node.children[7];\r\n            // eventHandler.component = \"btn\";\r\n            // eventHandler.handler = \"clickAction\";\r\n            //eventHandler.customEventData = \"my data\";\r\n            //console.log(comp.node.children[7]);\r\n        }.bind(this));\r\n    },\r\n\r\n    closeAction:function() {\r\n        if (this.isSubPage) {\r\n            this.isSubPage = false;\r\n            this.subScrollView.active = false;\r\n            this.scrollView.active = true;\r\n        }\r\n        else {\r\n            this.node.getComponent('alert').dismissAction();\r\n        }\r\n    },\r\n   /* clickAction:function( index ){\r\n        //_ReceiveRecordItem()\r\n    },\r\n    _ReceiveRecordItem:function(RecordItemInfo) {\r\n        cc.log(RecordItemInfo)\r\n        cc.log('------78')\r\n        //console.log(RecordItemInfo);return;\r\n        var index = RecordItemInfo.data\r\n        var playersInfo = JSON.parse(this._records[index].playersInfo);\r\n        \r\n        var players = playersInfo.players;                  // 玩家信息\r\n        var playersIndex = playersInfo.playersIndex;        // 玩家的位置\r\n        var createUserId = this._records[index].createUserId;   // 创房ID\r\n        var sendUserId = this._records[index].userid;           // 发送人ID\r\n\r\n        this.isSubPage = true;\r\n        this.subScrollView.active = true;\r\n        this.scrollView.active = false;\r\n\r\n        this.timeLabel.string = (this._records[index].createAt).substr(5,11);               // 时间\r\n        this.jushuLabel.string = this.js(JSON.parse(this._records[index].setting2));        // 局数\r\n        this.roomId.string = this._records[index].roomId;                                   // 房间号\r\n        this.creat.string = this.findCreator(this._records[index].createUserId,players);    // 房主\r\n\r\n        this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;\r\n        this.subScrollViewContent.removeAllChildren();\r\n\r\n        for(var i = 0; i < players.length; i++ ){\r\n            var item = cc.instantiate(this.splash);\r\n            this.subScrollViewContent.addChild(item);\r\n            var comp = item.getComponent('recordInfo');\r\n            var creator = 0;       \r\n            var self = 0;       // 表示自己，要对自己的比牌记录背景做处理\r\n            if(createUserId == players[i].id){\r\n                creator =1;\r\n            }\r\n            if( sendUserId == players[i].id){\r\n                self = 1;\r\n            }\r\n            this.records(comp,i,creator,self,index);\r\n        }\r\n\r\n    },\r\n    records:function(info,i,creator,self,index){\r\n        if(self){\r\n            info.node.color = new cc.Color(125, 126, 200);\r\n        }\r\n        cc.log(info)\r\n        cc.log('----119')\r\n        var players = JSON.parse(this._records[index].playersInfo).players;\r\n        var scores = this._records[index].scores ;\r\n        info.nicknameLabels.string = players[i].nickname;\r\n        info.id.string = players[i].id;\r\n        info.jifen.string = scores[i];\r\n\r\n        var headUrl = players[i].avatarUrl;   //头像连接\r\n        var sprite = info.avatarNode.getComponent(cc.Sprite);\r\n        cc.loader.load(headUrl+\".jpg\", function (err, tex) {\r\n          if (!err) {\r\n              var frame = new cc.SpriteFrame(tex);\r\n              sprite.spriteFrame=frame;\r\n          }\r\n        });\r\n        info.creatorImg.active = creator;\r\n    },\r\n    findCreator:function(createId,players){ //找房主\r\n        for(var i=0; i<players.length;i++){\r\n            if(createId == players[i].id){\r\n                return players[i].nickname;\r\n            }\r\n        }\r\n    },\r\n    js:function(num){\r\n        var J = 5;\r\n        switch(num){\r\n            case 0: J = 5;break;\r\n            case 1: J = 10;break;\r\n            case 2: J = 20;break;\r\n            case 3: J = 30;break;\r\n        }\r\n        return J;\r\n    },*/\r\n\r\n});\r\n"
  ]
}