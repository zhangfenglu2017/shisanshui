{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": ";;AAEA,IAAI,WAAW,GAAG,EAAE,CAAC,KAAK,CAAC;AACvB,eAAS,EAAE,CAAC,SAAS;;AAErB,cAAU,EAAE;AACR,gBAAQ,EAAE,EAAE,CAAC,QAAQ;AACrB,wBAAgB,EAAE,EAAE,CAAC,MAAM;AAC3B,aAAK,EAAC,EAAE,CAAC,IAAI;KAChB;;;AAGD,UAAM,EAAE,kBAAY;AAChB,mBAAW,CAAC,SAAS,GAAG,IAAI,CAAC;KAChC;;AAED,aAAS,EAAE,qBAAwC;YAA9B,MAAM,yDAAG,EAAE;YAAE,QAAQ,yDAAG,IAAI;;AAC7C,YAAI,MAAM,CAAC,MAAM,IAAI,CAAC,EAAE;AACpB,mBAAO;SACV;;AAED,YAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;AACxB,YAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;AACjC,YAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;AACzC,YAAI,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC;AAC1B,YAAI,QAAQ,GAAG,GAAG,CAAC;AACnB,YAAI,OAAO,GAAG,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;;;;;;;AAO9C,YAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,CAAC,CAAC;AAC3B,YAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,OAAO,CAAC;;AAE/B,YAAI,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,KAAK,CAAC;AAC7D,YAAI,YAAY,GAAG,QAAQ,EAAE;AACzB,gBAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;AAClC,gBAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,OAAO,CAAC;AAC/B,wBAAY,GAAG,QAAQ,CAAC;SAC3B;;AAED,YAAI,CAAC,IAAI,CAAC,KAAK,GAAG,YAAY,GAAG,EAAE,CAAC;AACpC,YAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,MAAM,GAAG,EAAE,CAAC;;AAEnE,YAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;AACnD,YAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;;AAErD,YAAI,QAAQ,EAAE;AACV,gBAAI,CAAC,SAAS,EAAE,CAAA;;;SAGnB;KACJ;;AAED,aAAS,EAAE,mBAAU,MAAM,EAAE;AACzB,YAAI,CAAC,SAAS,EAAE,CAAC;AACjB,YAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;AACxB,YAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC;AACzB,YAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;AAClC,YAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;AAC1C,YAAI,UAAU,GAAI,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;AACrD,kBAAU,CAAC,WAAW,GAAG,MAAM,CAAC;KACnC;;AAED,aAAS,EAAE,qBAAY;AACnB,YAAI,CAAC,sBAAsB,EAAE,CAAC;AAC9B,YAAI,CAAC,YAAY,CAAC,CAAA,YAAU;AACxB,gBAAI,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;SAC5B,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;KACpB;;CAEJ,CAAC,CAAC;AACH,WAAW,CAAC,QAAQ,GAAG,UAAS,MAAM,EAAC;AACnC,QAAI,CAAC,SAAS,CAAC,SAAS,EAAE,CAAC;AAC3B,QAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;AAClC,QAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC;AACnC,QAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;AAC5C,QAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;AACpD,QAAI,UAAU,GAAI,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;AAC/D,cAAU,CAAC,WAAW,GAAG,MAAM,CAAC;;;;;CAKnC;;;AAGD,WAAW,CAAC,WAAW,GAAG,UAAU,GAAG,EAAE;AACrC,QAAI,MAAM,GAAG,GAAG,CAAC,OAAO,CAAC,cAAc,EAAE,UAAS,KAAK,EAAC;AACpD,YAAI,EAAE,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,aAAa,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;AAChE,eAAO,EAAE,CAAC;KACb,CAAC,CAAC;AACH,WAAO,MAAM,CAAC;CACjB,EAED,MAAM,CAAC,OAAO,GAAG,WAAW,CAAC",
  "file": "unknown",
  "sourcesContent": [
    "// 用于在游戏过程中，展示用户的聊天消息\r\n\r\nlet ChatMessage = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        richText: cc.RichText,\r\n        spriteBackground: cc.Sprite,\r\n        emoji:cc.Node,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        ChatMessage.instances = this;\r\n    },\r\n\r\n    setString: function (string = \"\", autoHide = true) {\r\n        if (string.length == 0) {\r\n            return;\r\n        }\r\n\r\n        this.node.active = true;\r\n        this.richText.node.active = true;\r\n        this.spriteBackground.node.active = true;\r\n        this.emoji.active = false;\r\n        let maxWidth = 300;\r\n        let realStr = ChatMessage.parseString(string);\r\n\r\n        // 由于 cc.RichText 在指定 maxWidth 后，该结点的 width 会一直\r\n        // 是 maxWidth 值。而在将 maxWidth 指定为0时，其 contentSize.width 会\r\n        // 是内容的真正所需的宽度\r\n        //\r\n        // 所以这里先将 maxWidth 设为 0，获取其实际内容 width 后再调整\r\n        this.richText.maxWidth = 0;\r\n        this.richText.string = realStr;\r\n\r\n        let contentWidth = this.richText.node.getContentSize().width;\r\n        if (contentWidth > maxWidth) {\r\n            this.richText.maxWidth = maxWidth;\r\n            this.richText.string = realStr;\r\n            contentWidth = maxWidth;\r\n        }\r\n\r\n        this.node.width = contentWidth + 28;\r\n        this.node.height = this.richText.node.getContentSize().height + 20;\r\n\r\n        this.spriteBackground.node.width = this.node.width;\r\n        this.spriteBackground.node.height = this.node.height;\r\n\r\n        if (autoHide) {\r\n            this._hideNode()\r\n            //this.unscheduleAllCallbacks();\r\n            //this.scheduleOnce(this._hideNode.bind(this), 3);\r\n        }\r\n    },\r\n\r\n    showEmoji: function (sprite) {\r\n        this._hideNode();\r\n        this.node.active = true;\r\n        this.emoji.active = true;\r\n        this.richText.node.active = false;\r\n        this.spriteBackground.node.active = false;\r\n        var btnSprites =  this.emoji.getComponent(cc.Sprite);\r\n        btnSprites.spriteFrame = sprite;\r\n    },\r\n\r\n    _hideNode: function () {\r\n        this.unscheduleAllCallbacks();\r\n        this.scheduleOnce(function(){\r\n            this.node.active = false;\r\n        }.bind(this), 3);\r\n    },\r\n\r\n});\r\nChatMessage.setEmoji = function(sprite){\r\n    this.instances._hideNode();\r\n    this.instances.node.active = true;\r\n    this.instances.emoji.active = true;\r\n    this.instances.richText.node.active = false;\r\n    this.instances.spriteBackground.node.active = false;\r\n    var btnSprites =  this.instances.emoji.getComponent(cc.Sprite);\r\n    btnSprites.spriteFrame = sprite;\r\n    //console.log(this.emoji);\r\n    //return;\r\n    //\r\n    //this.emoji.Sprite = sprite;\r\n},\r\n\r\n// 将 <bq10> 改为： <img src='bg10'/>\r\nChatMessage.parseString = function (str) {\r\n    let result = str.replace(/<bq\\d{1,2}>/g, function(match){\r\n        var bq = match.replace(\"<\", \" <img src='\").replace(\">\", \"'/> \");\r\n        return bq;\r\n    });\r\n    return result;\r\n},\r\n\r\nmodule.exports = ChatMessage;\r\n"
  ]
}