{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "const Socket = require('socket');\r\nconst KQGlobalEvent = require('KQGlobalEvent');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        matchingLabel:cc.Label,\r\n        timeNode:cc.Node,\r\n        matchingNode:cc.Node,\r\n        waitingPrefab: cc.Prefab,\r\n        alertPrefab: cc.Prefab,\r\n\r\n        tishi:cc.Node,\r\n\r\n        _userId: null,\r\n        _response: null,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n      this._userId = Socket.instance.userInfo.id;\r\n      cc.isRoomViewShow = true;\r\n      KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo ,this);\r\n      KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);\r\n      KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);\r\n      KQGlobalEvent.on(Socket.Event.ReceiveInterRandom, this._socketReceiveInterRandom, this);\r\n    },\r\n\r\n    _socketReceiveDeskInfo: function (response) {\r\n      if (!response.result) {\r\n        return;\r\n      }\r\n\r\n      cc.director.loadScene('play');\r\n    },\r\n\r\n    _socketReceiveInterRandom: function(response) {\r\n        //服务器发送  {'action':'interRandom','result':false,'data':{'reason':reason}}\r\n        this._response = response;\r\n        this.unschedule(this._timeoutRandomAction);\r\n        // 处理随机场匹配不成功的情况\r\n        if (response.result) {\r\n            return;\r\n        }\r\n\r\n        let reason = response.data.reason || \"加入随机场失败\";\r\n        this.showAlertMessage(reason);\r\n\r\n        if (reason == '你已经在匹配队列') {\r\n            this._showMatching();\r\n        } else {\r\n            this._hideMatching();\r\n        }\r\n    },\r\n\r\n    _socketDisconnect: function() {\r\n      // 连接已断开\r\n      this.matchingNode.active = false;\r\n      this.showNetworkMessage('网络链接断开，重新连接中...');\r\n    },\r\n\r\n    _socketConnected: function() {\r\n      this.hiddenNetworkMessage();\r\n    },\r\n\r\n\r\n    onDestroy: function () {\r\n      KQGlobalEvent.offTarget(this);\r\n    },\r\n\r\n    clickExit: function () {\r\n        cc.director.loadScene('hall');\r\n    },\r\n\r\n    clickStart: function () {\r\n      Socket.sendEnterRandom(this._userId);\r\n      this._showMatching();\r\n\r\n      /*#####begin*/\r\n      //reason是服务器发送回来的\r\n      /*if(this._response.data.reason == \"你的钻石不足\"){\r\n          this.tishi.active = true;\r\n      }*/\r\n      /*#####end*/\r\n\r\n      this.scheduleOnce(this._timeoutRandomAction, 5);\r\n    },\r\n    /*#####点击空白地方，砖石不足提示消失*/\r\n    /*onBtnKong:function () {\r\n        if(this.tishi.active){\r\n            this.tishi.active = false;\r\n        }else{\r\n            //什么也不做\r\n        }\r\n    },*/\r\n    /*取消匹配*/\r\n    clickCancel:function () {\r\n      Socket.sendCancelRandom(this._userId);\r\n\r\n      this._hideMatching();\r\n    },\r\n\r\n    _timeoutRandomAction: function() {\r\n        this._hideMatching();\r\n        this.showAlertMessage('进入匹配失败');\r\n    },\r\n\r\n    _showMatching: function() {\r\n        var comp = this.matchingNode.getComponent('alert');\r\n        comp.alert();\r\n        this.matchingLabel.string = '正在匹配中，请稍后...';\r\n        let num = 0;\r\n        this.schedule(function() {\r\n            num = num + 0.5;\r\n            this.timeNode.rotation = num;\r\n         }, 0.01);\r\n    },\r\n\r\n    _hideMatching: function() {\r\n        var comp = this.matchingNode.getComponent('alert');\r\n        comp.dismissAction();\r\n    },\r\n\r\n     showNetworkMessage:function(msg) {\r\n        this.unschedule(this._timeoutRandomAction);\r\n\r\n        if (this.networkNode != null) {\r\n            var removeSelfAction = cc.removeSelf();\r\n            this.networkNode.runAction(removeSelfAction);\r\n            this.networkNode = null;\r\n        }\r\n        this.networkNode = cc.instantiate(this.waitingPrefab);\r\n        this.node.addChild(this.networkNode);\r\n        var comp = this.networkNode.getComponent('alert');\r\n        var self = this;\r\n        comp.onDismissComplete = function() {\r\n            self.networkNode = null;\r\n        };\r\n        comp.setMessage(msg);\r\n        comp.alert();\r\n    },\r\n\r\n    hiddenNetworkMessage:function() {\r\n        if (this.networkNode != null) {\r\n            this.networkNode.getComponent('alert').dismissAction();\r\n        }\r\n    },\r\n\r\n    showAlertMessage: function(msg) {\r\n        if (!msg) {\r\n            cc.error(\"不能显示为空的信息\");\r\n            return;\r\n        }\r\n\r\n        if (!this.alertMessageNode) {\r\n            this.alertMessageNode = cc.instantiate(this.alertPrefab);\r\n            this.node.addChild(this.alertMessageNode);\r\n        }\r\n\r\n        this.alertMessageNode.getComponent('alert').setMessage(msg);\r\n        this.alertMessageNode.getComponent('alert').alert();\r\n    },\r\n});\r\n"
  ]
}