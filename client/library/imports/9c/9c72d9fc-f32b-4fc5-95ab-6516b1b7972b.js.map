{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "var manager = require('manager');\r\nconst KQCard = require('KQCard');\r\nconst Socket = require('socket');\r\nconst KQCardFindTypeExtension = require('KQCardFindTypeExtension');\r\nconst KQGlobalEvent = require('KQGlobalEvent');\r\nconst AudioManager = require('AudioManager');\r\nconst KQNativeInvoke = require('KQNativeInvoke');\r\nconst KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');\r\n\r\nvar APPID = 'wxe8993f468b16fa5d';\r\nvar ROOMID = '';\r\n//授权地址\r\n//正式地址\r\n// var REDIRECT_URI = \"http%3A%2F%2Fwww.honggefeng.cn%2FsszWeb%2Findex.php\";\r\n// 测试地址\r\nvar REDIRECT_URI = \"http%3a%2f%2fo1o2.cn\";\r\n\r\nlet HREF = \"https://open.weixin.qq.com/connect/oauth2/authorize?appid=\"+APPID+\"&redirect_uri=\"+REDIRECT_URI+\"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect\";\r\n\r\n\r\ncc.Class({\r\n\r\n    extends: cc.Component,\r\n    properties: {\r\n        //selectNode:cc.Node,\r\n        alertPrefab:cc.Prefab,\r\n        canvasNode:cc.Node,\r\n        loadingNode:cc.Node,\r\n        //err:cc.Node,\r\n        waitingPrefab:cc.Prefab,\r\n        recordInfo:cc.Prefab,\r\n        label:cc.Label,\r\n    },\r\n\r\n    goUpdateAction:function() {\r\n        if (KQNativeInvoke.isNativeIOS()) {\r\n            jsb.reflection.callStaticMethod(\"AppController\",\"downloadNewVersion:\",this.iosUrl);\r\n        }\r\n        else {//Android\r\n            jsb.reflection.callStaticMethod(\"com/gongpa/ssz/AppActivity\", \"downloadNewVersion\", \"(Ljava/lang/String;)V\", this.androidUrl);\r\n        }\r\n    },\r\n\r\n    checkVersion:function(vData) {\r\n        //var version = vData.version;\r\n        cc.info1 = vData.version;\r\n        this.iosUrl = vData.iosUrl;\r\n        this.androidUrl = vData.androidUrl;\r\n        //if (manager.version != version) {//更新版本\r\n        //    this.versionEnable = false;\r\n        //    this.goUpdateAction();\r\n        //    //this.versionLabel.string = '请到服务器更新到最新版本';\r\n        //}\r\n        //else {\r\n            //this.versionLabel.string = '当前版本 ' + manager.version;\r\n            if(KQNativeInvoke.isNativeIOS()) {\r\n                // if(iosVersion != manager.version) {\r\n                //     this.versionEnable = false;\r\n                //     var updateAlert = cc.find(\"Canvas/update\").getComponent(\"alert\");\r\n                //     updateAlert.alert();\r\n                // }\r\n                // else {\r\n                    this.versionEnable = true;\r\n                    var self = this;\r\n                    var info = manager.getUserInfo();\r\n                    if (info.length == 0) {\r\n                        this.loginEnable = true;\r\n                    }\r\n                    this.scheduleOnce(function(){\r\n                        if (info.length > 0) {\r\n                            this.loginEnable = true;\r\n                            self.loginAction();\r\n                        }\r\n                    },0.5);\r\n                //}\r\n            }\r\n            else if(KQNativeInvoke.isNativeAndroid()) {\r\n                // if(androidVersion != manager.version) {\r\n                //     this.versionEnable = false;\r\n                //     var updateAlert = cc.find(\"Canvas/update\").getComponent(\"alert\");\r\n                //     updateAlert.alert();\r\n                // }\r\n                // else {\r\n                    this.versionEnable = true;\r\n                    var self = this;\r\n                    var info = manager.getUserInfo();\r\n                    if (info.length == 0) {\r\n                        this.loginEnable = true;\r\n                    }\r\n                    this.scheduleOnce(function(){\r\n                        if (info.length > 0) {\r\n                            this.loginEnable = true;\r\n                            self.loginAction();\r\n                        }\r\n                    },0.5);\r\n                //}\r\n            }\r\n            else{\r\n              this.versionEnable = true;\r\n              var self = this;\r\n              // var info = manager.getUserInfo();\r\n              // if (info.length == 0) {\r\n              //     this.loginEnable = true;\r\n              // }\r\n              this.scheduleOnce(function(){\r\n                  if(!cc.sys.isNative){\r\n                      var recordId = self.getQueryString('recordId');\r\n                      if(recordId){\r\n                        Socket.sendGetRecrodFromId(recordId);\r\n                        return;\r\n                      }\r\n                      var roomId = self.getQueryString(\"roomId\");\r\n                      if(roomId){\r\n                          var info = manager.getUserInfo();\r\n                          if (info.length > 0) {\r\n                            var data = JSON.parse(info);\r\n                            if(!data.errcode){\r\n                              self.sendLoginRequest(data);\r\n                            }else{\r\n                              manager.setUserInfo(\"\");\r\n                            }\r\n                            return;\r\n                          }else{\r\n                            self._get_HREF(roomId);\r\n                          }\r\n                      }\r\n                  }\r\n                  var info = manager.getUserInfo();\r\n                  if (info.length > 0) {\r\n                    var data = null;\r\n                    try {\r\n                      data = JSON.parse(info);\r\n                    }\r\n                    catch (e){\r\n                      manager.setUserInfo(\"\");\r\n                      data = null;\r\n                    }\r\n                    if(!data || data.errcode){\r\n                      manager.setUserInfo(\"\");\r\n                    }else{\r\n                      this.loginEnable = true;\r\n                      self.loginAction();\r\n                    }\r\n                  }\r\n                  else{\r\n                    if(!cc.sys.isNative){\r\n                        var code = self.getQueryString(\"code\");\r\n                        var roomId = self.getQueryString(\"roomId\");\r\n                        if( roomId ){\r\n                            var info = manager.getUserInfo();\r\n                            if (info.length > 0) {\r\n                              var data = JSON.parse(info);\r\n                              if(!data.errcode){\r\n                                self.sendLoginRequest(data);\r\n                              }else{\r\n                                manager.setUserInfo(\"\");\r\n                              }\r\n                              return;\r\n                            }else{\r\n                              self._get_HREF(roomId);\r\n                            }\r\n                        }\r\n                        if( code ){\r\n                            try{\r\n                                var obj = new XMLHttpRequest();  // XMLHttpRequest对象用于在后台与服务器交换数据\r\n                                var url = \"./get_token.php\";       \r\n                                obj.open(\"POST\", url, true);\r\n                                obj.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");  // 添加http头，发送信息至服务器时内容编码类型\r\n                                obj.onreadystatechange = function() {\r\n                                  if (obj.readyState == 4 && (obj.status == 200 || obj.status == 304)) {  // 304未修改\r\n                                      //alert(obj.responseText);\r\n                                      var data = JSON.parse( obj.responseText );\r\n                                      if(!data.errcode){\r\n                                          manager.setUserInfo( obj.responseText );\r\n                                          self.sendLoginRequest( data );\r\n                                      }\r\n                                  }\r\n                                };\r\n                                obj.send(\"code=\"+code);\r\n                            }catch(e){\r\n                                //alert(e);\r\n                            }\r\n                        }\r\n                    }\r\n                  }\r\n              },0.5);\r\n            }\r\n        //}\r\n    },\r\n    keyBackListen:function () {\r\n        var _this = this;\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(e) {\r\n            if(e.keyCode == cc.KEY.back) {\r\n                if(!KQNativeInvoke.isNativeIOS()){\r\n                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"backToDesk\", \"()V\");\r\n                }\r\n            }\r\n        },this);\r\n    },\r\n    //随机生成 num 位 的随机数 含大小写字母及数字\r\n    getRandomAccount:function(num)\r\n    {\r\n        /**\r\n         * 返回一个字母\r\n         */\r\n        function getCharacter(flag){\r\n            var character = \"\";\r\n            if(flag === \"lower\"){\r\n                character = String.fromCharCode(Math.floor( Math.random() * 26) + \"a\".charCodeAt(0));\r\n            }\r\n            if(flag === \"upper\"){\r\n                character = String.fromCharCode(Math.floor( Math.random() * 26) + \"A\".charCodeAt(0));\r\n            }\r\n            return character;\r\n        }\r\n\r\n        var str = \"\";\r\n        for(var i=0;i<num;i++)\r\n        {\r\n            var flag = \"lower\" ;\r\n            var random = Math.floor(Math.random() * 3);\r\n            if(random == 0)\r\n            {\r\n                flag = \"upper\" ;\r\n                str += getCharacter(flag);\r\n            }else if(random == 1)\r\n            {\r\n                str += getCharacter(flag);\r\n            }else\r\n            {\r\n                str += Math.floor(Math.random() * 10);\r\n            }\r\n        }\r\n        return str;\r\n    },\r\n    getGuestUserInfo:function(){\r\n        let search = window.location.search;\r\n        var openid = \"guest_\" + this.getRandomAccount(8);\r\n        var unionid = 'guest_' + this.getRandomAccount(8);\r\n        var nickname = this.getRandomAccount(8);\r\n        var testData = '{\"openid\":\"'+openid+'\",\"nickname\":\"'+nickname+'\",\"unionid\":\"'+unionid+'\",\"sex\":1,\"language\":\"zh_CN\",\"city\":\"Changsha\",\"province\":\"Hunan\",\"country\":\"CN\",\"headimgurl\":\"http:\\/\\/wx.qlogo.cn\\/mmopen\\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\\/0\",\"privilege\":[]}';\r\n        return testData;\r\n    },\r\n    onLoad: function () {\r\n        this.keyBackListen();\r\n        if(!cc.sys.isNative && cc.sys.isMobile){\r\n            var canvas = cc.find(\"Canvas\");\r\n            var cvs = canvas.getComponent(cc.Canvas);\r\n        }\r\n        KQGlabolSocketEventHander.start();\r\n        this.socket = cc.find('GameSocket').getComponent('socket');\r\n        var self = this;\r\n        this.loginEnable = false;\r\n        this.socket.receviceMessage = function(response) {\r\n            var data = JSON.parse(response);\r\n            //console.log(data)\r\n            if (data.action == 'checkVersion') {\r\n              try{\r\n                self.checkVersion(data.data);\r\n              }catch(e){\r\n                //this.err.string = e;\r\n              }\r\n            }\r\n            else if (data.action == 'login') {\r\n               if (data.result) {//成功\r\n                   self.socket.userInfo = data.data;//运行时态信息\r\n                   if(!cc.sys.isNative){\r\n                      var roomId = self.getQueryString(\"roomId\");\r\n                      //console.log(roomId);\r\n                      if(roomId){\r\n                        var userId = data.data.id;\r\n                        var exitInRoom = data.data.roomId;\r\n                        if(exitInRoom != \"\"){\r\n                          roomId = exitInRoom;\r\n                        }\r\n                        Socket.sendLoginJoin(roomId, userId);\r\n                        return;\r\n                      }\r\n                    }\r\n                    self._loadingLabel(\"登录中\");\r\n                   if (data.data.roomId.length > 0) {\r\n                        cc.director.loadScene('play');\r\n                   }\r\n                   else {\r\n                        cc.director.loadScene('hall');\r\n                   }\r\n               }\r\n               else {\r\n                  // self.alertMessage('登录失败!');\r\n               }\r\n           }\r\n        };\r\n        this._registerSocketEvent();\r\n\r\n        this.socket.getWxInfo = function(info) {\r\n           manager.setUserInfo(info);//保存本地\r\n           var data = JSON.parse(info);//str -> json(obj)\r\n           self.scheduleOnce(function(){//延迟执行 1s\r\n               self.sendLoginRequest(data);//登录请求\r\n           },1);\r\n        };\r\n        this.getOnlyUserInfoByBrowser();\r\n        //cc.sys.localStorage.removeItem(\"userinfo\");\r\n        // let search = window.location.search;\r\n        // var openid = \"JzIwMTcvNi8xNiDkuIrljYgxMMzowOCc=\";\r\n        // var unionid = '8dOtAcDic5Sichv3lxtMXYJgmunTLOLv';\r\n        // var nickname = \"哇哈哈\";\r\n\r\n\r\n        //var openid = \"JzIwMTcvNi8xNiDkuIrljYgxMMzowOCc=\";\r\n        //var openid = \"guest_\" + this.getRandomAccount(8);\r\n        //var unionid = '8dOtAcDic5Sichv3lxtMXYJgmunTLOLv';\r\n        //var unionid = 'guest_' + this.getRandomAccount(8);\r\n        //var nickname = this.getRandomAccount(8);\r\n\r\n\r\n         //if (search) {\r\n         //    var url = window.location.search;\r\n         //    var loc = url.substring(url.lastIndexOf('=') + 1, url.length);\r\n         //    if (loc == 1) {\r\n         //        openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';\r\n         //        unionid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc';\r\n         //        nickname = loc;\r\n         //    }\r\n         //    else if (loc == 2) {\r\n         //        openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';\r\n         //        unionid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw';\r\n         //        nickname = loc;\r\n         //    }\r\n         //    else if (loc == 3) {\r\n         //        openid = 'JzIwMTctNi0xNiAwOTo0NToc=';\r\n         //        unionid = '8dOtAcDic5Sichv3lxtMXYmunTLOLv';\r\n         //        nickname = loc;\r\n         //    }\r\n         //    else if (loc == 4) {\r\n         //        openid = 'ozlXIwgv_QJT0ykdUihaABmsWp2A';\r\n         //        unionid = 'o-3911qWsQsW3wUodqFfUtbsAeNk';\r\n         //        nickname = loc;\r\n         //    }\r\n         //    else if (loc == 5) {\r\n         //        openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';\r\n         //         unionid = 'o-JzIwMTcvNi8xNiDkuIrljYgxMDowM';\r\n         //        nickname = loc;\r\n         //    }else if(loc == 6){\r\n         //        openid = 'JzIwMTcvNi8xNiDkuIrljYgxMMzoc=';\r\n         //         unionid = 'o-zIwMTcvNi8xNiDkuIrl';\r\n         //        nickname = loc;\r\n         //    }\r\n         //\r\n         //}\r\n        // var testData = '{\"openid\":\"'+openid+'\",\"nickname\":\"'+nickname+'\",\"unionid\":\"'+unionid+'\",\"sex\":1,\"language\":\"zh_CN\",\"city\":\"Changsha\",\"province\":\"Hunan\",\"country\":\"CN\",\"headimgurl\":\"http:\\/\\/wx.qlogo.cn\\/mmopen\\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\\/0\",\"privilege\":[]}';\r\n\r\n\r\n         //if (!cc.sys.isNative){\r\n         //    var info = manager.getUserInfo();\r\n         //    if (info.length > 0) {\r\n         //        //this.showWaitingMessage('已存有账号=====');\r\n         //        //return;\r\n         //    }else\r\n         //    {\r\n         //        //this.showWaitingMessage('新账号=====');\r\n         //        var userInfo = this.getGuestUserInfo();\r\n         //        manager.setUserInfo(userInfo);\r\n         //    }\r\n         //}\r\n    },\r\n\r\n    getOnlyUserInfoByBrowser:function()\r\n    {\r\n        var openid = \"\";\r\n        var unionid = \"\";\r\n        var nickname = \"\";\r\n\r\n        var testData = \"\";\r\n        var userInfo = manager.getUserInfo();\r\n\r\n        let search = window.location.search;\r\n        if(userInfo.length > 0)\r\n        {\r\n            openid = userInfo.openId;\r\n            unionid = userInfo.unionid;\r\n            nickname = userInfo.nickname;\r\n        }\r\n\r\n        if (search) {\r\n            var url = window.location.search;\r\n            var loc = url.substring(url.lastIndexOf('=') + 1, url.length);\r\n            if (loc == 1) {\r\n                openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';\r\n                unionid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc';\r\n                nickname = \"guest_1\";\r\n                testData = '{\"openid\":\"'+openid+'\",\"nickname\":\"'+nickname+'\",\"unionid\":\"'+unionid+'\",\"sex\":1,\"language\":\"zh_CN\",\"city\":\"Changsha\",\"province\":\"Hunan\",\"country\":\"CN\",\"headimgurl\":\"http:\\/\\/wx.qlogo.cn\\/mmopen\\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\\/0\",\"privilege\":[]}';\r\n            }\r\n            else if (loc == 2) {\r\n                openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';\r\n                unionid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw';\r\n                nickname = \"guest_2\";\r\n                testData = '{\"openid\":\"'+openid+'\",\"nickname\":\"'+nickname+'\",\"unionid\":\"'+unionid+'\",\"sex\":1,\"language\":\"zh_CN\",\"city\":\"Changsha\",\"province\":\"Hunan\",\"country\":\"CN\",\"headimgurl\":\"http:\\/\\/wx.qlogo.cn\\/mmopen\\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\\/0\",\"privilege\":[]}';\r\n            }\r\n            else if (loc == 3) {\r\n                openid = 'JzIwMTctNi0xNiAwOTo0NToc=';\r\n                unionid = '8dOtAcDic5Sichv3lxtMXYmunTLOLv';\r\n                nickname = \"guest_3\";\r\n                testData = '{\"openid\":\"'+openid+'\",\"nickname\":\"'+nickname+'\",\"unionid\":\"'+unionid+'\",\"sex\":1,\"language\":\"zh_CN\",\"city\":\"Changsha\",\"province\":\"Hunan\",\"country\":\"CN\",\"headimgurl\":\"http:\\/\\/wx.qlogo.cn\\/mmopen\\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\\/0\",\"privilege\":[]}';\r\n            }\r\n            else if (loc == 4) {\r\n                openid = 'ozlXIwgv_QJT0ykdUihaABmsWp2A';\r\n                unionid = 'o-3911qWsQsW3wUodqFfUtbsAeNk';\r\n                nickname = \"guest_4\";\r\n                testData = '{\"openid\":\"'+openid+'\",\"nickname\":\"'+nickname+'\",\"unionid\":\"'+unionid+'\",\"sex\":1,\"language\":\"zh_CN\",\"city\":\"Changsha\",\"province\":\"Hunan\",\"country\":\"CN\",\"headimgurl\":\"http:\\/\\/wx.qlogo.cn\\/mmopen\\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\\/0\",\"privilege\":[]}';\r\n            }\r\n            else if (loc == 5) {\r\n                openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';\r\n                 unionid = 'o-JzIwMTcvNi8xNiDkuIrljYgxMDowM';\r\n                nickname = \"guest_5\";\r\n                testData = '{\"openid\":\"'+openid+'\",\"nickname\":\"'+nickname+'\",\"unionid\":\"'+unionid+'\",\"sex\":1,\"language\":\"zh_CN\",\"city\":\"Changsha\",\"province\":\"Hunan\",\"country\":\"CN\",\"headimgurl\":\"http:\\/\\/wx.qlogo.cn\\/mmopen\\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\\/0\",\"privilege\":[]}';\r\n            }else if(loc == 6){\r\n                openid = 'JzIwMTcvNi8xNiDkuIrljYgxMMzoc=';\r\n                 unionid = 'o-zIwMTcvNi8xNiDkuIrl';\r\n                nickname = \"guest_6\";\r\n                testData = '{\"openid\":\"'+openid+'\",\"nickname\":\"'+nickname+'\",\"unionid\":\"'+unionid+'\",\"sex\":1,\"language\":\"zh_CN\",\"city\":\"Changsha\",\"province\":\"Hunan\",\"country\":\"CN\",\"headimgurl\":\"http:\\/\\/wx.qlogo.cn\\/mmopen\\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\\/0\",\"privilege\":[]}';\r\n            }\r\n        }\r\n         if(testData && testData.length > 0)\r\n         {\r\n             if (!cc.sys.isNative){\r\n                 manager.setUserInfo(testData);\r\n             }\r\n         }\r\n    },\r\n    _registerSocketEvent:function(){\r\n        KQGlobalEvent.on(Socket.Event.ReceiveLoginJoin, this._LoginJoin, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveRecordId, this._ReceiveRecordId, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveNoUionid, this._ReceiveNoUionid, this);\r\n    }, \r\n    _get_HREF:function(roomId){\r\n      if(roomId != ROOMID){\r\n        ROOMID = roomId;\r\n        roomId = \"%3froomId%3d\"+roomId ;\r\n        REDIRECT_URI = REDIRECT_URI+roomId;\r\n        HREF = \"https://open.weixin.qq.com/connect/oauth2/authorize?appid=\"+APPID+\"&redirect_uri=\"+REDIRECT_URI+\"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect\";\r\n      }\r\n    },\r\n    _ReceiveNoUionid:function(response){\r\n      manager.setUserInfo(\"\");\r\n      var self = this;\r\n      var roomId = this.getQueryString(\"roomId\");\r\n      if(roomId){\r\n        //roomId = \"%3froomId%3d\"+roomId ;\r\n        //REDIRECT_URI = REDIRECT_URI+roomId;\r\n        this._get_HREF(roomId);\r\n      }\r\n      setTimeout(function(){\r\n        self.loadingNode.parent.active = false;\r\n        self.loadingNode.stopAllActions();\r\n      },2000)\r\n      this._loadingLabel(\"登录失败，请重新登录\");\r\n    },\r\n    _ReceiveRecordId:function(response){\r\n        var data = response.data;\r\n        if(data.recordMsg.length>0){\r\n          var record = data.recordMsg[0];\r\n          var playersInfo = JSON.parse(record.playersInfo).players;\r\n          var recordNode = cc.instantiate(this.recordInfo);\r\n          let totalGameResult = recordNode.getComponent(\"TotalGameResult\");\r\n          playersInfo.sort(function(a,b){return b.totalScore-a.totalScore});  // 排序\r\n          totalGameResult.setPlayerInfos(playersInfo,record);\r\n          totalGameResult._clickBtn();\r\n          recordNode.getComponent('alert').alert();\r\n          this.node.addChild(recordNode);\r\n        }\r\n    },\r\n    _LoginJoin: function(response){\r\n        this._loadingLabel(\"进入房间，正在为您请求数据\");\r\n        if (response.result){\r\n            if(cc.from == null) {\r\n                cc.from = {};\r\n            }\r\n            cc.from.ma = response.data.maPai;\r\n            cc.director.loadScene('play');\r\n        } else {\r\n            cc.joinDesk = {};\r\n            cc.director.loadScene('hall');\r\n            let reasonInfo = this._joinReasonMap(response.data.reason);\r\n            cc.joinDesk.result = response.result;\r\n            cc.joinDesk.reason = reasonInfo;\r\n        }\r\n    },\r\n    _joinReasonMap: function (reason) {\r\n      let reasonInfo = {\r\n        notExist: \"房间不存在!\",\r\n        cardNumber: \"您房卡不足!\",\r\n      };\r\n      let info = reasonInfo[reason] || \"房间已满!\";\r\n      return info;\r\n    },\r\n\r\n    getQueryString: function(name){\r\n        var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\"); \r\n        var r = window.location.search.substr(1).match(reg); \r\n        if (r != null) return unescape(r[2]); return null; \r\n    },\r\n\r\n    agreements: function () {\r\n        this.agreementNode.active = true;\r\n        //this.agreementLabel.string = cc.info1;\r\n        this.agreementLabel.node.y = 0;\r\n    },\r\n\r\n    onDestroy: function () {\r\n      this.socket.receviceMessage = function () {};\r\n    },\r\n\r\n    _loadingLabel:function(label){\r\n        this.label.string = label;\r\n    },\r\n\r\n    sendLoginRequest:function(data) {\r\n        //this.showWaitingMessage('登录中...');\r\n        this.loadingNode.parent.active = true;\r\n        this.loadingNode.runAction(cc.repeatForever(cc.rotateBy(2, 360)));\r\n        //return;\r\n        this.socket.sendMessage('login',data);\r\n    },\r\n\r\n    loginAction:function() {\r\n        if (!cc.sys.isNative){\r\n            var info = manager.getUserInfo();\r\n            if (info.length > 0) {\r\n                //this.showWaitingMessage('已存有账号=====');\r\n                //return;\r\n            }else\r\n            {\r\n                //this.showWaitingMessage('新账号=====');\r\n                var userInfo = this.getGuestUserInfo();\r\n                manager.setUserInfo(userInfo);\r\n            }\r\n        }\r\n\r\n        var info = manager.getUserInfo();\r\n        if (info.length > 0) {\r\n          var data = JSON.parse(info);\r\n          this.sendLoginRequest(data);\r\n          return;\r\n        }\r\n        if (!cc.sys.isNative){\r\n            // cc.sys.openURL(HREF);\r\n            window.location.href = HREF;\r\n        }else{\r\n          if (KQNativeInvoke.isNativeIOS()) {\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxLogin\");//IOS\r\n          } else if (KQNativeInvoke.isNativeAndroid()) {//Android\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"wxLogin\", \"()V\");\r\n          }\r\n        }\r\n        \r\n    },\r\n\r\n    changeGuestUserInfo:function()\r\n    {\r\n        manager.setUserInfo('');\r\n        this.loginAction();\r\n    },\r\n\r\n    loginYkAction:function() {\r\n        //var comp = this.selectNode.getComponent('select');\r\n        //if (!comp.selected) {\r\n        //    this.showMsg = cc.instantiate(this.alertPrefab);\r\n        //    this.canvasNode.addChild(this.showMsg);\r\n        //    let comp = this.showMsg.getComponent('alert');\r\n        //    comp.setMessage('请同意用户协议');\r\n        //    return;\r\n        //}\r\n        var testDate = new Date();\r\n        var time = \"'\"+testDate.toLocaleString()+\"'\";\r\n        var openid = new Buffer(time).toString('base64');\r\n        var testData = '{\"openid\":\"'+openid+'\",\"nickname\":\"游客\",\"sex\":1,\"language\":\"zh_CN\",\"city\":\"Changsha\",\"province\":\"Hunan\",\"country\":\"CN\",\"headimgurl\":\"http:\\/\\/wx.qlogo.cn\\/mmopen\\/BVyz4R8q6puJibEv1hrsaTmIKQhkaTS9FyvcevvC5hlxFnfOuspDjicG0GtzyJXOhNT7g1WZDeCDQhnRdEOgz3QMnP0F9iboQGy\\/0\",\"privilege\":[]}';\r\n        var data = JSON.parse(testData);\r\n        this.sendLoginRequest(data);\r\n\r\n    },\r\n\r\n    showWaitingMessage:function(msg) {\r\n        if (this.waitingNode != null && cc.sys.isNative && cc.isValid(this.waitingNode)) {\r\n          if (msg == this.waitingNode.getComponent('alert').getMessage()) {\r\n            return;\r\n          }\r\n            this.waitingNode.removeFromParent();\r\n            this.waitingNode = null;\r\n        }\r\n        this.waitingNode = cc.instantiate(this.waitingPrefab);\r\n        this.canvasNode.addChild(this.waitingNode);\r\n        var comp = this.waitingNode.getComponent('alert');\r\n        //console.log(comp);\r\n\r\n        comp.setMessage(msg);\r\n        comp.alert();\r\n    },\r\n\r\n    hiddenWaitingMessage:function() {\r\n        if (this.waitingNode != null) {\r\n            this.waitingNode.getComponent('alert').dismissAction();\r\n        }\r\n    },\r\n\r\n    protocolAction:function() {\r\n        cc.log('protocol action');\r\n    },\r\n});\r\n"
  ]
}