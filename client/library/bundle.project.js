require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"ArrayExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4fd85NSsFJLd4qHrH0UjHzl', 'ArrayExtension');
// scripts\Extensions\ArrayExtension.js

// 给 Array 添加方法
// arr.find(...)
// arr.findIndex(...)
// arr.includes(e)
// arr.unique(equalFunction, isNewArray)
// Array.from
// Array.equal
// arr.isEqual(otherArray, isStrict)
// Array.sortByNumber
// arr.findSubArrayIndexs([])   用于查找数组内的部分元素的索引
// arr.translationWithStartIndex(startIndex) 将数组内的元素平移
// 如：[1, 2, 3, 4, 5].translationWithStartIndex(3) => [4,5,1,2,3]
// arr.kq_insert(index, e)   插入一个元素
// arr.kq_excludes(array)   // 除了array数组中的元素

module.exports = {};

if (!Array.prototype.find) {
  Array.prototype.find = function (predicate) {
    'use strict';
    if (this == null) {
      throw new TypeError('Array.prototype.find called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return value;
      }
    }
    return undefined;
  };
}

if (!Array.prototype.findIndex) {
  Array.prototype.findIndex = function (predicate) {
    if (this === null) {
      throw new TypeError('Array.prototype.findIndex called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return i;
      }
    }
    return -1;
  };
}

// https://tc39.github.io/ecma262/#sec-array.prototype.includes
if (!Array.prototype.includes) {
  Object.defineProperty(Array.prototype, 'includes', {
    enumerable: false,
    value: function value(searchElement, fromIndex) {

      // 1. Let O be ? ToObject(this value).
      if (this == null) {
        throw new TypeError('"this" is null or not defined');
      }

      var o = Object(this);

      // 2. Let len be ? ToLength(? Get(O, "length")).
      var len = o.length >>> 0;

      // 3. If len is 0, return false.
      if (len === 0) {
        return false;
      }

      // 4. Let n be ? ToInteger(fromIndex).
      //    (If fromIndex is undefined, this step produces the value 0.)
      var n = fromIndex | 0;

      // 5. If n ≥ 0, then
      //  a. Let k be n.
      // 6. Else n < 0,
      //  a. Let k be len + n.
      //  b. If k < 0, let k be 0.
      var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

      // 7. Repeat, while k < len
      while (k < len) {
        // a. Let elementK be the result of ? Get(O, ! ToString(k)).
        // b. If SameValueZero(searchElement, elementK) is true, return true.
        // c. Increase k by 1.
        // NOTE: === provides the correct "SameValueZero" comparison needed here.
        if (o[k] === searchElement) {
          return true;
        }
        k++;
      }

      // 8. Return false
      return false;
    }
  });
}

// unique
if (!Array.prototype.unique) {
  Object.defineProperty(Array.prototype, 'unique', {
    enumerable: false,
    value: function value(equalFunction) {
      var newArray = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

      if (newArray) {
        return this._unqiue_new(equalFunction);
      }

      return this._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue_new', {
    enumerable: false,
    value: function value(equalFunction) {
      var array = Array.from(this);

      return array._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue', {
    enumerable: false,
    value: function value(equalFunction) {
      var len = this.length;
      var i = -1;

      while (i++ < len) {
        var j = i + 1;

        for (; j < this.length; ++j) {
          var isEqual = false;
          if (equalFunction) {
            isEqual = equalFunction(this[i], this[j]);
          } else {
            isEqual = this[i] === this[j];
          }

          if (isEqual) {
            this.splice(j--, 1);
          }
        }
      }
      return this;
    }
  });
}

// Production steps of ECMA-262, Edition 6, 22.1.2.1
// Reference: https://people.mozilla.org/~jorendorff/es6-draft.html#sec-array.from
if (!Array.from) {
  Array.from = (function () {
    var toStr = Object.prototype.toString;
    var isCallable = function isCallable(fn) {
      return typeof fn === 'function' || toStr.call(fn) === '[object Function]';
    };
    var toInteger = function toInteger(value) {
      var number = Number(value);
      if (isNaN(number)) {
        return 0;
      }
      if (number === 0 || !isFinite(number)) {
        return number;
      }
      return (number > 0 ? 1 : -1) * Math.floor(Math.abs(number));
    };
    var maxSafeInteger = Math.pow(2, 53) - 1;
    var toLength = function toLength(value) {
      var len = toInteger(value);
      return Math.min(Math.max(len, 0), maxSafeInteger);
    };

    // The length property of the from method is 1.
    return function from(arrayLike /*, mapFn, thisArg */) {
      // 1. Let C be the this value.
      var C = this;

      // 2. Let items be ToObject(arrayLike).
      var items = Object(arrayLike);

      // 3. ReturnIfAbrupt(items).
      if (arrayLike == null) {
        throw new TypeError("Array.from requires an array-like object - not null or undefined");
      }

      // 4. If mapfn is undefined, then let mapping be false.
      var mapFn = arguments.length > 1 ? arguments[1] : void undefined;
      var T;
      if (typeof mapFn !== 'undefined') {
        // 5. else
        // 5. a If IsCallable(mapfn) is false, throw a TypeError exception.
        if (!isCallable(mapFn)) {
          throw new TypeError('Array.from: when provided, the second argument must be a function');
        }

        // 5. b. If thisArg was supplied, let T be thisArg; else let T be undefined.
        if (arguments.length > 2) {
          T = arguments[2];
        }
      }

      // 10. Let lenValue be Get(items, "length").
      // 11. Let len be ToLength(lenValue).
      var len = toLength(items.length);

      // 13. If IsConstructor(C) is true, then
      // 13. a. Let A be the result of calling the [[Construct]] internal method of C with an argument list containing the single item len.
      // 14. a. Else, Let A be ArrayCreate(len).
      var A = isCallable(C) ? Object(new C(len)) : new Array(len);

      // 16. Let k be 0.
      var k = 0;
      // 17. Repeat, while k < len… (also steps a - h)
      var kValue;
      while (k < len) {
        kValue = items[k];
        if (mapFn) {
          A[k] = typeof T === 'undefined' ? mapFn(kValue, k) : mapFn.call(T, kValue, k);
        } else {
          A[k] = kValue;
        }
        k += 1;
      }
      // 18. Let putStatus be Put(A, "length", len, true).
      A.length = len;
      // 20. Return A.
      return A;
    };
  })();
}

if (!Array.equal) {
  Array.equal = function (arr1, arr2) {
    var strict = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (arr1 === undefined || arr2 === undefined) {
      return false;
    }

    var length = arr1.length;
    if (length !== arr2.length) return false;
    for (var i = 0; i < length; i++) {
      if (strict) {
        if (arr1[i] !== arr2[i]) {
          return false;
        }
      } else {
        var value1 = arr1[i];
        var value2 = arr2[i];
        var result = true;
        if (Array.isArray(value1) && Array.isArray(value2)) {
          result = Array.equal(value1, value2, strict);
        } else {
          result = value1 == value2;
        }
      }
    }

    return true;
  };
}

if (!Array.prototype.isEqual) {
  Object.defineProperty(Array.prototype, 'isEqual', {
    enumerable: false,
    value: function value(otherArray) {
      var strict = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

      return Array.equal(this, otherArray, strict);
    }
  });
}

if (!Array.sortByNumber) {
  Array.sortByNumber = function (n1, n2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    return (n1 - n2) * (asc ? 1 : -1);
  };
}

if (!Array.prototype.findSubArrayIndexs) {
  Object.defineProperty(Array.prototype, 'findSubArrayIndexs', {
    enumerable: false,
    value: function value(subArray, f) {
      var _this = this;

      var indexs = [];

      var _loop = function () {
        var subValue = subArray[i];
        var findFunc = f || function (thisValue) {
          return subValue === thisValue;
        };
        var index = _this.findIndex(findFunc);
        if (index >= 0) {
          indexs.push(index);
        } else {
          indexs = [];
          return 'break';
        }
      };

      for (var i in subArray) {
        var _ret = _loop();

        if (_ret === 'break') break;
      }

      return indexs.length > 0 ? indexs : null;
    }
  });
}

if (!Array.prototype.translationWithStartIndex) {
  Object.defineProperty(Array.prototype, 'translationWithStartIndex', {
    enumerable: false,
    value: function value(startIndex) {
      if (startIndex == 0) {
        return this;
      }

      if (startIndex >= this.length) {
        return this;
      }

      var pre = this.slice(startIndex);
      var last = this.slice(0, startIndex);
      var result = pre.concat(last);

      return result;
    }
  });
}

if (!Array.prototype.kq_insert) {
  Object.defineProperty(Array.prototype, 'kq_insert', {
    enumerable: false,
    value: function value(index, e) {
      if (e == null) {
        return this;
      }

      if (index >= this.length) {
        this.push(e);
        return;
      }

      this.splice(index, 0, e);

      return this;
    }
  });
}

if (!Array.prototype.kq_excludes) {
  Object.defineProperty(Array.prototype, 'kq_excludes', {
    enumerable: false,
    value: function value(otherArray) {
      if (otherArray == null) {
        return this;
      }

      var result = [];
      this.forEach(function (element) {
        if (!otherArray.includes(element)) {
          result.push(element);
        }
      });

      return result;
    }
  });
}

/*
if(!Array.prototype.min){
  Array.prototype.min = function() {
    var min = this[0];
    var len = this.length;
    for (var i = 1; i < len; i++) {
      if (this[i] < min) {
        min = this[i];
      }
    }
    return min;
  }
}*/

cc._RFpop();
},{}],"AudioManager":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd5deKFuSZAC4Ky0zI4+z6O', 'AudioManager');
// scripts\Audio\AudioManager.js

var manager = require('manager');

var AudioManager = cc.Class({
    "extends": cc.Component,

    properties: {
        hall_bgm: {
            "default": null,
            url: cc.AudioClip
        },

        // 打枪
        daQiang: {
            "default": null,
            url: cc.AudioClip
        },

        fapai: {
            "default": null,
            url: cc.AudioClip
        },

        window: {
            "default": null,
            url: cc.AudioClip
        },

        click_weixin_login: {
            "default": null,
            url: cc.AudioClip
        },

        fangPai: {
            "default": null,
            url: cc.AudioClip
        }

    },

    statics: {
        instance: null
    },

    onLoad: function onLoad() {
        AudioManager.instance = this;
        this._registerAppActiveChange();

        this.soundOn = true;
        cc.game.addPersistRootNode(this.node);
        if (cc.game.isPersistRootNode(this.node)) {
            // cc.log('添加全局节点成功');
        }
        this.mValue = manager.getMusicValue();
        this.mEValue = manager.getMusicEffectValue();
        this.bgAudioId = -1;
    },

    stopHallMusic: function stopHallMusic() {
        cc.audioEngine.stop(this.bgAudioId);
    },

    playMusic: function playMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.hall_bgm, true);
        if (this.bgAudioId != -1) {
            //cc.log('play');
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
        //cc.audioEngine.playMusic( url, true )
    },

    playCompareCardsMusic: function playCompareCardsMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.hall_bgm, true);
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
    },

    playDaQiang: function playDaQiang() {
        for (var start = 0; start <= 1.6; start = start + 0.5) {
            this.scheduleOnce((function () {
                this._playSFX(this.daQiang);
            }).bind(this), start);
        }
    },

    // “打枪”
    playHumanDaQiang: function playHumanDaQiang() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = "resources/sounds/man" /* + (sex == 1 ? "man" : "woman")*/;
        path = path + "/daqiang1.mp3";

        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // “中枪”
    playHumanZQiang: function playHumanZQiang() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = "resources/sounds/man" /* + (sex == 1 ? "man" : "woman")*/;
        path = path + "/daqiang3.mp3";

        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playPokerClick: function playPokerClick() {
        var url = cc.url.raw('resources/sounds/public/click_wx_login.mp3');
        this._playSFX(url);
    },

    // 播放全垒打音效
    playHomeRun: function playHomeRun() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "special1.mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放发牌音效
    playFaPai: function playFaPai() {
        var path1 = this._soundsHumanPath(1) + "room_start_compare.mp3";
        var url1 = cc.url.raw(path1);
        this._playSFX(url1);
        //let pokerDeal = this._soundsHumanPath(1) + "poker_deal.mp3";
        //let urlPokerDeal = cc.url.raw(pokerDeal);
        //this._playSFX(urlPokerDeal);
        this._playSFX(this.fapai);
        for (var index = 0; index < 6; index++) {
            this.scheduleOnce((function () {
                this._playSFX(this.fapai);
            }).bind(this), index * 0.1);
        }
    },

    playCardType: function playCardType() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];
        var type = arguments.length <= 1 || arguments[1] === undefined ? -1 : arguments[1];

        // 只播放普通类型的语音
        if (type >= 10 || type < 0) {
            // 10 及以上是特殊牌
            var _path = this._soundsHumanPath(sex) + type + ".mp3";
            var _url = cc.url.raw(_path);
            this._playSFX(_url);
            return;
        }

        var path = this._soundsHumanPath(sex) + "common" + (type + 1) + ".mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放 开始比牌
    playStartCompare: function playStartCompare() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "start_compare.mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playWin: function playWin() {
        var url = cc.url.raw('resources/sounds/openface/win.mp3');
        this._playSFX(url);
    },

    playLose: function playLose() {
        var url = cc.url.raw('resources/sounds/openface/lose.mp3');
        this._playSFX(url);
    },

    coinIncome: function coinIncome() {
        var url = cc.url.raw('resources/sounds/openface/coin_income.mp3');
        this._playSFX(url);
    },

    _soundsHumanPath: function _soundsHumanPath(sex) {
        var path = "resources/sounds/man/" /* + (sex == 1 ? "man" : "woman") + "/"*/;
        return path;
    },

    setBgMusicVolumn: function setBgMusicVolumn(value) {
        this.mValue = value;
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, value);
        }
    },

    setEffectMusicVolum: function setEffectMusicVolum(value) {
        this.mEValue = value;
    },

    /*聊天*/
    playChatAudio: function playChatAudio(sex, str) {
        var index = this.chatTexts().indexOf(str);
        if (index === -1) {
            return;
        }
        var number = "CHAT" + (index + 1);
        var path = "resources/sounds/chat/" + number + ".mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    chatTexts: function chatTexts() {
        return ['还不出牌，我都快去吃锅边糊了', '嗨呀，我家里老人都比你打的快', '嗨呀，打牌打的我都困了', '哎，你快慢慢找，我先去西湖逛一下', '快一点呀，我等你想好我厕所都上一趟了', '你这在干嘛，这么慢', '嗨呀，最近在忙什么，很久没见了', '来来来，三缺一', '来来来，赶紧坐下来打一圈', '跟你们这些高手打我会紧张，让我一点', '蛮晚到天亮，输了可以让你们先欠着'];
    },

    pauseMusic: function pauseMusic() {
        this.soundOn = false;
        cc.audioEngine.pauseMusic();
    },

    resumeMusic: function resumeMusic() {
        this.soundOn = true;
        cc.audioEngine.resumeMusic();
    },

    _playSFX: function _playSFX(clip) {
        if (this.soundOn) {
            var audioId = cc.audioEngine.playEffect(clip, false);
            cc.audioEngine.setVolume(audioId, this.mEValue);
            return audioId;
        }

        return null;
    },

    // MARK: 前后台操作
    _registerAppActiveChange: function _registerAppActiveChange() {
        cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
        cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
    },

    /**
     * 进入后台
     */
    _appEnterBackground: function _appEnterBackground() {
        var now = cc.sys.now();
        if (now - this._lastAppEnterBackgroundTime < 100) {
            return;
        }
        this._lastAppEnterBackgroundTime = now;

        this.pauseMusic();
    },

    /**
     * 进入前台
     */
    _appBecomActive: function _appBecomActive() {
        var now = cc.sys.now();
        if (now - this._lastAppBecomActiveTime < 100) {
            return;
        }
        this._lastAppBecomActiveTime = now;

        this.resumeMusic();
    },

    /*确定按钮音效*/
    playBtnClickSFX: function playBtnClickSFX() {
        this._playSFX(this.click_weixin_login);
    },
    /*公共按钮，按键或者关闭按钮之类的音效*/
    palyBtnPublicSFX: function palyBtnPublicSFX() {
        this._playSFX(this.click_weixin_login);
    },

    /*取消按钮音效*/
    palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyWindowSFX: function palyWindowSFX() {
        this._playSFX(this.window);
    },
    palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyFangPaiSFX: function palyFangPaiSFX() {
        this._playSFX(this.fangPai);
    }

});

module.exports = AudioManager;

cc._RFpop();
},{"manager":"manager"}],"CardPrefab":[function(require,module,exports){
"use strict";
cc._RFpush(module, '94cdbrbPc9KRqx+1sHumWI3', 'CardPrefab');
// scripts\CardPrefab.js

var KQCard = require('KQCard');

cc.Class({
  'extends': cc.Component,

  properties: {
    graySprite: cc.Sprite,

    _cardName: null,
    _kqCardMode: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.graySprite.node.active = false;
  },

  // 通过牌名设置牌
  setCard: function setCard(cardName) {
    this._setCardName(cardName);

    this._loadCardFrame(cardName, (function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }).bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._kqCardMode;
  },

  _setCardName: function _setCardName(cardName) {
    this._cardName = cardName;
    this._kqCardMode = new KQCard(cardName);
  },

  // 设置选择状态
  setSelected: function setSelected() {
    var selected = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.graySprite.node.active = selected;
  },

  isSelected: function isSelected() {
    return this.graySprite.node.active;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"CardTypeCombine":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45c41vwAhFNYYSXDvaKpEP0', 'CardTypeCombine');
// scripts\CardTypeCombine.js

var _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var AudioManager = require('AudioManager');
var play = require('play');
var KQCardScoretsHelper = require('KQCardScoretsHelper');
// 牌类型 component
//
cc.Class({
    'extends': cc.Component,
    statics: {
        instances: null
    },
    properties: {
        cardsLayout: cc.Layout,
        // btnDuiZi: cc.Button,
        // btnLiangDui: cc.Button,
        // btnSanTiao: cc.Button,
        // btnShunZi: cc.Button,
        // btnTongHua: cc.Button,
        // btnHuLu: cc.Button,
        // btnTieZhi: cc.Button,
        // btnTongHuaShun: cc.Button,
        // btnWuTong: cc.Button,
        // typeButtonsNode: cc.Node,
        btnDeleteTouDao: cc.Button, // 头道
        btnDeleteZhongDao: cc.Button, // 中道
        btnDeleteWeiDao: cc.Button, // 尾道
        btnCancelAll: cc.Button, // 全部取消
        btnDone: cc.Button, // 确定出牌
        timeNode: cc.Node,
        labelTime: cc.Label,
        layoutTouDao: cc.Layout,
        layoutZhongDao: cc.Layout,
        layoutWeiDao: cc.Layout,
        cardAllNode: cc.Node,
        cardPrefab: cc.Prefab,
        cardTypePrefab: cc.Prefab,

        touDaoNode: cc.Node,
        zhongDaoNode: cc.Node,
        weiDaoNode: cc.Node,

        autoCardScrollView: cc.ScrollView,
        autoCard: cc.Prefab,
        autoCardLayout: cc.Layout,
        autoCardAnimation: cc.Node,

        LayoutWithEvent: [],

        BtnClickGongXiNiComfirm: false, //用于检查用户是否点击了恭喜你页面的确定按钮
        cardsLayoutSortColor: false,
        /*#####*/

        _cardOffsetY: null,

        _kqCardModes: [],
        _allCardModes: [],
        _findCardTypeObject: null, // 用来记录找到的牌型对象
        _findCardIndex: null, // 用来记录找到的牌型对象

        _finishSelectCardsCallback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.BtnClickGongXiNiComfirm = false;
        this.cardsLayoutSortColor = false;
        this._cardOffsetY = 0;
        this._registerTouchEvents();
        this._registerDaosLayoutClickEvent();
        this.reset();
        this._findCardIndex = {};
        this.cardTime = 0.3;

        this.cardSpriteAtlas = this.node.parent.getComponent('play').cardSpriteAtlas;
        this.daoSpriteAtlas = this.node.parent.getComponent('play').daoSpriteAtlas;
    },

    /*#####点击空白地方将牌收回去*/
    onClickCardTypeCombineNode: function onClickCardTypeCombineNode() {
        this._resetCardsPositionY();
    },

    _hideDeleteButtons: function _hideDeleteButtons() {
        //this.btnDeleteTouDao.node.active = false;
        //this.btnDeleteZhongDao.node.active = false;
        //this.btnDeleteWeiDao.node.active = false;
    },

    // 重置，回到最初始有状态
    reset: function reset() {
        this._hideDeleteButtons();
        this.clearCards();
        this.timeStop();
        //this._typeButtons().forEach(function (button) {
        //    button.interactable = false;
        //});
        this._allCardModes = [];
    },

    cardsLayoutSort: function cardsLayoutSort(e) {
        var nodeAyy = e.target.children;
        if (nodeAyy[0].active == true) {
            //按大小
            this.cardsLayoutSortColor = true;
            nodeAyy[0].active = false;
            nodeAyy[1].active = true;
            this._resetCardsPositionX();
            return;
        } else if (nodeAyy[1].active == true) {
            //按花色
            this.cardsLayoutSortColor = false;
            nodeAyy[0].active = true;
            nodeAyy[1].active = false;
            this._resetCardsPositionX();
        }
        //this.cardsLayoutSortColor = nodeAyy[1].active == false;
        //this.cardsLayoutSortColor == true
    },

    addCards: function addCards(cardNames) {
        cc.assert(cardNames);
        this._resetCardsPositionY();
        //cardNames.sort(function(a1,a2){
        //    return a1.split('_')[0] - a2.split('_')[0];
        //})
        cardNames.forEach((function (card, index) {
            this.addCard(card, false, index);
        }).bind(this));
        //this.cardsLayoutSort();
        this._resetCardsPositionX();
        this._reloadKQCardModesInner();
        this._resetTypeButtonEnablesWithModels(this._kqCardModes);
    },

    addCard: function addCard(cardName) {
        var autoChangePositionX = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var index = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];

        cc.assert(cardName.length > 0);

        var cardPrefab = cc.instantiate(this.cardPrefab);
        cardPrefab.name = cardName;
        // if(cc.maPai){
        //     var cardMaPai = '3_' + cc.maPai;
        //     if(cardName == cardMaPai){
        //         cardPrefab.color = new cc.Color(226, 145, 145);
        //     }
        // }
        cardPrefab.getComponent('CardPrefab').setCard(cardName, index);
        this.cardsLayout.node.addChild(cardPrefab);
        cardPrefab.setPositionY(this._cardOffsetY);

        if (autoChangePositionX) {
            this._resetCardsPositionX();
        }
        //let newCard = new KQCard(cardName,null,index);
        //let originCard = this._allCardModes.find(function(card) {
        //    return card.isEqual(newCard);
        //});
        //if (originCard == null && !autoChangePositionX) {
        //    this._allCardModes.push(newCard);
        //}
    },

    addCardModes: function addCardModes(cardNames) {
        cc.assert(cardNames.length > 0);
        this._allCardModes = [];
        cardNames.forEach((function (cardName, index) {
            var newCard = new KQCard(cardName, null, index);
            this._allCardModes.push(newCard);
        }).bind(this));
    },

    reloadCards: function reloadCards(cardNames) {
        //cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //三度同花
        // cardNames=['2_13', '2_5', '2_7', '3_1', '3_2', '3_4', '3_3', '3_13', '1_12', '1_6', '1_1', '1_4', '1_5'];
        //三同花顺
        //  cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '4_1', '4_2', '4_3'];
        //一条龙
        // cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '1_11', '1_12', '1_13'];
        //三顺子
        //cardNames=['4_1', '3_2', '4_3', '1_7', '4_5', '4_6', '3_9', '4_8', '3_1', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_9', '3_9', '4_8', '3_10', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_5', '3_6', '4_8', '3_6', '1_13', '4_12', '4_11', '2_7'];
        //cardNames=['3_4', '3_4', '4_6', '2_20', '1_20', '1_20', '3_6', '4_8', '3_6', '1_8', '4_12', '4_11', '2_20'];
        //三丰天下
        //cardNames=['1_1', '2_1', '3_1', '1_2', '2_2', '3_2', '4_1', '4_2', '3_3', '2_3', '1_3', '4_3', '1_13'];
        //4丰天下
        // cardNames=['1_1', '2_1', '3_1', '1_4', '2_4', '3_2', '4_2', '1_2', '3_4', '2_3', '1_3', '4_3', '1_2'];
        //六岁半
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //cardNames=['1_9', '2_11', '3_8', '1_12', '2_2', '3_2', '1_13', '2_5', '3_5','1_4', '2_4', '3_4', '3_10'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //   cardNames=['4_2', '2_3', '3_4', '3_5', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //cardNames=['4_1', '2_1', '1_4', '3_4', '1_6', '2_6', '1_8', '3_8', '2_8','2_12', '1_12', '2_13', '3_13'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_8', '2_9', '2_10', '2_11', '2_13','3_13', '3_12', '2_12', '1_12'];
        // cardNames=['4_9', '2_9', '3_4', '3_6', '1_8', '2_1', '2_5', '2_4', '2_3','3_13', '3_12', '2_2', '1_12'];
        //cardNames=['3_2', '4_2', '2_4', '3_5', '1_5', '3_7', '2_7', '3_10', '2_1','2_13', '2_10', '2_12', '2_11'];
        //cardNames=['4_2', '4_3', '4_4', '4_5', '4_5', '4_6', '4_12', '4_13', '2_12','3_12', '2_8', '3_8', '2_11'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '3_5', '2_5', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '2_20', '1_20', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_3', '3_4', '4_6', '4_5', '2_7', '1_20', '1_3', '4_4', '3_6','4_7', '4_8', '2_12', '1_12'];
        cc.log(cardNames);
        this.clearCards();
        this._kqCardModes = [];
        this.addCards(cardNames);
    },

    clearCards: function clearCards() {
        this.cardsLayout.node.removeAllChildren();
        this.layoutTouDao.node.removeAllChildren();
        this.layoutZhongDao.node.removeAllChildren();
        this.layoutWeiDao.node.removeAllChildren();
    },

    removeCard: function removeCard(cardName) {
        if (!cardName.length) {
            return;
        }

        this.cardsLayout.node.getChildByName(cardName).removeFromParent();
    },

    setFinishSelectCardsCallback: function setFinishSelectCardsCallback(callback) {
        this._finishSelectCardsCallback = callback;
        this.node.active = false;
    },

    _reloadKQCardModesInner: function _reloadKQCardModesInner() {
        //this._kqCardModes = this.cardsLayout.node.children.map(function (cardPrefabNode) {
        //    let cardPrefab = cardPrefabNode.getComponent('CardPrefab');
        //    return cardPrefab.cardMode();
        //}).sort(KQCard.sort);
        //this._findCardTypeObject = null;
    },

    _typeButtons: function _typeButtons() {
        //return [
        //    this.btnDuiZi,
        //    this.btnLiangDui,
        //    this.btnSanTiao,
        //    this.btnShunZi,
        //    this.btnTongHua,
        //    this.btnHuLu,
        //    this.btnTieZhi,
        //    this.btnTongHuaShun,
        //    /*#####*/
        //    //this.btnWuTong,
        //    /*#####*/
        //];
    },

    _resetTypeButtonEnablesWithModels: function _resetTypeButtonEnablesWithModels(cardModes) {
        /*cardModes.length == 13*/
        //cardModes = cardModes || this._kqCardModes;
        //
        ///*#####初始化牌*/
        //var ButtonsLayoutChilds = this.typeButtonsNode.children;
        //for(var i=0;i<ButtonsLayoutChilds.length;i++){
        //    ButtonsLayoutChilds[i].interactable = false;
        //}
        //
        //this.btnDuiZi.interactable = KQCard.containDuiZi(cardModes);
        //this.btnLiangDui.interactable = KQCard.containLiaDui(cardModes);
        //this.btnSanTiao.interactable = KQCard.containSanTiao(cardModes);
        //this.btnShunZi.interactable = KQCard.containShunZi(cardModes);
        //this.btnTongHua.interactable = KQCard.containTongHua(cardModes);
        //this.btnHuLu.interactable = KQCard.containHuLu(cardModes);
        //this.btnTieZhi.interactable = KQCard.containTieZhi(cardModes);
        //this.btnTongHuaShun.interactable = KQCard.containTongHuaShun(cardModes);
        ////this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        ////KQCard.isTeShuPai(cardModes)
        ////let typeName = KQCard.cardsTyp-eName(cardModes);
        ////KQCard.isLiuDuiBan(cardModes);
        ////alert(this.btnShunZi.interactable)
        ///*#####如果有多一色，就是设置无同按钮的可交互性*/
        ////if(cc.duoYiSe == 0) {
        ////    this.wuTongNode = this.typeButtonsNode.getChildByName("btnWuTong");
        ////    this.btnWuTong = this.wuTongNode.getComponent(cc.Button);
        ////    this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        ////}
        ///*#####*/
        //
        //this._autoActiveTypeButtons();
        //
        ///*#####设置按钮可交互和不可交互时的透明度*/
        //for(var i=0;i<ButtonsLayoutChilds.length;i++){
        //    if(ButtonsLayoutChilds[i].getComponent(cc.Button).interactable){
        //        ButtonsLayoutChilds[i].opacity = 255;
        //    }else{
        //        ButtonsLayoutChilds[i].opacity = 125;
        //    }
        //}
    },

    // 将找到了牌类型的牌突出出来
    _stickOutFindCardType: function _stickOutFindCardType(title, findMethods) {

        // 先根据牌类型找出所有的索引集合
        //var findedIndexsArray = null;
        //this._findCardTypeObject = this._findCardTypeObject || {};
        //if (this._findCardTypeObject.title != title) {
        //    findedIndexsArray = (findMethods() || []).reverse();
        //
        //    for(var i =0;i<findedIndexsArray.length-1;i++){//删除同类型牌
        //        var index = findedIndexsArray[i];
        //        /*if(title == 'liangDui'){
        //         let jStringspoint = index.map(function(indexs){
        //         return this._kqCardModes[indexs].point;
        //         }.bind(this));
        //         var isBreak = false;
        //         var repNum = jStringspoint.reduce(function(p,n){
        //         if(!p[n]){
        //         p[n] = 1;
        //         }else{
        //         p[n] += 1
        //         }
        //         return p
        //         },{});
        //         for(var y in repNum){
        //         if(repNum[y] >= 3){
        //         isBreak = true;
        //         }
        //         }
        //         if(isBreak){
        //         cc.log(repNum)
        //         cc.log(findedIndexsArray)
        //         cc.log(i)
        //         cc.log('--------291')
        //         findedIndexsArray.splice(i,1);
        //         continue;
        //         }
        //         }*/
        //        var iString = '';
        //        for(var j =i+1;j<findedIndexsArray.length;j++){
        //            var s = findedIndexsArray[j];
        //            var jString = '';
        //
        //            let iStrings = s.map(function(index){
        //                let cardModel = this._kqCardModes[index];
        //                return cardModel.cardName();
        //            }.bind(this));
        //
        //            let jStrings = index.map(function(indexs){
        //                let cardModel = this._kqCardModes[indexs];
        //                return cardModel.cardName();
        //            }.bind(this));
        //
        //
        //            for(var r = 0;r < index.length;r++){
        //                jString = jString + iStrings[r];
        //                iString = iString + jStrings[r];
        //            }
        //
        //            if(jString == iString){
        //                findedIndexsArray.splice(i,1);
        //                break;
        //            }
        //        }
        //    }
        //
        //    this._findCardTypeObject = {
        //        title: title,
        //        indexsArray: findedIndexsArray,
        //        //index: title=="duiZi"?findedIndexsArray.length-1:0
        //        index: 0
        //    };
        //}
        //
        //findedIndexsArray = this._findCardTypeObject.indexsArray;
        //if (!findedIndexsArray || findedIndexsArray.length == 0) {
        //    return;
        //}
        //// 将已有的突出的牌的位置重置回初始位置
        //this._resetCardsPositionY();
        //
        //// 计算出要突出的牌数组
        //var index = this._findCardTypeObject.index;
        //let indexs = findedIndexsArray[index];
        //
        //let selectedCardNames = indexs.map(function(index){
        //    let cardModel = this._kqCardModes[index];
        //    return cardModel.cardName();
        //}.bind(this));
        //
        //let cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {
        //    let cardPrefab = cardNode.getComponent('CardPrefab');
        //    if(selectedCardNames.includes(cardPrefab.cardName())) {
        //        var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());
        //        selectedCardNames.splice(nameIndex,1);
        //        return true;
        //    }
        //    return false;
        //});

        //// 突出计算出来的牌数组
        //this._changeCardPrefabsY(cardNodes);
        //// 保存好，用于再次点击了突出下一组牌
        //index = (index + 1) % findedIndexsArray.length;
        //this._findCardTypeObject.index = index;
    },

    clickDuiZi: function clickDuiZi() {
        this._stickOutFindCardType("duiZi", (function () {
            return KQCard.findDuiZi(this._kqCardModes);
        }).bind(this));
    },

    clickLiangDui: function clickLiangDui() {
        this._stickOutFindCardType("liangDui", (function () {
            return KQCard.findLiaDui(this._kqCardModes);
        }).bind(this));
    },

    clickSanTiao: function clickSanTiao() {
        this._stickOutFindCardType("sanTiao", (function () {
            return KQCard.findSanTiao(this._kqCardModes);
        }).bind(this));
    },

    clickShunZi: function clickShunZi() {
        this._stickOutFindCardType("shunZi", (function () {
            return KQCard.findShunZi(this._kqCardModes);
        }).bind(this));
    },

    clickTongHua: function clickTongHua() {
        this._stickOutFindCardType("tongHua", (function () {
            return KQCard.findTongHua(this._kqCardModes);
        }).bind(this));
    },

    clickHuLu: function clickHuLu() {
        this._stickOutFindCardType("huLu", (function () {
            return KQCard.findHuLu(this._kqCardModes);
        }).bind(this));
    },

    clickTieZhi: function clickTieZhi() {
        this._stickOutFindCardType("tieZhi", (function () {
            return KQCard.findTieZhi(this._kqCardModes);
        }).bind(this));
    },

    /*#####*/
    clickWuTong: function clickWuTong() {
        this._stickOutFindCardType("wuTong", (function () {
            return KQCard.findWuTong(this._kqCardModes);
        }).bind(this));
    },
    /*#####*/

    clickTongHuaShun: function clickTongHuaShun() {
        this._stickOutFindCardType("tongHuaShun", (function () {
            return KQCard.findTongHuaShun(this._kqCardModes);
        }).bind(this));
    },

    clickCancelAll: function clickCancelAll() {
        this.clickDeleteTouDao();
        this.clickDeleteZhongDao();
        this.clickDeleteWeiDao();
    },

    /*点击完成按钮*/
    clickDone: function clickDone() {
        cc.sys.localStorage.removeItem("timestamp");
        this.cardAlls = this.cardAllNode.children.sort(function (a, b) {
            return b.y - a.y;
        }).map(function (i) {
            return i.children[0];
        });

        var touCardModels = this._taoDaoCardModes();
        var zhongCardModes = this._zhongDaoCardModes();
        var weiCardModes = this._weiDaoCardModes();
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    /*点击恭喜你页面的确定按钮*/
    onBtnGongXiNiComfirmClick: function onBtnGongXiNiComfirmClick() {
        //记录玩家点击了确定按钮：
        this.BtnClickGongXiNiComfirm = true;

        var cards = [];

        cc.teShuPaiCards.forEach(function (i) {
            cards = cards.concat(i);
        });

        var teShuPaiCardsServerInfo = this._convertCardsToServerModel2(cards);
        var result = [teShuPaiCardsServerInfo];
        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    _didSelectedCards: function _didSelectedCards(touCards, zhongCards, weiCards) {
        touCards = touCards || [];
        zhongCards = zhongCards || [];
        weiCards = weiCards || [];
        var touServerInfo = this._convertCardsToServerModel(touCards);
        var zhongServerInfo = this._convertCardsToServerModel(zhongCards);
        var weiServerInfo = this._convertCardsToServerModel(weiCards);

        //console.log(touServerInfo);
        //console.log(zhongServerInfo);
        //console.log(weiServerInfo);
        //console.log("---------------------------------512");
        if (!(touServerInfo.value < zhongServerInfo.value && zhongServerInfo.value <= weiServerInfo.value)) {
            this.autoCardAnimation.y = -50;
            this.autoCardAnimation.opacity = 255;
            this.autoCardAnimation.runAction(cc.moveTo(1, cc.p(0, 0)));
            this.scheduleOnce((function () {
                var action = cc.spawn(cc.moveTo(this.cardTime, cc.p(0, 10)), cc.fadeOut(this.cardTime));
                this.autoCardAnimation.runAction(action);
            }).bind(this), 1.5);
            return;
        }
        var result = [touServerInfo, zhongServerInfo, weiServerInfo];
        //return;
        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    clickDeleteTouDao: function clickDeleteTouDao() {
        this._deleteDaoCardsOfLayout(this.layoutTouDao.node);
    },

    clickDeleteZhongDao: function clickDeleteZhongDao() {
        this._deleteDaoCardsOfLayout(this.layoutZhongDao.node);
    },

    clickDeleteWeiDao: function clickDeleteWeiDao() {
        this._deleteDaoCardsOfLayout(this.layoutWeiDao.node);
    },

    // 计时器事件
    timeStart: function timeStart(duration) {
        cc.assert(duration > 0);
        this.timeStop();
        this.timeNode.active = true;
        var timestamp = cc.sys.localStorage.getItem("timestamp"); // 获取本地存储的时间戳
        if (timestamp) {
            // 如果有则证明玩家是重新进来了的
            var now = Date.parse(new Date());
            var time = duration * 1000;
            if (now - timestamp > time) {
                // 超时
                if (now - timestamp < 2 * time) {
                    duration = 5; // 玩家可能出于其他原因退出游戏导致超时，为其提供5秒时间整理牌型（这已经是很仁慈的了）。
                } else {
                        cc.sys.localStorage.removeItem("timestamp");
                    }
            } else {
                duration = Math.floor(duration - (now - timestamp) / 1000);
            }
        } else {
            // 如果没有时间戳，则保存，为玩家退出游戏保留证据；
            var timestamp = Date.parse(new Date());
            cc.sys.localStorage.setItem('timestamp', timestamp);
        }
        this._timeRemainDuration = duration;
        this.labelTime.string = String(duration);
        this.timeNode.getComponent("time").setTime(duration * 0.5);
        this.schedule(this._timeMethod, 1, duration);
    },

    timeStop: function timeStop() {
        this.unschedule(this._timeMethod);
        this.timeNode.active = false;
    },

    _timeMethod: function _timeMethod() {
        this._timeRemainDuration = this._timeRemainDuration - 1;

        var remain = Math.max(this._timeRemainDuration, 0);
        this.labelTime.string = remain < 10 && remain > 0 ? '0' + remain : remain;

        if (this._timeRemainDuration <= 0) {
            this.timeStop();
            if (cc.chaoShiChuPai == true) this._timeOutAutoSelectCards();
            cc.sys.localStorage.removeItem("timestamp");
            return;
        }
    },

    // 超时后，自动选牌
    _timeOutAutoSelectCards: function _timeOutAutoSelectCards() {
        /**
         * 隐藏恭喜你
         */
        play.gongXiNiShow(false);
        if (typeof cc.teShuPaiCards != "undefined" && cc.teShuPaiCards != null) {
            this.onBtnGongXiNiComfirmClick();
            return;
        }

        //let [touCardModels, zhongCardModes, weiCardModes] = this._cacleAutoSelectedCards();

        var _findCardIndex$arr$0 = _slicedToArray(this._findCardIndex.arr[0], 3);

        var touCardModels = _findCardIndex$arr$0[0];
        var zhongCardModes = _findCardIndex$arr$0[1];
        var weiCardModes = _findCardIndex$arr$0[2];

        if (touCardModels == null || zhongCardModes == null || weiCardModes == null) {
            touCardModels = this._allCardModes.slice(-3);
            zhongCardModes = this._allCardModes.slice(5, 10);
            weiCardModes = this._allCardModes.slice(0, 5);
        }

        // cc.log(touCardModels)
        // cc.log(zhongCardModes)
        // cc.log(weiCardModes)
        // cc.log(this._allCardModes)
        // cc.log("自动选牌 touCardModels zhongCardModes weiCardModes：");
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    _cacleAutoSelectedCards: function _cacleAutoSelectedCards() {
        var cards = this._allCardModes.filter(function (i) {
            return i;
        });
        var resultCards = [];
        for (var i = 1; i < 3; i++) {
            var cardss = KQCard.autoSelectCards(cards, 5);
            cards = cards.kq_excludes(cardss);
            resultCards.push(cardss);
        }
        resultCards.push(cards);
        //let touScore = KQCard.scoreOfCards(resultCards[2]);
        //let zhongScore = KQCard.scoreOfCards(resultCards[1]);
        //let weiScore = KQCard.scoreOfCards(resultCards[0]);
        // cc.log(resultCards)
        // cc.log(this._allCardModes)
        // cc.log("牌分数自动选牌：", touScore, zhongScore, weiScore);
        //let weiCardModes = KQCard.autoSelectCards(cards, 5);
        //cards = cards.kq_excludes(weiCardModes);
        //
        //let zhongCardModes = KQCard.autoSelectCards(cards, 5);
        //
        //let touCardModes = cards.kq_excludes(zhongCardModes);
        //if (touCardModes.length == 3 && zhongCardModes.length == 5 && weiCardModes.length == 5) {
        //    return [touCardModes, zhongCardModes, weiCardModes];
        //}
        if (resultCards[2].length == 3 && resultCards[1].length == 5 && resultCards[0].length == 5) {
            return [resultCards[2], resultCards[1], resultCards[0]];
        }

        return [];
    },

    _convertCardsToServerModel: function _convertCardsToServerModel(cards) {
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = KQCard.scoreOfCards(cards);
        cards = KQCard._typeCardsSortByNumberOfPoints1(cards);
        result.cards = KQCard.convertToServerCards(cards);

        return result;
    },

    /*#####*/
    _convertCardsToServerModel2: function _convertCardsToServerModel2(cards) {
        var convertToServerCards = [];

        cc.teShuPaiCards.forEach(function (cardMode) {
            var arr = [];
            cardMode = KQCard._typeCardsSortByNumberOfPoints(KQCard.cardsFromArray(cardMode));
            cardMode.forEach(function (cca) {
                var point = cca.point == 14 ? 1 : cca.point;
                arr.push({ number: point, suit: cca.color });
            });
            convertToServerCards.push(arr);
        });
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = 0;
        result.cards = convertToServerCards;

        if (result.type >= KQCard.TYPE.SanTaoHua && cc.moshi != 1) {
            // 特殊牌
            result.isContainExtra = true;
        }

        return result;
    },
    /*#####*/
    // 特殊牌里是否还含有特殊牌
    // 包含的情况有：
    // 三桃花 可能含有同花顺
    // 三顺子 可能含有同花顺
    // 六对半 可能含有铁支
    _isContainExtraCardsType: function _isContainExtraCardsType(type, cards) {
        if (type == KQCard.TYPE.SanTaoHua) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.SanShunZi) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.LiuDuiBan) {
            return KQCard.containTieZhi(cards);
        }
        return false;
    },

    // 触摸事件
    _registerTouchEvents: function _registerTouchEvents() {
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_START, this._touchCardLayout.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_MOVE, this._touchCardLayout.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_END, this._touchCardLayoutEnd.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_CANCEL, this._touchCardLayoutEnd.bind(this));
    },
    cacleAutoSelectedCardsIndex: function cacleAutoSelectedCardsIndex(cards) {
        //cc.log('------622')
        var testFind = KQCard.testFind(cards) || [];
        //cc.log('------6221')
        var result = [];
        for (var i = 0; i < testFind.length; i++) {
            var s = testFind[i];
            if (s.length >= 1) {
                for (var j = 0; j < s.length; j++) {
                    //result.push(s[0]);//只取一个
                    result.push(s[j]); //
                }
            }
        }
        return result;
    },

    cacleAutoSelectedCardsArray: function cacleAutoSelectedCardsArray(cards) {
        var indexs = this.cacleAutoSelectedCardsIndex(cards);
        if (indexs.length < 1) {
            return false;
        }
        var selectedCard = [];
        for (var i = 0; i < indexs.length; i++) {
            var s = indexs[i];
            var a = s.map(function (index) {
                return cards[index];
            });
            selectedCard.push(a);
        }
        return selectedCard;
    },

    cacleAutoSelectedCards2: function cacleAutoSelectedCards2() {
        var cards = this._allCardModes.slice();
        var cardsArray = this.cacleAutoSelectedCardsArray(cards);
        var resultArray = [];
        for (var i = 0; i < cardsArray.length; i++) {
            var _s = cardsArray[i] || [];
            var qwer = [];
            for (var j = 1; j < cardsArray.length; j++) {
                var d = cardsArray[j] || [];
                var sC = _s.kq_excludes(d);
                if (sC.length == _s.length && _s.length > 0) {
                    //判断牌相同 即没有重复的
                    qwer = [_s, d];
                }
            }
            if (qwer.length > 1) {
                resultArray.push(qwer);
            }
        }

        //补全计划1
        for (var i = 0; i < resultArray.length; i++) {

            var _s2 = resultArray[i];

            var cardss = this._allCardModes.slice();

            cardss = cardss.kq_excludes(_s2[0]);

            cardss = cardss.kq_excludes(_s2[1]);

            if (cardss.length >= 5) {
                _s2[2] = KQCard.autoSelectCards(cardss, 5);
            } else {
                _s2[2] = KQCard.autoSelectCards(cardss, 3);
            }

            resultArray[i].sort(function (a1, a2) {
                return KQCard.scoreOfCards(a1) - KQCard.scoreOfCards(a2);
            });
        }
        //补全计划2
        for (var i = 0; i < resultArray.length; i++) {
            var s = resultArray[i];
            var cardsqe = this._allCardModes.filter(function (ii) {
                //重新赋值cards
                return ii;
            });
            //去重
            var q = s[0].concat(s[1]).concat(s[2]);
            var cardsq = cardsqe.kq_excludes(q);
            s[0] = s[0].kq_excludes(s[1]);
            s[0] = s[0].kq_excludes(s[2]);
            s[1] = s[1].kq_excludes(s[0]);
            s[1] = s[1].kq_excludes(s[2]);
            s[2] = s[2].kq_excludes(s[1]);
            s[2] = s[2].kq_excludes(s[0]);
            //多余删除
            if (s[2].length > 5) {
                //尾道
                var a = s[2].splice(5, s[2].length - 5);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            if (s[1].length > 5) {
                //中道
                var a = s[1].splice(5, s[1].length - 5);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            if (s[0].length > 3) {
                //头道
                var a = s[0].splice(3, s[0].length - 3);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            //cardsq = KQCard._convertOneToA(cardsq);
            cardsq.sort(KQCard.sortByPoint);
            cardsq.forEach(function (card11) {
                if (card11.point == 14) {
                    card11.point = 1;
                }
            });
            //有缺添加
            while (s[2].length < 5) {
                //尾道
                s[2].push(cardsq.pop() || []);
            }
            while (s[1].length < 5) {
                //中道
                s[1].push(cardsq.pop() || []);
            }
            while (s[0].length < 3) {
                //头道
                s[0].push(cardsq.pop() || []);
            }
            /*if(cardsq.length > 0){
                while(s[2].length < 5) {//尾道
                    s[2].push(cardsq.pop());
                }
            }
            if(cardsq.length > 0){
                while(s[1].length < 5) {//中道
                    s[1].push(cardsq.pop());
                }
            }
            if(cardsq.length > 0){
                while(s[0].length < 3) {//头道
                    s[0].push(cardsq.pop());
                }
            }*/
            if (s[2][4] == null || s[1][4] == null || s[0][2] == null || s[2][4] == '' || s[1][4] == '' || s[0][2] == '') {
                resultArray.splice(i, 1);
            }
        }

        var resultCards = [];
        var cardss1 = this._allCardModes.filter(function (i) {
            return i;
        });
        var indexasdf = 2;
        for (var i = 0; i < 3; i++) {
            var _length = indexasdf == 0 ? 3 : 5;
            var cardss = KQCard.autoSelectCards(cardss1, _length) || [];
            cardss1 = cardss1.kq_excludes(cardss);
            resultCards[indexasdf] = cardss;
            indexasdf--;
        }

        for (var i = 0; i < resultCards.length; i++) {
            var _length2 = i == 0 ? 3 : 5;
            if (resultCards[i].length < _length2) {
                cardss1 = cardss1.kq_excludes(resultCards[i]);
                while (resultCards[i].length < _length2) {
                    resultCards[i].push(cardss1.pop());
                }
            }
        }

        resultArray.push(resultCards);

        var cardsTypeNames = [];
        var resultArrays = [];

        for (var i = 0; i < resultArray.length; i++) {
            //删除类型相同的组合
            var _s3 = resultArray[i];
            var typeName0 = KQCard.cardsTypeName(_s3[0]);
            typeName0 += KQCard.cardsTypeName(_s3[1]);
            typeName0 += KQCard.cardsTypeName(_s3[2]);
            if (cardsTypeNames.indexOf(typeName0) == -1) {
                var touScore = KQCard.scoreOfCards(_s3[0]);
                var zhongScore = KQCard.scoreOfCards(_s3[1]);
                var weiScore = KQCard.scoreOfCards(_s3[2]);
                if (zhongScore > touScore && zhongScore < weiScore) {
                    cardsTypeNames.push(typeName0);
                    resultArrays.push(_s3);
                }
            }
        }

        resultArrays.sort(function (a1, a2) {
            var b0 = parseInt(KQCard.cardsType(a2[0])) + "";
            var b1 = parseInt(KQCard.cardsType(a2[1])) + "";
            var b2 = parseInt(KQCard.cardsType(a2[2])) + "";

            var s0 = parseInt(KQCard.cardsType(a1[0])) + "";
            var s1 = parseInt(KQCard.cardsType(a1[1])) + "";
            var s2 = parseInt(KQCard.cardsType(a1[2])) + "";

            var s = parseInt(s2 + s1 + s0);
            var b = parseInt(b2 + b1 + b0);

            return b - s;
        });

        if (resultArrays.length > 7) {
            resultArrays = resultArrays.slice(0, 7);
        }
        //for(var i = 0;i < resultArrays.length;i++){//如果有相公牌则删除
        //    let s = resultArrays[i];
        //    let touScore = KQCard.scoreOfCards(s[0]);
        //    let zhongScore = KQCard.scoreOfCards(s[1]);
        //    let weiScore = KQCard.scoreOfCards(s[2]);
        //    cc.log(touScore,zhongScore,weiScore);
        //    if(weiScore < touScore || weiScore < zhongScore){
        //        resultArrays.splice(i,1);
        //    }
        //}
        //cc.log(resultArrays)
        //cc.log('-------897')

        //if(cc.teShuPaiCards){
        //    var TeShuCards = cc.teShuPaiCards.map(function(ca){
        //       return KQCard._typeCardsSortByNumberOfPoints(KQCard.cardsFromArray(ca));
        //    });
        //    resultArrays.unshift(TeShuCards);
        //
        //}

        if (resultArrays.length <= 0) {

            this._allCardModes.forEach(function (i) {
                if (i.scores == 1) i.scores = 14;
            });

            var card20 = KQCard.contain20(this._allCardModes);

            this._allCardModes = this._allCardModes.kq_excludes(card20);

            this._allCardModes = KQCard._typeCardsSortByNumberOfPoints(this._allCardModes);

            this._allCardModes = card20.concat(this._allCardModes);

            var asdf1 = this._allCardModes.slice(0, 5);

            var asdf2 = this._allCardModes.slice(5, 10);

            var asdf3 = this._allCardModes.slice(10, 13);

            resultArrays.push([asdf3, asdf2, asdf1]);
        }

        this.autoCardLayout.node.removeAllChildren();
        this.autoCardScrollView.scrollToLeft();
        for (var i = 0; i < resultArrays.length; i++) {
            //添加预制体
            var _s4 = resultArrays[i];
            var autoCard = cc.instantiate(this.autoCard);
            autoCard.y = 0;
            _s4[0].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            _s4[1].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            _s4[2].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            var cardsNode = [autoCard.children[1], autoCard.children[3], autoCard.children[2]];

            this._setCardDaoSprite(cardsNode, _s4);

            autoCard.cardArray = _s4;
            var eventHandler = new cc.Component.EventHandler();
            eventHandler.target = this.node;
            eventHandler.component = "CardTypeCombine";
            eventHandler.handler = "clickAutoSelectedCards";
            eventHandler.customEventData = i;
            autoCard.getComponent(cc.Button).clickEvents.push(eventHandler);
            this.autoCardLayout.node.addChild(autoCard);
        }
        this._findCardIndex.arr = resultArrays;

        this.autoSelectedCardsOne();
    },

    //daoCancelAll: function () {
    //    var nodes = [this.layoutTouDao.node,this.layoutZhongDao.node,this.layoutWeiDao.node];
    //    for(var i = 0;i < nodes.length;i++){
    //        nodes[i].removeAllChildren();
    //    }
    //},

    autoSelectedCardsOne: function autoSelectedCardsOne() {
        this.cardsLayout.node.removeAllChildren();

        var indexs = 0;

        for (var i = 0; i < this.autoCardLayout.node.children.length; i++) {

            var nodes = this.autoCardLayout.node.children[i];

            nodes.children[0].active = false;
        }

        this.autoCardLayout.node.children[indexs].children[0].active = true;

        var resultArray = this._findCardIndex.arr[indexs];

        this._findCardIndex.indexs = indexs;

        for (var i = 0; i < resultArray.length; i++) {

            var cardModes = resultArray[i];

            cardModes.sort(KQCard.sort);

            var num = 0;
            if (i == 1) {
                num = 3;
            } else if (i == 2) {
                num = 8;
            }
            //cardModes.forEach(function(i){if (i.point == 14) i.point = 1;})
            cardModes.forEach((function (cardMode, index) {

                var cardName = cardMode.cardName();

                var numBer = num + index;

                var nodds1 = new cc.Node(); //创建一个节点对象

                nodds1.anchorY = 1;

                nodds1.addComponent(cc.Sprite); //添加精灵组件

                this.cardAllNode.children[numBer].addChild(nodds1);

                this.cardAllNode.children[numBer].children[0].cardName = cardName;

                this.cardAllNode.children[numBer].children[0]._cardModel = new KQCard(cardName, null, index);

                var btnSprites = this.cardAllNode.children[numBer].children[0].getComponent(cc.Sprite);

                this.cardAllNode.children[numBer].getComponent(cc.Sprite).spriteFrame = '';

                btnSprites.node.removeAllChildren();

                if (cc.maPai == cardName) {

                    var nodds = new cc.Node(); //创建一个节点对象

                    nodds.addComponent(cc.Sprite); //添加精灵组件

                    cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                        if (err) {
                            cc.error(err.message || err);return;
                        }

                        var btnSprite1 = nodds.getComponent(cc.Sprite);

                        btnSprite1.spriteFrame = spriteFrame;

                        btnSprite1.node.width = 107;

                        btnSprite1.node.height = 155;

                        btnSprite1.node.y = -65.5;
                    }).bind(this));

                    btnSprites.node.addChild(nodds);
                }

                var path = 'public-pic-card-poker-' + cardName;

                this._loadCardFrame(this.cardSpriteAtlas, path, btnSprites, 95, 130);
            }).bind(this));
        }

        this.clickAutoSelectedCards(null);

        //this._setCardDaoSprite();
    },

    clickAutoSelectedCards: function clickAutoSelectedCards(event) {
        var indexs = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];

        for (var i = 0; i < this.autoCardLayout.node.children.length; i++) {

            var nodes = this.autoCardLayout.node.children[i];

            nodes.children[0].active = false;
        }

        this.autoCardLayout.node.children[indexs].children[0].active = true;

        AudioManager.instance.playPokerClick();

        if (event) {
            var resultArray = event.target.cardArray;
        } else {
            var resultArray = this._findCardIndex.arr[indexs];
        }
        var touScore = KQCard.scoreOfCards(resultArray[0]);
        var zhongScore = KQCard.scoreOfCards(resultArray[1]);
        var weiScore = KQCard.scoreOfCards(resultArray[2]);
        //cc.log(touScore);
        //cc.log(zhongScore);
        //cc.log(weiScore);
        //console.log('----------1180')
        resultArray = resultArray.map((function (cardMode) {

            cardMode = KQCard._typeCardsSortByNumberOfPoints(cardMode);

            return cardMode.map((function (cardModes) {

                return cardModes.cardName();
            }).bind(this));
        }).bind(this));
        //console.log(resultArray)

        this.LayoutWithEvent.forEach(function (nodes) {

            nodes.color = new cc.Color(255, 255, 255);

            nodes.children.forEach(function (i) {
                i.color = new cc.Color(255, 255, 255);
            });
        });

        this.LayoutWithEvent = [];

        resultArray = resultArray[0].concat(resultArray[1]).concat(resultArray[2]);

        var cardAllNode = this.cardAllNode.children.map(function (i) {
            return i;
        });

        for (var i = 0; i < resultArray.length; i++) {

            var s = resultArray[i];

            for (var j = 0; j < cardAllNode.length; j++) {

                var d = cardAllNode[j];

                d.getComponent(cc.Button).interactable = false;

                if (d.children[0].cardName == s) {

                    d.stopAllActions();

                    var detail = this.changeNodeSpaceAR[i];

                    var call = cc.callFunc((function () {

                        this.cardAllNode.children.forEach(function (nodes) {
                            nodes.getComponent(cc.Button).interactable = true;
                        });

                        this._setCardDaoSprite();
                    }).bind(this), this);

                    d.runAction(cc.sequence(cc.moveTo(this.cardTime, detail), call));

                    cardAllNode.splice(j, 1);

                    break;
                }
            }
        }
    },

    _loadCardFrame: function _loadCardFrame(SpriteFrame, path, SpritesNode, w, h) {

        var Sprite = SpriteFrame.getSpriteFrame(path);

        SpritesNode.spriteFrame = Sprite;

        if (w) SpritesNode.node.width = w;

        if (h) SpritesNode.node.height = h;
    },

    stickOutFindCardType1: function stickOutFindCardType1(cards) {
        var index = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];
    },

    //// 将已有的突出的牌的位置重置回初始位置
    //this._resetCardsPositionY();
    //let selectedCardNames = cards.map(function(cardModel){
    //    return cardModel.cardName();
    //}.bind(this));
    //
    //let cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {
    //    let cardPrefab = cardNode.getComponent('CardPrefab');
    //    if(selectedCardNames.includes(cardPrefab.cardName())) {
    //        var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());
    //        selectedCardNames.splice(nameIndex,1);
    //        return true;
    //    }
    //    return false;
    //});
    //
    //cc.log('-------696')
    //this._changeCardPrefabsY(cardNodes);
    //if(index == 1){
    //    this._addDaoCardToLayout(this.layoutTouDao.node, 3);
    //}
    //else if(index == 2){
    //    this._addDaoCardToLayout(this.layoutZhongDao.node);
    //}
    //else if(index == 3){
    //    this._addDaoCardToLayout(this.layoutWeiDao.node);
    //}

    _touchCardLayout: function _touchCardLayout(event) {
        //event.bubbles = true;
        //let location = event.getLocation();
        //let cardPrefab = this._cardPrefabInCardLayoutWithLocation(location);
        //if (cardPrefab) {
        //    cardPrefab.getComponent('CardPrefab').setSelected(true);
        //    event.stopPropagation();
        //}
    },

    _touchCardLayoutEnd: function _touchCardLayoutEnd(event) {
        //this._changeSelectedCardPrefabsY();
        //this._diseclectCardPrefabs();
    },

    _cardPrefabInCardLayoutWithLocation: function _cardPrefabInCardLayoutWithLocation(location) {
        //location = this.cardsLayout.node.convertToNodeSpaceAR(location);
        //let cardNodes = this.cardsLayout.node.children.sort(function (cardNode1, cardNode2) {
        //    let rect1 = cardNode1.getBoundingBox();
        //    let rect2 = cardNode2.getBoundingBox();
        //    return rect2.x - rect1.x;
        //});
        //for (let index in cardNodes) {
        //    let cardNode = cardNodes[index];
        //
        //    let rect = cardNode.getBoundingBox();
        //
        //    if (cc.rectContainsPoint(rect, location)) {
        //        return cardNode;
        //    }
        //}
        //
        //return null;
    },

    _changeSelectedCardPrefabsY: function _changeSelectedCardPrefabsY() {
        //let cardNodes = this._selectedCardPrefabs();
        //this._changeCardPrefabsY(cardNodes);
        //
        //AudioManager.instance.playPokerClick();
    },

    _changeCardPrefabsY: function _changeCardPrefabsY(cardNodes) {
        //cardNodes.forEach(function (cardNode) {
        //    let y = cardNode.getPositionY();
        //    if (y == this._cardOffsetY) {
        //        cardNode.setPositionY(this._cardOffsetY + 55);
        //    } else {
        //        cardNode.setPositionY(this._cardOffsetY);
        //    }
        //}.bind(this));
    },

    _selectedCardPrefabs: function _selectedCardPrefabs() {
        var includeStickOut = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];
    },

    //let cardNodes = this.cardsLayout.node.children || [];
    //return cardNodes.filter(function (cardNode) {
    //    let cardPrefab = cardNode.getComponent('CardPrefab');
    //    let isSelected = cardPrefab.isSelected();
    //    if (!isSelected && includeStickOut) {
    //        isSelected = cardNode.getPositionY() > 10;
    //    }
    //
    //    return isSelected;
    //});
    _diseclectCardPrefabs: function _diseclectCardPrefabs() {
        //let cardNodes = this.cardsLayout.node.children;
        //cardNodes.forEach(function (node) {
        //    node.getComponent('CardPrefab').setSelected(false);
        //});
    },

    // 重置 cards 的 X
    _resetCardsPositionX: function _resetCardsPositionX() {
        //let interval = 98;
        //let interval = 78;
        //let cardNodes = this.cardsLayout.node.children || [];
        //let length = cardNodes.length;
        //if (length == 0) {
        //    return;
        //}
        //
        //let middleIndex = length / 2;
        //let cardWidth = 154;
        //
        //
        ////this.cardsLayoutSort();
        //if(this.cardsLayoutSortColor == true){
        //    this.cardsLayout.node.children.sort(function (n1, n2) {
        //        let component1 = n1.getComponent('CardPrefab');
        //        let component2 = n2.getComponent('CardPrefab');
        //        return component2.cardMode().color - component1.cardMode().color;
        //    });
        //}else{
        //    this.cardsLayout.node.children.sort(function (n1, n2) {
        //        let component1 = n1.getComponent('CardPrefab');
        //        let component2 = n2.getComponent('CardPrefab');
        //        return component1.cardMode().sort(component2.cardMode());
        //    });
        //}
        ////cardNodes.sort(function (n1, n2) {
        ////    let component1 = n1.getComponent('CardPrefab');
        ////    let component2 = n2.getComponent('CardPrefab');
        ////
        ////    return component1.cardMode().sort(component2.cardMode());
        ////});
        //
        //cardNodes.forEach(function (cardNode, index) {
        //    cardNode.zIndex = index;
        //    let x = (index - middleIndex) * interval + cardWidth / 3;
        //    cardNode.setPositionX(x);
        //});
    },

    // 重置 cards 的 X为0
    resetCardsPositionX1: function resetCardsPositionX1() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //let length = cardNodes.length;
        //if (length == 0) {
        //    return;
        //}
        //cardNodes.forEach(function (cardNode) {
        //    cardNode.setPositionY(0);
        //});
    },

    _resetCardsPositionY: function _resetCardsPositionY() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //cardNodes.forEach(function (cardNode) {
        //    cardNode.setPositionY(this._cardOffsetY);
        //}.bind(this));
    },

    // 头、中、尾道 layout 的点击事件
    _registerDaosLayoutClickEvent: function _registerDaosLayoutClickEvent() {

        this.changeNodeSpaceAR = []; //记录所有牌的坐标
        this.cardAllNode.children.forEach((function (nodes) {
            //获取节点的世界坐标
            var cardBackWorldSpace1 = nodes.convertToWorldSpaceAR(cc.v2(0, 0));
            //获取相对父节点所在的坐标
            var detail = nodes.parent.convertToNodeSpaceAR(cardBackWorldSpace1);

            this.changeNodeSpaceAR.push(detail);
        }).bind(this));
    },

    clickAllCard: function clickAllCard(event) {
        AudioManager.instance.playPokerClick();
        if (this.LayoutWithEvent.length <= 1) {
            this.LayoutWithEvent.push(event.target);
            event.target.color = new cc.Color(182, 182, 182);
            event.target.children.forEach(function (i) {
                i.color = new cc.Color(182, 182, 182);
            });
        }
        if (this.LayoutWithEvent.length == 2) {

            var arr = [];

            this.LayoutWithEvent.forEach((function (nodes) {
                //获取节点的世界坐标
                var cardBackWorldSpace1 = nodes.convertToWorldSpaceAR(cc.v2(0, 0));
                //获取相对父节点所在的坐标
                var detail = nodes.parent.convertToNodeSpaceAR(cardBackWorldSpace1);

                arr.unshift(detail);
            }).bind(this));

            this.LayoutWithEvent.forEach((function (nodes, index) {

                nodes.color = new cc.Color(255, 255, 255);

                nodes.children.forEach(function (i) {
                    i.color = new cc.Color(255, 255, 255);
                });

                nodes.getComponent(cc.Button).interactable = false;

                this.scheduleOnce((function () {

                    nodes.getComponent(cc.Button).interactable = true;

                    this._setCardDaoSprite();
                }).bind(this), this.cardTime);

                nodes.stopAllActions();

                var detail = arr[index];

                nodes.runAction(cc.moveTo(this.cardTime, detail));
            }).bind(this));

            this.LayoutWithEvent = [];
        }
    },

    _setCardDaoSprite: function _setCardDaoSprite() {
        var nodes = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];
        var cards = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];

        if (!nodes) {

            this.cardAlls = this.cardAllNode.children.sort(function (a, b) {
                return b.y - a.y;
            }).map(function (i) {
                return i.children[0];
            });

            cards = [this._taoDaoCardModes(), this._zhongDaoCardModes(), this._weiDaoCardModes()];

            cards.forEach(function (card) {
                card.forEach(function (i) {
                    if (i.scores == 14) {
                        i.scores = 1;
                    }
                });
            });

            nodes = [this.touDaoNode, this.zhongDaoNode, this.weiDaoNode];
        }

        //头道
        var typeName0 = KQCard.cardsType(cards[0]) + 1;

        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;

        typeName0 = typeName0 == '04' ? '11' : typeName0;

        var path = 'game_poker_type' + typeName0;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[0].getComponent(cc.Sprite));

        //中道
        var typeName1 = KQCard.cardsType(cards[1]) + 1;

        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;

        typeName1 = typeName1 == '07' ? '22' : typeName1;

        path = 'game_poker_type' + typeName1;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[1].getComponent(cc.Sprite));

        //尾道
        var typeName2 = KQCard.cardsType(cards[2]) + 1;

        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        path = 'game_poker_type' + typeName2;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[2].getComponent(cc.Sprite));

        this.cardAllNode.children.forEach(function (n) {
            n.getComponent(cc.Sprite).spriteFrame = "";
        });

        if (cards) {

            if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards, this.cardAllNode.children, this.cardSpriteAtlas);

            if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards, this.cardAllNode.children, this.cardSpriteAtlas);

            if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards, this.cardAllNode.children, this.cardSpriteAtlas);
        }
    },

    _clickTouDaoLayout: function _clickTouDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutTouDao.node, event);
    },

    _clickZhongDaoLayout: function _clickZhongDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutZhongDao.node, event);
    },

    _clickWeiDaoLayout: function _clickWeiDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutWeiDao.node, event);
    },

    _daoCardNodeInLayoutWithEvent: function _daoCardNodeInLayoutWithEvent(node, event) {
        var cardNodes = node.children || [];
        var location = event.getLocation();
        location = node.convertToNodeSpaceAR(location);
        //var cardBackWorldSpace = this.layoutZhongDao.node.convertToWorldSpaceAR(cc.v2(0, 0));
        ////获取节点的世界坐标
        //var detail = this.layoutZhongDao.node.parent.convertToNodeSpaceAR(cardBackWorldSpace);
        ////获取相对父节点所在的坐标
        //this.layoutWeiDao.node.runAction(cc.moveTo(1,detail));
        for (var index in cardNodes) {
            var cardNode = cardNodes[index];
            var rect = cardNode.getBoundingBox();
            if (cc.rectContainsPoint(rect, location)) {
                AudioManager.instance.playPokerClick();
                var arrs = [node, cardNode];
                if (this.LayoutWithEvent.length == 1) {
                    if (this.LayoutWithEvent[0][0].name != node.name) {
                        cardNode.opacity = 200;
                        this.LayoutWithEvent.push(arrs);
                    } else {
                        this.LayoutWithEvent[0][1].opacity = 255;
                        this.LayoutWithEvent = [];
                    }
                } else if (this.LayoutWithEvent.length == 0) {
                    //cc.log(cardNode)
                    this.LayoutWithEvent.push(arrs);
                    cardNode.opacity = 200;
                }
                if (this.LayoutWithEvent.length == 2) {
                    var node1 = this.LayoutWithEvent[0][1];
                    var node2 = this.LayoutWithEvent[1][1];
                    //获取节点的世界坐标
                    var cardBackWorldSpace = node1.convertToWorldSpaceAR(cc.v2(0, 0));
                    //获取相对父节点所在的坐标
                    var detail = node1.parent.convertToNodeSpaceAR(cardBackWorldSpace);
                    node2.runAction(cc.moveTo(1, detail));
                }

                return;
            }
        }

        //return null;
    },

    _addDaoCardToLayout: function _addDaoCardToLayout(node) {
        var maxNumberCard = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];
    },

    //let cardNodes = node.children || [];
    //if (cardNodes.length >= 5) {
    //    return;
    //}
    //let remainCount = maxNumberCard - cardNodes.length;
    //
    //var selectedCards = this._selectedCardPrefabs(true) || [];
    //
    //if (selectedCards.length == 0) {
    //    return;
    //}
    //if (selectedCards.length > remainCount) {
    //    selectedCards = selectedCards.slice(0, remainCount);
    //}
    //
    //let selectedCardNames = selectedCards.map(function (cardPrefab) {
    //    return cardPrefab.getComponent('CardPrefab').cardName();
    //});
    //
    //cardNodes.forEach(function (cardTypeNode) {
    //    selectedCardNames.push(cardTypeNode.getComponent('CardTypeSprite').cardName());
    //});
    //
    //let cardModes = selectedCardNames.map(function (cardName,index) {
    //    return new KQCard(cardName,null,index);
    //}).sort(function (c1, c2) {
    //    return KQCard.sort(c1, c2, false);
    //});

    //let touCardModes = (node == this.layoutTouDao.node) ? cardModes : this._taoDaoCardModes();
    //let zhongCardModes = (node == this.layoutZhongDao.node) ? cardModes : this._zhongDaoCardModes();
    //let weiCardModes = (node == this.layoutWeiDao.node) ? cardModes : this._weiDaoCardModes();
    //if (!this._isValidCardModes(touCardModes, zhongCardModes, weiCardModes)) {
    //    this.cacleAutoSelectedCards1();
    //    cc.log('相公牌：自动选择牌')
    //    return;
    //}
    //
    //node.removeAllChildren();
    //
    //cardModes.forEach(function (cardMode,index) {
    //    let cardName = cardMode.cardName();
    //    let cardTypeSprite = cc.instantiate(this.cardTypePrefab);
    //    cardTypeSprite.names = cardName+'+'+index;
    //    cardTypeSprite.getComponent('CardTypeSprite').setCard(cardName,index);
    //    node.addChild(cardTypeSprite);
    //}.bind(this));
    //
    //
    //selectedCards.forEach(function (node) {
    //    node.removeFromParent();
    //});
    //this._resetCardsPositionY();
    //this._resetCardsPositionX();
    //
    //this._autoActiveDeleteDaoButtons();
    //
    //this._reloadKQCardModesInner();
    //this._resetTypeButtonEnablesWithModels();
    // 删除 头、中或尾道中的某中牌
    _deleteDaoCard: function _deleteDaoCard(cardTypeNode) {
        var reloadTypeButtonEnables = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
    },

    //let cardName = cardTypeNode.getComponent('CardTypeSprite').cardName();
    //this.addCard(cardName, true);
    //
    //this._resetCardsPositionY();
    //
    //cardTypeNode.removeFromParent(true);
    //this._autoActiveDeleteDaoButtons();
    //
    //if (reloadTypeButtonEnables) {
    //    this._reloadKQCardModesInner();
    //    this._resetTypeButtonEnablesWithModels();
    //}
    // 删除 头道或中道或尾道上所有的 牌
    _deleteDaoCardsOfLayout: function _deleteDaoCardsOfLayout(daoLayout) {
        //let cardNodes = Array.from(daoLayout.children);
        //cardNodes.forEach(this._deleteDaoCard.bind(this));
        //
        //this._reloadKQCardModesInner();
        //this._resetTypeButtonEnablesWithModels();
    },

    // 判断能否使用选择中的牌
    // 即：头道要小于中道、中道要小于尾道
    _isValidCardModes: function _isValidCardModes(touCardModes, zhongCardModes, weiCardModes) {
        touCardModes = touCardModes || [];
        zhongCardModes = zhongCardModes || [];
        weiCardModes = weiCardModes || [];
        if (touCardModes.length < 3 || zhongCardModes.length < 5 || weiCardModes.length < 5) {
            return true;
        }

        var touScore = KQCard.scoreOfCards(touCardModes);
        var zhongScore = KQCard.scoreOfCards(zhongCardModes);
        var weiScore = KQCard.scoreOfCards(weiCardModes);
        return touScore < zhongScore && zhongScore <= weiScore;
    },

    // 头道上已有的牌
    _taoDaoCardModes: function _taoDaoCardModes() {
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(0, 3));
    },

    // 中道上已有的牌
    _zhongDaoCardModes: function _zhongDaoCardModes() {
        //return this._cardModesOfCardPrefabs(this.layoutZhongDao.node.children);
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(3, 8));
    },

    // 尾道上已有的牌
    _weiDaoCardModes: function _weiDaoCardModes() {
        //return this._cardModesOfCardPrefabs(this.layoutWeiDao.node.children);
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(8, 13));
    },

    _cardModesOfCardPrefabs: function _cardModesOfCardPrefabs(cardTypeNodes) {
        if (!cardTypeNodes) {
            return [];
        }

        var cardModes = cardTypeNodes.map(function (node) {
            //let component = node.getComponent('CardTypeSprite');
            //return component.cardMode();._cardModel
            return node._cardModel;
        });

        return cardModes || [];
    },

    // 自动设置 头、中、尾道的删除按钮的可见性
    _autoActiveDeleteDaoButtons: function _autoActiveDeleteDaoButtons() {
        //this._autoActiveDeleteDaoButton(this.layoutTouDao.node, this.btnDeleteTouDao.node);
        //this._autoActiveDeleteDaoButton(this.layoutZhongDao.node, this.btnDeleteZhongDao.node);
        //this._autoActiveDeleteDaoButton(this.layoutWeiDao.node, this.btnDeleteWeiDao.node);
    },

    _autoActiveDeleteDaoButton: function _autoActiveDeleteDaoButton(layout, button) {
        //button.active = layout.children.length > 0;
    },

    // 自动设置 “全部取消”、“确定出牌”、“类型选择”按钮的可见性
    _autoActiveTypeButtons: function _autoActiveTypeButtons() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //let hasCardUnSelected = cardNodes.length > 0;
        //this.btnDone.node.active = !hasCardUnSelected;
        //this.btnCancelAll.node.active = this.btnDone.node.active;
        //this.typeButtonsNode.active = hasCardUnSelected;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardScoretsHelper":"KQCardScoretsHelper","play":"play"}],"CardTypeSprite":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e614c0FMndAtrOMcy8/PcZw', 'CardTypeSprite');
// scripts\CardTypeSprite.js

var KQCard = require('KQCard');
cc.Class({
  'extends': cc.Component,

  properties: {
    _cardName: null,
    _cardModel: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setCard: function setCard(cardName, index) {
    var asdf = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    this._cardName = cardName;
    if (asdf) {
      this._cardModel = new KQCard(cardName, null, index);
    }
    this._loadCardFrame(cardName, (function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }).bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._cardModel;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"ChatMessage":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dc8980X2ZVNKrH9BsIsSE4D', 'ChatMessage');
// scripts\Chat\ChatMessage.js

// 用于在游戏过程中，展示用户的聊天消息

var ChatMessage = cc.Class({
    "extends": cc.Component,

    properties: {
        richText: cc.RichText,
        spriteBackground: cc.Sprite,
        emoji: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        ChatMessage.instances = this;
    },

    setString: function setString() {
        var string = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];
        var autoHide = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (string.length == 0) {
            return;
        }

        this.node.active = true;
        this.richText.node.active = true;
        this.spriteBackground.node.active = true;
        this.emoji.active = false;
        var maxWidth = 300;
        var realStr = ChatMessage.parseString(string);

        // 由于 cc.RichText 在指定 maxWidth 后，该结点的 width 会一直
        // 是 maxWidth 值。而在将 maxWidth 指定为0时，其 contentSize.width 会
        // 是内容的真正所需的宽度
        //
        // 所以这里先将 maxWidth 设为 0，获取其实际内容 width 后再调整
        this.richText.maxWidth = 0;
        this.richText.string = realStr;

        var contentWidth = this.richText.node.getContentSize().width;
        if (contentWidth > maxWidth) {
            this.richText.maxWidth = maxWidth;
            this.richText.string = realStr;
            contentWidth = maxWidth;
        }

        this.node.width = contentWidth + 28;
        this.node.height = this.richText.node.getContentSize().height + 20;

        this.spriteBackground.node.width = this.node.width;
        this.spriteBackground.node.height = this.node.height;

        if (autoHide) {
            this._hideNode();
            //this.unscheduleAllCallbacks();
            //this.scheduleOnce(this._hideNode.bind(this), 3);
        }
    },

    showEmoji: function showEmoji(sprite) {
        this._hideNode();
        this.node.active = true;
        this.emoji.active = true;
        this.richText.node.active = false;
        this.spriteBackground.node.active = false;
        var btnSprites = this.emoji.getComponent(cc.Sprite);
        btnSprites.spriteFrame = sprite;
    },

    _hideNode: function _hideNode() {
        this.unscheduleAllCallbacks();
        this.scheduleOnce((function () {
            this.node.active = false;
        }).bind(this), 3);
    }

});
ChatMessage.setEmoji = function (sprite) {
    this.instances._hideNode();
    this.instances.node.active = true;
    this.instances.emoji.active = true;
    this.instances.richText.node.active = false;
    this.instances.spriteBackground.node.active = false;
    var btnSprites = this.instances.emoji.getComponent(cc.Sprite);
    btnSprites.spriteFrame = sprite;
    //console.log(this.emoji);
    //return;
    //
    //this.emoji.Sprite = sprite;
},

// 将 <bq10> 改为： <img src='bg10'/>
ChatMessage.parseString = function (str) {
    var result = str.replace(/<bq\d{1,2}>/g, function (match) {
        var bq = match.replace("<", " <img src='").replace(">", "'/> ");
        return bq;
    });
    return result;
}, module.exports = ChatMessage;

cc._RFpop();
},{}],"ChatTextRecord":[function(require,module,exports){
"use strict";
cc._RFpush(module, '88d10U9tIpHNK1entoUH0Ju', 'ChatTextRecord');
// scripts\Pefabs\ChatTextRecord.js

cc.Class({
    'extends': cc.Component,

    properties: {},

    // use this for initialization
    onLoad: function onLoad() {},

    setString: function setString(str) {
        this._richText().string = str;
    },

    _richText: function _richText() {
        return this.node.getComponent('cc.RichText');
    },

    setEmoji: function setEmoji(spraite) {
        this._spriteFrame().Spraite = spraite;
    },
    _spriteFrame: function _spriteFrame() {
        return this.node.getComponent('cc.Sprite');
    }
});

cc._RFpop();
},{}],"CompareCards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9aa4aH/Ha1JfaEeY5nFj5P1', 'CompareCards');
// scripts\Pefabs\CompareCards.js

var KQCardResHelper = require('KQCardResHelper');
var AudioManager = require('AudioManager');
var KQCard = require('KQCard');

cc.Class({
    'extends': cc.Component,

    properties: {
        touLayout: cc.Layout,
        zhongLayout: cc.Layout,
        weiLayout: cc.Layout,

        touLayoutBack: cc.Layout,
        zhongLayoutBack: cc.Layout,
        weiLayoutBack: cc.Layout,
        baoDao: cc.Node, //报道图,
        playTotalScore: cc.Layout, //所有玩家的总分数

        daoScoreLayouts: [cc.Layout],
        daoTitleNodes: [cc.Node],
        TScoreLayout: cc.Layout,
        TtitleNode: cc.Node,

        pNum: 0, //玩家人数
        teShuTime: 0, //特殊牌出牌顺序
        teShuNum: 0, //特殊牌人数

        _lCScore: null,
        _daoLayouts: null, // 头、中、尾集合
        _daoLayoutBacks: null, // 头、中、尾集合
        _scores: null,
        _user: null, // 用于比牌的数据
        _cardsInfo: null,
        _compareIndex: 0 },

    // 将要比较的 索引  0~2
    // use this for initialization
    onLoad: function onLoad() {

        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        this._daoLayoutBacks = [this.touLayoutBack, this.zhongLayoutBack, this.weiLayoutBack];
        this.reset();

        if (this._scores) {
            this.setScores(this._scores);
        }
    },

    reset: function reset() {
        this._compareIndex = 0;

        this.node.children.forEach(function (node) {
            node.active = false;
        });

        this.baoDao.getComponent(cc.Sprite).spriteFrame = null;

        var nodes = this.touLayoutBack.node.children.concat(this.zhongLayoutBack.node.children).concat(this.weiLayoutBack.node.children);

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        nodes.forEach((function (nod) {

            nod.removeAllChildren();

            var cardSprite = nod.getComponent(cc.Sprite);

            KQCard._loadCardFrame(this.cardSpriteAtlas, "public-pic-card-poker-back", cardSprite);
        }).bind(this));

        this.daoScoreLayouts.forEach((function (nod) {
            nod.node.active = false;
        }).bind(this));

        this.daoTitleNodes.forEach((function (nod) {
            nod.active = false;
        }).bind(this));

        if (this.TScoreLayout) this.TScoreLayout.node.active = false;

        if (this.TtitleNode) this.TtitleNode.active = false;

        this.unscheduleAllCallbacks();

        //console.log('执行了一遍清除定时器--------------------------------')

        if (this.TScoreLayout) this.TScoreLayout.node.stopAllActions();

        if (this.playTotalScore) this.playTotalScore.node.stopAllActions();
    },

    setCompareData: function setCompareData(user) {
        this._user = user;
        this._cardsInfo = user.cardInfo;
        var cardsInfo = user.cardInfo;
        this._lCScore = user.lCScore;
        var cards = cardsInfo.map(function (cardInfoItem) {
            return KQCard.cardsFromArray(cardInfoItem.cards);
        }).reduce(function (array, subCards) {
            return array.concat(subCards);
        }, []);

        var scores = [user.score1 || 0, user.score2 || 0, user.score3 || 0, user.lScore1 || 0, user.lScore2 || 0, user.lScore3 || 0];
        this.setCards(cards);
        this.setScores(scores);
    },

    //显示所有玩家的总分数
    showScoreResult: function showScoreResult() {
        if (!this._user) return;
        var scores = this._user.cScore;
        this.setScores([scores], [this.playTotalScore], true);
        this.playTotalScore.node.active = true;
        this.playTotalScore.node.opacity = 255;
        var x = this.playTotalScore.node.x;
        var y = this.playTotalScore.node.y;
        this.playTotalScore.node.runAction(cc.moveTo(0.8, cc.p(x, y + 30)));
        this.scheduleOnce((function () {
            this.playTotalScore.node.runAction(cc.fadeOut(0.2));
        }).bind(this), 0.6);
        this.scheduleOnce((function () {
            this.playTotalScore.node.y = y;
        }).bind(this), 1);
    },

    //显示三道分数
    showNextCompareScore: function showNextCompareScore(isContainExtra) {
        if (isContainExtra && this.TScoreLayout) {
            var scores1 = this._lCScore.splice(0, 1);
            if (scores1.length <= 0) return;
            this.setScores(scores1, [this.TScoreLayout], true);
            this.TtitleNode.active = true;
            this.TScoreLayout.node.active = true;

            var scaleTo11 = cc.scaleTo(0.3, 1.8);
            var scaleTo21 = cc.scaleTo(0.1, 1.1);
            var scaleTo31 = cc.scaleTo(0.1, 1.3);
            var scaleToSeq1 = cc.sequence(scaleTo11, scaleTo21, scaleTo31);
            this.TScoreLayout.node.runAction(scaleToSeq1);
        }

        if (this.daoScoreLayouts.length <= 0) return;
        if (!this._user.isContainExtra) {
            var index = this._compareIndex == 0 ? 1 : this._compareIndex;
            this.daoScoreLayouts[index - 1].node.active = true;
            this.daoScoreLayouts[index + 2].node.active = true;
            this.daoTitleNodes[index - 1].active = true;
        }

        var scores = this._lCScore.splice(0, 1);
        if (scores.length <= 0 && !this.TScoreLayout) return;
        this.setScores(scores, [this.TScoreLayout], true);
        this.TtitleNode.active = true;
        this.TScoreLayout.node.active = true;

        var scaleTo1 = cc.scaleTo(0.3, 1.8);
        var scaleTo2 = cc.scaleTo(0.1, 1.1);
        var scaleTo3 = cc.scaleTo(0.1, 1.3);
        var scaleToSeq = cc.sequence(scaleTo1, scaleTo2, scaleTo3);
        this.TScoreLayout.node.runAction(scaleToSeq);
    },

    // 下一个要比较的分数
    // 如果没有要比较的了，则返回 0
    nextCompareScore: function nextCompareScore() {
        if (!this._user) return 0;

        var data;
        if (this._user.isContainExtra) {
            data = this._cardsInfo[0];
            if (data) return data.type * 9000000000000000;
        } else {
            data = this._cardsInfo[this._compareIndex];
        }
        if (!data) return 0;
        return data.value;
    },

    setMaPai: function setMaPai(nodes, cardName) {
        if (cc.maPai == cardName) {

            var nodds = new cc.Node(); //创建一个节点对象

            nodds.addComponent(cc.Sprite); //添加精灵组件

            cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                if (err) {
                    cc.error(err.message || err);return;
                }

                var btnSprite1 = nodds.getComponent(cc.Sprite);

                btnSprite1.sizeMode = 0;

                btnSprite1.spriteFrame = spriteFrame;

                btnSprite1.node.width = nodes.width + 10;

                btnSprite1.node.height = nodes.height + 10;
            }).bind(this));

            nodes.addChild(nodds);
        }
    },

    setCards: function setCards(cards) {

        var cardSprites = this._allCardSprites();

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        cards.forEach((function (kqCard, index) {
            if (index >= cardSprites.length) {
                return;
            }
            cardSprites[index].node.removeAllChildren();

            cardSprites[index].node.getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.cardName = kqCard.cardName();

            nodds1.width = cardSprites[index].node.width;

            nodds1.height = cardSprites[index].node.height;

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var path = "public-pic-card-poker-" + kqCard.cardName();

            KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            this.setMaPai(cardSprite.node, kqCard.cardName());

            cardSprites[index].node.addChild(nodds1);
        }).bind(this));

        var cards0 = cards.slice(0, 3);
        var cards1 = cards.slice(3, 8);
        var cards2 = cards.slice(8, 13);

        var cards11 = [cards0, cards1, cards2];
        //头道
        var typeName0 = KQCard.cardsType(cards0) + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        typeName0 = typeName0 == '04' ? '11' : typeName0;

        //中道
        var typeName1 = KQCard.cardsType(cards1) + 1;
        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;
        typeName1 = typeName1 == '07' ? '22' : typeName1;

        //尾道
        var typeName2 = KQCard.cardsType(cards2) + 1;
        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        cardSprites = cardSprites.map(function (i) {
            return i.node;
        });

        if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards11, cardSprites, this.cardSpriteAtlas);
        if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards11, cardSprites, this.cardSpriteAtlas);
        if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards11, cardSprites, this.cardSpriteAtlas);
    },

    setScores: function setScores(scores) {
        var Layouts = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];
        var is_WH = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

        if (!Layouts) {
            Layouts = this.daoScoreLayouts;
            if (Layouts.length <= 0) return;
        }

        scores.forEach((function (string, index) {

            var labels = Layouts[index];

            labels.node.removeAllChildren();

            var path = "play/CardTypeCombine/" + (Number(string) >= 0 ? "addNum" : "delNum");

            this._creatorNodes(labels.node, 10, path, '', is_WH);

            var strings = string > 0 ? string + "" : string * -1 + "";

            var stringAyy = strings.split("");

            for (var i = 0; i < stringAyy.length; i++) {

                var s = stringAyy[i];

                this._creatorNodes(labels.node, Number(s), path, '', is_WH);
            }

            labels.type = 1;
        }).bind(this));
    },

    _creatorNodes: function _creatorNodes(nodes, name, path, paths) {
        var w_h = arguments.length <= 4 || arguments[4] === undefined ? false : arguments[4];

        var node = new cc.Node(); //创建一个节点对象

        node.addComponent(cc.Sprite); //添加精灵组件

        var btnSprite = node.getComponent(cc.Sprite);

        btnSprite.sizeMode = 0;

        btnSprite.node.width = 18;btnSprite.node.height = 23;
        //name = name + "";
        this._loadCardFrame(name, (function (spriteFrame) {

            btnSprite.spriteFrame = spriteFrame;

            if (w_h) {
                btnSprite.node.width = 30;btnSprite.node.height = 40;
            }
        }).bind(this), path, paths);

        nodes.addChild(node);
    },

    _setCardSpriteFrame: function _setCardSpriteFrame(indexs, nodes) {
        var cardsInfo = this._cardsInfo;
        var cards = cardsInfo.map(function (cardInfoItem) {
            return KQCard.cardsFromArray(cardInfoItem.cards);
        })[indexs] || [];

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        // cc.log(this._cardsInfo)
        // cc.log(cards)
        // cc.log('------555')

        cards.forEach((function (kqCard, index) {

            nodes.children[index].removeAllChildren();

            nodes.children[index].getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.cardName = kqCard.cardName();

            nodds1.width = nodes.children[index].width;

            if (nodes.parent.parent.name == "playSelf") {

                nodes.children[index].height = 130;

                nodds1.height = 130;
            } else {

                nodes.children[index].height = 115;

                nodds1.height = 115;

                //console.log(nodes);
                //console.log(nodds1);
            }

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var path = "public-pic-card-poker-" + kqCard.cardName();

            cardSprite.node.removeAllChildren();

            KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            this.setMaPai(cardSprite.node, kqCard.cardName());

            nodes.children[index].addChild(nodds1);
        }).bind(this));

        var typeName = KQCard.cardsType(cards) + 1;

        typeName = typeName >= 10 ? typeName + "" : "0" + typeName;

        //头道
        if (indexs == 0) {
            typeName = typeName == '04' ? '11' : typeName;
        } else if (indexs == 1) {
            typeName = typeName == '07' ? '22' : typeName;
        }

        var cardSprites = nodes.children.map(function (i) {
            return i;
        });

        KQCard._setGuiCards(typeName, cards, cardSprites, this.cardSpriteAtlas);
    },

    showTouCards: function showTouCards() {
        if (this._user.isContainExtra == true) return;
        //console.log('开始执行一次定时动作--------------------------------')

        this.touLayoutBack.node.active = false;
        this._setCardSpriteFrame(0, this.touLayoutBack.node);
        this.scheduleOnce((function () {
            this.touLayout.node.active = false;
            this.touLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.touLayout.node.active = true;
        this.touLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.touLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        var types = this._cardsInfo[this._compareIndex].type == 3 ? 333 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showZhongCards: function showZhongCards() {
        if (this._user.isContainExtra == true) return;

        this.zhongLayoutBack.node.active = false;
        this._setCardSpriteFrame(1, this.zhongLayoutBack.node);
        this.scheduleOnce((function () {
            this.zhongLayout.node.active = false;
            this.zhongLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.zhongLayout.node.active = true;
        this.zhongLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.zhongLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        var types = this._cardsInfo[this._compareIndex].type == 6 ? 555 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showWeiCards: function showWeiCards() {
        //console.log('执行了一次尾道动画---------------')
        if (this._user.isContainExtra == true) return;
        //this._setCardSpriteFrame(1,this.zhongLayoutBack.node);
        this.weiLayoutBack.node.active = false;
        this._setCardSpriteFrame(2, this.weiLayoutBack.node);
        this.scheduleOnce((function () {
            this.weiLayout.node.active = false;
            this.weiLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.weiLayout.node.active = true;
        this.weiLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.weiLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[this._compareIndex].type);
        this._compareIndex += 1;
    },

    showTeShuCards: function showTeShuCards(cards) {
        //let typeName = KQCard.cardsTypeName(cardsNames);
        this._daoLayoutBacks = [this.touLayoutBack, this.zhongLayoutBack, this.weiLayoutBack];

        var touCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[0]);
        var zhongCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[1]);
        var weiCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[2]);
        var cardSprites = touCardSprites.concat(zhongCardSprites).concat(weiCardSprites);
        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;
        this.scheduleOnce((function () {
            cards.forEach((function (kqCard, index) {
                if (index >= cardSprites.length) return;

                var cardSprite = cardSprites[index];

                var path = "public-pic-card-poker-" + kqCard.cardName();

                cardSprite.node.removeAllChildren();

                KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

                this.setMaPai(cardSprite.node, kqCard.cardName());
            }).bind(this));
            this._daoLayoutBacks.forEach((function (nodes) {
                nodes.node.active = true;
            }).bind(this));
            AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[0].type);
        }).bind(this), 0.1);
    },

    showNextCards: function showNextCards() {
        var cardTypeCombine = this.node.parent.parent.getChildByName('CardTypeCombine').getComponent('CardTypeCombine');
        cardTypeCombine.reset();
        cardTypeCombine.node.active = false;

        this.touLayoutBack.node.parent.active = true;
        if (this._user.isContainExtra) {
            var cards = this._cardsInfo[0].cards.map(function (cardInfoItem) {
                return KQCard.cardsFromArray(cardInfoItem);
            }).reduce(function (array, subCards) {
                return array.concat(subCards);
            }, []);
            this.showTeShuCards(cards);
            this.showBaoDao(0, 0);
            this.baoDao.active = true;
            return;
        }
        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        this._daoLayouts.forEach(function (nodes) {
            nodes.node.active = false;
        });
        if (this._compareIndex == 0) {
            this.showBaoDao(0, 140);
            this.showTouCards();
        } else if (this._compareIndex == 1) {
            this.showBaoDao(1, 85);
            this.showZhongCards();
        } else if (this._compareIndex == 2) {
            this.showBaoDao(2, 34);
            this.showWeiCards();
        }

        this.baoDao.active = true;
        this.scheduleOnce((function () {
            this.baoDao.active = false;
        }).bind(this), 0.7);
    },

    showAllCards: function showAllCards() {
        if (!this._user) return;

        if (this._user.isContainExtra) {

            var cards = this._cardsInfo[0].cards.map(function (cardInfoItem) {
                return KQCard.cardsFromArray(cardInfoItem);
            }).reduce(function (array, subCards) {
                return array.concat(subCards);
            }, []);

            this.showTeShuCards(cards);

            //return;
        }

        if (!this._daoLayoutBacks) return;

        this.touLayoutBack.node.parent.active = true;

        this._daoLayoutBacks.forEach((function (nodes, index) {

            nodes.node.active = true;

            nodes.node.children.forEach(function (no) {
                no.active = true;
            });

            this._setCardSpriteFrame(index, nodes.node);

            if (this.TScoreLayout) this.daoTitleNodes[index].active = true;
        }).bind(this));

        if (!this.TScoreLayout) return;

        this.daoScoreLayouts.forEach((function (nodes) {

            nodes.node.active = true;
        }).bind(this));

        this.setScores([this._user.cScore], [this.TScoreLayout], true);

        this.TtitleNode.active = true;

        this.TScoreLayout.node.active = true;
    },

    showBaoDao: function showBaoDao(index, positonY) {
        var cardsInfo = this._cardsInfo;
        var cardType = cardsInfo.map(function (cardInfoItem) {
            return cardInfoItem.type;
        });

        var typeName0 = cardType[index] + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        if (index == 0) typeName0 = typeName0 == '04' ? '11' : typeName0;
        if (index == 1) typeName0 = typeName0 == '07' ? '22' : typeName0;

        if (cardType[index] == 10) typeName0 = '15'; //特殊牌
        if (cardType[index] == 11) typeName0 = '14';
        if (cardType[index] == 12) typeName0 = '16';
        if (cardType[index] == 18) typeName0 = '25';
        if (cardType[index] == 19) typeName0 = '26';

        var path = this._user.isContainExtra ? "game-right_specia" : "game-poker_type";

        this._loadCardFrame(typeName0, (function (spriteFrame) {
            var btnSprites1 = this.baoDao.getComponent(cc.Sprite);
            btnSprites1.spriteFrame = spriteFrame;
        }).bind(this), "play/CardTypeCombine/game_txt", path);
        this.baoDao.y = positonY;
    },

    _loadCardFrame: function _loadCardFrame(cardName, callback) {
        var path = arguments.length <= 2 || arguments[2] === undefined ? "play/CardTypeCombine/pockList" : arguments[2];
        var paths = arguments.length <= 3 || arguments[3] === undefined ? "public-pic-card-poker-" : arguments[3];

        cc.loader.loadRes(path, cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                cc.error(err);
                return;
            }
            cardName = cardName + "";
            cardName = this._cardFullName(cardName, paths);
            var frame = atlas.getSpriteFrame(cardName);
            callback(frame);
        }).bind(this));
    },

    _cardFullName: function _cardFullName(cardShortName, paths) {
        if (!paths) return cardShortName;
        var cardName = cardShortName;
        if (!cardName.startsWith(paths)) {
            cardName = paths + cardName;
        }
        return cardName;
    },

    _clearCards: function _clearCards() {
        this._clearLayoutCards(this.touLayout);
        this._clearLayoutCards(this.zhongLayout);
        this._clearLayoutCards(this.weiLayout);
    },

    _clearLayoutCards: function _clearLayoutCards(layout) {
        this._cardSpritesWithLayout(layout).forEach(function (sprite) {
            sprite.spriteFrame = null;
        });
    },

    _cardSpritesWithLayout: function _cardSpritesWithLayout(layout) {
        var node = layout.node;
        return node.children.map(function (node) {
            return node.getComponent('cc.Sprite');
        });
    },

    _allCardSprites: function _allCardSprites() {
        var touCardSprites = this._cardSpritesWithLayout(this.touLayout);
        var zhongCardSprites = this._cardSpritesWithLayout(this.zhongLayout);
        var weiCardSprites = this._cardSpritesWithLayout(this.weiLayout);
        var result = touCardSprites.concat(zhongCardSprites).concat(weiCardSprites);
        return result;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardResHelper":"KQCardResHelper"}],"Countdown":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6406dyBk8tKVrlJ1+mg7cLt', 'Countdown');
// scripts\Pefabs\Countdown.js

cc.Class({
    "extends": cc.Component,

    properties: {
        labelTime: cc.Label,
        //timeNode: cc.Node,

        _callback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.labelTime.string = "0";
    },

    /**
     * 开始倒计时
     * 
     * @param  {Number} time 时长
     * @param  {Function} callback 倒计时的回调
     */
    startCountdown: function startCountdown(time, callback) {
        this.stop();
        this._callback = callback;

        this.node.active = true;
        this.labelTime.string = "" + time;
        this.schedule(this._countDown, 1, time);
        this.getComponent("time").setTime(time * 0.5);
    },

    stop: function stop() {
        this.unschedule(this._countDown);
        this.node.active = false;

        if (this._callback) {
            var isTimeout = Number(this.labelTime.string) <= 0;
            var callback = this._callback;
            this._callback = null;
            callback(isTimeout);
        }

        this._callback = null;
    },

    _countDown: function _countDown() {
        var time = Number(this.labelTime.string || "0");
        time = time - 1;

        if (time <= 0) {
            this.stop();
        }

        this.labelTime.string = String(time);
    }

});

cc._RFpop();
},{}],1:[function(require,module,exports){
'use strict'

exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function placeHoldersCount (b64) {
  var len = b64.length
  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // the number of equal signs (place holders)
  // if there are two placeholders, than the two characters before it
  // represent one byte
  // if there is only one, then the three characters before it represent 2 bytes
  // this is just a cheap hack to not do indexOf twice
  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0
}

function byteLength (b64) {
  // base64 is 4/3 + up to two characters of the original data
  return b64.length * 3 / 4 - placeHoldersCount(b64)
}

function toByteArray (b64) {
  var i, j, l, tmp, placeHolders, arr
  var len = b64.length
  placeHolders = placeHoldersCount(b64)

  arr = new Arr(len * 3 / 4 - placeHolders)

  // if there are placeholders, only get up to the last complete 4 chars
  l = placeHolders > 0 ? len - 4 : len

  var L = 0

  for (i = 0, j = 0; i < l; i += 4, j += 3) {
    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]
    arr[L++] = (tmp >> 16) & 0xFF
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  if (placeHolders === 2) {
    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[L++] = tmp & 0xFF
  } else if (placeHolders === 1) {
    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var output = ''
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    output += lookup[tmp >> 2]
    output += lookup[(tmp << 4) & 0x3F]
    output += '=='
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])
    output += lookup[tmp >> 10]
    output += lookup[(tmp >> 4) & 0x3F]
    output += lookup[(tmp << 2) & 0x3F]
    output += '='
  }

  parts.push(output)

  return parts.join('')
}

},{}],2:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

'use strict'

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('isarray')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":1,"ieee754":3,"isarray":4}],3:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],4:[function(require,module,exports){
var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};

},{}],"GameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6a3cdd+2shGlZ+jeI3trSsB', 'GameResult');
// scripts\Play\GameResult.js

var KQCard = require('KQCard');
var AudioManager = require('AudioManager');

var ResultStatus = {
  WIN: 2,
  DRAW: 1,
  LOSE: 0
};

var GameResult = cc.Class({
  'extends': cc.Component,

  properties: {
    winNode: cc.Node,
    loseNode: cc.Node,
    drawNode: cc.Node,
    contentNode: cc.Node,

    resultItems: [cc.Node],

    _deskInfo: null,
    _userId: null,
    _closeCallback: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._hideResultItems();
  },

  showResults: function showResults(deskInfo, currentUserId) {
    this._deskInfo = deskInfo;
    this._userId = currentUserId;

    var resultStatus = this._resultStatus();
    this.contentNode.active = true;
    this.winNode.active = resultStatus == ResultStatus.WIN;
    this.drawNode.active = resultStatus == ResultStatus.DRAW;
    this.loseNode.active = resultStatus == ResultStatus.LOSE;

    if (this.winNode.active) {
      AudioManager.instance.playWin();
    } else if (this.loseNode.active) {
      AudioManager.instance.playLose();
    }

    this.node.getComponent('alert').alert();
    this.node.getComponent('alert').setDismissCallback((function () {
      this._closeCallback;
    }).bind(this));

    var playerInfos = deskInfo.players.sort(function (p1, p2) {
      return p2.cScore - p1.cScore;
    });
    var itemComps = this.resultItems.map(function (node) {
      return node.getComponent('ResultItem');
    });
    itemComps.forEach((function (itemComp, index) {
      itemComp.node.active = index < playerInfos.length;
      if (!itemComp.node.active) {
        return;
      }

      var user = playerInfos[index];
      itemComp.updateWithPlayerInfo(user, deskInfo.isRandomDesk);
      var cards = this._cardsFromUser(user);
      itemComp.setCards(cards);
    }).bind(this));
  },

  setCloseCallback: function setCloseCallback(callback) {
    this._closeCallback = callback;
  },

  _cardsFromUser: function _cardsFromUser(user) {
    var cards = user.cardInfo.map(function (cardInfoItem) {
      return KQCard.cardsFromArray(cardInfoItem.cards);
    }).reduce(function (array, subCards) {
      return array.concat(subCards);
    }, []);

    return cards;
  },

  _hideResultItems: function _hideResultItems() {
    this.resultItems.forEach(function (node) {
      node.acitve = false;
    });
  },

  _resultStatus: function _resultStatus() {
    var playerInfos = this._deskInfo.players;
    var user = playerInfos.find((function (user) {
      return user.id == this._userId;
    }).bind(this));

    var score = user.cScore;
    if (this._deskInfo.isRandomDesk) {
      // 如果是随机场的话，应该用钻石来判断输赢
      score = user.diamond;
    }

    if (score > 0) {
      return ResultStatus.WIN;
    } else if (score < 0) {
      return ResultStatus.LOSE;
    }

    return ResultStatus.DRAW;
  }
});

module.exports = GameResult;

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard"}],"GetCardPointsSameCount":[function(require,module,exports){
"use strict";
cc._RFpush(module, '64665arSbVGtqTVZeISv/TD', 'GetCardPointsSameCount');
// scripts\KQCard\GetCardPointsSameCount.js

/*#####*/
//��������һ���������ڵ���ͬ�������Ƶ�����
var GetCardPointsSameCount = function GetCardPointsSameCount(cards) {
    this.cardNumbers = {};
    for (var i in cards) {
        var s;
        if (typeof cards[i].number == 'undefined') {
            s = cards[i].point;
        } else {
            s = cards[i].number;
        }
        if (this.cardNumbers[s]) {
            this.cardNumbers[s]++;
        } else {
            this.cardNumbers[s] = 1;
        }
        //cc.log(this.cardNumbers[cards[i].number])
        //cc.log(cards)
        //cc.log(cards[i].number)
        //cc.log('---7')
    }
    return this.cardNumbers;
};

module.exports = GetCardPointsSameCount;

cc._RFpop();
},{}],"Invit":[function(require,module,exports){
"use strict";
cc._RFpush(module, '37d962bf0NPxaQIYUcZDwR3', 'Invit');
// scripts\Invit.js

var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }
    var isComplete = this._lastEmptyLabel() == null;
    var inviteNumber = this._roomNumber();
    if (inviteNumber.length == 6) {
      this.callbackJoinRoom = inviteNumber;
    }
  },

  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackJoinRoom;
    console.log(inviteNumber, "------------------------");
    if (inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackJoinRoom = ''; //清空邀请码
    }
  },

  clickClear: function clickClear() {
    this.callbackJoinRoom = '';
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"KQCardColorsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf1deKQQ4NMMYVV+7xEr9Jf', 'KQCardColorsHelper');
// scripts\KQCard\KQCardColorsHelper.js

// 牌花色帮助类
// 用于计算一个牌数组的花色相同的牌的张数
var KQCardColorsHelper = function KQCardColorsHelper(cards) {
  this.colorNumber = {};

  cards.forEach((function (card) {
    var color = card.color;
    var number = this.colorNumber[color] || 0;
    this.colorNumber[color] = number + 1;
  }).bind(this));
};

// 相同花色的牌的最大数量
KQCardColorsHelper.prototype.maxNumber = function () {
  var result = 0;
  for (var prop in this.colorNumber) {
    var number = this.colorNumber[prop];
    result = Math.max(number, result);
  }

  return result;
};

module.exports = KQCardColorsHelper;

cc._RFpop();
},{}],"KQCardFindTypeExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '54a95JOLVRACIP91XEFodqF', 'KQCardFindTypeExtension');
// scripts\KQCard\KQCardFindTypeExtension.js

var KQCard = require('KQCard');
var ArrayExtension = require('ArrayExtension');
var KQCardPointsHelper = require('KQCardPointsHelper');

module.exports = {};

// 寻找 cardModes 中的 对子
// 这会返回 对子 的索引数组
// 如：[[1, 3], [4, 5]]
KQCard.findDuiZi = function (cardModes) {
  var sDuiZiIndexs = KQCard.findSanTiao(cardModes) || [];
  var result = KQCard._findPointLength(cardModes, 2) || [];
  if (result.length < 2) {
    if (sDuiZiIndexs.length > 0) {
      sDuiZiIndexs.forEach(function (indexs) {
        var s1 = [indexs[0], indexs[1]];
        //var s2 = [indexs[1],indexs[2]];
        //result.push(s2);
        result.push(s1);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 2);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }

  result = KQCard.repeat(result);

  return result.length > 0 ? result : [];
};

KQCard._findPointLength = function (cardModes, length) {
  if (cardModes.length < length) {
    return [];
  }

  var obj = cardModes.reduce(function (obj, card, index) {
    var pointIndexs = obj[card.point] || [];
    obj[card.point] = pointIndexs;
    pointIndexs.push(index);
    return obj;
  }, {});

  var result = [];
  for (var prop in obj) {
    var pointIndexs = obj[prop];
    // if (pointIndexs.length == length) {
    //   pointIndexs.sort(function (n1, n2) {
    //     return n1 - n2;
    //   });
    //   result.push(pointIndexs);
    // }
    while (pointIndexs.length >= length && length != 0) {
      //有多的分割多个数组
      var splices = pointIndexs.splice(0, length);
      if (splices.length >= length) {
        splices.sort(function (n1, n2) {
          return n1 - n2;
        });
        result.push(splices);
      }
    }
  }

  result.sort(function (arr1, arr2) {
    var n1 = arr1[0];
    var n2 = arr2[0];
    return n2 - n1;
  });
  return result.length > 0 ? result : [];
};

// 找 两对 的索引数组
// 如：[[1, 2, 3, 4], [5, 6, 7, 8]]
KQCard.findLiaDui = function (cardModes) {
  var duiZiIndexs = KQCard.findDuiZi(cardModes) || [];
  var duiZiIndex = KQCard.findGuiPai(cardModes, 2) || [];

  if (duiZiIndexs.length < 1 && duiZiIndex.length > 0) {
    duiZiIndex.forEach(function (indexs) {
      duiZiIndexs.unshift(indexs);
    });
  }
  if (duiZiIndexs.length < 2) {
    return [];
  }

  var result = [];
  for (var i = 0; i < duiZiIndexs.length; ++i) {
    for (var j = i + 1; j < duiZiIndexs.length; ++j) {
      if (result.length < 10) {
        var pre = duiZiIndexs[i];
        var next = duiZiIndexs[j];
        var s = pre.concat(next);
        var newS = [];
        for (var q = 0; q < s.length; q++) {
          if (newS.indexOf(s[q]) == -1) {
            newS.push(s[q]);
          } else {
            break;
          }
        }
        if (newS.length == 4) {
          newS.sort(function (n1, n2) {
            return n1 - n2;
          });
          result.unshift(newS);
        }
      } else {
        break;
      }
    }
  }
  result = KQCard.repeat(result);
  if (result.length > 6) {
    result = result.slice(0, 6);
  }
  return result;
};

// 找三条
// 如：[[1, 2, 3]];
KQCard.findSanTiao = function (cardModes) {
  if (cardModes.length < 3) {
    return [];
  }
  var result = KQCard._findPointLength(cardModes, 3) || [];
  //for(var q =0;q<result.length;q++){
  //  var indexs = result[q][0];
  //  if(cardModes[indexs].point >= 20){
  //    result.splice(q,1);
  //  }
  //}
  if (result.length < 2) {
    var tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray.length > 0) {
      tieZhiIndexsArray.forEach(function (indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        var sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 3);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }
  /*if(result.length < 1){
    // 铁支是包含三条的
    let tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray) {
      tieZhiIndexsArray.forEach(function(indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        let sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
  }*/

  //if(result.length > 10){
  //  result = result.slice(0,10);
  //}

  result = KQCard.repeat(result);
  return result.length > 0 ? result : [];
};

// 找同花顺
/*KQCard.findTongHuaShun = function (cardModes, length = 5) {
  if (cardModes.length < length) {
    return [];
  }
  let result = [];
  var sanShunZi = KQCard.sanShunZi1(cardModes,length);
  if(sanShunZi[0] == null){
    return false;
  }
  for(var i=0;i<sanShunZi[0].length;i++) {
    var s = sanShunZi[0][i];
    if (KQCard.isTongHuaShun(s, length)) {
      result.unshift(sanShunZi[1][i]);

    }
  }
  if(result.length > 0){
    return result
  }else{
    return KQCard.findTongHuaShun1(cardModes);
  }
};*/
KQCard.findTongHuaShun = function (cards) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cards.length < length) {
    return [];
  }
  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= 5) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var start = 0; start + 5 <= s.length; ++start) {
      var subCards = s.slice(start, start + 5);
      if (KQCard.isTongHuaShun(subCards)) {
        (function () {
          var indexs = [];
          subCards.forEach(function (ca) {
            for (var q = 0; q < cards.length; q++) {
              var r = cards[q];
              if (r === ca) {
                indexs.push(q);
                break;
              }
            }
          });
          indexs.sort(Array.sortByPoint);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
      cards.forEach(function (adfs) {
        if (adfs.point == 14) {
          adfs.point = 1;
          adfs.scores = 1;
        }
      });
      return KQCard.findTongHuaShun20(cards);
    }
    return KQCard.findTongHuaShun(convertedCards);
  }
  //return result.length > 0 ? result : null;
};
KQCard.findTongHuaShun20 = function (card) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (card.length < length) {
    return false;
  }
  var card20 = KQCard.contain20(card) || [];
  if (card20.length <= 0) {
    return false;
  }
  var cards = card.kq_excludes(card20);

  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= parseInt(5 - card20.length)) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  //cc.log(colorSum)

  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var j = 1; j <= card20.length; ++j) {
      var num = 5 - j;
      for (var start = 0; start + num <= s.length; ++start) {
        var subCards = s.slice(start, start + num);
        var bool = parseInt(subCards[num - 1]['scores']) - parseInt(subCards[0]['scores']) < 5;
        if (bool) {
          var newCard20;

          (function () {
            var indexs = [];
            newCard20 = card20.slice(0, j);

            subCards = subCards.concat(newCard20);
            subCards.forEach(function (ca) {
              for (var q = 0; q < card.length; q++) {
                var r = card[q];
                if (r === ca) {
                  indexs.push(q);
                  break;
                }
              }
            });
            indexs.sort(Array.sortByNumber);

            result.unshift(indexs);
          })();
        }
      }
    }
  }
  //cc.log(result)
  //cc.log('--------357')
  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(card);
    if (card === convertedCards) {
      return [];
    }
    return KQCard.findTongHuaShun20(convertedCards);
  }
  //return result.length > 0 ? result : null;
};

// 找铁支
// 如：[[1,2,3,4]]
KQCard.findTieZhi = function (cardModes) {
  var result = KQCard._findPointLength(cardModes, 4);
  if (result.length > 0) {
    return result;
  }
  result = [];
  // 五同是包含铁支的
  var wuTongIndexsArray = KQCard.findWuTong(cardModes);
  if (wuTongIndexsArray) {
    wuTongIndexsArray.forEach(function (indexs) {
      var tieZhiIndexs0 = [indexs[0], indexs[1], indexs[2], indexs[3]];
      var tieZhiIndexs1 = [indexs[0], indexs[1], indexs[2], indexs[4]];
      var tieZhiIndexs2 = [indexs[0], indexs[1], indexs[3], indexs[4]];
      var tieZhiIndexs3 = [indexs[0], indexs[2], indexs[3], indexs[4]];
      var tieZhiIndexs4 = [indexs[1], indexs[2], indexs[3], indexs[4]];
      result.push(tieZhiIndexs0);
      result.push(tieZhiIndexs1);
      result.push(tieZhiIndexs2);
      result.push(tieZhiIndexs3);
      result.push(tieZhiIndexs4);
    });
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result);
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 4);
};
//找五同
KQCard.findWuTong = function (cardModes) {
  if (cardModes.length < 5) {
    return [];
  }
  var result = this._findPointLength(cardModes, 5) || [];
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 5);
};
// 找顺子
// 如：[[1, 2, 3, 4, 5]]
KQCard.findShunZi = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  if (typeof cardModes[0]['point'] == "undefined") {
    cardModes = KQCard.cardsFromArray(cardModes);
  }
  // 先根据点数去重
  var uniqueCards = cardModes.unique(function (card1, card2) {
    return card1.point == card2.point;
  });
  uniqueCards.sort(KQCard.sortByPoint);

  // 如果有 A，则在最后添加 14
  var cardA = cardModes.find(function (card) {
    return card.point == 1;
  });
  if (cardA) {
    var cardAPlus = new KQCard(cardA);
    cardAPlus.point = 14;
    uniqueCards.push(cardAPlus);
  }

  var result = [];

  // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
  for (var start = 0; start + length <= uniqueCards.length; ++start) {
    var subCards = uniqueCards.slice(start, start + length);
    if (KQCard.isShunZi(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {

            if (card.point == 14) {
              return originCard.point == 1;
            }

            return card === originCard;
          });
          indexs.push(index);
        });

        indexs.sort(Array.sortByNumber);
        result.unshift(indexs);
      })();
    }
  }

  // 处理点数重复的情况
  // 比如 A A K Q J 10 这种
  var repeatIndexsArray = KQCard._findRepeatPointIndexsArray(result, cardModes);
  repeatIndexsArray.forEach(function (indexs) {
    result.unshift(indexs);
  });

  result.sort(function (arr1, arr2) {
    return arr1[0] - arr2[0];
  });

  return result.length > 0 ? result : KQCard.findShunZi20(cardModes);
};
KQCard.findShunZi20 = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes);
  if (card20.length <= 0) {
    return [];
  }
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  var newArr = [];
  var newArrs = [];
  for (var i = 0; i < cards.length; i++) {
    if (newArrs.indexOf(cards[i]['point']) == -1) {
      newArr.push(cards[i]);
      newArrs.push(cards[i].point);
    }
  }

  newArr.sort(function (n1, n2) {
    return n1.point - n2.point;
  });
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = length - j;
    for (var start = 0; start + num <= newArr.length; ++start) {
      var subCards = newArr.slice(start, start + num);
      var bool = parseInt(subCards[num - 1]['point']) - parseInt(subCards[0]['point']) < length;
      if (bool) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cardModes);
    if (cardModes === convertedCards) {
      return false;
    }
    return KQCard.findShunZi20(convertedCards);
  }
};
KQCard._findRepeatPointIndexsArray = function (indexsArray, originCards) {
  var repeatIndexsArray = [];
  indexsArray.forEach(function (indexs) {
    var cards = indexs.map(function (index) {
      return originCards[index];
    });

    cards.forEach(function (card, index) {
      var originIndex = originCards.findIndex(function (originCard) {
        if (typeof card == 'undefined') {
          return;
        }
        if (originCard !== card && originCard.point == card.point) {
          return true;
        }
        return false;
      });

      if (originIndex < 0) {
        return;
      }

      var repeatIndexs = indexs.slice();
      repeatIndexs[index] = originIndex;
      repeatIndexsArray.push(repeatIndexs);
    });
  });

  return repeatIndexsArray;
};

// 找同花
// 如：[[1, 2, 3, 4, 5]]
KQCard.findTongHua = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }

  var cards = Array.from(cardModes);
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var start = 0; start + length <= cards.length; ++start) {
    var subCards = cards.slice(start, start + length);
    if (KQCard.isTongHua(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {
            return card === originCard;
          });
          indexs.push(index);
        });
        //indexs = indexs.length > 5 ? indexs.splice(1,1) : indexs;
        indexs.sort(Array.sortByNumber);
        result.unshift(indexs);
      })();
    }
  }
  return result.length > 0 ? result : KQCard.findTongHua20(cardModes);
};
KQCard.findTongHua20 = function (cardModes) {
  if (cardModes.length < 5) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes);
  if (card20.length <= 0) {
    return [];
  }
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = 5 - j;
    for (var start = 0; start + num <= cards.length; ++start) {
      var subCards = cards.slice(start, start + num);
      if (KQCard.isTongHua(subCards, num)) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  return result.length > 0 ? result : [];
};

KQCard.findHuLu = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }

  var p_3 = KQCard.findSanTiao(cardModes);
  var p_4 = KQCard.findTieZhi(cardModes);
  var p2 = KQCard.findDuiZi(cardModes) || [];
  //var p_3 =  this._findPointLength(cardModes, 3) || [];
  //var p_4 = this._findPointLength(cardModes, 4) || [];
  //var p2 = this._findPointLength(cardModes, 2) || [];
  if (p2.length <= 0) {
    if (p_3) {
      p_3.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        var sanTiaoIndexs3 = [indexs[1], indexs[2]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        p2.push(sanTiaoIndexs3);
      });
    }

    if (p_4) {
      p_4.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[1], indexs[2]];
        //let sanTiaoIndexs4 = [indexs[1], indexs[3]];
        var sanTiaoIndexs6 = [indexs[2], indexs[3]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        //p2.unshift(sanTiaoIndexs2);
        //p2.unshift(sanTiaoIndexs3);
        //p2.unshift(sanTiaoIndexs4);
        p2.push(sanTiaoIndexs6);
      });
    }
  }

  if (p2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.unshift(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : KQCard.findHuLu20(cardModes);
};
KQCard.findHuLu20 = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes) || [];
  if (card20.length <= 0) {
    return [];
  }
  var p_3 = KQCard.findGuiPai(cardModes, 3);
  var p_4 = KQCard.findGuiPai(cardModes, 4);
  var p_2 = KQCard.findGuiPai(cardModes, 2);
  if (p_2 == null) {
    p_2 = [];
  }
  if (p_3) {
    p_3.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs3 = [indexs[1], indexs[2]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs3);
    });
  }

  if (p_4) {
    p_4.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs6 = [indexs[2], indexs[3]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs6);
    });
  }

  if (p_2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p_2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.unshift(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : [];
};

KQCard.findGuiPai = function (cardModes) {
  var numBer = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

  var card20 = KQCard.contain20(cardModes).map(function (card) {
    //得到鬼牌的索引
    for (var q = 0; q < cardModes.length; q++) {
      var r = cardModes[q];
      if (r === card) {
        return q;
      }
    }
  });
  if (card20.length <= 0) {
    return [];
  }
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = numBer - j; //除鬼牌外 我应该找多少张牌匹配
    var indexs = KQCard._findPointLength(cardModes, num) || [];
    for (var t = 0; t < indexs.length; t++) {
      if (numBer == 2) {
        //是对子的时候把鬼牌和单张匹配都循环一遍
        for (var o = 0; o < card20.length; ++o) {
          var s = indexs[t].concat(card20[o]);
          if (s.length == numBer) {
            result.push(s);
          }
        }
      } else {
        var s = indexs[t].concat(card20.slice(0, j)); //依次相加鬼牌第一次加一张 递增
        if (s.length == numBer) {
          result.push(s);
        }
      }
    }
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result); //去重
  return result.length > 0 ? result : [];
};

KQCard.repeat = function (result) {
  for (var i = 0; i < result.length; i++) {
    var index = result[i];

    var newAyy = [];
    for (var o = 0; o < index.length; o++) {
      //有重复干掉你
      if (newAyy.indexOf(index[o]) == -1) {
        newAyy.push(index[o]);
      } else {
        result.splice(i, 1);
        break;
      }
    }

    for (var j = i + 1; j < result.length - 1; j++) {
      var s = result[j];
      var jString = '';
      var iString = '';
      for (var r = 0; r < s.length; r++) {
        jString = jString + s[r];
        iString = iString + index[r];
      }
      if (jString == iString) {
        //有重复干掉你
        result.splice(i, 1);
        break;
      }
    }
  }
  return result;
};

KQCard.testFind = function (cardModes) {
  var WuTong = KQCard.findWuTong(cardModes) || [];
  var TongHuaShun = KQCard.findTongHuaShun(cardModes) || [];
  var TieZhi = KQCard.findTieZhi(cardModes) || [];
  var HuLu = KQCard.findHuLu(cardModes) || [];
  var TongHua = KQCard.findTongHua(cardModes) || [];
  var ShunZi = KQCard.findShunZi(cardModes) || [];
  var SanTiao = KQCard.findSanTiao(cardModes) || [];
  var LiaDui = KQCard.findLiaDui(cardModes) || [];
  var DuiZi = KQCard.findDuiZi(cardModes) || [];
  var result = [WuTong, TongHuaShun, TieZhi, HuLu, TongHua, ShunZi, SanTiao, LiaDui, DuiZi];
  return result;
};

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","KQCard":"KQCard","KQCardPointsHelper":"KQCardPointsHelper"}],"KQCardPointsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '42d3e866XhHdbkspy3Qytap', 'KQCardPointsHelper');
// scripts\KQCard\KQCardPointsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardPointsHelper = function KQCardPointsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.point;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardPointsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardPointsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardResHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'be420vtWaJOHoxQcZwP2xN2', 'KQCardResHelper');
// scripts\KQCard\KQCardResHelper.js

var Helper = {
  loadCardSpriteFrame: function loadCardSpriteFrame(cardName, callback) {
    this._loadCardFrame(cardName, callback);
  },

  setCardSpriteFrame: function setCardSpriteFrame(sprite, cardName) {
    this.loadCardSpriteFrame(cardName, function (spriteFrame) {
      sprite.spriteFrame = spriteFrame;
    });
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        callback(null, err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
};

module.exports = Helper;

cc._RFpop();
},{}],"KQCardScoreExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3f5d8wDA+tMPbPd/k4hBAAR', 'KQCardScoreExtension');
// scripts\KQCard\KQCardScoreExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardScoretsHelper = require('KQCardScoretsHelper');
var GetCardPointsSameCount = require('GetCardPointsSameCount');
var KQCardPointsHelper = require('KQCardPointsHelper');

KQCard.scoreOfCards = function (cards) {
  if (cards == null || cards.length == null) {
    cards = [];
  }

  var isTou = cards.length == 3;
  var typeScore = KQCard._typeScoreOfCards(cards);
  var caleCards = KQCard._convertOneToA(cards.slice());
  caleCards.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  //caleCards = KQCard.Sort(caleCards);
  var card20 = KQCard.contain20(caleCards);
  var pointHelper = new KQCardScoretsHelper(caleCards.kq_excludes(card20));
  var maxNum = pointHelper.maxNumber() /*-card20.length == 0 ? 1: pointHelper.maxNumber()-card20.length*/;

  var maxScore = 0; //获取除鬼牌外最大的的点数
  for (var i in pointHelper.pointNumbers) {
    if (parseInt(i) > maxScore && pointHelper.pointNumbers[i] == maxNum) {
      maxScore = parseInt(i);
    }
  }
  caleCards.forEach(function (card) {
    if (card.scores >= 20) {
      card.scores = maxScore;
    }
  });
  card20.forEach(function (card) {
    card.scores = maxScore;
  });
  //cc.log(maxNum)
  //cc.log(maxScore)
  //cc.log(caleCards.kq_excludes(card20))
  //cc.log('----35')
  caleCards.sort(KQCard.sort);
  if (typeScore == 9000000000000000) {
    //五同
    caleCards.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var totalValue = "";
    //var totalColor = "";
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      //var c = caleCards[i].color;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      //totalColor = c+totalColor;
    }
    //totalValue = totalValue+totalColor;
    //cc.log(totalValue)
    //cc.log(parseInt(totalValue))
    //cc.log(typeScore+parseInt(totalValue))
    return typeScore + parseInt(totalValue);
  } else if (typeScore == 8000000000000000) {
    //同花顺比最大的那张，如果两张相同那就是相同
    if (card20.length > 0) {
      //有鬼牌的时候要改变鬼牌的分数
      caleCards = KQCard._changeCardScors(caleCards);
    }
    var totalValue = "";
    var valueColor = ""; //牌色
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      var c = caleCards[i].color; //牌色
      valueColor = c + valueColor; //牌色
    }
    if (cc.huaSe == 0) return typeScore + parseInt(totalValue);
    return typeScore + parseInt(totalValue + valueColor);
  } else if (typeScore == 7000000000000000) {
    //铁支,找出那四张是什么牌

    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }
    //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
    //var qwe = '';
    //qwe = oneValueColor.substr(0,oneValueColor.length -1);
    //oneValueColor = oneValueColor.substr(oneValueColor.length -1);
    //str = str+oneValue + oneValueColor + valueColor + qwe;
    //return typeScore+parseInt(str);
    return typeScore + parseInt(str + oneValue);
  } else if (typeScore == 6000000000000000) {
    //葫芦
    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }

    if (isTou) {
      oneValue = oneValue + '0000';
      oneValueColor = oneValueColor + '00';
    }
    return typeScore + parseInt(str + oneValue);
    //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
    //str = str+oneValue + valueColor + oneValueColor;
    //return typeScore+parseInt(str);
  } else if (typeScore == 5000000000000000) {
      //同花,有可能需要比5张牌
      var totalScore = "";
      var totalColor = "";
      //var colors = 0;//获取牌的类型颜色
      //for(var i in caleCards) {
      //  if(parseInt(caleCards[i].point) < 20){
      //    colors = parseInt(caleCards[i].color);
      //    break;
      //  }
      //}

      for (var i in caleCards) {
        var paiPoint = parseInt(caleCards[i].point);
        var colors = parseInt(caleCards[i].point) < 20 ? caleCards[i].color : 5;
        totalColor = colors + totalColor;
        totalScore = (paiPoint >= 10 ? paiPoint : "0" + paiPoint) + totalScore;
      }
      return typeScore + parseInt(totalScore);
      //if(cc.huaSe == 0) return typeScore+parseInt(totalScore);
      //return typeScore+parseInt(totalScore+totalColor);
    } else if (typeScore == 4000000000000000) {
        //顺子
        if (card20.length > 0) {
          //有鬼牌的时候要改变鬼牌的分数
          caleCards = KQCard._changeCardScors(caleCards);
        }
        var totalValue = "";
        var valueColor = ""; //牌色
        for (var i in caleCards) {
          var s = caleCards[i].scores;
          totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;

          var c = caleCards[i].color; //牌色
          valueColor = c + valueColor; //牌色
        }
        return typeScore + parseInt(totalValue);
        //if(cc.huaSe == 0) return typeScore+parseInt(totalValue);
        //return typeScore+parseInt(totalValue + valueColor);
      } else if (typeScore == 3000000000000000) {
          //三条，找出是哪张牌有3张
          //caleCards.sort(KQCard.sort);
          var str = "";
          var oneValue = "";
          var valueColor = ""; //牌色
          var oneValueColor = ""; //牌色
          var oneValueColor20 = ""; //牌色
          for (var w in caleCards) {
            if (maxScore == caleCards[w].scores) {
              //三条
              var s = caleCards[w].scores;
              str = (parseInt(s) >= 10 ? s : "0" + s) + str;

              var c = caleCards[w].color; //牌色
              valueColor = c + valueColor; //牌色
            } else {
                var s = caleCards[w].scores;
                oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

                var c = caleCards[w].color; //牌色
                if (parseInt(s) < 20) {
                  oneValueColor = c + oneValueColor; //牌色
                } else {
                    oneValueColor20 = c + oneValueColor20; //牌色
                  }
              }
          }
          if (isTou) {
            oneValue = oneValue + '0000';
            valueColor = valueColor + '00';
          }
          return typeScore + parseInt(str + oneValue);
          //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
          //str = str+oneValue + oneValueColor + valueColor + oneValueColor20;
          //return typeScore+parseInt(str);
        } else if (typeScore == 2000000000000000) {
            //caleCards.sort(KQCard.sort);
            //两对,有可能需要比5张牌
            var str = "";
            var oneValue = '';
            var valueColor = ""; //牌色
            var oneValueColor = ""; //牌色
            for (var i in pointHelper.pointNumbers) {
              if (pointHelper.pointNumbers[i] == 2) {
                //两对
                for (var w in caleCards) {
                  if (i == caleCards[w].scores) {
                    var s = caleCards[w].scores;
                    str = (parseInt(s) >= 10 ? s : "0" + s) + str;
                    var c = caleCards[w].color; //牌色
                    valueColor = c + valueColor; //牌色
                  }
                }
              } else {
                  for (var q in caleCards) {
                    //单张加花色
                    if (i == caleCards[q].scores) {
                      var s = caleCards[q].scores;
                      oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

                      var c = caleCards[q].color; //牌色
                      oneValueColor = oneValueColor + c; //牌色
                    }
                  }
                }
            }
            return typeScore + parseInt(str + oneValue);
            //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
            ////cc.log(str)
            ////cc.log(oneValue)
            //str = str+oneValue +oneValueColor + valueColor;
            //return typeScore+parseInt(str);
          } else if (typeScore == 1000000000000000) {
              //对子
              //caleCards.sort(KQCard.sort);
              var str = "";
              var oneValue = "";
              var oneValueColor = "";
              var valueColor = "";

              if (card20.length > 0) {
                caleCards.sort(function (card1, card2) {
                  return card2.point - card1.point;
                });
                caleCards = caleCards.kq_excludes(card20);
                caleCards.forEach(function (card, index) {
                  var s = card.scores;
                  var c = card.color;
                  str = str + (parseInt(s) >= 10 ? s : "0" + s);
                  if (index == 0) {
                    var s20 = card20[0].scores;
                    str = str + (parseInt(s20) >= 10 ? s20 : "0" + s20);
                    valueColor = valueColor + c;
                    valueColor = valueColor + card20[0].color;
                  } else {
                    oneValueColor = oneValueColor + c;
                  }
                });
                //cc.log(str)
                //cc.log('--------274')
                if (isTou) {
                  str = str + '0000';
                  valueColor = valueColor + '00';
                }
                return typeScore + parseInt(str);
                //if(cc.huaSe == 0) return typeScore+parseInt(str);
                //str = str + oneValueColor + valueColor;
                //return typeScore+parseInt(str);
              }

              for (var i in pointHelper.pointNumbers) {
                if (pointHelper.pointNumbers[i] == maxNum) {
                  //对子
                  for (var w in caleCards) {
                    //对子加花色
                    if (i == caleCards[w].scores) {
                      var s = caleCards[w].scores;
                      valueColor = caleCards[w].color + valueColor;
                      str = (parseInt(s) >= 10 ? s : "0" + s) + str;
                    }
                  }
                } else {
                  for (var q in caleCards) {
                    //单张加花色
                    if (i == caleCards[q].scores) {
                      var s = caleCards[q].scores;
                      oneValueColor = caleCards[q].color + oneValueColor;
                      oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;
                    }
                  }
                }
              }
              if (isTou) {
                oneValue = oneValue + '0000';
                valueColor = valueColor + '00';
              }
              return typeScore + parseInt(str + oneValue);
              //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
              //str = str+oneValue+oneValueColor+valueColor;
              //return typeScore+parseInt(str);
            } else if (typeScore == 0) {
                //乌龙
                var valuePoint = "";
                var valueColor = "";
                for (var q in caleCards) {
                  var s = caleCards[q].scores;
                  var c = caleCards[q].color; //单张加花色
                  valuePoint = (parseInt(s) >= 10 ? s : "0" + s) + valuePoint;
                  valueColor = c + valueColor;
                }
                if (isTou) {
                  valuePoint = valuePoint + '0000';
                  valueColor = valueColor + '00';
                }
                return typeScore + parseInt(valuePoint);
                //if(cc.huaSe == 0) return typeScore+parseInt(valuePoint);
                //valuePoint = valuePoint + valueColor;
                //return typeScore+parseInt(valuePoint);
              }

  var cardsTotalPoint = 0;
  caleCards.forEach(function (card) {
    cardsTotalPoint += card.point;
  });

  var result = typeScore + cardsTotalPoint;
  return result;
};
KQCard._changeCardScors = function (cardModel) {
  cardModel.forEach(function (card) {
    card.scores = card.point;
    if (card.scores == 1) {
      card.scores = 14;
    }
  });

  var is14 = true; //是 k q j 10 A;
  var is1 = true; //是1 2 3 4 5

  cardModel.forEach(function (card) {
    if (card.scores < 10) {
      is14 = false; //不是 k q j 10 A;
    }
  });
  cardModel.forEach(function (card) {
    card.scores = card.point;
    if (card.scores == 14) {
      card.scores = 1;
    }
  });
  cardModel.forEach(function (card) {
    if (card.scores > 5 && card.scores != 20) {
      is1 = false; //不是1 2 3 4 5
    }
  });

  if (is14) {
    //是 k q j 10 A;
    cardModel.forEach(function (card) {
      if (card.scores == 1) {
        card.scores = 14;
      }
    });

    cardModel.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var num = 14;
    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      scoresAyy.push(num);
      num -= 1;
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    //cc.log('----------是 k q j 10 A',scoresAyy)
    cardModel.forEach((function (card) {
      //找出选中的牌
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  } else if (is1) {
    //是1 2 3 4 5
    cardModel.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var num = 5;
    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      scoresAyy.push(num);
      num -= 1;
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    //cc.log('----------是1 2 3 4 5')
    cardModel.forEach((function (card) {
      //找出选中的牌
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  } else {
    cardModel.sort(function (a1, a2) {
      return a1.scores - a2.scores;
    });
    var scoresAyy = []; //用来装鬼牌分数
    for (var i = 0; i < 5; i++) {
      var s = parseInt(cardModel[0].scores) + i; //最小的牌的分数
      scoresAyy.push(s); //一副牌的分数
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    cardModel.forEach((function (card) {
      //改变牌的分数
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  }

  cardModel.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  cardModel.sort(function (a1, a2) {
    return a1.scores - a2.scores;
  });
  return cardModel;
};
/*#####*/

KQCard._typeScoreOfCards = function (cards) {
  var typeScore = 0;
  if (KQCard.containWuTong(cards)) {
    typeScore = 9000000000000000;
  } else if (KQCard.containTongHuaShun(cards)) {
    typeScore = 8000000000000000;
  } else if (KQCard.containTieZhi(cards)) {
    typeScore = 7000000000000000;
  } else if (KQCard.containHuLu(cards)) {
    typeScore = 6000000000000000;
  } else if (KQCard.containTongHua(cards)) {
    typeScore = 5000000000000000;
  } else if (KQCard.containShunZi(cards)) {
    typeScore = 4000000000000000;
  } else if (KQCard.containSanTiao(cards)) {
    typeScore = 3000000000000000;
  } else if (KQCard.containLiaDui(cards)) {
    typeScore = 2000000000000000;
  } else if (KQCard.containDuiZi(cards)) {
    typeScore = 1000000000000000;
  }

  return typeScore;
};
/*
 // 根据牌型进行排序
 KQCard._typeCardsSort = function (cards) {
 if ((cards == null) || (cards.length == 0)) {
 return cards;
 }
 if(KQCard.containWuTong(cards)){
 return KQCard._typeCardsSortWutong(cards);
 } else if (KQCard.containTongHuaShun(cards)) {
 return KQCard._typeCardsSortShunZi(cards);
 } else if (KQCard.containTieZhi(cards)) {
 return KQCard._typeCardsSortTieZhi(cards);
 } else if (KQCard.containHuLu(cards)) {
 return KQCard._typeCardsSortHuLu(cards);
 } else if (KQCard.containTongHua(cards)) {
 return KQCard._typeCardsSortTongHua(cards);
 } else if (KQCard.containShunZi(cards)) {
 return KQCard._typeCardsSortShunZi(cards);
 } else if (KQCard.containSanTiao(cards)) {
 return KQCard._typeCardsSortSanTiao(cards);
 } else if (KQCard.containLiaDui(cards)) {
 return KQCard._typeCardsSortLiangDui(cards);
 } else if (KQCard.containDuiZi(cards)) {
 return KQCard._typeCardsSortDuiZi(cards);
 }

 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortShunZi = function (cards) {
 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortTieZhi = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 /!*#####*!/
 KQCard._typeCardsSortWutong = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };
 /!*#####*!/

 KQCard._typeCardsSortHuLu = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortTongHua = function (cards) {
 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortSanTiao = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortLiangDui = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortDuiZi = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };
 */
KQCard._typeCardsSortByNumberOfPoints = function (cards) {

  cards = KQCard._changeGuiCard(cards);

  cards.forEach(function (i) {
    if (i.scores == 1) i.scores = 14;
  });

  var pointHelper = new KQCardScoretsHelper(cards);
  var newCards = cards.slice().sort(function (card1, card2) {
    var numberOfCard1 = pointHelper.pointNumbers[card1.scores];
    var numberOfCard2 = pointHelper.pointNumbers[card2.scores];

    if (numberOfCard2 != numberOfCard1) {
      return numberOfCard2 - numberOfCard1;
    }
    var scores1 = card1.scores == 1 ? 14 : card1.scores;
    var scores2 = card2.scores == 1 ? 14 : card2.scores;
    return scores2 - scores1;
    //return card2.scores - card1.scores;
  });
  newCards.forEach(function (i) {
    if (i.scores == 14) i.scores = 1;
  });
  return newCards /*.concat(card20)*/;
};

KQCard._typeCardsSortByNumberOfPoints1 = function (cards) {

  cards = KQCard._changeGuiCard(cards);

  cards.forEach(function (i) {
    if (i.scores == 1) i.scores = 14;
  });

  var pointHelper = new KQCardScoretsHelper(cards);
  var newCards = cards.slice().sort(function (card1, card2) {
    var numberOfCard1 = pointHelper.pointNumbers[card1.scores];
    var numberOfCard2 = pointHelper.pointNumbers[card2.scores];

    if (numberOfCard2 != numberOfCard1) {
      return numberOfCard1 - numberOfCard2;
    }
    var scores1 = card1.scores == 1 ? 14 : card1.scores;
    var scores2 = card2.scores == 1 ? 14 : card2.scores;
    return scores1 - scores2;
    //return card1.scores - card2.scores;
  });
  newCards.forEach(function (i) {
    if (i.scores == 14) i.scores = 1;
  });
  return newCards;
};

KQCard._changeGuiCard = function (cards) {

  var card20 = KQCard.contain20(cards);

  var ca = cards.kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var type = KQCard.cardsType(cards) + 1;

  type = type >= 10 ? type : "0" + type;

  if (type == "05" || type == "09") {

    return KQCard._changeCardScors(cards);
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }
    color = ca[0].color;

    so = so == 14 ? 1 : so;

    card20.forEach(function (n) {

      n.scores = so;

      n.colorScores = color;
    });
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    card20.forEach((function (n) {

      n.scores = so;

      n.colorScores = color;
    }).bind(this));
  }

  return card20.concat(ca);
};

KQCard._setGuiCard = function (index, start, end, type, cards, nodes, cardSpriteAtlas) {
  //cc.log(cardSpriteAtlas)
  //cc.log('-----593')
  var card20 = KQCard.contain20(cards[index]);

  var ca = cards[index].kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var node = nodes.slice(start, end).filter(function (n) {

    if (n.childrenCount > 0 && n.children[0].cardName) {

      if (parseInt(n.children[0].cardName.split("_")[1]) == 20) return true;
    }
  });

  if (type == "05" || type == "09") {

    cards[index] = KQCard._changeCardScors(cards[index]);

    so = cards[index].filter(function (i) {
      if (i.point == 20) return true;
    }).map(function (i) {
      return i.scores == 14 ? 1 : i.scores;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = ca[0].color + "_" + so.splice(0, 1)[0];

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    color = ca[0].color;

    so = so == 14 ? 1 : so;

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
};

KQCard._setGuiCards = function (type, cards, nodes, cardSpriteAtlas) {
  //cc.log(cardSpriteAtlas)
  //cc.log('-----593')
  var card20 = KQCard.contain20(cards);

  var ca = cards.kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var node = nodes.slice().filter(function (n) {

    if (n.childrenCount > 0 && n.children[0].cardName) {

      if (parseInt(n.children[0].cardName.split("_")[1]) == 20) return true;
    }
  });

  if (type == "05" || type == "09") {

    cards = KQCard._changeCardScors(cards);

    so = cards.filter(function (i) {
      if (i.point == 20) return true;
    }).map(function (i) {
      return i.scores == 14 ? 1 : i.scores;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = ca[0].color + "_" + so.splice(0, 1)[0];

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    color = ca[0].color;

    so = so == 14 ? 1 : so;

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
};

KQCard._loadCardFrame = function (SpriteFrame, path, SpritesNode, w, h) {
  //cc.log(SpriteFrame)
  //cc.log('---769')
  var Sprite = SpriteFrame.getSpriteFrame(path);

  SpritesNode.spriteFrame = Sprite;

  if (w) SpritesNode.node.width = w;

  if (h) SpritesNode.node.height = h;
};

KQCard.testScore = function () {};

cc._RFpop();
},{"GetCardPointsSameCount":"GetCardPointsSameCount","KQCard":"KQCard","KQCardColorsHelper":"KQCardColorsHelper","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardPointsHelper":"KQCardPointsHelper","KQCardScoretsHelper":"KQCardScoretsHelper"}],"KQCardScoretsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3d3b5YPHXhN44h/B0miZFRE', 'KQCardScoretsHelper');
// scripts\KQCard\KQCardScoretsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardScoretsHelper = function KQCardScoretsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.scores;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardScoretsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardScoretsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardSelectExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '66642YNpFVIzb+JM2CkwEgS', 'KQCardSelectExtension');
// scripts\KQCard\KQCardSelectExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');

// 牌自动选择的扩展

/**
 * 自动选择牌，由大到小
 *
 * @param  {[KQCard]} originCards  被选择的原始牌数组
 *
 * @return {[KQCard]}
 */
KQCard.autoSelectCards = function (originCards, maxLength) {
    if (originCards.length <= maxLength) {
        return originCards;
    }
    originCards.forEach(function (card) {
        if (card.scores == 1) {
            card.scores = 14;
        }
    });
    var cards = originCards.slice().sort(function (a, b) {
        return a.scores - b.scores;
    });

    var findFuncs = [KQCard.findWuTong, KQCard.findTongHuaShun, KQCard.findTieZhi, KQCard.findHuLu, KQCard.findTongHua, KQCard.findShunZi, KQCard.findSanTiao, KQCard.findLiaDui, KQCard.findDuiZi];

    var indexArrays = null;
    for (var i = 0; i < findFuncs.length; ++i) {
        var func = findFuncs[i];
        indexArrays = func.bind(KQCard)(cards);
        if (indexArrays && indexArrays.length > 0) {
            break;
        }
    }

    var indexs = [];
    if (indexArrays && indexArrays.length > 0) {
        // 找出同类型的牌里的分数最大的牌
        var maxScore = 0;
        indexArrays.forEach(function (tempIndexs) {
            var tempCards = tempIndexs.map(function (index) {
                return cards[index];
            });
            var score = KQCard.scoreOfCards(tempCards);
            if (score > maxScore) {
                maxScore = score;
                indexs = tempIndexs;
            }
        });
    }

    var targetCards = indexs.map(function (index) {
        return cards[index];
    });

    /*if (targetCards.length < maxLength) {
     cards = cards.kq_excludes(targetCards);
     while(targetCards.length < maxLength) {
     targetCards.push(cards.pop());
     }
     } else */if (targetCards.length > maxLength) {
        targetCards = targetCards.slice(0, maxLength);
    }

    return targetCards || [];
};

KQCard.testAutoSelect = function (cards) {};

cc._RFpop();
},{"KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension"}],"KQCard":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c548c0gMf5BGIH4309MULw+', 'KQCard');
// scripts\KQCard\KQCard.js

var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardPointsHelper = require('KQCardPointsHelper');
var NumberExtension = require('NumberExtension');
var GetCardPointsSameCount = require('GetCardPointsSameCount');

cc = cc || {};
cc.assert = cc.assert || console.assert || function () {};
cc.log = cc.log || console.log || function () {};
cc.error = cc.error || console.error || function () {};

// 牌 Model 类，封装了花色和点数
// 使用：
// new KQCard(22);
var KQCard = function KQCard(point, color, index) {
    this.color = null;
    this.point = null;
    this.sindex = index;
    this._initWithColorAndPoint = function (color, point) {
        if (color == 's') {
            color = 4;
        }
        if (color == 'h') {
            color = 3;
        }
        if (color == 'c') {
            color = 2;
        }
        if (color == 'd') {
            color = 1;
        }

        this.point = Number(point);
        this.scores = Number(point);
        this.color = Number(color);
        this.colorScores = Number(color);

        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithNumber = function (number) {
        this.point = Math.floor(number / 10);
        this.color = number % 10;
        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithObject = function (object) {
        if (object.point) {
            this._initWithColorAndPoint(object.color, object.point);
        } else if (object.suit) {
            this._initWithColorAndPoint(object.suit, object.number);
        }
    };

    this.description = function () {
        return this.cardName();
    };

    this.cardName = function () {
        return this.color + "_" + this.point;
    };

    this.sort = function (otherCard) {
        var asc = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var AisMax = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

        return KQCard.sort(this, otherCard, asc, AisMax);
    };

    this.isEqual = function (otherCard) {
        if (!otherCard) {
            return false;
        }
        return this.point == otherCard.point && this.color == otherCard.color && this.sindex == otherCard.sindex;
    };

    if (point && color) {
        this._initWithColorAndPoint(color, point);
        return;
    }

    var number = Number(point);
    if (!Number.isNaN(number)) {
        this._initWithNumber(number);
        return;
    }

    if (typeof point == 'string') {
        // 解析 xxxxd_d 形式
        var found = point.match(/(\.)*\d_\d+/);
        if (found instanceof Array && found.length > 0) {
            var result = found[0];
            var numbers = result.split('_');

            var _color = Number(numbers[0]);
            var _point = Number(numbers[1]);

            this._initWithColorAndPoint(_color, _point);
        }

        return;
    }

    if (typeof point == 'object') {
        this._initWithObject(point);
        return;
    }

    cc.error("初始化错误：" + point + " " + color);
};

// 转换成服务器的牌 model
KQCard.prototype.toServerCard = function () {
    return {
        'suit': this.color,
        'number': this.point
    };
};

KQCard.COLOR_SPADE = 4;
KQCard.COLOR_HEART = 3;
KQCard.COLOR_CLUB = 2;
KQCard.COLOR_DIAMOND = 1;

module.exports = KQCard;

KQCard.cardsFromArray = function (cardNames) {
    return cardNames.map(function (cardName, index) {
        return new KQCard(cardName, null, index);
    });
};

// 将多张牌转换成服务器的形式
KQCard.convertToServerCards = function (cards) {
    return cards.map(function (card) {
        return card.toServerCard();
    });
};

KQCard.TYPE = {
    WuLong: 0,
    DuiZi: 1,
    LiangDui: 2,
    SanTiao: 3,
    ShunZi: 4,
    TongHua: 5,
    HuLu: 6,
    TieZhi: 7,
    TongHuaShun: 8,
    /*#####*/
    WuTong: 9,
    /*#####*/
    SanTaoHua: 10, // 特殊牌
    SanShunZi: 11,
    LiuDuiBan: 12,

    WuDuiSanTiao: 13,
    SiTaoSanTiao: 14,

    CouYiSe: 15,
    SanFenTianXia: 16,
    SanTongHuaShun: 17,
    YiTiaoLong: 18,
    QingLong: 19
};

// 牌类型名
KQCard.cardsTypeName = function (cards) {
    var names = ['乌龙', '对子', '两对', '三条', '顺子', '同花', '葫芦', '铁支', '同花顺', '五同', '三同花', '三顺子', '六对半', '五对三条', '四套三条', '凑一色', '三分天下', '三同花顺', '一条龙', '清龙'];
    var type = KQCard.cardsType(cards);
    return names[type];
};

// 找出牌的类型
KQCard.cardsType = function (cards) {
    if (KQCard.isQingLong(cards)) {
        return KQCard.TYPE.QingLong;
    }

    if (KQCard.isYiTiaoLong(cards)) {
        return KQCard.TYPE.YiTiaoLong;
    }

    //if (KQCard.isSanTongHuaShun(cards)) {
    //    return KQCard.TYPE.SanTongHuaShun;
    //}
    //
    //if (KQCard.isSanFenTianXia(cards)) {
    //    return KQCard.TYPE.SanFenTianXia;
    //}

    if (KQCard.isLiuDuiBan(cards)) {
        return KQCard.TYPE.LiuDuiBan;
    }

    if (KQCard.isSanTongHua(cards)) {
        return KQCard.TYPE.SanTaoHua;
    }

    if (KQCard.isSanShunZi(cards)) {
        return KQCard.TYPE.SanShunZi;
    }

    //if (KQCard.isCouYiSe(cards)) {
    //    return KQCard.TYPE.CouYiSe;
    //}
    //
    //if (KQCard.isWuDuiSanTiao(cards)) {
    //    return KQCard.TYPE.WuDuiSanTiao;
    //}
    //
    //if (KQCard.isSiTaoSanTiao(cards)) {
    //    return KQCard.TYPE.SiTaoSanTiao;
    //}

    /*#####*/
    if (KQCard.containWuTong(cards, 5)) {
        return KQCard.TYPE.WuTong;
    }

    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    //
    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    /*#####*/

    if (KQCard.containTongHuaShun(cards, 5)) {
        return KQCard.TYPE.TongHuaShun;
    }

    if (KQCard.containTieZhi(cards)) {
        return KQCard.TYPE.TieZhi;
    }

    if (KQCard.containHuLu(cards)) {
        return KQCard.TYPE.HuLu;
    }

    if (KQCard.containTongHua(cards)) {
        return KQCard.TYPE.TongHua;
    }

    if (KQCard.containShunZi(cards)) {
        return KQCard.TYPE.ShunZi;
    }

    if (KQCard.containSanTiao(cards)) {
        return KQCard.TYPE.SanTiao;
    }

    if (KQCard.containLiaDui(cards)) {
        return KQCard.TYPE.LiangDui;
    }

    if (KQCard.containDuiZi(cards)) {
        return KQCard.TYPE.DuiZi;
    }

    return KQCard.TYPE.WuLong;
};

// 判断是否是同花
KQCard.isTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    var colors = cards.map(function (card) {
        return card.color;
    });

    var color = colors[0];
    for (var index in colors) {
        var e = colors[index];
        if (e != color) {
            return false;
        }
    }
    return true;
};

// 是否包含同花
KQCard.containTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    //if (KQCard.findTongHua(cards).length > 0) {
    //    return true;
    //}
    //return false;
    cards = Array.from(cards);
    cards.sort(KQCard.sortByColor);

    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    minLength = minLength - card20.length;

    for (var start = 0; start + minLength <= cards.length; ++start) {
        var subCards = cards.slice(start, start + minLength);
        if (KQCard.isTongHua(subCards, minLength)) {
            return true;
        }
    }

    //return KQCard.containTongHua20(cards);
};
KQCard.containTongHua20 = function (card) {
    if (card.length < 5) {
        return false;
    }
    var card20 = KQCard.contain20(card);
    var cards = card.kq_excludes(card20);
    cards.sort(KQCard.sortByColor);

    for (var j = 1; j <= card20.length; ++j) {
        var num = 5 - j;
        for (var start = 0; start + num <= cards.length; ++start) {
            var subCards = cards.slice(start, start + num);
            if (KQCard.isTongHua(subCards, num)) {
                return true;
            }
        }
    }
    return false;
};
// 判断是否是顺子
KQCard.isShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    if (KQCard._isShunZiAKQ(cards)) {
        return true;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });

    var point = points[0];
    for (var index in points) {
        var e = points[index];
        if (e != point) {
            return false;
        }

        point = point + 1;
    }

    return true;
};

// 判断是否是 A K Q J 10 这个顺子
KQCard._isShunZiAKQ = function (cards) {
    var length = cards.length;
    if (length.length < 3) {
        return false;
    }

    var point1s = [1];
    var point14s = [14];
    var pointK = 13;

    Number(length - 1).kq_times(function (times) {
        point1s.push(pointK - times);
        point14s.push(pointK - times);
    });

    return KQCard._isCardsContainPoints(cards, point1s) || KQCard._isCardsContainPoints(cards, point14s);
};

// cards 中是否包含 points 这些点数

KQCard._isCardsContainPoints = function (cards, points) {
    var _loop = function (index) {
        var point = points[index];
        var pointCardIndex = cards.findIndex(function (card) {
            return card.point == point;
        });

        if (pointCardIndex < 0) {
            return {
                v: false
            };
        }
    };

    for (var index = 0; index < points.length; ++index) {
        var _ret = _loop(index);

        if (typeof _ret === 'object') return _ret.v;
    }

    return true;
};
KQCard.contain20 = function (cards) {
    if (cards.length <= 0) {
        return [];
    }
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var newCard = cards.filter(function (card) {
        //重新赋值cards
        if (card.point >= 20) {
            return card;
        }
    });
    return newCard || [];
};
// 是否包含顺子
KQCard.containShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findShunZi(cards).length > 0) {
        return true;
    }
    return false;
    //let uniqueCards = cards.unique(function(card1, card2) {
    //    return card1.point == card2.point;
    //});
    //uniqueCards.sort(KQCard.sortByPoint);
    //
    //let minPointCard = uniqueCards[0];
    //if (minPointCard.point == 1) {
    //    let APlusCard = new KQCard(minPointCard);
    //    APlusCard.point = 14;
    //    uniqueCards.push(APlusCard);
    //}
    //
    //for (var start = 0; (start + minLength) <= uniqueCards.length; ++start) {
    //    let subCards = uniqueCards.slice(start, start + minLength);
    //    if (KQCard.isShunZi(subCards, minLength)) {
    //        return true;
    //    }
    //}
    //
    //return KQCard.containShunZi20(cards);
};
/*KQCard.containShunZi20 = function (card) {
 if (card.length < 5) {
 return false;
 }
 var card20 = KQCard.contain20(card);
 var cards = card.kq_excludes(card20);
 // 先根据点数去重
 var newArr = [];
 var newArrs = [];
 for (var i = 0; i < cards.length; i++) {
 if (newArrs.indexOf(cards[i].point) == -1) {
 newArr.push(cards[i]);
 newArrs.push(cards[i].point);
 }
 }
 //newArr.forEach(function(card){
 //    if(card.scores == 14){
 //        card.scores = 1;
 //    }
 //})
 newArr.sort(function (n1, n2) {
 return n1.point - n2.point;
 });
 for(var j = 1;j <= card20.length;++j){
 var num = 5 - j;
 for (var start = 0; (start + num) <= newArr.length; ++start) {
 var subCards = newArr.slice(start, start + num);
 var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
 if(bool){
 return true;
 }
 }
 }
 // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
 let convertedCards = KQCard._convertOneToA1(card);
 if (card === convertedCards) {
 return false;
 }
 return KQCard.containShunZi20(convertedCards);
 };*/
// 是否是同花顺
KQCard.isTongHuaShun = function (cards) {
    return KQCard.isTongHua(cards) && KQCard.isShunZi(cards);
};

// 是否包含有同花顺
KQCard.containTongHuaShun = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findTongHuaShun(cards).length > 0) {
        return true;
    }
    return false;
    //var sanShunZi = KQCard.sanShunZi1(cards,minLength)[0];
    //if(sanShunZi == null){
    //    return false;
    //}
    //var result = false;
    //for(var i=0;i<sanShunZi.length;i++) {
    //    var s = sanShunZi[i];
    //    if (KQCard.isTongHuaShun(s, minLength)) {
    //        return true;
    //    }
    //}
    //return KQCard.containTongHuaShun1(cards);
};
/*KQCard.containTongHuaShun1 = function (cards, minLength = 5) {
 if (cards.length < minLength) {
 return false;
 }
 let tempCards = Array.from(cards).sort(KQCard.sortByColor);
 for (var start = 0; (start + minLength) <= tempCards.length; ++start) {
 let subCards = tempCards.slice(start, start + minLength);
 if (KQCard.isTongHuaShun(subCards, minLength)) {
 return true;
 }
 }

 let convertedCards = KQCard._convertOneToA1(cards);
 if (cards === convertedCards) {
 return KQCard.containTongHuaShun20(cards);
 }
 return KQCard.containTongHuaShun1(convertedCards);
 //return false;
 };
 KQCard.containTongHuaShun20 = function (card, minLength = 5) {
 if (card.length < minLength) {
 return false;
 }
 var card20 = KQCard.contain20(card) || [];
 var cards = card.kq_excludes(card20);

 cards = Array.from(cards);
 var colorS = []; //黑桃
 var colorH = []; //红心
 var colorC = []; //梅花
 var colorD = []; //方块
 var pointS = []; //黑桃
 var pointH = []; //红心
 var pointC = []; //梅花
 var pointD = []; //方块
 for(var i=0;i<cards.length;i++){
 if(cards[i].color == '4'){
 if(pointS.indexOf(cards[i].point) == -1){
 pointS.push(cards[i].point);
 colorS.push(cards[i]);
 }

 }else if(cards[i].color == '3'){
 if(pointH.indexOf(cards[i].point) == -1){
 pointH.push(cards[i].point);
 colorH.push(cards[i]);
 }
 }else if(cards[i].color == '2'){
 if(pointC.indexOf(cards[i].point) == -1){
 pointC.push(cards[i].point);
 colorC.push(cards[i]);
 }
 }else if(cards[i].color == '1'){
 if(pointD.indexOf(cards[i].point) == -1){
 pointD.push(cards[i].point);
 colorD.push(cards[i]);
 }
 }
 }

 var color = [colorS,colorH,colorC,colorD];
 var colorSum = [];    //总共有几种花色 [5,3,0....]
 for(var i=0;i<color.length;i++){
 if(color[i].length >= parseInt(5 - card20.length)){
 //color[i].forEach(function(ca){
 //    if(ca.scores == 14){
 //        ca.scores = 1;
 //    }
 //})
 color[i].sort(function(a1,a2){
 return a1 - a2;
 })
 colorSum.push(color[i]);
 }
 }

 for(var i=0;i<colorSum.length;i++) {
 var s = colorSum[i]
 for(var j = 1;j <= card20.length;++j){
 var num = 5 - j;
 for (var start = 0; (start + num) <= s.length; ++start) {
 var subCards = s.slice(start, start + num);
 var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
 if(bool){
 return true;
 }
 }
 }
 }



 let convertedCards = KQCard._convertOneToA1(card);
 if (card === convertedCards) {
 return false;
 }
 return KQCard.containTongHuaShun20(convertedCards);
 };*/

// 是否是清龙
KQCard.isQingLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    /**
     *
     */
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
        }
    }
    if (colorSum.length == 1) {
        if (colorSum[0] == 13) {

            if (KQCard.isYiTiaoLong(cards)) {

                var teShuCard = cards.filter(function (i) {
                    return i;
                });

                teShuCard = KQCard.cardsFromArray(teShuCard);

                teShuCard.forEach(function (a) {
                    if (a.scores == 1) a.scores = 14;
                });

                teShuCard.sort(function (a, b) {
                    return b.scores - a.scores;
                });

                teShuCard = KQCard.convertToServerCards(teShuCard);

                var a1 = teShuCard.splice(0, 5);

                var a2 = teShuCard.splice(0, 5);

                cc.teShuPaiCards = [teShuCard, a2, a1];

                return true;
            }
        }
    }
    //return KQCard.isTongHuaShun(cards);
    return false;
};

// 是否是一条龙
KQCard.isLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }

    return KQCard.isShunZi(cards);
};

/*#####*/
/*是否一条龙*/
KQCard.isYiTiaoLong = function (cards) {
    //cards:{number:1~13 ,'suit':'h'...}
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].number == 'undefined') {
        cards = KQCard.convertToServerCards(cards);
    }
    var number = cards.map(function (card) {
        return card.number;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });
    for (var i = 0; i < cards.length - 1; i++) {
        if (number[i] != number[i + 1] - 1) {
            return false;
        }
    }

    var teShuCard = cards.filter(function (i) {
        return i;
    });

    teShuCard = KQCard.cardsFromArray(teShuCard);

    teShuCard.forEach(function (a) {
        if (a.scores == 1) a.scores = 14;
    });

    teShuCard.sort(function (a, b) {
        return b.scores - a.scores;
    });

    teShuCard = KQCard.convertToServerCards(teShuCard);

    var a1 = teShuCard.splice(0, 5);

    var a2 = teShuCard.splice(0, 5);

    cc.teShuPaiCards = [teShuCard, a2, a1];
    //cc.log(cc.teShuPaiCards )
    //cc.log('--------728')
    return true;
};
/*#####*/
/*是否三同花*/
KQCard.isSanTongHua = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == "undefined") {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var sanCard = [colorS, colorH, colorC, colorD];
    var teShuCard = [];
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
            teShuCard.push(sanCard[i]);
        }
    }

    //三种花色
    if (colorSum.length == 3) {
        for (var i = 0; i < colorSum.length; i++) {
            if (colorSum[i] != 5 && colorSum[i] != 3) {
                return false;
            }
        }
        teShuCard.sort(function (a, b) {
            return a.length - b.length;
        });
        cc.teShuPaiCards = teShuCard;
        return true;
    }
    return false;
};
/*是否凑一色*/
KQCard.isCouYiSe = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's' || cards[i].suit == 'c') {
            colorS.push(cards[i]); //全黑
        } else if (cards[i].suit == 'h' || cards[i].suit == 'd') {
                colorH.push(cards[i]); //全红
            }
    }

    //如果牌中包含四种花色就不可能是三同花
    if (colorS.length == 13 || colorH.length == 13) {
        return true;
    }
    //else if(colorH.length == 13){
    //    return true;
    //}
    return false;
};
/*#####*/
// 是否是六对半
KQCard.isLiuDuiBan = function (cards) {
    var length = 12;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfYi = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength || value == 3) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value == 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        }
        //else if (value == 6 || value == 7 || value == 5) {
        //    numberOfDuiZi = numberOfDuiZi + 0;
        //}
        else if (value == 1) {
                numberOfYi += 1;
            }
    }

    if (numberOfDuiZi == 6) {

        var teShuCard = cards.filter(function (i) {
            return i;
        });

        teShuCard = KQCard.cardsFromArray(teShuCard);

        teShuCard.forEach(function (a) {
            if (a.scores == 1) a.scores = 14;
        });

        teShuCard.sort(function (a, b) {
            return b.scores - a.scores;
        });

        teShuCard = KQCard.convertToServerCards(teShuCard);

        var a1 = teShuCard.splice(0, 5);

        var a2 = teShuCard.splice(0, 5);

        cc.teShuPaiCards = [teShuCard, a2, a1];

        return true;
    }
    return false;
};

KQCard.isWuDuiSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    var sanTiaoLength = 3;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfSanTiao = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        } else if (value >= 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        }
    }
    return numberOfDuiZi == 5 && numberOfSanTiao == 1;
};

//判断5张或者3张是否顺子
KQCard.isShunZi1 = function (arr) {
    //console.log(arr);
    for (var i = 0; i < arr.length - 1; i++) {
        if (arr[i + 1] - arr[i] != 1) {
            //不是顺子
            //console.log("不是顺子");
            return false;
        }
    }
    return true;
};

KQCard.isSanShunZi = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }

    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }

    //取出牌的点数
    var number = cards.map(function (card) {
        return card.number;
    });
    //排序
    number.sort(function (n1, n2) {
        return n1 - n2;
    });
    if (KQCard.fenZhu(number, 5, 5) == false) {
        var number = cards.map(function (card) {
            return card.number;
        });
        //排序
        number.sort(function (n1, n2) {
            return n1 - n2;
        });
        if (KQCard.fenZhu(number, 5, 3) == false) {
            var number = cards.map(function (card) {
                return card.number;
            });
            //排序
            number.sort(function (n1, n2) {
                return n1 - n2;
            });
            if (KQCard.fenZhu(number, 3, 5) == false) {
                //不是三顺子
                var AIsExist = false; //是否存在A
                for (var i in cards) {
                    if (cards[i].number == 1) {
                        AIsExist = true;
                        //console.log("存在A");
                        break;
                    }
                }
                if (!AIsExist) {
                    //console.log("退出递归");
                    return false;
                }

                for (var i in cards) {
                    if (cards[i].number == 1) {
                        //console.log("A转为14");
                        cards[i].number = 14;
                        break;
                    }
                }
                if (cc.teShuPaiCards && cc.teShuPaiCards.length > 0 && cc.teShuPaiCards[0][0] && typeof cc.teShuPaiCards[0][0] == 'number') {
                    var newCards = cards.filter(function (i) {
                        return i;
                    });
                    var newCards1 = cc.teShuPaiCards.map(function (arr) {
                        var cad = arr.map(function (number) {
                            for (var i = 0; i < newCards.length; i++) {
                                if (newCards[i].number == number) {
                                    return newCards.splice(i, 1)[0];
                                    break;
                                }
                            }
                        });
                        return cad;
                    });
                    cc.teShuPaiCards = newCards1;
                }
                return KQCard.isSanShunZi(cards);
            }
        }
    }
    if (cc.teShuPaiCards && cc.teShuPaiCards.length > 0 && cc.teShuPaiCards[0][0] && typeof cc.teShuPaiCards[0][0] == 'number') {
        var newCards = cards.filter(function (i) {
            return i;
        });
        var newCards1 = cc.teShuPaiCards.map(function (arr) {
            var cad = arr.map(function (number) {
                for (var i = 0; i < newCards.length; i++) {
                    if (newCards[i].number == number) {
                        return newCards.splice(i, 1)[0];
                        break;
                    }
                }
            });
            return cad;
        });
        cc.teShuPaiCards = newCards1;
    }
    return true;
};

//分组553||535||355
KQCard.fenZhu = function (number, num1, num2) {
    var arr1 = [];
    var arr2 = [];
    var arr3 = [];
    for (var i = 0; i < number.length - 1; i++) {
        if (i == 0) {
            arr1.push(number[0]);
        }
        if (number[i + 1] - number[i] == 0) {
            continue;
        }
        arr1.push(number[i + 1]);
        if (arr1.length == num1) {
            //取第一组是顺子
            if (KQCard.isShunZi1(arr1)) {
                //这5个是顺子,从数组中移除
                for (var i = 0; i < arr1.length; i++) {
                    for (var j = 0; j < number.length; j++) {
                        if (number[j] == arr1[i]) {
                            //两个数一样的只删除一个
                            if (number[j] == number[j + 1]) {
                                continue;
                            }
                            number.splice(j, 1); //从number中移除
                        }
                    }
                }
                /*console.log("删除第一组后的number");
                 console.log(number);*/
                //接下来取第二组
                for (var i = 0; i < number.length - 1; i++) {
                    if (i == 0) {
                        arr2.push(number[0]);
                    }
                    if (number[i + 1] - number[i] == 0) {
                        continue;
                    }
                    arr2.push(number[i + 1]);
                    if (arr2.length == num2) {
                        //取第二组是顺子
                        if (KQCard.isShunZi1(arr2)) {
                            for (var i = 0; i < arr2.length; i++) {
                                for (var j = 0; j < number.length; j++) {
                                    if (number[j] == arr2[i]) {
                                        //两个数一样的只删除一个
                                        if (number[j] == number[j + 1]) {
                                            continue;
                                        }
                                        number.splice(j, 1); //从number中移除
                                    }
                                }
                            }
                            /*console.log("删除第二组后的number");
                             console.log(number);*/
                            arr3 = number;
                            //接下来就是剩下的了
                            if (KQCard.isShunZi1(arr3)) {
                                //第三组也是顺子
                                var asdf = [arr1, arr2, arr3];

                                asdf.sort(function (n1, n2) {
                                    return n1.length - n2.length;
                                });

                                if (!cc.teShuPaiCards) cc.teShuPaiCards = asdf;

                                return true;
                            }
                            //第三组不是顺子
                            return false;
                        }
                        //第二组不是顺子
                        return false;
                    }
                }
            }
            //第一组不是顺子
            return false;
        }
    }
    //如果取不到num1个数
    if (arr1.length < num1) {
        return false;
    }
    if (arr2.length < num2) {
        return false;
    }
};

KQCard.isSanShunZi1 = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }

    cards = Array.from(cards);
    cards.sort(KQCard.sortByPoint);
    var wei = [];
    var zhong = [];
    var tou = [];
    var sanShunZi = KQCard.sanShunZi1(cards)[0]; //获取所有组合的头道
    if (!sanShunZi) {
        //你连头道都没有 怎么更我混
        return false;
    }

    var newCard = cards.filter(function (i) {
        //重新赋值cards
        return i;
    });
    var newCards1 = [];
    var newPoint = []; //判断point是否相同
    var duiZi = []; //取出有对子当中的一张牌
    for (var s in cards) {
        if (newPoint.indexOf(cards[s].point) < 0) {
            newCards1.push(cards[s]);
            newPoint.push(cards[s].point);
        } else {
            //取出有对子当中的一张牌
            duiZi.push(cards[s]);
        }
    }

    for (var j = 0; j < sanShunZi.length; ++j) {
        //循环所有头道
        var number3 = sanShunZi[j];
        if (typeof number3 == 'undefined') {
            continue;
        }
        for (var i = 0; i < cards.length; ++i) {
            var newCards = newCards1.filter(function (i) {
                //重新赋值cards
                return i;
            });

            newCards = newCards.kq_excludes(number3); //删除牌里的头道
            if (wei.length != 5) {
                var subCards = newCards.slice(i, i + 5);
                if (subCards.length == 5 || KQCard.isShunZi(subCards)) {
                    //得到尾道 删除牌里的尾道
                    wei = subCards;
                    // cc.log(number3)
                    // cc.log(newCards1)
                    // cc.log(subCards)
                    // cc.log(newCards)
                    // cc.log(i)
                    // cc.log('-----716')
                    newCards = newCards.kq_excludes(subCards);
                }
            }

            if (wei.length == 5) {
                //把剩余的牌和对子的单张合并
                var tasks = duiZi.filter(function (i) {
                    //重新赋值对子
                    return i;
                });
                tasks = tasks.kq_excludes(number3); //判断头道和对子的单张是否有相同 有的话就删除
                newCards = newCards.concat(tasks); //把剩余的牌和对子的单张合并
            }

            if (zhong.length != 5 && newCards.length == 5) {
                if (KQCard.isShunZi(newCards)) {
                    //是三顺子
                    zhong = newCards;
                }
            }
            if (wei.length == 5 && zhong.length == 5) {
                //是三顺子终止循环
                break;
            } else {
                //来吧 继续吧
                zhong = [];wei = [];tou = [];
            }
        }
        if (wei.length == 5 && zhong.length == 5) {
            //是三顺子终止循环
            tou = number3;
            break;
        } else {
            //来吧 继续吧
            zhong = [];wei = [];tou = [];
        }
    }

    cards = newCard;
    if (KQCard._isSanShunZi(tou, zhong, wei)) {
        //是三顺子
        tou = KQCard.convertToServerCards(tou);
        zhong = KQCard.convertToServerCards(zhong);
        wei = KQCard.convertToServerCards(wei);

        if (!cc.teShuPaiCards) cc.teShuPaiCards = [tou, zhong, wei];
        return true;
    }
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
        cards.forEach(function (a) {
            if (a.point == 14) a.point = 1;
        });
        //return false;
        return KQCard.isSanShunZi1(cards);
    }
    return KQCard.isSanShunZi(convertedCards);
};

KQCard.sanShunZi1 = function (cards) {
    var length = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    var shunzi = KQCard.findShunZi(cards, length);
    var cardsT = [];
    var cardsIndex = [];
    if (shunzi == null) {
        return false;
    }
    for (var i = 0; i < shunzi.length; i++) {
        var a = shunzi[i];
        var cardsShunzi = [];
        // var cardsIndex = [];
        for (var j = 0; j < a.length; j++) {
            var index = a[j];
            if (typeof cards[index] == 'undefined') {
                continue;
            }
            cardsShunzi.push(cards[index]);
        }
        cardsIndex.push(a);
        cardsT.push(cardsShunzi);
    }
    return [cardsT, cardsIndex];
};

KQCard._isSanShunZi = function (touCards, zhongCards, weiCards) {
    return KQCard.isShunZi(touCards) && KQCard.isShunZi(zhongCards) && KQCard.isShunZi(weiCards);
};
// 是否是三同花顺
KQCard.isSanTongHuaShun = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorCardsObject = KQCard._colorClassCards(cards);

    var subCards = [];
    for (var prop in colorCardsObject) {
        var _cards = colorCardsObject[prop];
        subCards.push(_cards);
    }

    if (subCards.length != 3) {
        return false;
    }

    subCards = subCards.sort(function (s1, s2) {
        return s1.length > s2.length;
    });

    var touCards = subCards[0];
    var zhongCards = subCards[1];
    var weiCards = subCards[2];

    if (touCards.length != 3 || zhongCards.length != 5 || weiCards.length != 5) {
        return false;
    }

    return KQCard._isSanTongHuaShun(touCards, zhongCards, weiCards);
};

// 将牌根据 color 进行分类
KQCard._colorClassCards = function (cards) {
    var colorCardsObject = {};
    cards.forEach(function (card) {
        var color = card.color;
        var subCards = colorCardsObject[color];
        if (!subCards) {
            subCards = [];
            colorCardsObject[color] = subCards;
        }
        subCards.push(card);
    });

    return colorCardsObject;
};

// 是否是三同花顺
KQCard._isSanTongHuaShun = function (touCards, zhongCards, weiCards) {
    return KQCard.isTongHuaShun(touCards) && KQCard.isTongHuaShun(zhongCards) && KQCard.isTongHuaShun(weiCards);
};

// 是否是 “三分天下”
KQCard.isSanFenTianXia = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var tieZhiLength = 4;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfTieZhi = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == tieZhiLength) {
            numberOfTieZhi = numberOfTieZhi + 1;
        }
    }
    return numberOfTieZhi === 3;
};

// 是否是 “四套三条”
KQCard.isSiTaoSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var sanTiaoLength = 3;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfSanTiao = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        }
    }

    return numberOfSanTiao == 4;
};

// 是否是 “三桃花”
// 头、中、尾道为相同花色的牌
KQCard.isSanTaoHua = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorHelper = new KQCardColorsHelper(cards);
    var colorNumbers = [];
    for (var prop in colorHelper.colorNumber) {
        colorNumbers.push(colorHelper.colorNumber[prop]);
    }

    colorNumbers.sort(function (n1, n2) {
        return n1 - n2;
    });

    if (colorNumbers.length != 3) {
        return false;
    }

    if (colorNumbers[0] == 3 && colorNumbers[1] == 5 && colorNumbers[2] == 5) {
        return true;
    }

    return false;
};

// 判断是否包含铁支
// 四张同样点数的牌
KQCard.containTieZhi = function (cards) {
    var length = 4;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var helper = new KQCardPointsHelper(cards);

    for (var w in helper.pointNumbers) {
        var maxNumber = helper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}
    // else{
    //    return KQCard.containGuiPai(cards,4);
    //}
    //if (KQCard.findTieZhi(cards).length > 0) {
    //    return true;
    //}
    return false;
};

// 判断是否是铁支
KQCard.isTieZhi = function (cards) {
    var length = 4;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};

/*#####是否包含五同*/
//五张同样点数的牌
KQCard.containWuTong = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    //五张牌相同的
    var helper = new KQCardPointsHelper(cards);
    //for(var w in helper.pointNumbers) {
    //    cc.log(w)
    //}
    //cc.log(cards)
    //cc.log(helper)
    //cc.log(card20)
    //cc.log(helper.maxNumber())
    //cc.log('------1307')
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}
    for (var w in helper.pointNumbers) {
        var maxNumber = helper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return helper.maxNumber() >= length;
        }
    }
    return false;
};

/*判断是否五同*/
KQCard.isWuTong = function (cards) {
    var length = 5;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};
/*#####*/

// 是否是 “葫芦”
// 三张相同 + 一对
KQCard.containHuLu = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    if (KQCard.findHuLu(cards).length > 0) {
        return true;
    }
    //let pointHelper = new KQCardPointsHelper(cards);
    //var pointNumbers = [];
    //var index = 0;
    //for (let prop in pointHelper.pointNumbers) {
    //    pointNumbers[index] = pointHelper.pointNumbers[prop];
    //    index = index + 1;
    //}
    //var h=[];
    //var h1=[];
    //for(var i in pointNumbers){
    //    var s=pointNumbers[i];
    //    if(s == 3){
    //        h.push(s)
    //    }
    //    else if(s==4){
    //        h1.push(s)
    //    }
    //
    //}
    //
    //if ((pointNumbers.indexOf(3) != -1) && (pointNumbers.indexOf(2) != -1)
    // || h.length > 1 || h1.length > 1 ||(pointNumbers.indexOf(4) != -1)
    // && (pointNumbers.indexOf(2) != -1)) {
    //    return true;
    //}

    return false;
};

// 判断是否是 葫芦
KQCard.isHuLu = function (cards) {
    if (cards.length != 5) {
        return false;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (p1, p2) {
        return p1 - p2;
    });

    var p1 = points[0];
    var p2 = p1;
    var numberP1 = 0;
    var numberP2 = 0;

    points.forEach(function (point) {
        if (point != p1 && point != p2) {
            p2 = point;
            numberP2 = 0;
        }

        numberP1 = numberP1 + (point == p1 ? 1 : 0);
        numberP2 = numberP2 + (point == p2 ? 1 : 0);
    });

    var maxNumber = Math.max(numberP1);
    var minNumber = Math.min(numberP2);

    return minNumber == 2 && maxNumber == 3;
};

// 是否包含有 “三条”
KQCard.containSanTiao = function (cards) {
    var length = 3;
    if (cards.length < length) {
        return false;
    }
    //if (KQCard.findSanTiao(cards).length > 0) {
    //    return true;
    //}
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var pointHelper = new KQCardPointsHelper(cards);
    for (var w in pointHelper.pointNumbers) {
        var maxNumber = pointHelper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] >= length) {
    //        return true;
    //    }
    //}
    return false;

    //
    //return KQCard.containGuiPai(cards,3);
};

// 是否是 “三条”
KQCard.isSanTiao = function (cards) {
    if (cards.length != 3) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (card.point == point) {
            return point;
        }

        return -1;
    }, cards[0].point);

    return result != -1;
};

// 是否包含有 ：两对
KQCard.containLiaDui = function (cards) {
    if (cards.length < 4) {
        return false;
    }
    if (KQCard.findLiaDui(cards).length > 0) {
        return true;
    }
    //var numberOfDuiZi = 0;
    //let pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] == 2) {
    //        numberOfDuiZi = numberOfDuiZi + 1;
    //        if (numberOfDuiZi == 2) {
    //            return true;
    //        }
    //    }
    //}

    return false;
};

// 是否是 两对
KQCard.isLiaDui = function (cards) {
    if (cards.length != 4) {
        return false;
    }

    var pointHelper = new KQCardPointsHelper(cards);
    for (var prop in pointHelper.pointNumbers) {
        if (pointHelper.pointNumbers[prop] != 2) {
            return false;
        }
    }
    return true;
};

// 是不是对子
KQCard.isDuiZi = function (cards) {
    if (cards.length != 2) {
        return false;
    }

    var card1 = cards[0];
    var card2 = cards[1];

    return card1.point == card2.point;
};

// 是否包含对子
KQCard.containDuiZi = function (cards) {
    var length = 2;
    if (cards.length < length) {
        return false;
    }
    //if (KQCard.findDuiZi(cards).length > 0) {
    //    return true;
    //}
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] >= length) {
    //        return true;
    //    }
    //}
    for (var w in pointHelper.pointNumbers) {
        var maxNumber = pointHelper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    return false;
    //return KQCard.containGuiPai(cards,2);
};

KQCard.containGuiPai = function (cards, length) {
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    var helper = new KQCardPointsHelper(cards);
    var maxNumber = helper.maxNumber() + card20.length;
    return maxNumber >= length;
};
/*#####*/
// 是否是特殊牌
KQCard.isTeShuPai = function (cards) {
    if (cards.length < 13) {
        return false;
    }

    return KQCard.isQingLong(cards) || KQCard.isYiTiaoLong(cards) || KQCard.isLiuDuiBan(cards) || KQCard.isSanShunZi(cards) || KQCard.isSanTongHua(cards)
    /*|| KQCard.isSanTongHuaShun(cards)
     || KQCard.isSanFenTianXia(cards)
     || KQCard.isSiTaoSanTiao(cards)
      || KQCard.isWuDuiSanTiao(cards)
     || KQCard.isCouYiSe(cards)*/;
};

// 将牌中的 1 变化为 A（14)
KQCard._convertOneToA = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var result = cards.map(function (card) {
        if (card.point == 1) {
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

KQCard._convertOneToA1 = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var num = 0;
    var result = cards.map(function (card) {
        if (card.point == 1 && num == 0) {
            num++;
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

// KQCard 的排序方法
KQCard.sortByPoint = function (card1, card2) {
    var result = Number(card1.point) - Number(card2.point);
    return result;
};

KQCard.sortByColor = function (card1, card2) {
    var pointAsc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (card2.color == card1.color) {
        return (card1.point - card2.point) * (pointAsc ? 1 : -1);
    }
    return card2.color - card1.color;
};

KQCard.sort = function (card1, card2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];
    var AisMax = arguments.length <= 3 || arguments[3] === undefined ? true : arguments[3];

    var result = 1;
    if (card1.point == card2.point) {
        result = card1.color - card2.color;
    } else {
        var point1 = card1.point;
        var point2 = card2.point;
        if (AisMax && point1 == 1) {
            point1 = 14;
        }

        if (AisMax && point2 == 1) {
            point2 = 14;
        }

        result = point1 - point2;
    }

    return result * (asc ? 1 : -1);
};

//转为客户端的牌
KQCard._convertCardsToCardNames = function (cards) {
    // [{"suit":"s","number":10}]
    var suitColorMap = ['', 'd', 'c', 'h', 's'];
    return cards.map(function (card) {
        var cardNumber = card.point;
        var color = suitColorMap[card.color];
        var number = Math.max(Math.min(cardNumber, 13), 1);
        return { number: number, suit: color };
    });
};

cc._RFpop();
},{"GetCardPointsSameCount":"GetCardPointsSameCount","KQCardColorsHelper":"KQCardColorsHelper","KQCardPointsHelper":"KQCardPointsHelper","NumberExtension":"NumberExtension"}],"KQGlabolSocketEventHander":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'babea3CWj9G1pWM9AkXao0n', 'KQGlabolSocketEventHander');
// scripts\Socket\KQGlabolSocketEventHander.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var KQGlabolSocketEventHander = {
    start: function start() {
        if (this._didStart) {
            return;
        }
        this._didStart = true;

        KQGlobalEvent.on(Socket.Event.ReceiveForceExit, this._forceExitApp, this);
    },

    _forceExitApp: function _forceExitApp(response) {
        KQNativeInvoke.forceExitApp();
    }
};

module.exports = KQGlabolSocketEventHander;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","socket":"socket"}],"KQGlobalEvent":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd90d6OrggVEXa29ffA+vZY0', 'KQGlobalEvent');
// scripts\Event\KQGlobalEvent.js

var KQGlobalEvent = {
    _handles: {},
    //发送事件
    emit: function emit(eventName) {
        var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

        if (typeof data == 'string') {
            data = { 'data': data };
        }

        var returns = []; //返回值
        data.eventName = eventName; //保存一下事件名字

        for (var findEvenName in this._handles) {
            if (findEvenName == eventName) {
                for (var i = 0; i < this._handles[findEvenName].length; i++) {
                    var returnValue = this._handles[findEvenName][i](data);
                    returns.push(returnValue);
                }
            }
        }

        return returns;
    },
    //添加普通事件
    on: function on(eventName, callback, target) {
        // console.log('收到事件', eventName);
        this._handles[eventName] = this._handles[eventName] || [];

        this._handles[eventName].push(callback.bind(target));
        callback._caller = target;
    },

    //通过事件名移除一个监听器
    off: function off(eventName) {
        for (var i = 0; i < this._handles[eventName].length; i++) {
            this._handles[eventName][i] = null;
        }
    },

    // 移动一个 target 上所有的监听
    offTarget: function offTarget(target) {
        for (var name in this._handles) {
            var eventHandlers = this._handles[name];
            var indexs = eventHandlers.filter(function (callback) {
                return callback._caller = target;
            }).map(function (callback, index) {
                return index;
            });

            var indexOffset = 0;
            indexs.forEach(function (index) {
                eventHandlers.splice(index + indexOffset, 1);
                indexOffset = indexOffset + 1;
            });
        }
    }
};

module.exports = KQGlobalEvent;

cc._RFpop();
},{}],"KQNativeInvoke":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7327dLBqWVNaJ14fJQ4jq6Y', 'KQNativeInvoke');
// scripts\Utils\KQNativeInvoke.js

var KQNativeInvoke = {
  IOSClassName: "AppController",
  ANDRIODClassName: "com/gongpa/ssz/AppActivity",

  isNativeIOS: function isNativeIOS() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.IPHONE || platform == cc.sys.IPAD) {
      return true;
    }
    return false;
  },

  isNativeAndroid: function isNativeAndroid() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.ANDROID) {
      return true;
    }
    return false;
  },

  isNative: function isNative() {
    return cc.sys.isNative == true;
  }
};

// MARK: 可调用的本地方法
/**
 * 微信登录
 */
KQNativeInvoke.wxLogin = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
  } else if (KQNativeInvoke.isNativeAndroid()) {
      //Android
      jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
    }
};

/**
 * 分享大厅信息到微信好友
 * 
 */
KQNativeInvoke.shareHallToWeChatFriend = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallFriend", "()V");
  }
};

/**
 * 分享大厅信息到朋友圈
 * 
 */
KQNativeInvoke.shareHallToWeChatTimeline = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", "()V");
  }
};

/**
 * 强制退出 APP
 * 
 */
KQNativeInvoke.forceExitApp = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
  }
};

/**
 * 下载新版本
 * 
 * @param {String} iosUrl      iOS 版本地址
 * @param {String} androidUrl  安卓版本地址
 */
KQNativeInvoke.downloadNewVersion = function (iosUrl, androidUrl) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", iosUrl);
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", androidUrl);
  }
};

/**
 * 分享房间给微信好友
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatFriend = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V", id, description, title);
  }
};

/**
 * 分享房间到微信朋友圈
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatTimeline = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShare:description:", id, description, title);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShare", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V", id, description, title);
  }
};

/**
 * 分享屏幕截图到微信好友
 */
KQNativeInvoke.shareScreenToWeChatFriend = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShareFriend", "()V");
  }
};

/**
 * 分享屏幕截图到微信朋友圈
 */
KQNativeInvoke.shareScreenToWeChatTimeline = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
  }
};

/**
 * 开始录音
 */
KQNativeInvoke.startRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
  }
};

/**
 * 结束录音
 */
KQNativeInvoke.endRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
  }
};

KQNativeInvoke.screenshotShare = function () {
  var strings = arguments.length <= 0 || arguments[0] === undefined ? 'shareIMG' : arguments[0];

  if (this._isCapturing) {
    return;
  }
  this._isCapturing = true;
  var size = cc.director.getWinSize();
  var fileName = "result_share.jpg";
  var fullPath = jsb.fileUtils.getWritablePath() + fileName;
  if (jsb.fileUtils.isFileExist(fullPath)) {
    jsb.fileUtils.removeFile(fullPath);
  }
  var texture = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height), cc.IMAGE_FORMAT_PNG, gl.DEPTH24_STENCIL8_OES);
  texture.setPosition(cc.p(size.width / 2, size.height / 2));
  texture.begin();
  cc.director.getRunningScene().visit();
  texture.end();
  texture.saveToFile(fileName, cc.IMAGE_FORMAT_PNG);

  var self = this;
  var tryTimes = 0;
  var fn = function fn() {
    if (jsb.fileUtils.isFileExist(fullPath)) {

      if (cc.sys.os == cc.sys.OS_ANDROID) {
        jsb.reflection.callStaticMethod(self.ANDRIODClassName, strings, "(Ljava/lang/String;)V", fullPath);
      }
      self._isCapturing = false;
    } else {
      tryTimes++;
      if (tryTimes > 10) {
        console.log("time out...");
        return;
      }
      setTimeout(fn, 50);
    }
  };
  setTimeout(fn, 50);
};

/**
 * 播放网络语音
 * 
 * @param {String} audioUrl 语音地址
 */
KQNativeInvoke.playAudioWithUrl = function (audioUrl) {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", audioUrl);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", audioUrl);
  }
};

module.exports = KQNativeInvoke;

cc._RFpop();
},{}],"MsgControl":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd242dsY+hBG5LpL7ZF7Kn6', 'MsgControl');
// scripts\Chat\MsgControl.js

var Socket = require('socket');
var ChatMessage = require('ChatMessage');
var AudioManager = require('AudioManager');

// 用来发送消息的 component
cc.Class({
    'extends': cc.Component,

    properties: {
        //bqNode:cc.Node,
        //bqNode1:cc.Node,
        //btnLanguageNode:cc.Node,
        //btnLanguageNode1:cc.Node,
        //btnChartNode:cc.Node,
        //btnChartNode1:cc.Node,
        textScrollView: cc.Node,
        imageContentNode: cc.Node,

        editBox: cc.EditBox,

        textRecordScrollView: cc.ScrollView,
        textRecordLayout: cc.Layout,

        textPrefab: cc.Prefab,
        chatTextRecordPrefab: cc.Prefab,
        emojiPrefab: cc.Prefab,
        // imagePrefab:cc.Prefab,

        biaoqing: [cc.Node], // [亮的背景, 暗的背景]   快捷语
        kuaijieyu: [cc.Node], // [亮的背景, 暗的背景]   表情
        content: [cc.Node], // [快捷语, 表情]  
        inputNode: cc.Node,
        emoji: [cc.Node],
        _userId: null,

        _playerInfos: null, // 记录用户信息
        _chatTextMessageRecords: null },

    // 聊天文本消息记录
    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        this._playerInfos = [];
        this.textContent = this.textScrollView.getComponent(cc.ScrollView).content;
        // this.imageContent = this.imageScrollView.getComponent(cc.ScrollView).content;
        var self = this;
        var textData = AudioManager.instance.chatTexts();
        for (var i = 0; i < textData.length; i++) {
            var item = cc.instantiate(this.textPrefab);
            item.getComponent('cellText').setText(textData[i]);
            item.getComponent('cellText').onSelectAction = function (text) {
                self.onTextClickAction(text);
            };
            this.textContent.h = 1000;
            this.textContent.addChild(item);
        }
    },

    clickKuaiJieYu: function clickKuaiJieYu() {
        this.kuaijieyu[0].active = true; // 快捷语 背景
        this.kuaijieyu[1].active = false; // 快捷语 按钮
        this.biaoqing[0].active = false; // 背景表情
        this.biaoqing[1].active = true; // 表情按钮
        this.content[0].active = true;
        this.content[1].active = false;
    },
    clickBiaoQing: function clickBiaoQing() {
        this.biaoqing[0].active = true; // 背景表情
        this.biaoqing[1].active = false; // 表情按钮
        this.kuaijieyu[0].active = false; // 快捷语 背景
        this.kuaijieyu[1].active = true; // 快捷语 按钮
        this.content[0].active = false;
        this.content[1].active = true;
    },
    onTextClickAction: function onTextClickAction() {
        var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        this.editBox.string = "";
        this.sendText(text);
    },

    clickEmoji: function clickEmoji(event, emojiName) {
        var string = this.editBox.string;
        this.editBox.string = string + "<" + emojiName + ">";
        this.sendEmoji(emojiName);
    },

    clickSend: function clickSend() {
        var string = this.editBox.string || "";
        if (string.length == 0) {
            return;
        }
        this.editBox.string = "";
        this.sendText(string);
    },

    sendEmoji: function sendEmoji(emojiName) {
        if (emojiName.length == 0) {
            return;
        }
        Socket.sendEmoji(this._userId, emojiName);
        this.dismiss();
    },

    sendText: function sendText() {
        var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        if (text.length == 0) {
            return;
        }
        Socket.sendText(this._userId, text);
        this.dismiss();
    },

    dismiss: function dismiss() {
        this.node.active = false;
    },

    bqAction: function bqAction() {
        this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode1.active = true;
        this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode.active = false;
        this.textScrollView.active = false;
        this.imageContentNode.active = true;
        this.textRecordScrollView.node.active = false;
    },

    textAction: function textAction() {
        this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode.active = false;
        this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode1.active = true;
        this.textScrollView.active = true;
        this.imageContentNode.active = false;
        this.textRecordScrollView.node.active = false;
    },

    chartAction: function chartAction() {
        this.bqNode1.active = this.btnLanguageNode1.active = this.btnChartNode1.active = false;
        this.bqNode.active = this.btnLanguageNode.active = this.btnChartNode.active = true;
        this.textScrollView.active = this.imageContentNode.active = false;
        this.textRecordScrollView.node.active = true;
    },

    addPlayerInfos: function addPlayerInfos(playerInfos) {
        this._playerInfos = this._playerInfos || [];

        playerInfos.forEach((function (userInfo) {
            var haveUserInfo = this._playerInfos.find(function (ownUserInfo) {
                return ownUserInfo.id == userInfo.id;
            });

            if (haveUserInfo == null) {
                this._playerInfos.push(userInfo);
            }
        }).bind(this));
    },

    addChatTextMessage: function addChatTextMessage(userId, text) {
        this._playerInfos = this._playerInfos || [];

        var nickname = "[ID:" + userId + "说]：";
        var userInfo = this._playerInfos.find(function (userInfo) {
            return userInfo.id == userId;
        });

        if (userInfo) {
            nickname = "[" + userInfo.nickname + "说]：";
        }

        var str = nickname + text;
        str = ChatMessage.parseString(str);
        this._addChatTextToRecord(str);
    },

    addChatEmojiMessage: function addChatEmojiMessage(userId, emoji) {
        this._playerInfos = this._playerInfos || [];

        var nickname = "[ID:" + userId + "说]：";
        var userInfo = this._playerInfos.find(function (userInfo) {
            return userInfo.id == userId;
        });
        if (userInfo) {
            nickname = "[" + userInfo.nickname + "说]：";
        };
        var str = nickname + emoji;
        str = ChatMessage.parseString(str);
        this._addChatEmojiToRecord(emoji);
        // cc.log(emoji)
        // cc.log('---190')
    },

    _addChatEmojiToRecord: function _addChatEmojiToRecord(emoji) {
        var self = this;
        this._loadEmojiFrame(emoji, function (frame) {
            //var item  = cc.instantiate(self.emojiPrefab);
            //cc.log(frame)
            //var btnSprites =  item.getComponent(cc.Sprite);
            //btnSprites.spriteFrame = frame;
            //let chatEmojiRecord = item.getComponent('ChatTextRecord');
            //chatEmojiRecord.setEmoji(frame);
            ChatMessage.setEmoji(frame);
        });
    },

    _loadEmojiFrame: function _loadEmojiFrame(Emojiname, callback) {
        cc.loader.loadRes("/textures/chat/bq", cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                //console.log(null, err)
                return;
            }
            var frame = atlas.getSpriteFrame(Emojiname);
            callback(frame);
        }).bind(this));
    },

    _addChatTextToRecord: function _addChatTextToRecord(text) {
        var item = cc.instantiate(this.chatTextRecordPrefab);
        var chatTextRecord = item.getComponent('ChatTextRecord');
        chatTextRecord.setString(text);

        this.textRecordLayout.node.addChild(item);
        this.textRecordScrollView.scrollToBottom();
    }
});

cc._RFpop();
},{"AudioManager":"AudioManager","ChatMessage":"ChatMessage","socket":"socket"}],"NetworkError":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c99d35Sy6hDPbrte9nVczxP', 'NetworkError');
// scripts\NetworkError.js

var manager = require('manager');
var KQNativeInvoke = require('KQNativeInvoke');

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    exitAction: function exitAction() {
        cc.director.end();
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"NumberExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '80e21gZRpNM4pIiCpZ+7s8m', 'NumberExtension');
// scripts\Extensions\NumberExtension.js

// number.kq_times(f)   调用多次

if (!Number.prototype.kq_times) {

    /**
     * 调用一个方法 this 次
     * 
     * @param  {Function} f 要调用的方法
     * @param  {Object}   thisArg   可选； f 的 this值
     */
    Number.prototype.kq_times = function (f, thisArg) {
        if (!f) {
            return;
        }

        for (var i = 0; i < this; ++i) {
            if (thisArg) {
                f.apply(thisArg, i);
            } else {
                f(i);
            }
        }
    };
}

cc._RFpop();
},{}],"Playback":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0d3095dnBVFo5D1hEDDa5KQ', 'Playback');
// scripts\Playback\Playback.js

var Socket = require('socket');

// 用于回放的组件
var Playback = cc.Class({
  'extends': cc.Component,

  properties: {
    _playbackDatas: null, // 用于回放的数据
    _isPlaybacking: false
  },

  statics: {
    instance: null
  },

  onLoad: function onLoad() {
    Playback.instance = this;
    cc.game.addPersistRootNode(this.node);
  },

  // 设置回放数据
  setPlaybackDatas: function setPlaybackDatas(datas) {
    this._playbackDatas = datas;
  },

  // 清空回放数据。同时会清空回放
  removePlaybackDatas: function removePlaybackDatas() {
    this.setPlaybackDatas(null);
    this.stopPlayback();
  },

  // 是否包含回放数据
  isContainPlaybackDatas: function isContainPlaybackDatas() {
    return this._playbackDatas != null;
  },

  // 开始回放
  startPlayback: function startPlayback() {
    // 模拟 socket 接收到了事件即可
    //cc.log("Playback 开始回放");

    this._isPlaybacking = true;

    if (!this._playbackDatas) {
      cc.error("想回放，却没有回放数据");
      this.stopPlayback();
      return;
    }

    this._executePlayback();
  },

  // 停止回放
  stopPlayback: function stopPlayback() {
    this._isPlaybacking = false;
    this.unscheduleAllCallbacks();
  },

  // 是否正在回放
  isPlaybacking: function isPlaybacking() {
    return this._isPlaybacking;
  },

  // 执行真正的回放操作
  _executePlayback: function _executePlayback() {
    var startTime = 1.0;
    var interval = 3.0;
    cc.log(this._playbackDatas);

    // 在某些特殊情况下
    // 回放数据里会包含两套 gameOver action
    // 所以需要过滤掉其中一个
    this._playbackDatas = this._playbackDatas.filter((function (string, index) {
      if (index == this._playbackDatas.length - 1) {
        return true;
      }

      return string.indexOf('"action":"gameOver') == -1;
    }).bind(this));

    this._playbackDatas.forEach((function (data, index) {
      var delay = startTime + index * interval;
      if (index == this._playbackDatas.length - 1) {
        // 如果是最后一个，则应该只间隔一秒
        delay = startTime + (index - 1) * interval + 1;
      }

      this.scheduleOnce(function () {
        cc.log("回放开始模拟 Socket 接收到服务器消息, ", index);
        Socket.instance._dispatchResponse(data);
      }, delay);
    }).bind(this));
  }

});

module.exports = Playback;

cc._RFpop();
},{"socket":"socket"}],"Player":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6ffa0O02PFOp78QADTW5zGf', 'Player');
// scripts\Play\Player.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
var KQCardResHelper = require('KQCardResHelper');
var KQCard = require('KQCard');
var AudioManager = require('AudioManager');

cc.Class({
    'extends': cc.Component,

    properties: {
        foldCardNode: cc.Node, // 牌盖着时的样子
        teShuPaiNode: cc.Node, // 特殊牌盖着时的样子
        cardsBackLayout: cc.Layout, // 13张牌背影，可用来展示发牌动画 含 cardsBack Component
        compareCardsNode: cc.Node, // compareCards   含 CompareCards Component
        userInfoNode: cc.Node, // 包含用户信息 含 userInfo Component
        chatMessageNode: cc.Node, // 聊天消息 包含 ChatMessage Component
        userAvatarNode: cc.Node,
        //userSampleInfoNode: cc.Node,
        bulletHolePrefab: cc.Prefab, //中枪
        bulletHoleNode: cc.Node, //中枪
        shotNode: [cc.Node], //打枪
        userId: 0,
        cardTypePrefab: cc.Prefab,
        // 用户信息
        // 1、 如果 包含：cardInfo:[]，表明用户已经出牌
        //
        _userInfo: null,
        _deskInfo: null,
        /**/
        playedCompareCardsIndexs: {
            visible: false,
            'default': undefined
        }
        /**/
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.userAvatarNode.on(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
        this.reset();
        this.foldCardNodeBack = false; //判断是否点击了拍的背影
        this.cardSpriteAtlas = this.node.parent.getComponent('play').cardSpriteAtlas;
    },

    onDestroy: function onDestroy() {
        this.userAvatarNode.off(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
    },

    click_leave: function click_leave() {
        var userid = Socket.instance.userInfo.id;
        var leaveId = this._userInfo.id;
        Socket.sendQingli(leaveId, userid);
    },

    _showUserInfo: function _showUserInfo() {
        //this.userSampleInfoNode.getComponent('UserSampleInfo').updateWithUser(this._userInfo);
    },

    reset: function reset() {
        this.foldCardNode.active = false;
        this.cardsBackLayout.active = false;
        this.compareCardsNode.active = false;
        this.teShuPaiNode.active = false;
        this.bulletHoleNode.active = false;
        this.bulletHoleNode.removeAllChildren();
        this.bulletHoleNode.children.forEach(function (node) {
            node.active = false;
        });
        if (this.shotNode.length > 0) this.shotNode.forEach(function (node) {
            if (node) node.active = false;
        });
        this.compareCardsNode.getComponent('CompareCards').reset();
        this.compareCardsNode.getComponent('CompareCards').unscheduleAllCallbacks();
    },

    /*####*/
    reset2: function reset2() {
        this.foldCardNode.active = false;
        this.cardsBackLayout.active = false;
        this.teShuPaiNode.active = false;
        this.bulletHoleNode.active = false;
        this.bulletHoleNode.removeAllChildren();
        this.bulletHoleNode.children.forEach(function (node) {
            node.active = false;
        });
        if (this.shotNode.length > 0) this.shotNode.forEach(function (node) {
            if (node) node.active = false;
        });
        //this.compareCardsNode.active = false;
        //this.compareCardsNode.getComponent('CompareCards').reset();
    },
    /*#####*/

    updateUserInfoWithUsers: function updateUserInfoWithUsers(users) {
        var user = users.find((function (e) {
            return this.userId == e.id;
        }).bind(this));

        this.updateUserInfo(user);
    },
    showQingli: function showQingli(creator, index) {
        if (!this.node.active) {
            return;
        }
        if (index > 0) {
            this.userInfoNode.getComponent('userInfo').setqingli(false);
        } else {
            if (creator) {
                this.userInfoNode.getComponent('userInfo').setqingli(false);
            } else {
                this.userInfoNode.getComponent('userInfo').setqingli(true);
            }
        }
    },
    updateUserInfo: function updateUserInfo(user) {
        this._userInfo = user;
        this.node.active = user != null;
        this.userInfoNode.active = this.node.active;
        if (!user) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.updateAvatar(user.avatarUrl);
        userInfo.updateUserId(user.id);
        userInfo.updateNickname(user.nickname);
        userInfo.setOfflineVisible(!user.onlineStatus);

        //if (this._deskInfo && this._deskInfo.cIndex > 0) {
        //  if (UserModelHelper.isPlayedCards(user)) {
        //    this.playCard(user.id);
        //    this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
        //  }
        //}
        /**/
        var cIndex = this._deskInfo.cIndex;
        if (this._deskInfo && cIndex > 0 && this.playedCompareCardsIndexs.indexOf(cIndex) == -1) {
            if (UserModelHelper.isPlayedCards(user)) {
                this.playCard(user.id, user.cardInfo);
                this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
            }
        }
        /**/
    },

    // 更新房主信息
    updateBanker: function updateBanker() {
        var userInfoComp = this.userInfoNode.getComponent('userInfo');
        if (!this._userInfo) {
            userInfoComp.setIsBanker(false);
            return;
        }

        var isBanker = this._userInfo ? this._userInfo.isBanker : false;
        userInfoComp.setIsBanker(isBanker);
    },

    showFangZhuStatus: function showFangZhuStatus(createId) {
        var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (!this.node.active) {
            return;
        }
        if (this._userInfo.id == createId) {
            this.userInfoNode.getComponent('userInfo').setFangZhuNodeVisible(visible);
        }
    },

    /**
     * 更新分数
     *
     * @param {Number} score 用户分数、可选
     */
    updateScore: function updateScore(score) {
        if (!score && this._userInfo) {
            score = this._userInfo.totalScore;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.updateScore(score);
    },

    showReadyStatus: function showReadyStatus(userId) {
        var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (!this.node.active) {
            return;
        }

        if (this._userInfo.id == userId) {
            this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(visible);
        }
    },
    showBeilv: function showBeilv(userId, bl) {
        if (!this.node.active) {
            return;
        }
        if (this._userInfo.id == userId) {
            this.userInfoNode.getComponent('userInfo').setBeilvLabel(bl);
        }
    },
    /*setDeskInfo: function (deskInfo) {
     this._deskInfo = deskInfo;
     },*/
    updateDeskInfo: function updateDeskInfo(deskInfo) {
        this._deskInfo = deskInfo;

        if (deskInfo && !deskInfo.isCBegin) {
            this.reset();
        }
    },
    /**/

    hideReadyStatus: function hideReadyStatus() {
        this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(false);
    },

    playFaPaiAnimation: function playFaPaiAnimation() {
        if (!this.node.active) {
            return;
        }
        if (UserModelHelper.isPlayedCards(this._userInfo)) {
            return;
        }
        var cardsBack = this.cardsBackLayout.getComponent('cardsBack');
        cardsBack.showPlayCardBacks();
    },

    shouldShowFaPaiAnimation: function shouldShowFaPaiAnimation() {
        return UserModelHelper.isPlayedCards(this._userInfo);
    },

    setUserOnlineStatus: function setUserOnlineStatus(userId) {
        var status = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.setOfflineVisible(status != 1);
    },

    showChatText: function showChatText(userId, message) {
        if (userId != this.userId) {
            return;
        }

        var chatMessage = this.chatMessageNode.getComponent('ChatMessage');
        chatMessage.setString(message);
    },

    // 用户已经出牌，处于三堆盖着牌的状态
    playCard: function playCard(userId, cardInfo) {
        if (this.userId != userId) {
            return;
        }

        this.cardsBackLayout.node.active = false;
        this.compareCardsNode.active = false;
        this.foldCardNode.targetOff(this.foldCardNode);
        this.foldCardNode.active = true;
        this.foldCardNode.children.slice(0, 3).forEach((function (node) {
            node.active = true;
            node.children.forEach((function (noe) {
                noe.active = true;

                var cardSprite = noe.getComponent('cc.Sprite');

                var path = 'public-pic-card-poker-back';

                this._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);
            }).bind(this));
        }).bind(this));
        this.foldCardNode.on(cc.Node.EventType.TOUCH_END, (function (event) {
            this._clickFoldCardNode(event);
        }).bind(this), this.foldCardNode);
    },

    _clickFoldCardNode: function _clickFoldCardNode(event) {

        if (this.userId != Socket.instance.userInfo.id) return;

        var cardInfo = this._userInfo.cardInfo.length == 1 ? this._userInfo.cardInfo[0].cards : this._userInfo.cardInfo;

        var cards = cardInfo.map((function (cardInfoItem) {

            if (this._userInfo.cardInfo.length == 1) return KQCard.cardsFromArray(cardInfoItem);

            return KQCard.cardsFromArray(cardInfoItem.cards);
        }).bind(this)).reduce(function (array, subCards) {
            return array.concat(subCards);
        }, []);

        var foldCardNode = this.foldCardNode.children.slice(0, 3);

        var nodes = foldCardNode.map(function (node) {
            return node.children;
        }).reduce(function (array, sub) {
            return array.concat(sub);
        }, []);

        cards.forEach((function (kqCard, index) {

            if (index >= nodes.length) return;

            nodes[index].removeAllChildren();

            nodes[index].getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.width = nodes[0].width;

            nodds1.height = nodes[0].height;

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var cardName = this.foldCardNodeBack == false ? kqCard.cardName() : "back";

            nodds1.cardName = cardName;

            var path = 'public-pic-card-poker-' + cardName;

            this._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            if (cc.maPai == cardName) {

                var nodds = new cc.Node(); //创建一个节点对象

                nodds.addComponent(cc.Sprite); //添加精灵组件

                cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                    if (err) {
                        cc.error(err.message || err);return;
                    }

                    var btnSprite1 = nodds.getComponent(cc.Sprite);

                    btnSprite1.spriteFrame = spriteFrame;

                    btnSprite1.node.width = cardSprite.node.width + 10;

                    btnSprite1.node.height = cardSprite.node.height + 10;
                }).bind(this));

                cardSprite.node.addChild(nodds);
            }

            nodes[index].addChild(nodds1);
        }).bind(this));

        var cards0 = cards.slice(0, 3);
        var cards1 = cards.slice(3, 8);
        var cards2 = cards.slice(8, 13);

        cards = [cards0, cards1, cards2];
        //头道
        var typeName0 = KQCard.cardsType(cards0) + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        typeName0 = typeName0 == '04' ? '11' : typeName0;

        //中道
        var typeName1 = KQCard.cardsType(cards1) + 1;
        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;
        typeName1 = typeName1 == '07' ? '22' : typeName1;

        //尾道
        var typeName2 = KQCard.cardsType(cards2) + 1;
        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards, nodes, this.cardSpriteAtlas);
        if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards, nodes, this.cardSpriteAtlas);
        if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards, nodes, this.cardSpriteAtlas);
        if (this.foldCardNodeBack == false) {
            this.foldCardNodeBack = true;
        } else if (this.foldCardNodeBack == true) {
            this.foldCardNodeBack = false;
        }
    },

    _loadCardFrame: function _loadCardFrame(SpriteFrame, path, SpritesNode, w, h) {

        var Sprite = SpriteFrame.getSpriteFrame(path);

        SpritesNode.spriteFrame = Sprite;

        if (w) SpritesNode.node.width = w;

        if (h) SpritesNode.node.height = h;
    },

    // 准备好开始比牌
    // readyToCompareCards: function () {
    //     this.foldCardNode.targetOff(this.foldCardNode);
    //     this.foldCardNodeBack = true;
    //     this._clickFoldCardNode();
    //     this.cardsBackLayout.node.active = false;
    //     this.compareCardsNode.active = true;
    //     //this.foldCardNode.active = false;
    //     if(this.compareCardsNode.getComponent('CompareCards')._user){
    //         if(this.compareCardsNode.getComponent('CompareCards')._user.isContainExtra){
    //             this.teShuPaiNode.active = true;
    //         }else{
    //             this.teShuPaiNode.active = false;
    //         }
    //     }
    // },
    readyToCompareCards: function readyToCompareCards() {
        this.foldCardNode.targetOff(this.foldCardNode);
        this.foldCardNodeBack = true;
        this._clickFoldCardNode();
        this.cardsBackLayout.node.active = false;
        this.compareCardsNode.active = true;
        this.foldCardNode.active = true;
        if (this.compareCardsNode.getComponent('CompareCards')._user) {
            if (this.compareCardsNode.getComponent('CompareCards')._user.isContainExtra) {
                this.teShuPaiNode.active = true;
            } else {
                this.teShuPaiNode.active = false;
            }
        }
    },

    // 播放打枪动画
    // @param userId   要主动打枪的用户id
    // @param toUserIndex  挨枪的用户的 index
    playShootAnimation: function playShootAnimation(userId, toUserIndex) {
        if (userId != this.userId) {
            return;
        }
        var shotNode = this.shotNode[toUserIndex];
        shotNode.active = true;
        shotNode.children[0].active = true;
        shotNode.children[1].active = true;

        //枪
        var rotateBy = cc.rotateTo(0.1, -15);
        var delay1 = cc.delayTime(0.1);
        var rotateBy1 = cc.rotateTo(0.1, 0);
        var start_func1 = cc.callFunc(function () {
            shotNode.children[0].active = true;
        });
        var end_func1 = cc.callFunc(function () {
            shotNode.children[0].active = false;
        });
        var action = cc.repeat(cc.sequence(start_func1, rotateBy, delay1, rotateBy1, end_func1), 3);

        //烟
        var fadeIn = cc.fadeIn(0);
        var scaleTo1 = cc.scaleTo(0, 0.8);
        var scaleTo2 = cc.scaleTo(0.08, 1);
        var fadeOutAndScaleTo = cc.spawn(cc.fadeOut(0.02), cc.scaleTo(0.02, 0.5));
        var delay2 = cc.delayTime(.2);
        var start_func2 = cc.callFunc(function () {
            shotNode.children[1].active = true;
        });
        var end_func2 = cc.callFunc(function () {
            shotNode.children[1].active = false;
        });
        var action1 = cc.repeat(cc.sequence(start_func2, fadeIn, scaleTo1, scaleTo2, fadeOutAndScaleTo, delay2, end_func2), 3);

        shotNode.children[0].runAction(action);
        shotNode.children[1].runAction(action1);

        //let userInfo = this.userInfoNode.getComponent('userInfo');
        //userInfo.playShootAnimation(toUserIndex);
    },

    // 播放中枪动画
    playBulletHoleAnimation: function playBulletHoleAnimation(userId) {
        if (userId != this.userId) {
            return;
        }

        this.bulletHoleNode.active = true;

        var bulletHoleNode = cc.instantiate(this.bulletHolePrefab);

        bulletHoleNode.children.forEach((function (node) {
            node.active = false;
        }).bind(this));

        bulletHoleNode.children[0].y = 0;

        this.bulletHoleNode.addChild(bulletHoleNode);

        var interval = 0.3;

        var initTime = 0;

        bulletHoleNode.children.forEach((function (node) {

            this.scheduleOnce(function () {

                AudioManager.instance.playHumanZQiang();

                node.active = true;

                var y = Math.round(Math.random()) == 0 ? -1 : 1;

                y = Math.floor(Math.random() * 38) * y;

                var x = Math.round(Math.random()) == 0 ? -1 : 1;

                x = Math.floor(Math.random() * 38) * x;

                node.x = x;

                node.y = y;
            }, initTime);

            initTime = initTime + interval;
        }).bind(this));
    },

    // 播放全垒打动画
    playHomeRunAimation: function playHomeRunAimation(userId) {
        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.playHomeRunAimation();
    },

    playSpeakAnimation: function playSpeakAnimation(userId) {
        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.playSpeakAnimation();
    },

    nextCompareScore: function nextCompareScore() {
        if (!this.node.active) {
            return 0;
        }

        var score = this.compareCardsNode.getComponent('CompareCards').nextCompareScore();
        return score;
    },

    showNextCompareCards: function showNextCompareCards() {
        if (this.nextCompareScore() <= 0) {
            return;
        }
        this.teShuPaiNode.active = false;
        this.compareCardsNode.getComponent('CompareCards').showNextCards();
    },

    showAllCompareCards: function showAllCompareCards(users) {
        var user = users.find((function (e) {
            return this.userId == e.id;
        }).bind(this));
        this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
        this.compareCardsNode.getComponent('CompareCards').showAllCards();

        this.updateScore(this._userInfo.totalScore || 0);
    },

    showNextCompareScore: function showNextCompareScore(isContainExtra) {
        this.compareCardsNode.getComponent('CompareCards').showNextCompareScore(isContainExtra);
    },

    showScoreResult: function showScoreResult() {
        this.compareCardsNode.getComponent('CompareCards').showScoreResult();
    }
});

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","AudioManager":"AudioManager","KQCard":"KQCard","KQCardResHelper":"KQCardResHelper","KQGlobalEvent":"KQGlobalEvent","Playback":"Playback","UserModelHelper":"UserModelHelper","socket":"socket"}],"ResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9b2behcoUlLYL1MIMs+04wI', 'ResultItem');
// scripts\Play\ResultItem.js

var KQCardResHelper = require('KQCardResHelper');
var SpriteHelper = require('SpriteHelper');
var KQCard = require('KQCard');

cc.Class({
  'extends': cc.Component,

  properties: {
    avatarSprite: cc.Sprite,
    labelNickname: cc.Label,
    labelResultNumber: cc.Label,
    layoutTouDao: cc.Layout,
    layoutZhongDao: cc.Layout,
    layoutWeiDao: cc.Layout,
    layoutTeShu: cc.Layout,

    labelTeShuPaiTitle: cc.Label,

    scoreUnitNode: cc.Node, // 积分
    diamondUnitNode: cc.Node },

  // 钻石
  onLoad: function onLoad() {},

  //{"id":100049,"nickname":"imya","openId":"xx","avatarUrl":"xx","sex":1,
  // "cardNumber":3,"onlineStatus":1,"inviteCode":"","ipAddress":"::ffff:222.244.65.201",
  // "lastLoginTime":"2017-04-13 22:09:01","createAt":"2017-04-11 22:39:30",
  // "updateAt":"2017-04-13 22:09:01",
  // "cards":[],"roomId":"598883","readyStatus":true,"totalScore":0,
  // "cScore":0,"isBanker":false}
  updateWithPlayerInfo: function updateWithPlayerInfo(playerInfo) {
    var isRandomRoom = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];

    SpriteHelper.setImageUrl(this.avatarSprite, playerInfo.avatarUrl);
    this.labelNickname.string = playerInfo.nickname;
    //cc.log(this.labelResultNumber.string)
    //cc.log(playerInfo)
    //cc.log(playerInfo.cScore)
    //cc.log('---36')
    this.labelResultNumber.string = playerInfo.cScore;

    this.scoreUnitNode.active = !isRandomRoom;
    this.diamondUnitNode.active = isRandomRoom;
    var Number = playerInfo.cScore;
    if (isRandomRoom) {
      // 如果是随机场的话，则显示钻石数量
      Number = playerInfo.cScore * 5;
    }
    this.labelResultNumber.string = Number;
  },

  setCards: function setCards(cards) {
    cc.assert(cards.length == 13);

    // 不会再有特殊牌了
    /*if (KQCard.isTeShuPai(cards)) {
      this.setTeShuCards(cards);
      return;
      }
    */

    //let touCards = cards.slice(0, 3);
    //let zhongCards = cards.slice(3, 3 + 5);
    //let weiCards = cards.slice(8);
    //this.setTouCards(touCards);
    //this.setZhongCards(zhongCards);
    //this.setWeiCards(weiCards);
  }

});
/*setTouCards: function (cards) {
  this._setCardsToLayout(this.layoutTouDao, cards);
},
 setZhongCards: function (cards) {
  this._setCardsToLayout(this.layoutZhongDao, cards);
},
  setWeiCards: function (cards) {
  this._setCardsToLayout(this.layoutWeiDao, cards);
},*/

//结算  将特殊牌放入Layout
/*setTeShuCards: function (cards) {
  this.layoutTeShu.node.active = true;
  this.layoutTouDao.node.active = false;
  this.layoutZhongDao.node.active = false;
  this.layoutWeiDao.node.active = false;
  this._setCardsToLayout(this.layoutTeShu, cards);
   let typeName = KQCard.cardsTypeName(cards);
  this.labelTeShuPaiTitle.string = typeName;
},*/

//结算将牌放到Layout里面
/*_setCardsToLayout: function (layout, cards) {
  let node = layout.node;
  node.children.forEach(function (spriteNode, index) {
    let sprite = spriteNode.getComponent('cc.Sprite');
    let card = cards[index];
    if (!card) {
      return;
    }
     KQCardResHelper.setCardSpriteFrame(sprite, card.cardName());
  });
},*/

cc._RFpop();
},{"KQCard":"KQCard","KQCardResHelper":"KQCardResHelper","SpriteHelper":"SpriteHelper"}],"Setting":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3ad6mNk4BMBZzipGQDNlr4', 'Setting');
// scripts\Setting\Setting.js

var Manager = require('manager');
var KQNativeInvoke = require('KQNativeInvoke');

cc.Class({
  'extends': cc.Component,

  properties: {
    phone: cc.Label,
    musicSlider: cc.Node,
    effectSlider: cc.Node,
    btnSwitchAccount: cc.Button,
    shareBg: cc.Node,
    wx: cc.Node,
    pyq: cc.Node,
    music: cc.Node,
    sounds: cc.Node,
    _audioManager: null,
    _musicOn: 1,
    _soundsOn: 1,
    _phone: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._audioManager = cc.find('AudioManager') || {};
    this._audioManager = this._audioManager.getComponent('AudioManager');
    this._initSliders();
    this.phone.string = this._phone ? this._phone : "无";
    var bgMusic = cc.sys.localStorage.getItem("bgMusic");
    var bgSound = cc.sys.localStorage.getItem("bgSound");
    //console.log(bgMusic);
    if (bgMusic != '') {
      if (parseInt(bgMusic) == 1) {
        this._musicOn = 1;
        this.music.getChildByName('music_on').active = true;
        this.music.getChildByName('music_off').active = false;
      } else {
        this._musicOn = 0;
        this.music.getChildByName('music_on').active = false;
        this.music.getChildByName('music_off').active = true;
      }
    }
    if (bgSound == 0) {
      // 如果背景音效是关闭的
      if (parseInt(bgSound) == 0) {
        this._soundsOn = 0;
        this.sounds.getChildByName('sounds_on').active = false;
        this.sounds.getChildByName('sounds_off').active = true;
      } else {
        this._soundsOn = 1;
        this.sounds.getChildByName('sounds_on').active = true;
        this.sounds.getChildByName('sounds_off').active = false;
      }
      this._audioManager.setEffectMusicVolum(this._soundsOn);
    }
  },
  clickWx: function clickWx() {
    //点击微信
    if (!cc.sys.isNative) {
      this.shareBg.active = true;
      this.wx.active = true;
    } else {
      var title = cc.sys.localStorage.getItem('shareTitle');
      var description = cc.sys.localStorage.getItem('desc');
      var recordId = cc.sys.localStorage.getItem('recordId');
      var roomId = cc.sys.localStorage.getItem('roomId');
      var id = '';
      if (roomId) {
        id = 'roomId=' + roomId;
      }
      if (recordId) {
        id = 'recordId=' + recordId;
      }
      if (KQNativeInvoke.isNativeIOS()) {
        jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
      } else if (KQNativeInvoke.isNativeAndroid()) {
        //Android
        var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
        jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
      }
    }
  },
  clickPyq: function clickPyq() {
    //点击朋友圈
    if (!cc.sys.isNative) {
      this.shareBg.active = true;
      this.pyq.active = true;
    } else {
      var title = cc.sys.localStorage.getItem('shareTitle');
      var description = cc.sys.localStorage.getItem('desc');
      var recordId = cc.sys.localStorage.getItem('recordId');
      var roomId = cc.sys.localStorage.getItem('roomId');
      var id = '';
      if (roomId) {
        id = 'roomId=' + roomId;
      }
      if (recordId) {
        id = 'recordId=' + recordId;
      }
      if (KQNativeInvoke.isNativeIOS()) {
        jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline:description:", id, description, title);
      } else if (KQNativeInvoke.isNativeAndroid()) {
        //Android
        var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
        jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
      }
    }
  },

  clickshareBg: function clickshareBg() {
    // 点击分享背景图
    this.shareBg.active = false;
    this.wx.active = false;
    this.pyq.active = false;
  },
  clickMusic: function clickMusic() {
    //点击音乐
    this.music.children[1].active = this._musicOn = !this._musicOn;
    this.music.children[2].active = !this._musicOn;
    var volume = 0;
    if (this._musicOn) {
      this._audioManager.setBgMusicVolumn(1);
      this._audioManager.playMusic();
      volume = 1;
    } else {
      this._audioManager.setBgMusicVolumn(0);
      volume = 0;
    }
    cc.sys.localStorage.setItem("bgMusic", volume);
  },

  clickSounds: function clickSounds() {
    //点击了音效
    this.sounds.children[1].active = this._soundsOn = !this._soundsOn;
    this.sounds.children[2].active = !this._soundsOn;
    var volume = 0;
    if (this._soundsOn) {
      this._audioManager.setEffectMusicVolum(1);
      volume = 1;
    } else {
      this._audioManager.setEffectMusicVolum(0);
      volume = 0;
    }
    cc.sys.localStorage.setItem("bgSound", volume);
  },
  clickSetting: function clickSetting() {//点击设置

  },
  _initSliders: function _initSliders() {
    this._initSliderEvents();

    var musicVal = Manager.getMusicValue();
    var effectVal = Manager.getMusicEffectValue();

    this._audioManager.setBgMusicVolumn(musicVal);
    this._audioManager.setEffectMusicVolum(effectVal);

    this.musicSlider.getComponent('slider').setValue(musicVal);
    this.effectSlider.getComponent('slider').setValue(effectVal);
  },

  _initSliderEvents: function _initSliderEvents() {
    var self = this;
    this.musicSlider.getComponent('slider').onValueChange = function (value) {
      Manager.setMusicValue(value);
      self._audioManager.setBgMusicVolumn(value);
    };

    this.effectSlider.getComponent('slider').onValueChange = function (value) {
      Manager.setMusicEffectValue(value);
      self._audioManager.setEffectMusicVolum(value);
    };
  },

  clickSwitch: function clickSwitch() {},

  hideSwitch: function hideSwitch() {
    if (this.btnSwitchAccount) {
      this.btnSwitchAccount.node.active = false;
    }
  }
});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"SpriteHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '936f2uPA8NAuqUZv0R8ZxgP', 'SpriteHelper');
// scripts\Extensions\SpriteHelper.js

var SpriteHelper = {
  setImageUrl: function setImageUrl(sprite, url) {
    if (url.endsWith("png") || url.endsWith("jpg") || url.endsWith("gif")) {} else {
      //url = url + ".png";
    }

    cc.loader.load({ url: url, type: "jpg" }, function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      sprite.spriteFrame = frame;
    });
  }
};

module.exports = SpriteHelper;

cc._RFpop();
},{}],"StringExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7b106eQ/I5F1J85hMxFBIlw', 'StringExtension');
// scripts\Extensions\StringExtension.js

// 给 String 添加功能

// str.startsWith("");
// str.endsWith("");

if (!String.prototype.startsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`
		var defineProperty = (function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		})();
		var toString = ({}).toString;
		var startsWith = function startsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var position = arguments.length > 1 ? arguments[1] : undefined;
			// `ToInteger`
			var pos = position ? Number(position) : 0;
			if (pos != pos) {
				// better `isNaN`
				pos = 0;
			}
			var start = Math.min(Math.max(pos, 0), stringLength);
			// Avoid the `indexOf` call if no match is possible
			if (searchLength + start > stringLength) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'startsWith', {
				'value': startsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.startsWith = startsWith;
		}
	})();
}

// str.endsWith("");
if (!String.prototype.endsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`
		var defineProperty = (function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		})();
		var toString = ({}).toString;
		var endsWith = function endsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var pos = stringLength;
			if (arguments.length > 1) {
				var position = arguments[1];
				if (position !== undefined) {
					// `ToInteger`
					pos = position ? Number(position) : 0;
					if (pos != pos) {
						// better `isNaN`
						pos = 0;
					}
				}
			}
			var end = Math.min(Math.max(pos, 0), stringLength);
			var start = end - searchLength;
			if (start < 0) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'endsWith', {
				'value': endsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.endsWith = endsWith;
		}
	})();
}

cc._RFpop();
},{}],"TotalGameResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1c6f93a1BOnoSiX6kJ0Efn', 'TotalGameResultItem');
// scripts\Play\TotalGameResultItem.js

var SpriteHelper = require('SpriteHelper');
cc.Class({
  "extends": cc.Component,

  properties: {
    avatarSprite: cc.Sprite,
    labelUserId: cc.Label,
    labelScore: cc.Label,
    labelNickname: cc.Label,

    _deskInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setUserInfo: function setUserInfo(user, deskInfo) {
    if (!user) {
      return;
    }

    var totalScore = user.totalScore;
    if (deskInfo && (deskInfo.setting1 == 0 || deskInfo.setting1 == 1)) {
      var baseScore = deskInfo.setting1 == 0 ? 100 : 200;
      totalScore = totalScore - baseScore;
    }

    SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);
    this.labelUserId.string = "" + user.id;
    this.labelScore.string = totalScore > 0 ? "+ " + totalScore : "- " + totalScore * -1;
    if (totalScore == 0) {
      this.labelScore.string = "0";
    }
    this.labelNickname.string = user.nickname;
  }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"TotalGameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f7fb2e7foJFNJzjdtbAtk7O', 'TotalGameResult');
// scripts\Play\TotalGameResult.js

var KQNativeInvoke = require('KQNativeInvoke');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        itemLayout: cc.Layout,
        itemPrefab: cc.Prefab,
        timeLabel: cc.Label, // 时间
        jushuLabel: cc.Label, // 局数
        roomId: cc.Label, // 房间号
        nicknameLabels: cc.Label,
        recordInfo_sview: [cc.Node],

        sharrBg: cc.Node,
        btnWeiXin: cc.Node,
        btnGongXuoHao: cc.Node,
        btnZhuShou: cc.Node,
        btnZongFen: cc.Node,

        suanfen_sview: cc.Node,
        suanFenPrefab: cc.Prefab,
        suanFenBgPrefab: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {},

    onDisable: function onDisable() {
        //if(cc.sys.isBrowser){
        //
        var shareTitle = '开房玩[大众十三水]';
        var desc = '开好房了，就等你们一起来[大众十三水]啦！晚了位置就没了哟~';
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);

        // cc.sys.localStorage.removeItem("shareTitle");
        // cc.sys.localStorage.removeItem("desc");
        cc.sys.localStorage.removeItem("recordId");
        //cc.sys.localStorage.setItem("roomId",'');
        if (window.shareToTimeLine) {
            window.shareToTimeLine();
        }
        if (window.shareToSession) {
            window.shareToSession();
        }
        //}
    },
    js: function js(setting2) {
        var jushu = 5;
        switch (setting2) {
            case 0:
                jushu = 5;break;case 1:
                jushu = 10;break;
            case 2:
                jushu = 20;break;case 3:
                jushu = 30;break;
        }
        return jushu;
    },

    creator: function creator(_creator, players) {
        //创房者
        for (var i = 0; i < players.length; i++) {
            if (players[i].id == _creator) {
                return i;
            }
        }
    },

    _clickBtn: function _clickBtn() {
        this.btnZhuShou.active = true;
        this.btnZongFen.active = false;
    },

    clickZongFen: function clickZongFen() {

        this.btnZhuShou.active = true;

        this.btnZongFen.active = false;

        this.recordInfo_sview.forEach(function (node) {
            node.active = true;
        });

        this.suanfen_sview.active = false;
    },
    _globalMsg: function _globalMsg(recordInfo) {
        //if(cc.sys.isBrowser) {
        var roomId = "房间号：" + recordInfo.roomId;
        var pj = ["5 ", "10 ", "20 "];
        var js = "局数：" + pj[recordInfo.setting1 - 2];
        var time = "时间：" + (recordInfo.createAt ? recordInfo.createAt : recordInfo.createTime);
        var shareTitle = "[大众十三水]战绩";
        var desc = roomId + js + time + " 点击查看详情";
        var recordId = recordInfo.id != undefined ? recordInfo.id : recordInfo.recordId;
        cc.sys.localStorage.setItem("shareTitle", shareTitle);
        cc.sys.localStorage.setItem("desc", desc);
        cc.sys.localStorage.setItem("recordId", recordId);
        cc.sys.localStorage.setItem("roomId", '');

        if (window.shareToTimeLine) {
            window.shareToTimeLine();
        }
        if (window.shareToSession) {
            window.shareToSession();
        }
        //}
    },
    //大局
    setPlayerInfos: function setPlayerInfos(playerInfos, deskInfo) {
        playerInfos.sort(function (a, b) {
            return b.totalScore - a.totalScore;
        }); // 排序
        // cc.log(playerInfos)
        // cc.log(deskInfo)
        // cc.log('--65')

        this._globalMsg(deskInfo);
        this.recordInfo_sview.forEach(function (node) {
            node.active = true;
        });

        this.suanfen_sview.active = false;

        this.btnZhuShou.active = true;

        this.btnZongFen.active = false;

        this._playerInfos = playerInfos;

        this._deskInfo = deskInfo;

        var createId = deskInfo.createUserId ? deskInfo.createUserId : deskInfo.createId;

        var nickname = playerInfos[this.creator(createId, playerInfos)].nickname;

        this.roomId.string = deskInfo.roomId;

        var createAt = deskInfo.createAt ? deskInfo.createAt : deskInfo.createTime;

        this.timeLabel.string = createAt.substr(0, 11);

        this.jushuLabel.string = this.js(deskInfo.setting1 - 2);

        this.nicknameLabels.string = nickname;

        this.itemLayout.node.removeAllChildren();

        playerInfos.forEach((function (user) {

            var item = cc.instantiate(this.itemPrefab);

            item.getComponent('TotalGameResultItem').setUserInfo(user, deskInfo);

            if (deskInfo.createUserId == user.id || deskInfo.createId == user.id) {

                item.children[1].children[0].active = true;
            } else {

                item.children[1].children[0].active = false;
            }

            this.itemLayout.node.addChild(item);
        }).bind(this));
    },

    //算分能手
    clickSuanFen: function clickSuanFen() {

        this.btnZhuShou.active = false;

        this.btnZongFen.active = true;

        this.recordInfo_sview.forEach(function (node) {
            node.active = false;
        });

        this.suanfen_sview.active = true;

        var playersRigth = this._playerInfos.filter(function (player) {
            return player.totalScore > 0;
        });

        var playersLeft = this._playerInfos.filter(function (player) {
            return player.totalScore < 0;
        });

        var playersRigthScore = playersRigth.map(function (player) {
            return player.totalScore;
        });

        var playersLeftScore = playersLeft.map(function (player) {
            return player.totalScore * -1;
        });

        var playersIndex = [],
            arrs = [playersRigthScore.filter(function (i) {
            return i;
        }), playersLeftScore.filter(function (i) {
            return i;
        })],
            indexs = playersLeftScore.length > playersRigthScore.length ? 0 : 1; //1是赢的人 0输的人

        // for(var i = 0;i < arrs[indexs].length; i++){

        //     var score = arrs[indexs][i];

        //     var d = this.getCombBySum(arrs[indexs==1?0:1], score)[0] || [];

        //     if(d.length > 0){

        //         playersIndex.push([score,d]);

        //         d.forEach(function (s) {

        //             var index = arrs[indexs==1?0:1].indexOf(s);

        //             if(index != -1) arrs[indexs==1?0:1].splice(index,1);

        //         });
        //     }
        // }

        // if(playersIndex.length == 0) indexs = 2;
        indexs = 2;
        this.suanfen_sview.children[0].removeAllChildren();

        playersLeft.forEach((function (user, index) {

            var suanFenBgPrefab = cc.instantiate(this.suanFenBgPrefab);

            suanFenBgPrefab.removeAllChildren();

            this._ctarePrefab(1, suanFenBgPrefab, user, user.totalScore, this._deskInfo, -200, 0);

            var x = 0,
                y = 0;

            if (indexs == 1) {
                for (var j = 0; j < playersIndex[index][1].length; j++) {

                    var s = playersIndex[index][1][j];

                    var d = playersRigthScore.indexOf(s);

                    if (d != -1) {

                        var plays = playersRigth.splice(d, 1)[0];

                        playersRigthScore.splice(d, 1);

                        if (plays) {

                            if (suanFenBgPrefab.childrenCount >= 3) y = -90;

                            if (suanFenBgPrefab.childrenCount == 3) x = 0;

                            if (suanFenBgPrefab.childrenCount >= 5) y = -180;

                            if (suanFenBgPrefab.childrenCount == 5) x = 0;

                            this._ctarePrefab(0, suanFenBgPrefab, plays, plays.totalScore, this._deskInfo, x, y);

                            x += 200;
                        }
                    }
                }
            } else if (indexs == 0) {
                var fen = suanFenBgPrefab.children[0].getChildByName("fen").getComponent(cc.Label).string.substr(3) * -1;

                for (var j = 0; j < playersIndex.length; j++) {

                    var s = playersIndex[j];

                    var d = s[1].indexOf(fen);

                    var q = s[0];

                    var w = playersRigthScore.indexOf(q);

                    if (d != -1 && w != -1) {

                        var plays = playersRigth[w];

                        this._ctarePrefab(0, suanFenBgPrefab, plays, plays.totalScore, this._deskInfo, x, y, fen);
                    }
                }
            } else {
                var q = playersLeftScore[index];
                var addScore = 0;
                var arr = [];
                for (var j = 0; j < playersRigthScore.length; j++) {
                    var w = playersRigthScore[j];
                    if (addScore < q) {
                        addScore += w;
                        if (addScore > q) {
                            arr.push(w - (addScore - q));
                        } else {
                            arr.push(w);
                        }
                        if (q - w >= 0) {
                            playersRigthScore[j] = 0;
                        }
                    }
                    if (addScore > q) {
                        playersRigthScore[j] = addScore - q;
                        break;
                    }
                }

                for (var t = 0; t < arr.length; t++) {
                    var r = arr[t];
                    if (r == 0) continue;
                    if (suanFenBgPrefab.childrenCount >= 3) y = -90;

                    if (suanFenBgPrefab.childrenCount == 3) x = 0;

                    if (suanFenBgPrefab.childrenCount >= 5) y = -180;

                    if (suanFenBgPrefab.childrenCount == 5) x = 0;

                    var plays = playersRigth[t];

                    this._ctarePrefab(0, suanFenBgPrefab, plays, r, this._deskInfo, x, y);

                    x += 200;
                }
            }

            this.suanfen_sview.children[0].addChild(suanFenBgPrefab);
        }).bind(this));
    },

    _ctarePrefab: function _ctarePrefab(shu, node, user, totalScore, deskInfo, x, y) {
        var fen = arguments.length <= 7 || arguments[7] === undefined ? null : arguments[7];

        var suanFenPrefab = cc.instantiate(this.suanFenPrefab);

        suanFenPrefab.getChildByName("ID").getComponent(cc.Label).string = "ID:" + user.id;

        if (deskInfo.createUserId == user.id) suanFenPrefab.getChildByName("ID").color = new cc.Color(235, 115, 122);

        suanFenPrefab.getChildByName("shu").getComponent(cc.Label).string = shu == 0 ? "输" : "";

        var str = shu == 0 ? totalScore + "分" : "总分:" + totalScore;

        if (fen) str = fen + "分";

        suanFenPrefab.getChildByName("fen").getComponent(cc.Label).string = str;

        var sprite = suanFenPrefab.getChildByName("haed").getComponent(cc.Sprite);

        var headUrl = user.avatarUrl; // 头像URL

        cc.loader.load({ url: headUrl, type: "jpg" }, function (err, tex) {

            if (!err) {

                var frame = new cc.SpriteFrame(tex);

                sprite.spriteFrame = frame;

                sprite.node.height = 55;

                sprite.node.width = 55;
            }
        });

        suanFenPrefab.x = x;

        suanFenPrefab.y = y;

        node.height = 90 + y * -1;

        node.addChild(suanFenPrefab);
    },

    clickExit: function clickExit() {
        Socket.sendOnceAgain('false', this._userId);
        cc.director.loadScene('hall');
    },

    clickShareWeiChat: function clickShareWeiChat() {
        if (!cc.sys.isNative) {
            this.sharrBg.active = true;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
            } else {
                //Android
                KQNativeInvoke.screenshotShare();
            }
        }
    },
    clickShareBg: function clickShareBg() {
        this.sharrBg.active = false;
    },
    clickSharePengYouQuan: function clickSharePengYouQuan() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
        }
    },

    getCombBySum: function getCombBySum(array, sum, tolerance, targetCount) {
        var util = {
            /*
             get combination from array
             arr: target array
             num: combination item length
             return: one array that contain combination arrays
             */
            getCombination: function getCombination(arr, num) {
                var r = [];
                (function f(t, a, n) {
                    if (n == 0) {
                        return r.push(t);
                    }
                    for (var i = 0, l = a.length; i <= l - n; i++) {
                        f(t.concat(a[i]), a.slice(i + 1), n - 1);
                    }
                })([], arr, num);
                return r;
            },
            //take array index to a array
            getArrayIndex: function getArrayIndex(array) {
                var i = 0,
                    r = [];
                for (i = 0; i < array.length; i++) {
                    r.push(i);
                }

                return r;
            }
        },
            logic = {
            //sort the array,then get what's we need
            init: function init(array, sum) {
                //clone array
                var _array = array.concat(),
                    r = [],
                    i = 0;
                //sort by asc
                _array.sort(function (a, b) {
                    return a - b;
                });
                //get all number when it's less than or equal sum
                for (i = 0; i < _array.length; i++) {
                    if (_array[i] <= sum) {
                        r.push(_array[i]);
                    } else {
                        break;
                    }
                }

                return r;
            },
            //important function
            core: function core(array, sum, arrayIndex, count, r) {
                var i = 0,
                    k = 0,
                    combArray = [],
                    _sum = 0,
                    _cca = [],
                    _cache = [];

                if (count == _returnMark) {
                    return;
                }
                //get current count combination
                combArray = util.getCombination(arrayIndex, count);
                for (i = 0; i < combArray.length; i++) {
                    _cca = combArray[i];
                    _sum = 0;
                    _cache = [];
                    //calculate the sum from combination
                    for (k = 0; k < _cca.length; k++) {
                        _sum += array[_cca[k]];
                        _cache.push(array[_cca[k]]);
                    }
                    if (Math.abs(_sum - sum) <= _tolerance) {
                        r.push(_cache);
                    }
                }

                logic.core(array, sum, arrayIndex, count - 1, r);
            }

        },
            r = [],
            _array = [],
            _targetCount = 0,
            _tolerance = 0,
            _returnMark = 0;

        //check data
        _targetCount = targetCount || _targetCount;
        _tolerance = tolerance || _tolerance;

        _array = logic.init(array, sum);
        if (_targetCount) {
            _returnMark = _targetCount - 1;
        }

        logic.core(_array, sum, util.getArrayIndex(_array), _targetCount || _array.length, r);

        return r;
    }
});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","socket":"socket"}],"UserModelHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98854aScapF5oQnHKxJsvmF', 'UserModelHelper');
// scripts\ModelUtils\UserModelHelper.js

var UserModelHelper = {
  // 用户是否已出牌
  isPlayedCards: function isPlayedCards(user) {
    cc.assert(user);

    if (user && user.cardInfo && user.cardInfo.length > 0) {
      return true;
    }

    return false;
  },

  // 用户是否已准备
  isUserReady: function isUserReady(user) {
    return user.readyStatus == true;
  }
};

module.exports = UserModelHelper;

cc._RFpop();
},{}],"UserSampleInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3a9f7A0IgRGPrAZvy1p9s4i', 'UserSampleInfo');
// scripts\Play\UserSampleInfo.js

var SpriteHelper = require('SpriteHelper');

cc.Class({
  'extends': cc.Component,

  properties: {
    labelUserId: cc.Label,
    labelUserIP: cc.Label,
    labelNickname: cc.Label,
    avatarSprite: cc.Sprite,
    manSprite: cc.Sprite,
    womenSprite: cc.Sprite,

    _didShowUserInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  updateWithUser: function updateWithUser(user) {
    return;
    if (!user) {
      return;
    }

    if (this._didShowUserInfo == user) {
      this.unscheduleAllCallbacks();
      this._disappearUserInfo();
      return;
    }

    this._didShowUserInfo = user;
    if (!this.node.active) {
      this.node.getComponent('alert').alert();
    }

    this.unscheduleAllCallbacks();
    this.scheduleOnce((function () {
      this._disappearUserInfo();
    }).bind(this), 5);

    this.labelUserId.string = "UID:\n" + user.id;
    this.labelUserIP.string = "用户IP:\n" + user.ipAddress.replace("::ffff:", "");
    this.labelNickname.string = user.nickname;
    this.avatarSprite.spriteFrame = null;
    SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);

    var sex = user.sex; // sex: 1 男  2 女
    this.manSprite.node.active = sex == 1;
    this.womenSprite.node.active = sex != 1;
  },

  _disappearUserInfo: function _disappearUserInfo() {
    this.node.active = false;
    this._didShowUserInfo = null;
  }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"agreement":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8f601dzNnZLtq+KGT0uqDqF', 'agreement');
// scripts\agreement.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');
cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        agreement: {
            'default': null,
            type: cc.Label
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        // cc.log('----61')
        //  cc.log(this.agreement)
    },
    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (!response.result) {
            return;
        }
        var s = cc.find('Canvas/agreement');
        var data = response.data;
        //this._info1 = response.data;
        // cc.log(this.agreement)
        // cc.log(s)
        // cc.log('----61')
        this.agreement.string = data.info1 || "";
    }
});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"alert":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16cd2qs73lByZaHhJkQAEee', 'alert');
// scripts\alert.js

var AudioManager = require('AudioManager');
cc.Class({
  'extends': cc.Component,

  properties: {
    // foo: {
    //    default: null,      // The default value will be used only when the component attaching
    //                           to a node for the first time
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    popNode: cc.Node,
    label: cc.Label,

    _alertCallback: null,
    _willDismissCallback: null,
    _dismissCallback: null,
    _confirmCallback: null, // 点击确定后的回调
    _tishi: null,
    _card_num: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  alert: function alert() {
    this.node.active = true;
    var anim = this.popNode.getComponent(cc.Animation);
    anim.play('pop');

    if (this._alertCallback) {
      this._alertCallback(this.node);
    }
  },
  /*#####弹出结果*/
  alertResult: function alertResult() {
    this.node.active = true;
    cc.find("Canvas/show_result").active = false;
    var anim = this.popNode.getComponent(cc.Animation);
    anim.play('pop');

    if (this._alertCallback) {
      this._alertCallback(this.node);
    }
  },

  /*#####点击确定*/
  playBtnClickSFX: function playBtnClickSFX() {
    AudioManager.instance.playBtnClickSFX();
  },

  /*#####点击取消*/
  palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
    AudioManager.instance.palyBtnCancelClickSFX();
  },

  /*#####点击关闭或者按键之类的按钮，播放音效*/
  palyBtnPublicSFX: function palyBtnPublicSFX() {
    AudioManager.instance.palyBtnPublicSFX();
  },

  /*#####点击创建房间，播放音效*/
  palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
    AudioManager.instance.palyBtnCreateRoomSFX();
  },
  /*#####点击创建房间，播放音效*/
  palyWindowSFX: function palyWindowSFX() {
    AudioManager.instance.palyWindowSFX();
  },

  palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
    AudioManager.instance.palyWeiXinLoginSFX();
  },
  palyFangPaiSFX: function palyFangPaiSFX() {
    AudioManager.instance.palyFangPaiSFX();
  },

  dismissAction: function dismissAction() {
    var willDismissCallback = this._willDismissCallback;
    if (willDismissCallback) {
      var result = willDismissCallback();
      if (result) {
        this.dismissComplete();
        return;
      }
    }

    var anim = this.popNode.getComponent(cc.Animation);
    var dismissAnim = anim.getAnimationState('pop_dismiss');
    dismissAnim.on('finished', this.dismissComplete, this);
    anim.play('pop_dismiss');
  },

  /*#####隐藏结果页面*/
  dismissActionResult: function dismissActionResult() {
    var willDismissCallback = this._willDismissCallback;
    if (willDismissCallback) {
      var result = willDismissCallback();
      if (result) {
        this.dismissComplete();
        return;
      }
    }

    var anim = this.popNode.getComponent(cc.Animation);
    var dismissAnim = anim.getAnimationState('pop_dismiss');
    dismissAnim.on('finished', this.dismissComplete, this);
    anim.play('pop_dismiss');
    cc.find("Canvas/show_result").active = true;
  },

  dismissComplete: function dismissComplete() {
    this.node.active = false;

    if (this.onDismissComplete) {
      this.onDismissComplete();
    }

    if (this._dismissCallback) {
      this._dismissCallback(this.node);
    }
  },
  dismissPlay: function dismissPlay() {
    cc.director.loadScene("hall");
  },

  onDismissComplete: function onDismissComplete() {
    //cc.log("onDismissComplete");
  },

  doneAction: function doneAction() {
    this.dismissAction();
    this.onDoneAction();

    var confirmCallback = this._confirmCallback;
    if (confirmCallback) {
      confirmCallback(this.node);
    }
  },

  onDoneAction: function onDoneAction() {},

  setMessage: function setMessage(msg) {
    this.label.string = msg;
  },

  getMessage: function getMessage() {
    return this.label.string;
  },

  setAlertCallbck: function setAlertCallbck(callback) {
    this._alertCallback = callback;
  },

  setWillDismissCallback: function setWillDismissCallback(callback) {
    this._willDismissCallback = callback;
  },

  setDismissCallback: function setDismissCallback(callback) {
    this._dismissCallback = callback;
  },

  setConfirmCallback: function setConfirmCallback(callback) {
    this._confirmCallback = callback;
  }

});
/*setMessage: function (message) {
  this.label.getComponent('cc.Label').string = message;
},*/

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"AudioManager":"AudioManager"}],"animation":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c9ee9y0ua5NRLSZAxQqDjdw', 'animation');
// scripts\animation.js

/**
 *  房间特殊牌动画
 *
 *
 *
 * 
 */
cc.Class({
    "extends": cc.Component,

    properties: {
        fapaiNode: cc.Prefab, //
        liuduiban: cc.Prefab,
        santonghua: cc.Prefab,
        sanshunzi: cc.Prefab,
        quanleida: cc.Prefab,
        qinglong: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {},
    fapaiAnimation: function fapaiAnimation() {
        var fapai = this.node.getChildByName('fapai');
        fapai = cc.removeSelf();
        var fapaiAnim = cc.instantiate(this.fapaiNode);
        this.node.addChild(fapaiAnim);

        var Lgun = fapaiAnim.getChildByName("left_gang"); // 左边的抢
        var Rgun = fapaiAnim.getChildByName("right_gang"); // 右边的抢
        var mask = fapaiAnim.getChildByName("mask");
        /* -----------start及子节点----------- */
        var start = fapaiAnim.getChildByName("start"),
            quan = start.getChildByName("quan"),
            baodian = start.getChildByName("baodian"),
            ditan = start.getChildByName("ditan"),
            beginIco = start.getChildByName("begin_icon"),
            title = start.getChildByName("title"),
            rWing = start.getChildByName("rWing"),
            lWing = start.getChildByName("lWing");
        /* --------------------------------- */
        var self = this;
        fapaiAnim.active = true;
        mask.runAction(cc.scaleTo(0.2, 10, 10));
        Lgun.runAction(cc.sequence(self.LgunAction()));
        Rgun.runAction(cc.sequence(self.RgunAction()));

        var startFinished = cc.callFunc(function () {
            rWing.active = true;
            lWing.active = true;
            lWing.runAction(cc.sequence(cc.repeat(cc.sequence(cc.skewTo(0.05, 20, -10), cc.skewTo(0.05, 0, 0)), 3), cc.fadeOut(0)));
            rWing.runAction(cc.sequence(cc.repeat(cc.sequence(cc.skewTo(0.05, 20, -10), cc.skewTo(0.05, 0, 0)), 3), cc.fadeOut(0)));
        });
        var wingFinished = cc.callFunc(function () {
            setTimeout(function () {
                start.runAction(cc.scaleTo(0.2, 0, 0));
            }, 500);
        });
        setTimeout(function () {
            start.active = true;
            start.runAction(cc.sequence(cc.scaleTo(0.2, 1.5, 1.5), cc.scaleTo(0.2, 1, 1), startFinished, wingFinished));
            quan.runAction(cc.sequence(cc.scaleTo(0.2, 10, 10), cc.fadeOut(0)));
            baodian.runAction(cc.sequence(cc.scaleTo(0.2, 1.5, 1.5), cc.fadeOut(0)));
        }, 400);
        setTimeout(function () {
            lWing.active = false;
            rWing.active = false;
            start.active = false;
            fapaiAnim.active = false;
            fapaiAnim.removeFromParent(true);
        }, 2000);
    },
    LgunAction: function LgunAction() {
        // 左边的枪
        return [cc.spawn([cc.moveTo(0.2, cc.v2(-430, 152)), cc.scaleTo(0.2, 2, 2)]), cc.spawn([cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(-220, 0)), cc.rotateTo(0.2, 35)]), cc.fadeOut(0)];
    },
    RgunAction: function RgunAction() {
        // 右边的枪
        return [cc.spawn([cc.moveTo(0.2, cc.v2(430, 152)), cc.scaleTo(0.2, -2, 2)]), cc.spawn([cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(220, 0)), cc.rotateTo(0.2, -35)]), cc.fadeOut(0)];
    },
    _bezier1: function _bezier1(index) {
        var bezier = [];
        bezier[0] = [[cc.v2(100, 74), cc.v2(150, 174), cc.v2(200, -174)], cc.v2(100, 74)];
        bezier[1] = [[cc.v2(-72, 284), cc.v2(-122, 384), cc.v2(-222, -150)], cc.v2(-72, 284)];
        bezier[2] = [[cc.v2(-70, 200), cc.v2(-120, 300), cc.v2(-220, -200)], cc.v2(-70, 200)];
        bezier[3] = [[cc.v2(-123, 213), cc.v2(-173, 313), cc.v2(-273, -160)], cc.v2(-123, 213)];
        bezier[4] = [[cc.v2(110, 237), cc.v2(160, 337), cc.v2(260, -177)], cc.v2(210, 237)];
        bezier[5] = [[cc.v2(183, 115), cc.v2(233, 215), cc.v2(333, -155)], cc.v2(183, 115)];
        bezier[6] = [[cc.v2(92, 116), cc.v2(142, 216), cc.v2(242, -146)], cc.v2(92, 116)];
        bezier[7] = [[cc.v2(-26, 124), cc.v2(-76, 224), cc.v2(-176, -164)], cc.v2(-26, 124)];
        bezier[8] = [[cc.v2(-110, 81), cc.v2(-220, 131), cc.v2(-460, -180)], cc.v2(-110, 81)];
        bezier[9] = [[cc.v2(-125, 33), cc.v2(-225, 133), cc.v2(-275, -133)], cc.v2(-125, 33)];
        bezier[10] = [[cc.v2(0, 0), cc.v2(50, 100), cc.v2(150, -150)], cc.v2(0, 0)];
        bezier[11] = [[cc.v2(-235, 5), cc.v2(-275, 105), cc.v2(-375, -186)], cc.v2(-235, 5)];
        bezier[12] = [[cc.v2(-80, 4), cc.v2(-130, 104), cc.v2(-230, -233)], cc.v2(-80, 4)];
        bezier[13] = [[cc.v2(100, -7), cc.v2(150, 107), cc.v2(250, -177)], cc.v2(100, -7)];
        bezier[14] = [[cc.v2(154, 23), cc.v2(204, 113), cc.v2(254, -173)], cc.v2(254, 23)];
        return bezier[index];
    },
    // 青龙动画
    _qinglongAniamtion: function _qinglongAniamtion(type) {
        var qinglong = cc.instantiate(this.qinglong);
        this.node.addChild(qinglong);
        var bg = qinglong.getChildByName('bg');
        var title = '';
        if (type == "ql") {
            title = qinglong.getChildByName('qlongtitle');
        } else {
            title = qinglong.getChildByName('longtitle');
        }

        var yun1 = qinglong.getChildByName('yun1');
        var yun2 = qinglong.getChildByName('yun2');
        var yun3 = qinglong.getChildByName('yun3');
        var yun4 = qinglong.getChildByName('yun4');
        var long = qinglong.getChildByName("long");

        var hua1 = qinglong.getChildByName('hua1');
        var hua2 = qinglong.getChildByName('hua2');
        var hua3 = qinglong.getChildByName('hua3');
        var A = [],
            B = [],
            C = [];
        var hua = [];

        var test = cc.instantiate(hua1);

        var self = this;
        for (var i = 0; i < 5; i++) {
            A[i] = cc.instantiate(hua1);
            A[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(A[i]);
            B[i] = cc.instantiate(hua2);
            B[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(B[i]);
            C[i] = cc.instantiate(hua3);
            C[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(C[i]);
        };
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), cc.scaleTo(0.2, 2, 2), cc.spawn(cc.scaleTo(0.2, 1.5, 1.5), longStart)));
        });
        var longStart = cc.callFunc(function () {
            long.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 0.5)), cc.scaleTo(0.1, 3, 3), cc.spawn(cc.scaleTo(0.1, 1, 1), yunStart)));
        });
        var flowerStart = cc.callFunc(function () {});
        var yunStart = cc.callFunc(function () {
            yun1.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(-334, 234)), cc.moveTo(0.2, cc.v2(-344, 234))), 3)));
            yun2.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(-368, -82)), cc.moveTo(0.2, cc.v2(-358, -82))), 3)));
            yun3.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(408, -4)), cc.moveTo(0.2, cc.v2(398, -4))), 3)));
            yun4.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(406, 181)), cc.moveTo(0.2, cc.v2(416, 181))), 3)));
            for (var i = 1; i < hua.length; i++) {
                hua[i].setPosition(self._bezier(i)[1]);
                qinglong.addChild(hua[i]);
                hua[i].runAction(cc.sequence(cc.spawn(cc.bezierTo(0.3, self._bezier(i)[0]), cc.scaleTo(0.3, 1, 1), cc.fadeTo(0.3, 0))));
            }
            setTimeout(function () {
                qinglong.removeFromParent(true);
            }, 1500);
            //yun1
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.scaleTo(0.2, 2, 2));
    },
    // 三顺子动画
    _sanshunziAnimation: function _sanshunziAnimation() {
        var sanshunzi = cc.instantiate(this.sanshunzi);
        this.node.addChild(sanshunzi);
        var bg = sanshunzi.getChildByName('bg');
        var Ltu = sanshunzi.getChildByName('Ltu');
        var Rtu = sanshunzi.getChildByName('Rtu');
        var title = sanshunzi.getChildByName('title');
        var zushun1 = sanshunzi.getChildByName('zushun1');
        var zushun2 = sanshunzi.getChildByName('zushun2');
        var zushun3 = sanshunzi.getChildByName('zushun3');
        var zushun4 = sanshunzi.getChildByName('zushun4');
        var zushun5 = sanshunzi.getChildByName('zushun5');
        var self = this;
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.2, 2.5, 2.5), titleScale));
            Ltu.runAction(cc.sequence(cc.fadeTo(0.2, 255)));
            Rtu.runAction(cc.sequence(cc.fadeTo(0.2, 255)));
        });
        var titleScale = cc.callFunc(function () {
            // title放大完成后 竹笋2和3同时进行
            title.runAction(cc.scaleTo(0.2, 1.5, 1.5));
            zushun2.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10), ZS1));
            zushun3.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 22, 22)), cc.scaleTo(0.2, 20, 20), ZS4));
            setTimeout(function () {
                zushun5.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10)));
            }, 100);
            setTimeout(function () {
                self.sanshunzi.active = false;
                sanshunzi.removeFromParent(true);
            }, 2000);
        });
        var ZS1 = cc.callFunc(function () {
            zushun1.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10)));
        });
        var ZS4 = cc.callFunc(function () {
            zushun4.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 14, 14)), cc.scaleTo(0.2, 12, 12)));
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.scaleTo(0.2, 2, 2));
    },
    // 全垒打
    _quanleidaAnimation: function _quanleidaAnimation() {
        var quanleida = cc.instantiate(this.quanleida);
        this.node.addChild(quanleida);
        var bg = quanleida.getChildByName('bg');
        var ball = quanleida.getChildByName('ball');
        var bangqiutao = quanleida.getChildByName('bangqiutao');
        var bangqiugun = quanleida.getChildByName('bangqiugun');
        var Lyun = quanleida.getChildByName('Lyun');
        var Ryun = quanleida.getChildByName('Ryun');
        var title = quanleida.getChildByName('title');
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.2, 2.5, 2.5), cc.scaleTo(0.2, 1.5, 1.5), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(0, 20)), cc.moveTo(0.3, cc.v2(0, 0))), 2)));

            Lyun.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 20, 20), cc.moveTo(0.2, cc.v2(-270, 70))), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(-270, 26)), cc.moveTo(0.3, cc.v2(-270, 46))), 2)));

            Ryun.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 20, 20), cc.moveTo(0.2, cc.v2(270, 70))), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(270, 66)), cc.moveTo(0.3, cc.v2(270, 46))), 2)));

            bangqiutao.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.3, 10, 10), cc.moveTo(0.3, cc.v2(250, 50))), bqtFinished));
        });
        var bqtFinished = cc.callFunc(function () {
            bangqiutao.runAction(cc.repeat(cc.sequence(cc.rotateTo(0.2, -10), cc.rotateTo(0.2, 0)), 3));
            ball.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.1, 255), cc.moveTo(0.2, cc.v2(196, 83))), ballFinished));
        });
        var ballFinished = cc.callFunc(function () {
            ball.runAction(cc.spawn(cc.fadeTo(0.2, 0), cc.moveTo(0.2, cc.v2(0, 0)), cc.scaleTo(0.2, 4, 4)));
            bangqiugun.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 2, 2), cc.fadeTo(0.2, 255)), cc.scaleTo(0.3, 1.5, 1.5)));
            setTimeout(function () {
                bg.runAction(cc.fadeTo(0.2, 0));
                ball.runAction(cc.fadeTo(0.2, 0));
                bangqiutao.runAction(cc.fadeTo(0.2, 0));
                bangqiugun.runAction(cc.fadeTo(0.2, 0));
                Lyun.runAction(cc.fadeTo(0.2, 0));
                Ryun.runAction(cc.fadeTo(0.2, 0));
                title.runAction(cc.fadeTo(0.2, 0));

                quanleida.removeFromParent(true);
            }, 2000);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    },

    // 三同花动画
    _santonghuaAnimation: function _santonghuaAnimation() {
        var santonghua = cc.instantiate(this.santonghua);
        this.node.addChild(santonghua);
        var bg = santonghua.getChildByName('bg');
        var hua1 = santonghua.getChildByName('hua1');
        var hua2 = santonghua.getChildByName('hua2');
        var hua3 = santonghua.getChildByName('hua3');
        var Rtaohua = santonghua.getChildByName('Rtaohua');
        var Ltaohua = santonghua.getChildByName('Ltaohua');
        var title = santonghua.getChildByName('title');
        var self = this;
        //var H1 = cc.instantiate(hua1);
        var A = [],
            B = [],
            C = [];
        var hua = [];
        for (var i = 0; i < 5; i++) {
            A[i] = cc.instantiate(hua1);
            A[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(A[i]);
            B[i] = cc.instantiate(hua2);
            B[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(B[i]);
            C[i] = cc.instantiate(hua3);
            C[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(C[i]);
        };
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), cc.scaleTo(0.2, 1, 1), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.1, 1.8, 1.8)));
            Ltaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(-160, -60)))));
            Rtaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(140, -60)))));
            for (var i = 1; i < hua.length; i++) {
                hua[i].setPosition(self._bezier(i)[1]);
                santonghua.addChild(hua[i]);
                hua[i].runAction(cc.sequence(cc.spawn(cc.bezierTo(0.3, self._bezier(i)[0]), cc.scaleTo(0.3, 1, 1), cc.fadeTo(0.3, 0))));
            }
            setTimeout(function () {
                bg.runAction(cc.fadeTo(0.2, 0));
                Rtaohua.runAction(cc.fadeTo(0.2, 0));
                Ltaohua.runAction(cc.fadeTo(0.2, 0));
                title.runAction(cc.fadeTo(0.2, 0));
                santonghua.removeFromParent(true);
            }, 1500);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.3, 255), cc.scaleTo(0.3, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    },
    // 贝塞尔曲线(只能定三个点)
    _bezier: function _bezier(index) {
        var bezier = [];
        bezier[0] = [[cc.v2(200, 74), cc.v2(250, 124), cc.v2(400, -174)], cc.v2(200, 74)];
        bezier[1] = [[cc.v2(-72, 284), cc.v2(-122, 334), cc.v2(-272, -150)], cc.v2(-72, 284)];
        bezier[2] = [[cc.v2(-270, 300), cc.v2(-320, 350), cc.v2(-420, -200)], cc.v2(-270, 300)];
        bezier[3] = [[cc.v2(-223, 213), cc.v2(-273, 263), cc.v2(-373, -160)], cc.v2(-223, 213)];
        bezier[4] = [[cc.v2(210, 237), cc.v2(260, 287), cc.v2(360, -177)], cc.v2(210, 237)];
        bezier[5] = [[cc.v2(183, 115), cc.v2(233, 164), cc.v2(333, -155)], cc.v2(183, 115)];
        bezier[6] = [[cc.v2(92, 116), cc.v2(142, 166), cc.v2(242, -146)], cc.v2(92, 116)];
        bezier[7] = [[cc.v2(-26, 124), cc.v2(-76, 174), cc.v2(-176, -164)], cc.v2(-26, 124)];
        bezier[8] = [[cc.v2(-310, 81), cc.v2(-360, 131), cc.v2(-460, -180)], cc.v2(-310, 81)];
        bezier[9] = [[cc.v2(-125, 33), cc.v2(-175, 83), cc.v2(-275, -133)], cc.v2(-125, 33)];
        bezier[10] = [[cc.v2(0, 0), cc.v2(50, 50), cc.v2(150, -150)], cc.v2(0, 0)];
        bezier[11] = [[cc.v2(-235, 5), cc.v2(-275, 55), cc.v2(-375, -86)], cc.v2(-235, 5)];
        bezier[12] = [[cc.v2(-80, 4), cc.v2(-130, 54), cc.v2(-230, -233)], cc.v2(-80, 4)];
        bezier[13] = [[cc.v2(100, -7), cc.v2(150, 57), cc.v2(250, -177)], cc.v2(100, -7)];
        bezier[14] = [[cc.v2(254, 23), cc.v2(304, 73), cc.v2(404, -173)], cc.v2(254, 23)];
        return bezier[index];
    },

    // 六对半动画
    _liuduibanAnimation: function _liuduibanAnimation() {
        var liuduiban = cc.instantiate(this.liuduiban);
        this.node.addChild(liuduiban);
        var bg = liuduiban.getChildByName('bg');
        var Lqi = liuduiban.getChildByName('Lqi');
        var Rqi = liuduiban.getChildByName('Rqi');
        var Cqi = liuduiban.getChildByName('Cqi');
        var Rtaohua = liuduiban.getChildByName('Rtaohua');
        var Ltaohua = liuduiban.getChildByName('Ltaohua');
        var title = liuduiban.getChildByName('title');

        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.1, 2.5, 2.5), cc.scaleTo(0.1, 1.8, 1.8), Finished));
            Ltaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(-160, -60)))));
            Rtaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(140, -60)))));
        });
        var Finished = cc.callFunc(function () {
            Lqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(-103, 158))), cc.moveTo(0.2, cc.v2(-103, 168)), cc.moveTo(0.2, cc.v2(-103, 158))));
            Rqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(133, 160))), cc.moveTo(0.2, cc.v2(133, 170)), cc.moveTo(0.2, cc.v2(133, 160))));
            setTimeout(function () {
                Cqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(20, 96))), cc.moveTo(0.2, cc.v2(20, 106)), cc.moveTo(0.2, cc.v2(20, 96))));
                Ltaohua.runAction(cc.sequence(cc.repeat(cc.sequence(cc.rotateTo(0.3, 10), cc.rotateTo(0.3, 0)), 2), thFinished));
                Rtaohua.runAction(cc.repeat(cc.sequence(cc.rotateTo(0.3, -10), cc.rotateTo(0.3, 0)), 2));
            }, 500);
        });
        var thFinished = cc.callFunc(function () {
            bg.runAction(cc.fadeTo(0.2, 0));
            Lqi.runAction(cc.fadeTo(0.2, 0));
            Rqi.runAction(cc.fadeTo(0.2, 0));
            Cqi.runAction(cc.fadeTo(0.2, 0));
            Rtaohua.runAction(cc.fadeTo(0.2, 0));
            Ltaohua.runAction(cc.fadeTo(0.2, 0));
            title.runAction(cc.fadeTo(0.2, 0));
            liuduiban.removeFromParent(true);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    }
});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"cardNum":[function(require,module,exports){
"use strict";
cc._RFpush(module, '19329zUw3hCTpBk+7waBT2d', 'cardNum');
// scripts\cardNum.js

cc.Class({
    "extends": cc.Component,

    properties: {

        cards: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.totalCards();
    },
    totalCards: function totalCards() {
        // var create = this.node.children;
        //console.log(this.node);
        var renshu = this.node.getChildByName("renshu");
        var jushu = this.node.getChildByName("jushu");
        var getCard = this.node.getChildByName("cards");
        //var renshu = create[3], jushu = create[4], getCard = create[6];

        var rs = renshu.getComponent("singleSelect").selectedIndex;
        var js = jushu.getComponent("singleSelect").selectedIndex;
        var gc = getCard.getComponent("singleSelect").selectedIndex;

        var R = 1,
            J = 1,
            G = 1;
        switch (rs) {
            case 0:
                R = 1;break;
            case 1:
                R = 2;break;
            case 2:
                R = 3;break;
            case 3:
                R = 4;break;
        }
        switch (js) {
            case 0:
                J = 1;break;
            case 1:
                J = 2;break;
            case 2:
                J = 3;break;
        }
        switch (gc) {
            case 0:
                G = 1;break; // AA制
            default:
                G = 0;break;
        }
        this.cards.string = R + J;
        //this.cards.string = G ? (R+J):(R+J)*(R+3);  // (R+J)表示每个人要出的房卡量；(R+3)表示一共有多少人，  
    }
});

cc._RFpop();
},{}],"cardsBack":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98986IsXIdHiqLGEVIG2CWP', 'cardsBack');
// scripts\cardsBack.js

// 牌背影列表 component
// 可以显示、隐藏牌背影列表
cc.Class({
  "extends": cc.Component,

  properties: {
    cardsBackLayout: cc.Layout,
    cardsBackList: [cc.Sprite]
  },

  // use this for initialization
  onLoad: function onLoad() {},

  // 以动画的方式显示牌背影
  showPlayCardBacks: function showPlayCardBacks() {
    this.hideCardBacks();
    this.cardsBackLayout.node.active = true;

    var interval = 0.05;
    var startTime = 0;
    this.cardsBackList.forEach((function (cardBack) {
      this.scheduleOnce(function () {
        cardBack.node.active = true;
      }, startTime);
      startTime = startTime + interval;
    }).bind(this));
  },

  // 隐藏显示牌背影
  hideCardBacks: function hideCardBacks() {
    this.cardsBackLayout.node.active = false;
    this.cardsBackList.forEach(function (cardBack) {
      cardBack.node.active = false;
    });
  }
});

cc._RFpop();
},{}],"cards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0fcbct/TBxC742saKLuFviQ', 'cards');
// scripts\cards.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        /*牌花色*/
        spadesImages: [cc.SpriteFrame],
        heartsImages: [cc.SpriteFrame],
        clubImages: [cc.SpriteFrame],
        diamondImages: [cc.SpriteFrame]
    },

    // use this for initialization
    onLoad: function onLoad() {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"cellText":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9c9fd3OxWNEp4rijfjJv05t', 'cellText');
// scripts\cellText.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        labelMsg: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setText: function setText(text) {
        this.labelMsg.getComponent(cc.Label).string = text;
    },

    clickAction: function clickAction() {
        var text = this.labelMsg.getComponent(cc.Label).string;
        this.onSelectAction(text);
    },

    onSelectAction: function onSelectAction(msg) {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"changInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cb225d0jXtB0JToI7yXR0hG', 'changInfo');
// scripts\changInfo.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        phoneEditBox: cc.EditBox,
        wxEditBox: cc.EditBox,
        alert: cc.Prefab,
        canvas: cc.Node,
        _userId: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        this._registerSocketEvent();
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveOnChangeInfo, this._ReceiveChangeInfo, this);
    },
    _ReceiveChangeInfo: function _ReceiveChangeInfo(response) {
        var changedRows = response.data;
        var msg = '';
        //console.log(response);
        //console.log(changedRows);
        //console.log("-------------------------------38");
        if (changedRows) {
            msg = "更改成功";
        } else {
            msg = "今天已经更新过了，请明天再更新";
        }
        this.alertMsg(msg);
    },
    clickAction: function clickAction() {
        var wx = this.wxEditBox.string;
        var phone = this.phoneEditBox.string;
        var info = {};
        var msg = '';
        if (!wx && !phone) {
            msg = "请填写微信号和手机号";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (!/(^[1-9]\d*$)/.test(phone)) {
            msg = "您输入的手机号码格式不对，请重新输入";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (phone.length != 11) {
            msg = "您输入的手机号码不够11位，请重新输入";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (!/(^[1-9a-zA-Z]\d*$)/.test(wx)) {
            msg = "您输入的微信号格式不对，请重新输入";
            wx = "";
            this.alertMsg(msg);
            return;
        }
        if (wx.length < 6 || wx.length > 20) {
            msg = "您输入的微信号格式超出范围，请输入6~20位的微信号";
            wx = "";
            this.alertMsg(msg);
            return;
        }
        info.wx = wx;
        info.phone = phone;
        Socket.sendChangeInfo(this._userId, info);
    },

    alertMsg: function alertMsg(msg) {
        var alert = cc.instantiate(this.alert);
        this.canvas.addChild(alert);
        var comp = alert.getComponent('alert');
        comp.setMessage(msg);
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"change_mapai":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'ed8274emaRL471ny4dnQ8cA', 'change_mapai');
// scripts\change_mapai.js

cc.Class({
    "extends": cc.Component,

    properties: {

        mPtitle: cc.Label,
        _cards: [],
        renshuSelect: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        var hs = 3;
        var ds = 5;
        if (cc.set) {
            hs = cc.set.setting7[0];
            ds = cc.set.setting7[1];
        }
        this._cards = [hs, ds];
        this.mp(hs, ds);
    },
    change: function change() {
        var selectedIndex = this.renshuSelect.getComponent('singleSelect').selectedIndex;
        var hs = Math.ceil(Math.random() * 40 / 10); //获取一个1~4的数字，代表花色
        var ds = Math.ceil(Math.random() * 130 / 10); //获取一个1~13的数字，代表点数
        var card = [hs, ds];
        this._cards = card;
        this.mp(hs, ds, selectedIndex);
    },
    mp: function mp(h, d, index) {
        var ma = "单码";
        var hs = ["方块", "梅花", "红桃", "黑桃"];
        var ds = ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"];
        if (index) {
            var defaultMa = 4;
            if (h >= defaultMa - index + 1) {
                ma = "双码";
            }
        }
        this.mPtitle.string = hs[h - 1] + ds[d - 1] + ma;
    }
});

cc._RFpop();
},{}],"checkSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '974a0c6jzZPRI5AeaAb4U0z', 'checkSelect');
// scripts\checkSelect.js

cc.Class({
    "extends": cc.Component,

    properties: {
        selectedIndex: 0,
        selectedNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selected = true;
        this.selectedIndex = 0;
        this.selectedNode.active = true;
    },
    clickAction: function clickAction(e, data) {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        this.selectedIndex = this.selected ? 0 : null;
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"choujiang":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f64e0whLhNLmbOHtPpK94CG', 'choujiang');
// scripts\choujiang.js

var socket = require("socket");
cc.Class({
    "extends": cc.Component,

    properties: {
        option: {
            "default": [],
            type: cc.Node
        }
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickBtnchoujiang: function clickBtnchoujiang() {
        for (var i = 0; i < this.option.length; i++) {
            this.option[i].opacity = 255;
        }
        var index = 0;
        this._tishi = this.node.getChildByName("choujiang_bg").getChildByName("tishi");
        this._card_num = cc.find("Canvas/user/shop_bg/card_num");
        var comp = this._card_num.getComponent(cc.Label);
        this.callback = function () {
            if (index == 0) {
                this.option[index].opacity = 128;
                this.option[this.option.length - 1].opacity = 255;
            } else if (index == 1) {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            } else {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            }
            index++;
            if (index == this.option.length) {
                index = 0;
            }
        };
        if (comp.string < 20) {
            this._tishi.active = true;
        } else {
            //choujiang
            this.schedule(this.callback, 0.05);
            this.schedule(function () {
                this.unschedule(this.callback);
                for (var i = 0; i < this.option.length; i++) {
                    this.option[i].opacity = 255;
                }
                var i = Math.floor(Math.random() * 12);
                this.option[i].opacity = 128;
            }, 3, 0, 1);
        }
    },

    //***
    clickBtnComfirm: function clickBtnComfirm() {
        this._tishi.active = false;
        //this.node.active = false;
    }
});
//****

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"socket":"socket"}],"create_btn_anima":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'df337riLglP3YcI/IJFXecj', 'create_btn_anima');
// scripts\create_btn_anima.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...

    },

    // use this for initialization
    onLoad: function onLoad() {},
    loadCardSpriteFrame: function loadCardSpriteFrame(cardName, callback) {
        this._loadCardFrame(cardName, callback);
    },
    _cardFullName: function _cardFullName(cardShortName) {
        var cardName = cardShortName;
        if (!cardName.startsWith("public-pic-card-poker")) {
            cardName = "public-pic-card-poker-" + cardName;
        }
        return cardName;
    },
    _loadCardFrame: function _loadCardFrame(cardName, callback) {
        cc.assert(callback);
        cc.loader.loadRes("play/hall/public/all_effect_ttw_main", cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                callback(null, err);
                return;
            }
            cardName = this._cardFullName(cardName);
            var frame = atlas.getSpriteFrame(cardName);
            callback(frame);
        }).bind(this));
    },
    test: function test() {}

});

cc._RFpop();
},{}],"daikai":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f6c69jpXLVAEZuQjdkc2pyH', 'daikai');
// scripts\daikai.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        //selectedIndex: 0,
        _selected: 1
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        this._select = true;
        var daikai = 0;
        if (cc.set) {
            daikai = cc.set.setting9;
            this._selected = this._select = daikai;
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select;
            this._selected = this._select;
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (self._select) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                this.setSelected(self._selected = self._select = !self._select);
                var title = this.node.getChildByName("title");
                if (self._select) {
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    title.color = new cc.Color(255, 255, 255);
                }
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "orders" && cc.set) {
            //this.remember_set(overTime);
        }
    },
    remember_set: function remember_set(obj) {
        for (var i = 0; i < this.nodes.length; i++) {
            this.nodes[i].getComponent('select').setSelected(obj);
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (obj) {
                var title = this.nodes[0].getChildByName('title');
                title.color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
    }

});

cc._RFpop();
},{}],"fecha":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e517077l0xMarB9uQsXGzvk', 'fecha');
// scripts\Extensions\fecha.js

(function (main) {
  'use strict';

  /**
   * Parse or format dates
   * @class fecha
   */
  var fecha = {};
  var token = /d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g;
  var twoDigits = /\d\d?/;
  var threeDigits = /\d{3}/;
  var fourDigits = /\d{4}/;
  var word = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;
  var literal = /\[([^]*?)\]/gm;
  var noop = function noop() {};

  function shorten(arr, sLen) {
    var newArr = [];
    for (var i = 0, len = arr.length; i < len; i++) {
      newArr.push(arr[i].substr(0, sLen));
    }
    return newArr;
  }

  function monthUpdate(arrName) {
    return function (d, v, i18n) {
      var index = i18n[arrName].indexOf(v.charAt(0).toUpperCase() + v.substr(1).toLowerCase());
      if (~index) {
        d.month = index;
      }
    };
  }

  function pad(val, len) {
    val = String(val);
    len = len || 2;
    while (val.length < len) {
      val = '0' + val;
    }
    return val;
  }

  var dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
  var monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  var monthNamesShort = shorten(monthNames, 3);
  var dayNamesShort = shorten(dayNames, 3);
  fecha.i18n = {
    dayNamesShort: dayNamesShort,
    dayNames: dayNames,
    monthNamesShort: monthNamesShort,
    monthNames: monthNames,
    amPm: ['am', 'pm'],
    DoFn: function DoFn(D) {
      return D + ['th', 'st', 'nd', 'rd'][D % 10 > 3 ? 0 : (D - D % 10 !== 10) * D % 10];
    }
  };

  var formatFlags = {
    D: function D(dateObj) {
      return dateObj.getDate();
    },
    DD: function DD(dateObj) {
      return pad(dateObj.getDate());
    },
    Do: function Do(dateObj, i18n) {
      return i18n.DoFn(dateObj.getDate());
    },
    d: function d(dateObj) {
      return dateObj.getDay();
    },
    dd: function dd(dateObj) {
      return pad(dateObj.getDay());
    },
    ddd: function ddd(dateObj, i18n) {
      return i18n.dayNamesShort[dateObj.getDay()];
    },
    dddd: function dddd(dateObj, i18n) {
      return i18n.dayNames[dateObj.getDay()];
    },
    M: function M(dateObj) {
      return dateObj.getMonth() + 1;
    },
    MM: function MM(dateObj) {
      return pad(dateObj.getMonth() + 1);
    },
    MMM: function MMM(dateObj, i18n) {
      return i18n.monthNamesShort[dateObj.getMonth()];
    },
    MMMM: function MMMM(dateObj, i18n) {
      return i18n.monthNames[dateObj.getMonth()];
    },
    YY: function YY(dateObj) {
      return String(dateObj.getFullYear()).substr(2);
    },
    YYYY: function YYYY(dateObj) {
      return dateObj.getFullYear();
    },
    h: function h(dateObj) {
      return dateObj.getHours() % 12 || 12;
    },
    hh: function hh(dateObj) {
      return pad(dateObj.getHours() % 12 || 12);
    },
    H: function H(dateObj) {
      return dateObj.getHours();
    },
    HH: function HH(dateObj) {
      return pad(dateObj.getHours());
    },
    m: function m(dateObj) {
      return dateObj.getMinutes();
    },
    mm: function mm(dateObj) {
      return pad(dateObj.getMinutes());
    },
    s: function s(dateObj) {
      return dateObj.getSeconds();
    },
    ss: function ss(dateObj) {
      return pad(dateObj.getSeconds());
    },
    S: function S(dateObj) {
      return Math.round(dateObj.getMilliseconds() / 100);
    },
    SS: function SS(dateObj) {
      return pad(Math.round(dateObj.getMilliseconds() / 10), 2);
    },
    SSS: function SSS(dateObj) {
      return pad(dateObj.getMilliseconds(), 3);
    },
    a: function a(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0] : i18n.amPm[1];
    },
    A: function A(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0].toUpperCase() : i18n.amPm[1].toUpperCase();
    },
    ZZ: function ZZ(dateObj) {
      var o = dateObj.getTimezoneOffset();
      return (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4);
    }
  };

  var parseFlags = {
    D: [twoDigits, function (d, v) {
      d.day = v;
    }],
    Do: [new RegExp(twoDigits.source + word.source), function (d, v) {
      d.day = parseInt(v, 10);
    }],
    M: [twoDigits, function (d, v) {
      d.month = v - 1;
    }],
    YY: [twoDigits, function (d, v) {
      var da = new Date(),
          cent = +('' + da.getFullYear()).substr(0, 2);
      d.year = '' + (v > 68 ? cent - 1 : cent) + v;
    }],
    h: [twoDigits, function (d, v) {
      d.hour = v;
    }],
    m: [twoDigits, function (d, v) {
      d.minute = v;
    }],
    s: [twoDigits, function (d, v) {
      d.second = v;
    }],
    YYYY: [fourDigits, function (d, v) {
      d.year = v;
    }],
    S: [/\d/, function (d, v) {
      d.millisecond = v * 100;
    }],
    SS: [/\d{2}/, function (d, v) {
      d.millisecond = v * 10;
    }],
    SSS: [threeDigits, function (d, v) {
      d.millisecond = v;
    }],
    d: [twoDigits, noop],
    ddd: [word, noop],
    MMM: [word, monthUpdate('monthNamesShort')],
    MMMM: [word, monthUpdate('monthNames')],
    a: [word, function (d, v, i18n) {
      var val = v.toLowerCase();
      if (val === i18n.amPm[0]) {
        d.isPm = false;
      } else if (val === i18n.amPm[1]) {
        d.isPm = true;
      }
    }],
    ZZ: [/([\+\-]\d\d:?\d\d|Z)/, function (d, v) {
      if (v === 'Z') v = '+00:00';
      var parts = (v + '').match(/([\+\-]|\d\d)/gi),
          minutes;

      if (parts) {
        minutes = +(parts[1] * 60) + parseInt(parts[2], 10);
        d.timezoneOffset = parts[0] === '+' ? minutes : -minutes;
      }
    }]
  };
  parseFlags.dd = parseFlags.d;
  parseFlags.dddd = parseFlags.ddd;
  parseFlags.DD = parseFlags.D;
  parseFlags.mm = parseFlags.m;
  parseFlags.hh = parseFlags.H = parseFlags.HH = parseFlags.h;
  parseFlags.MM = parseFlags.M;
  parseFlags.ss = parseFlags.s;
  parseFlags.A = parseFlags.a;

  // Some common format strings
  fecha.masks = {
    'default': 'ddd MMM DD YYYY HH:mm:ss',
    shortDate: 'M/D/YY',
    mediumDate: 'MMM D, YYYY',
    longDate: 'MMMM D, YYYY',
    fullDate: 'dddd, MMMM D, YYYY',
    shortTime: 'HH:mm',
    mediumTime: 'HH:mm:ss',
    longTime: 'HH:mm:ss.SSS'
  };

  /***
   * Format a date
   * @method format
   * @param {Date|number} dateObj
   * @param {string} mask Format of the date, i.e. 'mm-dd-yy' or 'shortDate'
   */
  fecha.format = function (dateObj, mask, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof dateObj === 'number') {
      dateObj = new Date(dateObj);
    }

    if (Object.prototype.toString.call(dateObj) !== '[object Date]' || isNaN(dateObj.getTime())) {
      throw new Error('Invalid Date in fecha.format');
    }

    mask = fecha.masks[mask] || mask || fecha.masks['default'];

    var literals = [];

    // Make literals inactive by replacing them with ??
    mask = mask.replace(literal, function ($0, $1) {
      literals.push($1);
      return '??';
    });
    // Apply formatting rules
    mask = mask.replace(token, function ($0) {
      return $0 in formatFlags ? formatFlags[$0](dateObj, i18n) : $0.slice(1, $0.length - 1);
    });
    // Inline literal values back into the formatted value
    return mask.replace(/\?\?/g, function () {
      return literals.shift();
    });
  };

  /**
   * Parse a date string into an object, changes - into /
   * @method parse
   * @param {string} dateStr Date string
   * @param {string} format Date parse format
   * @returns {Date|boolean}
   */
  fecha.parse = function (dateStr, format, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof format !== 'string') {
      throw new Error('Invalid format in fecha.parse');
    }

    format = fecha.masks[format] || format;

    // Avoid regular expression denial of service, fail early for really long strings
    // https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
    if (dateStr.length > 1000) {
      return false;
    }

    var isValid = true;
    var dateInfo = {};
    format.replace(token, function ($0) {
      if (parseFlags[$0]) {
        var info = parseFlags[$0];
        var index = dateStr.search(info[0]);
        if (! ~index) {
          isValid = false;
        } else {
          dateStr.replace(info[0], function (result) {
            info[1](dateInfo, result, i18n);
            dateStr = dateStr.substr(index + result.length);
            return result;
          });
        }
      }

      return parseFlags[$0] ? '' : $0.slice(1, $0.length - 1);
    });

    if (!isValid) {
      return false;
    }

    var today = new Date();
    if (dateInfo.isPm === true && dateInfo.hour != null && +dateInfo.hour !== 12) {
      dateInfo.hour = +dateInfo.hour + 12;
    } else if (dateInfo.isPm === false && +dateInfo.hour === 12) {
      dateInfo.hour = 0;
    }

    var date;
    if (dateInfo.timezoneOffset != null) {
      dateInfo.minute = +(dateInfo.minute || 0) - +dateInfo.timezoneOffset;
      date = new Date(Date.UTC(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0));
    } else {
      date = new Date(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0);
    }
    return date;
  };

  /* istanbul ignore next */
  if (typeof module !== 'undefined' && module.exports) {
    module.exports = fecha;
  } else if (typeof define === 'function' && define.amd) {
    define(function () {
      return fecha;
    });
  } else {
    main.fecha = fecha;
  }
})(this);

cc._RFpop();
},{}],"game":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45811N61jFFA6UrygQla5+x', 'game');
// scripts\game.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        messageNode: cc.Node,
        playNode: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {},

    showMessageAlert: function showMessageAlert() {
        this.messageNode.active = true;
        var comp = this.messageNode.getComponent(cc.Animation);
        comp.play('pop');
    },

    dismissMessageAlert: function dismissMessageAlert() {
        var self = this;
        this.scheduleOnce(function () {
            self.messageNode.active = false;
        }, 0.3);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"hall_btn_anima":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b8a30Txa91I27+7HOFLyJA6', 'hall_btn_anima');
// scripts\hall_btn_anima.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        create_anima: {
            type: cc.SpriteFrame,
            "default": []
        }
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"hall":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1e6741Q2VFGDLupV88mg60Z', 'hall');
// scripts\hall.js

var manager = require('manager');
var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var Playback = require('Playback');

var hall = cc.Class({
    'extends': cc.Component,

    properties: {

        //productNodes:[cc.Node],
        shopAlertNode: cc.Node,
        createNode: cc.Node,
        joinNode: cc.Node,
        gengxin: cc.Node,
        alertPrefab: cc.Prefab,
        tsSingleSelect: [cc.Node], // 创建房间信息，单选
        tsCheckSeclect: [cc.Node], // 创建房间信息，复选
        selectMoShi: cc.Node, // 创建房间信息，模式（庄家模式和无特殊牌）
        selectGuiPai: cc.Node, // 创建房间信息，模式（庄家模式和无特殊牌）
        overTime: cc.Node, // 超时出牌
        daikai: cc.Node, //代开房
        //labelNotice: cc.Label,      // 公告
        labelBanner: cc.Label, // banner label
        recordNode: cc.Node,
        waitingPrefab: cc.Prefab,
        setting: cc.Node,
        //用户信息
        avatarNode: cc.Node,
        nickNameLabel: cc.Label,
        cardNumberLabel: cc.Label,
        userIdLabel: cc.Label,
        codeLabel: cc.Label,
        //phone:cc.Label,
        // userInfoMsgNode:cc.Node,
        logoutNode: cc.Node,
        //战绩
        recordMsgNode: cc.Node,
        feedbackEditBox: cc.EditBox, //反馈
        feedbackNode: cc.Node,
        wxshare: cc.Node,
        _userId: 0,
        _openId: null,
        _help: null,
        _close: null,
        iosUrl: null,
        aUrl: null

    },

    statics: {
        lastHallInfo: null, // 上一次收到的大厅信息
        cacheImageInfo: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.keyBackListen();
        if (cc.sys.isBrowser) {
            if (window.shareToTimeLine) {
                window.shareToTimeLine();
            }
            if (window.shareToSession) {
                window.shareToSession();
            }
        }
        cc.sys.localStorage.removeItem("timestamp");
        var bg = this.node.getChildByName("room_bg");
        var windowP = cc.director.getWinSizeInPixels();
        var scaleX = windowP.width / bg.width;
        var scaleY = windowP.height / bg.height;
        var scale = Math.max(scaleX, scaleY);
        bg.scaleX = scale;
        bg.scaleY = scale;
        this.clearLocalStorage();
        cc.from = {};
        cc.from.isUseMa = true;
        cc.from.ma = 0;
        cc.isRoomViewShow = false;
        this._btn = this.node.getChildByName("btn");
        this._buttons = this.node.getChildByName("buttons");
        var volume = cc.sys.localStorage.getItem("bgVolume");
        if (volume != null && parseInt(volume)) {
            AudioManager.instance.playMusic();
        }

        var bgSound = cc.sys.localStorage.getItem("bgSound");
        if (bgSound == 0) {
            var audioManager = cc.find('AudioManager');
            audioManager = audioManager.getComponent('AudioManager');
            audioManager.setEffectMusicVolum(bgSound);
        }
        Playback.instance.removePlaybackDatas();

        hall.cacheImageInfo = hall.cacheImageInfo || {};

        this._registerSocketEvent();
        this._startBannerAnimation();
        this._initJoinRoom();

        this._userId = Socket.instance.userInfo.id;
        this._openId = Socket.instance.userInfo.openId;
        this._inviteCode = Socket.instance.userInfo.inviteCode; //邀请码
        var self = this;
        this.socket = cc.find('GameSocket').getComponent('socket');
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
        };

        this.socket.connectionSuccess = function () {
            self.hiddenNetworkMessage();
            self.hiddenCheckMessage();
        };
        this.socket.connectionDisconnect = function () {
            self.showNetworkMessage('网络链接断开，重新连接中...');
        };
        this.socket.checkNetworkNow = function () {
            self.showCheckMessage('检查网络中...');
        };
        this.socket.checkNetworkEnd = function () {
            self.hiddenCheckMessage();
            self.hiddenNetworkMessage();
        };

        //  /*设置用户信息*/
        this.updateUserInfo();
        /*刷新用户信息*/
        Socket.sendGetUserInfo(this._userId, this._openId);
        /*定时刷新用户信息*/
        this.schedule((function () {
            Socket.sendGetUserInfo(this._userId, this._openId);
        }).bind(this), 10); //10s一次
        Socket.sendGetHallInfo(this.socket.userInfo.id);
        if (hall.lastHallInfo) {
            this.updateBanner(hall.lastHallInfo.info);
        }
        cc.onShareWXResp = null;
        cc.director.preloadScene('play', function () {
            cc.director.preloadScene('login');
        });
        if (cc.joinDesk != null) {
            if (!cc.joinDesk.result) {
                var reason = cc.joinDesk.reason;
                this.alertMessage(reason);
            }
            cc.joinDesk = null;
        }
        if (cc.qingli != null) {
            this.alertMessage("您被房主请出房间");
            cc.qingli = null;
        }
        //var creatAnima = this.node.getChildByName("create_room");
    },

    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },

    clickWxShare: function clickWxShare() {
        if (!cc.sys.isNative) {
            this.wxshare.active = true;
        } else {
            var title = cc.sys.localStorage.getItem('shareTitle');
            var description = cc.sys.localStorage.getItem('desc');
            var recordId = cc.sys.localStorage.getItem('recordId');
            var id = '';
            if (recordId) {
                id = 'recordId=' + recordId;
            }

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
            }
        }
    },

    //分享到朋友圈
    shareHallTimeline: function shareHallTimeline() {
        if (!cc.sys.isNative) {
            this.wxshare.active = true;
        } else {
            var title = cc.sys.localStorage.getItem('shareTitle');
            var description = cc.sys.localStorage.getItem('desc');
            var recordId = cc.sys.localStorage.getItem('recordId');
            var id = '';
            if (recordId) {
                id = 'recordId=' + recordId;
            }

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
            }
        }
    },

    shareBg: function shareBg() {
        if (!cc.sys.isNative) {
            this.wxshare.active = false;
        } else {
            // if (KQNativeInvoke.isNativeIOS()) {
            //     jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,"wxShareHallTimeline",id, description,title);
            // }
            // else {//Android
            //     var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            //     jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str,id, description,title);
            // }
        }
    },

    clearLocalStorage: function clearLocalStorage() {
        var shareTitle = '开房玩[大众十三水]';
        var desc = '开好房了，就等你们一起来[大众十三水]啦！晚了位置就没了哟~';
        cc.sys.localStorage.removeItem('roomId');
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
        this.socket.connectionSuccess = function () {};
        this.socket.connectionDisconnect = function () {};
        this.socket.checkNetworkNow = function () {};
        this.socket.checkNetworkEnd = function () {};

        KQGlobalEvent.offTarget(this);
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.JoinDesk, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveCreateDesk, this._createRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGetUserInfo, this._socketReceiveUserInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        //KQGlobalEvent.on(Socket.Event.ReceiveInviteCode, this._socketReceiveInviteCode, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        //KQGlobalEvent.on(Socket.Event.ReceiveSharePng, this._socketSharePng, this);
    },

    // 跳转到公众号
    guanzhu: function guanzhu() {
        // var url = "http://www.honggefeng.cn/gzh/index.html";
        // cc.sys.openURL(url)
    },
    _startBannerAnimation: function _startBannerAnimation() {
        var anim = this.labelBanner.getComponent(cc.Animation);
        anim.play('banner');
    },
    downLoad: function downLoad() {
        var url = 'https://fir.im/5tne';
        cc.sys.openURL(url);

        //window.location.href = "http://www.baidu.com";
        //console.log("？？？？？？？？");
    },

    _initJoinRoom: function _initJoinRoom() {
        var self = this;
        var joinRoom = this.joinNode.getComponent('joinRoom');

        joinRoom.callbackJoinRoom = function (number) {
            // self.joinNode.getComponent('alert').dismissAction();
            // self.showWaitingMessage('加入中...');
            // self.scheduleOnce(function() {
            //     self.hiddenWaitingMessage();
            // }, 2.0);

            /*加入房间请求*/
            var userId = Socket.instance.userInfo.id;
            Socket.sendJoinDesk(number, userId);
        };
    },

    _jiinRoomSocketCallback: function _jiinRoomSocketCallback(response) {
        var _this2 = this;

        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            (function () {
                if (cc.from == null) {
                    cc.from = {};
                }
                var joinRoom = _this2.joinNode.getComponent('joinRoom');

                _this2.joinNode.getComponent('alert').setAlertCallbck(function () {
                    joinRoom.clickClear();
                });
                cc.from.ma = response.data.maPai;
                cc.director.loadScene('play');
            })();
        } else {
            var reasonInfo = this._joinReasonMap(response.data.reason);
            this.alertMessage(reasonInfo);
        }
    },

    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!response.result) {
            return;
        }
        var data = response.data;
        hall.lastHallInfo = data;
        var isIOS = data.isIOS;
        var isAndroid = data.isA;
        var vIOS = data.vIOS;
        var vA = data.vA;
        this.iosUrl = data.iosUrl;
        this.aUrl = data.aUrl;
        if (cc.sys.isNative) {
            if (KQNativeInvoke.isNativeIOS()) {
                if (isIOS == 1) {
                    if (vIOS != '1.0.3') {
                        this.gengxin.active = true;
                    }
                }
            } else {
                //Android
                if (isAndroid == 1) {
                    if (vA != '1.0.4') {
                        this.gengxin.active = true;
                    }
                }
            }
        }
        var notice = data.broadcast;
        var banner = data.info;
        //this.updateNotice(notice);
        this.updateBanner(banner);
    },
    downloadNewVersion: function downloadNewVersion() {
        if (KQNativeInvoke.isNativeIOS()) {
            cc.sys.openURL(this.iosUrl);
            // jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", this.iosUrl);
        } else {
                //Android
                cc.sys.openURL(this.aUrl);
                // jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", this.aUrl);
            }
    },
    _createRoomSocketCallback: function _createRoomSocketCallback(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            cc.director.loadScene('play');
        }
        /*如果钻石不足，则提示*/
        else {
                this.alertMessage("您的钻石不足");
            }
    },

    _joinReasonMap: function _joinReasonMap(reason) {
        var reasonInfo = {
            notExist: "房间不存在!",
            cardNumber: "您房卡不足!"
        };

        var info = reasonInfo[reason] || "房间已满!";
        return info;
    },

    /*shop*/
    shopAction: function shopAction() {
        var comp = this.shopAlertNode.getComponent('alert');
        comp.alert();
    },
    /*提示*/
    alertMessage: function alertMessage(msg) {
        var node = cc.instantiate(this.alertPrefab);
        this.node.addChild(node);
        var comp = node.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    //updateNotice: function (notice) {
    //    if(this.labelNotice == null){
    //        return;
    //    }
    //  this.labelNotice.string = notice || "";
    //},

    updateBanner: function updateBanner() {
        var banner = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        if (this.labelBanner == null) {
            return;
        }
        this.labelBanner.string = banner;
    },

    /*#####
    * setting1 局数  (0 | 1 | 2 )
    * setting2 人数  (0 | 1 | 2 | 3)
    * setting3 玩法  (0 | 1 | 2 | 3 | 4)
    * setting4 AA制收取房费  (0 | 1 | 2 )
    * setting5 其他  (0)
    * setting6  
    * setting7
    * */
    createDoneAction: function createDoneAction() {
        var info = {};
        var self = this;
        var key = ['setting1', 'setting2', 'setting4', 'setting5'];
        for (var i = 0; i < this.tsSingleSelect.length; i++) {
            var tsIndex = self.tsSingleSelect[i].getComponent('singleSelect').selectedIndex;
            info[key[i]] = tsIndex;
        }

        info['setting3'] = this.selectMoShi.getComponent('selectMoShi')._select;
        info['setting6'] = this.overTime.getComponent('overTime')._selected;
        info['setting9'] = this.daikai.getComponent('daikai')._selected;
        //console.log( info['setting6'] );
        if (!info['setting3'][3]) {
            // 玩法 [疯狂场,鬼牌,比花色,坐庄,马牌] info['setting3'][3]第三项表示坐庄模式，非坐庄模式的倍率是1倍
            info['setting5'] = 0; // 倍率 (0~1) == (1~3倍)
        }
        info['setting8'] = null;

        info['setting7'] = this.selectMoShi.getComponent('change_mapai')._cards;
        cc.set = info;
        info['userId'] = this.socket.userInfo.id; //用户Id
        this.socket.sendMessage('createDesk', info);

        this.createNode.getComponent('alert').dismissAction();

        //let self = this;
        this.showWaitingMessage('创建中...');
        this.scheduleOnce(function () {
            self.hiddenWaitingMessage();
        }, 2.0);
    },

    // 随机场
    /*clickRandRoom: function () {
      cc.director.loadScene('randRoom');
    },*/

    clickRecord: function clickRecord() {
        var comp = this.recordNode.getComponent('alert');
        comp.alert();
        Socket.sendGetRecrod(Socket.instance.userInfo.id);
    },

    clickPlayRule: function clickPlayRule() {
        //cc.director.loadScene('rule');
        this.help = this.node.getChildByName("help");
        var comp = this.help.getComponent('alert');
        comp.alert();
    },

    clickPlay: function clickPlay() {
        if (cc.clickOut) cc.director.loadScene('play');
    },

    /*切换账号*/
    clickCancelLation: function clickCancelLation() {
        this.logoutNode.getComponent('alert').alert();
    },

    logoutAction: function logoutAction() {
        //manager.setUserInfo('');
        cc.director.loadScene('login');
        hall.cacheImageInfo = null;
    },

    exitAction: function exitAction() {
        //manager.setUserInfo('');
        if (!cc.sys.isNative) {
            cc.director.loadScene('login');
            hall.cacheImageInfo = null;
            return;
        }

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
        cc.director.end();
    },

    //接收处理用户数据
    _socketReceiveUserInfo: function _socketReceiveUserInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!this.socket.userInfo) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }
        //console.log(response,"----------------------用户信息");
        //this.phone.string = response.data.phone ? response.data.phone : "无";
        this.setting.getComponent('Setting')._phone = response.data.phone ? response.data.phone : null;
        this.setting.getComponent('Setting').phone.string = response.data.phone ? response.data.phone : '无';
        this.nickNameLabel.string = response.data.nickname; // 用户名
        this.userIdLabel.string = 'ID: ' + response.data.id; // ID
        this.cardNumberLabel.string = response.data.cardNumber;
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        cc.loader.load({ url: response.data.avatarUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;
            }
        });
    },

    _socketDisconnect: function _socketDisconnect() {
        this.showNetworkMessage("网络链接断开，重新连接中...");
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    //更新用户信息
    updateUserInfo: function updateUserInfo() {
        var info = this.socket.userInfo;
        if (!info) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }

        this.nickNameLabel.string = info.nickname;
        this.userIdLabel.string = 'ID: ' + info.id;
        this.cardNumberLabel.string = info.cardNumber;

        var avatarUrl = info.avatarUrl + ".jpg";
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        var texture = hall.cacheImageInfo[avatarUrl];
        if (texture) {
            var frame = new cc.SpriteFrame(texture);
            if (frame) {
                //cc.log("从缓存中加载头像");
                sprite.spriteFrame = frame;
                return;
            }
        }

        cc.loader.load({ url: info.avatarUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;

                hall.cacheImageInfo[avatarUrl] = tex;
            }
        });
    },

    /*提交意见*/
    feedbackAcion: function feedbackAcion() {
        var userId = this.socket.userInfo.id;
        var text = this.feedbackEditBox.string;
        if (text.length > 0) {
            this.feedbackNode.getComponent('alert').dismissAction();
            Socket.sendFeedback(userId, text);
            this.feedbackEditBox.string = '';
        }
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.sys.isObjectValid(this.waitingNode)) {
            this.waitingNode.destory();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    //network
    showNetworkMessage: function showNetworkMessage(msg) {
        if (this.networkNode && this.networkNode.active) {
            var _alert = this.networkNode.getComponent('alert');
            if (_alert.getMessage() == msg) {
                return;
            }
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage(msg) {
        if (!(this.checkNode && this.checkNode.active)) {} else {
            var _alert2 = this.checkNode.getComponent('alert');
            if (_alert2.getMessage() == msg) {
                return;
            }
        }

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },
    onBtnClick: function onBtnClick() {
        if (this._buttons.active) {
            this._buttons.active = false;
        } else {
            this._buttons.active = true;
        }
    }

});

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },
module.exports = hall;

cc._RFpop();
},{"AudioManager":"AudioManager","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","manager":"manager","socket":"socket"}],"help":[function(require,module,exports){
"use strict";
cc._RFpush(module, '09981CwNMZOI4DHUg8u9kcj', 'help');
// scripts\help.js

cc.Class({
    "extends": cc.Component,
    properties: {
        /*sprites: {
            default: null,
            type: cc.SpriteAtlas
        },*/
        play_method_before: cc.Node, //玩法介绍
        play_method_content_label: cc.Node, //玩法介绍内容
        introduce_pai_before: cc.Node, //牌型介绍
        details: cc.Node, //牌型介绍内容
        caozuo_before: cc.Node, //操作介绍
        caozuo_content: cc.Node, //操作介绍内容
        _btn: null,
        _content: null,
        _buttonCom: null,
        _play_method_button: null,
        _introduce_pai_button: null,
        _caozuo_button: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        //this._play_method_button = this.play_method_before.getComponent(cc.Button);
        //this._introduce_pai_button = this.introduce_pai_before.getComponent(cc.Button);
        //this._caozuo_button = this.caozuo_before.getComponent(cc.Button);
        //this._btn = [this.play_method_before,this.introduce_pai_before,this.caozuo_before];
        //this._content = [this.play_method_content_label,this.details,this.caozuo_content];
        //this._buttonCom = [this._play_method_button,this._introduce_pai_button,this._caozuo_button];
        ////刚开始牌型介绍的按钮不可用
        //this._buttonCom[1].interactable = false;
    },
    // 点击玩法介绍
    onBtnPlayMethodClick: function onBtnPlayMethodClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[0].interactable = false;
        ////当前点击的对应的内容可见
        this._content[0].active = true;
    },
    //点击牌型介绍
    onBtnIntroducePaiClick: function onBtnIntroducePaiClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[1].interactable = false;
        ////当前点击的对应的内容可见
        //this._content[1].active = true;
    },
    //点击操作介绍
    onBtnCaozuoClick: function onBtnCaozuoClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[2].interactable = false;
        ////当前点击的对应的内容可见
        //this._content[2].active = true;
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"inviteCode":[function(require,module,exports){
"use strict";
cc._RFpush(module, '777f9/eB7RKK4aO7FmNYFgO', 'inviteCode');
// scripts\inviteCode.js

/**
 * 邀请码
 * @authors 黄成(you@example.org)
 * @date    2017-06-16 09:44:10
 * @version $Id$
 */
var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackInviteCode: ''
  },

  onLoad: function onLoad() {
    this.clickClear(); //清除数字
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
      //cc.log(label.string ,"----------------");
    } else {
        return;
      }
    var isComplete = this._lastEmptyLabel() == null;
    //cc.log("isComplete-------------", this.callbackInviteCode);
    var inviteNumber = this._inviteNumber();

    if (inviteNumber.length == 6) {
      //cc.log(inviteNumber,"--------------------38"); //邀请码
      var userId = Socket.instance.userInfo.id;
      //Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = inviteNumber;
    }
  },
  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackInviteCode;
    //cc.log(inviteNumber,"--------------------38")
    if (inviteNumber && inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = ''; //清空邀请码
    }
  },
  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _inviteNumber: function _inviteNumber() {
    return this.labelNumbers.reduce(function (inviteNumber, label) {
      //cc.log(inviteNumber,"-----------------");
      return inviteNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"joinRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd5dcb9CJvpPJpnsCQ/q197x', 'joinRoom');
// scripts\joinRoom.js

cc.Class({
  "extends": cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }

    var isComplete = this._lastEmptyLabel() == null;
    if (isComplete && this.callbackJoinRoom) {
      var roomNumber = this._roomNumber();
      // cc.log("要加入的房间号是：", roomNumber);
      this.callbackJoinRoom(roomNumber);
    }
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{}],"launch":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0efb2ngHglDtK2A+W4dmfzt', 'launch');
// scripts\launch.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.scheduleOnce(function () {
            cc.director.loadScene('login');
        }, 0.5);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"login":[function(require,module,exports){
(function (Buffer){
"use strict";
cc._RFpush(module, '9c72dn88ytPxZWrZRaxt5cr', 'login');
// scripts\login.js

var manager = require('manager');
var KQCard = require('KQCard');
var Socket = require('socket');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');

var APPID = 'wxe8993f468b16fa5d';
var ROOMID = '';
//授权地址
//正式地址
// var REDIRECT_URI = "http%3A%2F%2Fwww.honggefeng.cn%2FsszWeb%2Findex.php";
// 测试地址
var REDIRECT_URI = "http%3a%2f%2fo1o2.cn";

var HREF = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + APPID + "&redirect_uri=" + REDIRECT_URI + "&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";

cc.Class({

    'extends': cc.Component,
    properties: {
        //selectNode:cc.Node,
        alertPrefab: cc.Prefab,
        canvasNode: cc.Node,
        loadingNode: cc.Node,
        //err:cc.Node,
        waitingPrefab: cc.Prefab,
        recordInfo: cc.Prefab,
        label: cc.Label
    },

    goUpdateAction: function goUpdateAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod("AppController", "downloadNewVersion:", this.iosUrl);
        } else {
            //Android
            jsb.reflection.callStaticMethod("com/gongpa/ssz/AppActivity", "downloadNewVersion", "(Ljava/lang/String;)V", this.androidUrl);
        }
    },

    checkVersion: function checkVersion(vData) {
        //var version = vData.version;
        cc.info1 = vData.version;
        this.iosUrl = vData.iosUrl;
        this.androidUrl = vData.androidUrl;
        //if (manager.version != version) {//更新版本
        //    this.versionEnable = false;
        //    this.goUpdateAction();
        //    //this.versionLabel.string = '请到服务器更新到最新版本';
        //}
        //else {
        //this.versionLabel.string = '当前版本 ' + manager.version;
        if (KQNativeInvoke.isNativeIOS()) {
            // if(iosVersion != manager.version) {
            //     this.versionEnable = false;
            //     var updateAlert = cc.find("Canvas/update").getComponent("alert");
            //     updateAlert.alert();
            // }
            // else {
            this.versionEnable = true;
            var self = this;
            var info = manager.getUserInfo();
            if (info.length == 0) {
                this.loginEnable = true;
            }
            this.scheduleOnce(function () {
                if (info.length > 0) {
                    this.loginEnable = true;
                    self.loginAction();
                }
            }, 0.5);
            //}
        } else if (KQNativeInvoke.isNativeAndroid()) {
                // if(androidVersion != manager.version) {
                //     this.versionEnable = false;
                //     var updateAlert = cc.find("Canvas/update").getComponent("alert");
                //     updateAlert.alert();
                // }
                // else {
                this.versionEnable = true;
                var self = this;
                var info = manager.getUserInfo();
                if (info.length == 0) {
                    this.loginEnable = true;
                }
                this.scheduleOnce(function () {
                    if (info.length > 0) {
                        this.loginEnable = true;
                        self.loginAction();
                    }
                }, 0.5);
                //}
            } else {
                    this.versionEnable = true;
                    var self = this;
                    // var info = manager.getUserInfo();
                    // if (info.length == 0) {
                    //     this.loginEnable = true;
                    // }
                    this.scheduleOnce(function () {
                        if (!cc.sys.isNative) {
                            var recordId = self.getQueryString('recordId');
                            if (recordId) {
                                Socket.sendGetRecrodFromId(recordId);
                                return;
                            }
                            var roomId = self.getQueryString("roomId");
                            if (roomId) {
                                var info = manager.getUserInfo();
                                if (info.length > 0) {
                                    var data = JSON.parse(info);
                                    if (!data.errcode) {
                                        self.sendLoginRequest(data);
                                    } else {
                                        manager.setUserInfo("");
                                    }
                                    return;
                                } else {
                                    self._get_HREF(roomId);
                                }
                            }
                        }
                        var info = manager.getUserInfo();
                        if (info.length > 0) {
                            var data = null;
                            try {
                                data = JSON.parse(info);
                            } catch (e) {
                                manager.setUserInfo("");
                                data = null;
                            }
                            if (!data || data.errcode) {
                                manager.setUserInfo("");
                            } else {
                                this.loginEnable = true;
                                self.loginAction();
                            }
                        } else {
                            if (!cc.sys.isNative) {
                                var code = self.getQueryString("code");
                                var roomId = self.getQueryString("roomId");
                                if (roomId) {
                                    var info = manager.getUserInfo();
                                    if (info.length > 0) {
                                        var data = JSON.parse(info);
                                        if (!data.errcode) {
                                            self.sendLoginRequest(data);
                                        } else {
                                            manager.setUserInfo("");
                                        }
                                        return;
                                    } else {
                                        self._get_HREF(roomId);
                                    }
                                }
                                if (code) {
                                    try {
                                        var obj = new XMLHttpRequest(); // XMLHttpRequest对象用于在后台与服务器交换数据
                                        var url = "./get_token.php";
                                        obj.open("POST", url, true);
                                        obj.setRequestHeader("Content-type", "application/x-www-form-urlencoded"); // 添加http头，发送信息至服务器时内容编码类型
                                        obj.onreadystatechange = function () {
                                            if (obj.readyState == 4 && (obj.status == 200 || obj.status == 304)) {
                                                // 304未修改
                                                //alert(obj.responseText);
                                                var data = JSON.parse(obj.responseText);
                                                if (!data.errcode) {
                                                    manager.setUserInfo(obj.responseText);
                                                    self.sendLoginRequest(data);
                                                }
                                            }
                                        };
                                        obj.send("code=" + code);
                                    } catch (e) {
                                        //alert(e);
                                    }
                                }
                            }
                        }
                    }, 0.5);
                }
        //}
    },
    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },
    //随机生成 num 位 的随机数 含大小写字母及数字
    getRandomAccount: function getRandomAccount(num) {
        /**
         * 返回一个字母
         */
        function getCharacter(flag) {
            var character = "";
            if (flag === "lower") {
                character = String.fromCharCode(Math.floor(Math.random() * 26) + "a".charCodeAt(0));
            }
            if (flag === "upper") {
                character = String.fromCharCode(Math.floor(Math.random() * 26) + "A".charCodeAt(0));
            }
            return character;
        }

        var str = "";
        for (var i = 0; i < num; i++) {
            var flag = "lower";
            var random = Math.floor(Math.random() * 3);
            if (random == 0) {
                flag = "upper";
                str += getCharacter(flag);
            } else if (random == 1) {
                str += getCharacter(flag);
            } else {
                str += Math.floor(Math.random() * 10);
            }
        }
        return str;
    },
    getGuestUserInfo: function getGuestUserInfo() {
        var search = window.location.search;
        var openid = "guest_" + this.getRandomAccount(8);
        var unionid = 'guest_' + this.getRandomAccount(8);
        var nickname = this.getRandomAccount(8);
        var testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
        return testData;
    },
    onLoad: function onLoad() {
        this.keyBackListen();
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var canvas = cc.find("Canvas");
            var cvs = canvas.getComponent(cc.Canvas);
        }
        KQGlabolSocketEventHander.start();
        this.socket = cc.find('GameSocket').getComponent('socket');
        var self = this;
        this.loginEnable = false;
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
            //console.log(data)
            if (data.action == 'checkVersion') {
                try {
                    self.checkVersion(data.data);
                } catch (e) {
                    //this.err.string = e;
                }
            } else if (data.action == 'login') {
                    if (data.result) {
                        //成功
                        self.socket.userInfo = data.data; //运行时态信息
                        if (!cc.sys.isNative) {
                            var roomId = self.getQueryString("roomId");
                            //console.log(roomId);
                            if (roomId) {
                                var userId = data.data.id;
                                var exitInRoom = data.data.roomId;
                                if (exitInRoom != "") {
                                    roomId = exitInRoom;
                                }
                                Socket.sendLoginJoin(roomId, userId);
                                return;
                            }
                        }
                        self._loadingLabel("登录中");
                        if (data.data.roomId.length > 0) {
                            cc.director.loadScene('play');
                        } else {
                            cc.director.loadScene('hall');
                        }
                    } else {
                        // self.alertMessage('登录失败!');
                    }
                }
        };
        this._registerSocketEvent();

        this.socket.getWxInfo = function (info) {
            manager.setUserInfo(info); //保存本地
            var data = JSON.parse(info); //str -> json(obj)
            self.scheduleOnce(function () {
                //延迟执行 1s
                self.sendLoginRequest(data); //登录请求
            }, 1);
        };
        this.getOnlyUserInfoByBrowser();
        //cc.sys.localStorage.removeItem("userinfo");
        // let search = window.location.search;
        // var openid = "JzIwMTcvNi8xNiDkuIrljYgxMMzowOCc=";
        // var unionid = '8dOtAcDic5Sichv3lxtMXYJgmunTLOLv';
        // var nickname = "哇哈哈";

        //var openid = "JzIwMTcvNi8xNiDkuIrljYgxMMzowOCc=";
        //var openid = "guest_" + this.getRandomAccount(8);
        //var unionid = '8dOtAcDic5Sichv3lxtMXYJgmunTLOLv';
        //var unionid = 'guest_' + this.getRandomAccount(8);
        //var nickname = this.getRandomAccount(8);

        //if (search) {
        //    var url = window.location.search;
        //    var loc = url.substring(url.lastIndexOf('=') + 1, url.length);
        //    if (loc == 1) {
        //        openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';
        //        unionid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc';
        //        nickname = loc;
        //    }
        //    else if (loc == 2) {
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';
        //        unionid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw';
        //        nickname = loc;
        //    }
        //    else if (loc == 3) {
        //        openid = 'JzIwMTctNi0xNiAwOTo0NToc=';
        //        unionid = '8dOtAcDic5Sichv3lxtMXYmunTLOLv';
        //        nickname = loc;
        //    }
        //    else if (loc == 4) {
        //        openid = 'ozlXIwgv_QJT0ykdUihaABmsWp2A';
        //        unionid = 'o-3911qWsQsW3wUodqFfUtbsAeNk';
        //        nickname = loc;
        //    }
        //    else if (loc == 5) {
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';
        //         unionid = 'o-JzIwMTcvNi8xNiDkuIrljYgxMDowM';
        //        nickname = loc;
        //    }else if(loc == 6){
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYgxMMzoc=';
        //         unionid = 'o-zIwMTcvNi8xNiDkuIrl';
        //        nickname = loc;
        //    }
        //
        //}
        // var testData = '{"openid":"'+openid+'","nickname":"'+nickname+'","unionid":"'+unionid+'","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';

        //if (!cc.sys.isNative){
        //    var info = manager.getUserInfo();
        //    if (info.length > 0) {
        //        //this.showWaitingMessage('已存有账号=====');
        //        //return;
        //    }else
        //    {
        //        //this.showWaitingMessage('新账号=====');
        //        var userInfo = this.getGuestUserInfo();
        //        manager.setUserInfo(userInfo);
        //    }
        //}
    },

    getOnlyUserInfoByBrowser: function getOnlyUserInfoByBrowser() {
        var openid = "";
        var unionid = "";
        var nickname = "";

        var testData = "";
        var userInfo = manager.getUserInfo();

        var search = window.location.search;
        if (userInfo.length > 0) {
            openid = userInfo.openId;
            unionid = userInfo.unionid;
            nickname = userInfo.nickname;
        }

        if (search) {
            var url = window.location.search;
            var loc = url.substring(url.lastIndexOf('=') + 1, url.length);
            if (loc == 1) {
                openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';
                unionid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc';
                nickname = "guest_1";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 2) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';
                unionid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw';
                nickname = "guest_2";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 3) {
                openid = 'JzIwMTctNi0xNiAwOTo0NToc=';
                unionid = '8dOtAcDic5Sichv3lxtMXYmunTLOLv';
                nickname = "guest_3";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 4) {
                openid = 'ozlXIwgv_QJT0ykdUihaABmsWp2A';
                unionid = 'o-3911qWsQsW3wUodqFfUtbsAeNk';
                nickname = "guest_4";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 5) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';
                unionid = 'o-JzIwMTcvNi8xNiDkuIrljYgxMDowM';
                nickname = "guest_5";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 6) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYgxMMzoc=';
                unionid = 'o-zIwMTcvNi8xNiDkuIrl';
                nickname = "guest_6";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            }
        }
        if (testData && testData.length > 0) {
            if (!cc.sys.isNative) {
                manager.setUserInfo(testData);
            }
        }
    },
    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveLoginJoin, this._LoginJoin, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRecordId, this._ReceiveRecordId, this);
        KQGlobalEvent.on(Socket.Event.ReceiveNoUionid, this._ReceiveNoUionid, this);
    },
    _get_HREF: function _get_HREF(roomId) {
        if (roomId != ROOMID) {
            ROOMID = roomId;
            roomId = "%3froomId%3d" + roomId;
            REDIRECT_URI = REDIRECT_URI + roomId;
            HREF = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + APPID + "&redirect_uri=" + REDIRECT_URI + "&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";
        }
    },
    _ReceiveNoUionid: function _ReceiveNoUionid(response) {
        manager.setUserInfo("");
        var self = this;
        var roomId = this.getQueryString("roomId");
        if (roomId) {
            //roomId = "%3froomId%3d"+roomId ;
            //REDIRECT_URI = REDIRECT_URI+roomId;
            this._get_HREF(roomId);
        }
        setTimeout(function () {
            self.loadingNode.parent.active = false;
            self.loadingNode.stopAllActions();
        }, 2000);
        this._loadingLabel("登录失败，请重新登录");
    },
    _ReceiveRecordId: function _ReceiveRecordId(response) {
        var data = response.data;
        if (data.recordMsg.length > 0) {
            var record = data.recordMsg[0];
            var playersInfo = JSON.parse(record.playersInfo).players;
            var recordNode = cc.instantiate(this.recordInfo);
            var totalGameResult = recordNode.getComponent("TotalGameResult");
            playersInfo.sort(function (a, b) {
                return b.totalScore - a.totalScore;
            }); // 排序
            totalGameResult.setPlayerInfos(playersInfo, record);
            totalGameResult._clickBtn();
            recordNode.getComponent('alert').alert();
            this.node.addChild(recordNode);
        }
    },
    _LoginJoin: function _LoginJoin(response) {
        this._loadingLabel("进入房间，正在为您请求数据");
        if (response.result) {
            if (cc.from == null) {
                cc.from = {};
            }
            cc.from.ma = response.data.maPai;
            cc.director.loadScene('play');
        } else {
            cc.joinDesk = {};
            cc.director.loadScene('hall');
            var reasonInfo = this._joinReasonMap(response.data.reason);
            cc.joinDesk.result = response.result;
            cc.joinDesk.reason = reasonInfo;
        }
    },
    _joinReasonMap: function _joinReasonMap(reason) {
        var reasonInfo = {
            notExist: "房间不存在!",
            cardNumber: "您房卡不足!"
        };
        var info = reasonInfo[reason] || "房间已满!";
        return info;
    },

    getQueryString: function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);return null;
    },

    agreements: function agreements() {
        this.agreementNode.active = true;
        //this.agreementLabel.string = cc.info1;
        this.agreementLabel.node.y = 0;
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
    },

    _loadingLabel: function _loadingLabel(label) {
        this.label.string = label;
    },

    sendLoginRequest: function sendLoginRequest(data) {
        //this.showWaitingMessage('登录中...');
        this.loadingNode.parent.active = true;
        this.loadingNode.runAction(cc.repeatForever(cc.rotateBy(2, 360)));
        //return;
        this.socket.sendMessage('login', data);
    },

    loginAction: function loginAction() {
        if (!cc.sys.isNative) {
            var info = manager.getUserInfo();
            if (info.length > 0) {
                //this.showWaitingMessage('已存有账号=====');
                //return;
            } else {
                    //this.showWaitingMessage('新账号=====');
                    var userInfo = this.getGuestUserInfo();
                    manager.setUserInfo(userInfo);
                }
        }

        var info = manager.getUserInfo();
        if (info.length > 0) {
            var data = JSON.parse(info);
            this.sendLoginRequest(data);
            return;
        }
        if (!cc.sys.isNative) {
            // cc.sys.openURL(HREF);
            window.location.href = HREF;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
            } else if (KQNativeInvoke.isNativeAndroid()) {
                    //Android
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
                }
        }
    },

    changeGuestUserInfo: function changeGuestUserInfo() {
        manager.setUserInfo('');
        this.loginAction();
    },

    loginYkAction: function loginYkAction() {
        //var comp = this.selectNode.getComponent('select');
        //if (!comp.selected) {
        //    this.showMsg = cc.instantiate(this.alertPrefab);
        //    this.canvasNode.addChild(this.showMsg);
        //    let comp = this.showMsg.getComponent('alert');
        //    comp.setMessage('请同意用户协议');
        //    return;
        //}
        var testDate = new Date();
        var time = "'" + testDate.toLocaleString() + "'";
        var openid = new Buffer(time).toString('base64');
        var testData = '{"openid":"' + openid + '","nickname":"游客","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/BVyz4R8q6puJibEv1hrsaTmIKQhkaTS9FyvcevvC5hlxFnfOuspDjicG0GtzyJXOhNT7g1WZDeCDQhnRdEOgz3QMnP0F9iboQGy\/0","privilege":[]}';
        var data = JSON.parse(testData);
        this.sendLoginRequest(data);
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.isValid(this.waitingNode)) {
            if (msg == this.waitingNode.getComponent('alert').getMessage()) {
                return;
            }
            this.waitingNode.removeFromParent();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.canvasNode.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        //console.log(comp);

        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    protocolAction: function protocolAction() {
        cc.log('protocol action');
    }
});

cc._RFpop();
}).call(this,require("buffer").Buffer)

},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","buffer":2,"manager":"manager","socket":"socket"}],"maPai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8b896xHkCtE1IzD8BDK4cWL', 'maPai');
// scripts\Play\maPai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        maPaiSprite: [cc.SpriteFrame],
        spriteNode: cc.Sprite,
        labelNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"manager":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4a47fj0J/VHup24OT7njkko', 'manager');
// scripts\manager.js

module.exports = {
    version: 'v1.0.0',

    setUserInfo: function setUserInfo(str) {
        cc.sys.localStorage.setItem('userinfo', str);
    },

    getUserInfo: function getUserInfo() {
        var value = cc.sys.localStorage.getItem('userinfo');
        if (!value) {
            return "";
        }
        return value;
    },

    setMusicValue: function setMusicValue(value) {
        cc.sys.localStorage.setItem('musicVolumn', value);
    },

    getMusicValue: function getMusicValue() {
        var value = cc.sys.localStorage.getItem('musicVolumn');
        if (!value) {
            return 1;
        }
        return value;
    },

    setMusicEffectValue: function setMusicEffectValue(value) {
        cc.sys.localStorage.setItem('musicEffectVolumn', value);
    },

    getMusicEffectValue: function getMusicEffectValue() {
        var value = cc.sys.localStorage.getItem('musicEffectVolumn');
        if (!value) {
            return 1;
        }
        return value;
    }
};

cc._RFpop();
},{}],"overTime":[function(require,module,exports){
"use strict";
cc._RFpush(module, '48748u5hxdOD4WTPWQqSQwN', 'overTime');
// scripts\overTime.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        //selectedIndex: 0,
        _selected: 1
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        this._select = true;
        var overTime = 0;
        if (cc.set) {
            overTime = cc.set.setting6;
            this._selected = this._select = overTime;
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select;
            this._selected = this._select;
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (self._select) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                this.setSelected(self._selected = self._select = !self._select);
                var title = this.node.getChildByName("title");
                if (self._select) {
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    title.color = new cc.Color(255, 255, 255);
                }
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "orders" && cc.set) {
            //this.remember_set(overTime);
        }
    },
    remember_set: function remember_set(obj) {
        for (var i = 0; i < this.nodes.length; i++) {
            this.nodes[i].getComponent('select').setSelected(obj);
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (obj) {
                var title = this.nodes[0].getChildByName('title');
                title.color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
    }

});

cc._RFpop();
},{}],"play":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16c65H2Pw9PBaQSvw69LGLQ', 'play');
// scripts\play.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var Manager = require('manager');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
var fecha = require('fecha');
var manager = require('manager');
/*#####*/
var KQCard = require('KQCard');
/**/
var Player = require('Player');
/**/
//const isTeShuPai = require('isTeShuPai');
//特殊牌类型
var TESHUPAITYPE = {
    isTeShuPai: false,
    isLiuDuiBan: false,
    isSanShunZi: false,
    isSanTaoHua: false,

    isQingLong: false,
    isYiTiaoLong: false,
    isSanTongHuaShun: false,
    isSanFenTianXia: false,
    isCouYiSe: false,
    isSiTaoSanTiao: false,
    isWuDuiSanTiao: false
};

var GAMESTATUS = {
    WAIT_PEOPLE: 0, // 等人
    WAIT_READY: 1, // 等待他人准备
    PLAYING: 2 };
// 正在玩游戏
var sTitle = '';
var sDescription = '';
var sId = '';
// 布局
//          2
//   3            1
//     self 0
var Play = cc.Class({
    'extends': cc.Component,

    properties: {
        playerNodes: [cc.Node],
        //playsCoins: [cc.Node],
        chatNode: cc.Node,
        cardTypeCombineNode: cc.Node,
        typeButtonsNode: cc.Node,
        phone: cc.Label,
        labelRoomNumber: cc.Label,
        labelOverview: cc.Label,
        labelRemainTime: cc.Label,
        btnShare: cc.Button,
        btnReady: cc.Button, // 准备按钮
        btnStartGame: cc.Button, // 开始按钮
        beilv: cc.Node, // 选择倍率节点
        btnChatVoice: cc.Button,
        btnChatText: cc.Button,
        againBtn: cc.Node,

        startCompareCardsNode: cc.Node,
        settingNode: cc.Node,
        VoiceMsgBg: cc.Node,
        exit: cc.Node, // 离开房间节点
        Dissolve: cc.Node, // 解散房间节点
        shareBg: cc.Node, // 分享背景
        totalGameResult: cc.Node, // 结果节点
        alertRequestExitNode: cc.Node, // 申请退出 Node
        dissolveAlter: cc.Node, // 申请退出 Node
        alertRequestExitCountdownNode: cc.Node, // 申请退出倒计时 Node
        alertAnsowerExitNode: cc.Node, // 回答申请退出  Node
        contentAnsowerExitNode: cc.Node, // 回答申请退出头像  Node
        alertAnsowerExitResult: cc.Node, // 回答申请退出结果  Node
        alertAnsowerExitCountdownNode: cc.Node, // 回答以上请退出的倒计时
        Countdown: cc.Node, // 倒计时
        labelTime: cc.Label,
        needCard: cc.Label,
        alert: cc.Node,
        coinsContainerNode: cc.Node,
        btnAlertRequestExitConfirmButton: cc.Button,
        btnAlertRequestExitCancelButton: cc.Button,

        autoTishi: cc.Prefab,
        waitingPrefab: cc.Prefab,
        coinsPrefab: cc.Prefab,
        playerComps: [Player],

        gongXiNi: cc.Node,
        teShuPai: cc.Node,

        cardSpriteAtlas: cc.SpriteAtlas,
        daoSpriteAtlas: cc.SpriteAtlas,

        _liuDuiBan: false,
        _sanShunZi: false,
        _sanTongHua: false,
        _yiTiaoLong: false,

        _QingLong: false,
        _SanTongHuaShun: false,
        _SanFenTianXia: false,
        _CouYiSe: false,
        _SiTaoSanTiao: false,
        _WuDuiSanTiao: false,

        _playerComponents: null,
        _msgControl: null,
        _nowTimeAgain: 0,

        _socket: null,
        _userId: 0,
        _playerInfos: null,
        _deskInfo: null, // createTime 创建时间  isDissolving 表示是否正在解散 dissolveLeftTime 离解散剩余多长时间 dissolveAnswerInfo [处理过的人的信息]
        _gameStatus: GAMESTATUS.WAIT_PEOPLE,
        _enterTime: null,
        _bigRecordInfo: null,
        _players: null,
        /**/
        _isComparingCardsNow: false, // 是否正在比牌
        _playedCompareCardsIndexs: [], // 已经播放过比牌的局数
        /**/
        fapaiNode: cc.Prefab,
        liuduiban: cc.Prefab,
        santonghua: cc.Prefab,
        sanshunzi: cc.Prefab,
        quanleida: cc.Prefab
    },
    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },
    // use this for initialization
    onLoad: function onLoad() {
        var _this2 = this;

        this.keyBackListen();
        this.headCardTime = 0.85;
        var bg = this.node.getChildByName("room_bg");
        var windowP = cc.director.getWinSizeInPixels();
        var scaleX = windowP.width / bg.width;
        var scaleY = windowP.height / bg.height;
        var scale = Math.max(scaleX, scaleY);
        bg.scaleX = scale;
        bg.scaleY = scale;

        this.BtnClickGongXiNiComfirm = this.cardTypeCombineNode.getComponent("CardTypeCombine").BtnClickGongXiNiComfirm;
        this._enterTime = Date.now();
        /**/
        this.playerComps.forEach(function (playerComp) {
            playerComp.playedCompareCardsIndexs = _this2._playedCompareCardsIndexs;
        });
        /**/
        /*AudioManager.instance.playDeskMusic();*/

        AudioManager.instance.stopHallMusic();
        var bgSound = cc.sys.localStorage.getItem("bgSound");
        if (bgSound == 0) {
            var audioManager = cc.find('AudioManager');
            audioManager = audioManager.getComponent('AudioManager');
            audioManager.setEffectMusicVolum(bgSound);
        }

        this._initPlayerComponents();
        this._initSelectCardNode();
        this._initOneGameResult();
        this._remainTimeStartUpdate();

        this._userId = Socket.instance.userInfo.id;
        this._msgControl = this.chatNode.getComponent('MsgControl');
        this._userId = Socket.instance.userInfo.id;
        this.beilv.getComponent("selectbeilv")._userid = this._userId;
        //this.settingNode.getComponent("Setting").hideSwitch();
        this.labelRoomNumber.string = "";
        this.labelRemainTime.node.active = false;

        this._registerVoiceNodeEvents();
        this._registerSocketEvent();

        Play.instances = this;
        this._gongXiNiShow(false);
        if (Playback.instance.isContainPlaybackDatas()) {
            Playback.instance.startPlayback();
            this.playbackNode.active = true;
            this.btnChatVoice.node.active = false;
            //this.cardsFromArray.node.active = false;
        } else {
                this._loadDeskInfo();
            }

        this._socket = Socket.instance;

        cc.director.preloadScene('hall', function () {
            cc.director.preloadScene('login');
        });

        cc.clickOut = false;
        //this.timeStart(5);
    },

    timeStart: function timeStart(duration, action) {
        cc.assert(duration > 0);
        this.timeStop();
        this.Countdown.active = true;
        if (action != "ready") {
            var timestamp = cc.sys.localStorage.getItem("timestamp"); // 获取本地存储的时间戳
            if (timestamp) {
                // 如果有则证明玩家是重新进来了的
                var now = Date.parse(new Date());
                var time = duration * 1000;
                if (now - timestamp > time) {
                    // 超时
                    if (now - timestamp < 2 * time) {
                        duration = 5; // 玩家可能出于其他原因退出游戏导致超时，为其提供5秒时间整理牌型（这已经是很仁慈的了）。
                    } else {
                            cc.sys.localStorage.removeItem("timestamp");
                        }
                } else {
                    duration = Math.floor(duration - (now - timestamp) / 1000);
                }
            } else {
                // 如果没有时间戳，则保存，为玩家退出游戏保留证据；
                var timestamp = Date.parse(new Date());
                cc.sys.localStorage.setItem('timestamp', timestamp);
            }
        }
        this._timeRemainDuration = duration;
        this.labelTime.string = String(duration);
        this.Countdown.getComponent("time").setTime(duration * 0.5);
        var self = this;
        this.callback = function () {
            self._timeMethod(action);
        };
        this.schedule(this.callback, 1, duration);
    },

    timeStop: function timeStop() {
        this.unschedule(this.callback);
        this.Countdown.active = false;
    },

    _timeMethod: function _timeMethod(action) {
        this._timeRemainDuration = this._timeRemainDuration - 1;

        var remain = Math.max(this._timeRemainDuration, 0);
        this.labelTime.string = remain < 10 && remain > 0 ? '0' + remain : remain;

        if (this._timeRemainDuration <= 0) {
            this.timeStop();
            if (action == "ready") {
                if (this._deskInfo.cIndex > 0) {
                    this.clickReady();
                }
            }
            cc.sys.localStorage.removeItem("timestamp");
            return;
        }
    },

    _globalMsg: function _globalMsg(data) {
        //if(!cc.sys.isNative){
        var roomId = data.roomId;
        var wf = data.setting3; ///[疯狂场,鬼牌,比花色,坐庄,马牌]
        var room = "房号：" + roomId;
        var fk = wf[0] ? "疯狂场 " : "普通场 "; // 疯狂场
        var gp = wf[1] ? "鬼牌 " : "无鬼 "; // 鬼牌
        var hs = wf[2] ? "比花色 " : "不比花色 "; // 比花色
        var zj = wf[3] ? "坐庄 " : "不坐庄 "; // 庄家
        var mp = wf[4] ? "买马 " : "不买马 "; // 马牌
        var sf = "房费:" + (data.setting4 ? data.setting4 == 1 ? "赢者扣 " : "房主扣 " : "平摊 "); //收费
        var shareTitle = room + " 模式:" + zj + sf;

        var pj = ["5局 ", "10局 ", "20局 "]; //牌局
        var ds = ["4人不加色 ", "5人加一色 ", "6人二色 ", "7人加三色 "]; //多色
        var rs = ds[data.setting2] + "";
        var js = pj[data.setting1 - 2];
        var desc = '[大众十三水] ' + zj + fk + mp + gp + sf + rs + js + " 点击直接进入房间";

        sTitle = shareTitle;
        sDescription = desc;
        sId = 'roomId=' + roomId;

        cc.sys.localStorage.setItem('roomId', roomId);
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);

        if (cc.sys.isBrowser) {
            if (window.shareToTimeLine) {
                window.shareToTimeLine();
            }
            if (window.shareToSession) {
                window.shareToSession();
            }
        }
        //}
    },

    /*#####*/
    /*显示马牌*/
    _initMaPai: function _initMaPai() {},

    _initPlayerComponents: function _initPlayerComponents(playerIndex) {
        this._playerComponents = this.playerNodes.map(function (node) {
            return node.getComponent('Player');
        });

        if (!playerIndex) {
            playerIndex = [0, 1, 2, 3, 4, 5];
        }

        var a = this._playerComponents.splice(1, 7);

        for (var i = 0; i < playerIndex.length - 1; i++) {
            var index1 = playerIndex[i];
            var index2 = playerIndex[i + 1];
            var tmp = null;
            tmp = a[index1];
            a[index1] = a[index2];
            a[index2] = tmp;
        }

        a.forEach((function (node) {
            this._playerComponents.push(node);
        }).bind(this));

        if (this.playsCoins && this.playsCoins.length > 0) {
            this.playsCoins.forEach((function (node) {
                node.active = false;
            }).bind(this));
        }

        this.playsCoins = [];

        this._playerComponents.forEach((function (plays, i) {
            var name = "coins" + i;

            var node = new cc.Node();

            node.name = name;

            node.x = plays.node.x;

            node.y = plays.node.y;

            this.node.addChild(node);

            this.playsCoins.push(node);
        }).bind(this));
    },

    _initSelectCardNode: function _initSelectCardNode() {
        var self = this;
        var cardTypeCombineComp = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombineComp.setFinishSelectCardsCallback(function (serverCardsInfo) {
            cardTypeCombineComp.reset();
            Socket.sendPlayCard(self._userId, serverCardsInfo);
            self.cardTypeCombineNode.active = false;
        });
    },

    /**/
    _initOneGameResult: function _initOneGameResult() {
        var self = this;
        // this.oneGameResult.setCloseCallback = function () {
        //     if (self._isRandomRoom()) {
        //         cc.director.loadScene('hall');
        //     }
        // };
    },

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickLeaveDesk: function clickLeaveDesk() {
        // 点击离开桌子
        if (this._deskInfo.cIndex == 0) {
            // 还没开始可以退出房间
            if (this._deskInfo.createId == this._userId) {
                cc.director.loadScene('hall');
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
        }
    },
    clickDissolveDesk: function clickDissolveDesk() {
        // 点击解散桌子
        if (this._deskInfo.createId == this._userId) {
            // 只有房主才能解散桌子
            this.btnAlertRequestExitCancelButton.node.active = true;
            this.btnAlertRequestExitConfirmButton.node.active = true;
            var _alert = this.alertRequestExitNode.getComponent('alert');
            _alert.unscheduleAllCallbacks();
            _alert.setMessage("是否要解散房间");
            _alert.alert();
        }
    },

    clickExitOut: function clickExitOut() {
        Socket.sendDissolveDesk(this._userId);
    },

    //解散退出房间
    clickExit: function clickExit() {
        if (Playback.instance.isPlaybacking()) {
            cc.director.loadScene('hall');
            return;
        }
        /**/
        if (this._deskInfo && this._deskInfo.isDeskOver) {
            if (!this._isComparingCardsNow) {
                // 如果房间已结束，并且不是正在播放打牌动画, 则直接离开房间
                cc.director.loadScene('hall');
            }
            return;
        }
        /**/
        //if (this._isRandomRoom()) {
        //    this.alertForceExitNode.getComponent('alert').alert();
        //    return;
        //}
        if (this._deskInfo.cIndex == 0) {
            if (this._deskInfo.createId == this._userId) {
                var alert1 = this.dissolveAlter.getComponent('alert');
                alert1.alert();
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
            return;
        }
        this.btnAlertRequestExitCancelButton.node.active = true;
        this.btnAlertRequestExitConfirmButton.node.active = true;

        var alert = this.alertRequestExitNode.getComponent('alert');
        alert.unscheduleAllCallbacks();
        alert.setMessage("是否解散房间？");
        alert.alert();

        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },
    //不解散退出房间
    clickOut: function clickOut() {
        if (this._deskInfo.cIndex == 0) {
            if (this._deskInfo.createId == this._userId) {
                cc.clickOut = true;
                cc.director.loadScene('hall');
                return;
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
        }
    },

    clickShareBg: function clickShareBg() {
        cc.find("Canvas/shareBg").active = false;
        this.shareBg.active = false;
    },
    guanzhu: function guanzhu() {
        // var url = "http://www.honggefeng.cn/gzh/index.html";
        // cc.sys.openURL(url)
    },
    recordShare: function recordShare() {
        if (this._deskInfo.recordId) {
            var shareTitle = "[大众十三水]战绩";
            var roomId = "房间号：" + this._deskInfo.roomId;
            var pj = ["5 ", "10 ", "20 "]; //牌局
            var js = "局数：" + pj[this._deskInfo.setting1 - 2];
            var time = "时间：" + this._deskInfo.createTime;
            var desc = roomId + js + time + "点击查看详情";

            var recordId = this._deskInfo.recordId;
            cc.sys.localStorage.setItem("shareTitle", shareTitle);
            cc.sys.localStorage.setItem("desc", desc);
            cc.sys.localStorage.setItem("recordId", recordId);
            cc.sys.localStorage.setItem("roomId", '');

            sTitle = shareTitle;
            sDescription = desc;
            sId = 'roomId=' + roomId;
            if (recordId) {
                sId = 'recordId=' + recordId;
            }

            if (cc.sys.isBrowser) {
                if (window.shareToTimeLine) {
                    window.shareToTimeLine();
                }
                if (window.shareToSession) {
                    window.shareToSession();
                }
            }
        };
        if (!cc.sys.isNative) {
            cc.find("Canvas/shareBg").active = true;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
            } else {
                //Android
                KQNativeInvoke.screenshotShare();
            }
        }
    },
    // 点击桌面分享
    clickDeskShare: function clickDeskShare() {
        //this._globalMsg(this._deskInfo);
        if (!cc.sys.isNative) {
            var shareBg = cc.find("Canvas/shareBg");
            shareBg.active = true;
            //var wxBg = this.shareBg.getChildByName("wx");
            //var pyqBg = this.shareBg.getChildByName("PYQ");
            //wxBg.active = true;
            //pyqBg.active = false;
            //this.shareBg.active = true;
        }
        var id = sId;
        var title = sTitle;
        var description = sDescription;
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
        }
    },
    //点击分享按钮
    clickShare: function clickShare() {
        //this._globalMsg(this._deskInfo);
        if (!cc.sys.isNative) {
            var wxBg = this.shareBg.getChildByName("wx");
            var pyqBg = this.shareBg.getChildByName("PYQ");
            wxBg.active = true;
            pyqBg.active = false;
            this.shareBg.active = true;
        }
        var id = sId;
        var title = sTitle;
        var description = sDescription;

        // let roomId = String(this._deskInfo.roomId);
        // var description = "大众十三水 玩法:"
        // description = description + " " + this._deskInfoNumberOfPeople();
        // description = description + "," + this._deskInfoPayInfo();
        // description = description + " " + this._deskInfoNumberOfGame();

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
        }
    },

    //分享到朋友圈
    shareHallTimeline: function shareHallTimeline() {
        if (!cc.sys.isNative) {
            var wxBg = this.shareBg.getChildByName("wx");
            var pyqBg = this.shareBg.getChildByName("PYQ");
            wxBg.active = false;
            pyqBg.active = true;
            this.shareBg.active = true;
        } else {
            var id = sId;
            var title = sTitle;
            var description = sDescription;

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
            }
        }
    },

    //点击准备按钮
    clickReady: function clickReady() {
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.timeStop();
        Socket.sendReady(this._userId);
    },

    //点击开始按钮
    clickStartGame: function clickStartGame() {
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.btnStartGame.node.active = false;
        Socket.sendStartGame(this._userId);
    },

    updateRoomNumber: function updateRoomNumber(roomNumber) {
        var gameNumberString = "";
        if (this._deskInfo.setting1 != 0 && this._deskInfo.setting1 != 1) {
            gameNumberString = "局数 : " + "" + this._deskInfo.cIndex + "/" + this._deskInfo.mMax;
        } else if (this._deskInfo.setting1 == 0) {
            gameNumberString = "局数 : 10局";
        } else if (this._deskInfo.setting1 == 1) {
            gameNumberString = "局数 : 20局";
        }
        this.labelRoomNumber.string = "房号 : " + "" + roomNumber + "    " + gameNumberString;
    },

    updateGameStatus: function updateGameStatus() {
        var status = arguments.length <= 0 || arguments[0] === undefined ? GAMESTATUS.WAIT_PEOPLE : arguments[0];

        this._gameStatus = status;

        this.btnShare.node.active = status == GAMESTATUS.WAIT_PEOPLE;
        this.btnReady.node.active = status == GAMESTATUS.WAIT_READY;
        this.isReadyStatus();
    },

    gameStatus: function gameStatus() {
        return this._gameStatus;
    },
    isReadyStatus: function isReadyStatus() {
        if (this._playerInfos && this._playerInfos.length > 0) {
            this._playerInfos.forEach((function (playerInfo) {
                var userInfoSelf = cc.find('Canvas/playSelf/userInfoSelf');
                if (playerInfo.id == this._userId) {
                    if (!playerInfo.readyStatus && !this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas()) {
                        userInfoSelf.getComponent('userInfo').setReadyNodeVisible(false);
                        if (this._deskInfo.cIndex == 0) {
                            //一局还没开始
                            this.btnReady.node.active = false;
                            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {
                                this.btnShare.node.active = true;
                            } else {
                                this.btnShare.node.active = false;
                            }

                            if (this._deskInfo.players.length >= 2 && this._deskInfo.createId == this._userId) {
                                //是否是房主
                                this.btnStartGame.node.active = true;
                            } else {
                                this.btnStartGame.node.active = false;
                            }
                        } else {
                            this.btnReady.node.active = true;
                            this.btnShare.node.active = false;
                            this.btnStartGame.node.active = false;
                            this.btnStartGame.node.active = false;
                        }
                    } else {
                        this.btnReady.node.active = false;
                        this.btnShare.node.active = false;
                        this.btnStartGame.node.active = false;
                        if (!this._isComparingCardsNow) {
                            userInfoSelf.getComponent('userInfo').setReadyNodeVisible(true);
                        } else {
                            this._playerComponents.forEach(function (playerComp) {
                                playerComp.hideReadyStatus();
                            });
                        }
                    }
                }
                //console.log(this._isComparingCardsNow)
                //console.log("准备状态--------")
                if (this._isComparingCardsNow) {
                    //
                    this._playerComponents.forEach(function (playerComp) {
                        playerComp.hideReadyStatus();
                    });
                }
            }).bind(this));
        }
    },

    isGameStart: function isGameStart() {
        if (this._deskInfo.cIndex == 0) {
            //一局还没开始
            if (this._deskInfo.createId == this._userId) {
                //是否是房主
                if (!this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas() && this._deskInfo.players.length >= 2) {
                    this.btnStartGame.node.active = true;
                    this.btnReady.node.active = false;
                } else {
                    this.btnStartGame.node.active = false;
                }
            } else {
                this.btnStartGame.node.active = false;
            }

            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {
                this.btnShare.node.active = true;
            } else {
                this.btnShare.node.active = false;
            }
        } else {
            this.btnStartGame.node.active = false;
            this.btnShare.node.active = false;
        }
    },

    /// 游戏动画
    _startGame: function _startGame(playMusic) {

        if (this.gameStatus() == GAMESTATUS.PLAYING) {
            return;
        }
        //this._playerInfos = players;
        //this._playerComponents.forEach(function (player) {
        //
        //});
        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset(); //#####
            playerComp.hideReadyStatus();
        });
        this.teShuPai.active = false;

        this.unscheduleAllCallbacks();

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        this._playerComponents.forEach((function (plays, i) {

            var name = "coins" + i;

            var node = this.node.getChildByName(name);

            if (node) {
                node.removeAllChildren();
                this.node.removeChild(node);
            }
        }).bind(this));
        // cc.log(this.node)
        // cc.log('------709')
        this._updateUserInfos(this._playerInfos);
        this.showCompareCard();
        this._isComparingCardsNow = true;
        this.updateGameStatus(GAMESTATUS.PLAYING);
        this._playFaPaiAnimation(playMusic);

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');

        cardTypeCombine.reset();

        cardTypeCombine.node.active = false;

        if (!UserModelHelper.isPlayedCards(this._findPlayerInfoByUserId(this._userId))) {
            this.node.getComponent("animation").fapaiAnimation();
            this.scheduleOnce((function () {
                this._showCardTypeCombine();
            }).bind(this), 1.9);
        }
    },

    _playFaPaiAnimation: function _playFaPaiAnimation(playMusic) {
        this._playerComponents.forEach(function (player) {
            player.playFaPaiAnimation();
        });
        if (playMusic) {
            AudioManager.instance.playFaPai();
        }
    },

    /*#####*/
    //是否特殊牌
    isTeShuPai: function isTeShuPai(cards) {
        var result = KQCard.isTeShuPai(cards);
        if (result) {
            TESHUPAITYPE.isTeShuPai = true;
        } else {
            TESHUPAITYPE.isTeShuPai = false;
        }
        return result;
    },
    //是否一条龙
    isYiTiaoLong: function isYiTiaoLong(cards) {
        var result = KQCard.isYiTiaoLong(cards);
        if (result) {
            TESHUPAITYPE.isYiTiaoLong = true;
        } else {
            TESHUPAITYPE.isYiTiaoLong = false;
        }
        return result;
    },
    //是否六对半
    isLiuDuiBan: function isLiuDuiBan(cards) {
        var result = KQCard.isLiuDuiBan(cards);
        if (result) {
            TESHUPAITYPE.isLiuDuiBan = true;
        } else {
            TESHUPAITYPE.isLiuDuiBan = false;
        }
    },
    //是否三顺子
    isSanShunZi: function isSanShunZi(cards) {
        var result = KQCard.isSanShunZi(cards);
        if (result) {
            TESHUPAITYPE.isSanShunZi = true;
        } else {
            TESHUPAITYPE.isSanShunZi = false;
        }
    },
    //是否三同花
    isSanTongHua: function isSanTongHua(cards) {
        var result = KQCard.isSanTongHua(cards);
        if (result) {
            TESHUPAITYPE.isSanTaoHua = true;
        } else {
            TESHUPAITYPE.isSanTaoHua = false;
        }
    },
    //是否三同花顺
    isSanTongHuaShun: function isSanTongHuaShun(cards) {
        var result = KQCard.isSanTongHuaShun(cards);
        if (result) {
            TESHUPAITYPE.isSanTongHuaShun = true;
        } else {
            TESHUPAITYPE.isSanTongHuaShun = false;
        }
    },
    //是否是清龙
    isQingLong: function isQingLong(cards) {
        var result = KQCard.isQingLong(cards);
        if (result) {
            TESHUPAITYPE.isQingLong = true;
        } else {
            TESHUPAITYPE.isQingLong = false;
        }
    },
    //是否是 “三分天下”
    isSanFenTianXia: function isSanFenTianXia(cards) {
        var result = KQCard.isSanFenTianXia(cards);
        if (result) {
            TESHUPAITYPE.isSanFenTianXia = true;
        } else {
            TESHUPAITYPE.isSanFenTianXia = false;
        }
    },
    //是否是 “四套三条”
    isSiTaoSanTiao: function isSiTaoSanTiao(cards) {
        var result = KQCard.isSiTaoSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isSiTaoSanTiao = true;
        } else {
            TESHUPAITYPE.isSiTaoSanTiao = false;
        }
    },
    //是否是五对三条
    isWuDuiSanTiao: function isWuDuiSanTiao(cards) {
        var result = KQCard.isWuDuiSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isWuDuiSanTiao = true;
        } else {
            TESHUPAITYPE.isWuDuiSanTiao = false;
        }
    },
    //是否是凑一色
    isCouYiSe: function isCouYiSe(cards) {
        var result = KQCard.isCouYiSe(cards);
        if (result) {
            TESHUPAITYPE.isCouYiSe = true;
        } else {
            TESHUPAITYPE.isCouYiSe = false;
        }
    },
    /*#####*/

    /*显示配牌页面*/
    _showCardTypeCombine: function _showCardTypeCombine() {
        if (Playback.instance.isPlaybacking()) {
            return;
        }
        if (this.cardTypeCombineNode.active) {
            return;
        }

        this.startCompareCardsNode.active = false;
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;

        cc.teShuPaiCards = null;

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombine.reset();
        cardTypeCombine.reloadCards([]);
        cardTypeCombine.node.active = true;
        cardTypeCombine.timeStart(60);
        this.timeStart(60, "");
        this.cardTypeCombineNode.scale = 1;

        var cards = this._findCardsByUserId(this._userId);
        //"1_9""3_9""2_9"
        // "2_7""1_7""3_3""2_12"
        //"1_1""1_3""2_6""1_11""2_1""3_4"//
        // if(this._userId == 2){
        //     cards = [{suit: "d", number:2},{suit: "d", number:2}, {suit: "d", number:2},//青龙

        //         {suit: "h", number:2}, {suit: "d", number:2},
        //         {suit: "c", number:3}, {suit: "c", number:3}, {suit: "c", number:3},

        //         {suit: "d", number:3}, {suit: "d", number:4},
        //         {suit: "d", number:4}, {suit: "d", number:4}, {suit: "d", number:4}];
        // }
        //if(this._userId == 1){d
        //    cards = [{suit: "c", number:1},{suit: "h", number:1}, {suit: "s", number:1},//青龙
        //
        //        {suit: "h", number:8}, {suit: "c", number:2},
        //        {suit: "d", number:8}, {suit: "h", number:8}, {suit: "d", number:20},
        //        {suit: "h", number:9}, {suit: "s", number:9},
        //        {suit: "s", number:9}, {suit: "s", number:9}, {suit: "h", number:9}];
        //}
        // else if(this._userId == 6){
        //     cards = [{suit: "d", number:11},{suit: "d", number:13}, {suit: "d", number:11},//青龙
        //         {suit: "d", number:1}, {suit: "d", number:1},
        //         {suit: "h", number:2}, {suit: "h", number:4}, {suit: "h", number:9},
        //         {suit: "s", number:7}, {suit: "s", number:7},
        //         {suit: "s", number:5}, {suit: "s", number:5}, {suit: "s", number:5},];
        // }

        //else if(this._userId == 3){
        //    cards = [{suit: "d", number:4},{suit: "d", number:13}, {suit: "s", number:13},//青龙
        //        {suit: "d", number:6}, {suit: "s", number:7},
        //        {suit: "d", number:8}, {suit: "c", number:9}, {suit: "c", number:10},
        //        {suit: "s", number:1}, {suit: "s", number:3},
        //        {suit: "s", number:10}, {suit: "s", number:8}, {suit: "s", number:12},];
        //}
        cc.moshi = 0;
        for (var i = 0; i < cards.length; i++) {
            var s = cards[i].number;
            if (s >= 20) {
                cc.moshi = 1;
                break;
            }
        }
        var cardNames = this._convertCardsToCardNames(cards);
        cardTypeCombine.reloadCards(cardNames);
        cardTypeCombine.addCardModes(cardNames);

        //cc.from.moshi == 0选择了庄家模式

        if (cc.moshi != 1) {
            this.isTeShuPai(cards);
            this.isQingLong(cards);
            this.isYiTiaoLong(cards);
            this.isLiuDuiBan(cards);
            this.isSanShunZi(cards);
            this.isSanTongHua(cards);
            if (TESHUPAITYPE.isTeShuPai) {
                this.cardTypeCombineNode.scale = 0;
                var nodes = this.gongXiNi.getChildByName("bg");
                nodes.opacity = 240;
            }
            //this.isSanTongHuaShun(cards);
            //this.isSanFenTianXia(cards);
            //this.isSiTaoSanTiao(cards);
            //this.isWuDuiSanTiao(cards);
            //this.isCouYiSe(cards);
            this._showGongXiNiAndBtnTeShuPai();
        }
        cardTypeCombine.cacleAutoSelectedCards2();

        if (cc.moshi == 1) cc.teShuPaiCards = null;
        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset(); //#####
            playerComp.hideReadyStatus();
        });
    },

    getIsTeShuPai: function getIsTeShuPai(userId) {
        var cards = this._findCardsByUserId(userId);
        return this.isTeShuPai(cards);
    },

    /*#####检测特殊牌类型，显示相对应的恭喜你页面和特殊牌精灵*/
    _showGongXiNiAndBtnTeShuPai: function _showGongXiNiAndBtnTeShuPai() {
        /*如果有特殊牌*/
        if (TESHUPAITYPE.isTeShuPai) {
            if (TESHUPAITYPE.isQingLong) {
                this._gongXiNiShow(true, "同花十三水");
                this._sanTongHua = true;
            } else if (TESHUPAITYPE.isYiTiaoLong) {
                this._gongXiNiShow(true, "十三水");
                this._yiTiaoLong = true;
            } else if (TESHUPAITYPE.isLiuDuiBan) {
                this._gongXiNiShow(true, "六对半");
                this._liuDuiBan = true;
            } else if (TESHUPAITYPE.isSanShunZi) {
                this._gongXiNiShow(true, "三顺子");
                this._sanShunZi = true;
            } else if (TESHUPAITYPE.isSanTaoHua) {
                this._gongXiNiShow(true, "三同花");
                this._sanTongHua = true;
            }
            //else if(TESHUPAITYPE.isSanTongHuaShun){
            //    this._gongXiNiShow(true);
            //    this._SanTongHuaShun = true;
            //}
            //else if(TESHUPAITYPE.isSanFenTianXia){
            //    this._gongXiNiShow(true);
            //    this._SanFenTianXia = true;
            //}
            //else if(TESHUPAITYPE.isCouYiSe){
            //    this._gongXiNiShow(true);
            //    this._CouYiSe = true;
            //}
            //else if(TESHUPAITYPE.isSiTaoSanTiao){
            //    this._gongXiNiShow(true);
            //    this._SiTaoSanTiao = true;
            //}
            //else if(TESHUPAITYPE.isWuDuiSanTiao){
            //    this._gongXiNiShow(true);
            //    this._WuDuiSanTiao = true;
            //}
            else {
                    this._gongXiNiShow(false);
                }
        }
        //this._initTeShuPaiSprite();
    },

    /*#####控制特殊牌精灵的显示*/
    _initTeShuPaiSprite: function _initTeShuPaiSprite() {
        /*把所有的特殊牌精灵都隐藏掉*/
        //for(var i=0;i<this.teshupai_min.length;i++){
        //    this.teshupai_min[i].active = false;
        //    this.teshupai_max[i].active = false;
        //}
        ///*如果是一条龙，就显示一条龙的精灵*/
        //if(this._yiTiaoLong){
        //    this.teshupai_min[3].active = true;
        //    this.teshupai_max[3].active = true;
        //}
        ///*如果是六对半就显示六对半的精灵*/
        //else if(this._liuDuiBan){
        //    this.teshupai_min[0].active = true;
        //    this.teshupai_max[0].active = true;
        //}
        ///*如果是三顺子就显示三顺子的精灵*/
        //else if(this._sanShunZi){
        //    this.teshupai_min[1].active = true;
        //    this.teshupai_max[1].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._sanTongHua){
        //    this.teshupai_min[2].active = true;
        //    this.teshupai_max[2].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._QingLong){
        //    this.teshupai_min[4].active = true;
        //    this.teshupai_max[4].active = true;
        //}_gongXiNiShow
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SanTongHuaShun){
        //    this.teshupai_min[5].active = true;
        //    this.teshupai_max[5].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SanFenTianXia){
        //    this.teshupai_min[6].active = true;
        //    this.teshupai_max[6].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._CouYiSe){
        //    this.teshupai_min[7].active = true;
        //    this.teshupai_max[7].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SiTaoSanTiao){
        //    this.teshupai_min[8].active = true;
        //    this.teshupai_max[8].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._WuDuiSanTiao){
        //    this.teshupai_min[9].active = true;
        //    this.teshupai_max[9].active = true;
        //}
    },

    /*#####*/
    //显示gongXiNi 页面和teShuPai
    clickGongXiNiShow: function clickGongXiNiShow() {
        this.cardTypeCombineNode.scale = 1;
        var nodes = this.gongXiNi.getChildByName("bg");
        nodes.opacity = 0;
    },

    _gongXiNiShow: function _gongXiNiShow(statues) {
        var test = arguments.length <= 1 || arguments[1] === undefined ? "" : arguments[1];

        //var alterCom = this.gongXiNi.getComponent("alert");
        var alterCom = this.gongXiNi.getComponent('alert');
        alterCom.unscheduleAllCallbacks();
        test = "是否按特殊牌型[" + test + "]出牌？" + "\n" + "(取消后点击左下角可再报道)";
        alterCom.setMessage(test);
        if (statues) {
            alterCom.alert();
        } else {
            alterCom.dismissAction();
        }
        this.teShuPai.active = statues;
        var nodes = this.teShuPai.getChildByName("btnTeshupai");
        nodes.children[0].runAction(cc.repeatForever(cc.rotateBy(1, -360)));
        nodes.children[1].runAction(cc.repeatForever(cc.rotateBy(1, 360)));
    },
    /*#####*/

    //  结果相关
    // 显示一局结果
    _showOneGameResult: function _showOneGameResult() {
        /**/
        this._isComparingCardsNow = false;
        /**/
        this.updateGameStatus(GAMESTATUS.WAIT_PEOPLE);
        //let oneGameResult = this.oneGameResult.getComponent('GameResult');
        //oneGameResult.unscheduleAllCallbacks();
        //oneGameResult.showResults(this._deskInfo, this._userId);
        this._updateUserScores();
        //this._updateBanker();
        //
        var self = this;
        this.scheduleOnce(function () {
            //self._playerComponents.forEach(function (playerComp) {
            //  //playerComp.reset();
            //  //playerComp.reset2();  //#####
            //});

            if (!self._isRandomRoom()) {
                //if (self._deskInfo.cIndex == 0) {//一局还没开始
                //    self.btnReady.node.active = true;
                //}
                if (self._isTotalGameOver()) {
                    self._showTotalGameResult();
                }
            }
        }, 0.5);

        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.scheduleOnce(function () {
                oneGameResult.getComponent('alert').dismissAction();
                cc.director.loadScene('hall');
            }, 2);
            return true;
        }
    },

    // 显示总结果
    _showTotalGameResult: function _showTotalGameResult() {
        var showDelay = arguments.length <= 0 || arguments[0] === undefined ? 2 : arguments[0];

        this.timeStop();
        //cc.find("Canvas/show_result").active = false;
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.alertAnsowerExitNode.active = false;
        this.alertRequestExitNode.active = false;
        if (this._deskInfo.cIndex == this._deskInfo.mMax) {
            this.againBtn.active = true;
        } else {
            this.againBtn.active = false;
        }

        var totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');
        if (totalGameResultComp.node.active) {
            return;
        }

        if (this._bigRecordInfo == null) {
            this._bigRecordInfo = this._deskInfo.players;
        }
        totalGameResultComp.setPlayerInfos(this._bigRecordInfo, this._deskInfo);

        var alert = this.totalGameResult.getComponent('alert');
        this.scheduleOnce((function () {
            //this.oneGameResult.active = false;
            //alert.alert();
            /**/
            if (!this.totalGameResult.active) {
                alert.alert();
            }
            /**/
        }).bind(this), showDelay);

        alert.setDismissCallback(function () {
            Socket.sendOnceAgain('false', this._userId);
            //cc.director.loadScene('hall');
        });
    },
    clickAgain: function clickAgain() {
        Socket.sendOnceAgain('true', this._userId);
    },

    // MARK: Socket 相关
    _loadDeskInfo: function _loadDeskInfo() {
        Socket.sendGetDesckInfo(this._userId);
    },
    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveOnlineStatus, this._socketReciveOnlineStatus, this);
        KQGlobalEvent.on(Socket.Event.ReceiveChatText, this._socketReciveChatTextMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveChatEmoji, this._socketReciveChatEmojiMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolve, this._socketReceiveRequestExitMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolveResult, this._socketReceiveRequestExitResultMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveAudioMessage, this._socketReceiveAudioMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceivePlayCard, this._socketReceivePlayCard, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGameOver, this._socketReceiveGameOver, this);
        KQGlobalEvent.on(Socket.Event.ReceiveFaPai, this._socketReciveFaPai, this);
        KQGlobalEvent.on(Socket.Event.ReceiveReady, this._socketReciveReady, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDissolveDesk, this._socketReceiveDissolveDesk, this);
        KQGlobalEvent.on(Socket.Event.ReceiveLeaveDesk, this._socketLeaveDesk, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._receiveSocketConnectError, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._receiveSocketConnectSuccessed, this);
        KQGlobalEvent.on(Socket.Event.ReceivePause, this._socketReceivePause, this);
        KQGlobalEvent.on(Socket.Event.ReceiveSelectBeiLv, this._ReceiveSelectBeiLv, this);
        KQGlobalEvent.on(Socket.Event.ReceiveBeiLv, this._ReceiveBeiLv, this);
        KQGlobalEvent.on(Socket.Event.ReceiveQingLi, this._ReceiveQingLi, this);
        KQGlobalEvent.on(Socket.Event.ReceiveOnceAgain, this._ReceiveOnceAgain, this);
    },

    _ReceiveOnceAgain: function _ReceiveOnceAgain(response) {
        var _this3 = this;

        /**
         * 再来一局
         * 总结果要隐藏掉
         * 比牌要隐藏掉
         * 发牌要显示
         */
        this._playedCompareCardsIndexs = [];
        this.playerComps.forEach(function (playerComp) {
            playerComp.playedCompareCardsIndexs = _this3._playedCompareCardsIndexs;
        });
        var data = response.data;
        if (!data.reason) {
            this.totalGameResult.active = false;
            this.startCompareCardsNode.active = false;
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset(); //#####
            });
            this._socketReceiveDeskInfo(response);
        } else {
            var now = Date.now();
            if (now - this._nowTimeAgain > 1500) {
                this._nowTimeAgain = now;
                this.alertAnsowerExitResult.y = -143;
                this.alertAnsowerExitResult.opacity = 255;
                this.alertAnsowerExitResult.children[0].getComponent(cc.Label).string = '房卡不足';
                var action = cc.spawn(cc.moveTo(0.3, cc.p(0, 20)), cc.fadeOut(0.3));
                this.alertAnsowerExitResult.runAction(cc.sequence(cc.moveTo(1, cc.p(0, 0)), action));
            }
        }
    },

    _ReceiveSelectBeiLv: function _ReceiveSelectBeiLv() {
        if (this._deskInfo.createId != this._userId) {
            this.beilv.active = true;
            var B3 = this.beilv.getChildByName('bg').getChildByName('btn3').getComponent(cc.Button);
            if (this._deskInfo.setting5 == 1) {
                /**
                 * 庄家选择两倍的时候 3倍按钮是不能响应的
                 * 选择三倍不用管，全部显示，
                 * 选择一倍也不用管，直接发牌，
                 */
                B3.interactable = false;
            }
            var selectBl = this.beilv.getComponent('selectBeilv');
            selectBl._userid = this._userid;
        }
    },

    _ReceiveBeiLv: function _ReceiveBeiLv(response) {
        var userId = response.data.userId;
        var bl = response.data.beilv;
        this._playerComponents.forEach(function (player) {
            player.showBeilv(userId, bl);
        });
    },

    _ReceiveQingLi: function _ReceiveQingLi(response) {
        var leaveId = response.data.leaveId;
        if (leaveId == this._userId) {
            if (cc.qingli == null) {
                var ql = response.action;
                cc.qingli = '';
                cc.qingli = ql;
            }
            cc.director.loadScene('hall');
        }
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        var data = response.data;

        this._initPlayerComponents(data.playersIndexAyy);
        /*#####添加五同按钮*/
        // cc.moshi = 0;

        // if(data.setting3[1] == true) cc.moshi = 1;  //  ？？？

        cc.maPai = null;

        if (data.maPai.length == 2) cc.maPai = data.maPai[0] + "_" + data.maPai[1];

        cc.huaSe = data.setting3[2];

        cc.chaoShiChuPai = data.setting6;

        cc.duoYiSe = response.data.setting2; //setting2为 4~7 人（0~3）

        this._deskInfo = data;
        this._globalMsg(data);
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(data.roomId);
        this.needCard.string = data.needCard; // 开放需要的房卡
        var playerIndexs = data.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._updateUserScores();
        this._updateBanker();
        this._msgControl.addPlayerInfos(this._playerInfos);

        var currentUserInfo = players.find((function (playerInfo) {
            return playerInfo.id == this._userId;
        }).bind(this));

        if (data.createId == this._userId) {
            if (data.cIndex > 0) {
                // 开始游戏了，请离按钮全部隐藏
                this._playerComponents.forEach(function (player) {
                    player.showQingli(false, data.cIndex);
                });
            } else {
                // 游戏没开始，房主的请离按钮不显示
                this._playerComponents.forEach(function (player) {
                    if (data.createId == player.userId) {
                        // 我是房主，不显示我的请离按钮
                        player.showQingli(true, data.cIndex);
                    } else {
                        player.showQingli(false, data.cIndex);
                    }
                });
            }
        }

        this._playerComponents.forEach(function (player) {
            if (data.createId == player.userId) {
                //显示房主
                player.showFangZhuStatus(data.createId, true);
            } else {
                player.showFangZhuStatus(player.userId, false);
            }
        });

        if (this._deskInfo.createId != this._userId) {
            // 非庄家
            if (this._deskInfo.cIndex == 0) {
                // 如果还没开始游戏，显示退出按钮，隐藏解散按钮
                this.exit.active = true;
                this.Dissolve.active = false;
            } else {
                // 反之
                this.exit.active = false;
                this.Dissolve.active = true;
            }
        } else {
            // 庄家
            if (this._deskInfo.cIndex > 0) {
                // 开局了 隐藏退出按钮
                this.exit.active = false;
                this.Dissolve.active = true;
            } else {
                // 没开局 两个都显示
                this.exit.active = true;
                this.Dissolve.active = true;
            }
        }

        if (!this._deskInfo.isCBegin) {
            this._gameStatus = GAMESTATUS.WAIT_READY;
        }
        for (var i = 0; i < players.length; i++) {
            var s = players[i];
            var is = s.readyStatus; //true/false
            var userId = s.id;
            this._playerComponents.forEach((function (player) {
                if (!this._deskInfo.isCBegin) player.showReadyStatus(userId, is);
            }).bind(this));
        }
        if (currentUserInfo && currentUserInfo.cards.length > 0 && this._deskInfo.isCBegin) {
            if (!currentUserInfo.cardInfo.length) {
                this._startGame(true);
            } else {
                this._startGame(false);
            }
        } else if (UserModelHelper.isPlayedCards(currentUserInfo) && !this._deskInfo.isCBegin) {
            this._socketReceiveGameOver(response);
        }
        this.isReadyStatus();
        this._handleUpdateDeskInfoAboutExitRoom(this._deskInfo);
        this.showCompareCard();
    },

    showCompareCard: function showCompareCard() {
        if (this._deskInfo.cIndex == 0 || this._deskInfo.isCBegin || !this._deskInfo.players || this._deskInfo.players.length <= 0 || this._deskInfo.players[0].cardInfo <= 0) {
            return;
        }

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        this.unscheduleAllCallbacks();

        this.node.stopAllActions();

        this._playerComponents.forEach(function (playerComp) {
            playerComp.readyToCompareCards();
        });

        this._playerComponents.forEach((function (player) {

            if (player.node.active) player.showAllCompareCards(this._deskInfo.players);
        }).bind(this));

        this.startCompareCardsNode.active = false;

        this._isComparingCardsNow = false;

        this.isReadyStatus();

        this.scheduleOnce((function () {

            if (this._isTotalGameOver()) this._showTotalGameResult();
        }).bind(this), 0.5);
    },

    _socketReciveFaPai: function _socketReciveFaPai(response) {
        //  发牌了开始比牌隐藏掉
        this.startCompareCardsNode.active = false;
        this.timeStop();
        this._isComparingCardsNow = true;
        this._gameStatus = GAMESTATUS.WAIT_READY;
        this._socketReceiveDeskInfo(response);
    },
    logoutAction: function logoutAction() {
        cc.director.loadScene('login');
        //manager.setUserInfo('');
        //hall.cacheImageInfo = null;
    },
    _socketReciveOnlineStatus: function _socketReciveOnlineStatus(response) {
        //{"action":"sendOnlineStatus","result":true,"data":{"userId":100049,"status":1}}
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }

        var data = response.data;
        var userId = data.userId;
        var status = data.status;

        this._playerComponents.forEach(function (player) {
            player.setUserOnlineStatus(userId, status);
        });
    },

    _socketReciveChatTextMessage: function _socketReciveChatTextMessage(response) {
        var userId = response.data.userId;
        var message = response.data.msg;

        this._playerComponents.forEach(function (player) {
            player.showChatText(userId, message);
        });

        this._msgControl.addChatTextMessage(userId, message);

        var sex = this._playerInfos.find(function (user) {
            return user.id == userId;
        }).sex;
        AudioManager.instance.playChatAudio(sex, message);
    },
    _socketReciveChatEmojiMessage: function _socketReciveChatEmojiMessage(response) {
        var userId = response.data.userId;
        var emoji = response.data.emoji;

        //this._playerComponents.forEach(function (player) {
        //    player.showChatText(userId, emoji);
        //});
        //this._msgControl.addChatEmojiMessage(userId, emoji);
        this._msgControl._loadEmojiFrame(emoji, (function (frame) {
            this._playerComponents.forEach(function (player) {
                if (player.userId == userId) player.chatMessageNode.getComponent('ChatMessage').showEmoji(frame);
            });
        }).bind(this));
    },

    _socketReceiveRequestExitMessage: function _socketReceiveRequestExitMessage(response) {
        //if (response.data.userId == this._userId) {
        //    return;
        //}

        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");

        var btnAgree = alert_bg.getChildByName("btnAgree");

        var btnDisagree = alert_bg.getChildByName("btnDisagree");

        btnAgree.active = true;

        btnDisagree.active = true;

        var dataInfos = response.data.info;

        if (!this.alertAnsowerExitNode.active) {

            var alertComp = this.alertAnsowerExitNode.getComponent('alert');

            alertComp.alert();

            alertComp.unscheduleAllCallbacks();

            this.contentAnsowerExitNode.children.forEach(function (i) {
                i.active = false;
            });

            this._playerInfos.forEach((function (playerInfo, index) {

                var play = this.contentAnsowerExitNode.children[index];

                var name = play.getChildByName("nickname");

                var back = play.getChildByName("fanzhu");

                var img = play.getChildByName("avatar_bg");

                play.active = true;

                name.getComponent(cc.Label).string = playerInfo.nickname;

                if (this._deskInfo.createId == playerInfo.id) {
                    //显示房主

                    back.active = true;
                } else {

                    back.active = false;
                }

                cc.loader.load({ url: playerInfo.avatarUrl, type: "jpg" }, (function (err, data) {

                    if (err) return;

                    var frame = new cc.SpriteFrame(data);

                    img.getComponent(cc.Sprite).spriteFrame = frame;
                }).bind(this));
            }).bind(this));

            var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');

            countdown.startCountdown(60, (function (isTimeout) {

                if (isTimeout) {

                    this.clickAgreeOtherPlayerExit();

                    return;
                }
            }).bind(this));
        }

        this._playerInfos.forEach((function (playerInfo, index) {

            var dataInfo = dataInfos[index];

            var play = this.contentAnsowerExitNode.children[index];

            var str = play.getChildByName("id");

            var dataInfo = dataInfos[index];

            if (dataInfo == 1) {

                if (this._userId == playerInfo.id) {
                    //显示房主

                    btnAgree.active = false;

                    btnDisagree.active = false;
                }

                str.getComponent(cc.Label).string = "同意";
            } else {

                str.getComponent(cc.Label).string = "";
            }
        }).bind(this));
    },

    _socketReceiveRequestExitResultMessage: function _socketReceiveRequestExitResultMessage(response) {
        this._hideReqestExitNode();
        if (this.alertAnsowerExitNode.active) {
            this.alertAnsowerExitNode.getComponent('alert').dismissAction();
            this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        }

        if (response.data.result) {
            // 解散成功
        } else {
                var userId = response.data.userId;
                var nickname = this._findPlayerInfoByUserId(userId).nickname;
                this.alertAnsowerExitResult.y = -143;
                this.alertAnsowerExitResult.opacity = 255;
                this.alertAnsowerExitResult.children[0].getComponent(cc.Label).string = nickname + '不同意退出';
                var action = cc.spawn(cc.moveTo(.3, cc.p(0, 20)), cc.fadeOut(this.cardTime));
                this.alertAnsowerExitResult.runAction(cc.sequence(cc.moveTo(1, cc.p(0, 0)), action));

                //this.showAlertMessage('解散失败，因为' + nickname + '不同意退出');
            }
    },

    _socketReceiveAudioMessage: function _socketReceiveAudioMessage(response) {
        var userId = response.data.userId;
        this.playSpeakAnimation(userId);

        if (userId == this._userId) {
            return;
        }

        var url = response.data.url;
        this.playAudioUrl(url);
    },

    _socketReceivePlayCard: function _socketReceivePlayCard(response) {
        // 有用户已经准备好了牌
        var userId = response.data[0].userId;
        var cardInfo = response.data[1].card;
        this._deskInfo = response.data[2].s;
        var players = response.data[2].s.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._playerComponents.forEach(function (player) {
            player.playCard(userId, cardInfo);
        });

        if (userId == this._userId) {
            this.cardTypeCombineNode.active = false;
        }
    },
    _getSelfReadyStatus: function _getSelfReadyStatus() {
        var self = this._findPlayerInfoByUserId(this._userId);
        return self.readyStatus;
    },
    _socketReciveReady: function _socketReciveReady(response) {
        var userId = response.data.userId;
        this._playerComponents.forEach((function (player) {
            if (!this._deskInfo.isCBegin) player.showReadyStatus(userId);
        }).bind(this));
    },

    //收到游戏结束
    _socketReceiveGameOver: function _socketReceiveGameOver(response) {
        this.timeStop();
        cc.sys.localStorage.removeItem("timestamp");

        this._hideReqestExitNode();

        // 一局游戏结束
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        /**/
        var deskInfo = response.data;
        if (response.action == 'gameOver' && deskInfo.isDeskOver) {

            Socket.sendDidReceiveGameOverAction(this._userId);
        }
        /**/
        this._deskInfo = response.data;

        // 如果是强制解散房间，则直接显示总成绩
        if (this._isDissvledRoom() && !Playback.instance.isPlaybacking()) {
            this._showTotalGameResult(0.1);
            return;
        }

        if (Date.now() - this._enterTime < 1000 * 4) {
            // 刚进来的话，不展示比牌动画
            //  let oneGameResult = this.oneGameResult.getComponent('GameResult');
            //  oneGameResult.unscheduleAllCallbacks();
            //  oneGameResult.showResults(this._deskInfo, this._userId);
            this.isReadyStatus();
            this.btnShare.node.active = false;
            this.btnReady.node.active = true;
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
            /**/
            this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
            /**/
            return;
        }

        var data = response.data;
        this._deskInfo = data;
        this._bigRecordInfo = data.bigRecordInfo;
        //console.log(data);
        //console.log("-----------------------------------1709");
        this._updatGameOverview(this._deskInfo);
        //let playerIndexs = data.playersIndex; // [100049]

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        //this._updateRecordInfo(players);

        if (UserModelHelper.isUserReady(this._findCurrentUserInfo())) {
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
        } else {
            this._startCompareCards(response);
        }

        if (Date.now() - this._enterTime < 1000 * 4) {
            this.showCompareCard();
            return;
        }
    },
    // _updateRecordInfo:function(players){

    //     // this._bigRecordInfo.push();
    // },
    _socketReceiveDissolveDesk: function _socketReceiveDissolveDesk(response) {
        this.cardTypeCombineNode.active = false;
        cc.director.loadScene('hall');

        // this.alert.getComponent('alert').setWillDismissCallback(function(){

        //   return true;
        // });

        // let message = "房主已解散房间";
        // if (this._isRandomRoom()) {
        //   message = "有玩家已强制退出房间，游戏结束。本局游戏不会扣除您的钻石。";
        // }

        // this.showAlertMessage(message, false);
    },
    /**/
    _socketLeaveDesk: function _socketLeaveDesk(response) {
        if (!response.result) {
            return;
        }

        if (this._deskInfo.isDeskOver) {
            // 如果房间已结束，也不用再自动退回到大厅了
            return;
        }

        cc.director.loadScene('hall');
    },
    /**/
    // socket 收到有人手机进入后台消息
    _socketReceivePause: function _socketReceivePause(response) {
        if (!response.result) {
            return;
        }

        var userId = response.data.userId;
        this._playerComponents.forEach(function (player) {
            if (player.userId == userId) {
                player.setUserOnlineStatus(userId, 0);
            }
        });
    },

    _receiveSocketConnectError: function _receiveSocketConnectError(response) {
        this.showNetworkMessage();
    },

    _receiveSocketConnectSuccessed: function _receiveSocketConnectSuccessed(response) {
        this.hiddenNetworkMessage();

        if (!Playback.instance.isPlaybacking()) {
            this._loadDeskInfo();
        }
    },
    /**/
    // MARK: 更新房间信息
    updateDeskInfo: function updateDeskInfo(deskInfo) {
        this._deskInfo = deskInfo;
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(deskInfo.roomId);

        var playerIndexs = deskInfo.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = deskInfo.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._msgControl.addPlayerInfos(this._playerInfos);
        if (deskInfo.cIndex == 0 && this._deskInfo.players.length < this._deskInfo.maxNumber) {
            this.btnShare.node.active = true;
        }
    },
    /**/
    _injectUserIdToPlayerComponents: function _injectUserIdToPlayerComponents(playerIndexs) {
        var currentUserIdIndex = playerIndexs.findIndex((function (userId) {
            return userId == this._userId;
        }).bind(this));

        var fixedPlayerIndexs = playerIndexs.translationWithStartIndex(currentUserIdIndex);
        this._playerComponents.forEach(function (playerComponent, index) {
            var userId = fixedPlayerIndexs.length > index ? fixedPlayerIndexs[index] : null;
            playerComponent.userId = userId;
        });
    },

    _updateUserInfos: function _updateUserInfos(userInfos) {
        var self = this;
        this._playerComponents.forEach(function (playerComponent, index) {
            //playerComponent.setDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateUserInfoWithUsers(userInfos);
        });

        //this._handleTheSameOfIPAdress(userInfos);
    },

    _updateUserScores: function _updateUserScores(userInfos) {
        this._playerComponents.forEach(function (player) {
            player.updateScore();
        });
    },

    _updateBanker: function _updateBanker() {
        this._playerComponents.forEach(function (player) {
            player.updateBanker();
        });
    },

    // 私有方法
    _findCardsByUserId: function _findCardsByUserId(userId) {
        var player = this._findPlayerInfoByUserId(userId);

        return player != null ? player.cards : null;
    },

    _findPlayerInfoByUserId: function _findPlayerInfoByUserId(userId) {
        var player = (this._playerInfos || []).find(function (playerInfo) {
            return userId == playerInfo.id;
        });

        return player;
    },

    _findPlayerIndexByUserId: function _findPlayerIndexByUserId(userId) {
        //let index = this._playerComponents.findIndex(function (playerComp) {
        //    return playerComp.userId == userId;
        //});
        var index = this.playerNodes.findIndex(function (node) {
            return node.getComponent('Player').userId == userId;
        });
        return index;
    },

    _findCurrentUserInfo: function _findCurrentUserInfo() {
        return this._findPlayerInfoByUserId(this._userId);
    },

    _convertCardsToCardNames: function _convertCardsToCardNames(cards) {
        // [{"suit":"s","number":10}]
        var suitColorMap = {
            s: 4,
            h: 3,
            c: 2,
            d: 1
        };
        return cards.map(function (card) {
            var cardNumber = card.number;

            // 服务器中的 14 是 A
            if (card.number == 14) {
                cardNumber = 1;
            }
            var color = suitColorMap[card.suit];
            var number = Math.max(Math.min(cardNumber, 21), 1);
            return color + "_" + number;
        });
    },

    // 更新游戏总览信息
    _updatGameOverview: function _updatGameOverview(deskInfo) {
        if (Playback.instance.isPlaybacking()) {
            this.labelOverview.string = "回放";
            return;
        }

        if (this._isRandomRoom()) {
            this.labelOverview.string = "";
            return;
        }
        var bihuase = "不比花色 ";
        var zuozhuang = "不坐庄 ";
        var putong = "普通场 ";
        var wugui = "无鬼 ";
        var maPai = '不买马 ';
        var renshu = "4人不加色 ";
        var card = "平摊";

        //[疯狂场,鬼牌,比花色,坐庄,马牌]
        if (this._deskInfo.setting3[2]) {
            bihuase = "比花色  ";
        }
        if (this._deskInfo.setting3[3]) {
            zuozhuang = "坐庄 ";
        }
        if (this._deskInfo.setting3[0]) {
            putong = "疯狂场  ";
        }
        if (this._deskInfo.setting3[1]) {
            wugui = "有鬼  ";
        }
        if (this._deskInfo.setting3[4]) {
            maPai = "买马";
            var huaSe = "方块";
            var dianShu = 1;
            switch (this._deskInfo.setting7[0]) {//setting7 [1~4,1~13] 表示 [花色，点数]
                case 1:
                    huaSe = "方块";break;
                case 2:
                    huaSe = "梅花";break;
                case 3:
                    huaSe = "红心";break;
                case 4:
                    huaSe = "黑桃";break;
            }
            switch (this._deskInfo.setting7[1]) {
                case 1:
                    dianShu = 'A';break;
                case 2:
                    dianShu = 2;break;
                case 3:
                    dianShu = 3;break;
                case 4:
                    dianShu = 4;break;
                case 5:
                    dianShu = 5;break;
                case 6:
                    dianShu = 6;break;
                case 7:
                    dianShu = 7;break;
                case 8:
                    dianShu = 8;break;
                case 9:
                    dianShu = 9;break;
                case 10:
                    dianShu = 10;break;
                case 11:
                    dianShu = 'J';break;
                case 12:
                    dianShu = 'Q';break;
                case 13:
                    dianShu = 'K';break;
            }
            maPai = huaSe + dianShu + maPai;
        }

        if (this._deskInfo.setting2 == 1) {
            renshu = "5人加一色 ";
        } else if (this._deskInfo.setting2 == 2) {
            renshu = "6人加二色 ";
        } else if (this._deskInfo.setting2 == 3) {
            renshu = "7人加三色 ";
        }
        if (this._deskInfo.setting4 == 1) {
            card = "赢者扣 ";
        } else if (this._deskInfo.setting4 == 2) {
            card = "房主扣 ";
        }

        this.labelOverview.string = "模式 : " + bihuase + zuozhuang + putong + wugui + maPai + "\n" + "其他：" + renshu + card;
        //this.labelOverview.string = "模式 : " + "" + deskInfo.maxNumber + "人" +bihuase+zuozhuang+putong+wugui+maPai;
    },

    // 是否是随机房
    _isRandomRoom: function _isRandomRoom() {
        if (this._deskInfo == null) {
            return true;
        }

        return this._deskInfo.isRandomDesk;
    },

    // 是否所有局数都用完了
    _isTotalGameOver: function _isTotalGameOver() {
        if (this._deskInfo == null) {
            return false;
        }

        if (this._deskInfo.isDeskOver) {
            return true;
        }

        return this._deskInfo.mMax <= this._deskInfo.cIndex;
    },

    // 是否已解散房间
    _isDissvledRoom: function _isDissvledRoom() {
        if (this._deskInfo) {
            return this._deskInfo.dissolveStatus;
        }

        return false;
    },

    _startCompareCards: function _startCompareCards(data) {
        this._isComparingCardsNow = true;
        this._gongXiNiShow(false);
        this._players = data.data.players;
        var user = this._findPlayerInfoByUserId(this._userId);
        if (!this.totalGameResult.active) {
            AudioManager.instance.playStartCompare(user.sex);
        }

        this.startCompareCardsNode.getComponent('alert').alert();
        this._playerComponents.forEach(function (playerComp) {
            playerComp.readyToCompareCards();
        });
        this.unscheduleAllCallbacks();
        this.scheduleOnce((function () {
            this.startCompareCardsNode.active = false;
            this._showCompareCardDetails(data);
        }).bind(this), 1.0);
    },

    _showCompareCardDetails: function _showCompareCardDetails(data) {

        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset();
            playerComp.readyToCompareCards();
        });

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');

        cardTypeCombine.reset();

        cardTypeCombine.node.active = false;

        var comparePlayers1 = this._playerComponents.filter(function (player) {

            if (player.node.active) {

                var user = player.compareCardsNode.getComponent('CompareCards')._user;

                if (!user.isContainExtra) return player.node.active;
            }
        });

        var teShuPlayers = this._playerComponents.filter(function (player) {

            if (player.node.active) {

                var user = player.compareCardsNode.getComponent('CompareCards')._user;

                if (user.isContainExtra) return player.node.active;
            }
        });
        var self = this;
        var duration = this._showCompareCardStep(0, comparePlayers1);

        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers1);
        }, duration);

        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers1);
        }, duration * 2);

        if (teShuPlayers.length > 0) {
            this.scheduleOnce(function () {
                self._showCompareCardStep(0, teShuPlayers, true);
            }, duration * 3);
        }

        duration = duration * 3 + 0.5;

        for (var i = 0; i < teShuPlayers.length; i++) {

            var user = teShuPlayers[i].compareCardsNode.getComponent('CompareCards')._user;

            if (user.isContainExtra) duration = duration + 2.5;
        }

        var shootDuration = this.headCardTime;

        var shootDatas = this._shootDatas() || [];

        var shotData = this._shotData() || [];

        var homeRunUserId = this._homeRunUserId();

        var shotDataTimes = 0;

        shotData.forEach(function (data, index) {

            self.scheduleOnce(function () {

                self.playShoot(data.fromUserId, data.toUserId);
            }, duration + index * shootDuration);

            shotDataTimes += self.headCardTime;

            duration += self.headCardTime;
        });

        if (homeRunUserId.length >= 1) {

            shootDatas.forEach(function (data, index) {

                self.scheduleOnce(function () {

                    self.playShoot(data.fromUserId, data.toUserId);
                }, duration + (index + shotDataTimes) * shootDuration);

                duration += self.headCardTime;
            });
        }

        duration = duration + shootDatas.length * shootDuration + shotData.length * shootDuration;

        if (homeRunUserId > 0) {

            self.scheduleOnce(function () {
                self.playHomeRun(homeRunUserId);
            }, duration);

            duration = duration + 1;
        }

        if (homeRunUserId) {
            duration = duration + 1;
        }

        //this.scheduleOnce(function () {this._jinBiAction();}.bind(this), duration);//显示结算金币//显示结果
        this._jinBiAction(duration);
        //this.scheduleOnce(function () {
        //
        //    this._playerComponents.forEach(function (playerComp) {playerComp.showScoreResult();});
        //
        //    self._showCompareCardFinished();
        //
        //}.bind(this), duration);
    },

    _jinBiAction: function _jinBiAction(duration) {
        var comparePlayers1 = this._playerComponents.filter(function (player) {
            return player.node.active;
        });

        var nextTime = 0; //下一个动作开始的时间

        var zTime = 0; //下下一个动作开始的时间

        var start = 0;

        var end = 0;

        var coinsContainerAyy = []; //所有的用户的金币 一个用户一个数组

        var coinsAyy = []; //所有的金币，一个数组

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        comparePlayers1.forEach((function (plays, index) {
            //根据积分创建金币

            var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

            if (cScore < 0) {

                cScore *= -1;

                var node = new cc.Node();

                node.name = "coinsContainer";

                var numScore = cScore > 30 ? 30 : cScore;
                for (var i = 0; i < numScore; i++) {
                    this._createJinBiPrefab(node, node); //根据积分创建金币
                }

                this.playsCoins[index].addChild(node);

                coinsContainerAyy.push(node.children);
            }
        }).bind(this));

        this.playsCoins.forEach(function (no) {
            if (no) no.active = false;
        });

        this.scheduleOnce((function () {
            //显示结果

            this.playsCoins.forEach(function (no) {
                if (no) no.active = true;
            });

            AudioManager.instance.coinIncome();

            coinsContainerAyy.forEach((function (coinsAyys) {
                //把金币移动到容器

                var initTime = 0;

                var interval = 0.002;

                coinsAyys.forEach((function (coins) {
                    //把金币移动到容器

                    var y = Math.round(Math.random()) == 0 ? -1 : 1;

                    y = Math.floor(Math.random() * 38) * y;

                    var x = Math.round(Math.random()) == 0 ? -1 : 1;

                    x = Math.floor(Math.random() * 38) * x;

                    var cardBackWorldSpace1 = this.node.convertToWorldSpaceAR(cc.v2(x, y));

                    var v2 = coins.convertToNodeSpaceAR(cardBackWorldSpace1);

                    this.scheduleOnce(function () {

                        coins.runAction(cc.moveBy(0.2, v2));
                    }, initTime);

                    initTime = initTime + interval;
                }).bind(this));

                nextTime = initTime;

                coinsAyy = coinsAyy.concat(coinsAyys); //把金币集合到一个数组
            }).bind(this));

            var zcScore = 0;

            comparePlayers1.forEach((function (plays) {
                //计算金币

                var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

                cScore = cScore > 30 ? 30 : cScore;

                if (cScore > 0) zcScore += cScore * 1;
            }).bind(this));

            var coinsAyy1 = coinsAyy.splice(zcScore, coinsAyy.length);

            coinsAyy1.forEach(function (node) {
                node.parent.removeChild(node);
            });

            comparePlayers1.forEach((function (plays) {
                //把金币到用户头像附近

                var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

                if (cScore > 0) {

                    var interval = 0.0025;

                    var initTime = nextTime + 1;

                    var numScore = cScore > 30 ? 30 : cScore;

                    //end += numScore;

                    coinsAyy.splice(0, numScore).forEach((function (coinsNode) {
                        //把金币到用户头像附近

                        this.scheduleOnce(function () {

                            //获取节点的世界坐标
                            var cardBackWorldSpace1 = plays.node.convertToWorldSpaceAR(cc.v2(0, 0));
                            //获取相对父节点所在的坐标
                            var detail = coinsNode.convertToNodeSpaceAR(cardBackWorldSpace1);

                            var moveBy = cc.moveBy(0.25, detail);

                            var nextFadeIn = cc.fadeOut(0.13);

                            var moveSeq = cc.sequence(moveBy, nextFadeIn);

                            coinsNode.runAction(moveSeq);
                        }, initTime);

                        initTime = initTime + interval;
                    }).bind(this));

                    //start += cScore;

                    zTime = initTime;
                }
            }).bind(this));

            this.scheduleOnce((function () {
                //显示结果

                //this.playsCoins.forEach(function(no){if(no) no.active = false;});

                this._showCompareCardFinished();

                comparePlayers1.forEach(function (playerComp) {
                    playerComp.showScoreResult();
                });
            }).bind(this), zTime);

            this.scheduleOnce((function () {
                //显示结果

                this.playsCoins.forEach(function (no) {
                    if (no) no.removeAllChildren();
                });
            }).bind(this), zTime + 5);
        }).bind(this), duration);
    },

    _createJinBiPrefab: function _createJinBiPrefab(node, v2Node) {

        var nodes = cc.instantiate(this.coinsPrefab);

        var y = Math.round(Math.random()) == 0 ? -1 : 1;

        y = Math.floor(Math.random() * 38) * y + v2Node.y;

        var x = Math.round(Math.random()) == 0 ? -1 : 1;

        x = Math.floor(Math.random() * 38) * x + v2Node.x;

        nodes.x = x;

        nodes.y = y;

        node.addChild(nodes);
    },

    _showCompareCardStep: function _showCompareCardStep() {
        var startTime = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];
        var comparePlayers = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];
        var isContainExtra = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

        var duration = startTime;
        var interval = this.headCardTime;
        var teshuTime = 0;
        var self = this;

        comparePlayers = comparePlayers.sort(function (player1, player2) {
            return player1.nextCompareScore() - player2.nextCompareScore();
        });

        var co = comparePlayers;
        //console.log(co)
        //console.log('-------------执行了几次')

        co.forEach(function (player) {

            self.scheduleOnce(function () {
                player.showNextCompareCards();
            }, duration + teshuTime);

            duration = duration + interval;
            var user = player.compareCardsNode.getComponent('CompareCards')._user;
            if (user.isContainExtra) {
                if (user.cardInfo[0].type == 10) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._santonghuaAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 11) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._sanshunziAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 12) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._liuduibanAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 18) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._qinglongAniamtion('long');
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 19) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._qinglongAniamtion("ql");
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                }
            }
        });

        if (isContainExtra) {

            for (var i = 0; i < co.length; i++) duration = duration + 2.5;

            this._playerComponents.forEach(function (player) {
                if (player.node.active) {
                    self.scheduleOnce(function () {
                        player.showNextCompareScore(isContainExtra);
                    }, duration - interval);
                }
            });
        } else {
            co.forEach(function (player) {
                self.scheduleOnce(function () {
                    player.showNextCompareScore();
                }, duration - interval);
            });
        }

        return duration + teshuTime;
    },

    _isGameOver: function _isGameOver() {},

    // 比牌完成后会调用的方法
    _showCompareCardFinished: function _showCompareCardFinished() {
        this.timeStart(5, "ready");
        this._showOneGameResult();
        /**/
        this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
        /**/
    },

    //network
    showNetworkMessage: function showNetworkMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? "网络链接断开，重新连接中..." : arguments[0];

        if (this.networkNode && this.networkNode.active) {
            return;
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg, autoDismiss) {
        var alertComp = this.alert.getComponent('alert');
        if (!this.alert.active) {
            alertComp.alert();
        }

        alertComp.setMessage(msg);
        alertComp.unscheduleAllCallbacks();
        if (autoDismiss) {
            alertComp.scheduleOnce(function () {
                alertComp.dismissAction();
            }, 5);
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? '检查网络中...' : arguments[0];

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null && this.checkNode.active) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },

    /////  聊天语音逻辑
    // _registerVoiceNodeEvents: function () {
    //     let self = this;
    //     let chatVoiceNode = this.btnChatVoice.node;
    //     this.endRecordTime = Date.now();
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_START,function(event) {
    //         if (Date.now() - self.endRecordTime >= 1000) {
    //             self.nativeRecordAction();
    //             //self.voiceRecordAnimationNode.active = true;

    //             let action = cc.scaleTo(0.12, 1.2);
    //             self.btnChatVoice.node.runAction(action);

    //             self._isRecording = true;
    //         }
    //     });
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_END,function(event) {
    //         if (self._isRecording) {
    //             self.endRecordTime = Date.now();
    //         }
    //         self._isRecording = false;

    //         self.nativeEndRecordAction();
    //         //self.voiceRecordAnimationNode.active = false;

    //         let action = cc.scaleTo(0.12, 1);
    //         self.btnChatVoice.node.runAction(action);
    //     });
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL,function(event) {
    //         if (self._isRecording) {
    //             self.endRecordTime = Date.now();
    //         }
    //         self._isRecording = false;

    //         self.nativeEndRecordAction();
    //         //self.voiceRecordAnimationNode.active = false;

    //         let action = cc.scaleTo(0.12, 1);
    //         self.btnChatVoice.node.runAction(action);
    //     });
    //     Socket.instance.uploadFinish = function(url) {
    //         let userId = self._userId;
    //         Socket.sendAudioMessage(userId, url);
    //         self.playSpeakAnimation(self._userId);
    //     };
    // },

    _registerVoiceNodeEvents: function _registerVoiceNodeEvents() {
        var self = this;
        var chatVoiceNode = this.btnChatVoice.node;
        this.endRecordTime = Date.now();
        chatVoiceNode.on(cc.Node.EventType.TOUCH_START, function (event) {
            // self.VoiceMsgBgAnimation();
            if (!cc.sys.isNative) {
                var runTime = 0.3;
                var tishi = cc.instantiate(self.autoTishi);
                self.node.addChild(tishi);
                var action = cc.spawn(cc.moveTo(0.3, cc.v2(0, 0)), cc.fadeIn(0.3));
                tishi.runAction(action);
                self.scheduleOnce((function () {
                    var finished = cc.callFunc(function () {
                        tishi.removeFromParent(true);
                    });
                    var action = cc.sequence(cc.spawn(cc.fadeOut(runTime), cc.moveTo(runTime, cc.v2(0, 50))), finished);
                    tishi.runAction(action);
                }).bind(this), 1.5);
                //var url = "www.baidu.com";
                //let userId = self._userId;
                //Socket.sendAudioMessage(userId, url);
            } else {
                    if (Date.now() - self.endRecordTime >= 1000) {
                        self.VoiceMsgBgAnimation();
                        self.nativeRecordAction();
                        var _action = cc.scaleTo(0.12, 1.2);
                        self.btnChatVoice.node.runAction(_action);
                        self._isRecording = true;
                    }
                }
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            self.VoiceMsgBg.active = false;
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            //self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            self.VoiceMsgBg.active = false;
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            //self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        Socket.instance.uploadFinish = function (url) {
            var userId = self._userId;
            Socket.sendAudioMessage(userId, url);
            self.playSpeakAnimation(self._userId);
        };
    },
    VoiceMsgBgAnimation: function VoiceMsgBgAnimation() {
        this.VoiceMsgBg.active = true;
        var whileLayout = this.VoiceMsgBg.getChildByName("whileLayout");
        var childWhile = whileLayout.getChildByName("childWhile");
        if (this.whileLayoutInterval) {
            clearInterval(this.whileLayoutInterval);
        }

        this.whileLayoutInterval = setInterval(function () {
            var node = cc.instantiate(childWhile);
            if (whileLayout.children.length > 5) {
                whileLayout.removeAllChildren();
            }
            whileLayout.addChild(node);
        }, 200);

        var layout = this.VoiceMsgBg.getChildByName("layout");
        var cWhile = layout.getChildByName("while");

        if (this.layoutInterval) {
            clearInterval(this.layoutInterval);
        }

        this.layoutInterval = setInterval(function () {
            var node = cc.instantiate(cWhile);
            if (layout.children.length > 3) {
                layout.removeAllChildren();
            }
            layout.addChild(node);
        }, 300);
    },
    nativeRecordAction: function nativeRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
            AudioManager.instance.pauseMusic();
        }
    },

    nativeEndRecordAction: function nativeEndRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
            AudioManager.instance.resumeMusic();
        }
    },

    playAudioUrl: function playAudioUrl(url) {
        //console.log("---------------------------2553");
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", url);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", url);
        }
    },

    // MARK:  退出游戏逻辑
    _handleUpdateDeskInfoAboutExitRoom: function _handleUpdateDeskInfoAboutExitRoom(deskInfo) {
        if (!deskInfo.isDissolving) {
            return;
        }
        var dataInfos = deskInfo.dissolveAnswerInfo;

        var alertComp = this.alertAnsowerExitNode.getComponent('alert');

        alertComp.alert();

        alertComp.unscheduleAllCallbacks();

        this.contentAnsowerExitNode.children.forEach(function (i) {
            i.active = false;
        });

        this._playerInfos.forEach((function (playerInfo, index) {

            var play = this.contentAnsowerExitNode.children[index];

            var name = play.getChildByName("nickname");

            var back = play.getChildByName("fanzhu");

            var img = play.getChildByName("avatar_bg");

            var str = play.getChildByName("id");

            var dataInfo = dataInfos[index];

            play.active = true;

            name.getComponent(cc.Label).string = playerInfo.nickname;

            if (this._deskInfo.createId == playerInfo.id) {
                //显示房主

                back.active = true;
            } else {

                back.active = false;
            }

            cc.loader.load({ url: playerInfo.avatarUrl, type: "jpg" }, (function (err, data) {

                if (err) return;

                var frame = new cc.SpriteFrame(data);

                img.getComponent(cc.Sprite).spriteFrame = frame;
            }).bind(this));

            if (dataInfo == 1) {

                str.getComponent(cc.Label).string = "同意";
            } else {

                str.getComponent(cc.Label).string = "";
            }
        }).bind(this));

        var dissolveLeftTime = deskInfo.dissolveLeftTime || 60;

        var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');

        countdown.startCountdown(dissolveLeftTime, (function (isTimeout) {

            if (isTimeout) {
                this.clickAgreeOtherPlayerExit();
                return;
            }
        }).bind(this));

        var dissolveUserId = deskInfo.dissolveUserId;

        if (dissolveUserId == this._userId) {

            var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");

            var btnAgree = alert_bg.getChildByName("btnAgree");

            var btnDisagree = alert_bg.getChildByName("btnDisagree");

            btnAgree.active = false;

            btnDisagree.active = false;
            //this.alertRequestExitNode.active = true;
            //this.btnAlertRequestExitCancelButton.node.active = false;
            //this.btnAlertRequestExitConfirmButton.node.active = false;
            //let alert = this.alertRequestExitNode.getComponent('alert');
            //alert.setMessage("您正在申请协商退出，等待其他玩家同意");
            //this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(dissolveLeftTime);
            return;
        }

        //let dissolveAnswerInfos = deskInfo.dissolveAnswerInfo;
        //let currentUserIdIndex = deskInfo.playersIndex.findIndex(function(userId) {
        //    return this._userId == userId;
        //}.bind(this));
        //
        //let answerResult = dissolveAnswerInfos[currentUserIdIndex];
        //
        //if (answerResult == -1) {
        //    // -1 表示未处理  0 表示拒绝  1表示同意
        //    this.alertAnsowerExitNode.active = true;
        //
        //    let countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');
        //
        //    countdown.startCountdown(dissolveLeftTime, function(isTimeout) {
        //        if (isTimeout) {
        //            this.clickAgreeOtherPlayerExit();
        //        }
        //    }.bind(this));
        //
        //}
    },

    // 确定要强制退出游戏
    clickConfirmForceExit: function clickConfirmForceExit() {
        Socket.sendForceExitRoom(this._userId);
        cc.director.loadScene('hall');
    },

    // 确认请求退出游戏
    clickConfirmRequestExit: function clickConfirmRequestExit() {
        this.btnAlertRequestExitCancelButton.node.active = false;
        this.btnAlertRequestExitConfirmButton.node.active = false;
        var alert = this.alertRequestExitNode.getComponent('alert');
        if (this._deskInfo.cIndex > 0) {
            alert.setMessage("您正在申请协商退出，等待其他玩家同意");
            this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(60);
        }
        Socket.sendLeaveDesk(this._userId);
    },

    // 同意他人退出
    clickAgreeOtherPlayerExit: function clickAgreeOtherPlayerExit() {
        //this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        //this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        //this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");
        var btnAgree = alert_bg.getChildByName("btnAgree");
        var btnDisagree = alert_bg.getChildByName("btnDisagree");
        btnAgree.active = false;
        btnDisagree.active = false;
        Socket.sendAnswerDissolve(this._userId, 1);
    },

    // 不同意他人退出
    clickDisagreeOtherPlayerExit: function clickDisagreeOtherPlayerExit() {
        //this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        //this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        //this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");
        var btnAgree = alert_bg.getChildByName("btnAgree");
        var btnDisagree = alert_bg.getChildByName("btnDisagree");
        btnAgree.active = false;
        btnDisagree.active = false;
        Socket.sendAnswerDissolve(this._userId, 0);
    },

    // 隐藏请求退出 Node
    _hideReqestExitNode: function _hideReqestExitNode() {
        if (!this.alertRequestExitNode.active) {
            return;
        }

        this.alertRequestExitNode.active = false;
        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },

    //// 打枪
    playShoot: function playShoot(fromUserId, toUserId) {
        var user = this._findPlayerInfoByUserId(fromUserId);
        if (user) {
            AudioManager.instance.playHumanDaQiang(user.sex);
        }

        var toUserIndex = this._findPlayerIndexByUserId(toUserId);

        this._playerComponents.forEach((function (player) {
            if (this._userId == fromUserId || this._userId == toUserId) player.showNextCompareScore();
            player.playShootAnimation(fromUserId, toUserIndex);
            player.playBulletHoleAnimation(toUserId);
        }).bind(this));
    },

    // 播放全垒打动效
    playHomeRun: function playHomeRun(userId) {
        var user = this._findPlayerInfoByUserId(userId);
        if (user) {
            AudioManager.instance.playHomeRun(user.sex);
        }
        this.node.getComponent("animation")._quanleidaAnimation('long');

        this._playerComponents.forEach((function (player) {

            player.showNextCompareScore();
        }).bind(this));
    },

    playSpeakAnimation: function playSpeakAnimation(userId) {
        this._playerComponents.forEach(function (player) {
            player.playSpeakAnimation(userId);
        });
    },

    _shootDatas: function _shootDatas() {
        var homeRunUserId = this._homeRunUserId(); // 全垒打
        var shootDatas = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId == homeRunUserId;
        });
        return shootDatas;
    },

    _shotData: function _shotData() {
        var homeRunUserId = this._homeRunUserId(); // 打枪
        var shotData = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId != homeRunUserId;
        });
        return shotData;
    },

    _homeRunUserId: function _homeRunUserId() {
        return this._deskInfo.allShotData;
    },

    // MARK: 房间信息部分

    // 获取房间的玩法
    _deskInfoGameWay: function _deskInfoGameWay() {
        var setting = this._deskInfo.setting3;
        if (setting == null) {
            setting = 2;
        }
        var names = ["庄家模式", "无特殊牌", "普通模式"];
        return names[setting];
    },

    _deskInfoNumberOfGame: function _deskInfoNumberOfGame() {
        var setting = this._deskInfo.setting1;
        var infos = ['10局', '20局', '40局', '5局'];
        /*if (setting <= 1) {
         return '条数：' + infos[setting];
         }*/
        if (setting == 2) {
            setting = 0;
        } else if (setting == 3) {
            setting = 1;
        } else if (setting == 4) {
            setting = 2;
        } else if (setting == 5) {
            setting = 3;
        }
        return '局数：' + infos[setting];
    },

    _deskInfoNumberOfPeople: function _deskInfoNumberOfPeople() {
        var setting = this._deskInfo.setting2;
        var infos = ['2人', '3人', '4人', '5人'];
        return infos[setting];
    },

    _deskInfoPayInfo: function _deskInfoPayInfo() {
        var setting = this._deskInfo.setting4;
        if (setting == null) {
            setting = 0;
        }
        if (setting == 0) {
            setting = 1;
        }
        var infos = ['房主霸主庄', '房费AA'];
        return infos[setting];
    },

    _deskInfoJiaYiSeInfo: function _deskInfoJiaYiSeInfo() {
        var setting = this._deskInfo.setting7 == 0 ? 1 : 0;
        var infos = ['无多一色', '多一色'];
        return infos[setting];
    },

    _deskInfoGuiPaiInfo: function _deskInfoGuiPaiInfo() {
        var setting = undefined;
        if (this._deskInfo.setting8 == null) {
            setting = 0;
        } else if (this._deskInfo.setting8 == 0) {
            setting = 1;
        } else if (this._deskInfo.setting8 == 1) {
            setting = 2;
        }
        var infos = ['无王牌', '两张王牌', '四张王牌'];
        return infos[setting];
    },

    // MARK: 剩余时间
    _remainTimeStartUpdate: function _remainTimeStartUpdate() {
        //this.schedule(this._remainTimeUpdate, 1.0, cc.macro.REPEAT_FOREVER);
    },

    _remainTimeUpdate: function _remainTimeUpdate() {
        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        if (this._deskInfo == null) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        var isTaoShu = this._deskInfo.setting1 == 0 || this._deskInfo.setting1 == 1;
        if (isTaoShu) {
            this.labelRemainTime.node.active = false;
            return;
        }

        if (!this._deskInfo.createTime) {
            return;
        }

        this.labelRemainTime.node.active = true;
        var createTime = fecha.parse(this._deskInfo.createTime, 'YYYY-MM-DD HH:mm:ss').getTime();
        var oneHour = 60 * 60;
        var remain = (Date.now() - createTime) / 1000;
        remain = Math.max(oneHour - remain, 0);

        var mins = Math.floor(remain / 60);
        var secs = Math.floor(remain % 60);
        if (mins == 0 && secs == 0) {
            this.labelRemainTime.string = "";
            return;
        }

        var minsString = "" + mins;
        if (minsString.length < 2) {
            minsString = "0" + minsString;
        }

        var secsString = "" + secs;
        if (secsString.length < 2) {
            secsString = "0" + secsString;
        }

        var string = "剩余时间：00:" + minsString + ":" + secsString;
        this.labelRemainTime.string = string;
    },

    // MARK: 处理同 IP 的用户
    _handleTheSameOfIPAdress: function _handleTheSameOfIPAdress(userInfos) {
        if (!userInfos || userInfos.length == 0) {
            return;
        }

        var ipUserInfos = userInfos.reduce(function (ips, userInfo) {
            var users = ips[userInfo.ipAddress] || [];
            users.push(userInfo);

            ips[userInfo.ipAddress] = users;
            return ips;
        }, {});

        var sameIpUsers = null;
        for (var ip in ipUserInfos) {
            var users = ipUserInfos[ip];
            if (users.length > 1) {
                sameIpUsers = users;
                break;
            }
        }

        if (sameIpUsers == null) {
            return;
        }

        this._alertSameIpUserInfos(sameIpUsers);
    },

    _alertSameIpUserInfos: function _alertSameIpUserInfos(users) {
        var message = "";
        var userIds = "";
        users.forEach(function (user, index) {
            message = message + (index > 0 ? ' 和 ' : '') + user.nickname;
            userIds = userIds + user.id;
        });
        message = message + ' 在同一 IP 下！';

        this._didAlertSameIpMessage = this._didAlertSameIpMessage || {};
        if (this._didAlertSameIpMessage[userIds]) {
            return;
        }

        this.showAlertMessage(message, true);
        this._didAlertSameIpMessage[userIds] = true;
    }

});
Play.gongXiNiShow = function (type) {
    this.instances._gongXiNiShow(type);
};
module.exports = Play;

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","AudioManager":"AudioManager","KQCard":"KQCard","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","Player":"Player","UserModelHelper":"UserModelHelper","fecha":"fecha","manager":"manager","socket":"socket"}],"product":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'a9ad2cC2BdEiaFSqV4XCWQV', 'product');
// scripts\product.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        productId: ''
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickAction: function clickAction() {
        this.onClickAction(this.productId);
    },

    onClickAction: function onClickAction(productId) {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"randRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4d298BlaelCHqiV5dTDjhuY', 'randRoom');
// scripts\randRoom.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');

cc.Class({
    'extends': cc.Component,

    properties: {
        matchingLabel: cc.Label,
        timeNode: cc.Node,
        matchingNode: cc.Node,
        waitingPrefab: cc.Prefab,
        alertPrefab: cc.Prefab,

        tishi: cc.Node,

        _userId: null,
        _response: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        cc.isRoomViewShow = true;
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        KQGlobalEvent.on(Socket.Event.ReceiveInterRandom, this._socketReceiveInterRandom, this);
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            return;
        }

        cc.director.loadScene('play');
    },

    _socketReceiveInterRandom: function _socketReceiveInterRandom(response) {
        //服务器发送  {'action':'interRandom','result':false,'data':{'reason':reason}}
        this._response = response;
        this.unschedule(this._timeoutRandomAction);
        // 处理随机场匹配不成功的情况
        if (response.result) {
            return;
        }

        var reason = response.data.reason || "加入随机场失败";
        this.showAlertMessage(reason);

        if (reason == '你已经在匹配队列') {
            this._showMatching();
        } else {
            this._hideMatching();
        }
    },

    _socketDisconnect: function _socketDisconnect() {
        // 连接已断开
        this.matchingNode.active = false;
        this.showNetworkMessage('网络链接断开，重新连接中...');
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    },

    clickStart: function clickStart() {
        Socket.sendEnterRandom(this._userId);
        this._showMatching();

        /*#####begin*/
        //reason是服务器发送回来的
        /*if(this._response.data.reason == "你的钻石不足"){
            this.tishi.active = true;
        }*/
        /*#####end*/

        this.scheduleOnce(this._timeoutRandomAction, 5);
    },
    /*#####点击空白地方，砖石不足提示消失*/
    /*onBtnKong:function () {
        if(this.tishi.active){
            this.tishi.active = false;
        }else{
            //什么也不做
        }
    },*/
    /*取消匹配*/
    clickCancel: function clickCancel() {
        Socket.sendCancelRandom(this._userId);

        this._hideMatching();
    },

    _timeoutRandomAction: function _timeoutRandomAction() {
        this._hideMatching();
        this.showAlertMessage('进入匹配失败');
    },

    _showMatching: function _showMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.alert();
        this.matchingLabel.string = '正在匹配中，请稍后...';
        var num = 0;
        this.schedule(function () {
            num = num + 0.5;
            this.timeNode.rotation = num;
        }, 0.01);
    },

    _hideMatching: function _hideMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.dismissAction();
    },

    showNetworkMessage: function showNetworkMessage(msg) {
        this.unschedule(this._timeoutRandomAction);

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg) {
        if (!msg) {
            cc.error("不能显示为空的信息");
            return;
        }

        if (!this.alertMessageNode) {
            this.alertMessageNode = cc.instantiate(this.alertPrefab);
            this.node.addChild(this.alertMessageNode);
        }

        this.alertMessageNode.getComponent('alert').setMessage(msg);
        this.alertMessageNode.getComponent('alert').alert();
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"recordInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1457gdvd5I5aENjKvCTkCd', 'recordInfo');
// scripts\recordInfo.js

var Socket = require('socket');
var Playback = require('Playback');
var record = require('record');

cc.Class({
    'extends': cc.Component,

    properties: {
        timeLabel: cc.Label, // 时间
        jushuLabel: cc.Label, // 局数
        createUser: cc.Node, // 房主
        roomId: cc.Label, // 房间号
        jifen: cc.Label, // 积分
        id: cc.Label,
        avatarNode: cc.Node, // 头像
        creatorImg: cc.Node, // 创房头像
        nicknameLabels: cc.Label,
        scoreLabels: [cc.Label],
        //numNode:cc.Label,
        _parentId: null,
        //playbackNode:cc.Node,//回放按钮
        //watchNode:cc.Node,//查看按钮
        reordInfo: cc.Node,
        _recordItemInfo: null,
        totalGameResult: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {
        this.totalGameResult = cc.find("Canvas/recordInfo");
    },

    setInfo: function setInfo(recordInfo) {
        this._parentId = recordInfo.id;
        //this.watchNode.active = true;
        //this.playbackNode.active = false;
        if (recordInfo.playersInfo.length == 0) {
            return;
        }

        var playersInfo = JSON.parse(recordInfo.playersInfo);
        recordInfo.scores = JSON.parse(recordInfo.scores);

        var fen = recordInfo.scores[this.fen(recordInfo.userid, playersInfo.playersIndex)];
        //cc.log(fen)
        //cc.log(recordInfo.scores)
        //cc.log(this.fen(recordInfo.userid,playersInfo.playersIndex))
        //cc.log(recordInfo.userid)
        //cc.log(playersInfo.playersIndex)
        //cc.log(recordInfo)
        //cc.log(playersInfo)
        //cc.log('----47')
        this.jifen.string = fen >= 0 ? "+" + fen : fen;

        var headUrl = playersInfo.players[this.creator(recordInfo.createUserId, playersInfo.playersIndex)].avatarUrl; // 头像URL
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        cc.loader.load({ url: headUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;
            }
        });

        this.roomId.string = "房号：" + playersInfo.roomId;
        this.timeLabel.string = "时间：" + playersInfo.time.substr(5, 11);
        this.jushuLabel.string = "局数：" + this.js(playersInfo.setting1 - 2);

        //for (var i = 0;i < playersInfo.players.length;i++) {
        //  this.nicknameLabels[i].string = playersInfo.players[i].nickname;
        //  this.scoreLabels[i].string = playersInfo.players[i].totalScore;
        //}
    },
    js: function js(setting2) {
        var jushu = 5;
        switch (setting2) {
            case 0:
                jushu = 5;break;
            case 1:
                jushu = 10;break;
            case 2:
                jushu = 20;break;
            case 3:
                jushu = 30;break;
        }
        return jushu;
    },

    fen: function fen(userid, players) {
        // 找积分
        for (var i = 0; i < players.length; i++) {
            if (players[i] == userid) {
                return i;
            }
        }
    },
    creator: function creator(_creator, players) {
        //创房者
        for (var i = 0; i < players.length; i++) {
            if (players[i] == _creator) {
                return i;
            }
        }
    },

    clickAction: function clickAction(event, data) {
        var playersInfo = JSON.parse(data.playersInfo);
        var totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');
        totalGameResultComp.setPlayerInfos(playersInfo.players, data);
        totalGameResultComp._clickBtn();
        this.totalGameResult.getComponent('alert').alert();

        //if (this._recordItemInfo) {
        //  this._startPlayback(this._recordItemInfo._info8Array);
        //  return;
        //}
        ////Socket.sendGetItemRecord(Socket.instance.userInfo.id,this._parentId);
        //Socket.sendGetItemRecord(Socket.instance.userInfo.id,--index);
    },

    _startPlayback: function _startPlayback(playBackInfo) {
        //Playback.instance.setPlaybackDatas(playBackInfo);
        //cc.director.loadScene('play');
    },

    detailAction: function detailAction(recordItemInfo, index) {
        //this._recordItemInfo = recordItemInfo;
        ////this.playbackNode.active = true
        ////console.log();
        ////this.numNode.string = "第" + (index + 1) + "局";
        //this.timeLabel.string = recordItemInfo.creatAt.substr(5,11);
        //let objArray = JSON.parse(recordItemInfo.info8);
        //this._recordItemInfo._info8Array = objArray;
        //let playersArray = objArray.map(function(str){
        //  return JSON.parse(str);
        //});
        //
        //var players = playersArray[playersArray.length-1].data.players;
        //for (var i = 0;i < players.length;i++) {
        //    this.nicknameLabels[i].string = players[i].nickname;
        //    this.scoreLabels[i].string = players[i].cScore;
        //}
    },
    records: function records() {}

});

cc._RFpop();
},{"Playback":"Playback","record":"record","socket":"socket"}],"record":[function(require,module,exports){
"use strict";
cc._RFpush(module, '452f4rFUqRLFYlGEJS5kEWs', 'record');
// scripts\record.js

var KQGlobalEvent = require('KQGlobalEvent');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        scrollView: cc.Node,
        recordItem: cc.Prefab
    },

    //subScrollView:cc.Node,
    //subRecordItem:cc.Node,
    //splash:cc.Prefab,
    //reordInfo:cc.Node,
    //
    //jifen:cc.Label,
    //head:cc.Node,
    //id:cc.Label,
    //nickname:cc.Label,
    //creat:cc.Label,        // 创房人
    //createUser:cc.Node,     //  头像
    //
    //timeLabel:cc.Label,   // 时间
    //jushuLabel:cc.Label,  // 局数
    ////createUser:cc.Node,   // 房主
    //roomId:cc.Label,      // 房间号
    //_records:null,
    // use this for initialization
    onLoad: function onLoad() {
        //this.isSubPage = false;
        //this.subScrollView.active = false;
        //
        //this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;
        //console.log( this.subScrollViewContent );
        //this.recordInfo = this.subScrollViewContent.children[0];
        //this.reords = this.subScrollViewContent.children[0].children[3];
        this.scrollViewContent = this.scrollView.getComponent(cc.ScrollView).content;
        this._registerSocketEvent();
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.GetRecord, this._ReceiveRecordInfo, this);
        //KQGlobalEvent.on(Socket.Event.GetItemRecord, this._ReceiveRecordItem, this);
    },

    _ReceiveRecordInfo: function _ReceiveRecordInfo(response) {
        //cc.log(response)
        //cc.log('------78')
        //console.log(response);
        //this._records = response.data;
        //this.isSubPage = false;
        //this.subScrollView.active = false;
        //this.scrollView.active = true;

        this.scrollViewContent.removeAllChildren();
        var index = 0;
        response.data.filter(function (record) {
            return record.playersInfo.length > 0;
        }).forEach((function (recordInfo) {
            index++;
            var item = cc.instantiate(this.recordItem);
            this.scrollViewContent.addChild(item);
            var comp = item.getComponent('recordInfo');
            comp.setInfo(recordInfo);
            var recordBtn = item.children[7].getComponent(cc.Button);
            recordBtn.clickEvents[0].customEventData = recordInfo;
            // var eventHandler = new cc.Component.EventHandler();
            // eventHandler.target = comp.node.children[7];
            // eventHandler.component = "btn";
            // eventHandler.handler = "clickAction";
            //eventHandler.customEventData = "my data";
            //console.log(comp.node.children[7]);
        }).bind(this));
    },

    closeAction: function closeAction() {
        if (this.isSubPage) {
            this.isSubPage = false;
            this.subScrollView.active = false;
            this.scrollView.active = true;
        } else {
            this.node.getComponent('alert').dismissAction();
        }
    }
});
/* clickAction:function( index ){
     //_ReceiveRecordItem()
 },
 _ReceiveRecordItem:function(RecordItemInfo) {
     cc.log(RecordItemInfo)
     cc.log('------78')
     //console.log(RecordItemInfo);return;
     var index = RecordItemInfo.data
     var playersInfo = JSON.parse(this._records[index].playersInfo);
     
     var players = playersInfo.players;                  // 玩家信息
     var playersIndex = playersInfo.playersIndex;        // 玩家的位置
     var createUserId = this._records[index].createUserId;   // 创房ID
     var sendUserId = this._records[index].userid;           // 发送人ID
      this.isSubPage = true;
     this.subScrollView.active = true;
     this.scrollView.active = false;
      this.timeLabel.string = (this._records[index].createAt).substr(5,11);               // 时间
     this.jushuLabel.string = this.js(JSON.parse(this._records[index].setting2));        // 局数
     this.roomId.string = this._records[index].roomId;                                   // 房间号
     this.creat.string = this.findCreator(this._records[index].createUserId,players);    // 房主
      this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;
     this.subScrollViewContent.removeAllChildren();
      for(var i = 0; i < players.length; i++ ){
         var item = cc.instantiate(this.splash);
         this.subScrollViewContent.addChild(item);
         var comp = item.getComponent('recordInfo');
         var creator = 0;       
         var self = 0;       // 表示自己，要对自己的比牌记录背景做处理
         if(createUserId == players[i].id){
             creator =1;
         }
         if( sendUserId == players[i].id){
             self = 1;
         }
         this.records(comp,i,creator,self,index);
     }
  },
 records:function(info,i,creator,self,index){
     if(self){
         info.node.color = new cc.Color(125, 126, 200);
     }
     cc.log(info)
     cc.log('----119')
     var players = JSON.parse(this._records[index].playersInfo).players;
     var scores = this._records[index].scores ;
     info.nicknameLabels.string = players[i].nickname;
     info.id.string = players[i].id;
     info.jifen.string = scores[i];
      var headUrl = players[i].avatarUrl;   //头像连接
     var sprite = info.avatarNode.getComponent(cc.Sprite);
     cc.loader.load(headUrl+".jpg", function (err, tex) {
       if (!err) {
           var frame = new cc.SpriteFrame(tex);
           sprite.spriteFrame=frame;
       }
     });
     info.creatorImg.active = creator;
 },
 findCreator:function(createId,players){ //找房主
     for(var i=0; i<players.length;i++){
         if(createId == players[i].id){
             return players[i].nickname;
         }
     }
 },
 js:function(num){
     var J = 5;
     switch(num){
         case 0: J = 5;break;
         case 1: J = 10;break;
         case 2: J = 20;break;
         case 3: J = 30;break;
     }
     return J;
 },*/

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"rule":[function(require,module,exports){
"use strict";
cc._RFpush(module, '92f6eNs7RdDRJIRLCZnyulJ', 'rule');
// scripts\rule.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    }
});

cc._RFpop();
},{}],"scale":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c1c33tgIe9JvLb/mE+2mRnK', 'scale');
// scripts\scale.js

cc.Class({
    "extends": cc.Component,

    properties: {
        content: cc.Node
    },

    onLoad: function onLoad() {
        var visibleSize = cc.director.getVisibleSize();
        var contentSize = {};
        contentSize.width = this.node.width;
        contentSize.height = this.node.height;
        var scaleX = visibleSize.width / contentSize.width;
        var scaleY = visibleSize.height / contentSize.height;
        var scale = Math.min(scaleX, scaleY).toFixed(2);
        this.node.scaleX = scale;
        this.node.scaleY = scale;
    }
});

cc._RFpop();
},{}],"selectMoShi":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0030eDrh7xEm6AeR3FCg5WU', 'selectMoShi');
// scripts\selectMoShi.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        selectedIndex: 0,
        _select: [],
        _selected: 0,
        beilv: cc.Node, // 倍率
        _blShow: 0 },

    // 倍率的显示状态
    onLoad: function onLoad() {
        this.beilv.active = this._blShow;
        this._select = [1, 1, 1, 0, 0];
        if (cc.set) {
            // 记录上一句的房间情况
            this._select = cc.set['setting3'];
        }
        var self = this;
        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select[i];
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (this._select[i]) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
            if (i == 3) {
                this.beilv.active = this._blShow = this._select[3];
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                var index = this.index;
                for (var i = 0; i < self.nodes.length; i++) {
                    var comp = self.nodes[i].getComponent('select');
                }
                this.setSelected(self._select[index] = !self._select[index]);
                if (this.index == 3) {
                    // 第三个是庄家模式，庄家模式显示倍率
                    self.beilv.active = this._blShow = self._select[3];
                }

                self._select[index] = self._select[index];
                self.selectedIndex = index;
                self.onSelectChange(index);

                var title = this.node.children[0];
                if (self._select[index]) {
                    // 如果当前选项为TRUE 则显示青色
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    // 反之 白色
                    title.color = new cc.Color(255, 255, 255);
                }
            };
        }
    },
    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
        //console.log(this._select);
    }

});

cc._RFpop();
},{}],"select_mapai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8e7e53kJcJK9rwMSxnloqI5', 'select_mapai');
// scripts\select_mapai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        pai: cc.Node,
        mapai: {
            "default": [],
            type: cc.SpriteFrame
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selectMa = this.node.getComponent("select_ma");
        this.selectMa.onLoad();
        this.com = this.pai.getComponent(cc.Sprite);
    },

    clickBtnComfirm: function clickBtnComfirm() {
        this.com.spriteFrame = this.mapai[cc.from.ma];
        //console.log(this.com.spriteFrame);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"select_ma":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4bc0b2bZGRGXoAfdO3Y6Squ', 'select_ma');
// scripts\select_ma.js

cc.Class({
    "extends": cc.Component,

    properties: {
        rightIcon: [cc.Node],
        mapaiRight: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.from == null) {
            cc.from = {};
        }
        //如果不带马，则马牌为空
        if (this.mapaiRight.active == false) {
            cc.from.isUseMa = false;
            cc.from.ma = null;
        } else {
            cc.from.isUseMa = true;
            //否则马牌默认为第0个，即黑桃5
            cc.from.ma = 0;
        }
        for (var i = 0; i < this.rightIcon.length; i++) {
            if (i == 0) {
                this.rightIcon[i].active = true;
                cc.from.ma = 0;
                this.select = this.rightIcon[i];
            } else {
                this.rightIcon[i].active = false;
            }
        }
    },
    onMaPaiClick: function onMaPaiClick(e) {
        var targetName = e.target.name;
        //cc.log(targetName)
        if (targetName != this.select.parent.name) {
            if (targetName == "select_kuang1") {
                this.select = this.rightIcon[2];
                cc.from.ma = 2;
            } else if (targetName == "select_kuang2") {
                this.select = this.rightIcon[1];
                cc.from.ma = 1;
            } else if (targetName == "select_kuang3") {
                this.select = this.rightIcon[0];
                cc.from.ma = 0;
            }
            for (var i = 0; i < this.rightIcon.length; i++) {
                this.rightIcon[i].active = false;
            }
            this.select.active = true;
        }
        //console.log(cc.from.ma);
    }

});

cc._RFpop();
},{}],"selectbeilv":[function(require,module,exports){
"use strict";
cc._RFpush(module, '253cf+Bll9FV5ngl0DW3PxZ', 'selectbeilv');
// scripts\selectbeilv.js

var KQGlobalEvent = require('KQGlobalEvent');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        _userid: 0
    },

    // use this for initialization
    onLoad: function onLoad() {},
    clickBeiLv: function clickBeiLv(event, num) {
        this.node.active = false;
        Socket.sendBeiLv(num, this._userid);
    }

});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"select":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e913aIwAtVEo5jMrf40D5rw', 'select');
// scripts\select.js

cc.Class({
    "extends": cc.Component,

    properties: {
        bgNode: cc.Node, //选择框
        selectedNode: cc.Node, //对号
        pai: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        //console.log(this.node);
        this.selected = true;
        //console.log(cc.set);
    },

    clickAction: function clickAction() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
    },

    setSelected: function setSelected(selected) {
        this.selected = selected;
        this.selectedNode.active = this.selected;
    },
    /*#####*/
    clickSelectKuang: function clickSelectKuang() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        cc.from.isUseMa = this.selected;
        var mapaiCom = this.pai.getComponent(cc.Button);
        if (this.selectedNode.active === false) {
            mapaiCom.interactable = false;
        } else {
            mapaiCom.interactable = true;
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"singleSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '194a8h4vXFO+bXX92yzqbfq', 'singleSelect');
// scripts\singleSelect.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        selectedIndex: 0
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        var rs = 0;
        var js = 0;
        var sf = 0;
        var bl = 0;
        if (cc.set) {
            js = cc.set.setting1;
            rs = cc.set.setting2;
            sf = cc.set.setting4;
            bl = cc.set.setting5;
        }
        for (var i = 0; i < this.nodes.length; i++) {
            var isSelected = this.selectedIndex == i;
            this.nodes[i].getComponent('select').setSelected(isSelected);
            var index = 0;
            var selectIndex = this.selectedIndex;
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (selectIndex == i) {
                this.nodes[selectIndex].getChildByName("title").color = new cc.Color(13, 210, 222);
            }
        }
        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;

            tComp.clickAction = function () {
                for (var i = 0; i < self.nodes.length; i++) {
                    var comp = self.nodes[i].getComponent('select');
                    comp.setSelected(false);
                }
                var Peers = this.node.parent.children; // 同辈节点
                var index = 0;
                for (var a = 0; a < Peers.length; a++) {
                    if (Peers[a].children.length > 0) {
                        // 如果同辈有子节点 处理子节点文字的颜色
                        var title = Peers[a].getChildByName("title");
                        title.color = new cc.Color(255, 255, 255);
                    }
                }
                this.node.getChildByName('title').color = new cc.Color(13, 210, 222);
                //this.node.children[index].color = new cc.Color(13,210,222);
                this.setSelected(true);
                self.selectedIndex = this.index;
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "renshu" && cc.set) {
            console.log(rs);
            this.remember_set(rs);
        }
        if (this.node._name == "jushu" && cc.set) {
            this.remember_set(js);
        }
        if (this.node._name == "cards" && cc.set) {
            this.remember_set(sf);
        }
        if (this.node._name == "beiLv" && cc.set) {
            this.remember_set(bl);
        }
    },
    remember_set: function remember_set(num) {
        this.selectedIndex = num;
        for (var i = 0; i < this.nodes.length; i++) {
            var isSelected = num == i;
            this.nodes[i].getComponent('select').setSelected(isSelected);
            var index = 0;
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (num == i) {
                // if( this.nodes[num].children[0].name == "title" ){
                //     index = 0;
                // }else if(this.nodes[num].children[1].name == "title"){
                //     index =1;
                // }
                this.nodes[num].getChildByName('title').color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {}

});

cc._RFpop();
},{}],"slider":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1c921w7bEFKUIdNwItOX3oG', 'slider');
// scripts\slider.js

cc.Class({
    "extends": cc.Component,

    properties: {
        indicatorNode: cc.Node,
        backgroundNode: cc.Node,
        selectedNode: cc.Node,

        value: 0
    },

    // use this for initialization
    onLoad: function onLoad() {
        var self = this;
        this.indicatorNode.on(cc.Node.EventType.TOUCH_START, function (event) {});
        this.indicatorNode.on(cc.Node.EventType.TOUCH_MOVE, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });

        //this.maxWidth = this.node.width - 40;
        this.maxWidth = this.node.width - 28;
        this.setValue(this.value);
    },

    updateSlider: function updateSlider(pt) {
        var x = pt.x;
        if (x < 0) {
            x = 0;
        }

        if (x > this.maxWidth) {
            x = this.maxWidth;
        }
        this.setValue(x / this.maxWidth);
        this.onValueChange(this.value);
    },

    /*0 - 1*/
    setValue: function setValue(value) {
        this.value = value;
        if (this.value < 0) {
            this.value = 0;
        }
        if (this.value > 1) {
            this.value = 1;
        }
        //this.maxWidth = this.node.width - 38;
        this.maxWidth = this.node.width - 28;
        this.indicatorNode.x = this.value * this.maxWidth + 10;
        this.selectedNode.width = this.value * this.maxWidth + this.indicatorNode.width / 2;
    },

    onValueChange: function onValueChange(value) {
        cc.log(value);
    }
});

cc._RFpop();
},{}],"socket":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf75cLLNo1ETbJFrx/23i/H', 'socket');
// scripts\socket.js

var manager = require('manager');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var SocketConstant = {
  MaxReconnectCheckInterval: 5 };

/**
 * 这是对 WebSocket 的一个封装
 * 
 * 里面包含自动重连的功能
 */
// 重连检测时间片
var Socket = cc.Class({
  'extends': cc.Component,

  properties: {
    _lastReceiveMsgTime: 0, // 最后一次收到消息时间(毫秒)
    _timeout: 8 },

  // 超时时长 （秒）
  statics: {
    instance: null,
    // url:"ws://182.18.26.13:5041",
    //url:"ws://123.56.20.164:5041",//修改前
    url: "ws://127.0.0.1:5041"
  },

  // url:"ws://192.168.0.108:5041",
  //url:"ws://183.3.205.149:5002",
  // use this for initialization
  onLoad: function onLoad() {
    Socket.instance = this;

    this.name = "socket";

    cc.game.addPersistRootNode(this.node);
    if (cc.game.isPersistRootNode(this.node)) {
      cc.log('添加全局节点 Socket 成功');
    }

    this._registerAppActiveChange();

    this.isCreating = false;
    this.createIndex = 0;
    this.createSocket();

    this.schedule(function () {
      this.checkConnection();
    }, 5);

    this.recvTime = Date.now(); //接收到最新一条服务器的信息的时间
    //cc.log(manager.version);

    this._checkSocket();
  },

  checkConnection: function checkConnection() {
    //客户端定时给服务端发送点数据，防止连接由于长时间没有通讯而被某些节点的防火墙关闭导致连接断开的情况。
    this.sendMessage('checkAction', '');
  },

  createSocket: function createSocket() {
    var self = this;
    this.createIndex++; //创建次数加1
    if (this.createIndex > 5) {
      this.networkError();
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.isCreating = true;

    KQGlobalEvent.emit(Socket.Event.SocketConnecting);
    this.ws = new WebSocket(Socket.url);
    if (this.ws === null) {
      this.networkError();
      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { 'data': 'Socket 创建失败' });
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.socketError = false;

    // socket 连接成功
    this.ws.onopen = function (event) {
      //cc.log("WebSocket 连接成功：", event);

      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketConnectSuccessed, event);

      self.isCreating = false;
      self.socketError = false;
      self.createIndex = 0;
      self.connectionSuccess();
      self.sendReconnectInfo();
    };

    // socket 接收到消息
    this.ws.onmessage = function (event) {
      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketReceiveMessage, event.data);

      self.isCreating = false;
      self.socketError = false;
      self.receviceMessage(event.data);
      self._dispatchResponse(event.data);
      self.recvTime = Date.now(); //接收最新一条信息的时间

      /**/
    };

    /**
     * socket 发生错误
     * 
     * socket 本身有 `onerror` 回调，但事实证明，其不靠谱，
     * 有很大的机率有误报的行为，常常在没有错误时，会给错误回调。
     * 且不能定制超时时长
     * 
     * @param {String} message 
     */
    this.ws._kq_onerror = function (message) {
      cc.error('WebSocket 连接错误：' + message);

      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { data: message });
      self.ws.close();
      if (!self.ws) {
        return;
      }

      // 虽然调用了 websocket 的 close 方法，但是
      // 它并会立即调用 onclose 回调，而是在未来的某
      // 一时间再回调 onclose；但这里明显可以直接回调了。
      var ws = self.ws;

      self.ws.onclose();
      ws.onclose = function () {};
    };

    // socke 已关闭
    this.ws.onclose = function (event) {
      //cc.log('WebSocket 已关闭 close time=' + Date.now() + " event: " + event);

      self.isCreating = false;
      self.socketError = true;
      self.ws = null;
      self.connectionDisconnect();
      KQGlobalEvent.emit(Socket.Event.SocketDisconnect, event);
      //cc.log('socket close'+JSON.stringify(event));
    };
  },

  reconnect: function reconnect() {
    var self = this;
    this.scheduleOnce(function () {
      if (!self.isCreating && self.socketError) {
        self.createSocket();
      }
    }, 2);
  },

  sendReconnectInfo: function sendReconnectInfo() {
    var self = this;
    this.scheduleOnce(function () {
      if (this.userInfo != null) {
        var userId = self.userInfo.user_id || self.userInfo.id;
        self.sendMessage('reconnect', {
          'userId': userId
        });
      }
    }, 1);
  },

  receviceMessage: function receviceMessage(response) {},

  connectionDisconnect: function connectionDisconnect() {},

  connectionSuccess: function connectionSuccess() {},

  networkError: function networkError() {},

  checkNetworkStart: function checkNetworkStart() {},

  checkNetworkEnd: function checkNetworkEnd() {},

  _dispatchResponse: function _dispatchResponse(responseString) {
    //cc.log("WebSocket 接收到服务器消息：", responseString);
    var response = JSON.parse(responseString);
    var action = response["action"];
    if (action) {
      KQGlobalEvent.emit(action, response);
    }
  },

  // MARK: 前后台操作
  _registerAppActiveChange: function _registerAppActiveChange() {
    //cc.log("WebSocket 注册应用进入前、后台事件");
    cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
    cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
  },

  /**
   * 进入后台
   */
  _appEnterBackground: function _appEnterBackground() {
    var now = cc.sys.now();
    if (now - this._lastAppEnterBackgroundTime < 100) {
      return;
    }
    this._lastAppEnterBackgroundTime = now;

    //cc.log("WebSocket 检测到应用进入后台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppPause(id);
    this._cancelCheckSocket();
  },

  /**
   * 进入前台 
   */
  _appBecomActive: function _appBecomActive() {
    var now = cc.sys.now();
    if (now - this._lastAppBecomActiveTime < 100) {
      return;
    }
    this._lastAppBecomActiveTime = now;

    //cc.log("WebSocket 检测到应用进入前台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppActive(id);
    this._checkSocket();

    this.scheduleOnce((function () {
      this._checkSocketExecute();
    }).bind(this), 1.5);
  },

  //进入后台操作
  enterbackgroudAction: function enterbackgroudAction() {
    this._appEnterBackground();
  },

  //进入前台操作
  resumeAction: function resumeAction() {
    //检查网络
    this._checkNetwork();
    this._appBecomActive();
  },

  sendMessage: function sendMessage(action, data) {
    data = this._strongVerifyData(data);

    if (this.socketError) {
      cc.error("socket 连接错误：" + this.socketError);
      this.reconnect();
      return;
    }
    //cc.log('WebSocket 发送消息：' + action, data);
    if (cc.sys.isObjectValid(this.ws)) {
      if (this.ws.readyState === WebSocket.OPEN) {
        this.ws.send(this._convertParameterToString(action, data));
      }
    } else {
      this.connectionDisconnect();
    }
  },

  _strongVerifyData: function _strongVerifyData() {
    var data = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

    if (typeof data == 'string') {
      data = { "string": data };
    }

    if (data == null) {
      data = {};
    }

    if (!data["userId"]) {
      if (this.userInfo && typeof this.userInfo == 'object' && this.userInfo.id) {
        data["userId"] = this.userInfo.id;
      }
    }
    return data;
  },

  _convertParameterToString: function _convertParameterToString(action) {
    var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var obj = {};
    obj.action = action;
    obj.data = data;

    return JSON.stringify(obj);
  },

  // 检查网络
  _checkNetwork: function _checkNetwork() {
    if (this.checkNetworkNow) {
      this.checkNetworkNow();
    }

    this.shouldCheck = true;
    if (!this.socketError) {
      this.recvTime = 0;
      this.sendMessage('checkAction', '');
      this.scheduleOnce(function () {
        this.checkNetworkEnd();
        this.shouldCheck = false;
        if (this.recvTime === 0) {
          this.connectionDisconnect();
        }
      }, 2.5);
    } else {
      this.connectionDisconnect();
    }
  },

  // MARK: socket 掉线尽早确认
  _checkSocket: function _checkSocket() {
    this.schedule(this._checkSocketExecute, SocketConstant.MaxReconnectCheckInterval, cc.macro.REPEAT_FOREVER);
  },

  _cancelCheckSocket: function _cancelCheckSocket() {
    this.unschedule(this._checkSocketExecute);
  },

  _checkSocketExecute: function _checkSocketExecute() {
    if (this._isSocketTimeout() && this.ws) {
      this.ws._kq_onerror('连接超时');
      return;
    }
  },

  // socket 是否已超时
  _isSocketTimeout: function _isSocketTimeout() {
    return this._lastReceiveMessageInterval() >= this._timeout;
  },

  // 上一次收到消息到现在的时间间隔
  _lastReceiveMessageInterval: function _lastReceiveMessageInterval() {
    var now = cc.sys.now();
    var interval = (now - this._lastReceiveMsgTime) / 1000;
    //cc.log(`WebSocket 现在距上一条收到消息的时间间隔是：${interval} 秒`);
    return interval;
  }

});

// MARK: Socket 事件定义
Socket.Event = {
  SocketConnecting: "SocketConnecting", // Socket 正在连接
  SocketConnectSuccessed: "SocketConnectSuccessed", // 连接成功
  SocketDisconnect: "SocketDisconnect", // Socket 断开连接
  SocketConnectError: "SocketConnectError", // Socket 连接错误
  SocketReceiveMessage: "SocketReceiveMessage", // Socket 接收到消息

  LoginJoin: "loginJoin", // 客户端发送 从登陆界面获取房间号进入游戏
  RecordId: "recordId", // 客户端发送 
  OnceAgain: "onceAgain", // 客户端发送 
  BeiLv: "beiLv", // 客户端发送 
  InviteCode: "inviteCode", // 客户端发送   邀请码
  JoinDesk: "joinDesk", // 客户端发送
  CreateDesk: "createDesk", // 客户端发送
  LeaveDesk: "leaveDesk", // 离开桌子
  DissolveDesk: "dissolveDesk", // 解散桌子
  AnswerDissolve: "answerDissolve", // 回答请求退出命令
  GetDeskInfo: "getDeskInfo", // 客户端发送
  SendImage: "sendImage", // 客户端发送
  SendText: "sendText", // 客户端发送
  SendEmoji: "sendEmoji", // 客户端发送
  ChangeInfo: "changeInfo", // 客户端发送
  SendAudioMessage: "sendAudioMessage", // 客户端发送  发送语音消息
  GetRecord: "getRecord", // 获取战绩信息
  GetItemRecord: "getItemRecord", // 获取战绩信息
  PlayCard: "playCard", // 客户端发送，用户打出牌
  TimeoutDissolve: "timeoutDissolve", // 请求退出超时时，需要发出的消息
  Feedback: "feedback", // 客户端发送  反馈信息
  SharePng: "sharePng", // 客户端发送  分享领取砖石
  EnterRandom: "interRandom", // 客户端发送  进入随机场
  CancelRandom: "cancelRandom", // 客户端发送  取消进入随机场
  ForceExitRandom: "dissolve", // 客户端发送 强制退出随机场
  Ready: "ready", // 客户端发送 准备
  StartGame: "startGame", // 客户端发送 开始游戏
  GetHallInfo: "getHallInfo", // 客户端发送 获取大厅信息
  GetUserInfo: "getUserInfo", // 客户端发送 获取用户信息
  CheckAction: "checkAction", // 客户端发送，用来检测与服务器的连通性
  Pause: "pause", // 客户端进入后台时要发送的消息
  Active: "active", // 客户端回到前台时要发送的消息
  Qingli: "qingli", // 客户端回到前台时要发送的消息

  ReceiveRequestDissolve: "requestDissolve", // 请求解散桌子 服务器发送
  ReceiveRequestDissolveResult: "requestDissolveResult", // 请求解散桌子结果
  ReceiveChatText: "sendText", // 服务器发送
  ReceiveChatEmoji: "sendEmoji", // 服务器发送
  ReceiveDeskInfo: "deskInfo", // 服务器发送
  ReceiveGameOver: "gameOver", // 服务器发送
  ReceiveFaPai: "fapai", // 服务器发送
  ReceiveSharePng: "sharePngs", // 服务器发送
  ReceiveOnlineStatus: "sendOnlineStatus", // 服务器发送
  ReceiveOnChangeInfo: "changeInfo", // 服务器发送
  ReceiveAudioMessage: "sendAudioMessage", // 服务器发送，接收到用户发送了语音消息
  ReceivePlayCard: "playCard", // 服务器发送，有用户已经准备好牌
  ReceiveCreateDesk: "createDesk", // 服务器发送，创建房间的回调
  ReceiveReady: "ready", // 服务器发送，有用户点击了准备
  ReceiveHallInfo: "getHallInfo", // 服务器发送
  ReceiveGetUserInfo: "getUserInfo", // 服务器发送 获取用户信息
  ReceiveCheckAction: "checkAction", // 服务器发送  用来确认 Socket 还在连着
  ReceiveForceExit: "forceExit", // 服务器发送  用来使客户端强退
  ReceiveDissolveDesk: "dissolveDesk", // 服务器发送   当房主退出时，解散桌子
  ReceiveInterRandom: "interRandom", // 服务器发送   进入随机场的反馈
  ReceivePause: "pause", // 服务器发送   当有用户设备进入后台时，会收到这条消息
  ReceiveInviteCode: 'inviteCode', // 服务器发送，收到邀请码的消息
  ReceiveLeaveDesk: 'leaveDesk', // 服务器发送，收到需要离开桌子的消息
  ReceiveSelectBeiLv: 'selectBeiLv', // 服务器发送，收到选择倍率的消息
  ReceiveBeiLv: 'beiLv', // 服务器发送，收到倍率的消息
  ReceiveQingLi: 'qingli', // 服务器发送，收到请离
  ReceiveRecordId: 'recordId', // 服务器发送，收到战绩信息
  ReceiveLoginJoin: 'loginJoin', // 服务器发送，收到从页面进入房间信息
  ReceiveOnceAgain: 'onceAgain', // 服务器发送，收到再来一局信息
  ReceiveNoUionid: 'noUionid' };

// MARK: Socket 提供的可发给服务器消息的方法

// 服务器发送，收到没有unionID信号
Socket.sendCheckAction = function () {
  this.instance.sendMessage(this.Event.CheckAction, null);
};
/**/
Socket.sendDidReceiveGameOverAction = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(Socket.Event.DidReceiveGameOverAction, param);
};
/**/

/**
 * 当 APP 进入后台时要发送的消息
 */
Socket.sendAppPause = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Pause, param);
};

/**
 * 当 APP 进入前台时发送的消息
 */
Socket.sendAppActive = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Active, param);
};

// 开房
Socket.sendCreateDesk = function (createDescInfo, userId) {
  cc.assert(createDescInfo);
  cc.assert(userId);

  createDescInfo["userId"] = userId;
  this.instance.sendMessage(this.Event.CreateDesk, createDescInfo);
};

Socket.sendQingli = function (leaveId, userId) {
  var param = {
    "leaveId": leaveId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.Qingli, param);
};
// 从登陆页面加入房间
Socket.sendLoginJoin = function (roomId, userId) {
  var param = {
    "roomId": roomId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.LoginJoin, param);
};
// 再来一局
Socket.sendOnceAgain = function (again, userId) {
  var param = {
    "userId": userId,
    "again": again
  };
  this.instance.sendMessage(this.Event.OnceAgain, param);
};
// 加入房间
Socket.sendJoinDesk = function (roomId, userId) {
  cc.assert(roomId);
  cc.assert(userId);

  var param = {
    "roomId": roomId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.JoinDesk, param);
};
// 向服务端发送我选择的倍率
Socket.sendBeiLv = function (beilv, userId) {
  var param = {
    "beilv": beilv,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.BeiLv, param);
};
// 发送邀请码
Socket.sendInviteCode = function (inviteCode, userId) {
  var param = {
    "inviteCode": inviteCode,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.InviteCode, param);
};

// 获取房间信息
Socket.sendGetDesckInfo = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetDeskInfo, param);
};

Socket.sendText = function (userId, text) {
  //cc.assert(userId);
  //cc.assert(text);
  var param = {
    "msg": text,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendText, param);
};
Socket.sendEmoji = function (userId, emoji) {
  var param = {
    "emoji": emoji,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendEmoji, param);
};
Socket.sendChangeInfo = function (userId, Info) {
  var param = {
    "changeInfo": Info,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.ChangeInfo, param);
};
Socket.sendAudioMessage = function (userId) {
  var url = arguments.length <= 1 || arguments[1] === undefined ? "" : arguments[1];

  cc.assert(userId);
  cc.assert(url.length > 0);

  if (url.length == 0) {
    return;
  }

  var param = {
    "url": url,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendAudioMessage, param);
};

Socket.sendImage = function (userId, image) {
  cc.assert(userId);
  cc.assert(image);
  var param = {
    "msg": image,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendImage, param);
};

Socket.sendGetRecrod = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.GetRecord, param);
};

Socket.sendGetRecrodFromId = function (recordId) {
  var param = {
    "recordId": recordId
  };
  this.instance.sendMessage(this.Event.RecordId, param);
};

Socket.sendDissolveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.DissolveDesk, param);
};

Socket.sendGetItemRecord = function (userId, parentId) {
  cc.assert(userId);
  cc.assert(parentId);
  var param = {
    "userId": userId,
    "parentId": parentId
  };

  this.instance.sendMessage(this.Event.GetItemRecord, param);
};

Socket.sendLeaveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.LeaveDesk, param);
},

/**
 * 回答退房请求
 * 
 * @param  {Number} userId 当前用户 id
 * @param  {NUmber} answer=1 回答。1 表示同意； 0 表示拒绝； -1 表示未选择
 */
Socket.sendAnswerDissolve = function (userId) {
  var answer = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];

  cc.assert(userId);
  var param = {
    "userId": userId,
    "answer": answer
  };

  this.instance.sendMessage(this.Event.AnswerDissolve, param);
}, Socket.sendForceExitRoom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.DissolveDesk, param);
},

// 十三张中
// cardInfo 类似于：
// [{
//         'cards':[{'suit':suit,'number':number},{}],//特殊牌不用传
//         'type':0,
//         'value':4,
//         'isContainExtra':true,// 特殊牌是否包含特殊牌
//     },
//     {
//         'cards':[{'suit':suit,'number':number},{}],
//         'type':0,
//         'value':4
//     }]
Socket.sendPlayCard = function (userId, cardInfo) {
  cc.assert(userId);
  var param = {
    "userId": userId,
    "card": cardInfo
  };

  this.instance.sendMessage(this.Event.PlayCard, param);
};

Socket.sendTimeoutDissolve = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.TimeoutDissolve, param);
};

Socket.sendFeedback = function (userId, text) {
  cc.assert(userId);
  cc.assert(text);
  var param = {
    "userId": userId,
    "text": text
  };

  this.instance.sendMessage(this.Event.Feedback, param);
};

Socket.sendSharePng = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SharePng, param);
};
// 开始匹配随机场
Socket.sendEnterRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.EnterRandom, param);
};

// 取消匹配随机场
Socket.sendCancelRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.CancelRandom, param);
};

// 准备
Socket.sendReady = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.Ready, param);
}, Socket.sendStartGame = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  cc.log(this.Event.StartGame);
  cc.log();
  this.instance.sendMessage(this.Event.StartGame, param);
},

// 获取大厅信息
Socket.sendGetHallInfo = function (userId) {
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetHallInfo, param);
},

// 获取用户信息
Socket.sendGetUserInfo = function (userId, openId) {
  var param = {
    "userId": userId,
    "openId": openId
  };

  this.instance.sendMessage(this.Event.GetUserInfo, param);
}, module.exports = Socket;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"test":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3a5ah1deZEh6HfPdghRXyA', 'test');
// scripts\KQCard\test.js

this._changeCardScors = function (cardModel) {

    cardModel.forEach(function (card) {
        card.scores = card.number;
    });

    cardModel = this._convertOneToA(cardModel);

    var is14 = true; //是A K Q J 10 ;

    var is1 = true; //是1 2 3 4 5

    cardModel.forEach(function (card) {
        if (card.scores < 10) is14 = false;
    }); //不是A K Q J 10

    cardModel.forEach(function (card) {
        if ((card.scores > 5 || card.scores == 14) && card.scores != 20) is1 = false;
    }); //不是1 2 3 4 5});

    if (is14) {
        //是A K Q J 10 ;

        cardModel.sort(function (a1, a2) {
            return a2.scores - a1.scores;
        });

        var num = 14,
            scoresAyy = []; //一副牌的分数

        for (var i = 0; i < 5; i++) {

            scoresAyy.push(num);

            num -= 1;
        }

        for (var j = 0; j < scoresAyy.length; j++) {

            for (var i = 0; i < cardModel.length; i++) {

                var cardScores = cardModel[i].scores;

                if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
            }
        }

        cardModel.forEach(function (card) {
            if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
        }); //找出选中的牌
    } else if (is1) {
            //是1 2 3 4 5

            cardModel.sort(function (a1, a2) {
                return a2.scores - a1.scores;
            });

            var num = 5,
                scoresAyy = []; //一副牌的分数

            for (var i = 0; i < 5; i++) {

                scoresAyy.push(num);

                num -= 1;
            }

            for (var j = 0; j < scoresAyy.length; j++) {

                for (var i = 0; i < cardModel.length; i++) {

                    var cardScores = cardModel[i].scores;

                    if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
                }
            }

            cardModel.forEach(function (card) {
                if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
            }); //找出选中的牌
        } else {
                cardModel.sort(function (a1, a2) {
                    return a1.scores - a2.scores;
                });

                var scoresAyy = []; //用来装鬼牌分数

                for (var i = 0; i < 5; i++) {

                    var s = parseInt(cardModel[0].scores) + i; //最小的牌的分数

                    scoresAyy.push(s); //一副牌的分数
                }

                for (var j = 0; j < scoresAyy.length; j++) {

                    for (var i = 0; i < cardModel.length; i++) {

                        var cardScores = cardModel[i].scores;

                        if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
                    }
                }
                cardModel.forEach(function (card) {
                    if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
                }); //改变牌的分数
            }

    cardModel = this._convertOneToA(cardModel);

    cardModel.sort(function (a1, a2) {
        return a1.scores - a2.scores;
    });
    return cardModel;
};

cc._RFpop();
},{}],"time":[function(require,module,exports){
"use strict";
cc._RFpush(module, '458d4VWlwNDT6xQ+pFW8Bby', 'time');
// scripts\time.js

cc.Class({
        "extends": cc.Component,

        properties: {
                leftNode: cc.Node,
                RigthNode: cc.Node,
                _time: null
        },

        // use this for initialization
        onLoad: function onLoad() {},

        setTime: function setTime(time) {

                this.unscheduleAllCallbacks();

                this._time = time;

                this.leftNode.rotation = 0;

                this.RigthNode.rotation = 0;

                this.RigthNode.stopAllActions();

                this.leftNode.stopAllActions();

                this.leftNode.runAction(cc.rotateBy(this._time, -180));

                this.scheduleOnce((function () {

                        this.RigthNode.runAction(cc.rotateBy(this._time, 180));
                }).bind(this), this._time);
        }

});

cc._RFpop();
},{}],"userInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e8d10xRGnJAn42wJsuC6aBi', 'userInfo');
// scripts\userInfo.js

var AudioManager = require('AudioManager');
var Playback = require('Playback');

cc.Class({
  'extends': cc.Component,

  properties: {
    spriteAvatar: cc.Sprite,
    labelNickname: cc.Label,
    labelScore: cc.Label,
    spriteOffline: cc.Sprite,
    voiceNode: cc.Node,
    homeRunNode: cc.Node,
    readyNode: cc.Node,
    beilv: cc.Label,
    shootNodes: [cc.Node],
    bankerNode: cc.Node,
    fangZhuNode: cc.Node,
    qingli: cc.Node,
    id: cc.Label
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.updateScore();
  },

  setqingli: function setqingli() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.qingli.active = visible != false;
  },

  setReadyNodeVisible: function setReadyNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.readyNode.active = visible != false;
  },
  setBeilvLabel: function setBeilvLabel(bl) {
    //this.beilv.active = true;
    this.beilv.string = bl ? bl + "倍" : '';
  },

  setFangZhuNodeVisible: function setFangZhuNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.fangZhuNode.active = visible != false;
  },

  updateScore: function updateScore() {
    var score = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    if (score >= 0) {
      this.labelScore.string = "+" + score;
    } else {
      this.labelScore.string = "" + score;
    }
  },
  updateUserId: function updateUserId(id) {
    this.id.string = id ? "ID:" + id : "";
  },
  updateNickname: function updateNickname() {
    var nickname = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

    this.labelNickname.string = nickname;
  },

  updateAvatar: function updateAvatar(avatar) {
    if (avatar.endsWith("png") || avatar.endsWith("jpg") || avatar.endsWith("gif")) {} else {
      //avatar = avatar + ".png";
    }

    cc.loader.load({ url: avatar, type: "jpg" }, (function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      this.spriteAvatar.spriteFrame = frame;
    }).bind(this));
  },

  setOfflineVisible: function setOfflineVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    if (Playback.instance.isPlaybacking()) {
      // 如果是处理回放状态，就不用再处理离线消息了
      return;
    }

    this.spriteOffline.node.active = visible;
  },

  setIsBanker: function setIsBanker() {
    var isBanker = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.bankerNode.active = isBanker;
  },

  playShootAnimation: function playShootAnimation() {
    var toIndex = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    //let shootNode = this.shootNodes[toIndex];
    //shootNode.active = true;
    //let anim = shootNode.getComponent(cc.Animation);
    //anim.play('shoot').on('finished', function () {
    //  shootNode.active = false;
    //}, this);

    AudioManager.instance.playDaQiang();
  },

  playBulletHoleAnimation: function playBulletHoleAnimation() {
    var bulletHoleNode = this.node.getChildByName('bulletHole');
    bulletHoleNode.active = true;
    var anim = bulletHoleNode.getComponent(cc.Animation);
    anim.play('bulletHole').on('finished', function () {
      bulletHoleNode.active = false;
    }, this);
  },

  playSpeakAnimation: function playSpeakAnimation() {
    this.voiceNode.active = true;
    this.scheduleOnce((function () {
      this.voiceNode.active = false;
    }).bind(this), 4);
  },

  // 播放全垒打动画
  playHomeRunAimation: function playHomeRunAimation() {
    //let alert = this.homeRunNode.getComponent('alert');
    //alert.alert();
    //this.scheduleOnce(function () {
    //  this.homeRunNode.active = false;
    //}.bind(this), 2);
  }
});

cc._RFpop();
},{"AudioManager":"AudioManager","Playback":"Playback"}],"zhuanNumCtrl":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1b0dfWuicJLYJDmjjT1lmQc', 'zhuanNumCtrl');
// scripts\zhuanNumCtrl.js

cc.Class({
    "extends": cc.Component,

    properties: {
        zhuanNumLabel: cc.Label,
        jushu: cc.Node,
        AA: cc.Node,
        _selectedPeopleIndex: null,
        _selectedJushuIndex: null,
        _selectedAAIndex: null
    },

    onLoad: function onLoad() {
        this._ctrl();
    },

    clickPeopleAction: function clickPeopleAction() {
        this._ctrl();
    },

    clickAAAction: function clickAAAction() {
        this._ctrl();
    },

    clickJushuAction: function clickJushuAction() {
        this._ctrl();
    },

    _ctrl: function _ctrl() {
        this._selectedPeopleIndex = this.node.getComponent("singleSelect").selectedIndex;
        this._selectedJushuIndex = this.jushu.getComponent("singleSelect").selectedIndex;
        this._selectedAAIndex = this.AA.getComponent("checkSelect").selectedIndex;
        //人数选2人时且没选上AA制收费
        var renShu = 2;
        if (this._selectedPeopleIndex == 0) {
            renShu = 2;
        } else if (this._selectedPeopleIndex == 1) {
            renShu = 3;
        } else if (this._selectedPeopleIndex == 2) {
            renShu = 4;
        } else if (this._selectedPeopleIndex == 3) {
            renShu = 5;
        }
        var zhuangShi = 20;
        if (this._selectedJushuIndex == 0) {
            zhuangShi = 20;
        } else if (this._selectedJushuIndex == 1) {
            zhuangShi = 40;
        } else if (this._selectedJushuIndex == 2) {
            zhuangShi = 80;
        } else if (this._selectedJushuIndex == 3) {
            zhuangShi = 10;
        }
        //AA
        if (this._selectedAAIndex != null) {
            zhuangShi = Math.ceil(zhuangShi / renShu);
        }
        this.zhuanNumLabel.string = zhuangShi;
        //if(this._selectedPeopleIndex == 0){
        //    if(this._selectedAAIndex == null){
        //局数选10局时
        //if(this._selectedJushuIndex == 0){
        //    this.zhuanNumLabel.string = "10";
        //}
        ////局数选20局时
        //if(this._selectedJushuIndex == 1){
        //    this.zhuanNumLabel.string = "30";
        //}
        ////局数选30局时
        //if(this._selectedJushuIndex == 2){
        //    this.zhuanNumLabel.string = "80";
        //}
        //}
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "8";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "15";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "23";
        //        }
        //    }
        //
        //}
        //人数选3人
        //else if(this._selectedPeopleIndex == 1){
        //    //没选上AA制收费
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "42";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "60";
        //        }
        //    }
        //    //选了AA收费
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "20";
        //        }
        //    }
        //
        //}
        ////人数选4人且没选上AA制收费
        //else{
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "28";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "56";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "84";
        //        }
        //    }
        //    //AA制收费选上了
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //    }
        //}
    }
});

cc._RFpop();
},{}]},{},["AudioManager","CardPrefab","CardTypeCombine","CardTypeSprite","ChatMessage","MsgControl","KQGlobalEvent","ArrayExtension","NumberExtension","SpriteHelper","StringExtension","fecha","Invit","GetCardPointsSameCount","KQCard","KQCardColorsHelper","KQCardFindTypeExtension","KQCardPointsHelper","KQCardResHelper","KQCardScoreExtension","KQCardScoretsHelper","KQCardSelectExtension","test","UserModelHelper","NetworkError","ChatTextRecord","CompareCards","Countdown","GameResult","Player","ResultItem","TotalGameResult","TotalGameResultItem","UserSampleInfo","maPai","Playback","Setting","KQGlabolSocketEventHander","KQNativeInvoke","agreement","alert","animation","cardNum","cards","cardsBack","cellText","changInfo","change_mapai","checkSelect","choujiang","create_btn_anima","daikai","game","hall","hall_btn_anima","help","inviteCode","joinRoom","launch","login","manager","overTime","play","product","randRoom","record","recordInfo","rule","scale","select","selectMoShi","select_ma","select_mapai","selectbeilv","singleSelect","slider","socket","time","userInfo","zhuanNumCtrl"])

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL0NvY29zQ3JlYXRvci9yZXNvdXJjZXMvYXBwLmFzYXIvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvQXJyYXlFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9BdWRpby9BdWRpb01hbmFnZXIuanMiLCJhc3NldHMvc2NyaXB0cy9DYXJkUHJlZmFiLmpzIiwiYXNzZXRzL3NjcmlwdHMvQ2FyZFR5cGVDb21iaW5lLmpzIiwiYXNzZXRzL3NjcmlwdHMvQ2FyZFR5cGVTcHJpdGUuanMiLCJhc3NldHMvc2NyaXB0cy9DaGF0L0NoYXRNZXNzYWdlLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGVmYWJzL0NoYXRUZXh0UmVjb3JkLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGVmYWJzL0NvbXBhcmVDYXJkcy5qcyIsImFzc2V0cy9zY3JpcHRzL1BlZmFicy9Db3VudGRvd24uanMiLCIuLi8uLi8uLi8uLi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9iYXNlNjQtanMvaW5kZXguanMiLCIuLi8uLi8uLi8uLi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9idWZmZXIvaW5kZXguanMiLCIuLi8uLi8uLi8uLi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9pZWVlNzU0L2luZGV4LmpzIiwiLi4vLi4vLi4vLi4vQ29jb3NDcmVhdG9yL3Jlc291cmNlcy9hcHAuYXNhci9ub2RlX21vZHVsZXMvaXNhcnJheS9pbmRleC5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvR2FtZVJlc3VsdC5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9HZXRDYXJkUG9pbnRzU2FtZUNvdW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvSW52aXQuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkQ29sb3JzSGVscGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZFBvaW50c0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRSZXNIZWxwZXIuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2NvcmVFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2NvcmV0c0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRTZWxlY3RFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkLmpzIiwiYXNzZXRzL3NjcmlwdHMvU29ja2V0L0tRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIuanMiLCJhc3NldHMvc2NyaXB0cy9FdmVudC9LUUdsb2JhbEV2ZW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvVXRpbHMvS1FOYXRpdmVJbnZva2UuanMiLCJhc3NldHMvc2NyaXB0cy9DaGF0L01zZ0NvbnRyb2wuanMiLCJhc3NldHMvc2NyaXB0cy9OZXR3b3JrRXJyb3IuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL051bWJlckV4dGVuc2lvbi5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXliYWNrL1BsYXliYWNrLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9QbGF5ZXIuanMiLCJhc3NldHMvc2NyaXB0cy9QbGF5L1Jlc3VsdEl0ZW0uanMiLCJhc3NldHMvc2NyaXB0cy9TZXR0aW5nL1NldHRpbmcuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL1Nwcml0ZUhlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvU3RyaW5nRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9Ub3RhbEdhbWVSZXN1bHRJdGVtLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9Ub3RhbEdhbWVSZXN1bHQuanMiLCJhc3NldHMvc2NyaXB0cy9Nb2RlbFV0aWxzL1VzZXJNb2RlbEhlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvVXNlclNhbXBsZUluZm8uanMiLCJhc3NldHMvc2NyaXB0cy9hZ3JlZW1lbnQuanMiLCJhc3NldHMvc2NyaXB0cy9hbGVydC5qcyIsImFzc2V0cy9zY3JpcHRzL2FuaW1hdGlvbi5qcyIsImFzc2V0cy9zY3JpcHRzL2NhcmROdW0uanMiLCJhc3NldHMvc2NyaXB0cy9jYXJkc0JhY2suanMiLCJhc3NldHMvc2NyaXB0cy9jYXJkcy5qcyIsImFzc2V0cy9zY3JpcHRzL2NlbGxUZXh0LmpzIiwiYXNzZXRzL3NjcmlwdHMvY2hhbmdJbmZvLmpzIiwiYXNzZXRzL3NjcmlwdHMvY2hhbmdlX21hcGFpLmpzIiwiYXNzZXRzL3NjcmlwdHMvY2hlY2tTZWxlY3QuanMiLCJhc3NldHMvc2NyaXB0cy9jaG91amlhbmcuanMiLCJhc3NldHMvc2NyaXB0cy9jcmVhdGVfYnRuX2FuaW1hLmpzIiwiYXNzZXRzL3NjcmlwdHMvZGFpa2FpLmpzIiwiYXNzZXRzL3NjcmlwdHMvRXh0ZW5zaW9ucy9mZWNoYS5qcyIsImFzc2V0cy9zY3JpcHRzL2dhbWUuanMiLCJhc3NldHMvc2NyaXB0cy9oYWxsX2J0bl9hbmltYS5qcyIsImFzc2V0cy9zY3JpcHRzL2hhbGwuanMiLCJhc3NldHMvc2NyaXB0cy9oZWxwLmpzIiwiYXNzZXRzL3NjcmlwdHMvaW52aXRlQ29kZS5qcyIsImFzc2V0cy9zY3JpcHRzL2pvaW5Sb29tLmpzIiwiYXNzZXRzL3NjcmlwdHMvbGF1bmNoLmpzIiwiYXNzZXRzL3NjcmlwdHMvbG9naW4uanMiLCJhc3NldHMvc2NyaXB0cy9QbGF5L21hUGFpLmpzIiwiYXNzZXRzL3NjcmlwdHMvbWFuYWdlci5qcyIsImFzc2V0cy9zY3JpcHRzL292ZXJUaW1lLmpzIiwiYXNzZXRzL3NjcmlwdHMvcGxheS5qcyIsImFzc2V0cy9zY3JpcHRzL3Byb2R1Y3QuanMiLCJhc3NldHMvc2NyaXB0cy9yYW5kUm9vbS5qcyIsImFzc2V0cy9zY3JpcHRzL3JlY29yZEluZm8uanMiLCJhc3NldHMvc2NyaXB0cy9yZWNvcmQuanMiLCJhc3NldHMvc2NyaXB0cy9ydWxlLmpzIiwiYXNzZXRzL3NjcmlwdHMvc2NhbGUuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3RNb1NoaS5qcyIsImFzc2V0cy9zY3JpcHRzL3NlbGVjdF9tYXBhaS5qcyIsImFzc2V0cy9zY3JpcHRzL3NlbGVjdF9tYS5qcyIsImFzc2V0cy9zY3JpcHRzL3NlbGVjdGJlaWx2LmpzIiwiYXNzZXRzL3NjcmlwdHMvc2VsZWN0LmpzIiwiYXNzZXRzL3NjcmlwdHMvc2luZ2xlU2VsZWN0LmpzIiwiYXNzZXRzL3NjcmlwdHMvc2xpZGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvc29ja2V0LmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL3Rlc3QuanMiLCJhc3NldHMvc2NyaXB0cy90aW1lLmpzIiwiYXNzZXRzL3NjcmlwdHMvdXNlckluZm8uanMiLCJhc3NldHMvc2NyaXB0cy96aHVhbk51bUN0cmwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUVBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQUo7QUFFSTtBQUNFO0FBQ0E7QUFDRTtBQUFSO0FBQ0E7QUFFSTtBQUFKO0FBQ0E7QUFDQTtBQUVBO0FBQ0U7QUFDRTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFBUjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0U7QUFDRTtBQUNBO0FBREo7QUFDQTtBQUdNO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFETjtBQUNBO0FBR007QUFETjtBQUNBO0FBR007QUFDRTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHTTtBQUROO0FBQ0E7QUFHTTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBR1E7QUFDRTtBQURWO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFHTTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNFO0FBQ0U7QUFDQTtBQURKO0FBQ0E7QUFDTTtBQUNFO0FBQ1I7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNOO0FBQ007QUFDRTtBQUNSO0FBQ1E7QUFDRTtBQUNBO0FBQ0U7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNVO0FBQ0U7QUFDWjtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFDQTtBQUNFO0FBQVI7QUFFTTtBQUNFO0FBQVI7QUFFTTtBQUFOO0FBRUk7QUFDQTtBQUNFO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRU07QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUVNO0FBQ0E7QUFDQTtBQUFOO0FBQ0E7QUFFUTtBQUNFO0FBQVY7QUFDQTtBQUNBO0FBRVE7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFTTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRU07QUFBTjtBQUVNO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFBVjtBQUVVO0FBQVY7QUFFUTtBQUFSO0FBQ0E7QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0U7QUFBRjtBQUNBO0FBQUk7QUFDRTtBQUVOO0FBQ0E7QUFBSTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFFVjtBQUNBO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUVWO0FBQVU7QUFFVjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDSjtBQUNBO0FBRE07QUFHTjtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0U7QUFHRjtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBQ0E7QUFIQTtBQUNFO0FBQ0U7QUFDQTtBQUtKO0FBQ0E7QUFMTTtBQU9OO0FBQ0E7QUFOUTtBQUNBO0FBQ0U7QUFRVjtBQU5RO0FBQ0E7QUFDRTtBQVFWO0FBTlU7QUFDQTtBQVFWO0FBQ0E7QUFDQTtBQXBCTTtBQXNCTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWk07QUFjTjtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQWNSO0FBQ0E7QUFaTTtBQUNFO0FBY1I7QUFDQTtBQVpNO0FBQ0E7QUFDQTtBQWNOO0FBWk07QUFjTjtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQWNSO0FBQ0E7QUFaTTtBQUNFO0FBQ0E7QUFjUjtBQUNBO0FBWk07QUFjTjtBQVpNO0FBY047QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFjUjtBQUNBO0FBWk07QUFDQTtBQUNFO0FBQ0U7QUFjVjtBQUNBO0FBQ0E7QUFaTTtBQWNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVpBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0k7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFDSTtBQUFoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQVE7QUFDQTtBQUVSO0FBQVE7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUZRO0FBQ0E7QUFJUjtBQUZRO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBRkk7QUFJSjtBQUNBO0FBSlE7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBQ0E7QUFKUTtBQUNBO0FBQ0k7QUFDSTtBQU1oQjtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFQUTtBQVNSO0FBUFk7QUFDQTtBQUNBO0FBQ0E7QUFTWjtBQUNBO0FBUFE7QUFDQTtBQUNBO0FBU1I7QUFDQTtBQUNBO0FBUEk7QUFTSjtBQUNBO0FBVFE7QUFDQTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFDSTtBQVdaO0FBQ0E7QUFDQTtBQVRJO0FBQ0k7QUFXUjtBQUNBO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFDSTtBQVdaO0FBVFE7QUFDQTtBQUNBO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQVdSO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFEWjtBQUNBO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBQ0k7QUFEWjtBQUdRO0FBRFI7QUFHUTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBR1E7QUFEUjtBQUdRO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDelNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNNO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRE07QUFHTjtBQUNBO0FBREk7QUFDRTtBQUdOO0FBQ0E7QUFESTtBQUNFO0FBQ0E7QUFDRTtBQUdSO0FBQ0E7QUFETTtBQUdOO0FBQ0E7QUFESTtBQUNFO0FBR047QUFETTtBQUNFO0FBQ0U7QUFDQTtBQUdWO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0VBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQURBO0FBQ0k7QUFDQTtBQUNJO0FBR1I7QUFESTtBQUNJO0FBR1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBQVE7QUFFUjtBQUFRO0FBQ0E7QUFFUjtBQUNBO0FBQVE7QUFFUjtBQUFRO0FBQ0E7QUFDQTtBQUNBO0FBRVI7QUFBUTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVSO0FBQVE7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFFUjtBQUNBO0FBQUk7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFRO0FBRVI7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUVSO0FBRFk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdaO0FBQ0E7QUFEWTtBQUNBO0FBQ0E7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFEUTtBQUNJO0FBR1o7QUFDQTtBQURRO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUpRO0FBTVI7QUFKUTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSlE7QUFDQTtBQUNBO0FBTVI7QUFKUTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUpRO0FBTVI7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQU1SO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQU1aO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFBOEQ7QUFPdEU7QUFQMEc7QUFTMUc7QUFDQTtBQVJRO0FBQ0E7QUFDQTtBQUNBO0FBVVI7QUFDQTtBQUNBO0FBUkk7QUFVSjtBQVJRO0FBVVI7QUFSUTtBQVVSO0FBUlE7QUFBcUM7QUFXN0M7QUFDQTtBQVZRO0FBQ0E7QUFDQTtBQUNJO0FBWVo7QUFDQTtBQUNBO0FBVkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVlE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFZaEI7QUFWWTtBQVlaO0FBVlE7QUFZUjtBQVZRO0FBQ0k7QUFZWjtBQUNBO0FBQ0E7QUFWSTtBQUNJO0FBWVI7QUFDQTtBQVZJO0FBQ0k7QUFZUjtBQUNBO0FBVkk7QUFDSTtBQVlSO0FBQ0E7QUFDQTtBQVZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVlSO0FBWFk7QUFDQTtBQUNBO0FBYVo7QUFaZ0I7QUFDSTtBQWNwQjtBQVpvQjtBQWNwQjtBQUNBO0FBWmdCO0FBY2hCO0FBQ0E7QUFDQTtBQWJZO0FBQ0E7QUFlWjtBQWJRO0FBQ0E7QUFDQTtBQUNBO0FBZVI7QUFDQTtBQWJJO0FBQ0k7QUFDQTtBQWVSO0FBQ0E7QUFiSTtBQUNJO0FBZVI7QUFiUTtBQUNBO0FBZVI7QUFiUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBZVo7QUFDQTtBQUNBO0FBQ0E7QUFiSTtBQWVKO0FBQ0E7QUFDQTtBQWJRO0FBQ0E7QUFDSTtBQUNBO0FBZVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQlE7QUFDSTtBQUNBO0FBQ0E7QUFtQlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQlE7QUFtQlI7QUFDQTtBQWpCSTtBQUNJO0FBQ0k7QUFtQlo7QUFqQlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQW1CWjtBQWpCUTtBQW1CUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQlE7QUFDSTtBQW1CWjtBQUNBO0FBakJRO0FBbUJSO0FBQ0E7QUFqQkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbUJSO0FBakJRO0FBbUJSO0FBQ0E7QUFDQTtBQWpCSTtBQUNJO0FBbUJSO0FBakJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQW1CaEI7QUFqQlk7QUFtQlo7QUFqQlE7QUFDQTtBQUNBO0FBQ0E7QUFtQlI7QUFqQlE7QUFtQlI7QUFqQlk7QUFtQlo7QUFDQTtBQWpCUTtBQW1CUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpCSTtBQUNJO0FBQ0k7QUFtQlo7QUFqQlk7QUFtQlo7QUFqQlk7QUFtQlo7QUFqQlE7QUFtQlI7QUFDQTtBQUNBO0FBakJJO0FBbUJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQkk7QUFtQko7QUFqQlE7QUFtQlI7QUFqQlE7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQW1CaEI7QUFqQm9CO0FBbUJwQjtBQUNBO0FBQ0E7QUFqQlE7QUFtQlI7QUFDQTtBQWpCSTtBQUNJO0FBQ0E7QUFDSTtBQW1CWjtBQWpCUTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBbUJoQjtBQWpCWTtBQW1CWjtBQWpCUTtBQW1CUjtBQUNBO0FBakJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFtQmhCO0FBbEJvQjtBQW9CcEI7QUFDQTtBQWxCWTtBQUNJO0FBb0JoQjtBQUNBO0FBQ0E7QUFDQTtBQWxCUTtBQW9CUjtBQWxCWTtBQW9CWjtBQWxCWTtBQW9CWjtBQWxCWTtBQW9CWjtBQWxCWTtBQW9CWjtBQWxCWTtBQUNJO0FBb0JoQjtBQWxCZ0I7QUFvQmhCO0FBQ0E7QUFsQlk7QUFDSTtBQW9CaEI7QUFDQTtBQUNBO0FBbEJRO0FBQ0k7QUFDQTtBQW9CWjtBQW5CZ0I7QUFxQmhCO0FBQ0E7QUFuQlk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXFCWjtBQW5CWTtBQXFCWjtBQXBCZ0I7QUFDQTtBQUNJO0FBc0JwQjtBQUNBO0FBcEJZO0FBc0JaO0FBckJnQjtBQUNBO0FBQ0k7QUF1QnBCO0FBQ0E7QUFyQlk7QUF1Qlo7QUF0QmdCO0FBQ0E7QUFDSTtBQXdCcEI7QUFDQTtBQUNBO0FBdEJZO0FBQ0E7QUFDSTtBQUNJO0FBd0JwQjtBQUNBO0FBQ0E7QUF0Qlk7QUF3Qlo7QUF2QmdCO0FBeUJoQjtBQXZCWTtBQXlCWjtBQXhCZ0I7QUEwQmhCO0FBeEJZO0FBMEJaO0FBekJnQjtBQTJCaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF6Qlk7QUFFSTtBQTBCaEI7QUFDQTtBQUNBO0FBeEJRO0FBQ0E7QUFBb0Q7QUEyQjVEO0FBMUJRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNEJaO0FBQ0E7QUExQlE7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBNEJwQjtBQUNBO0FBQ0E7QUFDQTtBQTFCUTtBQTRCUjtBQTFCUTtBQUNBO0FBNEJSO0FBMUJRO0FBNEJSO0FBM0JZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUE2QnBCO0FBQ0E7QUFDQTtBQUNBO0FBM0JRO0FBQ0k7QUFDQTtBQUNBO0FBNkJaO0FBM0JZO0FBQ0E7QUFDQTtBQTZCWjtBQTNCWTtBQUNBO0FBNkJaO0FBM0JZO0FBNkJaO0FBQ0E7QUEzQlE7QUFDSTtBQTZCWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTNCUTtBQTZCUjtBQTNCWTtBQUF1QztBQThCbkQ7QUFDQTtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQUNBO0FBN0JRO0FBQ0E7QUFDQTtBQStCUjtBQTlCWTtBQUNBO0FBQ0E7QUFDQTtBQUF5QjtBQWlDckM7QUFoQ1k7QUFBeUI7QUFtQ3JDO0FBbENZO0FBQXlCO0FBcUNyQztBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQXBDWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBc0NaO0FBcENRO0FBc0NSO0FBcENRO0FBc0NSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBDSTtBQUNJO0FBc0NSO0FBcENRO0FBc0NSO0FBcENRO0FBc0NSO0FBcENZO0FBc0NaO0FBcENZO0FBc0NaO0FBQ0E7QUFuQ1E7QUFxQ1I7QUFuQ1E7QUFxQ1I7QUFuQ1E7QUFxQ1I7QUFsQ1E7QUFvQ1I7QUFsQ1k7QUFvQ1o7QUFsQ1k7QUFvQ1o7QUFsQ1k7QUFDQTtBQUNJO0FBb0NoQjtBQWpDZ0I7QUFtQ2hCO0FBQ0E7QUFqQ1k7QUFtQ1o7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ29CO0FBbUNwQjtBQWpDb0I7QUFtQ3BCO0FBakNvQjtBQW1DcEI7QUFqQ3dCO0FBQVU7QUFvQ2xDO0FBQ0E7QUFuQ3dCO0FBcUN4QjtBQW5Dd0I7QUFxQ3hCO0FBbkN3QjtBQXFDeEI7QUFuQ3dCO0FBcUN4QjtBQW5Dd0I7QUFxQ3hCO0FBQ0E7QUFsQ29CO0FBb0NwQjtBQUNBO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQUNBO0FBQ0E7QUFoQ1E7QUFrQ1I7QUFDQTtBQUNBO0FBQ0E7QUEvQkk7QUFpQ0o7QUFDQTtBQWhDUTtBQWtDUjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQUNBO0FBL0JRO0FBaUNSO0FBL0JRO0FBaUNSO0FBL0JRO0FBQ0k7QUFpQ1o7QUE5Qlk7QUFnQ1o7QUE5QlE7QUFDQTtBQUNBO0FBZ0NSO0FBQ0E7QUFDQTtBQUNBO0FBOUJRO0FBZ0NSO0FBOUJZO0FBZ0NaO0FBOUJZO0FBZ0NaO0FBOUJnQjtBQWdDaEI7QUFDQTtBQUNBO0FBQ0E7QUE1QlE7QUE4QlI7QUE1Qlk7QUE4Qlo7QUE1Qlk7QUFBbUM7QUErQi9DO0FBQ0E7QUFDQTtBQTlCUTtBQWdDUjtBQTlCUTtBQWdDUjtBQTlCUTtBQUE0RDtBQWlDcEU7QUFDQTtBQWhDUTtBQWtDUjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQWhDZ0I7QUFrQ2hCO0FBaENnQjtBQWtDaEI7QUFoQ2dCO0FBa0NoQjtBQWhDb0I7QUFrQ3BCO0FBaENvQjtBQWtDcEI7QUFoQ29CO0FBa0NwQjtBQWhDd0I7QUFDSTtBQWtDNUI7QUFDQTtBQWhDd0I7QUFrQ3hCO0FBQ0E7QUEvQm9CO0FBaUNwQjtBQS9Cb0I7QUFpQ3BCO0FBL0JvQjtBQWlDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTNCSTtBQTZCSjtBQTNCUTtBQTZCUjtBQTNCUTtBQTZCUjtBQTNCUTtBQTZCUjtBQTNCUTtBQTZCUjtBQUNBO0FBM0JJO0FBNkJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJJO0FBOEJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdCSTtBQStCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdCSTtBQStCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdCSTtBQStCSjtBQTdCUTtBQUNBO0FBK0JSO0FBN0JZO0FBK0JaO0FBN0JZO0FBK0JaO0FBN0JZO0FBK0JaO0FBQ0E7QUFDQTtBQTVCSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFBMEM7QUErQnREO0FBQ0E7QUE5QlE7QUFnQ1I7QUE5Qlk7QUFnQ1o7QUE5Qlk7QUFnQ1o7QUE5QmdCO0FBZ0NoQjtBQTlCZ0I7QUFnQ2hCO0FBOUJnQjtBQWdDaEI7QUFDQTtBQTdCWTtBQStCWjtBQTdCZ0I7QUErQmhCO0FBN0JnQjtBQUFtQztBQWdDbkQ7QUFDQTtBQS9CZ0I7QUFpQ2hCO0FBL0JnQjtBQWlDaEI7QUEvQm9CO0FBaUNwQjtBQS9Cb0I7QUFpQ3BCO0FBQ0E7QUE5QmdCO0FBZ0NoQjtBQTlCZ0I7QUFnQ2hCO0FBOUJnQjtBQWdDaEI7QUFDQTtBQTdCWTtBQStCWjtBQUNBO0FBQ0E7QUEzQkk7QUE2Qko7QUFDQTtBQUNBO0FBN0JRO0FBK0JSO0FBN0JZO0FBQThEO0FBZ0MxRTtBQWhDOEc7QUFrQzlHO0FBQ0E7QUFqQ1k7QUFtQ1o7QUFqQ1k7QUFBNkI7QUFBeUI7QUFBb0I7QUFzQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBdkNZO0FBeUNaO0FBQ0E7QUFDQTtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQUNBO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBQ0E7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUFBOEM7QUF5Q3REO0FBQ0E7QUF4Q1E7QUEwQ1I7QUF4Q1k7QUEwQ1o7QUF4Q1k7QUEwQ1o7QUF4Q1k7QUEwQ1o7QUFDQTtBQUNBO0FBdkNJO0FBQ0k7QUF5Q1I7QUFDQTtBQXZDSTtBQUNJO0FBeUNSO0FBQ0E7QUF2Q0k7QUFDSTtBQXlDUjtBQUNBO0FBdkNJO0FBQ0k7QUFDQTtBQUNBO0FBeUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2Q1E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUF5Q3hCO0FBdkN3QjtBQUNBO0FBeUN4QjtBQUNBO0FBQ0E7QUF0Q29CO0FBQ0E7QUF3Q3BCO0FBdENnQjtBQUNJO0FBQ0E7QUF3Q3BCO0FBdENvQjtBQXdDcEI7QUF0Q29CO0FBQ0E7QUF3Q3BCO0FBQ0E7QUFyQ2dCO0FBdUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFyQ0k7QUF1Q0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdENJO0FBd0NKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkNJO0FBeUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUF5Q1o7QUFDQTtBQXZDUTtBQUNBO0FBQ0E7QUFDQTtBQXlDUjtBQUNBO0FBQ0E7QUF2Q0k7QUFDSTtBQXlDUjtBQUNBO0FBQ0E7QUF2Q0k7QUF5Q0o7QUF2Q1E7QUF5Q1I7QUFDQTtBQUNBO0FBdkNJO0FBeUNKO0FBdkNRO0FBeUNSO0FBQ0E7QUF2Q0k7QUFDSTtBQUNJO0FBeUNaO0FBQ0E7QUF2Q1E7QUF5Q1I7QUFDQTtBQXZDWTtBQXlDWjtBQUNBO0FBdkNRO0FBeUNSO0FBQ0E7QUFDQTtBQXZDSTtBQXlDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkNJO0FBeUNKO0FBQ0E7QUFDQTtBQUNBO0FBdkNJO0FBeUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbHNEQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQURKO0FBQ0E7QUFDTTtBQUNBO0FBQ0k7QUFDVjtBQUNNO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ007QUFDRTtBQUNFO0FBQ0E7QUFDVjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdEQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBRlE7QUFDSTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGUTtBQUNBO0FBSVI7QUFGUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBSVo7QUFDQTtBQUZRO0FBQ0E7QUFJUjtBQUZRO0FBQ0E7QUFJUjtBQUZRO0FBQ0k7QUFJWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFDSTtBQUlaO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDSTtBQUNJO0FBQ0E7QUFJUjtBQUZJO0FBSUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEdBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUVJO0FBQUo7QUFJSTtBQUNFO0FBRk47QUFDQTtBQUlJO0FBQ0U7QUFGTjtBQUNBO0FBSUk7QUFDSTtBQUZSO0FBSUk7QUFDSTtBQUZSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFBUjtBQUVRO0FBQTRDO0FBQ3BEO0FBQ0E7QUFBUTtBQUVSO0FBQVE7QUFFUjtBQUFRO0FBRVI7QUFBUTtBQUVSO0FBQVk7QUFFWjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQ0E7QUFDUTtBQUE2QztBQUVyRDtBQUNBO0FBRFE7QUFBMkM7QUFJbkQ7QUFDQTtBQUhRO0FBS1I7QUFIUTtBQUtSO0FBSFE7QUFLUjtBQUNBO0FBQ0E7QUFIUTtBQUtSO0FBSFE7QUFLUjtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFLWjtBQUhZO0FBS1o7QUFDQTtBQUZRO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFJWjtBQUZRO0FBQThCO0FBS3RDO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNWjtBQUpZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNWjtBQUNBO0FBSlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNUjtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFLUjtBQUhRO0FBQ0E7QUFDSTtBQUNBO0FBS1o7QUFIWTtBQUtaO0FBSFE7QUFDQTtBQUtSO0FBQ0E7QUFISTtBQUNJO0FBS1I7QUFIWTtBQUtaO0FBSFk7QUFLWjtBQUhZO0FBS1o7QUFIZ0I7QUFBVTtBQU0xQjtBQUNBO0FBTGdCO0FBT2hCO0FBTGdCO0FBT2hCO0FBTGdCO0FBT2hCO0FBTGdCO0FBT2hCO0FBTGdCO0FBT2hCO0FBQ0E7QUFKWTtBQU1aO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFKUTtBQU1SO0FBSlE7QUFNUjtBQUpRO0FBQ0k7QUFDSTtBQU1oQjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFDQTtBQUhRO0FBQ0E7QUFDQTtBQUtSO0FBSFE7QUFLUjtBQUhRO0FBQ0E7QUFDQTtBQUtSO0FBQ0E7QUFIUTtBQUNBO0FBQ0E7QUFLUjtBQUNBO0FBSFE7QUFDQTtBQUtSO0FBSFE7QUFBMEM7QUFNbEQ7QUFDQTtBQUxRO0FBQ0E7QUFDQTtBQU9SO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFDQTtBQU5RO0FBQ0k7QUFDQTtBQVFaO0FBQ0E7QUFOUTtBQVFSO0FBTlk7QUFRWjtBQU5ZO0FBUVo7QUFOWTtBQVFaO0FBTlk7QUFRWjtBQU5ZO0FBUVo7QUFOWTtBQVFaO0FBTlk7QUFRWjtBQU5nQjtBQVFoQjtBQU5nQjtBQVFoQjtBQUNBO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMWTtBQU9aO0FBTFk7QUFBUTtBQVFwQjtBQUNBO0FBQ0E7QUFOUTtBQVFSO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDUTtBQU9oQjtBQUNBO0FBTFE7QUFPUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFPUjtBQUxZO0FBT1o7QUFMWTtBQU9aO0FBTFk7QUFPWjtBQUxZO0FBT1o7QUFMWTtBQU9aO0FBTFk7QUFPWjtBQUxnQjtBQU9oQjtBQUxnQjtBQU9oQjtBQUNBO0FBSmdCO0FBTWhCO0FBSmdCO0FBTWhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUNBO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUhRO0FBQ0k7QUFLWjtBQUZZO0FBSVo7QUFDQTtBQUZRO0FBQWlEO0FBS3pEO0FBQ0E7QUFKUTtBQU1SO0FBQ0E7QUFISTtBQUNJO0FBS1I7QUFDQTtBQUhRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFLWjtBQUNBO0FBSFE7QUFDQTtBQUNBO0FBQ0k7QUFLWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBQ0k7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBSUo7QUFGUTtBQUlSO0FBRlE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFDSTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBSUo7QUFGUTtBQUlSO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUloQjtBQUZnQjtBQUloQjtBQUZnQjtBQUloQjtBQUZnQjtBQUloQjtBQUZnQjtBQUloQjtBQUZnQjtBQUloQjtBQURZO0FBQStDO0FBSTNEO0FBSFk7QUFLWjtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDQTtBQUtSO0FBSFE7QUFDQTtBQUNJO0FBQ0k7QUFLaEI7QUFIZ0I7QUFLaEI7QUFIWTtBQUNBO0FBQ0E7QUFDQTtBQUtaO0FBSFE7QUFDQTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBQ0E7QUFLWjtBQUZZO0FBQ0E7QUFJWjtBQURZO0FBQ0E7QUFHWjtBQUNBO0FBRFE7QUFDQTtBQUE4QjtBQUl0QztBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBSVI7QUFGUTtBQUlSO0FBRlk7QUFBa0U7QUFLOUU7QUFKb0Q7QUFNcEQ7QUFDQTtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMWTtBQU9aO0FBTFk7QUFBMkM7QUFRdkQ7QUFDQTtBQVBZO0FBU1o7QUFQWTtBQVNaO0FBQ0E7QUFOUTtBQVFSO0FBTlE7QUFRUjtBQU5ZO0FBUVo7QUFDQTtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQ0k7QUFNWjtBQUNBO0FBSlE7QUFDQTtBQUNBO0FBQ0E7QUFNUjtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNUjtBQUpRO0FBTVI7QUFKUTtBQUNJO0FBQ0E7QUFNWjtBQUpRO0FBTVI7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBTlE7QUFDSTtBQUNJO0FBQ0E7QUFRaEI7QUFOWTtBQUNBO0FBQ0E7QUFDQTtBQVFaO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFRWjtBQU5RO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNBO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFDSTtBQVFaO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNJO0FBUVo7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNwQkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ1o7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0RBLEFENERBO0FDM0RBLEFENERBO0FDM0RBLEFENERBO0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNsSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzd2REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRjtBQUNBO0FBRUE7QUFDRTtBQUFGO0FBRUU7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBRUk7QUFBSjtBQUVJO0FBQ0E7QUFDQTtBQUFKO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFBSjtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQUo7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUo7QUFFSTtBQUNFO0FBQU47QUFFTTtBQUFOO0FBQ0E7QUFFSTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFBUjtBQUNBO0FBRU07QUFDQTtBQUNBO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQUo7QUFDQTtBQUVFO0FBQ0U7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBRUU7QUFDRTtBQUNFO0FBQU47QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBRUk7QUFDQTtBQUFKO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0SEE7QUFDQTtBQUNDO0FBQ0c7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNaO0FBQ1k7QUFDWjtBQUNRO0FBQ0k7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ1E7QUFDUjtBQUNNO0FBQ0E7QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUFNO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBQ0U7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0U7QUFDQTtBQUVFO0FBQ1Y7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDVjtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckZBO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNKO0FBQ0E7QUFDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDQTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0o7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFBTTtBQUNBO0FBQ0U7QUFDRTtBQUVWO0FBQVE7QUFFUjtBQUNBO0FBQ0E7QUFDQTtBQUFFO0FBQ0U7QUFDQTtBQUNBO0FBRUo7QUFBRTtBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDRTtBQUNBO0FBRUY7QUFBRTtBQUNFO0FBQ0k7QUFFUjtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQ0E7QUFBRTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBRVo7QUFBWTtBQUVaO0FBQ0E7QUFBUTtBQUNFO0FBQ0U7QUFFWjtBQUFVO0FBRVY7QUFDQTtBQUFRO0FBRVI7QUFDQTtBQUNBO0FBRUU7QUFDQTtBQUNFO0FBQUo7QUFFRTtBQUFGO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDRTtBQUNFO0FBQUo7QUFFRTtBQUFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFDQTtBQUNBO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDQTtBQUFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUVSO0FBQ0E7QUFDTTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ1I7QUFDTTtBQUNOO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDTjtBQUFRO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBRWQ7QUFDQTtBQUNBO0FBQVE7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFERTtBQUNFO0FBR0o7QUFESTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ0E7QUFHVjtBQUNBO0FBRE07QUFHTjtBQURJO0FBR0o7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBSEU7QUFDRTtBQUtKO0FBSEU7QUFDQTtBQUNFO0FBS0o7QUFIRTtBQUtGO0FBSEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUtSO0FBQ0E7QUFGTTtBQUNFO0FBQ0E7QUFJUjtBQUNBO0FBRk07QUFDRTtBQUNBO0FBSVI7QUFDQTtBQUZNO0FBQ0U7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUNBO0FBRkU7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBSVI7QUFGTTtBQUlOO0FBQ0E7QUFDQTtBQUNBO0FBRkU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBTFU7QUFDSTtBQU9kO0FBTlU7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFRaEI7QUFDQTtBQUNBO0FBTFU7QUFPVjtBQUxVO0FBT1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMRTtBQUNFO0FBT0o7QUFMSTtBQUNBO0FBQ0U7QUFPTjtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFDRTtBQUNBO0FBQ0U7QUFPSjtBQUxFO0FBT0Y7QUFMRTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9OO0FBQ0E7QUFMRTtBQUNFO0FBT0o7QUFMRTtBQUNBO0FBT0Y7QUFDQTtBQUxBO0FBQ0U7QUFDRTtBQU9KO0FBTEU7QUFDQTtBQU9GO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQVBFO0FBQ0U7QUFTSjtBQVBFO0FBQ0U7QUFTSjtBQUNBO0FBUEU7QUFDRTtBQVNKO0FBUEU7QUFTRjtBQUNBO0FBUEU7QUFDRTtBQVNKO0FBUEU7QUFDRTtBQUNBO0FBQ0E7QUFTSjtBQUNBO0FBUEU7QUFTRjtBQUNBO0FBUEU7QUFDRTtBQUNBO0FBU0o7QUFSTTtBQUNBO0FBQ0U7QUFVUjtBQVJVO0FBQ0U7QUFVWjtBQUNBO0FBUlU7QUFVVjtBQVJRO0FBVVI7QUFDQTtBQVJNO0FBQ0E7QUFVTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFURTtBQUNBO0FBQ0U7QUFXSjtBQUNBO0FBVEU7QUFDRTtBQVdKO0FBQ0E7QUFURTtBQVdGO0FBVEE7QUFXQTtBQUNBO0FBWEU7QUFDRTtBQWFKO0FBWEU7QUFDQTtBQUNFO0FBYUo7QUFYRTtBQWFGO0FBWEU7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBYU47QUFDQTtBQUNBO0FBWEU7QUFDRTtBQWFKO0FBWEU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFhTjtBQUNBO0FBQ0E7QUFkUTtBQUNJO0FBZ0JaO0FBZlE7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFpQmQ7QUFDQTtBQUNBO0FBQ0E7QUFkUTtBQUNBO0FBZ0JSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmRTtBQUNFO0FBaUJKO0FBZkk7QUFDQTtBQUNFO0FBaUJOO0FBZkk7QUFpQko7QUFDQTtBQWZBO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFpQk47QUFDQTtBQWZJO0FBQ0U7QUFDRTtBQUNFO0FBaUJWO0FBZlE7QUFDRTtBQWlCVjtBQWZRO0FBaUJSO0FBQ0E7QUFmTTtBQUNFO0FBaUJSO0FBQ0E7QUFmTTtBQUNBO0FBQ0E7QUFpQk47QUFDQTtBQUNBO0FBZkU7QUFpQkY7QUFDQTtBQUNBO0FBQ0E7QUFmQTtBQWlCQTtBQUNBO0FBakJFO0FBQ0U7QUFtQko7QUFDQTtBQWpCRTtBQUNBO0FBbUJGO0FBakJFO0FBQ0E7QUFDRTtBQUNBO0FBbUJKO0FBbEJNO0FBQ0E7QUFDRTtBQUNFO0FBb0JWO0FBbEJVO0FBb0JWO0FBQ0E7QUFsQk07QUFDQTtBQW9CTjtBQUNBO0FBQ0E7QUFuQkU7QUFxQkY7QUFuQkE7QUFDRTtBQUNFO0FBcUJKO0FBbkJFO0FBQ0E7QUFDRTtBQXFCSjtBQW5CRTtBQXFCRjtBQW5CRTtBQXFCRjtBQW5CRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFxQk47QUFDQTtBQUNBO0FBdEJRO0FBQ0k7QUF3Qlo7QUF2QlE7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUF5QmQ7QUFDQTtBQUNBO0FBQ0E7QUF0QlE7QUFDQTtBQXdCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkJFO0FBeUJGO0FBQ0E7QUF2QkE7QUFDRTtBQUNBO0FBQ0U7QUF5Qko7QUFDQTtBQXRCRTtBQUNBO0FBQ0E7QUF3QkY7QUFDQTtBQUNBO0FBdEJFO0FBQ0U7QUFDRTtBQUNFO0FBd0JSO0FBdEJRO0FBQ0E7QUF3QlI7QUF0QlE7QUF3QlI7QUFDQTtBQUNBO0FBdEJJO0FBQ0U7QUFDRTtBQXdCUjtBQUNBO0FBQ0E7QUFDQTtBQXRCUTtBQUNBO0FBd0JSO0FBQ0E7QUFDQTtBQUNBO0FBdEJRO0FBd0JSO0FBQ0E7QUFDQTtBQUNBO0FBcEJFO0FBQ0U7QUFzQko7QUFwQkU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQXNCWjtBQUNBO0FBcEJRO0FBQ0U7QUFzQlY7QUFDQTtBQXBCTTtBQUNFO0FBc0JSO0FBQ0E7QUFDQTtBQXBCRTtBQUNFO0FBc0JKO0FBcEJFO0FBc0JGO0FBcEJBO0FBQ0U7QUFDQTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0E7QUFDRTtBQXNCSjtBQXBCRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQXNCTjtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBc0JOO0FBQ0E7QUFDQTtBQXBCRTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFzQlo7QUFDQTtBQXBCUTtBQUNFO0FBc0JWO0FBQ0E7QUFwQk07QUFDRTtBQXNCUjtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQXNCSjtBQXBCRTtBQXNCRjtBQUNBO0FBcEJBO0FBc0JBO0FBQ0E7QUF0QkU7QUF3QkY7QUF2Qkk7QUFDRTtBQUNBO0FBQ0U7QUF5QlI7QUFDQTtBQUNBO0FBdkJFO0FBQ0U7QUF5Qko7QUF2QkU7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBeUJOO0FBeEJRO0FBQ0U7QUFDQTtBQUNFO0FBMEJaO0FBQ0E7QUFDQTtBQXhCUTtBQUNBO0FBQ0U7QUEwQlY7QUFDQTtBQUNBO0FBQ0E7QUF4QkU7QUFDRTtBQTBCSjtBQXhCRTtBQUNBO0FBMEJGO0FBQ0E7QUF4QkE7QUFDRTtBQUNFO0FBMEJKO0FBeEJJO0FBQ0E7QUEwQko7QUF6Qk07QUFDRTtBQTJCUjtBQXpCUTtBQUNBO0FBMkJSO0FBQ0E7QUFDQTtBQXpCSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQTJCVjtBQXpCTTtBQTJCTjtBQTFCUTtBQUNBO0FBNEJSO0FBQ0E7QUFDQTtBQXpCRTtBQTJCRjtBQUNBO0FBeEJBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQWdCRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0NEJBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0o7QUFDVTtBQUNWO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDQTtBQUdBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDRTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBQ007QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0Y7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNOO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDTjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0Y7QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNKO0FBQ0k7QUFDRTtBQUNOO0FBQ007QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFFSTtBQUFKO0FBQ007QUFDTjtBQUNJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDSTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQU47QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUdJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUROO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUROO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFDQTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBSE47QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBTUk7QUFKSjtBQUtNO0FBSE47QUFLSTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBSE47QUFLTTtBQUNBO0FBSE47QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUpOO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUNFO0FBSFY7QUFLVTtBQUhWO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDQTtBQUhOO0FBS0k7QUFISjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFMTjtBQU1RO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUpaO0FBQ0E7QUFDQTtBQVFRO0FBTlI7QUFPVTtBQUNFO0FBQ0E7QUFMWjtBQU9ZO0FBQ0E7QUFMWjtBQUNBO0FBQ0E7QUFDQTtBQVVJO0FBUko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdJO0FBQ0E7QUFDQTtBQUNBO0FBVEo7QUFXSTtBQUNFO0FBQ0U7QUFUUjtBQVdNO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBVFY7QUFXVTtBQVRWO0FBQ0E7QUFDQTtBQUNBO0FBV007QUFDRTtBQUNBO0FBVFI7QUFXTTtBQVROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXSTtBQUNFO0FBVE47QUFVUTtBQVJSO0FBU1U7QUFDRTtBQUNBO0FBQ0E7QUFQWjtBQUNBO0FBQ0E7QUFVUTtBQVJSO0FBU1U7QUFDRTtBQUNBO0FBQ0E7QUFQWjtBQUNBO0FBQ0E7QUFDQTtBQVdJO0FBQ0U7QUFDQTtBQVROO0FBV0k7QUFUSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWUk7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFWTjtBQVlJO0FBQ0U7QUFDQTtBQVZOO0FBWUk7QUFWSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYUU7QUFDQTtBQUNFO0FBWEo7QUFDQTtBQWFFO0FBQ0E7QUFYRjtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFYTjtBQUNBO0FBQ0E7QUFhRTtBQUNBO0FBWEY7QUFhRTtBQUNFO0FBQ0U7QUFYTjtBQUNBO0FBYUU7QUFDRTtBQUNBO0FBQ0U7QUFYTjtBQUNBO0FBYUU7QUFDRTtBQUNFO0FBWE47QUFDQTtBQUNBO0FBYUU7QUFYRjtBQVlJO0FBQ0U7QUFDRTtBQVZSO0FBQ0E7QUFDQTtBQVlJO0FBQ0U7QUFWTjtBQVlJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFWTjtBQVlJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFWVjtBQUNBO0FBQ0E7QUFDQTtBQVlJO0FBVko7QUFXTTtBQUNFO0FBVFI7QUFDQTtBQUNBO0FBQ0E7QUFXSTtBQUNFO0FBVE47QUFXSTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBVE47QUFXSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBVFY7QUFDQTtBQUNBO0FBQ0E7QUFXSTtBQVRKO0FBVU07QUFDRTtBQVJSO0FBQ0E7QUFDQTtBQVdJO0FBQ0U7QUFUTjtBQVdJO0FBQ0E7QUFDRTtBQUNBO0FBVE47QUFXSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBVFY7QUFDQTtBQUNBO0FBV0k7QUFUSjtBQVVNO0FBQ0U7QUFSUjtBQUNBO0FBQ0E7QUFDQTtBQVVFO0FBQ0U7QUFDRTtBQVJOO0FBQ0E7QUFVRTtBQUNFO0FBUko7QUFVRTtBQVJGO0FBQ0E7QUFDQTtBQVVBO0FBQ0U7QUFDQTtBQUNFO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQVVJO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQVVJO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQUNBO0FBVUU7QUFSRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBUkE7QUFVRTtBQVJGO0FBVUU7QUFBMEI7QUFQNUI7QUFDQTtBQVFFO0FBQ0E7QUFDRTtBQUNBO0FBTko7QUFRSTtBQUNFO0FBTk47QUFRSTtBQUNBO0FBQ0E7QUFOSjtBQUNBO0FBUUU7QUFBNkI7QUFML0I7QUFNRTtBQUpGO0FBQ0E7QUFNQTtBQUpBO0FBTUU7QUFKRjtBQU1FO0FBQTBCO0FBSDVCO0FBQ0E7QUFJRTtBQUNBO0FBQ0U7QUFDQTtBQUZKO0FBSUk7QUFDRTtBQUZOO0FBSUk7QUFDQTtBQUNBO0FBRko7QUFDQTtBQUlFO0FBQTZCO0FBRC9CO0FBRUU7QUFBRjtBQUNBO0FBRUE7QUFBQTtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUU7QUFBRjtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUU7QUFBRjtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUk7QUFBSjtBQUdFO0FBREY7QUFHSTtBQURKO0FBR007QUFETjtBQUdNO0FBRE47QUFHTTtBQUE2RTtBQUFuRjtBQUNBO0FBRUk7QUFBSjtBQUVJO0FBQUo7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUlFO0FBRkY7QUFLSTtBQUhKO0FBS007QUFITjtBQUtNO0FBSE47QUFLTTtBQUE2RTtBQUZuRjtBQUNBO0FBQ0E7QUFJSTtBQUZKO0FBSUk7QUFBdUI7QUFEM0I7QUFDQTtBQUVJO0FBQUo7QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFJRTtBQUZGO0FBQ0E7QUFJQTtBQUZBO0FBQ0E7QUFJRTtBQUZGO0FBSUU7QUFGRjtBQUlFO0FBRkY7QUFJRTtBQUZGO0FBSUU7QUFGRjtBQUlFO0FBRkY7QUFJSTtBQUZKO0FBSU07QUFGTjtBQUNBO0FBQ0E7QUFLRTtBQUhGO0FBS0k7QUFISjtBQUtJO0FBQXFDO0FBRnpDO0FBRXlGO0FBQXpGO0FBQ0E7QUFDSTtBQUNKO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNBO0FBR0U7QUFERjtBQUdJO0FBREo7QUFHTTtBQUROO0FBR007QUFETjtBQUdNO0FBQTZFO0FBQW5GO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFFSTtBQUFKO0FBRUk7QUFBSjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUdFO0FBREY7QUFJSTtBQUZKO0FBSU07QUFGTjtBQUlNO0FBRk47QUFJTTtBQUE2RTtBQURuRjtBQUNBO0FBQ0E7QUFHSTtBQURKO0FBR0k7QUFBdUI7QUFBM0I7QUFDQTtBQUNJO0FBQ0o7QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFIQTtBQUNBO0FBS0U7QUFIRjtBQUtFO0FBSEY7QUFLRTtBQUhGO0FBS0U7QUFIRjtBQUtFO0FBSEY7QUFLRTtBQUhGO0FBS0k7QUFISjtBQUtNO0FBSE47QUFDQTtBQUNBO0FBTUU7QUFKRjtBQU1JO0FBSko7QUFNSTtBQUE4QjtBQUhsQztBQUdrRjtBQURsRjtBQUNBO0FBRUk7QUFBSjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUlFO0FBRkY7QUFJSTtBQUZKO0FBSU07QUFGTjtBQUlNO0FBRk47QUFJTTtBQUE2RTtBQURuRjtBQUNBO0FBQ0E7QUFHSTtBQURKO0FBR0k7QUFESjtBQUdJO0FBREo7QUFHTTtBQUROO0FBR007QUFETjtBQUdNO0FBRE47QUFHTTtBQUROO0FBQ0E7QUFJRTtBQUZGO0FBS0k7QUFISjtBQUtNO0FBSE47QUFLTTtBQUhOO0FBS007QUFBNkU7QUFGbkY7QUFDQTtBQUNBO0FBSUk7QUFGSjtBQUlJO0FBQXVCO0FBRDNCO0FBQ0E7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBSkE7QUFDQTtBQU1FO0FBSkY7QUFNRTtBQUpGO0FBTUU7QUFKRjtBQU1FO0FBSkY7QUFDQTtBQU9BO0FBTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzE0QkE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDSjtBQUNVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSjtBQVdJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQVRaO0FBQ0E7QUFDQTtBQVdJO0FBQ0E7QUFUSjtBQVdRO0FBQ0E7QUFDSTtBQVRaO0FBQ0E7QUFTUTtBQUNBO0FBQ0k7QUFDQTtBQVBaO0FBQ0E7QUFDQTtBQUNBO0FBU0k7QUFDSTtBQVBSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTUTtBQVBSO0FBQ0E7QUFTSTtBQVBKO0FBQ0E7QUFTQTtBQVBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBb0I7QUFFNUI7QUFEUTtBQUFvQjtBQUk1QjtBQUhRO0FBQW9CO0FBTTVCO0FBTFE7QUFBb0I7QUFRNUI7QUFDQTtBQVBRO0FBQ0E7QUFDQTtBQUNBO0FBU1I7QUFQUTtBQUNBO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQUNJO0FBU1o7QUFQWTtBQVNaO0FBQ0E7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQVNKO0FBQ0E7QUFDQTtBQVZRO0FBWVI7QUFDQTtBQVZJO0FBQ0k7QUFDSTtBQVlaO0FBVlE7QUFZUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0E7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBV0o7QUFUUTtBQUNBO0FBQ0k7QUFDQTtBQVdaO0FBVFk7QUFDQTtBQVdaO0FBVFk7QUFXWjtBQUNBO0FBVFE7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBV0o7QUFDQTtBQUNBO0FBVEE7QUFDSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBQ0E7QUFUQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBVEE7QUFXQTtBQVRBO0FBQ0k7QUFDSTtBQVdSO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFDSTtBQUNJO0FBV1I7QUFDQTtBQUNBO0FBVEE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXSjtBQVRJO0FBV0o7QUFUSTtBQUNBO0FBQ0E7QUFXSjtBQVRJO0FBQ0E7QUFXSjtBQVRJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXSjtBQUNBO0FBQ0E7QUFUQTtBQUNJO0FBR0E7QUFDQTtBQVNKO0FBQ0E7QUFDQTtBQVBBO0FBQ0k7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBUUo7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBQ0E7QUFSSTtBQUNJO0FBVVI7QUFDQTtBQVJJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFVWjtBQUNBO0FBUkk7QUFVSjtBQUNBO0FBQ0E7QUFSQTtBQVVBO0FBQ0E7QUFWSTtBQUNJO0FBWVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZJO0FBQ0E7QUFZSjtBQVZJO0FBQ0E7QUFDQTtBQVlKO0FBVkk7QUFDSTtBQUNBO0FBQ0k7QUFZWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFDSTtBQUNJO0FBWVI7QUFWSTtBQUNBO0FBQ0E7QUFZSjtBQVZJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQVloQjtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBQ0E7QUFWQTtBQVlBO0FBQ0E7QUFaSTtBQUNJO0FBY1I7QUFDQTtBQVpJO0FBQ0k7QUFjUjtBQUNBO0FBWkk7QUFDSTtBQWNSO0FBWlE7QUFjUjtBQUNBO0FBWkk7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQWNaO0FBQ0E7QUFaUTtBQWNSO0FBQ0E7QUFaSTtBQWNKO0FBQ0E7QUFDQTtBQVpBO0FBQ0k7QUFDQTtBQUNJO0FBY1I7QUFDQTtBQVpJO0FBQ0E7QUFDQTtBQWNKO0FBWkk7QUFDSTtBQUNBO0FBY1I7QUFDQTtBQVpJO0FBY0o7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQWNBO0FBWlE7QUFDQTtBQUNJO0FBY1o7QUFDQTtBQVpRO0FBQ0k7QUFjWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBekJJO0FBMkJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQkk7QUFzQko7QUFwQkE7QUFDSTtBQUNJO0FBc0JSO0FBcEJJO0FBQ0k7QUFzQlI7QUFwQkk7QUFzQko7QUFyQlE7QUFDSTtBQXVCWjtBQUNBO0FBckJJO0FBdUJKO0FBQ0E7QUFyQkE7QUF1QkE7QUFDQTtBQXZCSTtBQUNJO0FBeUJSO0FBdkJJO0FBQ0k7QUF5QlI7QUF2Qkk7QUF5Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZCQTtBQUNJO0FBeUJKO0FBQ0E7QUFDQTtBQXZCQTtBQXlCQTtBQUNBO0FBekJJO0FBQ0k7QUEyQlI7QUF6Qkk7QUFDSTtBQTJCUjtBQXpCSTtBQTJCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkJBO0FBQ0k7QUFDQTtBQUNJO0FBeUJSO0FBdkJJO0FBQ0E7QUFDSTtBQXlCUjtBQUNBO0FBQ0E7QUFDQTtBQXZCSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQXlCWjtBQXZCWTtBQXlCWjtBQXZCWTtBQXlCWjtBQXZCWTtBQXlCWjtBQUNBO0FBdkJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQXlCWjtBQUNBO0FBdkJJO0FBQ0k7QUF5QlI7QUF2Qlk7QUF5Qlo7QUF2QmdCO0FBQXlDO0FBMEJ6RDtBQUNBO0FBekJnQjtBQTJCaEI7QUF6QmdCO0FBQ0k7QUEyQnBCO0FBQ0E7QUF6QmdCO0FBQ0k7QUEyQnBCO0FBQ0E7QUF6QmdCO0FBMkJoQjtBQXpCZ0I7QUEyQmhCO0FBekJnQjtBQTJCaEI7QUF6QmdCO0FBMkJoQjtBQXpCZ0I7QUEyQmhCO0FBQ0E7QUFDQTtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0E7QUFDSTtBQTBCUjtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQUNBO0FBeEJBO0FBMEJBO0FBeEJJO0FBQ0E7QUFDSTtBQTBCUjtBQXhCSTtBQUNBO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBMEJSO0FBeEJRO0FBMEJSO0FBeEJJO0FBQ0k7QUFDSTtBQTBCWjtBQUNBO0FBQ0E7QUF4Qkk7QUFBeUM7QUEyQjdDO0FBQ0E7QUExQkk7QUE0Qko7QUExQkk7QUFDSTtBQTRCUjtBQUNBO0FBMUJJO0FBQ0k7QUE0QlI7QUFDQTtBQTFCSTtBQTRCSjtBQTFCSTtBQTRCSjtBQTFCSTtBQTRCSjtBQTFCSTtBQTRCSjtBQUNBO0FBMUJJO0FBNEJKO0FBQ0E7QUFDQTtBQTFCQTtBQUNJO0FBQ0E7QUFDSTtBQTRCUjtBQTFCSTtBQUNBO0FBQ0k7QUE0QlI7QUExQkk7QUFDSTtBQTRCUjtBQTFCSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQTRCWjtBQTFCWTtBQTRCWjtBQTFCWTtBQTRCWjtBQTFCWTtBQTRCWjtBQUNBO0FBMUJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQTRCWjtBQUNBO0FBQ0E7QUFDQTtBQTFCSTtBQUNJO0FBQ0k7QUFDSTtBQTRCaEI7QUFDQTtBQTFCUTtBQUNJO0FBNEJaO0FBMUJRO0FBQ0E7QUE0QlI7QUExQkk7QUE0Qko7QUFDQTtBQXpCQTtBQUNJO0FBQ0E7QUFDSTtBQTJCUjtBQXpCSTtBQUNBO0FBQ0k7QUEyQlI7QUF6Qkk7QUFDSTtBQTJCUjtBQXpCSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBMkJaO0FBekJZO0FBMkJaO0FBQ0E7QUFDQTtBQUNBO0FBekJJO0FBQ0k7QUEyQlI7QUFDQTtBQUNBO0FBQ0E7QUF6Qkk7QUEyQko7QUFDQTtBQUNBO0FBekJBO0FBQ0k7QUFDQTtBQUNJO0FBMkJSO0FBQ0E7QUF6Qkk7QUEyQko7QUF6Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUEyQlo7QUF4Qlk7QUEwQlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCWTtBQTBCWjtBQUNBO0FBQ0E7QUF4Qkk7QUEwQko7QUF4QlE7QUFBeUM7QUEyQmpEO0FBQ0E7QUExQlE7QUE0QlI7QUExQlE7QUFDSTtBQTRCWjtBQUNBO0FBMUJRO0FBQ0k7QUE0Qlo7QUFDQTtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCSTtBQTRCSjtBQUNBO0FBMUJBO0FBQ0k7QUFDQTtBQUNJO0FBNEJSO0FBQ0E7QUExQkk7QUFDQTtBQTRCSjtBQTFCSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQTRCWjtBQXpCWTtBQTJCWjtBQXhCWTtBQTBCWjtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQTBCQTtBQXhCSTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qlk7QUEwQlo7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUFDSTtBQTBCUjtBQUNBO0FBQ0E7QUF4Qkk7QUFDSTtBQTBCUjtBQUNBO0FBeEJJO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQUNJO0FBMEJaO0FBQ0E7QUF4QlE7QUFDSTtBQTBCWjtBQXhCUTtBQUNJO0FBQ0k7QUEwQmhCO0FBQ0E7QUF4Qlk7QUFDSTtBQTBCaEI7QUF4Qlk7QUEwQlo7QUF4QmdCO0FBQ0E7QUFDSTtBQUNJO0FBMEJ4QjtBQXhCd0I7QUEwQnhCO0FBQ0E7QUF4QmdCO0FBMEJoQjtBQXhCb0I7QUEwQnBCO0FBQ0E7QUF4QmdCO0FBQ0k7QUEwQnBCO0FBeEJ3QjtBQUNBO0FBMEJ4QjtBQUNBO0FBeEJnQjtBQUNJO0FBQXdDO0FBMkI1RDtBQTFCb0I7QUFDSTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBNEJwQztBQUNBO0FBQ0E7QUExQndCO0FBNEJ4QjtBQTFCb0I7QUE0QnBCO0FBMUJnQjtBQTRCaEI7QUFDQTtBQUNBO0FBMUJJO0FBQ0k7QUFBd0M7QUE2QmhEO0FBNUJRO0FBQ0k7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQThCeEI7QUFDQTtBQUNBO0FBNUJZO0FBOEJaO0FBNUJRO0FBOEJSO0FBNUJJO0FBOEJKO0FBQ0E7QUFDQTtBQTVCQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQThCWjtBQTVCUTtBQUNJO0FBOEJaO0FBNUJRO0FBQ0E7QUE4QlI7QUE1Qlk7QUE4Qlo7QUE1QmdCO0FBQ0k7QUFDSTtBQThCeEI7QUE1QjRCO0FBQ0k7QUE4QmhDO0FBNUI0QjtBQThCNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJnQjtBQUNJO0FBQ0k7QUE4QnhCO0FBNUJvQjtBQUNJO0FBOEJ4QjtBQTVCb0I7QUFDQTtBQThCcEI7QUE1QndCO0FBQ0k7QUFDSTtBQUNJO0FBOEJwQztBQTVCd0M7QUFDSTtBQThCNUM7QUE1QndDO0FBOEJ4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUI0QjtBQThCNUI7QUE1QjRCO0FBOEI1QjtBQTVCZ0M7QUE4QmhDO0FBNUJnQztBQUE2QjtBQStCN0Q7QUFDQTtBQTlCZ0M7QUFnQ2hDO0FBOUJnQztBQWdDaEM7QUFDQTtBQTlCNEI7QUFnQzVCO0FBQ0E7QUE5QndCO0FBZ0N4QjtBQUNBO0FBQ0E7QUFDQTtBQTlCWTtBQWdDWjtBQUNBO0FBQ0E7QUE5Qkk7QUFDSTtBQWdDUjtBQTlCSTtBQUNJO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCQTtBQUNJO0FBQ0E7QUFDSTtBQWdDUjtBQTlCSTtBQUNJO0FBZ0NSO0FBOUJJO0FBQ0E7QUFDSTtBQWdDUjtBQUNBO0FBOUJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0NKO0FBL0JRO0FBaUNSO0FBQ0E7QUEvQkk7QUFpQ0o7QUFoQ1E7QUFrQ1I7QUFoQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFrQ1o7QUFDQTtBQWpDWTtBQW1DWjtBQUNBO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFsQ1E7QUFDQTtBQUNJO0FBb0NaO0FBbENRO0FBQ0k7QUFvQ1o7QUFuQ2dCO0FBcUNoQjtBQUNBO0FBbkNZO0FBQ0E7QUFDSTtBQUNBO0FBcUNoQjtBQXBDb0I7QUFzQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBDb0I7QUFzQ3BCO0FBQ0E7QUFDQTtBQW5DWTtBQXFDWjtBQXBDZ0I7QUFzQ2hCO0FBckNvQjtBQXVDcEI7QUFyQ2dCO0FBQ0E7QUF1Q2hCO0FBQ0E7QUFyQ1k7QUFDSTtBQXVDaEI7QUF0Q29CO0FBd0NwQjtBQUNBO0FBdENZO0FBd0NaO0FBdkNnQjtBQXlDaEI7QUFDQTtBQXZDZ0I7QUF5Q2hCO0FBQ0E7QUF2Q1E7QUF5Q1I7QUF4Q1k7QUFDQTtBQTBDWjtBQUNBO0FBeENZO0FBMENaO0FBQ0E7QUFDQTtBQXhDSTtBQUNBO0FBMENKO0FBekNRO0FBQ0E7QUFDQTtBQTJDUjtBQXpDUTtBQUNBO0FBMkNSO0FBekNJO0FBQ0E7QUFDSTtBQUNJO0FBMkNaO0FBQ0E7QUF6Q1E7QUEyQ1I7QUF6Q0k7QUEyQ0o7QUFDQTtBQXpDQTtBQTJDQTtBQUNBO0FBM0NJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUE2Q1I7QUEzQ0k7QUFDSTtBQUNBO0FBNkNSO0FBM0NRO0FBQ0k7QUFDQTtBQUNJO0FBNkNoQjtBQTNDWTtBQTZDWjtBQTFDUTtBQUNBO0FBNENSO0FBMUNJO0FBNENKO0FBQ0E7QUExQ0E7QUFDSTtBQTRDSjtBQUNBO0FBekNBO0FBQ0k7QUFDQTtBQUNJO0FBMkNSO0FBekNJO0FBQ0E7QUFDSTtBQTJDUjtBQXpDSTtBQTJDSjtBQXpDSTtBQUNBO0FBQ0k7QUFDQTtBQTJDUjtBQUNBO0FBekNJO0FBQ0k7QUEyQ1I7QUFDQTtBQXpDSTtBQUNJO0FBMkNSO0FBQ0E7QUF6Q0k7QUFDQTtBQUNBO0FBMkNKO0FBekNJO0FBQ0k7QUEyQ1I7QUFDQTtBQXpDSTtBQTJDSjtBQUNBO0FBQ0E7QUF6Q0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQTJDWjtBQXpDUTtBQTJDUjtBQUNBO0FBekNJO0FBMkNKO0FBQ0E7QUFDQTtBQXpDQTtBQUNJO0FBMkNKO0FBQ0E7QUFDQTtBQXZDQTtBQUNJO0FBQ0E7QUFDSTtBQXlDUjtBQUNBO0FBdkNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBeUNaO0FBQ0E7QUF2Q0k7QUF5Q0o7QUFDQTtBQUNBO0FBdENBO0FBQ0k7QUFDQTtBQUNJO0FBd0NSO0FBdENJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBd0NaO0FBQ0E7QUFDQTtBQXRDSTtBQXdDSjtBQUNBO0FBQ0E7QUFDQTtBQXJDQTtBQUNJO0FBQ0E7QUFDSTtBQXVDUjtBQXJDSTtBQUNBO0FBQ0k7QUF1Q1I7QUFyQ0k7QUFDQTtBQUNBO0FBQ0k7QUF1Q1I7QUFDQTtBQXJDSTtBQUNJO0FBdUNSO0FBQ0E7QUFyQ0k7QUFDSTtBQXVDUjtBQUNBO0FBckNJO0FBR0k7QUFxQ1I7QUFDQTtBQW5DSTtBQXFDSjtBQUNBO0FBQ0E7QUFDQTtBQWxDQTtBQUNJO0FBQ0E7QUFDSTtBQW9DUjtBQWxDSTtBQUNBO0FBQ0E7QUFDQTtBQW9DSjtBQWxDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBb0NoQjtBQWxDWTtBQW9DWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbENJO0FBb0NKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0E7QUFDSTtBQW1DUjtBQUNBO0FBakNJO0FBQ0k7QUFDSTtBQW1DWjtBQWpDUTtBQW1DUjtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBakNJO0FBQ0E7QUFDQTtBQW1DSjtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFtQ2hCO0FBakNZO0FBbUNaO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDSTtBQUNJO0FBbUNaO0FBakNRO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0E7QUFDSTtBQW1DUjtBQWpDSTtBQUNJO0FBbUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDSTtBQW1DUjtBQWpDUTtBQW1DUjtBQUNBO0FBakNJO0FBQ0E7QUFDQTtBQUNBO0FBbUNKO0FBakNJO0FBQ0k7QUFDSTtBQUNBO0FBbUNaO0FBQ0E7QUFqQ1E7QUFDQTtBQW1DUjtBQUNBO0FBakNJO0FBQ0E7QUFtQ0o7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQW1DaEI7QUFqQ1k7QUFtQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDSTtBQW1DUjtBQUNBO0FBakNJO0FBQ0k7QUFDSTtBQW1DWjtBQUNBO0FBakNRO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDSTtBQW1DUjtBQWpDSTtBQUNJO0FBbUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDQTtBQUNJO0FBQ0k7QUFtQ1o7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDQTtBQW1DSjtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNBO0FBQ0k7QUFtQ1I7QUFDQTtBQUNBO0FBQ0E7QUFqQ0k7QUFDQTtBQUNBO0FBQ0E7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBbUNoQjtBQWpDWTtBQW1DWjtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0k7QUFtQ1I7QUFqQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCQTtBQUNJO0FBQ1E7QUE4Qlo7QUE1QlE7QUE4QlI7QUE1Qkk7QUFDSTtBQUNJO0FBQ0E7QUE4Qlo7QUE1QlE7QUE4QlI7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBNUJBO0FBQ0k7QUFDUTtBQThCWjtBQTVCUTtBQThCUjtBQTVCSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUE4Qlo7QUE1QlE7QUE4QlI7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUE1QkE7QUFDSTtBQUNBO0FBOEJKO0FBQ0E7QUE1QkE7QUE4QkE7QUFDQTtBQTlCSTtBQUNJO0FBZ0NSO0FBOUJJO0FBZ0NKO0FBQ0E7QUE5QkE7QUFnQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0E7QUFDSTtBQW1DUjtBQWpDUTtBQUNBO0FBQ0E7QUFDSTtBQW1DWjtBQUNBO0FBakNRO0FBQ0k7QUFtQ1o7QUFDQTtBQWpDUTtBQW1DUjtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQW1DQTtBQWpDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFtQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6eURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQUNBO0FBRFE7QUFDQTtBQUdSO0FBRFE7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUdwQjtBQUNBO0FBQ0E7QUFDQTtBQURRO0FBR1I7QUFDQTtBQURJO0FBR0o7QUFEUTtBQUdSO0FBRFE7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUdWO0FBRFU7QUFHVjtBQUNBO0FBRFE7QUFDQTtBQUNFO0FBQ0E7QUFHVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakVBO0FBQ0U7QUFDQTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNJO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ047QUFDSTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFBSTtBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQUk7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNFO0FBQ0U7QUFFSjtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0U7QUFDRTtBQUdKO0FBQ0E7QUFGSTtBQUlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0U7QUFDRTtBQUlKO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQ0U7QUFDRTtBQUtKO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0U7QUFDRTtBQU1KO0FBQ0E7QUFKRTtBQUNFO0FBTUo7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0U7QUFDRTtBQU1KO0FBQ0E7QUFKRTtBQUNFO0FBTUo7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQU5RO0FBQ0k7QUFRWjtBQU5RO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBTlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUVI7QUFOUTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBTmdCO0FBQ0k7QUFRcEI7QUFOZ0I7QUFRaEI7QUFMZ0I7QUFDQTtBQUNJO0FBQ0E7QUFPcEI7QUFMZ0I7QUFPaEI7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNFO0FBQ0U7QUFNSjtBQUNBO0FBSkU7QUFDRTtBQU1KO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNZO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBR0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUdJO0FBREo7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQURRO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUdSO0FBRFE7QUFDSTtBQUNJO0FBR2hCO0FBQ0E7QUFEWTtBQUNJO0FBR2hCO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUdSO0FBRFE7QUFDQTtBQUNJO0FBR1o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQUNBO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFHUjtBQURRO0FBQ0E7QUFDSTtBQUdaO0FBRFE7QUFDSTtBQUdaO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEWTtBQUdaO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDSTtBQUVaO0FBQWdCO0FBRWhCO0FBQVk7QUFDQTtBQUVaO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuT0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBQ0E7QUFHWTtBQURaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFDQTtBQUVRO0FBQ0k7QUFDSTtBQUFoQjtBQUVnQjtBQUFoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNNO0FBQ047QUFDTTtBQUNFO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDRTtBQUNFO0FBQ1Y7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ1U7QUFDVjtBQUNBO0FBQ1E7QUFDRTtBQUNBO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFvRDtBQUU1RDtBQURRO0FBQWtFO0FBSTFFO0FBSFE7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQW9EO0FBTTVEO0FBTFE7QUFBa0U7QUFRMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEk7QUFDSTtBQUNJO0FBU1o7QUFDQTtBQVBRO0FBU1I7QUFQSTtBQUNJO0FBQ0k7QUFTWjtBQVBRO0FBQ0k7QUFTWjtBQVBZO0FBQ0k7QUFTaEI7QUFQZ0I7QUFTaEI7QUFDQTtBQUNBO0FBUEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBU1o7QUFDQTtBQVBRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUFE7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQVNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBU1o7QUFDQTtBQVBRO0FBQ0E7QUFTUjtBQUNBO0FBUEk7QUFTSjtBQUNBO0FBVFE7QUFDSTtBQVdaO0FBVFE7QUFDSTtBQVdaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUSTtBQUNJO0FBQ0k7QUFXWjtBQUNBO0FBVFE7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQVdKO0FBQ0E7QUFYUTtBQUNJO0FBYVo7QUFDQTtBQVhRO0FBQ0k7QUFhWjtBQUNBO0FBWEk7QUFDSTtBQUNJO0FBYVo7QUFYUTtBQUNLO0FBYWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhJO0FBQ0k7QUFhUjtBQVhRO0FBQ0k7QUFhWjtBQUNBO0FBQ0E7QUFDQTtBQVhJO0FBQ0k7QUFhUjtBQUNBO0FBWEk7QUFDSTtBQUNJO0FBYVo7QUFYUTtBQUNJO0FBYVo7QUFYUTtBQUNBO0FBYVI7QUFDQTtBQVhJO0FBQ0k7QUFhUjtBQUNBO0FBWEk7QUFhSjtBQUNBO0FBYlE7QUFDSTtBQWVaO0FBQ0E7QUFiUTtBQUNBO0FBZVI7QUFDQTtBQWJJO0FBQ0k7QUFDSTtBQWVaO0FBQ0E7QUFiUTtBQUNBO0FBZVI7QUFDQTtBQUNBO0FBYkk7QUFDSTtBQUNJO0FBZVo7QUFDQTtBQWJRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFDQTtBQVpRO0FBQ0k7QUFjWjtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBVlE7QUFZUjtBQVZRO0FBWVI7QUFWUTtBQVlSO0FBVlk7QUFZWjtBQVZZO0FBWVo7QUFWeUQ7QUFZekQ7QUFDQTtBQVhRO0FBYVI7QUFYUTtBQUE4QztBQWN0RDtBQWQ0RztBQWdCNUc7QUFDQTtBQWZRO0FBaUJSO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZnQjtBQWlCaEI7QUFmZ0I7QUFpQmhCO0FBZmdCO0FBaUJoQjtBQWZvQjtBQUFVO0FBa0I5QjtBQUNBO0FBakJvQjtBQW1CcEI7QUFqQm9CO0FBbUJwQjtBQWpCb0I7QUFtQnBCO0FBakJvQjtBQW1CcEI7QUFDQTtBQWhCZ0I7QUFrQmhCO0FBQ0E7QUFmWTtBQWlCWjtBQUNBO0FBZlE7QUFDQTtBQUNBO0FBaUJSO0FBZlE7QUFpQlI7QUFmUTtBQUNBO0FBQ0E7QUFpQlI7QUFDQTtBQWZRO0FBQ0E7QUFDQTtBQWlCUjtBQUNBO0FBZlE7QUFDQTtBQWlCUjtBQWRRO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFnQlo7QUFiWTtBQWVaO0FBQ0E7QUFDQTtBQVpJO0FBY0o7QUFaUTtBQWNSO0FBWlE7QUFjUjtBQVpRO0FBY1I7QUFaUTtBQWNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBY2hCO0FBWmdCO0FBY2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkk7QUFDSTtBQUNJO0FBY1o7QUFaUTtBQUNBO0FBQ0E7QUFDQTtBQWNSO0FBQ0E7QUFaUTtBQUNBO0FBQ0E7QUFDQTtBQUF5QztBQWVqRDtBQWRRO0FBQXVDO0FBaUIvQztBQWhCUTtBQWtCUjtBQUNBO0FBaEJRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUF5QztBQW1CakQ7QUFsQlE7QUFBdUM7QUFxQi9DO0FBcEJRO0FBc0JSO0FBcEJRO0FBQ0E7QUFzQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkJJO0FBQ0k7QUFDSTtBQXFCWjtBQUNBO0FBbkJRO0FBcUJSO0FBbkJRO0FBcUJSO0FBbkJRO0FBQStDO0FBc0J2RDtBQUNBO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJZO0FBdUJaO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQXJCZ0I7QUF1QmhCO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQXJCZ0I7QUF1QmhCO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQUNBO0FBcEJZO0FBc0JaO0FBQ0E7QUFDQTtBQUNBO0FBbEJJO0FBQ0k7QUFDSTtBQW9CWjtBQUNBO0FBbEJRO0FBQ0E7QUFvQlI7QUFDQTtBQWxCSTtBQUNJO0FBQ0k7QUFvQlo7QUFDQTtBQWxCUTtBQUNBO0FBb0JSO0FBQ0E7QUFsQkk7QUFDSTtBQUNJO0FBb0JaO0FBQ0E7QUFsQlE7QUFDQTtBQW9CUjtBQUNBO0FBbEJJO0FBQ0k7QUFDSTtBQW9CWjtBQWxCUTtBQUNBO0FBb0JSO0FBQ0E7QUFsQkk7QUFDSTtBQUNJO0FBb0JaO0FBbEJRO0FBQ0E7QUFvQlI7QUFsQlE7QUFvQlI7QUFDQTtBQWxCSTtBQUNJO0FBb0JSO0FBQ0E7QUFsQkk7QUFDSTtBQW9CUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQU07QUFDQTtBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQU07QUFFTjtBQUFNO0FBQ0E7QUFDQTtBQUNBO0FBRU47QUFBVTtBQUVWO0FBQVE7QUFFUjtBQUNBO0FBQUk7QUFDRTtBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNoQjtBQUVnQjtBQUNBO0FBQ0E7QUFBaEI7QUFDQTtBQUVRO0FBQVI7QUFDWTtBQUNJO0FBQ0E7QUFDQTtBQUNoQjtBQUVnQjtBQUNBO0FBQ0E7QUFBaEI7QUFFWTtBQUFaO0FBQ0E7QUFFSTtBQUFKO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDSTtBQUNaO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFBWTtBQUNBO0FBRVo7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUFNO0FBQ0U7QUFDQTtBQUVSO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBRFk7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFFSjtBQURNO0FBQ0E7QUFDQTtBQUdOO0FBREk7QUFHSjtBQUZNO0FBQ0E7QUFDRTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBSVY7QUFGUTtBQUNFO0FBSVY7QUFGUTtBQUlSO0FBQ0E7QUFGSTtBQUlKO0FBSE07QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBS1I7QUFIUTtBQUNBO0FBS1I7QUFITTtBQUtOO0FBSEk7QUFLSjtBQUNBO0FBSEk7QUFDRTtBQUtOO0FBSE07QUFDQTtBQUtOO0FBSE07QUFDQTtBQUtOO0FBSE07QUFDQTtBQUtOO0FBQ0E7QUFISTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBS1I7QUFDQTtBQUhNO0FBQ0U7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUhJO0FBS0o7QUFESTtBQUNFO0FBQ0U7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0xBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDQTtBQUdJO0FBQ0U7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0o7QUFDTTtBQUNFO0FBQ0E7QUFDQTtBQUNSO0FBQ007QUFDTjtBQUNJO0FBQ0E7QUFDRTtBQUNFO0FBQ1I7QUFDTTtBQUNBO0FBQ0U7QUFDUjtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDTTtBQUNBO0FBQ047QUFBUTtBQUVSO0FBQU07QUFFTjtBQUFNO0FBQ0U7QUFFUjtBQUFNO0FBQ0E7QUFDRTtBQUNFO0FBRVY7QUFDQTtBQUFNO0FBRU47QUFBSTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBRVI7QUFDQTtBQUFNO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0M7QUFDQztBQUNBO0FBRUY7QUFBRztBQUNDO0FBQ0E7QUFDQTtBQUVKO0FBQUc7QUFFSDtBQUFFO0FBQ0E7QUFDQztBQUNDO0FBRUo7QUFBRztBQUNBO0FBQ0M7QUFFSjtBQUFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBRUo7QUFBSztBQUNBO0FBRUw7QUFETTtBQUdOO0FBQ0E7QUFDQTtBQURHO0FBQ0E7QUFDQTtBQUNDO0FBR0o7QUFERztBQUNBO0FBQ0M7QUFDQztBQUdMO0FBQ0E7QUFERztBQUdIO0FBREU7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUdKO0FBQ0E7QUFERztBQUdIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSEE7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNFO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNFO0FBQ0E7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQURSO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBREo7QUFDQTtBQUdZO0FBQ0E7QUFDQTtBQUNBO0FBRFo7QUFDQTtBQUNBO0FBR1k7QUFEWjtBQUdZO0FBQ0k7QUFEaEI7QUFHWTtBQUNJO0FBRGhCO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDQTtBQUNJO0FBQVE7QUFBeUI7QUFBa0I7QUFDM0M7QUFBMEI7QUFBa0I7QUFFeEQ7QUFFUjtBQUNBO0FBQUk7QUFFSjtBQURRO0FBQ0k7QUFDSTtBQUdoQjtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUdKO0FBRFE7QUFHUjtBQURRO0FBR1I7QUFEUTtBQUErQztBQUl2RDtBQUNBO0FBSFE7QUFLUjtBQUhJO0FBS0o7QUFIWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS1o7QUFIWTtBQUNJO0FBS2hCO0FBSFk7QUFDSTtBQUtoQjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFBK0I7QUFNdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBQ0E7QUFBK0M7QUFRdkQ7QUFDQTtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFk7QUFTWjtBQVBZO0FBU1o7QUFQWTtBQVNaO0FBUGdCO0FBU2hCO0FBQ0E7QUFOZ0I7QUFRaEI7QUFDQTtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUtKO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFIUTtBQUErQztBQU12RDtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBQStEO0FBUXZFO0FBQ0E7QUFQUTtBQUE4RDtBQVV0RTtBQUNBO0FBVFE7QUFBNEQ7QUFZcEU7QUFDQTtBQVhRO0FBQTBEO0FBY2xFO0FBQ0E7QUFiUTtBQWVSO0FBYnlEO0FBZXpEO0FBZnlHO0FBaUJ6RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmUTtBQUNBO0FBaUJSO0FBZlE7QUFpQlI7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQUNBO0FBaEJZO0FBQ0k7QUFrQmhCO0FBaEJvQjtBQWtCcEI7QUFoQm9CO0FBa0JwQjtBQWhCb0I7QUFrQnBCO0FBaEJ3QjtBQWtCeEI7QUFoQndCO0FBa0J4QjtBQWhCd0I7QUFrQnhCO0FBaEI0QjtBQWtCNUI7QUFoQjRCO0FBa0I1QjtBQWhCNEI7QUFrQjVCO0FBaEI0QjtBQWtCNUI7QUFoQjRCO0FBa0I1QjtBQWhCNEI7QUFrQjVCO0FBQ0E7QUFDQTtBQUNBO0FBZGdCO0FBZ0JoQjtBQWRnQjtBQWdCaEI7QUFkb0I7QUFnQnBCO0FBZG9CO0FBZ0JwQjtBQWRvQjtBQWdCcEI7QUFkb0I7QUFnQnBCO0FBZG9CO0FBZ0JwQjtBQWR3QjtBQWdCeEI7QUFkd0I7QUFnQnhCO0FBQ0E7QUFDQTtBQWJnQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFlNUI7QUFiNEI7QUFlNUI7QUFid0I7QUFDSTtBQWU1QjtBQUNBO0FBYm9CO0FBQ0k7QUFDQTtBQWV4QjtBQUNBO0FBQ0E7QUFiZ0I7QUFDSTtBQUNBO0FBQ0E7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFDQTtBQUNBO0FBWlk7QUFjWjtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBQ0E7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFk7QUFhWjtBQVhnQjtBQWFoQjtBQVhnQjtBQWFoQjtBQVhnQjtBQWFoQjtBQVhnQjtBQWFoQjtBQUNBO0FBQ0E7QUFUUTtBQVdSO0FBVFE7QUFXUjtBQVRRO0FBV1I7QUFUUTtBQVdSO0FBQ0E7QUFSSTtBQUNJO0FBQ0E7QUFVUjtBQUNBO0FBUkk7QUFDSTtBQUNJO0FBVVo7QUFSWTtBQUNJO0FBVWhCO0FBQ0E7QUFSa0I7QUFVbEI7QUFDQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBUkk7QUFDRTtBQUNJO0FBVVY7QUFDQTtBQVJVO0FBVVY7QUFDQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJnQjtBQUNJO0FBQ0E7QUFFSTtBQUVJO0FBUTVCO0FBTndCO0FBRUk7QUFPNUI7QUFDQTtBQUxvQjtBQU9wQjtBQUNBO0FBTGdCO0FBQ0k7QUFPcEI7QUFMb0I7QUFDSTtBQU94QjtBQUNBO0FBTG9CO0FBT3BCO0FBQ0E7QUFDQTtBQUNBO0FBTmdCO0FBUWhCO0FBTm9CO0FBUXBCO0FBQ0E7QUFDQTtBQU5vQjtBQUNJO0FBUXhCO0FBQ0E7QUFOb0I7QUFDSTtBQUNJO0FBUTVCO0FBTjRCO0FBUTVCO0FBQ0E7QUFDQTtBQU5vQjtBQVFwQjtBQUNBO0FBTmdCO0FBQ0k7QUFRcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTm9CO0FBQ0k7QUFReEI7QUFDQTtBQU5vQjtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBUXhCO0FBTndCO0FBQ0k7QUFDQTtBQVE1QjtBQU53QjtBQUNJO0FBUTVCO0FBQ0E7QUFDQTtBQU5vQjtBQVFwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5RO0FBQ0E7QUFRUjtBQU5RO0FBQ0E7QUFDSTtBQVFaO0FBQ0E7QUFOUTtBQVFSO0FBTlE7QUFRUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JnQkE7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDRTtBQUNBO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFDRTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNFO0FBRFI7QUFDQTtBQUdNO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRE47QUFHTTtBQUNBO0FBQ0E7QUFETjtBQUNBO0FBR0k7QUFDRTtBQUNBO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkRBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFDRTtBQURWO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUdRO0FBQ0U7QUFEVjtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBRFY7QUFDQTtBQUNBO0FBR1E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQURWO0FBQ0E7QUFDQTtBQUdRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBR1E7QUFDRTtBQURWO0FBQ0E7QUFHUTtBQUNFO0FBRFY7QUFDQTtBQUdJO0FBQ0U7QUFETjtBQUNBO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUdRO0FBQ0E7QUFDRTtBQURWO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFLSTtBQUNJO0FBSFI7QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFLSTtBQUNFO0FBSE47QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUdBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUdRO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQURaO0FBR1E7QUFDSTtBQUNJO0FBRGhCO0FBQ0E7QUFHUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBRFo7QUFHUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEWjtBQUNBO0FBSUk7QUFGSjtBQUdRO0FBRFI7QUFjSTtBQVpKO0FBYVE7QUFYUjtBQXdCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0QlI7QUFDQTtBQXdCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQXRCWjtBQXdCWTtBQXRCWjtBQUNBO0FBd0JRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0QlI7QUF3QlE7QUFDQTtBQUNBO0FBQ0E7QUF0QlI7QUFDQTtBQXNCUTtBQXBCUjtBQXNCUTtBQXBCUjtBQXNCUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcEJaO0FBc0JRO0FBQ0k7QUFwQlo7QUFzQlE7QUFDSTtBQXBCWjtBQXNCUTtBQUdBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQXRCaEI7QUF3Qlk7QUFDSTtBQXRCaEI7QUFDQTtBQUNBO0FBd0JRO0FBQ0E7QUF0QlI7QUFDQTtBQXlCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUF2Qlo7QUF5QlE7QUFDSTtBQUNBO0FBQ0E7QUF2Qlo7QUF5QlE7QUF2QlI7QUF3Qlk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQXRCaEI7QUF3Qlk7QUFDSTtBQUNBO0FBdEJoQjtBQUNBO0FBeUJRO0FBQ0k7QUF2Qlo7QUF5QlE7QUFDSTtBQXZCWjtBQXlCUTtBQUNBO0FBdkJSO0FBQ0E7QUEwQkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBeEJaO0FBMEJRO0FBQ0k7QUF4Qlo7QUEyQlk7QUF6Qlo7QUE0Qlk7QUExQlo7QUE2Qlk7QUEzQlo7QUE2QlE7QUFDSTtBQUNBO0FBM0JaO0FBNkJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzQmhCO0FBNkJnQjtBQTNCaEI7QUFDQTtBQTZCUTtBQUNBO0FBM0JSO0FBQ0E7QUFDQTtBQThCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJSO0FBOEJRO0FBNUJSO0FBQ0E7QUE0QlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCWjtBQTRCUTtBQUNJO0FBMUJaO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUExQmhCO0FBNEJZO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCaEI7QUFDQTtBQTRCUTtBQUNBO0FBMUJSO0FBQ0E7QUE0Qkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBMUJSO0FBQ0E7QUFDQTtBQTRCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCUjtBQTRCUTtBQUNJO0FBMUJaO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBMUJaO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBMUJoQjtBQUNBO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCWjtBQTRCUTtBQUNBO0FBMUJSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6WEE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0k7QUFDSjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBRFE7QUFDSTtBQUFRO0FBQVk7QUFDWjtBQUFZO0FBQ1o7QUFBWTtBQUNaO0FBQVk7QUFFeEI7QUFDSTtBQUFRO0FBQVk7QUFDWjtBQUFZO0FBQ1o7QUFBWTtBQUV4QjtBQUNJO0FBQVE7QUFDUjtBQUFRO0FBQVk7QUFFeEI7QUFZUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFETjtBQUdNO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFEVjtBQUdRO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDSztBQUNHO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ1E7QUFDUjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEdBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDWjtBQUNRO0FBQ0M7QUFDVDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ2hCO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDSTtBQUNJO0FBRFo7QUFHUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBRHBCO0FBR29CO0FBQ0E7QUFEcEI7QUFHb0I7QUFDQTtBQURwQjtBQUdnQjtBQUNBO0FBQ0k7QUFEcEI7QUFDQTtBQUdRO0FBQ0k7QUFEWjtBQUNBO0FBR1k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQURwQjtBQUdnQjtBQUNBO0FBRGhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBRlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZFQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUtBO0FBQ0k7QUFIUjtBQUtJO0FBQ0k7QUFDQTtBQUNFO0FBSFY7QUFLUTtBQUhSO0FBS0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBSGhCO0FBS1k7QUFDQTtBQUNBO0FBSFo7QUFDQTtBQUtJO0FBSEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ1M7QUFDVDtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ3BCO0FBQ29CO0FBQ3BCO0FBQ2dCO0FBQ2hCO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Y7QUFFRTtBQUNFO0FBQ0E7QUFDRTtBQUFOO0FBRUk7QUFBSjtBQUNBO0FBRUU7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUFOO0FBRUk7QUFBSjtBQUNBO0FBRUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQU47QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUNNO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQU07QUFDRTtBQUNBO0FBRVI7QUFDQTtBQUNBO0FBQUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVGO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ1Y7QUFDVTtBQUNFO0FBQ0E7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNBO0FBQ0U7QUFDTjtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBQ047QUFFTTtBQUFOO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFHRTtBQUNFO0FBREo7QUFHSTtBQUNFO0FBRE47QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqVkE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ2hCO0FBQ1k7QUFDSTtBQUNoQjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ1o7QUFDQTtBQUNRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDWjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNRO0FBQ0k7QUFDWjtBQUNRO0FBQ0k7QUFDWjtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDSTtBQUNaO0FBQ1E7QUFDQTtBQUNJO0FBQ1o7QUFDUTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ0k7QUFDSTtBQUNBO0FBQ2hCO0FBQ1k7QUFDWjtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNBO0FBQ1k7QUFDSTtBQUNoQjtBQUNBO0FBQ2dCO0FBQ0E7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ1k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ2hCO0FBQ0E7QUFDWTtBQUNJO0FBQ2hCO0FBQ0E7QUFDZ0I7QUFDQTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFFSTtBQUNJO0FBQ0E7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFFUTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRVk7QUFDQTtBQUFaO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNRO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQVk7QUFDSTtBQUVoQjtBQUFZO0FBRVo7QUFBWTtBQUNJO0FBRWhCO0FBQVk7QUFDQTtBQUVaO0FBQ0E7QUFEWTtBQUNBO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFEUTtBQUNJO0FBR1o7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDSTtBQUd4QjtBQUNBO0FBQ0E7QUFDQTtBQURnQjtBQUNJO0FBQ0k7QUFHeEI7QUFDQTtBQUNBO0FBQ0E7QUFBUTtBQUNBO0FBRVI7QUFBUTtBQUVSO0FBQUk7QUFDSTtBQUNJO0FBRVo7QUFDQTtBQUNBO0FBRFk7QUFHWjtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0k7QUFHWjtBQURRO0FBR1I7QUFEUTtBQUNJO0FBR1o7QUFDQTtBQUNBO0FBRFk7QUFHWjtBQUNBO0FBQ0E7QUFESTtBQUNFO0FBQ0U7QUFDQTtBQUdSO0FBQ0E7QUFETTtBQUNBO0FBR047QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUhRO0FBQ0k7QUFLWjtBQUhNO0FBS047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBSVo7QUFDQTtBQUZRO0FBQ0E7QUFDQTtBQUlSO0FBRlE7QUFJUjtBQUhZO0FBS1o7QUFIUTtBQUtSO0FBSFE7QUFDQTtBQUNBO0FBQ0E7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUhRO0FBQ0E7QUFDSTtBQUtaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDQTtBQUtSO0FBQ0E7QUFGSTtBQUlKO0FBRlE7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFJUjtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBSVI7QUFDQTtBQUZJO0FBSUo7QUFGUTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBSUo7QUFGTTtBQUNFO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFGUTtBQUNJO0FBSVo7QUFDQTtBQUhZO0FBS1o7QUFIUTtBQUtSO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFDSTtBQUlaO0FBRk07QUFDRTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBRk07QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFJZDtBQUNBO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUlSO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFJVjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBSVI7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFJWjtBQUZnQjtBQUNBO0FBSWhCO0FBQ0E7QUFDQTtBQUZRO0FBQ0k7QUFDSTtBQUNBO0FBSWhCO0FBRmdCO0FBSWhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGSTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUZJO0FBQ0U7QUFDSTtBQUNBO0FBSVY7QUFGTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSU47QUFDQTtBQUZJO0FBQ0U7QUFDSTtBQUlWO0FBQ0E7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUloQjtBQUNBO0FBQ0E7QUFGUTtBQUNJO0FBQ0E7QUFDQTtBQUlaO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBSVo7QUFGUTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFDSTtBQUlaO0FBQ0E7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUVJO0FBQ0E7QUFDSTtBQUdoQjtBQUNBO0FBQ0E7QUFEUTtBQUNJO0FBQ0E7QUFDQTtBQUdaO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBR1o7QUFEUTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUdaO0FBQ0E7QUFESTtBQUNJO0FBQ0k7QUFHWjtBQURZO0FBR1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL3FCQTtBQUNJO0FBQ0E7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNRO0FBQ1I7QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDSjtBQUFNO0FBQ0E7QUFFTjtBQUFNO0FBQ0U7QUFDQTtBQUVSO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFDRTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0U7QUFDRTtBQUNBO0FBRUU7QUFDVjtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNWO0FBQ0E7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlGQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNFO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDTTtBQUNBO0FBQ0U7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDQTtBQUVFO0FBQVY7QUFDQTtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFBVjtBQUNBO0FBQ0E7QUFFTTtBQUFOO0FBQ0E7QUFFSTtBQUNFO0FBQ0U7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUVBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBRUk7QUFDQTtBQUFKO0FBRVE7QUFDQTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQ0E7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFDQTtBQUVZO0FBQVo7QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUVRO0FBQ0E7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRVk7QUFBWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFb0I7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUF4QjtBQUVvQjtBQUNJO0FBQ0k7QUFDQTtBQUE1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdvQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBRHhCO0FBR29CO0FBQ0k7QUFDSTtBQUNBO0FBRDVCO0FBQ0E7QUFDQTtBQUNBO0FBSWM7QUFDQTtBQUZkO0FBQ0E7QUFDQTtBQUNBO0FBSWM7QUFDSTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBRnhCO0FBSXNCO0FBQ0E7QUFDSTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBRjlCO0FBSThCO0FBRjlCO0FBSTRCO0FBRjVCO0FBSTRCO0FBRjVCO0FBQ0E7QUFDQTtBQUlrQjtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBRnRCO0FBS3NCO0FBQ0E7QUFIdEI7QUFLb0I7QUFDRTtBQUh0QjtBQUtzQjtBQUNBO0FBSHRCO0FBQ0E7QUFNb0I7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBSmhDO0FBTWdDO0FBSmhDO0FBTThCO0FBSjlCO0FBTThCO0FBSjlCO0FBQ0E7QUFNd0I7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUpsQztBQUNBO0FBS3NDO0FBQ0E7QUFDSTtBQUNBO0FBSDFDO0FBQ0E7QUFDQTtBQUtnQztBQUhoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUhwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFISjtBQUNBO0FBQ0E7QUFNUTtBQUNJO0FBQ0E7QUFDSTtBQUpoQjtBQU1ZO0FBQ0k7QUFKaEI7QUFNWTtBQUpaO0FBQ0E7QUFNUTtBQUNBO0FBRUk7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQU5oQjtBQVNnQjtBQVBoQjtBQVVnQjtBQVJoQjtBQUNBO0FBVVE7QUFSUjtBQVVJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUlI7QUFVSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBUlo7QUFVUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFSWjtBQVVZO0FBQ0U7QUFDRTtBQVJoQjtBQUNBO0FBQ0E7QUFDQTtBQVdlO0FBVGY7QUFVbUI7QUFDQTtBQUNHO0FBUnRCO0FBVXNCO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFSMUI7QUFVd0I7QUFDQTtBQVJ4QjtBQUNBO0FBVW9CO0FBQ0Q7QUFDSztBQVJ4QjtBQVd3QjtBQVR4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZUTtBQVZSO0FBWVE7QUFDRztBQUNBO0FBQ0E7QUFWWDtBQVdlO0FBVGY7QUFDQTtBQVdRO0FBVFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNJO0FBRUk7QUFDQTtBQUNBO0FBYlI7QUFlUTtBQUNBO0FBYlI7QUFlUTtBQUNBO0FBRUk7QUFDQTtBQUNBO0FBZFo7QUFDQTtBQWdCUTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBZGhCO0FBaUJnQjtBQUNBO0FBQ0E7QUFDQTtBQWZoQjtBQWtCZ0I7QUFDQTtBQUNBO0FBQ0E7QUFoQmhCO0FBbUJnQjtBQUNBO0FBQ0E7QUFDQTtBQWpCaEI7QUFvQmdCO0FBQ0M7QUFDRDtBQUNBO0FBbEJoQjtBQW9CZ0I7QUFDQztBQUNEO0FBQ0E7QUFsQmhCO0FBQ0E7QUFvQlM7QUFFSTtBQUNJO0FBbkJqQjtBQUNBO0FBQ0E7QUFxQkk7QUFDSTtBQUNBO0FBQ0E7QUFuQlI7QUFxQkk7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBbkJSO0FBQ0E7QUFxQkk7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQW5CTjtBQUNBO0FBcUJRO0FBbkJSO0FBcUJNO0FBQ0U7QUFDQTtBQW5CUjtBQXFCTTtBQW5CTjtBQXFCSTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQStCO0FBbEJ6QztBQW1CVTtBQUNBO0FBQ0E7QUFDQTtBQWpCVjtBQUNBO0FBbUJJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFqQmhCO0FBbUJZO0FBQ0E7QUFqQlo7QUFtQlk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpCWjtBQUNBO0FBbUJJO0FBQ0U7QUFDRTtBQUNBO0FBakJSO0FBbUJNO0FBQ0E7QUFqQk47QUFDQTtBQW1CSTtBQUNJO0FBQ0E7QUFDQTtBQWpCUjtBQUNBO0FBbUJJO0FBQ0k7QUFqQlI7QUFtQlE7QUFqQlI7QUFDQTtBQW1CSTtBQUNFO0FBakJOO0FBQ0E7QUFtQkk7QUFDSTtBQWpCUjtBQUNBO0FBbUJJO0FBakJKO0FBbUJRO0FBQ0E7QUFqQlI7QUFtQlE7QUFqQlI7QUFDQTtBQW1CSTtBQUNJO0FBQ0k7QUFDQTtBQWpCWjtBQUNBO0FBQ0E7QUFDQTtBQW9CZ0I7QUFDQTtBQWxCaEI7QUFDQTtBQUNBO0FBb0JRO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFsQlY7QUFvQlE7QUFsQlI7QUFvQlk7QUFsQlo7QUFvQlU7QUFDRTtBQWxCWjtBQUNBO0FBbUJZO0FBakJaO0FBQ0E7QUFDQTtBQUNBO0FBb0JJO0FBRUk7QUFDQTtBQW5CUjtBQUNBO0FBcUJJO0FBbkJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFxQlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkJSO0FBQ0E7QUFzQkk7QUFDSTtBQUNFO0FBQ0U7QUFwQlo7QUFzQlk7QUFDQTtBQXBCWjtBQXNCUTtBQUNBO0FBQ0E7QUFwQlI7QUFDQTtBQXNCUTtBQUNBO0FBcEJSO0FBQ0E7QUFzQkk7QUFDSTtBQUNJO0FBcEJaO0FBQ0E7QUFDQTtBQXNCSTtBQUNJO0FBcEJSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNqbEJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ1o7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ1o7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ1o7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDaEI7QUFDZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNwQjtBQUNvQjtBQUNwQjtBQUNnQjtBQUNoQjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBR1I7QUFEUTtBQUNJO0FBR1o7QUFDQTtBQUNBO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFHWjtBQUNBO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFHWjtBQUNBO0FBRFk7QUFHWjtBQUNBO0FBQVE7QUFFUjtBQUNRO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQWdCO0FBQ0E7QUFDQTtBQUVoQjtBQURvQjtBQUNJO0FBR3hCO0FBRHdCO0FBR3hCO0FBQ0E7QUFEb0I7QUFHcEI7QUFDQTtBQUNBO0FBRmdCO0FBQ0E7QUFJaEI7QUFDQTtBQUZRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUlaO0FBRlM7QUFJVDtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFJUjtBQUZRO0FBQ0E7QUFJUjtBQUZRO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFJcEI7QUFDQTtBQUZZO0FBQ0E7QUFJWjtBQUNBO0FBQ0E7QUFGSTtBQUlKO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUlSO0FBRlE7QUFDQTtBQUNBO0FBSVI7QUFGUTtBQUNJO0FBQ0k7QUFJaEI7QUFGWTtBQUNJO0FBSWhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFFSjtBQUVJO0FBQ0k7QUFDSTtBQUFaO0FBQ0E7QUFFUTtBQUNJO0FBQVo7QUFDQTtBQUVRO0FBQVI7QUFFUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFaO0FBQ0E7QUFFUTtBQUF5QjtBQUNqQztBQUNBO0FBQVE7QUFDSTtBQUNJO0FBRWhCO0FBQ0E7QUFDQTtBQUFRO0FBRVI7QUFBUTtBQUNJO0FBRVo7QUFBWTtBQUVaO0FBQVk7QUFFWjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQVk7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFBWjtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFESjtBQUVRO0FBQVI7QUFDWTtBQUNJO0FBQ2hCO0FBQ2dCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFBUTtBQUVSO0FBRFk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUdSO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUNBO0FBR1o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQURnQjtBQUdoQjtBQURZO0FBR1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRFE7QUFDSTtBQUNJO0FBQ0E7QUFHaEI7QUFEZ0I7QUFHaEI7QUFEWTtBQUdaO0FBRFE7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUdoQjtBQURnQjtBQUdoQjtBQUNBO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUVSO0FBQUs7QUFFTDtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRVo7QUFBWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRVo7QUFBWTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBRWhCO0FBQ0E7QUFBWTtBQUNJO0FBQ0k7QUFFcEI7QUFBZ0I7QUFDSTtBQUVwQjtBQUNBO0FBQ0E7QUFBUTtBQUNLO0FBRWI7QUFBWTtBQUNJO0FBRWhCO0FBQ0E7QUFBZ0I7QUFFaEI7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUVKO0FBQVE7QUFDSTtBQUNBO0FBRVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUVaO0FBQ0E7QUFEWTtBQUNBO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFHSjtBQURRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdaO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUTtBQUNJO0FBRVo7QUFDQTtBQURZO0FBQ0E7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1o7QUFEWTtBQUNBO0FBQ0E7QUFHWjtBQURZO0FBQ0k7QUFHaEI7QUFDQTtBQURnQjtBQUNBO0FBR2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDSTtBQUdaO0FBRFk7QUFHWjtBQURZO0FBR1o7QUFEUTtBQUdSO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFIUTtBQUtSO0FBSFE7QUFDQTtBQUNBO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFLUjtBQUhJO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFLeEI7QUFKNEI7QUFDQTtBQUNJO0FBTWhDO0FBSmdDO0FBTWhDO0FBQ0E7QUFKNEI7QUFNNUI7QUFMZ0M7QUFPaEM7QUFMZ0M7QUFPaEM7QUFDQTtBQUw0QjtBQUNBO0FBQ0E7QUFDQTtBQU81QjtBQUNBO0FBSndCO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFNNUI7QUFKNEI7QUFDSTtBQU1oQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKZ0I7QUFNaEI7QUFMb0I7QUFDSTtBQU94QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBT1I7QUFOWTtBQVFaO0FBUGdCO0FBRUk7QUFDQTtBQVFwQjtBQU5vQjtBQVFwQjtBQUNBO0FBTGdCO0FBT2hCO0FBQ0E7QUFMWTtBQUNJO0FBT2hCO0FBTGdCO0FBT2hCO0FBQ0E7QUFMWTtBQUNBO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQU9KO0FBTFE7QUFDSTtBQU9aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMUTtBQUNJO0FBQ0E7QUFPWjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFBcUM7QUFRN0M7QUFDQTtBQVBRO0FBU1I7QUFQWTtBQVNaO0FBUFk7QUFTWjtBQVBZO0FBQ0k7QUFDQTtBQVNoQjtBQUNBO0FBQ0E7QUFDQTtBQU5RO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFRUjtBQU5RO0FBUVI7QUFOUTtBQVFSO0FBTlE7QUFRUjtBQU5RO0FBQ0k7QUFDQTtBQUNJO0FBUWhCO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNJO0FBT1o7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBTFE7QUFPUjtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFMUTtBQU9SO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNJO0FBT1o7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0E7QUFDQTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT1I7QUFMUTtBQU9SO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMUTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFPaEI7QUFDQTtBQUxRO0FBQ0E7QUFDQTtBQU9SO0FBQ0E7QUFDQTtBQUxRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFPaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTFk7QUFPWjtBQUxRO0FBT1I7QUFMUTtBQUNBO0FBQ0k7QUFDQTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQU9SO0FBQ0E7QUFDQTtBQUxJO0FBT0o7QUFMUTtBQUNJO0FBQ0k7QUFDQTtBQU9oQjtBQUpnQjtBQUNBO0FBTWhCO0FBSGdCO0FBQ0E7QUFLaEI7QUFGZ0I7QUFDQTtBQUloQjtBQURnQjtBQUNBO0FBR2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRGdCO0FBR2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUNBO0FBSFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBS1o7QUFIWTtBQUtaO0FBSFE7QUFDQTtBQUNBO0FBQ0E7QUFLUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFLSjtBQUhRO0FBS1I7QUFIUTtBQUtSO0FBQ0E7QUFDQTtBQUhRO0FBS1I7QUFDQTtBQUhRO0FBQ0E7QUFLUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSFk7QUFLWjtBQUNBO0FBQ0E7QUFIZ0I7QUFDSTtBQUtwQjtBQUNBO0FBQ0E7QUFDQTtBQUhRO0FBQ0k7QUFDSTtBQUNBO0FBS2hCO0FBSFk7QUFLWjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUxRO0FBT1I7QUFMUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUxRO0FBQ0E7QUFDSTtBQU9aO0FBQ0E7QUFMUTtBQUNJO0FBT1o7QUFMUTtBQU9SO0FBTFE7QUFDQTtBQU9SO0FBQ0E7QUFDQTtBQUxZO0FBQ0k7QUFPaEI7QUFDQTtBQUNBO0FBQ0E7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQU9SO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFPUjtBQUxJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9SO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQUTtBQUNBO0FBQ0k7QUFTWjtBQVBRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQVNoQjtBQVBZO0FBU1o7QUFQWTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBU2hCO0FBQ0E7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQVFaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOZ0I7QUFRaEI7QUFOWTtBQUNBO0FBUVo7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBUWhCO0FBTlk7QUFRWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0k7QUFDQTtBQU9aO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPUjtBQUxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9SO0FBTFE7QUFDSTtBQU9aO0FBQ0E7QUFMUTtBQUNJO0FBT1o7QUFOZ0I7QUFDSTtBQVFwQjtBQUNBO0FBQ0E7QUFQZ0I7QUFDSTtBQVNwQjtBQVJ3QjtBQVV4QjtBQVJ3QjtBQVV4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUlE7QUFDSTtBQVVaO0FBVGdCO0FBV2hCO0FBVGdCO0FBV2hCO0FBQ0E7QUFDQTtBQVRRO0FBV1I7QUFWWTtBQVlaO0FBWGdCO0FBQ0E7QUFhaEI7QUFDQTtBQVpnQjtBQUNBO0FBY2hCO0FBQ0E7QUFDQTtBQVpZO0FBY1o7QUFiZ0I7QUFDQTtBQWVoQjtBQUNBO0FBYmdCO0FBQ0E7QUFlaEI7QUFDQTtBQUNBO0FBYlE7QUFDSTtBQWVaO0FBYlE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBZWhCO0FBQ0E7QUFiUTtBQUNJO0FBQ0k7QUFlaEI7QUFiZ0I7QUFlaEI7QUFDQTtBQVpZO0FBY1o7QUFaUTtBQUNBO0FBQ0E7QUFjUjtBQUNBO0FBWkk7QUFDSTtBQUVJO0FBYVo7QUFDQTtBQVhRO0FBQXFDO0FBYzdDO0FBQ0E7QUFiUTtBQWVSO0FBYlE7QUFlUjtBQWJRO0FBQXNEO0FBZ0I5RDtBQUNBO0FBZlE7QUFpQlI7QUFmWTtBQWlCWjtBQUNBO0FBZFE7QUFnQlI7QUFkUTtBQWdCUjtBQWRRO0FBZ0JSO0FBZFE7QUFnQlI7QUFkWTtBQWdCWjtBQUNBO0FBQ0E7QUFaSTtBQWNKO0FBWlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNSO0FBWkk7QUFDSTtBQWNSO0FBQ0E7QUFDQTtBQVpJO0FBY0o7QUFaUTtBQUNJO0FBQ0E7QUFjWjtBQUNBO0FBWlE7QUFDQTtBQUNBO0FBY1I7QUFaUTtBQUNJO0FBY1o7QUFDQTtBQUNBO0FBWkk7QUFDSTtBQUNBO0FBY1I7QUFaUTtBQUNJO0FBY1o7QUFDQTtBQVpRO0FBY1I7QUFaUTtBQUNJO0FBY1o7QUFaUTtBQWNSO0FBWkk7QUFDSTtBQUNBO0FBY1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpRO0FBQ0k7QUFDSTtBQWNoQjtBQUNBO0FBQ0E7QUFDQTtBQVpJO0FBY0o7QUFDQTtBQUNBO0FBQ0E7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFk7QUFhWjtBQVhZO0FBYVo7QUFYWTtBQWFaO0FBWFk7QUFBeUQ7QUFjckU7QUFDQTtBQWJZO0FBZVo7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFDQTtBQWRvQjtBQWdCcEI7QUFDQTtBQWJvQjtBQWVwQjtBQUNBO0FBYmdCO0FBZWhCO0FBYm9CO0FBZXBCO0FBYm9CO0FBZXBCO0FBYm9CO0FBZXBCO0FBQ0E7QUFDQTtBQVZZO0FBWVo7QUFWWTtBQVlaO0FBVmdCO0FBWWhCO0FBVm9CO0FBWXBCO0FBVm9CO0FBWXBCO0FBQ0E7QUFDQTtBQUNBO0FBUlE7QUFVUjtBQVJZO0FBVVo7QUFSWTtBQVVaO0FBUlk7QUFVWjtBQVJZO0FBVVo7QUFSWTtBQVVaO0FBUmdCO0FBVWhCO0FBQ0E7QUFUb0I7QUFXcEI7QUFUb0I7QUFXcEI7QUFDQTtBQVRnQjtBQVdoQjtBQUNBO0FBUmdCO0FBVWhCO0FBQ0E7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQVFaO0FBQ0E7QUFMUTtBQU9SO0FBQ0E7QUFMWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFPUjtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFDQTtBQU9SO0FBQ0E7QUFMSTtBQU9KO0FBTFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQU9aO0FBQ0E7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQU9SO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQU9SO0FBTFE7QUFPUjtBQUNBO0FBTFE7QUFDSTtBQUNBO0FBT1o7QUFDQTtBQUxRO0FBQ0E7QUFPUjtBQUxZO0FBT1o7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUxRO0FBQ0k7QUFDQTtBQU9aO0FBQ0E7QUFKUTtBQU1SO0FBQ0E7QUFDQTtBQUNBO0FBSlk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQU1oQjtBQUNBO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQU1SO0FBQ0E7QUFKUTtBQU1SO0FBQ0E7QUFKUTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBSlE7QUFDSTtBQUNJO0FBTWhCO0FBQ0E7QUFKWTtBQU1aO0FBQ0E7QUFKUTtBQUNJO0FBQ0E7QUFNWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFNUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUpRO0FBTVI7QUFKWTtBQU1aO0FBQ0E7QUFKUTtBQU1SO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQU1aO0FBQ0E7QUFKUTtBQUNBO0FBQ0k7QUFDSTtBQU1oQjtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFNUjtBQUNBO0FBSkk7QUFDSTtBQU1SO0FBSlE7QUFDSTtBQU1aO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQ0E7QUFNUjtBQUpRO0FBQ0E7QUFNUjtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQU1aO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQU1aO0FBQ0E7QUFKUTtBQUNBO0FBQ0k7QUFDQTtBQU1aO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQU1SO0FBQ0E7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNJO0FBS1o7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBS1I7QUFIUTtBQUtSO0FBQ0E7QUFISTtBQUNJO0FBQ0k7QUFLWjtBQUNBO0FBSFE7QUFLUjtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBQ0E7QUFIUTtBQUNJO0FBS1o7QUFIUTtBQUtSO0FBQ0E7QUFISTtBQUNJO0FBS1I7QUFDQTtBQUhJO0FBS0o7QUFIUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBS1o7QUFIUTtBQUNJO0FBS1o7QUFDQTtBQUhZO0FBQ0k7QUFLaEI7QUFIWTtBQUNBO0FBQ0E7QUFLWjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFDSTtBQUNBO0FBS1o7QUFDQTtBQUhRO0FBQ0k7QUFDQTtBQUtaO0FBSFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLUjtBQUNBO0FBSFE7QUFDSTtBQUtaO0FBSFE7QUFDSTtBQUtaO0FBSFE7QUFDSTtBQUtaO0FBSFE7QUFDSTtBQUtaO0FBSFE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQVE7QUFBbUI7QUFDbkI7QUFBbUI7QUFDbkI7QUFBbUI7QUFDbkI7QUFBbUI7QUFFL0I7QUFDSTtBQUFRO0FBQW9CO0FBQ3BCO0FBQWtCO0FBQ2xCO0FBQWtCO0FBQ2xCO0FBQWtCO0FBQ2xCO0FBQWtCO0FBQ2xCO0FBQWtCO0FBQ2xCO0FBQWtCO0FBQ2xCO0FBQWtCO0FBQ2xCO0FBQWtCO0FBQ2pCO0FBQW1CO0FBQ25CO0FBQW9CO0FBQ3BCO0FBQW9CO0FBQ3BCO0FBQW9CO0FBRWpDO0FBc0JaO0FBQ0E7QUFwQlE7QUFDSTtBQXNCWjtBQXBCWTtBQXNCWjtBQXBCWTtBQXNCWjtBQXBCUTtBQUNJO0FBc0JaO0FBcEJZO0FBc0JaO0FBQ0E7QUFwQlE7QUFzQlI7QUFDQTtBQUNBO0FBQ0E7QUFwQkk7QUFDSTtBQUNJO0FBc0JaO0FBQ0E7QUFwQlE7QUFzQlI7QUFDQTtBQUNBO0FBcEJJO0FBQ0k7QUFDSTtBQXNCWjtBQUNBO0FBcEJRO0FBQ0k7QUFzQlo7QUFDQTtBQXBCUTtBQXNCUjtBQUNBO0FBQ0E7QUFwQkk7QUFDSTtBQUNJO0FBc0JaO0FBQ0E7QUFwQlE7QUFzQlI7QUFDQTtBQW5CSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQXFCWjtBQUNBO0FBbkJRO0FBQ0E7QUFBc0Q7QUFzQjlEO0FBckJRO0FBQ0E7QUFDSTtBQUNBO0FBdUJaO0FBQ0E7QUFDQTtBQXJCSTtBQXVCSjtBQXJCUTtBQUNJO0FBQ0E7QUF1Qlo7QUFDQTtBQXJCUTtBQXVCUjtBQXJCUTtBQXVCUjtBQXJCUTtBQXVCUjtBQXJCUTtBQXVCUjtBQXJCWTtBQXVCWjtBQXJCZ0I7QUF1QmhCO0FBckJnQjtBQXVCaEI7QUFDQTtBQUNBO0FBcEJRO0FBc0JSO0FBcEJZO0FBc0JaO0FBcEJnQjtBQXNCaEI7QUFwQmdCO0FBc0JoQjtBQUNBO0FBbkJRO0FBQ0E7QUFxQlI7QUFuQlE7QUFBK0I7QUFzQnZDO0FBQ0E7QUFyQlE7QUFBK0I7QUF3QnZDO0FBQ0E7QUF2QlE7QUFDSTtBQUErQjtBQTBCM0M7QUFDQTtBQUNBO0FBeEJRO0FBMEJSO0FBeEJRO0FBMEJSO0FBeEJZO0FBMEJaO0FBeEJZO0FBMEJaO0FBQ0E7QUF2QlE7QUF5QlI7QUF2QlE7QUF5QlI7QUF2QlE7QUF5QlI7QUF2QlE7QUF5QlI7QUF2QlE7QUF5QlI7QUF2QlE7QUF5QlI7QUF2Qlk7QUF5Qlo7QUF2QmdCO0FBeUJoQjtBQUNBO0FBdEJZO0FBd0JaO0FBdEJZO0FBd0JaO0FBQ0E7QUFyQlE7QUF1QlI7QUFyQlk7QUF1Qlo7QUFyQmdCO0FBdUJoQjtBQXJCb0I7QUF1QnBCO0FBQ0E7QUFwQmdCO0FBc0JoQjtBQUNBO0FBQ0E7QUFsQlE7QUFvQlI7QUFsQlE7QUFvQlI7QUFsQlk7QUFBK0I7QUFxQjNDO0FBQ0E7QUFwQlk7QUFzQlo7QUFDQTtBQXBCUTtBQUNJO0FBc0JaO0FBQ0E7QUFDQTtBQXBCUTtBQXNCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFuQkk7QUFDSTtBQUF1RTtBQXNCL0U7QUFDQTtBQXJCUTtBQXVCUjtBQXJCUTtBQXVCUjtBQXJCUTtBQXVCUjtBQXJCUTtBQXVCUjtBQXJCUTtBQXVCUjtBQXJCUTtBQXVCUjtBQXJCUTtBQUFxQztBQXdCN0M7QUFDQTtBQXZCUTtBQXlCUjtBQUNBO0FBeEJZO0FBMEJaO0FBeEJZO0FBMEJaO0FBdkJnQjtBQXlCaEI7QUF2QmdCO0FBeUJoQjtBQXZCZ0I7QUF5QmhCO0FBdkJnQjtBQUNBO0FBQ0k7QUF5QnBCO0FBQ0E7QUF2QmdCO0FBeUJoQjtBQXZCZ0I7QUF5QmhCO0FBQ0E7QUFDQTtBQXJCUTtBQUFxQztBQXdCN0M7QUFDQTtBQXZCUTtBQXlCUjtBQUNBO0FBeEJZO0FBQXFDO0FBMkJqRDtBQUNBO0FBMUJZO0FBNEJaO0FBMUJZO0FBNEJaO0FBQ0E7QUEzQmdCO0FBNkJoQjtBQTNCZ0I7QUE2QmhCO0FBM0JnQjtBQTZCaEI7QUFDQTtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBNUJ3QjtBQThCeEI7QUFDQTtBQTNCb0I7QUE2QnBCO0FBQ0E7QUExQmdCO0FBNEJoQjtBQTFCZ0I7QUE0QmhCO0FBQ0E7QUF6Qlk7QUEyQlo7QUF6Qlk7QUEyQlo7QUFDQTtBQTFCZ0I7QUE0QmhCO0FBMUJnQjtBQTRCaEI7QUExQmdCO0FBNEJoQjtBQUNBO0FBekJZO0FBMkJaO0FBekJZO0FBQWlDO0FBNEI3QztBQUNBO0FBM0JZO0FBNkJaO0FBQ0E7QUE1QmdCO0FBOEJoQjtBQTVCZ0I7QUE4QmhCO0FBNUJvQjtBQThCcEI7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBQ0E7QUFDQTtBQTVCb0I7QUE4QnBCO0FBQ0E7QUE3QndCO0FBK0J4QjtBQUNBO0FBN0I0QjtBQStCNUI7QUE3QjRCO0FBK0I1QjtBQTdCNEI7QUErQjVCO0FBN0I0QjtBQStCNUI7QUE3QjRCO0FBK0I1QjtBQTdCNEI7QUErQjVCO0FBQ0E7QUE1QndCO0FBOEJ4QjtBQUNBO0FBQ0E7QUFDQTtBQTNCb0I7QUE2QnBCO0FBQ0E7QUFDQTtBQXpCWTtBQTJCWjtBQUNBO0FBQ0E7QUFDQTtBQTFCZ0I7QUE0QmhCO0FBMUJnQjtBQUErQztBQTZCL0Q7QUFDQTtBQUNBO0FBMUJZO0FBNEJaO0FBQ0E7QUEzQmdCO0FBQXFDO0FBOEJyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBMUJJO0FBNEJKO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBQ0E7QUExQkk7QUE0Qko7QUFDQTtBQUNBO0FBQ0E7QUE5QlE7QUFDQTtBQUNBO0FBQ0E7QUFnQ1I7QUE5QlE7QUFDSTtBQWdDWjtBQUNBO0FBOUJRO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCUTtBQWdDUjtBQTlCWTtBQUNJO0FBZ0NoQjtBQUNBO0FBOUJZO0FBQ0E7QUFDQTtBQUNJO0FBZ0NoQjtBQTlCb0I7QUFBK0I7QUFpQ25EO0FBQ0E7QUFoQ29CO0FBa0NwQjtBQUNBO0FBOUJvQjtBQUErQjtBQWlDbkQ7QUFDQTtBQWhDb0I7QUFrQ3BCO0FBQ0E7QUE5Qm9CO0FBQStCO0FBaUNuRDtBQUNBO0FBaENvQjtBQWtDcEI7QUFDQTtBQS9Cb0I7QUFBK0I7QUFrQ25EO0FBQ0E7QUFqQ29CO0FBbUNwQjtBQUNBO0FBL0JvQjtBQUErQjtBQWtDbkQ7QUFDQTtBQWpDb0I7QUFtQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBaENRO0FBa0NSO0FBaENZO0FBa0NaO0FBaENZO0FBQ0k7QUFDSTtBQUNJO0FBa0N4QjtBQUNBO0FBQ0E7QUFDQTtBQS9CWTtBQUNJO0FBQ0k7QUFpQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBL0JRO0FBaUNSO0FBQ0E7QUEvQkk7QUFpQ0o7QUFDQTtBQTdCSTtBQUNJO0FBQ0E7QUErQlI7QUE3QlE7QUErQlI7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUFDQTtBQS9CUTtBQUNJO0FBaUNaO0FBQ0E7QUEvQlE7QUFDSTtBQUNBO0FBQ0E7QUFpQ1o7QUEvQlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBaUNaO0FBL0JRO0FBQ0E7QUFpQ1I7QUFDQTtBQS9CSTtBQUNJO0FBQ0k7QUFpQ1o7QUFDQTtBQUNBO0FBL0JJO0FBQ0k7QUFDQTtBQUNJO0FBaUNaO0FBQ0E7QUEvQlE7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQWlDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQS9CSTtBQWlDSjtBQUNBO0FBakNRO0FBQ0k7QUFDQTtBQUNBO0FBbUNaO0FBakNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQW1DWjtBQWpDUTtBQUNBO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDSTtBQUNJO0FBbUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQW1DUjtBQWpDWTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0s7QUFtQ3pCO0FBakNvQjtBQUNBO0FBbUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBaENnQjtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFrQ3BCO0FBQ0E7QUFDQTtBQWhDUTtBQUNJO0FBQ0E7QUFDSTtBQWtDaEI7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFrQ1o7QUFDQTtBQWhDWTtBQUNBO0FBa0NaO0FBaENRO0FBQ0k7QUFDQTtBQUNJO0FBa0NoQjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQUNBO0FBaENZO0FBQ0E7QUFrQ1o7QUFoQ1E7QUFDSTtBQUNBO0FBQ0E7QUFrQ1o7QUFDQTtBQWhDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFrQ1o7QUFDQTtBQWhDUTtBQUNJO0FBQ0E7QUFDSTtBQWtDaEI7QUFoQ1k7QUFrQ1o7QUFDQTtBQWhDUTtBQUNBO0FBa0NSO0FBL0JRO0FBQ0k7QUFpQ1o7QUFDQTtBQS9CUTtBQUNJO0FBQ0E7QUFDSTtBQWlDaEI7QUEvQlk7QUFpQ1o7QUFDQTtBQS9CSTtBQUNJO0FBQ0k7QUFpQ1o7QUFDQTtBQWhDWTtBQUNBO0FBa0NaO0FBQ0E7QUFDQTtBQWhDSTtBQUNJO0FBQ0k7QUFrQ1o7QUFDQTtBQWpDWTtBQUNBO0FBbUNaO0FBQ0E7QUFDQTtBQWpDSTtBQW1DSjtBQWpDUTtBQUNJO0FBbUNaO0FBQ0E7QUFsQ1k7QUFvQ1o7QUFDQTtBQUNBO0FBQ0E7QUFsQ0k7QUFDSTtBQUNJO0FBb0NaO0FBbENRO0FBb0NSO0FBbENRO0FBb0NSO0FBbENRO0FBb0NSO0FBbENRO0FBb0NSO0FBbENRO0FBQXlEO0FBcUNqRTtBQUNBO0FBcENRO0FBc0NSO0FBcENZO0FBc0NaO0FBcENZO0FBc0NaO0FBcENZO0FBc0NaO0FBcENZO0FBc0NaO0FBcENZO0FBc0NaO0FBcENZO0FBc0NaO0FBcENZO0FBc0NaO0FBcENZO0FBc0NaO0FBcENZO0FBc0NaO0FBQ0E7QUFyQ2dCO0FBdUNoQjtBQUNBO0FBcENnQjtBQXNDaEI7QUFDQTtBQXBDWTtBQXNDWjtBQXBDZ0I7QUFzQ2hCO0FBcENnQjtBQXNDaEI7QUFwQ2dCO0FBc0NoQjtBQUNBO0FBbkNZO0FBcUNaO0FBbkNnQjtBQXFDaEI7QUFDQTtBQWxDZ0I7QUFvQ2hCO0FBQ0E7QUFDQTtBQWpDUTtBQW1DUjtBQWpDUTtBQW1DUjtBQWpDUTtBQW1DUjtBQWpDWTtBQUNJO0FBQ0E7QUFtQ2hCO0FBQ0E7QUFDQTtBQWhDUTtBQWtDUjtBQWhDUTtBQWtDUjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFoQ1k7QUFrQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE5Qkk7QUFDSTtBQUNBO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQWdDWjtBQTlCUTtBQWdDUjtBQUNBO0FBQ0E7QUE5Qkk7QUFnQ0o7QUFDQTtBQUNBO0FBOUJRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWdDUjtBQUNBO0FBQ0E7QUE5Qkk7QUFnQ0o7QUFDQTtBQUNBO0FBOUJRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWdDUjtBQUNBO0FBQ0E7QUE5Qkk7QUFDSTtBQUNJO0FBZ0NaO0FBQ0E7QUE5QlE7QUFDQTtBQWdDUjtBQUNBO0FBQ0E7QUE5Qkk7QUFDSTtBQUNBO0FBQ0k7QUFnQ1o7QUFDQTtBQTlCUTtBQWdDUjtBQTlCUTtBQUNJO0FBQ0E7QUFDQTtBQWdDWjtBQUNBO0FBQ0E7QUFDQTtBQTlCSTtBQUNJO0FBQ0E7QUFDSTtBQWdDWjtBQTlCUTtBQWdDUjtBQTlCUTtBQWdDUjtBQTlCWTtBQWdDWjtBQUNBO0FBQ0E7QUE1Qkk7QUFDSTtBQUNJO0FBOEJaO0FBQ0E7QUFDQTtBQTVCSTtBQUNJO0FBQ0E7QUFDSTtBQThCWjtBQTVCUTtBQThCUjtBQUNBO0FBNUJJO0FBQ0k7QUFDQTtBQUNJO0FBOEJaO0FBNUJRO0FBOEJSO0FBQ0E7QUE1Qkk7QUFDSTtBQThCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJJO0FBQ0k7QUFDQTtBQUNJO0FBOEJaO0FBNUJRO0FBQ0E7QUE4QlI7QUFDQTtBQTVCSTtBQUNJO0FBQ0E7QUE4QlI7QUFDQTtBQUNBO0FBNUJRO0FBQ0k7QUE4Qlo7QUEzQlk7QUE2Qlo7QUExQlk7QUE0Qlo7QUF6Qlk7QUEyQlo7QUF6QlE7QUEyQlI7QUFDQTtBQXpCSTtBQUNJO0FBQ0E7QUFDQTtBQTJCUjtBQUNBO0FBekJJO0FBQ0k7QUFDQTtBQUNJO0FBMkJaO0FBekJRO0FBQ0k7QUEyQlo7QUF6QlE7QUFDQTtBQTJCUjtBQUNBO0FBekJJO0FBQ0k7QUFDQTtBQUNBO0FBMkJSO0FBQ0E7QUF6Qkk7QUFDSTtBQUNBO0FBQ0k7QUEyQlo7QUF4Qlk7QUEwQlo7QUF2Qlk7QUF5Qlo7QUF2QlE7QUFDQTtBQXlCUjtBQUNBO0FBQ0E7QUF2Qkk7QUF5Qko7QUFDQTtBQUNBO0FBdkJJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUF5Qlo7QUFDQTtBQXZCUTtBQUNJO0FBQ0E7QUFDQTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0E7QUFDSTtBQUNBO0FBeUJaO0FBQ0E7QUF2QlE7QUFDSTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF5QlI7QUF2QlE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0E7QUFDSTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0E7QUFDSTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0E7QUF5QlI7QUFDQTtBQUNBO0FBdkJJO0FBQ0k7QUFDSTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0k7QUFDQTtBQXlCWjtBQXZCWTtBQUNBO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBeUJoQjtBQUNBO0FBQ0E7QUF2QlE7QUFDSTtBQXlCWjtBQUNBO0FBdkJRO0FBeUJSO0FBQ0E7QUF2Qkk7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBeUJaO0FBdkJRO0FBeUJSO0FBdkJRO0FBQ0E7QUFDSTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0E7QUF5QlI7QUFDQTtBQUNBO0FBdkJBO0FBQ0k7QUF5Qko7QUF2QkE7QUF5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9pR0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNaO0FBQ1k7QUFDWjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ007QUFDQTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUVJO0FBQ0U7QUFBTjtBQUNBO0FBRUk7QUFDSTtBQUFSO0FBQ0E7QUFFSTtBQUNFO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0U7QUFBTjtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQVo7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFDQTtBQUVLO0FBQ0c7QUFBUjtBQUVRO0FBQ0k7QUFDQTtBQUNBO0FBQVo7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBWjtBQUVRO0FBQ0E7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQ0E7QUFBWjtBQUNBO0FBRVE7QUFDSTtBQUNBO0FBQVo7QUFDQTtBQUVRO0FBQ0E7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNRO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNoQjtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUFRO0FBQWlCO0FBQ2pCO0FBQWtCO0FBQ2xCO0FBQWtCO0FBQ2xCO0FBQWtCO0FBRTlCO0FBS1I7QUFDQTtBQUhJO0FBS0o7QUFKUTtBQUNJO0FBQ0k7QUFNaEI7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUxRO0FBQ0k7QUFDSTtBQU9oQjtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9SO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkpBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUF5QztBQUVqRDtBQURZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUdaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0S0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNFO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFBWTtBQUVaO0FBQVE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFFaEI7QUFBZ0I7QUFFaEI7QUFBWTtBQUNJO0FBRWhCO0FBQ0E7QUFDQTtBQUFRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBRXBCO0FBQWdCO0FBQ0E7QUFFaEI7QUFEb0I7QUFHcEI7QUFDQTtBQURnQjtBQUNBO0FBQ0E7QUFHaEI7QUFEZ0I7QUFDQTtBQUdoQjtBQUZvQjtBQUlwQjtBQUNBO0FBSG9CO0FBS3BCO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDWTtBQUNaO0FBQ1k7QUFDWjtBQUNRO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDaEI7QUFFZ0I7QUFBaEI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBR1E7QUFDSTtBQUNJO0FBQ0E7QUFEaEI7QUFJZ0I7QUFDQTtBQUZoQjtBQUtnQjtBQUNBO0FBSGhCO0FBS1k7QUFDSTtBQUhoQjtBQUtZO0FBSFo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1REE7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUdBO0FBQ0k7QUFDQTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0QkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQVo7QUFFWTtBQUFaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDWjtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDaEI7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ1k7QUFDSTtBQUNJO0FBQ0E7QUFDcEI7QUFDZ0I7QUFDQTtBQUNBO0FBQ0k7QUFDcEI7QUFBd0I7QUFDQTtBQUV4QjtBQUNBO0FBQWdCO0FBRWhCO0FBQWdCO0FBQ0E7QUFDQTtBQUVoQjtBQUNBO0FBQVE7QUFDSTtBQUNBO0FBRVo7QUFBUTtBQUNJO0FBRVo7QUFBUTtBQUNJO0FBRVo7QUFBUTtBQUNJO0FBRVo7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQWdCO0FBRWhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hHQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFHQTtBQUNJO0FBQ0E7QUFEWjtBQUdRO0FBQ0k7QUFDQTtBQURaO0FBR1E7QUFDSTtBQUNBO0FBRFo7QUFDQTtBQUNBO0FBR1E7QUFDQTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBQ0E7QUFHUTtBQUNJO0FBRFo7QUFHUTtBQUNBO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBQ0k7QUFEWjtBQUdRO0FBQ0k7QUFEWjtBQUNBO0FBR1E7QUFDQTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNFO0FBQ0U7QUFDQTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNJO0FBQ0o7QUFDSTtBQUNBO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0E7QUFDQTtBQUNKO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDRTtBQUNGO0FBQ0k7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDTjtBQUNJO0FBQ0o7QUFDSTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ0k7QUFDSjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ007QUFDQTtBQUNOO0FBQ007QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ007QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ007QUFDQTtBQUNBO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNNO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFFTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQU47QUFDQTtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFRTtBQUFGO0FBSUU7QUFGRjtBQU1FO0FBSkY7QUFRRTtBQU5GO0FBVUU7QUFSRjtBQVlFO0FBVkY7QUFjRTtBQVpGO0FBY0k7QUFDQTtBQUNBO0FBQ0U7QUFaTjtBQUNBO0FBQ0E7QUFDQTtBQWNFO0FBWkY7QUFjSTtBQUNBO0FBWko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNFO0FBQ0U7QUFDQTtBQUNFO0FBWk47QUFjSTtBQVpKO0FBQ0E7QUFjSTtBQUNBO0FBQ0E7QUFaSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBY0U7QUFDRTtBQUNBO0FBQ0U7QUFaTjtBQWNJO0FBWko7QUFDQTtBQWNJO0FBQ0E7QUFDQTtBQVpKO0FBY0k7QUFDRTtBQVpOO0FBQ0E7QUFDQTtBQUNBO0FBY0U7QUFDRTtBQVpKO0FBQ0E7QUFDQTtBQWNFO0FBWkY7QUFjSTtBQUNBO0FBWko7QUFDQTtBQWNFO0FBQ0U7QUFaSjtBQWNJO0FBQ0U7QUFDQTtBQUNBO0FBWk47QUFDQTtBQWNJO0FBQ0U7QUFDRTtBQVpSO0FBQ0E7QUFjTTtBQVpOO0FBQ0E7QUFDQTtBQWNFO0FBWkY7QUFDQTtBQVlJO0FBQ0U7QUFWTjtBQUNBO0FBWUk7QUFDRTtBQVZOO0FBQ0E7QUFZSTtBQUNFO0FBQ0U7QUFWUjtBQUNBO0FBYUk7QUFYSjtBQUNBO0FBYUU7QUFYRjtBQUNBO0FBV0k7QUFDQTtBQUNBO0FBVEo7QUFXSTtBQVRKO0FBQ0E7QUFDQTtBQVdFO0FBQ0U7QUFDRTtBQVROO0FBQ0E7QUFXSTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFUVjtBQUNBO0FBQ0E7QUFXTTtBQVROO0FBQ0E7QUFDQTtBQUNBO0FBV0U7QUFDRTtBQVRKO0FBQ0E7QUFXRTtBQUNFO0FBVEo7QUFDQTtBQVdFO0FBQ0U7QUFDRTtBQUNBO0FBVE47QUFDQTtBQUNBO0FBQ0E7QUFXRTtBQUNFO0FBVEo7QUFDQTtBQUNBO0FBV0U7QUFDRTtBQUNBO0FBVEo7QUFXSTtBQVRKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFURjtBQVdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRGO0FBV0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEY7QUFDQTtBQUNBO0FBQ0E7QUFZQTtBQUNFO0FBVkY7QUFDQTtBQVlBO0FBQ0U7QUFDQTtBQVZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWFBO0FBQ0U7QUFDQTtBQVhGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFhQTtBQUNFO0FBQ0E7QUFYRjtBQUNBO0FBQ0E7QUFhQTtBQUNFO0FBQ0E7QUFYRjtBQWFFO0FBQ0E7QUFYRjtBQUNBO0FBYUE7QUFDQztBQUNHO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFDQTtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBQ0E7QUFhQTtBQUNFO0FBQ0U7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQUNBO0FBYUE7QUFDRTtBQUNBO0FBWEY7QUFhRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFDQTtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBQ0E7QUFhQTtBQUNFO0FBQ0U7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQUNBO0FBQ0E7QUFhQTtBQUNFO0FBQ0E7QUFDRTtBQVhKO0FBQ0E7QUFhRTtBQVhGO0FBQ0E7QUFhQTtBQVhBO0FBQ0E7QUFhRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFhQTtBQUNFO0FBQ0U7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBYUE7QUFYQTtBQUNBO0FBV0U7QUFDQTtBQVRGO0FBV0U7QUFDRTtBQVRKO0FBQ0E7QUFXRTtBQUNFO0FBQ0E7QUFUSjtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQVRKO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0U7QUFUSjtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0U7QUFDRTtBQVRKO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0U7QUFUSjtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQVRKO0FBQ0E7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNJO0FBQ0E7QUFDRTtBQVROO0FBQ0E7QUFXSTtBQVRKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQVRBO0FBQ0E7QUFTRTtBQUNBO0FBQ0U7QUFDQTtBQVBKO0FBQ0E7QUFTRTtBQVBGO0FBV0k7QUFDQTtBQUNFO0FBVE47QUFDQTtBQVdJO0FBVEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0E7QUFDSTtBQUNBO0FBQ0U7QUFDQTtBQVROO0FBQ0E7QUFXSTtBQVRKO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBQ0E7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFUSjtBQUNBO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0U7QUFUSjtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNFO0FBVEo7QUFDQTtBQVdFO0FBVEY7QUFDQTtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0U7QUFUSjtBQUNBO0FBV0U7QUFURjtBQUNBO0FBQ0E7QUFXQTtBQUNJO0FBQ0E7QUFDRTtBQVROO0FBQ0E7QUFXSTtBQVRKO0FBWU07QUFDQTtBQUNFO0FBVlI7QUFZTTtBQUNBO0FBQ0E7QUFWTjtBQUNBO0FBQ0E7QUFZQTtBQUNJO0FBQ0U7QUFWTjtBQUNBO0FBWUk7QUFWSjtBQUNBO0FBQ0E7QUFZQTtBQUNJO0FBQ0U7QUFDQTtBQVZOO0FBQ0E7QUFZSTtBQVZKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzV1QkE7QUFDQTtBQUNJO0FBQWtDO0FBRXRDO0FBQ0E7QUFESTtBQUdKO0FBREk7QUFHSjtBQURJO0FBR0o7QUFESTtBQUFrQztBQUl0QztBQUNBO0FBSEk7QUFBa0M7QUFNdEM7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQU5RO0FBQWlDO0FBU3pDO0FBQ0E7QUFSUTtBQVVSO0FBQ0E7QUFSUTtBQVVSO0FBUlk7QUFVWjtBQVJZO0FBVVo7QUFDQTtBQVBRO0FBU1I7QUFQWTtBQVNaO0FBUGdCO0FBU2hCO0FBUGdCO0FBU2hCO0FBQ0E7QUFDQTtBQU5RO0FBQW1DO0FBUzNDO0FBQ0E7QUFDQTtBQUNBO0FBUFE7QUFBaUM7QUFVekM7QUFDQTtBQVRRO0FBV1I7QUFDQTtBQVRRO0FBV1I7QUFUWTtBQVdaO0FBVFk7QUFXWjtBQUNBO0FBVFE7QUFXUjtBQVRZO0FBV1o7QUFUZ0I7QUFXaEI7QUFUZ0I7QUFXaEI7QUFDQTtBQUNBO0FBUlE7QUFBa0M7QUFXMUM7QUFDQTtBQVJRO0FBQWlDO0FBV3pDO0FBQ0E7QUFWUTtBQVlSO0FBVlE7QUFZUjtBQVZZO0FBWVo7QUFWWTtBQVlaO0FBQ0E7QUFUUTtBQVdSO0FBVFk7QUFXWjtBQVRnQjtBQVdoQjtBQVRnQjtBQVdoQjtBQUNBO0FBUlE7QUFBa0M7QUFXMUM7QUFDQTtBQUNBO0FBVkk7QUFZSjtBQVZJO0FBQWlDO0FBYXJDO0FBWkk7QUFjSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SEE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBSUk7QUFGSjtBQUlRO0FBRlI7QUFJUTtBQUZSO0FBSVE7QUFGUjtBQUlRO0FBRlI7QUFJUTtBQUZSO0FBSVE7QUFGUjtBQUlRO0FBRlI7QUFJUTtBQUZSO0FBSVk7QUFGWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRE07QUFHTjtBQUNBO0FBREk7QUFHSjtBQUNBO0FBSE07QUFLTjtBQUhJO0FBS0o7QUFITTtBQUtOO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFMUTtBQU9SO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFQUTtBQUNJO0FBU1o7QUFOWTtBQVFaO0FBQ0E7QUFOSTtBQUNFO0FBUU47QUFOSTtBQVFKO0FBQ0E7QUFSTTtBQVVOO0FBQ0E7QUFSSTtBQUNFO0FBVU47QUFDQTtBQUNBO0FBSk07QUFDRTtBQUNFO0FBTVY7QUFDQTtBQUpRO0FBQ0E7QUFNUjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFOTTtBQVFOO0FBTlE7QUFRUjtBQUNBO0FBTk07QUFRTjtBQUNBO0FBTkk7QUFRSjtBQUNBO0FBUk07QUFVTjtBQUNBO0FBUkk7QUFVSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWTTtBQVlOO0FBQ0E7QUFWSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFZUjtBQUNBO0FBQ0E7QUFWSTtBQUNFO0FBQ0E7QUFDRTtBQVlSO0FBQ0E7QUFDQTtBQUNBO0FBVkk7QUFZSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5SUE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSztBQUNHO0FBQ0E7QUFDQTtBQUNSO0FBQ1M7QUFDQTtBQUNJO0FBQ2I7QUFFYTtBQUFiO0FBR2E7QUFEYjtBQUlhO0FBRmI7QUFJUztBQUNBO0FBQ0k7QUFGYjtBQUthO0FBSGI7QUFNYTtBQUpiO0FBT2E7QUFMYjtBQUNBO0FBT1M7QUFDSTtBQUxiO0FBT1M7QUFMVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvLyDnu5kgQXJyYXkg5re75Yqg5pa55rOVXG4vLyBhcnIuZmluZCguLi4pXG4vLyBhcnIuZmluZEluZGV4KC4uLilcbi8vIGFyci5pbmNsdWRlcyhlKVxuLy8gYXJyLnVuaXF1ZShlcXVhbEZ1bmN0aW9uLCBpc05ld0FycmF5KVxuLy8gQXJyYXkuZnJvbVxuLy8gQXJyYXkuZXF1YWxcbi8vIGFyci5pc0VxdWFsKG90aGVyQXJyYXksIGlzU3RyaWN0KVxuLy8gQXJyYXkuc29ydEJ5TnVtYmVyXG4vLyBhcnIuZmluZFN1YkFycmF5SW5kZXhzKFtdKSAgIOeUqOS6juafpeaJvuaVsOe7hOWGheeahOmDqOWIhuWFg+e0oOeahOe0ouW8lVxuLy8gYXJyLnRyYW5zbGF0aW9uV2l0aFN0YXJ0SW5kZXgoc3RhcnRJbmRleCkg5bCG5pWw57uE5YaF55qE5YWD57Sg5bmz56e7XG4vLyDlpoLvvJpbMSwgMiwgMywgNCwgNV0udHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleCgzKSA9PiBbNCw1LDEsMiwzXVxuLy8gYXJyLmtxX2luc2VydChpbmRleCwgZSkgICDmj5LlhaXkuIDkuKrlhYPntKBcbi8vIGFyci5rcV9leGNsdWRlcyhhcnJheSkgICAvLyDpmaTkuoZhcnJheeaVsOe7hOS4reeahOWFg+e0oFxuXG5cbm1vZHVsZS5leHBvcnRzID0ge307XG5cbmlmICghQXJyYXkucHJvdG90eXBlLmZpbmQpIHtcbiAgQXJyYXkucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbihwcmVkaWNhdGUpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgaWYgKHRoaXMgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJyYXkucHJvdG90eXBlLmZpbmQgY2FsbGVkIG9uIG51bGwgb3IgdW5kZWZpbmVkJyk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgcHJlZGljYXRlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdwcmVkaWNhdGUgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgfVxuICAgIHZhciBsaXN0ID0gT2JqZWN0KHRoaXMpO1xuICAgIHZhciBsZW5ndGggPSBsaXN0Lmxlbmd0aCA+Pj4gMDtcbiAgICB2YXIgdGhpc0FyZyA9IGFyZ3VtZW50c1sxXTtcbiAgICB2YXIgdmFsdWU7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YWx1ZSA9IGxpc3RbaV07XG4gICAgICBpZiAocHJlZGljYXRlLmNhbGwodGhpc0FyZywgdmFsdWUsIGksIGxpc3QpKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUuZmluZEluZGV4KSB7XG4gIEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXggPSBmdW5jdGlvbihwcmVkaWNhdGUpIHtcbiAgICBpZiAodGhpcyA9PT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleCBjYWxsZWQgb24gbnVsbCBvciB1bmRlZmluZWQnKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBwcmVkaWNhdGUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ByZWRpY2F0ZSBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG4gICAgdmFyIGxpc3QgPSBPYmplY3QodGhpcyk7XG4gICAgdmFyIGxlbmd0aCA9IGxpc3QubGVuZ3RoID4+PiAwO1xuICAgIHZhciB0aGlzQXJnID0gYXJndW1lbnRzWzFdO1xuICAgIHZhciB2YWx1ZTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhbHVlID0gbGlzdFtpXTtcbiAgICAgIGlmIChwcmVkaWNhdGUuY2FsbCh0aGlzQXJnLCB2YWx1ZSwgaSwgbGlzdCkpIHtcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAtMTtcbiAgfTtcbn1cblxuXG4vLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1hcnJheS5wcm90b3R5cGUuaW5jbHVkZXNcbmlmICghQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpbmNsdWRlcycsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oc2VhcmNoRWxlbWVudCwgZnJvbUluZGV4KSB7XG5cbiAgICAgIC8vIDEuIExldCBPIGJlID8gVG9PYmplY3QodGhpcyB2YWx1ZSkuXG4gICAgICBpZiAodGhpcyA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1widGhpc1wiIGlzIG51bGwgb3Igbm90IGRlZmluZWQnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG8gPSBPYmplY3QodGhpcyk7XG5cbiAgICAgIC8vIDIuIExldCBsZW4gYmUgPyBUb0xlbmd0aCg/IEdldChPLCBcImxlbmd0aFwiKSkuXG4gICAgICB2YXIgbGVuID0gby5sZW5ndGggPj4+IDA7XG5cbiAgICAgIC8vIDMuIElmIGxlbiBpcyAwLCByZXR1cm4gZmFsc2UuXG4gICAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gNC4gTGV0IG4gYmUgPyBUb0ludGVnZXIoZnJvbUluZGV4KS5cbiAgICAgIC8vICAgIChJZiBmcm9tSW5kZXggaXMgdW5kZWZpbmVkLCB0aGlzIHN0ZXAgcHJvZHVjZXMgdGhlIHZhbHVlIDAuKVxuICAgICAgdmFyIG4gPSBmcm9tSW5kZXggfCAwO1xuXG4gICAgICAvLyA1LiBJZiBuIOKJpSAwLCB0aGVuXG4gICAgICAvLyAgYS4gTGV0IGsgYmUgbi5cbiAgICAgIC8vIDYuIEVsc2UgbiA8IDAsXG4gICAgICAvLyAgYS4gTGV0IGsgYmUgbGVuICsgbi5cbiAgICAgIC8vICBiLiBJZiBrIDwgMCwgbGV0IGsgYmUgMC5cbiAgICAgIHZhciBrID0gTWF0aC5tYXgobiA+PSAwID8gbiA6IGxlbiAtIE1hdGguYWJzKG4pLCAwKTtcblxuICAgICAgLy8gNy4gUmVwZWF0LCB3aGlsZSBrIDwgbGVuXG4gICAgICB3aGlsZSAoayA8IGxlbikge1xuICAgICAgICAvLyBhLiBMZXQgZWxlbWVudEsgYmUgdGhlIHJlc3VsdCBvZiA/IEdldChPLCAhIFRvU3RyaW5nKGspKS5cbiAgICAgICAgLy8gYi4gSWYgU2FtZVZhbHVlWmVybyhzZWFyY2hFbGVtZW50LCBlbGVtZW50SykgaXMgdHJ1ZSwgcmV0dXJuIHRydWUuXG4gICAgICAgIC8vIGMuIEluY3JlYXNlIGsgYnkgMS5cbiAgICAgICAgLy8gTk9URTogPT09IHByb3ZpZGVzIHRoZSBjb3JyZWN0IFwiU2FtZVZhbHVlWmVyb1wiIGNvbXBhcmlzb24gbmVlZGVkIGhlcmUuXG4gICAgICAgIGlmIChvW2tdID09PSBzZWFyY2hFbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaysrO1xuICAgICAgfVxuXG4gICAgICAvLyA4LiBSZXR1cm4gZmFsc2VcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0pO1xufVxuXG4vLyB1bmlxdWVcbmlmICghQXJyYXkucHJvdG90eXBlLnVuaXF1ZSkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAndW5pcXVlJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihlcXVhbEZ1bmN0aW9uLCBuZXdBcnJheSA9IHRydWUpIHtcbiAgICAgIGlmIChuZXdBcnJheSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdW5xaXVlX25ldyhlcXVhbEZ1bmN0aW9uKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3VucWl1ZShlcXVhbEZ1bmN0aW9uKTtcbiAgICB9LFxuICB9KTtcblxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnX3VucWl1ZV9uZXcnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKGVxdWFsRnVuY3Rpb24pIHtcbiAgICAgIGxldCBhcnJheSA9IEFycmF5LmZyb20odGhpcyk7XG5cbiAgICAgIHJldHVybiBhcnJheS5fdW5xaXVlKGVxdWFsRnVuY3Rpb24pO1xuICAgIH1cbiAgfSk7XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ191bnFpdWUnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKGVxdWFsRnVuY3Rpb24pIHtcbiAgICAgIHZhciBsZW4gPSB0aGlzLmxlbmd0aDtcbiAgICAgIHZhciBpID0gLTE7XG5cbiAgICAgIHdoaWxlIChpKysgPCBsZW4pIHtcbiAgICAgICAgdmFyIGogPSBpICsgMTtcblxuICAgICAgICBmb3IgKDsgaiA8IHRoaXMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICB2YXIgaXNFcXVhbCA9IGZhbHNlO1xuICAgICAgICAgIGlmIChlcXVhbEZ1bmN0aW9uKSB7XG4gICAgICAgICAgICBpc0VxdWFsID0gZXF1YWxGdW5jdGlvbih0aGlzW2ldLCB0aGlzW2pdKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaXNFcXVhbCA9IHRoaXNbaV0gPT09IHRoaXNbal07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGlzRXF1YWwpIHtcbiAgICAgICAgICAgIHRoaXMuc3BsaWNlKGotLSwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICB9KTtcbn1cblxuXG4vLyBQcm9kdWN0aW9uIHN0ZXBzIG9mIEVDTUEtMjYyLCBFZGl0aW9uIDYsIDIyLjEuMi4xXG4vLyBSZWZlcmVuY2U6IGh0dHBzOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy1hcnJheS5mcm9tXG5pZiAoIUFycmF5LmZyb20pIHtcbiAgQXJyYXkuZnJvbSA9IChmdW5jdGlvbigpIHtcbiAgICB2YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuICAgIHZhciBpc0NhbGxhYmxlID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgIHJldHVybiB0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicgfHwgdG9TdHIuY2FsbChmbikgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG4gICAgfTtcbiAgICB2YXIgdG9JbnRlZ2VyID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBudW1iZXIgPSBOdW1iZXIodmFsdWUpO1xuICAgICAgaWYgKGlzTmFOKG51bWJlcikpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgICBpZiAobnVtYmVyID09PSAwIHx8ICFpc0Zpbml0ZShudW1iZXIpKSB7XG4gICAgICAgIHJldHVybiBudW1iZXI7XG4gICAgICB9XG4gICAgICByZXR1cm4gKG51bWJlciA+IDAgPyAxIDogLTEpICogTWF0aC5mbG9vcihNYXRoLmFicyhudW1iZXIpKTtcbiAgICB9O1xuICAgIHZhciBtYXhTYWZlSW50ZWdlciA9IE1hdGgucG93KDIsIDUzKSAtIDE7XG4gICAgdmFyIHRvTGVuZ3RoID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBsZW4gPSB0b0ludGVnZXIodmFsdWUpO1xuICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KGxlbiwgMCksIG1heFNhZmVJbnRlZ2VyKTtcbiAgICB9O1xuXG4gICAgLy8gVGhlIGxlbmd0aCBwcm9wZXJ0eSBvZiB0aGUgZnJvbSBtZXRob2QgaXMgMS5cbiAgICByZXR1cm4gZnVuY3Rpb24gZnJvbShhcnJheUxpa2UgLyosIG1hcEZuLCB0aGlzQXJnICovICkge1xuICAgICAgLy8gMS4gTGV0IEMgYmUgdGhlIHRoaXMgdmFsdWUuXG4gICAgICB2YXIgQyA9IHRoaXM7XG5cbiAgICAgIC8vIDIuIExldCBpdGVtcyBiZSBUb09iamVjdChhcnJheUxpa2UpLlxuICAgICAgdmFyIGl0ZW1zID0gT2JqZWN0KGFycmF5TGlrZSk7XG5cbiAgICAgIC8vIDMuIFJldHVybklmQWJydXB0KGl0ZW1zKS5cbiAgICAgIGlmIChhcnJheUxpa2UgPT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQXJyYXkuZnJvbSByZXF1aXJlcyBhbiBhcnJheS1saWtlIG9iamVjdCAtIG5vdCBudWxsIG9yIHVuZGVmaW5lZFwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gNC4gSWYgbWFwZm4gaXMgdW5kZWZpbmVkLCB0aGVuIGxldCBtYXBwaW5nIGJlIGZhbHNlLlxuICAgICAgdmFyIG1hcEZuID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB2b2lkIHVuZGVmaW5lZDtcbiAgICAgIHZhciBUO1xuICAgICAgaWYgKHR5cGVvZiBtYXBGbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgLy8gNS4gZWxzZVxuICAgICAgICAvLyA1LiBhIElmIElzQ2FsbGFibGUobWFwZm4pIGlzIGZhbHNlLCB0aHJvdyBhIFR5cGVFcnJvciBleGNlcHRpb24uXG4gICAgICAgIGlmICghaXNDYWxsYWJsZShtYXBGbikpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcnJheS5mcm9tOiB3aGVuIHByb3ZpZGVkLCB0aGUgc2Vjb25kIGFyZ3VtZW50IG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gNS4gYi4gSWYgdGhpc0FyZyB3YXMgc3VwcGxpZWQsIGxldCBUIGJlIHRoaXNBcmc7IGVsc2UgbGV0IFQgYmUgdW5kZWZpbmVkLlxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICBUID0gYXJndW1lbnRzWzJdO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIDEwLiBMZXQgbGVuVmFsdWUgYmUgR2V0KGl0ZW1zLCBcImxlbmd0aFwiKS5cbiAgICAgIC8vIDExLiBMZXQgbGVuIGJlIFRvTGVuZ3RoKGxlblZhbHVlKS5cbiAgICAgIHZhciBsZW4gPSB0b0xlbmd0aChpdGVtcy5sZW5ndGgpO1xuXG4gICAgICAvLyAxMy4gSWYgSXNDb25zdHJ1Y3RvcihDKSBpcyB0cnVlLCB0aGVuXG4gICAgICAvLyAxMy4gYS4gTGV0IEEgYmUgdGhlIHJlc3VsdCBvZiBjYWxsaW5nIHRoZSBbW0NvbnN0cnVjdF1dIGludGVybmFsIG1ldGhvZCBvZiBDIHdpdGggYW4gYXJndW1lbnQgbGlzdCBjb250YWluaW5nIHRoZSBzaW5nbGUgaXRlbSBsZW4uXG4gICAgICAvLyAxNC4gYS4gRWxzZSwgTGV0IEEgYmUgQXJyYXlDcmVhdGUobGVuKS5cbiAgICAgIHZhciBBID0gaXNDYWxsYWJsZShDKSA/IE9iamVjdChuZXcgQyhsZW4pKSA6IG5ldyBBcnJheShsZW4pO1xuXG4gICAgICAvLyAxNi4gTGV0IGsgYmUgMC5cbiAgICAgIHZhciBrID0gMDtcbiAgICAgIC8vIDE3LiBSZXBlYXQsIHdoaWxlIGsgPCBsZW7igKYgKGFsc28gc3RlcHMgYSAtIGgpXG4gICAgICB2YXIga1ZhbHVlO1xuICAgICAgd2hpbGUgKGsgPCBsZW4pIHtcbiAgICAgICAga1ZhbHVlID0gaXRlbXNba107XG4gICAgICAgIGlmIChtYXBGbikge1xuICAgICAgICAgIEFba10gPSB0eXBlb2YgVCA9PT0gJ3VuZGVmaW5lZCcgPyBtYXBGbihrVmFsdWUsIGspIDogbWFwRm4uY2FsbChULCBrVmFsdWUsIGspO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIEFba10gPSBrVmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgayArPSAxO1xuICAgICAgfVxuICAgICAgLy8gMTguIExldCBwdXRTdGF0dXMgYmUgUHV0KEEsIFwibGVuZ3RoXCIsIGxlbiwgdHJ1ZSkuXG4gICAgICBBLmxlbmd0aCA9IGxlbjtcbiAgICAgIC8vIDIwLiBSZXR1cm4gQS5cbiAgICAgIHJldHVybiBBO1xuICAgIH07XG4gIH0oKSk7XG59XG5cbmlmICghQXJyYXkuZXF1YWwpIHtcbiAgQXJyYXkuZXF1YWwgPSBmdW5jdGlvbihhcnIxLCBhcnIyLCBzdHJpY3QgPSB0cnVlKSB7XG4gICAgaWYgKGFycjEgPT09IHVuZGVmaW5lZCB8fCBhcnIyID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgbGVuZ3RoID0gYXJyMS5sZW5ndGhcbiAgICBpZiAobGVuZ3RoICE9PSBhcnIyLmxlbmd0aCkgcmV0dXJuIGZhbHNlXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHN0cmljdCkge1xuICAgICAgICBpZiAoYXJyMVtpXSAhPT0gYXJyMltpXSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgdmFsdWUxID0gYXJyMVtpXTtcbiAgICAgICAgdmFyIHZhbHVlMiA9IGFycjJbaV07XG4gICAgICAgIHZhciByZXN1bHQgPSB0cnVlO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZTEpICYmIEFycmF5LmlzQXJyYXkodmFsdWUyKSkge1xuICAgICAgICAgIHJlc3VsdCA9IEFycmF5LmVxdWFsKHZhbHVlMSwgdmFsdWUyLCBzdHJpY3QpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdCA9ICh2YWx1ZTEgPT0gdmFsdWUyKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWVcbiAgfTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUuaXNFcXVhbCkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnaXNFcXVhbCcsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24ob3RoZXJBcnJheSwgc3RyaWN0ID0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIEFycmF5LmVxdWFsKHRoaXMsIG90aGVyQXJyYXksIHN0cmljdCk7XG4gICAgfSxcbiAgfSk7XG59XG5cbmlmICghQXJyYXkuc29ydEJ5TnVtYmVyKSB7XG4gIEFycmF5LnNvcnRCeU51bWJlciA9IGZ1bmN0aW9uIChuMSwgbjIsIGFzYyA9IHRydWUpIHtcbiAgICByZXR1cm4gKG4xIC0gbjIpICogKGFzYyA/IDEgOiAtMSk7XG4gIH07XG59XG5cbmlmICghQXJyYXkucHJvdG90eXBlLmZpbmRTdWJBcnJheUluZGV4cykge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnZmluZFN1YkFycmF5SW5kZXhzJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoc3ViQXJyYXksIGYpIHtcbiAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgaW4gc3ViQXJyYXkpIHtcbiAgICAgICAgbGV0IHN1YlZhbHVlID0gc3ViQXJyYXlbaV07XG4gICAgICAgIGxldCBmaW5kRnVuYyA9IGYgfHwgZnVuY3Rpb24gKHRoaXNWYWx1ZSkge1xuICAgICAgICAgIHJldHVybiBzdWJWYWx1ZSA9PT0gdGhpc1ZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBpbmRleCA9IHRoaXMuZmluZEluZGV4KGZpbmRGdW5jKTtcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICBpbmRleHMucHVzaChpbmRleCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaW5kZXhzID0gW107XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGluZGV4cy5sZW5ndGggPiAwID8gaW5kZXhzIDogbnVsbDtcbiAgICB9LFxuICB9KTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUudHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleCkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAndHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleCcsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24gKHN0YXJ0SW5kZXgpIHtcbiAgICAgIGlmIChzdGFydEluZGV4ID09IDApIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGlmIChzdGFydEluZGV4ID49IHRoaXMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICBsZXQgcHJlID0gdGhpcy5zbGljZShzdGFydEluZGV4KTtcbiAgICAgIGxldCBsYXN0ID0gdGhpcy5zbGljZSgwLCBzdGFydEluZGV4KTtcbiAgICAgIGxldCByZXN1bHQgPSBwcmUuY29uY2F0KGxhc3QpO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG4gIH0pO1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS5rcV9pbnNlcnQpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2txX2luc2VydCcsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oaW5kZXgsIGUpIHtcbiAgICAgIGlmIChlID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGlmIChpbmRleCA+PSB0aGlzLmxlbmd0aCkge1xuICAgICAgICB0aGlzLnB1c2goZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5zcGxpY2UoaW5kZXgsIDAsIGUpO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICB9KTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUua3FfZXhjbHVkZXMpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2txX2V4Y2x1ZGVzJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihvdGhlckFycmF5KSB7XG4gICAgICBpZiAob3RoZXJBcnJheSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICBsZXQgcmVzdWx0ID0gW107XG4gICAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICBpZiAoIW90aGVyQXJyYXkuaW5jbHVkZXMoZWxlbWVudCkpIHtcbiAgICAgICAgICByZXN1bHQucHVzaChlbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcbiAgfSk7XG59XG5cbi8qXG5pZighQXJyYXkucHJvdG90eXBlLm1pbil7XG4gIEFycmF5LnByb3RvdHlwZS5taW4gPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbWluID0gdGhpc1swXTtcbiAgICB2YXIgbGVuID0gdGhpcy5sZW5ndGg7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgaWYgKHRoaXNbaV0gPCBtaW4pIHtcbiAgICAgICAgbWluID0gdGhpc1tpXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1pbjtcbiAgfVxufSovXG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcblxubGV0IEF1ZGlvTWFuYWdlciA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGhhbGxfYmdtOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcblxuICAgICAgICAvLyDmiZPmnqpcbiAgICAgICAgZGFRaWFuZzoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICAgICAgZmFwYWk6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuXG4gICAgICAgIHdpbmRvdzoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICAgICAgY2xpY2tfd2VpeGluX2xvZ2luOntcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuXG4gICAgICAgIGZhbmdQYWk6e1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICB9LFxuXG4gICAgc3RhdGljczoge1xuICAgICAgICBpbnN0YW5jZTogbnVsbCxcbiAgICB9LFxuXG4gICAgb25Mb2FkOmZ1bmN0aW9uKCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UgPSB0aGlzO1xuICAgICAgICB0aGlzLl9yZWdpc3RlckFwcEFjdGl2ZUNoYW5nZSgpO1xuXG4gICAgICAgIHRoaXMuc291bmRPbiA9IHRydWU7XG4gICAgICAgIGNjLmdhbWUuYWRkUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSk7XG4gICAgICAgIGlmIChjYy5nYW1lLmlzUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSkpIHtcbiAgICAgICAgICAgIC8vIGNjLmxvZygn5re75Yqg5YWo5bGA6IqC54K55oiQ5YqfJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tVmFsdWUgPSBtYW5hZ2VyLmdldE11c2ljVmFsdWUoKTtcbiAgICAgICAgdGhpcy5tRVZhbHVlID0gbWFuYWdlci5nZXRNdXNpY0VmZmVjdFZhbHVlKCk7XG4gICAgICAgIHRoaXMuYmdBdWRpb0lkID0gLTE7XG4gICAgfSxcblxuICAgIHN0b3BIYWxsTXVzaWM6IGZ1bmN0aW9uKCl7XG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnN0b3AodGhpcy5iZ0F1ZGlvSWQpO1xuICAgIH0sXG5cbiAgICBwbGF5TXVzaWM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmJnQXVkaW9JZCA9IGNjLmF1ZGlvRW5naW5lLnBsYXlNdXNpYyggdGhpcy5oYWxsX2JnbSwgdHJ1ZSk7XG4gICAgICAgIGlmICh0aGlzLmJnQXVkaW9JZCAhPSAtMSkge1xuICAgICAgICAgICAgLy9jYy5sb2coJ3BsYXknKTtcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnNldFZvbHVtZSh0aGlzLmJnQXVkaW9JZCx0aGlzLm1WYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9jYy5hdWRpb0VuZ2luZS5wbGF5TXVzaWMoIHVybCwgdHJ1ZSApXG4gICAgfSxcblxuXG4gICAgcGxheUNvbXBhcmVDYXJkc011c2ljOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYmdBdWRpb0lkID0gY2MuYXVkaW9FbmdpbmUucGxheU11c2ljKCB0aGlzLmhhbGxfYmdtLCB0cnVlKTtcbiAgICAgICAgaWYgKHRoaXMuYmdBdWRpb0lkICE9IC0xKSB7XG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUodGhpcy5iZ0F1ZGlvSWQsdGhpcy5tVmFsdWUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHBsYXlEYVFpYW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgc3RhcnQgPD0gMS42OyBzdGFydCA9IHN0YXJ0ICsgMC41KSB7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmRhUWlhbmcpO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCBzdGFydCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8g4oCc5omT5p6q4oCdXG4gICAgcGxheUh1bWFuRGFRaWFuZzogZnVuY3Rpb24gKHNleCA9IDEpIHtcbiAgICAgICAgdmFyIHBhdGggPSBcInJlc291cmNlcy9zb3VuZHMvbWFuXCIvKiArIChzZXggPT0gMSA/IFwibWFuXCIgOiBcIndvbWFuXCIpKi87XG4gICAgICAgIHBhdGggPSBwYXRoICsgXCIvZGFxaWFuZzEubXAzXCI7XG5cbiAgICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcocGF0aCk7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgLy8g4oCc5Lit5p6q4oCdXG4gICAgcGxheUh1bWFuWlFpYW5nOiBmdW5jdGlvbiAoc2V4ID0gMSkge1xuICAgICAgICB2YXIgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9tYW5cIi8qICsgKHNleCA9PSAxID8gXCJtYW5cIiA6IFwid29tYW5cIikqLztcbiAgICAgICAgcGF0aCA9IHBhdGggKyBcIi9kYXFpYW5nMy5tcDNcIjtcblxuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICBwbGF5UG9rZXJDbGljazogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdygncmVzb3VyY2VzL3NvdW5kcy9wdWJsaWMvY2xpY2tfd3hfbG9naW4ubXAzJyk7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5YWo5Z6S5omT6Z+z5pWIXG4gICAgcGxheUhvbWVSdW46IGZ1bmN0aW9uIChzZXggPSAxKSB7XG4gICAgICAgIGxldCBwYXRoID0gdGhpcy5fc291bmRzSHVtYW5QYXRoKHNleCkgKyBcInNwZWNpYWwxLm1wM1wiO1xuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICAvLyDmkq3mlL7lj5HniYzpn7PmlYhcbiAgICBwbGF5RmFQYWk6IGZ1bmN0aW9uKCkge1xuICAgICAgICBsZXQgcGF0aDEgPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoMSkgKyBcInJvb21fc3RhcnRfY29tcGFyZS5tcDNcIjtcbiAgICAgICAgbGV0IHVybDEgPSBjYy51cmwucmF3KHBhdGgxKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwxKTtcbiAgICAgICAgLy9sZXQgcG9rZXJEZWFsID0gdGhpcy5fc291bmRzSHVtYW5QYXRoKDEpICsgXCJwb2tlcl9kZWFsLm1wM1wiO1xuICAgICAgICAvL2xldCB1cmxQb2tlckRlYWwgPSBjYy51cmwucmF3KHBva2VyRGVhbCk7XG4gICAgICAgIC8vdGhpcy5fcGxheVNGWCh1cmxQb2tlckRlYWwpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuZmFwYWkpO1xuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgNjsgaW5kZXgrKykge1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmZhcGFpKTtcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgaW5kZXggKiAwLjEpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHBsYXlDYXJkVHlwZTogZnVuY3Rpb24gKHNleCA9IDEsIHR5cGUgPSAtMSkge1xuICAgICAgICAvLyDlj6rmkq3mlL7mma7pgJrnsbvlnovnmoTor63pn7NcbiAgICAgICAgaWYgKCh0eXBlID49IDEwKSB8fCAodHlwZSA8IDApKSB7XG4gICAgICAgICAgICAvLyAxMCDlj4rku6XkuIrmmK/nibnmrorniYxcbiAgICAgICAgICAgIGxldCBwYXRoID0gdGhpcy5fc291bmRzSHVtYW5QYXRoKHNleCkgKyAodHlwZSkgKyBcIi5tcDNcIjtcbiAgICAgICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHBhdGggPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoc2V4KSArIFwiY29tbW9uXCIgKyAodHlwZSArIDEpICsgXCIubXAzXCI7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIC8vIOaSreaUviDlvIDlp4vmr5TniYxcbiAgICBwbGF5U3RhcnRDb21wYXJlOiBmdW5jdGlvbiAoc2V4ID0gMSkge1xuICAgICAgICBsZXQgcGF0aCA9IHRoaXMuX3NvdW5kc0h1bWFuUGF0aChzZXgpICsgXCJzdGFydF9jb21wYXJlLm1wM1wiO1xuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICBwbGF5V2luOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KCdyZXNvdXJjZXMvc291bmRzL29wZW5mYWNlL3dpbi5tcDMnKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICBwbGF5TG9zZTogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdygncmVzb3VyY2VzL3NvdW5kcy9vcGVuZmFjZS9sb3NlLm1wMycpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIGNvaW5JbmNvbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcoJ3Jlc291cmNlcy9zb3VuZHMvb3BlbmZhY2UvY29pbl9pbmNvbWUubXAzJyk7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgX3NvdW5kc0h1bWFuUGF0aDogZnVuY3Rpb24gKHNleCkge1xuICAgICAgICBsZXQgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9tYW4vXCIvKiArIChzZXggPT0gMSA/IFwibWFuXCIgOiBcIndvbWFuXCIpICsgXCIvXCIqLztcbiAgICAgICAgcmV0dXJuIHBhdGg7XG4gICAgfSxcblxuICAgIHNldEJnTXVzaWNWb2x1bW46IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubVZhbHVlID0gdmFsdWU7XG4gICAgICAgIGlmICh0aGlzLmJnQXVkaW9JZCAhPSAtMSkge1xuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc2V0Vm9sdW1lKHRoaXMuYmdBdWRpb0lkLHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzZXRFZmZlY3RNdXNpY1ZvbHVtOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB0aGlzLm1FVmFsdWUgPSB2YWx1ZTtcbiAgICB9LFxuXG4gICAgLyrogYrlpKkqL1xuICAgIHBsYXlDaGF0QXVkaW86ZnVuY3Rpb24oc2V4LCBzdHIpIHtcbiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5jaGF0VGV4dHMoKS5pbmRleE9mKHN0cik7XG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbnVtYmVyID0gXCJDSEFUXCIrKGluZGV4KzEpO1xuICAgICAgICBsZXQgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9jaGF0L1wiICsgbnVtYmVyICsgXCIubXAzXCI7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIGNoYXRUZXh0czogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgJ+i/mOS4jeWHuueJjO+8jOaIkemDveW/q+WOu+WQg+mUhei+ueeziuS6hicsXG4gICAgICAgICAgICAn5Zeo5ZGA77yM5oiR5a626YeM6ICB5Lq66YO95q+U5L2g5omT55qE5b+rJyxcbiAgICAgICAgICAgICfll6jlkYDvvIzmiZPniYzmiZPnmoTmiJHpg73lm7DkuoYnLFxuICAgICAgICAgICAgJ+WTju+8jOS9oOW/q+aFouaFouaJvu+8jOaIkeWFiOWOu+ilv+a5lumAm+S4gOS4iycsXG4gICAgICAgICAgICAn5b+r5LiA54K55ZGA77yM5oiR562J5L2g5oOz5aW95oiR5Y6V5omA6YO95LiK5LiA6Laf5LqGJyxcbiAgICAgICAgICAgICfkvaDov5nlnKjlubLlmJvvvIzov5nkuYjmhaInLFxuICAgICAgICAgICAgJ+WXqOWRgO+8jOacgOi/keWcqOW/meS7gOS5iO+8jOW+iOS5heayoeingeS6hicsXG4gICAgICAgICAgICAn5p2l5p2l5p2l77yM5LiJ57y65LiAJyxcbiAgICAgICAgICAgICfmnaXmnaXmnaXvvIzotbbntKflnZDkuIvmnaXmiZPkuIDlnIgnLFxuICAgICAgICAgICAgJ+i3n+S9oOS7rOi/meS6m+mrmOaJi+aJk+aIkeS8mue0p+W8oO+8jOiuqeaIkeS4gOeCuScsXG4gICAgICAgICAgICAn6Juu5pma5Yiw5aSp5Lqu77yM6L6T5LqG5Y+v5Lul6K6p5L2g5Lus5YWI5qyg552AJ1xuICAgICAgICBdO1xuICAgIH0sXG5cbiAgICBwYXVzZU11c2ljOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zb3VuZE9uID0gZmFsc2U7XG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnBhdXNlTXVzaWMoKTtcbiAgICB9LFxuXG4gICAgcmVzdW1lTXVzaWM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNvdW5kT24gPSB0cnVlO1xuICAgICAgICBjYy5hdWRpb0VuZ2luZS5yZXN1bWVNdXNpYygpO1xuICAgIH0sXG5cbiAgICBfcGxheVNGWDogZnVuY3Rpb24oY2xpcCkge1xuICAgICAgICBpZiAodGhpcy5zb3VuZE9uKSB7XG4gICAgICAgICAgICB2YXIgYXVkaW9JZCA9IGNjLmF1ZGlvRW5naW5lLnBsYXlFZmZlY3QoIGNsaXAsIGZhbHNlICk7XG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUoYXVkaW9JZCx0aGlzLm1FVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIGF1ZGlvSWQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgLy8gTUFSSzog5YmN5ZCO5Y+w5pON5L2cXG4gICAgX3JlZ2lzdGVyQXBwQWN0aXZlQ2hhbmdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNjLmdhbWUub24oY2MuZ2FtZS5FVkVOVF9ISURFLCB0aGlzLl9hcHBFbnRlckJhY2tncm91bmQsIHRoaXMpO1xuICAgICAgICBjYy5nYW1lLm9uKGNjLmdhbWUuRVZFTlRfU0hPVywgdGhpcy5fYXBwQmVjb21BY3RpdmUsIHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDov5vlhaXlkI7lj7BcbiAgICAgKi9cbiAgICBfYXBwRW50ZXJCYWNrZ3JvdW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCBub3cgPSBjYy5zeXMubm93KCk7XG4gICAgICAgIGlmIChub3cgLSB0aGlzLl9sYXN0QXBwRW50ZXJCYWNrZ3JvdW5kVGltZSA8IDEwMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xhc3RBcHBFbnRlckJhY2tncm91bmRUaW1lID0gbm93O1xuXG4gICAgICAgIHRoaXMucGF1c2VNdXNpYygpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDov5vlhaXliY3lj7BcbiAgICAgKi9cbiAgICBfYXBwQmVjb21BY3RpdmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcbiAgICAgICAgaWYgKG5vdyAtIHRoaXMuX2xhc3RBcHBCZWNvbUFjdGl2ZVRpbWUgPCAxMDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sYXN0QXBwQmVjb21BY3RpdmVUaW1lID0gbm93O1xuXG4gICAgICAgIHRoaXMucmVzdW1lTXVzaWMoKTtcbiAgICB9LFxuXG4gICAgLyrnoa7lrprmjInpkq7pn7PmlYgqL1xuICAgIHBsYXlCdG5DbGlja1NGWDpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX3dlaXhpbl9sb2dpbik7XG4gICAgfSxcbiAgICAvKuWFrOWFseaMiemSru+8jOaMiemUruaIluiAheWFs+mXreaMiemSruS5i+exu+eahOmfs+aViCovXG4gICAgcGFseUJ0blB1YmxpY1NGWDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5jbGlja193ZWl4aW5fbG9naW4pO1xuICAgIH0sXG5cbiAgICAvKuWPlua2iOaMiemSrumfs+aViCovXG4gICAgcGFseUJ0bkNhbmNlbENsaWNrU0ZYOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX3dlaXhpbl9sb2dpbik7XG4gICAgfSxcbiAgICBwYWx5QnRuQ3JlYXRlUm9vbVNGWDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5jbGlja193ZWl4aW5fbG9naW4pO1xuICAgIH0sXG4gICAgcGFseVdpbmRvd1NGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMud2luZG93KTtcbiAgICB9LFxuICAgIHBhbHlXZWlYaW5Mb2dpblNGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuY2xpY2tfd2VpeGluX2xvZ2luKTtcbiAgICB9LFxuICAgIHBhbHlGYW5nUGFpU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5mYW5nUGFpKTtcbiAgICB9LFxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBBdWRpb01hbmFnZXI7XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgZ3JheVNwcml0ZTogY2MuU3ByaXRlLFxuXG4gICAgICAgIF9jYXJkTmFtZTogbnVsbCxcbiAgICAgICAgX2txQ2FyZE1vZGU6IG51bGxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmdyYXlTcHJpdGUubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLy8g6YCa6L+H54mM5ZCN6K6+572u54mMXG4gICAgc2V0Q2FyZDogZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICB0aGlzLl9zZXRDYXJkTmFtZShjYXJkTmFtZSk7XG5cbiAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUoY2FyZE5hbWUsIGZ1bmN0aW9uIChzcHJpdGVGcmFtZSkge1xuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2FyZE5hbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jYXJkTmFtZTtcbiAgICB9LFxuXG4gICAgY2FyZE1vZGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9rcUNhcmRNb2RlO1xuICAgIH0sXG5cbiAgICBfc2V0Q2FyZE5hbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSkge1xuICAgICAgdGhpcy5fY2FyZE5hbWUgPSBjYXJkTmFtZTtcbiAgICAgIHRoaXMuX2txQ2FyZE1vZGUgPSBuZXcgS1FDYXJkKGNhcmROYW1lKTtcbiAgICB9LFxuXG4gICAgLy8g6K6+572u6YCJ5oup54q25oCBXG4gICAgc2V0U2VsZWN0ZWQ6IGZ1bmN0aW9uIChzZWxlY3RlZCA9IGZhbHNlKSB7XG4gICAgICB0aGlzLmdyYXlTcHJpdGUubm9kZS5hY3RpdmUgPSBzZWxlY3RlZDtcbiAgICB9LFxuXG4gICAgaXNTZWxlY3RlZDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ3JheVNwcml0ZS5ub2RlLmFjdGl2ZTtcbiAgICB9LFxuXG4gICAgX2NhcmRGdWxsTmFtZTogZnVuY3Rpb24gKGNhcmRTaG9ydE5hbWUpIHtcbiAgICAgIHZhciBjYXJkTmFtZSA9IGNhcmRTaG9ydE5hbWU7XG4gICAgICBpZiAoIWNhcmROYW1lLnN0YXJ0c1dpdGgoXCJwdWJsaWMtcGljLWNhcmQtcG9rZXJcIikpIHtcbiAgICAgICAgY2FyZE5hbWUgPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY2FyZE5hbWU7XG4gICAgfSxcblxuICAgIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICBjYy5hc3NlcnQoY2FsbGJhY2spO1xuXG4gICAgICBjYy5sb2FkZXIubG9hZFJlcyhcInBsYXkvQ2FyZFR5cGVDb21iaW5lL3BvY2tMaXN0XCIsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY2MuZXJyb3IoZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjYXJkTmFtZSA9IHRoaXMuX2NhcmRGdWxsTmFtZShjYXJkTmFtZSk7XG4gICAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcbiAgICAgICAgY2FsbGJhY2soZnJhbWUpO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY29uc3QgcGxheSA9IHJlcXVpcmUoJ3BsYXknKTtcbmNvbnN0IEtRQ2FyZFNjb3JldHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRTY29yZXRzSGVscGVyJyk7XG4vLyDniYznsbvlnosgY29tcG9uZW50XG4vL1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcbiAgICBzdGF0aWNzOiB7XG4gICAgICAgIGluc3RhbmNlczogbnVsbCxcbiAgICB9LFxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgY2FyZHNMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgLy8gYnRuRHVpWmk6IGNjLkJ1dHRvbixcbiAgICAgICAgLy8gYnRuTGlhbmdEdWk6IGNjLkJ1dHRvbixcbiAgICAgICAgLy8gYnRuU2FuVGlhbzogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5TaHVuWmk6IGNjLkJ1dHRvbixcbiAgICAgICAgLy8gYnRuVG9uZ0h1YTogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5IdUx1OiBjYy5CdXR0b24sXG4gICAgICAgIC8vIGJ0blRpZVpoaTogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5Ub25nSHVhU2h1bjogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5XdVRvbmc6IGNjLkJ1dHRvbixcbiAgICAgICAgLy8gdHlwZUJ1dHRvbnNOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBidG5EZWxldGVUb3VEYW86IGNjLkJ1dHRvbiwgICAvLyDlpLTpgZNcbiAgICAgICAgYnRuRGVsZXRlWmhvbmdEYW86IGNjLkJ1dHRvbiwgLy8g5Lit6YGTXG4gICAgICAgIGJ0bkRlbGV0ZVdlaURhbzogY2MuQnV0dG9uLCAgIC8vIOWwvumBk1xuICAgICAgICBidG5DYW5jZWxBbGw6IGNjLkJ1dHRvbiwgICAgICAvLyDlhajpg6jlj5bmtohcbiAgICAgICAgYnRuRG9uZTogY2MuQnV0dG9uLCAgICAgICAgICAgLy8g56Gu5a6a5Ye654mMXG4gICAgICAgIHRpbWVOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBsYWJlbFRpbWU6IGNjLkxhYmVsLFxuICAgICAgICBsYXlvdXRUb3VEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0WmhvbmdEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0V2VpRGFvOiBjYy5MYXlvdXQsXG4gICAgICAgIGNhcmRBbGxOb2RlOmNjLk5vZGUsXG4gICAgICAgIGNhcmRQcmVmYWI6IGNjLlByZWZhYixcbiAgICAgICAgY2FyZFR5cGVQcmVmYWI6IGNjLlByZWZhYixcblxuICAgICAgICB0b3VEYW9Ob2RlOmNjLk5vZGUsXG4gICAgICAgIHpob25nRGFvTm9kZTpjYy5Ob2RlLFxuICAgICAgICB3ZWlEYW9Ob2RlOmNjLk5vZGUsXG5cbiAgICAgICAgYXV0b0NhcmRTY3JvbGxWaWV3OiBjYy5TY3JvbGxWaWV3LFxuICAgICAgICBhdXRvQ2FyZDogY2MuUHJlZmFiLFxuICAgICAgICBhdXRvQ2FyZExheW91dDogY2MuTGF5b3V0LFxuICAgICAgICBhdXRvQ2FyZEFuaW1hdGlvbjpjYy5Ob2RlLFxuXG5cbiAgICAgICAgTGF5b3V0V2l0aEV2ZW50OiBbXSxcblxuICAgICAgICBCdG5DbGlja0dvbmdYaU5pQ29tZmlybTpmYWxzZSwgIC8v55So5LqO5qOA5p+l55So5oi35piv5ZCm54K55Ye75LqG5oGt5Zac5L2g6aG16Z2i55qE56Gu5a6a5oyJ6ZKuXG4gICAgICAgIGNhcmRzTGF5b3V0U29ydENvbG9yOiBmYWxzZSxcbiAgICAgICAgLyojIyMjIyovXG5cbiAgICAgICAgX2NhcmRPZmZzZXRZOiBudWxsLFxuXG4gICAgICAgIF9rcUNhcmRNb2RlczogW10sXG4gICAgICAgIF9hbGxDYXJkTW9kZXM6IFtdLFxuICAgICAgICBfZmluZENhcmRUeXBlT2JqZWN0OiBudWxsLCAgLy8g55So5p2l6K6w5b2V5om+5Yiw55qE54mM5Z6L5a+56LGhXG4gICAgICAgIF9maW5kQ2FyZEluZGV4OiBudWxsLCAgLy8g55So5p2l6K6w5b2V5om+5Yiw55qE54mM5Z6L5a+56LGhXG5cbiAgICAgICAgX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2s6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY2FyZE9mZnNldFkgPSAwO1xuICAgICAgICB0aGlzLl9yZWdpc3RlclRvdWNoRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyRGFvc0xheW91dENsaWNrRXZlbnQoKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICB0aGlzLl9maW5kQ2FyZEluZGV4ID0ge307XG4gICAgICAgIHRoaXMuY2FyZFRpbWUgPSAwLjM7XG5cbiAgICAgICAgdGhpcy5jYXJkU3ByaXRlQXRsYXMgPSB0aGlzLm5vZGUucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcbiAgICAgICAgdGhpcy5kYW9TcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQuZ2V0Q29tcG9uZW50KCdwbGF5JykuZGFvU3ByaXRlQXRsYXM7XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vnqbrnmb3lnLDmlrnlsIbniYzmlLblm57ljrsqL1xuICAgIG9uQ2xpY2tDYXJkVHlwZUNvbWJpbmVOb2RlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcbiAgICB9LFxuXG4gICAgX2hpZGVEZWxldGVCdXR0b25zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhpcy5idG5EZWxldGVUb3VEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgLy90aGlzLmJ0bkRlbGV0ZVpob25nRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIC8vdGhpcy5idG5EZWxldGVXZWlEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLy8g6YeN572u77yM5Zue5Yiw5pyA5Yid5aeL5pyJ54q25oCBXG4gICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5faGlkZURlbGV0ZUJ1dHRvbnMoKTtcbiAgICAgICAgdGhpcy5jbGVhckNhcmRzKCk7XG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcbiAgICAgICAgLy90aGlzLl90eXBlQnV0dG9ucygpLmZvckVhY2goZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgICAvLyAgICBidXR0b24uaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgIC8vfSk7XG4gICAgICAgIHRoaXMuX2FsbENhcmRNb2RlcyA9IFtdO1xuICAgIH0sXG5cbiAgICBjYXJkc0xheW91dFNvcnQ6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBub2RlQXl5ID0gZS50YXJnZXQuY2hpbGRyZW47XG4gICAgICAgIGlmKG5vZGVBeXlbMF0uYWN0aXZlID09IHRydWUpey8v5oyJ5aSn5bCPXG4gICAgICAgICAgICB0aGlzLmNhcmRzTGF5b3V0U29ydENvbG9yID0gdHJ1ZTtcbiAgICAgICAgICAgIG5vZGVBeXlbMF0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBub2RlQXl5WzFdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25YKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihub2RlQXl5WzFdLmFjdGl2ZSA9PSB0cnVlKXsvL+aMieiKseiJslxuICAgICAgICAgICAgdGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9IGZhbHNlO1xuICAgICAgICAgICAgbm9kZUF5eVswXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgbm9kZUF5eVsxXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcbiAgICAgICAgfVxuICAgICAgICAvL3RoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSBub2RlQXl5WzFdLmFjdGl2ZSA9PSBmYWxzZTtcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0U29ydENvbG9yID09IHRydWVcbiAgICB9LFxuXG4gICAgYWRkQ2FyZHM6IGZ1bmN0aW9uIChjYXJkTmFtZXMpIHtcbiAgICAgICAgY2MuYXNzZXJ0KGNhcmROYW1lcyk7XG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcbiAgICAgICAgLy9jYXJkTmFtZXMuc29ydChmdW5jdGlvbihhMSxhMil7XG4gICAgICAgIC8vICAgIHJldHVybiBhMS5zcGxpdCgnXycpWzBdIC0gYTIuc3BsaXQoJ18nKVswXTtcbiAgICAgICAgLy99KVxuICAgICAgICBjYXJkTmFtZXMuZm9yRWFjaChmdW5jdGlvbihjYXJkLGluZGV4KXtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2FyZChjYXJkLGZhbHNlLGluZGV4KVxuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAvL3RoaXMuY2FyZHNMYXlvdXRTb3J0KCk7XG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcbiAgICAgICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICB0aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscyh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgfSxcblxuICAgIGFkZENhcmQ6IGZ1bmN0aW9uIChjYXJkTmFtZSwgYXV0b0NoYW5nZVBvc2l0aW9uWCA9IGZhbHNlLGluZGV4ID0gbnVsbCkge1xuICAgICAgICBjYy5hc3NlcnQoY2FyZE5hbWUubGVuZ3RoID4gMCk7XG5cbiAgICAgICAgbGV0IGNhcmRQcmVmYWIgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmNhcmRQcmVmYWIpO1xuICAgICAgICBjYXJkUHJlZmFiLm5hbWUgPSBjYXJkTmFtZTtcbiAgICAgICAgLy8gaWYoY2MubWFQYWkpe1xuICAgICAgICAvLyAgICAgdmFyIGNhcmRNYVBhaSA9ICczXycgKyBjYy5tYVBhaTtcbiAgICAgICAgLy8gICAgIGlmKGNhcmROYW1lID09IGNhcmRNYVBhaSl7XG4gICAgICAgIC8vICAgICAgICAgY2FyZFByZWZhYi5jb2xvciA9IG5ldyBjYy5Db2xvcigyMjYsIDE0NSwgMTQ1KTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfVxuICAgICAgICBjYXJkUHJlZmFiLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpLnNldENhcmQoY2FyZE5hbWUsaW5kZXgpO1xuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuYWRkQ2hpbGQoY2FyZFByZWZhYik7XG4gICAgICAgIGNhcmRQcmVmYWIuc2V0UG9zaXRpb25ZKHRoaXMuX2NhcmRPZmZzZXRZKTtcblxuICAgICAgICBpZiAoYXV0b0NoYW5nZVBvc2l0aW9uWCkge1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWCgpO1xuICAgICAgICB9XG4gICAgICAgIC8vbGV0IG5ld0NhcmQgPSBuZXcgS1FDYXJkKGNhcmROYW1lLG51bGwsaW5kZXgpO1xuICAgICAgICAvL2xldCBvcmlnaW5DYXJkID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmZpbmQoZnVuY3Rpb24oY2FyZCkge1xuICAgICAgICAvLyAgICByZXR1cm4gY2FyZC5pc0VxdWFsKG5ld0NhcmQpO1xuICAgICAgICAvL30pO1xuICAgICAgICAvL2lmIChvcmlnaW5DYXJkID09IG51bGwgJiYgIWF1dG9DaGFuZ2VQb3NpdGlvblgpIHtcbiAgICAgICAgLy8gICAgdGhpcy5fYWxsQ2FyZE1vZGVzLnB1c2gobmV3Q2FyZCk7XG4gICAgICAgIC8vfVxuICAgIH0sXG5cbiAgICBhZGRDYXJkTW9kZXM6IGZ1bmN0aW9uIChjYXJkTmFtZXMpIHtcbiAgICAgICAgY2MuYXNzZXJ0KGNhcmROYW1lcy5sZW5ndGggPiAwKTtcbiAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzID0gW107XG4gICAgICAgIGNhcmROYW1lcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmROYW1lLGluZGV4KXtcbiAgICAgICAgICAgIGxldCBuZXdDYXJkID0gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICAgICAgICAgIHRoaXMuX2FsbENhcmRNb2Rlcy5wdXNoKG5ld0NhcmQpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICByZWxvYWRDYXJkczogZnVuY3Rpb24gKGNhcmROYW1lcykge1xuICAgICAgICAvL2NhcmROYW1lcz1bJzFfMScsICcyXzEnLCAnM18xMScsICcxXzEyJywgJzJfMicsICczXzInLCAnNF8xMScsICc0XzEyJywgJzNfMTMnLCAnMl81JywgJzFfMTMnLCAnNF8zJywgJzFfMyddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMTEnLCAnMV8xMicsICcyXzInLCAnM18yJywgJzRfMTEnLCAnNF8xMicsICczXzEzJywgJzJfNScsICcxXzEzJywgJzRfMycsICcxXzMnXTtcbiAgICAgICAgLy/kuInluqblkIzoirFcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMl8xMycsICcyXzUnLCAnMl83JywgJzNfMScsICczXzInLCAnM180JywgJzNfMycsICczXzEzJywgJzFfMTInLCAnMV82JywgJzFfMScsICcxXzQnLCAnMV81J107XG4gICAgICAgIC8v5LiJ5ZCM6Iqx6aG6XG4gICAgICAgIC8vICBjYXJkTmFtZXM9WycyXzEnLCAnMl8yJywgJzJfMycsICcyXzQnLCAnMl81JywgJzNfNicsICczXzcnLCAnM184JywgJzNfOScsICczXzEwJywgJzRfMScsICc0XzInLCAnNF8zJ107XG4gICAgICAgIC8v5LiA5p2h6b6ZXG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzJfMScsICcyXzInLCAnMl8zJywgJzJfNCcsICcyXzUnLCAnM182JywgJzNfNycsICczXzgnLCAnM185JywgJzNfMTAnLCAnMV8xMScsICcxXzEyJywgJzFfMTMnXTtcbiAgICAgICAgLy/kuInpobrlrZBcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzEnLCAnM18yJywgJzRfMycsICcxXzcnLCAnNF81JywgJzRfNicsICczXzknLCAnNF84JywgJzNfMScsICcxXzEzJywgJzRfMTInLCAnNF8xMScsICcyXzEwJ107XG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzNfNScsICczXzQnLCAnNF8zJywgJzFfMicsICczXzEnLCAnNF85JywgJzNfOScsICc0XzgnLCAnM18xMCcsICcxXzEzJywgJzRfMTInLCAnNF8xMScsICcyXzEwJ107XG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzNfNScsICczXzQnLCAnNF8zJywgJzFfMicsICczXzEnLCAnNF81JywgJzNfNicsICc0XzgnLCAnM182JywgJzFfMTMnLCAnNF8xMicsICc0XzExJywgJzJfNyddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzNfNCcsICczXzQnLCAnNF82JywgJzJfMjAnLCAnMV8yMCcsICcxXzIwJywgJzNfNicsICc0XzgnLCAnM182JywgJzFfOCcsICc0XzEyJywgJzRfMTEnLCAnMl8yMCddO1xuICAgICAgICAvL+S4ieS4sOWkqeS4i1xuICAgICAgICAvL2NhcmROYW1lcz1bJzFfMScsICcyXzEnLCAnM18xJywgJzFfMicsICcyXzInLCAnM18yJywgJzRfMScsICc0XzInLCAnM18zJywgJzJfMycsICcxXzMnLCAnNF8zJywgJzFfMTMnXTtcbiAgICAgICAgLy805Liw5aSp5LiLXG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzFfMScsICcyXzEnLCAnM18xJywgJzFfNCcsICcyXzQnLCAnM18yJywgJzRfMicsICcxXzInLCAnM180JywgJzJfMycsICcxXzMnLCAnNF8zJywgJzFfMiddO1xuICAgICAgICAvL+WFreWygeWNilxuICAgICAgICAvLyBjYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMTEnLCAnMV8xMicsICcyXzInLCAnM18yJywgJzRfMTEnLCAnNF8xMicsICczXzEzJywgJzJfNScsICcxXzEzJywgJzRfMycsICcxXzMnXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9WycxXzknLCAnMl8xMScsICczXzgnLCAnMV8xMicsICcyXzInLCAnM18yJywgJzFfMTMnLCAnMl81JywgJzNfNScsJzFfNCcsICcyXzQnLCAnM180JywgJzNfMTAnXTtcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnNF85JywgJzJfMycsICczXzQnLCAnM182JywgJzJfMScsICcyXzQnLCAnMl8yJywgJzJfNScsICcyXzEzJywnMl84JywgJzJfMTAnLCAnMl8xMScsICcyXzEyJ107XG4gICAgICAgIC8vICAgY2FyZE5hbWVzPVsnNF8yJywgJzJfMycsICczXzQnLCAnM181JywgJzJfMScsICcyXzQnLCAnMl8yJywgJzJfNScsICcyXzEzJywnMl84JywgJzJfMTAnLCAnMl8xMScsICcyXzEyJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8xJywgJzJfMScsICcxXzQnLCAnM180JywgJzFfNicsICcyXzYnLCAnMV84JywgJzNfOCcsICcyXzgnLCcyXzEyJywgJzFfMTInLCAnMl8xMycsICczXzEzJ107XG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzRfOScsICcyXzMnLCAnM180JywgJzNfNicsICcyXzgnLCAnMl85JywgJzJfMTAnLCAnMl8xMScsICcyXzEzJywnM18xMycsICczXzEyJywgJzJfMTInLCAnMV8xMiddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9Wyc0XzknLCAnMl85JywgJzNfNCcsICczXzYnLCAnMV84JywgJzJfMScsICcyXzUnLCAnMl80JywgJzJfMycsJzNfMTMnLCAnM18xMicsICcyXzInLCAnMV8xMiddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzNfMicsICc0XzInLCAnMl80JywgJzNfNScsICcxXzUnLCAnM183JywgJzJfNycsICczXzEwJywgJzJfMScsJzJfMTMnLCAnMl8xMCcsICcyXzEyJywgJzJfMTEnXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzInLCAnNF8zJywgJzRfNCcsICc0XzUnLCAnNF81JywgJzRfNicsICc0XzEyJywgJzRfMTMnLCAnMl8xMicsJzNfMTInLCAnMl84JywgJzNfOCcsICcyXzExJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8zJywgJzFfMycsICc0XzUnLCAnNF81JywgJzNfNScsICcyXzUnLCAnMV8yMCcsICc0XzExJywgJzNfMTInLCc0XzEyJywgJzRfOCcsICc0XzEnLCAnMV8xMiddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzRfMycsICcxXzMnLCAnNF81JywgJzRfNScsICcyXzIwJywgJzFfMjAnLCAnMV8yMCcsICc0XzExJywgJzNfMTInLCc0XzEyJywgJzRfOCcsICc0XzEnLCAnMV8xMiddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzRfMycsICczXzQnLCAnNF82JywgJzRfNScsICcyXzcnLCAnMV8yMCcsICcxXzMnLCAnNF80JywgJzNfNicsJzRfNycsICc0XzgnLCAnMl8xMicsICcxXzEyJ107XG4gICAgICAgIGNjLmxvZyhjYXJkTmFtZXMpXG4gICAgICAgIHRoaXMuY2xlYXJDYXJkcygpO1xuICAgICAgICB0aGlzLl9rcUNhcmRNb2RlcyA9IFtdO1xuICAgICAgICB0aGlzLmFkZENhcmRzKGNhcmROYW1lcyk7XG4gICAgfSxcblxuICAgIGNsZWFyQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMubGF5b3V0VG91RGFvLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMubGF5b3V0V2VpRGFvLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICB9LFxuXG4gICAgcmVtb3ZlQ2FyZDogZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICAgIGlmICghY2FyZE5hbWUubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoY2FyZE5hbWUpLnJlbW92ZUZyb21QYXJlbnQoKTtcbiAgICB9LFxuXG4gICAgc2V0RmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBfcmVsb2FkS1FDYXJkTW9kZXNJbm5lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3RoaXMuX2txQ2FyZE1vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2FyZFByZWZhYk5vZGUpIHtcbiAgICAgICAgLy8gICAgbGV0IGNhcmRQcmVmYWIgPSBjYXJkUHJlZmFiTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgLy8gICAgcmV0dXJuIGNhcmRQcmVmYWIuY2FyZE1vZGUoKTtcbiAgICAgICAgLy99KS5zb3J0KEtRQ2FyZC5zb3J0KTtcbiAgICAgICAgLy90aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QgPSBudWxsO1xuICAgIH0sXG5cbiAgICBfdHlwZUJ1dHRvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9yZXR1cm4gW1xuICAgICAgICAvLyAgICB0aGlzLmJ0bkR1aVppLFxuICAgICAgICAvLyAgICB0aGlzLmJ0bkxpYW5nRHVpLFxuICAgICAgICAvLyAgICB0aGlzLmJ0blNhblRpYW8sXG4gICAgICAgIC8vICAgIHRoaXMuYnRuU2h1blppLFxuICAgICAgICAvLyAgICB0aGlzLmJ0blRvbmdIdWEsXG4gICAgICAgIC8vICAgIHRoaXMuYnRuSHVMdSxcbiAgICAgICAgLy8gICAgdGhpcy5idG5UaWVaaGksXG4gICAgICAgIC8vICAgIHRoaXMuYnRuVG9uZ0h1YVNodW4sXG4gICAgICAgIC8vICAgIC8qIyMjIyMqL1xuICAgICAgICAvLyAgICAvL3RoaXMuYnRuV3VUb25nLFxuICAgICAgICAvLyAgICAvKiMjIyMjKi9cbiAgICAgICAgLy9dO1xuICAgIH0sXG5cbiAgICBfcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHM6IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgICAgICAgLypjYXJkTW9kZXMubGVuZ3RoID09IDEzKi9cbiAgICAgICAgLy9jYXJkTW9kZXMgPSBjYXJkTW9kZXMgfHwgdGhpcy5fa3FDYXJkTW9kZXM7XG4gICAgICAgIC8vXG4gICAgICAgIC8vLyojIyMjI+WIneWni+WMlueJjCovXG4gICAgICAgIC8vdmFyIEJ1dHRvbnNMYXlvdXRDaGlsZHMgPSB0aGlzLnR5cGVCdXR0b25zTm9kZS5jaGlsZHJlbjtcbiAgICAgICAgLy9mb3IodmFyIGk9MDtpPEJ1dHRvbnNMYXlvdXRDaGlsZHMubGVuZ3RoO2krKyl7XG4gICAgICAgIC8vICAgIEJ1dHRvbnNMYXlvdXRDaGlsZHNbaV0uaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgIC8vfVxuICAgICAgICAvL1xuICAgICAgICAvL3RoaXMuYnRuRHVpWmkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5EdWlaaShjYXJkTW9kZXMpO1xuICAgICAgICAvL3RoaXMuYnRuTGlhbmdEdWkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZE1vZGVzKTtcbiAgICAgICAgLy90aGlzLmJ0blNhblRpYW8uaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5TYW5UaWFvKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vdGhpcy5idG5TaHVuWmkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5TaHVuWmkoY2FyZE1vZGVzKTtcbiAgICAgICAgLy90aGlzLmJ0blRvbmdIdWEuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5Ub25nSHVhKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vdGhpcy5idG5IdUx1LmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluSHVMdShjYXJkTW9kZXMpO1xuICAgICAgICAvL3RoaXMuYnRuVGllWmhpLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vdGhpcy5idG5Ub25nSHVhU2h1bi5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vLy90aGlzLmJ0bld1VG9uZy5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkTW9kZXMpO1xuICAgICAgICAvLy8vS1FDYXJkLmlzVGVTaHVQYWkoY2FyZE1vZGVzKVxuICAgICAgICAvLy8vbGV0IHR5cGVOYW1lID0gS1FDYXJkLmNhcmRzVHlwLWVOYW1lKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vLy9LUUNhcmQuaXNMaXVEdWlCYW4oY2FyZE1vZGVzKTtcbiAgICAgICAgLy8vL2FsZXJ0KHRoaXMuYnRuU2h1blppLmludGVyYWN0YWJsZSlcbiAgICAgICAgLy8vKiMjIyMj5aaC5p6c5pyJ5aSa5LiA6Imy77yM5bCx5piv6K6+572u5peg5ZCM5oyJ6ZKu55qE5Y+v5Lqk5LqS5oCnKi9cbiAgICAgICAgLy8vL2lmKGNjLmR1b1lpU2UgPT0gMCkge1xuICAgICAgICAvLy8vICAgIHRoaXMud3VUb25nTm9kZSA9IHRoaXMudHlwZUJ1dHRvbnNOb2RlLmdldENoaWxkQnlOYW1lKFwiYnRuV3VUb25nXCIpO1xuICAgICAgICAvLy8vICAgIHRoaXMuYnRuV3VUb25nID0gdGhpcy53dVRvbmdOb2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xuICAgICAgICAvLy8vICAgIHRoaXMuYnRuV3VUb25nLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vLy99XG4gICAgICAgIC8vLyojIyMjIyovXG4gICAgICAgIC8vXG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZVR5cGVCdXR0b25zKCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vLyojIyMjI+iuvue9ruaMiemSruWPr+S6pOS6kuWSjOS4jeWPr+S6pOS6kuaXtueahOmAj+aYjuW6piovXG4gICAgICAgIC8vZm9yKHZhciBpPTA7aTxCdXR0b25zTGF5b3V0Q2hpbGRzLmxlbmd0aDtpKyspe1xuICAgICAgICAvLyAgICBpZihCdXR0b25zTGF5b3V0Q2hpbGRzW2ldLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSl7XG4gICAgICAgIC8vICAgICAgICBCdXR0b25zTGF5b3V0Q2hpbGRzW2ldLm9wYWNpdHkgPSAyNTU7XG4gICAgICAgIC8vICAgIH1lbHNle1xuICAgICAgICAvLyAgICAgICAgQnV0dG9uc0xheW91dENoaWxkc1tpXS5vcGFjaXR5ID0gMTI1O1xuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vfVxuICAgIH0sXG5cbiAgICAvLyDlsIbmib7liLDkuobniYznsbvlnovnmoTniYznqoHlh7rlh7rmnaVcbiAgICBfc3RpY2tPdXRGaW5kQ2FyZFR5cGU6IGZ1bmN0aW9uICh0aXRsZSwgZmluZE1ldGhvZHMpIHtcblxuICAgICAgICAvLyDlhYjmoLnmja7niYznsbvlnovmib7lh7rmiYDmnInnmoTntKLlvJXpm4blkIhcbiAgICAgICAgLy92YXIgZmluZGVkSW5kZXhzQXJyYXkgPSBudWxsO1xuICAgICAgICAvL3RoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCA9IHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCB8fCB7fTtcbiAgICAgICAgLy9pZiAodGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LnRpdGxlICE9IHRpdGxlKSB7XG4gICAgICAgIC8vICAgIGZpbmRlZEluZGV4c0FycmF5ID0gKGZpbmRNZXRob2RzKCkgfHwgW10pLnJldmVyc2UoKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgZm9yKHZhciBpID0wO2k8ZmluZGVkSW5kZXhzQXJyYXkubGVuZ3RoLTE7aSsrKXsvL+WIoOmZpOWQjOexu+Wei+eJjFxuICAgICAgICAvLyAgICAgICAgdmFyIGluZGV4ID0gZmluZGVkSW5kZXhzQXJyYXlbaV07XG4gICAgICAgIC8vICAgICAgICAvKmlmKHRpdGxlID09ICdsaWFuZ0R1aScpe1xuICAgICAgICAvLyAgICAgICAgIGxldCBqU3RyaW5nc3BvaW50ID0gaW5kZXgubWFwKGZ1bmN0aW9uKGluZGV4cyl7XG4gICAgICAgIC8vICAgICAgICAgcmV0dXJuIHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4c10ucG9pbnQ7XG4gICAgICAgIC8vICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy8gICAgICAgICB2YXIgaXNCcmVhayA9IGZhbHNlO1xuICAgICAgICAvLyAgICAgICAgIHZhciByZXBOdW0gPSBqU3RyaW5nc3BvaW50LnJlZHVjZShmdW5jdGlvbihwLG4pe1xuICAgICAgICAvLyAgICAgICAgIGlmKCFwW25dKXtcbiAgICAgICAgLy8gICAgICAgICBwW25dID0gMTtcbiAgICAgICAgLy8gICAgICAgICB9ZWxzZXtcbiAgICAgICAgLy8gICAgICAgICBwW25dICs9IDFcbiAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAgcmV0dXJuIHBcbiAgICAgICAgLy8gICAgICAgICB9LHt9KTtcbiAgICAgICAgLy8gICAgICAgICBmb3IodmFyIHkgaW4gcmVwTnVtKXtcbiAgICAgICAgLy8gICAgICAgICBpZihyZXBOdW1beV0gPj0gMyl7XG4gICAgICAgIC8vICAgICAgICAgaXNCcmVhayA9IHRydWU7XG4gICAgICAgIC8vICAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgICBpZihpc0JyZWFrKXtcbiAgICAgICAgLy8gICAgICAgICBjYy5sb2cocmVwTnVtKVxuICAgICAgICAvLyAgICAgICAgIGNjLmxvZyhmaW5kZWRJbmRleHNBcnJheSlcbiAgICAgICAgLy8gICAgICAgICBjYy5sb2coaSlcbiAgICAgICAgLy8gICAgICAgICBjYy5sb2coJy0tLS0tLS0tMjkxJylcbiAgICAgICAgLy8gICAgICAgICBmaW5kZWRJbmRleHNBcnJheS5zcGxpY2UoaSwxKTtcbiAgICAgICAgLy8gICAgICAgICBjb250aW51ZTtcbiAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAgfSovXG4gICAgICAgIC8vICAgICAgICB2YXIgaVN0cmluZyA9ICcnO1xuICAgICAgICAvLyAgICAgICAgZm9yKHZhciBqID1pKzE7ajxmaW5kZWRJbmRleHNBcnJheS5sZW5ndGg7aisrKXtcbiAgICAgICAgLy8gICAgICAgICAgICB2YXIgcyA9IGZpbmRlZEluZGV4c0FycmF5W2pdO1xuICAgICAgICAvLyAgICAgICAgICAgIHZhciBqU3RyaW5nID0gJyc7XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgICAgICAgICAgbGV0IGlTdHJpbmdzID0gcy5tYXAoZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBsZXQgY2FyZE1vZGVsID0gdGhpcy5fa3FDYXJkTW9kZXNbaW5kZXhdO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICByZXR1cm4gY2FyZE1vZGVsLmNhcmROYW1lKCk7XG4gICAgICAgIC8vICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgICAgICAgICBsZXQgalN0cmluZ3MgPSBpbmRleC5tYXAoZnVuY3Rpb24oaW5kZXhzKXtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgbGV0IGNhcmRNb2RlbCA9IHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4c107XG4gICAgICAgIC8vICAgICAgICAgICAgICAgIHJldHVybiBjYXJkTW9kZWwuY2FyZE5hbWUoKTtcbiAgICAgICAgLy8gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAvL1xuICAgICAgICAvL1xuICAgICAgICAvLyAgICAgICAgICAgIGZvcih2YXIgciA9IDA7ciA8IGluZGV4Lmxlbmd0aDtyKyspe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBqU3RyaW5nID0galN0cmluZyArIGlTdHJpbmdzW3JdO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBpU3RyaW5nID0gaVN0cmluZyArIGpTdHJpbmdzW3JdO1xuICAgICAgICAvLyAgICAgICAgICAgIH1cbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgICAgICAgICBpZihqU3RyaW5nID09IGlTdHJpbmcpe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBmaW5kZWRJbmRleHNBcnJheS5zcGxpY2UoaSwxKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vICAgICAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgIHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCA9IHtcbiAgICAgICAgLy8gICAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgICAgLy8gICAgICAgIGluZGV4c0FycmF5OiBmaW5kZWRJbmRleHNBcnJheSxcbiAgICAgICAgLy8gICAgICAgIC8vaW5kZXg6IHRpdGxlPT1cImR1aVppXCI/ZmluZGVkSW5kZXhzQXJyYXkubGVuZ3RoLTE6MFxuICAgICAgICAvLyAgICAgICAgaW5kZXg6IDBcbiAgICAgICAgLy8gICAgfTtcbiAgICAgICAgLy99XG4gICAgICAgIC8vXG4gICAgICAgIC8vZmluZGVkSW5kZXhzQXJyYXkgPSB0aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QuaW5kZXhzQXJyYXk7XG4gICAgICAgIC8vaWYgKCFmaW5kZWRJbmRleHNBcnJheSB8fCBmaW5kZWRJbmRleHNBcnJheS5sZW5ndGggPT0gMCkge1xuICAgICAgICAvLyAgICByZXR1cm47XG4gICAgICAgIC8vfVxuICAgICAgICAvLy8vIOWwhuW3suacieeahOeqgeWHuueahOeJjOeahOS9jee9rumHjee9ruWbnuWIneWni+S9jee9rlxuICAgICAgICAvL3RoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8vLyDorqHnrpflh7ropoHnqoHlh7rnmoTniYzmlbDnu4RcbiAgICAgICAgLy92YXIgaW5kZXggPSB0aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QuaW5kZXg7XG4gICAgICAgIC8vbGV0IGluZGV4cyA9IGZpbmRlZEluZGV4c0FycmF5W2luZGV4XTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgc2VsZWN0ZWRDYXJkTmFtZXMgPSBpbmRleHMubWFwKGZ1bmN0aW9uKGluZGV4KXtcbiAgICAgICAgLy8gICAgbGV0IGNhcmRNb2RlbCA9IHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4XTtcbiAgICAgICAgLy8gICAgcmV0dXJuIGNhcmRNb2RlbC5jYXJkTmFtZSgpO1xuICAgICAgICAvL30uYmluZCh0aGlzKSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5maWx0ZXIoZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgIC8vICAgIGxldCBjYXJkUHJlZmFiID0gY2FyZE5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vICAgIGlmKHNlbGVjdGVkQ2FyZE5hbWVzLmluY2x1ZGVzKGNhcmRQcmVmYWIuY2FyZE5hbWUoKSkpIHtcbiAgICAgICAgLy8gICAgICAgIHZhciBuYW1lSW5kZXggPSBzZWxlY3RlZENhcmROYW1lcy5pbmRleE9mKGNhcmRQcmVmYWIuY2FyZE5hbWUoKSk7XG4gICAgICAgIC8vICAgICAgICBzZWxlY3RlZENhcmROYW1lcy5zcGxpY2UobmFtZUluZGV4LDEpO1xuICAgICAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy8gICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAvL30pO1xuXG4gICAgICAgIC8vLy8g56qB5Ye66K6h566X5Ye65p2l55qE54mM5pWw57uEXG4gICAgICAgIC8vdGhpcy5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XG4gICAgICAgIC8vLy8g5L+d5a2Y5aW977yM55So5LqO5YaN5qyh54K55Ye75LqG56qB5Ye65LiL5LiA57uE54mMXG4gICAgICAgIC8vaW5kZXggPSAoaW5kZXggKyAxKSAlIGZpbmRlZEluZGV4c0FycmF5Lmxlbmd0aDtcbiAgICAgICAgLy90aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QuaW5kZXggPSBpbmRleDtcbiAgICB9LFxuXG4gICAgY2xpY2tEdWlaaTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcImR1aVppXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZER1aVppKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tMaWFuZ0R1aTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcImxpYW5nRHVpXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZExpYUR1aSh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrU2FuVGlhbzogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcInNhblRpYW9cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kU2FuVGlhbyh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrU2h1blppOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwic2h1blppXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZFNodW5aaSh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrVG9uZ0h1YTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcInRvbmdIdWFcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YSh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrSHVMdTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcImh1THVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kSHVMdSh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrVGllWmhpOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwidGllWmhpXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZFRpZVpoaSh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIC8qIyMjIyMqL1xuICAgIGNsaWNrV3VUb25nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwid3VUb25nXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZFd1VG9uZyh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcbiAgICAvKiMjIyMjKi9cblxuICAgIGNsaWNrVG9uZ0h1YVNodW46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJ0b25nSHVhU2h1blwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bih0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrQ2FuY2VsQWxsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2xpY2tEZWxldGVUb3VEYW8oKTtcbiAgICAgICAgdGhpcy5jbGlja0RlbGV0ZVpob25nRGFvKCk7XG4gICAgICAgIHRoaXMuY2xpY2tEZWxldGVXZWlEYW8oKTtcbiAgICB9LFxuXG4gICAgLyrngrnlh7vlrozmiJDmjInpkq4qL1xuICAgIGNsaWNrRG9uZTogZnVuY3Rpb24gKCkge1xuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XG4gICAgICAgIHRoaXMuY2FyZEFsbHMgPSAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbi5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIueSAtIGEueTt9KS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkuY2hpbGRyZW5bMF07fSk7XG5cbiAgICAgICAgbGV0IHRvdUNhcmRNb2RlbHMgPSB0aGlzLl90YW9EYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgbGV0IHpob25nQ2FyZE1vZGVzID0gdGhpcy5femhvbmdEYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgbGV0IHdlaUNhcmRNb2RlcyA9IHRoaXMuX3dlaURhb0NhcmRNb2RlcygpO1xuICAgICAgICB0aGlzLl9kaWRTZWxlY3RlZENhcmRzKHRvdUNhcmRNb2RlbHMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXMpO1xuICAgIH0sXG5cbiAgICAvKueCueWHu+aBreWWnOS9oOmhtemdoueahOehruWumuaMiemSriovXG4gICAgb25CdG5Hb25nWGlOaUNvbWZpcm1DbGljazpmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8v6K6w5b2V546p5a6254K55Ye75LqG56Gu5a6a5oyJ6ZKu77yaXG4gICAgICAgIHRoaXMuQnRuQ2xpY2tHb25nWGlOaUNvbWZpcm0gPSB0cnVlO1xuXG4gICAgICAgIHZhciBjYXJkcyA9IFtdO1xuXG4gICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihpKXtjYXJkcyA9IGNhcmRzLmNvbmNhdChpKTt9KTtcblxuICAgICAgICB2YXIgdGVTaHVQYWlDYXJkc1NlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsMihjYXJkcyk7XG4gICAgICAgIHZhciByZXN1bHQgPSBbdGVTaHVQYWlDYXJkc1NlcnZlckluZm9dO1xuICAgICAgICBpZiAodGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIF9kaWRTZWxlY3RlZENhcmRzOiBmdW5jdGlvbiAodG91Q2FyZHMsIHpob25nQ2FyZHMsIHdlaUNhcmRzKSB7XG4gICAgICAgIHRvdUNhcmRzID0gdG91Q2FyZHMgfHwgW107XG4gICAgICAgIHpob25nQ2FyZHMgPSB6aG9uZ0NhcmRzIHx8IFtdO1xuICAgICAgICB3ZWlDYXJkcyA9IHdlaUNhcmRzIHx8IFtdO1xuICAgICAgICBsZXQgdG91U2VydmVySW5mbyA9IHRoaXMuX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWwodG91Q2FyZHMpO1xuICAgICAgICBsZXQgemhvbmdTZXJ2ZXJJbmZvID0gdGhpcy5fY29udmVydENhcmRzVG9TZXJ2ZXJNb2RlbCh6aG9uZ0NhcmRzKTtcbiAgICAgICAgbGV0IHdlaVNlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsKHdlaUNhcmRzKTtcblxuICAgICAgICAvL2NvbnNvbGUubG9nKHRvdVNlcnZlckluZm8pO1xuICAgICAgICAvL2NvbnNvbGUubG9nKHpob25nU2VydmVySW5mbyk7XG4gICAgICAgIC8vY29uc29sZS5sb2cod2VpU2VydmVySW5mbyk7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS01MTJcIik7XG4gICAgICAgIGlmKCEodG91U2VydmVySW5mby52YWx1ZSA8IHpob25nU2VydmVySW5mby52YWx1ZSAmJiB6aG9uZ1NlcnZlckluZm8udmFsdWUgPD0gd2VpU2VydmVySW5mby52YWx1ZSkpe1xuICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZEFuaW1hdGlvbi55ID0gLTUwO1xuICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZEFuaW1hdGlvbi5vcGFjaXR5ID0gMjU1O1xuICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZEFuaW1hdGlvbi5ydW5BY3Rpb24oY2MubW92ZVRvKDEsIGNjLnAoMCwgMCkpKTtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gY2Muc3Bhd24oY2MubW92ZVRvKHRoaXMuY2FyZFRpbWUsIGNjLnAoMCwgMTApKSwgY2MuZmFkZU91dCh0aGlzLmNhcmRUaW1lKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZEFuaW1hdGlvbi5ydW5BY3Rpb24oYWN0aW9uKTtcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgMS41KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0ID0gW3RvdVNlcnZlckluZm8sIHpob25nU2VydmVySW5mbywgd2VpU2VydmVySW5mb107XG4gICAgICAgIC8vcmV0dXJuO1xuICAgICAgICBpZiAodGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNsaWNrRGVsZXRlVG91RGFvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2RlbGV0ZURhb0NhcmRzT2ZMYXlvdXQodGhpcy5sYXlvdXRUb3VEYW8ubm9kZSk7XG4gICAgfSxcblxuICAgIGNsaWNrRGVsZXRlWmhvbmdEYW86IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGVsZXRlRGFvQ2FyZHNPZkxheW91dCh0aGlzLmxheW91dFpob25nRGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICBjbGlja0RlbGV0ZVdlaURhbzogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkc09mTGF5b3V0KHRoaXMubGF5b3V0V2VpRGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICAvLyDorqHml7blmajkuovku7ZcbiAgICB0aW1lU3RhcnQ6IGZ1bmN0aW9uIChkdXJhdGlvbikge1xuICAgICAgICBjYy5hc3NlcnQoZHVyYXRpb24gPiAwKTtcbiAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xuICAgICAgICB0aGlzLnRpbWVOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciB0aW1lc3RhbXAgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ0aW1lc3RhbXBcIik7ICAvLyDojrflj5bmnKzlnLDlrZjlgqjnmoTml7bpl7TmiLNcbiAgICAgICAgaWYodGltZXN0YW1wKXsgIC8vIOWmguaenOacieWImeivgeaYjueOqeWutuaYr+mHjeaWsOi/m+adpeS6hueahFxuICAgICAgICAgICAgdmFyIG5vdyA9IERhdGUucGFyc2UobmV3IERhdGUoKSk7XG4gICAgICAgICAgICB2YXIgdGltZSA9IGR1cmF0aW9uKjEwMDA7XG4gICAgICAgICAgICBpZihub3cgLSB0aW1lc3RhbXAgPiB0aW1lKXsgLy8g6LaF5pe2XG4gICAgICAgICAgICAgICAgaWYobm93IC0gdGltZXN0YW1wIDwgMip0aW1lKXtcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb24gPSA1OyAgLy8g546p5a625Y+v6IO95Ye65LqO5YW25LuW5Y6f5Zug6YCA5Ye65ri45oiP5a+86Ie06LaF5pe277yM5Li65YW25o+Q5L6bNeenkuaXtumXtOaVtOeQhueJjOWei++8iOi/meW3sue7j+aYr+W+iOS7geaFiOeahOS6hu+8ieOAglxuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSBNYXRoLmZsb29yKCBkdXJhdGlvbiAtIChub3cgLSB0aW1lc3RhbXApLzEwMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ZWxzZXsgIC8vIOWmguaenOayoeacieaXtumXtOaIs++8jOWImeS/neWtmO+8jOS4uueOqeWutumAgOWHuua4uOaIj+S/neeVmeivgeaNru+8m1xuICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IERhdGUucGFyc2UobmV3IERhdGUoKSk7ICAgICBcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGltZXN0YW1wJyx0aW1lc3RhbXApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBTdHJpbmcoZHVyYXRpb24pO1xuICAgICAgICB0aGlzLnRpbWVOb2RlLmdldENvbXBvbmVudChcInRpbWVcIikuc2V0VGltZShkdXJhdGlvbiAqIDAuNSk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5fdGltZU1ldGhvZCwgMSwgZHVyYXRpb24pO1xuICAgIH0sXG5cbiAgICB0aW1lU3RvcDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fdGltZU1ldGhvZCk7XG4gICAgICAgIHRoaXMudGltZU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIF90aW1lTWV0aG9kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA9IHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiAtIDE7XG5cbiAgICAgICAgdmFyIHJlbWFpbiA9IE1hdGgubWF4KHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiwgMCk7XG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IChyZW1haW4gPCAxMCAmJiByZW1haW4gPiAwKSA/ICgnMCcgKyByZW1haW4pIDogcmVtYWluO1xuXG4gICAgICAgIGlmICh0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gPD0gMCkge1xuICAgICAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xuICAgICAgICAgICAgaWYoY2MuY2hhb1NoaUNodVBhaSA9PSB0cnVlKSB0aGlzLl90aW1lT3V0QXV0b1NlbGVjdENhcmRzKCk7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8g6LaF5pe25ZCO77yM6Ieq5Yqo6YCJ54mMXG4gICAgX3RpbWVPdXRBdXRvU2VsZWN0Q2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOmakOiXj+aBreWWnOS9oFxuICAgICAgICAgKi9cbiAgICAgICAgcGxheS5nb25nWGlOaVNob3coZmFsc2UpO1xuICAgICAgICBpZiAodHlwZW9mKGNjLnRlU2h1UGFpQ2FyZHMpICE9IFwidW5kZWZpbmVkXCIgJiYgY2MudGVTaHVQYWlDYXJkcyAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLm9uQnRuR29uZ1hpTmlDb21maXJtQ2xpY2soKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vbGV0IFt0b3VDYXJkTW9kZWxzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzXSA9IHRoaXMuX2NhY2xlQXV0b1NlbGVjdGVkQ2FyZHMoKTtcbiAgICAgICAgbGV0IFt0b3VDYXJkTW9kZWxzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzXSA9IHRoaXMuX2ZpbmRDYXJkSW5kZXguYXJyWzBdO1xuXG5cbiAgICAgICAgaWYgKHRvdUNhcmRNb2RlbHMgPT0gbnVsbCB8fCB6aG9uZ0NhcmRNb2RlcyA9PSBudWxsIHx8IHdlaUNhcmRNb2RlcyA9PSBudWxsKSB7XG4gICAgICAgICAgICB0b3VDYXJkTW9kZWxzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLnNsaWNlKC0zKTtcbiAgICAgICAgICAgIHpob25nQ2FyZE1vZGVzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLnNsaWNlKDUsIDEwKTtcbiAgICAgICAgICAgIHdlaUNhcmRNb2RlcyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSgwLCA1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNjLmxvZyh0b3VDYXJkTW9kZWxzKVxuICAgICAgICAvLyBjYy5sb2coemhvbmdDYXJkTW9kZXMpXG4gICAgICAgIC8vIGNjLmxvZyh3ZWlDYXJkTW9kZXMpXG4gICAgICAgIC8vIGNjLmxvZyh0aGlzLl9hbGxDYXJkTW9kZXMpXG4gICAgICAgIC8vIGNjLmxvZyhcIuiHquWKqOmAieeJjCB0b3VDYXJkTW9kZWxzIHpob25nQ2FyZE1vZGVzIHdlaUNhcmRNb2Rlc++8mlwiKTtcbiAgICAgICAgdGhpcy5fZGlkU2VsZWN0ZWRDYXJkcyh0b3VDYXJkTW9kZWxzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzKTtcbiAgICB9LFxuXG4gICAgX2NhY2xlQXV0b1NlbGVjdGVkQ2FyZHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICBsZXQgY2FyZHMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuZmlsdGVyKGZ1bmN0aW9uKGkpe1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgcmVzdWx0Q2FyZHMgPSBbXTtcbiAgICAgICAgZm9yKHZhciBpID0gMTtpIDwgMzsgaSsrKXtcbiAgICAgICAgICAgIGxldCBjYXJkc3MgPSBLUUNhcmQuYXV0b1NlbGVjdENhcmRzKGNhcmRzLCA1KTtcbiAgICAgICAgICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZHNzKTtcbiAgICAgICAgICAgIHJlc3VsdENhcmRzLnB1c2goY2FyZHNzKTtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHRDYXJkcy5wdXNoKGNhcmRzKTtcbiAgICAgICAgLy9sZXQgdG91U2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHJlc3VsdENhcmRzWzJdKTtcbiAgICAgICAgLy9sZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0Q2FyZHNbMV0pO1xuICAgICAgICAvL2xldCB3ZWlTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0Q2FyZHNbMF0pO1xuICAgICAgICAvLyBjYy5sb2cocmVzdWx0Q2FyZHMpXG4gICAgICAgIC8vIGNjLmxvZyh0aGlzLl9hbGxDYXJkTW9kZXMpXG4gICAgICAgIC8vIGNjLmxvZyhcIueJjOWIhuaVsOiHquWKqOmAieeJjO+8mlwiLCB0b3VTY29yZSwgemhvbmdTY29yZSwgd2VpU2NvcmUpO1xuICAgICAgICAvL2xldCB3ZWlDYXJkTW9kZXMgPSBLUUNhcmQuYXV0b1NlbGVjdENhcmRzKGNhcmRzLCA1KTtcbiAgICAgICAgLy9jYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKHdlaUNhcmRNb2Rlcyk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vbGV0IHpob25nQ2FyZE1vZGVzID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkcywgNSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vbGV0IHRvdUNhcmRNb2RlcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKHpob25nQ2FyZE1vZGVzKTtcbiAgICAgICAgLy9pZiAodG91Q2FyZE1vZGVzLmxlbmd0aCA9PSAzICYmIHpob25nQ2FyZE1vZGVzLmxlbmd0aCA9PSA1ICYmIHdlaUNhcmRNb2Rlcy5sZW5ndGggPT0gNSkge1xuICAgICAgICAvLyAgICByZXR1cm4gW3RvdUNhcmRNb2RlcywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2Rlc107XG4gICAgICAgIC8vfVxuICAgICAgICBpZiAocmVzdWx0Q2FyZHNbMl0ubGVuZ3RoID09IDMgJiYgcmVzdWx0Q2FyZHNbMV0ubGVuZ3RoID09IDUgJiYgcmVzdWx0Q2FyZHNbMF0ubGVuZ3RoID09IDUpIHtcbiAgICAgICAgICAgIHJldHVybiBbcmVzdWx0Q2FyZHNbMl0sIHJlc3VsdENhcmRzWzFdLCByZXN1bHRDYXJkc1swXV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gW107XG4gICAgfSxcblxuICAgIF9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHt9O1xuICAgICAgICByZXN1bHQudHlwZSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMpO1xuICAgICAgICByZXN1bHQudmFsdWUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKGNhcmRzKTtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzMShjYXJkcyk7XG4gICAgICAgIHJlc3VsdC5jYXJkcyA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyhjYXJkcyk7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuXG4gICAgLyojIyMjIyovXG4gICAgX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWwyOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgICAgdmFyIGNvbnZlcnRUb1NlcnZlckNhcmRzID0gW107XG5cbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmRNb2RlKXtcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgICAgIGNhcmRNb2RlID0gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZE1vZGUpKTtcbiAgICAgICAgICAgIGNhcmRNb2RlLmZvckVhY2goZnVuY3Rpb24oY2NhKXtcbiAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBjY2EucG9pbnQgPT0gMTQgPyAxOmNjYS5wb2ludDtcbiAgICAgICAgICAgICAgICBhcnIucHVzaCh7bnVtYmVyOnBvaW50LHN1aXQ6Y2NhLmNvbG9yfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnZlcnRUb1NlcnZlckNhcmRzLnB1c2goYXJyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCByZXN1bHQgPSB7fTtcbiAgICAgICAgcmVzdWx0LnR5cGUgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzKTtcbiAgICAgICAgcmVzdWx0LnZhbHVlID0gMDtcbiAgICAgICAgcmVzdWx0LmNhcmRzID0gY29udmVydFRvU2VydmVyQ2FyZHM7XG5cbiAgICAgICAgaWYgKHJlc3VsdC50eXBlID49IEtRQ2FyZC5UWVBFLlNhblRhb0h1YSAmJiBjYy5tb3NoaSAhPSAxKSB7XG4gICAgICAgICAgICAvLyDnibnmrorniYxcbiAgICAgICAgICAgIHJlc3VsdC5pc0NvbnRhaW5FeHRyYSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG4gICAgLyojIyMjIyovXG4gICAgLy8g54m55q6K54mM6YeM5piv5ZCm6L+Y5ZCr5pyJ54m55q6K54mMXG4gICAgLy8g5YyF5ZCr55qE5oOF5Ya15pyJ77yaXG4gICAgLy8g5LiJ5qGD6IqxIOWPr+iDveWQq+acieWQjOiKsemhulxuICAgIC8vIOS4iemhuuWtkCDlj6/og73lkKvmnInlkIzoirHpobpcbiAgICAvLyDlha3lr7nljYog5Y+v6IO95ZCr5pyJ6ZOB5pSvXG4gICAgX2lzQ29udGFpbkV4dHJhQ2FyZHNUeXBlOiBmdW5jdGlvbiAodHlwZSwgY2FyZHMpIHtcbiAgICAgICAgaWYgKHR5cGUgPT0gS1FDYXJkLlRZUEUuU2FuVGFvSHVhKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bihjYXJkcyk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBLUUNhcmQuVFlQRS5TYW5TaHVuWmkpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRzKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IEtRQ2FyZC5UWVBFLkxpdUR1aUJhbikge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSxcblxuICAgIC8vIOinpuaRuOS6i+S7tlxuICAgIF9yZWdpc3RlclRvdWNoRXZlbnRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dC5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCB0aGlzLl90b3VjaENhcmRMYXlvdXQuYmluZCh0aGlzKSk7XG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dC5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX01PVkUsIHRoaXMuX3RvdWNoQ2FyZExheW91dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCB0aGlzLl90b3VjaENhcmRMYXlvdXRFbmQuYmluZCh0aGlzKSk7XG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dC5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCwgdGhpcy5fdG91Y2hDYXJkTGF5b3V0RW5kLmJpbmQodGhpcykpO1xuICAgIH0sXG4gICAgY2FjbGVBdXRvU2VsZWN0ZWRDYXJkc0luZGV4OiBmdW5jdGlvbihjYXJkcykge1xuICAgICAgICAvL2NjLmxvZygnLS0tLS0tNjIyJylcbiAgICAgICAgbGV0IHRlc3RGaW5kID0gS1FDYXJkLnRlc3RGaW5kKGNhcmRzKSB8fCBbXTtcbiAgICAgICAgLy9jYy5sb2coJy0tLS0tLTYyMjEnKVxuICAgICAgICB2YXIgcmVzdWx0ID0gW11cbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgdGVzdEZpbmQubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgdmFyIHMgPSB0ZXN0RmluZFtpXTtcbiAgICAgICAgICAgIGlmKHMubGVuZ3RoID49IDEpe1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7aiA8IHMubGVuZ3RoOyBqKyspe1xuICAgICAgICAgICAgICAgICAgICAvL3Jlc3VsdC5wdXNoKHNbMF0pOy8v5Y+q5Y+W5LiA5LiqXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHNbal0pOy8vXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxuICAgIGNhY2xlQXV0b1NlbGVjdGVkQ2FyZHNBcnJheTogZnVuY3Rpb24oY2FyZHMpIHtcbiAgICAgICAgdmFyIGluZGV4cyA9IHRoaXMuY2FjbGVBdXRvU2VsZWN0ZWRDYXJkc0luZGV4KGNhcmRzKTtcbiAgICAgICAgaWYoaW5kZXhzLmxlbmd0aCA8IDEpe1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBzZWxlY3RlZENhcmQgPSBbXTtcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgaW5kZXhzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGxldCBzID0gaW5kZXhzW2ldO1xuICAgICAgICAgICAgbGV0IGEgPSBzLm1hcChmdW5jdGlvbihpbmRleCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhcmRzW2luZGV4XTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2VsZWN0ZWRDYXJkLnB1c2goYSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkQ2FyZDtcbiAgICB9LFxuXG4gICAgY2FjbGVBdXRvU2VsZWN0ZWRDYXJkczI6IGZ1bmN0aW9uKCkge1xuICAgICAgICBsZXQgY2FyZHMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoKTtcbiAgICAgICAgdmFyIGNhcmRzQXJyYXkgPSB0aGlzLmNhY2xlQXV0b1NlbGVjdGVkQ2FyZHNBcnJheShjYXJkcyk7XG4gICAgICAgIHZhciByZXN1bHRBcnJheSA9IFtdO1xuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCBjYXJkc0FycmF5Lmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgbGV0IHMgPSBjYXJkc0FycmF5W2ldIHx8IFtdO1xuICAgICAgICAgICAgbGV0IHF3ZXIgPSBbXTtcbiAgICAgICAgICAgIGZvcih2YXIgaiA9IDE7aiA8IGNhcmRzQXJyYXkubGVuZ3RoO2orKyl7XG4gICAgICAgICAgICAgICAgbGV0IGQgPSBjYXJkc0FycmF5W2pdIHx8IFtdO1xuICAgICAgICAgICAgICAgIGxldCBzQyA9IHMua3FfZXhjbHVkZXMoZCk7XG4gICAgICAgICAgICAgICAgaWYoc0MubGVuZ3RoID09IHMubGVuZ3RoICYmIHMubGVuZ3RoID4gMCl7Ly/liKTmlq3niYznm7jlkIwg5Y2z5rKh5pyJ6YeN5aSN55qEXG4gICAgICAgICAgICAgICAgICAgIHF3ZXIgPSBbcyxkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihxd2VyLmxlbmd0aCA+IDEpe1xuICAgICAgICAgICAgICAgIHJlc3VsdEFycmF5LnB1c2gocXdlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL+ihpeWFqOiuoeWIkjFcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXkubGVuZ3RoO2krKyl7XG5cbiAgICAgICAgICAgIGxldCBzID0gcmVzdWx0QXJyYXlbaV07XG5cbiAgICAgICAgICAgIGxldCBjYXJkc3MgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoKTtcblxuICAgICAgICAgICAgY2FyZHNzID0gY2FyZHNzLmtxX2V4Y2x1ZGVzKHNbMF0pO1xuXG4gICAgICAgICAgICBjYXJkc3MgPSBjYXJkc3Mua3FfZXhjbHVkZXMoc1sxXSk7XG5cbiAgICAgICAgICAgIGlmKGNhcmRzcy5sZW5ndGggPj0gNSl7XG4gICAgICAgICAgICAgICAgc1syXSA9IEtRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMoY2FyZHNzLCA1KTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHNbMl0gPSBLUUNhcmQuYXV0b1NlbGVjdENhcmRzKGNhcmRzcywgMyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlc3VsdEFycmF5W2ldLnNvcnQoZnVuY3Rpb24gKGExLGEyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5zY29yZU9mQ2FyZHMoYTEpLUtRQ2FyZC5zY29yZU9mQ2FyZHMoYTIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy/ooaXlhajorqHliJIyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHJlc3VsdEFycmF5Lmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgdmFyIHMgPSByZXN1bHRBcnJheVtpXTtcbiAgICAgICAgICAgIHZhciBjYXJkc3FlID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmZpbHRlcihmdW5jdGlvbihpaSl7Ly/ph43mlrDotYvlgLxjYXJkc1xuICAgICAgICAgICAgICAgIHJldHVybiBpaTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy/ljrvph41cbiAgICAgICAgICAgIHZhciBxID0gc1swXS5jb25jYXQoc1sxXSkuY29uY2F0KHNbMl0pO1xuICAgICAgICAgICAgdmFyIGNhcmRzcSA9IGNhcmRzcWUua3FfZXhjbHVkZXMocSk7XG4gICAgICAgICAgICBzWzBdID0gc1swXS5rcV9leGNsdWRlcyhzWzFdKTtcbiAgICAgICAgICAgIHNbMF0gPSBzWzBdLmtxX2V4Y2x1ZGVzKHNbMl0pO1xuICAgICAgICAgICAgc1sxXSA9IHNbMV0ua3FfZXhjbHVkZXMoc1swXSk7XG4gICAgICAgICAgICBzWzFdID0gc1sxXS5rcV9leGNsdWRlcyhzWzJdKTtcbiAgICAgICAgICAgIHNbMl0gPSBzWzJdLmtxX2V4Y2x1ZGVzKHNbMV0pO1xuICAgICAgICAgICAgc1syXSA9IHNbMl0ua3FfZXhjbHVkZXMoc1swXSk7XG4gICAgICAgICAgICAvL+WkmuS9meWIoOmZpFxuICAgICAgICAgICAgaWYgKHNbMl0ubGVuZ3RoID4gNSkgey8v5bC+6YGTXG4gICAgICAgICAgICAgICAgbGV0IGEgPSBzWzJdLnNwbGljZSg1LCBzWzJdLmxlbmd0aC01KTtcbiAgICAgICAgICAgICAgICBmb3IodmFyIHkgaW4gYSl7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRzcS5wdXNoKGFbeV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzWzFdLmxlbmd0aCA+IDUpIHsvL+S4remBk1xuICAgICAgICAgICAgICAgIGxldCBhID0gc1sxXS5zcGxpY2UoNSwgc1sxXS5sZW5ndGgtNSk7XG4gICAgICAgICAgICAgICAgZm9yKHZhciB5IGluIGEpe1xuICAgICAgICAgICAgICAgICAgICBjYXJkc3EucHVzaChhW3ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc1swXS5sZW5ndGggPiAzKSB7Ly/lpLTpgZNcbiAgICAgICAgICAgICAgICBsZXQgYSA9IHNbMF0uc3BsaWNlKDMsIHNbMF0ubGVuZ3RoLTMpO1xuICAgICAgICAgICAgICAgIGZvcih2YXIgeSBpbiBhKXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZHNxLnB1c2goYVt5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9jYXJkc3EgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0EoY2FyZHNxKTtcbiAgICAgICAgICAgIGNhcmRzcS5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XG4gICAgICAgICAgICBjYXJkc3EuZm9yRWFjaChmdW5jdGlvbihjYXJkMTEpe1xuICAgICAgICAgICAgICAgIGlmKGNhcmQxMS5wb2ludCA9PSAxNCl7XG4gICAgICAgICAgICAgICAgICAgIGNhcmQxMS5wb2ludCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL+aciee8uua3u+WKoFxuICAgICAgICAgICAgd2hpbGUoc1syXS5sZW5ndGggPCA1KSB7Ly/lsL7pgZNcbiAgICAgICAgICAgICAgICBzWzJdLnB1c2goY2FyZHNxLnBvcCgpIHx8IFtdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlKHNbMV0ubGVuZ3RoIDwgNSkgey8v5Lit6YGTXG4gICAgICAgICAgICAgICAgc1sxXS5wdXNoKGNhcmRzcS5wb3AoKSB8fCBbXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aGlsZShzWzBdLmxlbmd0aCA8IDMpIHsvL+WktOmBk1xuICAgICAgICAgICAgICAgIHNbMF0ucHVzaChjYXJkc3EucG9wKCkgfHwgW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyppZihjYXJkc3EubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgd2hpbGUoc1syXS5sZW5ndGggPCA1KSB7Ly/lsL7pgZNcbiAgICAgICAgICAgICAgICAgICAgc1syXS5wdXNoKGNhcmRzcS5wb3AoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoY2FyZHNxLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgIHdoaWxlKHNbMV0ubGVuZ3RoIDwgNSkgey8v5Lit6YGTXG4gICAgICAgICAgICAgICAgICAgIHNbMV0ucHVzaChjYXJkc3EucG9wKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGNhcmRzcS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICB3aGlsZShzWzBdLmxlbmd0aCA8IDMpIHsvL+WktOmBk1xuICAgICAgICAgICAgICAgICAgICBzWzBdLnB1c2goY2FyZHNxLnBvcCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9Ki9cbiAgICAgICAgICAgIGlmKHNbMl1bNF0gPT0gbnVsbCB8fCBzWzFdWzRdID09IG51bGwgfHwgc1swXVsyXSA9PSBudWxsXG4gICAgICAgICAgICAgICAgfHwgc1syXVs0XSA9PSAnJyB8fCBzWzFdWzRdID09ICcnIHx8IHNbMF1bMl0gPT0gJycpe1xuICAgICAgICAgICAgICAgIHJlc3VsdEFycmF5LnNwbGljZShpLDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJlc3VsdENhcmRzID0gW107XG4gICAgICAgIGxldCBjYXJkc3MxID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaTt9KTtcbiAgICAgICAgdmFyIGluZGV4YXNkZiA9IDI7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IDM7IGkrKyl7XG4gICAgICAgICAgICBsZXQgbGVuZ3RoID0gaW5kZXhhc2RmID09IDA/IDM6IDU7XG4gICAgICAgICAgICBsZXQgY2FyZHNzID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkc3MxLCBsZW5ndGgpIHx8IFtdO1xuICAgICAgICAgICAgY2FyZHNzMSA9IGNhcmRzczEua3FfZXhjbHVkZXMoY2FyZHNzKTtcbiAgICAgICAgICAgIHJlc3VsdENhcmRzW2luZGV4YXNkZl0gPSBjYXJkc3M7XG4gICAgICAgICAgICBpbmRleGFzZGYtLTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHJlc3VsdENhcmRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGxldCBsZW5ndGggPSBpID09IDA/IDM6IDU7XG4gICAgICAgICAgICBpZiAocmVzdWx0Q2FyZHNbaV0ubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2FyZHNzMSA9IGNhcmRzczEua3FfZXhjbHVkZXMocmVzdWx0Q2FyZHNbaV0pO1xuICAgICAgICAgICAgICAgIHdoaWxlKHJlc3VsdENhcmRzW2ldLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRDYXJkc1tpXS5wdXNoKGNhcmRzczEucG9wKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJlc3VsdEFycmF5LnB1c2gocmVzdWx0Q2FyZHMpO1xuXG4gICAgICAgIHZhciBjYXJkc1R5cGVOYW1lcyA9IFtdO1xuICAgICAgICB2YXIgcmVzdWx0QXJyYXlzID0gW107XG5cbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXkubGVuZ3RoO2krKyl7Ly/liKDpmaTnsbvlnovnm7jlkIznmoTnu4TlkIhcbiAgICAgICAgICAgIGxldCBzID0gcmVzdWx0QXJyYXlbaV07XG4gICAgICAgICAgICBsZXQgdHlwZU5hbWUwID0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoc1swXSk7XG4gICAgICAgICAgICB0eXBlTmFtZTAgKz0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoc1sxXSk7XG4gICAgICAgICAgICB0eXBlTmFtZTAgKz0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoc1syXSk7XG4gICAgICAgICAgICBpZihjYXJkc1R5cGVOYW1lcy5pbmRleE9mKHR5cGVOYW1lMCkgPT0gLTEpe1xuICAgICAgICAgICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1swXSk7XG4gICAgICAgICAgICAgICAgbGV0IHpob25nU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHNbMV0pO1xuICAgICAgICAgICAgICAgIGxldCB3ZWlTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1syXSk7XG4gICAgICAgICAgICAgICAgaWYoemhvbmdTY29yZSA+IHRvdVNjb3JlICYmIHpob25nU2NvcmUgPCB3ZWlTY29yZSl7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRzVHlwZU5hbWVzLnB1c2godHlwZU5hbWUwKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0QXJyYXlzLnB1c2gocyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmVzdWx0QXJyYXlzLnNvcnQoZnVuY3Rpb24gKGExLGEyKSB7XG4gICAgICAgICAgICB2YXIgYjAgPSBwYXJzZUludChLUUNhcmQuY2FyZHNUeXBlKGEyWzBdKSApICsgXCJcIjtcbiAgICAgICAgICAgIHZhciBiMSA9IHBhcnNlSW50KEtRQ2FyZC5jYXJkc1R5cGUoYTJbMV0pICkgKyBcIlwiO1xuICAgICAgICAgICAgdmFyIGIyID0gcGFyc2VJbnQoS1FDYXJkLmNhcmRzVHlwZShhMlsyXSkgKSArIFwiXCI7XG5cbiAgICAgICAgICAgIHZhciBzMCA9IHBhcnNlSW50KEtRQ2FyZC5jYXJkc1R5cGUoYTFbMF0pICkgKyBcIlwiO1xuICAgICAgICAgICAgdmFyIHMxID0gcGFyc2VJbnQoS1FDYXJkLmNhcmRzVHlwZShhMVsxXSkgKSArIFwiXCI7XG4gICAgICAgICAgICB2YXIgczIgPSBwYXJzZUludChLUUNhcmQuY2FyZHNUeXBlKGExWzJdKSApICsgXCJcIjtcblxuICAgICAgICAgICAgdmFyIHMgPSBwYXJzZUludChzMiArIHMxICsgczApO1xuICAgICAgICAgICAgdmFyIGIgPSBwYXJzZUludChiMiArIGIxICsgYjApO1xuXG4gICAgICAgICAgICByZXR1cm4gYiAtIHM7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmKHJlc3VsdEFycmF5cy5sZW5ndGggPiA3KXtcbiAgICAgICAgICAgIHJlc3VsdEFycmF5cyA9IHJlc3VsdEFycmF5cy5zbGljZSgwLDcpO1xuICAgICAgICB9XG4gICAgICAgIC8vZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXlzLmxlbmd0aDtpKyspey8v5aaC5p6c5pyJ55u45YWs54mM5YiZ5Yig6ZmkXG4gICAgICAgIC8vICAgIGxldCBzID0gcmVzdWx0QXJyYXlzW2ldO1xuICAgICAgICAvLyAgICBsZXQgdG91U2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHNbMF0pO1xuICAgICAgICAvLyAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1sxXSk7XG4gICAgICAgIC8vICAgIGxldCB3ZWlTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1syXSk7XG4gICAgICAgIC8vICAgIGNjLmxvZyh0b3VTY29yZSx6aG9uZ1Njb3JlLHdlaVNjb3JlKTtcbiAgICAgICAgLy8gICAgaWYod2VpU2NvcmUgPCB0b3VTY29yZSB8fCB3ZWlTY29yZSA8IHpob25nU2NvcmUpe1xuICAgICAgICAvLyAgICAgICAgcmVzdWx0QXJyYXlzLnNwbGljZShpLDEpO1xuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vfVxuICAgICAgICAvL2NjLmxvZyhyZXN1bHRBcnJheXMpXG4gICAgICAgIC8vY2MubG9nKCctLS0tLS0tODk3JylcblxuICAgICAgICAvL2lmKGNjLnRlU2h1UGFpQ2FyZHMpe1xuICAgICAgICAvLyAgICB2YXIgVGVTaHVDYXJkcyA9IGNjLnRlU2h1UGFpQ2FyZHMubWFwKGZ1bmN0aW9uKGNhKXtcbiAgICAgICAgLy8gICAgICAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhKSk7XG4gICAgICAgIC8vICAgIH0pO1xuICAgICAgICAvLyAgICByZXN1bHRBcnJheXMudW5zaGlmdChUZVNodUNhcmRzKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy99XG5cbiAgICAgICAgaWYocmVzdWx0QXJyYXlzLmxlbmd0aCA8PSAwKXtcblxuICAgICAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzLmZvckVhY2goZnVuY3Rpb24oaSl7aWYoaS5zY29yZXMgPT0gMSkgaS5zY29yZXMgPSAxNDt9KTtcblxuICAgICAgICAgICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAodGhpcy5fYWxsQ2FyZE1vZGVzKTtcblxuICAgICAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2FsbENhcmRNb2RlcyA9IEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHModGhpcy5fYWxsQ2FyZE1vZGVzKTtcblxuICAgICAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzID0gY2FyZDIwLmNvbmNhdCh0aGlzLl9hbGxDYXJkTW9kZXMpO1xuXG4gICAgICAgICAgICB2YXIgYXNkZjEgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoMCw1KTtcblxuICAgICAgICAgICAgdmFyIGFzZGYyID0gdGhpcy5fYWxsQ2FyZE1vZGVzLnNsaWNlKDUsMTApO1xuXG4gICAgICAgICAgICB2YXIgYXNkZjMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoMTAsMTMpO1xuXG4gICAgICAgICAgICByZXN1bHRBcnJheXMucHVzaChbYXNkZjMsYXNkZjIsYXNkZjFdKVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMuYXV0b0NhcmRTY3JvbGxWaWV3LnNjcm9sbFRvTGVmdCgpO1xuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCByZXN1bHRBcnJheXMubGVuZ3RoO2krKyl7Ly/mt7vliqDpooTliLbkvZNcbiAgICAgICAgICAgIGxldCBzID0gcmVzdWx0QXJyYXlzW2ldO1xuICAgICAgICAgICAgbGV0IGF1dG9DYXJkID0gY2MuaW5zdGFudGlhdGUodGhpcy5hdXRvQ2FyZCk7XG4gICAgICAgICAgICBhdXRvQ2FyZC55ID0gMDtcbiAgICAgICAgICAgIHNbMF0uZm9yRWFjaChmdW5jdGlvbihpKXtpZiAoaS5wb2ludCA9PSAxNCkgaS5wb2ludCA9IDE7fSlcbiAgICAgICAgICAgIHNbMV0uZm9yRWFjaChmdW5jdGlvbihpKXtpZiAoaS5wb2ludCA9PSAxNCkgaS5wb2ludCA9IDE7fSlcbiAgICAgICAgICAgIHNbMl0uZm9yRWFjaChmdW5jdGlvbihpKXtpZiAoaS5wb2ludCA9PSAxNCkgaS5wb2ludCA9IDE7fSlcbiAgICAgICAgICAgIHZhciBjYXJkc05vZGUgPSBbYXV0b0NhcmQuY2hpbGRyZW5bMV0sYXV0b0NhcmQuY2hpbGRyZW5bM10sYXV0b0NhcmQuY2hpbGRyZW5bMl1dO1xuXG4gICAgICAgICAgICB0aGlzLl9zZXRDYXJkRGFvU3ByaXRlKGNhcmRzTm9kZSxzKTtcblxuICAgICAgICAgICAgYXV0b0NhcmQuY2FyZEFycmF5ID0gcztcbiAgICAgICAgICAgIHZhciBldmVudEhhbmRsZXIgPSBuZXcgY2MuQ29tcG9uZW50LkV2ZW50SGFuZGxlcigpO1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVyLnRhcmdldCA9IHRoaXMubm9kZTtcbiAgICAgICAgICAgIGV2ZW50SGFuZGxlci5jb21wb25lbnQgPSBcIkNhcmRUeXBlQ29tYmluZVwiO1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVyLmhhbmRsZXIgPSBcImNsaWNrQXV0b1NlbGVjdGVkQ2FyZHNcIjtcbiAgICAgICAgICAgIGV2ZW50SGFuZGxlci5jdXN0b21FdmVudERhdGEgPSBpO1xuICAgICAgICAgICAgYXV0b0NhcmQuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuY2xpY2tFdmVudHMucHVzaChldmVudEhhbmRsZXIpO1xuICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLmFkZENoaWxkKGF1dG9DYXJkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9maW5kQ2FyZEluZGV4LmFyciA9IHJlc3VsdEFycmF5cztcblxuICAgICAgICB0aGlzLmF1dG9TZWxlY3RlZENhcmRzT25lKCk7XG4gICAgfSxcblxuICAgIC8vZGFvQ2FuY2VsQWxsOiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gICAgdmFyIG5vZGVzID0gW3RoaXMubGF5b3V0VG91RGFvLm5vZGUsdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLHRoaXMubGF5b3V0V2VpRGFvLm5vZGVdO1xuICAgIC8vICAgIGZvcih2YXIgaSA9IDA7aSA8IG5vZGVzLmxlbmd0aDtpKyspe1xuICAgIC8vICAgICAgICBub2Rlc1tpXS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuICAgIC8vICAgIH1cbiAgICAvL30sXG5cbiAgICBhdXRvU2VsZWN0ZWRDYXJkc09uZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuY2FyZHNMYXlvdXQubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgIHZhciBpbmRleHMgPSAwO1xuXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmF1dG9DYXJkTGF5b3V0Lm5vZGUuY2hpbGRyZW4ubGVuZ3RoO2krKyl7XG5cbiAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXMuYXV0b0NhcmRMYXlvdXQubm9kZS5jaGlsZHJlbltpXTtcblxuICAgICAgICAgICAgbm9kZXMuY2hpbGRyZW5bMF0uYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYXV0b0NhcmRMYXlvdXQubm9kZS5jaGlsZHJlbltpbmRleHNdLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgbGV0IHJlc3VsdEFycmF5ID0gdGhpcy5fZmluZENhcmRJbmRleC5hcnJbaW5kZXhzXTtcblxuICAgICAgICB0aGlzLl9maW5kQ2FyZEluZGV4LmluZGV4cyA9IGluZGV4cztcblxuXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHJlc3VsdEFycmF5Lmxlbmd0aDtpKyspe1xuXG4gICAgICAgICAgICB2YXIgY2FyZE1vZGVzID0gcmVzdWx0QXJyYXlbaV07XG5cbiAgICAgICAgICAgIGNhcmRNb2Rlcy5zb3J0KEtRQ2FyZC5zb3J0KTtcblxuICAgICAgICAgICAgdmFyIG51bSA9IDA7XG4gICAgICAgICAgICBpZihpID09IDEpe1xuICAgICAgICAgICAgICAgIG51bSA9IDM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGkgPT0gMil7XG4gICAgICAgICAgICAgICAgbnVtID0gODtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vY2FyZE1vZGVzLmZvckVhY2goZnVuY3Rpb24oaSl7aWYgKGkucG9pbnQgPT0gMTQpIGkucG9pbnQgPSAxO30pXG4gICAgICAgICAgICBjYXJkTW9kZXMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZE1vZGUsaW5kZXgpIHtcblxuICAgICAgICAgICAgICAgIHZhciBjYXJkTmFtZSA9IGNhcmRNb2RlLmNhcmROYW1lKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbnVtQmVyID0gbnVtK2luZGV4O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGRzMSA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXG5cbiAgICAgICAgICAgICAgICBub2RkczEuYW5jaG9yWSA9IDE7XG5cbiAgICAgICAgICAgICAgICBub2RkczEuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuW251bUJlcl0uYWRkQ2hpbGQobm9kZHMxKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW5bbnVtQmVyXS5jaGlsZHJlblswXS5jYXJkTmFtZSA9IGNhcmROYW1lO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbltudW1CZXJdLmNoaWxkcmVuWzBdLl9jYXJkTW9kZWwgPSBuZXcgS1FDYXJkKGNhcmROYW1lLG51bGwsaW5kZXgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGJ0blNwcml0ZXMgPSAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbltudW1CZXJdLmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbltudW1CZXJdLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gJyc7XG5cbiAgICAgICAgICAgICAgICBidG5TcHJpdGVzLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcblxuICAgICAgICAgICAgICAgIGlmKGNjLm1hUGFpID09IGNhcmROYW1lKXtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZHMgPSBuZXcgY2MuTm9kZSgpOyAvL+WIm+W7uuS4gOS4quiKgueCueWvueixoVxuXG4gICAgICAgICAgICAgICAgICAgIG5vZGRzLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgICAgICAgICAgICAgIGNjLmxvYWRlci5sb2FkUmVzKCdwbGF5L2Rlc2svaW1nX3JlZDVfMScsIGNjLlNwcml0ZUZyYW1lLCBmdW5jdGlvbiAoZXJyLCBzcHJpdGVGcmFtZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7Y2MuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyKTtyZXR1cm47fVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnRuU3ByaXRlMSA9IG5vZGRzLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEubm9kZS53aWR0aCA9IDEwNztcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5ub2RlLmhlaWdodCA9IDE1NTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5ub2RlLnkgPSAtNjUuNTtcblxuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZXMubm9kZS5hZGRDaGlsZChub2Rkcyk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9ICdwdWJsaWMtcGljLWNhcmQtcG9rZXItJysgY2FyZE5hbWU7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxidG5TcHJpdGVzLCA5NSwgMTMwKTtcblxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2xpY2tBdXRvU2VsZWN0ZWRDYXJkcyhudWxsKTtcblxuICAgICAgICAvL3RoaXMuX3NldENhcmREYW9TcHJpdGUoKTtcblxuICAgIH0sXG5cbiAgICBjbGlja0F1dG9TZWxlY3RlZENhcmRzOiBmdW5jdGlvbihldmVudCxpbmRleHMgPSAwKSB7XG5cbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMuYXV0b0NhcmRMYXlvdXQubm9kZS5jaGlsZHJlbi5sZW5ndGg7aSsrKXtcblxuICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLmNoaWxkcmVuW2ldO1xuXG4gICAgICAgICAgICBub2Rlcy5jaGlsZHJlblswXS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLmNoaWxkcmVuW2luZGV4c10uY2hpbGRyZW5bMF0uYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVBva2VyQ2xpY2soKTtcblxuICAgICAgICBpZihldmVudCl7XG4gICAgICAgICAgICB2YXIgcmVzdWx0QXJyYXkgPSBldmVudC50YXJnZXQuY2FyZEFycmF5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICB2YXIgcmVzdWx0QXJyYXkgPSB0aGlzLl9maW5kQ2FyZEluZGV4LmFycltpbmRleHNdO1xuICAgICAgICB9XG4gICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0QXJyYXlbMF0pO1xuICAgICAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0QXJyYXlbMV0pO1xuICAgICAgICBsZXQgd2VpU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHJlc3VsdEFycmF5WzJdKTtcbiAgICAgICAgLy9jYy5sb2codG91U2NvcmUpO1xuICAgICAgICAvL2NjLmxvZyh6aG9uZ1Njb3JlKTtcbiAgICAgICAgLy9jYy5sb2cod2VpU2NvcmUpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCctLS0tLS0tLS0tMTE4MCcpXG4gICAgICAgIHJlc3VsdEFycmF5ID0gcmVzdWx0QXJyYXkubWFwKGZ1bmN0aW9uIChjYXJkTW9kZSl7XG5cbiAgICAgICAgICAgIGNhcmRNb2RlID0gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhjYXJkTW9kZSk7XG5cbiAgICAgICAgICAgIHJldHVybiBjYXJkTW9kZS5tYXAoZnVuY3Rpb24gKGNhcmRNb2Rlcyl7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gY2FyZE1vZGVzLmNhcmROYW1lKCk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXN1bHRBcnJheSlcblxuICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudC5mb3JFYWNoKGZ1bmN0aW9uKG5vZGVzKXtcblxuICAgICAgICAgICAgbm9kZXMuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7XG5cbiAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oaSl7aS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTt9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQgPSBbXTtcblxuICAgICAgICByZXN1bHRBcnJheSA9IHJlc3VsdEFycmF5WzBdLmNvbmNhdChyZXN1bHRBcnJheVsxXSkuY29uY2F0KHJlc3VsdEFycmF5WzJdKTtcblxuICAgICAgICB2YXIgY2FyZEFsbE5vZGUgPSB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaTt9KTtcblxuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCByZXN1bHRBcnJheS5sZW5ndGg7aSsrKXtcblxuICAgICAgICAgICAgdmFyIHMgPSByZXN1bHRBcnJheVtpXTtcblxuICAgICAgICAgICAgZm9yKHZhciBqID0gMDtqIDwgY2FyZEFsbE5vZGUubGVuZ3RoO2orKyl7XG5cbiAgICAgICAgICAgICAgICB2YXIgZCA9IGNhcmRBbGxOb2RlW2pdO1xuXG4gICAgICAgICAgICAgICAgZC5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGlmKGQuY2hpbGRyZW5bMF0uY2FyZE5hbWUgPT0gcyl7XG5cbiAgICAgICAgICAgICAgICAgICAgZC5zdG9wQWxsQWN0aW9ucygpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXRhaWwgPSB0aGlzLmNoYW5nZU5vZGVTcGFjZUFSW2ldO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjYWxsID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24obm9kZXMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0Q2FyZERhb1Nwcml0ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgdGhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZC5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2MubW92ZVRvKHRoaXMuY2FyZFRpbWUsZGV0YWlsKSwgY2FsbCkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhcmRBbGxOb2RlLnNwbGljZShqLDEpXG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICB9LFxuXG4gICAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uKFNwcml0ZUZyYW1lLCBwYXRoLCBTcHJpdGVzTm9kZSwgdywgaCkge1xuXG4gICAgICAgIHZhciBTcHJpdGUgPSBTcHJpdGVGcmFtZS5nZXRTcHJpdGVGcmFtZSggcGF0aCApO1xuXG4gICAgICAgIFNwcml0ZXNOb2RlLnNwcml0ZUZyYW1lID0gU3ByaXRlO1xuXG4gICAgICAgIGlmKHcpIFNwcml0ZXNOb2RlLm5vZGUud2lkdGggPSB3O1xuXG4gICAgICAgIGlmKGgpIFNwcml0ZXNOb2RlLm5vZGUuaGVpZ2h0ID0gaDtcbiAgICB9LFxuXG4gICAgc3RpY2tPdXRGaW5kQ2FyZFR5cGUxOiBmdW5jdGlvbiAoY2FyZHMsaW5kZXggPSAwKSB7XG4gICAgICAgIC8vLy8g5bCG5bey5pyJ55qE56qB5Ye655qE54mM55qE5L2N572u6YeN572u5Zue5Yid5aeL5L2N572uXG4gICAgICAgIC8vdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xuICAgICAgICAvL2xldCBzZWxlY3RlZENhcmROYW1lcyA9IGNhcmRzLm1hcChmdW5jdGlvbihjYXJkTW9kZWwpe1xuICAgICAgICAvLyAgICByZXR1cm4gY2FyZE1vZGVsLmNhcmROYW1lKCk7XG4gICAgICAgIC8vfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLmZpbHRlcihmdW5jdGlvbiAoY2FyZE5vZGUpIHtcbiAgICAgICAgLy8gICAgbGV0IGNhcmRQcmVmYWIgPSBjYXJkTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgLy8gICAgaWYoc2VsZWN0ZWRDYXJkTmFtZXMuaW5jbHVkZXMoY2FyZFByZWZhYi5jYXJkTmFtZSgpKSkge1xuICAgICAgICAvLyAgICAgICAgdmFyIG5hbWVJbmRleCA9IHNlbGVjdGVkQ2FyZE5hbWVzLmluZGV4T2YoY2FyZFByZWZhYi5jYXJkTmFtZSgpKTtcbiAgICAgICAgLy8gICAgICAgIHNlbGVjdGVkQ2FyZE5hbWVzLnNwbGljZShuYW1lSW5kZXgsMSk7XG4gICAgICAgIC8vICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvLyAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIC8vfSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vY2MubG9nKCctLS0tLS0tNjk2JylcbiAgICAgICAgLy90aGlzLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcbiAgICAgICAgLy9pZihpbmRleCA9PSAxKXtcbiAgICAgICAgLy8gICAgdGhpcy5fYWRkRGFvQ2FyZFRvTGF5b3V0KHRoaXMubGF5b3V0VG91RGFvLm5vZGUsIDMpO1xuICAgICAgICAvL31cbiAgICAgICAgLy9lbHNlIGlmKGluZGV4ID09IDIpe1xuICAgICAgICAvLyAgICB0aGlzLl9hZGREYW9DYXJkVG9MYXlvdXQodGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKTtcbiAgICAgICAgLy99XG4gICAgICAgIC8vZWxzZSBpZihpbmRleCA9PSAzKXtcbiAgICAgICAgLy8gICAgdGhpcy5fYWRkRGFvQ2FyZFRvTGF5b3V0KHRoaXMubGF5b3V0V2VpRGFvLm5vZGUpO1xuICAgICAgICAvL31cblxuICAgIH0sXG5cbiAgICBfdG91Y2hDYXJkTGF5b3V0OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy9ldmVudC5idWJibGVzID0gdHJ1ZTtcbiAgICAgICAgLy9sZXQgbG9jYXRpb24gPSBldmVudC5nZXRMb2NhdGlvbigpO1xuICAgICAgICAvL2xldCBjYXJkUHJlZmFiID0gdGhpcy5fY2FyZFByZWZhYkluQ2FyZExheW91dFdpdGhMb2NhdGlvbihsb2NhdGlvbik7XG4gICAgICAgIC8vaWYgKGNhcmRQcmVmYWIpIHtcbiAgICAgICAgLy8gICAgY2FyZFByZWZhYi5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKS5zZXRTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgLy8gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIC8vfVxuICAgIH0sXG5cbiAgICBfdG91Y2hDYXJkTGF5b3V0RW5kOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy90aGlzLl9jaGFuZ2VTZWxlY3RlZENhcmRQcmVmYWJzWSgpO1xuICAgICAgICAvL3RoaXMuX2Rpc2VjbGVjdENhcmRQcmVmYWJzKCk7XG4gICAgfSxcblxuICAgIF9jYXJkUHJlZmFiSW5DYXJkTGF5b3V0V2l0aExvY2F0aW9uOiBmdW5jdGlvbiAobG9jYXRpb24pIHtcbiAgICAgICAgLy9sb2NhdGlvbiA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jb252ZXJ0VG9Ob2RlU3BhY2VBUihsb2NhdGlvbik7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5zb3J0KGZ1bmN0aW9uIChjYXJkTm9kZTEsIGNhcmROb2RlMikge1xuICAgICAgICAvLyAgICBsZXQgcmVjdDEgPSBjYXJkTm9kZTEuZ2V0Qm91bmRpbmdCb3goKTtcbiAgICAgICAgLy8gICAgbGV0IHJlY3QyID0gY2FyZE5vZGUyLmdldEJvdW5kaW5nQm94KCk7XG4gICAgICAgIC8vICAgIHJldHVybiByZWN0Mi54IC0gcmVjdDEueDtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy9mb3IgKGxldCBpbmRleCBpbiBjYXJkTm9kZXMpIHtcbiAgICAgICAgLy8gICAgbGV0IGNhcmROb2RlID0gY2FyZE5vZGVzW2luZGV4XTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgbGV0IHJlY3QgPSBjYXJkTm9kZS5nZXRCb3VuZGluZ0JveCgpO1xuICAgICAgICAvL1xuICAgICAgICAvLyAgICBpZiAoY2MucmVjdENvbnRhaW5zUG9pbnQocmVjdCwgbG9jYXRpb24pKSB7XG4gICAgICAgIC8vICAgICAgICByZXR1cm4gY2FyZE5vZGU7XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy99XG4gICAgICAgIC8vXG4gICAgICAgIC8vcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9jaGFuZ2VTZWxlY3RlZENhcmRQcmVmYWJzWTogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLl9zZWxlY3RlZENhcmRQcmVmYWJzKCk7XG4gICAgICAgIC8vdGhpcy5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlQb2tlckNsaWNrKCk7XG4gICAgfSxcblxuICAgIF9jaGFuZ2VDYXJkUHJlZmFic1k6IGZ1bmN0aW9uIChjYXJkTm9kZXMpIHtcbiAgICAgICAgLy9jYXJkTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZE5vZGUpIHtcbiAgICAgICAgLy8gICAgbGV0IHkgPSBjYXJkTm9kZS5nZXRQb3NpdGlvblkoKTtcbiAgICAgICAgLy8gICAgaWYgKHkgPT0gdGhpcy5fY2FyZE9mZnNldFkpIHtcbiAgICAgICAgLy8gICAgICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSArIDU1KTtcbiAgICAgICAgLy8gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gICAgICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSk7XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy99LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBfc2VsZWN0ZWRDYXJkUHJlZmFiczogZnVuY3Rpb24gKGluY2x1ZGVTdGlja091dCA9IGZhbHNlKSB7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgLy9yZXR1cm4gY2FyZE5vZGVzLmZpbHRlcihmdW5jdGlvbiAoY2FyZE5vZGUpIHtcbiAgICAgICAgLy8gICAgbGV0IGNhcmRQcmVmYWIgPSBjYXJkTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgLy8gICAgbGV0IGlzU2VsZWN0ZWQgPSBjYXJkUHJlZmFiLmlzU2VsZWN0ZWQoKTtcbiAgICAgICAgLy8gICAgaWYgKCFpc1NlbGVjdGVkICYmIGluY2x1ZGVTdGlja091dCkge1xuICAgICAgICAvLyAgICAgICAgaXNTZWxlY3RlZCA9IGNhcmROb2RlLmdldFBvc2l0aW9uWSgpID4gMTA7XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgcmV0dXJuIGlzU2VsZWN0ZWQ7XG4gICAgICAgIC8vfSk7XG4gICAgfSxcblxuICAgIF9kaXNlY2xlY3RDYXJkUHJlZmFiczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW47XG4gICAgICAgIC8vY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgLy8gICAgbm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKS5zZXRTZWxlY3RlZChmYWxzZSk7XG4gICAgICAgIC8vfSk7XG4gICAgfSxcblxuICAgIC8vIOmHjee9riBjYXJkcyDnmoQgWFxuICAgIF9yZXNldENhcmRzUG9zaXRpb25YOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vbGV0IGludGVydmFsID0gOTg7XG4gICAgICAgIC8vbGV0IGludGVydmFsID0gNzg7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgLy9sZXQgbGVuZ3RoID0gY2FyZE5vZGVzLmxlbmd0aDtcbiAgICAgICAgLy9pZiAobGVuZ3RoID09IDApIHtcbiAgICAgICAgLy8gICAgcmV0dXJuO1xuICAgICAgICAvL31cbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgbWlkZGxlSW5kZXggPSBsZW5ndGggLyAyO1xuICAgICAgICAvL2xldCBjYXJkV2lkdGggPSAxNTQ7XG4gICAgICAgIC8vXG4gICAgICAgIC8vXG4gICAgICAgIC8vLy90aGlzLmNhcmRzTGF5b3V0U29ydCgpO1xuICAgICAgICAvL2lmKHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPT0gdHJ1ZSl7XG4gICAgICAgIC8vICAgIHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgLy8gICAgICAgIGxldCBjb21wb25lbnQxID0gbjEuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vICAgICAgICBsZXQgY29tcG9uZW50MiA9IG4yLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAvLyAgICAgICAgcmV0dXJuIGNvbXBvbmVudDIuY2FyZE1vZGUoKS5jb2xvciAtIGNvbXBvbmVudDEuY2FyZE1vZGUoKS5jb2xvcjtcbiAgICAgICAgLy8gICAgfSk7XG4gICAgICAgIC8vfWVsc2V7XG4gICAgICAgIC8vICAgIHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgLy8gICAgICAgIGxldCBjb21wb25lbnQxID0gbjEuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vICAgICAgICBsZXQgY29tcG9uZW50MiA9IG4yLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAvLyAgICAgICAgcmV0dXJuIGNvbXBvbmVudDEuY2FyZE1vZGUoKS5zb3J0KGNvbXBvbmVudDIuY2FyZE1vZGUoKSk7XG4gICAgICAgIC8vICAgIH0pO1xuICAgICAgICAvL31cbiAgICAgICAgLy8vL2NhcmROb2Rlcy5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgLy8vLyAgICBsZXQgY29tcG9uZW50MSA9IG4xLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAvLy8vICAgIGxldCBjb21wb25lbnQyID0gbjIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vLy9cbiAgICAgICAgLy8vLyAgICByZXR1cm4gY29tcG9uZW50MS5jYXJkTW9kZSgpLnNvcnQoY29tcG9uZW50Mi5jYXJkTW9kZSgpKTtcbiAgICAgICAgLy8vL30pO1xuICAgICAgICAvL1xuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSwgaW5kZXgpIHtcbiAgICAgICAgLy8gICAgY2FyZE5vZGUuekluZGV4ID0gaW5kZXg7XG4gICAgICAgIC8vICAgIGxldCB4ID0gKGluZGV4IC0gbWlkZGxlSW5kZXgpICogaW50ZXJ2YWwgKyBjYXJkV2lkdGggLyAzO1xuICAgICAgICAvLyAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblgoeCk7XG4gICAgICAgIC8vfSk7XG4gICAgfSxcblxuICAgIC8vIOmHjee9riBjYXJkcyDnmoQgWOS4ujBcbiAgICByZXNldENhcmRzUG9zaXRpb25YMTogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4gfHwgW107XG4gICAgICAgIC8vbGV0IGxlbmd0aCA9IGNhcmROb2Rlcy5sZW5ndGg7XG4gICAgICAgIC8vaWYgKGxlbmd0aCA9PSAwKSB7XG4gICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgLy99XG4gICAgICAgIC8vY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgIC8vICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSgwKTtcbiAgICAgICAgLy99KTtcbiAgICB9LFxuXG4gICAgX3Jlc2V0Q2FyZHNQb3NpdGlvblk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xuICAgICAgICAvLyAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblkodGhpcy5fY2FyZE9mZnNldFkpO1xuICAgICAgICAvL30uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIC8vIOWktOOAgeS4reOAgeWwvumBkyBsYXlvdXQg55qE54K55Ye75LqL5Lu2XG4gICAgX3JlZ2lzdGVyRGFvc0xheW91dENsaWNrRXZlbnQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB0aGlzLmNoYW5nZU5vZGVTcGFjZUFSID0gW107Ly/orrDlvZXmiYDmnInniYznmoTlnZDmoIdcbiAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG5vZGVzKXtcbiAgICAgICAgICAgIC8v6I635Y+W6IqC54K555qE5LiW55WM5Z2Q5qCHXG4gICAgICAgICAgICB2YXIgY2FyZEJhY2tXb3JsZFNwYWNlMSA9IG5vZGVzLmNvbnZlcnRUb1dvcmxkU3BhY2VBUihjYy52MigwLCAwKSk7XG4gICAgICAgICAgICAvL+iOt+WPluebuOWvueeItuiKgueCueaJgOWcqOeahOWdkOagh1xuICAgICAgICAgICAgdmFyIGRldGFpbCA9IG5vZGVzLnBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UxKTtcblxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VOb2RlU3BhY2VBUi5wdXNoKGRldGFpbCk7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tBbGxDYXJkOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlQb2tlckNsaWNrKCk7XG4gICAgICAgIGlmKHRoaXMuTGF5b3V0V2l0aEV2ZW50Lmxlbmd0aCA8PSAxKXtcbiAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50LnB1c2goZXZlbnQudGFyZ2V0KTtcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC5jb2xvciA9IG5ldyBjYy5Db2xvcigxODIsIDE4MiwgMTgyKTtcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGkpe2kuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTgyLCAxODIsIDE4Mik7fSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYodGhpcy5MYXlvdXRXaXRoRXZlbnQubGVuZ3RoID09IDIpe1xuXG4gICAgICAgICAgICB2YXIgYXJyID0gW107XG5cbiAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50LmZvckVhY2goZnVuY3Rpb24obm9kZXMpe1xuICAgICAgICAgICAgICAgIC8v6I635Y+W6IqC54K555qE5LiW55WM5Z2Q5qCHXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRCYWNrV29ybGRTcGFjZTEgPSBub2Rlcy5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoMCwgMCkpO1xuICAgICAgICAgICAgICAgIC8v6I635Y+W55u45a+554i26IqC54K55omA5Zyo55qE5Z2Q5qCHXG4gICAgICAgICAgICAgICAgdmFyIGRldGFpbCA9IG5vZGVzLnBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UxKTtcblxuICAgICAgICAgICAgICAgIGFyci51bnNoaWZ0KGRldGFpbCk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50LmZvckVhY2goZnVuY3Rpb24obm9kZXMsaW5kZXgpe1xuXG4gICAgICAgICAgICAgICAgbm9kZXMuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7XG5cbiAgICAgICAgICAgICAgICBub2Rlcy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGkpe2kuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7fSk7XG5cbiAgICAgICAgICAgICAgICBub2Rlcy5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICBub2Rlcy5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldENhcmREYW9TcHJpdGUoKTtcblxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgdGhpcy5jYXJkVGltZSk7XG5cbiAgICAgICAgICAgICAgICBub2Rlcy5zdG9wQWxsQWN0aW9ucygpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRldGFpbCA9IGFycltpbmRleF07XG5cbiAgICAgICAgICAgICAgICBub2Rlcy5ydW5BY3Rpb24oY2MubW92ZVRvKHRoaXMuY2FyZFRpbWUsZGV0YWlsKSk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50ID0gW107XG5cbiAgICAgICAgfVxuXG4gICAgfSxcblxuICAgIF9zZXRDYXJkRGFvU3ByaXRlOiBmdW5jdGlvbiAobm9kZXMgPSBudWxsICxjYXJkcyA9IG51bGwpIHtcblxuICAgICAgICBpZighbm9kZXMpe1xuXG4gICAgICAgICAgICB0aGlzLmNhcmRBbGxzID0gIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBiLnkgLSBhLnk7fSkubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBpLmNoaWxkcmVuWzBdO30pO1xuXG4gICAgICAgICAgICBjYXJkcyA9IFt0aGlzLl90YW9EYW9DYXJkTW9kZXMoKSx0aGlzLl96aG9uZ0Rhb0NhcmRNb2RlcygpLHRoaXMuX3dlaURhb0NhcmRNb2RlcygpXTtcblxuICAgICAgICAgICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtjYXJkLmZvckVhY2goZnVuY3Rpb24oaSl7aWYgKGkuc2NvcmVzID09IDE0KXtpLnNjb3JlcyA9IDE7fX0pO30pO1xuXG4gICAgICAgICAgICBub2RlcyA9IFt0aGlzLnRvdURhb05vZGUsdGhpcy56aG9uZ0Rhb05vZGUsdGhpcy53ZWlEYW9Ob2RlXTtcblxuICAgICAgICB9XG5cbiAgICAgICAgLy/lpLTpgZNcbiAgICAgICAgbGV0IHR5cGVOYW1lMCA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHNbMF0pKzE7XG5cbiAgICAgICAgdHlwZU5hbWUwID0gdHlwZU5hbWUwPj0xMCA/IHR5cGVOYW1lMCA6XCIwXCIrdHlwZU5hbWUwO1xuXG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD09JzA0JyA/ICcxMScgOnR5cGVOYW1lMDtcblxuICAgICAgICB2YXIgcGF0aCA9ICdnYW1lX3Bva2VyX3R5cGUnKyB0eXBlTmFtZTA7XG5cbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZSh0aGlzLmRhb1Nwcml0ZUF0bGFzLCBwYXRoICxub2Rlc1swXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKSk7XG5cbiAgICAgICAgLy/kuK3pgZNcbiAgICAgICAgbGV0IHR5cGVOYW1lMSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHNbMV0pKzE7XG5cbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPj0xMCA/IHR5cGVOYW1lMSA6XCIwXCIrdHlwZU5hbWUxO1xuXG4gICAgICAgIHR5cGVOYW1lMSA9IHR5cGVOYW1lMT09JzA3JyA/ICcyMicgOnR5cGVOYW1lMTtcblxuICAgICAgICBwYXRoID0gJ2dhbWVfcG9rZXJfdHlwZScrIHR5cGVOYW1lMTtcblxuICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuZGFvU3ByaXRlQXRsYXMsIHBhdGggLG5vZGVzWzFdLmdldENvbXBvbmVudChjYy5TcHJpdGUpKTtcblxuICAgICAgICAvL+WwvumBk1xuICAgICAgICBsZXQgdHlwZU5hbWUyID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkc1syXSkrMTtcblxuICAgICAgICB0eXBlTmFtZTIgPSB0eXBlTmFtZTI+PTEwID8gdHlwZU5hbWUyIDpcIjBcIit0eXBlTmFtZTI7XG5cbiAgICAgICAgcGF0aCA9ICdnYW1lX3Bva2VyX3R5cGUnKyB0eXBlTmFtZTI7XG5cbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZSh0aGlzLmRhb1Nwcml0ZUF0bGFzLCBwYXRoICxub2Rlc1syXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKSk7XG5cbiAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG4pe24uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBcIlwiO30pO1xuXG4gICAgICAgIGlmKGNhcmRzKXtcblxuICAgICAgICAgICAgaWYodHlwZU5hbWUwKSBLUUNhcmQuX3NldEd1aUNhcmQoMCwgMCwgMywgdHlwZU5hbWUwLCBjYXJkcywgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbiwgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xuXG4gICAgICAgICAgICBpZih0eXBlTmFtZTEpIEtRQ2FyZC5fc2V0R3VpQ2FyZCgxLCAzLCA4LCB0eXBlTmFtZTEsIGNhcmRzLCB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG5cbiAgICAgICAgICAgIGlmKHR5cGVOYW1lMikgS1FDYXJkLl9zZXRHdWlDYXJkKDIsIDgsIDEzLCB0eXBlTmFtZTIsIGNhcmRzLCB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG5cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfY2xpY2tUb3VEYW9MYXlvdXQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLl9kYW9DYXJkTm9kZUluTGF5b3V0V2l0aEV2ZW50KHRoaXMubGF5b3V0VG91RGFvLm5vZGUsIGV2ZW50KTtcbiAgICB9LFxuXG4gICAgX2NsaWNrWmhvbmdEYW9MYXlvdXQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLl9kYW9DYXJkTm9kZUluTGF5b3V0V2l0aEV2ZW50KHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZSwgZXZlbnQpO1xuICAgIH0sXG5cbiAgICBfY2xpY2tXZWlEYW9MYXlvdXQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLl9kYW9DYXJkTm9kZUluTGF5b3V0V2l0aEV2ZW50KHRoaXMubGF5b3V0V2VpRGFvLm5vZGUsIGV2ZW50KTtcbiAgICB9LFxuXG4gICAgX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQ6IGZ1bmN0aW9uIChub2RlLCBldmVudCkge1xuICAgICAgICBsZXQgY2FyZE5vZGVzID0gbm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgdmFyIGxvY2F0aW9uID0gZXZlbnQuZ2V0TG9jYXRpb24oKTtcbiAgICAgICAgbG9jYXRpb24gPSBub2RlLmNvbnZlcnRUb05vZGVTcGFjZUFSKGxvY2F0aW9uKTtcbiAgICAgICAgLy92YXIgY2FyZEJhY2tXb3JsZFNwYWNlID0gdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLmNvbnZlcnRUb1dvcmxkU3BhY2VBUihjYy52MigwLCAwKSk7XG4gICAgICAgIC8vLy/ojrflj5boioLngrnnmoTkuJbnlYzlnZDmoIdcbiAgICAgICAgLy92YXIgZGV0YWlsID0gdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLnBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UpO1xuICAgICAgICAvLy8v6I635Y+W55u45a+554i26IqC54K55omA5Zyo55qE5Z2Q5qCHXG4gICAgICAgIC8vdGhpcy5sYXlvdXRXZWlEYW8ubm9kZS5ydW5BY3Rpb24oY2MubW92ZVRvKDEsZGV0YWlsKSk7XG4gICAgICAgIGZvciAobGV0IGluZGV4IGluIGNhcmROb2Rlcykge1xuICAgICAgICAgICAgbGV0IGNhcmROb2RlID0gY2FyZE5vZGVzW2luZGV4XTtcbiAgICAgICAgICAgIGxldCByZWN0ID0gY2FyZE5vZGUuZ2V0Qm91bmRpbmdCb3goKTtcbiAgICAgICAgICAgIGlmIChjYy5yZWN0Q29udGFpbnNQb2ludChyZWN0LCBsb2NhdGlvbikpIHtcbiAgICAgICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVBva2VyQ2xpY2soKTtcbiAgICAgICAgICAgICAgICBsZXQgYXJycyA9IFtub2RlICxjYXJkTm9kZV07XG4gICAgICAgICAgICAgICAgaWYodGhpcy5MYXlvdXRXaXRoRXZlbnQubGVuZ3RoID09IDEpe1xuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLkxheW91dFdpdGhFdmVudFswXVswXS5uYW1lICE9IG5vZGUubmFtZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkTm9kZS5vcGFjaXR5ID0gMjAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQucHVzaChhcnJzKTtcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudFswXVsxXS5vcGFjaXR5ID0gMjU1O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMuTGF5b3V0V2l0aEV2ZW50Lmxlbmd0aCA9PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgLy9jYy5sb2coY2FyZE5vZGUpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50LnB1c2goYXJycyk7XG4gICAgICAgICAgICAgICAgICAgIGNhcmROb2RlLm9wYWNpdHkgPSAyMDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKHRoaXMuTGF5b3V0V2l0aEV2ZW50Lmxlbmd0aCA9PSAyKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUxID0gdGhpcy5MYXlvdXRXaXRoRXZlbnRbMF1bMV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlMiA9IHRoaXMuTGF5b3V0V2l0aEV2ZW50WzFdWzFdO1xuICAgICAgICAgICAgICAgICAgICAvL+iOt+WPluiKgueCueeahOS4lueVjOWdkOagh1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZEJhY2tXb3JsZFNwYWNlID0gbm9kZTEuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLnYyKDAsIDApKTtcbiAgICAgICAgICAgICAgICAgICAgLy/ojrflj5bnm7jlr7nniLboioLngrnmiYDlnKjnmoTlnZDmoIdcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRldGFpbCA9IG5vZGUxLnBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UpO1xuICAgICAgICAgICAgICAgICAgICBub2RlMi5ydW5BY3Rpb24oY2MubW92ZVRvKDEsZGV0YWlsKSk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9yZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX2FkZERhb0NhcmRUb0xheW91dDogZnVuY3Rpb24gKG5vZGUsIG1heE51bWJlckNhcmQgPSA1KSB7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IG5vZGUuY2hpbGRyZW4gfHwgW107XG4gICAgICAgIC8vaWYgKGNhcmROb2Rlcy5sZW5ndGggPj0gNSkge1xuICAgICAgICAvLyAgICByZXR1cm47XG4gICAgICAgIC8vfVxuICAgICAgICAvL2xldCByZW1haW5Db3VudCA9IG1heE51bWJlckNhcmQgLSBjYXJkTm9kZXMubGVuZ3RoO1xuICAgICAgICAvL1xuICAgICAgICAvL3ZhciBzZWxlY3RlZENhcmRzID0gdGhpcy5fc2VsZWN0ZWRDYXJkUHJlZmFicyh0cnVlKSB8fCBbXTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9pZiAoc2VsZWN0ZWRDYXJkcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAvLyAgICByZXR1cm47XG4gICAgICAgIC8vfVxuICAgICAgICAvL2lmIChzZWxlY3RlZENhcmRzLmxlbmd0aCA+IHJlbWFpbkNvdW50KSB7XG4gICAgICAgIC8vICAgIHNlbGVjdGVkQ2FyZHMgPSBzZWxlY3RlZENhcmRzLnNsaWNlKDAsIHJlbWFpbkNvdW50KTtcbiAgICAgICAgLy99XG4gICAgICAgIC8vXG4gICAgICAgIC8vbGV0IHNlbGVjdGVkQ2FyZE5hbWVzID0gc2VsZWN0ZWRDYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmRQcmVmYWIpIHtcbiAgICAgICAgLy8gICAgcmV0dXJuIGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuY2FyZE5hbWUoKTtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9jYXJkTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZFR5cGVOb2RlKSB7XG4gICAgICAgIC8vICAgIHNlbGVjdGVkQ2FyZE5hbWVzLnB1c2goY2FyZFR5cGVOb2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVTcHJpdGUnKS5jYXJkTmFtZSgpKTtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgY2FyZE1vZGVzID0gc2VsZWN0ZWRDYXJkTmFtZXMubWFwKGZ1bmN0aW9uIChjYXJkTmFtZSxpbmRleCkge1xuICAgICAgICAvLyAgICByZXR1cm4gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICAgICAgLy99KS5zb3J0KGZ1bmN0aW9uIChjMSwgYzIpIHtcbiAgICAgICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5zb3J0KGMxLCBjMiwgZmFsc2UpO1xuICAgICAgICAvL30pO1xuXG4gICAgICAgIC8vbGV0IHRvdUNhcmRNb2RlcyA9IChub2RlID09IHRoaXMubGF5b3V0VG91RGFvLm5vZGUpID8gY2FyZE1vZGVzIDogdGhpcy5fdGFvRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIC8vbGV0IHpob25nQ2FyZE1vZGVzID0gKG5vZGUgPT0gdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKSA/IGNhcmRNb2RlcyA6IHRoaXMuX3pob25nRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIC8vbGV0IHdlaUNhcmRNb2RlcyA9IChub2RlID09IHRoaXMubGF5b3V0V2VpRGFvLm5vZGUpID8gY2FyZE1vZGVzIDogdGhpcy5fd2VpRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIC8vaWYgKCF0aGlzLl9pc1ZhbGlkQ2FyZE1vZGVzKHRvdUNhcmRNb2RlcywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2RlcykpIHtcbiAgICAgICAgLy8gICAgdGhpcy5jYWNsZUF1dG9TZWxlY3RlZENhcmRzMSgpO1xuICAgICAgICAvLyAgICBjYy5sb2coJ+ebuOWFrOeJjO+8muiHquWKqOmAieaLqeeJjCcpXG4gICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgLy99XG4gICAgICAgIC8vXG4gICAgICAgIC8vbm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuICAgICAgICAvL1xuICAgICAgICAvL2NhcmRNb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTW9kZSxpbmRleCkge1xuICAgICAgICAvLyAgICBsZXQgY2FyZE5hbWUgPSBjYXJkTW9kZS5jYXJkTmFtZSgpO1xuICAgICAgICAvLyAgICBsZXQgY2FyZFR5cGVTcHJpdGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmNhcmRUeXBlUHJlZmFiKTtcbiAgICAgICAgLy8gICAgY2FyZFR5cGVTcHJpdGUubmFtZXMgPSBjYXJkTmFtZSsnKycraW5kZXg7XG4gICAgICAgIC8vICAgIGNhcmRUeXBlU3ByaXRlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVTcHJpdGUnKS5zZXRDYXJkKGNhcmROYW1lLGluZGV4KTtcbiAgICAgICAgLy8gICAgbm9kZS5hZGRDaGlsZChjYXJkVHlwZVNwcml0ZSk7XG4gICAgICAgIC8vfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9cbiAgICAgICAgLy9zZWxlY3RlZENhcmRzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgLy8gICAgbm9kZS5yZW1vdmVGcm9tUGFyZW50KCk7XG4gICAgICAgIC8vfSk7XG4gICAgICAgIC8vdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xuICAgICAgICAvL3RoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy90aGlzLl9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9ucygpO1xuICAgICAgICAvL1xuICAgICAgICAvL3RoaXMuX3JlbG9hZEtRQ2FyZE1vZGVzSW5uZXIoKTtcbiAgICAgICAgLy90aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscygpO1xuICAgIH0sXG5cbiAgICAvLyDliKDpmaQg5aS044CB5Lit5oiW5bC+6YGT5Lit55qE5p+Q5Lit54mMXG4gICAgX2RlbGV0ZURhb0NhcmQ6IGZ1bmN0aW9uIChjYXJkVHlwZU5vZGUsIHJlbG9hZFR5cGVCdXR0b25FbmFibGVzID0gZmFsc2UpIHtcbiAgICAgICAgLy9sZXQgY2FyZE5hbWUgPSBjYXJkVHlwZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLmNhcmROYW1lKCk7XG4gICAgICAgIC8vdGhpcy5hZGRDYXJkKGNhcmROYW1lLCB0cnVlKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy90aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vY2FyZFR5cGVOb2RlLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbnMoKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9pZiAocmVsb2FkVHlwZUJ1dHRvbkVuYWJsZXMpIHtcbiAgICAgICAgLy8gICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICAvLyAgICB0aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscygpO1xuICAgICAgICAvL31cbiAgICB9LFxuXG4gICAgLy8g5Yig6ZmkIOWktOmBk+aIluS4remBk+aIluWwvumBk+S4iuaJgOacieeahCDniYxcbiAgICBfZGVsZXRlRGFvQ2FyZHNPZkxheW91dDogZnVuY3Rpb24gKGRhb0xheW91dCkge1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSBBcnJheS5mcm9tKGRhb0xheW91dC5jaGlsZHJlbik7XG4gICAgICAgIC8vY2FyZE5vZGVzLmZvckVhY2godGhpcy5fZGVsZXRlRGFvQ2FyZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy90aGlzLl9yZWxvYWRLUUNhcmRNb2Rlc0lubmVyKCk7XG4gICAgICAgIC8vdGhpcy5fcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHMoKTtcbiAgICB9LFxuXG4gICAgLy8g5Yik5pat6IO95ZCm5L2/55So6YCJ5oup5Lit55qE54mMXG4gICAgLy8g5Y2z77ya5aS06YGT6KaB5bCP5LqO5Lit6YGT44CB5Lit6YGT6KaB5bCP5LqO5bC+6YGTXG4gICAgX2lzVmFsaWRDYXJkTW9kZXM6IGZ1bmN0aW9uICh0b3VDYXJkTW9kZXMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXMpIHtcbiAgICAgICAgdG91Q2FyZE1vZGVzID0gdG91Q2FyZE1vZGVzIHx8IFtdO1xuICAgICAgICB6aG9uZ0NhcmRNb2RlcyA9IHpob25nQ2FyZE1vZGVzIHx8IFtdO1xuICAgICAgICB3ZWlDYXJkTW9kZXMgPSB3ZWlDYXJkTW9kZXMgfHwgW107XG4gICAgICAgIGlmICh0b3VDYXJkTW9kZXMubGVuZ3RoIDwgMyB8fCB6aG9uZ0NhcmRNb2Rlcy5sZW5ndGggPCA1IHx8IHdlaUNhcmRNb2Rlcy5sZW5ndGggPCA1KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHModG91Q2FyZE1vZGVzKTtcbiAgICAgICAgbGV0IHpob25nU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHpob25nQ2FyZE1vZGVzKTtcbiAgICAgICAgbGV0IHdlaVNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyh3ZWlDYXJkTW9kZXMpO1xuICAgICAgICByZXR1cm4gKHRvdVNjb3JlIDwgemhvbmdTY29yZSkgJiYgKHpob25nU2NvcmUgPD0gd2VpU2NvcmUpO1xuICAgIH0sXG5cbiAgICAvLyDlpLTpgZPkuIrlt7LmnInnmoTniYxcbiAgICBfdGFvRGFvQ2FyZE1vZGVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMuY2FyZEFsbHMuc2xpY2UoMCwzKSk7XG4gICAgfSxcblxuICAgIC8vIOS4remBk+S4iuW3suacieeahOeJjFxuICAgIF96aG9uZ0Rhb0NhcmRNb2RlczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3JldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZS5jaGlsZHJlbik7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMuY2FyZEFsbHMuc2xpY2UoMyw4KSk7XG4gICAgfSxcblxuICAgIC8vIOWwvumBk+S4iuW3suacieeahOeJjFxuICAgIF93ZWlEYW9DYXJkTW9kZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9yZXR1cm4gdGhpcy5fY2FyZE1vZGVzT2ZDYXJkUHJlZmFicyh0aGlzLmxheW91dFdlaURhby5ub2RlLmNoaWxkcmVuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmRNb2Rlc09mQ2FyZFByZWZhYnModGhpcy5jYXJkQWxscy5zbGljZSg4LDEzKSk7XG4gICAgfSxcblxuICAgIF9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzOiBmdW5jdGlvbiAoY2FyZFR5cGVOb2Rlcykge1xuICAgICAgICBpZiAoIWNhcmRUeXBlTm9kZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjYXJkTW9kZXMgPSBjYXJkVHlwZU5vZGVzLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgLy9sZXQgY29tcG9uZW50ID0gbm9kZS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlU3ByaXRlJyk7XG4gICAgICAgICAgICAvL3JldHVybiBjb21wb25lbnQuY2FyZE1vZGUoKTsuX2NhcmRNb2RlbFxuICAgICAgICAgICAgcmV0dXJuIG5vZGUuX2NhcmRNb2RlbDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGNhcmRNb2RlcyB8fCBbXTtcbiAgICB9LFxuXG4gICAgLy8g6Ieq5Yqo6K6+572uIOWktOOAgeS4reOAgeWwvumBk+eahOWIoOmZpOaMiemSrueahOWPr+ingeaAp1xuICAgIF9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3RoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b24odGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgdGhpcy5idG5EZWxldGVUb3VEYW8ubm9kZSk7XG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbih0aGlzLmxheW91dFpob25nRGFvLm5vZGUsIHRoaXMuYnRuRGVsZXRlWmhvbmdEYW8ubm9kZSk7XG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbih0aGlzLmxheW91dFdlaURhby5ub2RlLCB0aGlzLmJ0bkRlbGV0ZVdlaURhby5ub2RlKTtcbiAgICB9LFxuXG4gICAgX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b246IGZ1bmN0aW9uIChsYXlvdXQsIGJ1dHRvbikge1xuICAgICAgICAvL2J1dHRvbi5hY3RpdmUgPSBsYXlvdXQuY2hpbGRyZW4ubGVuZ3RoID4gMDtcbiAgICB9LFxuXG4gICAgLy8g6Ieq5Yqo6K6+572uIOKAnOWFqOmDqOWPlua2iOKAneOAgeKAnOehruWumuWHuueJjOKAneOAgeKAnOexu+Wei+mAieaLqeKAneaMiemSrueahOWPr+ingeaAp1xuICAgIF9hdXRvQWN0aXZlVHlwZUJ1dHRvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICAvL2xldCBoYXNDYXJkVW5TZWxlY3RlZCA9IGNhcmROb2Rlcy5sZW5ndGggPiAwO1xuICAgICAgICAvL3RoaXMuYnRuRG9uZS5ub2RlLmFjdGl2ZSA9ICFoYXNDYXJkVW5TZWxlY3RlZDtcbiAgICAgICAgLy90aGlzLmJ0bkNhbmNlbEFsbC5ub2RlLmFjdGl2ZSA9IHRoaXMuYnRuRG9uZS5ub2RlLmFjdGl2ZTtcbiAgICAgICAgLy90aGlzLnR5cGVCdXR0b25zTm9kZS5hY3RpdmUgPSBoYXNDYXJkVW5TZWxlY3RlZDtcbiAgICB9LFxuXG59KTtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgIF9jYXJkTmFtZTogbnVsbCxcbiAgICAgIF9jYXJkTW9kZWw6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldENhcmQ6IGZ1bmN0aW9uIChjYXJkTmFtZSwgaW5kZXgsIGFzZGYgPSB0cnVlKSB7XG4gICAgICB0aGlzLl9jYXJkTmFtZSA9IGNhcmROYW1lO1xuICAgICAgaWYoYXNkZil7XG4gICAgICAgICAgdGhpcy5fY2FyZE1vZGVsID0gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUoY2FyZE5hbWUsIGZ1bmN0aW9uIChzcHJpdGVGcmFtZSkge1xuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2FyZE5hbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jYXJkTmFtZTtcbiAgICB9LFxuXG4gICAgY2FyZE1vZGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jYXJkTW9kZWw7XG4gICAgfSxcblxuICAgIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lKSB7XG4gICAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xuICAgICAgaWYgKCFjYXJkTmFtZS5zdGFydHNXaXRoKFwicHVibGljLXBpYy1jYXJkLXBva2VyXCIpKSB7XG4gICAgICAgIGNhcmROYW1lID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNhcmROYW1lO1xuICAgIH0sXG5cbiAgICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaykge1xuICAgICAgY2MuYXNzZXJ0KGNhbGxiYWNrKTtcblxuICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCJwbGF5L0NhcmRUeXBlQ29tYmluZS9wb2NrTGlzdFwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGNjLmVycm9yKGVycik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUpO1xuICAgICAgICB2YXIgZnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShjYXJkTmFtZSk7XG4gICAgICAgIGNhbGxiYWNrKGZyYW1lKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcbn0pO1xuIiwiLy8g55So5LqO5Zyo5ri45oiP6L+H56iL5Lit77yM5bGV56S655So5oi355qE6IGK5aSp5raI5oGvXG5cbmxldCBDaGF0TWVzc2FnZSA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHJpY2hUZXh0OiBjYy5SaWNoVGV4dCxcbiAgICAgICAgc3ByaXRlQmFja2dyb3VuZDogY2MuU3ByaXRlLFxuICAgICAgICBlbW9qaTpjYy5Ob2RlLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQ2hhdE1lc3NhZ2UuaW5zdGFuY2VzID0gdGhpcztcbiAgICB9LFxuXG4gICAgc2V0U3RyaW5nOiBmdW5jdGlvbiAoc3RyaW5nID0gXCJcIiwgYXV0b0hpZGUgPSB0cnVlKSB7XG4gICAgICAgIGlmIChzdHJpbmcubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnJpY2hUZXh0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zcHJpdGVCYWNrZ3JvdW5kLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lbW9qaS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgbGV0IG1heFdpZHRoID0gMzAwO1xuICAgICAgICBsZXQgcmVhbFN0ciA9IENoYXRNZXNzYWdlLnBhcnNlU3RyaW5nKHN0cmluZyk7XG5cbiAgICAgICAgLy8g55Sx5LqOIGNjLlJpY2hUZXh0IOWcqOaMh+WumiBtYXhXaWR0aCDlkI7vvIzor6Xnu5PngrnnmoQgd2lkdGgg5Lya5LiA55u0XG4gICAgICAgIC8vIOaYryBtYXhXaWR0aCDlgLzjgILogIzlnKjlsIYgbWF4V2lkdGgg5oyH5a6a5Li6MOaXtu+8jOWFtiBjb250ZW50U2l6ZS53aWR0aCDkvJpcbiAgICAgICAgLy8g5piv5YaF5a6555qE55yf5q2j5omA6ZyA55qE5a695bqmXG4gICAgICAgIC8vXG4gICAgICAgIC8vIOaJgOS7pei/memHjOWFiOWwhiBtYXhXaWR0aCDorr7kuLogMO+8jOiOt+WPluWFtuWunumZheWGheWuuSB3aWR0aCDlkI7lho3osIPmlbRcbiAgICAgICAgdGhpcy5yaWNoVGV4dC5tYXhXaWR0aCA9IDA7XG4gICAgICAgIHRoaXMucmljaFRleHQuc3RyaW5nID0gcmVhbFN0cjtcblxuICAgICAgICBsZXQgY29udGVudFdpZHRoID0gdGhpcy5yaWNoVGV4dC5ub2RlLmdldENvbnRlbnRTaXplKCkud2lkdGg7XG4gICAgICAgIGlmIChjb250ZW50V2lkdGggPiBtYXhXaWR0aCkge1xuICAgICAgICAgICAgdGhpcy5yaWNoVGV4dC5tYXhXaWR0aCA9IG1heFdpZHRoO1xuICAgICAgICAgICAgdGhpcy5yaWNoVGV4dC5zdHJpbmcgPSByZWFsU3RyO1xuICAgICAgICAgICAgY29udGVudFdpZHRoID0gbWF4V2lkdGg7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm5vZGUud2lkdGggPSBjb250ZW50V2lkdGggKyAyODtcbiAgICAgICAgdGhpcy5ub2RlLmhlaWdodCA9IHRoaXMucmljaFRleHQubm9kZS5nZXRDb250ZW50U2l6ZSgpLmhlaWdodCArIDIwO1xuXG4gICAgICAgIHRoaXMuc3ByaXRlQmFja2dyb3VuZC5ub2RlLndpZHRoID0gdGhpcy5ub2RlLndpZHRoO1xuICAgICAgICB0aGlzLnNwcml0ZUJhY2tncm91bmQubm9kZS5oZWlnaHQgPSB0aGlzLm5vZGUuaGVpZ2h0O1xuXG4gICAgICAgIGlmIChhdXRvSGlkZSkge1xuICAgICAgICAgICAgdGhpcy5faGlkZU5vZGUoKVxuICAgICAgICAgICAgLy90aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICAgICAgICAgIC8vdGhpcy5zY2hlZHVsZU9uY2UodGhpcy5faGlkZU5vZGUuYmluZCh0aGlzKSwgMyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2hvd0Vtb2ppOiBmdW5jdGlvbiAoc3ByaXRlKSB7XG4gICAgICAgIHRoaXMuX2hpZGVOb2RlKCk7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmVtb2ppLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMucmljaFRleHQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zcHJpdGVCYWNrZ3JvdW5kLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHZhciBidG5TcHJpdGVzID0gIHRoaXMuZW1vamkuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgIGJ0blNwcml0ZXMuc3ByaXRlRnJhbWUgPSBzcHJpdGU7XG4gICAgfSxcblxuICAgIF9oaWRlTm9kZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAzKTtcbiAgICB9LFxuXG59KTtcbkNoYXRNZXNzYWdlLnNldEVtb2ppID0gZnVuY3Rpb24oc3ByaXRlKXtcbiAgICB0aGlzLmluc3RhbmNlcy5faGlkZU5vZGUoKTtcbiAgICB0aGlzLmluc3RhbmNlcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgdGhpcy5pbnN0YW5jZXMuZW1vamkuYWN0aXZlID0gdHJ1ZTtcbiAgICB0aGlzLmluc3RhbmNlcy5yaWNoVGV4dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIHRoaXMuaW5zdGFuY2VzLnNwcml0ZUJhY2tncm91bmQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB2YXIgYnRuU3ByaXRlcyA9ICB0aGlzLmluc3RhbmNlcy5lbW9qaS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICBidG5TcHJpdGVzLnNwcml0ZUZyYW1lID0gc3ByaXRlO1xuICAgIC8vY29uc29sZS5sb2codGhpcy5lbW9qaSk7XG4gICAgLy9yZXR1cm47XG4gICAgLy9cbiAgICAvL3RoaXMuZW1vamkuU3ByaXRlID0gc3ByaXRlO1xufSxcblxuLy8g5bCGIDxicTEwPiDmlLnkuLrvvJogPGltZyBzcmM9J2JnMTAnLz5cbkNoYXRNZXNzYWdlLnBhcnNlU3RyaW5nID0gZnVuY3Rpb24gKHN0cikge1xuICAgIGxldCByZXN1bHQgPSBzdHIucmVwbGFjZSgvPGJxXFxkezEsMn0+L2csIGZ1bmN0aW9uKG1hdGNoKXtcbiAgICAgICAgdmFyIGJxID0gbWF0Y2gucmVwbGFjZShcIjxcIiwgXCIgPGltZyBzcmM9J1wiKS5yZXBsYWNlKFwiPlwiLCBcIicvPiBcIik7XG4gICAgICAgIHJldHVybiBicTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufSxcblxubW9kdWxlLmV4cG9ydHMgPSBDaGF0TWVzc2FnZTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldFN0cmluZzogZnVuY3Rpb24gKHN0cikge1xuICAgICAgdGhpcy5fcmljaFRleHQoKS5zdHJpbmcgPSBzdHI7XG4gICAgfSxcblxuICAgIF9yaWNoVGV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2NjLlJpY2hUZXh0Jyk7XG4gICAgfSxcbiAgICBcbiAgICBzZXRFbW9qaTpmdW5jdGlvbihzcHJhaXRlKXtcbiAgICAgICAgdGhpcy5fc3ByaXRlRnJhbWUoKS5TcHJhaXRlID0gc3ByYWl0ZTtcbiAgICB9LFxuICAgIF9zcHJpdGVGcmFtZTpmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gdGhpcy5ub2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XG4gICAgfSxcbn0pO1xuIiwiY29uc3QgS1FDYXJkUmVzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUmVzSGVscGVyJyk7XG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcbmNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB0b3VMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgemhvbmdMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgd2VpTGF5b3V0OiBjYy5MYXlvdXQsXG5cbiAgICAgICAgdG91TGF5b3V0QmFjazogY2MuTGF5b3V0LFxuICAgICAgICB6aG9uZ0xheW91dEJhY2s6IGNjLkxheW91dCxcbiAgICAgICAgd2VpTGF5b3V0QmFjazogY2MuTGF5b3V0LFxuICAgICAgICBiYW9EYW86IGNjLk5vZGUsICAvL+aKpemBk+WbvixcbiAgICAgICAgcGxheVRvdGFsU2NvcmU6IGNjLkxheW91dCwgIC8v5omA5pyJ546p5a6255qE5oC75YiG5pWwXG5cbiAgICAgICAgZGFvU2NvcmVMYXlvdXRzOiBbY2MuTGF5b3V0XSxcbiAgICAgICAgZGFvVGl0bGVOb2RlczogW2NjLk5vZGVdLFxuICAgICAgICBUU2NvcmVMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgVHRpdGxlTm9kZTogY2MuTm9kZSxcblxuICAgICAgICBwTnVtOjAsICAgICAgICAgLy/njqnlrrbkurrmlbBcbiAgICAgICAgdGVTaHVUaW1lOjAsICAgIC8v54m55q6K54mM5Ye654mM6aG65bqPXG4gICAgICAgIHRlU2h1TnVtOjAsICAgICAvL+eJueauiueJjOS6uuaVsFxuXG4gICAgICAgIF9sQ1Njb3JlOm51bGwsXG4gICAgICAgIF9kYW9MYXlvdXRzOiBudWxsLCAvLyDlpLTjgIHkuK3jgIHlsL7pm4blkIhcbiAgICAgICAgX2Rhb0xheW91dEJhY2tzOiBudWxsLCAvLyDlpLTjgIHkuK3jgIHlsL7pm4blkIhcbiAgICAgICAgX3Njb3JlczogbnVsbCxcbiAgICAgICAgX3VzZXI6IG51bGwsICAgICAgIC8vIOeUqOS6juavlOeJjOeahOaVsOaNrlxuICAgICAgICBfY2FyZHNJbmZvOiBudWxsLFxuICAgICAgICBfY29tcGFyZUluZGV4OiAwLCAgLy8g5bCG6KaB5q+U6L6D55qEIOe0ouW8lSAgMH4yXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHRoaXMuX2Rhb0xheW91dHMgPSBbdGhpcy50b3VMYXlvdXQsIHRoaXMuemhvbmdMYXlvdXQsIHRoaXMud2VpTGF5b3V0XTtcbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0QmFja3MgPSBbdGhpcy50b3VMYXlvdXRCYWNrLCB0aGlzLnpob25nTGF5b3V0QmFjaywgdGhpcy53ZWlMYXlvdXRCYWNrXTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgIGlmICh0aGlzLl9zY29yZXMpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U2NvcmVzKHRoaXMuX3Njb3Jlcyk7XG4gICAgICAgIH1cblxuICAgIH0sXG5cbiAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggPSAwO1xuXG4gICAgICAgIHRoaXMubm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7bm9kZS5hY3RpdmUgPSBmYWxzZTt9KTtcblxuICAgICAgICB0aGlzLmJhb0Rhby5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IG51bGw7XG5cbiAgICAgICAgdmFyIG5vZGVzID0gdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUuY2hpbGRyZW4uY29uY2F0KHRoaXMuemhvbmdMYXlvdXRCYWNrLm5vZGUuY2hpbGRyZW4pLmNvbmNhdCh0aGlzLndlaUxheW91dEJhY2subm9kZS5jaGlsZHJlbik7XG5cbiAgICAgICAgdGhpcy5jYXJkU3ByaXRlQXRsYXMgPSB0aGlzLm5vZGUucGFyZW50LnBhcmVudC5nZXRDb21wb25lbnQoJ3BsYXknKS5jYXJkU3ByaXRlQXRsYXM7XG5cbiAgICAgICAgbm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kKSB7XG5cbiAgICAgICAgICAgIG5vZC5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICB2YXIgY2FyZFNwcml0ZSA9IG5vZC5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgICAgICAgS1FDYXJkLl9sb2FkQ2FyZEZyYW1lKHRoaXMuY2FyZFNwcml0ZUF0bGFzLCBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1iYWNrXCIgLGNhcmRTcHJpdGUpO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5kYW9TY29yZUxheW91dHMuZm9yRWFjaChmdW5jdGlvbiAobm9kKSB7bm9kLm5vZGUuYWN0aXZlID0gZmFsc2U7fS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLmRhb1RpdGxlTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kKSB7bm9kLmFjdGl2ZSA9IGZhbHNlO30uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgaWYodGhpcy5UU2NvcmVMYXlvdXQpIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgaWYodGhpcy5UdGl0bGVOb2RlKSB0aGlzLlR0aXRsZU5vZGUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XG5cbiAgICAgICAgLy9jb25zb2xlLmxvZygn5omn6KGM5LqG5LiA6YGN5riF6Zmk5a6a5pe25ZmoLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKVxuXG4gICAgICAgIGlmKHRoaXMuVFNjb3JlTGF5b3V0KSB0aGlzLlRTY29yZUxheW91dC5ub2RlLnN0b3BBbGxBY3Rpb25zKCk7XG5cbiAgICAgICAgaWYodGhpcy5wbGF5VG90YWxTY29yZSkgdGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLnN0b3BBbGxBY3Rpb25zKCk7XG4gICAgfSxcblxuICAgIHNldENvbXBhcmVEYXRhOiBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICB0aGlzLl91c2VyID0gdXNlcjtcbiAgICAgICAgdGhpcy5fY2FyZHNJbmZvID0gdXNlci5jYXJkSW5mbztcbiAgICAgICAgbGV0IGNhcmRzSW5mbyA9IHVzZXIuY2FyZEluZm87XG4gICAgICAgIHRoaXMuX2xDU2NvcmUgPSB1c2VyLmxDU2NvcmU7XG4gICAgICAgIGxldCBjYXJkcyA9IGNhcmRzSW5mby5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0uY2FyZHMpO1xuICAgICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge1xuICAgICAgICAgICAgcmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7XG4gICAgICAgIH0sIFtdKTtcblxuXG4gICAgICAgIGxldCBzY29yZXMgPSBbdXNlci5zY29yZTEgfHwgMCwgdXNlci5zY29yZTIgfHwgMCwgdXNlci5zY29yZTMgfHwgMCx1c2VyLmxTY29yZTEgfHwgMCwgdXNlci5sU2NvcmUyIHx8IDAsIHVzZXIubFNjb3JlMyB8fCAwXTtcbiAgICAgICAgdGhpcy5zZXRDYXJkcyhjYXJkcyk7XG4gICAgICAgIHRoaXMuc2V0U2NvcmVzKHNjb3Jlcyk7XG4gICAgfSxcblxuICAgIC8v5pi+56S65omA5pyJ546p5a6255qE5oC75YiG5pWwXG4gICAgc2hvd1Njb3JlUmVzdWx0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYoIXRoaXMuX3VzZXIpIHJldHVybjtcbiAgICAgICAgdmFyIHNjb3JlcyA9IHRoaXMuX3VzZXIuY1Njb3JlO1xuICAgICAgICB0aGlzLnNldFNjb3Jlcyhbc2NvcmVzXSxbdGhpcy5wbGF5VG90YWxTY29yZV0sdHJ1ZSk7XG4gICAgICAgIHRoaXMucGxheVRvdGFsU2NvcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUub3BhY2l0eSA9IDI1NTtcbiAgICAgICAgdmFyIHggPSB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUueDtcbiAgICAgICAgdmFyIHkgPSB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUueTtcbiAgICAgICAgdGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLnJ1bkFjdGlvbihjYy5tb3ZlVG8oMC44LCBjYy5wKHgsIHkrMzApKSk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLnJ1bkFjdGlvbihjYy5mYWRlT3V0KDAuMikpO1xuICAgICAgICB9LmJpbmQodGhpcyksMC42KTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7dGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLnkgPSB5O30uYmluZCh0aGlzKSwxKTtcbiAgICB9LFxuXG4gICAgLy/mmL7npLrkuInpgZPliIbmlbBcbiAgICBzaG93TmV4dENvbXBhcmVTY29yZTogZnVuY3Rpb24oaXNDb250YWluRXh0cmEpIHtcbiAgICAgICAgaWYoaXNDb250YWluRXh0cmEgJiYgdGhpcy5UU2NvcmVMYXlvdXQpe1xuICAgICAgICAgICAgdmFyIHNjb3JlczEgPSB0aGlzLl9sQ1Njb3JlLnNwbGljZSgwLDEpO1xuICAgICAgICAgICAgaWYoc2NvcmVzMS5sZW5ndGggPD0gMCkgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5zZXRTY29yZXMoc2NvcmVzMSxbdGhpcy5UU2NvcmVMYXlvdXRdLHRydWUpO1xuICAgICAgICAgICAgdGhpcy5UdGl0bGVOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLlRTY29yZUxheW91dC5ub2RlLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAgIHZhciBzY2FsZVRvMTEgPSBjYy5zY2FsZVRvICgwLjMsIDEuOClcbiAgICAgICAgICAgIHZhciBzY2FsZVRvMjEgPSBjYy5zY2FsZVRvICgwLjEsIDEuMSlcbiAgICAgICAgICAgIHZhciBzY2FsZVRvMzEgPSBjYy5zY2FsZVRvICgwLjEsIDEuMylcbiAgICAgICAgICAgIHZhciBzY2FsZVRvU2VxMSA9Y2Muc2VxdWVuY2Uoc2NhbGVUbzExLHNjYWxlVG8yMSxzY2FsZVRvMzEpO1xuICAgICAgICAgICAgdGhpcy5UU2NvcmVMYXlvdXQubm9kZS5ydW5BY3Rpb24oc2NhbGVUb1NlcTEpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYodGhpcy5kYW9TY29yZUxheW91dHMubGVuZ3RoIDw9IDApIHJldHVybjtcbiAgICAgICAgaWYoIXRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEpe1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fY29tcGFyZUluZGV4ID09IDAgPyAxOiB0aGlzLl9jb21wYXJlSW5kZXg7XG4gICAgICAgICAgICB0aGlzLmRhb1Njb3JlTGF5b3V0c1tpbmRleC0xXS5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmRhb1Njb3JlTGF5b3V0c1tpbmRleCsyXS5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmRhb1RpdGxlTm9kZXNbaW5kZXgtMV0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzY29yZXMgPSB0aGlzLl9sQ1Njb3JlLnNwbGljZSgwLDEpO1xuICAgICAgICBpZihzY29yZXMubGVuZ3RoIDw9IDAgICYmICF0aGlzLlRTY29yZUxheW91dCkgcmV0dXJuO1xuICAgICAgICB0aGlzLnNldFNjb3JlcyhzY29yZXMsW3RoaXMuVFNjb3JlTGF5b3V0XSx0cnVlKTtcbiAgICAgICAgdGhpcy5UdGl0bGVOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICB2YXIgc2NhbGVUbzEgPSBjYy5zY2FsZVRvICgwLjMsIDEuOClcbiAgICAgICAgdmFyIHNjYWxlVG8yID0gY2Muc2NhbGVUbyAoMC4xLCAxLjEpXG4gICAgICAgIHZhciBzY2FsZVRvMyA9IGNjLnNjYWxlVG8gKDAuMSwgMS4zKVxuICAgICAgICB2YXIgc2NhbGVUb1NlcSA9Y2Muc2VxdWVuY2Uoc2NhbGVUbzEsc2NhbGVUbzIsc2NhbGVUbzMpO1xuICAgICAgICB0aGlzLlRTY29yZUxheW91dC5ub2RlLnJ1bkFjdGlvbihzY2FsZVRvU2VxKTtcblxuICAgIH0sXG5cbiAgICAvLyDkuIvkuIDkuKropoHmr5TovoPnmoTliIbmlbBcbiAgICAvLyDlpoLmnpzmsqHmnInopoHmr5TovoPnmoTkuobvvIzliJnov5Tlm54gMFxuICAgIG5leHRDb21wYXJlU2NvcmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3VzZXIpIHJldHVybiAwO1xuXG4gICAgICAgIHZhciBkYXRhO1xuICAgICAgICBpZih0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhKXtcbiAgICAgICAgICAgIGRhdGEgPSB0aGlzLl9jYXJkc0luZm9bMF07XG4gICAgICAgICAgICBpZiAoZGF0YSkgcmV0dXJuIGRhdGEudHlwZSAqIDkwMDAwMDAwMDAwMDAwMDA7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgZGF0YSA9IHRoaXMuX2NhcmRzSW5mb1t0aGlzLl9jb21wYXJlSW5kZXhdO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGF0YSkgcmV0dXJuIDA7XG4gICAgICAgIHJldHVybiBkYXRhLnZhbHVlO1xuICAgIH0sXG5cbiAgICBzZXRNYVBhaTogZnVuY3Rpb24gKG5vZGVzICxjYXJkTmFtZSkge1xuICAgICAgICBpZihjYy5tYVBhaSA9PSBjYXJkTmFtZSl7XG5cbiAgICAgICAgICAgIHZhciBub2RkcyA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXG5cbiAgICAgICAgICAgIG5vZGRzLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgICAgICBjYy5sb2FkZXIubG9hZFJlcygncGxheS9kZXNrL2ltZ19yZWQ1XzEnLCBjYy5TcHJpdGVGcmFtZSwgZnVuY3Rpb24gKGVyciwgc3ByaXRlRnJhbWUpIHtcblxuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtjYy5lcnJvcihlcnIubWVzc2FnZSB8fCBlcnIpO3JldHVybjt9XG5cbiAgICAgICAgICAgICAgICB2YXIgYnRuU3ByaXRlMSA9IG5vZGRzLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5zaXplTW9kZSA9IDA7XG5cbiAgICAgICAgICAgICAgICBidG5TcHJpdGUxLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG5cbiAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUud2lkdGggPSBub2Rlcy53aWR0aCArIDEwO1xuXG4gICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5ub2RlLmhlaWdodCA9IG5vZGVzLmhlaWdodCArIDEwO1xuXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICBub2Rlcy5hZGRDaGlsZChub2Rkcyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xuXG4gICAgICAgIGxldCBjYXJkU3ByaXRlcyA9IHRoaXMuX2FsbENhcmRTcHJpdGVzKCk7XG5cbiAgICAgICAgdGhpcy5jYXJkU3ByaXRlQXRsYXMgPSB0aGlzLm5vZGUucGFyZW50LnBhcmVudC5nZXRDb21wb25lbnQoJ3BsYXknKS5jYXJkU3ByaXRlQXRsYXM7XG5cbiAgICAgICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoa3FDYXJkLCBpbmRleCkge1xuICAgICAgICAgICAgaWYgKGluZGV4ID49IGNhcmRTcHJpdGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhcmRTcHJpdGVzW2luZGV4XS5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgICAgIGNhcmRTcHJpdGVzW2luZGV4XS5ub2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gXCJcIjtcblxuICAgICAgICAgICAgdmFyIG5vZGRzMSA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXG5cbiAgICAgICAgICAgIG5vZGRzMS5jYXJkTmFtZSA9IGtxQ2FyZC5jYXJkTmFtZSgpO1xuXG4gICAgICAgICAgICBub2RkczEud2lkdGggPSBjYXJkU3ByaXRlc1tpbmRleF0ubm9kZS53aWR0aDtcblxuICAgICAgICAgICAgbm9kZHMxLmhlaWdodCA9IGNhcmRTcHJpdGVzW2luZGV4XS5ub2RlLmhlaWdodDtcblxuICAgICAgICAgICAgbm9kZHMxLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgICAgICB2YXIgY2FyZFNwcml0ZSA9IG5vZGRzMS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpO1xuXG4gICAgICAgICAgICBjYXJkU3ByaXRlLnNpemVNb2RlID0gMDtcblxuICAgICAgICAgICAgdmFyIHBhdGggPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGtxQ2FyZC5jYXJkTmFtZSgpO1xuXG4gICAgICAgICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGNhcmRTcHJpdGUpO1xuXG4gICAgICAgICAgICB0aGlzLnNldE1hUGFpKGNhcmRTcHJpdGUubm9kZSwga3FDYXJkLmNhcmROYW1lKCkpO1xuXG4gICAgICAgICAgICBjYXJkU3ByaXRlc1tpbmRleF0ubm9kZS5hZGRDaGlsZChub2RkczEpO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdmFyIGNhcmRzMCA9IGNhcmRzLnNsaWNlKDAsMylcbiAgICAgICAgdmFyIGNhcmRzMSA9IGNhcmRzLnNsaWNlKDMsOClcbiAgICAgICAgdmFyIGNhcmRzMiA9IGNhcmRzLnNsaWNlKDgsMTMpXG5cbiAgICAgICAgdmFyIGNhcmRzMTEgPSBbY2FyZHMwLCBjYXJkczEsIGNhcmRzMl1cbiAgICAgICAgLy/lpLTpgZNcbiAgICAgICAgbGV0IHR5cGVOYW1lMCA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMwKSsxO1xuICAgICAgICB0eXBlTmFtZTAgPSB0eXBlTmFtZTA+PTEwID8gdHlwZU5hbWUwIDpcIjBcIit0eXBlTmFtZTA7XG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD09JzA0JyA/ICcxMScgOnR5cGVOYW1lMDtcblxuICAgICAgICAvL+S4remBk1xuICAgICAgICBsZXQgdHlwZU5hbWUxID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkczEpKzE7XG4gICAgICAgIHR5cGVOYW1lMSA9IHR5cGVOYW1lMT49MTAgPyB0eXBlTmFtZTEgOlwiMFwiK3R5cGVOYW1lMTtcbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPT0nMDcnID8gJzIyJyA6dHlwZU5hbWUxO1xuXG4gICAgICAgIC8v5bC+6YGTXG4gICAgICAgIGxldCB0eXBlTmFtZTIgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzMikrMTtcbiAgICAgICAgdHlwZU5hbWUyID0gdHlwZU5hbWUyPj0xMCA/IHR5cGVOYW1lMiA6XCIwXCIrdHlwZU5hbWUyO1xuXG4gICAgICAgIGNhcmRTcHJpdGVzID0gY2FyZFNwcml0ZXMubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBpLm5vZGU7fSk7XG5cbiAgICAgICAgaWYodHlwZU5hbWUwKSBLUUNhcmQuX3NldEd1aUNhcmQoMCwgMCwgMywgdHlwZU5hbWUwLCBjYXJkczExLCBjYXJkU3ByaXRlcywgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xuICAgICAgICBpZih0eXBlTmFtZTEpIEtRQ2FyZC5fc2V0R3VpQ2FyZCgxLCAzLCA4LCB0eXBlTmFtZTEsIGNhcmRzMTEsIGNhcmRTcHJpdGVzLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG4gICAgICAgIGlmKHR5cGVOYW1lMikgS1FDYXJkLl9zZXRHdWlDYXJkKDIsIDgsIDEzLCB0eXBlTmFtZTIsIGNhcmRzMTEsIGNhcmRTcHJpdGVzLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG5cbiAgICB9LFxuXG5cbiAgICBzZXRTY29yZXM6IGZ1bmN0aW9uIChzY29yZXMgLExheW91dHMgPSBudWxsICxpc19XSCA9IGZhbHNlKSB7XG4gICAgICAgIGlmKCFMYXlvdXRzKXtcbiAgICAgICAgICAgIExheW91dHMgPSB0aGlzLmRhb1Njb3JlTGF5b3V0cztcbiAgICAgICAgICAgIGlmKExheW91dHMubGVuZ3RoIDw9IDApIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHNjb3Jlcy5mb3JFYWNoKGZ1bmN0aW9uIChzdHJpbmcsIGluZGV4KSB7XG5cbiAgICAgICAgICAgIGxldCBsYWJlbHMgPSBMYXlvdXRzW2luZGV4XTtcblxuICAgICAgICAgICAgbGFiZWxzLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcblxuICAgICAgICAgICAgdmFyIHBhdGggPSBcInBsYXkvQ2FyZFR5cGVDb21iaW5lL1wiICsgKChOdW1iZXIoc3RyaW5nKSA+PSAwKSA/IFwiYWRkTnVtXCIgOiBcImRlbE51bVwiKTtcblxuICAgICAgICAgICAgdGhpcy5fY3JlYXRvck5vZGVzKGxhYmVscy5ub2RlICwxMCAscGF0aCAsJycgLGlzX1dIKTtcblxuICAgICAgICAgICAgdmFyIHN0cmluZ3MgPSAoc3RyaW5nID4gMCkgPyAoc3RyaW5nKSArIFwiXCI6IChzdHJpbmcgKiAtMSkgKyBcIlwiO1xuXG4gICAgICAgICAgICB2YXIgc3RyaW5nQXl5ID0gc3RyaW5ncy5zcGxpdChcIlwiKTtcblxuICAgICAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgc3RyaW5nQXl5Lmxlbmd0aDtpKyspe1xuXG4gICAgICAgICAgICAgICAgbGV0IHMgPSBzdHJpbmdBeXlbaV07XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9jcmVhdG9yTm9kZXMobGFiZWxzLm5vZGUgLE51bWJlcihzKSAscGF0aCAsJycgLGlzX1dIKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsYWJlbHMudHlwZSA9IDE7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgX2NyZWF0b3JOb2RlczpmdW5jdGlvbihub2RlcyxuYW1lLHBhdGgscGF0aHMsd19oID0gZmFsc2Upe1xuXG4gICAgICAgIHZhciBub2RlID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcblxuICAgICAgICBub2RlLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgIHZhciBidG5TcHJpdGUgPSBub2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgIGJ0blNwcml0ZS5zaXplTW9kZSA9IDA7XG5cbiAgICAgICAgYnRuU3ByaXRlLm5vZGUud2lkdGggPSAxODtidG5TcHJpdGUubm9kZS5oZWlnaHQgPSAyMztcbiAgICAgICAgLy9uYW1lID0gbmFtZSArIFwiXCI7XG4gICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUobmFtZSwgZnVuY3Rpb24gKHNwcml0ZUZyYW1lKSB7XG5cbiAgICAgICAgICAgIGJ0blNwcml0ZS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuXG4gICAgICAgICAgICBpZih3X2gpe2J0blNwcml0ZS5ub2RlLndpZHRoID0gMzA7YnRuU3ByaXRlLm5vZGUuaGVpZ2h0ID0gNDA7fVxuXG4gICAgICAgIH0uYmluZCh0aGlzKSwgcGF0aCwgcGF0aHMpO1xuXG4gICAgICAgIG5vZGVzLmFkZENoaWxkKG5vZGUpO1xuXG4gICAgfSxcblxuICAgIF9zZXRDYXJkU3ByaXRlRnJhbWU6IGZ1bmN0aW9uIChpbmRleHMsbm9kZXMpIHtcbiAgICAgICAgbGV0IGNhcmRzSW5mbyA9IHRoaXMuX2NhcmRzSW5mbztcbiAgICAgICAgbGV0IGNhcmRzID0gY2FyZHNJbmZvLm1hcChmdW5jdGlvbiAoY2FyZEluZm9JdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0uY2FyZHMpO1xuICAgICAgICAgICAgfSlbaW5kZXhzXSB8fCBbXTtcblxuICAgICAgICB0aGlzLmNhcmRTcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcblxuICAgICAgICAvLyBjYy5sb2codGhpcy5fY2FyZHNJbmZvKVxuICAgICAgICAvLyBjYy5sb2coY2FyZHMpXG4gICAgICAgIC8vIGNjLmxvZygnLS0tLS0tNTU1JylcblxuICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChrcUNhcmQsIGluZGV4KSB7XG5cbiAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICBub2Rlcy5jaGlsZHJlbltpbmRleF0uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBcIlwiXG5cbiAgICAgICAgICAgIHZhciBub2RkczEgPSBuZXcgY2MuTm9kZSgpOyAvL+WIm+W7uuS4gOS4quiKgueCueWvueixoVxuXG4gICAgICAgICAgICBub2RkczEuY2FyZE5hbWUgPSBrcUNhcmQuY2FyZE5hbWUoKTtcblxuICAgICAgICAgICAgbm9kZHMxLndpZHRoID0gbm9kZXMuY2hpbGRyZW5baW5kZXhdLndpZHRoO1xuXG4gICAgICAgICAgICBpZihub2Rlcy5wYXJlbnQucGFyZW50Lm5hbWUgPT0gXCJwbGF5U2VsZlwiKXtcblxuICAgICAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5oZWlnaHQgPSAxMzA7XG5cbiAgICAgICAgICAgICAgICBub2RkczEuaGVpZ2h0ID0gMTMwO1xuXG4gICAgICAgICAgICB9ZWxzZXtcblxuICAgICAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5oZWlnaHQgPSAxMTU7XG5cbiAgICAgICAgICAgICAgICBub2RkczEuaGVpZ2h0ID0gMTE1O1xuXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhub2Rlcyk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhub2RkczEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBub2RkczEuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XG5cbiAgICAgICAgICAgIHZhciBjYXJkU3ByaXRlID0gbm9kZHMxLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XG5cbiAgICAgICAgICAgIGNhcmRTcHJpdGUuc2l6ZU1vZGUgPSAwO1xuXG4gICAgICAgICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsga3FDYXJkLmNhcmROYW1lKCk7XG5cbiAgICAgICAgICAgIGNhcmRTcHJpdGUubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGNhcmRTcHJpdGUpO1xuXG4gICAgICAgICAgICB0aGlzLnNldE1hUGFpKGNhcmRTcHJpdGUubm9kZSwga3FDYXJkLmNhcmROYW1lKCkpO1xuXG4gICAgICAgICAgICBub2Rlcy5jaGlsZHJlbltpbmRleF0uYWRkQ2hpbGQobm9kZHMxKTtcblxuICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgIHZhciB0eXBlTmFtZSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMpKzE7XG5cbiAgICAgICAgdHlwZU5hbWUgPSB0eXBlTmFtZT49MTAgPyB0eXBlTmFtZStcIlwiIDpcIjBcIit0eXBlTmFtZTtcblxuICAgICAgICAvL+WktOmBk1xuICAgICAgICBpZihpbmRleHMgPT0gMCl7XG4gICAgICAgICAgICB0eXBlTmFtZSA9IHR5cGVOYW1lPT0nMDQnID8gJzExJyA6dHlwZU5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihpbmRleHMgPT0gMSl7XG4gICAgICAgICAgICB0eXBlTmFtZSA9IHR5cGVOYW1lPT0nMDcnID8gJzIyJyA6dHlwZU5hbWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY2FyZFNwcml0ZXMgPSBub2Rlcy5jaGlsZHJlbi5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGk7fSk7XG5cbiAgICAgICAgS1FDYXJkLl9zZXRHdWlDYXJkcyh0eXBlTmFtZSwgY2FyZHMsIGNhcmRTcHJpdGVzLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG5cbiAgICB9LFxuXG4gICAgc2hvd1RvdUNhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEgPT0gdHJ1ZSkgcmV0dXJuO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCflvIDlp4vmiafooYzkuIDmrKHlrprml7bliqjkvZwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpXG5cbiAgICAgICAgdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3NldENhcmRTcHJpdGVGcmFtZSgwLHRoaXMudG91TGF5b3V0QmFjay5ub2RlKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnRvdUxheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjcpO1xuXG4gICAgICAgIHRoaXMudG91TGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50b3VMYXlvdXQubm9kZS5zY2FsZVkgPSAwLjc7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy50b3VMYXlvdXQubm9kZS5zY2FsZVkgPSAxO1xuICAgICAgICB9LmJpbmQodGhpcyksIDAuMDIpO1xuXG5cbiAgICAgICAgdmFyIHR5cGVzID0gdGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF0udHlwZSA9PSAzID8gMzMzOnRoaXMuX2NhcmRzSW5mb1t0aGlzLl9jb21wYXJlSW5kZXhdLnR5cGU7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5Q2FyZFR5cGUodGhpcy5fdXNlci5zZXgsIHR5cGVzKTtcbiAgICAgICAgdGhpcy5fY29tcGFyZUluZGV4ICs9IDE7XG4gICAgfSxcblxuICAgIHNob3daaG9uZ0NhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEgPT0gdHJ1ZSkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuemhvbmdMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3NldENhcmRTcHJpdGVGcmFtZSgxLHRoaXMuemhvbmdMYXlvdXRCYWNrLm5vZGUpO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuemhvbmdMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuemhvbmdMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjcpO1xuXG4gICAgICAgIHRoaXMuemhvbmdMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnpob25nTGF5b3V0Lm5vZGUuc2NhbGVZID0gMC43O1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuemhvbmdMYXlvdXQubm9kZS5zY2FsZVkgPSAxO1xuICAgICAgICB9LmJpbmQodGhpcyksIDAuMDIpO1xuXG4gICAgICAgIHZhciB0eXBlcyA9IHRoaXMuX2NhcmRzSW5mb1t0aGlzLl9jb21wYXJlSW5kZXhdLnR5cGUgPT0gNiA/IDU1NTp0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlO1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0eXBlcyk7XG4gICAgICAgIHRoaXMuX2NvbXBhcmVJbmRleCArPSAxO1xuICAgIH0sXG5cbiAgICBzaG93V2VpQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZygn5omn6KGM5LqG5LiA5qyh5bC+6YGT5Yqo55S7LS0tLS0tLS0tLS0tLS0tJylcbiAgICAgICAgaWYodGhpcy5fdXNlci5pc0NvbnRhaW5FeHRyYSA9PSB0cnVlKSByZXR1cm47XG4gICAgICAgIC8vdGhpcy5fc2V0Q2FyZFNwcml0ZUZyYW1lKDEsdGhpcy56aG9uZ0xheW91dEJhY2subm9kZSk7XG4gICAgICAgIHRoaXMud2VpTGF5b3V0QmFjay5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9zZXRDYXJkU3ByaXRlRnJhbWUoMix0aGlzLndlaUxheW91dEJhY2subm9kZSk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy53ZWlMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMud2VpTGF5b3V0QmFjay5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH0uYmluZCh0aGlzKSwgMC43KTtcblxuICAgICAgICB0aGlzLndlaUxheW91dC5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMud2VpTGF5b3V0Lm5vZGUuc2NhbGVZID0gMC43O1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMud2VpTGF5b3V0Lm5vZGUuc2NhbGVZID0gMTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjAyKTtcblxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlKTtcbiAgICAgICAgdGhpcy5fY29tcGFyZUluZGV4ICs9IDE7XG4gICAgfSxcblxuICAgIHNob3dUZVNodUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgICAgLy9sZXQgdHlwZU5hbWUgPSBLUUNhcmQuY2FyZHNUeXBlTmFtZShjYXJkc05hbWVzKTtcbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0QmFja3MgPSBbdGhpcy50b3VMYXlvdXRCYWNrLCB0aGlzLnpob25nTGF5b3V0QmFjaywgdGhpcy53ZWlMYXlvdXRCYWNrXTtcblxuICAgICAgICBsZXQgdG91Q2FyZFNwcml0ZXMgPSB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQodGhpcy5fZGFvTGF5b3V0QmFja3NbMF0pO1xuICAgICAgICBsZXQgemhvbmdDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLl9kYW9MYXlvdXRCYWNrc1sxXSk7XG4gICAgICAgIGxldCB3ZWlDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLl9kYW9MYXlvdXRCYWNrc1syXSk7XG4gICAgICAgIGxldCBjYXJkU3ByaXRlcyA9IHRvdUNhcmRTcHJpdGVzLmNvbmNhdCh6aG9uZ0NhcmRTcHJpdGVzKS5jb25jYXQod2VpQ2FyZFNwcml0ZXMpO1xuICAgICAgICB0aGlzLmNhcmRTcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChrcUNhcmQsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IGNhcmRTcHJpdGVzLmxlbmd0aCkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgbGV0IGNhcmRTcHJpdGUgPSBjYXJkU3ByaXRlc1tpbmRleF07XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsga3FDYXJkLmNhcmROYW1lKCk7XG5cbiAgICAgICAgICAgICAgICBjYXJkU3ByaXRlLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcblxuICAgICAgICAgICAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZSh0aGlzLmNhcmRTcHJpdGVBdGxhcywgcGF0aCAsY2FyZFNwcml0ZSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNldE1hUGFpKGNhcmRTcHJpdGUubm9kZSwga3FDYXJkLmNhcmROYW1lKCkpO1xuXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgdGhpcy5fZGFvTGF5b3V0QmFja3MuZm9yRWFjaChmdW5jdGlvbiAobm9kZXMpIHtub2Rlcy5ub2RlLmFjdGl2ZSA9IHRydWU7fS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5Q2FyZFR5cGUodGhpcy5fdXNlci5zZXgsIHRoaXMuX2NhcmRzSW5mb1swXS50eXBlKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLDAuMSk7XG4gICAgfSxcblxuICAgIHNob3dOZXh0Q2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNhcmRUeXBlQ29tYmluZSA9IHRoaXMubm9kZS5wYXJlbnQucGFyZW50LmdldENoaWxkQnlOYW1lKCdDYXJkVHlwZUNvbWJpbmUnKS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlQ29tYmluZScpO1xuICAgICAgICBjYXJkVHlwZUNvbWJpbmUucmVzZXQoKTtcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLm5vZGUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUucGFyZW50LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhKSB7XG4gICAgICAgICAgICB2YXIgY2FyZHMgPSB0aGlzLl9jYXJkc0luZm9bMF0uY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkSW5mb0l0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRJbmZvSXRlbSk7XG4gICAgICAgICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcnJheS5jb25jYXQoc3ViQ2FyZHMpO1xuICAgICAgICAgICAgfSwgW10pO1xuICAgICAgICAgICAgdGhpcy5zaG93VGVTaHVDYXJkcyhjYXJkcyk7XG4gICAgICAgICAgICB0aGlzLnNob3dCYW9EYW8oMCwwKTtcbiAgICAgICAgICAgIHRoaXMuYmFvRGFvLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0cyA9IFt0aGlzLnRvdUxheW91dCwgdGhpcy56aG9uZ0xheW91dCwgdGhpcy53ZWlMYXlvdXRdO1xuICAgICAgICB0aGlzLl9kYW9MYXlvdXRzLmZvckVhY2goZnVuY3Rpb24gKG5vZGVzKSB7XG4gICAgICAgICAgICBub2Rlcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuX2NvbXBhcmVJbmRleCA9PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dCYW9EYW8oMCwxNDApO1xuICAgICAgICAgICAgdGhpcy5zaG93VG91Q2FyZHMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9jb21wYXJlSW5kZXggPT0gMSkge1xuICAgICAgICAgICAgdGhpcy5zaG93QmFvRGFvKDEsODUpO1xuICAgICAgICAgICAgdGhpcy5zaG93WmhvbmdDYXJkcygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX2NvbXBhcmVJbmRleCA9PSAyKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dCYW9EYW8oMiwzNCk7XG4gICAgICAgICAgICB0aGlzLnNob3dXZWlDYXJkcygpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5iYW9EYW8uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7dGhpcy5iYW9EYW8uYWN0aXZlID0gZmFsc2U7fS5iaW5kKHRoaXMpLCAwLjcpO1xuXG4gICAgfSxcblxuICAgIHNob3dBbGxDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZighdGhpcy5fdXNlcikgcmV0dXJuO1xuXG4gICAgICAgIGlmICh0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhKSB7XG5cbiAgICAgICAgICAgIHZhciBjYXJkcyA9IHRoaXMuX2NhcmRzSW5mb1swXS5jYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge3JldHVybiBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZEluZm9JdGVtKTt9KVxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge3JldHVybiBhcnJheS5jb25jYXQoc3ViQ2FyZHMpO30sIFtdKTtcblxuICAgICAgICAgICAgdGhpcy5zaG93VGVTaHVDYXJkcyhjYXJkcyk7XG5cbiAgICAgICAgICAgIC8vcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYoIXRoaXMuX2Rhb0xheW91dEJhY2tzKSByZXR1cm47XG5cbiAgICAgICAgdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUucGFyZW50LmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0QmFja3MuZm9yRWFjaChmdW5jdGlvbiAobm9kZXMsaW5kZXgpIHtcblxuICAgICAgICAgICAgbm9kZXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgICAgICBub2Rlcy5ub2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKG5vKSB7bm8uYWN0aXZlID0gdHJ1ZTt9KTtcblxuICAgICAgICAgICAgdGhpcy5fc2V0Q2FyZFNwcml0ZUZyYW1lKGluZGV4LG5vZGVzLm5vZGUpO1xuXG4gICAgICAgICAgICBpZih0aGlzLlRTY29yZUxheW91dCkgdGhpcy5kYW9UaXRsZU5vZGVzW2luZGV4XS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgaWYoIXRoaXMuVFNjb3JlTGF5b3V0KSByZXR1cm47XG5cbiAgICAgICAgdGhpcy5kYW9TY29yZUxheW91dHMuZm9yRWFjaChmdW5jdGlvbiAobm9kZXMpIHtcblxuICAgICAgICAgICAgbm9kZXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5zZXRTY29yZXMoW3RoaXMuX3VzZXIuY1Njb3JlXSxbdGhpcy5UU2NvcmVMYXlvdXRdLHRydWUpO1xuXG4gICAgICAgIHRoaXMuVHRpdGxlTm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcblxuICAgIH0sXG5cbiAgICBzaG93QmFvRGFvOiBmdW5jdGlvbiAoaW5kZXgscG9zaXRvblkpIHtcbiAgICAgICAgbGV0IGNhcmRzSW5mbyA9IHRoaXMuX2NhcmRzSW5mbztcbiAgICAgICAgbGV0IGNhcmRUeXBlID0gY2FyZHNJbmZvLm1hcChmdW5jdGlvbiAoY2FyZEluZm9JdGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FyZEluZm9JdGVtLnR5cGVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IHR5cGVOYW1lMCA9IGNhcmRUeXBlW2luZGV4XSsxO1xuICAgICAgICB0eXBlTmFtZTAgPSB0eXBlTmFtZTA+PTEwID8gdHlwZU5hbWUwIDpcIjBcIit0eXBlTmFtZTA7XG4gICAgICAgIGlmKGluZGV4ID09IDApIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD09JzA0JyA/ICcxMScgOnR5cGVOYW1lMDtcbiAgICAgICAgaWYoaW5kZXggPT0gMSkgdHlwZU5hbWUwID0gdHlwZU5hbWUwPT0nMDcnID8gJzIyJyA6dHlwZU5hbWUwO1xuXG4gICAgICAgIGlmKGNhcmRUeXBlW2luZGV4XSA9PSAxMCkgdHlwZU5hbWUwID0gJzE1JzsvL+eJueauiueJjFxuICAgICAgICBpZihjYXJkVHlwZVtpbmRleF0gPT0gMTEpIHR5cGVOYW1lMCA9ICcxNCc7XG4gICAgICAgIGlmKGNhcmRUeXBlW2luZGV4XSA9PSAxMikgdHlwZU5hbWUwID0gJzE2JztcbiAgICAgICAgaWYoY2FyZFR5cGVbaW5kZXhdID09IDE4KSB0eXBlTmFtZTAgPSAnMjUnO1xuICAgICAgICBpZihjYXJkVHlwZVtpbmRleF0gPT0gMTkpIHR5cGVOYW1lMCA9ICcyNic7XG5cbiAgICAgICAgdmFyIHBhdGggPSB0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhP1wiZ2FtZS1yaWdodF9zcGVjaWFcIjpcImdhbWUtcG9rZXJfdHlwZVwiO1xuXG4gICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUodHlwZU5hbWUwLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcbiAgICAgICAgICAgIHZhciBidG5TcHJpdGVzMSA9ICB0aGlzLmJhb0Rhby5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgICAgIGJ0blNwcml0ZXMxLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG4gICAgICAgIH0uYmluZCh0aGlzKSwgXCJwbGF5L0NhcmRUeXBlQ29tYmluZS9nYW1lX3R4dFwiLHBhdGgpO1xuICAgICAgICB0aGlzLmJhb0Rhby55ID0gcG9zaXRvblk7XG4gICAgfSxcblxuICAgIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrLCBwYXRoID0gXCJwbGF5L0NhcmRUeXBlQ29tYmluZS9wb2NrTGlzdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aHMgPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIikge1xuICAgICAgICBjYy5sb2FkZXIubG9hZFJlcyhwYXRoLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICBjYy5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhcmROYW1lID0gY2FyZE5hbWUgKyBcIlwiO1xuICAgICAgICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUscGF0aHMpO1xuICAgICAgICAgICAgdmFyIGZyYW1lID0gYXRsYXMuZ2V0U3ByaXRlRnJhbWUoY2FyZE5hbWUpO1xuICAgICAgICAgICAgY2FsbGJhY2soZnJhbWUpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBfY2FyZEZ1bGxOYW1lOiBmdW5jdGlvbiAoY2FyZFNob3J0TmFtZSxwYXRocykge1xuICAgICAgICBpZighcGF0aHMpIHJldHVybiBjYXJkU2hvcnROYW1lO1xuICAgICAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xuICAgICAgICBpZiAoIWNhcmROYW1lLnN0YXJ0c1dpdGgocGF0aHMpKSB7XG4gICAgICAgICAgICBjYXJkTmFtZSA9IHBhdGhzICsgY2FyZE5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhcmROYW1lO1xuICAgIH0sXG5cbiAgICBfY2xlYXJDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jbGVhckxheW91dENhcmRzKHRoaXMudG91TGF5b3V0KTtcbiAgICAgICAgdGhpcy5fY2xlYXJMYXlvdXRDYXJkcyh0aGlzLnpob25nTGF5b3V0KTtcbiAgICAgICAgdGhpcy5fY2xlYXJMYXlvdXRDYXJkcyh0aGlzLndlaUxheW91dCk7XG4gICAgfSxcblxuICAgIF9jbGVhckxheW91dENhcmRzOiBmdW5jdGlvbiAobGF5b3V0KSB7XG4gICAgICAgIHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dChsYXlvdXQpLmZvckVhY2goZnVuY3Rpb24gKHNwcml0ZSkge1xuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gbnVsbDtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9jYXJkU3ByaXRlc1dpdGhMYXlvdXQ6IGZ1bmN0aW9uIChsYXlvdXQpIHtcbiAgICAgICAgbGV0IG5vZGUgPSBsYXlvdXQubm9kZTtcbiAgICAgICAgcmV0dXJuIG5vZGUuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgX2FsbENhcmRTcHJpdGVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB0b3VDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLnRvdUxheW91dCk7XG4gICAgICAgIGxldCB6aG9uZ0NhcmRTcHJpdGVzID0gdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KHRoaXMuemhvbmdMYXlvdXQpO1xuICAgICAgICBsZXQgd2VpQ2FyZFNwcml0ZXMgPSB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQodGhpcy53ZWlMYXlvdXQpO1xuICAgICAgICBsZXQgcmVzdWx0ID0gdG91Q2FyZFNwcml0ZXMuY29uY2F0KHpob25nQ2FyZFNwcml0ZXMpLmNvbmNhdCh3ZWlDYXJkU3ByaXRlcyk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYWJlbFRpbWU6IGNjLkxhYmVsLFxuICAgICAgICAvL3RpbWVOb2RlOiBjYy5Ob2RlLFxuXG4gICAgICAgIF9jYWxsYmFjazogbnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IFwiMFwiO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDlvIDlp4vlgJLorqHml7ZcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gIHtOdW1iZXJ9IHRpbWUg5pe26ZW/XG4gICAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIOWAkuiuoeaXtueahOWbnuiwg1xuICAgICAqL1xuICAgIHN0YXJ0Q291bnRkb3duOiBmdW5jdGlvbih0aW1lLCBjYWxsYmFjaykge1xuICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcblxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gXCJcIiArIHRpbWU7XG4gICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5fY291bnREb3duLCAxLCB0aW1lKTtcbiAgICAgICAgdGhpcy5nZXRDb21wb25lbnQoXCJ0aW1lXCIpLnNldFRpbWUodGltZSAqIDAuNSlcbiAgICB9LFxuXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLl9jb3VudERvd24pO1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHRoaXMuX2NhbGxiYWNrKSB7XG4gICAgICAgICAgICBsZXQgaXNUaW1lb3V0ID0gTnVtYmVyKHRoaXMubGFiZWxUaW1lLnN0cmluZykgPD0gMDtcbiAgICAgICAgICAgIGxldCBjYWxsYmFjayA9IHRoaXMuX2NhbGxiYWNrO1xuICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBudWxsO1xuICAgICAgICAgICAgY2FsbGJhY2soaXNUaW1lb3V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gbnVsbDtcbiAgICB9LFxuXG4gICAgX2NvdW50RG93bjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0aW1lID0gTnVtYmVyKHRoaXMubGFiZWxUaW1lLnN0cmluZyB8fCBcIjBcIik7XG4gICAgICAgIHRpbWUgPSB0aW1lIC0gMTtcblxuICAgICAgICBpZiAodGltZSA8PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IFN0cmluZyh0aW1lKTtcbiAgICB9LFxuXG5cbn0pO1xuIiwiJ3VzZSBzdHJpY3QnXG5cbmV4cG9ydHMuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGhcbmV4cG9ydHMudG9CeXRlQXJyYXkgPSB0b0J5dGVBcnJheVxuZXhwb3J0cy5mcm9tQnl0ZUFycmF5ID0gZnJvbUJ5dGVBcnJheVxuXG52YXIgbG9va3VwID0gW11cbnZhciByZXZMb29rdXAgPSBbXVxudmFyIEFyciA9IHR5cGVvZiBVaW50OEFycmF5ICE9PSAndW5kZWZpbmVkJyA/IFVpbnQ4QXJyYXkgOiBBcnJheVxuXG52YXIgY29kZSA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJ1xuZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNvZGUubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgbG9va3VwW2ldID0gY29kZVtpXVxuICByZXZMb29rdXBbY29kZS5jaGFyQ29kZUF0KGkpXSA9IGlcbn1cblxucmV2TG9va3VwWyctJy5jaGFyQ29kZUF0KDApXSA9IDYyXG5yZXZMb29rdXBbJ18nLmNoYXJDb2RlQXQoMCldID0gNjNcblxuZnVuY3Rpb24gcGxhY2VIb2xkZXJzQ291bnQgKGI2NCkge1xuICB2YXIgbGVuID0gYjY0Lmxlbmd0aFxuICBpZiAobGVuICUgNCA+IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgc3RyaW5nLiBMZW5ndGggbXVzdCBiZSBhIG11bHRpcGxlIG9mIDQnKVxuICB9XG5cbiAgLy8gdGhlIG51bWJlciBvZiBlcXVhbCBzaWducyAocGxhY2UgaG9sZGVycylcbiAgLy8gaWYgdGhlcmUgYXJlIHR3byBwbGFjZWhvbGRlcnMsIHRoYW4gdGhlIHR3byBjaGFyYWN0ZXJzIGJlZm9yZSBpdFxuICAvLyByZXByZXNlbnQgb25lIGJ5dGVcbiAgLy8gaWYgdGhlcmUgaXMgb25seSBvbmUsIHRoZW4gdGhlIHRocmVlIGNoYXJhY3RlcnMgYmVmb3JlIGl0IHJlcHJlc2VudCAyIGJ5dGVzXG4gIC8vIHRoaXMgaXMganVzdCBhIGNoZWFwIGhhY2sgdG8gbm90IGRvIGluZGV4T2YgdHdpY2VcbiAgcmV0dXJuIGI2NFtsZW4gLSAyXSA9PT0gJz0nID8gMiA6IGI2NFtsZW4gLSAxXSA9PT0gJz0nID8gMSA6IDBcbn1cblxuZnVuY3Rpb24gYnl0ZUxlbmd0aCAoYjY0KSB7XG4gIC8vIGJhc2U2NCBpcyA0LzMgKyB1cCB0byB0d28gY2hhcmFjdGVycyBvZiB0aGUgb3JpZ2luYWwgZGF0YVxuICByZXR1cm4gYjY0Lmxlbmd0aCAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KVxufVxuXG5mdW5jdGlvbiB0b0J5dGVBcnJheSAoYjY0KSB7XG4gIHZhciBpLCBqLCBsLCB0bXAsIHBsYWNlSG9sZGVycywgYXJyXG4gIHZhciBsZW4gPSBiNjQubGVuZ3RoXG4gIHBsYWNlSG9sZGVycyA9IHBsYWNlSG9sZGVyc0NvdW50KGI2NClcblxuICBhcnIgPSBuZXcgQXJyKGxlbiAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzKVxuXG4gIC8vIGlmIHRoZXJlIGFyZSBwbGFjZWhvbGRlcnMsIG9ubHkgZ2V0IHVwIHRvIHRoZSBsYXN0IGNvbXBsZXRlIDQgY2hhcnNcbiAgbCA9IHBsYWNlSG9sZGVycyA+IDAgPyBsZW4gLSA0IDogbGVuXG5cbiAgdmFyIEwgPSAwXG5cbiAgZm9yIChpID0gMCwgaiA9IDA7IGkgPCBsOyBpICs9IDQsIGogKz0gMykge1xuICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDE4KSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA8PCAxMikgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAyKV0gPDwgNikgfCByZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDMpXVxuICAgIGFycltMKytdID0gKHRtcCA+PiAxNikgJiAweEZGXG4gICAgYXJyW0wrK10gPSAodG1wID4+IDgpICYgMHhGRlxuICAgIGFycltMKytdID0gdG1wICYgMHhGRlxuICB9XG5cbiAgaWYgKHBsYWNlSG9sZGVycyA9PT0gMikge1xuICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDIpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldID4+IDQpXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH0gZWxzZSBpZiAocGxhY2VIb2xkZXJzID09PSAxKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTApIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDQpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildID4+IDIpXG4gICAgYXJyW0wrK10gPSAodG1wID4+IDgpICYgMHhGRlxuICAgIGFycltMKytdID0gdG1wICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIGFyclxufVxuXG5mdW5jdGlvbiB0cmlwbGV0VG9CYXNlNjQgKG51bSkge1xuICByZXR1cm4gbG9va3VwW251bSA+PiAxOCAmIDB4M0ZdICsgbG9va3VwW251bSA+PiAxMiAmIDB4M0ZdICsgbG9va3VwW251bSA+PiA2ICYgMHgzRl0gKyBsb29rdXBbbnVtICYgMHgzRl1cbn1cblxuZnVuY3Rpb24gZW5jb2RlQ2h1bmsgKHVpbnQ4LCBzdGFydCwgZW5kKSB7XG4gIHZhciB0bXBcbiAgdmFyIG91dHB1dCA9IFtdXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSArPSAzKSB7XG4gICAgdG1wID0gKHVpbnQ4W2ldIDw8IDE2KSArICh1aW50OFtpICsgMV0gPDwgOCkgKyAodWludDhbaSArIDJdKVxuICAgIG91dHB1dC5wdXNoKHRyaXBsZXRUb0Jhc2U2NCh0bXApKVxuICB9XG4gIHJldHVybiBvdXRwdXQuam9pbignJylcbn1cblxuZnVuY3Rpb24gZnJvbUJ5dGVBcnJheSAodWludDgpIHtcbiAgdmFyIHRtcFxuICB2YXIgbGVuID0gdWludDgubGVuZ3RoXG4gIHZhciBleHRyYUJ5dGVzID0gbGVuICUgMyAvLyBpZiB3ZSBoYXZlIDEgYnl0ZSBsZWZ0LCBwYWQgMiBieXRlc1xuICB2YXIgb3V0cHV0ID0gJydcbiAgdmFyIHBhcnRzID0gW11cbiAgdmFyIG1heENodW5rTGVuZ3RoID0gMTYzODMgLy8gbXVzdCBiZSBtdWx0aXBsZSBvZiAzXG5cbiAgLy8gZ28gdGhyb3VnaCB0aGUgYXJyYXkgZXZlcnkgdGhyZWUgYnl0ZXMsIHdlJ2xsIGRlYWwgd2l0aCB0cmFpbGluZyBzdHVmZiBsYXRlclxuICBmb3IgKHZhciBpID0gMCwgbGVuMiA9IGxlbiAtIGV4dHJhQnl0ZXM7IGkgPCBsZW4yOyBpICs9IG1heENodW5rTGVuZ3RoKSB7XG4gICAgcGFydHMucHVzaChlbmNvZGVDaHVuayh1aW50OCwgaSwgKGkgKyBtYXhDaHVua0xlbmd0aCkgPiBsZW4yID8gbGVuMiA6IChpICsgbWF4Q2h1bmtMZW5ndGgpKSlcbiAgfVxuXG4gIC8vIHBhZCB0aGUgZW5kIHdpdGggemVyb3MsIGJ1dCBtYWtlIHN1cmUgdG8gbm90IGZvcmdldCB0aGUgZXh0cmEgYnl0ZXNcbiAgaWYgKGV4dHJhQnl0ZXMgPT09IDEpIHtcbiAgICB0bXAgPSB1aW50OFtsZW4gLSAxXVxuICAgIG91dHB1dCArPSBsb29rdXBbdG1wID4+IDJdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wIDw8IDQpICYgMHgzRl1cbiAgICBvdXRwdXQgKz0gJz09J1xuICB9IGVsc2UgaWYgKGV4dHJhQnl0ZXMgPT09IDIpIHtcbiAgICB0bXAgPSAodWludDhbbGVuIC0gMl0gPDwgOCkgKyAodWludDhbbGVuIC0gMV0pXG4gICAgb3V0cHV0ICs9IGxvb2t1cFt0bXAgPj4gMTBdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wID4+IDQpICYgMHgzRl1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPDwgMikgJiAweDNGXVxuICAgIG91dHB1dCArPSAnPSdcbiAgfVxuXG4gIHBhcnRzLnB1c2gob3V0cHV0KVxuXG4gIHJldHVybiBwYXJ0cy5qb2luKCcnKVxufVxuIiwiLyohXG4gKiBUaGUgYnVmZmVyIG1vZHVsZSBmcm9tIG5vZGUuanMsIGZvciB0aGUgYnJvd3Nlci5cbiAqXG4gKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz5cbiAqIEBsaWNlbnNlICBNSVRcbiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi9cblxuJ3VzZSBzdHJpY3QnXG5cbnZhciBiYXNlNjQgPSByZXF1aXJlKCdiYXNlNjQtanMnKVxudmFyIGllZWU3NTQgPSByZXF1aXJlKCdpZWVlNzU0JylcbnZhciBpc0FycmF5ID0gcmVxdWlyZSgnaXNhcnJheScpXG5cbmV4cG9ydHMuQnVmZmVyID0gQnVmZmVyXG5leHBvcnRzLlNsb3dCdWZmZXIgPSBTbG93QnVmZmVyXG5leHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTID0gNTBcblxuLyoqXG4gKiBJZiBgQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRgOlxuICogICA9PT0gdHJ1ZSAgICBVc2UgVWludDhBcnJheSBpbXBsZW1lbnRhdGlvbiAoZmFzdGVzdClcbiAqICAgPT09IGZhbHNlICAgVXNlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiAobW9zdCBjb21wYXRpYmxlLCBldmVuIElFNilcbiAqXG4gKiBCcm93c2VycyB0aGF0IHN1cHBvcnQgdHlwZWQgYXJyYXlzIGFyZSBJRSAxMCssIEZpcmVmb3ggNCssIENocm9tZSA3KywgU2FmYXJpIDUuMSssXG4gKiBPcGVyYSAxMS42KywgaU9TIDQuMisuXG4gKlxuICogRHVlIHRvIHZhcmlvdXMgYnJvd3NlciBidWdzLCBzb21ldGltZXMgdGhlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiB3aWxsIGJlIHVzZWQgZXZlblxuICogd2hlbiB0aGUgYnJvd3NlciBzdXBwb3J0cyB0eXBlZCBhcnJheXMuXG4gKlxuICogTm90ZTpcbiAqXG4gKiAgIC0gRmlyZWZveCA0LTI5IGxhY2tzIHN1cHBvcnQgZm9yIGFkZGluZyBuZXcgcHJvcGVydGllcyB0byBgVWludDhBcnJheWAgaW5zdGFuY2VzLFxuICogICAgIFNlZTogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9Njk1NDM4LlxuICpcbiAqICAgLSBDaHJvbWUgOS0xMCBpcyBtaXNzaW5nIHRoZSBgVHlwZWRBcnJheS5wcm90b3R5cGUuc3ViYXJyYXlgIGZ1bmN0aW9uLlxuICpcbiAqICAgLSBJRTEwIGhhcyBhIGJyb2tlbiBgVHlwZWRBcnJheS5wcm90b3R5cGUuc3ViYXJyYXlgIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYXJyYXlzIG9mXG4gKiAgICAgaW5jb3JyZWN0IGxlbmd0aCBpbiBzb21lIHNpdHVhdGlvbnMuXG5cbiAqIFdlIGRldGVjdCB0aGVzZSBidWdneSBicm93c2VycyBhbmQgc2V0IGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGAgdG8gYGZhbHNlYCBzbyB0aGV5XG4gKiBnZXQgdGhlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiwgd2hpY2ggaXMgc2xvd2VyIGJ1dCBiZWhhdmVzIGNvcnJlY3RseS5cbiAqL1xuQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgPSBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVCAhPT0gdW5kZWZpbmVkXG4gID8gZ2xvYmFsLlRZUEVEX0FSUkFZX1NVUFBPUlRcbiAgOiB0eXBlZEFycmF5U3VwcG9ydCgpXG5cbi8qXG4gKiBFeHBvcnQga01heExlbmd0aCBhZnRlciB0eXBlZCBhcnJheSBzdXBwb3J0IGlzIGRldGVybWluZWQuXG4gKi9cbmV4cG9ydHMua01heExlbmd0aCA9IGtNYXhMZW5ndGgoKVxuXG5mdW5jdGlvbiB0eXBlZEFycmF5U3VwcG9ydCAoKSB7XG4gIHRyeSB7XG4gICAgdmFyIGFyciA9IG5ldyBVaW50OEFycmF5KDEpXG4gICAgYXJyLl9fcHJvdG9fXyA9IHtfX3Byb3RvX186IFVpbnQ4QXJyYXkucHJvdG90eXBlLCBmb286IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDQyIH19XG4gICAgcmV0dXJuIGFyci5mb28oKSA9PT0gNDIgJiYgLy8gdHlwZWQgYXJyYXkgaW5zdGFuY2VzIGNhbiBiZSBhdWdtZW50ZWRcbiAgICAgICAgdHlwZW9mIGFyci5zdWJhcnJheSA9PT0gJ2Z1bmN0aW9uJyAmJiAvLyBjaHJvbWUgOS0xMCBsYWNrIGBzdWJhcnJheWBcbiAgICAgICAgYXJyLnN1YmFycmF5KDEsIDEpLmJ5dGVMZW5ndGggPT09IDAgLy8gaWUxMCBoYXMgYnJva2VuIGBzdWJhcnJheWBcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbmZ1bmN0aW9uIGtNYXhMZW5ndGggKCkge1xuICByZXR1cm4gQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRcbiAgICA/IDB4N2ZmZmZmZmZcbiAgICA6IDB4M2ZmZmZmZmZcbn1cblxuZnVuY3Rpb24gY3JlYXRlQnVmZmVyICh0aGF0LCBsZW5ndGgpIHtcbiAgaWYgKGtNYXhMZW5ndGgoKSA8IGxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHR5cGVkIGFycmF5IGxlbmd0aCcpXG4gIH1cbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlXG4gICAgdGhhdCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aClcbiAgICB0aGF0Ll9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzXG4gICAgaWYgKHRoYXQgPT09IG51bGwpIHtcbiAgICAgIHRoYXQgPSBuZXcgQnVmZmVyKGxlbmd0aClcbiAgICB9XG4gICAgdGhhdC5sZW5ndGggPSBsZW5ndGhcbiAgfVxuXG4gIHJldHVybiB0aGF0XG59XG5cbi8qKlxuICogVGhlIEJ1ZmZlciBjb25zdHJ1Y3RvciByZXR1cm5zIGluc3RhbmNlcyBvZiBgVWludDhBcnJheWAgdGhhdCBoYXZlIHRoZWlyXG4gKiBwcm90b3R5cGUgY2hhbmdlZCB0byBgQnVmZmVyLnByb3RvdHlwZWAuIEZ1cnRoZXJtb3JlLCBgQnVmZmVyYCBpcyBhIHN1YmNsYXNzIG9mXG4gKiBgVWludDhBcnJheWAsIHNvIHRoZSByZXR1cm5lZCBpbnN0YW5jZXMgd2lsbCBoYXZlIGFsbCB0aGUgbm9kZSBgQnVmZmVyYCBtZXRob2RzXG4gKiBhbmQgdGhlIGBVaW50OEFycmF5YCBtZXRob2RzLiBTcXVhcmUgYnJhY2tldCBub3RhdGlvbiB3b3JrcyBhcyBleHBlY3RlZCAtLSBpdFxuICogcmV0dXJucyBhIHNpbmdsZSBvY3RldC5cbiAqXG4gKiBUaGUgYFVpbnQ4QXJyYXlgIHByb3RvdHlwZSByZW1haW5zIHVubW9kaWZpZWQuXG4gKi9cblxuZnVuY3Rpb24gQnVmZmVyIChhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmICEodGhpcyBpbnN0YW5jZW9mIEJ1ZmZlcikpIHtcbiAgICByZXR1cm4gbmV3IEJ1ZmZlcihhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aClcbiAgfVxuXG4gIC8vIENvbW1vbiBjYXNlLlxuICBpZiAodHlwZW9mIGFyZyA9PT0gJ251bWJlcicpIHtcbiAgICBpZiAodHlwZW9mIGVuY29kaW5nT3JPZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICdJZiBlbmNvZGluZyBpcyBzcGVjaWZpZWQgdGhlbiB0aGUgZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZydcbiAgICAgIClcbiAgICB9XG4gICAgcmV0dXJuIGFsbG9jVW5zYWZlKHRoaXMsIGFyZylcbiAgfVxuICByZXR1cm4gZnJvbSh0aGlzLCBhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aClcbn1cblxuQnVmZmVyLnBvb2xTaXplID0gODE5MiAvLyBub3QgdXNlZCBieSB0aGlzIGltcGxlbWVudGF0aW9uXG5cbi8vIFRPRE86IExlZ2FjeSwgbm90IG5lZWRlZCBhbnltb3JlLiBSZW1vdmUgaW4gbmV4dCBtYWpvciB2ZXJzaW9uLlxuQnVmZmVyLl9hdWdtZW50ID0gZnVuY3Rpb24gKGFycikge1xuICBhcnIuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICByZXR1cm4gYXJyXG59XG5cbmZ1bmN0aW9uIGZyb20gKHRoYXQsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInZhbHVlXCIgYXJndW1lbnQgbXVzdCBub3QgYmUgYSBudW1iZXInKVxuICB9XG5cbiAgaWYgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgIHJldHVybiBmcm9tQXJyYXlCdWZmZXIodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aClcbiAgfVxuXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGZyb21TdHJpbmcodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQpXG4gIH1cblxuICByZXR1cm4gZnJvbU9iamVjdCh0aGF0LCB2YWx1ZSlcbn1cblxuLyoqXG4gKiBGdW5jdGlvbmFsbHkgZXF1aXZhbGVudCB0byBCdWZmZXIoYXJnLCBlbmNvZGluZykgYnV0IHRocm93cyBhIFR5cGVFcnJvclxuICogaWYgdmFsdWUgaXMgYSBudW1iZXIuXG4gKiBCdWZmZXIuZnJvbShzdHJbLCBlbmNvZGluZ10pXG4gKiBCdWZmZXIuZnJvbShhcnJheSlcbiAqIEJ1ZmZlci5mcm9tKGJ1ZmZlcilcbiAqIEJ1ZmZlci5mcm9tKGFycmF5QnVmZmVyWywgYnl0ZU9mZnNldFssIGxlbmd0aF1dKVxuICoqL1xuQnVmZmVyLmZyb20gPSBmdW5jdGlvbiAodmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gZnJvbShudWxsLCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxufVxuXG5pZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgQnVmZmVyLnByb3RvdHlwZS5fX3Byb3RvX18gPSBVaW50OEFycmF5LnByb3RvdHlwZVxuICBCdWZmZXIuX19wcm90b19fID0gVWludDhBcnJheVxuICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnNwZWNpZXMgJiZcbiAgICAgIEJ1ZmZlcltTeW1ib2wuc3BlY2llc10gPT09IEJ1ZmZlcikge1xuICAgIC8vIEZpeCBzdWJhcnJheSgpIGluIEVTMjAxNi4gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZmVyb3NzL2J1ZmZlci9wdWxsLzk3XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1ZmZlciwgU3ltYm9sLnNwZWNpZXMsIHtcbiAgICAgIHZhbHVlOiBudWxsLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSlcbiAgfVxufVxuXG5mdW5jdGlvbiBhc3NlcnRTaXplIChzaXplKSB7XG4gIGlmICh0eXBlb2Ygc2l6ZSAhPT0gJ251bWJlcicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInNpemVcIiBhcmd1bWVudCBtdXN0IGJlIGEgbnVtYmVyJylcbiAgfSBlbHNlIGlmIChzaXplIDwgMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInNpemVcIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBuZWdhdGl2ZScpXG4gIH1cbn1cblxuZnVuY3Rpb24gYWxsb2MgKHRoYXQsIHNpemUsIGZpbGwsIGVuY29kaW5nKSB7XG4gIGFzc2VydFNpemUoc2l6ZSlcbiAgaWYgKHNpemUgPD0gMCkge1xuICAgIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSlcbiAgfVxuICBpZiAoZmlsbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gT25seSBwYXkgYXR0ZW50aW9uIHRvIGVuY29kaW5nIGlmIGl0J3MgYSBzdHJpbmcuIFRoaXNcbiAgICAvLyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgc2VuZGluZyBpbiBhIG51bWJlciB0aGF0IHdvdWxkXG4gICAgLy8gYmUgaW50ZXJwcmV0dGVkIGFzIGEgc3RhcnQgb2Zmc2V0LlxuICAgIHJldHVybiB0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnXG4gICAgICA/IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKS5maWxsKGZpbGwsIGVuY29kaW5nKVxuICAgICAgOiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkuZmlsbChmaWxsKVxuICB9XG4gIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSlcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuXG4gKiBhbGxvYyhzaXplWywgZmlsbFssIGVuY29kaW5nXV0pXG4gKiovXG5CdWZmZXIuYWxsb2MgPSBmdW5jdGlvbiAoc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGFsbG9jKG51bGwsIHNpemUsIGZpbGwsIGVuY29kaW5nKVxufVxuXG5mdW5jdGlvbiBhbGxvY1Vuc2FmZSAodGhhdCwgc2l6ZSkge1xuICBhc3NlcnRTaXplKHNpemUpXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSA8IDAgPyAwIDogY2hlY2tlZChzaXplKSB8IDApXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7ICsraSkge1xuICAgICAgdGhhdFtpXSA9IDBcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuLyoqXG4gKiBFcXVpdmFsZW50IHRvIEJ1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICogKi9cbkJ1ZmZlci5hbGxvY1Vuc2FmZSA9IGZ1bmN0aW9uIChzaXplKSB7XG4gIHJldHVybiBhbGxvY1Vuc2FmZShudWxsLCBzaXplKVxufVxuLyoqXG4gKiBFcXVpdmFsZW50IHRvIFNsb3dCdWZmZXIobnVtKSwgYnkgZGVmYXVsdCBjcmVhdGVzIGEgbm9uLXplcm8tZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS5cbiAqL1xuQnVmZmVyLmFsbG9jVW5zYWZlU2xvdyA9IGZ1bmN0aW9uIChzaXplKSB7XG4gIHJldHVybiBhbGxvY1Vuc2FmZShudWxsLCBzaXplKVxufVxuXG5mdW5jdGlvbiBmcm9tU3RyaW5nICh0aGF0LCBzdHJpbmcsIGVuY29kaW5nKSB7XG4gIGlmICh0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnIHx8IGVuY29kaW5nID09PSAnJykge1xuICAgIGVuY29kaW5nID0gJ3V0ZjgnXG4gIH1cblxuICBpZiAoIUJ1ZmZlci5pc0VuY29kaW5nKGVuY29kaW5nKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiZW5jb2RpbmdcIiBtdXN0IGJlIGEgdmFsaWQgc3RyaW5nIGVuY29kaW5nJylcbiAgfVxuXG4gIHZhciBsZW5ndGggPSBieXRlTGVuZ3RoKHN0cmluZywgZW5jb2RpbmcpIHwgMFxuICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbmd0aClcblxuICB2YXIgYWN0dWFsID0gdGhhdC53cml0ZShzdHJpbmcsIGVuY29kaW5nKVxuXG4gIGlmIChhY3R1YWwgIT09IGxlbmd0aCkge1xuICAgIC8vIFdyaXRpbmcgYSBoZXggc3RyaW5nLCBmb3IgZXhhbXBsZSwgdGhhdCBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMgd2lsbFxuICAgIC8vIGNhdXNlIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGZpcnN0IGludmFsaWQgY2hhcmFjdGVyIHRvIGJlIGlnbm9yZWQuIChlLmcuXG4gICAgLy8gJ2FieHhjZCcgd2lsbCBiZSB0cmVhdGVkIGFzICdhYicpXG4gICAgdGhhdCA9IHRoYXQuc2xpY2UoMCwgYWN0dWFsKVxuICB9XG5cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5TGlrZSAodGhhdCwgYXJyYXkpIHtcbiAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCA8IDAgPyAwIDogY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMFxuICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbmd0aClcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgIHRoYXRbaV0gPSBhcnJheVtpXSAmIDI1NVxuICB9XG4gIHJldHVybiB0aGF0XG59XG5cbmZ1bmN0aW9uIGZyb21BcnJheUJ1ZmZlciAodGhhdCwgYXJyYXksIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICBhcnJheS5ieXRlTGVuZ3RoIC8vIHRoaXMgdGhyb3dzIGlmIGBhcnJheWAgaXMgbm90IGEgdmFsaWQgQXJyYXlCdWZmZXJcblxuICBpZiAoYnl0ZU9mZnNldCA8IDAgfHwgYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXFwnb2Zmc2V0XFwnIGlzIG91dCBvZiBib3VuZHMnKVxuICB9XG5cbiAgaWYgKGFycmF5LmJ5dGVMZW5ndGggPCBieXRlT2Zmc2V0ICsgKGxlbmd0aCB8fCAwKSkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcXCdsZW5ndGhcXCcgaXMgb3V0IG9mIGJvdW5kcycpXG4gIH1cblxuICBpZiAoYnl0ZU9mZnNldCA9PT0gdW5kZWZpbmVkICYmIGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSlcbiAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXksIGJ5dGVPZmZzZXQpXG4gIH0gZWxzZSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlXG4gICAgdGhhdCA9IGFycmF5XG4gICAgdGhhdC5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIH0gZWxzZSB7XG4gICAgLy8gRmFsbGJhY2s6IFJldHVybiBhbiBvYmplY3QgaW5zdGFuY2Ugb2YgdGhlIEJ1ZmZlciBjbGFzc1xuICAgIHRoYXQgPSBmcm9tQXJyYXlMaWtlKHRoYXQsIGFycmF5KVxuICB9XG4gIHJldHVybiB0aGF0XG59XG5cbmZ1bmN0aW9uIGZyb21PYmplY3QgKHRoYXQsIG9iaikge1xuICBpZiAoQnVmZmVyLmlzQnVmZmVyKG9iaikpIHtcbiAgICB2YXIgbGVuID0gY2hlY2tlZChvYmoubGVuZ3RoKSB8IDBcbiAgICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbilcblxuICAgIGlmICh0aGF0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRoYXRcbiAgICB9XG5cbiAgICBvYmouY29weSh0aGF0LCAwLCAwLCBsZW4pXG4gICAgcmV0dXJuIHRoYXRcbiAgfVxuXG4gIGlmIChvYmopIHtcbiAgICBpZiAoKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgb2JqLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB8fCAnbGVuZ3RoJyBpbiBvYmopIHtcbiAgICAgIGlmICh0eXBlb2Ygb2JqLmxlbmd0aCAhPT0gJ251bWJlcicgfHwgaXNuYW4ob2JqLmxlbmd0aCkpIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCAwKVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqKVxuICAgIH1cblxuICAgIGlmIChvYmoudHlwZSA9PT0gJ0J1ZmZlcicgJiYgaXNBcnJheShvYmouZGF0YSkpIHtcbiAgICAgIHJldHVybiBmcm9tQXJyYXlMaWtlKHRoYXQsIG9iai5kYXRhKVxuICAgIH1cbiAgfVxuXG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgQXJyYXlCdWZmZXIsIEFycmF5LCBvciBhcnJheS1saWtlIG9iamVjdC4nKVxufVxuXG5mdW5jdGlvbiBjaGVja2VkIChsZW5ndGgpIHtcbiAgLy8gTm90ZTogY2Fubm90IHVzZSBgbGVuZ3RoIDwga01heExlbmd0aCgpYCBoZXJlIGJlY2F1c2UgdGhhdCBmYWlscyB3aGVuXG4gIC8vIGxlbmd0aCBpcyBOYU4gKHdoaWNoIGlzIG90aGVyd2lzZSBjb2VyY2VkIHRvIHplcm8uKVxuICBpZiAobGVuZ3RoID49IGtNYXhMZW5ndGgoKSkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICdzaXplOiAweCcgKyBrTWF4TGVuZ3RoKCkudG9TdHJpbmcoMTYpICsgJyBieXRlcycpXG4gIH1cbiAgcmV0dXJuIGxlbmd0aCB8IDBcbn1cblxuZnVuY3Rpb24gU2xvd0J1ZmZlciAobGVuZ3RoKSB7XG4gIGlmICgrbGVuZ3RoICE9IGxlbmd0aCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGVxZXFlcVxuICAgIGxlbmd0aCA9IDBcbiAgfVxuICByZXR1cm4gQnVmZmVyLmFsbG9jKCtsZW5ndGgpXG59XG5cbkJ1ZmZlci5pc0J1ZmZlciA9IGZ1bmN0aW9uIGlzQnVmZmVyIChiKSB7XG4gIHJldHVybiAhIShiICE9IG51bGwgJiYgYi5faXNCdWZmZXIpXG59XG5cbkJ1ZmZlci5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAoYSwgYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihhKSB8fCAhQnVmZmVyLmlzQnVmZmVyKGIpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnRzIG11c3QgYmUgQnVmZmVycycpXG4gIH1cblxuICBpZiAoYSA9PT0gYikgcmV0dXJuIDBcblxuICB2YXIgeCA9IGEubGVuZ3RoXG4gIHZhciB5ID0gYi5sZW5ndGhcblxuICBmb3IgKHZhciBpID0gMCwgbGVuID0gTWF0aC5taW4oeCwgeSk7IGkgPCBsZW47ICsraSkge1xuICAgIGlmIChhW2ldICE9PSBiW2ldKSB7XG4gICAgICB4ID0gYVtpXVxuICAgICAgeSA9IGJbaV1cbiAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgaWYgKHggPCB5KSByZXR1cm4gLTFcbiAgaWYgKHkgPCB4KSByZXR1cm4gMVxuICByZXR1cm4gMFxufVxuXG5CdWZmZXIuaXNFbmNvZGluZyA9IGZ1bmN0aW9uIGlzRW5jb2RpbmcgKGVuY29kaW5nKSB7XG4gIHN3aXRjaCAoU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSAnaGV4JzpcbiAgICBjYXNlICd1dGY4JzpcbiAgICBjYXNlICd1dGYtOCc6XG4gICAgY2FzZSAnYXNjaWknOlxuICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgY2FzZSAnYmluYXJ5JzpcbiAgICBjYXNlICdiYXNlNjQnOlxuICAgIGNhc2UgJ3VjczInOlxuICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICBjYXNlICd1dGYxNmxlJzpcbiAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuXG5CdWZmZXIuY29uY2F0ID0gZnVuY3Rpb24gY29uY2F0IChsaXN0LCBsZW5ndGgpIHtcbiAgaWYgKCFpc0FycmF5KGxpc3QpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0XCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJylcbiAgfVxuXG4gIGlmIChsaXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBCdWZmZXIuYWxsb2MoMClcbiAgfVxuXG4gIHZhciBpXG4gIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgIGxlbmd0aCA9IDBcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7ICsraSkge1xuICAgICAgbGVuZ3RoICs9IGxpc3RbaV0ubGVuZ3RoXG4gICAgfVxuICB9XG5cbiAgdmFyIGJ1ZmZlciA9IEJ1ZmZlci5hbGxvY1Vuc2FmZShsZW5ndGgpXG4gIHZhciBwb3MgPSAwXG4gIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGJ1ZiA9IGxpc3RbaV1cbiAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImxpc3RcIiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKVxuICAgIH1cbiAgICBidWYuY29weShidWZmZXIsIHBvcylcbiAgICBwb3MgKz0gYnVmLmxlbmd0aFxuICB9XG4gIHJldHVybiBidWZmZXJcbn1cblxuZnVuY3Rpb24gYnl0ZUxlbmd0aCAoc3RyaW5nLCBlbmNvZGluZykge1xuICBpZiAoQnVmZmVyLmlzQnVmZmVyKHN0cmluZykpIHtcbiAgICByZXR1cm4gc3RyaW5nLmxlbmd0aFxuICB9XG4gIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBBcnJheUJ1ZmZlci5pc1ZpZXcgPT09ICdmdW5jdGlvbicgJiZcbiAgICAgIChBcnJheUJ1ZmZlci5pc1ZpZXcoc3RyaW5nKSB8fCBzdHJpbmcgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikpIHtcbiAgICByZXR1cm4gc3RyaW5nLmJ5dGVMZW5ndGhcbiAgfVxuICBpZiAodHlwZW9mIHN0cmluZyAhPT0gJ3N0cmluZycpIHtcbiAgICBzdHJpbmcgPSAnJyArIHN0cmluZ1xuICB9XG5cbiAgdmFyIGxlbiA9IHN0cmluZy5sZW5ndGhcbiAgaWYgKGxlbiA9PT0gMCkgcmV0dXJuIDBcblxuICAvLyBVc2UgYSBmb3IgbG9vcCB0byBhdm9pZCByZWN1cnNpb25cbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcbiAgZm9yICg7Oykge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICByZXR1cm4gbGVuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgIGNhc2UgdW5kZWZpbmVkOlxuICAgICAgICByZXR1cm4gdXRmOFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGhcbiAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgIHJldHVybiBsZW4gKiAyXG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gbGVuID4+PiAxXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICByZXR1cm4gYmFzZTY0VG9CeXRlcyhzdHJpbmcpLmxlbmd0aFxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSByZXR1cm4gdXRmOFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGggLy8gYXNzdW1lIHV0ZjhcbiAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cbkJ1ZmZlci5ieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aFxuXG5mdW5jdGlvbiBzbG93VG9TdHJpbmcgKGVuY29kaW5nLCBzdGFydCwgZW5kKSB7XG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG5cbiAgLy8gTm8gbmVlZCB0byB2ZXJpZnkgdGhhdCBcInRoaXMubGVuZ3RoIDw9IE1BWF9VSU5UMzJcIiBzaW5jZSBpdCdzIGEgcmVhZC1vbmx5XG4gIC8vIHByb3BlcnR5IG9mIGEgdHlwZWQgYXJyYXkuXG5cbiAgLy8gVGhpcyBiZWhhdmVzIG5laXRoZXIgbGlrZSBTdHJpbmcgbm9yIFVpbnQ4QXJyYXkgaW4gdGhhdCB3ZSBzZXQgc3RhcnQvZW5kXG4gIC8vIHRvIHRoZWlyIHVwcGVyL2xvd2VyIGJvdW5kcyBpZiB0aGUgdmFsdWUgcGFzc2VkIGlzIG91dCBvZiByYW5nZS5cbiAgLy8gdW5kZWZpbmVkIGlzIGhhbmRsZWQgc3BlY2lhbGx5IGFzIHBlciBFQ01BLTI2MiA2dGggRWRpdGlvbixcbiAgLy8gU2VjdGlvbiAxMy4zLjMuNyBSdW50aW1lIFNlbWFudGljczogS2V5ZWRCaW5kaW5nSW5pdGlhbGl6YXRpb24uXG4gIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkIHx8IHN0YXJ0IDwgMCkge1xuICAgIHN0YXJ0ID0gMFxuICB9XG4gIC8vIFJldHVybiBlYXJseSBpZiBzdGFydCA+IHRoaXMubGVuZ3RoLiBEb25lIGhlcmUgdG8gcHJldmVudCBwb3RlbnRpYWwgdWludDMyXG4gIC8vIGNvZXJjaW9uIGZhaWwgYmVsb3cuXG4gIGlmIChzdGFydCA+IHRoaXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuICcnXG4gIH1cblxuICBpZiAoZW5kID09PSB1bmRlZmluZWQgfHwgZW5kID4gdGhpcy5sZW5ndGgpIHtcbiAgICBlbmQgPSB0aGlzLmxlbmd0aFxuICB9XG5cbiAgaWYgKGVuZCA8PSAwKSB7XG4gICAgcmV0dXJuICcnXG4gIH1cblxuICAvLyBGb3JjZSBjb2Vyc2lvbiB0byB1aW50MzIuIFRoaXMgd2lsbCBhbHNvIGNvZXJjZSBmYWxzZXkvTmFOIHZhbHVlcyB0byAwLlxuICBlbmQgPj4+PSAwXG4gIHN0YXJ0ID4+Pj0gMFxuXG4gIGlmIChlbmQgPD0gc3RhcnQpIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG5cbiAgd2hpbGUgKHRydWUpIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gaGV4U2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAndXRmOCc6XG4gICAgICBjYXNlICd1dGYtOCc6XG4gICAgICAgIHJldHVybiB1dGY4U2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICByZXR1cm4gYXNjaWlTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICdsYXRpbjEnOlxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGxhdGluMVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9IChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG4vLyBUaGUgcHJvcGVydHkgaXMgdXNlZCBieSBgQnVmZmVyLmlzQnVmZmVyYCBhbmQgYGlzLWJ1ZmZlcmAgKGluIFNhZmFyaSA1LTcpIHRvIGRldGVjdFxuLy8gQnVmZmVyIGluc3RhbmNlcy5cbkJ1ZmZlci5wcm90b3R5cGUuX2lzQnVmZmVyID0gdHJ1ZVxuXG5mdW5jdGlvbiBzd2FwIChiLCBuLCBtKSB7XG4gIHZhciBpID0gYltuXVxuICBiW25dID0gYlttXVxuICBiW21dID0gaVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnN3YXAxNiA9IGZ1bmN0aW9uIHN3YXAxNiAoKSB7XG4gIHZhciBsZW4gPSB0aGlzLmxlbmd0aFxuICBpZiAobGVuICUgMiAhPT0gMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMTYtYml0cycpXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikge1xuICAgIHN3YXAodGhpcywgaSwgaSArIDEpXG4gIH1cbiAgcmV0dXJuIHRoaXNcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5zd2FwMzIgPSBmdW5jdGlvbiBzd2FwMzIgKCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgaWYgKGxlbiAlIDQgIT09IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDMyLWJpdHMnKVxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpIHtcbiAgICBzd2FwKHRoaXMsIGksIGkgKyAzKVxuICAgIHN3YXAodGhpcywgaSArIDEsIGkgKyAyKVxuICB9XG4gIHJldHVybiB0aGlzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDY0ID0gZnVuY3Rpb24gc3dhcDY0ICgpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIGlmIChsZW4gJSA4ICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA2NC1iaXRzJylcbiAgfVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSA4KSB7XG4gICAgc3dhcCh0aGlzLCBpLCBpICsgNylcbiAgICBzd2FwKHRoaXMsIGkgKyAxLCBpICsgNilcbiAgICBzd2FwKHRoaXMsIGkgKyAyLCBpICsgNSlcbiAgICBzd2FwKHRoaXMsIGkgKyAzLCBpICsgNClcbiAgfVxuICByZXR1cm4gdGhpc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkge1xuICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGggfCAwXG4gIGlmIChsZW5ndGggPT09IDApIHJldHVybiAnJ1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCAwLCBsZW5ndGgpXG4gIHJldHVybiBzbG93VG9TdHJpbmcuYXBwbHkodGhpcywgYXJndW1lbnRzKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIGVxdWFscyAoYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIGlmICh0aGlzID09PSBiKSByZXR1cm4gdHJ1ZVxuICByZXR1cm4gQnVmZmVyLmNvbXBhcmUodGhpcywgYikgPT09IDBcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbnNwZWN0ID0gZnVuY3Rpb24gaW5zcGVjdCAoKSB7XG4gIHZhciBzdHIgPSAnJ1xuICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFU1xuICBpZiAodGhpcy5sZW5ndGggPiAwKSB7XG4gICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJylcbiAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpIHN0ciArPSAnIC4uLiAnXG4gIH1cbiAgcmV0dXJuICc8QnVmZmVyICcgKyBzdHIgKyAnPidcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAodGFyZ2V0LCBzdGFydCwgZW5kLCB0aGlzU3RhcnQsIHRoaXNFbmQpIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIodGFyZ2V0KSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKVxuICB9XG5cbiAgaWYgKHN0YXJ0ID09PSB1bmRlZmluZWQpIHtcbiAgICBzdGFydCA9IDBcbiAgfVxuICBpZiAoZW5kID09PSB1bmRlZmluZWQpIHtcbiAgICBlbmQgPSB0YXJnZXQgPyB0YXJnZXQubGVuZ3RoIDogMFxuICB9XG4gIGlmICh0aGlzU3RhcnQgPT09IHVuZGVmaW5lZCkge1xuICAgIHRoaXNTdGFydCA9IDBcbiAgfVxuICBpZiAodGhpc0VuZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpc0VuZCA9IHRoaXMubGVuZ3RoXG4gIH1cblxuICBpZiAoc3RhcnQgPCAwIHx8IGVuZCA+IHRhcmdldC5sZW5ndGggfHwgdGhpc1N0YXJ0IDwgMCB8fCB0aGlzRW5kID4gdGhpcy5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignb3V0IG9mIHJhbmdlIGluZGV4JylcbiAgfVxuXG4gIGlmICh0aGlzU3RhcnQgPj0gdGhpc0VuZCAmJiBzdGFydCA+PSBlbmQpIHtcbiAgICByZXR1cm4gMFxuICB9XG4gIGlmICh0aGlzU3RhcnQgPj0gdGhpc0VuZCkge1xuICAgIHJldHVybiAtMVxuICB9XG4gIGlmIChzdGFydCA+PSBlbmQpIHtcbiAgICByZXR1cm4gMVxuICB9XG5cbiAgc3RhcnQgPj4+PSAwXG4gIGVuZCA+Pj49IDBcbiAgdGhpc1N0YXJ0ID4+Pj0gMFxuICB0aGlzRW5kID4+Pj0gMFxuXG4gIGlmICh0aGlzID09PSB0YXJnZXQpIHJldHVybiAwXG5cbiAgdmFyIHggPSB0aGlzRW5kIC0gdGhpc1N0YXJ0XG4gIHZhciB5ID0gZW5kIC0gc3RhcnRcbiAgdmFyIGxlbiA9IE1hdGgubWluKHgsIHkpXG5cbiAgdmFyIHRoaXNDb3B5ID0gdGhpcy5zbGljZSh0aGlzU3RhcnQsIHRoaXNFbmQpXG4gIHZhciB0YXJnZXRDb3B5ID0gdGFyZ2V0LnNsaWNlKHN0YXJ0LCBlbmQpXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgIGlmICh0aGlzQ29weVtpXSAhPT0gdGFyZ2V0Q29weVtpXSkge1xuICAgICAgeCA9IHRoaXNDb3B5W2ldXG4gICAgICB5ID0gdGFyZ2V0Q29weVtpXVxuICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbi8vIEZpbmRzIGVpdGhlciB0aGUgZmlyc3QgaW5kZXggb2YgYHZhbGAgaW4gYGJ1ZmZlcmAgYXQgb2Zmc2V0ID49IGBieXRlT2Zmc2V0YCxcbi8vIE9SIHRoZSBsYXN0IGluZGV4IG9mIGB2YWxgIGluIGBidWZmZXJgIGF0IG9mZnNldCA8PSBgYnl0ZU9mZnNldGAuXG4vL1xuLy8gQXJndW1lbnRzOlxuLy8gLSBidWZmZXIgLSBhIEJ1ZmZlciB0byBzZWFyY2hcbi8vIC0gdmFsIC0gYSBzdHJpbmcsIEJ1ZmZlciwgb3IgbnVtYmVyXG4vLyAtIGJ5dGVPZmZzZXQgLSBhbiBpbmRleCBpbnRvIGBidWZmZXJgOyB3aWxsIGJlIGNsYW1wZWQgdG8gYW4gaW50MzJcbi8vIC0gZW5jb2RpbmcgLSBhbiBvcHRpb25hbCBlbmNvZGluZywgcmVsZXZhbnQgaXMgdmFsIGlzIGEgc3RyaW5nXG4vLyAtIGRpciAtIHRydWUgZm9yIGluZGV4T2YsIGZhbHNlIGZvciBsYXN0SW5kZXhPZlxuZnVuY3Rpb24gYmlkaXJlY3Rpb25hbEluZGV4T2YgKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKSB7XG4gIC8vIEVtcHR5IGJ1ZmZlciBtZWFucyBubyBtYXRjaFxuICBpZiAoYnVmZmVyLmxlbmd0aCA9PT0gMCkgcmV0dXJuIC0xXG5cbiAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXRcbiAgaWYgKHR5cGVvZiBieXRlT2Zmc2V0ID09PSAnc3RyaW5nJykge1xuICAgIGVuY29kaW5nID0gYnl0ZU9mZnNldFxuICAgIGJ5dGVPZmZzZXQgPSAwXG4gIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA+IDB4N2ZmZmZmZmYpIHtcbiAgICBieXRlT2Zmc2V0ID0gMHg3ZmZmZmZmZlxuICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAtMHg4MDAwMDAwMCkge1xuICAgIGJ5dGVPZmZzZXQgPSAtMHg4MDAwMDAwMFxuICB9XG4gIGJ5dGVPZmZzZXQgPSArYnl0ZU9mZnNldCAgLy8gQ29lcmNlIHRvIE51bWJlci5cbiAgaWYgKGlzTmFOKGJ5dGVPZmZzZXQpKSB7XG4gICAgLy8gYnl0ZU9mZnNldDogaXQgaXQncyB1bmRlZmluZWQsIG51bGwsIE5hTiwgXCJmb29cIiwgZXRjLCBzZWFyY2ggd2hvbGUgYnVmZmVyXG4gICAgYnl0ZU9mZnNldCA9IGRpciA/IDAgOiAoYnVmZmVyLmxlbmd0aCAtIDEpXG4gIH1cblxuICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldDogbmVnYXRpdmUgb2Zmc2V0cyBzdGFydCBmcm9tIHRoZSBlbmQgb2YgdGhlIGJ1ZmZlclxuICBpZiAoYnl0ZU9mZnNldCA8IDApIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoICsgYnl0ZU9mZnNldFxuICBpZiAoYnl0ZU9mZnNldCA+PSBidWZmZXIubGVuZ3RoKSB7XG4gICAgaWYgKGRpcikgcmV0dXJuIC0xXG4gICAgZWxzZSBieXRlT2Zmc2V0ID0gYnVmZmVyLmxlbmd0aCAtIDFcbiAgfSBlbHNlIGlmIChieXRlT2Zmc2V0IDwgMCkge1xuICAgIGlmIChkaXIpIGJ5dGVPZmZzZXQgPSAwXG4gICAgZWxzZSByZXR1cm4gLTFcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSB2YWxcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XG4gICAgdmFsID0gQnVmZmVyLmZyb20odmFsLCBlbmNvZGluZylcbiAgfVxuXG4gIC8vIEZpbmFsbHksIHNlYXJjaCBlaXRoZXIgaW5kZXhPZiAoaWYgZGlyIGlzIHRydWUpIG9yIGxhc3RJbmRleE9mXG4gIGlmIChCdWZmZXIuaXNCdWZmZXIodmFsKSkge1xuICAgIC8vIFNwZWNpYWwgY2FzZTogbG9va2luZyBmb3IgZW1wdHkgc3RyaW5nL2J1ZmZlciBhbHdheXMgZmFpbHNcbiAgICBpZiAodmFsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIC0xXG4gICAgfVxuICAgIHJldHVybiBhcnJheUluZGV4T2YoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpXG4gIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICB2YWwgPSB2YWwgJiAweEZGIC8vIFNlYXJjaCBmb3IgYSBieXRlIHZhbHVlIFswLTI1NV1cbiAgICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgJiZcbiAgICAgICAgdHlwZW9mIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGlmIChkaXIpIHtcbiAgICAgICAgcmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5sYXN0SW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXlJbmRleE9mKGJ1ZmZlciwgWyB2YWwgXSwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcilcbiAgfVxuXG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIHN0cmluZywgbnVtYmVyIG9yIEJ1ZmZlcicpXG59XG5cbmZ1bmN0aW9uIGFycmF5SW5kZXhPZiAoYXJyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHtcbiAgdmFyIGluZGV4U2l6ZSA9IDFcbiAgdmFyIGFyckxlbmd0aCA9IGFyci5sZW5ndGhcbiAgdmFyIHZhbExlbmd0aCA9IHZhbC5sZW5ndGhcblxuICBpZiAoZW5jb2RpbmcgIT09IHVuZGVmaW5lZCkge1xuICAgIGVuY29kaW5nID0gU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgaWYgKGVuY29kaW5nID09PSAndWNzMicgfHwgZW5jb2RpbmcgPT09ICd1Y3MtMicgfHxcbiAgICAgICAgZW5jb2RpbmcgPT09ICd1dGYxNmxlJyB8fCBlbmNvZGluZyA9PT0gJ3V0Zi0xNmxlJykge1xuICAgICAgaWYgKGFyci5sZW5ndGggPCAyIHx8IHZhbC5sZW5ndGggPCAyKSB7XG4gICAgICAgIHJldHVybiAtMVxuICAgICAgfVxuICAgICAgaW5kZXhTaXplID0gMlxuICAgICAgYXJyTGVuZ3RoIC89IDJcbiAgICAgIHZhbExlbmd0aCAvPSAyXG4gICAgICBieXRlT2Zmc2V0IC89IDJcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByZWFkIChidWYsIGkpIHtcbiAgICBpZiAoaW5kZXhTaXplID09PSAxKSB7XG4gICAgICByZXR1cm4gYnVmW2ldXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBidWYucmVhZFVJbnQxNkJFKGkgKiBpbmRleFNpemUpXG4gICAgfVxuICB9XG5cbiAgdmFyIGlcbiAgaWYgKGRpcikge1xuICAgIHZhciBmb3VuZEluZGV4ID0gLTFcbiAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpIDwgYXJyTGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChyZWFkKGFyciwgaSkgPT09IHJlYWQodmFsLCBmb3VuZEluZGV4ID09PSAtMSA/IDAgOiBpIC0gZm91bmRJbmRleCkpIHtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggPT09IC0xKSBmb3VuZEluZGV4ID0gaVxuICAgICAgICBpZiAoaSAtIGZvdW5kSW5kZXggKyAxID09PSB2YWxMZW5ndGgpIHJldHVybiBmb3VuZEluZGV4ICogaW5kZXhTaXplXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZm91bmRJbmRleCAhPT0gLTEpIGkgLT0gaSAtIGZvdW5kSW5kZXhcbiAgICAgICAgZm91bmRJbmRleCA9IC0xXG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmIChieXRlT2Zmc2V0ICsgdmFsTGVuZ3RoID4gYXJyTGVuZ3RoKSBieXRlT2Zmc2V0ID0gYXJyTGVuZ3RoIC0gdmFsTGVuZ3RoXG4gICAgZm9yIChpID0gYnl0ZU9mZnNldDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIHZhciBmb3VuZCA9IHRydWVcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdmFsTGVuZ3RoOyBqKyspIHtcbiAgICAgICAgaWYgKHJlYWQoYXJyLCBpICsgaikgIT09IHJlYWQodmFsLCBqKSkge1xuICAgICAgICAgIGZvdW5kID0gZmFsc2VcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZm91bmQpIHJldHVybiBpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIC0xXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuaW5jbHVkZXMgPSBmdW5jdGlvbiBpbmNsdWRlcyAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICByZXR1cm4gdGhpcy5pbmRleE9mKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpICE9PSAtMVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiBpbmRleE9mICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7XG4gIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCB0cnVlKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmxhc3RJbmRleE9mID0gZnVuY3Rpb24gbGFzdEluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGZhbHNlKVxufVxuXG5mdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDBcbiAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXRcbiAgaWYgKCFsZW5ndGgpIHtcbiAgICBsZW5ndGggPSByZW1haW5pbmdcbiAgfSBlbHNlIHtcbiAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKVxuICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHtcbiAgICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICAgIH1cbiAgfVxuXG4gIC8vIG11c3QgYmUgYW4gZXZlbiBudW1iZXIgb2YgZGlnaXRzXG4gIHZhciBzdHJMZW4gPSBzdHJpbmcubGVuZ3RoXG4gIGlmIChzdHJMZW4gJSAyICE9PSAwKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGhleCBzdHJpbmcnKVxuXG4gIGlmIChsZW5ndGggPiBzdHJMZW4gLyAyKSB7XG4gICAgbGVuZ3RoID0gc3RyTGVuIC8gMlxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgcGFyc2VkID0gcGFyc2VJbnQoc3RyaW5nLnN1YnN0cihpICogMiwgMiksIDE2KVxuICAgIGlmIChpc05hTihwYXJzZWQpKSByZXR1cm4gaVxuICAgIGJ1ZltvZmZzZXQgKyBpXSA9IHBhcnNlZFxuICB9XG4gIHJldHVybiBpXG59XG5cbmZ1bmN0aW9uIHV0ZjhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKHV0ZjhUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIGFzY2lpV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcihhc2NpaVRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gbGF0aW4xV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYXNjaWlXcml0ZShidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIGJhc2U2NFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIoYmFzZTY0VG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiB1Y3MyV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcih1dGYxNmxlVG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gd3JpdGUgKHN0cmluZywgb2Zmc2V0LCBsZW5ndGgsIGVuY29kaW5nKSB7XG4gIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcpXG4gIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgIGVuY29kaW5nID0gJ3V0ZjgnXG4gICAgbGVuZ3RoID0gdGhpcy5sZW5ndGhcbiAgICBvZmZzZXQgPSAwXG4gIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIGVuY29kaW5nKVxuICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiBvZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgZW5jb2RpbmcgPSBvZmZzZXRcbiAgICBsZW5ndGggPSB0aGlzLmxlbmd0aFxuICAgIG9mZnNldCA9IDBcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgb2Zmc2V0WywgbGVuZ3RoXVssIGVuY29kaW5nXSlcbiAgfSBlbHNlIGlmIChpc0Zpbml0ZShvZmZzZXQpKSB7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICAgIGlmIChpc0Zpbml0ZShsZW5ndGgpKSB7XG4gICAgICBsZW5ndGggPSBsZW5ndGggfCAwXG4gICAgICBpZiAoZW5jb2RpbmcgPT09IHVuZGVmaW5lZCkgZW5jb2RpbmcgPSAndXRmOCdcbiAgICB9IGVsc2Uge1xuICAgICAgZW5jb2RpbmcgPSBsZW5ndGhcbiAgICAgIGxlbmd0aCA9IHVuZGVmaW5lZFxuICAgIH1cbiAgLy8gbGVnYWN5IHdyaXRlKHN0cmluZywgZW5jb2RpbmcsIG9mZnNldCwgbGVuZ3RoKSAtIHJlbW92ZSBpbiB2MC4xM1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICdCdWZmZXIud3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0WywgbGVuZ3RoXSkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCdcbiAgICApXG4gIH1cblxuICB2YXIgcmVtYWluaW5nID0gdGhpcy5sZW5ndGggLSBvZmZzZXRcbiAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkIHx8IGxlbmd0aCA+IHJlbWFpbmluZykgbGVuZ3RoID0gcmVtYWluaW5nXG5cbiAgaWYgKChzdHJpbmcubGVuZ3RoID4gMCAmJiAobGVuZ3RoIDwgMCB8fCBvZmZzZXQgPCAwKSkgfHwgb2Zmc2V0ID4gdGhpcy5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQXR0ZW1wdCB0byB3cml0ZSBvdXRzaWRlIGJ1ZmZlciBib3VuZHMnKVxuICB9XG5cbiAgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSAndXRmOCdcblxuICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZVxuICBmb3IgKDs7KSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGhleFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgICByZXR1cm4gdXRmOFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgICAgcmV0dXJuIGFzY2lpV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBsYXRpbjFXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICAvLyBXYXJuaW5nOiBtYXhMZW5ndGggbm90IHRha2VuIGludG8gYWNjb3VudCBpbiBiYXNlNjRXcml0ZVxuICAgICAgICByZXR1cm4gYmFzZTY0V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIHVjczJXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04gKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdCdWZmZXInLFxuICAgIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKVxuICB9XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKHN0YXJ0ID09PSAwICYmIGVuZCA9PT0gYnVmLmxlbmd0aCkge1xuICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1Zi5zbGljZShzdGFydCwgZW5kKSlcbiAgfVxufVxuXG5mdW5jdGlvbiB1dGY4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG4gIHZhciByZXMgPSBbXVxuXG4gIHZhciBpID0gc3RhcnRcbiAgd2hpbGUgKGkgPCBlbmQpIHtcbiAgICB2YXIgZmlyc3RCeXRlID0gYnVmW2ldXG4gICAgdmFyIGNvZGVQb2ludCA9IG51bGxcbiAgICB2YXIgYnl0ZXNQZXJTZXF1ZW5jZSA9IChmaXJzdEJ5dGUgPiAweEVGKSA/IDRcbiAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4REYpID8gM1xuICAgICAgOiAoZmlyc3RCeXRlID4gMHhCRikgPyAyXG4gICAgICA6IDFcblxuICAgIGlmIChpICsgYnl0ZXNQZXJTZXF1ZW5jZSA8PSBlbmQpIHtcbiAgICAgIHZhciBzZWNvbmRCeXRlLCB0aGlyZEJ5dGUsIGZvdXJ0aEJ5dGUsIHRlbXBDb2RlUG9pbnRcblxuICAgICAgc3dpdGNoIChieXRlc1BlclNlcXVlbmNlKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBpZiAoZmlyc3RCeXRlIDwgMHg4MCkge1xuICAgICAgICAgICAgY29kZVBvaW50ID0gZmlyc3RCeXRlXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4MUYpIDw8IDB4NiB8IChzZWNvbmRCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3Rikge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweEMgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4NiB8ICh0aGlyZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGRiAmJiAodGVtcENvZGVQb2ludCA8IDB4RDgwMCB8fCB0ZW1wQ29kZVBvaW50ID4gMHhERkZGKSkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBmb3VydGhCeXRlID0gYnVmW2kgKyAzXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAoZm91cnRoQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHgxMiB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHhDIHwgKHRoaXJkQnl0ZSAmIDB4M0YpIDw8IDB4NiB8IChmb3VydGhCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHhGRkZGICYmIHRlbXBDb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjb2RlUG9pbnQgPT09IG51bGwpIHtcbiAgICAgIC8vIHdlIGRpZCBub3QgZ2VuZXJhdGUgYSB2YWxpZCBjb2RlUG9pbnQgc28gaW5zZXJ0IGFcbiAgICAgIC8vIHJlcGxhY2VtZW50IGNoYXIgKFUrRkZGRCkgYW5kIGFkdmFuY2Ugb25seSAxIGJ5dGVcbiAgICAgIGNvZGVQb2ludCA9IDB4RkZGRFxuICAgICAgYnl0ZXNQZXJTZXF1ZW5jZSA9IDFcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA+IDB4RkZGRikge1xuICAgICAgLy8gZW5jb2RlIHRvIHV0ZjE2IChzdXJyb2dhdGUgcGFpciBkYW5jZSlcbiAgICAgIGNvZGVQb2ludCAtPSAweDEwMDAwXG4gICAgICByZXMucHVzaChjb2RlUG9pbnQgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApXG4gICAgICBjb2RlUG9pbnQgPSAweERDMDAgfCBjb2RlUG9pbnQgJiAweDNGRlxuICAgIH1cblxuICAgIHJlcy5wdXNoKGNvZGVQb2ludClcbiAgICBpICs9IGJ5dGVzUGVyU2VxdWVuY2VcbiAgfVxuXG4gIHJldHVybiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkocmVzKVxufVxuXG4vLyBCYXNlZCBvbiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMjc0NzI3Mi82ODA3NDIsIHRoZSBicm93c2VyIHdpdGhcbi8vIHRoZSBsb3dlc3QgbGltaXQgaXMgQ2hyb21lLCB3aXRoIDB4MTAwMDAgYXJncy5cbi8vIFdlIGdvIDEgbWFnbml0dWRlIGxlc3MsIGZvciBzYWZldHlcbnZhciBNQVhfQVJHVU1FTlRTX0xFTkdUSCA9IDB4MTAwMFxuXG5mdW5jdGlvbiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkgKGNvZGVQb2ludHMpIHtcbiAgdmFyIGxlbiA9IGNvZGVQb2ludHMubGVuZ3RoXG4gIGlmIChsZW4gPD0gTUFYX0FSR1VNRU5UU19MRU5HVEgpIHtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGNvZGVQb2ludHMpIC8vIGF2b2lkIGV4dHJhIHNsaWNlKClcbiAgfVxuXG4gIC8vIERlY29kZSBpbiBjaHVua3MgdG8gYXZvaWQgXCJjYWxsIHN0YWNrIHNpemUgZXhjZWVkZWRcIi5cbiAgdmFyIHJlcyA9ICcnXG4gIHZhciBpID0gMFxuICB3aGlsZSAoaSA8IGxlbikge1xuICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFxuICAgICAgU3RyaW5nLFxuICAgICAgY29kZVBvaW50cy5zbGljZShpLCBpICs9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKVxuICAgIClcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbmZ1bmN0aW9uIGFzY2lpU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldICYgMHg3RilcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGxhdGluMVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHJldCA9ICcnXG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcblxuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSlcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGhleFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IGJ1Zi5sZW5ndGhcblxuICBpZiAoIXN0YXJ0IHx8IHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIGlmICghZW5kIHx8IGVuZCA8IDAgfHwgZW5kID4gbGVuKSBlbmQgPSBsZW5cblxuICB2YXIgb3V0ID0gJydcbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICBvdXQgKz0gdG9IZXgoYnVmW2ldKVxuICB9XG4gIHJldHVybiBvdXRcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGJ5dGVzID0gYnVmLnNsaWNlKHN0YXJ0LCBlbmQpXG4gIHZhciByZXMgPSAnJ1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0gKyBieXRlc1tpICsgMV0gKiAyNTYpXG4gIH1cbiAgcmV0dXJuIHJlc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnNsaWNlID0gZnVuY3Rpb24gc2xpY2UgKHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIHN0YXJ0ID0gfn5zdGFydFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IGxlbiA6IH5+ZW5kXG5cbiAgaWYgKHN0YXJ0IDwgMCkge1xuICAgIHN0YXJ0ICs9IGxlblxuICAgIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMFxuICB9IGVsc2UgaWYgKHN0YXJ0ID4gbGVuKSB7XG4gICAgc3RhcnQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCAwKSB7XG4gICAgZW5kICs9IGxlblxuICAgIGlmIChlbmQgPCAwKSBlbmQgPSAwXG4gIH0gZWxzZSBpZiAoZW5kID4gbGVuKSB7XG4gICAgZW5kID0gbGVuXG4gIH1cblxuICBpZiAoZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgdmFyIG5ld0J1ZlxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBuZXdCdWYgPSB0aGlzLnN1YmFycmF5KHN0YXJ0LCBlbmQpXG4gICAgbmV3QnVmLl9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICB2YXIgc2xpY2VMZW4gPSBlbmQgLSBzdGFydFxuICAgIG5ld0J1ZiA9IG5ldyBCdWZmZXIoc2xpY2VMZW4sIHVuZGVmaW5lZClcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWNlTGVuOyArK2kpIHtcbiAgICAgIG5ld0J1ZltpXSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXdCdWZcbn1cblxuLypcbiAqIE5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgYnVmZmVyIGlzbid0IHRyeWluZyB0byB3cml0ZSBvdXQgb2YgYm91bmRzLlxuICovXG5mdW5jdGlvbiBjaGVja09mZnNldCAob2Zmc2V0LCBleHQsIGxlbmd0aCkge1xuICBpZiAoKG9mZnNldCAlIDEpICE9PSAwIHx8IG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdvZmZzZXQgaXMgbm90IHVpbnQnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gbGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aCcpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRMRSA9IGZ1bmN0aW9uIHJlYWRVSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRCRSA9IGZ1bmN0aW9uIHJlYWRVSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG4gIH1cblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWJ5dGVMZW5ndGhdXG4gIHZhciBtdWwgPSAxXG4gIHdoaWxlIChieXRlTGVuZ3RoID4gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDggKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIHRoaXNbb2Zmc2V0XVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2QkUgPSBmdW5jdGlvbiByZWFkVUludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgOCkgfCB0aGlzW29mZnNldCArIDFdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICgodGhpc1tvZmZzZXRdKSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikpICtcbiAgICAgICh0aGlzW29mZnNldCArIDNdICogMHgxMDAwMDAwKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdICogMHgxMDAwMDAwKSArXG4gICAgKCh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfFxuICAgIHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludExFID0gZnVuY3Rpb24gcmVhZEludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XVxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyBpXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludEJFID0gZnVuY3Rpb24gcmVhZEludEJFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoXG4gIHZhciBtdWwgPSAxXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0taV1cbiAgd2hpbGUgKGkgPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1pXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDggPSBmdW5jdGlvbiByZWFkSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICBpZiAoISh0aGlzW29mZnNldF0gJiAweDgwKSkgcmV0dXJuICh0aGlzW29mZnNldF0pXG4gIHJldHVybiAoKDB4ZmYgLSB0aGlzW29mZnNldF0gKyAxKSAqIC0xKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFID0gZnVuY3Rpb24gcmVhZEludDE2TEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRJbnQxNkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIDFdIHwgKHRoaXNbb2Zmc2V0XSA8PCA4KVxuICByZXR1cm4gKHZhbCAmIDB4ODAwMCkgPyB2YWwgfCAweEZGRkYwMDAwIDogdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyTEUgPSBmdW5jdGlvbiByZWFkSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdKSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10gPDwgMjQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiByZWFkSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDI0KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0TEUgPSBmdW5jdGlvbiByZWFkRmxvYXRMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0QkUgPSBmdW5jdGlvbiByZWFkRmxvYXRCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgZmFsc2UsIDIzLCA0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVMRSA9IGZ1bmN0aW9uIHJlYWREb3VibGVMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgNTIsIDgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUJFID0gZnVuY3Rpb24gcmVhZERvdWJsZUJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpXG59XG5cbmZ1bmN0aW9uIGNoZWNrSW50IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJidWZmZXJcIiBhcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyIGluc3RhbmNlJylcbiAgaWYgKHZhbHVlID4gbWF4IHx8IHZhbHVlIDwgbWluKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCJ2YWx1ZVwiIGFyZ3VtZW50IGlzIG91dCBvZiBib3VuZHMnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBtYXhCeXRlcyA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSAtIDFcbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBtYXhCeXRlcywgMClcbiAgfVxuXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB0aGlzW29mZnNldCArIGldID0gKHZhbHVlIC8gbXVsKSAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnRCRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBtYXhCeXRlcyA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSAtIDFcbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBtYXhCeXRlcywgMClcbiAgfVxuXG4gIHZhciBpID0gYnl0ZUxlbmd0aCAtIDFcbiAgdmFyIG11bCA9IDFcbiAgdGhpc1tvZmZzZXQgKyBpXSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoLS1pID49IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB0aGlzW29mZnNldCArIGldID0gKHZhbHVlIC8gbXVsKSAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50OCA9IGZ1bmN0aW9uIHdyaXRlVUludDggKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMSwgMHhmZiwgMClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKVxuICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICByZXR1cm4gb2Zmc2V0ICsgMVxufVxuXG5mdW5jdGlvbiBvYmplY3RXcml0ZVVJbnQxNiAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4pIHtcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmYgKyB2YWx1ZSArIDFcbiAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCAyKTsgaSA8IGo7ICsraSkge1xuICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSAmICgweGZmIDw8ICg4ICogKGxpdHRsZUVuZGlhbiA/IGkgOiAxIC0gaSkpKSkgPj4+XG4gICAgICAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSAqIDhcbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDJcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5mdW5jdGlvbiBvYmplY3RXcml0ZVVJbnQzMiAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4pIHtcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxXG4gIGZvciAodmFyIGkgPSAwLCBqID0gTWF0aC5taW4oYnVmLmxlbmd0aCAtIG9mZnNldCwgNCk7IGkgPCBqOyArK2kpIHtcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSAodmFsdWUgPj4+IChsaXR0bGVFbmRpYW4gPyBpIDogMyAtIGkpICogOCkgJiAweGZmXG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQzMkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50TEUgPSBmdW5jdGlvbiB3cml0ZUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICB2YXIgbGltaXQgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCAtIDEpXG5cbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdClcbiAgfVxuXG4gIHZhciBpID0gMFxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gMFxuICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICBpZiAodmFsdWUgPCAwICYmIHN1YiA9PT0gMCAmJiB0aGlzW29mZnNldCArIGkgLSAxXSAhPT0gMCkge1xuICAgICAgc3ViID0gMVxuICAgIH1cbiAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50QkUgPSBmdW5jdGlvbiB3cml0ZUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICB2YXIgbGltaXQgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCAtIDEpXG5cbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdClcbiAgfVxuXG4gIHZhciBpID0gYnl0ZUxlbmd0aCAtIDFcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHN1YiA9IDBcbiAgdGhpc1tvZmZzZXQgKyBpXSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoLS1pID49IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICBpZiAodmFsdWUgPCAwICYmIHN1YiA9PT0gMCAmJiB0aGlzW29mZnNldCArIGkgKyAxXSAhPT0gMCkge1xuICAgICAgc3ViID0gMVxuICAgIH1cbiAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweDdmLCAtMHg4MClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKVxuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmYgKyB2YWx1ZSArIDFcbiAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgcmV0dXJuIG9mZnNldCArIDFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHg3ZmZmLCAtMHg4MDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHg3ZmZmZmZmZiwgLTB4ODAwMDAwMDApXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuZnVuY3Rpb24gY2hlY2tJRUVFNzU0IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKVxuICBpZiAob2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG59XG5cbmZ1bmN0aW9uIHdyaXRlRmxvYXQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgNCwgMy40MDI4MjM0NjYzODUyODg2ZSszOCwgLTMuNDAyODIzNDY2Mzg1Mjg4NmUrMzgpXG4gIH1cbiAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgMjMsIDQpXG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdExFID0gZnVuY3Rpb24gd3JpdGVGbG9hdExFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVGbG9hdCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0QkUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydClcbn1cblxuZnVuY3Rpb24gd3JpdGVEb3VibGUgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgOCwgMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgsIC0xLjc5NzY5MzEzNDg2MjMxNTdFKzMwOClcbiAgfVxuICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCA1MiwgOClcbiAgcmV0dXJuIG9mZnNldCArIDhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUxFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUsIG5vQXNzZXJ0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlQkUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KVxufVxuXG4vLyBjb3B5KHRhcmdldEJ1ZmZlciwgdGFyZ2V0U3RhcnQ9MCwgc291cmNlU3RhcnQ9MCwgc291cmNlRW5kPWJ1ZmZlci5sZW5ndGgpXG5CdWZmZXIucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiBjb3B5ICh0YXJnZXQsIHRhcmdldFN0YXJ0LCBzdGFydCwgZW5kKSB7XG4gIGlmICghc3RhcnQpIHN0YXJ0ID0gMFxuICBpZiAoIWVuZCAmJiBlbmQgIT09IDApIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmICh0YXJnZXRTdGFydCA+PSB0YXJnZXQubGVuZ3RoKSB0YXJnZXRTdGFydCA9IHRhcmdldC5sZW5ndGhcbiAgaWYgKCF0YXJnZXRTdGFydCkgdGFyZ2V0U3RhcnQgPSAwXG4gIGlmIChlbmQgPiAwICYmIGVuZCA8IHN0YXJ0KSBlbmQgPSBzdGFydFxuXG4gIC8vIENvcHkgMCBieXRlczsgd2UncmUgZG9uZVxuICBpZiAoZW5kID09PSBzdGFydCkgcmV0dXJuIDBcbiAgaWYgKHRhcmdldC5sZW5ndGggPT09IDAgfHwgdGhpcy5sZW5ndGggPT09IDApIHJldHVybiAwXG5cbiAgLy8gRmF0YWwgZXJyb3IgY29uZGl0aW9uc1xuICBpZiAodGFyZ2V0U3RhcnQgPCAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3RhcmdldFN0YXJ0IG91dCBvZiBib3VuZHMnKVxuICB9XG4gIGlmIChzdGFydCA8IDAgfHwgc3RhcnQgPj0gdGhpcy5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdzb3VyY2VTdGFydCBvdXQgb2YgYm91bmRzJylcbiAgaWYgKGVuZCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdzb3VyY2VFbmQgb3V0IG9mIGJvdW5kcycpXG5cbiAgLy8gQXJlIHdlIG9vYj9cbiAgaWYgKGVuZCA+IHRoaXMubGVuZ3RoKSBlbmQgPSB0aGlzLmxlbmd0aFxuICBpZiAodGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0IDwgZW5kIC0gc3RhcnQpIHtcbiAgICBlbmQgPSB0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgKyBzdGFydFxuICB9XG5cbiAgdmFyIGxlbiA9IGVuZCAtIHN0YXJ0XG4gIHZhciBpXG5cbiAgaWYgKHRoaXMgPT09IHRhcmdldCAmJiBzdGFydCA8IHRhcmdldFN0YXJ0ICYmIHRhcmdldFN0YXJ0IDwgZW5kKSB7XG4gICAgLy8gZGVzY2VuZGluZyBjb3B5IGZyb20gZW5kXG4gICAgZm9yIChpID0gbGVuIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9IGVsc2UgaWYgKGxlbiA8IDEwMDAgfHwgIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gYXNjZW5kaW5nIGNvcHkgZnJvbSBzdGFydFxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgVWludDhBcnJheS5wcm90b3R5cGUuc2V0LmNhbGwoXG4gICAgICB0YXJnZXQsXG4gICAgICB0aGlzLnN1YmFycmF5KHN0YXJ0LCBzdGFydCArIGxlbiksXG4gICAgICB0YXJnZXRTdGFydFxuICAgIClcbiAgfVxuXG4gIHJldHVybiBsZW5cbn1cblxuLy8gVXNhZ2U6XG4vLyAgICBidWZmZXIuZmlsbChudW1iZXJbLCBvZmZzZXRbLCBlbmRdXSlcbi8vICAgIGJ1ZmZlci5maWxsKGJ1ZmZlclssIG9mZnNldFssIGVuZF1dKVxuLy8gICAgYnVmZmVyLmZpbGwoc3RyaW5nWywgb2Zmc2V0WywgZW5kXV1bLCBlbmNvZGluZ10pXG5CdWZmZXIucHJvdG90eXBlLmZpbGwgPSBmdW5jdGlvbiBmaWxsICh2YWwsIHN0YXJ0LCBlbmQsIGVuY29kaW5nKSB7XG4gIC8vIEhhbmRsZSBzdHJpbmcgY2FzZXM6XG4gIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgIGlmICh0eXBlb2Ygc3RhcnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBlbmNvZGluZyA9IHN0YXJ0XG4gICAgICBzdGFydCA9IDBcbiAgICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZW5kID09PSAnc3RyaW5nJykge1xuICAgICAgZW5jb2RpbmcgPSBlbmRcbiAgICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gICAgfVxuICAgIGlmICh2YWwubGVuZ3RoID09PSAxKSB7XG4gICAgICB2YXIgY29kZSA9IHZhbC5jaGFyQ29kZUF0KDApXG4gICAgICBpZiAoY29kZSA8IDI1Nikge1xuICAgICAgICB2YWwgPSBjb2RlXG4gICAgICB9XG4gICAgfVxuICAgIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2VuY29kaW5nIG11c3QgYmUgYSBzdHJpbmcnKVxuICAgIH1cbiAgICBpZiAodHlwZW9mIGVuY29kaW5nID09PSAnc3RyaW5nJyAmJiAhQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpXG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgdmFsID0gdmFsICYgMjU1XG4gIH1cblxuICAvLyBJbnZhbGlkIHJhbmdlcyBhcmUgbm90IHNldCB0byBhIGRlZmF1bHQsIHNvIGNhbiByYW5nZSBjaGVjayBlYXJseS5cbiAgaWYgKHN0YXJ0IDwgMCB8fCB0aGlzLmxlbmd0aCA8IHN0YXJ0IHx8IHRoaXMubGVuZ3RoIDwgZW5kKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ091dCBvZiByYW5nZSBpbmRleCcpXG4gIH1cblxuICBpZiAoZW5kIDw9IHN0YXJ0KSB7XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIHN0YXJ0ID0gc3RhcnQgPj4+IDBcbiAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgPyB0aGlzLmxlbmd0aCA6IGVuZCA+Pj4gMFxuXG4gIGlmICghdmFsKSB2YWwgPSAwXG5cbiAgdmFyIGlcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgZm9yIChpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgICAgdGhpc1tpXSA9IHZhbFxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB2YXIgYnl0ZXMgPSBCdWZmZXIuaXNCdWZmZXIodmFsKVxuICAgICAgPyB2YWxcbiAgICAgIDogdXRmOFRvQnl0ZXMobmV3IEJ1ZmZlcih2YWwsIGVuY29kaW5nKS50b1N0cmluZygpKVxuICAgIHZhciBsZW4gPSBieXRlcy5sZW5ndGhcbiAgICBmb3IgKGkgPSAwOyBpIDwgZW5kIC0gc3RhcnQ7ICsraSkge1xuICAgICAgdGhpc1tpICsgc3RhcnRdID0gYnl0ZXNbaSAlIGxlbl1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpc1xufVxuXG4vLyBIRUxQRVIgRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09XG5cbnZhciBJTlZBTElEX0JBU0U2NF9SRSA9IC9bXitcXC8wLTlBLVphLXotX10vZ1xuXG5mdW5jdGlvbiBiYXNlNjRjbGVhbiAoc3RyKSB7XG4gIC8vIE5vZGUgc3RyaXBzIG91dCBpbnZhbGlkIGNoYXJhY3RlcnMgbGlrZSBcXG4gYW5kIFxcdCBmcm9tIHRoZSBzdHJpbmcsIGJhc2U2NC1qcyBkb2VzIG5vdFxuICBzdHIgPSBzdHJpbmd0cmltKHN0cikucmVwbGFjZShJTlZBTElEX0JBU0U2NF9SRSwgJycpXG4gIC8vIE5vZGUgY29udmVydHMgc3RyaW5ncyB3aXRoIGxlbmd0aCA8IDIgdG8gJydcbiAgaWYgKHN0ci5sZW5ndGggPCAyKSByZXR1cm4gJydcbiAgLy8gTm9kZSBhbGxvd3MgZm9yIG5vbi1wYWRkZWQgYmFzZTY0IHN0cmluZ3MgKG1pc3NpbmcgdHJhaWxpbmcgPT09KSwgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHdoaWxlIChzdHIubGVuZ3RoICUgNCAhPT0gMCkge1xuICAgIHN0ciA9IHN0ciArICc9J1xuICB9XG4gIHJldHVybiBzdHJcbn1cblxuZnVuY3Rpb24gc3RyaW5ndHJpbSAoc3RyKSB7XG4gIGlmIChzdHIudHJpbSkgcmV0dXJuIHN0ci50cmltKClcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJylcbn1cblxuZnVuY3Rpb24gdG9IZXggKG4pIHtcbiAgaWYgKG4gPCAxNikgcmV0dXJuICcwJyArIG4udG9TdHJpbmcoMTYpXG4gIHJldHVybiBuLnRvU3RyaW5nKDE2KVxufVxuXG5mdW5jdGlvbiB1dGY4VG9CeXRlcyAoc3RyaW5nLCB1bml0cykge1xuICB1bml0cyA9IHVuaXRzIHx8IEluZmluaXR5XG4gIHZhciBjb2RlUG9pbnRcbiAgdmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGhcbiAgdmFyIGxlYWRTdXJyb2dhdGUgPSBudWxsXG4gIHZhciBieXRlcyA9IFtdXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIGNvZGVQb2ludCA9IHN0cmluZy5jaGFyQ29kZUF0KGkpXG5cbiAgICAvLyBpcyBzdXJyb2dhdGUgY29tcG9uZW50XG4gICAgaWYgKGNvZGVQb2ludCA+IDB4RDdGRiAmJiBjb2RlUG9pbnQgPCAweEUwMDApIHtcbiAgICAgIC8vIGxhc3QgY2hhciB3YXMgYSBsZWFkXG4gICAgICBpZiAoIWxlYWRTdXJyb2dhdGUpIHtcbiAgICAgICAgLy8gbm8gbGVhZCB5ZXRcbiAgICAgICAgaWYgKGNvZGVQb2ludCA+IDB4REJGRikge1xuICAgICAgICAgIC8vIHVuZXhwZWN0ZWQgdHJhaWxcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9IGVsc2UgaWYgKGkgKyAxID09PSBsZW5ndGgpIHtcbiAgICAgICAgICAvLyB1bnBhaXJlZCBsZWFkXG4gICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHZhbGlkIGxlYWRcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuXG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIC8vIDIgbGVhZHMgaW4gYSByb3dcbiAgICAgIGlmIChjb2RlUG9pbnQgPCAweERDMDApIHtcbiAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnRcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gdmFsaWQgc3Vycm9nYXRlIHBhaXJcbiAgICAgIGNvZGVQb2ludCA9IChsZWFkU3Vycm9nYXRlIC0gMHhEODAwIDw8IDEwIHwgY29kZVBvaW50IC0gMHhEQzAwKSArIDB4MTAwMDBcbiAgICB9IGVsc2UgaWYgKGxlYWRTdXJyb2dhdGUpIHtcbiAgICAgIC8vIHZhbGlkIGJtcCBjaGFyLCBidXQgbGFzdCBjaGFyIHdhcyBhIGxlYWRcbiAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgIH1cblxuICAgIGxlYWRTdXJyb2dhdGUgPSBudWxsXG5cbiAgICAvLyBlbmNvZGUgdXRmOFxuICAgIGlmIChjb2RlUG9pbnQgPCAweDgwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDEpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goY29kZVBvaW50KVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHg4MDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiB8IDB4QzAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDEwMDAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDMpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweEMgfCAweEUwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSA0KSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHgxMiB8IDB4RjAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweEMgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MFxuICAgICAgKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29kZSBwb2ludCcpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJ5dGVzXG59XG5cbmZ1bmN0aW9uIGFzY2lpVG9CeXRlcyAoc3RyKSB7XG4gIHZhciBieXRlQXJyYXkgPSBbXVxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkge1xuICAgIC8vIE5vZGUncyBjb2RlIHNlZW1zIHRvIGJlIGRvaW5nIHRoaXMgYW5kIG5vdCAmIDB4N0YuLlxuICAgIGJ5dGVBcnJheS5wdXNoKHN0ci5jaGFyQ29kZUF0KGkpICYgMHhGRilcbiAgfVxuICByZXR1cm4gYnl0ZUFycmF5XG59XG5cbmZ1bmN0aW9uIHV0ZjE2bGVUb0J5dGVzIChzdHIsIHVuaXRzKSB7XG4gIHZhciBjLCBoaSwgbG9cbiAgdmFyIGJ5dGVBcnJheSA9IFtdXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrXG5cbiAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSlcbiAgICBoaSA9IGMgPj4gOFxuICAgIGxvID0gYyAlIDI1NlxuICAgIGJ5dGVBcnJheS5wdXNoKGxvKVxuICAgIGJ5dGVBcnJheS5wdXNoKGhpKVxuICB9XG5cbiAgcmV0dXJuIGJ5dGVBcnJheVxufVxuXG5mdW5jdGlvbiBiYXNlNjRUb0J5dGVzIChzdHIpIHtcbiAgcmV0dXJuIGJhc2U2NC50b0J5dGVBcnJheShiYXNlNjRjbGVhbihzdHIpKVxufVxuXG5mdW5jdGlvbiBibGl0QnVmZmVyIChzcmMsIGRzdCwgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIGlmICgoaSArIG9mZnNldCA+PSBkc3QubGVuZ3RoKSB8fCAoaSA+PSBzcmMubGVuZ3RoKSkgYnJlYWtcbiAgICBkc3RbaSArIG9mZnNldF0gPSBzcmNbaV1cbiAgfVxuICByZXR1cm4gaVxufVxuXG5mdW5jdGlvbiBpc25hbiAodmFsKSB7XG4gIHJldHVybiB2YWwgIT09IHZhbCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXNlbGYtY29tcGFyZVxufVxuIiwiZXhwb3J0cy5yZWFkID0gZnVuY3Rpb24gKGJ1ZmZlciwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHtcbiAgdmFyIGUsIG1cbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBuQml0cyA9IC03XG4gIHZhciBpID0gaXNMRSA/IChuQnl0ZXMgLSAxKSA6IDBcbiAgdmFyIGQgPSBpc0xFID8gLTEgOiAxXG4gIHZhciBzID0gYnVmZmVyW29mZnNldCArIGldXG5cbiAgaSArPSBkXG5cbiAgZSA9IHMgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgcyA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gZUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBlID0gZSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fVxuXG4gIG0gPSBlICYgKCgxIDw8ICgtbkJpdHMpKSAtIDEpXG4gIGUgPj49ICgtbkJpdHMpXG4gIG5CaXRzICs9IG1MZW5cbiAgZm9yICg7IG5CaXRzID4gMDsgbSA9IG0gKiAyNTYgKyBidWZmZXJbb2Zmc2V0ICsgaV0sIGkgKz0gZCwgbkJpdHMgLT0gOCkge31cblxuICBpZiAoZSA9PT0gMCkge1xuICAgIGUgPSAxIC0gZUJpYXNcbiAgfSBlbHNlIGlmIChlID09PSBlTWF4KSB7XG4gICAgcmV0dXJuIG0gPyBOYU4gOiAoKHMgPyAtMSA6IDEpICogSW5maW5pdHkpXG4gIH0gZWxzZSB7XG4gICAgbSA9IG0gKyBNYXRoLnBvdygyLCBtTGVuKVxuICAgIGUgPSBlIC0gZUJpYXNcbiAgfVxuICByZXR1cm4gKHMgPyAtMSA6IDEpICogbSAqIE1hdGgucG93KDIsIGUgLSBtTGVuKVxufVxuXG5leHBvcnRzLndyaXRlID0gZnVuY3Rpb24gKGJ1ZmZlciwgdmFsdWUsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7XG4gIHZhciBlLCBtLCBjXG4gIHZhciBlTGVuID0gbkJ5dGVzICogOCAtIG1MZW4gLSAxXG4gIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxXG4gIHZhciBlQmlhcyA9IGVNYXggPj4gMVxuICB2YXIgcnQgPSAobUxlbiA9PT0gMjMgPyBNYXRoLnBvdygyLCAtMjQpIC0gTWF0aC5wb3coMiwgLTc3KSA6IDApXG4gIHZhciBpID0gaXNMRSA/IDAgOiAobkJ5dGVzIC0gMSlcbiAgdmFyIGQgPSBpc0xFID8gMSA6IC0xXG4gIHZhciBzID0gdmFsdWUgPCAwIHx8ICh2YWx1ZSA9PT0gMCAmJiAxIC8gdmFsdWUgPCAwKSA/IDEgOiAwXG5cbiAgdmFsdWUgPSBNYXRoLmFicyh2YWx1ZSlcblxuICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlID09PSBJbmZpbml0eSkge1xuICAgIG0gPSBpc05hTih2YWx1ZSkgPyAxIDogMFxuICAgIGUgPSBlTWF4XG4gIH0gZWxzZSB7XG4gICAgZSA9IE1hdGguZmxvb3IoTWF0aC5sb2codmFsdWUpIC8gTWF0aC5MTjIpXG4gICAgaWYgKHZhbHVlICogKGMgPSBNYXRoLnBvdygyLCAtZSkpIDwgMSkge1xuICAgICAgZS0tXG4gICAgICBjICo9IDJcbiAgICB9XG4gICAgaWYgKGUgKyBlQmlhcyA+PSAxKSB7XG4gICAgICB2YWx1ZSArPSBydCAvIGNcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUgKz0gcnQgKiBNYXRoLnBvdygyLCAxIC0gZUJpYXMpXG4gICAgfVxuICAgIGlmICh2YWx1ZSAqIGMgPj0gMikge1xuICAgICAgZSsrXG4gICAgICBjIC89IDJcbiAgICB9XG5cbiAgICBpZiAoZSArIGVCaWFzID49IGVNYXgpIHtcbiAgICAgIG0gPSAwXG4gICAgICBlID0gZU1heFxuICAgIH0gZWxzZSBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIG0gPSAodmFsdWUgKiBjIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IGUgKyBlQmlhc1xuICAgIH0gZWxzZSB7XG4gICAgICBtID0gdmFsdWUgKiBNYXRoLnBvdygyLCBlQmlhcyAtIDEpICogTWF0aC5wb3coMiwgbUxlbilcbiAgICAgIGUgPSAwXG4gICAgfVxuICB9XG5cbiAgZm9yICg7IG1MZW4gPj0gODsgYnVmZmVyW29mZnNldCArIGldID0gbSAmIDB4ZmYsIGkgKz0gZCwgbSAvPSAyNTYsIG1MZW4gLT0gOCkge31cblxuICBlID0gKGUgPDwgbUxlbikgfCBtXG4gIGVMZW4gKz0gbUxlblxuICBmb3IgKDsgZUxlbiA+IDA7IGJ1ZmZlcltvZmZzZXQgKyBpXSA9IGUgJiAweGZmLCBpICs9IGQsIGUgLz0gMjU2LCBlTGVuIC09IDgpIHt9XG5cbiAgYnVmZmVyW29mZnNldCArIGkgLSBkXSB8PSBzICogMTI4XG59XG4iLCJ2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcblxubW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChhcnIpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwoYXJyKSA9PSAnW29iamVjdCBBcnJheV0nO1xufTtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5cbmxldCBSZXN1bHRTdGF0dXMgPSB7XG4gIFdJTjogMixcbiAgRFJBVzogMSxcbiAgTE9TRTogMCxcbn07XG5cblxubGV0IEdhbWVSZXN1bHQgPSBjYy5DbGFzcyh7XG4gIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICBwcm9wZXJ0aWVzOiB7XG4gICAgd2luTm9kZTogY2MuTm9kZSxcbiAgICBsb3NlTm9kZTogY2MuTm9kZSxcbiAgICBkcmF3Tm9kZTogY2MuTm9kZSxcbiAgICBjb250ZW50Tm9kZTogY2MuTm9kZSxcblxuICAgIHJlc3VsdEl0ZW1zOiBbY2MuTm9kZV0sXG5cbiAgICBfZGVza0luZm86IG51bGwsXG4gICAgX3VzZXJJZDogbnVsbCxcbiAgICBfY2xvc2VDYWxsYmFjazogbnVsbCxcbiAgfSxcblxuICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5faGlkZVJlc3VsdEl0ZW1zKCk7XG4gIH0sXG5cbiAgc2hvd1Jlc3VsdHM6IGZ1bmN0aW9uIChkZXNrSW5mbywgY3VycmVudFVzZXJJZCkge1xuICAgIHRoaXMuX2Rlc2tJbmZvID0gZGVza0luZm87XG4gICAgdGhpcy5fdXNlcklkID0gY3VycmVudFVzZXJJZDtcblxuICAgIGxldCByZXN1bHRTdGF0dXMgPSB0aGlzLl9yZXN1bHRTdGF0dXMoKTtcbiAgICB0aGlzLmNvbnRlbnROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgdGhpcy53aW5Ob2RlLmFjdGl2ZSA9ICAocmVzdWx0U3RhdHVzID09IFJlc3VsdFN0YXR1cy5XSU4pO1xuICAgIHRoaXMuZHJhd05vZGUuYWN0aXZlID0gKHJlc3VsdFN0YXR1cyA9PSBSZXN1bHRTdGF0dXMuRFJBVyk7XG4gICAgdGhpcy5sb3NlTm9kZS5hY3RpdmUgPSAocmVzdWx0U3RhdHVzID09IFJlc3VsdFN0YXR1cy5MT1NFKTtcblxuICAgIGlmICh0aGlzLndpbk5vZGUuYWN0aXZlKSB7XG4gICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVdpbigpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5sb3NlTm9kZS5hY3RpdmUpIHtcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5TG9zZSgpO1xuICAgIH1cblxuICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnNldERpc21pc3NDYWxsYmFjayhmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9jbG9zZUNhbGxiYWNrXG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIGxldCBwbGF5ZXJJbmZvcyA9IGRlc2tJbmZvLnBsYXllcnMuc29ydChmdW5jdGlvbiAocDEsIHAyKSB7XG4gICAgICByZXR1cm4gcDIuY1Njb3JlIC0gcDEuY1Njb3JlO1xuICAgIH0pO1xuICAgIGxldCBpdGVtQ29tcHMgPSB0aGlzLnJlc3VsdEl0ZW1zLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgcmV0dXJuIG5vZGUuZ2V0Q29tcG9uZW50KCdSZXN1bHRJdGVtJyk7XG4gICAgfSk7XG4gICAgaXRlbUNvbXBzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW1Db21wLCBpbmRleCkge1xuICAgICAgaXRlbUNvbXAubm9kZS5hY3RpdmUgPSBpbmRleCA8IHBsYXllckluZm9zLmxlbmd0aDtcbiAgICAgIGlmICghaXRlbUNvbXAubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlciA9IHBsYXllckluZm9zW2luZGV4XTtcbiAgICAgIGl0ZW1Db21wLnVwZGF0ZVdpdGhQbGF5ZXJJbmZvKHVzZXIsIGRlc2tJbmZvLmlzUmFuZG9tRGVzayk7XG4gICAgICBsZXQgY2FyZHMgPSB0aGlzLl9jYXJkc0Zyb21Vc2VyKHVzZXIpO1xuICAgICAgaXRlbUNvbXAuc2V0Q2FyZHMoY2FyZHMpO1xuICAgIH0uYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgc2V0Q2xvc2VDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5fY2xvc2VDYWxsYmFjayA9IGNhbGxiYWNrO1xuICB9LFxuXG4gIF9jYXJkc0Zyb21Vc2VyOiBmdW5jdGlvbiAodXNlcikge1xuICAgIGxldCBjYXJkcyA9IHVzZXIuY2FyZEluZm8ubWFwKGZ1bmN0aW9uIChjYXJkSW5mb0l0ZW0pIHtcbiAgICAgIHJldHVybiBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZEluZm9JdGVtLmNhcmRzKTtcbiAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge1xuICAgICAgcmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7XG4gICAgfSwgW10pO1xuXG4gICAgcmV0dXJuIGNhcmRzO1xuICB9LFxuXG4gIF9oaWRlUmVzdWx0SXRlbXM6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnJlc3VsdEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIG5vZGUuYWNpdHZlID0gZmFsc2U7XG4gICAgfSk7XG4gIH0sXG5cbiAgX3Jlc3VsdFN0YXR1czogZnVuY3Rpb24oKSB7XG4gICAgbGV0IHBsYXllckluZm9zID0gdGhpcy5fZGVza0luZm8ucGxheWVycztcbiAgICBsZXQgdXNlciA9IHBsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgIHJldHVybiB1c2VyLmlkID09IHRoaXMuX3VzZXJJZDtcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgbGV0IHNjb3JlID0gdXNlci5jU2NvcmU7XG4gICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmlzUmFuZG9tRGVzaykge1xuICAgICAgLy8g5aaC5p6c5piv6ZqP5py65Zy655qE6K+d77yM5bqU6K+l55So6ZK755+z5p2l5Yik5pat6L6T6LWiXG4gICAgICBzY29yZSA9IHVzZXIuZGlhbW9uZDtcbiAgICB9XG5cbiAgICBpZiAoc2NvcmUgPiAwKSB7XG4gICAgICByZXR1cm4gUmVzdWx0U3RhdHVzLldJTjtcbiAgICB9IGVsc2UgaWYgKHNjb3JlIDwgMCkge1xuICAgICAgcmV0dXJuIFJlc3VsdFN0YXR1cy5MT1NFO1xuICAgIH1cblxuICAgIHJldHVybiBSZXN1bHRTdGF0dXMuRFJBVztcbiAgfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVSZXN1bHQ7XG4iLCIvKiMjIyMjKi9cclxuLy/vv73vv73vv73vv73vv73vv73vv73vv73Su++/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/vdq177+977+977+9zazvv73vv73vv73vv73vv73vv73vv73Gte+/ve+/ve+/ve+/ve+/vVxyXG4gdmFyIEdldENhcmRQb2ludHNTYW1lQ291bnQgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIHRoaXMuY2FyZE51bWJlcnMgPSB7fTtcclxuICAgIGZvcih2YXIgaSBpbiBjYXJkcyl7XHJcbiAgICAgICAgdmFyIHM7XHJcbiAgICAgICAgaWYodHlwZW9mKGNhcmRzW2ldLm51bWJlcikgPT0gJ3VuZGVmaW5lZCcpe1xyXG4gICAgICAgICAgICBzID0gY2FyZHNbaV0ucG9pbnQ7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHMgPSBjYXJkc1tpXS5udW1iZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuY2FyZE51bWJlcnNbc10pe1xyXG4gICAgICAgICAgICB0aGlzLmNhcmROdW1iZXJzW3NdICsrO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLmNhcmROdW1iZXJzW3NdID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy9jYy5sb2codGhpcy5jYXJkTnVtYmVyc1tjYXJkc1tpXS5udW1iZXJdKVxyXG4gICAgICAgIC8vY2MubG9nKGNhcmRzKVxyXG4gICAgICAgIC8vY2MubG9nKGNhcmRzW2ldLm51bWJlcilcclxuICAgICAgICAvL2NjLmxvZygnLS0tNycpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5jYXJkTnVtYmVycztcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR2V0Q2FyZFBvaW50c1NhbWVDb3VudDtcclxuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYWJlbE51bWJlcnM6IFtjYy5MYWJlbF0sXG4gICAgICAgIGNhbGxiYWNrSm9pblJvb206IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jbGlja0NsZWFyKCk7XG4gICAgfSxcblxuICAgIGNsaWNrTnVtYmVyOiBmdW5jdGlvbiAoZXZlbnQsIG51bWJlcikge1xuICAgICAgdmFyIGxhYmVsID0gdGhpcy5fbGFzdEVtcHR5TGFiZWwoKTtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBudW1iZXI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBsZXQgaXNDb21wbGV0ZSA9ICh0aGlzLl9sYXN0RW1wdHlMYWJlbCgpID09IG51bGwpO1xuICAgICAgbGV0IGludml0ZU51bWJlciA9IHRoaXMuX3Jvb21OdW1iZXIoKTtcbiAgICAgIGlmIChpbnZpdGVOdW1iZXIubGVuZ3RoID09IDYpIHtcbiAgICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tID0gaW52aXRlTnVtYmVyO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBzZW5kQ29kZSA6ZnVuY3Rpb24oKXsgIC8v5Y+R6YCB6YKA6K+356CBXG4gICAgICBsZXQgdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgbGV0IGludml0ZU51bWJlciA9IHRoaXMuY2FsbGJhY2tKb2luUm9vbTtcbiAgICAgIGNvbnNvbGUubG9nKGludml0ZU51bWJlciAsXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cIik7XG4gICAgICBpZiggaW52aXRlTnVtYmVyLmxlbmd0aD09Nil7ICBcbiAgICAgICAgU29ja2V0LnNlbmRJbnZpdGVDb2RlKGludml0ZU51bWJlciwgdXNlcklkKTtcbiAgICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tID0gJyc7ICAgLy/muIXnqbrpgoDor7fnoIFcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xpY2tDbGVhcjogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tID0gJyc7XG4gICAgICB0aGlzLmxhYmVsTnVtYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGNsaWNrRGVsZXRlT25lOiBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgbGFiZWwgPSB0aGlzLl9sYXN0TnVtYmVyTGFiZWwoKTtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBfbGFzdEVtcHR5TGFiZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGluZGV4IGluIHRoaXMubGFiZWxOdW1iZXJzKSB7XG4gICAgICAgIHZhciBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyA9PSBudWxsXG4gICAgICAgIHx8IGxhYmVsLnN0cmluZy5sZW5ndGggPD0gMCkge1xuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9sYXN0TnVtYmVyTGFiZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGluZGV4ID0gdGhpcy5sYWJlbE51bWJlcnMubGVuZ3RoIC0gMTsgaW5kZXggPj0gMDsgLS1pbmRleCkge1xuICAgICAgICBsZXQgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgJiYgbGFiZWwuc3RyaW5nLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9yb29tTnVtYmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5sYWJlbE51bWJlcnMucmVkdWNlKGZ1bmN0aW9uIChyb29tTnVtYmVyLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gcm9vbU51bWJlciArIChsYWJlbC5zdHJpbmcgfHwgXCJcIik7XG4gICAgICB9LCBcIlwiKTtcbiAgICB9LFxufSk7XG4iLCIvLyDniYzoirHoibLluK7liqnnsbtcbi8vIOeUqOS6juiuoeeul+S4gOS4queJjOaVsOe7hOeahOiKseiJsuebuOWQjOeahOeJjOeahOW8oOaVsFxudmFyIEtRQ2FyZENvbG9yc0hlbHBlciA9IGZ1bmN0aW9uIChjYXJkcykge1xuICB0aGlzLmNvbG9yTnVtYmVyID0ge307XG5cbiAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xuICAgIGxldCBjb2xvciA9IGNhcmQuY29sb3I7XG4gICAgdmFyIG51bWJlciA9IHRoaXMuY29sb3JOdW1iZXJbY29sb3JdIHx8IDA7XG4gICAgdGhpcy5jb2xvck51bWJlcltjb2xvcl0gPSBudW1iZXIgKyAxO1xuICB9LmJpbmQodGhpcykpO1xufTtcblxuLy8g55u45ZCM6Iqx6Imy55qE54mM55qE5pyA5aSn5pWw6YePXG5LUUNhcmRDb2xvcnNIZWxwZXIucHJvdG90eXBlLm1heE51bWJlciA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHJlc3VsdCA9IDA7XG4gIGZvciAobGV0IHByb3AgaW4gdGhpcy5jb2xvck51bWJlcikge1xuICAgIGxldCBudW1iZXIgPSB0aGlzLmNvbG9yTnVtYmVyW3Byb3BdO1xuICAgIHJlc3VsdCA9IE1hdGgubWF4KG51bWJlciwgcmVzdWx0KTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEtRQ2FyZENvbG9yc0hlbHBlcjtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY29uc3QgQXJyYXlFeHRlbnNpb24gPSByZXF1aXJlKCdBcnJheUV4dGVuc2lvbicpO1xuY29uc3QgS1FDYXJkUG9pbnRzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUG9pbnRzSGVscGVyJyk7XG5cbm1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIOWvu+aJviBjYXJkTW9kZXMg5Lit55qEIOWvueWtkFxuLy8g6L+Z5Lya6L+U5ZueIOWvueWtkCDnmoTntKLlvJXmlbDnu4Rcbi8vIOWmgu+8mltbMSwgM10sIFs0LCA1XV1cbktRQ2FyZC5maW5kRHVpWmkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGxldCBzRHVpWmlJbmRleHMgPSBLUUNhcmQuZmluZFNhblRpYW8oY2FyZE1vZGVzKSB8fCBbXTtcbiAgbGV0IHJlc3VsdCA9IEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgMikgfHwgW107XG4gIGlmKHJlc3VsdC5sZW5ndGggPCAyICl7XG4gICAgaWYoc0R1aVppSW5kZXhzLmxlbmd0aCA+IDApe1xuICAgICAgc0R1aVppSW5kZXhzLmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XG4gICAgICAgIHZhciBzMSA9IFtpbmRleHNbMF0saW5kZXhzWzFdXTtcbiAgICAgICAgLy92YXIgczIgPSBbaW5kZXhzWzFdLGluZGV4c1syXV07XG4gICAgICAgIC8vcmVzdWx0LnB1c2goczIpO1xuICAgICAgICByZXN1bHQucHVzaChzMSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdmFyIHRyZXN1bHQgPSBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMik7XG4gICAgZm9yKHZhciBpID0gMDtpIDwgdHJlc3VsdC5sZW5ndGg7aSsrKXtcbiAgICAgIHJlc3VsdC5wdXNoKHRyZXN1bHRbaV0pO1xuICAgIH1cbiAgfVxuXG4gIHJlc3VsdCA9IEtRQ2FyZC5yZXBlYXQocmVzdWx0KTtcblxuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBbXTtcbn07XG5cbktRQ2FyZC5fZmluZFBvaW50TGVuZ3RoID0gZnVuY3Rpb24gKGNhcmRNb2RlcywgbGVuZ3RoKSB7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgbGV0IG9iaiA9IGNhcmRNb2Rlcy5yZWR1Y2UoZnVuY3Rpb24ob2JqLCBjYXJkLCBpbmRleCkge1xuICAgIGxldCBwb2ludEluZGV4cyA9IG9ialtjYXJkLnBvaW50XSB8fCBbXTtcbiAgICBvYmpbY2FyZC5wb2ludF0gPSBwb2ludEluZGV4cztcbiAgICBwb2ludEluZGV4cy5wdXNoKGluZGV4KTtcbiAgICByZXR1cm4gb2JqO1xuICB9LCB7fSk7XG5cbiAgbGV0IHJlc3VsdCA9IFtdO1xuICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgIGxldCBwb2ludEluZGV4cyA9IG9ialtwcm9wXTtcbiAgICAvLyBpZiAocG9pbnRJbmRleHMubGVuZ3RoID09IGxlbmd0aCkge1xuICAgIC8vICAgcG9pbnRJbmRleHMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgLy8gICAgIHJldHVybiBuMSAtIG4yO1xuICAgIC8vICAgfSk7XG4gICAgLy8gICByZXN1bHQucHVzaChwb2ludEluZGV4cyk7XG4gICAgLy8gfVxuICAgIHdoaWxlKHBvaW50SW5kZXhzLmxlbmd0aCA+PSBsZW5ndGggJiYgbGVuZ3RoICE9IDApey8v5pyJ5aSa55qE5YiG5Ymy5aSa5Liq5pWw57uEXG4gICAgICB2YXIgc3BsaWNlcyA9IHBvaW50SW5kZXhzLnNwbGljZSgwLGxlbmd0aCk7XG4gICAgICBpZiAoc3BsaWNlcy5sZW5ndGggPj0gbGVuZ3RoKXtcbiAgICAgICAgc3BsaWNlcy5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgfSk7XG4gICAgICAgIHJlc3VsdC5wdXNoKHNwbGljZXMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJlc3VsdC5zb3J0KGZ1bmN0aW9uIChhcnIxLCBhcnIyKSB7XG4gICAgbGV0IG4xID0gYXJyMVswXTtcbiAgICBsZXQgbjIgPSBhcnIyWzBdO1xuICAgIHJldHVybiBuMiAtIG4xO1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XG59O1xuXG4vLyDmib4g5Lik5a+5IOeahOe0ouW8leaVsOe7hFxuLy8g5aaC77yaW1sxLCAyLCAzLCA0XSwgWzUsIDYsIDcsIDhdXVxuS1FDYXJkLmZpbmRMaWFEdWkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGxldCBkdWlaaUluZGV4cyA9IEtRQ2FyZC5maW5kRHVpWmkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgbGV0IGR1aVppSW5kZXggPSBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMikgfHwgW107XG5cbiAgaWYoZHVpWmlJbmRleHMubGVuZ3RoIDwgMSAmJiBkdWlaaUluZGV4Lmxlbmd0aCA+IDApe1xuICAgIGR1aVppSW5kZXguZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgZHVpWmlJbmRleHMudW5zaGlmdChpbmRleHMpO1xuICAgIH0pO1xuICB9XG4gIGlmIChkdWlaaUluZGV4cy5sZW5ndGggPCAyKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgbGV0IHJlc3VsdCA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGR1aVppSW5kZXhzLmxlbmd0aDsgKytpKSB7XG4gICAgZm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgZHVpWmlJbmRleHMubGVuZ3RoOyArK2opIHtcbiAgICAgIGlmKHJlc3VsdC5sZW5ndGggPCAxMCl7XG4gICAgICAgIGxldCBwcmUgPSBkdWlaaUluZGV4c1tpXTtcbiAgICAgICAgbGV0IG5leHQgPSBkdWlaaUluZGV4c1tqXTtcbiAgICAgICAgdmFyIHMgPSBwcmUuY29uY2F0KG5leHQpO1xuICAgICAgICB2YXIgbmV3UyA9IFtdO1xuICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBzLmxlbmd0aCA7cSsrKXtcbiAgICAgICAgICBpZihuZXdTLmluZGV4T2Yoc1txXSkgPT0gLTEpe1xuICAgICAgICAgICAgbmV3Uy5wdXNoKHNbcV0pO1xuICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKG5ld1MubGVuZ3RoID09IDQpe1xuICAgICAgICAgIG5ld1Muc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXN1bHQudW5zaGlmdChuZXdTKTtcbiAgICAgICAgfVxuICAgICAgfWVsc2V7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG5cbiAgICB9XG4gIH1cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpO1xuICBpZihyZXN1bHQubGVuZ3RoID4gNil7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsNik7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8vIOaJvuS4ieadoVxuLy8g5aaC77yaW1sxLCAyLCAzXV07XG5LUUNhcmQuZmluZFNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGlmKGNhcmRNb2Rlcy5sZW5ndGggPCAzKXtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgbGV0IHJlc3VsdCA9IEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgMykgfHwgW107XG4gIC8vZm9yKHZhciBxID0wO3E8cmVzdWx0Lmxlbmd0aDtxKyspe1xuICAvLyAgdmFyIGluZGV4cyA9IHJlc3VsdFtxXVswXTtcbiAgLy8gIGlmKGNhcmRNb2Rlc1tpbmRleHNdLnBvaW50ID49IDIwKXtcbiAgLy8gICAgcmVzdWx0LnNwbGljZShxLDEpO1xuICAvLyAgfVxuICAvL31cbiAgaWYocmVzdWx0Lmxlbmd0aCA8IDIgKXtcbiAgICBsZXQgdGllWmhpSW5kZXhzQXJyYXkgPSBLUUNhcmQuZmluZFRpZVpoaShjYXJkTW9kZXMpO1xuICAgIGlmKHRpZVpoaUluZGV4c0FycmF5Lmxlbmd0aCA+IDApe1xuICAgICAgdGllWmhpSW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czEgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbM11dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMF0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgICByZXN1bHQucHVzaChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMyKTtcbiAgICAgICAgLy9yZXN1bHQudW5zaGlmdChzYW5UaWFvSW5kZXhzMyk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdmFyIHRyZXN1bHQgPSBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMyk7XG4gICAgZm9yKHZhciBpID0gMDtpIDwgdHJlc3VsdC5sZW5ndGg7aSsrKXtcbiAgICAgIHJlc3VsdC5wdXNoKHRyZXN1bHRbaV0pO1xuICAgIH1cbiAgfVxuICAvKmlmKHJlc3VsdC5sZW5ndGggPCAxKXtcbiAgICAvLyDpk4HmlK/mmK/ljIXlkKvkuInmnaHnmoRcbiAgICBsZXQgdGllWmhpSW5kZXhzQXJyYXkgPSBLUUNhcmQuZmluZFRpZVpoaShjYXJkTW9kZXMpO1xuICAgIGlmICh0aWVaaGlJbmRleHNBcnJheSkge1xuICAgICAgdGllWmhpSW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czEgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbM11dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMF0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgICByZXN1bHQucHVzaChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMyKTtcbiAgICAgICAgLy9yZXN1bHQudW5zaGlmdChzYW5UaWFvSW5kZXhzMyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0qL1xuXG4gIC8vaWYocmVzdWx0Lmxlbmd0aCA+IDEwKXtcbiAgLy8gIHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLDEwKTtcbiAgLy99XG5cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpO1xuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBbXTtcbn07XG5cbi8vIOaJvuWQjOiKsemhulxuLypLUUNhcmQuZmluZFRvbmdIdWFTaHVuID0gZnVuY3Rpb24gKGNhcmRNb2RlcywgbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBsZXQgcmVzdWx0ID0gW107XG4gIHZhciBzYW5TaHVuWmkgPSBLUUNhcmQuc2FuU2h1blppMShjYXJkTW9kZXMsbGVuZ3RoKTtcbiAgaWYoc2FuU2h1blppWzBdID09IG51bGwpe1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBmb3IodmFyIGk9MDtpPHNhblNodW5aaVswXS5sZW5ndGg7aSsrKSB7XG4gICAgdmFyIHMgPSBzYW5TaHVuWmlbMF1baV07XG4gICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHMsIGxlbmd0aCkpIHtcbiAgICAgIHJlc3VsdC51bnNoaWZ0KHNhblNodW5aaVsxXVtpXSk7XG5cbiAgICB9XG4gIH1cbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xuICAgIHJldHVybiByZXN1bHRcbiAgfWVsc2V7XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4xKGNhcmRNb2Rlcyk7XG4gIH1cbn07Ki9cbktRQ2FyZC5maW5kVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAoY2FyZHMsIGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xuICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgdmFyIGNvbG9yQyA9IFtdOyAvL+aiheiKsVxuICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gIHZhciBwb2ludFMgPSBbXTsgLy/pu5HmoYNcbiAgdmFyIHBvaW50SCA9IFtdOyAvL+e6ouW/g1xuICB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXG4gIHZhciBwb2ludEQgPSBbXTsgLy/mlrnlnZdcbiAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICBpZihjYXJkc1tpXS5jb2xvciA9PSAnNCcpe1xuICAgICAgaWYocG9pbnRTLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRTLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG5cbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMycpe1xuICAgICAgaWYocG9pbnRILmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRILnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzInKXtcbiAgICAgIGlmKHBvaW50Qy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50Qy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcxJyl7XG4gICAgICBpZihwb2ludEQuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludEQucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgY29sb3IgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcbiAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgaWYoY29sb3JbaV0ubGVuZ3RoID49IDUpe1xuICAgICAgY29sb3JbaV0uc29ydChmdW5jdGlvbihhMSxhMil7XG4gICAgICAgIHJldHVybiBhMS5wb2ludCAtIGEyLnBvaW50O1xuICAgICAgfSlcbiAgICAgIGNvbG9yU3VtLnB1c2goY29sb3JbaV0pO1xuICAgIH1cbiAgfVxuICB2YXIgcmVzdWx0ID0gW107XG4gIGZvcih2YXIgaT0wO2k8Y29sb3JTdW0ubGVuZ3RoO2krKykge1xuICAgIHZhciBzID0gY29sb3JTdW1baV1cbiAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIDUpIDw9IHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICB2YXIgc3ViQ2FyZHMgPSBzLnNsaWNlKHN0YXJ0LCBzdGFydCArIDUpO1xuICAgICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHN1YkNhcmRzKSkge1xuICAgICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2EpIHtcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkcy5sZW5ndGg7IHErKyl7XG4gICAgICAgICAgICB2YXIgciA9IGNhcmRzW3FdO1xuICAgICAgICAgICAgaWYociA9PT0gY2Epe1xuICAgICAgICAgICAgICBpbmRleHMucHVzaChxKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaW5kZXhzLnNvcnQoQXJyYXkuc29ydEJ5UG9pbnQpO1xuICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmKHJlc3VsdC5sZW5ndGggPiAwKXtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9ZWxzZXtcbiAgICBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRzKTtcbiAgICBpZiAoY2FyZHMgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGFkZnMpe1xuICAgICAgICBpZihhZGZzLnBvaW50ID09IDE0KXtcbiAgICAgICAgICBhZGZzLnBvaW50ID0gMTtcbiAgICAgICAgICBhZGZzLnNjb3JlcyA9IDE7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bjIwKGNhcmRzKTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4oY29udmVydGVkQ2FyZHMpO1xuICB9XG4gIC8vcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogbnVsbDtcbn07XG5LUUNhcmQuZmluZFRvbmdIdWFTaHVuMjAgPSBmdW5jdGlvbiAoY2FyZCwgbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZC5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZCkgfHwgW107XG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHZhciBjYXJkcyA9IGNhcmQua3FfZXhjbHVkZXMoY2FyZDIwKTtcblxuICBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xuICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgdmFyIGNvbG9yQyA9IFtdOyAvL+aiheiKsVxuICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gIHZhciBwb2ludFMgPSBbXTsgLy/pu5HmoYNcbiAgdmFyIHBvaW50SCA9IFtdOyAvL+e6ouW/g1xuICB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXG4gIHZhciBwb2ludEQgPSBbXTsgLy/mlrnlnZdcbiAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICBpZihjYXJkc1tpXS5jb2xvciA9PSAnNCcpe1xuICAgICAgaWYocG9pbnRTLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRTLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG5cbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMycpe1xuICAgICAgaWYocG9pbnRILmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRILnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzInKXtcbiAgICAgIGlmKHBvaW50Qy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50Qy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcxJyl7XG4gICAgICBpZihwb2ludEQuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludEQucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgY29sb3IgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcbiAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgaWYoY29sb3JbaV0ubGVuZ3RoID49IHBhcnNlSW50KDUgLSBjYXJkMjAubGVuZ3RoKSl7XG4gICAgICBjb2xvcltpXS5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiAgICAgICAgcmV0dXJuIGExLnBvaW50IC0gYTIucG9pbnQ7XG4gICAgICB9KVxuICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgfVxuICB9XG4gIC8vY2MubG9nKGNvbG9yU3VtKVxuXG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBpPTA7aTxjb2xvclN1bS5sZW5ndGg7aSsrKSB7XG4gICAgdmFyIHMgPSBjb2xvclN1bVtpXVxuICAgIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gICAgICB2YXIgbnVtID0gNSAtIGo7XG4gICAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgICAgdmFyIHN1YkNhcmRzID0gcy5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuICAgICAgICB2YXIgYm9vbCA9IHBhcnNlSW50KHN1YkNhcmRzW251bS0xXVsnc2NvcmVzJ10pIC0gcGFyc2VJbnQoc3ViQ2FyZHNbMF1bJ3Njb3JlcyddKSA8IDU7XG4gICAgICAgIGlmKGJvb2wpe1xuICAgICAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgICAgICB2YXIgbmV3Q2FyZDIwID0gY2FyZDIwLnNsaWNlKDAsaik7XG4gICAgICAgICAgc3ViQ2FyZHMgPSBzdWJDYXJkcy5jb25jYXQobmV3Q2FyZDIwKTtcbiAgICAgICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhKSB7XG4gICAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkLmxlbmd0aDsgcSsrKXtcbiAgICAgICAgICAgICAgdmFyIHIgPSBjYXJkW3FdO1xuICAgICAgICAgICAgICBpZihyID09PSBjYSl7XG4gICAgICAgICAgICAgICAgaW5kZXhzLnB1c2gocSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGluZGV4cy5zb3J0KEFycmF5LnNvcnRCeU51bWJlcik7XG5cbiAgICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy9jYy5sb2cocmVzdWx0KVxuICAvL2NjLmxvZygnLS0tLS0tLS0zNTcnKVxuICBpZihyZXN1bHQubGVuZ3RoID4gMCl7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfWVsc2V7XG4gICAgbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkKTtcbiAgICBpZiAoY2FyZCA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4yMChjb252ZXJ0ZWRDYXJkcyk7XG4gIH1cbiAgLy9yZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBudWxsO1xufTtcblxuLy8g5om+6ZOB5pSvXG4vLyDlpoLvvJpbWzEsMiwzLDRdXVxuS1FDYXJkLmZpbmRUaWVaaGkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIHZhciByZXN1bHQgPSAgS1FDYXJkLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCA0KTtcbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgcmVzdWx0ID0gW107XG4gIC8vIOS6lOWQjOaYr+WMheWQq+mTgeaUr+eahFxuICBsZXQgd3VUb25nSW5kZXhzQXJyYXkgPSBLUUNhcmQuZmluZFd1VG9uZyhjYXJkTW9kZXMpO1xuICBpZiAod3VUb25nSW5kZXhzQXJyYXkpIHtcbiAgICB3dVRvbmdJbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgbGV0IHRpZVpoaUluZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgIGxldCB0aWVaaGlJbmRleHMxID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1s0XV07XG4gICAgICBsZXQgdGllWmhpSW5kZXhzMiA9IFtpbmRleHNbMF0sIGluZGV4c1sxXSwgaW5kZXhzWzNdLCBpbmRleHNbNF1dO1xuICAgICAgbGV0IHRpZVpoaUluZGV4czMgPSBbaW5kZXhzWzBdLCBpbmRleHNbMl0sIGluZGV4c1szXSwgaW5kZXhzWzRdXTtcbiAgICAgIGxldCB0aWVaaGlJbmRleHM0ID0gW2luZGV4c1sxXSwgaW5kZXhzWzJdLCBpbmRleHNbM10sIGluZGV4c1s0XV07XG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHMwKTtcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czEpO1xuICAgICAgcmVzdWx0LnB1c2godGllWmhpSW5kZXhzMik7XG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHMzKTtcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czQpO1xuICAgIH0pO1xuICB9XG4gIGlmKHJlc3VsdC5sZW5ndGggPiAxMCl7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsMTApO1xuICB9XG4gIHJlc3VsdCA9IEtRQ2FyZC5yZXBlYXQocmVzdWx0KTtcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogS1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDQpO1xufTtcbi8v5om+5LqU5ZCMXG5LUUNhcmQuZmluZFd1VG9uZyA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgaWYoY2FyZE1vZGVzLmxlbmd0aCA8IDUpe1xuICAgIHJldHVybiBbXTtcbiAgfVxuICB2YXIgcmVzdWx0ID0gdGhpcy5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgNSkgfHwgW107XG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IEtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2Rlcyw1KTtcbn07XG4vLyDmib7pobrlrZBcbi8vIOWmgu+8mltbMSwgMiwgMywgNCwgNV1dXG5LUUNhcmQuZmluZFNodW5aaSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBpZih0eXBlb2YoY2FyZE1vZGVzWzBdWydwb2ludCddKT09XCJ1bmRlZmluZWRcIil7XG4gICAgY2FyZE1vZGVzID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRNb2Rlcyk7XG4gIH1cbiAgLy8g5YWI5qC55o2u54K55pWw5Y676YeNXG4gIGxldCB1bmlxdWVDYXJkcyA9IGNhcmRNb2Rlcy51bmlxdWUoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XG4gICAgcmV0dXJuIGNhcmQxLnBvaW50ID09IGNhcmQyLnBvaW50O1xuICB9KTtcbiAgdW5pcXVlQ2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpO1xuXG4gIC8vIOWmguaenOaciSBB77yM5YiZ5Zyo5pyA5ZCO5re75YqgIDE0XG4gIGxldCBjYXJkQSA9IGNhcmRNb2Rlcy5maW5kKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gMTtcbiAgfSk7XG4gIGlmIChjYXJkQSkge1xuICAgIGxldCBjYXJkQVBsdXMgPSBuZXcgS1FDYXJkKGNhcmRBKTtcbiAgICBjYXJkQVBsdXMucG9pbnQgPSAxNDtcbiAgICB1bmlxdWVDYXJkcy5wdXNoKGNhcmRBUGx1cyk7XG4gIH1cblxuICBsZXQgcmVzdWx0ID0gW107XG5cbiAgLy8g55Sx5LqO54K55pWw5piv5ZSv5LiA5LiU5Y2H5bqP77yM5Y+q6ZyA6KaB5L6d5qyh6YGN5Y6G5Yik5pat5piv5ZCm5piv6aG65a2Q5Y2z5Y+vXG4gIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbGVuZ3RoKSA8PSB1bmlxdWVDYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICBsZXQgc3ViQ2FyZHMgPSB1bmlxdWVDYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBsZW5ndGgpO1xuICAgIGlmIChLUUNhcmQuaXNTaHVuWmkoc3ViQ2FyZHMsIGxlbmd0aCkpIHtcbiAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgICAgICBsZXQgaW5kZXggPSBjYXJkTW9kZXMuZmluZEluZGV4KGZ1bmN0aW9uIChvcmlnaW5DYXJkKSB7XG5cbiAgICAgICAgICBpZiAoY2FyZC5wb2ludCA9PSAxNCkge1xuICAgICAgICAgICAgcmV0dXJuIG9yaWdpbkNhcmQucG9pbnQgPT0gMTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gY2FyZCA9PT0gb3JpZ2luQ2FyZDtcbiAgICAgICAgfSk7XG4gICAgICAgIGluZGV4cy5wdXNoKGluZGV4KTtcbiAgICAgIH0pO1xuXG4gICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgcmVzdWx0LnVuc2hpZnQoaW5kZXhzKTtcbiAgICB9XG4gIH1cblxuICAvLyDlpITnkIbngrnmlbDph43lpI3nmoTmg4XlhrVcbiAgLy8g5q+U5aaCIEEgQSBLIFEgSiAxMCDov5nnp40gXG4gIGxldCByZXBlYXRJbmRleHNBcnJheSA9IEtRQ2FyZC5fZmluZFJlcGVhdFBvaW50SW5kZXhzQXJyYXkocmVzdWx0LCBjYXJkTW9kZXMpO1xuICByZXBlYXRJbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XG4gIH0pO1xuXG4gIHJlc3VsdC5zb3J0KGZ1bmN0aW9uIChhcnIxLCBhcnIyKSB7XG4gICAgcmV0dXJuIGFycjFbMF0gLSBhcnIyWzBdO1xuICB9KTtcblxuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBLUUNhcmQuZmluZFNodW5aaTIwKGNhcmRNb2Rlcyk7XG59O1xuS1FDYXJkLmZpbmRTaHVuWmkyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMgLGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZE1vZGVzKTtcbiAgaWYoY2FyZDIwLmxlbmd0aCA8PSAwKXtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIGNhcmRzID0gY2FyZE1vZGVzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gIC8vIOWFiOagueaNrueCueaVsOWOu+mHjVxuICB2YXIgbmV3QXJyID0gW107XG4gIHZhciBuZXdBcnJzID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAobmV3QXJycy5pbmRleE9mKGNhcmRzW2ldWydwb2ludCddKSA9PSAtMSkge1xuICAgICAgbmV3QXJyLnB1c2goY2FyZHNbaV0pO1xuICAgICAgbmV3QXJycy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICB9XG4gIH1cblxuICBuZXdBcnIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgcmV0dXJuIG4xLnBvaW50IC0gbjIucG9pbnQ7XG4gIH0pO1xuICB2YXIgcmVzdWx0ID0gW107XG4gIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gICAgdmFyIG51bSA9IGxlbmd0aCAtIGo7XG4gICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IG5ld0Fyci5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgIHZhciBzdWJDYXJkcyA9IG5ld0Fyci5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuICAgICAgdmFyIGJvb2wgPSBwYXJzZUludChzdWJDYXJkc1tudW0tMV1bJ3BvaW50J10pIC0gcGFyc2VJbnQoc3ViQ2FyZHNbMF1bJ3BvaW50J10pIDwgbGVuZ3RoO1xuICAgICAgaWYoYm9vbCl7XG4gICAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgICAgdmFyIG5ld0NhcmQyMCA9IGNhcmQyMC5zbGljZSgwLGopO1xuICAgICAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLmNvbmNhdChuZXdDYXJkMjApO1xuICAgICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkTW9kZXMubGVuZ3RoOyBxKyspe1xuICAgICAgICAgICAgdmFyIHIgPSBjYXJkTW9kZXNbcV07XG4gICAgICAgICAgICBpZihyID09PSBjYXJkKXtcbiAgICAgICAgICAgICAgaW5kZXhzLnB1c2gocSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmKHJlc3VsdC5sZW5ndGggPiAwKXtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9ZWxzZXtcbiAgICBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRNb2Rlcyk7XG4gICAgaWYgKGNhcmRNb2RlcyA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kU2h1blppMjAoY29udmVydGVkQ2FyZHMpO1xuICB9XG59O1xuS1FDYXJkLl9maW5kUmVwZWF0UG9pbnRJbmRleHNBcnJheSA9IGZ1bmN0aW9uKGluZGV4c0FycmF5LCBvcmlnaW5DYXJkcykge1xuICBsZXQgcmVwZWF0SW5kZXhzQXJyYXkgPSBbXTtcbiAgaW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICBsZXQgY2FyZHMgPSBpbmRleHMubWFwKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICByZXR1cm4gb3JpZ2luQ2FyZHNbaW5kZXhdO1xuICAgIH0pO1xuXG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkLCBpbmRleCkge1xuICAgICAgbGV0IG9yaWdpbkluZGV4ID0gb3JpZ2luQ2FyZHMuZmluZEluZGV4KGZ1bmN0aW9uKG9yaWdpbkNhcmQpIHtcbiAgICAgICAgaWYodHlwZW9mKGNhcmQpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9yaWdpbkNhcmQgIT09IGNhcmQgJiYgb3JpZ2luQ2FyZC5wb2ludCA9PSBjYXJkLnBvaW50KSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChvcmlnaW5JbmRleCA8IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgcmVwZWF0SW5kZXhzID0gaW5kZXhzLnNsaWNlKCk7XG4gICAgICByZXBlYXRJbmRleHNbaW5kZXhdID0gb3JpZ2luSW5kZXg7XG4gICAgICByZXBlYXRJbmRleHNBcnJheS5wdXNoKHJlcGVhdEluZGV4cyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHJldHVybiByZXBlYXRJbmRleHNBcnJheTtcbn07XG5cbi8vIOaJvuWQjOiKsVxuLy8g5aaC77yaW1sxLCAyLCAzLCA0LCA1XV1cbktRQ2FyZC5maW5kVG9uZ0h1YSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsIGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBsZXQgY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRNb2Rlcyk7XG4gIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcblxuICBsZXQgcmVzdWx0ID0gW107XG4gIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbGVuZ3RoKSA8PSBjYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICBsZXQgc3ViQ2FyZHMgPSBjYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBsZW5ndGgpO1xuICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBsZW5ndGgpKSB7XG4gICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgbGV0IGluZGV4ID0gY2FyZE1vZGVzLmZpbmRJbmRleChmdW5jdGlvbiAob3JpZ2luQ2FyZCkge1xuICAgICAgICAgIHJldHVybiBjYXJkID09PSBvcmlnaW5DYXJkO1xuICAgICAgICB9KTtcbiAgICAgICAgICBpbmRleHMucHVzaChpbmRleCk7XG4gICAgICB9KTtcbiAgICAgIC8vaW5kZXhzID0gaW5kZXhzLmxlbmd0aCA+IDUgPyBpbmRleHMuc3BsaWNlKDEsMSkgOiBpbmRleHM7XG4gICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgcmVzdWx0LnVuc2hpZnQoaW5kZXhzKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogS1FDYXJkLmZpbmRUb25nSHVhMjAoY2FyZE1vZGVzKTtcbn07XG5LUUNhcmQuZmluZFRvbmdIdWEyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCA1KSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRNb2Rlcyk7XG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciBjYXJkcyA9IGNhcmRNb2Rlcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAvLyDlhYjmoLnmja7ngrnmlbDljrvph41cbiAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuXG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICB2YXIgbnVtID0gNSAtIGo7XG4gICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IGNhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuICAgICAgdmFyIHN1YkNhcmRzID0gY2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcbiAgICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBudW0pKSB7XG4gICAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgICAgdmFyIG5ld0NhcmQyMCA9IGNhcmQyMC5zbGljZSgwLGopO1xuICAgICAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLmNvbmNhdChuZXdDYXJkMjApO1xuICAgICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkTW9kZXMubGVuZ3RoOyBxKyspe1xuICAgICAgICAgICAgdmFyIHIgPSBjYXJkTW9kZXNbcV07XG4gICAgICAgICAgICBpZihyID09PSBjYXJkKXtcbiAgICAgICAgICAgICAgaW5kZXhzLnB1c2gocSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IFtdO1xufTtcblxuS1FDYXJkLmZpbmRIdUx1ID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICBsZXQgbGVuZ3RoID0gNTtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuXG4gIHZhciBwXzM9S1FDYXJkLmZpbmRTYW5UaWFvKGNhcmRNb2Rlcyk7XG4gIHZhciBwXzQ9S1FDYXJkLmZpbmRUaWVaaGkoY2FyZE1vZGVzKTtcbiAgdmFyIHAyPUtRQ2FyZC5maW5kRHVpWmkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgLy92YXIgcF8zID0gIHRoaXMuX2ZpbmRQb2ludExlbmd0aChjYXJkTW9kZXMsIDMpIHx8IFtdO1xuICAvL3ZhciBwXzQgPSB0aGlzLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCA0KSB8fCBbXTtcbiAgLy92YXIgcDIgPSB0aGlzLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCAyKSB8fCBbXTtcbiAgaWYocDIubGVuZ3RoIDw9IDApe1xuICAgIGlmIChwXzMpIHtcbiAgICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV1dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMF0sIGluZGV4c1syXV07XG4gICAgICAgIGxldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMV0sIGluZGV4c1syXV07XG4gICAgICAgIHAyLnB1c2goc2FuVGlhb0luZGV4czApO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICBwMi5wdXNoKHNhblRpYW9JbmRleHMzKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChwXzQpIHtcbiAgICAgIHBfNC5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV1dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMF0sIGluZGV4c1syXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czMgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzNCA9IFtpbmRleHNbMV0sIGluZGV4c1szXV07XG4gICAgICAgIGxldCBzYW5UaWFvSW5kZXhzNiA9IFtpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICAgIHAyLnB1c2goc2FuVGlhb0luZGV4czApO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czIpO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czMpO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czQpO1xuICAgICAgICBwMi5wdXNoKHNhblRpYW9JbmRleHM2KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG5cblxuICBpZiAoKHAyID09IG51bGwpIHx8IChwXzMgPT0gbnVsbCkpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIHRyZXN1bHQ9W11cbiAgcDIuZm9yRWFjaChmdW5jdGlvbiAoaV8zKSB7XG4gICAgdmFyIHM9aV8zO1xuICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uIChpXzIpIHtcbiAgICAgIHMgPSBpXzMuY29uY2F0KGlfMik7XG4gICAgICBmb3IodmFyIGkgPTA7aTxzLmxlbmd0aC0xO2krKyl7XG4gICAgICAgIHZhciBpbmRleCA9IHNbaV07XG4gICAgICAgIGZvcih2YXIgaiA9aSsxO2o8cy5sZW5ndGg7aisrKXtcbiAgICAgICAgICBpZihpbmRleCA9PSBzW2pdKSB7XG4gICAgICAgICAgICBzID0gbnVsbDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZihzID09IG51bGwpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYocyAhPT0gbnVsbCl7XG4gICAgICAgIHRyZXN1bHQudW5zaGlmdChzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIGlmKHRyZXN1bHQubGVuZ3RoID4gMTApe1xuICAgIHRyZXN1bHQgPSB0cmVzdWx0LnNsaWNlKDAsMTApO1xuICB9XG4gIHJldHVybiB0cmVzdWx0Lmxlbmd0aCA+IDAgPyB0cmVzdWx0IDogS1FDYXJkLmZpbmRIdUx1MjAoY2FyZE1vZGVzKTtcbn07XG5LUUNhcmQuZmluZEh1THUyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgbGV0IGxlbmd0aCA9IDU7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRNb2RlcykgfHwgW107XG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciBwXzM9S1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDMpO1xuICB2YXIgcF80PUtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2Rlcyw0KTtcbiAgdmFyIHBfMj1LUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMik7XG4gIGlmKHBfMj09bnVsbCl7XG4gICAgcF8yPVtdO1xuICB9XG4gIGlmIChwXzMpIHtcbiAgICBwXzMuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgIGxldCBzYW5UaWFvSW5kZXhzMCA9IFtpbmRleHNbMF0sIGluZGV4c1sxXV07XG4gICAgICBsZXQgc2FuVGlhb0luZGV4czMgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgcF8yLnVuc2hpZnQoc2FuVGlhb0luZGV4czApO1xuICAgICAgcF8yLnVuc2hpZnQoc2FuVGlhb0luZGV4czMpO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKHBfNCkge1xuICAgIHBfNC5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdXTtcbiAgICAgIGxldCBzYW5UaWFvSW5kZXhzNiA9IFtpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICBwXzIudW5zaGlmdChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICBwXzIudW5zaGlmdChzYW5UaWFvSW5kZXhzNik7XG4gICAgfSk7XG4gIH1cblxuICBpZiAoKHBfMiA9PSBudWxsKSB8fCAocF8zID09IG51bGwpKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciB0cmVzdWx0PVtdXG4gIHBfMi5mb3JFYWNoKGZ1bmN0aW9uIChpXzMpIHtcbiAgICB2YXIgcz1pXzM7XG4gICAgcF8zLmZvckVhY2goZnVuY3Rpb24gKGlfMikge1xuICAgICAgcyA9IGlfMy5jb25jYXQoaV8yKTtcbiAgICAgIGZvcih2YXIgaSA9MDtpPHMubGVuZ3RoLTE7aSsrKXtcbiAgICAgICAgdmFyIGluZGV4ID0gc1tpXTtcbiAgICAgICAgZm9yKHZhciBqID1pKzE7ajxzLmxlbmd0aDtqKyspe1xuICAgICAgICAgIGlmKGluZGV4ID09IHNbal0pIHtcbiAgICAgICAgICAgIHMgPSBudWxsO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKHMgPT0gbnVsbCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZihzICE9PSBudWxsKXtcbiAgICAgICAgdHJlc3VsdC51bnNoaWZ0KHMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiAgaWYodHJlc3VsdC5sZW5ndGggPiAxMCl7XG4gICAgdHJlc3VsdCA9IHRyZXN1bHQuc2xpY2UoMCwxMCk7XG4gIH1cbiAgcmV0dXJuIHRyZXN1bHQubGVuZ3RoID4gMCA/IHRyZXN1bHQgOiBbXTtcbn07XG5cbktRQ2FyZC5maW5kR3VpUGFpID0gZnVuY3Rpb24gKGNhcmRNb2RlcyxudW1CZXIgPSAxKSB7XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRNb2RlcykubWFwKGZ1bmN0aW9uKGNhcmQpey8v5b6X5Yiw6ay854mM55qE57Si5byVXG4gICAgZm9yKHZhciBxID0gMDtxIDwgY2FyZE1vZGVzLmxlbmd0aDsgcSsrKXtcbiAgICAgIHZhciByID0gY2FyZE1vZGVzW3FdO1xuICAgICAgaWYociA9PT0gY2FyZCl7XG4gICAgICAgIHJldHVybiBxO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICB2YXIgbnVtID0gbnVtQmVyLWo7Ly/pmaTprLzniYzlpJYg5oiR5bqU6K+l5om+5aSa5bCR5byg54mM5Yy56YWNXG4gICAgdmFyIGluZGV4cyA9IEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgbnVtKSB8fCBbXTtcbiAgICBmb3IodmFyIHQgPSAwO3QgPCBpbmRleHMubGVuZ3RoOyB0KyspIHtcbiAgICAgIGlmKG51bUJlciA9PSAyKXsvL+aYr+WvueWtkOeahOaXtuWAmeaKiumsvOeJjOWSjOWNleW8oOWMuemFjemDveW+queOr+S4gOmBjVxuICAgICAgICBmb3IodmFyIG8gPSAwO28gPCBjYXJkMjAubGVuZ3RoOysrbyl7XG4gICAgICAgICAgdmFyIHMgPSBpbmRleHNbdF0uY29uY2F0KGNhcmQyMFtvXSk7XG4gICAgICAgICAgaWYocy5sZW5ndGggPT0gbnVtQmVyKXtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfWVsc2V7XG4gICAgICAgIHZhciBzID0gaW5kZXhzW3RdLmNvbmNhdChjYXJkMjAuc2xpY2UoMCxqKSk7Ly/kvp3mrKHnm7jliqDprLzniYznrKzkuIDmrKHliqDkuIDlvKAg6YCS5aKeXG4gICAgICAgIGlmKHMubGVuZ3RoID09IG51bUJlcil7XG4gICAgICAgICAgcmVzdWx0LnB1c2gocyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDEwKXtcbiAgICByZXN1bHQgPSByZXN1bHQuc2xpY2UoMCwxMCk7XG4gIH1cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpOy8v5Y676YeNXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IFtdO1xufTtcblxuS1FDYXJkLnJlcGVhdCA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgZm9yKHZhciBpID0wO2k8cmVzdWx0Lmxlbmd0aDtpKyspe1xuICAgIHZhciBpbmRleCA9IHJlc3VsdFtpXTtcblxuICAgIHZhciBuZXdBeXkgPSBbXTtcbiAgICBmb3IodmFyIG8gPSAwO28gPCBpbmRleC5sZW5ndGg7bysrKXsvL+aciemHjeWkjeW5suaOieS9oFxuICAgICAgaWYobmV3QXl5LmluZGV4T2YoaW5kZXhbb10pID09IC0xKXtcbiAgICAgICAgbmV3QXl5LnB1c2goaW5kZXhbb10pO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHJlc3VsdC5zcGxpY2UoaSwxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yKHZhciBqID1pKzE7ajxyZXN1bHQubGVuZ3RoLTE7aisrKXtcbiAgICAgIHZhciBzID0gcmVzdWx0W2pdO1xuICAgICAgdmFyIGpTdHJpbmcgPSAnJztcbiAgICAgIHZhciBpU3RyaW5nID0gJyc7XG4gICAgICBmb3IodmFyIHIgPSAwO3IgPCBzLmxlbmd0aDtyKyspe1xuICAgICAgICAgIGpTdHJpbmcgPSBqU3RyaW5nICsgc1tyXTtcbiAgICAgICAgICBpU3RyaW5nID0gaVN0cmluZyArIGluZGV4W3JdO1xuICAgICAgfVxuICAgICAgaWYoalN0cmluZyA9PSBpU3RyaW5nKXsvL+aciemHjeWkjeW5suaOieS9oFxuICAgICAgICByZXN1bHQuc3BsaWNlKGksMSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5cbktRQ2FyZC50ZXN0RmluZCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgdmFyIFd1VG9uZyA9IEtRQ2FyZC5maW5kV3VUb25nKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBUb25nSHVhU2h1biA9IEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4oY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIFRpZVpoaSA9IEtRQ2FyZC5maW5kVGllWmhpKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBIdUx1ID0gS1FDYXJkLmZpbmRIdUx1KGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBUb25nSHVhID0gS1FDYXJkLmZpbmRUb25nSHVhKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBTaHVuWmkgPSBLUUNhcmQuZmluZFNodW5aaShjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgU2FuVGlhbyA9IEtRQ2FyZC5maW5kU2FuVGlhbyhjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgTGlhRHVpID0gS1FDYXJkLmZpbmRMaWFEdWkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIER1aVppID0gS1FDYXJkLmZpbmREdWlaaShjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgcmVzdWx0ID0gW1xuICAgIFd1VG9uZyxcbiAgICBUb25nSHVhU2h1bixcbiAgICBUaWVaaGksXG4gICAgSHVMdSxcbiAgICBUb25nSHVhLFxuICAgIFNodW5aaSxcbiAgICBTYW5UaWFvLFxuICAgIExpYUR1aSxcbiAgICBEdWlaaSxcbiAgXVxuICByZXR1cm4gcmVzdWx0O1xufTtcbiIsIi8vIOeJjOeCueaVsOW4ruWKqeexu1xuLy8g55So5p2l6K6h566X5LiA5Liq54mM5pWw57uE5YaF55qE55u45ZCM54K55pWw55qE54mM55qE5byg5pWwXG52YXIgS1FDYXJkUG9pbnRzSGVscGVyID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdGhpcy5wb2ludE51bWJlcnMgPSB7fTtcbiAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIGxldCBwb2ludCA9IGNhcmQucG9pbnQ7XG4gICAgICAgIHZhciBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twb2ludF0gfHwgMDtcbiAgICAgICAgdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdID0gbnVtYmVyICsgMTtcbiAgICB9LmJpbmQodGhpcykpO1xufTtcblxuLy8g55u45ZCM54K55pWw54mM55qE5pyA5aSn5pWw6YePXG5LUUNhcmRQb2ludHNIZWxwZXIucHJvdG90eXBlLm1heE51bWJlciA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHJlc3VsdCA9IDA7XG4gIGZvciAobGV0IHByb3AgaW4gdGhpcy5wb2ludE51bWJlcnMpIHtcbiAgICBsZXQgbnVtYmVyID0gdGhpcy5wb2ludE51bWJlcnNbcHJvcF07XG4gICAgICAvL2lmKG51bWJlciA8IDIwKXtcbiAgICAgICAgICByZXN1bHQgPSBNYXRoLm1heChudW1iZXIsIHJlc3VsdCk7XG4gICAgICAvL31cbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBLUUNhcmRQb2ludHNIZWxwZXI7XG5cbi8qdmFyIGNhcmRzID0gW1xuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoyfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjR9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo0fSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjZ9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo4fSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEwfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMn0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEyfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTR9XG5dO1xudmFyIHRlc3QgPSBuZXcgS1FDYXJkUG9pbnRzU2FtZShjYXJkcyk7XG5jb25zb2xlLmxvZyh0ZXN0KTsqL1xuIiwibGV0IEhlbHBlciA9IHtcbiAgbG9hZENhcmRTcHJpdGVGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaykge1xuICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUoY2FyZE5hbWUsIGNhbGxiYWNrKTtcbiAgfSxcblxuICBzZXRDYXJkU3ByaXRlRnJhbWU6IGZ1bmN0aW9uIChzcHJpdGUsIGNhcmROYW1lKSB7XG4gICAgdGhpcy5sb2FkQ2FyZFNwcml0ZUZyYW1lKGNhcmROYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcbiAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuICAgIH0pO1xuICB9LFxuXG4gIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lKSB7XG4gICAgdmFyIGNhcmROYW1lID0gY2FyZFNob3J0TmFtZTtcbiAgICBpZiAoIWNhcmROYW1lLnN0YXJ0c1dpdGgoXCJwdWJsaWMtcGljLWNhcmQtcG9rZXJcIikpIHtcbiAgICAgIGNhcmROYW1lID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2FyZE5hbWU7XG4gIH0sXG5cbiAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2spIHtcbiAgICBjYy5hc3NlcnQoY2FsbGJhY2spO1xuXG4gICAgY2MubG9hZGVyLmxvYWRSZXMoXCJwbGF5L0NhcmRUeXBlQ29tYmluZS9wb2NrTGlzdFwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgZXJyKVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNhcmROYW1lID0gdGhpcy5fY2FyZEZ1bGxOYW1lKGNhcmROYW1lKTtcbiAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcbiAgICAgIGNhbGxiYWNrKGZyYW1lKTtcbiAgICB9LmJpbmQodGhpcykpO1xuICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBIZWxwZXI7XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcbmNvbnN0IEtRQ2FyZENvbG9yc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZENvbG9yc0hlbHBlcicpO1xuY29uc3QgS1FDYXJkU2NvcmV0c0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFNjb3JldHNIZWxwZXInKTtcbmNvbnN0IEdldENhcmRQb2ludHNTYW1lQ291bnQgPSByZXF1aXJlKCdHZXRDYXJkUG9pbnRzU2FtZUNvdW50Jyk7XG5jb25zdCBLUUNhcmRQb2ludHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRQb2ludHNIZWxwZXInKTtcblxuS1FDYXJkLnNjb3JlT2ZDYXJkcyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICBpZihjYXJkcyA9PSBudWxsIHx8IGNhcmRzLmxlbmd0aCA9PSBudWxsKSB7XG4gICAgY2FyZHMgPSBbXTtcbiAgfVxuXG4gIHZhciBpc1RvdSA9IGNhcmRzLmxlbmd0aCA9PSAzO1xuICBsZXQgdHlwZVNjb3JlID0gS1FDYXJkLl90eXBlU2NvcmVPZkNhcmRzKGNhcmRzKTtcbiAgdmFyIGNhbGVDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQShjYXJkcy5zbGljZSgpKTtcbiAgY2FsZUNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XG4gICAgaWYoY2FyZC5zY29yZXMgPT0gMSl7XG4gICAgICBjYXJkLnNjb3JlcyA9IDE0O1xuICAgIH1cbiAgfSlcbiAgLy9jYWxlQ2FyZHMgPSBLUUNhcmQuU29ydChjYWxlQ2FyZHMpO1xuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYWxlQ2FyZHMpO1xuICB2YXIgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkU2NvcmV0c0hlbHBlcihjYWxlQ2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKSk7XG4gIHZhciBtYXhOdW0gPSBwb2ludEhlbHBlci5tYXhOdW1iZXIoKS8qLWNhcmQyMC5sZW5ndGggPT0gMCA/IDE6IHBvaW50SGVscGVyLm1heE51bWJlcigpLWNhcmQyMC5sZW5ndGgqLztcblxuICB2YXIgbWF4U2NvcmUgPSAwOy8v6I635Y+W6Zmk6ay854mM5aSW5pyA5aSn55qE55qE54K55pWwXG4gIGZvcih2YXIgaSBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICBpZiAocGFyc2VJbnQoaSkgPiBtYXhTY29yZSAmJiBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbaV0gPT0gbWF4TnVtKSB7XG4gICAgICBtYXhTY29yZSA9IHBhcnNlSW50KGkpO1xuICAgIH1cbiAgfVxuICBjYWxlQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcbiAgICBpZihjYXJkLnNjb3JlcyA+PSAyMCl7XG4gICAgICBjYXJkLnNjb3JlcyA9IG1heFNjb3JlO1xuICAgIH1cbiAgfSlcbiAgY2FyZDIwLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XG4gICAgY2FyZC5zY29yZXMgPSBtYXhTY29yZTtcbiAgfSlcbiAgLy9jYy5sb2cobWF4TnVtKVxuICAvL2NjLmxvZyhtYXhTY29yZSlcbiAgLy9jYy5sb2coY2FsZUNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCkpXG4gIC8vY2MubG9nKCctLS0tMzUnKVxuICBjYWxlQ2FyZHMuc29ydChLUUNhcmQuc29ydCk7XG4gIGlmKHR5cGVTY29yZSA9PSA5MDAwMDAwMDAwMDAwMDAwKXtcbiAgICAvL+S6lOWQjFxuICAgIGNhbGVDYXJkcy5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiAgICAgIHJldHVybiBhMi5zY29yZXMgLSBhMS5zY29yZXM7XG4gICAgfSk7XG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xuICAgIC8vdmFyIHRvdGFsQ29sb3IgPSBcIlwiO1xuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcbiAgICAgIC8vdmFyIGMgPSBjYWxlQ2FyZHNbaV0uY29sb3I7XG4gICAgICB0b3RhbFZhbHVlID0gKHBhcnNlSW50KHMpID49IDEwID8gcyA6IFwiMFwiK3MpK3RvdGFsVmFsdWU7XG4gICAgICAvL3RvdGFsQ29sb3IgPSBjK3RvdGFsQ29sb3I7XG4gICAgfVxuICAgIC8vdG90YWxWYWx1ZSA9IHRvdGFsVmFsdWUrdG90YWxDb2xvcjtcbiAgICAvL2NjLmxvZyh0b3RhbFZhbHVlKVxuICAgIC8vY2MubG9nKHBhcnNlSW50KHRvdGFsVmFsdWUpKVxuICAgIC8vY2MubG9nKHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlKSlcbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDgwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+WQjOiKsemhuuavlOacgOWkp+eahOmCo+W8oO+8jOWmguaenOS4pOW8oOebuOWQjOmCo+WwseaYr+ebuOWQjFxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKXsvL+aciemsvOeJjOeahOaXtuWAmeimgeaUueWPmOmsvOeJjOeahOWIhuaVsFxuICAgICAgY2FsZUNhcmRzID0gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FsZUNhcmRzKTtcbiAgICB9XG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcbiAgICAgIHRvdGFsVmFsdWUgPSAocGFyc2VJbnQocykgPj0gMTAgPyBzIDogXCIwXCIrcykrdG90YWxWYWx1ZTtcbiAgICAgIHZhciBjID0gY2FsZUNhcmRzW2ldLmNvbG9yOy8v54mM6ImyXG4gICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcbiAgICB9XG4gICAgaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlKTtcbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUgKyB2YWx1ZUNvbG9yKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA3MDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/pk4HmlK8s5om+5Ye66YKj5Zub5byg5piv5LuA5LmI54mMXG5cbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIGlmKG1heFNjb3JlID09IGNhbGVDYXJkc1t3XS5zY29yZXMpey8v5LiJ5p2hXG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuICAgICAgfWVsc2V7XG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcblxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxuICAgICAgICBvbmVWYWx1ZUNvbG9yID0gYyArIG9uZVZhbHVlQ29sb3I7Ly/niYzoibJcblxuICAgICAgfVxuICAgIH1cbiAgICAvL2lmKGNjLmh1YVNlID09IDApIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcbiAgICAvL3ZhciBxd2UgPSAnJztcbiAgICAvL3F3ZSA9IG9uZVZhbHVlQ29sb3Iuc3Vic3RyKDAsb25lVmFsdWVDb2xvci5sZW5ndGggLTEpO1xuICAgIC8vb25lVmFsdWVDb2xvciA9IG9uZVZhbHVlQ29sb3Iuc3Vic3RyKG9uZVZhbHVlQ29sb3IubGVuZ3RoIC0xKTtcbiAgICAvL3N0ciA9IHN0citvbmVWYWx1ZSArIG9uZVZhbHVlQ29sb3IgKyB2YWx1ZUNvbG9yICsgcXdlO1xuICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA2MDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/okavoiqZcbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIGlmKG1heFNjb3JlID09IGNhbGVDYXJkc1t3XS5zY29yZXMpey8v5LiJ5p2hXG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuICAgICAgfWVsc2V7XG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcblxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxuICAgICAgICBvbmVWYWx1ZUNvbG9yID0gYyArIG9uZVZhbHVlQ29sb3I7Ly/niYzoibJcblxuICAgICAgfVxuICAgIH1cblxuICAgIGlmKGlzVG91KXtcbiAgICAgIG9uZVZhbHVlID0gb25lVmFsdWUrJzAwMDAnO1xuICAgICAgb25lVmFsdWVDb2xvciA9IG9uZVZhbHVlQ29sb3IrJzAwJztcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vc3RyID0gc3RyK29uZVZhbHVlICsgdmFsdWVDb2xvciArIG9uZVZhbHVlQ29sb3I7XG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XG5cbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA1MDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/lkIzoirEs5pyJ5Y+v6IO96ZyA6KaB5q+UNeW8oOeJjFxuICAgIHZhciB0b3RhbFNjb3JlID0gXCJcIjtcbiAgICB2YXIgdG90YWxDb2xvciA9IFwiXCI7XG4gICAgLy92YXIgY29sb3JzID0gMDsvL+iOt+WPlueJjOeahOexu+Wei+minOiJslxuICAgIC8vZm9yKHZhciBpIGluIGNhbGVDYXJkcykge1xuICAgIC8vICBpZihwYXJzZUludChjYWxlQ2FyZHNbaV0ucG9pbnQpIDwgMjApe1xuICAgIC8vICAgIGNvbG9ycyA9IHBhcnNlSW50KGNhbGVDYXJkc1tpXS5jb2xvcik7XG4gICAgLy8gICAgYnJlYWs7XG4gICAgLy8gIH1cbiAgICAvL31cblxuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBwYWlQb2ludCA9IHBhcnNlSW50KGNhbGVDYXJkc1tpXS5wb2ludCk7XG4gICAgICB2YXIgY29sb3JzID0gcGFyc2VJbnQoY2FsZUNhcmRzW2ldLnBvaW50KSA8IDIwID8gY2FsZUNhcmRzW2ldLmNvbG9yOiA1O1xuICAgICAgdG90YWxDb2xvciA9IGNvbG9ycyArIHRvdGFsQ29sb3I7XG4gICAgICB0b3RhbFNjb3JlID0gKHBhaVBvaW50Pj0xMCA/IHBhaVBvaW50IDogXCIwXCIrcGFpUG9pbnQpK3RvdGFsU2NvcmU7XG4gICAgfVxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxTY29yZSk7XG4gICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsU2NvcmUpO1xuICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFNjb3JlK3RvdGFsQ29sb3IpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDQwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+mhuuWtkFxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKXsvL+aciemsvOeJjOeahOaXtuWAmeimgeaUueWPmOmsvOeJjOeahOWIhuaVsFxuICAgICAgY2FsZUNhcmRzID0gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FsZUNhcmRzKTtcbiAgICB9XG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcbiAgICAgIHRvdGFsVmFsdWUgPSAocGFyc2VJbnQocykgPj0gMTAgPyBzIDogXCIwXCIrcykrdG90YWxWYWx1ZTtcblxuICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbaV0uY29sb3I7Ly/niYzoibJcbiAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuICAgIH1cbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpO1xuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlKTtcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxWYWx1ZSArIHZhbHVlQ29sb3IpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDMwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+S4ieadoe+8jOaJvuWHuuaYr+WTquW8oOeJjOaciTPlvKBcbiAgICAvL2NhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIHZhciBvbmVWYWx1ZUNvbG9yMjAgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciB3IGluIGNhbGVDYXJkcykge1xuICAgICAgaWYobWF4U2NvcmUgPT0gY2FsZUNhcmRzW3ddLnNjb3Jlcyl7Ly/kuInmnaFcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XG5cbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yOy8v54mM6ImyXG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIGlmKHBhcnNlSW50KHMpIDwgMjApe1xuICAgICAgICAgIG9uZVZhbHVlQ29sb3IgPSBjICsgb25lVmFsdWVDb2xvcjsvL+eJjOiJslxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICBvbmVWYWx1ZUNvbG9yMjAgPSBjICsgb25lVmFsdWVDb2xvcjIwOy8v54mM6ImyXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYoaXNUb3Upe1xuICAgICAgb25lVmFsdWUgPSBvbmVWYWx1ZSsnMDAwMCc7XG4gICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcisnMDAnO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0citvbmVWYWx1ZSk7XG4gICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0citvbmVWYWx1ZSk7XG4gICAgLy9zdHIgPSBzdHIrb25lVmFsdWUgKyBvbmVWYWx1ZUNvbG9yICsgdmFsdWVDb2xvciArIG9uZVZhbHVlQ29sb3IyMDtcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcblxuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDIwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL2NhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcbiAgICAvL+S4pOWvuSzmnInlj6/og73pnIDopoHmr5Q15byg54mMXG4gICAgdmFyIHN0ciA9IFwiXCI7XG4gICAgdmFyIG9uZVZhbHVlID0gJyc7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciBpIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgaWYocG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW2ldID09IDIpIHsvL+S4pOWvuVxuICAgICAgICBmb3IodmFyIHcgaW4gY2FsZUNhcmRzKSB7XG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbd10uc2NvcmVzKXtcbiAgICAgICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgICAgIHN0ciA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIHN0cjtcbiAgICAgICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGZvcih2YXIgcSBpbiBjYWxlQ2FyZHMpIHsvL+WNleW8oOWKoOiKseiJslxuICAgICAgICAgIGlmKGkgPT0gY2FsZUNhcmRzW3FdLnNjb3Jlcyl7XG4gICAgICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1txXS5zY29yZXM7XG4gICAgICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xuXG4gICAgICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1txXS5jb2xvcjsvL+eJjOiJslxuICAgICAgICAgICAgb25lVmFsdWVDb2xvciA9IG9uZVZhbHVlQ29sb3IgKyBjOy8v54mM6ImyXG5cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgfVxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcbiAgICAvL2lmKGNjLmh1YVNlID09IDApIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcbiAgICAvLy8vY2MubG9nKHN0cilcbiAgICAvLy8vY2MubG9nKG9uZVZhbHVlKVxuICAgIC8vc3RyID0gc3RyK29uZVZhbHVlICtvbmVWYWx1ZUNvbG9yICsgdmFsdWVDb2xvcjtcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSAxMDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/lr7nlrZBcbiAgICAvL2NhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjtcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7XG5cbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCl7XG4gICAgICBjYWxlQ2FyZHMuc29ydChmdW5jdGlvbihjYXJkMSxjYXJkMikge1xuICAgICAgICByZXR1cm4gY2FyZDIucG9pbnQtY2FyZDEucG9pbnQ7XG4gICAgICB9KTtcbiAgICAgIGNhbGVDYXJkcyA9IGNhbGVDYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAgICAgY2FsZUNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCxpbmRleCkge1xuICAgICAgICB2YXIgcyA9IGNhcmQuc2NvcmVzO1xuICAgICAgICB2YXIgYyA9IGNhcmQuY29sb3I7XG4gICAgICAgIHN0ciA9IHN0cisocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcyk7XG4gICAgICAgIGlmKGluZGV4ID09IDApe1xuICAgICAgICAgIHZhciBzMjAgPSBjYXJkMjBbMF0uc2NvcmVzO1xuICAgICAgICAgIHN0ciA9IHN0cisocGFyc2VJbnQoczIwKT49MTAgPyBzMjAgOlwiMFwiK3MyMCk7XG4gICAgICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrYztcbiAgICAgICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcitjYXJkMjBbMF0uY29sb3I7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIG9uZVZhbHVlQ29sb3IgPSBvbmVWYWx1ZUNvbG9yK2M7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy9jYy5sb2coc3RyKVxuICAgICAgLy9jYy5sb2coJy0tLS0tLS0tMjc0JylcbiAgICAgIGlmKGlzVG91KXtcbiAgICAgICAgc3RyID0gc3RyKycwMDAwJztcbiAgICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrJzAwJztcbiAgICAgIH1cbiAgICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcbiAgICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICAgICAgLy9zdHIgPSBzdHIgKyBvbmVWYWx1ZUNvbG9yICsgdmFsdWVDb2xvcjtcbiAgICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICAgIH1cblxuICAgIGZvcih2YXIgaSBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgIGlmKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tpXSA9PSBtYXhOdW0pIHsvL+WvueWtkFxuICAgICAgICBmb3IodmFyIHcgaW4gY2FsZUNhcmRzKSB7Ly/lr7nlrZDliqDoirHoibJcbiAgICAgICAgICBpZihpID09IGNhbGVDYXJkc1t3XS5zY29yZXMpe1xuICAgICAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICAgICAgdmFsdWVDb2xvciA9IGNhbGVDYXJkc1t3XS5jb2xvciArIHZhbHVlQ29sb3I7XG4gICAgICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgZm9yKHZhciBxIGluIGNhbGVDYXJkcykgey8v5Y2V5byg5Yqg6Iqx6ImyXG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbcV0uc2NvcmVzKXtcbiAgICAgICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3FdLnNjb3JlcztcbiAgICAgICAgICAgIG9uZVZhbHVlQ29sb3IgPSBjYWxlQ2FyZHNbcV0uY29sb3IgKyBvbmVWYWx1ZUNvbG9yO1xuICAgICAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgfVxuICAgIGlmKGlzVG91KXtcbiAgICAgIG9uZVZhbHVlID0gb25lVmFsdWUrJzAwMDAnO1xuICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrJzAwJztcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vc3RyID0gc3RyK29uZVZhbHVlK29uZVZhbHVlQ29sb3IrdmFsdWVDb2xvcjtcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSAwKSB7XG4gICAgLy/kuYzpvplcbiAgICB2YXIgdmFsdWVQb2ludCA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiO1xuICAgIGZvcih2YXIgcSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW3FdLnNjb3JlcztcbiAgICAgIHZhciBjID0gY2FsZUNhcmRzW3FdLmNvbG9yOy8v5Y2V5byg5Yqg6Iqx6ImyXG4gICAgICB2YWx1ZVBvaW50ID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgdmFsdWVQb2ludDtcbiAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjtcbiAgICB9XG4gICAgaWYoaXNUb3Upe1xuICAgICAgdmFsdWVQb2ludCA9IHZhbHVlUG9pbnQrJzAwMDAnO1xuICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrJzAwJztcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh2YWx1ZVBvaW50KTtcbiAgICAvL2lmKGNjLmh1YVNlID09IDApIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodmFsdWVQb2ludCk7XG4gICAgLy92YWx1ZVBvaW50ID0gdmFsdWVQb2ludCArIHZhbHVlQ29sb3I7XG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHZhbHVlUG9pbnQpO1xuICB9XG5cblxuICB2YXIgY2FyZHNUb3RhbFBvaW50PTA7XG4gIGNhbGVDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICBjYXJkc1RvdGFsUG9pbnQgKz0gY2FyZC5wb2ludDtcbiAgfSk7XG5cbiAgbGV0IHJlc3VsdCA9IHR5cGVTY29yZSArIGNhcmRzVG90YWxQb2ludDtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5LUUNhcmQuX2NoYW5nZUNhcmRTY29ycyA9IGZ1bmN0aW9uKGNhcmRNb2RlbCkge1xuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgY2FyZC5zY29yZXMgPSBjYXJkLnBvaW50O1xuICAgIGlmIChjYXJkLnNjb3JlcyA9PSAxKSB7XG4gICAgICBjYXJkLnNjb3JlcyA9IDE0O1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIGlzMTQgPSB0cnVlOy8v5pivIGsgcSBqIDEwIEE7XG4gIHZhciBpczEgPSB0cnVlOy8v5pivMSAyIDMgNCA1XG5cbiAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgIGlmIChjYXJkLnNjb3JlcyA8IDEwKSB7XG4gICAgICBpczE0ID0gZmFsc2U7IC8v5LiN5pivIGsgcSBqIDEwIEE7XG4gICAgfVxuICB9KTtcbiAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgIGNhcmQuc2NvcmVzID0gY2FyZC5wb2ludDtcbiAgICBpZiAoY2FyZC5zY29yZXMgPT0gMTQpIHtcbiAgICAgIGNhcmQuc2NvcmVzID0gMTtcbiAgICB9XG4gIH0pO1xuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgaWYgKGNhcmQuc2NvcmVzID4gNSAmJiBjYXJkLnNjb3JlcyAhPSAyMCkge1xuICAgICAgaXMxID0gZmFsc2U7Ly/kuI3mmK8xIDIgMyA0IDVcbiAgICB9XG4gIH0pO1xuXG4gIGlmIChpczE0KSB7IC8v5pivIGsgcSBqIDEwIEE7XG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgICAgaWYgKGNhcmQuc2NvcmVzID09IDEpIHtcbiAgICAgICAgY2FyZC5zY29yZXMgPSAxNDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge1xuICAgICAgcmV0dXJuIGEyLnNjb3JlcyAtIGExLnNjb3JlcztcbiAgICB9KTtcbiAgICB2YXIgbnVtID0gMTQ7XG4gICAgdmFyIHNjb3Jlc0F5eSA9IFtdOyAvL+S4gOWJr+eJjOeahOWIhuaVsFxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICBzY29yZXNBeXkucHVzaChudW0pO1xuICAgICAgbnVtIC09IDE7XG4gICAgfVxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRNb2RlbC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XG4gICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHtcbiAgICAgICAgICBzY29yZXNBeXkuc3BsaWNlKGosIDEpOyAvL+WIoOmZpOS4jeaYr+msvOeJjOeahOWIhlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC8vY2MubG9nKCctLS0tLS0tLS0t5pivIGsgcSBqIDEwIEEnLHNjb3Jlc0F5eSlcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7IC8v5om+5Ye66YCJ5Lit55qE54mMXG4gICAgICBpZiAoY2FyZC5wb2ludCA+PSAyMCkge1xuICAgICAgICBjYXJkLnNjb3JlcyA9IHNjb3Jlc0F5eS5zcGxpY2UoMCwgMSlbMF07XG4gICAgICB9XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfVxuICBlbHNlIGlmIChpczEpIHsgLy/mmK8xIDIgMyA0IDVcbiAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtcbiAgICAgIHJldHVybiBhMi5zY29yZXMgLSBhMS5zY29yZXM7XG4gICAgfSk7XG4gICAgdmFyIG51bSA9IDU7XG4gICAgdmFyIHNjb3Jlc0F5eSA9IFtdOyAvL+S4gOWJr+eJjOeahOWIhuaVsFxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICBzY29yZXNBeXkucHVzaChudW0pO1xuICAgICAgbnVtIC09IDE7XG4gICAgfVxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRNb2RlbC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XG4gICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHtcbiAgICAgICAgICBzY29yZXNBeXkuc3BsaWNlKGosIDEpOyAvL+WIoOmZpOS4jeaYr+msvOeJjOeahOWIhlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC8vY2MubG9nKCctLS0tLS0tLS0t5pivMSAyIDMgNCA1JylcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7IC8v5om+5Ye66YCJ5Lit55qE54mMXG4gICAgICBpZiAoY2FyZC5wb2ludCA+PSAyMCkge1xuICAgICAgICBjYXJkLnNjb3JlcyA9IHNjb3Jlc0F5eS5zcGxpY2UoMCwgMSlbMF07XG4gICAgICB9XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfVxuICBlbHNlIHtcbiAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtcbiAgICAgIHJldHVybiBhMS5zY29yZXMgLSBhMi5zY29yZXM7XG4gICAgfSk7XG4gICAgdmFyIHNjb3Jlc0F5eSA9IFtdOyAvL+eUqOadpeijhemsvOeJjOWIhuaVsFxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICB2YXIgcyA9IHBhcnNlSW50KGNhcmRNb2RlbFswXS5zY29yZXMpICsgaTsgLy/mnIDlsI/nmoTniYznmoTliIbmlbBcbiAgICAgIHNjb3Jlc0F5eS5wdXNoKHMpOy8v5LiA5Ymv54mM55qE5YiG5pWwXG4gICAgfVxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRNb2RlbC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XG4gICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHtcbiAgICAgICAgICBzY29yZXNBeXkuc3BsaWNlKGosIDEpOyAvL+WIoOmZpOS4jeaYr+msvOeJjOeahOWIhlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHsgLy/mlLnlj5jniYznmoTliIbmlbBcbiAgICAgIGlmIChjYXJkLnBvaW50ID49IDIwKSB7XG4gICAgICAgIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLDEpWzBdO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSk7XG4gIH1cblxuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgaWYgKGNhcmQuc2NvcmVzID09IDEpIHtcbiAgICAgIGNhcmQuc2NvcmVzID0gMTQ7XG4gICAgfVxuICB9KTtcbiAgY2FyZE1vZGVsLnNvcnQoZnVuY3Rpb24oYTEsIGEyKSB7XG4gICAgcmV0dXJuIGExLnNjb3JlcyAtIGEyLnNjb3JlcztcbiAgfSk7XG4gIHJldHVybiBjYXJkTW9kZWw7XG59O1xuLyojIyMjIyovXG5cbktRQ2FyZC5fdHlwZVNjb3JlT2ZDYXJkcyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICB2YXIgdHlwZVNjb3JlID0gMDtcbiAgaWYoS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZHMpKXtcbiAgICB0eXBlU2NvcmUgPSA5MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gODAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblRpZVpoaShjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSA3MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluSHVMdShjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSA2MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YShjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSA1MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2h1blppKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDQwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5TYW5UaWFvKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDMwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gMjAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkR1aVppKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDEwMDAwMDAwMDAwMDAwMDA7XG4gIH1cblxuICByZXR1cm4gdHlwZVNjb3JlO1xufTtcbi8qXG4gLy8g5qC55o2u54mM5Z6L6L+b6KGM5o6S5bqPXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0ID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gaWYgKChjYXJkcyA9PSBudWxsKSB8fCAoY2FyZHMubGVuZ3RoID09IDApKSB7XG4gcmV0dXJuIGNhcmRzO1xuIH1cbiBpZihLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcykpe1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRXdXRvbmcoY2FyZHMpO1xuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bihjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2h1blppKGNhcmRzKTtcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKSkge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRUaWVaaGkoY2FyZHMpO1xuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5IdUx1KGNhcmRzKSkge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRIdUx1KGNhcmRzKTtcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YShjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0VG9uZ0h1YShjYXJkcyk7XG4gfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblNodW5aaShjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2h1blppKGNhcmRzKTtcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2FuVGlhbyhjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2FuVGlhbyhjYXJkcyk7XG4gfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkxpYUR1aShjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0TGlhbmdEdWkoY2FyZHMpO1xuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5EdWlaaShjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0RHVpWmkoY2FyZHMpO1xuIH1cblxuIHJldHVybiBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCkucmV2ZXJzZSgpO1xuIH07XG5cbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRTaHVuWmkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiByZXR1cm4gY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpLnJldmVyc2UoKTtcbiB9O1xuXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0VGllWmhpID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xuIH07XG5cbiAvISojIyMjIyohL1xuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFd1dG9uZyA9IGZ1bmN0aW9uIChjYXJkcykge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcbiB9O1xuIC8hKiMjIyMjKiEvXG5cbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRIdUx1ID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xuIH07XG5cbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRUb25nSHVhID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gcmV0dXJuIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KS5yZXZlcnNlKCk7XG4gfTtcblxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhjYXJkcyk7XG4gfTtcblxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydExpYW5nRHVpID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xuIH07XG5cbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnREdWlaaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcbiB9O1xuICovXG5LUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzID0gZnVuY3Rpb24oY2FyZHMpIHtcblxuICBjYXJkcyA9IEtRQ2FyZC5fY2hhbmdlR3VpQ2FyZChjYXJkcyk7XG5cbiAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihpKXtpZihpLnNjb3JlcyA9PSAxKSBpLnNjb3JlcyA9IDE0O30pXG5cbiAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFNjb3JldHNIZWxwZXIoY2FyZHMpO1xuICBsZXQgbmV3Q2FyZHMgPSBjYXJkcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XG4gICAgbGV0IG51bWJlck9mQ2FyZDEgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbY2FyZDEuc2NvcmVzXTtcbiAgICBsZXQgbnVtYmVyT2ZDYXJkMiA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tjYXJkMi5zY29yZXNdO1xuXG4gICAgaWYgKG51bWJlck9mQ2FyZDIgIT0gbnVtYmVyT2ZDYXJkMSkge1xuICAgICAgcmV0dXJuIG51bWJlck9mQ2FyZDIgLSBudW1iZXJPZkNhcmQxO1xuICAgIH1cbiAgICB2YXIgc2NvcmVzMSA9IGNhcmQxLnNjb3JlcyA9PSAxPyAxNDpjYXJkMS5zY29yZXM7XG4gICAgdmFyIHNjb3JlczIgPSBjYXJkMi5zY29yZXMgPT0gMT8gMTQ6Y2FyZDIuc2NvcmVzO1xuICAgIHJldHVybiBzY29yZXMyIC0gc2NvcmVzMTtcbiAgICAvL3JldHVybiBjYXJkMi5zY29yZXMgLSBjYXJkMS5zY29yZXM7XG4gIH0pO1xuICBuZXdDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmKGkuc2NvcmVzID09IDE0KSBpLnNjb3JlcyA9IDE7fSlcbiAgcmV0dXJuIG5ld0NhcmRzLyouY29uY2F0KGNhcmQyMCkqLztcbn07XG5cbktRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMxID0gZnVuY3Rpb24oY2FyZHMpIHtcblxuICBjYXJkcyA9IEtRQ2FyZC5fY2hhbmdlR3VpQ2FyZChjYXJkcyk7XG5cbiAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihpKXtpZihpLnNjb3JlcyA9PSAxKSBpLnNjb3JlcyA9IDE0O30pXG5cbiAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFNjb3JldHNIZWxwZXIoY2FyZHMpO1xuICBsZXQgbmV3Q2FyZHMgPSBjYXJkcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XG4gICAgbGV0IG51bWJlck9mQ2FyZDEgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbY2FyZDEuc2NvcmVzXTtcbiAgICBsZXQgbnVtYmVyT2ZDYXJkMiA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tjYXJkMi5zY29yZXNdO1xuXG4gICAgaWYgKG51bWJlck9mQ2FyZDIgIT0gbnVtYmVyT2ZDYXJkMSkge1xuICAgICAgcmV0dXJuIG51bWJlck9mQ2FyZDEgLSBudW1iZXJPZkNhcmQyO1xuICAgIH1cbiAgICB2YXIgc2NvcmVzMSA9IGNhcmQxLnNjb3JlcyA9PSAxPyAxNDpjYXJkMS5zY29yZXM7XG4gICAgdmFyIHNjb3JlczIgPSBjYXJkMi5zY29yZXMgPT0gMT8gMTQ6Y2FyZDIuc2NvcmVzO1xuICAgIHJldHVybiBzY29yZXMxIC0gc2NvcmVzMjtcbiAgICAvL3JldHVybiBjYXJkMS5zY29yZXMgLSBjYXJkMi5zY29yZXM7XG4gIH0pO1xuICBuZXdDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmKGkuc2NvcmVzID09IDE0KSBpLnNjb3JlcyA9IDE7fSlcbiAgcmV0dXJuIG5ld0NhcmRzO1xufTtcblxuS1FDYXJkLl9jaGFuZ2VHdWlDYXJkID0gZnVuY3Rpb24gKGNhcmRzKSB7XG5cbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuXG4gIHZhciBjYSA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG5cbiAgdmFyIGhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2EpO1xuXG4gIHZhciBzbyA9IDA7XG5cbiAgdmFyIGNvbG9yID0gMTtcblxuICB2YXIgdHlwZSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMpICsgMTtcblxuICB0eXBlID0gdHlwZSA+PSAxMCA/IHR5cGUgOiBcIjBcIiArIHR5cGU7XG5cbiAgaWYodHlwZSA9PSBcIjA1XCIgfHwgdHlwZSA9PSBcIjA5XCIpe1xuXG4gICAgcmV0dXJuIEtRQ2FyZC5fY2hhbmdlQ2FyZFNjb3JzKGNhcmRzKTtcblxuICB9XG4gIGlmKHR5cGUgPT0gXCIwNlwiKXtcblxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XG5cbiAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xuXG4gICAgICBpZih3ID09IDEpIHcgPSAxNDtcblxuICAgICAgaWYobWF4TnVtYmVyID49IGhlbHBlci5tYXhOdW1iZXIoKSAmJiBzbyA8IHBhcnNlSW50KHcpICYmIHBhcnNlSW50KHcpICE9IDIwKXtzbyA9IHBhcnNlSW50KHcpO31cblxuICAgIH1cbiAgICBjb2xvciA9IGNhWzBdLmNvbG9yO1xuXG4gICAgc28gPSBzbyA9PSAxND8gMTogc287XG5cbiAgICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihuKXtcblxuICAgICAgbi5zY29yZXMgPSBzbztcblxuICAgICAgbi5jb2xvclNjb3JlcyA9IGNvbG9yO1xuXG4gICAgfSk7XG5cbiAgfVxuICBpZih0eXBlID09IFwiMDdcIiB8fCB0eXBlID09IFwiMjJcIiB8fCB0eXBlID09IFwiMDhcIiB8fCB0eXBlID09IFwiMTBcIlxuICAgICAgfHwgdHlwZSA9PSBcIjA0XCIgfHwgdHlwZSA9PSBcIjExXCIgfHwgdHlwZSA9PSBcIjAyXCIpe1xuXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcblxuICAgICAgdmFyIG1heE51bWJlciA9IGhlbHBlci5wb2ludE51bWJlcnNbd107XG5cbiAgICAgIGlmKHcgPT0gMSkgdyA9IDE0O1xuXG4gICAgICBpZihtYXhOdW1iZXIgPj0gaGVscGVyLm1heE51bWJlcigpICYmIHNvIDwgcGFyc2VJbnQodykgJiYgcGFyc2VJbnQodykgIT0gMjApe3NvID0gcGFyc2VJbnQodyk7fVxuXG4gICAgfVxuXG4gICAgc28gPSBzbyA9PSAxNCA/IDE6IHNvXG5cbiAgICBjYS5mb3JFYWNoKGZ1bmN0aW9uKG4pe2lmKHNvID09IG4ucG9pbnQgJiYgY29sb3IgPCBuLmNvbG9yKSBjb2xvciA9IG4uY29sb3I7fSk7XG5cbiAgICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihuKXtcblxuICAgICAgbi5zY29yZXMgPSBzbztcblxuICAgICAgbi5jb2xvclNjb3JlcyA9IGNvbG9yO1xuXG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICB9XG5cbiAgcmV0dXJuIGNhcmQyMC5jb25jYXQoY2EpO1xufTtcblxuS1FDYXJkLl9zZXRHdWlDYXJkID0gZnVuY3Rpb24gKGluZGV4LCBzdGFydCwgZW5kLCB0eXBlLCBjYXJkcyAsbm9kZXMsIGNhcmRTcHJpdGVBdGxhcykge1xuICAvL2NjLmxvZyhjYXJkU3ByaXRlQXRsYXMpXG4gIC8vY2MubG9nKCctLS0tLTU5MycpXG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzW2luZGV4XSk7XG5cbiAgdmFyIGNhID0gY2FyZHNbaW5kZXhdLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG5cbiAgdmFyIGhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2EpO1xuXG4gIHZhciBzbyA9IDA7XG5cbiAgdmFyIGNvbG9yID0gMTtcblxuICB2YXIgbm9kZSA9IG5vZGVzLnNsaWNlKHN0YXJ0LCBlbmQpLmZpbHRlcihmdW5jdGlvbihuKXtcblxuICAgIGlmKG4uY2hpbGRyZW5Db3VudCA+IDAgJiYgbi5jaGlsZHJlblswXS5jYXJkTmFtZSl7XG5cbiAgICAgIGlmKHBhcnNlSW50KG4uY2hpbGRyZW5bMF0uY2FyZE5hbWUuc3BsaXQoXCJfXCIpWzFdKSA9PSAyMCkgcmV0dXJuIHRydWU7XG5cbiAgICB9XG4gIH0pO1xuXG4gIGlmKHR5cGUgPT0gXCIwNVwiIHx8IHR5cGUgPT0gXCIwOVwiKXtcblxuICAgIGNhcmRzW2luZGV4XSA9IEtRQ2FyZC5fY2hhbmdlQ2FyZFNjb3JzKGNhcmRzW2luZGV4XSk7XG5cbiAgICBzbyA9IGNhcmRzW2luZGV4XS5maWx0ZXIoZnVuY3Rpb24oaSl7aWYoaS5wb2ludCA9PSAyMClyZXR1cm4gdHJ1ZTt9KS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkuc2NvcmVzID09IDE0PyAxOmkuc2NvcmVzO30pO1xuXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgdmFyIGNhcmROYW1lID0gY2FbMF0uY29sb3IgKyBcIl9cIiArIHNvLnNwbGljZSgwLDEpWzBdO1xuXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG5cbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuXG4gIH1cbiAgaWYodHlwZSA9PSBcIjA2XCIpe1xuXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcblxuICAgICAgdmFyIG1heE51bWJlciA9IGhlbHBlci5wb2ludE51bWJlcnNbd107XG5cbiAgICAgIGlmKHcgPT0gMSkgdyA9IDE0O1xuXG4gICAgICBpZihtYXhOdW1iZXIgPj0gaGVscGVyLm1heE51bWJlcigpICYmIHNvIDwgcGFyc2VJbnQodykgJiYgcGFyc2VJbnQodykgIT0gMjApe3NvID0gcGFyc2VJbnQodyk7fVxuXG4gICAgfVxuXG4gICAgY29sb3IgPSBjYVswXS5jb2xvcjtcblxuICAgIHNvID0gc28gPT0gMTQ/IDE6IHNvO1xuXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgdmFyIGNhcmROYW1lID0gY29sb3IgKyBcIl9cIiArIHNvO1xuXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG5cbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuICB9XG4gIGlmKHR5cGUgPT0gXCIwN1wiIHx8IHR5cGUgPT0gXCIyMlwiIHx8IHR5cGUgPT0gXCIwOFwiIHx8IHR5cGUgPT0gXCIxMFwiXG4gICAgICB8fCB0eXBlID09IFwiMDRcIiB8fCB0eXBlID09IFwiMTFcIiB8fCB0eXBlID09IFwiMDJcIil7XG5cbiAgICBmb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xuXG4gICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcblxuICAgICAgaWYodyA9PSAxKSB3ID0gMTQ7XG5cbiAgICAgIGlmKG1heE51bWJlciA+PSBoZWxwZXIubWF4TnVtYmVyKCkgJiYgc28gPCBwYXJzZUludCh3KSAmJiBwYXJzZUludCh3KSAhPSAyMCl7c28gPSBwYXJzZUludCh3KTt9XG5cbiAgICB9XG5cbiAgICBzbyA9IHNvID09IDE0ID8gMTogc29cblxuICAgIGNhLmZvckVhY2goZnVuY3Rpb24obil7aWYoc28gPT0gbi5wb2ludCAmJiBjb2xvciA8IG4uY29sb3IpIGNvbG9yID0gbi5jb2xvcjt9KTtcblxuICAgIG5vZGUuZm9yRWFjaChmdW5jdGlvbihuKXtcblxuICAgICAgdmFyIGJ0blNwcml0ZSA9IG4uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgIHZhciBjYXJkTmFtZSA9IGNvbG9yICsgXCJfXCIgKyBzbztcblxuICAgICAgdmFyIHBhdGggPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xuXG4gICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUoY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxidG5TcHJpdGUpO1xuXG4gICAgfS5iaW5kKHRoaXMpKTtcblxuXG4gIH1cblxufTtcblxuS1FDYXJkLl9zZXRHdWlDYXJkcyA9IGZ1bmN0aW9uICh0eXBlLCBjYXJkcyAsbm9kZXMsIGNhcmRTcHJpdGVBdGxhcykge1xuICAvL2NjLmxvZyhjYXJkU3ByaXRlQXRsYXMpXG4gIC8vY2MubG9nKCctLS0tLTU5MycpXG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcblxuICB2YXIgY2EgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuXG4gIHZhciBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhKTtcblxuICB2YXIgc28gPSAwO1xuXG4gIHZhciBjb2xvciA9IDE7XG5cbiAgdmFyIG5vZGUgPSBub2Rlcy5zbGljZSgpLmZpbHRlcihmdW5jdGlvbihuKXtcblxuICAgIGlmKG4uY2hpbGRyZW5Db3VudCA+IDAgJiYgbi5jaGlsZHJlblswXS5jYXJkTmFtZSl7XG5cbiAgICAgIGlmKHBhcnNlSW50KG4uY2hpbGRyZW5bMF0uY2FyZE5hbWUuc3BsaXQoXCJfXCIpWzFdKSA9PSAyMCkgcmV0dXJuIHRydWU7XG5cbiAgICB9XG4gIH0pO1xuXG4gIGlmKHR5cGUgPT0gXCIwNVwiIHx8IHR5cGUgPT0gXCIwOVwiKXtcblxuICAgIGNhcmRzID0gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FyZHMpO1xuXG4gICAgc28gPSBjYXJkcy5maWx0ZXIoZnVuY3Rpb24oaSl7aWYoaS5wb2ludCA9PSAyMClyZXR1cm4gdHJ1ZTt9KS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkuc2NvcmVzID09IDE0PyAxOmkuc2NvcmVzO30pO1xuXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgdmFyIGNhcmROYW1lID0gY2FbMF0uY29sb3IgKyBcIl9cIiArIHNvLnNwbGljZSgwLDEpWzBdO1xuXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG5cbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuXG4gIH1cbiAgaWYodHlwZSA9PSBcIjA2XCIpe1xuXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcblxuICAgICAgdmFyIG1heE51bWJlciA9IGhlbHBlci5wb2ludE51bWJlcnNbd107XG5cbiAgICAgIGlmKHcgPT0gMSkgdyA9IDE0O1xuXG4gICAgICBpZihtYXhOdW1iZXIgPj0gaGVscGVyLm1heE51bWJlcigpICYmIHNvIDwgcGFyc2VJbnQodykgJiYgcGFyc2VJbnQodykgIT0gMjApe3NvID0gcGFyc2VJbnQodyk7fVxuXG4gICAgfVxuXG4gICAgY29sb3IgPSBjYVswXS5jb2xvcjtcblxuICAgIHNvID0gc28gPT0gMTQ/IDE6IHNvO1xuXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgdmFyIGNhcmROYW1lID0gY29sb3IgKyBcIl9cIiArIHNvO1xuXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG5cbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuICB9XG4gIGlmKHR5cGUgPT0gXCIwN1wiIHx8IHR5cGUgPT0gXCIyMlwiIHx8IHR5cGUgPT0gXCIwOFwiIHx8IHR5cGUgPT0gXCIxMFwiXG4gICAgICB8fCB0eXBlID09IFwiMDRcIiB8fCB0eXBlID09IFwiMTFcIiB8fCB0eXBlID09IFwiMDJcIil7XG5cbiAgICBmb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xuXG4gICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcblxuICAgICAgaWYodyA9PSAxKSB3ID0gMTQ7XG5cbiAgICAgIGlmKG1heE51bWJlciA+PSBoZWxwZXIubWF4TnVtYmVyKCkgJiYgc28gPCBwYXJzZUludCh3KSAmJiBwYXJzZUludCh3KSAhPSAyMCl7c28gPSBwYXJzZUludCh3KTt9XG5cbiAgICB9XG5cbiAgICBzbyA9IHNvID09IDE0ID8gMTogc29cblxuICAgIGNhLmZvckVhY2goZnVuY3Rpb24obil7aWYoc28gPT0gbi5wb2ludCAmJiBjb2xvciA8IG4uY29sb3IpIGNvbG9yID0gbi5jb2xvcjt9KTtcblxuICAgIG5vZGUuZm9yRWFjaChmdW5jdGlvbihuKXtcblxuICAgICAgdmFyIGJ0blNwcml0ZSA9IG4uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgIHZhciBjYXJkTmFtZSA9IGNvbG9yICsgXCJfXCIgKyBzbztcblxuICAgICAgdmFyIHBhdGggPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xuXG4gICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUoY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxidG5TcHJpdGUpO1xuXG4gICAgfS5iaW5kKHRoaXMpKTtcblxuXG4gIH1cblxufTtcblxuS1FDYXJkLl9sb2FkQ2FyZEZyYW1lID0gZnVuY3Rpb24oU3ByaXRlRnJhbWUsIHBhdGgsIFNwcml0ZXNOb2RlLCB3LCBoKSB7XG4gIC8vY2MubG9nKFNwcml0ZUZyYW1lKVxuICAvL2NjLmxvZygnLS0tNzY5JylcbiAgdmFyIFNwcml0ZSA9IFNwcml0ZUZyYW1lLmdldFNwcml0ZUZyYW1lKCBwYXRoICk7XG5cbiAgU3ByaXRlc05vZGUuc3ByaXRlRnJhbWUgPSBTcHJpdGU7XG5cbiAgaWYodykgU3ByaXRlc05vZGUubm9kZS53aWR0aCA9IHc7XG5cbiAgaWYoaCkgU3ByaXRlc05vZGUubm9kZS5oZWlnaHQgPSBoO1xufTtcblxuXG5LUUNhcmQudGVzdFNjb3JlID0gZnVuY3Rpb24oKSB7XG5cbn07IiwiLy8g54mM54K55pWw5biu5Yqp57G7XHJcbi8vIOeUqOadpeiuoeeul+S4gOS4queJjOaVsOe7hOWGheeahOebuOWQjOeCueaVsOeahOeJjOeahOW8oOaVsFxyXG52YXIgS1FDYXJkU2NvcmV0c0hlbHBlciA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdGhpcy5wb2ludE51bWJlcnMgPSB7fTtcclxuICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICBsZXQgcG9pbnQgPSBjYXJkLnNjb3JlcztcclxuICAgICAgICB2YXIgbnVtYmVyID0gdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdIHx8IDA7XHJcbiAgICAgICAgdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdID0gbnVtYmVyICsgMTtcclxuICAgIH0uYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vLyDnm7jlkIzngrnmlbDniYznmoTmnIDlpKfmlbDph49cclxuS1FDYXJkU2NvcmV0c0hlbHBlci5wcm90b3R5cGUubWF4TnVtYmVyID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciByZXN1bHQgPSAwO1xyXG4gIGZvciAobGV0IHByb3AgaW4gdGhpcy5wb2ludE51bWJlcnMpIHtcclxuICAgIGxldCBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twcm9wXTtcclxuICAgICAgLy9pZihudW1iZXIgPCAyMCl7XHJcbiAgICAgICAgICByZXN1bHQgPSBNYXRoLm1heChudW1iZXIsIHJlc3VsdCk7XHJcbiAgICAgIC8vfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufTtcclxuXHJcblxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBLUUNhcmRTY29yZXRzSGVscGVyO1xyXG5cclxuLyp2YXIgY2FyZHMgPSBbXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEwfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTJ9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjE0fVxyXG5dO1xyXG52YXIgdGVzdCA9IG5ldyBLUUNhcmRQb2ludHNTYW1lKGNhcmRzKTtcclxuY29uc29sZS5sb2codGVzdCk7Ki9cclxuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jb25zdCBLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uJyk7XG5cbi8vIOeJjOiHquWKqOmAieaLqeeahOaJqeWxlVxuXG4vKipcbiAqIOiHquWKqOmAieaLqeeJjO+8jOeUseWkp+WIsOWwj1xuICpcbiAqIEBwYXJhbSAge1tLUUNhcmRdfSBvcmlnaW5DYXJkcyAg6KKr6YCJ5oup55qE5Y6f5aeL54mM5pWw57uEXG4gKlxuICogQHJldHVybiB7W0tRQ2FyZF19XG4gKi9cbktRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMgPSBmdW5jdGlvbihvcmlnaW5DYXJkcywgbWF4TGVuZ3RoKSB7XG4gICAgaWYgKG9yaWdpbkNhcmRzLmxlbmd0aCA8PSBtYXhMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG9yaWdpbkNhcmRzO1xuICAgIH1cbiAgICBvcmlnaW5DYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe1xuICAgICAgICBpZihjYXJkLnNjb3JlcyA9PSAxKXtcbiAgICAgICAgICAgIGNhcmQuc2NvcmVzID0gMTQ7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBsZXQgY2FyZHMgPSBvcmlnaW5DYXJkcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24oYSxiKXtcbiAgICAgICAgcmV0dXJuIGEuc2NvcmVzIC0gYi5zY29yZXM7XG4gICAgfSk7XG5cbiAgICBsZXQgZmluZEZ1bmNzID0gW1xuICAgICAgICBLUUNhcmQuZmluZFd1VG9uZyxcbiAgICAgICAgS1FDYXJkLmZpbmRUb25nSHVhU2h1bixcbiAgICAgICAgS1FDYXJkLmZpbmRUaWVaaGksXG4gICAgICAgIEtRQ2FyZC5maW5kSHVMdSxcbiAgICAgICAgS1FDYXJkLmZpbmRUb25nSHVhLFxuICAgICAgICBLUUNhcmQuZmluZFNodW5aaSxcbiAgICAgICAgS1FDYXJkLmZpbmRTYW5UaWFvLFxuICAgICAgICBLUUNhcmQuZmluZExpYUR1aSxcbiAgICAgICAgS1FDYXJkLmZpbmREdWlaaVxuICAgIF07XG5cbiAgICBsZXQgaW5kZXhBcnJheXMgPSBudWxsO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmluZEZ1bmNzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGxldCBmdW5jID0gZmluZEZ1bmNzW2ldO1xuICAgICAgICBpbmRleEFycmF5cyA9IChmdW5jLmJpbmQoS1FDYXJkKSkoY2FyZHMpO1xuICAgICAgICBpZiAoaW5kZXhBcnJheXMgJiYgaW5kZXhBcnJheXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgaW5kZXhzID0gW107XG4gICAgaWYgKGluZGV4QXJyYXlzICYmIGluZGV4QXJyYXlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8g5om+5Ye65ZCM57G75Z6L55qE54mM6YeM55qE5YiG5pWw5pyA5aSn55qE54mMXG4gICAgICAgIHZhciBtYXhTY29yZSA9IDA7XG4gICAgICAgIGluZGV4QXJyYXlzLmZvckVhY2godGVtcEluZGV4cyA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ZW1wQ2FyZHMgPSB0ZW1wSW5kZXhzLm1hcChpbmRleCA9PiBjYXJkc1tpbmRleF0pO1xuICAgICAgICBjb25zdCBzY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHModGVtcENhcmRzKTtcbiAgICAgICAgaWYgKHNjb3JlID4gbWF4U2NvcmUpIHtcbiAgICAgICAgICAgIG1heFNjb3JlID0gc2NvcmU7XG4gICAgICAgICAgICBpbmRleHMgPSB0ZW1wSW5kZXhzO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgfVxuXG4gICAgbGV0IHRhcmdldENhcmRzID0gaW5kZXhzLm1hcChmdW5jdGlvbihpbmRleCkge1xuICAgICAgICByZXR1cm4gY2FyZHNbaW5kZXhdO1xuICAgIH0pO1xuXG4gICAgLyppZiAodGFyZ2V0Q2FyZHMubGVuZ3RoIDwgbWF4TGVuZ3RoKSB7XG4gICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXModGFyZ2V0Q2FyZHMpO1xuICAgICB3aGlsZSh0YXJnZXRDYXJkcy5sZW5ndGggPCBtYXhMZW5ndGgpIHtcbiAgICAgdGFyZ2V0Q2FyZHMucHVzaChjYXJkcy5wb3AoKSk7XG4gICAgIH1cbiAgICAgfSBlbHNlICovaWYgKHRhcmdldENhcmRzLmxlbmd0aCA+IG1heExlbmd0aCkge1xuICAgICAgICB0YXJnZXRDYXJkcyA9IHRhcmdldENhcmRzLnNsaWNlKDAsIG1heExlbmd0aCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRhcmdldENhcmRzIHx8IFtdO1xufTtcblxuS1FDYXJkLnRlc3RBdXRvU2VsZWN0ID0gZnVuY3Rpb24oY2FyZHMpIHtcblxufTsiLCJjb25zdCBLUUNhcmRDb2xvcnNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRDb2xvcnNIZWxwZXInKTtcbmNvbnN0IEtRQ2FyZFBvaW50c0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFBvaW50c0hlbHBlcicpO1xuY29uc3QgTnVtYmVyRXh0ZW5zaW9uID0gcmVxdWlyZSgnTnVtYmVyRXh0ZW5zaW9uJyk7XG5jb25zdCBHZXRDYXJkUG9pbnRzU2FtZUNvdW50ID0gcmVxdWlyZSgnR2V0Q2FyZFBvaW50c1NhbWVDb3VudCcpO1xuXG5jYyA9IGNjIHx8IHt9O1xuY2MuYXNzZXJ0ID0gY2MuYXNzZXJ0IHx8IGNvbnNvbGUuYXNzZXJ0IHx8IGZ1bmN0aW9uICgpIHt9O1xuY2MubG9nID0gY2MubG9nIHx8IGNvbnNvbGUubG9nIHx8IGZ1bmN0aW9uICgpIHt9O1xuY2MuZXJyb3IgPSBjYy5lcnJvciB8fCBjb25zb2xlLmVycm9yIHx8IGZ1bmN0aW9uICgpIHt9O1xuXG4vLyDniYwgTW9kZWwg57G777yM5bCB6KOF5LqG6Iqx6Imy5ZKM54K55pWwXG4vLyDkvb/nlKjvvJpcbi8vIG5ldyBLUUNhcmQoMjIpO1xudmFyIEtRQ2FyZCA9IGZ1bmN0aW9uIChwb2ludCwgY29sb3IgLGluZGV4KSB7XG4gICAgdGhpcy5jb2xvciA9IG51bGw7XG4gICAgdGhpcy5wb2ludCA9IG51bGw7XG4gICAgdGhpcy5zaW5kZXggPSBpbmRleDtcbiAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQgPSBmdW5jdGlvbiAoY29sb3IsIHBvaW50KSB7XG4gICAgICAgIGlmIChjb2xvciA9PSAncycpIHsgY29sb3IgPSA0O31cbiAgICAgICAgaWYgKGNvbG9yID09ICdoJykgeyBjb2xvciA9IDM7fVxuICAgICAgICBpZiAoY29sb3IgPT0gJ2MnKSB7IGNvbG9yID0gMjt9XG4gICAgICAgIGlmIChjb2xvciA9PSAnZCcpIHsgY29sb3IgPSAxO31cblxuICAgICAgICB0aGlzLnBvaW50ID0gTnVtYmVyKHBvaW50KTtcbiAgICAgICAgdGhpcy5zY29yZXMgPSBOdW1iZXIocG9pbnQpO1xuICAgICAgICB0aGlzLmNvbG9yID0gTnVtYmVyKGNvbG9yKTtcbiAgICAgICAgdGhpcy5jb2xvclNjb3JlcyA9IE51bWJlcihjb2xvcik7XG5cbiAgICAgICAgY2MuYXNzZXJ0KHRoaXMucG9pbnQgPiAwKTtcbiAgICAgICAgY2MuYXNzZXJ0KHRoaXMuY29sb3IgPiAwKTtcbiAgICB9O1xuXG4gICAgdGhpcy5faW5pdFdpdGhOdW1iZXIgPSBmdW5jdGlvbiAobnVtYmVyKSB7XG4gICAgICAgIHRoaXMucG9pbnQgPSBNYXRoLmZsb29yKG51bWJlciAvIDEwKTtcbiAgICAgICAgdGhpcy5jb2xvciA9IG51bWJlciAlIDEwO1xuICAgICAgICBjYy5hc3NlcnQodGhpcy5wb2ludCA+IDApO1xuICAgICAgICBjYy5hc3NlcnQodGhpcy5jb2xvciA+IDApO1xuICAgIH07XG5cbiAgICB0aGlzLl9pbml0V2l0aE9iamVjdCA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgICAgaWYgKG9iamVjdC5wb2ludCkge1xuICAgICAgICAgICAgdGhpcy5faW5pdFdpdGhDb2xvckFuZFBvaW50KG9iamVjdC5jb2xvciwgb2JqZWN0LnBvaW50KTtcbiAgICAgICAgfSBlbHNlIGlmIChvYmplY3Quc3VpdCkge1xuICAgICAgICAgICAgdGhpcy5faW5pdFdpdGhDb2xvckFuZFBvaW50KG9iamVjdC5zdWl0LCBvYmplY3QubnVtYmVyKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jYXJkTmFtZSgpO1xuICAgIH07XG5cbiAgICB0aGlzLmNhcmROYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb2xvciArIFwiX1wiICsgdGhpcy5wb2ludDtcbiAgICB9O1xuXG4gICAgdGhpcy5zb3J0ID0gZnVuY3Rpb24gKG90aGVyQ2FyZCwgYXNjID0gZmFsc2UsIEFpc01heCA9IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5zb3J0KHRoaXMsIG90aGVyQ2FyZCwgYXNjLCBBaXNNYXgpO1xuICAgIH07XG5cbiAgICB0aGlzLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXJDYXJkKSB7XG4gICAgICAgIGlmICghb3RoZXJDYXJkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICh0aGlzLnBvaW50ID09IG90aGVyQ2FyZC5wb2ludCkgJiYgKHRoaXMuY29sb3IgPT0gb3RoZXJDYXJkLmNvbG9yKVxuICAgICAgICAgICAgJiYgKHRoaXMuc2luZGV4ID09IG90aGVyQ2FyZC5zaW5kZXgpO1xuICAgIH07XG5cbiAgICBpZiAocG9pbnQgJiYgY29sb3IpIHtcbiAgICAgICAgdGhpcy5faW5pdFdpdGhDb2xvckFuZFBvaW50KGNvbG9yLCBwb2ludCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgbnVtYmVyID0gTnVtYmVyKHBvaW50KTtcbiAgICBpZiAoIU51bWJlci5pc05hTihudW1iZXIpKSB7XG4gICAgICAgIHRoaXMuX2luaXRXaXRoTnVtYmVyKG51bWJlcik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mKHBvaW50KSA9PSAnc3RyaW5nJykge1xuICAgICAgICAvLyDop6PmnpAgeHh4eGRfZCDlvaLlvI9cbiAgICAgICAgbGV0IGZvdW5kID0gcG9pbnQubWF0Y2goLyhcXC4pKlxcZF9cXGQrLyk7XG4gICAgICAgIGlmICgoZm91bmQgaW5zdGFuY2VvZiBBcnJheSkgJiYgZm91bmQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGZvdW5kWzBdO1xuICAgICAgICAgICAgbGV0IG51bWJlcnMgPSByZXN1bHQuc3BsaXQoJ18nKTtcblxuICAgICAgICAgICAgbGV0IGNvbG9yID0gTnVtYmVyKG51bWJlcnNbMF0pO1xuICAgICAgICAgICAgbGV0IHBvaW50ID0gTnVtYmVyKG51bWJlcnNbMV0pO1xuXG4gICAgICAgICAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQoY29sb3IsIHBvaW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mKHBvaW50KSA9PSAnb2JqZWN0Jykge1xuICAgICAgICB0aGlzLl9pbml0V2l0aE9iamVjdChwb2ludCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYy5lcnJvcihcIuWIneWni+WMlumUmeivr++8mlwiICsgcG9pbnQgKyBcIiBcIiArIGNvbG9yKTtcbn07XG5cbi8vIOi9rOaNouaIkOacjeWKoeWZqOeahOeJjCBtb2RlbFxuS1FDYXJkLnByb3RvdHlwZS50b1NlcnZlckNhcmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgJ3N1aXQnOiB0aGlzLmNvbG9yLFxuICAgICAgICAnbnVtYmVyJzogdGhpcy5wb2ludCxcbiAgICB9O1xufTtcblxuS1FDYXJkLkNPTE9SX1NQQURFICAgPSA0O1xuS1FDYXJkLkNPTE9SX0hFQVJUICAgPSAzO1xuS1FDYXJkLkNPTE9SX0NMVUIgICAgPSAyO1xuS1FDYXJkLkNPTE9SX0RJQU1PTkQgPSAxO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEtRQ2FyZDtcblxuS1FDYXJkLmNhcmRzRnJvbUFycmF5ID0gZnVuY3Rpb24gKGNhcmROYW1lcykge1xuICAgIHJldHVybiBjYXJkTmFtZXMubWFwKGZ1bmN0aW9uIChjYXJkTmFtZSxpbmRleCkge1xuICAgICAgICByZXR1cm4gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICB9KTtcbn07XG5cbi8vIOWwhuWkmuW8oOeJjOi9rOaNouaIkOacjeWKoeWZqOeahOW9ouW8j1xuS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgcmV0dXJuIGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC50b1NlcnZlckNhcmQoKTtcbiAgICB9KTtcbn07XG5cbktRQ2FyZC5UWVBFID0ge1xuICAgIFd1TG9uZzogMCxcbiAgICBEdWlaaTogMSxcbiAgICBMaWFuZ0R1aTogMixcbiAgICBTYW5UaWFvOiAzLFxuICAgIFNodW5aaTogNCxcbiAgICBUb25nSHVhOiA1LFxuICAgIEh1THU6IDYsXG4gICAgVGllWmhpOiA3LFxuICAgIFRvbmdIdWFTaHVuOiA4LFxuICAgIC8qIyMjIyMqL1xuICAgIFd1VG9uZzo5LFxuICAgIC8qIyMjIyMqL1xuICAgIFNhblRhb0h1YTogMTAsICAvLyDnibnmrorniYxcbiAgICBTYW5TaHVuWmk6IDExLFxuICAgIExpdUR1aUJhbjogMTIsXG5cbiAgICBXdUR1aVNhblRpYW86MTMsXG4gICAgU2lUYW9TYW5UaWFvOiAxNCxcblxuICAgIENvdVlpU2U6IDE1LFxuICAgIFNhbkZlblRpYW5YaWE6IDE2LFxuICAgIFNhblRvbmdIdWFTaHVuOiAxNyxcbiAgICBZaVRpYW9Mb25nOiAxOCxcbiAgICBRaW5nTG9uZzogMTksXG59O1xuXG4vLyDniYznsbvlnovlkI1cbktRQ2FyZC5jYXJkc1R5cGVOYW1lID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IG5hbWVzID0gWyfkuYzpvpknLCAn5a+55a2QJywgJ+S4pOWvuScsICfkuInmnaEnLCAn6aG65a2QJywgJ+WQjOiKsScsICfokavoiqYnLCAn6ZOB5pSvJywgJ+WQjOiKsemhuicsICfkupTlkIwnLFxuICAgICAgICAn5LiJ5ZCM6IqxJywgJ+S4iemhuuWtkCcsJ+WFreWvueWNiicsICfkupTlr7nkuInmnaEnLCAn5Zub5aWX5LiJ5p2hJyxcbiAgICAgICAgJ+WHkeS4gOiJsicsJ+S4ieWIhuWkqeS4iycsICfkuInlkIzoirHpobonLCAn5LiA5p2h6b6ZJywgJ+a4hem+mSddO1xuICAgIGxldCB0eXBlID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkcyk7XG4gICAgcmV0dXJuIG5hbWVzW3R5cGVdO1xufTtcblxuLy8g5om+5Ye654mM55qE57G75Z6LXG5LUUNhcmQuY2FyZHNUeXBlID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKEtRQ2FyZC5pc1FpbmdMb25nKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuUWluZ0xvbmc7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1lpVGlhb0xvbmcoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5ZaVRpYW9Mb25nO1xuICAgIH1cblxuICAgIC8vaWYgKEtRQ2FyZC5pc1NhblRvbmdIdWFTaHVuKGNhcmRzKSkge1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5Ub25nSHVhU2h1bjtcbiAgICAvL31cbiAgICAvL1xuICAgIC8vaWYgKEtRQ2FyZC5pc1NhbkZlblRpYW5YaWEoY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNhbkZlblRpYW5YaWE7XG4gICAgLy99XG5cbiAgICBpZiAoS1FDYXJkLmlzTGl1RHVpQmFuKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuTGl1RHVpQmFuO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuaXNTYW5Ub25nSHVhKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuVGFvSHVhO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuaXNTYW5TaHVuWmkoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5TaHVuWmk7XG4gICAgfVxuXG5cbiAgICAvL2lmIChLUUNhcmQuaXNDb3VZaVNlKGNhcmRzKSkge1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5Db3VZaVNlO1xuICAgIC8vfVxuICAgIC8vXG4gICAgLy9pZiAoS1FDYXJkLmlzV3VEdWlTYW5UaWFvKGNhcmRzKSkge1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5XdUR1aVNhblRpYW87XG4gICAgLy99XG4gICAgLy9cbiAgICAvL2lmIChLUUNhcmQuaXNTaVRhb1NhblRpYW8oY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNpVGFvU2FuVGlhbztcbiAgICAvL31cblxuICAgIC8qIyMjIyMqL1xuICAgIGlmIChLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcywgNSkpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1VG9uZztcbiAgICB9XG5cbiAgICAvL2lmIChLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcykpIHtcbiAgICAvLyAgICByZXR1cm4gS1FDYXJkLlRZUEUuV3VUb25nO1xuICAgIC8vfVxuICAgIC8vXG4gICAgLy9pZiAoS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1VG9uZztcbiAgICAvL31cbiAgICAvKiMjIyMjKi9cblxuICAgIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRzLCA1KSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuVG9uZ0h1YVNodW47XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuVGllWmhpO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpbkh1THUoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5IdUx1O1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWEoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5Ub25nSHVhO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpblNodW5aaShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNodW5aaTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5TYW5UaWFvKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuVGlhbztcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5MaWFuZ0R1aTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5EdWlaaShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLkR1aVppO1xuICAgIH1cblxuICAgIHJldHVybiBLUUNhcmQuVFlQRS5XdUxvbmc7XG59O1xuXG4vLyDliKTmlq3mmK/lkKbmmK/lkIzoirFcbktRQ2FyZC5pc1RvbmdIdWEgPSBmdW5jdGlvbihjYXJkcywgbWluTGVuZ3RoID0gMykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBjb2xvcnMgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgcmV0dXJuIGNhcmQuY29sb3I7XG4gICAgfSk7XG5cbiAgICBsZXQgY29sb3IgPSBjb2xvcnNbMF07XG4gICAgZm9yIChsZXQgaW5kZXggaW4gY29sb3JzKSB7XG4gICAgICAgIGxldCBlID0gY29sb3JzW2luZGV4XTtcbiAgICAgICAgaWYgKGUgIT0gY29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbi8vIOaYr+WQpuWMheWQq+WQjOiKsVxuS1FDYXJkLmNvbnRhaW5Ub25nSHVhID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vaWYgKEtRQ2FyZC5maW5kVG9uZ0h1YShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIC8vcmV0dXJuIGZhbHNlO1xuICAgIGNhcmRzID0gQXJyYXkuZnJvbShjYXJkcyk7XG4gICAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuXG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgICBtaW5MZW5ndGggPSBtaW5MZW5ndGgtY2FyZDIwLmxlbmd0aDtcblxuICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbWluTGVuZ3RoKSA8PSBjYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgICAgbGV0IHN1YkNhcmRzID0gY2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbWluTGVuZ3RoKTtcbiAgICAgICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWEoc3ViQ2FyZHMsIG1pbkxlbmd0aCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy9yZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhMjAoY2FyZHMpO1xufTtcbktRQ2FyZC5jb250YWluVG9uZ0h1YTIwID0gZnVuY3Rpb24gKGNhcmQpIHtcbiAgICBpZiAoY2FyZC5sZW5ndGggPCA1KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZCk7XG4gICAgdmFyIGNhcmRzID0gY2FyZC5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAgIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcblxuICAgIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gICAgICAgIHZhciBudW0gPSA1IC0gajtcbiAgICAgICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IGNhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuICAgICAgICAgICAgdmFyIHN1YkNhcmRzID0gY2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcbiAgICAgICAgICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBudW0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcbi8vIOWIpOaWreaYr+WQpuaYr+mhuuWtkFxuS1FDYXJkLmlzU2h1blppID0gZnVuY3Rpb24oY2FyZHMsIG1pbkxlbmd0aCA9IDMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLl9pc1NodW5aaUFLUShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgbGV0IHBvaW50cyA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC5wb2ludDtcbiAgICB9KS5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgcmV0dXJuIG4xIC0gbjI7XG4gICAgfSk7XG5cbiAgICB2YXIgcG9pbnQgPSBwb2ludHNbMF07XG4gICAgZm9yICh2YXIgaW5kZXggaW4gcG9pbnRzKSB7XG4gICAgICAgIHZhciBlID0gcG9pbnRzW2luZGV4XTtcbiAgICAgICAgaWYgKGUgIT0gcG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHBvaW50ID0gcG9pbnQgKyAxO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufTtcblxuLy8g5Yik5pat5piv5ZCm5pivIEEgSyBRIEogMTAg6L+Z5Liq6aG65a2QXG5LUUNhcmQuX2lzU2h1blppQUtRID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IGNhcmRzLmxlbmd0aDtcbiAgICBpZiAobGVuZ3RoLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBwb2ludDFzID0gWzFdO1xuICAgIGxldCBwb2ludDE0cyA9IFsxNF07XG4gICAgbGV0IHBvaW50SyA9IDEzO1xuXG4gICAgTnVtYmVyKGxlbmd0aCAtIDEpLmtxX3RpbWVzKGZ1bmN0aW9uKHRpbWVzKSB7XG4gICAgICAgIHBvaW50MXMucHVzaChwb2ludEsgLSB0aW1lcyk7XG4gICAgICAgIHBvaW50MTRzLnB1c2gocG9pbnRLIC0gdGltZXMpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIEtRQ2FyZC5faXNDYXJkc0NvbnRhaW5Qb2ludHMoY2FyZHMsIHBvaW50MXMpIHx8IEtRQ2FyZC5faXNDYXJkc0NvbnRhaW5Qb2ludHMoY2FyZHMsIHBvaW50MTRzKTtcbn07XG5cbi8vIGNhcmRzIOS4reaYr+WQpuWMheWQqyBwb2ludHMg6L+Z5Lqb54K55pWwXG5cbktRQ2FyZC5faXNDYXJkc0NvbnRhaW5Qb2ludHMgPSBmdW5jdGlvbihjYXJkcywgcG9pbnRzKSB7XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHBvaW50cy5sZW5ndGg7ICsraW5kZXgpIHtcbiAgICAgICAgbGV0IHBvaW50ID0gcG9pbnRzW2luZGV4XTtcbiAgICAgICAgbGV0IHBvaW50Q2FyZEluZGV4ID0gY2FyZHMuZmluZEluZGV4KGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgICAgIHJldHVybiBjYXJkLnBvaW50ID09IHBvaW50O1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocG9pbnRDYXJkSW5kZXggPCAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5LUUNhcmQuY29udGFpbjIwID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYoY2FyZHMubGVuZ3RoIDw9IDApe1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5wb2ludCkgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICBjYXJkcyA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkcyk7XG4gICAgfVxuICAgIHZhciBuZXdDYXJkID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGNhcmQpey8v6YeN5paw6LWL5YC8Y2FyZHNcbiAgICAgICAgaWYoY2FyZC5wb2ludCA+PSAyMCl7XG4gICAgICAgICAgICByZXR1cm4gY2FyZDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBuZXdDYXJkIHx8IFtdO1xufTtcbi8vIOaYr+WQpuWMheWQq+mhuuWtkFxuS1FDYXJkLmNvbnRhaW5TaHVuWmkgPSBmdW5jdGlvbiAoY2FyZHMsIG1pbkxlbmd0aCA9IDUpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKEtRQ2FyZC5maW5kU2h1blppKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gICAgLy9sZXQgdW5pcXVlQ2FyZHMgPSBjYXJkcy51bmlxdWUoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XG4gICAgLy8gICAgcmV0dXJuIGNhcmQxLnBvaW50ID09IGNhcmQyLnBvaW50O1xuICAgIC8vfSk7XG4gICAgLy91bmlxdWVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XG4gICAgLy9cbiAgICAvL2xldCBtaW5Qb2ludENhcmQgPSB1bmlxdWVDYXJkc1swXTtcbiAgICAvL2lmIChtaW5Qb2ludENhcmQucG9pbnQgPT0gMSkge1xuICAgIC8vICAgIGxldCBBUGx1c0NhcmQgPSBuZXcgS1FDYXJkKG1pblBvaW50Q2FyZCk7XG4gICAgLy8gICAgQVBsdXNDYXJkLnBvaW50ID0gMTQ7XG4gICAgLy8gICAgdW5pcXVlQ2FyZHMucHVzaChBUGx1c0NhcmQpO1xuICAgIC8vfVxuICAgIC8vXG4gICAgLy9mb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG1pbkxlbmd0aCkgPD0gdW5pcXVlQ2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgLy8gICAgbGV0IHN1YkNhcmRzID0gdW5pcXVlQ2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbWluTGVuZ3RoKTtcbiAgICAvLyAgICBpZiAoS1FDYXJkLmlzU2h1blppKHN1YkNhcmRzLCBtaW5MZW5ndGgpKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICAvL1xuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluU2h1blppMjAoY2FyZHMpO1xufTtcbi8qS1FDYXJkLmNvbnRhaW5TaHVuWmkyMCA9IGZ1bmN0aW9uIChjYXJkKSB7XG4gaWYgKGNhcmQubGVuZ3RoIDwgNSkge1xuIHJldHVybiBmYWxzZTtcbiB9XG4gdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZCk7XG4gdmFyIGNhcmRzID0gY2FyZC5rcV9leGNsdWRlcyhjYXJkMjApO1xuIC8vIOWFiOagueaNrueCueaVsOWOu+mHjVxuIHZhciBuZXdBcnIgPSBbXTtcbiB2YXIgbmV3QXJycyA9IFtdO1xuIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspIHtcbiBpZiAobmV3QXJycy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSkge1xuIG5ld0Fyci5wdXNoKGNhcmRzW2ldKTtcbiBuZXdBcnJzLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuIH1cbiB9XG4gLy9uZXdBcnIuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcbiAvLyAgICBpZihjYXJkLnNjb3JlcyA9PSAxNCl7XG4gLy8gICAgICAgIGNhcmQuc2NvcmVzID0gMTtcbiAvLyAgICB9XG4gLy99KVxuIG5ld0Fyci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiByZXR1cm4gbjEucG9pbnQgLSBuMi5wb2ludDtcbiB9KTtcbiBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xuIHZhciBudW0gPSA1IC0gajtcbiBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gbmV3QXJyLmxlbmd0aDsgKytzdGFydCkge1xuIHZhciBzdWJDYXJkcyA9IG5ld0Fyci5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuIHZhciBib29sID0gcGFyc2VJbnQoc3ViQ2FyZHNbbnVtLTFdWydzY29yZXMnXSkgLSBwYXJzZUludChzdWJDYXJkc1swXVsnc2NvcmVzJ10pIDwgNTtcbiBpZihib29sKXtcbiByZXR1cm4gdHJ1ZTtcbiB9XG4gfVxuIH1cbiAvLyDnlLHkuo7ngrnmlbDmmK/llK/kuIDkuJTljYfluo/vvIzlj6rpnIDopoHkvp3mrKHpgY3ljobliKTmlq3mmK/lkKbmmK/pobrlrZDljbPlj69cbiBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmQpO1xuIGlmIChjYXJkID09PSBjb252ZXJ0ZWRDYXJkcykge1xuIHJldHVybiBmYWxzZTtcbiB9XG4gcmV0dXJuIEtRQ2FyZC5jb250YWluU2h1blppMjAoY29udmVydGVkQ2FyZHMpO1xuIH07Ki9cbi8vIOaYr+WQpuaYr+WQjOiKsemhulxuS1FDYXJkLmlzVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICByZXR1cm4gS1FDYXJkLmlzVG9uZ0h1YShjYXJkcykgJiYgS1FDYXJkLmlzU2h1blppKGNhcmRzKTtcbn07XG5cbi8vIOaYr+WQpuWMheWQq+acieWQjOiKsemhulxuS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkcywgbWluTGVuZ3RoID0gNSkge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoS1FDYXJkLmZpbmRUb25nSHVhU2h1bihjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICAgIC8vdmFyIHNhblNodW5aaSA9IEtRQ2FyZC5zYW5TaHVuWmkxKGNhcmRzLG1pbkxlbmd0aClbMF07XG4gICAgLy9pZihzYW5TaHVuWmkgPT0gbnVsbCl7XG4gICAgLy8gICAgcmV0dXJuIGZhbHNlO1xuICAgIC8vfVxuICAgIC8vdmFyIHJlc3VsdCA9IGZhbHNlO1xuICAgIC8vZm9yKHZhciBpPTA7aTxzYW5TaHVuWmkubGVuZ3RoO2krKykge1xuICAgIC8vICAgIHZhciBzID0gc2FuU2h1blppW2ldO1xuICAgIC8vICAgIGlmIChLUUNhcmQuaXNUb25nSHVhU2h1bihzLCBtaW5MZW5ndGgpKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMShjYXJkcyk7XG5cbn07XG4vKktRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4xID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XG4gaWYgKGNhcmRzLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuIHJldHVybiBmYWxzZTtcbiB9XG4gbGV0IHRlbXBDYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcbiBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG1pbkxlbmd0aCkgPD0gdGVtcENhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuIGxldCBzdWJDYXJkcyA9IHRlbXBDYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBtaW5MZW5ndGgpO1xuIGlmIChLUUNhcmQuaXNUb25nSHVhU2h1bihzdWJDYXJkcywgbWluTGVuZ3RoKSkge1xuIHJldHVybiB0cnVlO1xuIH1cbiB9XG5cbiBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRzKTtcbiBpZiAoY2FyZHMgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4yMChjYXJkcyk7XG4gfVxuIHJldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMShjb252ZXJ0ZWRDYXJkcyk7XG4gLy9yZXR1cm4gZmFsc2U7XG4gfTtcbiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMjAgPSBmdW5jdGlvbiAoY2FyZCwgbWluTGVuZ3RoID0gNSkge1xuIGlmIChjYXJkLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuIHJldHVybiBmYWxzZTtcbiB9XG4gdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZCkgfHwgW107XG4gdmFyIGNhcmRzID0gY2FyZC5rcV9leGNsdWRlcyhjYXJkMjApO1xuXG4gY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRzKTtcbiB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gdmFyIGNvbG9ySCA9IFtdOyAvL+e6ouW/g1xuIHZhciBjb2xvckMgPSBbXTsgLy/mooXoirFcbiB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gdmFyIHBvaW50UyA9IFtdOyAvL+m7keahg1xuIHZhciBwb2ludEggPSBbXTsgLy/nuqLlv4NcbiB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXG4gdmFyIHBvaW50RCA9IFtdOyAvL+aWueWdl1xuIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XG4gaWYoY2FyZHNbaV0uY29sb3IgPT0gJzQnKXtcbiBpZihwb2ludFMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuIHBvaW50Uy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiBjb2xvclMucHVzaChjYXJkc1tpXSk7XG4gfVxuXG4gfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzMnKXtcbiBpZihwb2ludEguaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuIHBvaW50SC5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gfVxuIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcyJyl7XG4gaWYocG9pbnRDLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiBwb2ludEMucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuIH1cbiB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMScpe1xuIGlmKHBvaW50RC5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gcG9pbnRELnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiB9XG4gfVxuIH1cblxuIHZhciBjb2xvciA9IFtjb2xvclMsY29sb3JILGNvbG9yQyxjb2xvckRdO1xuIHZhciBjb2xvclN1bSA9IFtdOyAgICAvL+aAu+WFseacieWHoOenjeiKseiJsiBbNSwzLDAuLi4uXVxuIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gaWYoY29sb3JbaV0ubGVuZ3RoID49IHBhcnNlSW50KDUgLSBjYXJkMjAubGVuZ3RoKSl7XG4gLy9jb2xvcltpXS5mb3JFYWNoKGZ1bmN0aW9uKGNhKXtcbiAvLyAgICBpZihjYS5zY29yZXMgPT0gMTQpe1xuIC8vICAgICAgICBjYS5zY29yZXMgPSAxO1xuIC8vICAgIH1cbiAvL30pXG4gY29sb3JbaV0uc29ydChmdW5jdGlvbihhMSxhMil7XG4gcmV0dXJuIGExIC0gYTI7XG4gfSlcbiBjb2xvclN1bS5wdXNoKGNvbG9yW2ldKTtcbiB9XG4gfVxuXG4gZm9yKHZhciBpPTA7aTxjb2xvclN1bS5sZW5ndGg7aSsrKSB7XG4gdmFyIHMgPSBjb2xvclN1bVtpXVxuIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gdmFyIG51bSA9IDUgLSBqO1xuIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbnVtKSA8PSBzLmxlbmd0aDsgKytzdGFydCkge1xuIHZhciBzdWJDYXJkcyA9IHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcbiB2YXIgYm9vbCA9IHBhcnNlSW50KHN1YkNhcmRzW251bS0xXVsnc2NvcmVzJ10pIC0gcGFyc2VJbnQoc3ViQ2FyZHNbMF1bJ3Njb3JlcyddKSA8IDU7XG4gaWYoYm9vbCl7XG4gcmV0dXJuIHRydWU7XG4gfVxuIH1cbiB9XG4gfVxuXG5cblxuIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZCk7XG4gaWYgKGNhcmQgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gcmV0dXJuIGZhbHNlO1xuIH1cbiByZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bjIwKGNvbnZlcnRlZENhcmRzKTtcbiB9OyovXG5cblxuLy8g5piv5ZCm5piv5riF6b6ZXG5LUUNhcmQuaXNRaW5nTG9uZyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSAxMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgdmFyIGNvbG9yUyA9IFtdOyAvL+m7keahg1xuICAgIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgICB2YXIgY29sb3JDID0gW107IC8v5qKF6IqxXG4gICAgdmFyIGNvbG9yRCA9IFtdOyAvL+aWueWdl1xuICAgIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ3MnKXtcbiAgICAgICAgICAgIGNvbG9yUy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnaCcpe1xuICAgICAgICAgICAgY29sb3JILnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5zdWl0ID09ICdjJyl7XG4gICAgICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2QnKXtcbiAgICAgICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgbHMgPSBjb2xvclMubGVuZ3RoOyAgLy/pu5HmoYPkuKrmlbBcbiAgICB2YXIgbGggPSBjb2xvckgubGVuZ3RoOyAgLy/nuqLmoYPkuKrmlbBcbiAgICB2YXIgbGMgPSBjb2xvckMubGVuZ3RoOyAgLy/mooXoirHkuKrmlbBcbiAgICB2YXIgbGQgPSBjb2xvckQubGVuZ3RoOyAgLy/mlrnlnZfkuKrmlbBcbiAgICB2YXIgY29sb3IgPSBbbHMsbGgsbGMsbGRdO1xuICAgIHZhciBjb2xvclN1bSA9IFtdOyAgICAvL+aAu+WFseacieWHoOenjeiKseiJsiBbNSwzLDAuLi4uXVxuICAgIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKGNvbG9yW2ldICE9IDApe1xuICAgICAgICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYoY29sb3JTdW0ubGVuZ3RoID09IDEpe1xuICAgICAgICBpZihjb2xvclN1bVswXSA9PSAxMyl7XG5cbiAgICAgICAgICAgIGlmKEtRQ2FyZC5pc1lpVGlhb0xvbmcoY2FyZHMpKXtcblxuICAgICAgICAgICAgICAgIHZhciB0ZVNodUNhcmQgPSBjYXJkcy5maWx0ZXIoZnVuY3Rpb24oaSl7cmV0dXJuIGl9KTtcblxuICAgICAgICAgICAgICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheSh0ZVNodUNhcmQpO1xuXG4gICAgICAgICAgICAgICAgdGVTaHVDYXJkLmZvckVhY2goZnVuY3Rpb24oYSl7XG4gICAgICAgICAgICAgICAgICAgIGlmKGEuc2NvcmVzID09IDEpIGEuc2NvcmVzID0gMTQ7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0ZVNodUNhcmQuc29ydChmdW5jdGlvbihhLGIpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYi5zY29yZXMgLSBhLnNjb3JlcztcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyh0ZVNodUNhcmQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGExID0gdGVTaHVDYXJkLnNwbGljZSgwLDUpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGEyID0gdGVTaHVDYXJkLnNwbGljZSgwLDUpO1xuXG4gICAgICAgICAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9IFt0ZVNodUNhcmQsIGEyLCBhMV07XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuICAgIC8vcmV0dXJuIEtRQ2FyZC5pc1RvbmdIdWFTaHVuKGNhcmRzKTtcbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG4vLyDmmK/lkKbmmK/kuIDmnaHpvplcbktRQ2FyZC5pc0xvbmcgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiBLUUNhcmQuaXNTaHVuWmkoY2FyZHMpO1xufTtcblxuLyojIyMjIyovXG4vKuaYr+WQpuS4gOadoem+mSovXG5LUUNhcmQuaXNZaVRpYW9Mb25nID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgLy9jYXJkczp7bnVtYmVyOjF+MTMgLCdzdWl0JzonaCcuLi59XG4gICAgdmFyIGxlbmd0aCA9IDEzO1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZih0eXBlb2YoY2FyZHNbMF0ubnVtYmVyKSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKGNhcmRzKTtcbiAgICB9XG4gICAgdmFyIG51bWJlciA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC5udW1iZXI7XG4gICAgfSkuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgIH0pO1xuICAgIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoLTE7aSsrKSB7XG4gICAgICAgIGlmKG51bWJlcltpXSAhPSBudW1iZXJbaSsxXSAtIDEpe1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHRlU2h1Q2FyZCA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaX0pO1xuXG4gICAgdGVTaHVDYXJkID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KHRlU2h1Q2FyZCk7XG5cbiAgICB0ZVNodUNhcmQuZm9yRWFjaChmdW5jdGlvbihhKXtcbiAgICAgICAgaWYoYS5zY29yZXMgPT0gMSkgYS5zY29yZXMgPSAxNDtcbiAgICB9KTtcblxuICAgIHRlU2h1Q2FyZC5zb3J0KGZ1bmN0aW9uKGEsYil7XG4gICAgICAgIHJldHVybiBiLnNjb3JlcyAtIGEuc2NvcmVzO1xuICAgIH0pO1xuXG4gICAgdGVTaHVDYXJkID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKHRlU2h1Q2FyZCk7XG5cbiAgICB2YXIgYTEgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XG5cbiAgICB2YXIgYTIgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XG5cbiAgICBjYy50ZVNodVBhaUNhcmRzID0gW3RlU2h1Q2FyZCwgYTIsIGExXTtcbiAgICAvL2NjLmxvZyhjYy50ZVNodVBhaUNhcmRzIClcbiAgICAvL2NjLmxvZygnLS0tLS0tLS03MjgnKVxuICAgIHJldHVybiB0cnVlO1xufTtcbi8qIyMjIyMqL1xuLyrmmK/lkKbkuInlkIzoirEqL1xuS1FDYXJkLmlzU2FuVG9uZ0h1YSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZihjYXJkc1swXS5zdWl0KSA9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XG4gICAgfVxuICAgIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcbiAgICB2YXIgY29sb3JIID0gW107IC8v57qi5b+DXG4gICAgdmFyIGNvbG9yQyA9IFtdOyAvL+aiheiKsVxuICAgIHZhciBjb2xvckQgPSBbXTsgLy/mlrnlnZdcbiAgICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihjYXJkc1tpXS5zdWl0ID09ICdzJyl7XG4gICAgICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2gnKXtcbiAgICAgICAgICAgIGNvbG9ySC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnYycpe1xuICAgICAgICAgICAgY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5zdWl0ID09ICdkJyl7XG4gICAgICAgICAgICBjb2xvckQucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIGxzID0gY29sb3JTLmxlbmd0aDsgIC8v6buR5qGD5Liq5pWwXG4gICAgdmFyIGxoID0gY29sb3JILmxlbmd0aDsgIC8v57qi5qGD5Liq5pWwXG4gICAgdmFyIGxjID0gY29sb3JDLmxlbmd0aDsgIC8v5qKF6Iqx5Liq5pWwXG4gICAgdmFyIGxkID0gY29sb3JELmxlbmd0aDsgIC8v5pa55Z2X5Liq5pWwXG4gICAgdmFyIHNhbkNhcmQgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcbiAgICB2YXIgdGVTaHVDYXJkID0gW107XG4gICAgdmFyIGNvbG9yID0gW2xzLGxoLGxjLGxkXTtcbiAgICB2YXIgY29sb3JTdW0gPSBbXTsgICAgLy/mgLvlhbHmnInlh6Dnp43oirHoibIgWzUsMywwLi4uLl1cbiAgICBmb3IodmFyIGk9MDtpPGNvbG9yLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihjb2xvcltpXSAhPSAwKXtcbiAgICAgICAgICAgIGNvbG9yU3VtLnB1c2goY29sb3JbaV0pO1xuICAgICAgICAgICAgdGVTaHVDYXJkLnB1c2goc2FuQ2FyZFtpXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL+S4ieenjeiKseiJslxuICAgIGlmKGNvbG9yU3VtLmxlbmd0aCA9PSAzKXtcbiAgICAgICAgZm9yKHZhciBpPTA7aTxjb2xvclN1bS5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAgICBpZiAoY29sb3JTdW1baV0gIT0gNSAmJiBjb2xvclN1bVtpXSAhPSAzKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGVTaHVDYXJkLnNvcnQoZnVuY3Rpb24oYSxiKXtcbiAgICAgICAgICAgIHJldHVybiBhLmxlbmd0aCAtIGIubGVuZ3RoO1xuICAgICAgICB9KTtcbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9IHRlU2h1Q2FyZDtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcblxufTtcbi8q5piv5ZCm5YeR5LiA6ImyKi9cbktRQ2FyZC5pc0NvdVlpU2UgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gMTM7XG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5zdWl0KSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XG4gICAgfVxuICAgIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcbiAgICB2YXIgY29sb3JIID0gW107IC8v57qi5b+DXG4gICAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY2FyZHNbaV0uc3VpdCA9PSAncycgfHwgY2FyZHNbaV0uc3VpdCA9PSAnYycpe1xuICAgICAgICAgICAgY29sb3JTLnB1c2goY2FyZHNbaV0pOy8v5YWo6buRXG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2gnIHx8IGNhcmRzW2ldLnN1aXQgPT0gJ2QnKXtcbiAgICAgICAgICAgIGNvbG9ySC5wdXNoKGNhcmRzW2ldKTsvL+WFqOe6olxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy/lpoLmnpzniYzkuK3ljIXlkKvlm5vnp43oirHoibLlsLHkuI3lj6/og73mmK/kuInlkIzoirFcbiAgICBpZihjb2xvclMubGVuZ3RoID09IDEzIHx8IGNvbG9ySC5sZW5ndGggPT0gMTMpe1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy9lbHNlIGlmKGNvbG9ySC5sZW5ndGggPT0gMTMpe1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG4vKiMjIyMjKi9cbi8vIOaYr+WQpuaYr+WFreWvueWNilxuS1FDYXJkLmlzTGl1RHVpQmFuID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEyO1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBkdWlaaUxlbmd0aCA9IDI7XG4gICAgLy/orqHnrpfkuIDkuKrniYzmlbDnu4TlhoXnmoTnm7jlkIzngrnmlbDnmoTniYznmoTlvKDmlbBcbiAgICBsZXQgY2FyZE51bWJlcnMgPSBuZXcgR2V0Q2FyZFBvaW50c1NhbWVDb3VudChjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mRHVpWmkgPSAwO1xuICAgIGxldCBudW1iZXJPZllpID0gMDtcbiAgICBmb3IgKGxldCBwcm9wIGluIGNhcmROdW1iZXJzKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IGNhcmROdW1iZXJzW3Byb3BdO1xuICAgICAgICBpZiAodmFsdWUgPT0gZHVpWmlMZW5ndGggfHwgdmFsdWUgPT0gMykge1xuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IDQpIHtcbiAgICAgICAgICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMjtcbiAgICAgICAgfVxuICAgICAgICAvL2Vsc2UgaWYgKHZhbHVlID09IDYgfHwgdmFsdWUgPT0gNyB8fCB2YWx1ZSA9PSA1KSB7XG4gICAgICAgIC8vICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMDtcbiAgICAgICAgLy99XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IDEpIHtcbiAgICAgICAgICAgIG51bWJlck9mWWkgKz0gMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmKG51bWJlck9mRHVpWmkgPT0gNil7XG5cbiAgICAgICAgdmFyIHRlU2h1Q2FyZCA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaX0pO1xuXG4gICAgICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheSh0ZVNodUNhcmQpO1xuXG4gICAgICAgIHRlU2h1Q2FyZC5mb3JFYWNoKGZ1bmN0aW9uKGEpe1xuICAgICAgICAgICAgaWYoYS5zY29yZXMgPT0gMSkgYS5zY29yZXMgPSAxNDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVTaHVDYXJkLnNvcnQoZnVuY3Rpb24oYSxiKXtcbiAgICAgICAgICAgIHJldHVybiBiLnNjb3JlcyAtIGEuc2NvcmVzO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZVNodUNhcmQgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHModGVTaHVDYXJkKTtcblxuICAgICAgICB2YXIgYTEgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XG5cbiAgICAgICAgdmFyIGEyID0gdGVTaHVDYXJkLnNwbGljZSgwLDUpO1xuXG4gICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMgPSBbdGVTaHVDYXJkLCBhMiwgYTFdO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5LUUNhcmQuaXNXdUR1aVNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGR1aVppTGVuZ3RoID0gMjtcbiAgICBsZXQgc2FuVGlhb0xlbmd0aCA9IDM7XG4gICAgLy/orqHnrpfkuIDkuKrniYzmlbDnu4TlhoXnmoTnm7jlkIzngrnmlbDnmoTniYznmoTlvKDmlbBcbiAgICBsZXQgY2FyZE51bWJlcnMgPSBuZXcgR2V0Q2FyZFBvaW50c1NhbWVDb3VudChjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mRHVpWmkgPSAwO1xuICAgIGxldCBudW1iZXJPZlNhblRpYW8gPSAwO1xuICAgIGZvciAobGV0IHByb3AgaW4gY2FyZE51bWJlcnMpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gY2FyZE51bWJlcnNbcHJvcF07XG4gICAgICAgIGlmICh2YWx1ZSA9PSBkdWlaaUxlbmd0aCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IHNhblRpYW9MZW5ndGgpIHtcbiAgICAgICAgICAgIG51bWJlck9mU2FuVGlhbyA9IG51bWJlck9mU2FuVGlhbyArIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPj0gNCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAyO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudW1iZXJPZkR1aVppID09IDUgJiYgbnVtYmVyT2ZTYW5UaWFvID09IDE7XG59O1xuXG4vL+WIpOaWrTXlvKDmiJbogIUz5byg5piv5ZCm6aG65a2QXG5LUUNhcmQuaXNTaHVuWmkxID0gZnVuY3Rpb24oYXJyKXtcbiAgICAvL2NvbnNvbGUubG9nKGFycik7XG4gICAgZm9yKHZhciBpPTA7aTxhcnIubGVuZ3RoLTE7aSsrKXtcbiAgICAgICAgaWYoYXJyW2krMV0gLSBhcnJbaV0gIT0gMSl7XG4gICAgICAgICAgICAvL+S4jeaYr+mhuuWtkFxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIuS4jeaYr+mhuuWtkFwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbktRQ2FyZC5pc1NhblNodW5aaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZih0eXBlb2YoY2FyZHNbMF0uc3VpdCkgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICBjYXJkcyA9IEtRQ2FyZC5fY29udmVydENhcmRzVG9DYXJkTmFtZXMoY2FyZHMpO1xuICAgIH1cblxuICAgIC8v5Y+W5Ye654mM55qE54K55pWwXG4gICAgdmFyIG51bWJlciA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC5udW1iZXI7XG4gICAgfSk7XG4gICAgLy/mjpLluo9cbiAgICBudW1iZXIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgIH0pO1xuICAgIGlmKEtRQ2FyZC5mZW5aaHUobnVtYmVyLDUsNSkgPT0gZmFsc2Upe1xuICAgICAgICB2YXIgbnVtYmVyID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FyZC5udW1iZXI7XG4gICAgICAgIH0pO1xuICAgICAgICAvL+aOkuW6j1xuICAgICAgICBudW1iZXIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmKEtRQ2FyZC5mZW5aaHUobnVtYmVyLDUsMykgPT0gZmFsc2Upe1xuICAgICAgICAgICAgdmFyIG51bWJlciA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYXJkLm51bWJlcjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy/mjpLluo9cbiAgICAgICAgICAgIG51bWJlci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYoS1FDYXJkLmZlblpodShudW1iZXIsMyw1KSA9PSBmYWxzZSl7XG4gICAgICAgICAgICAgICAgLy/kuI3mmK/kuInpobrlrZBcbiAgICAgICAgICAgICAgICB2YXIgQUlzRXhpc3QgPSBmYWxzZTsgIC8v5piv5ZCm5a2Y5ZyoQVxuICAgICAgICAgICAgICAgIGZvcih2YXIgaSBpbiBjYXJkcykge1xuICAgICAgICAgICAgICAgICAgICBpZihjYXJkc1tpXS5udW1iZXIgPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQUlzRXhpc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIuWtmOWcqEFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZighQUlzRXhpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIumAgOWHuumAkuW9klwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvcih2YXIgaSBpbiBjYXJkcykge1xuICAgICAgICAgICAgICAgICAgICBpZihjYXJkc1tpXS5udW1iZXIgPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkHovazkuLoxNFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRzW2ldLm51bWJlciA9IDE0O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoY2MudGVTaHVQYWlDYXJkcyAmJiBjYy50ZVNodVBhaUNhcmRzLmxlbmd0aCA+IDAgJiYgY2MudGVTaHVQYWlDYXJkc1swXVswXSAgJiYgdHlwZW9mKGNjLnRlU2h1UGFpQ2FyZHNbMF1bMF0pID09ICdudW1iZXInKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0NhcmRzID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpO30pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q2FyZHMxID0gY2MudGVTaHVQYWlDYXJkcy5tYXAoZnVuY3Rpb24oYXJyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWQgPSBhcnIubWFwKGZ1bmN0aW9uKG51bWJlcil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IG5ld0NhcmRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobmV3Q2FyZHNbaV0ubnVtYmVyID09IG51bWJlcil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3Q2FyZHMuc3BsaWNlKGksMSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhZDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMgPSBuZXdDYXJkczE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBLUUNhcmQuaXNTYW5TaHVuWmkoY2FyZHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmKGNjLnRlU2h1UGFpQ2FyZHMgJiYgY2MudGVTaHVQYWlDYXJkcy5sZW5ndGggPiAwICYmIGNjLnRlU2h1UGFpQ2FyZHNbMF1bMF0gICYmIHR5cGVvZihjYy50ZVNodVBhaUNhcmRzWzBdWzBdKSA9PSAnbnVtYmVyJyl7XG4gICAgICAgIHZhciBuZXdDYXJkcyA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaTt9KTtcbiAgICAgICAgdmFyIG5ld0NhcmRzMSA9IGNjLnRlU2h1UGFpQ2FyZHMubWFwKGZ1bmN0aW9uKGFycil7XG4gICAgICAgICAgICB2YXIgY2FkID0gYXJyLm1hcChmdW5jdGlvbihudW1iZXIpe1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBuZXdDYXJkcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgIGlmKG5ld0NhcmRzW2ldLm51bWJlciA9PSBudW1iZXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld0NhcmRzLnNwbGljZShpLDEpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjYWQ7XG4gICAgICAgIH0pO1xuICAgICAgICBjYy50ZVNodVBhaUNhcmRzID0gbmV3Q2FyZHMxO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbi8v5YiG57uENTUzfHw1MzV8fDM1NVxuS1FDYXJkLmZlblpodSA9IGZ1bmN0aW9uIChudW1iZXIsbnVtMSxudW0yKSAge1xuICAgIHZhciBhcnIxID0gW107XG4gICAgdmFyIGFycjIgPSBbXTtcbiAgICB2YXIgYXJyMyA9IFtdO1xuICAgIGZvcih2YXIgaT0wO2k8bnVtYmVyLmxlbmd0aC0xO2krKyl7XG4gICAgICAgIGlmKGkgPT0gMCl7XG4gICAgICAgICAgICBhcnIxLnB1c2gobnVtYmVyWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBpZihudW1iZXJbaSsxXSAtIG51bWJlcltpXSA9PSAwKXtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGFycjEucHVzaChudW1iZXJbaSsxXSk7XG4gICAgICAgIGlmKGFycjEubGVuZ3RoID09IG51bTEpe1xuICAgICAgICAgICAgLy/lj5bnrKzkuIDnu4TmmK/pobrlrZBcbiAgICAgICAgICAgIGlmKEtRQ2FyZC5pc1NodW5aaTEoYXJyMSkpe1xuICAgICAgICAgICAgICAgIC8v6L+ZNeS4quaYr+mhuuWtkCzku47mlbDnu4TkuK3np7vpmaRcbiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDtpPGFycjEubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaj0wO2o8bnVtYmVyLmxlbmd0aDtqKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IGFycjFbaV0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Lik5Liq5pWw5LiA5qC355qE5Y+q5Yig6Zmk5LiA5LiqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IG51bWJlcltqKzFdKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlci5zcGxpY2UoaiwxKTsgICAgLy/ku45udW1iZXLkuK3np7vpmaRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKmNvbnNvbGUubG9nKFwi5Yig6Zmk56ys5LiA57uE5ZCO55qEbnVtYmVyXCIpO1xuICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhudW1iZXIpOyovXG4gICAgICAgICAgICAgICAgLy/mjqXkuIvmnaXlj5bnrKzkuoznu4RcbiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDtpPG51bWJlci5sZW5ndGgtMTtpKyspe1xuICAgICAgICAgICAgICAgICAgICBpZihpID09IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJyMi5wdXNoKG51bWJlclswXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2krMV0gLSBudW1iZXJbaV0gPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhcnIyLnB1c2gobnVtYmVyW2krMV0pO1xuICAgICAgICAgICAgICAgICAgICBpZihhcnIyLmxlbmd0aCA9PSBudW0yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL+WPluesrOS6jOe7hOaYr+mhuuWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEtRQ2FyZC5pc1NodW5aaTEoYXJyMikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDtpPGFycjIubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaj0wO2o8bnVtYmVyLmxlbmd0aDtqKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IGFycjJbaV0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Lik5Liq5pWw5LiA5qC355qE5Y+q5Yig6Zmk5LiA5LiqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IG51bWJlcltqKzFdKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlci5zcGxpY2UoaiwxKTsgICAgLy/ku45udW1iZXLkuK3np7vpmaRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKmNvbnNvbGUubG9nKFwi5Yig6Zmk56ys5LqM57uE5ZCO55qEbnVtYmVyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhudW1iZXIpOyovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyMyA9IG51bWJlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+aOpeS4i+adpeWwseaYr+WJqeS4i+eahOS6hlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKEtRQ2FyZC5pc1NodW5aaTEoYXJyMykpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+esrOS4iee7hOS5n+aYr+mhuuWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNkZiA9IFthcnIxLGFycjIsYXJyM107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNkZi5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtyZXR1cm4gbjEubGVuZ3RoIC0gbjIubGVuZ3RoO30pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFjYy50ZVNodVBhaUNhcmRzKSBjYy50ZVNodVBhaUNhcmRzID0gYXNkZjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/nrKzkuInnu4TkuI3mmK/pobrlrZBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL+esrOS6jOe7hOS4jeaYr+mhuuWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy/nrKzkuIDnu4TkuI3mmK/pobrlrZBcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvL+WmguaenOWPluS4jeWIsG51bTHkuKrmlbBcbiAgICBpZihhcnIxLmxlbmd0aCA8IG51bTEpe1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmKGFycjIubGVuZ3RoIDwgbnVtMil7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59O1xuXG5LUUNhcmQuaXNTYW5TaHVuWmkxID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdmFyIGxlbmd0aCA9IDEzO1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZih0eXBlb2YoY2FyZHNbMF0ucG9pbnQpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZHMpO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNhcmRzID0gQXJyYXkuZnJvbShjYXJkcyk7XG4gICAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpO1xuICAgIHZhciB3ZWkgPSBbXTtcbiAgICB2YXIgemhvbmcgPSBbXTtcbiAgICB2YXIgdG91ID0gW107XG4gICAgdmFyIHNhblNodW5aaSA9IEtRQ2FyZC5zYW5TaHVuWmkxKGNhcmRzKVswXTsvL+iOt+WPluaJgOaciee7hOWQiOeahOWktOmBk1xuICAgIGlmKCFzYW5TaHVuWmkpeyAvL+S9oOi/nuWktOmBk+mDveayoeaciSDmgI7kuYjmm7TmiJHmt7dcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHZhciBuZXdDYXJkID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpey8v6YeN5paw6LWL5YC8Y2FyZHNcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgfSk7XG4gICAgdmFyIG5ld0NhcmRzMSA9IFtdO1xuICAgIHZhciBuZXdQb2ludCA9IFtdOy8v5Yik5patcG9pbnTmmK/lkKbnm7jlkIxcbiAgICB2YXIgZHVpWmkgPSBbXTsvL+WPluWHuuacieWvueWtkOW9k+S4reeahOS4gOW8oOeJjFxuICAgIGZvcih2YXIgcyBpbiBjYXJkcyl7XG4gICAgICAgIGlmKG5ld1BvaW50LmluZGV4T2YoY2FyZHNbc10ucG9pbnQpPDApe1xuICAgICAgICAgICAgbmV3Q2FyZHMxLnB1c2goY2FyZHNbc10pO1xuICAgICAgICAgICAgbmV3UG9pbnQucHVzaChjYXJkc1tzXS5wb2ludCk7XG4gICAgICAgIH1lbHNley8v5Y+W5Ye65pyJ5a+55a2Q5b2T5Lit55qE5LiA5byg54mMXG4gICAgICAgICAgICBkdWlaaS5wdXNoKGNhcmRzW3NdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2FuU2h1blppLmxlbmd0aDsgKytqKSB7Ly/lvqrnjq/miYDmnInlpLTpgZNcbiAgICAgICAgdmFyIG51bWJlcjMgPSBzYW5TaHVuWmlbal07XG4gICAgICAgIGlmKHR5cGVvZihudW1iZXIzKSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgKGkpIDwgY2FyZHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBuZXdDYXJkcyA9IG5ld0NhcmRzMS5maWx0ZXIoZnVuY3Rpb24oaSl7Ly/ph43mlrDotYvlgLxjYXJkc1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG5ld0NhcmRzID0gbmV3Q2FyZHMua3FfZXhjbHVkZXMobnVtYmVyMyk7Ly/liKDpmaTniYzph4znmoTlpLTpgZNcbiAgICAgICAgICAgIGlmICh3ZWkubGVuZ3RoICE9IDUpIHtcbiAgICAgICAgICAgICAgICBsZXQgc3ViQ2FyZHMgPSBuZXdDYXJkcy5zbGljZShpLCBpICsgNSk7XG4gICAgICAgICAgICAgICAgaWYgKHN1YkNhcmRzLmxlbmd0aCA9PSA1IHx8IEtRQ2FyZC5pc1NodW5aaShzdWJDYXJkcykpIHsvL+W+l+WIsOWwvumBkyDliKDpmaTniYzph4znmoTlsL7pgZNcbiAgICAgICAgICAgICAgICAgICAgd2VpID0gc3ViQ2FyZHM7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhudW1iZXIzKVxuICAgICAgICAgICAgICAgICAgICAvLyBjYy5sb2cobmV3Q2FyZHMxKVxuICAgICAgICAgICAgICAgICAgICAvLyBjYy5sb2coc3ViQ2FyZHMpXG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhuZXdDYXJkcylcbiAgICAgICAgICAgICAgICAgICAgLy8gY2MubG9nKGkpXG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZygnLS0tLS03MTYnKVxuICAgICAgICAgICAgICAgICAgICBuZXdDYXJkcyA9IG5ld0NhcmRzLmtxX2V4Y2x1ZGVzKHN1YkNhcmRzKTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYod2VpLmxlbmd0aCA9PSA1KXsvL+aKiuWJqeS9meeahOeJjOWSjOWvueWtkOeahOWNleW8oOWQiOW5tlxuICAgICAgICAgICAgICAgIGxldCB0YXNrcyA9IGR1aVppLmZpbHRlcihmdW5jdGlvbihpKXsvL+mHjeaWsOi1i+WAvOWvueWtkFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0YXNrcyA9IHRhc2tzLmtxX2V4Y2x1ZGVzKG51bWJlcjMpOy8v5Yik5pat5aS06YGT5ZKM5a+55a2Q55qE5Y2V5byg5piv5ZCm5pyJ55u45ZCMIOacieeahOivneWwseWIoOmZpFxuICAgICAgICAgICAgICAgIG5ld0NhcmRzID0gbmV3Q2FyZHMuY29uY2F0KHRhc2tzKTsvL+aKiuWJqeS9meeahOeJjOWSjOWvueWtkOeahOWNleW8oOWQiOW5tlxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoemhvbmcubGVuZ3RoICE9IDUgJiYgbmV3Q2FyZHMubGVuZ3RoID09IDUpIHtcbiAgICAgICAgICAgICAgICBpZiAoS1FDYXJkLmlzU2h1blppKG5ld0NhcmRzKSkgey8v5piv5LiJ6aG65a2QXG4gICAgICAgICAgICAgICAgICAgIHpob25nID0gbmV3Q2FyZHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYod2VpLmxlbmd0aCA9PSA1ICYmIHpob25nLmxlbmd0aCA9PSA1ICl7Ly/mmK/kuInpobrlrZDnu4jmraLlvqrnjq9cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7Ly/mnaXlkKcg57un57ut5ZCnXG4gICAgICAgICAgICAgICAgemhvbmcgPSBbXTt3ZWkgPSBbXTt0b3UgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZih3ZWkubGVuZ3RoID09IDUgJiYgemhvbmcubGVuZ3RoID09IDUgKXsvL+aYr+S4iemhuuWtkOe7iOatouW+queOr1xuICAgICAgICAgICAgdG91ID0gbnVtYmVyMztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7Ly/mnaXlkKcg57un57ut5ZCnXG4gICAgICAgICAgICB6aG9uZyA9IFtdO3dlaSA9IFtdO3RvdSA9IFtdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2FyZHMgPSBuZXdDYXJkO1xuICAgIGlmIChLUUNhcmQuX2lzU2FuU2h1blppKHRvdSx6aG9uZyx3ZWkpKSB7Ly/mmK/kuInpobrlrZBcbiAgICAgICAgdG91ID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKHRvdSk7XG4gICAgICAgIHpob25nID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKHpob25nKTtcbiAgICAgICAgd2VpID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKHdlaSk7XG5cbiAgICAgICAgaWYoIWNjLnRlU2h1UGFpQ2FyZHMpIGNjLnRlU2h1UGFpQ2FyZHMgPSBbdG91LHpob25nLHdlaV07XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRzKTtcbiAgICBpZiAoY2FyZHMgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gICAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24oYSl7XG4gICAgICAgICAgICBpZihhLnBvaW50ID09IDE0KSBhLnBvaW50ID0gMTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gS1FDYXJkLmlzU2FuU2h1blppMShjYXJkcyk7XG4gICAgfVxuICAgIHJldHVybiBLUUNhcmQuaXNTYW5TaHVuWmkoY29udmVydGVkQ2FyZHMpO1xufTtcblxuS1FDYXJkLnNhblNodW5aaTEgPSBmdW5jdGlvbiAoY2FyZHMsbGVuZ3RoID0gMykge1xuICAgIHZhciBzaHVuemkgPSBLUUNhcmQuZmluZFNodW5aaShjYXJkcyxsZW5ndGgpO1xuICAgIHZhciBjYXJkc1QgPSBbXTtcbiAgICB2YXIgY2FyZHNJbmRleCA9IFtdO1xuICAgIGlmKHNodW56aSA9PSBudWxsKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgc2h1bnppLmxlbmd0aDtpKyspe1xuICAgICAgICB2YXIgYSA9IHNodW56aVtpXTtcbiAgICAgICAgdmFyIGNhcmRzU2h1bnppID0gW107XG4gICAgICAgIC8vIHZhciBjYXJkc0luZGV4ID0gW107XG4gICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCBhLmxlbmd0aDtqKyspe1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gYVtqXTtcbiAgICAgICAgICAgIGlmKHR5cGVvZihjYXJkc1tpbmRleF0pID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhcmRzU2h1bnppLnB1c2goY2FyZHNbaW5kZXhdKTtcblxuICAgICAgICB9XG4gICAgICAgIGNhcmRzSW5kZXgucHVzaChhKTtcbiAgICAgICAgY2FyZHNULnB1c2goY2FyZHNTaHVuemkpO1xuICAgIH1cbiAgICByZXR1cm4gW2NhcmRzVCxjYXJkc0luZGV4XTtcbn07XG5cbktRQ2FyZC5faXNTYW5TaHVuWmkgPSBmdW5jdGlvbiAodG91Q2FyZHMsIHpob25nQ2FyZHMsIHdlaUNhcmRzKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5pc1NodW5aaSh0b3VDYXJkcykgJiYgS1FDYXJkLmlzU2h1blppKHpob25nQ2FyZHMpXG4gICAgICAgICYmIEtRQ2FyZC5pc1NodW5aaSh3ZWlDYXJkcyk7XG59O1xuLy8g5piv5ZCm5piv5LiJ5ZCM6Iqx6aG6XG5LUUNhcmQuaXNTYW5Ub25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGV0IGNvbG9yQ2FyZHNPYmplY3QgPSBLUUNhcmQuX2NvbG9yQ2xhc3NDYXJkcyhjYXJkcyk7XG5cbiAgICB2YXIgc3ViQ2FyZHMgPSBbXTtcbiAgICBmb3IgKGxldCBwcm9wIGluIGNvbG9yQ2FyZHNPYmplY3QpIHtcbiAgICAgICAgbGV0IGNhcmRzID0gY29sb3JDYXJkc09iamVjdFtwcm9wXTtcbiAgICAgICAgc3ViQ2FyZHMucHVzaChjYXJkcyk7XG4gICAgfVxuXG4gICAgaWYgKHN1YkNhcmRzLmxlbmd0aCAhPSAzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLnNvcnQoZnVuY3Rpb24gKHMxLCBzMikge1xuICAgICAgICByZXR1cm4gczEubGVuZ3RoID4gczIubGVuZ3RoO1xuICAgIH0pO1xuXG4gICAgbGV0IHRvdUNhcmRzID0gc3ViQ2FyZHNbMF07XG4gICAgbGV0IHpob25nQ2FyZHMgPSBzdWJDYXJkc1sxXTtcbiAgICBsZXQgd2VpQ2FyZHMgPSBzdWJDYXJkc1syXTtcblxuICAgIGlmICgodG91Q2FyZHMubGVuZ3RoICE9IDMpIHx8ICh6aG9uZ0NhcmRzLmxlbmd0aCAhPSA1KSB8fCAod2VpQ2FyZHMubGVuZ3RoICE9IDUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gS1FDYXJkLl9pc1NhblRvbmdIdWFTaHVuKHRvdUNhcmRzLCB6aG9uZ0NhcmRzLCB3ZWlDYXJkcyk7XG59O1xuXG4vLyDlsIbniYzmoLnmja4gY29sb3Ig6L+b6KGM5YiG57G7XG5LUUNhcmQuX2NvbG9yQ2xhc3NDYXJkcyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBjb2xvckNhcmRzT2JqZWN0ID0ge307XG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICBsZXQgY29sb3IgPSBjYXJkLmNvbG9yO1xuICAgICAgICB2YXIgc3ViQ2FyZHMgPSBjb2xvckNhcmRzT2JqZWN0W2NvbG9yXTtcbiAgICAgICAgaWYgKCFzdWJDYXJkcykge1xuICAgICAgICAgICAgc3ViQ2FyZHMgPSBbXTtcbiAgICAgICAgICAgIGNvbG9yQ2FyZHNPYmplY3RbY29sb3JdID0gc3ViQ2FyZHM7XG4gICAgICAgIH1cbiAgICAgICAgc3ViQ2FyZHMucHVzaChjYXJkKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBjb2xvckNhcmRzT2JqZWN0O1xufTtcblxuLy8g5piv5ZCm5piv5LiJ5ZCM6Iqx6aG6XG5LUUNhcmQuX2lzU2FuVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAodG91Q2FyZHMsIHpob25nQ2FyZHMsIHdlaUNhcmRzKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHRvdUNhcmRzKSAmJiBLUUNhcmQuaXNUb25nSHVhU2h1bih6aG9uZ0NhcmRzKVxuICAgICAgICAmJiBLUUNhcmQuaXNUb25nSHVhU2h1bih3ZWlDYXJkcyk7XG59O1xuXG5cbi8vIOaYr+WQpuaYryDigJzkuInliIblpKnkuIvigJ1cbktRQ2FyZC5pc1NhbkZlblRpYW5YaWEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHRpZVpoaUxlbmd0aCA9IDQ7XG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mVGllWmhpID0gMDtcbiAgICBmb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgICBsZXQgdmFsdWUgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF07XG4gICAgICAgIGlmICh2YWx1ZSA9PSB0aWVaaGlMZW5ndGgpIHtcbiAgICAgICAgICAgIG51bWJlck9mVGllWmhpID0gbnVtYmVyT2ZUaWVaaGkgKyAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudW1iZXJPZlRpZVpoaSA9PT0gMztcbn07XG5cblxuLy8g5piv5ZCm5pivIOKAnOWbm+Wll+S4ieadoeKAnVxuS1FDYXJkLmlzU2lUYW9TYW5UaWFvID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEzO1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBsZXQgc2FuVGlhb0xlbmd0aCA9IDM7XG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mU2FuVGlhbyA9IDA7XG4gICAgZm9yIChsZXQgcHJvcCBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3Byb3BdO1xuICAgICAgICBpZiAodmFsdWUgPT0gc2FuVGlhb0xlbmd0aCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZTYW5UaWFvID0gbnVtYmVyT2ZTYW5UaWFvICsgMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudW1iZXJPZlNhblRpYW8gPT0gNDtcbn07XG5cblxuLy8g5piv5ZCm5pivIOKAnOS4ieahg+iKseKAnVxuLy8g5aS044CB5Lit44CB5bC+6YGT5Li655u45ZCM6Iqx6Imy55qE54mMXG5LUUNhcmQuaXNTYW5UYW9IdWEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGxldCBjb2xvckhlbHBlciA9IG5ldyBLUUNhcmRDb2xvcnNIZWxwZXIoY2FyZHMpO1xuICAgIHZhciBjb2xvck51bWJlcnMgPSBbXTtcbiAgICBmb3IgKGxldCBwcm9wIGluIGNvbG9ySGVscGVyLmNvbG9yTnVtYmVyKSB7XG4gICAgICAgIGNvbG9yTnVtYmVycy5wdXNoKGNvbG9ySGVscGVyLmNvbG9yTnVtYmVyW3Byb3BdKTtcbiAgICB9XG5cbiAgICBjb2xvck51bWJlcnMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgIH0pO1xuXG4gICAgaWYgKGNvbG9yTnVtYmVycy5sZW5ndGggIT0gMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKGNvbG9yTnVtYmVyc1swXSA9PSAzXG4gICAgICAgICYmIChjb2xvck51bWJlcnNbMV0gPT0gNSlcbiAgICAgICAgJiYgKGNvbG9yTnVtYmVyc1syXSA9PSA1KSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5cbi8vIOWIpOaWreaYr+WQpuWMheWQq+mTgeaUr1xuLy8g5Zub5byg5ZCM5qC354K55pWw55qE54mMXG5LUUNhcmQuY29udGFpblRpZVpoaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSA0O1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAgIGxlbmd0aCA9IGxlbmd0aC1jYXJkMjAubGVuZ3RoO1xuICAgIGxldCBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcblxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xuICAgICAgICBpZihtYXhOdW1iZXIgPj0gbGVuZ3RoKXtcbiAgICAgICAgICAgIGNhcmQyMC5mb3JFYWNoKGZ1bmN0aW9uKGNhKXtcbiAgICAgICAgICAgICAgICBjYS5zY29yZXMgPSBwYXJzZUludCh3KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy9pZihoZWxwZXIubWF4TnVtYmVyKCkgPj0gbGVuZ3RoKXtcbiAgICAvLyAgICByZXR1cm4gaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aDtcbiAgICAvL31cbiAgICAvLyBlbHNle1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuY29udGFpbkd1aVBhaShjYXJkcyw0KTtcbiAgICAvL31cbiAgICAvL2lmIChLUUNhcmQuZmluZFRpZVpoaShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cblxuLy8g5Yik5pat5piv5ZCm5piv6ZOB5pSvXG5LUUNhcmQuaXNUaWVaaGkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gNDtcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLnJlZHVjZShmdW5jdGlvbiAocG9pbnQsIGNhcmQpIHtcbiAgICAgICAgaWYgKHBvaW50ID09IGNhcmQucG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2ludDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfSwgY2FyZHNbMF0ucG9pbnQpO1xuXG4gICAgcmV0dXJuIHJlc3VsdCAhPSAtMTtcbn07XG5cbi8qIyMjIyPmmK/lkKbljIXlkKvkupTlkIwqL1xuLy/kupTlvKDlkIzmoLfngrnmlbDnmoTniYxcbktRQ2FyZC5jb250YWluV3VUb25nID0gZnVuY3Rpb24oY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gNTtcbiAgICBpZihjYXJkcy5sZW5ndGggPCBsZW5ndGgpe1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgbGVuZ3RoID0gbGVuZ3RoLWNhcmQyMC5sZW5ndGg7XG4gICAgLy/kupTlvKDniYznm7jlkIznmoRcbiAgICBsZXQgaGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgLy9mb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIC8vICAgIGNjLmxvZyh3KVxuICAgIC8vfVxuICAgIC8vY2MubG9nKGNhcmRzKVxuICAgIC8vY2MubG9nKGhlbHBlcilcbiAgICAvL2NjLmxvZyhjYXJkMjApXG4gICAgLy9jYy5sb2coaGVscGVyLm1heE51bWJlcigpKVxuICAgIC8vY2MubG9nKCctLS0tLS0xMzA3JylcbiAgICAvL2lmKGhlbHBlci5tYXhOdW1iZXIoKSA+PSBsZW5ndGgpe1xuICAgIC8vICAgIHJldHVybiBoZWxwZXIubWF4TnVtYmVyKCkgPj0gbGVuZ3RoO1xuICAgIC8vfVxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xuICAgICAgICBpZihtYXhOdW1iZXIgPj0gbGVuZ3RoKXtcbiAgICAgICAgICAgIGNhcmQyMC5mb3JFYWNoKGZ1bmN0aW9uKGNhKXtcbiAgICAgICAgICAgICAgICBjYS5zY29yZXMgPSBwYXJzZUludCh3KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGhlbHBlci5tYXhOdW1iZXIoKSA+PSBsZW5ndGg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuLyrliKTmlq3mmK/lkKbkupTlkIwqL1xuS1FDYXJkLmlzV3VUb25nID0gZnVuY3Rpb24oY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gNTtcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMucmVkdWNlKGZ1bmN0aW9uIChwb2ludCwgY2FyZCkge1xuICAgICAgICBpZiAocG9pbnQgPT0gY2FyZC5wb2ludCkge1xuICAgICAgICAgICAgcmV0dXJuIHBvaW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9LCBjYXJkc1swXS5wb2ludCk7XG5cbiAgICByZXR1cm4gcmVzdWx0ICE9IC0xO1xufTtcbi8qIyMjIyMqL1xuXG4vLyDmmK/lkKbmmK8g4oCc6JGr6Iqm4oCdXG4vLyDkuInlvKDnm7jlkIwgKyDkuIDlr7lcbktRQ2FyZC5jb250YWluSHVMdSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSA1O1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoS1FDYXJkLmZpbmRIdUx1KGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvL2xldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIC8vdmFyIHBvaW50TnVtYmVycyA9IFtdO1xuICAgIC8vdmFyIGluZGV4ID0gMDtcbiAgICAvL2ZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgcG9pbnROdW1iZXJzW2luZGV4XSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXTtcbiAgICAvLyAgICBpbmRleCA9IGluZGV4ICsgMTtcbiAgICAvL31cbiAgICAvL3ZhciBoPVtdO1xuICAgIC8vdmFyIGgxPVtdO1xuICAgIC8vZm9yKHZhciBpIGluIHBvaW50TnVtYmVycyl7XG4gICAgLy8gICAgdmFyIHM9cG9pbnROdW1iZXJzW2ldO1xuICAgIC8vICAgIGlmKHMgPT0gMyl7XG4gICAgLy8gICAgICAgIGgucHVzaChzKVxuICAgIC8vICAgIH1cbiAgICAvLyAgICBlbHNlIGlmKHM9PTQpe1xuICAgIC8vICAgICAgICBoMS5wdXNoKHMpXG4gICAgLy8gICAgfVxuICAgIC8vXG4gICAgLy99XG4gICAgLy9cbiAgICAvL2lmICgocG9pbnROdW1iZXJzLmluZGV4T2YoMykgIT0gLTEpICYmIChwb2ludE51bWJlcnMuaW5kZXhPZigyKSAhPSAtMSlcbiAgICAvLyB8fCBoLmxlbmd0aCA+IDEgfHwgaDEubGVuZ3RoID4gMSB8fChwb2ludE51bWJlcnMuaW5kZXhPZig0KSAhPSAtMSlcbiAgICAvLyAmJiAocG9pbnROdW1iZXJzLmluZGV4T2YoMikgIT0gLTEpKSB7XG4gICAgLy8gICAgcmV0dXJuIHRydWU7XG4gICAgLy99XG5cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG4vLyDliKTmlq3mmK/lkKbmmK8g6JGr6IqmXG5LUUNhcmQuaXNIdUx1ID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCAhPSA1KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcG9pbnRzID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLnBvaW50O1xuICAgIH0pLnNvcnQoZnVuY3Rpb24gKHAxLCBwMikge1xuICAgICAgICByZXR1cm4gcDEgLSBwMjtcbiAgICB9KTtcblxuICAgIHZhciBwMSA9IHBvaW50c1swXTtcbiAgICB2YXIgcDIgPSBwMTtcbiAgICB2YXIgbnVtYmVyUDEgPSAwO1xuICAgIHZhciBudW1iZXJQMiA9IDA7XG5cbiAgICBwb2ludHMuZm9yRWFjaChmdW5jdGlvbiAocG9pbnQpIHtcbiAgICAgICAgaWYgKHBvaW50ICE9IHAxICYmIHBvaW50ICE9IHAyKSB7XG4gICAgICAgICAgICBwMiA9IHBvaW50O1xuICAgICAgICAgICAgbnVtYmVyUDIgPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgbnVtYmVyUDEgPSBudW1iZXJQMSArICgocG9pbnQgPT0gcDEpID8gMSA6IDApO1xuICAgICAgICBudW1iZXJQMiA9IG51bWJlclAyICsgKChwb2ludCA9PSBwMikgPyAxIDogMCk7XG4gICAgfSk7XG5cbiAgICBsZXQgbWF4TnVtYmVyID0gTWF0aC5tYXgobnVtYmVyUDEpO1xuICAgIGxldCBtaW5OdW1iZXIgPSBNYXRoLm1pbihudW1iZXJQMik7XG5cbiAgICByZXR1cm4gKG1pbk51bWJlciA9PSAyKSAmJiAobWF4TnVtYmVyID09IDMpO1xufTtcblxuLy8g5piv5ZCm5YyF5ZCr5pyJIOKAnOS4ieadoeKAnVxuS1FDYXJkLmNvbnRhaW5TYW5UaWFvID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdmFyIGxlbmd0aCA9IDM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vaWYgKEtRQ2FyZC5maW5kU2FuVGlhbyhjYXJkcykubGVuZ3RoID4gMCkge1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgbGVuZ3RoID0gbGVuZ3RoLWNhcmQyMC5sZW5ndGg7XG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgZm9yKHZhciB3IGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgICB2YXIgbWF4TnVtYmVyID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3ddO1xuICAgICAgICBpZihtYXhOdW1iZXIgPj0gbGVuZ3RoKXtcbiAgICAgICAgICAgIGNhcmQyMC5mb3JFYWNoKGZ1bmN0aW9uKGNhKXtcbiAgICAgICAgICAgICAgICBjYS5zY29yZXMgPSBwYXJzZUludCh3KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy9mb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIC8vICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gPj0gbGVuZ3RoKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAvL1xuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluR3VpUGFpKGNhcmRzLDMpO1xufTtcblxuLy8g5piv5ZCm5pivIOKAnOS4ieadoeKAnVxuS1FDYXJkLmlzU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLnJlZHVjZShmdW5jdGlvbiAocG9pbnQsIGNhcmQpIHtcbiAgICAgICAgaWYgKGNhcmQucG9pbnQgPT0gcG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2ludDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9LCBjYXJkc1swXS5wb2ludCk7XG5cbiAgICByZXR1cm4gcmVzdWx0ICE9IC0xO1xufTtcblxuLy8g5piv5ZCm5YyF5ZCr5pyJIO+8muS4pOWvuVxuS1FDYXJkLmNvbnRhaW5MaWFEdWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgNCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChLUUNhcmQuZmluZExpYUR1aShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy92YXIgbnVtYmVyT2ZEdWlaaSA9IDA7XG4gICAgLy9sZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICAvL2ZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgaWYgKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXSA9PSAyKSB7XG4gICAgLy8gICAgICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMTtcbiAgICAvLyAgICAgICAgaWYgKG51bWJlck9mRHVpWmkgPT0gMikge1xuICAgIC8vICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgICAgIH1cbiAgICAvLyAgICB9XG4gICAgLy99XG5cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG4vLyDmmK/lkKbmmK8g5Lik5a+5XG5LUUNhcmQuaXNMaWFEdWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IDQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIGZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gIT0gMikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcblxuLy8g5piv5LiN5piv5a+55a2QXG5LUUNhcmQuaXNEdWlaaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gMikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGNhcmQxID0gY2FyZHNbMF07XG4gICAgbGV0IGNhcmQyID0gY2FyZHNbMV07XG5cbiAgICByZXR1cm4gY2FyZDEucG9pbnQgPT0gY2FyZDIucG9pbnQ7XG59O1xuXG4vLyDmmK/lkKbljIXlkKvlr7nlrZBcbktRQ2FyZC5jb250YWluRHVpWmkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gMjtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy9pZiAoS1FDYXJkLmZpbmREdWlaaShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgbGVuZ3RoID0gbGVuZ3RoLWNhcmQyMC5sZW5ndGg7XG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgLy9mb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIC8vICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gPj0gbGVuZ3RoKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICBmb3IodmFyIHcgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIHZhciBtYXhOdW1iZXIgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbd107XG4gICAgICAgIGlmKG1heE51bWJlciA+PSBsZW5ndGgpe1xuICAgICAgICAgICAgY2FyZDIwLmZvckVhY2goZnVuY3Rpb24oY2Epe1xuICAgICAgICAgICAgICAgIGNhLnNjb3JlcyA9IHBhcnNlSW50KHcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gICAgLy9yZXR1cm4gS1FDYXJkLmNvbnRhaW5HdWlQYWkoY2FyZHMsMik7XG59O1xuXG5LUUNhcmQuY29udGFpbkd1aVBhaSA9IGZ1bmN0aW9uIChjYXJkcyAsIGxlbmd0aCkge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAgIGxldCBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICB2YXIgbWF4TnVtYmVyID0gKGhlbHBlci5tYXhOdW1iZXIoKSArIGNhcmQyMC5sZW5ndGgpO1xuICAgIHJldHVybiBtYXhOdW1iZXIgPj0gbGVuZ3RoO1xufTtcbi8qIyMjIyMqL1xuLy8g5piv5ZCm5piv54m55q6K54mMXG5LUUNhcmQuaXNUZVNodVBhaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCAxMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIEtRQ2FyZC5pc1FpbmdMb25nKGNhcmRzKVxuICAgICAgICB8fCBLUUNhcmQuaXNZaVRpYW9Mb25nKGNhcmRzKVxuICAgICAgICB8fCBLUUNhcmQuaXNMaXVEdWlCYW4oY2FyZHMpXG4gICAgICAgIHx8IEtRQ2FyZC5pc1NhblNodW5aaShjYXJkcylcbiAgICAgICAgfHwgS1FDYXJkLmlzU2FuVG9uZ0h1YShjYXJkcylcbiAgICAgICAgLyp8fCBLUUNhcmQuaXNTYW5Ub25nSHVhU2h1bihjYXJkcylcbiAgICAgICAgIHx8IEtRQ2FyZC5pc1NhbkZlblRpYW5YaWEoY2FyZHMpXG4gICAgICAgICB8fCBLUUNhcmQuaXNTaVRhb1NhblRpYW8oY2FyZHMpXG5cbiAgICAgICAgIHx8IEtRQ2FyZC5pc1d1RHVpU2FuVGlhbyhjYXJkcylcbiAgICAgICAgIHx8IEtRQ2FyZC5pc0NvdVlpU2UoY2FyZHMpKi87XG59O1xuXG4vLyDlsIbniYzkuK3nmoQgMSDlj5jljJbkuLogQe+8iDE0KVxuS1FDYXJkLl9jb252ZXJ0T25lVG9BID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmZpbmQoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgICAgIHJldHVybiBjYXJkLnBvaW50ID09IDE7XG4gICAgICAgIH0pID09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gY2FyZHM7XG4gICAgfVxuICAgIGxldCByZXN1bHQgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgaWYgKGNhcmQucG9pbnQgPT0gMSkge1xuICAgICAgICAgICAgbGV0IG5ld0NhcmQgPSBuZXcgS1FDYXJkKDE0LCBjYXJkLmNvbG9yKTtcbiAgICAgICAgICAgIHJldHVybiBuZXdDYXJkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYXJkO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbktRQ2FyZC5fY29udmVydE9uZVRvQTEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMuZmluZChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gMTtcbiAgICAgICAgfSkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBjYXJkcztcbiAgICB9XG4gICAgdmFyIG51bSA9IDA7XG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICBpZiAoY2FyZC5wb2ludCA9PSAxICYmIG51bSA9PSAwKSB7XG4gICAgICAgICAgICBudW0rKztcbiAgICAgICAgICAgIGxldCBuZXdDYXJkID0gbmV3IEtRQ2FyZCgxNCwgY2FyZC5jb2xvcik7XG4gICAgICAgICAgICByZXR1cm4gbmV3Q2FyZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FyZDtcbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG4vLyBLUUNhcmQg55qE5o6S5bqP5pa55rOVXG5LUUNhcmQuc29ydEJ5UG9pbnQgPSBmdW5jdGlvbiAoY2FyZDEsIGNhcmQyKSB7XG4gICAgbGV0IHJlc3VsdCA9IE51bWJlcihjYXJkMS5wb2ludCkgLSBOdW1iZXIoY2FyZDIucG9pbnQpXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbktRQ2FyZC5zb3J0QnlDb2xvciA9IGZ1bmN0aW9uIChjYXJkMSwgY2FyZDIsIHBvaW50QXNjID0gdHJ1ZSkge1xuICAgIGlmIChjYXJkMi5jb2xvciA9PSBjYXJkMS5jb2xvcikge1xuICAgICAgICByZXR1cm4gKGNhcmQxLnBvaW50IC0gY2FyZDIucG9pbnQpICogKHBvaW50QXNjID8gMSA6IC0xKTtcbiAgICB9XG4gICAgcmV0dXJuIGNhcmQyLmNvbG9yIC0gY2FyZDEuY29sb3I7XG59XG5cbktRQ2FyZC5zb3J0ID0gZnVuY3Rpb24gKGNhcmQxLCBjYXJkMiwgYXNjID0gdHJ1ZSwgQWlzTWF4ID0gdHJ1ZSkge1xuICAgIGxldCByZXN1bHQgPSAxO1xuICAgIGlmIChjYXJkMS5wb2ludCA9PSBjYXJkMi5wb2ludCkge1xuICAgICAgICByZXN1bHQgPSBjYXJkMS5jb2xvciAtIGNhcmQyLmNvbG9yO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBwb2ludDEgPSBjYXJkMS5wb2ludDtcbiAgICAgICAgdmFyIHBvaW50MiA9IGNhcmQyLnBvaW50O1xuICAgICAgICBpZiAoQWlzTWF4ICYmIHBvaW50MSA9PSAxKSB7XG4gICAgICAgICAgICBwb2ludDEgPSAxNDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChBaXNNYXggJiYgcG9pbnQyID09IDEpIHtcbiAgICAgICAgICAgIHBvaW50MiA9IDE0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzdWx0ID0gcG9pbnQxIC0gcG9pbnQyO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQgKiAoYXNjID8gMSA6IC0xKTtcbn07XG5cbi8v6L2s5Li65a6i5oi356uv55qE54mMXG5LUUNhcmQuX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgLy8gW3tcInN1aXRcIjpcInNcIixcIm51bWJlclwiOjEwfV1cbiAgICBsZXQgc3VpdENvbG9yTWFwID1bJycsJ2QnLCdjJywnaCcsJ3MnXTtcbiAgICByZXR1cm4gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHZhciBjYXJkTnVtYmVyID0gY2FyZC5wb2ludDtcbiAgICAgICAgbGV0IGNvbG9yID0gc3VpdENvbG9yTWFwW2NhcmQuY29sb3JdO1xuICAgICAgICBsZXQgbnVtYmVyID0gTWF0aC5tYXgoTWF0aC5taW4oY2FyZE51bWJlciwgMTMpLCAxKTtcbiAgICAgICAgcmV0dXJuIHtudW1iZXI6bnVtYmVyLHN1aXQ6Y29sb3J9O1xuICAgIH0pO1xufTsiLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5cbmxldCBLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyID0ge1xuICAgIHN0YXJ0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2RpZFN0YXJ0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZGlkU3RhcnQgPSB0cnVlO1xuXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVGb3JjZUV4aXQsIHRoaXMuX2ZvcmNlRXhpdEFwcCwgdGhpcyk7XG4gICAgfSxcblxuICAgIF9mb3JjZUV4aXRBcHA6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIEtRTmF0aXZlSW52b2tlLmZvcmNlRXhpdEFwcCgpO1xuICAgIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEtRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXI7IiwibGV0IEtRR2xvYmFsRXZlbnQgPSB7XG4gICAgX2hhbmRsZXM6IHt9LFxuICAgIC8v5Y+R6YCB5LqL5Lu2XG4gICAgZW1pdDogZnVuY3Rpb24gKGV2ZW50TmFtZSwgZGF0YSA9IHt9KSB7XG4gICAgICAgIGlmICh0eXBlb2YgZGF0YSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgZGF0YSA9IHsnZGF0YSc6IGRhdGF9O1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJldHVybnMgPSBbXSAvL+i/lOWbnuWAvFxuICAgICAgICBkYXRhLmV2ZW50TmFtZSA9IGV2ZW50TmFtZS8v5L+d5a2Y5LiA5LiL5LqL5Lu25ZCN5a2XXG5cbiAgICAgICAgZm9yICggdmFyIGZpbmRFdmVuTmFtZSBpbiB0aGlzLl9oYW5kbGVzKXtcbiAgICAgICAgICAgIGlmIChmaW5kRXZlbk5hbWUgPT0gZXZlbnROYW1lKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9oYW5kbGVzW2ZpbmRFdmVuTmFtZV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJldHVyblZhbHVlID0gdGhpcy5faGFuZGxlc1tmaW5kRXZlbk5hbWVdW2ldKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybnMucHVzaChyZXR1cm5WYWx1ZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmV0dXJuc1xuICAgIH0sXG4gICAgLy/mt7vliqDmma7pgJrkuovku7ZcbiAgICBvbjogZnVuY3Rpb24gKGV2ZW50TmFtZSwgY2FsbGJhY2ssIHRhcmdldCkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygn5pS25Yiw5LqL5Lu2JywgZXZlbnROYW1lKTtcbiAgICAgICAgdGhpcy5faGFuZGxlc1tldmVudE5hbWVdID0gdGhpcy5faGFuZGxlc1tldmVudE5hbWVdIHx8IFtdXG5cbiAgICAgICAgdGhpcy5faGFuZGxlc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2suYmluZCh0YXJnZXQpKVxuICAgICAgICBjYWxsYmFjay5fY2FsbGVyID0gdGFyZ2V0O1xuICAgIH0sXG5cbiAgICAvL+mAmui/h+S6i+S7tuWQjeenu+mZpOS4gOS4quebkeWQrOWZqFxuICAgIG9mZjogZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2hhbmRsZXNbZXZlbnROYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlc1tldmVudE5hbWVdW2ldID0gbnVsbFxuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIOenu+WKqOS4gOS4qiB0YXJnZXQg5LiK5omA5pyJ55qE55uR5ZCsXG4gICAgb2ZmVGFyZ2V0OiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICBmb3IgKHZhciBuYW1lIGluIHRoaXMuX2hhbmRsZXMpIHtcbiAgICAgICAgdmFyIGV2ZW50SGFuZGxlcnMgPSB0aGlzLl9oYW5kbGVzW25hbWVdO1xuICAgICAgICB2YXIgaW5kZXhzID0gZXZlbnRIYW5kbGVycy5maWx0ZXIoZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrLl9jYWxsZXIgPSB0YXJnZXQ7XG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoY2FsbGJhY2ssIGluZGV4KSB7XG4gICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgaW5kZXhPZmZzZXQgPSAwO1xuICAgICAgICBpbmRleHMuZm9yRWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICBldmVudEhhbmRsZXJzLnNwbGljZShpbmRleCArIGluZGV4T2Zmc2V0LCAxKTtcbiAgICAgICAgICBpbmRleE9mZnNldCA9IGluZGV4T2Zmc2V0ICsgMTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gS1FHbG9iYWxFdmVudDtcbiIsImxldCBLUU5hdGl2ZUludm9rZSA9IHtcbiAgSU9TQ2xhc3NOYW1lOiBcIkFwcENvbnRyb2xsZXJcIixcbiAgQU5EUklPRENsYXNzTmFtZTogXCJjb20vZ29uZ3BhL3Nzei9BcHBBY3Rpdml0eVwiLFxuXG4gIGlzTmF0aXZlSU9TOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHBsYXRmb3JtID0gY2Muc3lzLnBsYXRmb3JtO1xuICAgIGlmICgocGxhdGZvcm0gPT0gY2Muc3lzLklQSE9ORSkgfHwgKHBsYXRmb3JtID09IGNjLnN5cy5JUEFEKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcblxuICBpc05hdGl2ZUFuZHJvaWQ6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgcGxhdGZvcm0gPSBjYy5zeXMucGxhdGZvcm07XG4gICAgaWYgKHBsYXRmb3JtID09IGNjLnN5cy5BTkRST0lEKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIGlzTmF0aXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNjLnN5cy5pc05hdGl2ZSA9PSB0cnVlO1xuICB9XG59O1xuXG4vLyBNQVJLOiDlj6/osIPnlKjnmoTmnKzlnLDmlrnms5Vcbi8qKlxuICog5b6u5L+h55m75b2VXG4gKi9cbktRTmF0aXZlSW52b2tlLnd4TG9naW4gPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hMb2dpblwiKTsgLy9JT1NcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hMb2dpblwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIOWIhuS6q+Wkp+WOheS/oeaBr+WIsOW+ruS/oeWlveWPi1xuICogXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlSGFsbFRvV2VDaGF0RnJpZW5kID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2hhcmVIYWxsRnJpZW5kXCIsICk7XG4gIH0gZWxzZSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbEZyaWVuZFwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIOWIhuS6q+Wkp+WOheS/oeaBr+WIsOaci+WPi+WciFxuICogXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlSGFsbFRvV2VDaGF0VGltZWxpbmUgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCApO1xuICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuLyoqXG4gKiDlvLrliLbpgIDlh7ogQVBQXG4gKiBcbiAqL1xuS1FOYXRpdmVJbnZva2UuZm9yY2VFeGl0QXBwID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcImV4aXRBcHBcIiwgKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImV4aXRBcHBcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cblxuLyoqXG4gKiDkuIvovb3mlrDniYjmnKxcbiAqIFxuICogQHBhcmFtIHtTdHJpbmd9IGlvc1VybCAgICAgIGlPUyDniYjmnKzlnLDlnYBcbiAqIEBwYXJhbSB7U3RyaW5nfSBhbmRyb2lkVXJsICDlronljZPniYjmnKzlnLDlnYBcbiAqL1xuS1FOYXRpdmVJbnZva2UuZG93bmxvYWROZXdWZXJzaW9uID0gZnVuY3Rpb24gKGlvc1VybCwgYW5kcm9pZFVybCkge1xuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcImRvd25sb2FkTmV3VmVyc2lvbjpcIiwgaW9zVXJsKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImRvd25sb2FkTmV3VmVyc2lvblwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCBhbmRyb2lkVXJsKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIOWIhuS6q+aIv+mXtOe7meW+ruS/oeWlveWPi1xuICogXG4gKiBAcGFyYW0ge1N0cmluZ30gcm9vbUlkICAgICAgICAg5oi/6Ze0IGlkIOS/oeaBr1xuICogQHBhcmFtIHtTdHJpbmd9IGRlc2NyaXB0aW9uICAgIOaWh+acrOaPj+i/sFxuICovXG5LUU5hdGl2ZUludm9rZS5zaGFyZVJvb21Ub1dlQ2hhdEZyaWVuZCA9IGZ1bmN0aW9uIChyb29tSWQsIGRlc2NyaXB0aW9uKSB7XG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZDpkZXNjcmlwdGlvbjpcIiwgaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLCBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICB9XG59O1xuXG4vKipcbiAqIOWIhuS6q+aIv+mXtOWIsOW+ruS/oeaci+WPi+WciFxuICogXG4gKiBAcGFyYW0ge1N0cmluZ30gcm9vbUlkICAgICAgICAg5oi/6Ze0IGlkIOS/oeaBr1xuICogQHBhcmFtIHtTdHJpbmd9IGRlc2NyaXB0aW9uICAgIOaWh+acrOaPj+i/sFxuICovXG5LUU5hdGl2ZUludm9rZS5zaGFyZVJvb21Ub1dlQ2hhdFRpbWVsaW5lID0gZnVuY3Rpb24gKHJvb21JZCwgZGVzY3JpcHRpb24pIHtcbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNoYXJlOmRlc2NyaXB0aW9uOlwiLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XG4gIH1cbn07XG5cbi8qKlxuICog5YiG5Lqr5bGP5bmV5oiq5Zu+5Yiw5b6u5L+h5aW95Y+LXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlU2NyZWVuVG9XZUNoYXRGcmllbmQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZUZyaWVuZFwiLCApO1xuICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZUZyaWVuZFwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuLyoqXG4gKiDliIbkuqvlsY/luZXmiKrlm77liLDlvq7kv6HmnIvlj4vlnIhcbiAqL1xuS1FOYXRpdmVJbnZva2Uuc2hhcmVTY3JlZW5Ub1dlQ2hhdFRpbWVsaW5lID0gZnVuY3Rpb24gKCkge1xuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVcIiwgKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cbi8qKlxuICog5byA5aeL5b2V6Z+zXG4gKi9cbktRTmF0aXZlSW52b2tlLnN0YXJ0UmVjb3JkID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInJlY29yZFwiKTtcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJyZWNvcmRcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cbi8qKlxuICog57uT5p2f5b2V6Z+zXG4gKi9cbktRTmF0aXZlSW52b2tlLmVuZFJlY29yZCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJlbmRSZWNvcmRcIik7XG4gIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZW5kUmVjb3JkXCIsIFwiKClWXCIpO1xuICB9XG59O1xuXG5LUU5hdGl2ZUludm9rZS5zY3JlZW5zaG90U2hhcmUgPSBmdW5jdGlvbihzdHJpbmdzID0gJ3NoYXJlSU1HJykge1xuICAgICAgICBpZih0aGlzLl9pc0NhcHR1cmluZyl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faXNDYXB0dXJpbmcgPSB0cnVlO1xuICAgICAgICB2YXIgc2l6ZSA9IGNjLmRpcmVjdG9yLmdldFdpblNpemUoKTtcbiAgICAgICAgdmFyIGZpbGVOYW1lID0gXCJyZXN1bHRfc2hhcmUuanBnXCI7XG4gICAgICAgIHZhciBmdWxsUGF0aCA9IGpzYi5maWxlVXRpbHMuZ2V0V3JpdGFibGVQYXRoKCkgKyBmaWxlTmFtZTtcbiAgICAgICAgaWYoanNiLmZpbGVVdGlscy5pc0ZpbGVFeGlzdChmdWxsUGF0aCkpe1xuICAgICAgICAgICAganNiLmZpbGVVdGlscy5yZW1vdmVGaWxlKGZ1bGxQYXRoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGV4dHVyZSA9IG5ldyBjYy5SZW5kZXJUZXh0dXJlKE1hdGguZmxvb3Ioc2l6ZS53aWR0aCksIE1hdGguZmxvb3Ioc2l6ZS5oZWlnaHQpLGNjLklNQUdFX0ZPUk1BVF9QTkcsZ2wuREVQVEgyNF9TVEVOQ0lMOF9PRVMpO1xuICAgICAgICB0ZXh0dXJlLnNldFBvc2l0aW9uKGNjLnAoc2l6ZS53aWR0aC8yLCBzaXplLmhlaWdodC8yKSk7XG4gICAgICAgIHRleHR1cmUuYmVnaW4oKTtcbiAgICAgICAgY2MuZGlyZWN0b3IuZ2V0UnVubmluZ1NjZW5lKCkudmlzaXQoKTtcbiAgICAgICAgdGV4dHVyZS5lbmQoKTtcbiAgICAgICAgdGV4dHVyZS5zYXZlVG9GaWxlKGZpbGVOYW1lLCBjYy5JTUFHRV9GT1JNQVRfUE5HKTtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciB0cnlUaW1lcyA9IDA7XG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBpZihqc2IuZmlsZVV0aWxzLmlzRmlsZUV4aXN0KGZ1bGxQYXRoKSl7XG5cbiAgICAgICAgICAgICAgICBpZihjYy5zeXMub3MgPT0gY2Muc3lzLk9TX0FORFJPSUQpe1xuICAgICAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKHNlbGYuQU5EUklPRENsYXNzTmFtZSwgc3RyaW5ncywgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIixmdWxsUGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYuX2lzQ2FwdHVyaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHRyeVRpbWVzKys7XG4gICAgICAgICAgICAgICAgaWYodHJ5VGltZXMgPiAxMCl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidGltZSBvdXQuLi5cIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmbiw1MCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2V0VGltZW91dChmbiw1MCk7XG59XG5cblxuLyoqXG4gKiDmkq3mlL7nvZHnu5zor63pn7NcbiAqIFxuICogQHBhcmFtIHtTdHJpbmd9IGF1ZGlvVXJsIOivremfs+WcsOWdgFxuICovXG5LUU5hdGl2ZUludm9rZS5wbGF5QXVkaW9XaXRoVXJsID0gZnVuY3Rpb24gKGF1ZGlvVXJsKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwicGxheVVybDpcIiwgYXVkaW9VcmwpO1xuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJwbGF5VXJsXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGF1ZGlvVXJsKTtcbiAgfVxufTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gS1FOYXRpdmVJbnZva2U7IiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBDaGF0TWVzc2FnZSA9IHJlcXVpcmUoJ0NoYXRNZXNzYWdlJyk7XG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcblxuLy8g55So5p2l5Y+R6YCB5raI5oGv55qEIGNvbXBvbmVudFxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy9icU5vZGU6Y2MuTm9kZSxcbiAgICAgICAgLy9icU5vZGUxOmNjLk5vZGUsXG4gICAgICAgIC8vYnRuTGFuZ3VhZ2VOb2RlOmNjLk5vZGUsXG4gICAgICAgIC8vYnRuTGFuZ3VhZ2VOb2RlMTpjYy5Ob2RlLFxuICAgICAgICAvL2J0bkNoYXJ0Tm9kZTpjYy5Ob2RlLFxuICAgICAgICAvL2J0bkNoYXJ0Tm9kZTE6Y2MuTm9kZSxcbiAgICAgICAgdGV4dFNjcm9sbFZpZXc6Y2MuTm9kZSxcbiAgICAgICAgaW1hZ2VDb250ZW50Tm9kZTpjYy5Ob2RlLFxuXG4gICAgICAgIGVkaXRCb3g6IGNjLkVkaXRCb3gsXG5cbiAgICAgICAgdGV4dFJlY29yZFNjcm9sbFZpZXc6IGNjLlNjcm9sbFZpZXcsXG4gICAgICAgIHRleHRSZWNvcmRMYXlvdXQ6IGNjLkxheW91dCxcblxuICAgICAgICB0ZXh0UHJlZmFiOmNjLlByZWZhYixcbiAgICAgICAgY2hhdFRleHRSZWNvcmRQcmVmYWI6IGNjLlByZWZhYixcbiAgICAgICAgZW1vamlQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICAvLyBpbWFnZVByZWZhYjpjYy5QcmVmYWIsXG5cbiAgICAgICAgYmlhb3Fpbmc6IFtjYy5Ob2RlXSwgICAgLy8gW+S6rueahOiDjOaZrywg5pqX55qE6IOM5pmvXSAgIOW/q+aNt+ivrVxuICAgICAgICBrdWFpamlleXU6IFtjYy5Ob2RlXSwgICAvLyBb5Lqu55qE6IOM5pmvLCDmmpfnmoTog4zmma9dICAg6KGo5oOFXG4gICAgICAgIGNvbnRlbnQ6W2NjLk5vZGVdLCAgICAgIC8vIFvlv6vmjbfor60sIOihqOaDhV0gICBcbiAgICAgICAgaW5wdXROb2RlOmNjLk5vZGUsXG4gICAgICAgIGVtb2ppOltjYy5Ob2RlXSxcbiAgICAgICAgX3VzZXJJZDogbnVsbCxcblxuICAgICAgICBfcGxheWVySW5mb3M6IG51bGwsICAgICAgICAvLyDorrDlvZXnlKjmiLfkv6Hmga9cbiAgICAgICAgX2NoYXRUZXh0TWVzc2FnZVJlY29yZHM6IG51bGwsIC8vIOiBiuWkqeaWh+acrOa2iOaBr+iusOW9lVxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IFtdO1xuICAgICAgICB0aGlzLnRleHRDb250ZW50ID0gdGhpcy50ZXh0U2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcbiAgICAgICAgLy8gdGhpcy5pbWFnZUNvbnRlbnQgPSB0aGlzLmltYWdlU2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgdGV4dERhdGEgPSBBdWRpb01hbmFnZXIuaW5zdGFuY2UuY2hhdFRleHRzKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGV4dERhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gY2MuaW5zdGFudGlhdGUodGhpcy50ZXh0UHJlZmFiKTtcbiAgICAgICAgICAgIGl0ZW0uZ2V0Q29tcG9uZW50KCdjZWxsVGV4dCcpLnNldFRleHQodGV4dERhdGFbaV0pO1xuICAgICAgICAgICAgaXRlbS5nZXRDb21wb25lbnQoJ2NlbGxUZXh0Jykub25TZWxlY3RBY3Rpb24gPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5vblRleHRDbGlja0FjdGlvbih0ZXh0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnRleHRDb250ZW50LmggPSAxMDAwO1xuICAgICAgICAgICAgdGhpcy50ZXh0Q29udGVudC5hZGRDaGlsZChpdGVtKTtcbiAgICAgICAgfVxuXG4gICAgfSxcblxuXG4gICAgY2xpY2tLdWFpSmllWXUgOmZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMua3VhaWppZXl1WzBdLmFjdGl2ZSA9IHRydWU7ICAgIC8vIOW/q+aNt+ivrSDog4zmma9cbiAgICAgICAgdGhpcy5rdWFpamlleXVbMV0uYWN0aXZlID0gZmFsc2U7ICAgLy8g5b+r5o236K+tIOaMiemSrlxuICAgICAgICB0aGlzLmJpYW9xaW5nWzBdLmFjdGl2ZSA9IGZhbHNlOyAgICAvLyDog4zmma/ooajmg4VcbiAgICAgICAgdGhpcy5iaWFvcWluZ1sxXS5hY3RpdmUgPSB0cnVlOyAgICAgLy8g6KGo5oOF5oyJ6ZKuXG4gICAgICAgIHRoaXMuY29udGVudFswXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmNvbnRlbnRbMV0uYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcbiAgICBjbGlja0JpYW9RaW5nIDpmdW5jdGlvbigpe1xuICAgICAgICB0aGlzLmJpYW9xaW5nWzBdLmFjdGl2ZSA9IHRydWU7ICAgICAvLyDog4zmma/ooajmg4VcbiAgICAgICAgdGhpcy5iaWFvcWluZ1sxXS5hY3RpdmUgPSBmYWxzZTsgICAgLy8g6KGo5oOF5oyJ6ZKuXG4gICAgICAgIHRoaXMua3VhaWppZXl1WzBdLmFjdGl2ZSA9IGZhbHNlOyAgIC8vIOW/q+aNt+ivrSDog4zmma9cbiAgICAgICAgdGhpcy5rdWFpamlleXVbMV0uYWN0aXZlID0gdHJ1ZSA7ICAgLy8g5b+r5o236K+tIOaMiemSrlxuICAgICAgICB0aGlzLmNvbnRlbnRbMF0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29udGVudFsxXS5hY3RpdmUgPSB0cnVlO1xuICAgIH0sXG4gICAgb25UZXh0Q2xpY2tBY3Rpb246ZnVuY3Rpb24odGV4dCA9IFwiXCIpIHtcbiAgICAgICAgdGhpcy5lZGl0Qm94LnN0cmluZyA9IFwiXCI7XG4gICAgICAgIHRoaXMuc2VuZFRleHQodGV4dCk7XG4gICAgfSxcblxuICAgIGNsaWNrRW1vamk6IGZ1bmN0aW9uIChldmVudCwgZW1vamlOYW1lKSB7XG4gICAgICAgIGxldCBzdHJpbmcgPSB0aGlzLmVkaXRCb3guc3RyaW5nO1xuICAgICAgICB0aGlzLmVkaXRCb3guc3RyaW5nID0gc3RyaW5nICsgXCI8XCIgKyBlbW9qaU5hbWUgKyBcIj5cIjtcbiAgICAgICAgdGhpcy5zZW5kRW1vamkoZW1vamlOYW1lKTtcbiAgICB9LFxuXG4gICAgY2xpY2tTZW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCBzdHJpbmcgPSB0aGlzLmVkaXRCb3guc3RyaW5nIHx8IFwiXCI7XG4gICAgICAgIGlmIChzdHJpbmcubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVkaXRCb3guc3RyaW5nID0gXCJcIjtcbiAgICAgICAgdGhpcy5zZW5kVGV4dChzdHJpbmcpO1xuICAgIH0sXG5cbiAgICBzZW5kRW1vamkgOmZ1bmN0aW9uKGVtb2ppTmFtZSl7XG4gICAgICAgIGlmKGVtb2ppTmFtZS5sZW5ndGggPT0wKXtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIFNvY2tldC5zZW5kRW1vamkodGhpcy5fdXNlcklkLCBlbW9qaU5hbWUpO1xuICAgICAgICB0aGlzLmRpc21pc3MoKTtcbiAgICB9LFxuXG4gICAgc2VuZFRleHQ6IGZ1bmN0aW9uICh0ZXh0ID0gXCJcIikge1xuICAgICAgICBpZiAodGV4dC5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFNvY2tldC5zZW5kVGV4dCh0aGlzLl91c2VySWQsIHRleHQpO1xuICAgICAgICB0aGlzLmRpc21pc3MoKTtcbiAgICB9LFxuXG4gICAgZGlzbWlzczogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGJxQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmJxTm9kZTEuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUxLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuYnFOb2RlLmFjdGl2ZSA9IHRoaXMuYnRuTGFuZ3VhZ2VOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50ZXh0U2Nyb2xsVmlldy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pbWFnZUNvbnRlbnROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMudGV4dFJlY29yZFNjcm9sbFZpZXcubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgdGV4dEFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5icU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuTGFuZ3VhZ2VOb2RlLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJxTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZTEuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUxLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMudGV4dFNjcm9sbFZpZXcuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5pbWFnZUNvbnRlbnROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRleHRSZWNvcmRTY3JvbGxWaWV3Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGNoYXJ0QWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmJxTm9kZTEuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlMS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5icU5vZGUuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50ZXh0U2Nyb2xsVmlldy5hY3RpdmUgPSB0aGlzLmltYWdlQ29udGVudE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGV4dFJlY29yZFNjcm9sbFZpZXcubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBhZGRQbGF5ZXJJbmZvczogZnVuY3Rpb24gKHBsYXllckluZm9zKSB7XG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gdGhpcy5fcGxheWVySW5mb3MgfHwgW107XG5cbiAgICAgICAgcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbiAodXNlckluZm8pIHtcbiAgICAgICAgICAgIGxldCBoYXZlVXNlckluZm8gPSB0aGlzLl9wbGF5ZXJJbmZvcy5maW5kKGZ1bmN0aW9uIChvd25Vc2VySW5mbykge1xuICAgICAgICAgICAgICAgIHJldHVybiBvd25Vc2VySW5mby5pZCA9PSB1c2VySW5mby5pZDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoaGF2ZVVzZXJJbmZvID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcy5wdXNoKHVzZXJJbmZvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgYWRkQ2hhdFRleHRNZXNzYWdlOiBmdW5jdGlvbiAodXNlcklkLCB0ZXh0KSB7XG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gdGhpcy5fcGxheWVySW5mb3MgfHwgW107XG5cbiAgICAgICAgdmFyIG5pY2tuYW1lID0gXCJbSUQ6XCIgKyB1c2VySWQgKyBcIuivtF3vvJpcIjtcbiAgICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy5fcGxheWVySW5mb3MuZmluZChmdW5jdGlvbiAodXNlckluZm8pIHtcbiAgICAgICAgICAgIHJldHVybiB1c2VySW5mby5pZCA9PSB1c2VySWQ7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh1c2VySW5mbykge1xuICAgICAgICAgICAgbmlja25hbWUgPSBcIltcIiArIHVzZXJJbmZvLm5pY2tuYW1lICsgXCLor7Rd77yaXCI7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3RyID0gbmlja25hbWUgKyB0ZXh0O1xuICAgICAgICBzdHIgPSBDaGF0TWVzc2FnZS5wYXJzZVN0cmluZyhzdHIpO1xuICAgICAgICB0aGlzLl9hZGRDaGF0VGV4dFRvUmVjb3JkKHN0cik7XG4gICAgfSxcblxuICAgIGFkZENoYXRFbW9qaU1lc3NhZ2U6ZnVuY3Rpb24odXNlcklkLGVtb2ppKXtcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSB0aGlzLl9wbGF5ZXJJbmZvcyB8fCBbXTtcblxuICAgICAgICB2YXIgbmlja25hbWUgPSBcIltJRDpcIiArIHVzZXJJZCArIFwi6K+0Xe+8mlwiO1xuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLl9wbGF5ZXJJbmZvcy5maW5kKGZ1bmN0aW9uICh1c2VySW5mbykge1xuICAgICAgICAgICAgcmV0dXJuIHVzZXJJbmZvLmlkID09IHVzZXJJZDtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh1c2VySW5mbykge1xuICAgICAgICAgICAgbmlja25hbWUgPSBcIltcIiArIHVzZXJJbmZvLm5pY2tuYW1lICsgXCLor7Rd77yaXCI7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBzdHIgPSBuaWNrbmFtZSArIGVtb2ppO1xuICAgICAgICBzdHIgPSBDaGF0TWVzc2FnZS5wYXJzZVN0cmluZyhzdHIpO1xuICAgICAgICB0aGlzLl9hZGRDaGF0RW1vamlUb1JlY29yZChlbW9qaSk7XG4gICAgICAgIC8vIGNjLmxvZyhlbW9qaSlcbiAgICAgICAgLy8gY2MubG9nKCctLS0xOTAnKVxuICAgIH0sXG5cbiAgICBfYWRkQ2hhdEVtb2ppVG9SZWNvcmQ6ZnVuY3Rpb24oZW1vamkpe1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2xvYWRFbW9qaUZyYW1lKGVtb2ppLGZ1bmN0aW9uKGZyYW1lKXtcbiAgICAgICAgICAgIC8vdmFyIGl0ZW0gID0gY2MuaW5zdGFudGlhdGUoc2VsZi5lbW9qaVByZWZhYik7XG4gICAgICAgICAgICAvL2NjLmxvZyhmcmFtZSlcbiAgICAgICAgICAgIC8vdmFyIGJ0blNwcml0ZXMgPSAgaXRlbS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgICAgIC8vYnRuU3ByaXRlcy5zcHJpdGVGcmFtZSA9IGZyYW1lO1xuICAgICAgICAgICAgLy9sZXQgY2hhdEVtb2ppUmVjb3JkID0gaXRlbS5nZXRDb21wb25lbnQoJ0NoYXRUZXh0UmVjb3JkJyk7XG4gICAgICAgICAgICAvL2NoYXRFbW9qaVJlY29yZC5zZXRFbW9qaShmcmFtZSk7XG4gICAgICAgICAgICBDaGF0TWVzc2FnZS5zZXRFbW9qaShmcmFtZSk7XG5cbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgX2xvYWRFbW9qaUZyYW1lIDpmdW5jdGlvbihFbW9qaW5hbWUgLGNhbGxiYWNrKXtcbiAgICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCIvdGV4dHVyZXMvY2hhdC9icVwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcbiAgICAgICAgICAgIGlmKGVycil7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhudWxsLCBlcnIpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZyYW1lID0gYXRsYXMuZ2V0U3ByaXRlRnJhbWUoRW1vamluYW1lKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKGZyYW1lKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKVxuXG4gICAgfSxcblxuICAgIF9hZGRDaGF0VGV4dFRvUmVjb3JkOiBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICB2YXIgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2hhdFRleHRSZWNvcmRQcmVmYWIpO1xuICAgICAgICBsZXQgY2hhdFRleHRSZWNvcmQgPSBpdGVtLmdldENvbXBvbmVudCgnQ2hhdFRleHRSZWNvcmQnKTtcbiAgICAgICAgY2hhdFRleHRSZWNvcmQuc2V0U3RyaW5nKHRleHQpO1xuXG4gICAgICAgIHRoaXMudGV4dFJlY29yZExheW91dC5ub2RlLmFkZENoaWxkKGl0ZW0pO1xuICAgICAgICB0aGlzLnRleHRSZWNvcmRTY3JvbGxWaWV3LnNjcm9sbFRvQm90dG9tKCk7XG4gICAgfSxcbn0pO1xuIiwidmFyIG1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIGV4aXRBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIGNjLmRpcmVjdG9yLmVuZCgpO1xuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJleGl0QXBwXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImV4aXRBcHBcIiwgXCIoKVZcIik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiLy8gbnVtYmVyLmtxX3RpbWVzKGYpICAg6LCD55So5aSa5qyhXG5cblxuaWYgKCFOdW1iZXIucHJvdG90eXBlLmtxX3RpbWVzKSB7XG4gICAgXG4gICAgLyoqXG4gICAgICog6LCD55So5LiA5Liq5pa55rOVIHRoaXMg5qyhXG4gICAgICogXG4gICAgICogQHBhcmFtICB7RnVuY3Rpb259IGYg6KaB6LCD55So55qE5pa55rOVXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAgIHRoaXNBcmcgICDlj6/pgInvvJsgZiDnmoQgdGhpc+WAvFxuICAgICAqL1xuICAgIE51bWJlci5wcm90b3R5cGUua3FfdGltZXMgPSBmdW5jdGlvbihmLCB0aGlzQXJnKSB7XG4gICAgICAgIGlmICghZikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzOyArK2kpIHtcbiAgICAgICAgICAgIGlmICh0aGlzQXJnKSB7XG4gICAgICAgICAgICAgICAgZi5hcHBseSh0aGlzQXJnLCBpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZihpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcblxuLy8g55So5LqO5Zue5pS+55qE57uE5Lu2XG5jb25zdCBQbGF5YmFjayA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICBfcGxheWJhY2tEYXRhczogbnVsbCwgICAvLyDnlKjkuo7lm57mlL7nmoTmlbDmja5cbiAgICAgIF9pc1BsYXliYWNraW5nOiBmYWxzZSxcbiAgICB9LFxuXG4gICAgc3RhdGljczoge1xuICAgICAgaW5zdGFuY2U6IG51bGwsXG4gICAgfSxcblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgUGxheWJhY2suaW5zdGFuY2UgPSB0aGlzO1xuICAgICAgY2MuZ2FtZS5hZGRQZXJzaXN0Um9vdE5vZGUodGhpcy5ub2RlKTtcbiAgICB9LFxuXG4gICAgLy8g6K6+572u5Zue5pS+5pWw5o2uXG4gICAgc2V0UGxheWJhY2tEYXRhczogZnVuY3Rpb24gKGRhdGFzKSB7XG4gICAgICB0aGlzLl9wbGF5YmFja0RhdGFzID0gZGF0YXM7XG4gICAgfSxcblxuICAgIC8vIOa4heepuuWbnuaUvuaVsOaNruOAguWQjOaXtuS8mua4heepuuWbnuaUvlxuICAgIHJlbW92ZVBsYXliYWNrRGF0YXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuc2V0UGxheWJhY2tEYXRhcyhudWxsKTtcbiAgICAgIHRoaXMuc3RvcFBsYXliYWNrKCk7XG4gICAgfSxcblxuICAgIC8vIOaYr+WQpuWMheWQq+WbnuaUvuaVsOaNrlxuICAgIGlzQ29udGFpblBsYXliYWNrRGF0YXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9wbGF5YmFja0RhdGFzICE9IG51bGw7XG4gICAgfSxcblxuICAgIC8vIOW8gOWni+WbnuaUvlxuICAgIHN0YXJ0UGxheWJhY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIOaooeaLnyBzb2NrZXQg5o6l5pS25Yiw5LqG5LqL5Lu25Y2z5Y+vXG4gICAgICAvL2NjLmxvZyhcIlBsYXliYWNrIOW8gOWni+WbnuaUvlwiKTtcblxuICAgICAgdGhpcy5faXNQbGF5YmFja2luZyA9IHRydWU7XG5cbiAgICAgIGlmICghdGhpcy5fcGxheWJhY2tEYXRhcykge1xuICAgICAgICBjYy5lcnJvcihcIuaDs+WbnuaUvu+8jOWNtOayoeacieWbnuaUvuaVsOaNrlwiKTtcbiAgICAgICAgdGhpcy5zdG9wUGxheWJhY2soKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9leGVjdXRlUGxheWJhY2soKTtcbiAgICB9LFxuXG4gICAgLy8g5YGc5q2i5Zue5pS+XG4gICAgc3RvcFBsYXliYWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9pc1BsYXliYWNraW5nID0gZmFsc2U7XG4gICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICB9LFxuXG4gICAgLy8g5piv5ZCm5q2j5Zyo5Zue5pS+XG4gICAgaXNQbGF5YmFja2luZzogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2lzUGxheWJhY2tpbmc7XG4gICAgfSxcblxuICAgIC8vIOaJp+ihjOecn+ato+eahOWbnuaUvuaTjeS9nFxuICAgIF9leGVjdXRlUGxheWJhY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBzdGFydFRpbWUgPSAxLjA7XG4gICAgICBsZXQgaW50ZXJ2YWwgPSAzLjA7XG4gICAgICBjYy5sb2codGhpcy5fcGxheWJhY2tEYXRhcyk7XG5cbiAgICAgIC8vIOWcqOafkOS6m+eJueauiuaDheWGteS4i1xuICAgICAgLy8g5Zue5pS+5pWw5o2u6YeM5Lya5YyF5ZCr5Lik5aWXIGdhbWVPdmVyIGFjdGlvblxuICAgICAgLy8g5omA5Lul6ZyA6KaB6L+H5ruk5o6J5YW25Lit5LiA5LiqXG4gICAgICB0aGlzLl9wbGF5YmFja0RhdGFzID0gdGhpcy5fcGxheWJhY2tEYXRhcy5maWx0ZXIoZnVuY3Rpb24oc3RyaW5nLCBpbmRleCkge1xuICAgICAgICBpZiAoaW5kZXggPT0gdGhpcy5fcGxheWJhY2tEYXRhcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKHN0cmluZy5pbmRleE9mKCdcImFjdGlvblwiOlwiZ2FtZU92ZXInKSA9PSAtMSk7XG4gICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICB0aGlzLl9wbGF5YmFja0RhdGFzLmZvckVhY2goZnVuY3Rpb24gKGRhdGEsIGluZGV4KSB7XG4gICAgICAgIHZhciBkZWxheSA9IHN0YXJ0VGltZSArIGluZGV4ICogaW50ZXJ2YWw7XG4gICAgICAgIGlmIChpbmRleCA9PSB0aGlzLl9wbGF5YmFja0RhdGFzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAvLyDlpoLmnpzmmK/mnIDlkI7kuIDkuKrvvIzliJnlupTor6Xlj6rpl7TpmpTkuIDnp5JcbiAgICAgICAgICBkZWxheSA9IHN0YXJ0VGltZSArIChpbmRleCAtIDEpICogaW50ZXJ2YWwgKyAxO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNjLmxvZyhcIuWbnuaUvuW8gOWni+aooeaLnyBTb2NrZXQg5o6l5pS25Yiw5pyN5Yqh5Zmo5raI5oGvLCBcIiwgaW5kZXgpO1xuICAgICAgICAgIFNvY2tldC5pbnN0YW5jZS5fZGlzcGF0Y2hSZXNwb25zZShkYXRhKTtcbiAgICAgICAgfSwgZGVsYXkpO1xuXG4gICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgfSxcblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gUGxheWJhY2s7XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5jb25zdCBBcnJheUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0FycmF5RXh0ZW5zaW9uJyk7XG5jb25zdCBVc2VyTW9kZWxIZWxwZXIgPSByZXF1aXJlKCdVc2VyTW9kZWxIZWxwZXInKTtcbmNvbnN0IFBsYXliYWNrID0gcmVxdWlyZSgnUGxheWJhY2snKTtcbmNvbnN0IEtRQ2FyZFJlc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFJlc0hlbHBlcicpO1xuY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgZm9sZENhcmROb2RlOiBjYy5Ob2RlLCAgICAgIC8vIOeJjOebluedgOaXtueahOagt+WtkFxuICAgICAgICB0ZVNodVBhaU5vZGU6IGNjLk5vZGUsICAgICAgLy8g54m55q6K54mM55uW552A5pe255qE5qC35a2QXG4gICAgICAgIGNhcmRzQmFja0xheW91dDogY2MuTGF5b3V0LCAvLyAxM+W8oOeJjOiDjOW9se+8jOWPr+eUqOadpeWxleekuuWPkeeJjOWKqOeUuyDlkKsgY2FyZHNCYWNrIENvbXBvbmVudFxuICAgICAgICBjb21wYXJlQ2FyZHNOb2RlOiBjYy5Ob2RlLCAgLy8gY29tcGFyZUNhcmRzICAg5ZCrIENvbXBhcmVDYXJkcyBDb21wb25lbnRcbiAgICAgICAgdXNlckluZm9Ob2RlOiBjYy5Ob2RlLCAgICAgICAgICAvLyDljIXlkKvnlKjmiLfkv6Hmga8g5ZCrIHVzZXJJbmZvIENvbXBvbmVudFxuICAgICAgICBjaGF0TWVzc2FnZU5vZGU6IGNjLk5vZGUsICAgICAgIC8vIOiBiuWkqea2iOaBryDljIXlkKsgQ2hhdE1lc3NhZ2UgQ29tcG9uZW50XG4gICAgICAgIHVzZXJBdmF0YXJOb2RlOiBjYy5Ob2RlLFxuICAgICAgICAvL3VzZXJTYW1wbGVJbmZvTm9kZTogY2MuTm9kZSxcbiAgICAgICAgYnVsbGV0SG9sZVByZWZhYjogY2MuUHJlZmFiLC8v5Lit5p6qXG4gICAgICAgIGJ1bGxldEhvbGVOb2RlOiBjYy5Ob2RlLC8v5Lit5p6qXG4gICAgICAgIHNob3ROb2RlOiBbY2MuTm9kZV0sLy/miZPmnqpcbiAgICAgICAgdXNlcklkOiAwLFxuICAgICAgICBjYXJkVHlwZVByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICAvLyDnlKjmiLfkv6Hmga9cbiAgICAgICAgLy8gMeOAgSDlpoLmnpwg5YyF5ZCr77yaY2FyZEluZm86W13vvIzooajmmI7nlKjmiLflt7Lnu4/lh7rniYxcbiAgICAgICAgLy9cbiAgICAgICAgX3VzZXJJbmZvOiBudWxsLFxuICAgICAgICBfZGVza0luZm86IG51bGwsXG4gICAgICAgIC8qKi9cbiAgICAgICAgcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzOiB7XG4gICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGRlZmF1bHQ6IHVuZGVmaW5lZCxcbiAgICAgICAgfVxuICAgICAgICAvKiovXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVzZXJBdmF0YXJOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCB0aGlzLl9zaG93VXNlckluZm8sIHRoaXMpO1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlQmFjayA9IGZhbHNlOy8v5Yik5pat5piv5ZCm54K55Ye75LqG5ouN55qE6IOM5b2xXG4gICAgICAgIHRoaXMuY2FyZFNwcml0ZUF0bGFzID0gdGhpcy5ub2RlLnBhcmVudC5nZXRDb21wb25lbnQoJ3BsYXknKS5jYXJkU3ByaXRlQXRsYXM7XG4gICAgfSxcblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVzZXJBdmF0YXJOb2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgdGhpcy5fc2hvd1VzZXJJbmZvLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgY2xpY2tfbGVhdmU6ZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIHVzZXJpZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcbiAgICAgICAgdmFyIGxlYXZlSWQgPSB0aGlzLl91c2VySW5mby5pZDtcbiAgICAgICAgU29ja2V0LnNlbmRRaW5nbGkobGVhdmVJZCx1c2VyaWQpO1xuICAgIH0sXG4gICAgXG4gICAgX3Nob3dVc2VySW5mbzogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3RoaXMudXNlclNhbXBsZUluZm9Ob2RlLmdldENvbXBvbmVudCgnVXNlclNhbXBsZUluZm8nKS51cGRhdGVXaXRoVXNlcih0aGlzLl91c2VySW5mbyk7XG4gICAgfSxcblxuICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRlU2h1UGFpTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuICAgICAgICB0aGlzLmJ1bGxldEhvbGVOb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24obm9kZSl7bm9kZS5hY3RpdmUgPSBmYWxzZTt9KTtcbiAgICAgICAgaWYodGhpcy5zaG90Tm9kZS5sZW5ndGggPiAwKSB0aGlzLnNob3ROb2RlLmZvckVhY2goZnVuY3Rpb24obm9kZSl7aWYobm9kZSkgbm9kZS5hY3RpdmUgPSBmYWxzZTt9KTtcbiAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykucmVzZXQoKTtcbiAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xuICAgIH0sXG5cbiAgICAvKiMjIyMqL1xuICAgIHJlc2V0MjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGVTaHVQYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJ1bGxldEhvbGVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJ1bGxldEhvbGVOb2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2RlKXtub2RlLmFjdGl2ZSA9IGZhbHNlO30pO1xuICAgICAgICBpZih0aGlzLnNob3ROb2RlLmxlbmd0aCA+IDApIHRoaXMuc2hvdE5vZGUuZm9yRWFjaChmdW5jdGlvbihub2RlKXtpZihub2RlKSBub2RlLmFjdGl2ZSA9IGZhbHNlO30pO1xuICAgICAgICAvL3RoaXMuY29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgLy90aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5yZXNldCgpO1xuICAgIH0sXG4gICAgLyojIyMjIyovXG5cbiAgICB1cGRhdGVVc2VySW5mb1dpdGhVc2VyczogZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgIGxldCB1c2VyID0gdXNlcnMuZmluZChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXNlcklkID09IGUuaWQ7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVVc2VySW5mbyh1c2VyKTtcbiAgICB9LFxuICAgIHNob3dRaW5nbGk6ZnVuY3Rpb24oY3JlYXRvciwgaW5kZXgpe1xuICAgICAgICBpZighdGhpcy5ub2RlLmFjdGl2ZSl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYoaW5kZXg+MCl7XG4gICAgICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0cWluZ2xpKGZhbHNlKTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBpZihjcmVhdG9yKXtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0cWluZ2xpKGZhbHNlKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRxaW5nbGkodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHVwZGF0ZVVzZXJJbmZvOiBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICB0aGlzLl91c2VySW5mbyA9IHVzZXI7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSAodXNlciAhPSBudWxsKTtcbiAgICAgICAgdGhpcy51c2VySW5mb05vZGUuYWN0aXZlID0gdGhpcy5ub2RlLmFjdGl2ZTtcbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICAgIHVzZXJJbmZvLnVwZGF0ZUF2YXRhcih1c2VyLmF2YXRhclVybCk7XG4gICAgICAgIHVzZXJJbmZvLnVwZGF0ZVVzZXJJZCh1c2VyLmlkKTtcbiAgICAgICAgdXNlckluZm8udXBkYXRlTmlja25hbWUodXNlci5uaWNrbmFtZSk7XG4gICAgICAgIHVzZXJJbmZvLnNldE9mZmxpbmVWaXNpYmxlKCF1c2VyLm9ubGluZVN0YXR1cyk7XG5cbiAgICAgICAgLy9pZiAodGhpcy5fZGVza0luZm8gJiYgdGhpcy5fZGVza0luZm8uY0luZGV4ID4gMCkge1xuICAgICAgICAvLyAgaWYgKFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKHVzZXIpKSB7XG4gICAgICAgIC8vICAgIHRoaXMucGxheUNhcmQodXNlci5pZCk7XG4gICAgICAgIC8vICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNldENvbXBhcmVEYXRhKHVzZXIpO1xuICAgICAgICAvLyAgfVxuICAgICAgICAvL31cbiAgICAgICAgLyoqL1xuICAgICAgICBjb25zdCBjSW5kZXggPSB0aGlzLl9kZXNrSW5mby5jSW5kZXg7XG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mbyAmJiBjSW5kZXggPiAwICYmICh0aGlzLnBsYXllZENvbXBhcmVDYXJkc0luZGV4cy5pbmRleE9mKGNJbmRleCkgPT0gLTEpKSB7XG4gICAgICAgICAgICBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModXNlcikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXlDYXJkKHVzZXIuaWQsdXNlci5jYXJkSW5mbyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuc2V0Q29tcGFyZURhdGEodXNlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqL1xuICAgIH0sXG5cbiAgICAvLyDmm7TmlrDmiL/kuLvkv6Hmga9cbiAgICB1cGRhdGVCYW5rZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICBsZXQgdXNlckluZm9Db21wID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xuICAgICAgICBpZiAoIXRoaXMuX3VzZXJJbmZvKSB7XG4gICAgICAgICAgICB1c2VySW5mb0NvbXAuc2V0SXNCYW5rZXIoZmFsc2UpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGlzQmFua2VyID0gdGhpcy5fdXNlckluZm8gPyB0aGlzLl91c2VySW5mby5pc0JhbmtlciA6IGZhbHNlO1xuICAgICAgICB1c2VySW5mb0NvbXAuc2V0SXNCYW5rZXIoaXNCYW5rZXIpO1xuICAgIH0sXG5cbiAgICBzaG93RmFuZ1podVN0YXR1czogZnVuY3Rpb24gKGNyZWF0ZUlkLCB2aXNpYmxlID0gdHJ1ZSkge1xuICAgICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fdXNlckluZm8uaWQgPT0gY3JlYXRlSWQpIHtcbiAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRGYW5nWmh1Tm9kZVZpc2libGUodmlzaWJsZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog5pu05paw5YiG5pWwXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gc2NvcmUg55So5oi35YiG5pWw44CB5Y+v6YCJXG4gICAgICovXG4gICAgdXBkYXRlU2NvcmU6IGZ1bmN0aW9uKHNjb3JlKSB7XG4gICAgICAgIGlmICghc2NvcmUgJiYgdGhpcy5fdXNlckluZm8pIHtcbiAgICAgICAgICAgIHNjb3JlID0gdGhpcy5fdXNlckluZm8udG90YWxTY29yZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcbiAgICAgICAgdXNlckluZm8udXBkYXRlU2NvcmUoc2NvcmUpO1xuICAgIH0sXG5cbiAgICBzaG93UmVhZHlTdGF0dXM6IGZ1bmN0aW9uICh1c2VySWQsIHZpc2libGUgPSB0cnVlKSB7XG4gICAgICAgIGlmICghdGhpcy5ub2RlLmFjdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX3VzZXJJbmZvLmlkID09IHVzZXJJZCkge1xuICAgICAgICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldFJlYWR5Tm9kZVZpc2libGUodmlzaWJsZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHNob3dCZWlsdjpmdW5jdGlvbih1c2VySWQsYmwpe1xuICAgICAgICBpZighdGhpcy5ub2RlLmFjdGl2ZSl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYoIHRoaXMuX3VzZXJJbmZvLmlkID09IHVzZXJJZCApe1xuICAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRCZWlsdkxhYmVsKGJsKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLypzZXREZXNrSW5mbzogZnVuY3Rpb24gKGRlc2tJbmZvKSB7XG4gICAgIHRoaXMuX2Rlc2tJbmZvID0gZGVza0luZm87XG4gICAgIH0sKi9cbiAgICB1cGRhdGVEZXNrSW5mbzogZnVuY3Rpb24gKGRlc2tJbmZvKSB7XG4gICAgICAgIHRoaXMuX2Rlc2tJbmZvID0gZGVza0luZm87XG5cbiAgICAgICAgaWYgKGRlc2tJbmZvICYmICFkZXNrSW5mby5pc0NCZWdpbikge1xuICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvKiovXG5cbiAgICBoaWRlUmVhZHlTdGF0dXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldFJlYWR5Tm9kZVZpc2libGUoZmFsc2UpO1xuICAgIH0sXG5cbiAgICBwbGF5RmFQYWlBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKHRoaXMuX3VzZXJJbmZvKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBjYXJkc0JhY2sgPSB0aGlzLmNhcmRzQmFja0xheW91dC5nZXRDb21wb25lbnQoJ2NhcmRzQmFjaycpO1xuICAgICAgICBjYXJkc0JhY2suc2hvd1BsYXlDYXJkQmFja3MoKTtcbiAgICB9LFxuXG4gICAgc2hvdWxkU2hvd0ZhUGFpQW5pbWF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyh0aGlzLl91c2VySW5mbyk7XG4gICAgfSxcblxuICAgIHNldFVzZXJPbmxpbmVTdGF0dXM6IGZ1bmN0aW9uICh1c2VySWQsIHN0YXR1cyA9IDEpIHtcbiAgICAgICAgaWYgKHVzZXJJZCAhPSB0aGlzLnVzZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xuICAgICAgICB1c2VySW5mby5zZXRPZmZsaW5lVmlzaWJsZShzdGF0dXMgIT0gMSk7XG4gICAgfSxcblxuICAgIHNob3dDaGF0VGV4dDogZnVuY3Rpb24gKHVzZXJJZCwgbWVzc2FnZSkge1xuICAgICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY2hhdE1lc3NhZ2UgPSB0aGlzLmNoYXRNZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoJ0NoYXRNZXNzYWdlJyk7XG4gICAgICAgIGNoYXRNZXNzYWdlLnNldFN0cmluZyhtZXNzYWdlKTtcbiAgICB9LFxuXG4gICAgLy8g55So5oi35bey57uP5Ye654mM77yM5aSE5LqO5LiJ5aCG55uW552A54mM55qE54q25oCBXG4gICAgcGxheUNhcmQ6IGZ1bmN0aW9uICh1c2VySWQsY2FyZEluZm8pIHtcbiAgICAgICAgaWYgKHRoaXMudXNlcklkICE9IHVzZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS50YXJnZXRPZmYodGhpcy5mb2xkQ2FyZE5vZGUpO1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS5jaGlsZHJlbi5zbGljZSgwLDMpLmZvckVhY2goZnVuY3Rpb24obm9kZSl7XG4gICAgICAgICAgICBub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICBub2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24obm9lKXtcbiAgICAgICAgICAgICAgICBub2UuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIHZhciBjYXJkU3ByaXRlID0gbm9lLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9ICdwdWJsaWMtcGljLWNhcmQtcG9rZXItYmFjayc7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxjYXJkU3ByaXRlKTtcblxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX2NsaWNrRm9sZENhcmROb2RlKGV2ZW50KTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLHRoaXMuZm9sZENhcmROb2RlKTtcblxuXG4gICAgfSxcblxuICAgIF9jbGlja0ZvbGRDYXJkTm9kZTogZnVuY3Rpb24gKGV2ZW50KSB7XG5cbiAgICAgICAgaWYgKHRoaXMudXNlcklkICE9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZCkgcmV0dXJuO1xuXG4gICAgICAgIHZhciBjYXJkSW5mbyA9IHRoaXMuX3VzZXJJbmZvLmNhcmRJbmZvLmxlbmd0aCA9PSAxPyB0aGlzLl91c2VySW5mby5jYXJkSW5mb1swXS5jYXJkczogdGhpcy5fdXNlckluZm8uY2FyZEluZm87XG5cbiAgICAgICAgdmFyIGNhcmRzID0gY2FyZEluZm8ubWFwKGZ1bmN0aW9uIChjYXJkSW5mb0l0ZW0pIHtcblxuICAgICAgICAgICAgaWYodGhpcy5fdXNlckluZm8uY2FyZEluZm8ubGVuZ3RoID09IDEpIHJldHVybiBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZEluZm9JdGVtKTtcblxuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0uY2FyZHMpO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSkucmVkdWNlKGZ1bmN0aW9uIChhcnJheSwgc3ViQ2FyZHMpIHtyZXR1cm4gYXJyYXkuY29uY2F0KHN1YkNhcmRzKTt9LCBbXSk7XG5cbiAgICAgICAgdmFyIGZvbGRDYXJkTm9kZSA9IHRoaXMuZm9sZENhcmROb2RlLmNoaWxkcmVuLnNsaWNlKDAsMyk7XG5cbiAgICAgICAgdmFyIG5vZGVzID0gZm9sZENhcmROb2RlLm1hcChmdW5jdGlvbiAobm9kZSkge3JldHVybiBub2RlLmNoaWxkcmVuO30pLnJlZHVjZShmdW5jdGlvbiAoYXJyYXksIHN1Yikge3JldHVybiBhcnJheS5jb25jYXQoc3ViKTt9LCBbXSk7XG5cbiAgICAgICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoa3FDYXJkLCBpbmRleCkge1xuXG4gICAgICAgICAgICBpZiAoaW5kZXggPj0gbm9kZXMubGVuZ3RoKSByZXR1cm47XG5cbiAgICAgICAgICAgIG5vZGVzW2luZGV4XS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICBub2Rlc1tpbmRleF0uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBcIlwiO1xuXG4gICAgICAgICAgICB2YXIgbm9kZHMxID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcblxuICAgICAgICAgICAgbm9kZHMxLndpZHRoID0gbm9kZXNbMF0ud2lkdGg7XG5cbiAgICAgICAgICAgIG5vZGRzMS5oZWlnaHQgPSBub2Rlc1swXS5oZWlnaHQ7XG5cbiAgICAgICAgICAgIG5vZGRzMS5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTsgLy/mt7vliqDnsr7ngbXnu4Tku7ZcblxuICAgICAgICAgICAgdmFyIGNhcmRTcHJpdGUgPSBub2RkczEuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcblxuICAgICAgICAgICAgY2FyZFNwcml0ZS5zaXplTW9kZSA9IDA7XG5cbiAgICAgICAgICAgIHZhciBjYXJkTmFtZSA9IHRoaXMuZm9sZENhcmROb2RlQmFjayA9PSBmYWxzZT8ga3FDYXJkLmNhcmROYW1lKCk6IFwiYmFja1wiO1xuXG4gICAgICAgICAgICBub2RkczEuY2FyZE5hbWUgPSBjYXJkTmFtZTtcblxuICAgICAgICAgICAgdmFyIHBhdGggPSAncHVibGljLXBpYy1jYXJkLXBva2VyLScrIGNhcmROYW1lO1xuXG4gICAgICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxjYXJkU3ByaXRlKTtcblxuICAgICAgICAgICAgaWYoY2MubWFQYWkgPT0gY2FyZE5hbWUpe1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGRzID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcblxuICAgICAgICAgICAgICAgIG5vZGRzLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgICAgICAgICAgY2MubG9hZGVyLmxvYWRSZXMoJ3BsYXkvZGVzay9pbWdfcmVkNV8xJywgY2MuU3ByaXRlRnJhbWUsIGZ1bmN0aW9uIChlcnIsIHNwcml0ZUZyYW1lKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycikge2NjLmVycm9yKGVyci5tZXNzYWdlIHx8IGVycik7cmV0dXJuO31cblxuICAgICAgICAgICAgICAgICAgICB2YXIgYnRuU3ByaXRlMSA9IG5vZGRzLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcblxuICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUud2lkdGggPSBjYXJkU3ByaXRlLm5vZGUud2lkdGggKyAxMDtcblxuICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUuaGVpZ2h0ID0gY2FyZFNwcml0ZS5ub2RlLmhlaWdodCArIDEwO1xuXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgICAgIGNhcmRTcHJpdGUubm9kZS5hZGRDaGlsZChub2Rkcyk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbm9kZXNbaW5kZXhdLmFkZENoaWxkKG5vZGRzMSk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdmFyIGNhcmRzMCA9IGNhcmRzLnNsaWNlKDAsMylcbiAgICAgICAgdmFyIGNhcmRzMSA9IGNhcmRzLnNsaWNlKDMsOClcbiAgICAgICAgdmFyIGNhcmRzMiA9IGNhcmRzLnNsaWNlKDgsMTMpXG5cbiAgICAgICAgY2FyZHMgPSBbY2FyZHMwLCBjYXJkczEsIGNhcmRzMl1cbiAgICAgICAgLy/lpLTpgZNcbiAgICAgICAgbGV0IHR5cGVOYW1lMCA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMwKSsxO1xuICAgICAgICB0eXBlTmFtZTAgPSB0eXBlTmFtZTA+PTEwID8gdHlwZU5hbWUwIDpcIjBcIit0eXBlTmFtZTA7XG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD09JzA0JyA/ICcxMScgOnR5cGVOYW1lMDtcblxuICAgICAgICAvL+S4remBk1xuICAgICAgICBsZXQgdHlwZU5hbWUxID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkczEpKzE7XG4gICAgICAgIHR5cGVOYW1lMSA9IHR5cGVOYW1lMT49MTAgPyB0eXBlTmFtZTEgOlwiMFwiK3R5cGVOYW1lMTtcbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPT0nMDcnID8gJzIyJyA6dHlwZU5hbWUxO1xuXG4gICAgICAgIC8v5bC+6YGTXG4gICAgICAgIGxldCB0eXBlTmFtZTIgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzMikrMTtcbiAgICAgICAgdHlwZU5hbWUyID0gdHlwZU5hbWUyPj0xMCA/IHR5cGVOYW1lMiA6XCIwXCIrdHlwZU5hbWUyO1xuXG5cbiAgICAgICAgaWYodHlwZU5hbWUwKSBLUUNhcmQuX3NldEd1aUNhcmQoMCwgMCwgMywgdHlwZU5hbWUwLCBjYXJkcywgbm9kZXMsIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcbiAgICAgICAgaWYodHlwZU5hbWUxKSBLUUNhcmQuX3NldEd1aUNhcmQoMSwgMywgOCwgdHlwZU5hbWUxLCBjYXJkcywgbm9kZXMsIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcbiAgICAgICAgaWYodHlwZU5hbWUyKSBLUUNhcmQuX3NldEd1aUNhcmQoMiwgOCwgMTMsIHR5cGVOYW1lMiwgY2FyZHMsIG5vZGVzLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG4gICAgICAgIGlmKHRoaXMuZm9sZENhcmROb2RlQmFjayA9PSBmYWxzZSl7XG4gICAgICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZUJhY2sgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYodGhpcy5mb2xkQ2FyZE5vZGVCYWNrID09IHRydWUpe1xuICAgICAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgIH0sXG5cbiAgICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24oU3ByaXRlRnJhbWUsIHBhdGgsIFNwcml0ZXNOb2RlLCB3LCBoKSB7XG5cbiAgICAgICAgdmFyIFNwcml0ZSA9IFNwcml0ZUZyYW1lLmdldFNwcml0ZUZyYW1lKCBwYXRoICk7XG5cbiAgICAgICAgU3ByaXRlc05vZGUuc3ByaXRlRnJhbWUgPSBTcHJpdGU7XG5cbiAgICAgICAgaWYodykgU3ByaXRlc05vZGUubm9kZS53aWR0aCA9IHc7XG5cbiAgICAgICAgaWYoaCkgU3ByaXRlc05vZGUubm9kZS5oZWlnaHQgPSBoO1xuICAgIH0sXG5cbiAgICAvLyDlh4blpIflpb3lvIDlp4vmr5TniYxcbiAgICAvLyByZWFkeVRvQ29tcGFyZUNhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gICAgIHRoaXMuZm9sZENhcmROb2RlLnRhcmdldE9mZih0aGlzLmZvbGRDYXJkTm9kZSk7XG4gICAgLy8gICAgIHRoaXMuZm9sZENhcmROb2RlQmFjayA9IHRydWU7XG4gICAgLy8gICAgIHRoaXMuX2NsaWNrRm9sZENhcmROb2RlKCk7XG4gICAgLy8gICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgLy8gICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgIC8vICAgICAvL3RoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIC8vICAgICBpZih0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlcil7XG4gICAgLy8gICAgICAgICBpZih0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlci5pc0NvbnRhaW5FeHRyYSl7XG4gICAgLy8gICAgICAgICAgICAgdGhpcy50ZVNodVBhaU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAvLyAgICAgICAgIH1lbHNle1xuICAgIC8vICAgICAgICAgICAgIHRoaXMudGVTaHVQYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICB9XG4gICAgLy8gfSxcbiAgICByZWFkeVRvQ29tcGFyZUNhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLnRhcmdldE9mZih0aGlzLmZvbGRDYXJkTm9kZSk7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlQmFjayA9IHRydWU7XG4gICAgICAgIHRoaXMuX2NsaWNrRm9sZENhcmROb2RlKCk7XG4gICAgICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICBpZih0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlcil7XG4gICAgICAgICAgICBpZih0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlci5pc0NvbnRhaW5FeHRyYSl7XG4gICAgICAgICAgICAgICAgdGhpcy50ZVNodVBhaU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHRoaXMudGVTaHVQYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIOaSreaUvuaJk+aequWKqOeUu1xuICAgIC8vIEBwYXJhbSB1c2VySWQgICDopoHkuLvliqjmiZPmnqrnmoTnlKjmiLdpZFxuICAgIC8vIEBwYXJhbSB0b1VzZXJJbmRleCAg5oyo5p6q55qE55So5oi355qEIGluZGV4XG4gICAgcGxheVNob290QW5pbWF0aW9uOiBmdW5jdGlvbiAodXNlcklkLCB0b1VzZXJJbmRleCkge1xuICAgICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNob3ROb2RlID0gdGhpcy5zaG90Tm9kZVt0b1VzZXJJbmRleF07XG4gICAgICAgIHNob3ROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHNob3ROb2RlLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHNob3ROb2RlLmNoaWxkcmVuWzFdLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgLy/mnqpcbiAgICAgICAgdmFyIHJvdGF0ZUJ5ID0gY2Mucm90YXRlVG8oMC4xLC0xNSk7XG4gICAgICAgIHZhciBkZWxheTEgPSBjYy5kZWxheVRpbWUoMC4xKTtcbiAgICAgICAgdmFyIHJvdGF0ZUJ5MSA9IGNjLnJvdGF0ZVRvKDAuMSwwKTtcbiAgICAgICAgdmFyIHN0YXJ0X2Z1bmMxID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtzaG90Tm9kZS5jaGlsZHJlblswXS5hY3RpdmUgPSB0cnVlO30pO1xuICAgICAgICB2YXIgZW5kX2Z1bmMxID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtzaG90Tm9kZS5jaGlsZHJlblswXS5hY3RpdmUgPSBmYWxzZTt9KTtcbiAgICAgICAgdmFyIGFjdGlvbiA9IGNjLnJlcGVhdChjYy5zZXF1ZW5jZShzdGFydF9mdW5jMSAscm90YXRlQnksIGRlbGF5MSwgcm90YXRlQnkxLCBlbmRfZnVuYzEpLDMpO1xuXG4gICAgICAgIC8v54OfXG4gICAgICAgIHZhciBmYWRlSW4gPSBjYy5mYWRlSW4gKDApO1xuICAgICAgICB2YXIgc2NhbGVUbzEgPSBjYy5zY2FsZVRvICgwLCAwLjgpO1xuICAgICAgICB2YXIgc2NhbGVUbzIgPSBjYy5zY2FsZVRvICgwLjA4LCAxKTtcbiAgICAgICAgdmFyIGZhZGVPdXRBbmRTY2FsZVRvID0gY2Muc3Bhd24oY2MuZmFkZU91dCgwLjAyKSwgY2Muc2NhbGVUbygwLjAyLCAwLjUpKTtcbiAgICAgICAgdmFyIGRlbGF5MiA9IGNjLmRlbGF5VGltZSguMik7XG4gICAgICAgIHZhciBzdGFydF9mdW5jMiA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7c2hvdE5vZGUuY2hpbGRyZW5bMV0uYWN0aXZlID0gdHJ1ZTt9KTtcbiAgICAgICAgdmFyIGVuZF9mdW5jMiA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7c2hvdE5vZGUuY2hpbGRyZW5bMV0uYWN0aXZlID0gZmFsc2U7fSk7XG4gICAgICAgIHZhciBhY3Rpb24xID0gIGNjLnJlcGVhdChjYy5zZXF1ZW5jZShzdGFydF9mdW5jMiwgZmFkZUluLCBzY2FsZVRvMSwgc2NhbGVUbzIsIGZhZGVPdXRBbmRTY2FsZVRvLCBkZWxheTIsIGVuZF9mdW5jMiksMyk7XG5cbiAgICAgICAgc2hvdE5vZGUuY2hpbGRyZW5bMF0ucnVuQWN0aW9uKGFjdGlvbik7XG4gICAgICAgIHNob3ROb2RlLmNoaWxkcmVuWzFdLnJ1bkFjdGlvbihhY3Rpb24xKTtcblxuXG4gICAgICAgIC8vbGV0IHVzZXJJbmZvID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xuICAgICAgICAvL3VzZXJJbmZvLnBsYXlTaG9vdEFuaW1hdGlvbih0b1VzZXJJbmRleCk7XG4gICAgfSxcblxuICAgIC8vIOaSreaUvuS4reaequWKqOeUu1xuICAgIHBsYXlCdWxsZXRIb2xlQW5pbWF0aW9uOiBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICBsZXQgYnVsbGV0SG9sZU5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmJ1bGxldEhvbGVQcmVmYWIpO1xuXG4gICAgICAgIGJ1bGxldEhvbGVOb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24obm9kZSl7bm9kZS5hY3RpdmUgPSBmYWxzZTt9LmJpbmQodGhpcykpO1xuXG4gICAgICAgIGJ1bGxldEhvbGVOb2RlLmNoaWxkcmVuWzBdLnkgPSAwO1xuXG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUuYWRkQ2hpbGQoYnVsbGV0SG9sZU5vZGUpO1xuXG4gICAgICAgIHZhciBpbnRlcnZhbCA9IDAuMztcblxuICAgICAgICB2YXIgaW5pdFRpbWUgPSAwO1xuXG4gICAgICAgIGJ1bGxldEhvbGVOb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24obm9kZSl7XG5cbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlIdW1hblpRaWFuZygpO1xuXG4gICAgICAgICAgICAgICAgbm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIHkgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkpID09IDAgPyAtMSA6IDE7XG5cbiAgICAgICAgICAgICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjM4KSAqIHk7XG5cbiAgICAgICAgICAgICAgICB2YXIgeCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcblxuICAgICAgICAgICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMzgpICogeDtcblxuICAgICAgICAgICAgICAgIG5vZGUueCA9IHg7XG5cbiAgICAgICAgICAgICAgICBub2RlLnkgPSB5O1xuXG4gICAgICAgICAgICB9LCBpbml0VGltZSk7XG5cbiAgICAgICAgICAgIGluaXRUaW1lID0gaW5pdFRpbWUgKyBpbnRlcnZhbDtcblxuICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgfSxcblxuICAgIC8vIOaSreaUvuWFqOWekuaJk+WKqOeUu1xuICAgIHBsYXlIb21lUnVuQWltYXRpb246IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICAgICAgaWYgKHVzZXJJZCAhPSB0aGlzLnVzZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xuICAgICAgICB1c2VySW5mby5wbGF5SG9tZVJ1bkFpbWF0aW9uKCk7XG4gICAgfSxcblxuICAgIHBsYXlTcGVha0FuaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICAgIHVzZXJJbmZvLnBsYXlTcGVha0FuaW1hdGlvbigpO1xuICAgIH0sXG5cbiAgICBuZXh0Q29tcGFyZVNjb3JlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5ub2RlLmFjdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgc2NvcmUgPSB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5uZXh0Q29tcGFyZVNjb3JlKCk7XG4gICAgICAgIHJldHVybiBzY29yZTtcbiAgICB9LFxuXG4gICAgc2hvd05leHRDb21wYXJlQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMubmV4dENvbXBhcmVTY29yZSgpIDw9IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRlU2h1UGFpTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuc2hvd05leHRDYXJkcygpO1xuICAgIH0sXG5cbiAgICBzaG93QWxsQ29tcGFyZUNhcmRzOiBmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgbGV0IHVzZXIgPSB1c2Vycy5maW5kKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy51c2VySWQgPT0gZS5pZDtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuc2V0Q29tcGFyZURhdGEodXNlcik7XG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNob3dBbGxDYXJkcygpO1xuXG4gICAgICAgIHRoaXMudXBkYXRlU2NvcmUodGhpcy5fdXNlckluZm8udG90YWxTY29yZSB8fCAwKTtcbiAgICB9LFxuXG4gICAgc2hvd05leHRDb21wYXJlU2NvcmU6IGZ1bmN0aW9uIChpc0NvbnRhaW5FeHRyYSkge1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zaG93TmV4dENvbXBhcmVTY29yZShpc0NvbnRhaW5FeHRyYSk7XG4gICAgfSxcblxuICAgIHNob3dTY29yZVJlc3VsdDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zaG93U2NvcmVSZXN1bHQoKTtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBLUUNhcmRSZXNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRSZXNIZWxwZXInKTtcbmNvbnN0IFNwcml0ZUhlbHBlciA9IHJlcXVpcmUoJ1Nwcml0ZUhlbHBlcicpO1xuY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGF2YXRhclNwcml0ZTogY2MuU3ByaXRlLFxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxSZXN1bHROdW1iZXI6IGNjLkxhYmVsLFxuICAgICAgICBsYXlvdXRUb3VEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0WmhvbmdEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0V2VpRGFvOiBjYy5MYXlvdXQsXG4gICAgICAgIGxheW91dFRlU2h1OiBjYy5MYXlvdXQsXG5cbiAgICAgICAgbGFiZWxUZVNodVBhaVRpdGxlOiBjYy5MYWJlbCxcblxuICAgICAgICBzY29yZVVuaXROb2RlOiBjYy5Ob2RlLCAgICAgIC8vIOenr+WIhlxuICAgICAgICBkaWFtb25kVW5pdE5vZGU6IGNjLk5vZGUsICAgIC8vIOmSu+efs1xuICAgIH0sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICB9LFxuXG4gICAgLy97XCJpZFwiOjEwMDA0OSxcIm5pY2tuYW1lXCI6XCJpbXlhXCIsXCJvcGVuSWRcIjpcInh4XCIsXCJhdmF0YXJVcmxcIjpcInh4XCIsXCJzZXhcIjoxLFxuICAgIC8vIFwiY2FyZE51bWJlclwiOjMsXCJvbmxpbmVTdGF0dXNcIjoxLFwiaW52aXRlQ29kZVwiOlwiXCIsXCJpcEFkZHJlc3NcIjpcIjo6ZmZmZjoyMjIuMjQ0LjY1LjIwMVwiLFxuICAgIC8vIFwibGFzdExvZ2luVGltZVwiOlwiMjAxNy0wNC0xMyAyMjowOTowMVwiLFwiY3JlYXRlQXRcIjpcIjIwMTctMDQtMTEgMjI6Mzk6MzBcIixcbiAgICAvLyBcInVwZGF0ZUF0XCI6XCIyMDE3LTA0LTEzIDIyOjA5OjAxXCIsXG4gICAgLy8gXCJjYXJkc1wiOltdLFwicm9vbUlkXCI6XCI1OTg4ODNcIixcInJlYWR5U3RhdHVzXCI6dHJ1ZSxcInRvdGFsU2NvcmVcIjowLFxuICAgIC8vIFwiY1Njb3JlXCI6MCxcImlzQmFua2VyXCI6ZmFsc2V9XG4gICAgdXBkYXRlV2l0aFBsYXllckluZm86IGZ1bmN0aW9uIChwbGF5ZXJJbmZvLCBpc1JhbmRvbVJvb20gPSBmYWxzZSkge1xuICAgICAgU3ByaXRlSGVscGVyLnNldEltYWdlVXJsKHRoaXMuYXZhdGFyU3ByaXRlLCBwbGF5ZXJJbmZvLmF2YXRhclVybCk7XG4gICAgICB0aGlzLmxhYmVsTmlja25hbWUuc3RyaW5nID0gcGxheWVySW5mby5uaWNrbmFtZTtcbiAgICAgICAgLy9jYy5sb2codGhpcy5sYWJlbFJlc3VsdE51bWJlci5zdHJpbmcpXG4gICAgICAgIC8vY2MubG9nKHBsYXllckluZm8pXG4gICAgICAgIC8vY2MubG9nKHBsYXllckluZm8uY1Njb3JlKVxuICAgICAgICAvL2NjLmxvZygnLS0tMzYnKVxuICAgICAgdGhpcy5sYWJlbFJlc3VsdE51bWJlci5zdHJpbmcgPSBwbGF5ZXJJbmZvLmNTY29yZTtcblxuICAgICAgdGhpcy5zY29yZVVuaXROb2RlLmFjdGl2ZSA9ICFpc1JhbmRvbVJvb207XG4gICAgICB0aGlzLmRpYW1vbmRVbml0Tm9kZS5hY3RpdmUgPSBpc1JhbmRvbVJvb207XG4gICAgICB2YXIgTnVtYmVyID0gcGxheWVySW5mby5jU2NvcmU7XG4gICAgICBpZiAoaXNSYW5kb21Sb29tKSB7XG4gICAgICAgIC8vIOWmguaenOaYr+maj+acuuWcuueahOivne+8jOWImeaYvuekuumSu+efs+aVsOmHj1xuICAgICAgICAgIE51bWJlciA9IHBsYXllckluZm8uY1Njb3JlICogNTtcbiAgICAgIH1cbiAgICAgICAgdGhpcy5sYWJlbFJlc3VsdE51bWJlci5zdHJpbmcgPSBOdW1iZXI7XG4gICAgfSxcblxuICAgIHNldENhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIGNjLmFzc2VydChjYXJkcy5sZW5ndGggPT0gMTMpO1xuXG4gICAgICAvLyDkuI3kvJrlho3mnInnibnmrorniYzkuoZcbiAgICAgICAvKmlmIChLUUNhcmQuaXNUZVNodVBhaShjYXJkcykpIHtcbiAgICAgICAgIHRoaXMuc2V0VGVTaHVDYXJkcyhjYXJkcyk7XG4gICAgICAgICByZXR1cm47XG4gICAgICAgICB9XG4gICAgICAqL1xuXG4gICAgICAvL2xldCB0b3VDYXJkcyA9IGNhcmRzLnNsaWNlKDAsIDMpO1xuICAgICAgLy9sZXQgemhvbmdDYXJkcyA9IGNhcmRzLnNsaWNlKDMsIDMgKyA1KTtcbiAgICAgIC8vbGV0IHdlaUNhcmRzID0gY2FyZHMuc2xpY2UoOCk7XG4gICAgICAvL3RoaXMuc2V0VG91Q2FyZHModG91Q2FyZHMpO1xuICAgICAgLy90aGlzLnNldFpob25nQ2FyZHMoemhvbmdDYXJkcyk7XG4gICAgICAvL3RoaXMuc2V0V2VpQ2FyZHMod2VpQ2FyZHMpO1xuICAgIH0sXG5cbiAgICAvKnNldFRvdUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy5sYXlvdXRUb3VEYW8sIGNhcmRzKTtcbiAgICB9LFxuXG4gICAgc2V0WmhvbmdDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICB0aGlzLl9zZXRDYXJkc1RvTGF5b3V0KHRoaXMubGF5b3V0WmhvbmdEYW8sIGNhcmRzKTtcbiAgICB9LFxuXG5cbiAgICBzZXRXZWlDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICB0aGlzLl9zZXRDYXJkc1RvTGF5b3V0KHRoaXMubGF5b3V0V2VpRGFvLCBjYXJkcyk7XG4gICAgfSwqL1xuXG4gICAgLy/nu5PnrpcgIOWwhueJueauiueJjOaUvuWFpUxheW91dFxuICAgIC8qc2V0VGVTaHVDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICB0aGlzLmxheW91dFRlU2h1Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgIHRoaXMubGF5b3V0VG91RGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLmxheW91dFpob25nRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLmxheW91dFdlaURhby5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5fc2V0Q2FyZHNUb0xheW91dCh0aGlzLmxheW91dFRlU2h1LCBjYXJkcyk7XG5cbiAgICAgIGxldCB0eXBlTmFtZSA9IEtRQ2FyZC5jYXJkc1R5cGVOYW1lKGNhcmRzKTtcbiAgICAgIHRoaXMubGFiZWxUZVNodVBhaVRpdGxlLnN0cmluZyA9IHR5cGVOYW1lO1xuICAgIH0sKi9cblxuICAgLy/nu5PnrpflsIbniYzmlL7liLBMYXlvdXTph4zpnaJcbiAgICAvKl9zZXRDYXJkc1RvTGF5b3V0OiBmdW5jdGlvbiAobGF5b3V0LCBjYXJkcykge1xuICAgICAgbGV0IG5vZGUgPSBsYXlvdXQubm9kZTtcbiAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoc3ByaXRlTm9kZSwgaW5kZXgpIHtcbiAgICAgICAgbGV0IHNwcml0ZSA9IHNwcml0ZU5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcbiAgICAgICAgbGV0IGNhcmQgPSBjYXJkc1tpbmRleF07XG4gICAgICAgIGlmICghY2FyZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIEtRQ2FyZFJlc0hlbHBlci5zZXRDYXJkU3ByaXRlRnJhbWUoc3ByaXRlLCBjYXJkLmNhcmROYW1lKCkpO1xuICAgICAgfSk7XG4gICAgfSwqL1xufSk7XG4iLCJjb25zdCBNYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgcGhvbmU6Y2MuTGFiZWwsXG4gICAgICBtdXNpY1NsaWRlcjpjYy5Ob2RlLFxuICAgICAgZWZmZWN0U2xpZGVyOmNjLk5vZGUsXG4gICAgICBidG5Td2l0Y2hBY2NvdW50OiBjYy5CdXR0b24sXG4gICAgICBzaGFyZUJnOmNjLk5vZGUsXG4gICAgICB3eDpjYy5Ob2RlLFxuICAgICAgcHlxOmNjLk5vZGUsXG4gICAgICBtdXNpYzpjYy5Ob2RlLFxuICAgICAgc291bmRzOmNjLk5vZGUsXG4gICAgICBfYXVkaW9NYW5hZ2VyOiBudWxsLFxuICAgICAgX211c2ljT24gOiAxLFxuICAgICAgX3NvdW5kc09uIDogMSxcbiAgICAgIF9waG9uZTpudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlciA9IGNjLmZpbmQoJ0F1ZGlvTWFuYWdlcicpIHx8IHt9O1xuICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyID0gdGhpcy5fYXVkaW9NYW5hZ2VyLmdldENvbXBvbmVudCgnQXVkaW9NYW5hZ2VyJyk7XG4gICAgICB0aGlzLl9pbml0U2xpZGVycygpO1xuICAgICAgdGhpcy5waG9uZS5zdHJpbmcgPSB0aGlzLl9waG9uZT90aGlzLl9waG9uZTpcIuaXoFwiO1xuICAgICAgICB2YXIgYmdNdXNpYyA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImJnTXVzaWNcIik7XG4gICAgICAgIHZhciBiZ1NvdW5kID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdTb3VuZFwiKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhiZ011c2ljKTtcbiAgICAgICAgaWYoYmdNdXNpYyAhPSAnJykge1xuICAgICAgICAgICAgaWYgKHBhcnNlSW50KGJnTXVzaWMpID09IDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tdXNpY09uID0gMTtcbiAgICAgICAgICAgICAgICB0aGlzLm11c2ljLmdldENoaWxkQnlOYW1lKCdtdXNpY19vbicpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5tdXNpYy5nZXRDaGlsZEJ5TmFtZSgnbXVzaWNfb2ZmJykuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tdXNpY09uID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLm11c2ljLmdldENoaWxkQnlOYW1lKCdtdXNpY19vbicpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMubXVzaWMuZ2V0Q2hpbGRCeU5hbWUoJ211c2ljX29mZicpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYoYmdTb3VuZCA9PSAwKXsgLy8g5aaC5p6c6IOM5pmv6Z+z5pWI5piv5YWz6Zet55qEXG4gICAgICAgICAgICBpZiAocGFyc2VJbnQoYmdTb3VuZCkgPT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NvdW5kc09uID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLnNvdW5kcy5nZXRDaGlsZEJ5TmFtZSgnc291bmRzX29uJykuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5zb3VuZHMuZ2V0Q2hpbGRCeU5hbWUoJ3NvdW5kc19vZmYnKS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc291bmRzT24gPSAxO1xuICAgICAgICAgICAgICAgIHRoaXMuc291bmRzLmdldENoaWxkQnlOYW1lKCdzb3VuZHNfb24nKS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuc291bmRzLmdldENoaWxkQnlOYW1lKCdzb3VuZHNfb2ZmJykuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bSh0aGlzLl9zb3VuZHNPbik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGNsaWNrV3g6IGZ1bmN0aW9uKCl7ICAvL+eCueWHu+W+ruS/oVxuICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XG4gICAgICAgIHRoaXMuc2hhcmVCZy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnd4LmFjdGl2ZSA9IHRydWU7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHRpdGxlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzaGFyZVRpdGxlJyk7XG4gICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGVzYycpO1xuICAgICAgICB2YXIgcmVjb3JkSWQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JlY29yZElkJyk7XG4gICAgICAgIHZhciByb29tSWQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Jvb21JZCcpO1xuICAgICAgICB2YXIgaWQ9ICcnO1xuICAgICAgICBpZihyb29tSWQpe1xuICAgICAgICAgICAgaWQgPSAncm9vbUlkPScrcm9vbUlkO1xuICAgICAgICB9XG4gICAgICAgIGlmKHJlY29yZElkKXtcbiAgICAgICAgICAgIGlkID0gJ3JlY29yZElkPScrcmVjb3JkSWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUZyaWVuZDpkZXNjcmlwdGlvbjpcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICB2YXIgc3RyID0gXCIoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVZcIjtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlRnJpZW5kXCIsc3RyLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICB9LFxuICAgIGNsaWNrUHlxOiBmdW5jdGlvbigpeyAvL+eCueWHu+aci+WPi+WciFxuICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XG4gICAgICAgIHRoaXMuc2hhcmVCZy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnB5cS5hY3RpdmUgPSB0cnVlO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHZhciB0aXRsZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2hhcmVUaXRsZScpO1xuICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Rlc2MnKTtcbiAgICAgICAgdmFyIHJlY29yZElkID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyZWNvcmRJZCcpO1xuICAgICAgICB2YXIgcm9vbUlkID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyb29tSWQnKTtcbiAgICAgICAgdmFyIGlkPSAnJztcbiAgICAgICAgaWYocm9vbUlkKXtcbiAgICAgICAgICAgIGlkID0gJ3Jvb21JZD0nK3Jvb21JZDtcbiAgICAgICAgfVxuICAgICAgICBpZihyZWNvcmRJZCl7XG4gICAgICAgICAgICBpZCA9ICdyZWNvcmRJZD0nK3JlY29yZElkO1xuICAgICAgICB9XG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVIYWxsVGltZWxpbmU6ZGVzY3JpcHRpb246XCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcbiAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZFxuICAgICAgICAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLHN0ciwgaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgfSxcblxuICAgIGNsaWNrc2hhcmVCZzogZnVuY3Rpb24oKXsgIC8vIOeCueWHu+WIhuS6q+iDjOaZr+WbvlxuICAgICAgdGhpcy5zaGFyZUJnLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy53eC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMucHlxLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG4gICAgY2xpY2tNdXNpYyA6ZnVuY3Rpb24oKXsgICAvL+eCueWHu+mfs+S5kFxuICAgICAgdGhpcy5tdXNpYy5jaGlsZHJlblsxXS5hY3RpdmUgPSAodGhpcy5fbXVzaWNPbiA9ICF0aGlzLl9tdXNpY09uKTsgICBcbiAgICAgIHRoaXMubXVzaWMuY2hpbGRyZW5bMl0uYWN0aXZlID0gIXRoaXMuX211c2ljT247XG4gICAgICAgIHZhciB2b2x1bWUgPSAwO1xuICAgICAgaWYodGhpcy5fbXVzaWNPbil7XG4gICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5zZXRCZ011c2ljVm9sdW1uKDEpO1xuICAgICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5wbGF5TXVzaWMoKTtcbiAgICAgICAgICB2b2x1bWUgPSAxO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5zZXRCZ011c2ljVm9sdW1uKDApO1xuICAgICAgICAgIHZvbHVtZSA9IDA7XG4gICAgICB9XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImJnTXVzaWNcIix2b2x1bWUpO1xuICAgIH0sXG5cbiAgICBjbGlja1NvdW5kcyA6ZnVuY3Rpb24oKXsgIC8v54K55Ye75LqG6Z+z5pWIXG4gICAgICB0aGlzLnNvdW5kcy5jaGlsZHJlblsxXS5hY3RpdmUgPSAodGhpcy5fc291bmRzT24gPSAhdGhpcy5fc291bmRzT24pO1xuICAgICAgdGhpcy5zb3VuZHMuY2hpbGRyZW5bMl0uYWN0aXZlID0gIXRoaXMuX3NvdW5kc09uO1xuICAgICAgdmFyIHZvbHVtZT0wO1xuICAgICAgaWYodGhpcy5fc291bmRzT24pe1xuICAgICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bSgxKTtcbiAgICAgICAgdm9sdW1lID0gMTtcbiAgICAgIH1lbHNle1xuICAgICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bSgwKTtcbiAgICAgICAgdm9sdW1lID0gMDtcbiAgICAgIH1cbiAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImJnU291bmRcIix2b2x1bWUpO1xuICAgIH0sXG4gICAgY2xpY2tTZXR0aW5nOmZ1bmN0aW9uKCl7ICAvL+eCueWHu+iuvue9rlxuICAgICAgICBcbiAgICB9LFxuICAgIF9pbml0U2xpZGVyczogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5faW5pdFNsaWRlckV2ZW50cygpO1xuXG4gICAgICBsZXQgbXVzaWNWYWwgPSBNYW5hZ2VyLmdldE11c2ljVmFsdWUoKTtcbiAgICAgIGxldCBlZmZlY3RWYWwgPSBNYW5hZ2VyLmdldE11c2ljRWZmZWN0VmFsdWUoKTtcblxuICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnNldEJnTXVzaWNWb2x1bW4obXVzaWNWYWwpO1xuICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnNldEVmZmVjdE11c2ljVm9sdW0oZWZmZWN0VmFsKTtcblxuICAgICAgdGhpcy5tdXNpY1NsaWRlci5nZXRDb21wb25lbnQoJ3NsaWRlcicpLnNldFZhbHVlKG11c2ljVmFsKTtcbiAgICAgIHRoaXMuZWZmZWN0U2xpZGVyLmdldENvbXBvbmVudCgnc2xpZGVyJykuc2V0VmFsdWUoZWZmZWN0VmFsKTtcbiAgICB9LFxuXG4gICAgX2luaXRTbGlkZXJFdmVudHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgIHRoaXMubXVzaWNTbGlkZXIuZ2V0Q29tcG9uZW50KCdzbGlkZXInKS5vblZhbHVlQ2hhbmdlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgTWFuYWdlci5zZXRNdXNpY1ZhbHVlKHZhbHVlKTtcbiAgICAgICAgc2VsZi5fYXVkaW9NYW5hZ2VyLnNldEJnTXVzaWNWb2x1bW4odmFsdWUpO1xuICAgICAgfTtcblxuICAgICAgdGhpcy5lZmZlY3RTbGlkZXIuZ2V0Q29tcG9uZW50KCdzbGlkZXInKS5vblZhbHVlQ2hhbmdlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgTWFuYWdlci5zZXRNdXNpY0VmZmVjdFZhbHVlKHZhbHVlKTtcbiAgICAgICAgc2VsZi5fYXVkaW9NYW5hZ2VyLnNldEVmZmVjdE11c2ljVm9sdW0odmFsdWUpO1xuICAgICAgfTtcbiAgICB9LFxuXG4gICAgY2xpY2tTd2l0Y2g6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBoaWRlU3dpdGNoOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLmJ0blN3aXRjaEFjY291bnQpIHtcbiAgICAgICAgdGhpcy5idG5Td2l0Y2hBY2NvdW50Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSxcbn0pO1xuIiwibGV0IFNwcml0ZUhlbHBlciA9IHtcbiAgc2V0SW1hZ2VVcmw6IGZ1bmN0aW9uIChzcHJpdGUsIHVybCkge1xuICAgIGlmICh1cmwuZW5kc1dpdGgoXCJwbmdcIikgfHwgdXJsLmVuZHNXaXRoKFwianBnXCIpIHx8IHVybC5lbmRzV2l0aChcImdpZlwiKSkge1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vdXJsID0gdXJsICsgXCIucG5nXCI7XG4gICAgfVxuXG4gICAgY2MubG9hZGVyLmxvYWQoe3VybDp1cmwsdHlwZTpcImpwZ1wifSwgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZShkYXRhKTtcbiAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGZyYW1lO1xuICAgIH0pO1xuICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTcHJpdGVIZWxwZXI7XG4iLCIvLyDnu5kgU3RyaW5nIOa3u+WKoOWKn+iDvVxuXG4vLyBzdHIuc3RhcnRzV2l0aChcIlwiKTtcbi8vIHN0ci5lbmRzV2l0aChcIlwiKTtcblxuaWYgKCFTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGgpIHtcbiAgKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JzsgLy8gbmVlZGVkIHRvIHN1cHBvcnQgYGFwcGx5YC9gY2FsbGAgd2l0aCBgdW5kZWZpbmVkYC9gbnVsbGBcbiAgICB2YXIgZGVmaW5lUHJvcGVydHkgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAvLyBJRSA4IG9ubHkgc3VwcG9ydHMgYE9iamVjdC5kZWZpbmVQcm9wZXJ0eWAgb24gRE9NIGVsZW1lbnRzXG4gICAgICB0cnkge1xuICAgICAgICB2YXIgb2JqZWN0ID0ge307XG4gICAgICAgIHZhciAkZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG4gICAgICAgIHZhciByZXN1bHQgPSAkZGVmaW5lUHJvcGVydHkob2JqZWN0LCBvYmplY3QsIG9iamVjdCkgJiYgJGRlZmluZVByb3BlcnR5O1xuICAgICAgfSBjYXRjaChlcnJvcikge31cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSgpKTtcbiAgICB2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcbiAgICB2YXIgc3RhcnRzV2l0aCA9IGZ1bmN0aW9uKHNlYXJjaCkge1xuICAgICAgaWYgKHRoaXMgPT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBUeXBlRXJyb3IoKTtcbiAgICAgIH1cbiAgICAgIHZhciBzdHJpbmcgPSBTdHJpbmcodGhpcyk7XG4gICAgICBpZiAoc2VhcmNoICYmIHRvU3RyaW5nLmNhbGwoc2VhcmNoKSA9PSAnW29iamVjdCBSZWdFeHBdJykge1xuICAgICAgICB0aHJvdyBUeXBlRXJyb3IoKTtcbiAgICAgIH1cbiAgICAgIHZhciBzdHJpbmdMZW5ndGggPSBzdHJpbmcubGVuZ3RoO1xuICAgICAgdmFyIHNlYXJjaFN0cmluZyA9IFN0cmluZyhzZWFyY2gpO1xuICAgICAgdmFyIHNlYXJjaExlbmd0aCA9IHNlYXJjaFN0cmluZy5sZW5ndGg7XG4gICAgICB2YXIgcG9zaXRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDtcbiAgICAgIC8vIGBUb0ludGVnZXJgXG4gICAgICB2YXIgcG9zID0gcG9zaXRpb24gPyBOdW1iZXIocG9zaXRpb24pIDogMDtcbiAgICAgIGlmIChwb3MgIT0gcG9zKSB7IC8vIGJldHRlciBgaXNOYU5gXG4gICAgICAgIHBvcyA9IDA7XG4gICAgICB9XG4gICAgICB2YXIgc3RhcnQgPSBNYXRoLm1pbihNYXRoLm1heChwb3MsIDApLCBzdHJpbmdMZW5ndGgpO1xuICAgICAgLy8gQXZvaWQgdGhlIGBpbmRleE9mYCBjYWxsIGlmIG5vIG1hdGNoIGlzIHBvc3NpYmxlXG4gICAgICBpZiAoc2VhcmNoTGVuZ3RoICsgc3RhcnQgPiBzdHJpbmdMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIGluZGV4ID0gLTE7XG4gICAgICB3aGlsZSAoKytpbmRleCA8IHNlYXJjaExlbmd0aCkge1xuICAgICAgICBpZiAoc3RyaW5nLmNoYXJDb2RlQXQoc3RhcnQgKyBpbmRleCkgIT0gc2VhcmNoU3RyaW5nLmNoYXJDb2RlQXQoaW5kZXgpKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIGlmIChkZWZpbmVQcm9wZXJ0eSkge1xuICAgICAgZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ3N0YXJ0c1dpdGgnLCB7XG4gICAgICAgICd2YWx1ZSc6IHN0YXJ0c1dpdGgsXG4gICAgICAgICdjb25maWd1cmFibGUnOiB0cnVlLFxuICAgICAgICAnd3JpdGFibGUnOiB0cnVlXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoID0gc3RhcnRzV2l0aDtcbiAgICB9XG4gIH0oKSk7XG59XG5cbi8vIHN0ci5lbmRzV2l0aChcIlwiKTtcbmlmICghU3RyaW5nLnByb3RvdHlwZS5lbmRzV2l0aCkge1xuXHQoZnVuY3Rpb24oKSB7XG5cdFx0J3VzZSBzdHJpY3QnOyAvLyBuZWVkZWQgdG8gc3VwcG9ydCBgYXBwbHlgL2BjYWxsYCB3aXRoIGB1bmRlZmluZWRgL2BudWxsYFxuXHRcdHZhciBkZWZpbmVQcm9wZXJ0eSA9IChmdW5jdGlvbigpIHtcblx0XHRcdC8vIElFIDggb25seSBzdXBwb3J0cyBgT2JqZWN0LmRlZmluZVByb3BlcnR5YCBvbiBET00gZWxlbWVudHNcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHZhciBvYmplY3QgPSB7fTtcblx0XHRcdFx0dmFyICRkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcblx0XHRcdFx0dmFyIHJlc3VsdCA9ICRkZWZpbmVQcm9wZXJ0eShvYmplY3QsIG9iamVjdCwgb2JqZWN0KSAmJiAkZGVmaW5lUHJvcGVydHk7XG5cdFx0XHR9IGNhdGNoKGVycm9yKSB7fVxuXHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHR9KCkpO1xuXHRcdHZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuXHRcdHZhciBlbmRzV2l0aCA9IGZ1bmN0aW9uKHNlYXJjaCkge1xuXHRcdFx0aWYgKHRoaXMgPT0gbnVsbCkge1xuXHRcdFx0XHR0aHJvdyBUeXBlRXJyb3IoKTtcblx0XHRcdH1cblx0XHRcdHZhciBzdHJpbmcgPSBTdHJpbmcodGhpcyk7XG5cdFx0XHRpZiAoc2VhcmNoICYmIHRvU3RyaW5nLmNhbGwoc2VhcmNoKSA9PSAnW29iamVjdCBSZWdFeHBdJykge1xuXHRcdFx0XHR0aHJvdyBUeXBlRXJyb3IoKTtcblx0XHRcdH1cblx0XHRcdHZhciBzdHJpbmdMZW5ndGggPSBzdHJpbmcubGVuZ3RoO1xuXHRcdFx0dmFyIHNlYXJjaFN0cmluZyA9IFN0cmluZyhzZWFyY2gpO1xuXHRcdFx0dmFyIHNlYXJjaExlbmd0aCA9IHNlYXJjaFN0cmluZy5sZW5ndGg7XG5cdFx0XHR2YXIgcG9zID0gc3RyaW5nTGVuZ3RoO1xuXHRcdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdHZhciBwb3NpdGlvbiA9IGFyZ3VtZW50c1sxXTtcblx0XHRcdFx0aWYgKHBvc2l0aW9uICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHQvLyBgVG9JbnRlZ2VyYFxuXHRcdFx0XHRcdHBvcyA9IHBvc2l0aW9uID8gTnVtYmVyKHBvc2l0aW9uKSA6IDA7XG5cdFx0XHRcdFx0aWYgKHBvcyAhPSBwb3MpIHsgLy8gYmV0dGVyIGBpc05hTmBcblx0XHRcdFx0XHRcdHBvcyA9IDA7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR2YXIgZW5kID0gTWF0aC5taW4oTWF0aC5tYXgocG9zLCAwKSwgc3RyaW5nTGVuZ3RoKTtcblx0XHRcdHZhciBzdGFydCA9IGVuZCAtIHNlYXJjaExlbmd0aDtcblx0XHRcdGlmIChzdGFydCA8IDApIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGluZGV4ID0gLTE7XG5cdFx0XHR3aGlsZSAoKytpbmRleCA8IHNlYXJjaExlbmd0aCkge1xuXHRcdFx0XHRpZiAoc3RyaW5nLmNoYXJDb2RlQXQoc3RhcnQgKyBpbmRleCkgIT0gc2VhcmNoU3RyaW5nLmNoYXJDb2RlQXQoaW5kZXgpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9O1xuXHRcdGlmIChkZWZpbmVQcm9wZXJ0eSkge1xuXHRcdFx0ZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ2VuZHNXaXRoJywge1xuXHRcdFx0XHQndmFsdWUnOiBlbmRzV2l0aCxcblx0XHRcdFx0J2NvbmZpZ3VyYWJsZSc6IHRydWUsXG5cdFx0XHRcdCd3cml0YWJsZSc6IHRydWVcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoID0gZW5kc1dpdGg7XG5cdFx0fVxuXHR9KCkpO1xufVxuIiwiY29uc3QgU3ByaXRlSGVscGVyID0gcmVxdWlyZSgnU3ByaXRlSGVscGVyJyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBhdmF0YXJTcHJpdGU6IGNjLlNwcml0ZSxcbiAgICAgICAgbGFiZWxVc2VySWQ6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFNjb3JlOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxOaWNrbmFtZTogY2MuTGFiZWwsXG5cbiAgICAgICAgX2Rlc2tJbmZvOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBzZXRVc2VySW5mbzogZnVuY3Rpb24gKHVzZXIsIGRlc2tJbmZvKSB7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgdG90YWxTY29yZSA9IHVzZXIudG90YWxTY29yZTtcbiAgICAgIGlmIChkZXNrSW5mbyAmJiAoKGRlc2tJbmZvLnNldHRpbmcxID09IDApIHx8IChkZXNrSW5mby5zZXR0aW5nMSA9PSAxKSkpIHtcbiAgICAgICAgbGV0IGJhc2VTY29yZSA9IChkZXNrSW5mby5zZXR0aW5nMSA9PSAwKSA/IDEwMCA6IDIwMDtcbiAgICAgICAgdG90YWxTY29yZSA9IHRvdGFsU2NvcmUgLSBiYXNlU2NvcmU7XG4gICAgICB9XG5cbiAgICAgIFNwcml0ZUhlbHBlci5zZXRJbWFnZVVybCh0aGlzLmF2YXRhclNwcml0ZSwgdXNlci5hdmF0YXJVcmwpO1xuICAgICAgdGhpcy5sYWJlbFVzZXJJZC5zdHJpbmcgPSBcIlwiICsgdXNlci5pZDtcbiAgICAgIHRoaXMubGFiZWxTY29yZS5zdHJpbmcgPSAodG90YWxTY29yZSA+IDApID8gKFwiKyBcIiArIHRvdGFsU2NvcmUpIDogKFwiLSBcIiArIHRvdGFsU2NvcmUgKiAtMSk7XG4gICAgICBpZiAodG90YWxTY29yZSA9PSAwKSB7XG4gICAgICAgIHRoaXMubGFiZWxTY29yZS5zdHJpbmcgPSBcIjBcIjtcbiAgICAgIH1cbiAgICAgIHRoaXMubGFiZWxOaWNrbmFtZS5zdHJpbmcgPSB1c2VyLm5pY2tuYW1lO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcbmNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgaXRlbUxheW91dDogY2MuTGF5b3V0LFxuICAgICAgICBpdGVtUHJlZmFiOiBjYy5QcmVmYWIsXG4gICAgICAgIHRpbWVMYWJlbDpjYy5MYWJlbCwgICAvLyDml7bpl7RcbiAgICAgICAganVzaHVMYWJlbDpjYy5MYWJlbCwgIC8vIOWxgOaVsFxuICAgICAgICByb29tSWQ6Y2MuTGFiZWwsICAgICAgLy8g5oi/6Ze05Y+3XG4gICAgICAgIG5pY2tuYW1lTGFiZWxzOmNjLkxhYmVsLFxuICAgICAgICByZWNvcmRJbmZvX3N2aWV3OltjYy5Ob2RlXSxcblxuICAgICAgICBzaGFyckJnOmNjLk5vZGUsXG4gICAgICAgIGJ0bldlaVhpbjpjYy5Ob2RlLFxuICAgICAgICBidG5Hb25nWHVvSGFvOmNjLk5vZGUsXG4gICAgICAgIGJ0blpodVNob3U6Y2MuTm9kZSxcbiAgICAgICAgYnRuWm9uZ0ZlbjpjYy5Ob2RlLFxuXG4gICAgICAgIHN1YW5mZW5fc3ZpZXc6Y2MuTm9kZSxcbiAgICAgICAgc3VhbkZlblByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBzdWFuRmVuQmdQcmVmYWI6IGNjLlByZWZhYixcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgb25EaXNhYmxlOmZ1bmN0aW9uKCl7XG4gICAgICAgIC8vaWYoY2Muc3lzLmlzQnJvd3Nlcil7XG4gICAgICAgIC8vXG4gICAgICAgICAgICB2YXIgc2hhcmVUaXRsZSA9ICflvIDmiL/njqlb5aSn5LyX5Y2B5LiJ5rC0XSc7XG4gICAgICAgICAgICB2YXIgZGVzYyA9ICflvIDlpb3miL/kuobvvIzlsLHnrYnkvaDku6zkuIDotbfmnaVb5aSn5LyX5Y2B5LiJ5rC0XeWVpu+8geaZmuS6huS9jee9ruWwseayoeS6huWTn34nOyBcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2hhcmVUaXRsZScsc2hhcmVUaXRsZSk7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Rlc2MnLGRlc2MpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJzaGFyZVRpdGxlXCIpO1xuICAgICAgICAgICAgLy8gY2Muc3lzLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiZGVzY1wiKTtcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInJlY29yZElkXCIpO1xuICAgICAgICAgICAgLy9jYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJyb29tSWRcIiwnJyk7XG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LnNoYXJlVG9UaW1lTGluZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYod2luZG93LnNoYXJlVG9TZXNzaW9uKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LnNoYXJlVG9TZXNzaW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIC8vfVxuXG4gICAgfSxcbiAgICBqczogZnVuY3Rpb24oc2V0dGluZzIpe1xuICAgICAgICB2YXIganVzaHUgPSA1O1xuICAgICAgICBzd2l0Y2goc2V0dGluZzIpe1xuICAgICAgICAgICAgY2FzZSAwOiBqdXNodSA9IDU7IGJyZWFrO2Nhc2UgMToganVzaHUgPSAxMDsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6IGp1c2h1ID0gMjA7IGJyZWFrO2Nhc2UgMzoganVzaHUgPSAzMDsgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGp1c2h1O1xuICAgIH0sXG5cbiAgICBjcmVhdG9yIDpmdW5jdGlvbihjcmVhdG9yLHBsYXllcnMpeyAgICAvL+WIm+aIv+iAhVxuICAgICAgICBmb3IodmFyIGkgPTA7IGk8cGxheWVycy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGlmKHBsYXllcnNbaV0uaWQgPT0gY3JlYXRvcil7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX2NsaWNrQnRuIDpmdW5jdGlvbigpe1xuICAgICAgICB0aGlzLmJ0blpodVNob3UuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5idG5ab25nRmVuLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBjbGlja1pvbmdGZW4gOmZ1bmN0aW9uKCl7XG5cbiAgICAgICAgdGhpcy5idG5aaHVTaG91LmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5idG5ab25nRmVuLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMucmVjb3JkSW5mb19zdmlldy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7bm9kZS5hY3RpdmUgPSB0cnVlO30pO1xuXG4gICAgICAgIHRoaXMuc3VhbmZlbl9zdmlldy5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuICAgIF9nbG9iYWxNc2c6ZnVuY3Rpb24ocmVjb3JkSW5mbyl7XG4gICAgICAgIC8vaWYoY2Muc3lzLmlzQnJvd3Nlcikge1xuICAgICAgICAgICAgdmFyIHJvb21JZCA9XCLmiL/pl7Tlj7fvvJpcIityZWNvcmRJbmZvLnJvb21JZDtcbiAgICAgICAgICAgIHZhciBwaiA9IFtcIjUgXCIsXCIxMCBcIixcIjIwIFwiXTsgIFxuICAgICAgICAgICAgdmFyIGpzID0gXCLlsYDmlbDvvJpcIitwaltyZWNvcmRJbmZvLnNldHRpbmcxLTJdO1xuICAgICAgICAgICAgdmFyIHRpbWUgPSBcIuaXtumXtO+8mlwiKyhyZWNvcmRJbmZvLmNyZWF0ZUF0P3JlY29yZEluZm8uY3JlYXRlQXQ6cmVjb3JkSW5mby5jcmVhdGVUaW1lKTtcbiAgICAgICAgICAgIHZhciBzaGFyZVRpdGxlID0gXCJb5aSn5LyX5Y2B5LiJ5rC0XeaImOe7qVwiO1xuICAgICAgICAgICAgdmFyIGRlc2MgPSByb29tSWQranMrdGltZStcIiDngrnlh7vmn6XnnIvor6bmg4VcIjtcbiAgICAgICAgICAgIHZhciByZWNvcmRJZCA9IChyZWNvcmRJbmZvLmlkIT11bmRlZmluZWQpP3JlY29yZEluZm8uaWQ6cmVjb3JkSW5mby5yZWNvcmRJZDsgIFxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwic2hhcmVUaXRsZVwiLHNoYXJlVGl0bGUpO1xuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiZGVzY1wiLGRlc2MpO1xuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicmVjb3JkSWRcIixyZWNvcmRJZCk7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJyb29tSWRcIiwnJyk7XG5cbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvVGltZUxpbmUpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1Nlc3Npb24pIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1Nlc3Npb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgLy99XG4gICAgfSxcbiAgICAvL+Wkp+WxgFxuICAgIHNldFBsYXllckluZm9zOiBmdW5jdGlvbiAocGxheWVySW5mb3MsIGRlc2tJbmZvKXtcbiAgICAgICAgcGxheWVySW5mb3Muc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBiLnRvdGFsU2NvcmUtYS50b3RhbFNjb3JlfSk7IC8vIOaOkuW6j1xuICAgICAgICAvLyBjYy5sb2cocGxheWVySW5mb3MpXG4gICAgICAgIC8vIGNjLmxvZyhkZXNrSW5mbylcbiAgICAgICAgLy8gY2MubG9nKCctLTY1JylcbiAgICAgICAgIFxuICAgICAgICB0aGlzLl9nbG9iYWxNc2coZGVza0luZm8pO1xuICAgICAgICB0aGlzLnJlY29yZEluZm9fc3ZpZXcuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge25vZGUuYWN0aXZlID0gdHJ1ZTt9KTtcblxuICAgICAgICB0aGlzLnN1YW5mZW5fc3ZpZXcuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5idG5aaHVTaG91LmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5idG5ab25nRmVuLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gcGxheWVySW5mb3M7XG5cbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcblxuICAgICAgICB2YXIgY3JlYXRlSWQgPSBkZXNrSW5mby5jcmVhdGVVc2VySWQ/IGRlc2tJbmZvLmNyZWF0ZVVzZXJJZDogZGVza0luZm8uY3JlYXRlSWQ7XG5cbiAgICAgICAgdmFyIG5pY2tuYW1lID0gcGxheWVySW5mb3NbIHRoaXMuY3JlYXRvcihjcmVhdGVJZCwgcGxheWVySW5mb3MpIF0ubmlja25hbWU7XG5cbiAgICAgICAgdGhpcy5yb29tSWQuc3RyaW5nID0gZGVza0luZm8ucm9vbUlkO1xuXG4gICAgICAgIHZhciBjcmVhdGVBdCA9IGRlc2tJbmZvLmNyZWF0ZUF0PyBkZXNrSW5mby5jcmVhdGVBdDogZGVza0luZm8uY3JlYXRlVGltZTtcblxuICAgICAgICB0aGlzLnRpbWVMYWJlbC5zdHJpbmcgPSBjcmVhdGVBdC5zdWJzdHIoMCwxMSk7XG5cbiAgICAgICAgdGhpcy5qdXNodUxhYmVsLnN0cmluZyA9IHRoaXMuanMoZGVza0luZm8uc2V0dGluZzEtMik7XG5cbiAgICAgICAgdGhpcy5uaWNrbmFtZUxhYmVscy5zdHJpbmcgPSBuaWNrbmFtZTtcblxuICAgICAgICB0aGlzLml0ZW1MYXlvdXQubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgIHBsYXllckluZm9zLmZvckVhY2goZnVuY3Rpb24gKHVzZXIpIHtcblxuICAgICAgICAgICAgbGV0IGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLml0ZW1QcmVmYWIpO1xuXG4gICAgICAgICAgICBpdGVtLmdldENvbXBvbmVudCgnVG90YWxHYW1lUmVzdWx0SXRlbScpLnNldFVzZXJJbmZvKHVzZXIsIGRlc2tJbmZvKTtcblxuICAgICAgICAgICAgaWYoZGVza0luZm8uY3JlYXRlVXNlcklkID09IHVzZXIuaWQgfHwgZGVza0luZm8uY3JlYXRlSWQgPT0gdXNlci5pZCl7XG5cbiAgICAgICAgICAgICAgICBpdGVtLmNoaWxkcmVuWzFdLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAgIH1lbHNle1xuXG4gICAgICAgICAgICAgICAgaXRlbS5jaGlsZHJlblsxXS5jaGlsZHJlblswXS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLml0ZW1MYXlvdXQubm9kZS5hZGRDaGlsZChpdGVtKTtcblxuICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgfSxcblxuICAgIC8v566X5YiG6IO95omLXG4gICAgY2xpY2tTdWFuRmVuOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdGhpcy5idG5aaHVTaG91LmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuYnRuWm9uZ0Zlbi5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMucmVjb3JkSW5mb19zdmlldy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7bm9kZS5hY3RpdmUgPSBmYWxzZTt9KTtcblxuICAgICAgICB0aGlzLnN1YW5mZW5fc3ZpZXcuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICB2YXIgcGxheWVyc1JpZ3RoID0gdGhpcy5fcGxheWVySW5mb3MuZmlsdGVyKGZ1bmN0aW9uIChwbGF5ZXIpIHtyZXR1cm4gcGxheWVyLnRvdGFsU2NvcmUgPiAwO30pO1xuXG4gICAgICAgIHZhciBwbGF5ZXJzTGVmdCA9IHRoaXMuX3BsYXllckluZm9zLmZpbHRlcihmdW5jdGlvbiAocGxheWVyKSB7cmV0dXJuIHBsYXllci50b3RhbFNjb3JlIDwgMDt9KTtcblxuICAgICAgICB2YXIgcGxheWVyc1JpZ3RoU2NvcmUgPSBwbGF5ZXJzUmlndGgubWFwKGZ1bmN0aW9uIChwbGF5ZXIpIHtyZXR1cm4gcGxheWVyLnRvdGFsU2NvcmU7fSk7XG5cbiAgICAgICAgdmFyIHBsYXllcnNMZWZ0U2NvcmUgPSBwbGF5ZXJzTGVmdC5tYXAoZnVuY3Rpb24gKHBsYXllcikge3JldHVybiBwbGF5ZXIudG90YWxTY29yZSAqIC0xO30pO1xuXG4gICAgICAgIHZhciBwbGF5ZXJzSW5kZXggPSBbXSxcblxuICAgICAgICAgICAgYXJycyA9IFtwbGF5ZXJzUmlndGhTY29yZS5maWx0ZXIoZnVuY3Rpb24oaSl7cmV0dXJuIGk7fSkscGxheWVyc0xlZnRTY29yZS5maWx0ZXIoZnVuY3Rpb24oaSl7cmV0dXJuIGk7fSldLFxuXG4gICAgICAgICAgICBpbmRleHMgPSBwbGF5ZXJzTGVmdFNjb3JlLmxlbmd0aCA+IHBsYXllcnNSaWd0aFNjb3JlLmxlbmd0aD8gMDogMTsvLzHmmK/otaLnmoTkurogMOi+k+eahOS6ulxuXG4gICAgICAgIC8vIGZvcih2YXIgaSA9IDA7aSA8IGFycnNbaW5kZXhzXS5sZW5ndGg7IGkrKyl7XG5cbiAgICAgICAgLy8gICAgIHZhciBzY29yZSA9IGFycnNbaW5kZXhzXVtpXTtcblxuICAgICAgICAvLyAgICAgdmFyIGQgPSB0aGlzLmdldENvbWJCeVN1bShhcnJzW2luZGV4cz09MT8wOjFdLCBzY29yZSlbMF0gfHwgW107XG5cbiAgICAgICAgLy8gICAgIGlmKGQubGVuZ3RoID4gMCl7XG5cbiAgICAgICAgLy8gICAgICAgICBwbGF5ZXJzSW5kZXgucHVzaChbc2NvcmUsZF0pO1xuXG4gICAgICAgIC8vICAgICAgICAgZC5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7XG5cbiAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGluZGV4ID0gYXJyc1tpbmRleHM9PTE/MDoxXS5pbmRleE9mKHMpO1xuXG4gICAgICAgIC8vICAgICAgICAgICAgIGlmKGluZGV4ICE9IC0xKSBhcnJzW2luZGV4cz09MT8wOjFdLnNwbGljZShpbmRleCwxKTtcblxuICAgICAgICAvLyAgICAgICAgIH0pO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyB9XG5cbiAgICAgICAgLy8gaWYocGxheWVyc0luZGV4Lmxlbmd0aCA9PSAwKSBpbmRleHMgPSAyO1xuICAgICAgICBpbmRleHMgPSAyXG4gICAgICAgIHRoaXMuc3VhbmZlbl9zdmlldy5jaGlsZHJlblswXS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgIHBsYXllcnNMZWZ0LmZvckVhY2goZnVuY3Rpb24gKHVzZXIsIGluZGV4KSB7XG5cbiAgICAgICAgICAgIHZhciBzdWFuRmVuQmdQcmVmYWIgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnN1YW5GZW5CZ1ByZWZhYik7XG5cbiAgICAgICAgICAgIHN1YW5GZW5CZ1ByZWZhYi5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICB0aGlzLl9jdGFyZVByZWZhYigxICxzdWFuRmVuQmdQcmVmYWIsIHVzZXIsIHVzZXIudG90YWxTY29yZSwgdGhpcy5fZGVza0luZm8gLC0yMDAgLDApO1xuXG4gICAgICAgICAgICB2YXIgeCA9IDAsIHkgPSAwO1xuXG4gICAgICAgICAgICBpZihpbmRleHMgPT0gMSl7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IHBsYXllcnNJbmRleFtpbmRleF1bMV0ubGVuZ3RoOyBqKyspe1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gcGxheWVyc0luZGV4W2luZGV4XVsxXVtqXTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHBsYXllcnNSaWd0aFNjb3JlLmluZGV4T2Yocyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoZCAhPSAtMSl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbGF5cyA9IHBsYXllcnNSaWd0aC5zcGxpY2UoZCwxKVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyc1JpZ3RoU2NvcmUuc3BsaWNlKGQsMSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBsYXlzKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID49IDMpIHkgPSAtOTA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdWFuRmVuQmdQcmVmYWIuY2hpbGRyZW5Db3VudCA9PSAzKSB4ID0gMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID49IDUpIHkgPSAtMTgwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPT0gNSkgeCA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdGFyZVByZWZhYigwLCBzdWFuRmVuQmdQcmVmYWIsIHBsYXlzLCBwbGF5cy50b3RhbFNjb3JlLCB0aGlzLl9kZXNrSW5mbywgeCAseSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ICs9IDIwMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihpbmRleHMgPT0gMCl7XG4gICAgICAgICAgICAgICAgdmFyIGZlbiA9IHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlblswXS5nZXRDaGlsZEJ5TmFtZShcImZlblwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZy5zdWJzdHIoMykgKiAtMTtcblxuICAgICAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCBwbGF5ZXJzSW5kZXgubGVuZ3RoOyBqKyspe1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gcGxheWVyc0luZGV4W2pdO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gc1sxXS5pbmRleE9mKGZlbik7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHEgPSBzWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB3ID0gcGxheWVyc1JpZ3RoU2NvcmUuaW5kZXhPZihxKTtcblxuICAgICAgICAgICAgICAgICAgICBpZihkICE9IC0xICYmIHcgIT0gLTEpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGxheXMgPSBwbGF5ZXJzUmlndGhbd107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2N0YXJlUHJlZmFiKDAsIHN1YW5GZW5CZ1ByZWZhYiwgcGxheXMsIHBsYXlzLnRvdGFsU2NvcmUsIHRoaXMuX2Rlc2tJbmZvLCB4LCB5LCBmZW4pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHEgPSBwbGF5ZXJzTGVmdFNjb3JlW2luZGV4XTtcbiAgICAgICAgICAgICAgICB2YXIgYWRkU2NvcmUgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgcGxheWVyc1JpZ3RoU2NvcmUubGVuZ3RoOyBqKyspe1xuICAgICAgICAgICAgICAgICAgICB2YXIgdyA9IHBsYXllcnNSaWd0aFNjb3JlW2pdO1xuICAgICAgICAgICAgICAgICAgICBpZihhZGRTY29yZSA8IHEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkU2NvcmUgKz0gdztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFkZFNjb3JlID4gcSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2godyAtIChhZGRTY29yZSAtIHEpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKHcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYocSAtIHcgPj0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyc1JpZ3RoU2NvcmVbal0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmKGFkZFNjb3JlID4gcSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJzUmlndGhTY29yZVtqXSA9IGFkZFNjb3JlIC0gcTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZm9yKHZhciB0ID0gMDsgdCA8IGFyci5sZW5ndGg7IHQrKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gYXJyW3RdO1xuICAgICAgICAgICAgICAgICAgICBpZihyID09IDApIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICBpZihzdWFuRmVuQmdQcmVmYWIuY2hpbGRyZW5Db3VudCA+PSAzKSB5ID0gLTkwO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID09IDMpIHggPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID49IDUpIHkgPSAtMTgwO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID09IDUpIHggPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwbGF5cyA9IHBsYXllcnNSaWd0aFt0XTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdGFyZVByZWZhYigwLCBzdWFuRmVuQmdQcmVmYWIsIHBsYXlzLCByLCB0aGlzLl9kZXNrSW5mbywgeCwgeSk7XG5cbiAgICAgICAgICAgICAgICAgICAgeCArPSAyMDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc3VhbmZlbl9zdmlldy5jaGlsZHJlblswXS5hZGRDaGlsZChzdWFuRmVuQmdQcmVmYWIpO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICB9LFxuXG4gICAgX2N0YXJlUHJlZmFiOiBmdW5jdGlvbiAoc2h1LCBub2RlLCB1c2VyLCB0b3RhbFNjb3JlLCBkZXNrSW5mbywgeCwgeSwgZmVuID0gbnVsbCkge1xuXG4gICAgICAgIHZhciBzdWFuRmVuUHJlZmFiID0gY2MuaW5zdGFudGlhdGUodGhpcy5zdWFuRmVuUHJlZmFiKTtcblxuICAgICAgICBzdWFuRmVuUHJlZmFiLmdldENoaWxkQnlOYW1lKFwiSURcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIklEOlwiK3VzZXIuaWQ7XG5cbiAgICAgICAgaWYoZGVza0luZm8uY3JlYXRlVXNlcklkID09IHVzZXIuaWQpc3VhbkZlblByZWZhYi5nZXRDaGlsZEJ5TmFtZShcIklEXCIpLmNvbG9yID0gbmV3IGNjLkNvbG9yKDIzNSwgMTE1LCAxMjIpO1xuXG4gICAgICAgIHN1YW5GZW5QcmVmYWIuZ2V0Q2hpbGRCeU5hbWUoXCJzaHVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBzaHUgPT0gMD8gXCLovpNcIjogXCJcIjtcblxuICAgICAgICB2YXIgc3RyID0gc2h1ID09IDA/IHRvdGFsU2NvcmUrXCLliIZcIjogXCLmgLvliIY6XCIrdG90YWxTY29yZTtcblxuICAgICAgICBpZihmZW4pIHN0ciA9IGZlbitcIuWIhlwiO1xuXG4gICAgICAgIHN1YW5GZW5QcmVmYWIuZ2V0Q2hpbGRCeU5hbWUoXCJmZW5cIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBzdHI7XG5cbiAgICAgICAgdmFyIHNwcml0ZSA9IHN1YW5GZW5QcmVmYWIuZ2V0Q2hpbGRCeU5hbWUoXCJoYWVkXCIpLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgIHZhciBoZWFkVXJsID0gdXNlci5hdmF0YXJVcmw7IC8vIOWktOWDj1VSTFxuXG4gICAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6aGVhZFVybCx0eXBlOlwianBnXCJ9LCBmdW5jdGlvbiAoZXJyLCB0ZXgpIHtcblxuICAgICAgICAgICAgaWYgKCFlcnIpIHtcblxuICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xuXG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gZnJhbWU7XG5cbiAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5oZWlnaHQgPSA1NTtcblxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLndpZHRoID0gNTU7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgICAgICBzdWFuRmVuUHJlZmFiLnggPSB4O1xuXG4gICAgICAgIHN1YW5GZW5QcmVmYWIueSA9IHk7XG5cbiAgICAgICAgbm9kZS5oZWlnaHQgPSA5MCArIHkgKiAtMTtcblxuICAgICAgICBub2RlLmFkZENoaWxkKHN1YW5GZW5QcmVmYWIpO1xuXG4gICAgfSxcblxuICAgIGNsaWNrRXhpdDogZnVuY3Rpb24gKCkge1xuICAgICAgICBTb2NrZXQuc2VuZE9uY2VBZ2FpbignZmFsc2UnLHRoaXMuX3VzZXJJZCk7XG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xuICAgIH0sXG5cbiAgICBjbGlja1NoYXJlV2VpQ2hhdDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgIHRoaXMuc2hhcnJCZy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNjcmVlblNoYXJlRnJpZW5kXCIsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICBlbHNlIHsvL0FuZHJvaWRcbiAgICAgICAgICAgICAgICAgIEtRTmF0aXZlSW52b2tlLnNjcmVlbnNob3RTaGFyZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgIH1cbiAgICB9LFxuICAgIGNsaWNrU2hhcmVCZyA6ZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNoYXJyQmcuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcbiAgICBjbGlja1NoYXJlUGVuZ1lvdVF1YW46IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNjcmVlblNoYXJlXCIsKTtcbiAgICAgIH1cbiAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNjcmVlblNoYXJlXCIsIFwiKClWXCIpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBnZXRDb21iQnlTdW06IGZ1bmN0aW9uIChhcnJheSxzdW0sdG9sZXJhbmNlLHRhcmdldENvdW50KSB7XG4gICAgICAgIHZhciB1dGlsID0ge1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgIGdldCBjb21iaW5hdGlvbiBmcm9tIGFycmF5XG4gICAgICAgICAgICAgICAgIGFycjogdGFyZ2V0IGFycmF5XG4gICAgICAgICAgICAgICAgIG51bTogY29tYmluYXRpb24gaXRlbSBsZW5ndGhcbiAgICAgICAgICAgICAgICAgcmV0dXJuOiBvbmUgYXJyYXkgdGhhdCBjb250YWluIGNvbWJpbmF0aW9uIGFycmF5c1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGdldENvbWJpbmF0aW9uOiBmdW5jdGlvbihhcnIsIG51bSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcj1bXTtcbiAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uIGYodCxhLG4pXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuPT0wKVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByLnB1c2godCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTAsbD1hLmxlbmd0aDsgaTw9bC1uOyBpKyspXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZih0LmNvbmNhdChhW2ldKSwgYS5zbGljZShpKzEpLCBuLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KShbXSxhcnIsbnVtKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAvL3Rha2UgYXJyYXkgaW5kZXggdG8gYSBhcnJheVxuICAgICAgICAgICAgICAgIGdldEFycmF5SW5kZXg6IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwO2k8YXJyYXkubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICByLnB1c2goaSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LGxvZ2ljID0ge1xuICAgICAgICAgICAgICAgIC8vc29ydCB0aGUgYXJyYXksdGhlbiBnZXQgd2hhdCdzIHdlIG5lZWRcbiAgICAgICAgICAgICAgICBpbml0OiBmdW5jdGlvbihhcnJheSxzdW0pIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jbG9uZSBhcnJheVxuICAgICAgICAgICAgICAgICAgICB2YXIgX2FycmF5ID0gYXJyYXkuY29uY2F0KCksXG4gICAgICAgICAgICAgICAgICAgICAgICByID0gW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgLy9zb3J0IGJ5IGFzY1xuICAgICAgICAgICAgICAgICAgICBfYXJyYXkuc29ydChmdW5jdGlvbihhLGIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgLSBiO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgYWxsIG51bWJlciB3aGVuIGl0J3MgbGVzcyB0aGFuIG9yIGVxdWFsIHN1bVxuICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7aTxfYXJyYXkubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihfYXJyYXlbaV08PXN1bSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgci5wdXNoKF9hcnJheVtpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgLy9pbXBvcnRhbnQgZnVuY3Rpb25cbiAgICAgICAgICAgICAgICBjb3JlOiBmdW5jdGlvbihhcnJheSxzdW0sYXJyYXlJbmRleCxjb3VudCxyKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgayA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21iQXJyYXkgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9zdW0gPSAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgX2NjYSA9IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgX2NhY2hlID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoY291bnQgPT0gX3JldHVybk1hcmspe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IGN1cnJlbnQgY291bnQgY29tYmluYXRpb25cbiAgICAgICAgICAgICAgICAgICAgY29tYkFycmF5ID0gdXRpbC5nZXRDb21iaW5hdGlvbihhcnJheUluZGV4LGNvdW50KTtcbiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwO2k8Y29tYkFycmF5Lmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NjYSA9IGNvbWJBcnJheVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9zdW0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NhY2hlID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NhbGN1bGF0ZSB0aGUgc3VtIGZyb20gY29tYmluYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihrID0gMDtrPF9jY2EubGVuZ3RoO2srKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N1bSArPSBhcnJheVtfY2NhW2tdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2FjaGUucHVzaChhcnJheVtfY2NhW2tdXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihNYXRoLmFicyhfc3VtLXN1bSkgPD0gX3RvbGVyYW5jZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgci5wdXNoKF9jYWNoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBsb2dpYy5jb3JlKGFycmF5LHN1bSxhcnJheUluZGV4LGNvdW50LTEscik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgciA9IFtdLFxuICAgICAgICAgICAgX2FycmF5ID0gW10sXG4gICAgICAgICAgICBfdGFyZ2V0Q291bnQgPSAwLFxuICAgICAgICAgICAgX3RvbGVyYW5jZSA9IDAsXG4gICAgICAgICAgICBfcmV0dXJuTWFyayA9IDA7XG5cbiAgICAgICAgLy9jaGVjayBkYXRhXG4gICAgICAgIF90YXJnZXRDb3VudCA9IHRhcmdldENvdW50IHx8IF90YXJnZXRDb3VudDtcbiAgICAgICAgX3RvbGVyYW5jZSA9IHRvbGVyYW5jZSB8fCBfdG9sZXJhbmNlO1xuXG4gICAgICAgIF9hcnJheSA9IGxvZ2ljLmluaXQoYXJyYXksc3VtKTtcbiAgICAgICAgaWYoX3RhcmdldENvdW50KXtcbiAgICAgICAgICAgIF9yZXR1cm5NYXJrID0gX3RhcmdldENvdW50LTE7XG4gICAgICAgIH1cblxuICAgICAgICBsb2dpYy5jb3JlKF9hcnJheSxzdW0sdXRpbC5nZXRBcnJheUluZGV4KF9hcnJheSksKF90YXJnZXRDb3VudCB8fCBfYXJyYXkubGVuZ3RoKSxyKTtcblxuICAgICAgICByZXR1cm4gcjtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBVc2VyTW9kZWxIZWxwZXIgPSB7XG4gIC8vIOeUqOaIt+aYr+WQpuW3suWHuueJjFxuICBpc1BsYXllZENhcmRzOiBmdW5jdGlvbiAodXNlcikge1xuICAgIGNjLmFzc2VydCh1c2VyKTtcblxuICAgIGlmICh1c2VyICYmIHVzZXIuY2FyZEluZm8gJiYgdXNlci5jYXJkSW5mby5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG5cbiAgLy8g55So5oi35piv5ZCm5bey5YeG5aSHXG4gIGlzVXNlclJlYWR5OiBmdW5jdGlvbiAodXNlcikge1xuICAgIHJldHVybiB1c2VyLnJlYWR5U3RhdHVzID09IHRydWU7XG4gIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFVzZXJNb2RlbEhlbHBlcjtcbiIsImNvbnN0IFNwcml0ZUhlbHBlciA9IHJlcXVpcmUoJ1Nwcml0ZUhlbHBlcicpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYWJlbFVzZXJJZDogY2MuTGFiZWwsXG4gICAgICAgIGxhYmVsVXNlcklQOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxOaWNrbmFtZTogY2MuTGFiZWwsXG4gICAgICAgIGF2YXRhclNwcml0ZTogY2MuU3ByaXRlLFxuICAgICAgICBtYW5TcHJpdGU6IGNjLlNwcml0ZSxcbiAgICAgICAgd29tZW5TcHJpdGU6IGNjLlNwcml0ZSxcblxuICAgICAgICBfZGlkU2hvd1VzZXJJbmZvOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICB1cGRhdGVXaXRoVXNlcjogZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgIHJldHVybjtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLl9kaWRTaG93VXNlckluZm8gPT0gdXNlcikge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICAgICAgdGhpcy5fZGlzYXBwZWFyVXNlckluZm8oKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9kaWRTaG93VXNlckluZm8gPSB1c2VyO1xuICAgICAgaWYgKCF0aGlzLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XG4gICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2Rpc2FwcGVhclVzZXJJbmZvKCk7XG4gICAgICB9LmJpbmQodGhpcyksIDUpO1xuXG4gICAgICB0aGlzLmxhYmVsVXNlcklkLnN0cmluZyA9XCJVSUQ6XFxuXCIrdXNlci5pZDtcbiAgICAgIHRoaXMubGFiZWxVc2VySVAuc3RyaW5nID1cIueUqOaIt0lQOlxcblwiK3VzZXIuaXBBZGRyZXNzLnJlcGxhY2UoXCI6OmZmZmY6XCIsIFwiXCIpO1xuICAgICAgdGhpcy5sYWJlbE5pY2tuYW1lLnN0cmluZyA9IHVzZXIubmlja25hbWU7XG4gICAgICB0aGlzLmF2YXRhclNwcml0ZS5zcHJpdGVGcmFtZSA9IG51bGw7XG4gICAgICBTcHJpdGVIZWxwZXIuc2V0SW1hZ2VVcmwodGhpcy5hdmF0YXJTcHJpdGUsIHVzZXIuYXZhdGFyVXJsKTtcblxuICAgICAgbGV0IHNleCA9IHVzZXIuc2V4OyAgLy8gc2V4OiAxIOeUtyAgMiDlpbNcbiAgICAgIHRoaXMubWFuU3ByaXRlLm5vZGUuYWN0aXZlID0gKHNleCA9PSAxKTtcbiAgICAgIHRoaXMud29tZW5TcHJpdGUubm9kZS5hY3RpdmUgPSAoc2V4ICE9IDEpO1xuICAgIH0sXG5cbiAgICBfZGlzYXBwZWFyVXNlckluZm86IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2RpZFNob3dVc2VySW5mbyA9IG51bGw7XG4gICAgfSxcbn0pO1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XHJcbmNvbnN0IEtRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIgPSByZXF1aXJlKCdLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyJyk7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBhZ3JlZW1lbnQ6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWxcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVIYWxsSW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZUhhbGxJbmZvLCB0aGlzKTtcclxuICAgICAgICAvLyBjYy5sb2coJy0tLS02MScpXHJcbiAgICAgICAgLy8gIGNjLmxvZyh0aGlzLmFncmVlbWVudClcclxuICAgIH0sXHJcbiAgICBfc29ja2V0UmVjZWl2ZUhhbGxJbmZvOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzID0gY2MuZmluZCgnQ2FudmFzL2FncmVlbWVudCcpO1xyXG4gICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAvL3RoaXMuX2luZm8xID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAvLyBjYy5sb2codGhpcy5hZ3JlZW1lbnQpXHJcbiAgICAgICAgLy8gY2MubG9nKHMpXHJcbiAgICAgICAgLy8gY2MubG9nKCctLS0tNjEnKVxyXG4gICAgICAgIHRoaXMuYWdyZWVtZW50LnN0cmluZyA9IGRhdGEuaW5mbzEgfHwgXCJcIjtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwidmFyIEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgcG9wTm9kZTpjYy5Ob2RlLFxuICAgICAgICBsYWJlbDpjYy5MYWJlbCxcblxuICAgICAgICBfYWxlcnRDYWxsYmFjazogbnVsbCxcbiAgICAgICAgX3dpbGxEaXNtaXNzQ2FsbGJhY2s6IG51bGwsXG4gICAgICAgIF9kaXNtaXNzQ2FsbGJhY2s6IG51bGwsXG4gICAgICAgIF9jb25maXJtQ2FsbGJhY2s6IG51bGwsICAgLy8g54K55Ye756Gu5a6a5ZCO55qE5Zue6LCDXG4gICAgICAgIF90aXNoaTpudWxsLFxuICAgICAgICBfY2FyZF9udW06bnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICBcbiAgICB9LFxuXG4gICAgYWxlcnQ6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB2YXIgYW5pbSA9IHRoaXMucG9wTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgYW5pbS5wbGF5KCdwb3AnKTtcblxuICAgICAgICBpZiAodGhpcy5fYWxlcnRDYWxsYmFjaykge1xuICAgICAgICAgIHRoaXMuX2FsZXJ0Q2FsbGJhY2sodGhpcy5ub2RlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLyojIyMjI+W8ueWHuue7k+aenCovXG4gICAgYWxlcnRSZXN1bHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGNjLmZpbmQoXCJDYW52YXMvc2hvd19yZXN1bHRcIikuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHZhciBhbmltID0gdGhpcy5wb3BOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICBhbmltLnBsYXkoJ3BvcCcpO1xuXG4gICAgICAgIGlmICh0aGlzLl9hbGVydENhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy5fYWxlcnRDYWxsYmFjayh0aGlzLm5vZGUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vnoa7lrpoqL1xuICAgIHBsYXlCdG5DbGlja1NGWDpmdW5jdGlvbigpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlCdG5DbGlja1NGWCgpO1xuICAgIH0sXG5cbiAgICAvKiMjIyMj54K55Ye75Y+W5raIKi9cbiAgICBwYWx5QnRuQ2FuY2VsQ2xpY2tTRlg6ZnVuY3Rpb24oKXtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlCdG5DYW5jZWxDbGlja1NGWCgpO1xuICAgIH0sXG5cbiAgICAvKiMjIyMj54K55Ye75YWz6Zet5oiW6ICF5oyJ6ZSu5LmL57G755qE5oyJ6ZKu77yM5pKt5pS+6Z+z5pWIKi9cbiAgICBwYWx5QnRuUHVibGljU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5QnRuUHVibGljU0ZYKCk7XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vliJvlu7rmiL/pl7TvvIzmkq3mlL7pn7PmlYgqL1xuICAgIHBhbHlCdG5DcmVhdGVSb29tU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5QnRuQ3JlYXRlUm9vbVNGWCgpO1xuICAgIH0sXG4gICAgLyojIyMjI+eCueWHu+WIm+W7uuaIv+mXtO+8jOaSreaUvumfs+aViCovXG4gICAgcGFseVdpbmRvd1NGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseVdpbmRvd1NGWCgpO1xuICAgIH0sXG5cbiAgICBwYWx5V2VpWGluTG9naW5TRlg6ZnVuY3Rpb24oKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5V2VpWGluTG9naW5TRlgoKTtcbiAgICB9LFxuICAgIHBhbHlGYW5nUGFpU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5RmFuZ1BhaVNGWCgpO1xuICAgIH0sXG5cbiAgICBkaXNtaXNzQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgbGV0IHdpbGxEaXNtaXNzQ2FsbGJhY2sgPSB0aGlzLl93aWxsRGlzbWlzc0NhbGxiYWNrO1xuICAgICAgaWYgKHdpbGxEaXNtaXNzQ2FsbGJhY2spIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHdpbGxEaXNtaXNzQ2FsbGJhY2soKTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgIHRoaXMuZGlzbWlzc0NvbXBsZXRlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBvcE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgIHZhciBkaXNtaXNzQW5pbSA9IGFuaW0uZ2V0QW5pbWF0aW9uU3RhdGUoJ3BvcF9kaXNtaXNzJyk7XG4gICAgICAgIGRpc21pc3NBbmltLm9uKCdmaW5pc2hlZCcsdGhpcy5kaXNtaXNzQ29tcGxldGUsdGhpcyk7XG4gICAgICAgIGFuaW0ucGxheSgncG9wX2Rpc21pc3MnKTtcbiAgICB9LFxuXG4gICAgLyojIyMjI+makOiXj+e7k+aenOmhtemdoiovXG4gICAgZGlzbWlzc0FjdGlvblJlc3VsdDpmdW5jdGlvbigpIHtcbiAgICAgIGxldCB3aWxsRGlzbWlzc0NhbGxiYWNrID0gdGhpcy5fd2lsbERpc21pc3NDYWxsYmFjaztcbiAgICAgIGlmICh3aWxsRGlzbWlzc0NhbGxiYWNrKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSB3aWxsRGlzbWlzc0NhbGxiYWNrKCk7XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICB0aGlzLmRpc21pc3NDb21wbGV0ZSgpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAgIHZhciBhbmltID0gdGhpcy5wb3BOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICB2YXIgZGlzbWlzc0FuaW0gPSBhbmltLmdldEFuaW1hdGlvblN0YXRlKCdwb3BfZGlzbWlzcycpO1xuICAgICAgICBkaXNtaXNzQW5pbS5vbignZmluaXNoZWQnLHRoaXMuZGlzbWlzc0NvbXBsZXRlLHRoaXMpO1xuICAgICAgICBhbmltLnBsYXkoJ3BvcF9kaXNtaXNzJyk7XG4gICAgICAgIGNjLmZpbmQoXCJDYW52YXMvc2hvd19yZXN1bHRcIikuYWN0aXZlID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgZGlzbWlzc0NvbXBsZXRlOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHRoaXMub25EaXNtaXNzQ29tcGxldGUpIHtcbiAgICAgICAgICB0aGlzLm9uRGlzbWlzc0NvbXBsZXRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fZGlzbWlzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy5fZGlzbWlzc0NhbGxiYWNrKHRoaXMubm9kZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGRpc21pc3NQbGF5OmZ1bmN0aW9uKCkge1xuICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwiaGFsbFwiKTsgIFxuICAgIH0sXG5cbiAgICBvbkRpc21pc3NDb21wbGV0ZTpmdW5jdGlvbigpIHtcbiAgICAgIC8vY2MubG9nKFwib25EaXNtaXNzQ29tcGxldGVcIik7XG4gICAgfSxcblxuICAgIGRvbmVBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICB0aGlzLm9uRG9uZUFjdGlvbigpO1xuXG4gICAgICAgIGxldCBjb25maXJtQ2FsbGJhY2sgPSB0aGlzLl9jb25maXJtQ2FsbGJhY2s7XG4gICAgICAgIGlmIChjb25maXJtQ2FsbGJhY2spIHtcbiAgICAgICAgICBjb25maXJtQ2FsbGJhY2sodGhpcy5ub2RlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkRvbmVBY3Rpb246ZnVuY3Rpb24oKSB7XG5cbiAgICB9LFxuXG4gICAgc2V0TWVzc2FnZTpmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgdGhpcy5sYWJlbC5zdHJpbmcgPSBtc2c7XG4gICAgfSxcblxuICAgIGdldE1lc3NhZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLmxhYmVsLnN0cmluZztcbiAgICB9LFxuXG4gICAgc2V0QWxlcnRDYWxsYmNrOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX2FsZXJ0Q2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9LFxuXG4gICAgc2V0V2lsbERpc21pc3NDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICB0aGlzLl93aWxsRGlzbWlzc0NhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfSxcblxuICAgIHNldERpc21pc3NDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICB0aGlzLl9kaXNtaXNzQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9LFxuXG4gICAgc2V0Q29uZmlybUNhbGxiYWNrOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX2NvbmZpcm1DYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH0sXG5cbiAgICAvKnNldE1lc3NhZ2U6IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICB0aGlzLmxhYmVsLmdldENvbXBvbmVudCgnY2MuTGFiZWwnKS5zdHJpbmcgPSBtZXNzYWdlO1xuICAgIH0sKi9cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsIi8qKlxyXG4gKiAg5oi/6Ze054m55q6K54mM5Yqo55S7XHJcbiAqXHJcbiAqXHJcbiAqXHJcbiAqIFxyXG4gKi9cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBmYXBhaU5vZGU6IGNjLlByZWZhYiwgIC8vXHJcbiAgICAgICAgbGl1ZHVpYmFuOmNjLlByZWZhYixcclxuICAgICAgICBzYW50b25naHVhOmNjLlByZWZhYixcclxuICAgICAgICBzYW5zaHVuemk6Y2MuUHJlZmFiLFxyXG4gICAgICAgIHF1YW5sZWlkYTpjYy5QcmVmYWIsXHJcbiAgICAgICAgcWluZ2xvbmc6Y2MuUHJlZmFiLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcbiAgICBmYXBhaUFuaW1hdGlvbjpmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBmYXBhaSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSgnZmFwYWknKTtcclxuICAgICAgICBmYXBhaSA9IGNjLnJlbW92ZVNlbGYoKTtcclxuICAgICAgICB2YXIgZmFwYWlBbmltID0gY2MuaW5zdGFudGlhdGUodGhpcy5mYXBhaU5vZGUpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChmYXBhaUFuaW0pO1xyXG5cclxuICAgICAgICB2YXIgTGd1biA9IGZhcGFpQW5pbS5nZXRDaGlsZEJ5TmFtZShcImxlZnRfZ2FuZ1wiKTsgICAvLyDlt6bovrnnmoTmiqJcclxuICAgICAgICB2YXIgUmd1biA9ICBmYXBhaUFuaW0uZ2V0Q2hpbGRCeU5hbWUoXCJyaWdodF9nYW5nXCIpOyAvLyDlj7PovrnnmoTmiqJcclxuICAgICAgICB2YXIgbWFzayA9IGZhcGFpQW5pbS5nZXRDaGlsZEJ5TmFtZShcIm1hc2tcIik7XHJcbiAgICAgICAgLyogLS0tLS0tLS0tLS1zdGFydOWPiuWtkOiKgueCuS0tLS0tLS0tLS0tICovXHJcbiAgICAgICAgdmFyIHN0YXJ0ID0gZmFwYWlBbmltLmdldENoaWxkQnlOYW1lKFwic3RhcnRcIiksXHJcbiAgICAgICAgICAgIHF1YW4gPSBzdGFydC5nZXRDaGlsZEJ5TmFtZShcInF1YW5cIiksXHJcbiAgICAgICAgICAgIGJhb2RpYW4gPSBzdGFydC5nZXRDaGlsZEJ5TmFtZShcImJhb2RpYW5cIiksXHJcbiAgICAgICAgICAgIGRpdGFuID0gc3RhcnQuZ2V0Q2hpbGRCeU5hbWUoXCJkaXRhblwiKSxcclxuICAgICAgICAgICAgYmVnaW5JY28gPSBzdGFydC5nZXRDaGlsZEJ5TmFtZShcImJlZ2luX2ljb25cIiksXHJcbiAgICAgICAgICAgIHRpdGxlID0gc3RhcnQuZ2V0Q2hpbGRCeU5hbWUoXCJ0aXRsZVwiKSxcclxuICAgICAgICAgICAgcldpbmcgPSBzdGFydC5nZXRDaGlsZEJ5TmFtZShcInJXaW5nXCIpLFxyXG4gICAgICAgICAgICBsV2luZyA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwibFdpbmdcIik7XHJcbiAgICAgICAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGZhcGFpQW5pbS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIG1hc2sucnVuQWN0aW9uKCBjYy5zY2FsZVRvKDAuMiwxMCwxMCkgKTtcclxuICAgICAgICBMZ3VuLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2Uoc2VsZi5MZ3VuQWN0aW9uKCkpICk7XHJcbiAgICAgICAgUmd1bi5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKHNlbGYuUmd1bkFjdGlvbigpKSApO1xyXG5cclxuICAgICAgICB2YXIgc3RhcnRGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHJXaW5nLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGxXaW5nLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGxXaW5nLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoIGNjLnJlcGVhdCggY2Muc2VxdWVuY2UoIGNjLnNrZXdUbygwLjA1LDIwLC0xMCksY2Muc2tld1RvKDAuMDUsMCwwKSApLDMpLGNjLmZhZGVPdXQoMCkpICk7XHJcbiAgICAgICAgICAgIHJXaW5nLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoIGNjLnJlcGVhdCggY2Muc2VxdWVuY2UoIGNjLnNrZXdUbygwLjA1LDIwLC0xMCksY2Muc2tld1RvKDAuMDUsMCwwKSApLDMpLGNjLmZhZGVPdXQoMCkpICk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHdpbmdGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHN0YXJ0LnJ1bkFjdGlvbihjYy5zY2FsZVRvKDAuMiwwLDApKTtcclxuICAgICAgICAgICAgfSw1MDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgc3RhcnQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgc3RhcnQucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zY2FsZVRvKDAuMiwxLjUsMS41KSxjYy5zY2FsZVRvKDAuMiwxLDEpLHN0YXJ0RmluaXNoZWQsd2luZ0ZpbmlzaGVkKSApO1xyXG4gICAgICAgICAgICBxdWFuLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc2NhbGVUbygwLjIsMTAsMTApLGNjLmZhZGVPdXQoMCkpKTtcclxuICAgICAgICAgICAgYmFvZGlhbi5ydW5BY3Rpb24oICBjYy5zZXF1ZW5jZShjYy5zY2FsZVRvKDAuMiwxLjUsMS41KSxjYy5mYWRlT3V0KDApKSApO1xyXG4gICAgICAgIH0sNDAwKTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGxXaW5nLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByV2luZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgc3RhcnQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGZhcGFpQW5pbS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgZmFwYWlBbmltLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgfSwyMDAwKVxyXG5cclxuICAgIH0sXHJcbiAgICBMZ3VuQWN0aW9uOmZ1bmN0aW9uKCl7IC8vIOW3pui+ueeahOaeqlxyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIGNjLnNwYXduKFtcclxuICAgICAgICAgICAgICAgIGNjLm1vdmVUbyggMC4yLCBjYy52MigtNDMwLCAxNTIpICksXHJcbiAgICAgICAgICAgICAgICBjYy5zY2FsZVRvKDAuMiwyLDIpXHJcbiAgICAgICAgICAgIF0pLFxyXG4gICAgICAgICAgICBjYy5zcGF3bihbXHJcbiAgICAgICAgICAgICAgICBjYy5mYWRlVG8oMC4yLCAyNTUpLFxyXG4gICAgICAgICAgICAgICAgY2MubW92ZVRvKCAwLjIsIGNjLnYyKC0yMjAsIDApICksXHJcbiAgICAgICAgICAgICAgICBjYy5yb3RhdGVUbygwLjIsMzUpXHJcbiAgICAgICAgICAgIF0pLFxyXG4gICAgICAgICAgICBjYy5mYWRlT3V0KDApLFxyXG4gICAgICAgIF07XHJcbiAgICB9LFxyXG4gICAgUmd1bkFjdGlvbjpmdW5jdGlvbigpeyAvLyDlj7PovrnnmoTmnqpcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICBjYy5zcGF3bihbXHJcbiAgICAgICAgICAgICAgICBjYy5tb3ZlVG8oIDAuMiwgY2MudjIoNDMwLCAxNTIpICksXHJcbiAgICAgICAgICAgICAgICBjYy5zY2FsZVRvKDAuMiwtMiwyKVxyXG4gICAgICAgICAgICBdKSxcclxuICAgICAgICAgICAgY2Muc3Bhd24oW1xyXG4gICAgICAgICAgICAgICAgY2MuZmFkZVRvKDAuMiwgMjU1KSxcclxuICAgICAgICAgICAgICAgIGNjLm1vdmVUbyggMC4yLCBjYy52MigyMjAsIDApICksXHJcbiAgICAgICAgICAgICAgICBjYy5yb3RhdGVUbygwLjIsLTM1KVxyXG4gICAgICAgICAgICBdKSxcclxuICAgICAgICAgICAgY2MuZmFkZU91dCgwKVxyXG4gICAgICAgIF07XHJcbiAgICB9LFxyXG4gICAgX2JlemllcjE6ZnVuY3Rpb24oaW5kZXgpe1xyXG4gICAgICAgIHZhciBiZXppZXIgPSBbXTtcclxuICAgICAgICBiZXppZXJbMF0gPSBbIFtjYy52MigxMDAsIDc0KSxjYy52MigxNTAsMTc0KSxjYy52MigyMDAsIC0xNzQpXSwgY2MudjIoMTAwLCA3NCkgXTtcclxuICAgICAgICBiZXppZXJbMV0gPSBbIFtjYy52MigtNzIsIDI4NCksY2MudjIoLTEyMiwzODQpLGNjLnYyKC0yMjIsIC0xNTApXSwgY2MudjIoLTcyLCAyODQpIF07XHJcbiAgICAgICAgYmV6aWVyWzJdID0gWyBbY2MudjIoLTcwLCAyMDApLGNjLnYyKC0xMjAsMzAwKSxjYy52MigtMjIwLCAtMjAwKV0sIGNjLnYyKC03MCwgMjAwKSBdO1xyXG4gICAgICAgIGJlemllclszXSA9IFsgW2NjLnYyKC0xMjMsIDIxMyksY2MudjIoLTE3MywzMTMpLGNjLnYyKC0yNzMsIC0xNjApXSwgY2MudjIoLTEyMywgMjEzKSBdO1xyXG4gICAgICAgIGJlemllcls0XSA9IFsgW2NjLnYyKDExMCwgMjM3KSxjYy52MigxNjAsMzM3KSxjYy52MigyNjAsIC0xNzcpXSwgY2MudjIoMjEwLCAyMzcpIF07XHJcbiAgICAgICAgYmV6aWVyWzVdID0gWyBbY2MudjIoMTgzLCAxMTUpLGNjLnYyKDIzMywyMTUpLGNjLnYyKDMzMywgLTE1NSldLCBjYy52MigxODMsIDExNSkgXTtcclxuICAgICAgICBiZXppZXJbNl0gPSBbIFtjYy52Mig5MiwgMTE2KSxjYy52MigxNDIsMjE2KSxjYy52MigyNDIsIC0xNDYpXSwgY2MudjIoOTIsIDExNikgXTtcclxuICAgICAgICBiZXppZXJbN10gPSBbIFtjYy52MigtMjYsIDEyNCksY2MudjIoLTc2LDIyNCksY2MudjIoLTE3NiwgLTE2NCldLCBjYy52MigtMjYsIDEyNCkgXTtcclxuICAgICAgICBiZXppZXJbOF0gPSBbIFtjYy52MigtMTEwLCA4MSksY2MudjIoLTIyMCwxMzEpLGNjLnYyKC00NjAsIC0xODApXSwgY2MudjIoLTExMCwgODEpIF07XHJcbiAgICAgICAgYmV6aWVyWzldID0gWyBbY2MudjIoLTEyNSwgMzMpLGNjLnYyKC0yMjUsMTMzKSxjYy52MigtMjc1LCAtMTMzKV0sIGNjLnYyKC0xMjUsIDMzKSBdO1xyXG4gICAgICAgIGJlemllclsxMF0gPSBbIFtjYy52MigwLCAwKSxjYy52Mig1MCwxMDApLGNjLnYyKDE1MCwgLTE1MCldLCBjYy52MigwLCAwKSBdO1xyXG4gICAgICAgIGJlemllclsxMV0gPSBbIFtjYy52MigtMjM1LCA1KSxjYy52MigtMjc1LDEwNSksY2MudjIoLTM3NSwgLTE4NildLCBjYy52MigtMjM1LCA1KSBdO1xyXG4gICAgICAgIGJlemllclsxMl0gPSBbIFtjYy52MigtODAsIDQpLGNjLnYyKC0xMzAsMTA0KSxjYy52MigtMjMwLCAtMjMzKV0sIGNjLnYyKC04MCwgNCkgXTtcclxuICAgICAgICBiZXppZXJbMTNdID0gWyBbY2MudjIoMTAwLCAtNyksY2MudjIoMTUwLDEwNyksY2MudjIoMjUwLCAtMTc3KV0sIGNjLnYyKDEwMCwgLTcpIF07XHJcbiAgICAgICAgYmV6aWVyWzE0XSA9IFsgW2NjLnYyKDE1NCwgMjMpLGNjLnYyKDIwNCwxMTMpLGNjLnYyKDI1NCwgLTE3MyldLCBjYy52MigyNTQsIDIzKSBdO1xyXG4gICAgICAgIHJldHVybiBiZXppZXJbaW5kZXhdO1xyXG4gICAgfSxcclxuICAgIC8vIOmdkum+meWKqOeUu1xyXG4gICAgX3Fpbmdsb25nQW5pYW10aW9uOmZ1bmN0aW9uKHR5cGUpe1xyXG4gICAgICAgIHZhciBxaW5nbG9uZyA9IGNjLmluc3RhbnRpYXRlKHRoaXMucWluZ2xvbmcpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChxaW5nbG9uZyk7XHJcbiAgICAgICAgdmFyIGJnID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ2JnJyk7XHJcbiAgICAgICAgdmFyIHRpdGxlID0gJyc7XHJcbiAgICAgICAgaWYodHlwZSA9PSBcInFsXCIpe1xyXG4gICAgICAgICAgICB0aXRsZSA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCdxbG9uZ3RpdGxlJyk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRpdGxlID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ2xvbmd0aXRsZScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHl1bjEgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgneXVuMScpO1xyXG4gICAgICAgIHZhciB5dW4yID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ3l1bjInKTtcclxuICAgICAgICB2YXIgeXVuMyA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCd5dW4zJyk7XHJcbiAgICAgICAgdmFyIHl1bjQgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgneXVuNCcpO1xyXG4gICAgICAgIHZhciBsb25nID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoXCJsb25nXCIpO1xyXG5cclxuICAgICAgICB2YXIgaHVhMSA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCdodWExJyk7XHJcbiAgICAgICAgdmFyIGh1YTIgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgnaHVhMicpO1xyXG4gICAgICAgIHZhciBodWEzID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ2h1YTMnKTtcclxuICAgICAgICB2YXIgQSA9IFtdICwgQiA9IFtdICwgQyA9IFtdO1xyXG4gICAgICAgIHZhciBodWEgPSBbXTtcclxuXHJcbiAgICAgICAgdmFyIHRlc3QgPSBjYy5pbnN0YW50aWF0ZShodWExKTtcclxuXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGZvciAodmFyIGk9MDtpPDU7aSsrKXtcclxuICAgICAgICAgICAgQVtpXSA9IGNjLmluc3RhbnRpYXRlKGh1YTEpO1xyXG4gICAgICAgICAgICBBW2ldLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4xLDI1NSkpO1xyXG4gICAgICAgICAgICBodWEucHVzaCggQVtpXSApO1xyXG4gICAgICAgICAgICBCW2ldID0gY2MuaW5zdGFudGlhdGUoaHVhMik7XHJcbiAgICAgICAgICAgIEJbaV0ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjEsMjU1KSk7XHJcbiAgICAgICAgICAgIGh1YS5wdXNoKCBCW2ldICk7XHJcbiAgICAgICAgICAgIENbaV0gPSBjYy5pbnN0YW50aWF0ZShodWEzKTtcclxuICAgICAgICAgICAgQ1tpXS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMSwyNTUpKTtcclxuICAgICAgICAgICAgaHVhLnB1c2goIENbaV0gKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBiZ0ZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLnNjYWxlVG8oMC4yLDEsMSksY2MuZmFkZVRvKDAuMiwyNTUpKSxjYy5zY2FsZVRvKDAuMiwyLDIpLGNjLnNwYXduKGNjLnNjYWxlVG8oMC4yLDEuNSwxLjUpLGxvbmdTdGFydCkgKSApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBsb25nU3RhcnQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBsb25nLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMC41KSksY2Muc2NhbGVUbygwLjEsMywzKSxjYy5zcGF3bihjYy5zY2FsZVRvKDAuMSwxLDEpLHl1blN0YXJ0KSApKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZmxvd2VyU3RhcnQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICB9KTsgXHJcbiAgICAgICAgdmFyIHl1blN0YXJ0ID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgeXVuMS5ydW5BY3Rpb24oY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMixjYy52MigtMzM0LDIzNCkpLGNjLm1vdmVUbygwLjIsY2MudjIoLTM0NCwyMzQpKSksMykgKSk7XHJcbiAgICAgICAgICAgIHl1bjIucnVuQWN0aW9uKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLm1vdmVUbygwLjIsY2MudjIoLTM2OCwtODIpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0zNTgsLTgyKSkpLDMpICkpO1xyXG4gICAgICAgICAgICB5dW4zLnJ1bkFjdGlvbihjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnJlcGVhdChjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4yLGNjLnYyKDQwOCwtNCkpLGNjLm1vdmVUbygwLjIsY2MudjIoMzk4LC00KSkpLDMpKSk7XHJcbiAgICAgICAgICAgIHl1bjQucnVuQWN0aW9uKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLm1vdmVUbygwLjIsY2MudjIoNDA2LDE4MSkpLGNjLm1vdmVUbygwLjIsY2MudjIoNDE2LDE4MSkpKSwzKSApKTtcclxuICAgICAgICAgICAgZm9yKHZhciBpPTE7aTxodWEubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICBodWFbaV0uc2V0UG9zaXRpb24oc2VsZi5fYmV6aWVyKGkpWzFdKTtcclxuICAgICAgICAgICAgICAgIHFpbmdsb25nLmFkZENoaWxkKGh1YVtpXSk7XHJcbiAgICAgICAgICAgICAgICBodWFbaV0ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3biggY2MuYmV6aWVyVG8oMC4zLHNlbGYuX2JlemllcihpKVswXSksY2Muc2NhbGVUbygwLjMsMSwxKSxjYy5mYWRlVG8oMC4zLDApICkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBxaW5nbG9uZy5yZW1vdmVGcm9tUGFyZW50KHRydWUpO1xyXG4gICAgICAgICAgICB9LDE1MDApO1xyXG4gICAgICAgICAgICAvL3l1bjFcclxuICAgICAgICB9KVxyXG4gICAgICAgIGJnLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC40LDI1NSksY2Muc2NhbGVUbygwLjQsMzAsMzApKSxiZ0ZpbmlzaGVkICkpO1xyXG4gICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5zY2FsZVRvKDAuMiwyLDIpKTtcclxuXHJcbiAgICB9LFxyXG4gICAgLy8g5LiJ6aG65a2Q5Yqo55S7XHJcbiAgICBfc2Fuc2h1bnppQW5pbWF0aW9uOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIHNhbnNodW56aSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuc2Fuc2h1bnppKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQoc2Fuc2h1bnppKTtcclxuICAgICAgICB2YXIgYmcgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ2JnJyk7XHJcbiAgICAgICAgdmFyIEx0dSA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnTHR1Jyk7XHJcbiAgICAgICAgdmFyIFJ0dSA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnUnR1Jyk7XHJcbiAgICAgICAgdmFyIHRpdGxlID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCd0aXRsZScpO1xyXG4gICAgICAgIHZhciB6dXNodW4xID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCd6dXNodW4xJyk7XHJcbiAgICAgICAgdmFyIHp1c2h1bjIgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ3p1c2h1bjInKTtcclxuICAgICAgICB2YXIgenVzaHVuMyA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnenVzaHVuMycpO1xyXG4gICAgICAgIHZhciB6dXNodW40ID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCd6dXNodW40Jyk7XHJcbiAgICAgICAgdmFyIHp1c2h1bjUgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ3p1c2h1bjUnKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGJnRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLnNjYWxlVG8oMC4yLDEsMSksY2MuZmFkZVRvKDAuMiwyNTUpKSx0aXRsZUZpbmlzaGVkICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aXRsZUZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZSggY2Muc2NhbGVUbygwLjIsMi41LDIuNSksdGl0bGVTY2FsZSkpO1xyXG4gICAgICAgICAgICBMdHUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5mYWRlVG8oMC4yLDI1NSkgKSk7XHJcbiAgICAgICAgICAgIFJ0dS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLmZhZGVUbygwLjIsMjU1KSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aXRsZVNjYWxlID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXsgICAgLy8gdGl0bGXmlL7lpKflrozmiJDlkI4g56u556yLMuWSjDPlkIzml7bov5vooYxcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKCBjYy5zY2FsZVRvKDAuMiwxLjUsMS41KSApO1xyXG4gICAgICAgICAgICB6dXNodW4yLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwxMiwxMikpLGNjLnNjYWxlVG8oMC4yLDEwLDEwKSxaUzEgKSk7XHJcbiAgICAgICAgICAgIHp1c2h1bjMucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDIyLDIyKSksY2Muc2NhbGVUbygwLjIsMjAsMjApLFpTNCApKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgenVzaHVuNS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMTIsMTIpKSxjYy5zY2FsZVRvKDAuMiwxMCwxMCkpICk7XHJcbiAgICAgICAgICAgIH0sMTAwKVxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNhbnNodW56aS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHNhbnNodW56aS5yZW1vdmVGcm9tUGFyZW50KHRydWUpO1xyXG4gICAgICAgICAgICB9LDIwMDApXHJcblxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdmFyIFpTMSA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHp1c2h1bjEucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDEyLDEyKSksY2Muc2NhbGVUbygwLjIsMTAsMTApKSApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdmFyIFpTNCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHp1c2h1bjQucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDE0LDE0KSksY2Muc2NhbGVUbygwLjIsMTIsMTIpKSApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgYmcucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjQsMjU1KSxjYy5zY2FsZVRvKDAuNCwzMCwzMCkpLGJnRmluaXNoZWQgKSk7XHJcbiAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNjYWxlVG8oMC4yLDIsMikpO1xyXG5cclxuICAgIH0sXHJcbiAgICAvLyDlhajlnpLmiZNcclxuICAgIF9xdWFubGVpZGFBbmltYXRpb246ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgcXVhbmxlaWRhID0gY2MuaW5zdGFudGlhdGUodGhpcy5xdWFubGVpZGEpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChxdWFubGVpZGEpO1xyXG4gICAgICAgIHZhciBiZyA9IHF1YW5sZWlkYS5nZXRDaGlsZEJ5TmFtZSgnYmcnKTtcclxuICAgICAgICB2YXIgYmFsbCA9IHF1YW5sZWlkYS5nZXRDaGlsZEJ5TmFtZSgnYmFsbCcpO1xyXG4gICAgICAgIHZhciBiYW5ncWl1dGFvID0gcXVhbmxlaWRhLmdldENoaWxkQnlOYW1lKCdiYW5ncWl1dGFvJyk7XHJcbiAgICAgICAgdmFyIGJhbmdxaXVndW4gPSBxdWFubGVpZGEuZ2V0Q2hpbGRCeU5hbWUoJ2JhbmdxaXVndW4nKTtcclxuICAgICAgICB2YXIgTHl1biA9IHF1YW5sZWlkYS5nZXRDaGlsZEJ5TmFtZSgnTHl1bicpO1xyXG4gICAgICAgIHZhciBSeXVuID0gcXVhbmxlaWRhLmdldENoaWxkQnlOYW1lKCdSeXVuJyk7XHJcbiAgICAgICAgdmFyIHRpdGxlID0gcXVhbmxlaWRhLmdldENoaWxkQnlOYW1lKCd0aXRsZScpO1xyXG4gICAgICAgIHZhciBiZ0ZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5zY2FsZVRvKDAuMiwxLDEpLGNjLmZhZGVUbygwLjIsMjU1KSksdGl0bGVGaW5pc2hlZCApKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgdGl0bGVGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoIGNjLnNjYWxlVG8oMC4yLDIuNSwyLjUpLGNjLnNjYWxlVG8oMC4yLDEuNSwxLjUpLFxyXG4gICAgICAgICAgICAgICAgY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLm1vdmVUbygwLjMsY2MudjIoMCwyMCkpLGNjLm1vdmVUbygwLjMsY2MudjIoMCwwKSkpLDIpICkpO1xyXG5cclxuICAgICAgICAgICAgTHl1bi5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwyMCwyMCksY2MubW92ZVRvKDAuMixjYy52MigtMjcwLDcwKSkgKSxcclxuICAgICAgICAgICAgICAgIGNjLnJlcGVhdChjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4zLGNjLnYyKC0yNzAsMjYpKSxjYy5tb3ZlVG8oMC4zLGNjLnYyKC0yNzAsNDYpKSksMikgKSk7XHJcblxyXG4gICAgICAgICAgICBSeXVuLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDIwLDIwKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDI3MCw3MCkpICksXHJcbiAgICAgICAgICAgICAgICBjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMyxjYy52MigyNzAsNjYpKSxjYy5tb3ZlVG8oMC4zLGNjLnYyKDI3MCw0NikpKSwyKSApKTtcclxuXHJcbiAgICAgICAgICAgIGJhbmdxaXV0YW8ucnVuQWN0aW9uKGNjLnNlcXVlbmNlKCBjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjMsMTAsMTApLGNjLm1vdmVUbygwLjMsY2MudjIoMjUwLDUwKSkpLGJxdEZpbmlzaGVkICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBicXRGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGJhbmdxaXV0YW8ucnVuQWN0aW9uKGNjLnJlcGVhdChjYy5zZXF1ZW5jZShjYy5yb3RhdGVUbygwLjIsLTEwKSxjYy5yb3RhdGVUbygwLjIsMCkpLDMpKTtcclxuICAgICAgICAgICAgYmFsbC5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjEsMjU1KSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDE5Niw4MykpKSxiYWxsRmluaXNoZWQgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGJhbGxGaW5pc2hlZCA9IGNjLiBjYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBiYWxsLnJ1bkFjdGlvbihjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDApLGNjLm1vdmVUbygwLjIsY2MudjIoMCwwKSksY2Muc2NhbGVUbygwLjIsNCw0KSApKTtcclxuICAgICAgICAgICAgYmFuZ3FpdWd1bi5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKCBjYy5zcGF3bihjYy5zY2FsZVRvKDAuMiwyLDIpLGNjLmZhZGVUbygwLjIsMjU1KSksY2Muc2NhbGVUbygwLjMsMS41LDEuNSkgKSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGJnLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIGJhbGwucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgYmFuZ3FpdXRhby5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBiYW5ncWl1Z3VuLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIEx5dW4ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgUnl1bi5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcXVhbmxlaWRhLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0sMjAwMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYmcucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjQsMjU1KSxjYy5zY2FsZVRvKDAuNCwzMCwzMCkpLGJnRmluaXNoZWQgKSk7XHJcbiAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4yLDIsMikpKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOS4ieWQjOiKseWKqOeUu1xyXG4gICAgX3NhbnRvbmdodWFBbmltYXRpb246ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgc2FudG9uZ2h1YSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuc2FudG9uZ2h1YSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHNhbnRvbmdodWEpO1xyXG4gICAgICAgIHZhciBiZyA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ2JnJyk7XHJcbiAgICAgICAgdmFyIGh1YTEgPSBzYW50b25naHVhLmdldENoaWxkQnlOYW1lKCdodWExJyk7XHJcbiAgICAgICAgdmFyIGh1YTIgPSBzYW50b25naHVhLmdldENoaWxkQnlOYW1lKCdodWEyJyk7XHJcbiAgICAgICAgdmFyIGh1YTMgPSBzYW50b25naHVhLmdldENoaWxkQnlOYW1lKCdodWEzJyk7XHJcbiAgICAgICAgdmFyIFJ0YW9odWEgPSBzYW50b25naHVhLmdldENoaWxkQnlOYW1lKCdSdGFvaHVhJyk7XHJcbiAgICAgICAgdmFyIEx0YW9odWEgPSBzYW50b25naHVhLmdldENoaWxkQnlOYW1lKCdMdGFvaHVhJyk7XHJcbiAgICAgICAgdmFyIHRpdGxlID0gc2FudG9uZ2h1YS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy92YXIgSDEgPSBjYy5pbnN0YW50aWF0ZShodWExKTtcclxuICAgICAgICB2YXIgQSA9IFtdICwgQiA9IFtdICwgQyA9IFtdO1xyXG4gICAgICAgIHZhciBodWEgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpPTA7aTw1O2krKyl7XHJcbiAgICAgICAgICAgIEFbaV0gPSBjYy5pbnN0YW50aWF0ZShodWExKTtcclxuICAgICAgICAgICAgQVtpXS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMSwyNTUpKTtcclxuICAgICAgICAgICAgaHVhLnB1c2goIEFbaV0gKTtcclxuICAgICAgICAgICAgQltpXSA9IGNjLmluc3RhbnRpYXRlKGh1YTIpO1xyXG4gICAgICAgICAgICBCW2ldLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4xLDI1NSkpO1xyXG4gICAgICAgICAgICBodWEucHVzaCggQltpXSApO1xyXG4gICAgICAgICAgICBDW2ldID0gY2MuaW5zdGFudGlhdGUoaHVhMyk7XHJcbiAgICAgICAgICAgIENbaV0ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjEsMjU1KSk7XHJcbiAgICAgICAgICAgIGh1YS5wdXNoKCBDW2ldICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgYmdGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2Muc2NhbGVUbygwLjIsMSwxKSxjYy5mYWRlVG8oMC4yLDI1NSkpLGNjLnNjYWxlVG8oMC4yLDEsMSksdGl0bGVGaW5pc2hlZCApKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgdGl0bGVGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zY2FsZVRvKDAuMSwxLjgsMS44KSApKTtcclxuICAgICAgICAgICAgTHRhb2h1YS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDMsMyksY2MubW92ZVRvKDAuMixjYy52MigtMTYwLC02MCkpICkgKSk7XHJcbiAgICAgICAgICAgIFJ0YW9odWEucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwzLDMpLGNjLm1vdmVUbygwLjIsY2MudjIoMTQwLC02MCkpICkgKSk7XHJcbiAgICAgICAgICAgIGZvcih2YXIgaT0xO2k8aHVhLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgaHVhW2ldLnNldFBvc2l0aW9uKHNlbGYuX2JlemllcihpKVsxXSk7XHJcbiAgICAgICAgICAgICAgICBzYW50b25naHVhLmFkZENoaWxkKGh1YVtpXSk7XHJcbiAgICAgICAgICAgICAgICBodWFbaV0ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3biggY2MuYmV6aWVyVG8oMC4zLHNlbGYuX2JlemllcihpKVswXSksY2Muc2NhbGVUbygwLjMsMSwxKSxjYy5mYWRlVG8oMC4zLDApICkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBiZy5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBSdGFvaHVhLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIEx0YW9odWEucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgc2FudG9uZ2h1YS5yZW1vdmVGcm9tUGFyZW50KHRydWUpO1xyXG4gICAgICAgICAgICB9LDE1MDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGJnLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4zLDI1NSksY2Muc2NhbGVUbygwLjMsMzAsMzApKSxiZ0ZpbmlzaGVkICkpO1xyXG4gICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zY2FsZVRvKDAuMiwyLDIpKSk7XHJcbiAgICB9LFxyXG4gICAgLy8g6LSd5aGe5bCU5puy57q/KOWPquiDveWumuS4ieS4queCuSlcclxuICAgIF9iZXppZXI6ZnVuY3Rpb24oaW5kZXgpe1xyXG4gICAgICAgIHZhciBiZXppZXIgPSBbXTtcclxuICAgICAgICBiZXppZXJbMF0gPSBbIFtjYy52MigyMDAsIDc0KSxjYy52MigyNTAsMTI0KSxjYy52Mig0MDAsIC0xNzQpXSwgY2MudjIoMjAwLCA3NCkgXTtcclxuICAgICAgICBiZXppZXJbMV0gPSBbIFtjYy52MigtNzIsIDI4NCksY2MudjIoLTEyMiwzMzQpLGNjLnYyKC0yNzIsIC0xNTApXSwgY2MudjIoLTcyLCAyODQpIF07XHJcbiAgICAgICAgYmV6aWVyWzJdID0gWyBbY2MudjIoLTI3MCwgMzAwKSxjYy52MigtMzIwLDM1MCksY2MudjIoLTQyMCwgLTIwMCldLCBjYy52MigtMjcwLCAzMDApIF07XHJcbiAgICAgICAgYmV6aWVyWzNdID0gWyBbY2MudjIoLTIyMywgMjEzKSxjYy52MigtMjczLDI2MyksY2MudjIoLTM3MywgLTE2MCldLCBjYy52MigtMjIzLCAyMTMpIF07XHJcbiAgICAgICAgYmV6aWVyWzRdID0gWyBbY2MudjIoMjEwLCAyMzcpLGNjLnYyKDI2MCwyODcpLGNjLnYyKDM2MCwgLTE3NyldLCBjYy52MigyMTAsIDIzNykgXTtcclxuICAgICAgICBiZXppZXJbNV0gPSBbIFtjYy52MigxODMsIDExNSksY2MudjIoMjMzLDE2NCksY2MudjIoMzMzLCAtMTU1KV0sIGNjLnYyKDE4MywgMTE1KSBdO1xyXG4gICAgICAgIGJlemllcls2XSA9IFsgW2NjLnYyKDkyLCAxMTYpLGNjLnYyKDE0MiwxNjYpLGNjLnYyKDI0MiwgLTE0NildLCBjYy52Mig5MiwgMTE2KSBdO1xyXG4gICAgICAgIGJlemllcls3XSA9IFsgW2NjLnYyKC0yNiwgMTI0KSxjYy52MigtNzYsMTc0KSxjYy52MigtMTc2LCAtMTY0KV0sIGNjLnYyKC0yNiwgMTI0KSBdO1xyXG4gICAgICAgIGJlemllcls4XSA9IFsgW2NjLnYyKC0zMTAsIDgxKSxjYy52MigtMzYwLDEzMSksY2MudjIoLTQ2MCwgLTE4MCldLCBjYy52MigtMzEwLCA4MSkgXTtcclxuICAgICAgICBiZXppZXJbOV0gPSBbIFtjYy52MigtMTI1LCAzMyksY2MudjIoLTE3NSw4MyksY2MudjIoLTI3NSwgLTEzMyldLCBjYy52MigtMTI1LCAzMykgXTtcclxuICAgICAgICBiZXppZXJbMTBdID0gWyBbY2MudjIoMCwgMCksY2MudjIoNTAsNTApLGNjLnYyKDE1MCwgLTE1MCldLCBjYy52MigwLCAwKSBdO1xyXG4gICAgICAgIGJlemllclsxMV0gPSBbIFtjYy52MigtMjM1LCA1KSxjYy52MigtMjc1LDU1KSxjYy52MigtMzc1LCAtODYpXSwgY2MudjIoLTIzNSwgNSkgXTtcclxuICAgICAgICBiZXppZXJbMTJdID0gWyBbY2MudjIoLTgwLCA0KSxjYy52MigtMTMwLDU0KSxjYy52MigtMjMwLCAtMjMzKV0sIGNjLnYyKC04MCwgNCkgXTtcclxuICAgICAgICBiZXppZXJbMTNdID0gWyBbY2MudjIoMTAwLCAtNyksY2MudjIoMTUwLDU3KSxjYy52MigyNTAsIC0xNzcpXSwgY2MudjIoMTAwLCAtNykgXTtcclxuICAgICAgICBiZXppZXJbMTRdID0gWyBbY2MudjIoMjU0LCAyMyksY2MudjIoMzA0LDczKSxjYy52Mig0MDQsIC0xNzMpXSwgY2MudjIoMjU0LCAyMykgXTtcclxuICAgICAgICByZXR1cm4gYmV6aWVyW2luZGV4XTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5YWt5a+55Y2K5Yqo55S7XHJcbiAgICBfbGl1ZHVpYmFuQW5pbWF0aW9uOiBmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBsaXVkdWliYW4gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmxpdWR1aWJhbik7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKGxpdWR1aWJhbik7XHJcbiAgICAgICAgdmFyIGJnID0gbGl1ZHVpYmFuLmdldENoaWxkQnlOYW1lKCdiZycpO1xyXG4gICAgICAgIHZhciBMcWkgPSBsaXVkdWliYW4uZ2V0Q2hpbGRCeU5hbWUoJ0xxaScpO1xyXG4gICAgICAgIHZhciBScWkgPSBsaXVkdWliYW4uZ2V0Q2hpbGRCeU5hbWUoJ1JxaScpO1xyXG4gICAgICAgIHZhciBDcWkgPSBsaXVkdWliYW4uZ2V0Q2hpbGRCeU5hbWUoJ0NxaScpO1xyXG4gICAgICAgIHZhciBSdGFvaHVhID0gbGl1ZHVpYmFuLmdldENoaWxkQnlOYW1lKCdSdGFvaHVhJyk7XHJcbiAgICAgICAgdmFyIEx0YW9odWEgPSBsaXVkdWliYW4uZ2V0Q2hpbGRCeU5hbWUoJ0x0YW9odWEnKTtcclxuICAgICAgICB2YXIgdGl0bGUgPSBsaXVkdWliYW4uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XHJcblxyXG4gICAgICAgIHZhciBiZ0ZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5zY2FsZVRvKDAuMiwxLDEpLGNjLmZhZGVUbygwLjIsMjU1KSksdGl0bGVGaW5pc2hlZCApKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgdGl0bGVGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZSggY2Muc2NhbGVUbygwLjEsMi41LDIuNSksY2Muc2NhbGVUbygwLjEsMS44LDEuOCksRmluaXNoZWQgKSk7XHJcbiAgICAgICAgICAgIEx0YW9odWEucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwzLDMpLGNjLm1vdmVUbygwLjIsY2MudjIoLTE2MCwtNjApKSApICkpO1xyXG4gICAgICAgICAgICBSdGFvaHVhLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMywzKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDE0MCwtNjApKSApICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIExxaS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLm1vdmVUbygwLjIsY2MudjIoLTEwMywxNTgpKSksY2MubW92ZVRvKDAuMixjYy52MigtMTAzLDE2OCkpLGNjLm1vdmVUbygwLjIsY2MudjIoLTEwMywxNTgpKSApKTtcclxuICAgICAgICAgICAgUnFpLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2MubW92ZVRvKDAuMixjYy52MigxMzMsMTYwKSkpLGNjLm1vdmVUbygwLjIsY2MudjIoMTMzLDE3MCkpLGNjLm1vdmVUbygwLjIsY2MudjIoMTMzLDE2MCkpICkpO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBDcWkucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDIwLDk2KSkpLGNjLm1vdmVUbygwLjIsY2MudjIoMjAsMTA2KSksY2MubW92ZVRvKDAuMixjYy52MigyMCw5NikpICkpO1xyXG4gICAgICAgICAgICAgICAgTHRhb2h1YS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnJlcGVhdCggY2Muc2VxdWVuY2UoY2Mucm90YXRlVG8oMC4zLDEwKSxjYy5yb3RhdGVUbygwLjMsMCkpLDIgKSx0aEZpbmlzaGVkKSk7XHJcbiAgICAgICAgICAgICAgICBSdGFvaHVhLnJ1bkFjdGlvbiggY2MucmVwZWF0KCBjYy5zZXF1ZW5jZShjYy5yb3RhdGVUbygwLjMsLTEwKSxjYy5yb3RhdGVUbygwLjMsMCkpLDIgKSk7XHJcbiAgICAgICAgICAgIH0sNTAwKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgdGhGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGJnLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgTHFpLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgUnFpLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgQ3FpLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgUnRhb2h1YS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgIEx0YW9odWEucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgIGxpdWR1aWJhbi5yZW1vdmVGcm9tUGFyZW50KHRydWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGJnLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC40LDI1NSksY2Muc2NhbGVUbygwLjQsMzAsMzApKSxiZ0ZpbmlzaGVkICkpO1xyXG4gICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zY2FsZVRvKDAuMiwyLDIpKSk7XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcblxyXG4gICAgICAgIGNhcmRzIDogY2MuTGFiZWwsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy50b3RhbENhcmRzKCk7XHJcbiAgICB9LFxyXG4gICAgdG90YWxDYXJkcyA6ZnVuY3Rpb24oKXtcclxuICAgICAgICAvLyB2YXIgY3JlYXRlID0gdGhpcy5ub2RlLmNoaWxkcmVuO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy5ub2RlKTtcclxuICAgICAgICB2YXIgcmVuc2h1ID0gIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInJlbnNodVwiKTtcclxuICAgICAgICB2YXIganVzaHUgPSAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwianVzaHVcIik7XHJcbiAgICAgICAgdmFyIGdldENhcmQgPSAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiY2FyZHNcIik7XHJcbiAgICAgICAgLy92YXIgcmVuc2h1ID0gY3JlYXRlWzNdLCBqdXNodSA9IGNyZWF0ZVs0XSwgZ2V0Q2FyZCA9IGNyZWF0ZVs2XTtcclxuXHJcbiAgICAgICAgdmFyIHJzID0gcmVuc2h1LmdldENvbXBvbmVudChcInNpbmdsZVNlbGVjdFwiKS5zZWxlY3RlZEluZGV4O1xyXG4gICAgICAgIHZhciBqcyA9IGp1c2h1LmdldENvbXBvbmVudChcInNpbmdsZVNlbGVjdFwiKS5zZWxlY3RlZEluZGV4O1xyXG4gICAgICAgIHZhciBnYyA9IGdldENhcmQuZ2V0Q29tcG9uZW50KFwic2luZ2xlU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XHJcblxyXG4gICAgICAgIHZhciBSID0gMSwgSiA9IDEsIEcgPSAxO1xyXG4gICAgICAgIHN3aXRjaChycyl7XHJcbiAgICAgICAgICAgIGNhc2UgMDogUiA9IDE7YnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTogUiA9IDI7YnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjogUiA9IDM7YnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMzogUiA9IDQ7YnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN3aXRjaChqcyl7XHJcbiAgICAgICAgICAgIGNhc2UgMDogSiA9IDE7YnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTogSiA9IDI7YnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjogSiA9IDM7YnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN3aXRjaChnYyl7XHJcbiAgICAgICAgICAgIGNhc2UgMDogRyA9IDE7YnJlYWs7IC8vIEFB5Yi2XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6RyA9IDA7YnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2FyZHMuc3RyaW5nID0gUitKO1xyXG4gICAgICAgIC8vdGhpcy5jYXJkcy5zdHJpbmcgPSBHID8gKFIrSik6KFIrSikqKFIrMyk7ICAvLyAoUitKKeihqOekuuavj+S4quS6uuimgeWHuueahOaIv+WNoemHj++8myhSKzMp6KGo56S65LiA5YWx5pyJ5aSa5bCR5Lq677yMICAgIFxyXG4gICAgfVxyXG59KTtcclxuIiwiLy8g54mM6IOM5b2x5YiX6KGoIGNvbXBvbmVudFxuLy8g5Y+v5Lul5pi+56S644CB6ZqQ6JeP54mM6IOM5b2x5YiX6KGoXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBjYXJkc0JhY2tMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgY2FyZHNCYWNrTGlzdDogW2NjLlNwcml0ZV0sXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIC8vIOS7peWKqOeUu+eahOaWueW8j+aYvuekuueJjOiDjOW9sVxuICAgIHNob3dQbGF5Q2FyZEJhY2tzOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmhpZGVDYXJkQmFja3MoKTtcbiAgICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgbGV0IGludGVydmFsID0gMC4wNTtcbiAgICAgIHZhciBzdGFydFRpbWUgPSAwO1xuICAgICAgdGhpcy5jYXJkc0JhY2tMaXN0LmZvckVhY2goZnVuY3Rpb24oY2FyZEJhY2spe1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICBjYXJkQmFjay5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH0sIHN0YXJ0VGltZSk7XG4gICAgICAgIHN0YXJ0VGltZSA9IHN0YXJ0VGltZSArIGludGVydmFsO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgLy8g6ZqQ6JeP5pi+56S654mM6IOM5b2xXG4gICAgaGlkZUNhcmRCYWNrczogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuY2FyZHNCYWNrTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmRCYWNrKXtcbiAgICAgICAgY2FyZEJhY2subm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIC8q54mM6Iqx6ImyKi9cbiAgICAgICAgc3BhZGVzSW1hZ2VzOltjYy5TcHJpdGVGcmFtZV0sXG4gICAgICAgIGhlYXJ0c0ltYWdlczpbY2MuU3ByaXRlRnJhbWVdLFxuICAgICAgICBjbHViSW1hZ2VzOltjYy5TcHJpdGVGcmFtZV0sXG4gICAgICAgIGRpYW1vbmRJbWFnZXM6W2NjLlNwcml0ZUZyYW1lXSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgbGFiZWxNc2c6Y2MuTGFiZWwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldFRleHQ6ZnVuY3Rpb24odGV4dCkge1xuICAgICAgICB0aGlzLmxhYmVsTXNnLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGV4dDtcbiAgICB9LFxuXG4gICAgY2xpY2tBY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdGV4dCA9IHRoaXMubGFiZWxNc2cuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmc7XG4gICAgICAgIHRoaXMub25TZWxlY3RBY3Rpb24odGV4dCk7XG4gICAgfSxcblxuICAgIG9uU2VsZWN0QWN0aW9uOmZ1bmN0aW9uKG1zZykge1xuXG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xyXG5cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIHBob25lRWRpdEJveDpjYy5FZGl0Qm94LFxyXG4gICAgICAgIHd4RWRpdEJveDpjYy5FZGl0Qm94LFxyXG4gICAgICAgIGFsZXJ0OmNjLlByZWZhYixcclxuICAgICAgICBjYW52YXM6Y2MuTm9kZSxcclxuICAgICAgICBfdXNlcklkOm51bGwsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyU29ja2V0RXZlbnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgIF9yZWdpc3RlclNvY2tldEV2ZW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZU9uQ2hhbmdlSW5mbywgdGhpcy5fUmVjZWl2ZUNoYW5nZUluZm8sIHRoaXMpO1xyXG4gICAgfSxcclxuICAgIF9SZWNlaXZlQ2hhbmdlSW5mbyA6ZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAgIHZhciBjaGFuZ2VkUm93cyA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgdmFyIG1zZyA9ICcnO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coY2hhbmdlZFJvd3MpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMzhcIik7XHJcbiAgICAgICAgaWYoY2hhbmdlZFJvd3Mpe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuabtOaUueaIkOWKn1wiO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBtc2cgPSBcIuS7iuWkqeW3sue7j+abtOaWsOi/h+S6hu+8jOivt+aYjuWkqeWGjeabtOaWsFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFsZXJ0TXNnKG1zZyk7XHJcbiAgICB9LFxyXG4gICAgY2xpY2tBY3Rpb24gOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIHd4ID0gdGhpcy53eEVkaXRCb3guc3RyaW5nO1xyXG4gICAgICAgIHZhciBwaG9uZSA9IHRoaXMucGhvbmVFZGl0Qm94LnN0cmluZztcclxuICAgICAgICB2YXIgaW5mbyA9IHt9O1xyXG4gICAgICAgIHZhciBtc2cgPSAnJztcclxuICAgICAgICBpZighd3ggJiYgIXBob25lKXtcclxuICAgICAgICAgICAgbXNnID0gXCLor7floavlhpnlvq7kv6Hlj7flkozmiYvmnLrlj7dcIjtcclxuICAgICAgICAgICAgcGhvbmUgPSBcIlwiO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TXNnKG1zZyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoICEoLyheWzEtOV1cXGQqJCkvLnRlc3QocGhvbmUpKSApe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuaCqOi+k+WFpeeahOaJi+acuuWPt+eggeagvOW8j+S4jeWvue+8jOivt+mHjeaWsOi+k+WFpVwiO1xyXG4gICAgICAgICAgICBwaG9uZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiggcGhvbmUubGVuZ3RoICE9MTEgKXtcclxuICAgICAgICAgICAgbXNnID0gXCLmgqjovpPlhaXnmoTmiYvmnLrlj7fnoIHkuI3lpJ8xMeS9je+8jOivt+mHjeaWsOi+k+WFpVwiO1xyXG4gICAgICAgICAgICBwaG9uZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZighKC8oXlsxLTlhLXpBLVpdXFxkKiQpLy50ZXN0KHd4KSkgKXtcclxuICAgICAgICAgICAgbXNnID0gXCLmgqjovpPlhaXnmoTlvq7kv6Hlj7fmoLzlvI/kuI3lr7nvvIzor7fph43mlrDovpPlhaVcIjtcclxuICAgICAgICAgICAgd3ggPSBcIlwiO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TXNnKG1zZyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoIHd4Lmxlbmd0aDw2IHx8IHd4Lmxlbmd0aD4yMCApe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuaCqOi+k+WFpeeahOW+ruS/oeWPt+agvOW8j+i2heWHuuiMg+WbtO+8jOivt+i+k+WFpTZ+MjDkvY3nmoTlvq7kv6Hlj7dcIjtcclxuICAgICAgICAgICAgd3ggPSBcIlwiO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TXNnKG1zZyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaW5mby53eCA9IHd4O1xyXG4gICAgICAgIGluZm8ucGhvbmUgPSBwaG9uZTtcclxuICAgICAgICBTb2NrZXQuc2VuZENoYW5nZUluZm8odGhpcy5fdXNlcklkLGluZm8pO1xyXG4gICAgfSxcclxuXHJcbiAgICBhbGVydE1zZzogZnVuY3Rpb24obXNnKXtcclxuICAgICAgICB2YXIgYWxlcnQgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmFsZXJ0KTtcclxuICAgICAgICB0aGlzLmNhbnZhcy5hZGRDaGlsZChhbGVydCk7XHJcbiAgICAgICAgbGV0IGNvbXAgPSBhbGVydC5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBcclxuICAgICAgICBtUHRpdGxlOmNjLkxhYmVsLFxyXG4gICAgICAgIF9jYXJkczpbXSxcclxuICAgICAgICByZW5zaHVTZWxlY3Q6Y2MuTm9kZSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaHMgPSAzO1xyXG4gICAgICAgIHZhciBkcyA9IDU7XHJcbiAgICAgICAgaWYoY2Muc2V0KXtcclxuICAgICAgICAgICAgaHMgPSBjYy5zZXQuc2V0dGluZzdbMF07XHJcbiAgICAgICAgICAgIGRzID0gY2Muc2V0LnNldHRpbmc3WzFdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9jYXJkcyA9IFtocyxkc107XHJcbiAgICAgICAgIHRoaXMubXAoaHMsZHMpO1xyXG4gICAgfSxcclxuICAgIGNoYW5nZTogZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgc2VsZWN0ZWRJbmRleCA9IHRoaXMucmVuc2h1U2VsZWN0LmdldENvbXBvbmVudCgnc2luZ2xlU2VsZWN0Jykuc2VsZWN0ZWRJbmRleDtcclxuICAgICAgICB2YXIgaHMgPSBNYXRoLmNlaWwoIChNYXRoLnJhbmRvbSgpKjQwKS8xMCApOyAgICAvL+iOt+WPluS4gOS4qjF+NOeahOaVsOWtl++8jOS7o+ihqOiKseiJslxyXG4gICAgICAgIHZhciBkcyA9IE1hdGguY2VpbCggKE1hdGgucmFuZG9tKCkqMTMwKS8xMCApOyAgIC8v6I635Y+W5LiA5LiqMX4xM+eahOaVsOWtl++8jOS7o+ihqOeCueaVsFxyXG4gICAgICAgIHZhciBjYXJkID0gW2hzLGRzXTtcclxuICAgICAgICB0aGlzLl9jYXJkcyA9IGNhcmQ7XHJcbiAgICAgICAgdGhpcy5tcChocyxkcyxzZWxlY3RlZEluZGV4KVxyXG4gICAgfSxcclxuICAgIG1wOiBmdW5jdGlvbihoLGQsaW5kZXgpe1xyXG4gICAgICAgIHZhciBtYSA9IFwi5Y2V56CBXCI7XHJcbiAgICAgICAgdmFyIGhzID0gWyBcIuaWueWdl1wiLFwi5qKF6IqxXCIsXCLnuqLmoYNcIixcIum7keahg1wiXTtcclxuICAgICAgICB2YXIgZHMgPSBbIFwiMVwiLFwiMlwiLFwiM1wiLFwiNFwiLFwiNVwiLFwiNlwiLFwiN1wiLFwiOFwiLFwiOVwiLFwiMTBcIixcIkpcIixcIlFcIixcIktcIiBdO1xyXG4gICAgICAgIGlmKGluZGV4KXsgIFxyXG4gICAgICAgICAgICB2YXIgZGVmYXVsdE1hID0gNDtcclxuICAgICAgICAgICAgaWYoaCA+PSAoZGVmYXVsdE1hLWluZGV4KzEpICl7XHJcbiAgICAgICAgICAgICAgICBtYSA9IFwi5Y+M56CBXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tUHRpdGxlLnN0cmluZyA9IGhzW2gtMV0rZHNbZC0xXSttYTtcclxuICAgfSxcclxufSk7XHJcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgc2VsZWN0ZWRJbmRleCA6IDAsXHJcbiAgICAgICAgc2VsZWN0ZWROb2RlIDogY2MuTm9kZSAgXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKGUsZGF0YSkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhdGhpcy5zZWxlY3RlZDtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0aGlzLnNlbGVjdGVkO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IHRoaXMuc2VsZWN0ZWQ/MDpudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJ2YXIgc29ja2V0ID0gcmVxdWlyZShcInNvY2tldFwiKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBvcHRpb246e1xyXG4gICAgICAgICAgICBkZWZhdWx0OltdLFxyXG4gICAgICAgICAgICB0eXBlOmNjLk5vZGVcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcbiAgICBcclxuICAgIGNsaWNrQnRuY2hvdWppYW5nOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5vcHRpb24ubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIHRoaXMub3B0aW9uW2ldLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5fdGlzaGkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjaG91amlhbmdfYmdcIikuZ2V0Q2hpbGRCeU5hbWUoXCJ0aXNoaVwiKTtcclxuICAgICAgICB0aGlzLl9jYXJkX251bSA9IGNjLmZpbmQoXCJDYW52YXMvdXNlci9zaG9wX2JnL2NhcmRfbnVtXCIpO1xyXG4gICAgICAgIHZhciBjb21wID0gdGhpcy5fY2FyZF9udW0uZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGlmKGluZGV4ID09IDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uW2luZGV4XS5vcGFjaXR5ID0gMTI4O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uW3RoaXMub3B0aW9uLmxlbmd0aC0xXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYoaW5kZXggPT0gMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXhdLm9wYWNpdHkgPSAxMjg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXggLSAxXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXhdLm9wYWNpdHkgPSAxMjg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXgtMV0ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGluZGV4ICsrO1xyXG4gICAgICAgICAgICAgICAgaWYoaW5kZXggPT0gdGhpcy5vcHRpb24ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgaWYoY29tcC5zdHJpbmcgPCAyMCkge1xyXG4gICAgICAgICAgICB0aGlzLl90aXNoaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAvL2Nob3VqaWFuZ1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMuY2FsbGJhY2ssMC4wNSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLmNhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5vcHRpb24ubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baV0ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBpID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baV0ub3BhY2l0eSA9IDEyODtcclxuICAgICAgICAgICAgfSwzLDAsMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8qKipcclxuICAgIGNsaWNrQnRuQ29tZmlybTpmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl90aXNoaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL3RoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICAvLyoqKipcclxuXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICBcclxuICAgICAgICBcclxuICAgIH0sXHJcbiAgICBsb2FkQ2FyZFNwcml0ZUZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZShjYXJkTmFtZSwgY2FsbGJhY2spO1xyXG4gICAgfSxcclxuICAgIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lKSB7XHJcbiAgICAgICAgdmFyIGNhcmROYW1lID0gY2FyZFNob3J0TmFtZTtcclxuICAgICAgICBpZiAoIWNhcmROYW1lLnN0YXJ0c1dpdGgoXCJwdWJsaWMtcGljLWNhcmQtcG9rZXJcIikpIHtcclxuICAgICAgICAgIGNhcmROYW1lID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNhcmROYW1lO1xyXG4gICAgfSxcclxuICAgIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgY2MuYXNzZXJ0KGNhbGxiYWNrKTtcclxuICAgICAgICBjYy5sb2FkZXIubG9hZFJlcyhcInBsYXkvaGFsbC9wdWJsaWMvYWxsX2VmZmVjdF90dHdfbWFpblwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcclxuICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZXJyKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhcmROYW1lID0gdGhpcy5fY2FyZEZ1bGxOYW1lKGNhcmROYW1lKTtcclxuICAgICAgICAgICAgdmFyIGZyYW1lID0gYXRsYXMuZ2V0U3ByaXRlRnJhbWUoY2FyZE5hbWUpO1xyXG4gICAgICAgICAgICBjYWxsYmFjayhmcmFtZSk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgfSxcclxuICAgIHRlc3Q6ZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgXHJcbiAgICB9LFxyXG4gICAgXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBub2RlczpbY2MuTm9kZV0sXG4gICAgICAgIC8vc2VsZWN0ZWRJbmRleDogMCxcbiAgICAgICAgIF9zZWxlY3RlZDoxLFxuICAgIH0sXG5cbiAgICAvKiMjIyMqL1xuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3NlbGVjdCA9IHRydWU7IFxuICAgICAgICB2YXIgZGFpa2FpID0gMDtcbiAgICAgICAgaWYoY2Muc2V0KXtcbiAgICAgICAgICAgIGRhaWthaSA9IGNjLnNldC5zZXR0aW5nOTtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdGVkID0gdGhpcy5fc2VsZWN0ID0gZGFpa2FpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhY3RpdmUgPSB0aGlzLl9zZWxlY3Q7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RlZCA9IHRoaXMuX3NlbGVjdDtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKS5zZXRTZWxlY3RlZChhY3RpdmUpO1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gdGhpcy5ub2Rlc1tpXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcbiAgICAgICAgICAgIGlmKCBzZWxmLl9zZWxlY3QgKXtcbiAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRDb21wID0gdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgdENvbXAuaW5kZXggPSBpO1xuICAgICAgICAgICAgdENvbXAuY2xpY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKCBzZWxmLl9zZWxlY3RlZCA9IHNlbGYuX3NlbGVjdCA9ICFzZWxmLl9zZWxlY3QgKTtcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0aXRsZVwiKTtcbiAgICAgICAgICAgICAgICBpZiggc2VsZi5fc2VsZWN0ICl7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYub25TZWxlY3RDaGFuZ2UodGhpcy5pbmRleCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJvcmRlcnNcIiAmJiBjYy5zZXQpe1xuICAgICAgICAgICAgLy90aGlzLnJlbWVtYmVyX3NldChvdmVyVGltZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHJlbWVtYmVyX3NldDpmdW5jdGlvbihvYmope1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jykuc2V0U2VsZWN0ZWQob2JqKTtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJykuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgaWYoIG9iaiApe1xuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMubm9kZXNbMF0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XG4gICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25TZWxlY3RDaGFuZ2U6IGZ1bmN0aW9uIChzZWxlY3RJbmRleCkge1xuICAgICAgICAvL2NjLmxvZyhzZWxlY3RJbmRleCk7XG4gICAgfSxcbiAgICBcbn0pO1xuIiwiKGZ1bmN0aW9uIChtYWluKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogUGFyc2Ugb3IgZm9ybWF0IGRhdGVzXG4gICAqIEBjbGFzcyBmZWNoYVxuICAgKi9cbiAgdmFyIGZlY2hhID0ge307XG4gIHZhciB0b2tlbiA9IC9kezEsNH18TXsxLDR9fFlZKD86WVkpP3xTezEsM318RG98Wlp8KFtIaE1zRG1dKVxcMT98W2FBXXxcIlteXCJdKlwifCdbXiddKicvZztcbiAgdmFyIHR3b0RpZ2l0cyA9IC9cXGRcXGQ/LztcbiAgdmFyIHRocmVlRGlnaXRzID0gL1xcZHszfS87XG4gIHZhciBmb3VyRGlnaXRzID0gL1xcZHs0fS87XG4gIHZhciB3b3JkID0gL1swLTldKlsnYS16XFx1MDBBMC1cXHUwNUZGXFx1MDcwMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSt8W1xcdTA2MDAtXFx1MDZGRlxcL10rKFxccyo/W1xcdTA2MDAtXFx1MDZGRl0rKXsxLDJ9L2k7XG4gIHZhciBsaXRlcmFsID0gL1xcWyhbXl0qPylcXF0vZ207XG4gIHZhciBub29wID0gZnVuY3Rpb24gKCkge1xuICB9O1xuXG4gIGZ1bmN0aW9uIHNob3J0ZW4oYXJyLCBzTGVuKSB7XG4gICAgdmFyIG5ld0FyciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcnIubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIG5ld0Fyci5wdXNoKGFycltpXS5zdWJzdHIoMCwgc0xlbikpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3QXJyO1xuICB9XG5cbiAgZnVuY3Rpb24gbW9udGhVcGRhdGUoYXJyTmFtZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgdiwgaTE4bikge1xuICAgICAgdmFyIGluZGV4ID0gaTE4blthcnJOYW1lXS5pbmRleE9mKHYuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB2LnN1YnN0cigxKS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIGlmICh+aW5kZXgpIHtcbiAgICAgICAgZC5tb250aCA9IGluZGV4O1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBwYWQodmFsLCBsZW4pIHtcbiAgICB2YWwgPSBTdHJpbmcodmFsKTtcbiAgICBsZW4gPSBsZW4gfHwgMjtcbiAgICB3aGlsZSAodmFsLmxlbmd0aCA8IGxlbikge1xuICAgICAgdmFsID0gJzAnICsgdmFsO1xuICAgIH1cbiAgICByZXR1cm4gdmFsO1xuICB9XG5cbiAgdmFyIGRheU5hbWVzID0gWydTdW5kYXknLCAnTW9uZGF5JywgJ1R1ZXNkYXknLCAnV2VkbmVzZGF5JywgJ1RodXJzZGF5JywgJ0ZyaWRheScsICdTYXR1cmRheSddO1xuICB2YXIgbW9udGhOYW1lcyA9IFsnSmFudWFyeScsICdGZWJydWFyeScsICdNYXJjaCcsICdBcHJpbCcsICdNYXknLCAnSnVuZScsICdKdWx5JywgJ0F1Z3VzdCcsICdTZXB0ZW1iZXInLCAnT2N0b2JlcicsICdOb3ZlbWJlcicsICdEZWNlbWJlciddO1xuICB2YXIgbW9udGhOYW1lc1Nob3J0ID0gc2hvcnRlbihtb250aE5hbWVzLCAzKTtcbiAgdmFyIGRheU5hbWVzU2hvcnQgPSBzaG9ydGVuKGRheU5hbWVzLCAzKTtcbiAgZmVjaGEuaTE4biA9IHtcbiAgICBkYXlOYW1lc1Nob3J0OiBkYXlOYW1lc1Nob3J0LFxuICAgIGRheU5hbWVzOiBkYXlOYW1lcyxcbiAgICBtb250aE5hbWVzU2hvcnQ6IG1vbnRoTmFtZXNTaG9ydCxcbiAgICBtb250aE5hbWVzOiBtb250aE5hbWVzLFxuICAgIGFtUG06IFsnYW0nLCAncG0nXSxcbiAgICBEb0ZuOiBmdW5jdGlvbiBEb0ZuKEQpIHtcbiAgICAgIHJldHVybiBEICsgWyd0aCcsICdzdCcsICduZCcsICdyZCddW0QgJSAxMCA+IDMgPyAwIDogKEQgLSBEICUgMTAgIT09IDEwKSAqIEQgJSAxMF07XG4gICAgfVxuICB9O1xuXG4gIHZhciBmb3JtYXRGbGFncyA9IHtcbiAgICBEOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXREYXRlKCk7XG4gICAgfSxcbiAgICBERDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldERhdGUoKSk7XG4gICAgfSxcbiAgICBEbzogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGkxOG4uRG9GbihkYXRlT2JqLmdldERhdGUoKSk7XG4gICAgfSxcbiAgICBkOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXREYXkoKTtcbiAgICB9LFxuICAgIGRkOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0RGF5KCkpO1xuICAgIH0sXG4gICAgZGRkOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gaTE4bi5kYXlOYW1lc1Nob3J0W2RhdGVPYmouZ2V0RGF5KCldO1xuICAgIH0sXG4gICAgZGRkZDogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGkxOG4uZGF5TmFtZXNbZGF0ZU9iai5nZXREYXkoKV07XG4gICAgfSxcbiAgICBNOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRNb250aCgpICsgMTtcbiAgICB9LFxuICAgIE1NOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0TW9udGgoKSArIDEpO1xuICAgIH0sXG4gICAgTU1NOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gaTE4bi5tb250aE5hbWVzU2hvcnRbZGF0ZU9iai5nZXRNb250aCgpXTtcbiAgICB9LFxuICAgIE1NTU06IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcbiAgICAgIHJldHVybiBpMThuLm1vbnRoTmFtZXNbZGF0ZU9iai5nZXRNb250aCgpXTtcbiAgICB9LFxuICAgIFlZOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gU3RyaW5nKGRhdGVPYmouZ2V0RnVsbFllYXIoKSkuc3Vic3RyKDIpO1xuICAgIH0sXG4gICAgWVlZWTogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0RnVsbFllYXIoKTtcbiAgICB9LFxuICAgIGg6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldEhvdXJzKCkgJSAxMiB8fCAxMjtcbiAgICB9LFxuICAgIGhoOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0SG91cnMoKSAlIDEyIHx8IDEyKTtcbiAgICB9LFxuICAgIEg6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldEhvdXJzKCk7XG4gICAgfSxcbiAgICBISDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldEhvdXJzKCkpO1xuICAgIH0sXG4gICAgbTogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0TWludXRlcygpO1xuICAgIH0sXG4gICAgbW06IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRNaW51dGVzKCkpO1xuICAgIH0sXG4gICAgczogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0U2Vjb25kcygpO1xuICAgIH0sXG4gICAgc3M6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRTZWNvbmRzKCkpO1xuICAgIH0sXG4gICAgUzogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIE1hdGgucm91bmQoZGF0ZU9iai5nZXRNaWxsaXNlY29uZHMoKSAvIDEwMCk7XG4gICAgfSxcbiAgICBTUzogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChNYXRoLnJvdW5kKGRhdGVPYmouZ2V0TWlsbGlzZWNvbmRzKCkgLyAxMCksIDIpO1xuICAgIH0sXG4gICAgU1NTOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0TWlsbGlzZWNvbmRzKCksIDMpO1xuICAgIH0sXG4gICAgYTogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0SG91cnMoKSA8IDEyID8gaTE4bi5hbVBtWzBdIDogaTE4bi5hbVBtWzFdO1xuICAgIH0sXG4gICAgQTogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0SG91cnMoKSA8IDEyID8gaTE4bi5hbVBtWzBdLnRvVXBwZXJDYXNlKCkgOiBpMThuLmFtUG1bMV0udG9VcHBlckNhc2UoKTtcbiAgICB9LFxuICAgIFpaOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICB2YXIgbyA9IGRhdGVPYmouZ2V0VGltZXpvbmVPZmZzZXQoKTtcbiAgICAgIHJldHVybiAobyA+IDAgPyAnLScgOiAnKycpICsgcGFkKE1hdGguZmxvb3IoTWF0aC5hYnMobykgLyA2MCkgKiAxMDAgKyBNYXRoLmFicyhvKSAlIDYwLCA0KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHBhcnNlRmxhZ3MgPSB7XG4gICAgRDogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQuZGF5ID0gdjtcbiAgICB9XSxcbiAgICBEbzogW25ldyBSZWdFeHAodHdvRGlnaXRzLnNvdXJjZSArIHdvcmQuc291cmNlKSwgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQuZGF5ID0gcGFyc2VJbnQodiwgMTApO1xuICAgIH1dLFxuICAgIE06IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLm1vbnRoID0gdiAtIDE7XG4gICAgfV0sXG4gICAgWVk6IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICB2YXIgZGEgPSBuZXcgRGF0ZSgpLCBjZW50ID0gKygnJyArIGRhLmdldEZ1bGxZZWFyKCkpLnN1YnN0cigwLCAyKTtcbiAgICAgIGQueWVhciA9ICcnICsgKHYgPiA2OCA/IGNlbnQgLSAxIDogY2VudCkgKyB2O1xuICAgIH1dLFxuICAgIGg6IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLmhvdXIgPSB2O1xuICAgIH1dLFxuICAgIG06IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLm1pbnV0ZSA9IHY7XG4gICAgfV0sXG4gICAgczogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQuc2Vjb25kID0gdjtcbiAgICB9XSxcbiAgICBZWVlZOiBbZm91ckRpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQueWVhciA9IHY7XG4gICAgfV0sXG4gICAgUzogWy9cXGQvLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5taWxsaXNlY29uZCA9IHYgKiAxMDA7XG4gICAgfV0sXG4gICAgU1M6IFsvXFxkezJ9LywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQubWlsbGlzZWNvbmQgPSB2ICogMTA7XG4gICAgfV0sXG4gICAgU1NTOiBbdGhyZWVEaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLm1pbGxpc2Vjb25kID0gdjtcbiAgICB9XSxcbiAgICBkOiBbdHdvRGlnaXRzLCBub29wXSxcbiAgICBkZGQ6IFt3b3JkLCBub29wXSxcbiAgICBNTU06IFt3b3JkLCBtb250aFVwZGF0ZSgnbW9udGhOYW1lc1Nob3J0JyldLFxuICAgIE1NTU06IFt3b3JkLCBtb250aFVwZGF0ZSgnbW9udGhOYW1lcycpXSxcbiAgICBhOiBbd29yZCwgZnVuY3Rpb24gKGQsIHYsIGkxOG4pIHtcbiAgICAgIHZhciB2YWwgPSB2LnRvTG93ZXJDYXNlKCk7XG4gICAgICBpZiAodmFsID09PSBpMThuLmFtUG1bMF0pIHtcbiAgICAgICAgZC5pc1BtID0gZmFsc2U7XG4gICAgICB9IGVsc2UgaWYgKHZhbCA9PT0gaTE4bi5hbVBtWzFdKSB7XG4gICAgICAgIGQuaXNQbSA9IHRydWU7XG4gICAgICB9XG4gICAgfV0sXG4gICAgWlo6IFsvKFtcXCtcXC1dXFxkXFxkOj9cXGRcXGR8WikvLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgaWYgKHYgPT09ICdaJykgdiA9ICcrMDA6MDAnO1xuICAgICAgdmFyIHBhcnRzID0gKHYgKyAnJykubWF0Y2goLyhbXFwrXFwtXXxcXGRcXGQpL2dpKSwgbWludXRlcztcblxuICAgICAgaWYgKHBhcnRzKSB7XG4gICAgICAgIG1pbnV0ZXMgPSArKHBhcnRzWzFdICogNjApICsgcGFyc2VJbnQocGFydHNbMl0sIDEwKTtcbiAgICAgICAgZC50aW1lem9uZU9mZnNldCA9IHBhcnRzWzBdID09PSAnKycgPyBtaW51dGVzIDogLW1pbnV0ZXM7XG4gICAgICB9XG4gICAgfV1cbiAgfTtcbiAgcGFyc2VGbGFncy5kZCA9IHBhcnNlRmxhZ3MuZDtcbiAgcGFyc2VGbGFncy5kZGRkID0gcGFyc2VGbGFncy5kZGQ7XG4gIHBhcnNlRmxhZ3MuREQgPSBwYXJzZUZsYWdzLkQ7XG4gIHBhcnNlRmxhZ3MubW0gPSBwYXJzZUZsYWdzLm07XG4gIHBhcnNlRmxhZ3MuaGggPSBwYXJzZUZsYWdzLkggPSBwYXJzZUZsYWdzLkhIID0gcGFyc2VGbGFncy5oO1xuICBwYXJzZUZsYWdzLk1NID0gcGFyc2VGbGFncy5NO1xuICBwYXJzZUZsYWdzLnNzID0gcGFyc2VGbGFncy5zO1xuICBwYXJzZUZsYWdzLkEgPSBwYXJzZUZsYWdzLmE7XG5cblxuICAvLyBTb21lIGNvbW1vbiBmb3JtYXQgc3RyaW5nc1xuICBmZWNoYS5tYXNrcyA9IHtcbiAgICBkZWZhdWx0OiAnZGRkIE1NTSBERCBZWVlZIEhIOm1tOnNzJyxcbiAgICBzaG9ydERhdGU6ICdNL0QvWVknLFxuICAgIG1lZGl1bURhdGU6ICdNTU0gRCwgWVlZWScsXG4gICAgbG9uZ0RhdGU6ICdNTU1NIEQsIFlZWVknLFxuICAgIGZ1bGxEYXRlOiAnZGRkZCwgTU1NTSBELCBZWVlZJyxcbiAgICBzaG9ydFRpbWU6ICdISDptbScsXG4gICAgbWVkaXVtVGltZTogJ0hIOm1tOnNzJyxcbiAgICBsb25nVGltZTogJ0hIOm1tOnNzLlNTUydcbiAgfTtcblxuICAvKioqXG4gICAqIEZvcm1hdCBhIGRhdGVcbiAgICogQG1ldGhvZCBmb3JtYXRcbiAgICogQHBhcmFtIHtEYXRlfG51bWJlcn0gZGF0ZU9ialxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWFzayBGb3JtYXQgb2YgdGhlIGRhdGUsIGkuZS4gJ21tLWRkLXl5JyBvciAnc2hvcnREYXRlJ1xuICAgKi9cbiAgZmVjaGEuZm9ybWF0ID0gZnVuY3Rpb24gKGRhdGVPYmosIG1hc2ssIGkxOG5TZXR0aW5ncykge1xuICAgIHZhciBpMThuID0gaTE4blNldHRpbmdzIHx8IGZlY2hhLmkxOG47XG5cbiAgICBpZiAodHlwZW9mIGRhdGVPYmogPT09ICdudW1iZXInKSB7XG4gICAgICBkYXRlT2JqID0gbmV3IERhdGUoZGF0ZU9iaik7XG4gICAgfVxuXG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChkYXRlT2JqKSAhPT0gJ1tvYmplY3QgRGF0ZV0nIHx8IGlzTmFOKGRhdGVPYmouZ2V0VGltZSgpKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIERhdGUgaW4gZmVjaGEuZm9ybWF0Jyk7XG4gICAgfVxuXG4gICAgbWFzayA9IGZlY2hhLm1hc2tzW21hc2tdIHx8IG1hc2sgfHwgZmVjaGEubWFza3NbJ2RlZmF1bHQnXTtcblxuICAgIHZhciBsaXRlcmFscyA9IFtdO1xuXG4gICAgLy8gTWFrZSBsaXRlcmFscyBpbmFjdGl2ZSBieSByZXBsYWNpbmcgdGhlbSB3aXRoID8/XG4gICAgbWFzayA9IG1hc2sucmVwbGFjZShsaXRlcmFsLCBmdW5jdGlvbigkMCwgJDEpIHtcbiAgICAgIGxpdGVyYWxzLnB1c2goJDEpO1xuICAgICAgcmV0dXJuICc/Pyc7XG4gICAgfSk7XG4gICAgLy8gQXBwbHkgZm9ybWF0dGluZyBydWxlc1xuICAgIG1hc2sgPSBtYXNrLnJlcGxhY2UodG9rZW4sIGZ1bmN0aW9uICgkMCkge1xuICAgICAgcmV0dXJuICQwIGluIGZvcm1hdEZsYWdzID8gZm9ybWF0RmxhZ3NbJDBdKGRhdGVPYmosIGkxOG4pIDogJDAuc2xpY2UoMSwgJDAubGVuZ3RoIC0gMSk7XG4gICAgfSk7XG4gICAgLy8gSW5saW5lIGxpdGVyYWwgdmFsdWVzIGJhY2sgaW50byB0aGUgZm9ybWF0dGVkIHZhbHVlXG4gICAgcmV0dXJuIG1hc2sucmVwbGFjZSgvXFw/XFw/L2csIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGxpdGVyYWxzLnNoaWZ0KCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhcnNlIGEgZGF0ZSBzdHJpbmcgaW50byBhbiBvYmplY3QsIGNoYW5nZXMgLSBpbnRvIC9cbiAgICogQG1ldGhvZCBwYXJzZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gZGF0ZVN0ciBEYXRlIHN0cmluZ1xuICAgKiBAcGFyYW0ge3N0cmluZ30gZm9ybWF0IERhdGUgcGFyc2UgZm9ybWF0XG4gICAqIEByZXR1cm5zIHtEYXRlfGJvb2xlYW59XG4gICAqL1xuICBmZWNoYS5wYXJzZSA9IGZ1bmN0aW9uIChkYXRlU3RyLCBmb3JtYXQsIGkxOG5TZXR0aW5ncykge1xuICAgIHZhciBpMThuID0gaTE4blNldHRpbmdzIHx8IGZlY2hhLmkxOG47XG5cbiAgICBpZiAodHlwZW9mIGZvcm1hdCAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBmb3JtYXQgaW4gZmVjaGEucGFyc2UnKTtcbiAgICB9XG5cbiAgICBmb3JtYXQgPSBmZWNoYS5tYXNrc1tmb3JtYXRdIHx8IGZvcm1hdDtcblxuICAgIC8vIEF2b2lkIHJlZ3VsYXIgZXhwcmVzc2lvbiBkZW5pYWwgb2Ygc2VydmljZSwgZmFpbCBlYXJseSBmb3IgcmVhbGx5IGxvbmcgc3RyaW5nc1xuICAgIC8vIGh0dHBzOi8vd3d3Lm93YXNwLm9yZy9pbmRleC5waHAvUmVndWxhcl9leHByZXNzaW9uX0RlbmlhbF9vZl9TZXJ2aWNlXy1fUmVEb1NcbiAgICBpZiAoZGF0ZVN0ci5sZW5ndGggPiAxMDAwKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIGlzVmFsaWQgPSB0cnVlO1xuICAgIHZhciBkYXRlSW5mbyA9IHt9O1xuICAgIGZvcm1hdC5yZXBsYWNlKHRva2VuLCBmdW5jdGlvbiAoJDApIHtcbiAgICAgIGlmIChwYXJzZUZsYWdzWyQwXSkge1xuICAgICAgICB2YXIgaW5mbyA9IHBhcnNlRmxhZ3NbJDBdO1xuICAgICAgICB2YXIgaW5kZXggPSBkYXRlU3RyLnNlYXJjaChpbmZvWzBdKTtcbiAgICAgICAgaWYgKCF+aW5kZXgpIHtcbiAgICAgICAgICBpc1ZhbGlkID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGF0ZVN0ci5yZXBsYWNlKGluZm9bMF0sIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIGluZm9bMV0oZGF0ZUluZm8sIHJlc3VsdCwgaTE4bik7XG4gICAgICAgICAgICBkYXRlU3RyID0gZGF0ZVN0ci5zdWJzdHIoaW5kZXggKyByZXN1bHQubGVuZ3RoKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHBhcnNlRmxhZ3NbJDBdID8gJycgOiAkMC5zbGljZSgxLCAkMC5sZW5ndGggLSAxKTtcbiAgICB9KTtcblxuICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHZhciB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgaWYgKGRhdGVJbmZvLmlzUG0gPT09IHRydWUgJiYgZGF0ZUluZm8uaG91ciAhPSBudWxsICYmICtkYXRlSW5mby5ob3VyICE9PSAxMikge1xuICAgICAgZGF0ZUluZm8uaG91ciA9ICtkYXRlSW5mby5ob3VyICsgMTI7XG4gICAgfSBlbHNlIGlmIChkYXRlSW5mby5pc1BtID09PSBmYWxzZSAmJiArZGF0ZUluZm8uaG91ciA9PT0gMTIpIHtcbiAgICAgIGRhdGVJbmZvLmhvdXIgPSAwO1xuICAgIH1cblxuICAgIHZhciBkYXRlO1xuICAgIGlmIChkYXRlSW5mby50aW1lem9uZU9mZnNldCAhPSBudWxsKSB7XG4gICAgICBkYXRlSW5mby5taW51dGUgPSArKGRhdGVJbmZvLm1pbnV0ZSB8fCAwKSAtICtkYXRlSW5mby50aW1lem9uZU9mZnNldDtcbiAgICAgIGRhdGUgPSBuZXcgRGF0ZShEYXRlLlVUQyhkYXRlSW5mby55ZWFyIHx8IHRvZGF5LmdldEZ1bGxZZWFyKCksIGRhdGVJbmZvLm1vbnRoIHx8IDAsIGRhdGVJbmZvLmRheSB8fCAxLFxuICAgICAgICBkYXRlSW5mby5ob3VyIHx8IDAsIGRhdGVJbmZvLm1pbnV0ZSB8fCAwLCBkYXRlSW5mby5zZWNvbmQgfHwgMCwgZGF0ZUluZm8ubWlsbGlzZWNvbmQgfHwgMCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkYXRlID0gbmV3IERhdGUoZGF0ZUluZm8ueWVhciB8fCB0b2RheS5nZXRGdWxsWWVhcigpLCBkYXRlSW5mby5tb250aCB8fCAwLCBkYXRlSW5mby5kYXkgfHwgMSxcbiAgICAgICAgZGF0ZUluZm8uaG91ciB8fCAwLCBkYXRlSW5mby5taW51dGUgfHwgMCwgZGF0ZUluZm8uc2Vjb25kIHx8IDAsIGRhdGVJbmZvLm1pbGxpc2Vjb25kIHx8IDApO1xuICAgIH1cbiAgICByZXR1cm4gZGF0ZTtcbiAgfTtcblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZlY2hhO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZmVjaGE7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgbWFpbi5mZWNoYSA9IGZlY2hhO1xuICB9XG59KSh0aGlzKTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIG1lc3NhZ2VOb2RlOmNjLk5vZGUsXG4gICAgICAgIHBsYXlOb2RlOmNjLk5vZGUsXG5cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2hvd01lc3NhZ2VBbGVydDpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMubWVzc2FnZU5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgIGNvbXAucGxheSgncG9wJyk7XG4gICAgfSxcblxuICAgIGRpc21pc3NNZXNzYWdlQWxlcnQ6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNlbGYubWVzc2FnZU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH0sMC4zKTtcbiAgICB9LFxuXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgY3JlYXRlX2FuaW1hOntcclxuICAgICAgICAgICAgdHlwZTpjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICAgICAgZGVmYXVsdDpbXSxcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcbiBcclxuICAgIFxyXG59KTtcclxuIiwidmFyIG1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XG5jb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcbmNvbnN0IFBsYXliYWNrID0gcmVxdWlyZSgnUGxheWJhY2snKTtcblxubGV0IGhhbGwgPSBjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuXG4gICAgICAgIC8vcHJvZHVjdE5vZGVzOltjYy5Ob2RlXSxcbiAgICAgICAgc2hvcEFsZXJ0Tm9kZTpjYy5Ob2RlLFxuICAgICAgICBjcmVhdGVOb2RlOmNjLk5vZGUsXG4gICAgICAgIGpvaW5Ob2RlOmNjLk5vZGUsXG4gICAgICAgIGdlbmd4aW46Y2MuTm9kZSxcbiAgICAgICAgYWxlcnRQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICB0c1NpbmdsZVNlbGVjdDpbY2MuTm9kZV0sICAgLy8g5Yib5bu65oi/6Ze05L+h5oGv77yM5Y2V6YCJXG4gICAgICAgIHRzQ2hlY2tTZWNsZWN0OltjYy5Ob2RlXSwgICAvLyDliJvlu7rmiL/pl7Tkv6Hmga/vvIzlpI3pgIlcbiAgICAgICAgc2VsZWN0TW9TaGk6Y2MuTm9kZSwgICAgICAgIC8vIOWIm+W7uuaIv+mXtOS/oeaBr++8jOaooeW8j++8iOW6hOWutuaooeW8j+WSjOaXoOeJueauiueJjO+8iVxuICAgICAgICBzZWxlY3RHdWlQYWk6Y2MuTm9kZSwgICAgICAgLy8g5Yib5bu65oi/6Ze05L+h5oGv77yM5qih5byP77yI5bqE5a625qih5byP5ZKM5peg54m55q6K54mM77yJXG4gICAgICAgIG92ZXJUaW1lOmNjLk5vZGUsICAgICAgICAgICAvLyDotoXml7blh7rniYxcbiAgICAgICAgZGFpa2FpOmNjLk5vZGUsICAgICAgICAgICAgIC8v5Luj5byA5oi/XG4gICAgICAgIC8vbGFiZWxOb3RpY2U6IGNjLkxhYmVsLCAgICAgIC8vwqDlhazlkYpcbiAgICAgICAgbGFiZWxCYW5uZXI6IGNjLkxhYmVsLCAgICAgIC8vIGJhbm5lciBsYWJlbFxuICAgICAgICByZWNvcmROb2RlOmNjLk5vZGUsXG4gICAgICAgIHdhaXRpbmdQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICBzZXR0aW5nOmNjLk5vZGUsXG4gICAgICAgIC8v55So5oi35L+h5oGvXG4gICAgICAgIGF2YXRhck5vZGU6Y2MuTm9kZSxcbiAgICAgICAgbmlja05hbWVMYWJlbDpjYy5MYWJlbCxcbiAgICAgICAgY2FyZE51bWJlckxhYmVsOmNjLkxhYmVsLFxuICAgICAgICB1c2VySWRMYWJlbDpjYy5MYWJlbCxcbiAgICAgICAgY29kZUxhYmVsOmNjLkxhYmVsLFxuICAgICAgICAvL3Bob25lOmNjLkxhYmVsLFxuICAgICAgICAvLyB1c2VySW5mb01zZ05vZGU6Y2MuTm9kZSxcbiAgICAgICAgbG9nb3V0Tm9kZTogY2MuTm9kZSxcbiAgICAgICAgLy/miJjnu6lcbiAgICAgICAgcmVjb3JkTXNnTm9kZTpjYy5Ob2RlLFxuICAgICAgICBmZWVkYmFja0VkaXRCb3g6Y2MuRWRpdEJveCwvL+WPjemmiFxuICAgICAgICBmZWVkYmFja05vZGU6Y2MuTm9kZSxcbiAgICAgICAgd3hzaGFyZTpjYy5Ob2RlLFxuICAgICAgICBfdXNlcklkOjAsXG4gICAgICAgIF9vcGVuSWQ6bnVsbCxcbiAgICAgICAgX2hlbHA6bnVsbCxcbiAgICAgICAgX2Nsb3NlOm51bGwsXG4gICAgICAgIGlvc1VybDpudWxsLFxuICAgICAgICBhVXJsOm51bGwsXG5cbiAgICB9LFxuXG4gICAgc3RhdGljczoge1xuICAgICAgICBsYXN0SGFsbEluZm86IG51bGwsICAgLy8g5LiK5LiA5qyh5pS25Yiw55qE5aSn5Y6F5L+h5oGvXG4gICAgICAgIGNhY2hlSW1hZ2VJbmZvOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5rZXlCYWNrTGlzdGVuKCk7XG4gICAgICAgIGlmKGNjLnN5cy5pc0Jyb3dzZXIpIHtcbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvVGltZUxpbmUpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1Nlc3Npb24pIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1Nlc3Npb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XG4gICAgICAgIHZhciBiZyA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInJvb21fYmdcIik7XG4gICAgICAgIHZhciB3aW5kb3dQID0gY2MuZGlyZWN0b3IuZ2V0V2luU2l6ZUluUGl4ZWxzKCk7XG4gICAgICAgIHZhciBzY2FsZVggPSB3aW5kb3dQLndpZHRoL2JnLndpZHRoO1xuICAgICAgICB2YXIgc2NhbGVZID0gd2luZG93UC5oZWlnaHQvYmcuaGVpZ2h0O1xuICAgICAgICB2YXIgc2NhbGUgPSBNYXRoLm1heChzY2FsZVgsc2NhbGVZKTtcbiAgICAgICAgYmcuc2NhbGVYID0gc2NhbGU7XG4gICAgICAgIGJnLnNjYWxlWSA9IHNjYWxlO1xuICAgICAgICB0aGlzLmNsZWFyTG9jYWxTdG9yYWdlKCk7XG4gICAgICAgIGNjLmZyb20gPSB7fTtcbiAgICAgICAgY2MuZnJvbS5pc1VzZU1hID0gdHJ1ZTtcbiAgICAgICAgY2MuZnJvbS5tYSA9IDA7XG4gICAgICAgIGNjLmlzUm9vbVZpZXdTaG93ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2J0biA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0blwiKTtcbiAgICAgICAgdGhpcy5fYnV0dG9ucyA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ1dHRvbnNcIik7XG4gICAgICAgIHZhciB2b2x1bWUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJiZ1ZvbHVtZVwiKTtcbiAgICAgICAgaWYodm9sdW1lIT1udWxsICYmIHBhcnNlSW50KHZvbHVtZSkpIHtcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5TXVzaWMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBiZ1NvdW5kID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdTb3VuZFwiKTtcbiAgICAgICAgaWYoYmdTb3VuZCA9PSAwKXtcbiAgICAgICAgICAgIHZhciBhdWRpb01hbmFnZXIgPSBjYy5maW5kKCdBdWRpb01hbmFnZXInKTtcbiAgICAgICAgICAgIGF1ZGlvTWFuYWdlciA9IGF1ZGlvTWFuYWdlci5nZXRDb21wb25lbnQoJ0F1ZGlvTWFuYWdlcicpO1xuICAgICAgICAgICAgYXVkaW9NYW5hZ2VyLnNldEVmZmVjdE11c2ljVm9sdW0oYmdTb3VuZCk7XG4gICAgICAgIH1cbiAgICAgICAgUGxheWJhY2suaW5zdGFuY2UucmVtb3ZlUGxheWJhY2tEYXRhcygpO1xuXG4gICAgICAgIGhhbGwuY2FjaGVJbWFnZUluZm8gPSBoYWxsLmNhY2hlSW1hZ2VJbmZvIHx8IHt9O1xuXG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyU29ja2V0RXZlbnQoKTtcbiAgICAgICAgdGhpcy5fc3RhcnRCYW5uZXJBbmltYXRpb24oKTtcbiAgICAgICAgdGhpcy5faW5pdEpvaW5Sb29tKCk7XG5cbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgICB0aGlzLl9vcGVuSWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8ub3BlbklkO1xuICAgICAgICB0aGlzLl9pbnZpdGVDb2RlID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmludml0ZUNvZGU7ICAvL+mCgOivt+eggVxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuc29ja2V0ID0gY2MuZmluZCgnR2FtZVNvY2tldCcpLmdldENvbXBvbmVudCgnc29ja2V0Jyk7XG4gICAgICAgIHRoaXMuc29ja2V0LnJlY2V2aWNlTWVzc2FnZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2UpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25TdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLmhpZGRlbk5ldHdvcmtNZXNzYWdlKCk7XG4gICAgICAgICAgICBzZWxmLmhpZGRlbkNoZWNrTWVzc2FnZSgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNvY2tldC5jb25uZWN0aW9uRGlzY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5zaG93TmV0d29ya01lc3NhZ2UoJ+e9kee7nOmTvuaOpeaWreW8gO+8jOmHjeaWsOi/nuaOpeS4rS4uLicpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNvY2tldC5jaGVja05ldHdvcmtOb3cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYuc2hvd0NoZWNrTWVzc2FnZSgn5qOA5p+l572R57uc5LitLi4uJyk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc29ja2V0LmNoZWNrTmV0d29ya0VuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5oaWRkZW5DaGVja01lc3NhZ2UoKTtcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyAgLyrorr7nva7nlKjmiLfkv6Hmga8qL1xuICAgICAgICB0aGlzLnVwZGF0ZVVzZXJJbmZvKCk7XG4gICAgICAgIC8q5Yi35paw55So5oi35L+h5oGvKi9cbiAgICAgICAgU29ja2V0LnNlbmRHZXRVc2VySW5mbyh0aGlzLl91c2VySWQsdGhpcy5fb3BlbklkKTtcbiAgICAgICAgLyrlrprml7bliLfmlrDnlKjmiLfkv6Hmga8qL1xuICAgICAgICB0aGlzLnNjaGVkdWxlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBTb2NrZXQuc2VuZEdldFVzZXJJbmZvKHRoaXMuX3VzZXJJZCx0aGlzLl9vcGVuSWQpO1xuICAgICAgICB9LmJpbmQodGhpcyksMTApOy8vMTBz5LiA5qyhXG4gICAgICAgIFNvY2tldC5zZW5kR2V0SGFsbEluZm8odGhpcy5zb2NrZXQudXNlckluZm8uaWQpO1xuICAgICAgICBpZiAoaGFsbC5sYXN0SGFsbEluZm8pIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQmFubmVyKGhhbGwubGFzdEhhbGxJbmZvLmluZm8pO1xuICAgICAgICB9XG4gICAgICAgIGNjLm9uU2hhcmVXWFJlc3AgPSBudWxsO1xuICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ3BsYXknLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ2xvZ2luJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZihjYy5qb2luRGVzayE9bnVsbCl7XG4gICAgICAgICAgICBpZighY2Muam9pbkRlc2sucmVzdWx0KXtcbiAgICAgICAgICAgICAgICB2YXIgcmVhc29uID0gY2Muam9pbkRlc2sucmVhc29uO1xuICAgICAgICAgICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlKHJlYXNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYy5qb2luRGVzayA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYoY2MucWluZ2xpICE9IG51bGwpe1xuICAgICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UoXCLmgqjooqvmiL/kuLvor7flh7rmiL/pl7RcIik7XG4gICAgICAgICAgICBjYy5xaW5nbGkgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIC8vdmFyIGNyZWF0QW5pbWEgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjcmVhdGVfcm9vbVwiKTtcbiAgICB9LFxuXG4gICAga2V5QmFja0xpc3RlbjpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGNjLnN5c3RlbUV2ZW50Lm9uKGNjLlN5c3RlbUV2ZW50LkV2ZW50VHlwZS5LRVlfRE9XTixmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT0gY2MuS0VZLmJhY2spIHtcbiAgICAgICAgICAgICAgICBpZighS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSl7XG4gICAgICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJiYWNrVG9EZXNrXCIsIFwiKClWXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSx0aGlzKTtcbiAgICB9LFxuXG4gICAgY2xpY2tXeFNoYXJlOmZ1bmN0aW9uKCl7XG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgdGhpcy53eHNoYXJlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzaGFyZVRpdGxlJyk7XG4gICAgICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Rlc2MnKTtcbiAgICAgICAgICAgIHZhciByZWNvcmRJZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVjb3JkSWQnKTtcbiAgICAgICAgICAgIHZhciBpZD0gJyc7XG4gICAgICAgICAgICBpZihyZWNvcmRJZCl7XG4gICAgICAgICAgICAgICAgaWQgPSAncmVjb3JkSWQ9JytyZWNvcmRJZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVGcmllbmRcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XG4gICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVGcmllbmRcIiwgc3RyLGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy/liIbkuqvliLDmnIvlj4vlnIhcbiAgICBzaGFyZUhhbGxUaW1lbGluZTpmdW5jdGlvbigpe1xuICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgIHRoaXMud3hzaGFyZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2hhcmVUaXRsZScpO1xuICAgICAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkZXNjJyk7XG4gICAgICAgICAgICB2YXIgcmVjb3JkSWQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JlY29yZElkJyk7XG4gICAgICAgICAgICB2YXIgaWQ9ICcnO1xuICAgICAgICAgICAgaWYocmVjb3JkSWQpe1xuICAgICAgICAgICAgICAgIGlkID0gJ3JlY29yZElkPScrcmVjb3JkSWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAgICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xuICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsIHN0cixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBzaGFyZUJnOmZ1bmN0aW9uKCl7XG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgdGhpcy53eHNoYXJlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIC8vIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICAvLyAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAgLy8gICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xuICAgICAgICAgICAgLy8gICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsIHN0cixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNsZWFyTG9jYWxTdG9yYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzaGFyZVRpdGxlID0gJ+W8gOaIv+eOqVvlpKfkvJfljYHkuInmsLRdJztcbiAgICAgICAgdmFyIGRlc2MgPSAn5byA5aW95oi/5LqG77yM5bCx562J5L2g5Lus5LiA6LW35p2lW+Wkp+S8l+WNgeS4ieawtF3llabvvIHmmZrkuobkvY3nva7lsLHmsqHkuoblk59+JzsgXG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgncm9vbUlkJyk7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2hhcmVUaXRsZScsc2hhcmVUaXRsZSk7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGVzYycsZGVzYyk7XG4gICAgfSxcblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNvY2tldC5yZWNldmljZU1lc3NhZ2UgPSBmdW5jdGlvbigpIHt9O1xuICAgICAgICB0aGlzLnNvY2tldC5jb25uZWN0aW9uU3VjY2VzcyA9IGZ1bmN0aW9uKCkge307XG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25EaXNjb25uZWN0ID0gZnVuY3Rpb24oKSB7fTtcbiAgICAgICAgdGhpcy5zb2NrZXQuY2hlY2tOZXR3b3JrTm93ID0gZnVuY3Rpb24oKXt9O1xuICAgICAgICB0aGlzLnNvY2tldC5jaGVja05ldHdvcmtFbmQgPSBmdW5jdGlvbigpIHt9O1xuICAgICAgICBcbiAgICAgIEtRR2xvYmFsRXZlbnQub2ZmVGFyZ2V0KHRoaXMpO1xuICAgIH0sXG5cbiAgICBfcmVnaXN0ZXJTb2NrZXRFdmVudDogZnVuY3Rpb24gKCkge1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Kb2luRGVzaywgdGhpcy5famlpblJvb21Tb2NrZXRDYWxsYmFjaywgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEZXNrSW5mbywgdGhpcy5famlpblJvb21Tb2NrZXRDYWxsYmFjaywgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVDcmVhdGVEZXNrLCB0aGlzLl9jcmVhdGVSb29tU29ja2V0Q2FsbGJhY2ssIHRoaXMpO1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlSGFsbEluZm8sIHRoaXMuX3NvY2tldFJlY2VpdmVIYWxsSW5mbywgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVHZXRVc2VySW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZVVzZXJJbmZvLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0RGlzY29ubmVjdCwgdGhpcy5fc29ja2V0RGlzY29ubmVjdCwgdGhpcyk7XG4gICAgICAgIC8vS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUludml0ZUNvZGUsIHRoaXMuX3NvY2tldFJlY2VpdmVJbnZpdGVDb2RlLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcy5fc29ja2V0Q29ubmVjdGVkLCB0aGlzKTtcbiAgICAgICAgLy9LUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlU2hhcmVQbmcsIHRoaXMuX3NvY2tldFNoYXJlUG5nLCB0aGlzKTtcbiAgICB9LFxuXG5cbiAgICAvLyDot7PovazliLDlhazkvJflj7dcbiAgICBndWFuemh1OmZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIHZhciB1cmwgPSBcImh0dHA6Ly93d3cuaG9uZ2dlZmVuZy5jbi9nemgvaW5kZXguaHRtbFwiO1xuICAgICAgICAvLyBjYy5zeXMub3BlblVSTCh1cmwpXG4gICAgfSxcbiAgICBfc3RhcnRCYW5uZXJBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLmxhYmVsQmFubmVyLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICBhbmltLnBsYXkoJ2Jhbm5lcicpO1xuICAgIH0sXG4gICAgZG93bkxvYWQ6ZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIHVybCA9J2h0dHBzOi8vZmlyLmltLzV0bmUnO1xuICAgICAgICBjYy5zeXMub3BlblVSTCh1cmwpO1xuXG4gICAgICAgIC8vd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcImh0dHA6Ly93d3cuYmFpZHUuY29tXCI7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCLvvJ/vvJ/vvJ/vvJ/vvJ/vvJ/vvJ/vvJ9cIik7XG4gICAgfSxcblxuICAgIF9pbml0Sm9pblJvb206IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBsZXQgam9pblJvb20gPSB0aGlzLmpvaW5Ob2RlLmdldENvbXBvbmVudCgnam9pblJvb20nKTtcblxuICAgICAgICBqb2luUm9vbS5jYWxsYmFja0pvaW5Sb29tID0gZnVuY3Rpb24gKG51bWJlcikge1xuICAgICAgICAgICAgLy8gc2VsZi5qb2luTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICAgICAgLy8gc2VsZi5zaG93V2FpdGluZ01lc3NhZ2UoJ+WKoOWFpeS4rS4uLicpO1xuICAgICAgICAgICAgLy8gc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyAgICAgc2VsZi5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xuICAgICAgICAgICAgLy8gfSwgMi4wKTtcblxuICAgICAgICAgICAgLyrliqDlhaXmiL/pl7Tor7fmsYIqL1xuICAgICAgICAgICAgbGV0IHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcbiAgICAgICAgICAgIFNvY2tldC5zZW5kSm9pbkRlc2sobnVtYmVyLCB1c2VySWQpO1xuICAgICAgICB9O1xuICAgIH0sXG5cblxuICAgIF9qaWluUm9vbVNvY2tldENhbGxiYWNrOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYoY2MuaXNSb29tVmlld1Nob3cpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGlkZGVuV2FpdGluZ01lc3NhZ2UoKTtcblxuICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0KSB7XG4gICAgICAgICAgICBpZihjYy5mcm9tID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjYy5mcm9tID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgam9pblJvb20gPSB0aGlzLmpvaW5Ob2RlLmdldENvbXBvbmVudCgnam9pblJvb20nKTtcblxuICAgICAgICAgICAgdGhpcy5qb2luTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jykuc2V0QWxlcnRDYWxsYmNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBqb2luUm9vbS5jbGlja0NsZWFyKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSByZXNwb25zZS5kYXRhLm1hUGFpO1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcmVhc29uSW5mbyA9IHRoaXMuX2pvaW5SZWFzb25NYXAocmVzcG9uc2UuZGF0YS5yZWFzb24pO1xuICAgICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UocmVhc29uSW5mbyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX3NvY2tldFJlY2VpdmVIYWxsSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmKGNjLmlzUm9vbVZpZXdTaG93KXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgaGFsbC5sYXN0SGFsbEluZm8gPSBkYXRhO1xuICAgICAgICBsZXQgaXNJT1MgPSBkYXRhLmlzSU9TO1xuICAgICAgICBsZXQgaXNBbmRyb2lkID0gZGF0YS5pc0E7XG4gICAgICAgIGxldCB2SU9TID0gZGF0YS52SU9TO1xuICAgICAgICBsZXQgdkEgPSBkYXRhLnZBO1xuICAgICAgICB0aGlzLmlvc1VybCA9IGRhdGEuaW9zVXJsO1xuICAgICAgICB0aGlzLmFVcmwgPSBkYXRhLmFVcmw7XG4gICAgICAgIGlmKGNjLnN5cy5pc05hdGl2ZSl7XG4gICAgICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAgICAgIGlmKGlzSU9TID09IDEpe1xuICAgICAgICAgICAgICAgICAgICBpZih2SU9TICE9ICcxLjAuMycgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VuZ3hpbi5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICAgICAgaWYoaXNBbmRyb2lkID09IDEpe1xuICAgICAgICAgICAgICAgICAgICBpZih2QSAhPSAnMS4wLjQnICl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdlbmd4aW4uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxldCBub3RpY2UgPSBkYXRhLmJyb2FkY2FzdDtcbiAgICAgICAgbGV0IGJhbm5lciA9IGRhdGEuaW5mbztcbiAgICAgICAgLy90aGlzLnVwZGF0ZU5vdGljZShub3RpY2UpO1xuICAgICAgICB0aGlzLnVwZGF0ZUJhbm5lcihiYW5uZXIpO1xuICAgIH0sXG4gICAgZG93bmxvYWROZXdWZXJzaW9uOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgIGNjLnN5cy5vcGVuVVJMKHRoaXMuaW9zVXJsKTtcbiAgICAgICAgICAgIC8vIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcImRvd25sb2FkTmV3VmVyc2lvbjpcIiwgdGhpcy5pb3NVcmwpO1xuICAgICAgICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICAgICAgICAgIGNjLnN5cy5vcGVuVVJMKHRoaXMuYVVybCk7XG4gICAgICAgICAgICAvLyBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZG93bmxvYWROZXdWZXJzaW9uXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIHRoaXMuYVVybCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIF9jcmVhdGVSb29tU29ja2V0Q2FsbGJhY2s6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZihjYy5pc1Jvb21WaWV3U2hvdyl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xuXG4gICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgICAgICB9XG4gICAgICAgIC8q5aaC5p6c6ZK755+z5LiN6Laz77yM5YiZ5o+Q56S6Ki9cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZShcIuaCqOeahOmSu+efs+S4jei2s1wiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfam9pblJlYXNvbk1hcDogZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgbGV0IHJlYXNvbkluZm8gPSB7XG4gICAgICAgIG5vdEV4aXN0OiBcIuaIv+mXtOS4jeWtmOWcqCFcIixcbiAgICAgICAgY2FyZE51bWJlcjogXCLmgqjmiL/ljaHkuI3otrMhXCIsXG4gICAgICB9O1xuXG4gICAgICBsZXQgaW5mbyA9IHJlYXNvbkluZm9bcmVhc29uXSB8fCBcIuaIv+mXtOW3sua7oSFcIjtcbiAgICAgIHJldHVybiBpbmZvO1xuICAgIH0sXG5cbiAgICAvKnNob3AqL1xuICAgIHNob3BBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5zaG9wQWxlcnROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG4gICAgLyrmj5DnpLoqL1xuICAgIGFsZXJ0TWVzc2FnZTpmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmFsZXJ0UHJlZmFiKTtcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKG5vZGUpO1xuICAgICAgICB2YXIgY29tcCA9IG5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICAvL3VwZGF0ZU5vdGljZTogZnVuY3Rpb24gKG5vdGljZSkge1xuICAgIC8vICAgIGlmKHRoaXMubGFiZWxOb3RpY2UgPT0gbnVsbCl7XG4gICAgLy8gICAgICAgIHJldHVybjtcbiAgICAvLyAgICB9XG4gICAgLy8gIHRoaXMubGFiZWxOb3RpY2Uuc3RyaW5nID0gbm90aWNlIHx8IFwiXCI7XG4gICAgLy99LFxuXG4gICAgdXBkYXRlQmFubmVyOiBmdW5jdGlvbiAoYmFubmVyID0gXCJcIikge1xuICAgICAgICBpZih0aGlzLmxhYmVsQmFubmVyID09IG51bGwpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB0aGlzLmxhYmVsQmFubmVyLnN0cmluZyA9IGJhbm5lcjtcbiAgICB9LFxuXG5cbiAgICAvKiMjIyMjXG4gICAgKiBzZXR0aW5nMSDlsYDmlbAgICgwIHwgMSB8IDIgKVxuICAgICogc2V0dGluZzIg5Lq65pWwICAoMCB8IDEgfCAyIHwgMylcbiAgICAqIHNldHRpbmczIOeOqeazlSAgKDAgfCAxIHwgMiB8IDMgfCA0KVxuICAgICogc2V0dGluZzQgQUHliLbmlLblj5bmiL/otLkgICgwIHwgMSB8IDIgKVxuICAgICogc2V0dGluZzUg5YW25LuWICAoMClcbiAgICAqIHNldHRpbmc2ICBcbiAgICAqIHNldHRpbmc3XG4gICAgKiAqL1xuICAgIGNyZWF0ZURvbmVBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpbmZvID0ge307XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGtleSA9IFsnc2V0dGluZzEnLCdzZXR0aW5nMicsJ3NldHRpbmc0Jywnc2V0dGluZzUnXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRzU2luZ2xlU2VsZWN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdHNJbmRleCA9IHNlbGYudHNTaW5nbGVTZWxlY3RbaV0uZ2V0Q29tcG9uZW50KCdzaW5nbGVTZWxlY3QnKS5zZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgaW5mb1trZXlbaV1dID0gdHNJbmRleDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaW5mb1snc2V0dGluZzMnXSA9IHRoaXMuc2VsZWN0TW9TaGkuZ2V0Q29tcG9uZW50KCdzZWxlY3RNb1NoaScpLl9zZWxlY3Q7XG4gICAgICAgIGluZm9bJ3NldHRpbmc2J10gPSB0aGlzLm92ZXJUaW1lLmdldENvbXBvbmVudCgnb3ZlclRpbWUnKS5fc2VsZWN0ZWQ7XG4gICAgICAgIGluZm9bJ3NldHRpbmc5J10gPSB0aGlzLmRhaWthaS5nZXRDb21wb25lbnQoJ2RhaWthaScpLl9zZWxlY3RlZDtcbiAgICAgICAgLy9jb25zb2xlLmxvZyggaW5mb1snc2V0dGluZzYnXSApO1xuICAgICAgICBpZiggIWluZm9bJ3NldHRpbmczJ11bM10gKXsgICAvLyDnjqnms5UgW+eWr+eLguWcuizprLzniYws5q+U6Iqx6ImyLOWdkOW6hCzpqazniYxdIGluZm9bJ3NldHRpbmczJ11bM13nrKzkuInpobnooajnpLrlnZDluoTmqKHlvI/vvIzpnZ7lnZDluoTmqKHlvI/nmoTlgI3njofmmK8x5YCNXG4gICAgICAgICAgICBpbmZvWydzZXR0aW5nNSddID0gMDsgICAgIC8vIOWAjeeOhyAoMH4xKSA9PSAoMX4z5YCNKVxuICAgICAgICB9XG4gICAgICAgIGluZm9bJ3NldHRpbmc4J10gPSBudWxsO1xuICAgICBcbiAgICAgICAgaW5mb1snc2V0dGluZzcnXSA9IHRoaXMuc2VsZWN0TW9TaGkuZ2V0Q29tcG9uZW50KCdjaGFuZ2VfbWFwYWknKS5fY2FyZHM7XG4gICAgICAgIGNjLnNldCA9IGluZm87XG4gICAgICAgIGluZm9bJ3VzZXJJZCddID0gdGhpcy5zb2NrZXQudXNlckluZm8uaWQ7ICAgICAgLy/nlKjmiLdJZFxuICAgICAgICB0aGlzLnNvY2tldC5zZW5kTWVzc2FnZSgnY3JlYXRlRGVzaycsaW5mbyk7XG5cbiAgICAgICAgdGhpcy5jcmVhdGVOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG5cbiAgICAgICAgLy9sZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2hvd1dhaXRpbmdNZXNzYWdlKCfliJvlu7rkuK0uLi4nKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLmhpZGRlbldhaXRpbmdNZXNzYWdlKCk7XG4gICAgICAgIH0sIDIuMCk7XG4gICAgfSxcblxuICAgIC8vIOmaj+acuuWculxuICAgIC8qY2xpY2tSYW5kUm9vbTogZnVuY3Rpb24gKCkge1xuICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdyYW5kUm9vbScpO1xuICAgIH0sKi9cblxuICAgIGNsaWNrUmVjb3JkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5yZWNvcmROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgICAgICBTb2NrZXQuc2VuZEdldFJlY3JvZChTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQpO1xuXG4gICAgfSxcblxuICAgIGNsaWNrUGxheVJ1bGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9jYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3J1bGUnKTtcbiAgICAgICAgdGhpcy5oZWxwID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiaGVscFwiKTtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLmhlbHAuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGNsaWNrUGxheTogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZihjYy5jbGlja091dCkgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgfSxcblxuICAgIC8q5YiH5o2i6LSm5Y+3Ki9cbiAgICBjbGlja0NhbmNlbExhdGlvbjpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubG9nb3V0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgbG9nb3V0QWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgLy9tYW5hZ2VyLnNldFVzZXJJbmZvKCcnKTtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdsb2dpbicpO1xuICAgICAgICBoYWxsLmNhY2hlSW1hZ2VJbmZvID0gbnVsbDtcbiAgICB9LFxuXG4gICAgZXhpdEFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgIC8vbWFuYWdlci5zZXRVc2VySW5mbygnJyk7XG4gICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2xvZ2luJyk7XG4gICAgICAgIGhhbGwuY2FjaGVJbWFnZUluZm8gPSBudWxsO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwiZXhpdEFwcFwiKTtcbiAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZCBjb20ubGxpbmcucWlhbmppYW5nbHpnXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZXhpdEFwcFwiLCBcIigpVlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjYy5kaXJlY3Rvci5lbmQoKTtcblxuICAgIH0sXG5cbiAgICAvL+aOpeaUtuWkhOeQhueUqOaIt+aVsOaNrlxuICAgIF9zb2NrZXRSZWNlaXZlVXNlckluZm86ZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgaWYoY2MuaXNSb29tVmlld1Nob3cpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICBpZiAoIXRoaXMuc29ja2V0LnVzZXJJbmZvKSB7XG4gICAgICAgIGNjLmVycm9yKFwidGhpcy5zb2NrZXQudXNlckluZm8g5Li656m6ISEhXCIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvL2NvbnNvbGUubG9nKHJlc3BvbnNlLFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLeeUqOaIt+S/oeaBr1wiKTtcbiAgICAgIC8vdGhpcy5waG9uZS5zdHJpbmcgPSByZXNwb25zZS5kYXRhLnBob25lID8gcmVzcG9uc2UuZGF0YS5waG9uZSA6IFwi5pegXCI7XG4gICAgICB0aGlzLnNldHRpbmcuZ2V0Q29tcG9uZW50KCdTZXR0aW5nJykuX3Bob25lID0gcmVzcG9uc2UuZGF0YS5waG9uZT9yZXNwb25zZS5kYXRhLnBob25lOm51bGw7XG4gICAgICB0aGlzLnNldHRpbmcuZ2V0Q29tcG9uZW50KCdTZXR0aW5nJykucGhvbmUuc3RyaW5nID0gcmVzcG9uc2UuZGF0YS5waG9uZT9yZXNwb25zZS5kYXRhLnBob25lOifml6AnO1xuICAgICAgdGhpcy5uaWNrTmFtZUxhYmVsLnN0cmluZyA9IHJlc3BvbnNlLmRhdGEubmlja25hbWU7ICAgLy8g55So5oi35ZCNXG4gICAgICB0aGlzLnVzZXJJZExhYmVsLnN0cmluZyA9ICdJRDogJyArIHJlc3BvbnNlLmRhdGEuaWQ7ICAvLyBJRFxuICAgICAgdGhpcy5jYXJkTnVtYmVyTGFiZWwuc3RyaW5nID0gcmVzcG9uc2UuZGF0YS5jYXJkTnVtYmVyO1xuICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuYXZhdGFyTm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6cmVzcG9uc2UuZGF0YS5hdmF0YXJVcmwsdHlwZTpcImpwZ1wifSwgZnVuY3Rpb24gKGVyciwgdGV4KSB7XG4gICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKHRleCk7XG4gICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZT1mcmFtZTtcbiAgICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgX3NvY2tldERpc2Nvbm5lY3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNob3dOZXR3b3JrTWVzc2FnZShcIue9kee7nOmTvuaOpeaWreW8gO+8jOmHjeaWsOi/nuaOpeS4rS4uLlwiKTtcbiAgICB9LFxuXG4gICAgX3NvY2tldENvbm5lY3RlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcbiAgICB9LFxuXG4gICAgLy/mm7TmlrDnlKjmiLfkv6Hmga9cbiAgICB1cGRhdGVVc2VySW5mbzpmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGluZm8gPSB0aGlzLnNvY2tldC51c2VySW5mbztcbiAgICAgICAgaWYgKCFpbmZvKSB7XG4gICAgICAgICAgY2MuZXJyb3IoXCJ0aGlzLnNvY2tldC51c2VySW5mbyDkuLrnqbohISFcIik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5uaWNrTmFtZUxhYmVsLnN0cmluZyA9IGluZm8ubmlja25hbWU7XG4gICAgICAgIHRoaXMudXNlcklkTGFiZWwuc3RyaW5nID0gJ0lEOiAnICsgaW5mby5pZDtcbiAgICAgICAgdGhpcy5jYXJkTnVtYmVyTGFiZWwuc3RyaW5nID0gaW5mby5jYXJkTnVtYmVyO1xuXG4gICAgICAgIGxldCBhdmF0YXJVcmwgPSBpbmZvLmF2YXRhclVybCArIFwiLmpwZ1wiO1xuICAgICAgICB2YXIgc3ByaXRlID0gdGhpcy5hdmF0YXJOb2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICB2YXIgdGV4dHVyZSA9IGhhbGwuY2FjaGVJbWFnZUluZm9bYXZhdGFyVXJsXTtcbiAgICAgICAgaWYgKHRleHR1cmUpIHtcbiAgICAgICAgICAgIGxldCBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXh0dXJlKTtcbiAgICAgICAgICAgIGlmIChmcmFtZSkge1xuICAgICAgICAgICAgICAgIC8vY2MubG9nKFwi5LuO57yT5a2Y5Lit5Yqg6L295aS05YOPXCIpO1xuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGZyYW1lO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6aW5mby5hdmF0YXJVcmwsdHlwZTpcImpwZ1wifSwgZnVuY3Rpb24gKGVyciwgdGV4KSB7XG4gICAgICAgICAgICBpZiAoIWVycikge1xuICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZT1mcmFtZTtcblxuICAgICAgICAgICAgICAgIGhhbGwuY2FjaGVJbWFnZUluZm9bYXZhdGFyVXJsXSA9IHRleDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8q5o+Q5Lqk5oSP6KeBKi9cbiAgICBmZWVkYmFja0FjaW9uOmZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB1c2VySWQgPSB0aGlzLnNvY2tldC51c2VySW5mby5pZDtcbiAgICAgIHZhciB0ZXh0ID0gdGhpcy5mZWVkYmFja0VkaXRCb3guc3RyaW5nO1xuICAgICAgaWYgKHRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICB0aGlzLmZlZWRiYWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICBTb2NrZXQuc2VuZEZlZWRiYWNrKHVzZXJJZCx0ZXh0KTtcbiAgICAgICAgdGhpcy5mZWVkYmFja0VkaXRCb3guc3RyaW5nID0gJyc7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHNob3dXYWl0aW5nTWVzc2FnZTpmdW5jdGlvbihtc2cpIHtcbiAgICAgIGlmICh0aGlzLndhaXRpbmdOb2RlICE9IG51bGwgJiYgY2Muc3lzLmlzTmF0aXZlICYmIGNjLnN5cy5pc09iamVjdFZhbGlkKHRoaXMud2FpdGluZ05vZGUpKSB7XG4gICAgICAgICAgdGhpcy53YWl0aW5nTm9kZS5kZXN0b3J5KCk7XG4gICAgICAgICAgdGhpcy53YWl0aW5nTm9kZSA9IG51bGw7XG4gICAgICB9XG4gICAgICB0aGlzLndhaXRpbmdOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcbiAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLndhaXRpbmdOb2RlKTtcbiAgICAgIHZhciBjb21wID0gdGhpcy53YWl0aW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgaGlkZGVuV2FpdGluZ01lc3NhZ2U6ZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy53YWl0aW5nTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgdGhpcy53YWl0aW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvL25ldHdvcmtcbiAgICBzaG93TmV0d29ya01lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICYmIHRoaXMubmV0d29ya05vZGUuYWN0aXZlKSB7XG4gICAgICAgICAgICBsZXQgYWxlcnQgPSB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgICAgIGlmIChhbGVydC5nZXRNZXNzYWdlKCkgPT0gbXNnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHJlbW92ZVNlbGZBY3Rpb24gPSBjYy5yZW1vdmVTZWxmKCk7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5uZXR3b3JrTm9kZSk7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5uZXR3b3JrTm9kZSA9IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGhpZGRlbk5ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy9jaGVja05vZGVcbiAgICBzaG93Q2hlY2tNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgICBpZiAoISh0aGlzLmNoZWNrTm9kZSAmJiB0aGlzLmNoZWNrTm9kZS5hY3RpdmUpKSB7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgYWxlcnQgPSB0aGlzLmNoZWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgICAgICBpZiAoYWxlcnQuZ2V0TWVzc2FnZSgpID09IG1zZykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciByZW1vdmVTZWxmQWN0aW9uID0gY2MucmVtb3ZlU2VsZigpO1xuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUucnVuQWN0aW9uKHJlbW92ZVNlbGZBY3Rpb24pO1xuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hlY2tOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMuY2hlY2tOb2RlKTtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLmNoZWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5jaGVja05vZGUgPSBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICBoaWRkZW5DaGVja01lc3NhZ2U6ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLmNoZWNrTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBvbkJ0bkNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYodGhpcy5fYnV0dG9ucy5hY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbnMuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9ucy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBoYWxsO1xuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8qc3ByaXRlczoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5TcHJpdGVBdGxhc1xyXG4gICAgICAgIH0sKi9cclxuICAgICAgICBwbGF5X21ldGhvZF9iZWZvcmU6Y2MuTm9kZSwgIC8v546p5rOV5LuL57uNXHJcbiAgICAgICAgcGxheV9tZXRob2RfY29udGVudF9sYWJlbDpjYy5Ob2RlLCAgLy/njqnms5Xku4vnu43lhoXlrrlcclxuICAgICAgICBpbnRyb2R1Y2VfcGFpX2JlZm9yZTpjYy5Ob2RlLC8v54mM5Z6L5LuL57uNXHJcbiAgICAgICAgZGV0YWlsczpjYy5Ob2RlLCAgIC8v54mM5Z6L5LuL57uN5YaF5a65XHJcbiAgICAgICAgY2FvenVvX2JlZm9yZTpjYy5Ob2RlLCAgICAgLy/mk43kvZzku4vnu41cclxuICAgICAgICBjYW96dW9fY29udGVudDpjYy5Ob2RlLCAgLy/mk43kvZzku4vnu43lhoXlrrlcclxuICAgICAgICBfYnRuOm51bGwsXHJcbiAgICAgICAgX2NvbnRlbnQ6bnVsbCxcclxuICAgICAgICBfYnV0dG9uQ29tOm51bGwsXHJcbiAgICAgICAgX3BsYXlfbWV0aG9kX2J1dHRvbjpudWxsLFxyXG4gICAgICAgIF9pbnRyb2R1Y2VfcGFpX2J1dHRvbjpudWxsLFxyXG4gICAgICAgIF9jYW96dW9fYnV0dG9uOm51bGxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL3RoaXMuX3BsYXlfbWV0aG9kX2J1dHRvbiA9IHRoaXMucGxheV9tZXRob2RfYmVmb3JlLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xyXG4gICAgICAgIC8vdGhpcy5faW50cm9kdWNlX3BhaV9idXR0b24gPSB0aGlzLmludHJvZHVjZV9wYWlfYmVmb3JlLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xyXG4gICAgICAgIC8vdGhpcy5fY2FvenVvX2J1dHRvbiA9IHRoaXMuY2FvenVvX2JlZm9yZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICAvL3RoaXMuX2J0biA9IFt0aGlzLnBsYXlfbWV0aG9kX2JlZm9yZSx0aGlzLmludHJvZHVjZV9wYWlfYmVmb3JlLHRoaXMuY2FvenVvX2JlZm9yZV07XHJcbiAgICAgICAgLy90aGlzLl9jb250ZW50ID0gW3RoaXMucGxheV9tZXRob2RfY29udGVudF9sYWJlbCx0aGlzLmRldGFpbHMsdGhpcy5jYW96dW9fY29udGVudF07XHJcbiAgICAgICAgLy90aGlzLl9idXR0b25Db20gPSBbdGhpcy5fcGxheV9tZXRob2RfYnV0dG9uLHRoaXMuX2ludHJvZHVjZV9wYWlfYnV0dG9uLHRoaXMuX2Nhb3p1b19idXR0b25dO1xyXG4gICAgICAgIC8vLy/liJrlvIDlp4vniYzlnovku4vnu43nmoTmjInpkq7kuI3lj6/nlKhcclxuICAgICAgICAvL3RoaXMuX2J1dHRvbkNvbVsxXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICAvLyDngrnlh7vnjqnms5Xku4vnu41cclxuICAgIG9uQnRuUGxheU1ldGhvZENsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL2Zvcih2YXIgaT0wO2k8MztpKyspe1xyXG4gICAgICAgIC8vICAgIC8v5omA5pyJ5oyJ6ZKu6K6+572u5Li65Y+v55SoXHJcbiAgICAgICAgLy8gICAgdGhpcy5fYnV0dG9uQ29tW2ldLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgLy/miYDmnInnmoTlhoXlrrnpg73pmpDol4/mjolcclxuICAgICAgICAvLyAgICB0aGlzLl9jb250ZW50W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLy/lvZPliY3ngrnlh7vnmoTorr7nva7kuLrkuI3lj6/nlKhcclxuICAgICAgICAvL3RoaXMuX2J1dHRvbkNvbVswXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAvLy8v5b2T5YmN54K55Ye755qE5a+55bqU55qE5YaF5a655Y+v6KeBXHJcbiAgICAgICAgdGhpcy5fY29udGVudFswXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIC8v54K55Ye754mM5Z6L5LuL57uNXHJcbiAgICBvbkJ0bkludHJvZHVjZVBhaUNsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL2Zvcih2YXIgaT0wO2k8MztpKyspe1xyXG4gICAgICAgIC8vICAgIC8v5omA5pyJ5oyJ6ZKu6K6+572u5Li65Y+v55SoXHJcbiAgICAgICAgLy8gICAgdGhpcy5fYnV0dG9uQ29tW2ldLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgLy/miYDmnInnmoTlhoXlrrnpg73pmpDol4/mjolcclxuICAgICAgICAvLyAgICB0aGlzLl9jb250ZW50W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLy/lvZPliY3ngrnlh7vnmoTorr7nva7kuLrkuI3lj6/nlKhcclxuICAgICAgICAvL3RoaXMuX2J1dHRvbkNvbVsxXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAvLy8v5b2T5YmN54K55Ye755qE5a+55bqU55qE5YaF5a655Y+v6KeBXHJcbiAgICAgICAgLy90aGlzLl9jb250ZW50WzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgLy/ngrnlh7vmk43kvZzku4vnu41cclxuICAgIG9uQnRuQ2FvenVvQ2xpY2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vZm9yKHZhciBpPTA7aTwzO2krKyl7XHJcbiAgICAgICAgLy8gICAgLy/miYDmnInmjInpkq7orr7nva7kuLrlj6/nlKhcclxuICAgICAgICAvLyAgICB0aGlzLl9idXR0b25Db21baV0uaW50ZXJhY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICAvL+aJgOacieeahOWGheWuuemDvemakOiXj+aOiVxyXG4gICAgICAgIC8vICAgIHRoaXMuX2NvbnRlbnRbaV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vL+W9k+WJjeeCueWHu+eahOiuvue9ruS4uuS4jeWPr+eUqFxyXG4gICAgICAgIC8vdGhpcy5fYnV0dG9uQ29tWzJdLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vLy/lvZPliY3ngrnlh7vnmoTlr7nlupTnmoTlhoXlrrnlj6/op4FcclxuICAgICAgICAvL3RoaXMuX2NvbnRlbnRbMl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCIvKipcclxuICog6YKA6K+356CBXHJcbiAqIEBhdXRob3JzIOm7hOaIkCh5b3VAZXhhbXBsZS5vcmcpXHJcbiAqIEBkYXRlICAgIDIwMTctMDYtMTYgMDk6NDQ6MTBcclxuICogQHZlcnNpb24gJElkJFxyXG4gKi9cclxuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbGFiZWxOdW1iZXJzOiBbY2MuTGFiZWxdLFxyXG4gICAgICAgIGNhbGxiYWNrSW52aXRlQ29kZTogJycsXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNsaWNrQ2xlYXIoKTsgLy/muIXpmaTmlbDlrZdcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tDbGVhcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmxhYmVsTnVtYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xyXG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja051bWJlcjogZnVuY3Rpb24gKGV2ZW50LCBudW1iZXIpIHtcclxuICAgICAgdmFyIGxhYmVsID0gdGhpcy5fbGFzdEVtcHR5TGFiZWwoKTtcclxuICAgICAgaWYgKGxhYmVsKSB7XHJcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gbnVtYmVyO1xyXG4gICAgICAgXHQvL2NjLmxvZyhsYWJlbC5zdHJpbmcgLFwiLS0tLS0tLS0tLS0tLS0tLVwiKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgbGV0IGlzQ29tcGxldGUgPSAodGhpcy5fbGFzdEVtcHR5TGFiZWwoKSA9PSBudWxsKTtcclxuICAgICAgLy9jYy5sb2coXCJpc0NvbXBsZXRlLS0tLS0tLS0tLS0tLVwiLCB0aGlzLmNhbGxiYWNrSW52aXRlQ29kZSk7XHJcbiAgICAgIGxldCBpbnZpdGVOdW1iZXIgPSB0aGlzLl9pbnZpdGVOdW1iZXIoKTtcclxuXHJcbiAgICAgIGlmICggaW52aXRlTnVtYmVyLmxlbmd0aCA9PSA2ICl7XHJcbiAgICAgICAgLy9jYy5sb2coaW52aXRlTnVtYmVyLFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0zOFwiKTsgLy/pgoDor7fnoIFcclxuICAgICAgICBsZXQgdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIC8vU29ja2V0LnNlbmRJbnZpdGVDb2RlKGludml0ZU51bWJlciwgdXNlcklkKTtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrSW52aXRlQ29kZSA9IGludml0ZU51bWJlcjtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNlbmRDb2RlIDpmdW5jdGlvbigpeyAgLy/lj5HpgIHpgoDor7fnoIFcclxuICAgICAgbGV0IHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcclxuICAgICAgbGV0IGludml0ZU51bWJlciA9IHRoaXMuY2FsbGJhY2tJbnZpdGVDb2RlO1xyXG4gICAgICAvL2NjLmxvZyhpbnZpdGVOdW1iZXIsXCItLS0tLS0tLS0tLS0tLS0tLS0tLTM4XCIpXHJcbiAgICAgIGlmKCBpbnZpdGVOdW1iZXIgJiYgaW52aXRlTnVtYmVyLmxlbmd0aD09Nil7ICBcclxuICAgICAgICBTb2NrZXQuc2VuZEludml0ZUNvZGUoaW52aXRlTnVtYmVyLCB1c2VySWQpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tJbnZpdGVDb2RlID0gJyc7ICAgLy/muIXnqbrpgoDor7fnoIFcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsaWNrRGVsZXRlT25lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBsYWJlbCA9IHRoaXMuX2xhc3ROdW1iZXJMYWJlbCgpO1xyXG4gICAgICBpZiAobGFiZWwpIHtcclxuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9sYXN0RW1wdHlMYWJlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBmb3IgKHZhciBpbmRleCBpbiB0aGlzLmxhYmVsTnVtYmVycykge1xyXG4gICAgICAgIHZhciBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcclxuICAgICAgICBpZiAobGFiZWwuc3RyaW5nID09IG51bGxcclxuICAgICAgICB8fCBsYWJlbC5zdHJpbmcubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgIHJldHVybiBsYWJlbDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9sYXN0TnVtYmVyTGFiZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgZm9yICh2YXIgaW5kZXggPSB0aGlzLmxhYmVsTnVtYmVycy5sZW5ndGggLSAxOyBpbmRleCA+PSAwOyAtLWluZGV4KSB7XHJcbiAgICAgICAgbGV0IGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xyXG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgJiYgbGFiZWwuc3RyaW5nLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIHJldHVybiBsYWJlbDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaW52aXRlTnVtYmVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmxhYmVsTnVtYmVycy5yZWR1Y2UoZnVuY3Rpb24gKGludml0ZU51bWJlciwgbGFiZWwpIHtcclxuICAgICAgICAvL2NjLmxvZyhpbnZpdGVOdW1iZXIsXCItLS0tLS0tLS0tLS0tLS0tLVwiKTtcclxuICAgICAgICByZXR1cm4gaW52aXRlTnVtYmVyICsgKGxhYmVsLnN0cmluZyB8fCBcIlwiKTtcclxuICAgICAgfSwgXCJcIik7XHJcbiAgICB9LFxyXG59KSIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGxhYmVsTnVtYmVyczogW2NjLkxhYmVsXSxcbiAgICAgICAgY2FsbGJhY2tKb2luUm9vbTogbnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNsaWNrQ2xlYXIoKTtcbiAgICB9LFxuXG4gICAgY2xpY2tOdW1iZXI6IGZ1bmN0aW9uIChldmVudCwgbnVtYmVyKSB7XG4gICAgICB2YXIgbGFiZWwgPSB0aGlzLl9sYXN0RW1wdHlMYWJlbCgpO1xuICAgICAgaWYgKGxhYmVsKSB7XG4gICAgICAgIGxhYmVsLnN0cmluZyA9IG51bWJlcjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IGlzQ29tcGxldGUgPSAodGhpcy5fbGFzdEVtcHR5TGFiZWwoKSA9PSBudWxsKTtcbiAgICAgIGlmIChpc0NvbXBsZXRlICYmIHRoaXMuY2FsbGJhY2tKb2luUm9vbSkge1xuICAgICAgICBsZXQgcm9vbU51bWJlciA9IHRoaXMuX3Jvb21OdW1iZXIoKTtcbiAgICAgICAgLy8gY2MubG9nKFwi6KaB5Yqg5YWl55qE5oi/6Ze05Y+35piv77yaXCIsIHJvb21OdW1iZXIpO1xuICAgICAgICB0aGlzLmNhbGxiYWNrSm9pblJvb20ocm9vbU51bWJlcik7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGNsaWNrQ2xlYXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubGFiZWxOdW1iZXJzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7XG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgY2xpY2tEZWxldGVPbmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBsYWJlbCA9IHRoaXMuX2xhc3ROdW1iZXJMYWJlbCgpO1xuICAgICAgaWYgKGxhYmVsKSB7XG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XG4gICAgICB9XG4gICAgfSxcblxuICAgIF9sYXN0RW1wdHlMYWJlbDogZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgaW5kZXggaW4gdGhpcy5sYWJlbE51bWJlcnMpIHtcbiAgICAgICAgdmFyIGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xuICAgICAgICBpZiAobGFiZWwuc3RyaW5nID09IG51bGxcbiAgICAgICAgfHwgbGFiZWwuc3RyaW5nLmxlbmd0aCA8PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX2xhc3ROdW1iZXJMYWJlbDogZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgaW5kZXggPSB0aGlzLmxhYmVsTnVtYmVycy5sZW5ndGggLSAxOyBpbmRleCA+PSAwOyAtLWluZGV4KSB7XG4gICAgICAgIGxldCBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyAmJiBsYWJlbC5zdHJpbmcubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX3Jvb21OdW1iZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLmxhYmVsTnVtYmVycy5yZWR1Y2UoZnVuY3Rpb24gKHJvb21OdW1iZXIsIGxhYmVsKSB7XG4gICAgICAgIHJldHVybiByb29tTnVtYmVyICsgKGxhYmVsLnN0cmluZyB8fCBcIlwiKTtcbiAgICAgIH0sIFwiXCIpO1xuICAgIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdsb2dpbicpO1xuICAgICAgICB9LCAwLjUpO1xuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcbmNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uJyk7XG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5jb25zdCBLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyID0gcmVxdWlyZSgnS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlcicpO1xuXG52YXIgQVBQSUQgPSAnd3hlODk5M2Y0NjhiMTZmYTVkJztcbnZhciBST09NSUQgPSAnJztcbi8v5o6I5p2D5Zyw5Z2AXG4vL+ato+W8j+WcsOWdgFxuLy8gdmFyIFJFRElSRUNUX1VSSSA9IFwiaHR0cCUzQSUyRiUyRnd3dy5ob25nZ2VmZW5nLmNuJTJGc3N6V2ViJTJGaW5kZXgucGhwXCI7XG4vLyDmtYvor5XlnLDlnYBcbnZhciBSRURJUkVDVF9VUkkgPSBcImh0dHAlM2ElMmYlMmZvMW8yLmNuXCI7XG5cbmxldCBIUkVGID0gXCJodHRwczovL29wZW4ud2VpeGluLnFxLmNvbS9jb25uZWN0L29hdXRoMi9hdXRob3JpemU/YXBwaWQ9XCIrQVBQSUQrXCImcmVkaXJlY3RfdXJpPVwiK1JFRElSRUNUX1VSSStcIiZyZXNwb25zZV90eXBlPWNvZGUmc2NvcGU9c25zYXBpX3VzZXJpbmZvJnN0YXRlPVNUQVRFI3dlY2hhdF9yZWRpcmVjdFwiO1xuXG5cbmNjLkNsYXNzKHtcblxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vc2VsZWN0Tm9kZTpjYy5Ob2RlLFxuICAgICAgICBhbGVydFByZWZhYjpjYy5QcmVmYWIsXG4gICAgICAgIGNhbnZhc05vZGU6Y2MuTm9kZSxcbiAgICAgICAgbG9hZGluZ05vZGU6Y2MuTm9kZSxcbiAgICAgICAgLy9lcnI6Y2MuTm9kZSxcbiAgICAgICAgd2FpdGluZ1ByZWZhYjpjYy5QcmVmYWIsXG4gICAgICAgIHJlY29yZEluZm86Y2MuUHJlZmFiLFxuICAgICAgICBsYWJlbDpjYy5MYWJlbCxcbiAgICB9LFxuXG4gICAgZ29VcGRhdGVBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiQXBwQ29udHJvbGxlclwiLFwiZG93bmxvYWROZXdWZXJzaW9uOlwiLHRoaXMuaW9zVXJsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHsvL0FuZHJvaWRcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoXCJjb20vZ29uZ3BhL3Nzei9BcHBBY3Rpdml0eVwiLCBcImRvd25sb2FkTmV3VmVyc2lvblwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCB0aGlzLmFuZHJvaWRVcmwpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNoZWNrVmVyc2lvbjpmdW5jdGlvbih2RGF0YSkge1xuICAgICAgICAvL3ZhciB2ZXJzaW9uID0gdkRhdGEudmVyc2lvbjtcbiAgICAgICAgY2MuaW5mbzEgPSB2RGF0YS52ZXJzaW9uO1xuICAgICAgICB0aGlzLmlvc1VybCA9IHZEYXRhLmlvc1VybDtcbiAgICAgICAgdGhpcy5hbmRyb2lkVXJsID0gdkRhdGEuYW5kcm9pZFVybDtcbiAgICAgICAgLy9pZiAobWFuYWdlci52ZXJzaW9uICE9IHZlcnNpb24pIHsvL+abtOaWsOeJiOacrFxuICAgICAgICAvLyAgICB0aGlzLnZlcnNpb25FbmFibGUgPSBmYWxzZTtcbiAgICAgICAgLy8gICAgdGhpcy5nb1VwZGF0ZUFjdGlvbigpO1xuICAgICAgICAvLyAgICAvL3RoaXMudmVyc2lvbkxhYmVsLnN0cmluZyA9ICfor7fliLDmnI3liqHlmajmm7TmlrDliLDmnIDmlrDniYjmnKwnO1xuICAgICAgICAvL31cbiAgICAgICAgLy9lbHNlIHtcbiAgICAgICAgICAgIC8vdGhpcy52ZXJzaW9uTGFiZWwuc3RyaW5nID0gJ+W9k+WJjeeJiOacrCAnICsgbWFuYWdlci52ZXJzaW9uO1xuICAgICAgICAgICAgaWYoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAgICAgIC8vIGlmKGlvc1ZlcnNpb24gIT0gbWFuYWdlci52ZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIHRoaXMudmVyc2lvbkVuYWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vICAgICB2YXIgdXBkYXRlQWxlcnQgPSBjYy5maW5kKFwiQ2FudmFzL3VwZGF0ZVwiKS5nZXRDb21wb25lbnQoXCJhbGVydFwiKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgdXBkYXRlQWxlcnQuYWxlcnQoKTtcbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgLy8gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmVyc2lvbkVuYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2luRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9naW5FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9naW5BY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwwLjUpO1xuICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkge1xuICAgICAgICAgICAgICAgIC8vIGlmKGFuZHJvaWRWZXJzaW9uICE9IG1hbmFnZXIudmVyc2lvbikge1xuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLnZlcnNpb25FbmFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvLyAgICAgdmFyIHVwZGF0ZUFsZXJ0ID0gY2MuZmluZChcIkNhbnZhcy91cGRhdGVcIikuZ2V0Q29tcG9uZW50KFwiYWxlcnRcIik7XG4gICAgICAgICAgICAgICAgLy8gICAgIHVwZGF0ZUFsZXJ0LmFsZXJ0KCk7XG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIC8vIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZlcnNpb25FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2luRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2luQWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sMC41KTtcbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgIHRoaXMudmVyc2lvbkVuYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgLy8gdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XG4gICAgICAgICAgICAgIC8vIGlmIChpbmZvLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgIC8vICAgICB0aGlzLmxvZ2luRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY29yZElkID0gc2VsZi5nZXRRdWVyeVN0cmluZygncmVjb3JkSWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICBpZihyZWNvcmRJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBTb2NrZXQuc2VuZEdldFJlY3JvZEZyb21JZChyZWNvcmRJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIHZhciByb29tSWQgPSBzZWxmLmdldFF1ZXJ5U3RyaW5nKFwicm9vbUlkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgIGlmKHJvb21JZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFkYXRhLmVycmNvZGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZW5kTG9naW5SZXF1ZXN0KGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyhcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9nZXRfSFJFRihyb29tSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XG4gICAgICAgICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSl7XG4gICAgICAgICAgICAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyhcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZighZGF0YSB8fCBkYXRhLmVycmNvZGUpe1xuICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oXCJcIik7XG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9naW5FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9naW5BY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29kZSA9IHNlbGYuZ2V0UXVlcnlTdHJpbmcoXCJjb2RlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJvb21JZCA9IHNlbGYuZ2V0UXVlcnlTdHJpbmcoXCJyb29tSWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggcm9vbUlkICl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWRhdGEuZXJyY29kZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VuZExvZ2luUmVxdWVzdChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZ2V0X0hSRUYocm9vbUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggY29kZSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOyAgLy8gWE1MSHR0cFJlcXVlc3Tlr7nosaHnlKjkuo7lnKjlkI7lj7DkuI7mnI3liqHlmajkuqTmjaLmlbDmja5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IFwiLi9nZXRfdG9rZW4ucGhwXCI7ICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoub3BlbihcIlBPU1RcIiwgdXJsLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LXR5cGVcIiwgXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIik7ICAvLyDmt7vliqBodHRw5aS077yM5Y+R6YCB5L+h5oGv6Iez5pyN5Yqh5Zmo5pe25YaF5a6557yW56CB57G75Z6LXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqLnJlYWR5U3RhdGUgPT0gNCAmJiAob2JqLnN0YXR1cyA9PSAyMDAgfHwgb2JqLnN0YXR1cyA9PSAzMDQpKSB7ICAvLyAzMDTmnKrkv67mlLlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChvYmoucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKCBvYmoucmVzcG9uc2VUZXh0ICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFkYXRhLmVycmNvZGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyggb2JqLnJlc3BvbnNlVGV4dCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZW5kTG9naW5SZXF1ZXN0KCBkYXRhICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5zZW5kKFwiY29kZT1cIitjb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Y2F0Y2goZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0sMC41KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgLy99XG4gICAgfSxcbiAgICBrZXlCYWNrTGlzdGVuOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgY2Muc3lzdGVtRXZlbnQub24oY2MuU3lzdGVtRXZlbnQuRXZlbnRUeXBlLktFWV9ET1dOLGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGlmKGUua2V5Q29kZSA9PSBjYy5LRVkuYmFjaykge1xuICAgICAgICAgICAgICAgIGlmKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKXtcbiAgICAgICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImJhY2tUb0Rlc2tcIiwgXCIoKVZcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LHRoaXMpO1xuICAgIH0sXG4gICAgLy/pmo/mnLrnlJ/miJAgbnVtIOS9jSDnmoTpmo/mnLrmlbAg5ZCr5aSn5bCP5YaZ5a2X5q+N5Y+K5pWw5a2XXG4gICAgZ2V0UmFuZG9tQWNjb3VudDpmdW5jdGlvbihudW0pXG4gICAge1xuICAgICAgICAvKipcbiAgICAgICAgICog6L+U5Zue5LiA5Liq5a2X5q+NXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRDaGFyYWN0ZXIoZmxhZyl7XG4gICAgICAgICAgICB2YXIgY2hhcmFjdGVyID0gXCJcIjtcbiAgICAgICAgICAgIGlmKGZsYWcgPT09IFwibG93ZXJcIil7XG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyID0gU3RyaW5nLmZyb21DaGFyQ29kZShNYXRoLmZsb29yKCBNYXRoLnJhbmRvbSgpICogMjYpICsgXCJhXCIuY2hhckNvZGVBdCgwKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihmbGFnID09PSBcInVwcGVyXCIpe1xuICAgICAgICAgICAgICAgIGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoTWF0aC5mbG9vciggTWF0aC5yYW5kb20oKSAqIDI2KSArIFwiQVwiLmNoYXJDb2RlQXQoMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNoYXJhY3RlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzdHIgPSBcIlwiO1xuICAgICAgICBmb3IodmFyIGk9MDtpPG51bTtpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBmbGFnID0gXCJsb3dlclwiIDtcbiAgICAgICAgICAgIHZhciByYW5kb20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKTtcbiAgICAgICAgICAgIGlmKHJhbmRvbSA9PSAwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZsYWcgPSBcInVwcGVyXCIgO1xuICAgICAgICAgICAgICAgIHN0ciArPSBnZXRDaGFyYWN0ZXIoZmxhZyk7XG4gICAgICAgICAgICB9ZWxzZSBpZihyYW5kb20gPT0gMSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdHIgKz0gZ2V0Q2hhcmFjdGVyKGZsYWcpO1xuICAgICAgICAgICAgfWVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdHIgKz0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfSxcbiAgICBnZXRHdWVzdFVzZXJJbmZvOmZ1bmN0aW9uKCl7XG4gICAgICAgIGxldCBzZWFyY2ggPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoO1xuICAgICAgICB2YXIgb3BlbmlkID0gXCJndWVzdF9cIiArIHRoaXMuZ2V0UmFuZG9tQWNjb3VudCg4KTtcbiAgICAgICAgdmFyIHVuaW9uaWQgPSAnZ3Vlc3RfJyArIHRoaXMuZ2V0UmFuZG9tQWNjb3VudCg4KTtcbiAgICAgICAgdmFyIG5pY2tuYW1lID0gdGhpcy5nZXRSYW5kb21BY2NvdW50KDgpO1xuICAgICAgICB2YXIgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwiJytuaWNrbmFtZSsnXCIsXCJ1bmlvbmlkXCI6XCInK3VuaW9uaWQrJ1wiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC84RDhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2VFQ1QUZNNHphcUtFdGhaaWJ2OHhkV2tnak45WWI0QVFud3ZTdXJ6MjdVQjI5eHg4MVhPUnd4NTVYYW54cWN0ZERcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xuICAgICAgICByZXR1cm4gdGVzdERhdGE7XG4gICAgfSxcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5rZXlCYWNrTGlzdGVuKCk7XG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUgJiYgY2Muc3lzLmlzTW9iaWxlKXtcbiAgICAgICAgICAgIHZhciBjYW52YXMgPSBjYy5maW5kKFwiQ2FudmFzXCIpO1xuICAgICAgICAgICAgdmFyIGN2cyA9IGNhbnZhcy5nZXRDb21wb25lbnQoY2MuQ2FudmFzKTtcbiAgICAgICAgfVxuICAgICAgICBLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyLnN0YXJ0KCk7XG4gICAgICAgIHRoaXMuc29ja2V0ID0gY2MuZmluZCgnR2FtZVNvY2tldCcpLmdldENvbXBvbmVudCgnc29ja2V0Jyk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNvY2tldC5yZWNldmljZU1lc3NhZ2UgPSBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YSlcbiAgICAgICAgICAgIGlmIChkYXRhLmFjdGlvbiA9PSAnY2hlY2tWZXJzaW9uJykge1xuICAgICAgICAgICAgICB0cnl7XG4gICAgICAgICAgICAgICAgc2VsZi5jaGVja1ZlcnNpb24oZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgfWNhdGNoKGUpe1xuICAgICAgICAgICAgICAgIC8vdGhpcy5lcnIuc3RyaW5nID0gZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZGF0YS5hY3Rpb24gPT0gJ2xvZ2luJykge1xuICAgICAgICAgICAgICAgaWYgKGRhdGEucmVzdWx0KSB7Ly/miJDlip9cbiAgICAgICAgICAgICAgICAgICBzZWxmLnNvY2tldC51c2VySW5mbyA9IGRhdGEuZGF0YTsvL+i/kOihjOaXtuaAgeS/oeaBr1xuICAgICAgICAgICAgICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgICAgICAgICAgIHZhciByb29tSWQgPSBzZWxmLmdldFF1ZXJ5U3RyaW5nKFwicm9vbUlkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocm9vbUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICBpZihyb29tSWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEuZGF0YS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleGl0SW5Sb29tID0gZGF0YS5kYXRhLnJvb21JZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGV4aXRJblJvb20gIT0gXCJcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJvb21JZCA9IGV4aXRJblJvb207XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBTb2NrZXQuc2VuZExvZ2luSm9pbihyb29tSWQsIHVzZXJJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2xvYWRpbmdMYWJlbChcIueZu+W9leS4rVwiKTtcbiAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhLnJvb21JZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3BsYXknKTtcbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIC8vIHNlbGYuYWxlcnRNZXNzYWdlKCfnmbvlvZXlpLHotKUhJyk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJTb2NrZXRFdmVudCgpO1xuXG4gICAgICAgIHRoaXMuc29ja2V0LmdldFd4SW5mbyA9IGZ1bmN0aW9uKGluZm8pIHtcbiAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyhpbmZvKTsvL+S/neWtmOacrOWcsFxuICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoaW5mbyk7Ly9zdHIgLT4ganNvbihvYmopXG4gICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7Ly/lu7bov5/miafooYwgMXNcbiAgICAgICAgICAgICAgIHNlbGYuc2VuZExvZ2luUmVxdWVzdChkYXRhKTsvL+eZu+W9leivt+axglxuICAgICAgICAgICB9LDEpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmdldE9ubHlVc2VySW5mb0J5QnJvd3NlcigpO1xuICAgICAgICAvL2NjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInVzZXJpbmZvXCIpO1xuICAgICAgICAvLyBsZXQgc2VhcmNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcbiAgICAgICAgLy8gdmFyIG9wZW5pZCA9IFwiSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TU16b3dPQ2M9XCI7XG4gICAgICAgIC8vIHZhciB1bmlvbmlkID0gJzhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2JztcbiAgICAgICAgLy8gdmFyIG5pY2tuYW1lID0gXCLlk4flk4jlk4hcIjtcblxuXG4gICAgICAgIC8vdmFyIG9wZW5pZCA9IFwiSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TU16b3dPQ2M9XCI7XG4gICAgICAgIC8vdmFyIG9wZW5pZCA9IFwiZ3Vlc3RfXCIgKyB0aGlzLmdldFJhbmRvbUFjY291bnQoOCk7XG4gICAgICAgIC8vdmFyIHVuaW9uaWQgPSAnOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHYnO1xuICAgICAgICAvL3ZhciB1bmlvbmlkID0gJ2d1ZXN0XycgKyB0aGlzLmdldFJhbmRvbUFjY291bnQoOCk7XG4gICAgICAgIC8vdmFyIG5pY2tuYW1lID0gdGhpcy5nZXRSYW5kb21BY2NvdW50KDgpO1xuXG5cbiAgICAgICAgIC8vaWYgKHNlYXJjaCkge1xuICAgICAgICAgLy8gICAgdmFyIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG4gICAgICAgICAvLyAgICB2YXIgbG9jID0gdXJsLnN1YnN0cmluZyh1cmwubGFzdEluZGV4T2YoJz0nKSArIDEsIHVybC5sZW5ndGgpO1xuICAgICAgICAgLy8gICAgaWYgKGxvYyA9PSAxKSB7XG4gICAgICAgICAvLyAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvMU9TYz0nO1xuICAgICAgICAgLy8gICAgICAgIHVuaW9uaWQgPSAnSnpJd01UY3ROaTB4TmlBd09UbzBOVG8xT1NjJztcbiAgICAgICAgIC8vICAgICAgICBuaWNrbmFtZSA9IGxvYztcbiAgICAgICAgIC8vICAgIH1cbiAgICAgICAgIC8vICAgIGVsc2UgaWYgKGxvYyA9PSAyKSB7XG4gICAgICAgICAvLyAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN2Tmk4eE5pRGt1SXJsallnNU9qTTRPak16Snc9PSc7XG4gICAgICAgICAvLyAgICAgICAgdW5pb25pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZzVPak00T2pNekp3JztcbiAgICAgICAgIC8vICAgICAgICBuaWNrbmFtZSA9IGxvYztcbiAgICAgICAgIC8vICAgIH1cbiAgICAgICAgIC8vICAgIGVsc2UgaWYgKGxvYyA9PSAzKSB7XG4gICAgICAgICAvLyAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvYz0nO1xuICAgICAgICAgLy8gICAgICAgIHVuaW9uaWQgPSAnOGRPdEFjRGljNVNpY2h2M2x4dE1YWW11blRMT0x2JztcbiAgICAgICAgIC8vICAgICAgICBuaWNrbmFtZSA9IGxvYztcbiAgICAgICAgIC8vICAgIH1cbiAgICAgICAgIC8vICAgIGVsc2UgaWYgKGxvYyA9PSA0KSB7XG4gICAgICAgICAvLyAgICAgICAgb3BlbmlkID0gJ296bFhJd2d2X1FKVDB5a2RVaWhhQUJtc1dwMkEnO1xuICAgICAgICAgLy8gICAgICAgIHVuaW9uaWQgPSAnby0zOTExcVdzUXNXM3dVb2RxRmZVdGJzQWVOayc7XG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XG4gICAgICAgICAvLyAgICB9XG4gICAgICAgICAvLyAgICBlbHNlIGlmIChsb2MgPT0gNSkge1xuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZ3hNRG93TXpvd09DYz0nO1xuICAgICAgICAgLy8gICAgICAgICB1bmlvbmlkID0gJ28tSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TURvd00nO1xuICAgICAgICAgLy8gICAgICAgIG5pY2tuYW1lID0gbG9jO1xuICAgICAgICAgLy8gICAgfWVsc2UgaWYobG9jID09IDYpe1xuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZ3hNTXpvYz0nO1xuICAgICAgICAgLy8gICAgICAgICB1bmlvbmlkID0gJ28tekl3TVRjdk5pOHhOaURrdUlybCc7XG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XG4gICAgICAgICAvLyAgICB9XG4gICAgICAgICAvL1xuICAgICAgICAgLy99XG4gICAgICAgIC8vIHZhciB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCInK25pY2tuYW1lKydcIixcInVuaW9uaWRcIjpcIicrdW5pb25pZCsnXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG5cblxuICAgICAgICAgLy9pZiAoIWNjLnN5cy5pc05hdGl2ZSl7XG4gICAgICAgICAvLyAgICB2YXIgaW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcbiAgICAgICAgIC8vICAgIGlmIChpbmZvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgIC8vICAgICAgICAvL3RoaXMuc2hvd1dhaXRpbmdNZXNzYWdlKCflt7LlrZjmnInotKblj7c9PT09PScpO1xuICAgICAgICAgLy8gICAgICAgIC8vcmV0dXJuO1xuICAgICAgICAgLy8gICAgfWVsc2VcbiAgICAgICAgIC8vICAgIHtcbiAgICAgICAgIC8vICAgICAgICAvL3RoaXMuc2hvd1dhaXRpbmdNZXNzYWdlKCfmlrDotKblj7c9PT09PScpO1xuICAgICAgICAgLy8gICAgICAgIHZhciB1c2VySW5mbyA9IHRoaXMuZ2V0R3Vlc3RVc2VySW5mbygpO1xuICAgICAgICAgLy8gICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8odXNlckluZm8pO1xuICAgICAgICAgLy8gICAgfVxuICAgICAgICAgLy99XG4gICAgfSxcblxuICAgIGdldE9ubHlVc2VySW5mb0J5QnJvd3NlcjpmdW5jdGlvbigpXG4gICAge1xuICAgICAgICB2YXIgb3BlbmlkID0gXCJcIjtcbiAgICAgICAgdmFyIHVuaW9uaWQgPSBcIlwiO1xuICAgICAgICB2YXIgbmlja25hbWUgPSBcIlwiO1xuXG4gICAgICAgIHZhciB0ZXN0RGF0YSA9IFwiXCI7XG4gICAgICAgIHZhciB1c2VySW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcblxuICAgICAgICBsZXQgc2VhcmNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcbiAgICAgICAgaWYodXNlckluZm8ubGVuZ3RoID4gMClcbiAgICAgICAge1xuICAgICAgICAgICAgb3BlbmlkID0gdXNlckluZm8ub3BlbklkO1xuICAgICAgICAgICAgdW5pb25pZCA9IHVzZXJJbmZvLnVuaW9uaWQ7XG4gICAgICAgICAgICBuaWNrbmFtZSA9IHVzZXJJbmZvLm5pY2tuYW1lO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNlYXJjaCkge1xuICAgICAgICAgICAgdmFyIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG4gICAgICAgICAgICB2YXIgbG9jID0gdXJsLnN1YnN0cmluZyh1cmwubGFzdEluZGV4T2YoJz0nKSArIDEsIHVybC5sZW5ndGgpO1xuICAgICAgICAgICAgaWYgKGxvYyA9PSAxKSB7XG4gICAgICAgICAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvMU9TYz0nO1xuICAgICAgICAgICAgICAgIHVuaW9uaWQgPSAnSnpJd01UY3ROaTB4TmlBd09UbzBOVG8xT1NjJztcbiAgICAgICAgICAgICAgICBuaWNrbmFtZSA9IFwiZ3Vlc3RfMVwiO1xuICAgICAgICAgICAgICAgIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGxvYyA9PSAyKSB7XG4gICAgICAgICAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN2Tmk4eE5pRGt1SXJsallnNU9qTTRPak16Snc9PSc7XG4gICAgICAgICAgICAgICAgdW5pb25pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZzVPak00T2pNekp3JztcbiAgICAgICAgICAgICAgICBuaWNrbmFtZSA9IFwiZ3Vlc3RfMlwiO1xuICAgICAgICAgICAgICAgIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGxvYyA9PSAzKSB7XG4gICAgICAgICAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvYz0nO1xuICAgICAgICAgICAgICAgIHVuaW9uaWQgPSAnOGRPdEFjRGljNVNpY2h2M2x4dE1YWW11blRMT0x2JztcbiAgICAgICAgICAgICAgICBuaWNrbmFtZSA9IFwiZ3Vlc3RfM1wiO1xuICAgICAgICAgICAgICAgIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGxvYyA9PSA0KSB7XG4gICAgICAgICAgICAgICAgb3BlbmlkID0gJ296bFhJd2d2X1FKVDB5a2RVaWhhQUJtc1dwMkEnO1xuICAgICAgICAgICAgICAgIHVuaW9uaWQgPSAnby0zOTExcVdzUXNXM3dVb2RxRmZVdGJzQWVOayc7XG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzRcIjtcbiAgICAgICAgICAgICAgICB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCInK25pY2tuYW1lKydcIixcInVuaW9uaWRcIjpcIicrdW5pb25pZCsnXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsb2MgPT0gNSkge1xuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZ3hNRG93TXpvd09DYz0nO1xuICAgICAgICAgICAgICAgICB1bmlvbmlkID0gJ28tSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TURvd00nO1xuICAgICAgICAgICAgICAgIG5pY2tuYW1lID0gXCJndWVzdF81XCI7XG4gICAgICAgICAgICAgICAgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwiJytuaWNrbmFtZSsnXCIsXCJ1bmlvbmlkXCI6XCInK3VuaW9uaWQrJ1wiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC84RDhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2VFQ1QUZNNHphcUtFdGhaaWJ2OHhkV2tnak45WWI0QVFud3ZTdXJ6MjdVQjI5eHg4MVhPUnd4NTVYYW54cWN0ZERcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xuICAgICAgICAgICAgfWVsc2UgaWYobG9jID09IDYpe1xuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZ3hNTXpvYz0nO1xuICAgICAgICAgICAgICAgICB1bmlvbmlkID0gJ28tekl3TVRjdk5pOHhOaURrdUlybCc7XG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzZcIjtcbiAgICAgICAgICAgICAgICB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCInK25pY2tuYW1lKydcIixcInVuaW9uaWRcIjpcIicrdW5pb25pZCsnXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgIGlmKHRlc3REYXRhICYmIHRlc3REYXRhLmxlbmd0aCA+IDApXG4gICAgICAgICB7XG4gICAgICAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKHRlc3REYXRhKTtcbiAgICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgfSxcbiAgICBfcmVnaXN0ZXJTb2NrZXRFdmVudDpmdW5jdGlvbigpe1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlTG9naW5Kb2luLCB0aGlzLl9Mb2dpbkpvaW4sIHRoaXMpO1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlUmVjb3JkSWQsIHRoaXMuX1JlY2VpdmVSZWNvcmRJZCwgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVOb1Vpb25pZCwgdGhpcy5fUmVjZWl2ZU5vVWlvbmlkLCB0aGlzKTtcbiAgICB9LCBcbiAgICBfZ2V0X0hSRUY6ZnVuY3Rpb24ocm9vbUlkKXtcbiAgICAgIGlmKHJvb21JZCAhPSBST09NSUQpe1xuICAgICAgICBST09NSUQgPSByb29tSWQ7XG4gICAgICAgIHJvb21JZCA9IFwiJTNmcm9vbUlkJTNkXCIrcm9vbUlkIDtcbiAgICAgICAgUkVESVJFQ1RfVVJJID0gUkVESVJFQ1RfVVJJK3Jvb21JZDtcbiAgICAgICAgSFJFRiA9IFwiaHR0cHM6Ly9vcGVuLndlaXhpbi5xcS5jb20vY29ubmVjdC9vYXV0aDIvYXV0aG9yaXplP2FwcGlkPVwiK0FQUElEK1wiJnJlZGlyZWN0X3VyaT1cIitSRURJUkVDVF9VUkkrXCImcmVzcG9uc2VfdHlwZT1jb2RlJnNjb3BlPXNuc2FwaV91c2VyaW5mbyZzdGF0ZT1TVEFURSN3ZWNoYXRfcmVkaXJlY3RcIjtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9SZWNlaXZlTm9VaW9uaWQ6ZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyhcIlwiKTtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHZhciByb29tSWQgPSB0aGlzLmdldFF1ZXJ5U3RyaW5nKFwicm9vbUlkXCIpO1xuICAgICAgaWYocm9vbUlkKXtcbiAgICAgICAgLy9yb29tSWQgPSBcIiUzZnJvb21JZCUzZFwiK3Jvb21JZCA7XG4gICAgICAgIC8vUkVESVJFQ1RfVVJJID0gUkVESVJFQ1RfVVJJK3Jvb21JZDtcbiAgICAgICAgdGhpcy5fZ2V0X0hSRUYocm9vbUlkKTtcbiAgICAgIH1cbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgc2VsZi5sb2FkaW5nTm9kZS5wYXJlbnQuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHNlbGYubG9hZGluZ05vZGUuc3RvcEFsbEFjdGlvbnMoKTtcbiAgICAgIH0sMjAwMClcbiAgICAgIHRoaXMuX2xvYWRpbmdMYWJlbChcIueZu+W9leWksei0pe+8jOivt+mHjeaWsOeZu+W9lVwiKTtcbiAgICB9LFxuICAgIF9SZWNlaXZlUmVjb3JkSWQ6ZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIGlmKGRhdGEucmVjb3JkTXNnLmxlbmd0aD4wKXtcbiAgICAgICAgICB2YXIgcmVjb3JkID0gZGF0YS5yZWNvcmRNc2dbMF07XG4gICAgICAgICAgdmFyIHBsYXllcnNJbmZvID0gSlNPTi5wYXJzZShyZWNvcmQucGxheWVyc0luZm8pLnBsYXllcnM7XG4gICAgICAgICAgdmFyIHJlY29yZE5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnJlY29yZEluZm8pO1xuICAgICAgICAgIGxldCB0b3RhbEdhbWVSZXN1bHQgPSByZWNvcmROb2RlLmdldENvbXBvbmVudChcIlRvdGFsR2FtZVJlc3VsdFwiKTtcbiAgICAgICAgICBwbGF5ZXJzSW5mby5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIudG90YWxTY29yZS1hLnRvdGFsU2NvcmV9KTsgIC8vIOaOkuW6j1xuICAgICAgICAgIHRvdGFsR2FtZVJlc3VsdC5zZXRQbGF5ZXJJbmZvcyhwbGF5ZXJzSW5mbyxyZWNvcmQpO1xuICAgICAgICAgIHRvdGFsR2FtZVJlc3VsdC5fY2xpY2tCdG4oKTtcbiAgICAgICAgICByZWNvcmROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xuICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChyZWNvcmROb2RlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgX0xvZ2luSm9pbjogZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICB0aGlzLl9sb2FkaW5nTGFiZWwoXCLov5vlhaXmiL/pl7TvvIzmraPlnKjkuLrmgqjor7fmsYLmlbDmja5cIik7XG4gICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQpe1xuICAgICAgICAgICAgaWYoY2MuZnJvbSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2MuZnJvbSA9IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2MuZnJvbS5tYSA9IHJlc3BvbnNlLmRhdGEubWFQYWk7XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3BsYXknKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNjLmpvaW5EZXNrID0ge307XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcbiAgICAgICAgICAgIGxldCByZWFzb25JbmZvID0gdGhpcy5fam9pblJlYXNvbk1hcChyZXNwb25zZS5kYXRhLnJlYXNvbik7XG4gICAgICAgICAgICBjYy5qb2luRGVzay5yZXN1bHQgPSByZXNwb25zZS5yZXN1bHQ7XG4gICAgICAgICAgICBjYy5qb2luRGVzay5yZWFzb24gPSByZWFzb25JbmZvO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBfam9pblJlYXNvbk1hcDogZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgbGV0IHJlYXNvbkluZm8gPSB7XG4gICAgICAgIG5vdEV4aXN0OiBcIuaIv+mXtOS4jeWtmOWcqCFcIixcbiAgICAgICAgY2FyZE51bWJlcjogXCLmgqjmiL/ljaHkuI3otrMhXCIsXG4gICAgICB9O1xuICAgICAgbGV0IGluZm8gPSByZWFzb25JbmZvW3JlYXNvbl0gfHwgXCLmiL/pl7Tlt7Lmu6EhXCI7XG4gICAgICByZXR1cm4gaW5mbztcbiAgICB9LFxuXG4gICAgZ2V0UXVlcnlTdHJpbmc6IGZ1bmN0aW9uKG5hbWUpe1xuICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cChcIihefCYpXCIgKyBuYW1lICsgXCI9KFteJl0qKSgmfCQpXCIsIFwiaVwiKTsgXG4gICAgICAgIHZhciByID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSkubWF0Y2gocmVnKTsgXG4gICAgICAgIGlmIChyICE9IG51bGwpIHJldHVybiB1bmVzY2FwZShyWzJdKTsgcmV0dXJuIG51bGw7IFxuICAgIH0sXG5cbiAgICBhZ3JlZW1lbnRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYWdyZWVtZW50Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAvL3RoaXMuYWdyZWVtZW50TGFiZWwuc3RyaW5nID0gY2MuaW5mbzE7XG4gICAgICAgIHRoaXMuYWdyZWVtZW50TGFiZWwubm9kZS55ID0gMDtcbiAgICB9LFxuXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnNvY2tldC5yZWNldmljZU1lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICB9LFxuXG4gICAgX2xvYWRpbmdMYWJlbDpmdW5jdGlvbihsYWJlbCl7XG4gICAgICAgIHRoaXMubGFiZWwuc3RyaW5nID0gbGFiZWw7XG4gICAgfSxcblxuICAgIHNlbmRMb2dpblJlcXVlc3Q6ZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAvL3RoaXMuc2hvd1dhaXRpbmdNZXNzYWdlKCfnmbvlvZXkuK0uLi4nKTtcbiAgICAgICAgdGhpcy5sb2FkaW5nTm9kZS5wYXJlbnQuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5sb2FkaW5nTm9kZS5ydW5BY3Rpb24oY2MucmVwZWF0Rm9yZXZlcihjYy5yb3RhdGVCeSgyLCAzNjApKSk7XG4gICAgICAgIC8vcmV0dXJuO1xuICAgICAgICB0aGlzLnNvY2tldC5zZW5kTWVzc2FnZSgnbG9naW4nLGRhdGEpO1xuICAgIH0sXG5cbiAgICBsb2dpbkFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XG4gICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5bey5a2Y5pyJ6LSm5Y+3PT09PT0nKTtcbiAgICAgICAgICAgICAgICAvL3JldHVybjtcbiAgICAgICAgICAgIH1lbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5paw6LSm5Y+3PT09PT0nKTtcbiAgICAgICAgICAgICAgICB2YXIgdXNlckluZm8gPSB0aGlzLmdldEd1ZXN0VXNlckluZm8oKTtcbiAgICAgICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKHVzZXJJbmZvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pO1xuICAgICAgICAgIHRoaXMuc2VuZExvZ2luUmVxdWVzdChkYXRhKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgLy8gY2Muc3lzLm9wZW5VUkwoSFJFRik7XG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IEhSRUY7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4TG9naW5cIik7Ly9JT1NcbiAgICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hMb2dpblwiLCBcIigpVlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSxcblxuICAgIGNoYW5nZUd1ZXN0VXNlckluZm86ZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbygnJyk7XG4gICAgICAgIHRoaXMubG9naW5BY3Rpb24oKTtcbiAgICB9LFxuXG4gICAgbG9naW5Za0FjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgLy92YXIgY29tcCA9IHRoaXMuc2VsZWN0Tm9kZS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAvL2lmICghY29tcC5zZWxlY3RlZCkge1xuICAgICAgICAvLyAgICB0aGlzLnNob3dNc2cgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmFsZXJ0UHJlZmFiKTtcbiAgICAgICAgLy8gICAgdGhpcy5jYW52YXNOb2RlLmFkZENoaWxkKHRoaXMuc2hvd01zZyk7XG4gICAgICAgIC8vICAgIGxldCBjb21wID0gdGhpcy5zaG93TXNnLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgLy8gICAgY29tcC5zZXRNZXNzYWdlKCfor7flkIzmhI/nlKjmiLfljY/orq4nKTtcbiAgICAgICAgLy8gICAgcmV0dXJuO1xuICAgICAgICAvL31cbiAgICAgICAgdmFyIHRlc3REYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgdmFyIHRpbWUgPSBcIidcIit0ZXN0RGF0ZS50b0xvY2FsZVN0cmluZygpK1wiJ1wiO1xuICAgICAgICB2YXIgb3BlbmlkID0gbmV3IEJ1ZmZlcih0aW1lKS50b1N0cmluZygnYmFzZTY0Jyk7XG4gICAgICAgIHZhciB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCLmuLjlrqJcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvQlZ5ejRSOHE2cHVKaWJFdjFocnNhVG1JS1Foa2FUUzlGeXZjZXZ2QzVobHhGbmZPdXNwRGppY0cwR3R6eUpYT2hOVDdnMVdaRGVDRFFoblJkRU9nejNRTW5QMEY5aWJvUUd5XFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcbiAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHRlc3REYXRhKTtcbiAgICAgICAgdGhpcy5zZW5kTG9naW5SZXF1ZXN0KGRhdGEpO1xuXG4gICAgfSxcblxuICAgIHNob3dXYWl0aW5nTWVzc2FnZTpmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCAmJiBjYy5zeXMuaXNOYXRpdmUgJiYgY2MuaXNWYWxpZCh0aGlzLndhaXRpbmdOb2RlKSkge1xuICAgICAgICAgIGlmIChtc2cgPT0gdGhpcy53YWl0aW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZ2V0TWVzc2FnZSgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy53YWl0aW5nTm9kZS5yZW1vdmVGcm9tUGFyZW50KCk7XG4gICAgICAgICAgICB0aGlzLndhaXRpbmdOb2RlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLndhaXRpbmdOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcbiAgICAgICAgdGhpcy5jYW52YXNOb2RlLmFkZENoaWxkKHRoaXMud2FpdGluZ05vZGUpO1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKGNvbXApO1xuXG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGhpZGRlbldhaXRpbmdNZXNzYWdlOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy53YWl0aW5nTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLndhaXRpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcHJvdG9jb2xBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIGNjLmxvZygncHJvdG9jb2wgYWN0aW9uJyk7XG4gICAgfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBtYVBhaVNwcml0ZTpbY2MuU3ByaXRlRnJhbWVdLFxyXG4gICAgICAgIHNwcml0ZU5vZGU6Y2MuU3ByaXRlLFxyXG4gICAgICAgIGxhYmVsTm9kZTpjYy5Ob2RlXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG5cclxuICAgIFxyXG59KTtcclxuIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgdmVyc2lvbjondjEuMC4wJyxcblxuICAgIHNldFVzZXJJbmZvOmZ1bmN0aW9uKHN0cikge1xuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJpbmZvJywgc3RyKTtcbiAgICB9LFxuXG4gICAgZ2V0VXNlckluZm86ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcmluZm8nKTtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBzZXRNdXNpY1ZhbHVlOmZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbXVzaWNWb2x1bW4nLHZhbHVlKTtcbiAgICB9LFxuXG4gICAgZ2V0TXVzaWNWYWx1ZTpmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdtdXNpY1ZvbHVtbicpO1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcblxuICAgIHNldE11c2ljRWZmZWN0VmFsdWU6ZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdtdXNpY0VmZmVjdFZvbHVtbicsdmFsdWUpO1xuICAgIH0sXG5cbiAgICBnZXRNdXNpY0VmZmVjdFZhbHVlOmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ211c2ljRWZmZWN0Vm9sdW1uJyk7XG4gICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxufTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG5vZGVzOltjYy5Ob2RlXSxcbiAgICAgICAgLy9zZWxlY3RlZEluZGV4OiAwLFxuICAgICAgICAgX3NlbGVjdGVkOjEsXG4gICAgfSxcblxuICAgIC8qIyMjIyovXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5fc2VsZWN0ID0gdHJ1ZTsgXG4gICAgICAgIHZhciBvdmVyVGltZSA9IDA7XG4gICAgICAgIGlmKGNjLnNldCl7XG4gICAgICAgICAgICBvdmVyVGltZSA9IGNjLnNldC5zZXR0aW5nNjtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdGVkID0gdGhpcy5fc2VsZWN0ID0gb3ZlclRpbWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFjdGl2ZSA9IHRoaXMuX3NlbGVjdDtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdGVkID0gdGhpcy5fc2VsZWN0O1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKGFjdGl2ZSk7XG4gICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGVzW2ldLmdldENoaWxkQnlOYW1lKCd0aXRsZScpO1xuICAgICAgICAgICAgaWYoIHNlbGYuX3NlbGVjdCApe1xuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdENvbXAgPSB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICB0Q29tcC5pbmRleCA9IGk7XG4gICAgICAgICAgICB0Q29tcC5jbGlja0FjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQoIHNlbGYuX3NlbGVjdGVkID0gc2VsZi5fc2VsZWN0ID0gIXNlbGYuX3NlbGVjdCApO1xuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInRpdGxlXCIpO1xuICAgICAgICAgICAgICAgIGlmKCBzZWxmLl9zZWxlY3QgKXtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VsZi5vblNlbGVjdENoYW5nZSh0aGlzLmluZGV4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYoIHRoaXMubm9kZS5fbmFtZSA9PSBcIm9yZGVyc1wiICYmIGNjLnNldCl7XG4gICAgICAgICAgICAvL3RoaXMucmVtZW1iZXJfc2V0KG92ZXJUaW1lKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgcmVtZW1iZXJfc2V0OmZ1bmN0aW9uKG9iail7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKS5zZXRTZWxlY3RlZChvYmopO1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XG4gICAgICAgICAgICBpZiggb2JqICl7XG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gdGhpcy5ub2Rlc1swXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcbiAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvblNlbGVjdENoYW5nZTogZnVuY3Rpb24gKHNlbGVjdEluZGV4KSB7XG4gICAgICAgIC8vY2MubG9nKHNlbGVjdEluZGV4KTtcbiAgICB9LFxuICAgIFxufSk7XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcclxuY29uc3QgQXJyYXlFeHRlbnNpb24gPSByZXF1aXJlKCdBcnJheUV4dGVuc2lvbicpO1xyXG5jb25zdCBNYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xyXG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcclxuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xyXG5jb25zdCBVc2VyTW9kZWxIZWxwZXIgPSByZXF1aXJlKCdVc2VyTW9kZWxIZWxwZXInKTtcclxuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xyXG5jb25zdCBmZWNoYSA9IHJlcXVpcmUoJ2ZlY2hhJyk7XHJcbnZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xyXG4vKiMjIyMjKi9cclxuY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XHJcbi8qKi9cclxuY29uc3QgUGxheWVyID0gcmVxdWlyZSgnUGxheWVyJyk7XHJcbi8qKi9cclxuLy9jb25zdCBpc1RlU2h1UGFpID0gcmVxdWlyZSgnaXNUZVNodVBhaScpOyBcclxuLy/nibnmrorniYznsbvlnotcclxudmFyIFRFU0hVUEFJVFlQRSA9IHtcclxuICAgIGlzVGVTaHVQYWk6ZmFsc2UsXHJcbiAgICBpc0xpdUR1aUJhbjpmYWxzZSxcclxuICAgIGlzU2FuU2h1blppOmZhbHNlLFxyXG4gICAgaXNTYW5UYW9IdWE6ZmFsc2UsXHJcblxyXG4gICAgaXNRaW5nTG9uZzpmYWxzZSxcclxuICAgIGlzWWlUaWFvTG9uZzpmYWxzZSxcclxuICAgIGlzU2FuVG9uZ0h1YVNodW46ZmFsc2UsXHJcbiAgICBpc1NhbkZlblRpYW5YaWE6ZmFsc2UsXHJcbiAgICBpc0NvdVlpU2U6ZmFsc2UsXHJcbiAgICBpc1NpVGFvU2FuVGlhbzpmYWxzZSxcclxuICAgIGlzV3VEdWlTYW5UaWFvOmZhbHNlXHJcbn07XHJcblxyXG5sZXQgR0FNRVNUQVRVUyA9IHtcclxuICAgIFdBSVRfUEVPUExFOiAwLCAgICAvLyDnrYnkurpcclxuICAgIFdBSVRfUkVBRFk6IDEsICAgICAvLyDnrYnlvoXku5bkurrlh4blpIdcclxuICAgIFBMQVlJTkc6IDIsICAgICAgICAvLyDmraPlnKjnjqnmuLjmiI9cclxufTtcclxudmFyIHNUaXRsZSA9ICcnO1xyXG52YXIgc0Rlc2NyaXB0aW9uID0gJyc7XHJcbnZhciBzSWQgPSAnJztcclxuLy8g5biD5bGAXHJcbi8vICAgICAgICAgIDJcclxuLy8gICAzICAgICAgICAgICAgMVxyXG4vLyAgICAgc2VsZiAwXHJcbmxldCBQbGF5ID0gY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBwbGF5ZXJOb2RlczogW2NjLk5vZGVdLFxyXG4gICAgICAgIC8vcGxheXNDb2luczogW2NjLk5vZGVdLFxyXG4gICAgICAgIGNoYXROb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZU5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgdHlwZUJ1dHRvbnNOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIHBob25lOmNjLkxhYmVsLFxyXG4gICAgICAgIGxhYmVsUm9vbU51bWJlcjogY2MuTGFiZWwsXHJcbiAgICAgICAgbGFiZWxPdmVydmlldzogY2MuTGFiZWwsXHJcbiAgICAgICAgbGFiZWxSZW1haW5UaW1lOiBjYy5MYWJlbCxcclxuICAgICAgICBidG5TaGFyZTogY2MuQnV0dG9uLFxyXG4gICAgICAgIGJ0blJlYWR5OiBjYy5CdXR0b24sICAgICAgICAgICAgLy8g5YeG5aSH5oyJ6ZKuXHJcbiAgICAgICAgYnRuU3RhcnRHYW1lOiBjYy5CdXR0b24sICAgICAgICAvLyDlvIDlp4vmjInpkq5cclxuICAgICAgICBiZWlsdjpjYy5Ob2RlLCAgICAgICAgICAgICAgICAgIC8vIOmAieaLqeWAjeeOh+iKgueCuVxyXG4gICAgICAgIGJ0bkNoYXRWb2ljZTogY2MuQnV0dG9uLFxyXG4gICAgICAgIGJ0bkNoYXRUZXh0OiBjYy5CdXR0b24sXHJcbiAgICAgICAgYWdhaW5CdG46Y2MuTm9kZSxcclxuXHJcbiAgICAgICAgc3RhcnRDb21wYXJlQ2FyZHNOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIHNldHRpbmdOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIFZvaWNlTXNnQmc6Y2MuTm9kZSxcclxuICAgICAgICBleGl0OmNjLk5vZGUsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOemu+W8gOaIv+mXtOiKgueCuVxyXG4gICAgICAgIERpc3NvbHZlOmNjLk5vZGUsICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6Kej5pWj5oi/6Ze06IqC54K5XHJcbiAgICAgICAgc2hhcmVCZzpjYy5Ob2RlLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDliIbkuqvog4zmma9cclxuICAgICAgICB0b3RhbEdhbWVSZXN1bHQ6IGNjLk5vZGUsICAgICAgICAgICAgICAgICAgIC8vIOe7k+aenOiKgueCuVxyXG4gICAgICAgIGFsZXJ0UmVxdWVzdEV4aXROb2RlOiBjYy5Ob2RlLCAgICAgICAgICAgICAgLy8g55Sz6K+36YCA5Ye6IE5vZGVcclxuICAgICAgICBkaXNzb2x2ZUFsdGVyOiBjYy5Ob2RlLCAgICAgICAgICAgICAgICAgICAgIC8vIOeUs+ivt+mAgOWHuiBOb2RlXHJcbiAgICAgICAgYWxlcnRSZXF1ZXN0RXhpdENvdW50ZG93bk5vZGU6IGNjLk5vZGUsICAgICAvLyDnlLPor7fpgIDlh7rlgJLorqHml7YgTm9kZVxyXG4gICAgICAgIGFsZXJ0QW5zb3dlckV4aXROb2RlOiBjYy5Ob2RlLCAgICAgICAgICAgICAgLy8g5Zue562U55Sz6K+36YCA5Ye6ICBOb2RlXHJcbiAgICAgICAgY29udGVudEFuc293ZXJFeGl0Tm9kZTogY2MuTm9kZSwgICAgICAgICAgICAvLyDlm57nrZTnlLPor7fpgIDlh7rlpLTlg48gIE5vZGVcclxuICAgICAgICBhbGVydEFuc293ZXJFeGl0UmVzdWx0OiBjYy5Ob2RlLCAgICAgICAgICAgIC8vIOWbnuetlOeUs+ivt+mAgOWHuue7k+aenCAgTm9kZVxyXG4gICAgICAgIGFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlOiBjYy5Ob2RlLCAgICAgLy8g5Zue562U5Lul5LiK6K+36YCA5Ye655qE5YCS6K6h5pe2XHJcbiAgICAgICAgQ291bnRkb3duOmNjLk5vZGUsICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlgJLorqHml7ZcclxuICAgICAgICBsYWJlbFRpbWU6Y2MuTGFiZWwsXHJcbiAgICAgICAgbmVlZENhcmQ6Y2MuTGFiZWwsXHJcbiAgICAgICAgYWxlcnQ6IGNjLk5vZGUsXHJcbiAgICAgICAgY29pbnNDb250YWluZXJOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIGJ0bkFsZXJ0UmVxdWVzdEV4aXRDb25maXJtQnV0dG9uOiBjYy5CdXR0b24sXHJcbiAgICAgICAgYnRuQWxlcnRSZXF1ZXN0RXhpdENhbmNlbEJ1dHRvbjogY2MuQnV0dG9uLFxyXG5cclxuICAgICAgICBhdXRvVGlzaGk6Y2MuUHJlZmFiLFxyXG4gICAgICAgIHdhaXRpbmdQcmVmYWI6IGNjLlByZWZhYixcclxuICAgICAgICBjb2luc1ByZWZhYjogY2MuUHJlZmFiLFxyXG4gICAgICAgIHBsYXllckNvbXBzOiBbUGxheWVyXSxcclxuXHJcbiAgICAgICAgZ29uZ1hpTmk6Y2MuTm9kZSxcclxuICAgICAgICB0ZVNodVBhaTpjYy5Ob2RlLFxyXG5cclxuICAgICAgICBjYXJkU3ByaXRlQXRsYXM6Y2MuU3ByaXRlQXRsYXMsXHJcbiAgICAgICAgZGFvU3ByaXRlQXRsYXM6Y2MuU3ByaXRlQXRsYXMsXHJcblxyXG4gICAgICAgIF9saXVEdWlCYW46ZmFsc2UsXHJcbiAgICAgICAgX3NhblNodW5aaTpmYWxzZSxcclxuICAgICAgICBfc2FuVG9uZ0h1YTpmYWxzZSxcclxuICAgICAgICBfeWlUaWFvTG9uZzpmYWxzZSxcclxuXHJcbiAgICAgICAgX1FpbmdMb25nOmZhbHNlLFxyXG4gICAgICAgIF9TYW5Ub25nSHVhU2h1bjpmYWxzZSxcclxuICAgICAgICBfU2FuRmVuVGlhblhpYTpmYWxzZSxcclxuICAgICAgICBfQ291WWlTZTpmYWxzZSxcclxuICAgICAgICBfU2lUYW9TYW5UaWFvOmZhbHNlLFxyXG4gICAgICAgIF9XdUR1aVNhblRpYW86ZmFsc2UsXHJcblxyXG4gICAgICAgIF9wbGF5ZXJDb21wb25lbnRzOiBudWxsLFxyXG4gICAgICAgIF9tc2dDb250cm9sOiBudWxsLFxyXG4gICAgICAgIF9ub3dUaW1lQWdhaW46MCxcclxuXHJcbiAgICAgICAgX3NvY2tldDogbnVsbCxcclxuICAgICAgICBfdXNlcklkOiAwLFxyXG4gICAgICAgIF9wbGF5ZXJJbmZvczogbnVsbCxcclxuICAgICAgICBfZGVza0luZm86IG51bGwsICAgLy8gY3JlYXRlVGltZSDliJvlu7rml7bpl7QgIGlzRGlzc29sdmluZyDooajnpLrmmK/lkKbmraPlnKjop6PmlaMgZGlzc29sdmVMZWZ0VGltZSDnprvop6PmlaPliankvZnlpJrplb/ml7bpl7QgZGlzc29sdmVBbnN3ZXJJbmZvIFvlpITnkIbov4fnmoTkurrnmoTkv6Hmga9dXHJcbiAgICAgICAgX2dhbWVTdGF0dXM6IEdBTUVTVEFUVVMuV0FJVF9QRU9QTEUsXHJcbiAgICAgICAgX2VudGVyVGltZTogbnVsbCxcclxuICAgICAgICBfYmlnUmVjb3JkSW5mbzpudWxsLFxyXG4gICAgICAgIF9wbGF5ZXJzOm51bGwsXHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIF9pc0NvbXBhcmluZ0NhcmRzTm93OiBmYWxzZSwgLy8g5piv5ZCm5q2j5Zyo5q+U54mMXHJcbiAgICAgICAgX3BsYXllZENvbXBhcmVDYXJkc0luZGV4czogW10sIC8vIOW3sue7j+aSreaUvui/h+avlOeJjOeahOWxgOaVsFxyXG4gICAgICAgIC8qKi9cclxuICAgICAgICBmYXBhaU5vZGU6IGNjLlByZWZhYixcclxuICAgICAgICBsaXVkdWliYW46Y2MuUHJlZmFiLFxyXG4gICAgICAgIHNhbnRvbmdodWE6Y2MuUHJlZmFiLFxyXG4gICAgICAgIHNhbnNodW56aTpjYy5QcmVmYWIsXHJcbiAgICAgICAgcXVhbmxlaWRhOmNjLlByZWZhYixcclxuICAgIH0sXHJcbiAgICBrZXlCYWNrTGlzdGVuOmZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGNjLnN5c3RlbUV2ZW50Lm9uKGNjLlN5c3RlbUV2ZW50LkV2ZW50VHlwZS5LRVlfRE9XTixmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIGlmKGUua2V5Q29kZSA9PSBjYy5LRVkuYmFjaykge1xyXG4gICAgICAgICAgICAgICAgaWYoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpe1xyXG4gICAgICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJiYWNrVG9EZXNrXCIsIFwiKClWXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSx0aGlzKTtcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMua2V5QmFja0xpc3RlbigpO1xyXG4gICAgICAgIHRoaXMuaGVhZENhcmRUaW1lID0gMC44NTtcclxuICAgICAgICB2YXIgYmcgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJyb29tX2JnXCIpO1xyXG4gICAgICAgIHZhciB3aW5kb3dQID0gY2MuZGlyZWN0b3IuZ2V0V2luU2l6ZUluUGl4ZWxzKCk7XHJcbiAgICAgICAgdmFyIHNjYWxlWCA9IHdpbmRvd1Aud2lkdGgvYmcud2lkdGg7XHJcbiAgICAgICAgdmFyIHNjYWxlWSA9IHdpbmRvd1AuaGVpZ2h0L2JnLmhlaWdodDtcclxuICAgICAgICB2YXIgc2NhbGUgPSBNYXRoLm1heChzY2FsZVgsc2NhbGVZKTtcclxuICAgICAgICBiZy5zY2FsZVggPSBzY2FsZTtcclxuICAgICAgICBiZy5zY2FsZVkgPSBzY2FsZTtcclxuXHJcbiAgICAgICAgdGhpcy5CdG5DbGlja0dvbmdYaU5pQ29tZmlybSA9IHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5nZXRDb21wb25lbnQoXCJDYXJkVHlwZUNvbWJpbmVcIikuQnRuQ2xpY2tHb25nWGlOaUNvbWZpcm07XHJcbiAgICAgICAgdGhpcy5fZW50ZXJUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy5wbGF5ZXJDb21wcy5mb3JFYWNoKHBsYXllckNvbXAgPT4ge1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLnBsYXllZENvbXBhcmVDYXJkc0luZGV4cyA9IHRoaXMuX3BsYXllZENvbXBhcmVDYXJkc0luZGV4cztcclxuICAgICAgICB9KTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgLypBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheURlc2tNdXNpYygpOyovXHJcblxyXG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5zdG9wSGFsbE11c2ljKCk7XHJcbiAgICAgICAgdmFyIGJnU291bmQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJiZ1NvdW5kXCIpO1xyXG4gICAgICAgIGlmKGJnU291bmQgPT0gMCl7XHJcbiAgICAgICAgICAgIHZhciBhdWRpb01hbmFnZXIgPSBjYy5maW5kKCdBdWRpb01hbmFnZXInKTtcclxuICAgICAgICAgICAgYXVkaW9NYW5hZ2VyID0gYXVkaW9NYW5hZ2VyLmdldENvbXBvbmVudCgnQXVkaW9NYW5hZ2VyJyk7XHJcbiAgICAgICAgICAgIGF1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKGJnU291bmQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5faW5pdFBsYXllckNvbXBvbmVudHMoKTtcclxuICAgICAgICB0aGlzLl9pbml0U2VsZWN0Q2FyZE5vZGUoKTtcclxuICAgICAgICB0aGlzLl9pbml0T25lR2FtZVJlc3VsdCgpO1xyXG4gICAgICAgIHRoaXMuX3JlbWFpblRpbWVTdGFydFVwZGF0ZSgpO1xyXG5cclxuICAgICAgICB0aGlzLl91c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XHJcbiAgICAgICAgdGhpcy5fbXNnQ29udHJvbCA9IHRoaXMuY2hhdE5vZGUuZ2V0Q29tcG9uZW50KCdNc2dDb250cm9sJyk7XHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuYmVpbHYuZ2V0Q29tcG9uZW50KFwic2VsZWN0YmVpbHZcIikuX3VzZXJpZCA9IHRoaXMuX3VzZXJJZDtcclxuICAgICAgICAvL3RoaXMuc2V0dGluZ05vZGUuZ2V0Q29tcG9uZW50KFwiU2V0dGluZ1wiKS5oaWRlU3dpdGNoKCk7XHJcbiAgICAgICAgdGhpcy5sYWJlbFJvb21OdW1iZXIuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLl9yZWdpc3RlclZvaWNlTm9kZUV2ZW50cygpO1xyXG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyU29ja2V0RXZlbnQoKTtcclxuXHJcbiAgICAgICAgUGxheS5pbnN0YW5jZXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyhmYWxzZSk7XHJcbiAgICAgICAgaWYgKFBsYXliYWNrLmluc3RhbmNlLmlzQ29udGFpblBsYXliYWNrRGF0YXMoKSkge1xyXG4gICAgICAgICAgICBQbGF5YmFjay5pbnN0YW5jZS5zdGFydFBsYXliYWNrKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWJhY2tOb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuQ2hhdFZvaWNlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5jYXJkc0Zyb21BcnJheS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWREZXNrSW5mbygpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHRoaXMuX3NvY2tldCA9IFNvY2tldC5pbnN0YW5jZTtcclxuXHJcblxyXG4gICAgICAgIGNjLmRpcmVjdG9yLnByZWxvYWRTY2VuZSgnaGFsbCcsZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IucHJlbG9hZFNjZW5lKCdsb2dpbicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjYy5jbGlja091dCA9IGZhbHNlO1xyXG4gICAgICAgIC8vdGhpcy50aW1lU3RhcnQoNSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHRpbWVTdGFydDogZnVuY3Rpb24gKGR1cmF0aW9uLGFjdGlvbikge1xyXG4gICAgICAgIGNjLmFzc2VydChkdXJhdGlvbiA+IDApO1xyXG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICB0aGlzLkNvdW50ZG93bi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGlmKGFjdGlvbiAhPSBcInJlYWR5XCIpe1xyXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidGltZXN0YW1wXCIpOyAgLy8g6I635Y+W5pys5Zyw5a2Y5YKo55qE5pe26Ze05oizXHJcbiAgICAgICAgICAgIGlmKHRpbWVzdGFtcCl7ICAvLyDlpoLmnpzmnInliJnor4HmmI7njqnlrrbmmK/ph43mlrDov5vmnaXkuobnmoRcclxuICAgICAgICAgICAgICAgIHZhciBub3cgPSBEYXRlLnBhcnNlKG5ldyBEYXRlKCkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRpbWUgPSBkdXJhdGlvbioxMDAwO1xyXG4gICAgICAgICAgICAgICAgaWYobm93IC0gdGltZXN0YW1wID4gdGltZSl7IC8vIOi2heaXtlxyXG4gICAgICAgICAgICAgICAgICAgIGlmKG5vdyAtIHRpbWVzdGFtcCA8IDIqdGltZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gNTsgIC8vIOeOqeWutuWPr+iDveWHuuS6juWFtuS7luWOn+WboOmAgOWHuua4uOaIj+WvvOiHtOi2heaXtu+8jOS4uuWFtuaPkOS+mzXnp5Lml7bpl7TmlbTnkIbniYzlnovvvIjov5nlt7Lnu4/mmK/lvojku4HmhYjnmoTkuobvvInjgIJcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwidGltZXN0YW1wXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gTWF0aC5mbG9vciggZHVyYXRpb24gLSAobm93IC0gdGltZXN0YW1wKS8xMDAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfWVsc2V7ICAvLyDlpoLmnpzmsqHmnInml7bpl7TmiLPvvIzliJnkv53lrZjvvIzkuLrnjqnlrrbpgIDlh7rmuLjmiI/kv53nlZnor4Hmja7vvJtcclxuICAgICAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSBEYXRlLnBhcnNlKG5ldyBEYXRlKCkpOyAgICAgXHJcbiAgICAgICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3RpbWVzdGFtcCcsdGltZXN0YW1wKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gPSBkdXJhdGlvbjtcclxuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBTdHJpbmcoZHVyYXRpb24pO1xyXG4gICAgICAgIHRoaXMuQ291bnRkb3duLmdldENvbXBvbmVudChcInRpbWVcIikuc2V0VGltZShkdXJhdGlvbiAqIDAuNSk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzZWxmLl90aW1lTWV0aG9kKGFjdGlvbik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAgdGhpcy5zY2hlZHVsZSh0aGlzLmNhbGxiYWNrLCAxLCBkdXJhdGlvbik7XHJcbiAgICB9LFxyXG5cclxuICAgIHRpbWVTdG9wOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuY2FsbGJhY2spO1xyXG4gICAgICAgIHRoaXMuQ291bnRkb3duLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuXHJcbiAgICBfdGltZU1ldGhvZDogZnVuY3Rpb24gKGFjdGlvbikge1xyXG4gICAgICAgIHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA9IHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiAtIDE7XHJcblxyXG4gICAgICAgIHZhciByZW1haW4gPSBNYXRoLm1heCh0aGlzLl90aW1lUmVtYWluRHVyYXRpb24sIDApO1xyXG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IChyZW1haW4gPCAxMCAmJiByZW1haW4gPiAwKSA/ICgnMCcgKyByZW1haW4pIDogcmVtYWluO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uIDw9IDApIHtcclxuICAgICAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xyXG4gICAgICAgICAgICBpZihhY3Rpb24gPT0gXCJyZWFkeVwiKXtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNJbmRleD4wKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsaWNrUmVhZHkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBfZ2xvYmFsTXNnOmZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgIC8vaWYoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgdmFyIHJvb21JZCA9IGRhdGEucm9vbUlkO1xyXG4gICAgICAgIHZhciB3ZiA9IGRhdGEuc2V0dGluZzM7ICAvLy9b55av54uC5Zy6LOmsvOeJjCzmr5ToirHoibIs5Z2Q5bqELOmprOeJjF1cclxuICAgICAgICB2YXIgcm9vbSA9IFwi5oi/5Y+377yaXCIrcm9vbUlkO1xyXG4gICAgICAgIHZhciBmayA9IHdmWzBdP1wi55av54uC5Zy6IFwiOlwi5pmu6YCa5Zy6IFwiOyAgICAgICAgIC8vIOeWr+eLguWculxyXG4gICAgICAgIHZhciBncCA9IHdmWzFdP1wi6ay854mMIFwiOlwi5peg6ay8IFwiOyAgICAgICAgICAgICAvLyDprLzniYxcclxuICAgICAgICB2YXIgaHMgPSB3ZlsyXT9cIuavlOiKseiJsiBcIjpcIuS4jeavlOiKseiJsiBcIjsgICAgICAgLy8g5q+U6Iqx6ImyXHJcbiAgICAgICAgdmFyIHpqID0gd2ZbM10/XCLlnZDluoQgXCI6XCLkuI3lnZDluoQgXCI7ICAgICAgICAgICAvLyDluoTlrrZcclxuICAgICAgICB2YXIgbXAgPSB3Zls0XT9cIuS5sOmprCBcIjpcIuS4jeS5sOmprCBcIjsgICAgICAgICAgIC8vIOmprOeJjFxyXG4gICAgICAgIHZhciBzZiA9IFwi5oi/6LS5OlwiKyhkYXRhLnNldHRpbmc0PygoZGF0YS5zZXR0aW5nND09MSk/XCLotaLogIXmiaMgXCI6XCLmiL/kuLvmiaMgXCIpOlwi5bmz5pGKIFwiKTsgIC8v5pS26LS5XHJcbiAgICAgICAgdmFyIHNoYXJlVGl0bGUgPSByb29tK1wiIOaooeW8jzpcIit6aitzZjtcclxuXHJcbiAgICAgICAgdmFyIHBqID0gW1wiNeWxgCBcIixcIjEw5bGAIFwiLFwiMjDlsYAgXCJdOyAgLy/niYzlsYBcclxuICAgICAgICB2YXIgZHMgPSBbXCI05Lq65LiN5Yqg6ImyIFwiLFwiNeS6uuWKoOS4gOiJsiBcIixcIjbkurrkuozoibIgXCIsXCI35Lq65Yqg5LiJ6ImyIFwiXTsgIC8v5aSa6ImyXHJcbiAgICAgICAgdmFyIHJzID0gZHNbZGF0YS5zZXR0aW5nMl0rXCJcIjtcclxuICAgICAgICB2YXIganMgPSBwaltkYXRhLnNldHRpbmcxLTJdO1xyXG4gICAgICAgIHZhciBkZXNjID0gJ1vlpKfkvJfljYHkuInmsLRdICcremorZmsrbXArZ3Arc2YrcnMranMrXCIg54K55Ye755u05o6l6L+b5YWl5oi/6Ze0XCI7XHJcblxyXG4gICAgICAgIHNUaXRsZSA9IHNoYXJlVGl0bGU7XHJcbiAgICAgICAgc0Rlc2NyaXB0aW9uID0gZGVzYztcclxuICAgICAgICBzSWQgPSAncm9vbUlkPScrcm9vbUlkO1xyXG5cclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Jvb21JZCcscm9vbUlkKTtcclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3NoYXJlVGl0bGUnLHNoYXJlVGl0bGUpO1xyXG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGVzYycsZGVzYyk7XHJcblxyXG4gICAgICAgIGlmKGNjLnN5cy5pc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgaWYod2luZG93LnNoYXJlVG9UaW1lTGluZSkge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LnNoYXJlVG9UaW1lTGluZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvU2Vzc2lvbikge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LnNoYXJlVG9TZXNzaW9uKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy99XHJcbiAgICB9LFxyXG5cclxuXHJcblxyXG4gICAgLyojIyMjIyovXHJcbiAgICAvKuaYvuekuumprOeJjCovXHJcbiAgICBfaW5pdE1hUGFpOmZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9pbml0UGxheWVyQ29tcG9uZW50czogZnVuY3Rpb24gKHBsYXllckluZGV4KSB7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cyA9IHRoaXMucGxheWVyTm9kZXMubWFwKGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBub2RlLmdldENvbXBvbmVudCgnUGxheWVyJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmKCFwbGF5ZXJJbmRleCkge1xyXG4gICAgICAgICAgICBwbGF5ZXJJbmRleCA9IFswLDEsMiwzLDQsNV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgYSA9IHRoaXMuX3BsYXllckNvbXBvbmVudHMuc3BsaWNlKDEsNyk7XHJcblxyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwbGF5ZXJJbmRleC5sZW5ndGggLSAxOyBpKyspe1xyXG4gICAgICAgICAgICB2YXIgaW5kZXgxID0gcGxheWVySW5kZXhbaV07XHJcbiAgICAgICAgICAgIHZhciBpbmRleDIgPSBwbGF5ZXJJbmRleFtpICsgMV07XHJcbiAgICAgICAgICAgIHZhciB0bXAgPSBudWxsO1xyXG4gICAgICAgICAgICB0bXAgPSBhW2luZGV4MV07XHJcbiAgICAgICAgICAgIGFbaW5kZXgxXSA9IGFbaW5kZXgyXTtcclxuICAgICAgICAgICAgYVtpbmRleDJdID0gdG1wIDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGEuZm9yRWFjaChmdW5jdGlvbihub2RlKXt0aGlzLl9wbGF5ZXJDb21wb25lbnRzLnB1c2gobm9kZSk7fS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgaWYodGhpcy5wbGF5c0NvaW5zICYmIHRoaXMucGxheXNDb2lucy5sZW5ndGggPiAwKXtcclxuICAgICAgICAgICAgdGhpcy5wbGF5c0NvaW5zLmZvckVhY2goZnVuY3Rpb24obm9kZSl7XHJcbiAgICAgICAgICAgICAgICBub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5wbGF5c0NvaW5zID0gW107XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5cyxpKXtcclxuICAgICAgICAgICAgdmFyIG5hbWUgPSBcImNvaW5zXCIgKyBpO1xyXG5cclxuICAgICAgICAgICAgdmFyIG5vZGUgPSBuZXcgY2MuTm9kZSgpO1xyXG5cclxuICAgICAgICAgICAgbm9kZS5uYW1lID0gbmFtZTtcclxuXHJcbiAgICAgICAgICAgIG5vZGUueCA9IHBsYXlzLm5vZGUueDtcclxuXHJcbiAgICAgICAgICAgIG5vZGUueSA9IHBsYXlzLm5vZGUueTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChub2RlKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucGxheXNDb2lucy5wdXNoKG5vZGUpO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX2luaXRTZWxlY3RDYXJkTm9kZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICBsZXQgY2FyZFR5cGVDb21iaW5lQ29tcCA9IHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlQ29tYmluZScpO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZUNvbXAuc2V0RmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjayhmdW5jdGlvbiAoc2VydmVyQ2FyZHNJbmZvKSB7XHJcbiAgICAgICAgICAgIGNhcmRUeXBlQ29tYmluZUNvbXAucmVzZXQoKTtcclxuICAgICAgICAgICAgU29ja2V0LnNlbmRQbGF5Q2FyZChzZWxmLl91c2VySWQsIHNlcnZlckNhcmRzSW5mbyk7XHJcbiAgICAgICAgICAgIHNlbGYuY2FyZFR5cGVDb21iaW5lTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqL1xyXG4gICAgX2luaXRPbmVHYW1lUmVzdWx0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy8gdGhpcy5vbmVHYW1lUmVzdWx0LnNldENsb3NlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gICAgIGlmIChzZWxmLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgICAgIC8vICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9O1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vZmZUYXJnZXQodGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrTGVhdmVEZXNrOmZ1bmN0aW9uKCl7ICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDngrnlh7vnprvlvIDmoYzlrZBcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDApIHsgICAgICAgICAgICAgICAvLyDov5jmsqHlvIDlp4vlj6/ku6XpgIDlh7rmiL/pl7RcclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gdGhpcy5fdXNlcklkKXtcclxuICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIFNvY2tldC5zZW5kTGVhdmVEZXNrKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2xpY2tEaXNzb2x2ZURlc2sgOmZ1bmN0aW9uKCl7ICAgICAgICAgICAgICAgICAgICAgIC8vIOeCueWHu+ino+aVo+ahjOWtkFxyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHRoaXMuX3VzZXJJZCl7ICAgIC8vIOWPquacieaIv+S4u+aJjeiDveino+aVo+ahjOWtkFxyXG4gICAgICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDYW5jZWxCdXR0b24ubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDb25maXJtQnV0dG9uLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgICAgIGFsZXJ0LnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICAgICAgYWxlcnQuc2V0TWVzc2FnZShcIuaYr+WQpuimgeino+aVo+aIv+mXtFwiKTtcclxuICAgICAgICAgICAgYWxlcnQuYWxlcnQoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrRXhpdE91dDpmdW5jdGlvbigpe1xyXG4gICAgICAgIFNvY2tldC5zZW5kRGlzc29sdmVEZXNrKHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8v6Kej5pWj6YCA5Ye65oi/6Ze0XHJcbiAgICBjbGlja0V4aXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKi9cclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8gJiYgdGhpcy5fZGVza0luZm8uaXNEZXNrT3Zlcikge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cpIHtcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenOaIv+mXtOW3sue7k+adn++8jOW5tuS4lOS4jeaYr+ato+WcqOaSreaUvuaJk+eJjOWKqOeUuywg5YiZ55u05o6l56a75byA5oi/6Ze0XHJcbiAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKi9cclxuICAgICAgICAvL2lmICh0aGlzLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgICAgIC8vICAgIHRoaXMuYWxlcnRGb3JjZUV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xyXG4gICAgICAgIC8vICAgIHJldHVybjtcclxuICAgICAgICAvL31cclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDApIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGFsZXJ0MSA9IHRoaXMuZGlzc29sdmVBbHRlci5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgICAgICAgICBhbGVydDEuYWxlcnQoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIFNvY2tldC5zZW5kTGVhdmVEZXNrKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDYW5jZWxCdXR0b24ubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENvbmZpcm1CdXR0b24ubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICBsZXQgYWxlcnQgPSB0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBhbGVydC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgYWxlcnQuc2V0TWVzc2FnZShcIuaYr+WQpuino+aVo+aIv+mXtO+8n1wiKTtcclxuICAgICAgICBhbGVydC5hbGVydCgpO1xyXG5cclxuICAgICAgICB0aGlzLmFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgfSxcclxuICAgIC8v5LiN6Kej5pWj6YCA5Ye65oi/6Ze0XHJcbiAgICBjbGlja091dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gMCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICBjYy5jbGlja091dCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIFNvY2tldC5zZW5kTGVhdmVEZXNrKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja1NoYXJlQmc6ZnVuY3Rpb24oKXtcclxuICAgICAgICBjYy5maW5kKFwiQ2FudmFzL3NoYXJlQmdcIikuYWN0aXZlID0gZmFsc2U7IFxyXG4gICAgICAgIHRoaXMuc2hhcmVCZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICAgZ3VhbnpodTpmdW5jdGlvbigpe1xyXG4gICAgICAgIC8vIHZhciB1cmwgPSBcImh0dHA6Ly93d3cuaG9uZ2dlZmVuZy5jbi9nemgvaW5kZXguaHRtbFwiO1xyXG4gICAgICAgIC8vIGNjLnN5cy5vcGVuVVJMKHVybClcclxuICAgIH0sXHJcbiAgICByZWNvcmRTaGFyZTpmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnJlY29yZElkKXtcclxuICAgICAgICAgICAgdmFyIHNoYXJlVGl0bGUgPSBcIlvlpKfkvJfljYHkuInmsLRd5oiY57upXCI7XHJcbiAgICAgICAgICAgIHZhciByb29tSWQgPVwi5oi/6Ze05Y+377yaXCIrdGhpcy5fZGVza0luZm8ucm9vbUlkO1xyXG4gICAgICAgICAgICB2YXIgcGogPSBbXCI1IFwiLFwiMTAgXCIsXCIyMCBcIl07ICAvL+eJjOWxgFxyXG4gICAgICAgICAgICB2YXIganMgPSBcIuWxgOaVsO+8mlwiK3BqW3RoaXMuX2Rlc2tJbmZvLnNldHRpbmcxLTJdO1xyXG4gICAgICAgICAgICB2YXIgdGltZSA9IFwi5pe26Ze077yaXCIrdGhpcy5fZGVza0luZm8uY3JlYXRlVGltZSA7XHJcbiAgICAgICAgICAgIHZhciBkZXNjID0gcm9vbUlkK2pzK3RpbWUrXCLngrnlh7vmn6XnnIvor6bmg4VcIjtcclxuXHJcbiAgICAgICAgICAgIHZhciByZWNvcmRJZCA9IHRoaXMuX2Rlc2tJbmZvLnJlY29yZElkO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJzaGFyZVRpdGxlXCIsc2hhcmVUaXRsZSk7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImRlc2NcIixkZXNjKTtcclxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicmVjb3JkSWRcIixyZWNvcmRJZCk7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInJvb21JZFwiLCcnKTtcclxuXHJcbiAgICAgICAgICAgIHNUaXRsZSA9IHNoYXJlVGl0bGU7XHJcbiAgICAgICAgICAgIHNEZXNjcmlwdGlvbiA9IGRlc2M7XHJcbiAgICAgICAgICAgIHNJZCA9ICdyb29tSWQ9Jytyb29tSWQ7XHJcbiAgICAgICAgICAgIGlmKHJlY29yZElkKXtcclxuICAgICAgICAgICAgICAgIHNJZCA9ICdyZWNvcmRJZD0nK3JlY29yZElkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZihjYy5zeXMuaXNCcm93c2VyKXtcclxuICAgICAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvVGltZUxpbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1Nlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1Nlc3Npb24oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgICBjYy5maW5kKFwiQ2FudmFzL3NoYXJlQmdcIikuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTY3JlZW5TaGFyZUZyaWVuZFwiLCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgICAgICBLUU5hdGl2ZUludm9rZS5zY3JlZW5zaG90U2hhcmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyDngrnlh7vmoYzpnaLliIbkuqtcclxuICAgIGNsaWNrRGVza1NoYXJlIDpmdW5jdGlvbigpe1xyXG4gICAgICAgIC8vdGhpcy5fZ2xvYmFsTXNnKHRoaXMuX2Rlc2tJbmZvKTtcclxuICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcclxuICAgICAgICAgICAgdmFyIHNoYXJlQmcgPSBjYy5maW5kKFwiQ2FudmFzL3NoYXJlQmdcIik7IFxyXG4gICAgICAgICAgICBzaGFyZUJnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vdmFyIHd4QmcgPSB0aGlzLnNoYXJlQmcuZ2V0Q2hpbGRCeU5hbWUoXCJ3eFwiKTtcclxuICAgICAgICAgICAgLy92YXIgcHlxQmcgPSB0aGlzLnNoYXJlQmcuZ2V0Q2hpbGRCeU5hbWUoXCJQWVFcIik7XHJcbiAgICAgICAgICAgIC8vd3hCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL3B5cUJnLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL3RoaXMuc2hhcmVCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaWQ9c0lkO1xyXG4gICAgICAgIHZhciB0aXRsZSA9IHNUaXRsZTtcclxuICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBzRGVzY3JpcHRpb247XHJcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNoYXJlRnJpZW5kOmRlc2NyaXB0aW9uOlwiLGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZFxyXG4gICAgICAgICAgICB2YXIgc3RyID0gXCIoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVZcIjtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVGcmllbmRcIixzdHIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v54K55Ye75YiG5Lqr5oyJ6ZKuXHJcbiAgICBjbGlja1NoYXJlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy90aGlzLl9nbG9iYWxNc2codGhpcy5fZGVza0luZm8pO1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICB2YXIgd3hCZyA9IHRoaXMuc2hhcmVCZy5nZXRDaGlsZEJ5TmFtZShcInd4XCIpO1xyXG4gICAgICAgICAgICB2YXIgcHlxQmcgPSB0aGlzLnNoYXJlQmcuZ2V0Q2hpbGRCeU5hbWUoXCJQWVFcIik7XHJcbiAgICAgICAgICAgIHd4QmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgcHlxQmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuc2hhcmVCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaWQ9c0lkO1xyXG4gICAgICAgIHZhciB0aXRsZSA9IHNUaXRsZTtcclxuICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBzRGVzY3JpcHRpb247XHJcblxyXG4gICAgICAgIC8vIGxldCByb29tSWQgPSBTdHJpbmcodGhpcy5fZGVza0luZm8ucm9vbUlkKTtcclxuICAgICAgICAvLyB2YXIgZGVzY3JpcHRpb24gPSBcIuWkp+S8l+WNgeS4ieawtCDnjqnms5U6XCJcclxuICAgICAgICAvLyBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uICsgXCIgXCIgKyB0aGlzLl9kZXNrSW5mb051bWJlck9mUGVvcGxlKCk7XHJcbiAgICAgICAgLy8gZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbiArIFwiLFwiICsgdGhpcy5fZGVza0luZm9QYXlJbmZvKCk7XHJcbiAgICAgICAgLy8gZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbiArIFwiIFwiICsgdGhpcy5fZGVza0luZm9OdW1iZXJPZkdhbWUoKTtcclxuXHJcblxyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUZyaWVuZDpkZXNjcmlwdGlvbjpcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcclxuICAgICAgICAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlRnJpZW5kXCIsc3RyLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy/liIbkuqvliLDmnIvlj4vlnIhcclxuICAgIHNoYXJlSGFsbFRpbWVsaW5lOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgIHZhciB3eEJnID0gdGhpcy5zaGFyZUJnLmdldENoaWxkQnlOYW1lKFwid3hcIik7XHJcbiAgICAgICAgICAgIHZhciBweXFCZyA9IHRoaXMuc2hhcmVCZy5nZXRDaGlsZEJ5TmFtZShcIlBZUVwiKTtcclxuICAgICAgICAgICAgd3hCZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgcHlxQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5zaGFyZUJnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHZhciBpZD1zSWQ7XHJcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IHNUaXRsZTtcclxuICAgICAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gc0Rlc2NyaXB0aW9uO1xyXG5cclxuICAgICAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgICAgICB2YXIgc3RyID0gXCIoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVZcIjtcclxuICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsIHN0cixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvL+eCueWHu+WHhuWkh+aMiemSrlxyXG4gICAgY2xpY2tSZWFkeTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xyXG4gICAgICAgIFNvY2tldC5zZW5kUmVhZHkodGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/ngrnlh7vlvIDlp4vmjInpkq5cclxuICAgIGNsaWNrU3RhcnRHYW1lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIFNvY2tldC5zZW5kU3RhcnRHYW1lKHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZVJvb21OdW1iZXI6IGZ1bmN0aW9uIChyb29tTnVtYmVyKSB7XHJcbiAgICAgICAgbGV0IGdhbWVOdW1iZXJTdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSAhPSAwICYmIHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxICE9IDEpIHtcclxuICAgICAgICAgICAgZ2FtZU51bWJlclN0cmluZyA9IFwi5bGA5pWwIDogXCIgKyBcIlwiICsgdGhpcy5fZGVza0luZm8uY0luZGV4ICsgXCIvXCIgKyB0aGlzLl9kZXNrSW5mby5tTWF4O1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fZGVza0luZm8uc2V0dGluZzEgPT0gMCkge1xyXG4gICAgICAgICAgICBnYW1lTnVtYmVyU3RyaW5nID0gXCLlsYDmlbAgOiAxMOWxgFwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fZGVza0luZm8uc2V0dGluZzEgPT0gMSkge1xyXG4gICAgICAgICAgICBnYW1lTnVtYmVyU3RyaW5nID0gXCLlsYDmlbAgOiAyMOWxgFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxhYmVsUm9vbU51bWJlci5zdHJpbmcgPSBcIuaIv+WPtyA6IFwiICsgXCJcIiArIHJvb21OdW1iZXIgKyBcIiAgICBcIiArIGdhbWVOdW1iZXJTdHJpbmc7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZUdhbWVTdGF0dXM6IGZ1bmN0aW9uIChzdGF0dXMgPSBHQU1FU1RBVFVTLldBSVRfUEVPUExFKSB7XHJcbiAgICAgICAgdGhpcy5fZ2FtZVN0YXR1cyA9IHN0YXR1cztcclxuXHJcbiAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IChzdGF0dXMgPT0gR0FNRVNUQVRVUy5XQUlUX1BFT1BMRSk7XHJcbiAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IChzdGF0dXMgPT0gR0FNRVNUQVRVUy5XQUlUX1JFQURZKTtcclxuICAgICAgICB0aGlzLmlzUmVhZHlTdGF0dXMoKTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2FtZVN0YXR1czogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9nYW1lU3RhdHVzO1xyXG4gICAgfSxcclxuICAgIGlzUmVhZHlTdGF0dXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZih0aGlzLl9wbGF5ZXJJbmZvcyAmJiB0aGlzLl9wbGF5ZXJJbmZvcy5sZW5ndGg+MCkge1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllckluZm8pe1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJbmZvU2VsZj1jYy5maW5kKCdDYW52YXMvcGxheVNlbGYvdXNlckluZm9TZWxmJyk7XHJcbiAgICAgICAgICAgICAgICBpZihwbGF5ZXJJbmZvLmlkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFwbGF5ZXJJbmZvLnJlYWR5U3RhdHVzICYmICF0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ICYmICFQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkgJiYgIVBsYXliYWNrLmluc3RhbmNlLmlzQ29udGFpblBsYXliYWNrRGF0YXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySW5mb1NlbGYuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldFJlYWR5Tm9kZVZpc2libGUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDApIHsvL+S4gOWxgOi/mOayoeW8gOWni1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMubGVuZ3RoIDwgdGhpcy5fZGVza0luZm8ubWF4TnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8ucGxheWVycy5sZW5ndGggPj0gMiAmJiB0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpey8v5piv5ZCm5piv5oi/5Li7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIXRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJbmZvU2VsZi5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheWVyQ29tcCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyQ29tcC5oaWRlUmVhZHlTdGF0dXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93KVxyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIuWHhuWkh+eKtuaAgS0tLS0tLS0tXCIpXHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93KSB7Ly9cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheWVyQ29tcCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllckNvbXAuaGlkZVJlYWR5U3RhdHVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBpc0dhbWVTdGFydDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gMCkgey8v5LiA5bGA6L+Y5rKh5byA5aeLXHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHRoaXMuX3VzZXJJZCl7Ly/mmK/lkKbmmK/miL/kuLtcclxuICAgICAgICAgICAgICAgIGlmKCF0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ICYmICFQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKClcclxuICAgICAgICAgICAgICAgICAgICAmJiAhUGxheWJhY2suaW5zdGFuY2UuaXNDb250YWluUGxheWJhY2tEYXRhcygpICYmIHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMubGVuZ3RoID49IDIpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5wbGF5ZXJzLmxlbmd0aCA8IHRoaXMuX2Rlc2tJbmZvLm1heE51bWJlcil7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8vIOa4uOaIj+WKqOeUu1xyXG4gICAgX3N0YXJ0R2FtZTogZnVuY3Rpb24gKHBsYXlNdXNpYykge1xyXG5cclxuICAgICAgICBpZiAodGhpcy5nYW1lU3RhdHVzKCkgPT0gR0FNRVNUQVRVUy5QTEFZSU5HKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy90aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgICAgLy90aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy99KTtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5yZXNldCgpOyAgLy8jIyMjI1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLmhpZGVSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMudGVTaHVQYWkuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG5cclxuICAgICAgICB0aGlzLnBsYXlzQ29pbnMuZm9yRWFjaChmdW5jdGlvbihubyl7aWYobm8pIG5vLnJlbW92ZUFsbENoaWxkcmVuKCk7fSk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5cyxpKXtcclxuXHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gXCJjb2luc1wiICsgaTtcclxuXHJcbiAgICAgICAgICAgIHZhciBub2RlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKG5hbWUpO1xyXG5cclxuICAgICAgICAgICAgaWYobm9kZSl7XHJcbiAgICAgICAgICAgICAgICBub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICAvLyBjYy5sb2codGhpcy5ub2RlKVxyXG4gICAgICAgIC8vIGNjLmxvZygnLS0tLS0tNzA5JylcclxuICAgICAgICB0aGlzLl91cGRhdGVVc2VySW5mb3ModGhpcy5fcGxheWVySW5mb3MpO1xyXG4gICAgICAgIHRoaXMuc2hvd0NvbXBhcmVDYXJkKCk7XHJcbiAgICAgICAgdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy51cGRhdGVHYW1lU3RhdHVzKEdBTUVTVEFUVVMuUExBWUlORyk7XHJcbiAgICAgICAgdGhpcy5fcGxheUZhUGFpQW5pbWF0aW9uKHBsYXlNdXNpYyk7XHJcblxyXG4gICAgICAgIGxldCBjYXJkVHlwZUNvbWJpbmUgPSB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZUNvbWJpbmUnKTtcclxuXHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnJlc2V0KCk7XHJcblxyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAoIVVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodGhpcy5fdXNlcklkKSkpIHtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcImFuaW1hdGlvblwiKS5mYXBhaUFuaW1hdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zaG93Q2FyZFR5cGVDb21iaW5lKCk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgMS45KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfcGxheUZhUGFpQW5pbWF0aW9uOiBmdW5jdGlvbiAocGxheU11c2ljKSB7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpe1xyXG4gICAgICAgICAgICBwbGF5ZXIucGxheUZhUGFpQW5pbWF0aW9uKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYocGxheU11c2ljKXtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlGYVBhaSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjIyovXHJcbiAgICAvL+aYr+WQpueJueauiueJjFxyXG4gICAgaXNUZVNodVBhaTogZnVuY3Rpb24oY2FyZHMpe1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNUZVNodVBhaShjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzVGVTaHVQYWkgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNUZVNodVBhaSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5LiA5p2h6b6ZXHJcbiAgICBpc1lpVGlhb0xvbmc6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1lpVGlhb0xvbmcoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1lpVGlhb0xvbmcgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNZaVRpYW9Mb25nID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKblha3lr7nljYpcclxuICAgIGlzTGl1RHVpQmFuOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNMaXVEdWlCYW4oY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc0xpdUR1aUJhbiA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc0xpdUR1aUJhbiA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuS4iemhuuWtkFxyXG4gICAgaXNTYW5TaHVuWmk6IGZ1bmN0aW9uKGNhcmRzKXtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzU2FuU2h1blppKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5TaHVuWmkgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5TaHVuWmkgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbkuInlkIzoirFcclxuICAgIGlzU2FuVG9uZ0h1YTogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzU2FuVG9uZ0h1YShjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuVGFvSHVhID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuVGFvSHVhID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5LiJ5ZCM6Iqx6aG6XHJcbiAgICBpc1NhblRvbmdIdWFTaHVuOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNTYW5Ub25nSHVhU2h1bihjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuVG9uZ0h1YVNodW4gPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5Ub25nSHVhU2h1biA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuaYr+a4hem+mVxyXG4gICAgaXNRaW5nTG9uZzogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzUWluZ0xvbmcoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1FpbmdMb25nID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzUWluZ0xvbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmK8g4oCc5LiJ5YiG5aSp5LiL4oCdXHJcbiAgICBpc1NhbkZlblRpYW5YaWE6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1NhbkZlblRpYW5YaWEoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhbkZlblRpYW5YaWEgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5GZW5UaWFuWGlhID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5pivIOKAnOWbm+Wll+S4ieadoeKAnVxyXG4gICAgaXNTaVRhb1NhblRpYW86IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1NpVGFvU2FuVGlhbyhjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2lUYW9TYW5UaWFvID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2lUYW9TYW5UaWFvID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5piv5LqU5a+55LiJ5p2hXHJcbiAgICBpc1d1RHVpU2FuVGlhbzogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzV3VEdWlTYW5UaWFvKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNXdUR1aVNhblRpYW8gPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNXdUR1aVNhblRpYW8gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmK/lh5HkuIDoibJcclxuICAgIGlzQ291WWlTZTogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzQ291WWlTZShjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzQ291WWlTZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc0NvdVlpU2UgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyojIyMjIyovXHJcblxyXG4gICAgLyrmmL7npLrphY3niYzpobXpnaIqL1xyXG4gICAgX3Nob3dDYXJkVHlwZUNvbWJpbmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zdGFydENvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9IG51bGw7XHJcblxyXG4gICAgICAgIGxldCBjYXJkVHlwZUNvbWJpbmUgPSB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZUNvbWJpbmUnKTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUucmVzZXQoKTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUucmVsb2FkQ2FyZHMoW10pO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnRpbWVTdGFydCg2MCk7XHJcbiAgICAgICAgdGhpcy50aW1lU3RhcnQoNjAsXCJcIik7XHJcbiAgICAgICAgdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLnNjYWxlID0gMTtcclxuXHJcbiAgICAgICAgbGV0IGNhcmRzID0gdGhpcy5fZmluZENhcmRzQnlVc2VySWQodGhpcy5fdXNlcklkKTtcclxuICAgICAgICAvL1wiMV85XCJcIjNfOVwiXCIyXzlcIlxyXG4gICAgICAgIC8vIFwiMl83XCJcIjFfN1wiXCIzXzNcIlwiMl8xMlwiXHJcbiAgICAgICAgLy9cIjFfMVwiXCIxXzNcIlwiMl82XCJcIjFfMTFcIlwiMl8xXCJcIjNfNFwiLy9cclxuICAgICAgICAvLyBpZih0aGlzLl91c2VySWQgPT0gMil7XHJcbiAgICAgICAgLy8gICAgIGNhcmRzID0gW3tzdWl0OiBcImRcIiwgbnVtYmVyOjJ9LHtzdWl0OiBcImRcIiwgbnVtYmVyOjJ9LCB7c3VpdDogXCJkXCIsIG51bWJlcjoyfSwvL+mdkum+mVxyXG5cclxuICAgICAgICAvLyAgICAgICAgIHtzdWl0OiBcImhcIiwgbnVtYmVyOjJ9LCB7c3VpdDogXCJkXCIsIG51bWJlcjoyfSxcclxuICAgICAgICAvLyAgICAgICAgIHtzdWl0OiBcImNcIiwgbnVtYmVyOjN9LCB7c3VpdDogXCJjXCIsIG51bWJlcjozfSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6M30sXHJcblxyXG4gICAgICAgIC8vICAgICAgICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6M30sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjR9LFxyXG4gICAgICAgIC8vICAgICAgICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6NH0sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjR9LCB7c3VpdDogXCJkXCIsIG51bWJlcjo0fV07XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIC8vaWYodGhpcy5fdXNlcklkID09IDEpe2RcclxuICAgICAgICAvLyAgICBjYXJkcyA9IFt7c3VpdDogXCJjXCIsIG51bWJlcjoxfSx7c3VpdDogXCJoXCIsIG51bWJlcjoxfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MX0sLy/pnZLpvplcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJoXCIsIG51bWJlcjo4fSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6Mn0sXHJcbiAgICAgICAgLy8gICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjh9LCB7c3VpdDogXCJoXCIsIG51bWJlcjo4fSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6MjB9LFxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJoXCIsIG51bWJlcjo5fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6OX0sXHJcbiAgICAgICAgLy8gICAgICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjl9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo5fSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6OX1dO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vIGVsc2UgaWYodGhpcy5fdXNlcklkID09IDYpe1xyXG4gICAgICAgIC8vICAgICBjYXJkcyA9IFt7c3VpdDogXCJkXCIsIG51bWJlcjoxMX0se3N1aXQ6IFwiZFwiLCBudW1iZXI6MTN9LCB7c3VpdDogXCJkXCIsIG51bWJlcjoxMX0sLy/pnZLpvplcclxuICAgICAgICAvLyAgICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjF9LCB7c3VpdDogXCJkXCIsIG51bWJlcjoxfSxcclxuICAgICAgICAvLyAgICAgICAgIHtzdWl0OiBcImhcIiwgbnVtYmVyOjJ9LCB7c3VpdDogXCJoXCIsIG51bWJlcjo0fSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6OX0sXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJzXCIsIG51bWJlcjo3fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6N30sXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJzXCIsIG51bWJlcjo1fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6NX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjV9LF07XHJcbiAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fdXNlcklkID09IDMpe1xyXG4gICAgICAgIC8vICAgIGNhcmRzID0gW3tzdWl0OiBcImRcIiwgbnVtYmVyOjR9LHtzdWl0OiBcImRcIiwgbnVtYmVyOjEzfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MTN9LC8v6Z2S6b6ZXHJcbiAgICAgICAgLy8gICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjZ9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo3fSxcclxuICAgICAgICAvLyAgICAgICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6OH0sIHtzdWl0OiBcImNcIiwgbnVtYmVyOjl9LCB7c3VpdDogXCJjXCIsIG51bWJlcjoxMH0sXHJcbiAgICAgICAgLy8gICAgICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjF9LCB7c3VpdDogXCJzXCIsIG51bWJlcjozfSxcclxuICAgICAgICAvLyAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6MTB9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo4fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MTJ9LF07XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgY2MubW9zaGkgPSAwO1xyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBjYXJkcy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgIHZhciBzID0gY2FyZHNbaV0ubnVtYmVyO1xyXG4gICAgICAgICAgICBpZihzID49IDIwKXtcclxuICAgICAgICAgICAgICAgIGNjLm1vc2hpID0gMTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBjYXJkTmFtZXMgPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnJlbG9hZENhcmRzKGNhcmROYW1lcyk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLmFkZENhcmRNb2RlcyhjYXJkTmFtZXMpO1xyXG5cclxuICAgICAgICAvL2NjLmZyb20ubW9zaGkgPT0gMOmAieaLqeS6huW6hOWutuaooeW8j1xyXG5cclxuICAgICAgICBpZihjYy5tb3NoaSAhPSAxKXtcclxuICAgICAgICAgICAgdGhpcy5pc1RlU2h1UGFpKGNhcmRzKTtcclxuICAgICAgICAgICAgdGhpcy5pc1FpbmdMb25nKGNhcmRzKTtcclxuICAgICAgICAgICAgdGhpcy5pc1lpVGlhb0xvbmcoY2FyZHMpO1xyXG4gICAgICAgICAgICB0aGlzLmlzTGl1RHVpQmFuKGNhcmRzKTtcclxuICAgICAgICAgICAgdGhpcy5pc1NhblNodW5aaShjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNTYW5Ub25nSHVhKGNhcmRzKTtcclxuICAgICAgICAgICAgaWYoVEVTSFVQQUlUWVBFLmlzVGVTaHVQYWkpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLnNjYWxlID0gMDtcclxuICAgICAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXMuZ29uZ1hpTmkuZ2V0Q2hpbGRCeU5hbWUoXCJiZ1wiKTtcclxuICAgICAgICAgICAgICAgIG5vZGVzLm9wYWNpdHkgPSAyNDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy90aGlzLmlzU2FuVG9uZ0h1YVNodW4oY2FyZHMpO1xyXG4gICAgICAgICAgICAvL3RoaXMuaXNTYW5GZW5UaWFuWGlhKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzU2lUYW9TYW5UaWFvKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzV3VEdWlTYW5UaWFvKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzQ291WWlTZShjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dHb25nWGlOaUFuZEJ0blRlU2h1UGFpKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5jYWNsZUF1dG9TZWxlY3RlZENhcmRzMigpO1xyXG5cclxuICAgICAgICBpZihjYy5tb3NoaSA9PSAxKSBjYy50ZVNodVBhaUNhcmRzID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5yZXNldCgpOyAgLy8jIyMjI1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLmhpZGVSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRJc1RlU2h1UGFpOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgdmFyIGNhcmRzID0gdGhpcy5fZmluZENhcmRzQnlVc2VySWQodXNlcklkKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5pc1RlU2h1UGFpKGNhcmRzKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjI+ajgOa1i+eJueauiueJjOexu+Wei++8jOaYvuekuuebuOWvueW6lOeahOaBreWWnOS9oOmhtemdouWSjOeJueauiueJjOeyvueBtSovXHJcbiAgICBfc2hvd0dvbmdYaU5pQW5kQnRuVGVTaHVQYWk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvKuWmguaenOacieeJueauiueJjCovXHJcbiAgICAgICAgaWYoVEVTSFVQQUlUWVBFLmlzVGVTaHVQYWkpe1xyXG4gICAgICAgICAgICBpZihURVNIVVBBSVRZUEUuaXNRaW5nTG9uZyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSwgXCLlkIzoirHljYHkuInmsLRcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zYW5Ub25nSHVhID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1lpVGlhb0xvbmcpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUsIFwi5Y2B5LiJ5rC0XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5feWlUaWFvTG9uZyA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihURVNIVVBBSVRZUEUuaXNMaXVEdWlCYW4pe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUsIFwi5YWt5a+55Y2KXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbGl1RHVpQmFuID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1NhblNodW5aaSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSwgXCLkuInpobrlrZBcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zYW5TaHVuWmkgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYoVEVTSFVQQUlUWVBFLmlzU2FuVGFvSHVhKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlLCBcIuS4ieWQjOiKsVwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NhblRvbmdIdWEgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTYW5Ub25nSHVhU2h1bil7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fU2FuVG9uZ0h1YVNodW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1NhbkZlblRpYW5YaWEpe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX1NhbkZlblRpYW5YaWEgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc0NvdVlpU2Upe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX0NvdVlpU2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1NpVGFvU2FuVGlhbyl7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fU2lUYW9TYW5UaWFvID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNXdUR1aVNhblRpYW8pe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX1d1RHVpU2FuVGlhbyA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvL3RoaXMuX2luaXRUZVNodVBhaVNwcml0ZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMj5o6n5Yi254m55q6K54mM57K+54G155qE5pi+56S6Ki9cclxuICAgIF9pbml0VGVTaHVQYWlTcHJpdGU6ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8q5oqK5omA5pyJ55qE54m55q6K54mM57K+54G16YO96ZqQ6JeP5o6JKi9cclxuICAgICAgICAvL2Zvcih2YXIgaT0wO2k8dGhpcy50ZXNodXBhaV9taW4ubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5baV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbaV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4gOadoem+me+8jOWwseaYvuekuuS4gOadoem+meeahOeyvueBtSovXHJcbiAgICAgICAgLy9pZih0aGlzLl95aVRpYW9Mb25nKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pblszXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzNdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+WFreWvueWNiuWwseaYvuekuuWFreWvueWNiueahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX2xpdUR1aUJhbil7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bMF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFswXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuInpobrlrZDlsLHmmL7npLrkuInpobrlrZDnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9zYW5TaHVuWmkpe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbMV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fc2FuVG9uZ0h1YSl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bMl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFsyXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9RaW5nTG9uZyl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bNF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFs0XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfV9nb25nWGlOaVNob3dcclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fU2FuVG9uZ0h1YVNodW4pe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzVdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbNV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fU2FuRmVuVGlhblhpYSl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bNl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFs2XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9Db3VZaVNlKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pbls3XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzddLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX1NpVGFvU2FuVGlhbyl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bOF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFs4XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9XdUR1aVNhblRpYW8pe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbOV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjIyovXHJcbiAgICAvL+aYvuekumdvbmdYaU5pIOmhtemdouWSjHRlU2h1UGFpXHJcbiAgICBjbGlja0dvbmdYaU5pU2hvdzpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLnNjYWxlID0gMTtcclxuICAgICAgICB2YXIgbm9kZXMgPSB0aGlzLmdvbmdYaU5pLmdldENoaWxkQnlOYW1lKFwiYmdcIik7XHJcbiAgICAgICAgbm9kZXMub3BhY2l0eSA9IDA7XHJcbiAgICB9LFxyXG5cclxuICAgIF9nb25nWGlOaVNob3c6ZnVuY3Rpb24gKHN0YXR1ZXMsIHRlc3QgPSBcIlwiKSB7XHJcbiAgICAgICAgLy92YXIgYWx0ZXJDb20gPSB0aGlzLmdvbmdYaU5pLmdldENvbXBvbmVudChcImFsZXJ0XCIpO1xyXG4gICAgICAgIGxldCBhbHRlckNvbSA9IHRoaXMuZ29uZ1hpTmkuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIGFsdGVyQ29tLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICB0ZXN0ID0gXCLmmK/lkKbmjInnibnmrorniYzlnotbXCIgKyB0ZXN0ICsgXCJd5Ye654mM77yfXCIgK1wiXFxuXCIrIFwiKOWPlua2iOWQjueCueWHu+W3puS4i+inkuWPr+WGjeaKpemBkylcIjtcclxuICAgICAgICBhbHRlckNvbS5zZXRNZXNzYWdlKHRlc3QpO1xyXG4gICAgICAgIGlmKHN0YXR1ZXMpe1xyXG4gICAgICAgICAgICBhbHRlckNvbS5hbGVydCgpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBhbHRlckNvbS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudGVTaHVQYWkuYWN0aXZlID0gc3RhdHVlcztcclxuICAgICAgICB2YXIgbm9kZXMgPSB0aGlzLnRlU2h1UGFpLmdldENoaWxkQnlOYW1lKFwiYnRuVGVzaHVwYWlcIik7XHJcbiAgICAgICAgbm9kZXMuY2hpbGRyZW5bMF0ucnVuQWN0aW9uKGNjLnJlcGVhdEZvcmV2ZXIoY2Mucm90YXRlQnkoMSwgLTM2MCkpKTtcclxuICAgICAgICBub2Rlcy5jaGlsZHJlblsxXS5ydW5BY3Rpb24oY2MucmVwZWF0Rm9yZXZlcihjYy5yb3RhdGVCeSgxLCAzNjApKSk7XHJcbiAgICB9LFxyXG4gICAgLyojIyMjIyovXHJcblxyXG4gICAgLy8gIOe7k+aenOebuOWFs1xyXG4gICAgLy8g5pi+56S65LiA5bGA57uT5p6cXHJcbiAgICBfc2hvd09uZUdhbWVSZXN1bHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyA9IGZhbHNlO1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgICB0aGlzLnVwZGF0ZUdhbWVTdGF0dXMoR0FNRVNUQVRVUy5XQUlUX1BFT1BMRSk7XHJcbiAgICAgICAgLy9sZXQgb25lR2FtZVJlc3VsdCA9IHRoaXMub25lR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ0dhbWVSZXN1bHQnKTtcclxuICAgICAgICAvL29uZUdhbWVSZXN1bHQudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIC8vb25lR2FtZVJlc3VsdC5zaG93UmVzdWx0cyh0aGlzLl9kZXNrSW5mbywgdGhpcy5fdXNlcklkKTtcclxuICAgICAgICB0aGlzLl91cGRhdGVVc2VyU2NvcmVzKCk7XHJcbiAgICAgICAgLy90aGlzLl91cGRhdGVCYW5rZXIoKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy9zZWxmLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgICAgLy8gIC8vcGxheWVyQ29tcC5yZXNldCgpO1xyXG4gICAgICAgICAgICAvLyAgLy9wbGF5ZXJDb21wLnJlc2V0MigpOyAgLy8jIyMjI1xyXG4gICAgICAgICAgICAvL30pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFzZWxmLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgICAgICAgICAgICAgLy9pZiAoc2VsZi5fZGVza0luZm8uY0luZGV4ID09IDApIHsvL+S4gOWxgOi/mOayoeW8gOWni1xyXG4gICAgICAgICAgICAgICAgLy8gICAgc2VsZi5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLl9pc1RvdGFsR2FtZU92ZXIoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3Nob3dUb3RhbEdhbWVSZXN1bHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIDAuNSk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9pc1JhbmRvbVJvb20oKSB8fCBQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgb25lR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICAgIH0sIDIpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaYvuekuuaAu+e7k+aenFxyXG4gICAgX3Nob3dUb3RhbEdhbWVSZXN1bHQ6IGZ1bmN0aW9uIChzaG93RGVsYXkgPSAyKSB7XHJcbiAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xyXG4gICAgICAgIC8vY2MuZmluZChcIkNhbnZhcy9zaG93X3Jlc3VsdFwiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gdGhpcy5fZGVza0luZm8ubU1heCl7XHJcbiAgICAgICAgICAgIHRoaXMuYWdhaW5CdG4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5hZ2FpbkJ0bi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCB0b3RhbEdhbWVSZXN1bHRDb21wID0gdGhpcy50b3RhbEdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdUb3RhbEdhbWVSZXN1bHQnKTtcclxuICAgICAgICBpZiggdG90YWxHYW1lUmVzdWx0Q29tcC5ub2RlLmFjdGl2ZSApe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfSBcclxuXHJcbiAgICAgICAgaWYodGhpcy5fYmlnUmVjb3JkSW5mbyA9PSBudWxsKXtcclxuICAgICAgICAgICAgdGhpcy5fYmlnUmVjb3JkSW5mbyA9IHRoaXMuX2Rlc2tJbmZvLnBsYXllcnM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRvdGFsR2FtZVJlc3VsdENvbXAuc2V0UGxheWVySW5mb3ModGhpcy5fYmlnUmVjb3JkSW5mbywgdGhpcy5fZGVza0luZm8pO1xyXG5cclxuICAgICAgICBsZXQgYWxlcnQgPSB0aGlzLnRvdGFsR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvL3RoaXMub25lR2FtZVJlc3VsdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy9hbGVydC5hbGVydCgpO1xyXG4gICAgICAgICAgICAvKiovXHJcbiAgICAgICAgICAgIGlmICghdGhpcy50b3RhbEdhbWVSZXN1bHQuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydC5hbGVydCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8qKi9cclxuICAgICAgICB9LmJpbmQodGhpcyksIHNob3dEZWxheSk7XHJcblxyXG4gICAgICAgIGFsZXJ0LnNldERpc21pc3NDYWxsYmFjayhmdW5jdGlvbiAoKXtcclxuICAgICAgICAgICAgU29ja2V0LnNlbmRPbmNlQWdhaW4oJ2ZhbHNlJyx0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICAvL2NjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIGNsaWNrQWdhaW46ZnVuY3Rpb24oKXtcclxuICAgICAgICBTb2NrZXQuc2VuZE9uY2VBZ2FpbigndHJ1ZScsdGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gTUFSSzogU29ja2V0IOebuOWFs1xyXG4gICAgX2xvYWREZXNrSW5mbzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIFNvY2tldC5zZW5kR2V0RGVzY2tJbmZvKHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG4gICAgX3JlZ2lzdGVyU29ja2V0RXZlbnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlRGVza0luZm8sIHRoaXMuX3NvY2tldFJlY2VpdmVEZXNrSW5mbywgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZU9ubGluZVN0YXR1cywgdGhpcy5fc29ja2V0UmVjaXZlT25saW5lU3RhdHVzLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlQ2hhdFRleHQsIHRoaXMuX3NvY2tldFJlY2l2ZUNoYXRUZXh0TWVzc2FnZSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUNoYXRFbW9qaSwgdGhpcy5fc29ja2V0UmVjaXZlQ2hhdEVtb2ppTWVzc2FnZSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVJlcXVlc3REaXNzb2x2ZSwgdGhpcy5fc29ja2V0UmVjZWl2ZVJlcXVlc3RFeGl0TWVzc2FnZSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVJlcXVlc3REaXNzb2x2ZVJlc3VsdCwgdGhpcy5fc29ja2V0UmVjZWl2ZVJlcXVlc3RFeGl0UmVzdWx0TWVzc2FnZSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUF1ZGlvTWVzc2FnZSwgdGhpcy5fc29ja2V0UmVjZWl2ZUF1ZGlvTWVzc2FnZSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVBsYXlDYXJkLCB0aGlzLl9zb2NrZXRSZWNlaXZlUGxheUNhcmQsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVHYW1lT3ZlciwgdGhpcy5fc29ja2V0UmVjZWl2ZUdhbWVPdmVyLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlRmFQYWksIHRoaXMuX3NvY2tldFJlY2l2ZUZhUGFpLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlUmVhZHksIHRoaXMuX3NvY2tldFJlY2l2ZVJlYWR5LCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlRGlzc29sdmVEZXNrLCB0aGlzLl9zb2NrZXRSZWNlaXZlRGlzc29sdmVEZXNrLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlTGVhdmVEZXNrLCB0aGlzLl9zb2NrZXRMZWF2ZURlc2ssIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlNvY2tldERpc2Nvbm5lY3QsIHRoaXMuX3JlY2VpdmVTb2NrZXRDb25uZWN0RXJyb3IsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RTdWNjZXNzZWQsIHRoaXMuX3JlY2VpdmVTb2NrZXRDb25uZWN0U3VjY2Vzc2VkLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlUGF1c2UsIHRoaXMuX3NvY2tldFJlY2VpdmVQYXVzZSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVNlbGVjdEJlaUx2LCB0aGlzLl9SZWNlaXZlU2VsZWN0QmVpTHYsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVCZWlMdiwgdGhpcy5fUmVjZWl2ZUJlaUx2LCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlUWluZ0xpLCB0aGlzLl9SZWNlaXZlUWluZ0xpLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlT25jZUFnYWluLCB0aGlzLl9SZWNlaXZlT25jZUFnYWluLCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgX1JlY2VpdmVPbmNlQWdhaW46ZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWGjeadpeS4gOWxgFxyXG4gICAgICAgICAqIOaAu+e7k+aenOimgemakOiXj+aOiVxyXG4gICAgICAgICAqIOavlOeJjOimgemakOiXj+aOiVxyXG4gICAgICAgICAqIOWPkeeJjOimgeaYvuekulxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX3BsYXllZENvbXBhcmVDYXJkc0luZGV4cyA9IFtdO1xyXG4gICAgICAgIHRoaXMucGxheWVyQ29tcHMuZm9yRWFjaChwbGF5ZXJDb21wID0+IHtcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMgPSB0aGlzLl9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHM7XHJcbiAgICB9KTtcclxuICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgaWYoIWRhdGEucmVhc29uKXtcclxuICAgICAgICAgICAgdGhpcy50b3RhbEdhbWVSZXN1bHQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRDb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTsgIC8vIyMjIyNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3NvY2tldFJlY2VpdmVEZXNrSW5mbyhyZXNwb25zZSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHZhciBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICBpZihub3cgLSB0aGlzLl9ub3dUaW1lQWdhaW4gPiAxNTAwKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25vd1RpbWVBZ2FpbiA9IG5vdztcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdFJlc3VsdC55ID0gLTE0MztcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdFJlc3VsdC5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0LmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gJ+aIv+WNoeS4jei2syc7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gY2Muc3Bhd24oY2MubW92ZVRvKDAuMywgY2MucCgwLCAyMCkpLCBjYy5mYWRlT3V0KDAuMykpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0LnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMSwgY2MucCgwLCAwKSksIGFjdGlvbikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgX1JlY2VpdmVTZWxlY3RCZWlMdjpmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkICE9IHRoaXMuX3VzZXJJZCl7XHJcbiAgICAgICAgICAgIHRoaXMuYmVpbHYuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdmFyIEIzID0gdGhpcy5iZWlsdi5nZXRDaGlsZEJ5TmFtZSgnYmcnKS5nZXRDaGlsZEJ5TmFtZSgnYnRuMycpLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xyXG4gICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nNT09MSl7XHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIOW6hOWutumAieaLqeS4pOWAjeeahOaXtuWAmSAz5YCN5oyJ6ZKu5piv5LiN6IO95ZON5bqU55qEXHJcbiAgICAgICAgICAgICAgICAgKiDpgInmi6nkuInlgI3kuI3nlKjnrqHvvIzlhajpg6jmmL7npLrvvIxcclxuICAgICAgICAgICAgICAgICAqIOmAieaLqeS4gOWAjeS5n+S4jeeUqOeuoe+8jOebtOaOpeWPkeeJjO+8jFxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBCMy5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgc2VsZWN0QmwgPSB0aGlzLmJlaWx2LmdldENvbXBvbmVudCgnc2VsZWN0QmVpbHYnKTtcclxuICAgICAgICAgICAgc2VsZWN0QmwuX3VzZXJpZCA9IHRoaXMuX3VzZXJpZDtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9SZWNlaXZlQmVpTHY6ZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAgIGxldCB1c2VySWQgPSByZXNwb25zZS5kYXRhLnVzZXJJZDtcclxuICAgICAgICBsZXQgYmwgPSByZXNwb25zZS5kYXRhLmJlaWx2O1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5zaG93QmVpbHYodXNlcklkLGJsKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX1JlY2VpdmVRaW5nTGk6ZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAgIHZhciBsZWF2ZUlkID0gcmVzcG9uc2UuZGF0YS5sZWF2ZUlkO1xyXG4gICAgICAgIGlmKGxlYXZlSWQgPT0gdGhpcy5fdXNlcklkKXtcclxuICAgICAgICAgICAgaWYoY2MucWluZ2xpID09IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgdmFyIHFsID0gcmVzcG9uc2UuYWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY2MucWluZ2xpID0gJyc7XHJcbiAgICAgICAgICAgICAgICBjYy5xaW5nbGkgPSBxbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjZWl2ZURlc2tJbmZvOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICBjYy5lcnJvcihcIumUmeivr++8mlwiLCByZXNwb25zZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG5cclxuICAgICAgICB0aGlzLl9pbml0UGxheWVyQ29tcG9uZW50cyhkYXRhLnBsYXllcnNJbmRleEF5eSk7XHJcbiAgICAgICAgLyojIyMjI+a3u+WKoOS6lOWQjOaMiemSriovXHJcbiAgICAgICAgLy8gY2MubW9zaGkgPSAwO1xyXG5cclxuICAgICAgICAvLyBpZihkYXRhLnNldHRpbmczWzFdID09IHRydWUpIGNjLm1vc2hpID0gMTsgIC8vICDvvJ/vvJ/vvJ9cclxuXHJcbiAgICAgICAgY2MubWFQYWkgPSBudWxsO1xyXG5cclxuICAgICAgICBpZihkYXRhLm1hUGFpLmxlbmd0aCA9PSAyKSBjYy5tYVBhaSA9IGRhdGEubWFQYWlbMF0gKyBcIl9cIiArIGRhdGEubWFQYWlbMV07XHJcblxyXG4gICAgICAgIGNjLmh1YVNlID0gZGF0YS5zZXR0aW5nM1syXTtcclxuXHJcbiAgICAgICAgY2MuY2hhb1NoaUNodVBhaSA9IGRhdGEuc2V0dGluZzY7XHJcblxyXG4gICAgICAgIGNjLmR1b1lpU2UgPSByZXNwb25zZS5kYXRhLnNldHRpbmcyOyAgIC8vc2V0dGluZzLkuLogNH43IOS6uu+8iDB+M++8iVxyXG5cclxuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5fZ2xvYmFsTXNnKGRhdGEpO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0R2FtZU92ZXJ2aWV3KHRoaXMuX2Rlc2tJbmZvKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVJvb21OdW1iZXIoZGF0YS5yb29tSWQpO1xyXG4gICAgICAgIHRoaXMubmVlZENhcmQuc3RyaW5nID0gIGRhdGEubmVlZENhcmQ7ICAgICAgICAgLy8g5byA5pS+6ZyA6KaB55qE5oi/5Y2hXHJcbiAgICAgICAgbGV0IHBsYXllckluZGV4cyA9IGRhdGEucGxheWVyc0luZGV4OyAgIC8vIFsxMDAwNDldXHJcbiAgICAgICAgdGhpcy5faW5qZWN0VXNlcklkVG9QbGF5ZXJDb21wb25lbnRzKHBsYXllckluZGV4cyk7XHJcblxyXG4gICAgICAgIGxldCBwbGF5ZXJzID0gZGF0YS5wbGF5ZXJzO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gcGxheWVycztcclxuICAgICAgICB0aGlzLl91cGRhdGVVc2VySW5mb3MocGxheWVycyk7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlclNjb3JlcygpO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZUJhbmtlcigpO1xyXG4gICAgICAgIHRoaXMuX21zZ0NvbnRyb2wuYWRkUGxheWVySW5mb3ModGhpcy5fcGxheWVySW5mb3MpO1xyXG5cclxuICAgICAgICBsZXQgY3VycmVudFVzZXJJbmZvID0gcGxheWVycy5maW5kKGZ1bmN0aW9uIChwbGF5ZXJJbmZvKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwbGF5ZXJJbmZvLmlkID09IHRoaXMuX3VzZXJJZDtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICBpZihkYXRhLmNyZWF0ZUlkID09IHRoaXMuX3VzZXJJZCl7XHJcbiAgICAgICAgICAgIGlmKGRhdGEuY0luZGV4PjApeyAgLy8g5byA5aeL5ri45oiP5LqG77yM6K+356a75oyJ6ZKu5YWo6YOo6ZqQ6JePXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHBsYXllci5zaG93UWluZ2xpKGZhbHNlLGRhdGEuY0luZGV4KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1lbHNleyAgICAgICAgICAgICAgLy8g5ri45oiP5rKh5byA5aeL77yM5oi/5Li755qE6K+356a75oyJ6ZKu5LiN5pi+56S6XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGRhdGEuY3JlYXRlSWQgPT0gcGxheWVyLnVzZXJJZCApeyAgLy8g5oiR5piv5oi/5Li777yM5LiN5pi+56S65oiR55qE6K+356a75oyJ6ZKuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5zaG93UWluZ2xpKHRydWUsZGF0YS5jSW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd1FpbmdsaShmYWxzZSxkYXRhLmNJbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgaWYoZGF0YS5jcmVhdGVJZCA9PSBwbGF5ZXIudXNlcklkKXsvL+aYvuekuuaIv+S4u1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLnNob3dGYW5nWmh1U3RhdHVzKGRhdGEuY3JlYXRlSWQsdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLnNob3dGYW5nWmh1U3RhdHVzKHBsYXllci51c2VySWQsZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCAhPSB0aGlzLl91c2VySWQgKXsgIC8vIOmdnuW6hOWutlxyXG4gICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gMCApeyAgICAgICAgICAgIC8vIOWmguaenOi/mOayoeW8gOWni+a4uOaIj++8jOaYvuekuumAgOWHuuaMiemSru+8jOmakOiXj+ino+aVo+aMiemSrlxyXG4gICAgICAgICAgICAgICAgdGhpcy5leGl0LmFjdGl2ZSA9ICB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5EaXNzb2x2ZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfWVsc2V7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlj43kuYtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXhpdC5hY3RpdmUgPSAgZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkRpc3NvbHZlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDluoTlrrZcclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY0luZGV4ID4gMCApeyAgICAgICAgICAgICAvLyDlvIDlsYDkuoYg6ZqQ6JeP6YCA5Ye65oyJ6ZKuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4aXQuYWN0aXZlID0gIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5EaXNzb2x2ZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmsqHlvIDlsYAg5Lik5Liq6YO95pi+56S6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4aXQuYWN0aXZlID0gIHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkRpc3NvbHZlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5fZGVza0luZm8uaXNDQmVnaW4pIHtcclxuICAgICAgICAgICAgdGhpcy5fZ2FtZVN0YXR1cyA9IEdBTUVTVEFUVVMuV0FJVF9SRUFEWTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yKHZhciBpPTA7aTxwbGF5ZXJzLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICB2YXIgcyA9IHBsYXllcnNbaV07XHJcbiAgICAgICAgICAgIHZhciBpcyA9IHMucmVhZHlTdGF0dXM7Ly90cnVlL2ZhbHNlXHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBzLmlkO1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICAgICAgaWYoIXRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luKSBwbGF5ZXIuc2hvd1JlYWR5U3RhdHVzKHVzZXJJZCxpcyk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjdXJyZW50VXNlckluZm8gJiYgY3VycmVudFVzZXJJbmZvLmNhcmRzLmxlbmd0aCA+IDAgJiYgdGhpcy5fZGVza0luZm8uaXNDQmVnaW4pIHtcclxuICAgICAgICAgICAgaWYoIWN1cnJlbnRVc2VySW5mby5jYXJkSW5mby5sZW5ndGgpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhcnRHYW1lKHRydWUpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0R2FtZShmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHMoY3VycmVudFVzZXJJbmZvKSAmJiAhdGhpcy5fZGVza0luZm8uaXNDQmVnaW4pIHtcclxuICAgICAgICAgICAgdGhpcy5fc29ja2V0UmVjZWl2ZUdhbWVPdmVyKHJlc3BvbnNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc1JlYWR5U3RhdHVzKCk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlVXBkYXRlRGVza0luZm9BYm91dEV4aXRSb29tKHRoaXMuX2Rlc2tJbmZvKTtcclxuICAgICAgICB0aGlzLnNob3dDb21wYXJlQ2FyZCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzaG93Q29tcGFyZUNhcmQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gMCB8fCB0aGlzLl9kZXNrSW5mby5pc0NCZWdpbiB8fFxyXG4gICAgICAgICAgICAhdGhpcy5fZGVza0luZm8ucGxheWVycyB8fCB0aGlzLl9kZXNrSW5mby5wbGF5ZXJzLmxlbmd0aCA8PSAwIHx8IHRoaXMuX2Rlc2tJbmZvLnBsYXllcnNbMF0uY2FyZEluZm8gPD0gMCl7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vKXtpZihubykgbm8ucmVtb3ZlQWxsQ2hpbGRyZW4oKTt9KTtcclxuXHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcblxyXG4gICAgICAgIHRoaXMubm9kZS5zdG9wQWxsQWN0aW9ucygpO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtwbGF5ZXJDb21wLnJlYWR5VG9Db21wYXJlQ2FyZHMoKTt9KTtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuXHJcbiAgICAgICAgICAgIGlmKHBsYXllci5ub2RlLmFjdGl2ZSlwbGF5ZXIuc2hvd0FsbENvbXBhcmVDYXJkcyh0aGlzLl9kZXNrSW5mby5wbGF5ZXJzKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgdGhpcy5zdGFydENvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1JlYWR5U3RhdHVzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1RvdGFsR2FtZU92ZXIoKSkgdGhpcy5fc2hvd1RvdGFsR2FtZVJlc3VsdCgpO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcyksIDAuNSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjaXZlRmFQYWk6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIC8vICDlj5HniYzkuoblvIDlp4vmr5TniYzpmpDol4/mjolcclxuICAgICAgICB0aGlzLnN0YXJ0Q29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XHJcbiAgICAgICAgdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fZ2FtZVN0YXR1cyA9IEdBTUVTVEFUVVMuV0FJVF9SRUFEWTtcclxuICAgICAgICB0aGlzLl9zb2NrZXRSZWNlaXZlRGVza0luZm8ocmVzcG9uc2UpO1xyXG4gICAgfSxcclxuICAgIGxvZ291dEFjdGlvbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdsb2dpbicpO1xyXG4gICAgICAgIC8vbWFuYWdlci5zZXRVc2VySW5mbygnJyk7XHJcbiAgICAgICAgLy9oYWxsLmNhY2hlSW1hZ2VJbmZvID0gbnVsbDtcclxuICAgIH0sXHJcbiAgICBfc29ja2V0UmVjaXZlT25saW5lU3RhdHVzOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAvL3tcImFjdGlvblwiOlwic2VuZE9ubGluZVN0YXR1c1wiLFwicmVzdWx0XCI6dHJ1ZSxcImRhdGFcIjp7XCJ1c2VySWRcIjoxMDAwNDksXCJzdGF0dXNcIjoxfX1cclxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICBjYy5lcnJvcihcIumUmeivr++8mlwiLCByZXNwb25zZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICBsZXQgdXNlcklkID0gZGF0YS51c2VySWQ7XHJcbiAgICAgICAgbGV0IHN0YXR1cyA9IGRhdGEuc3RhdHVzO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICBwbGF5ZXIuc2V0VXNlck9ubGluZVN0YXR1cyh1c2VySWQsIHN0YXR1cyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNpdmVDaGF0VGV4dE1lc3NhZ2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIGxldCB1c2VySWQgPSByZXNwb25zZS5kYXRhLnVzZXJJZDtcclxuICAgICAgICBsZXQgbWVzc2FnZSA9IHJlc3BvbnNlLmRhdGEubXNnO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICBwbGF5ZXIuc2hvd0NoYXRUZXh0KHVzZXJJZCwgbWVzc2FnZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuX21zZ0NvbnRyb2wuYWRkQ2hhdFRleHRNZXNzYWdlKHVzZXJJZCwgbWVzc2FnZSk7XHJcblxyXG4gICAgICAgIGxldCBzZXggPSB0aGlzLl9wbGF5ZXJJbmZvcy5maW5kKGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1c2VyLmlkID09IHVzZXJJZDtcclxuICAgICAgICB9KS5zZXg7XHJcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlDaGF0QXVkaW8oc2V4LCBtZXNzYWdlKTtcclxuICAgIH0sXHJcbiAgICBfc29ja2V0UmVjaXZlQ2hhdEVtb2ppTWVzc2FnZSA6ZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAgIGxldCB1c2VySWQgPSByZXNwb25zZS5kYXRhLnVzZXJJZDtcclxuICAgICAgICBsZXQgZW1vamkgPSByZXNwb25zZS5kYXRhLmVtb2ppO1xyXG5cclxuICAgICAgICAvL3RoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgLy8gICAgcGxheWVyLnNob3dDaGF0VGV4dCh1c2VySWQsIGVtb2ppKTtcclxuICAgICAgICAvL30pO1xyXG4gICAgICAgIC8vdGhpcy5fbXNnQ29udHJvbC5hZGRDaGF0RW1vamlNZXNzYWdlKHVzZXJJZCwgZW1vamkpO1xyXG4gICAgICAgIHRoaXMuX21zZ0NvbnRyb2wuX2xvYWRFbW9qaUZyYW1lKGVtb2ppLGZ1bmN0aW9uKGZyYW1lKXtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgIGlmKHBsYXllci51c2VySWQgPT0gdXNlcklkKSBwbGF5ZXIuY2hhdE1lc3NhZ2VOb2RlLmdldENvbXBvbmVudCgnQ2hhdE1lc3NhZ2UnKS5zaG93RW1vamkoZnJhbWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LmJpbmQodGhpcykpXHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlUmVxdWVzdEV4aXRNZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAvL2lmIChyZXNwb25zZS5kYXRhLnVzZXJJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAvLyAgICByZXR1cm47XHJcbiAgICAgICAgLy99XHJcblxyXG5cclxuICAgICAgICB2YXIgYWxlcnRfYmcgPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENoaWxkQnlOYW1lKFwiYWxlcnRfYmdcIik7XHJcblxyXG4gICAgICAgIHZhciBidG5BZ3JlZSA9IGFsZXJ0X2JnLmdldENoaWxkQnlOYW1lKFwiYnRuQWdyZWVcIik7XHJcblxyXG4gICAgICAgIHZhciBidG5EaXNhZ3JlZSA9IGFsZXJ0X2JnLmdldENoaWxkQnlOYW1lKFwiYnRuRGlzYWdyZWVcIik7XHJcblxyXG4gICAgICAgIGJ0bkFncmVlLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIGJ0bkRpc2FncmVlLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHZhciBkYXRhSW5mb3MgPSByZXNwb25zZS5kYXRhLmluZm87XHJcblxyXG4gICAgICAgIGlmKCF0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmFjdGl2ZSl7XHJcblxyXG4gICAgICAgICAgICBsZXQgYWxlcnRDb21wID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcblxyXG4gICAgICAgICAgICBhbGVydENvbXAuYWxlcnQoKTtcclxuXHJcbiAgICAgICAgICAgIGFsZXJ0Q29tcC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRBbnNvd2VyRXhpdE5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihpKXtpLmFjdGl2ZSA9IGZhbHNlO30pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJJbmZvLGluZGV4KXtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcGxheSA9IHRoaXMuY29udGVudEFuc293ZXJFeGl0Tm9kZS5jaGlsZHJlbltpbmRleF07XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBwbGF5LmdldENoaWxkQnlOYW1lKFwibmlja25hbWVcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGJhY2sgPSBwbGF5LmdldENoaWxkQnlOYW1lKFwiZmFuemh1XCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBpbWcgPSBwbGF5LmdldENoaWxkQnlOYW1lKFwiYXZhdGFyX2JnXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIHBsYXkuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBuYW1lLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gcGxheWVySW5mby5uaWNrbmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSBwbGF5ZXJJbmZvLmlkKXsvL+aYvuekuuaIv+S4u1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBiYWNrLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNle1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBiYWNrLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6cGxheWVySW5mby5hdmF0YXJVcmwsdHlwZTpcImpwZ1wifSwgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZShkYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaW1nLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gZnJhbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNvdW50ZG93biA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKTtcclxuXHJcbiAgICAgICAgICAgIGNvdW50ZG93bi5zdGFydENvdW50ZG93big2MCwgZnVuY3Rpb24oaXNUaW1lb3V0KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGlzVGltZW91dCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsaWNrQWdyZWVPdGhlclBsYXllckV4aXQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllckluZm8saW5kZXgpe1xyXG5cclxuICAgICAgICAgICAgdmFyIGRhdGFJbmZvID0gZGF0YUluZm9zW2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgIHZhciBwbGF5ID0gdGhpcy5jb250ZW50QW5zb3dlckV4aXROb2RlLmNoaWxkcmVuW2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzdHIgPSBwbGF5LmdldENoaWxkQnlOYW1lKFwiaWRcIik7XHJcblxyXG4gICAgICAgICAgICB2YXIgZGF0YUluZm8gPSBkYXRhSW5mb3NbaW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgaWYoZGF0YUluZm8gPT0gMSl7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5fdXNlcklkID09IHBsYXllckluZm8uaWQpey8v5pi+56S65oi/5Li7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJ0bkFncmVlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBidG5EaXNhZ3JlZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBzdHIuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIuWQjOaEj1wiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7XHJcblxyXG4gICAgICAgICAgICAgICAgc3RyLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVSZXF1ZXN0RXhpdFJlc3VsdE1lc3NhZ2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMuX2hpZGVSZXFlc3RFeGl0Tm9kZSgpO1xyXG4gICAgICAgIGlmICh0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdG9wKCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIC8vIOino+aVo+aIkOWKn1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCB1c2VySWQgPSByZXNwb25zZS5kYXRhLnVzZXJJZDtcclxuICAgICAgICAgICAgbGV0IG5pY2tuYW1lID0gdGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZCh1c2VySWQpLm5pY2tuYW1lO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQueSA9IC0xNDM7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdFJlc3VsdC5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQuY2hpbGRyZW5bMF0uZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBuaWNrbmFtZSArICfkuI3lkIzmhI/pgIDlh7onO1xyXG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gY2Muc3Bhd24oY2MubW92ZVRvKC4zLCBjYy5wKDAsIDIwKSksIGNjLmZhZGVPdXQodGhpcy5jYXJkVGltZSkpO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLm1vdmVUbygxLCBjYy5wKDAsIDApKSwgYWN0aW9uKSk7XHJcblxyXG4gICAgICAgICAgICAvL3RoaXMuc2hvd0FsZXJ0TWVzc2FnZSgn6Kej5pWj5aSx6LSl77yM5Zug5Li6JyArIG5pY2tuYW1lICsgJ+S4jeWQjOaEj+mAgOWHuicpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVBdWRpb01lc3NhZ2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIGxldCB1c2VySWQgPSByZXNwb25zZS5kYXRhLnVzZXJJZDtcclxuICAgICAgICB0aGlzLnBsYXlTcGVha0FuaW1hdGlvbih1c2VySWQpO1xyXG5cclxuICAgICAgICBpZiAodXNlcklkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdXJsID0gcmVzcG9uc2UuZGF0YS51cmw7XHJcbiAgICAgICAgdGhpcy5wbGF5QXVkaW9VcmwodXJsKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVQbGF5Q2FyZDogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgLy8g5pyJ55So5oi35bey57uP5YeG5aSH5aW95LqG54mMXHJcbiAgICAgICAgdmFyIHVzZXJJZCA9IHJlc3BvbnNlLmRhdGFbMF0udXNlcklkO1xyXG4gICAgICAgIHZhciBjYXJkSW5mbyA9IHJlc3BvbnNlLmRhdGFbMV0uY2FyZDtcclxuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IHJlc3BvbnNlLmRhdGFbMl0ucztcclxuICAgICAgICBsZXQgcGxheWVycyA9IHJlc3BvbnNlLmRhdGFbMl0ucy5wbGF5ZXJzO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gcGxheWVycztcclxuICAgICAgICB0aGlzLl91cGRhdGVVc2VySW5mb3MocGxheWVycyk7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyLnBsYXlDYXJkKHVzZXJJZCxjYXJkSW5mbyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICh1c2VySWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgX2dldFNlbGZSZWFkeVN0YXR1czpmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodGhpcy5fdXNlcklkKTtcclxuICAgICAgICByZXR1cm4gc2VsZi5yZWFkeVN0YXR1cztcclxuICAgIH0sXHJcbiAgICBfc29ja2V0UmVjaXZlUmVhZHk6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIGxldCB1c2VySWQgPSByZXNwb25zZS5kYXRhLnVzZXJJZDtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICBpZighdGhpcy5fZGVza0luZm8uaXNDQmVnaW4pIHBsYXllci5zaG93UmVhZHlTdGF0dXModXNlcklkKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+aUtuWIsOa4uOaIj+e7k+adn1xyXG4gICAgX3NvY2tldFJlY2VpdmVHYW1lT3ZlcjogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xyXG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRpbWVzdGFtcFwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5faGlkZVJlcWVzdEV4aXROb2RlKCk7XHJcblxyXG4gICAgICAgIC8vIOS4gOWxgOa4uOaIj+e7k+adn1xyXG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGNjLmVycm9yKFwi6ZSZ6K+v77yaXCIsIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICAgICAgY29uc3QgZGVza0luZm8gPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIGlmIChyZXNwb25zZS5hY3Rpb24gPT0gJ2dhbWVPdmVyJyAmJiBkZXNrSW5mby5pc0Rlc2tPdmVyKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBTb2NrZXQuc2VuZERpZFJlY2VpdmVHYW1lT3ZlckFjdGlvbih0aGlzLl91c2VySWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSByZXNwb25zZS5kYXRhO1xyXG5cclxuICAgICAgICAvLyDlpoLmnpzmmK/lvLrliLbop6PmlaPmiL/pl7TvvIzliJnnm7TmjqXmmL7npLrmgLvmiJDnu6lcclxuICAgICAgICBpZiAodGhpcy5faXNEaXNzdmxlZFJvb20oKSAmJiAhUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dUb3RhbEdhbWVSZXN1bHQoMC4xKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gdGhpcy5fZW50ZXJUaW1lIDwgMTAwMCAqIDQpIHtcclxuICAgICAgICAgICAgLy8g5Yia6L+b5p2l55qE6K+d77yM5LiN5bGV56S65q+U54mM5Yqo55S7XHJcbiAgICAgICAgICAgIC8vICBsZXQgb25lR2FtZVJlc3VsdCA9IHRoaXMub25lR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ0dhbWVSZXN1bHQnKTtcclxuICAgICAgICAgICAgLy8gIG9uZUdhbWVSZXN1bHQudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgICAgICAvLyAgb25lR2FtZVJlc3VsdC5zaG93UmVzdWx0cyh0aGlzLl9kZXNrSW5mbywgdGhpcy5fdXNlcklkKTtcclxuICAgICAgICAgICAgdGhpcy5pc1JlYWR5U3RhdHVzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyQ29tcC5yZXNldCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLyoqL1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMucHVzaCh0aGlzLl9kZXNrSW5mby5jSW5kZXgpO1xyXG4gICAgICAgICAgICAvKiovXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5fYmlnUmVjb3JkSW5mbyA9IGRhdGEuYmlnUmVjb3JkSW5mb1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTcwOVwiKTtcclxuICAgICAgICB0aGlzLl91cGRhdEdhbWVPdmVydmlldyh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgLy9sZXQgcGxheWVySW5kZXhzID0gZGF0YS5wbGF5ZXJzSW5kZXg7IC8vIFsxMDAwNDldXHJcblxyXG4gICAgICAgIGxldCBwbGF5ZXJzID0gZGF0YS5wbGF5ZXJzO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gcGxheWVycztcclxuICAgICAgICB0aGlzLl91cGRhdGVVc2VySW5mb3MocGxheWVycyk7XHJcbiAgICAgICAgLy90aGlzLl91cGRhdGVSZWNvcmRJbmZvKHBsYXllcnMpO1xyXG5cclxuICAgICAgICBpZiAoVXNlck1vZGVsSGVscGVyLmlzVXNlclJlYWR5KHRoaXMuX2ZpbmRDdXJyZW50VXNlckluZm8oKSkpIHtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YXJ0Q29tcGFyZUNhcmRzKHJlc3BvbnNlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gdGhpcy5fZW50ZXJUaW1lIDwgMTAwMCAqIDQpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93Q29tcGFyZUNhcmQoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyBfdXBkYXRlUmVjb3JkSW5mbzpmdW5jdGlvbihwbGF5ZXJzKXtcclxuXHJcbiAgICAvLyAgICAgLy8gdGhpcy5fYmlnUmVjb3JkSW5mby5wdXNoKCk7XHJcbiAgICAvLyB9LFxyXG4gICAgX3NvY2tldFJlY2VpdmVEaXNzb2x2ZURlc2s6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG5cclxuICAgICAgICAvLyB0aGlzLmFsZXJ0LmdldENvbXBvbmVudCgnYWxlcnQnKS5zZXRXaWxsRGlzbWlzc0NhbGxiYWNrKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIC8vICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgLy8gfSk7XHJcblxyXG4gICAgICAgIC8vIGxldCBtZXNzYWdlID0gXCLmiL/kuLvlt7Lop6PmlaPmiL/pl7RcIjtcclxuICAgICAgICAvLyBpZiAodGhpcy5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICAvLyAgIG1lc3NhZ2UgPSBcIuacieeOqeWutuW3suW8uuWItumAgOWHuuaIv+mXtO+8jOa4uOaIj+e7k+adn+OAguacrOWxgOa4uOaIj+S4jeS8muaJo+mZpOaCqOeahOmSu+efs+OAglwiO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgLy8gdGhpcy5zaG93QWxlcnRNZXNzYWdlKG1lc3NhZ2UsIGZhbHNlKTtcclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICBfc29ja2V0TGVhdmVEZXNrOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uaXNEZXNrT3Zlcikge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzmiL/pl7Tlt7Lnu5PmnZ/vvIzkuZ/kuI3nlKjlho3oh6rliqjpgIDlm57liLDlpKfljoXkuoZcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICB9LFxyXG4gICAgLyoqL1xyXG4gICAgLy8gc29ja2V0IOaUtuWIsOacieS6uuaJi+acuui/m+WFpeWQjuWPsOa2iOaBr1xyXG4gICAgX3NvY2tldFJlY2VpdmVQYXVzZTogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllcikge1xyXG4gICAgICAgICAgICBpZiAocGxheWVyLnVzZXJJZCA9PSB1c2VySWQpIHtcclxuICAgICAgICAgICAgICAgIHBsYXllci5zZXRVc2VyT25saW5lU3RhdHVzKHVzZXJJZCwgMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX3JlY2VpdmVTb2NrZXRDb25uZWN0RXJyb3I6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdGhpcy5zaG93TmV0d29ya01lc3NhZ2UoKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3JlY2VpdmVTb2NrZXRDb25uZWN0U3VjY2Vzc2VkOiBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcclxuXHJcbiAgICAgICAgaWYgKCFQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5fbG9hZERlc2tJbmZvKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8qKi9cclxuICAgIC8vIE1BUks6IOabtOaWsOaIv+mXtOS/oeaBr1xyXG4gICAgdXBkYXRlRGVza0luZm86IGZ1bmN0aW9uIChkZXNrSW5mbykge1xyXG4gICAgICAgIHRoaXMuX2Rlc2tJbmZvID0gZGVza0luZm87XHJcbiAgICAgICAgdGhpcy5fdXBkYXRHYW1lT3ZlcnZpZXcodGhpcy5fZGVza0luZm8pO1xyXG4gICAgICAgIHRoaXMudXBkYXRlUm9vbU51bWJlcihkZXNrSW5mby5yb29tSWQpO1xyXG5cclxuICAgICAgICBsZXQgcGxheWVySW5kZXhzID0gZGVza0luZm8ucGxheWVyc0luZGV4OyAvLyBbMTAwMDQ5XVxyXG4gICAgICAgIHRoaXMuX2luamVjdFVzZXJJZFRvUGxheWVyQ29tcG9uZW50cyhwbGF5ZXJJbmRleHMpO1xyXG5cclxuICAgICAgICBsZXQgcGxheWVycyA9IGRlc2tJbmZvLnBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSBwbGF5ZXJzO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZVVzZXJJbmZvcyhwbGF5ZXJzKTtcclxuICAgICAgICB0aGlzLl9tc2dDb250cm9sLmFkZFBsYXllckluZm9zKHRoaXMuX3BsYXllckluZm9zKTtcclxuICAgICAgICBpZiAoZGVza0luZm8uY0luZGV4ID09IDAgJiYgdGhpcy5fZGVza0luZm8ucGxheWVycy5sZW5ndGggPCB0aGlzLl9kZXNrSW5mby5tYXhOdW1iZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8qKi9cclxuICAgIF9pbmplY3RVc2VySWRUb1BsYXllckNvbXBvbmVudHM6IGZ1bmN0aW9uIChwbGF5ZXJJbmRleHMpIHtcclxuICAgICAgICBsZXQgY3VycmVudFVzZXJJZEluZGV4ID0gcGxheWVySW5kZXhzLmZpbmRJbmRleChmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1c2VySWQgPT0gdGhpcy5fdXNlcklkO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIGxldCBmaXhlZFBsYXllckluZGV4cyA9IHBsYXllckluZGV4cy50cmFuc2xhdGlvbldpdGhTdGFydEluZGV4KGN1cnJlbnRVc2VySWRJbmRleCk7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wb25lbnQsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIGxldCB1c2VySWQgPSBmaXhlZFBsYXllckluZGV4cy5sZW5ndGggPiBpbmRleCA/IGZpeGVkUGxheWVySW5kZXhzW2luZGV4XSA6IG51bGw7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXBvbmVudC51c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF91cGRhdGVVc2VySW5mb3M6IGZ1bmN0aW9uICh1c2VySW5mb3MpIHtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wb25lbnQsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIC8vcGxheWVyQ29tcG9uZW50LnNldERlc2tJbmZvKHNlbGYuX2Rlc2tJbmZvKTtcclxuICAgICAgICAgICAgLyoqL1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wb25lbnQudXBkYXRlRGVza0luZm8oc2VsZi5fZGVza0luZm8pO1xyXG4gICAgICAgICAgICAvKiovXHJcbiAgICAgICAgICAgIHBsYXllckNvbXBvbmVudC51cGRhdGVVc2VySW5mb1dpdGhVc2Vycyh1c2VySW5mb3MpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL3RoaXMuX2hhbmRsZVRoZVNhbWVPZklQQWRyZXNzKHVzZXJJbmZvcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF91cGRhdGVVc2VyU2NvcmVzOiBmdW5jdGlvbih1c2VySW5mb3MpIHtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheWVyKSB7XHJcbiAgICAgICAgICAgIHBsYXllci51cGRhdGVTY29yZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgX3VwZGF0ZUJhbmtlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllcikge1xyXG4gICAgICAgICAgICBwbGF5ZXIudXBkYXRlQmFua2VyKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOengeacieaWueazlVxyXG4gICAgX2ZpbmRDYXJkc0J5VXNlcklkOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgbGV0IHBsYXllciA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodXNlcklkKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChwbGF5ZXIgIT0gbnVsbCkgPyBwbGF5ZXIuY2FyZHMgOiBudWxsO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZmluZFBsYXllckluZm9CeVVzZXJJZDogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIGxldCBwbGF5ZXIgPSAodGhpcy5fcGxheWVySW5mb3MgfHwgW10pLmZpbmQoZnVuY3Rpb24gKHBsYXllckluZm8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVzZXJJZCA9PSBwbGF5ZXJJbmZvLmlkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcGxheWVyO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZmluZFBsYXllckluZGV4QnlVc2VySWQ6IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICAvL2xldCBpbmRleCA9IHRoaXMuX3BsYXllckNvbXBvbmVudHMuZmluZEluZGV4KGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuIHBsYXllckNvbXAudXNlcklkID09IHVzZXJJZDtcclxuICAgICAgICAvL30pO1xyXG4gICAgICAgIGxldCBpbmRleCA9IHRoaXMucGxheWVyTm9kZXMuZmluZEluZGV4KGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBub2RlLmdldENvbXBvbmVudCgnUGxheWVyJykudXNlcklkID09IHVzZXJJZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICB9LFxyXG5cclxuICAgIF9maW5kQ3VycmVudFVzZXJJbmZvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcblxyXG4gICAgX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzOiBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgICAgICAvLyBbe1wic3VpdFwiOlwic1wiLFwibnVtYmVyXCI6MTB9XVxyXG4gICAgICAgIGxldCBzdWl0Q29sb3JNYXAgPSB7XHJcbiAgICAgICAgICAgIHM6IDQsXHJcbiAgICAgICAgICAgIGg6IDMsXHJcbiAgICAgICAgICAgIGM6IDIsXHJcbiAgICAgICAgICAgIGQ6IDEsXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XHJcbiAgICAgICAgICAgIHZhciBjYXJkTnVtYmVyID0gY2FyZC5udW1iZXI7XHJcblxyXG4gICAgICAgICAgICAvLyDmnI3liqHlmajkuK3nmoQgMTQg5pivIEFcclxuICAgICAgICAgICAgaWYgKGNhcmQubnVtYmVyID09IDE0KSB7XHJcbiAgICAgICAgICAgICAgICBjYXJkTnVtYmVyID0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgY29sb3IgPSBzdWl0Q29sb3JNYXBbY2FyZC5zdWl0XTtcclxuICAgICAgICAgICAgbGV0IG51bWJlciA9IE1hdGgubWF4KE1hdGgubWluKGNhcmROdW1iZXIsIDIxKSwgMSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjb2xvciArIFwiX1wiICsgbnVtYmVyO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmm7TmlrDmuLjmiI/mgLvop4jkv6Hmga9cclxuICAgIF91cGRhdEdhbWVPdmVydmlldzogZnVuY3Rpb24gKGRlc2tJbmZvKSB7XHJcbiAgICAgICAgaWYgKFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsT3ZlcnZpZXcuc3RyaW5nID0gXCLlm57mlL5cIjtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2lzUmFuZG9tUm9vbSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWxPdmVydmlldy5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBiaWh1YXNlID0gXCLkuI3mr5ToirHoibIgXCI7XHJcbiAgICAgICAgdmFyIHp1b3podWFuZyA9IFwi5LiN5Z2Q5bqEIFwiO1xyXG4gICAgICAgIHZhciBwdXRvbmcgID0gXCLmma7pgJrlnLogXCI7XHJcbiAgICAgICAgdmFyIHd1Z3VpID0gIFwi5peg6ay8IFwiO1xyXG4gICAgICAgIHZhciBtYVBhaSA9ICfkuI3kubDpqawgJztcclxuICAgICAgICB2YXIgcmVuc2h1ID0gXCI05Lq65LiN5Yqg6ImyIFwiO1xyXG4gICAgICAgIHZhciBjYXJkID0gXCLlubPmkYpcIjtcclxuXHJcbiAgICAgICAgLy9b55av54uC5Zy6LOmsvOeJjCzmr5ToirHoibIs5Z2Q5bqELOmprOeJjF1cclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nM1syXSl7XHJcbiAgICAgICAgICAgIGJpaHVhc2UgPSBcIuavlOiKseiJsiAgXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmczWzNdKXtcclxuICAgICAgICAgICAgenVvemh1YW5nID0gXCLlnZDluoQgXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmczWzBdKXtcclxuICAgICAgICAgICAgcHV0b25nID0gXCLnlq/ni4LlnLogIFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nM1sxXSl7XHJcbiAgICAgICAgICAgIHd1Z3VpID0gXCLmnInprLwgIFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nM1s0XSl7XHJcbiAgICAgICAgICAgIG1hUGFpID0gXCLkubDpqaxcIjtcclxuICAgICAgICAgICAgdmFyIGh1YVNlID0gXCLmlrnlnZdcIjtcclxuICAgICAgICAgICAgdmFyIGRpYW5TaHUgPSAxXHJcbiAgICAgICAgICAgIHN3aXRjaCh0aGlzLl9kZXNrSW5mby5zZXR0aW5nN1swXSl7IC8vc2V0dGluZzcgWzF+NCwxfjEzXSDooajnpLogW+iKseiJsu+8jOeCueaVsF1cclxuICAgICAgICAgICAgICAgIGNhc2UgMTogaHVhU2UgPSBcIuaWueWdl1wiO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOiBodWFTZSA9IFwi5qKF6IqxXCI7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6IGh1YVNlID0gXCLnuqLlv4NcIjticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogaHVhU2UgPSBcIum7keahg1wiO2JyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHN3aXRjaCh0aGlzLl9kZXNrSW5mby5zZXR0aW5nN1sxXSl7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6IGRpYW5TaHUgPSAnQSc7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6IGRpYW5TaHUgPSAyO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOiBkaWFuU2h1ID0gMzticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogZGlhblNodSA9IDQ7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IGRpYW5TaHUgPSA1O2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA2OiBkaWFuU2h1ID0gNjticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogZGlhblNodSA9IDc7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDg6IGRpYW5TaHUgPSA4O2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA5OiBkaWFuU2h1ID0gOTticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMTA6IGRpYW5TaHUgPSAxMDticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMTE6IGRpYW5TaHUgPSAnSic7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDEyOiBkaWFuU2h1ID0gJ1EnO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxMzogZGlhblNodSA9ICdLJzticmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBtYVBhaSA9IGh1YVNlK2RpYW5TaHUrbWFQYWk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nMiA9PSAxKXtcclxuICAgICAgICAgICAgcmVuc2h1ID0gXCI15Lq65Yqg5LiA6ImyIFwiO1xyXG4gICAgICAgIH1lbHNlIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcyID09IDIpe1xyXG4gICAgICAgICAgICByZW5zaHUgPSBcIjbkurrliqDkuozoibIgXCI7XHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzIgPT0gMyl7XHJcbiAgICAgICAgICAgIHJlbnNodSA9IFwiN+S6uuWKoOS4ieiJsiBcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzQgPT0gMSl7XHJcbiAgICAgICAgICAgIGNhcmQgPSBcIui1ouiAheaJoyBcIjtcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nNCA9PSAyKXtcclxuICAgICAgICAgICAgY2FyZCA9IFwi5oi/5Li75omjIFwiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5sYWJlbE92ZXJ2aWV3LnN0cmluZyA9IFwi5qih5byPIDogXCIrYmlodWFzZSt6dW96aHVhbmcrcHV0b25nK3d1Z3VpK21hUGFpK1wiXFxuXCIrXCLlhbbku5bvvJpcIityZW5zaHUrY2FyZDtcclxuICAgICAgICAvL3RoaXMubGFiZWxPdmVydmlldy5zdHJpbmcgPSBcIuaooeW8jyA6IFwiICsgXCJcIiArIGRlc2tJbmZvLm1heE51bWJlciArIFwi5Lq6XCIgK2JpaHVhc2UrenVvemh1YW5nK3B1dG9uZyt3dWd1aSttYVBhaTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5piv5ZCm5piv6ZqP5py65oi/XHJcbiAgICBfaXNSYW5kb21Sb29tOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVza0luZm8uaXNSYW5kb21EZXNrO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmmK/lkKbmiYDmnInlsYDmlbDpg73nlKjlrozkuoZcclxuICAgIF9pc1RvdGFsR2FtZU92ZXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uaXNEZXNrT3Zlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9kZXNrSW5mby5tTWF4IDw9IHRoaXMuX2Rlc2tJbmZvLmNJbmRleDtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5piv5ZCm5bey6Kej5pWj5oi/6Ze0XHJcbiAgICBfaXNEaXNzdmxlZFJvb206IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Rlc2tJbmZvLmRpc3NvbHZlU3RhdHVzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgX3N0YXJ0Q29tcGFyZUNhcmRzOiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyhmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5fcGxheWVycyA9IGRhdGEuZGF0YS5wbGF5ZXJzO1xyXG4gICAgICAgIGxldCB1c2VyID0gdGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZCh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgIGlmKCF0aGlzLnRvdGFsR2FtZVJlc3VsdC5hY3RpdmUpe1xyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVN0YXJ0Q29tcGFyZSh1c2VyLnNleCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc3RhcnRDb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge3BsYXllckNvbXAucmVhZHlUb0NvbXBhcmVDYXJkcygpO30pO1xyXG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFydENvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dDb21wYXJlQ2FyZERldGFpbHMoZGF0YSk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAxLjApO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc2hvd0NvbXBhcmVDYXJkRGV0YWlsczogZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTtcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5yZWFkeVRvQ29tcGFyZUNhcmRzKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBjYXJkVHlwZUNvbWJpbmUgPSB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZUNvbWJpbmUnKTtcclxuXHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnJlc2V0KCk7XHJcblxyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgY29tcGFyZVBsYXllcnMxID0gdGhpcy5fcGxheWVyQ29tcG9uZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYXllcikge1xyXG5cclxuICAgICAgICAgICAgaWYocGxheWVyLm5vZGUuYWN0aXZlKXtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHBsYXllci5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXI7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIXVzZXIuaXNDb250YWluRXh0cmEpIHJldHVybiBwbGF5ZXIubm9kZS5hY3RpdmU7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCB0ZVNodVBsYXllcnMgPSB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZpbHRlcihmdW5jdGlvbiAocGxheWVyKSB7XHJcblxyXG4gICAgICAgICAgICBpZihwbGF5ZXIubm9kZS5hY3RpdmUpe1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB1c2VyID0gcGxheWVyLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlcjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZih1c2VyLmlzQ29udGFpbkV4dHJhKSByZXR1cm4gcGxheWVyLm5vZGUuYWN0aXZlO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgZHVyYXRpb24gPSB0aGlzLl9zaG93Q29tcGFyZUNhcmRTdGVwKDAsIGNvbXBhcmVQbGF5ZXJzMSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtzZWxmLl9zaG93Q29tcGFyZUNhcmRTdGVwKDAsIGNvbXBhcmVQbGF5ZXJzMSk7fSwgZHVyYXRpb24pO1xyXG5cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7c2VsZi5fc2hvd0NvbXBhcmVDYXJkU3RlcCgwLCBjb21wYXJlUGxheWVyczEpO30sIGR1cmF0aW9uICogMik7XHJcblxyXG4gICAgICAgIGlmKHRlU2h1UGxheWVycy5sZW5ndGggPiAwKXtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3NlbGYuX3Nob3dDb21wYXJlQ2FyZFN0ZXAoMCwgdGVTaHVQbGF5ZXJzLCB0cnVlKTt9LCBkdXJhdGlvbiAqIDMpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKiAzICsgMC41O1xyXG5cclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGVTaHVQbGF5ZXJzLmxlbmd0aDsgaSsrKXtcclxuXHJcbiAgICAgICAgICAgIHZhciB1c2VyID0gdGVTaHVQbGF5ZXJzW2ldLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlcjtcclxuXHJcbiAgICAgICAgICAgIGlmKHVzZXIuaXNDb250YWluRXh0cmEpZHVyYXRpb24gPSBkdXJhdGlvbiArIDIuNVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBzaG9vdER1cmF0aW9uID0gdGhpcy5oZWFkQ2FyZFRpbWU7XHJcblxyXG4gICAgICAgIGxldCBzaG9vdERhdGFzID0gdGhpcy5fc2hvb3REYXRhcygpIHx8IFtdO1xyXG5cclxuICAgICAgICBsZXQgc2hvdERhdGEgPSB0aGlzLl9zaG90RGF0YSgpIHx8IFtdO1xyXG5cclxuICAgICAgICBsZXQgaG9tZVJ1blVzZXJJZCA9IHRoaXMuX2hvbWVSdW5Vc2VySWQoKTtcclxuXHJcbiAgICAgICAgdmFyIHNob3REYXRhVGltZXMgPSAwO1xyXG5cclxuICAgICAgICBzaG90RGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhLCBpbmRleCkge1xyXG5cclxuICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGYucGxheVNob290KGRhdGEuZnJvbVVzZXJJZCwgZGF0YS50b1VzZXJJZCk7XHJcblxyXG4gICAgICAgICAgICB9LCBkdXJhdGlvbiArIGluZGV4ICogc2hvb3REdXJhdGlvbik7XHJcblxyXG4gICAgICAgICAgICBzaG90RGF0YVRpbWVzICs9IHNlbGYuaGVhZENhcmRUaW1lO1xyXG5cclxuICAgICAgICAgICAgZHVyYXRpb24gKz0gc2VsZi5oZWFkQ2FyZFRpbWU7XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZihob21lUnVuVXNlcklkLmxlbmd0aCA+PSAxKXtcclxuXHJcbiAgICAgICAgICAgIHNob290RGF0YXMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YSwgaW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucGxheVNob290KGRhdGEuZnJvbVVzZXJJZCwgZGF0YS50b1VzZXJJZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSwgZHVyYXRpb24gKyAoaW5kZXggKyBzaG90RGF0YVRpbWVzKSAqIHNob290RHVyYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uICs9IHNlbGYuaGVhZENhcmRUaW1lO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbiArIHNob290RGF0YXMubGVuZ3RoICogc2hvb3REdXJhdGlvbiArIHNob3REYXRhLmxlbmd0aCAqIHNob290RHVyYXRpb247XHJcblxyXG4gICAgICAgIGlmIChob21lUnVuVXNlcklkID4gMCkge1xyXG5cclxuICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3NlbGYucGxheUhvbWVSdW4oaG9tZVJ1blVzZXJJZCk7fSwgZHVyYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbiArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaG9tZVJ1blVzZXJJZCkge1xyXG4gICAgICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uICsgMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3RoaXMuX2ppbkJpQWN0aW9uKCk7fS5iaW5kKHRoaXMpLCBkdXJhdGlvbik7Ly/mmL7npLrnu5Pnrpfph5HluIEvL+aYvuekuue7k+aenFxyXG4gICAgICAgIHRoaXMuX2ppbkJpQWN0aW9uKGR1cmF0aW9uKTtcclxuICAgICAgICAvL3RoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge3BsYXllckNvbXAuc2hvd1Njb3JlUmVzdWx0KCk7fSk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICBzZWxmLl9zaG93Q29tcGFyZUNhcmRGaW5pc2hlZCgpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy99LmJpbmQodGhpcyksIGR1cmF0aW9uKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9qaW5CaUFjdGlvbjogZnVuY3Rpb24gKGR1cmF0aW9uKSB7XHJcbiAgICAgICAgdmFyIGNvbXBhcmVQbGF5ZXJzMSA9IHRoaXMuX3BsYXllckNvbXBvbmVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGF5ZXIpIHtyZXR1cm4gcGxheWVyLm5vZGUuYWN0aXZlO30pO1xyXG5cclxuICAgICAgICB2YXIgbmV4dFRpbWUgPSAwOy8v5LiL5LiA5Liq5Yqo5L2c5byA5aeL55qE5pe26Ze0XHJcblxyXG4gICAgICAgIHZhciB6VGltZSA9IDA7Ly/kuIvkuIvkuIDkuKrliqjkvZzlvIDlp4vnmoTml7bpl7RcclxuXHJcbiAgICAgICAgdmFyIHN0YXJ0ID0gMDtcclxuXHJcbiAgICAgICAgdmFyIGVuZCA9IDA7XHJcblxyXG4gICAgICAgIHZhciBjb2luc0NvbnRhaW5lckF5eSA9IFtdOyAvL+aJgOacieeahOeUqOaIt+eahOmHkeW4gSDkuIDkuKrnlKjmiLfkuIDkuKrmlbDnu4RcclxuXHJcbiAgICAgICAgdmFyIGNvaW5zQXl5ID0gW107IC8v5omA5pyJ55qE6YeR5biB77yM5LiA5Liq5pWw57uEXHJcblxyXG4gICAgICAgIHRoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vKXtpZihubykgbm8ucmVtb3ZlQWxsQ2hpbGRyZW4oKTt9KTtcclxuXHJcbiAgICAgICAgY29tcGFyZVBsYXllcnMxLmZvckVhY2goZnVuY3Rpb24ocGxheXMsIGluZGV4KXsvL+agueaNruenr+WIhuWIm+W7uumHkeW4gVxyXG5cclxuICAgICAgICAgICAgdmFyIGNTY29yZSA9IHBsYXlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlci5jU2NvcmU7XHJcblxyXG4gICAgICAgICAgICBpZihjU2NvcmUgPCAwKXtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgY1Njb3JlICo9IC0xO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBub2RlID0gbmV3IGNjLk5vZGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBub2RlLm5hbWUgPSBcImNvaW5zQ29udGFpbmVyXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG51bVNjb3JlID0gIGNTY29yZSA+IDMwID8gMzA6Y1Njb3JlO1xyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMCA7aSA8IG51bVNjb3JlIDtpKyspe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NyZWF0ZUppbkJpUHJlZmFiKG5vZGUsIG5vZGUpOy8v5qC55o2u56ev5YiG5Yib5bu66YeR5biBXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5c0NvaW5zW2luZGV4XS5hZGRDaGlsZChub2RlKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb2luc0NvbnRhaW5lckF5eS5wdXNoKG5vZGUuY2hpbGRyZW4pO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICB0aGlzLnBsYXlzQ29pbnMuZm9yRWFjaChmdW5jdGlvbihubyl7aWYobm8pIG5vLmFjdGl2ZSA9IGZhbHNlO30pO1xyXG5cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHsvL+aYvuekuue7k+aenFxyXG5cclxuICAgICAgICAgICAgdGhpcy5wbGF5c0NvaW5zLmZvckVhY2goZnVuY3Rpb24obm8pe2lmKG5vKSBuby5hY3RpdmUgPSB0cnVlO30pO1xyXG5cclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLmNvaW5JbmNvbWUoKTtcclxuXHJcbiAgICAgICAgICAgIGNvaW5zQ29udGFpbmVyQXl5LmZvckVhY2goZnVuY3Rpb24oY29pbnNBeXlzKXsvL+aKiumHkeW4geenu+WKqOWIsOWuueWZqFxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBpbml0VGltZSA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGludGVydmFsID0gMC4wMDI7XHJcblxyXG4gICAgICAgICAgICAgICAgY29pbnNBeXlzLmZvckVhY2goZnVuY3Rpb24oY29pbnMpey8v5oqK6YeR5biB56e75Yqo5Yiw5a655ZmoXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB5ID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSA9PSAwID8gLTEgOiAxO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjM4KSAqIHk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSA9PSAwID8gLTEgOiAxO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjM4KSAqIHg7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjYXJkQmFja1dvcmxkU3BhY2UxID0gdGhpcy5ub2RlLmNvbnZlcnRUb1dvcmxkU3BhY2VBUihjYy52Mih4LCB5KSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2MiA9IGNvaW5zLmNvbnZlcnRUb05vZGVTcGFjZUFSKGNhcmRCYWNrV29ybGRTcGFjZTEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvaW5zLnJ1bkFjdGlvbihjYy5tb3ZlQnkoMC4yLCB2MikpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LCBpbml0VGltZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGluaXRUaW1lID0gaW5pdFRpbWUgKyBpbnRlcnZhbDtcclxuXHJcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgICAgIG5leHRUaW1lID0gaW5pdFRpbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgY29pbnNBeXkgPSBjb2luc0F5eS5jb25jYXQoY29pbnNBeXlzKTsvL+aKiumHkeW4gembhuWQiOWIsOS4gOS4quaVsOe7hFxyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgIHZhciB6Y1Njb3JlID0gMDtcclxuXHJcbiAgICAgICAgICAgIGNvbXBhcmVQbGF5ZXJzMS5mb3JFYWNoKGZ1bmN0aW9uKHBsYXlzKXsvL+iuoeeul+mHkeW4gVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjU2NvcmUgPSBwbGF5cy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXIuY1Njb3JlO1xyXG5cclxuICAgICAgICAgICAgICAgIGNTY29yZSA9ICBjU2NvcmUgPiAzMCA/IDMwOmNTY29yZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihjU2NvcmUgPiAwKSB6Y1Njb3JlICs9IGNTY29yZSAqIDE7XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNvaW5zQXl5MSA9IGNvaW5zQXl5LnNwbGljZSh6Y1Njb3JlLCBjb2luc0F5eS5sZW5ndGgpO1xyXG5cclxuICAgICAgICAgICAgY29pbnNBeXkxLmZvckVhY2goZnVuY3Rpb24obm9kZSl7bm9kZS5wYXJlbnQucmVtb3ZlQ2hpbGQobm9kZSk7fSk7XHJcblxyXG4gICAgICAgICAgICBjb21wYXJlUGxheWVyczEuZm9yRWFjaChmdW5jdGlvbihwbGF5cyl7Ly/miorph5HluIHliLDnlKjmiLflpLTlg4/pmYTov5FcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY1Njb3JlID0gcGxheXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyLmNTY29yZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihjU2NvcmUgPiAwKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGludGVydmFsID0gMC4wMDI1O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5pdFRpbWUgPSBuZXh0VGltZSArIDE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBudW1TY29yZSA9ICBjU2NvcmUgPiAzMCA/IDMwOmNTY29yZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9lbmQgKz0gbnVtU2NvcmU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvaW5zQXl5LnNwbGljZSgwLCBudW1TY29yZSkuZm9yRWFjaChmdW5jdGlvbihjb2luc05vZGUpey8v5oqK6YeR5biB5Yiw55So5oi35aS05YOP6ZmE6L+RXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+iOt+WPluiKgueCueeahOS4lueVjOWdkOagh1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmRCYWNrV29ybGRTcGFjZTEgPSBwbGF5cy5ub2RlLmNvbnZlcnRUb1dvcmxkU3BhY2VBUihjYy52MigwLCAwKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+iOt+WPluebuOWvueeItuiKgueCueaJgOWcqOeahOWdkOagh1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRldGFpbCA9IGNvaW5zTm9kZS5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UxKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW92ZUJ5ID0gY2MubW92ZUJ5KDAuMjUsIGRldGFpbCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRGYWRlSW4gPSBjYy5mYWRlT3V0KDAuMTMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb3ZlU2VxID1jYy5zZXF1ZW5jZShtb3ZlQnksbmV4dEZhZGVJbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29pbnNOb2RlLnJ1bkFjdGlvbihtb3ZlU2VxKSA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBpbml0VGltZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0VGltZSA9IGluaXRUaW1lICsgaW50ZXJ2YWw7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vc3RhcnQgKz0gY1Njb3JlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB6VGltZSA9IGluaXRUaW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHsvL+aYvuekuue7k+aenFxyXG5cclxuICAgICAgICAgICAgICAgIC8vdGhpcy5wbGF5c0NvaW5zLmZvckVhY2goZnVuY3Rpb24obm8pe2lmKG5vKSBuby5hY3RpdmUgPSBmYWxzZTt9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zaG93Q29tcGFyZUNhcmRGaW5pc2hlZCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbXBhcmVQbGF5ZXJzMS5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7cGxheWVyQ29tcC5zaG93U2NvcmVSZXN1bHQoKTt9KTtcclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgelRpbWUpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkgey8v5pi+56S657uT5p6cXHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5c0NvaW5zLmZvckVhY2goZnVuY3Rpb24obm8pe2lmKG5vKSBuby5yZW1vdmVBbGxDaGlsZHJlbigpO30pO1xyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCB6VGltZSArIDUpO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcyksIGR1cmF0aW9uKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9jcmVhdGVKaW5CaVByZWZhYjogZnVuY3Rpb24gKG5vZGUsdjJOb2RlKSB7XHJcblxyXG4gICAgICAgIHZhciBub2RlcyA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY29pbnNQcmVmYWIpO1xyXG5cclxuICAgICAgICB2YXIgeSA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcclxuXHJcbiAgICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozOCkgKiB5ICsgdjJOb2RlLnk7XHJcblxyXG4gICAgICAgIHZhciB4ID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSA9PSAwID8gLTEgOiAxO1xyXG5cclxuICAgICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjM4KSAqIHggKyB2Mk5vZGUueDtcclxuXHJcbiAgICAgICAgbm9kZXMueCA9IHg7XHJcblxyXG4gICAgICAgIG5vZGVzLnkgPSB5O1xyXG5cclxuICAgICAgICBub2RlLmFkZENoaWxkKG5vZGVzKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3Nob3dDb21wYXJlQ2FyZFN0ZXA6IGZ1bmN0aW9uIChzdGFydFRpbWUgPSAwLCBjb21wYXJlUGxheWVycyA9IFtdLCBpc0NvbnRhaW5FeHRyYSA9IGZhbHNlKSB7XHJcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gc3RhcnRUaW1lO1xyXG4gICAgICAgIGxldCBpbnRlcnZhbCA9IHRoaXMuaGVhZENhcmRUaW1lO1xyXG4gICAgICAgIGxldCB0ZXNodVRpbWUgPSAwO1xyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgY29tcGFyZVBsYXllcnMgPSBjb21wYXJlUGxheWVycy5zb3J0KGZ1bmN0aW9uIChwbGF5ZXIxLCBwbGF5ZXIyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwbGF5ZXIxLm5leHRDb21wYXJlU2NvcmUoKSAtIHBsYXllcjIubmV4dENvbXBhcmVTY29yZSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgY289Y29tcGFyZVBsYXllcnM7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjbylcclxuICAgICAgICAvL2NvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0t5omn6KGM5LqG5Yeg5qyhJylcclxuXHJcbiAgICAgICAgY28uZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcblxyXG4gICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd05leHRDb21wYXJlQ2FyZHMoKTtcclxuICAgICAgICAgICAgfSwgZHVyYXRpb24gKyB0ZXNodVRpbWUpO1xyXG5cclxuICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbiArIGludGVydmFsO1xyXG4gICAgICAgICAgICB2YXIgdXNlciA9IHBsYXllci5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXI7XHJcbiAgICAgICAgICAgIGlmKHVzZXIuaXNDb250YWluRXh0cmEpe1xyXG4gICAgICAgICAgICAgICAgaWYodXNlci5jYXJkSW5mb1swXS50eXBlID09IDEwKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3RoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuX3NhbnRvbmdodWFBbmltYXRpb24oKTt9LGR1cmF0aW9uIC0gMSArIHRlc2h1VGltZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRlc2h1VGltZSArPSAyLjU7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZih1c2VyLmNhcmRJbmZvWzBdLnR5cGUgPT0gMTEpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7dGhpcy5ub2RlLmdldENvbXBvbmVudChcImFuaW1hdGlvblwiKS5fc2Fuc2h1bnppQW5pbWF0aW9uKCk7IH0sIGR1cmF0aW9uIC0gMSArIHRlc2h1VGltZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRlc2h1VGltZSArPSAyLjU7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZih1c2VyLmNhcmRJbmZvWzBdLnR5cGUgPT0gMTIpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7dGhpcy5ub2RlLmdldENvbXBvbmVudChcImFuaW1hdGlvblwiKS5fbGl1ZHVpYmFuQW5pbWF0aW9uKCk7fSwgZHVyYXRpb24gLSAxICsgdGVzaHVUaW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGVzaHVUaW1lICs9IDIuNTtcclxuXHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZih1c2VyLmNhcmRJbmZvWzBdLnR5cGUgPT0gMTgpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7dGhpcy5ub2RlLmdldENvbXBvbmVudChcImFuaW1hdGlvblwiKS5fcWluZ2xvbmdBbmlhbXRpb24oJ2xvbmcnKTt9LCBkdXJhdGlvbiAtIDEgKyB0ZXNodVRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0ZXNodVRpbWUgKz0gMi41O1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYodXNlci5jYXJkSW5mb1swXS50eXBlID09IDE5KXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3RoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuX3Fpbmdsb25nQW5pYW10aW9uKFwicWxcIik7fSwgZHVyYXRpb24gLSAxICsgdGVzaHVUaW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGVzaHVUaW1lICs9IDIuNTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYoaXNDb250YWluRXh0cmEpe1xyXG5cclxuICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGNvLmxlbmd0aDsgaSsrKSBkdXJhdGlvbiA9IGR1cmF0aW9uICsgMi41XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICAgICAgaWYocGxheWVyLm5vZGUuYWN0aXZlKXtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5zaG93TmV4dENvbXBhcmVTY29yZShpc0NvbnRhaW5FeHRyYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZHVyYXRpb24gLSBpbnRlcnZhbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgY28uZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGxheWVyLnNob3dOZXh0Q29tcGFyZVNjb3JlKCk7XHJcbiAgICAgICAgICAgICAgICB9LCBkdXJhdGlvbiAtIGludGVydmFsKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZHVyYXRpb24gKyB0ZXNodVRpbWU7XHJcbiAgICB9LFxyXG5cclxuICAgIF9pc0dhbWVPdmVyOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmr5TniYzlrozmiJDlkI7kvJrosIPnlKjnmoTmlrnms5VcclxuICAgIF9zaG93Q29tcGFyZUNhcmRGaW5pc2hlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMudGltZVN0YXJ0KDUsXCJyZWFkeVwiKTtcclxuICAgICAgICB0aGlzLl9zaG93T25lR2FtZVJlc3VsdCgpO1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgICB0aGlzLl9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMucHVzaCh0aGlzLl9kZXNrSW5mby5jSW5kZXgpO1xyXG4gICAgICAgIC8qKi9cclxuICAgIH0sXHJcblxyXG4gICAgLy9uZXR3b3JrXHJcbiAgICBzaG93TmV0d29ya01lc3NhZ2U6ZnVuY3Rpb24obXNnID0gXCLnvZHnu5zpk77mjqXmlq3lvIDvvIzph43mlrDov57mjqXkuK0uLi5cIikge1xyXG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICYmIHRoaXMubmV0d29ya05vZGUuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIHJlbW92ZVNlbGZBY3Rpb24gPSBjYy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUucnVuQWN0aW9uKHJlbW92ZVNlbGZBY3Rpb24pO1xyXG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMubmV0d29ya05vZGUpO1xyXG4gICAgICAgIHZhciBjb21wID0gdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGNvbXAub25EaXNtaXNzQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc2VsZi5uZXR3b3JrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgICBjb21wLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGRlbk5ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc2hvd0FsZXJ0TWVzc2FnZTogZnVuY3Rpb24obXNnLCBhdXRvRGlzbWlzcykge1xyXG4gICAgICAgIGxldCBhbGVydENvbXAgPSB0aGlzLmFsZXJ0LmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBpZiAoIXRoaXMuYWxlcnQuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIGFsZXJ0Q29tcC5hbGVydCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYWxlcnRDb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgICBhbGVydENvbXAudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIGlmIChhdXRvRGlzbWlzcykge1xyXG4gICAgICAgICAgICBhbGVydENvbXAuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0Q29tcC5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgICAgIH0sIDUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy9jaGVja05vZGVcclxuICAgIHNob3dDaGVja01lc3NhZ2U6ZnVuY3Rpb24obXNnID0gJ+ajgOafpee9kee7nOS4rS4uLicpIHtcclxuICAgICAgICBpZiAodGhpcy5jaGVja05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUucnVuQWN0aW9uKHJlbW92ZVNlbGZBY3Rpb24pO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hlY2tOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5jaGVja05vZGUpO1xyXG4gICAgICAgIHZhciBjb21wID0gdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYuY2hlY2tOb2RlID0gbnVsbDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgIGNvbXAuYWxlcnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgaGlkZGVuQ2hlY2tNZXNzYWdlOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrTm9kZSAhPSBudWxsICYmIHRoaXMuY2hlY2tOb2RlLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8vLy8gIOiBiuWkqeivremfs+mAu+i+kVxyXG4gICAgLy8gX3JlZ2lzdGVyVm9pY2VOb2RlRXZlbnRzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgLy8gICAgIGxldCBjaGF0Vm9pY2VOb2RlID0gdGhpcy5idG5DaGF0Vm9pY2Uubm9kZTtcclxuICAgIC8vICAgICB0aGlzLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgLy8gICAgIGNoYXRWb2ljZU5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIC8vICAgICAgICAgaWYgKERhdGUubm93KCkgLSBzZWxmLmVuZFJlY29yZFRpbWUgPj0gMTAwMCkge1xyXG4gICAgLy8gICAgICAgICAgICAgc2VsZi5uYXRpdmVSZWNvcmRBY3Rpb24oKTtcclxuICAgIC8vICAgICAgICAgICAgIC8vc2VsZi52b2ljZVJlY29yZEFuaW1hdGlvbk5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAvLyAgICAgICAgICAgICBsZXQgYWN0aW9uID0gY2Muc2NhbGVUbygwLjEyLCAxLjIpO1xyXG4gICAgLy8gICAgICAgICAgICAgc2VsZi5idG5DaGF0Vm9pY2Uubm9kZS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuXHJcbiAgICAvLyAgICAgICAgICAgICBzZWxmLl9pc1JlY29yZGluZyA9IHRydWU7XHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vICAgICBjaGF0Vm9pY2VOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCxmdW5jdGlvbihldmVudCkge1xyXG4gICAgLy8gICAgICAgICBpZiAoc2VsZi5faXNSZWNvcmRpbmcpIHtcclxuICAgIC8vICAgICAgICAgICAgIHNlbGYuZW5kUmVjb3JkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAvLyAgICAgICAgIHNlbGYubmF0aXZlRW5kUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAvLyAgICAgICAgIC8vc2VsZi52b2ljZVJlY29yZEFuaW1hdGlvbk5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgLy8gICAgICAgICBsZXQgYWN0aW9uID0gY2Muc2NhbGVUbygwLjEyLCAxKTtcclxuICAgIC8vICAgICAgICAgc2VsZi5idG5DaGF0Vm9pY2Uubm9kZS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vICAgICBjaGF0Vm9pY2VOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCxmdW5jdGlvbihldmVudCkge1xyXG4gICAgLy8gICAgICAgICBpZiAoc2VsZi5faXNSZWNvcmRpbmcpIHtcclxuICAgIC8vICAgICAgICAgICAgIHNlbGYuZW5kUmVjb3JkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAvLyAgICAgICAgIHNlbGYubmF0aXZlRW5kUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAvLyAgICAgICAgIC8vc2VsZi52b2ljZVJlY29yZEFuaW1hdGlvbk5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgLy8gICAgICAgICBsZXQgYWN0aW9uID0gY2Muc2NhbGVUbygwLjEyLCAxKTtcclxuICAgIC8vICAgICAgICAgc2VsZi5idG5DaGF0Vm9pY2Uubm9kZS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vICAgICBTb2NrZXQuaW5zdGFuY2UudXBsb2FkRmluaXNoID0gZnVuY3Rpb24odXJsKSB7XHJcbiAgICAvLyAgICAgICAgIGxldCB1c2VySWQgPSBzZWxmLl91c2VySWQ7XHJcbiAgICAvLyAgICAgICAgIFNvY2tldC5zZW5kQXVkaW9NZXNzYWdlKHVzZXJJZCwgdXJsKTtcclxuICAgIC8vICAgICAgICAgc2VsZi5wbGF5U3BlYWtBbmltYXRpb24oc2VsZi5fdXNlcklkKTtcclxuICAgIC8vICAgICB9O1xyXG4gICAgLy8gfSxcclxuXHJcbiAgICBfcmVnaXN0ZXJWb2ljZU5vZGVFdmVudHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgbGV0IGNoYXRWb2ljZU5vZGUgPSB0aGlzLmJ0bkNoYXRWb2ljZS5ub2RlO1xyXG4gICAgICAgIHRoaXMuZW5kUmVjb3JkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCxmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAvLyBzZWxmLlZvaWNlTXNnQmdBbmltYXRpb24oKTtcclxuICAgICAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgICAgICB2YXIgcnVuVGltZSA9IDAuM1xyXG4gICAgICAgICAgICAgICAgdmFyIHRpc2hpID0gY2MuaW5zdGFudGlhdGUoc2VsZi5hdXRvVGlzaGkpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5ub2RlLmFkZENoaWxkKHRpc2hpKTtcclxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBjYy5zcGF3biggY2MubW92ZVRvKDAuMywgY2MudjIoMCwgMCkpLGNjLmZhZGVJbigwLjMpKTtcclxuICAgICAgICAgICAgICAgIHRpc2hpLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICB0aXNoaS5yZW1vdmVGcm9tUGFyZW50KHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBjYy5zZXF1ZW5jZSggY2Muc3Bhd24oY2MuZmFkZU91dChydW5UaW1lKSxjYy5tb3ZlVG8ocnVuVGltZSxjYy52MigwLCA1MCkpKSxmaW5pc2hlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGlzaGkucnVuQWN0aW9uKCBhY3Rpb24gKTtcclxuICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCAxLjUpO1xyXG4gICAgICAgICAgICAgICAgLy92YXIgdXJsID0gXCJ3d3cuYmFpZHUuY29tXCI7XHJcbiAgICAgICAgICAgICAgICAvL2xldCB1c2VySWQgPSBzZWxmLl91c2VySWQ7XHJcbiAgICAgICAgICAgICAgICAvL1NvY2tldC5zZW5kQXVkaW9NZXNzYWdlKHVzZXJJZCwgdXJsKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHNlbGYuZW5kUmVjb3JkVGltZSA+PSAxMDAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5Wb2ljZU1zZ0JnQW5pbWF0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5uYXRpdmVSZWNvcmRBY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aW9uID0gY2Muc2NhbGVUbygwLjEyLCAxLjIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgc2VsZi5Wb2ljZU1zZ0JnLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5faXNSZWNvcmRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuZW5kUmVjb3JkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHNlbGYubmF0aXZlRW5kUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAgICAgICAgIC8vc2VsZi52b2ljZVJlY29yZEFuaW1hdGlvbk5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBsZXQgYWN0aW9uID0gY2Muc2NhbGVUbygwLjEyLCAxKTtcclxuICAgICAgICAgICAgc2VsZi5idG5DaGF0Vm9pY2Uubm9kZS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjaGF0Vm9pY2VOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCxmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBzZWxmLlZvaWNlTXNnQmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLl9pc1JlY29yZGluZykge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5lbmRSZWNvcmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWxmLl9pc1JlY29yZGluZyA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgc2VsZi5uYXRpdmVFbmRSZWNvcmRBY3Rpb24oKTtcclxuICAgICAgICAgICAgLy9zZWxmLnZvaWNlUmVjb3JkQW5pbWF0aW9uTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGxldCBhY3Rpb24gPSBjYy5zY2FsZVRvKDAuMTIsIDEpO1xyXG4gICAgICAgICAgICBzZWxmLmJ0bkNoYXRWb2ljZS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFNvY2tldC5pbnN0YW5jZS51cGxvYWRGaW5pc2ggPSBmdW5jdGlvbih1cmwpIHtcclxuICAgICAgICAgICAgbGV0IHVzZXJJZCA9IHNlbGYuX3VzZXJJZDtcclxuICAgICAgICAgICAgU29ja2V0LnNlbmRBdWRpb01lc3NhZ2UodXNlcklkLCB1cmwpO1xyXG4gICAgICAgICAgICBzZWxmLnBsYXlTcGVha0FuaW1hdGlvbihzZWxmLl91c2VySWQpO1xyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG4gICAgVm9pY2VNc2dCZ0FuaW1hdGlvbjpmdW5jdGlvbigpe1xyXG4gICAgICAgIHRoaXMuVm9pY2VNc2dCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHZhciB3aGlsZUxheW91dCA9IHRoaXMuVm9pY2VNc2dCZy5nZXRDaGlsZEJ5TmFtZShcIndoaWxlTGF5b3V0XCIpO1xyXG4gICAgICAgIHZhciBjaGlsZFdoaWxlID0gd2hpbGVMYXlvdXQuZ2V0Q2hpbGRCeU5hbWUoXCJjaGlsZFdoaWxlXCIpO1xyXG4gICAgICAgIGlmKCB0aGlzLndoaWxlTGF5b3V0SW50ZXJ2YWwgKXtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLndoaWxlTGF5b3V0SW50ZXJ2YWwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy53aGlsZUxheW91dEludGVydmFsID0gIHNldEludGVydmFsKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHZhciBub2RlID0gY2MuaW5zdGFudGlhdGUoY2hpbGRXaGlsZSk7XHJcbiAgICAgICAgICAgIGlmKHdoaWxlTGF5b3V0LmNoaWxkcmVuLmxlbmd0aD41KXtcclxuICAgICAgICAgICAgICAgIHdoaWxlTGF5b3V0LnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgd2hpbGVMYXlvdXQuYWRkQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgfSwyMDApXHJcblxyXG4gICAgICAgIHZhciBsYXlvdXQgPSB0aGlzLlZvaWNlTXNnQmcuZ2V0Q2hpbGRCeU5hbWUoXCJsYXlvdXRcIik7XHJcbiAgICAgICAgdmFyIGNXaGlsZSA9IGxheW91dC5nZXRDaGlsZEJ5TmFtZShcIndoaWxlXCIpO1xyXG4gICAgICAgIFxyXG5cclxuICAgICAgICBpZiggdGhpcy5sYXlvdXRJbnRlcnZhbCApe1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMubGF5b3V0SW50ZXJ2YWwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5sYXlvdXRJbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHZhciBub2RlID0gY2MuaW5zdGFudGlhdGUoY1doaWxlKTtcclxuICAgICAgICAgICAgaWYobGF5b3V0LmNoaWxkcmVuLmxlbmd0aD4zKXtcclxuICAgICAgICAgICAgICAgIGxheW91dC5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxheW91dC5hZGRDaGlsZChub2RlKTtcclxuICAgICAgICB9LDMwMClcclxuICAgIH0sXHJcbiAgICBuYXRpdmVSZWNvcmRBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJyZWNvcmRcIik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZCBjb20ubGxpbmcucWlhbmppYW5nbHpnXHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJyZWNvcmRcIiwgXCIoKVZcIik7XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYXVzZU11c2ljKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBuYXRpdmVFbmRSZWNvcmRBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJlbmRSZWNvcmRcIik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZFxyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZW5kUmVjb3JkXCIsIFwiKClWXCIpO1xyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucmVzdW1lTXVzaWMoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHBsYXlBdWRpb1VybDpmdW5jdGlvbih1cmwpIHtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMjU1M1wiKTtcclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInBsYXlVcmw6XCIsdXJsKTtcclxuICAgICAgICB9IGVsc2UgaWYoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInBsYXlVcmxcIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgdXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6ICDpgIDlh7rmuLjmiI/pgLvovpFcclxuICAgIF9oYW5kbGVVcGRhdGVEZXNrSW5mb0Fib3V0RXhpdFJvb206IGZ1bmN0aW9uKGRlc2tJbmZvKSB7XHJcbiAgICAgICAgaWYgKCFkZXNrSW5mby5pc0Rpc3NvbHZpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZGF0YUluZm9zID0gZGVza0luZm8uZGlzc29sdmVBbnN3ZXJJbmZvO1xyXG5cclxuICAgICAgICBsZXQgYWxlcnRDb21wID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcblxyXG4gICAgICAgIGFsZXJ0Q29tcC5hbGVydCgpO1xyXG5cclxuICAgICAgICBhbGVydENvbXAudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG5cclxuICAgICAgICB0aGlzLmNvbnRlbnRBbnNvd2VyRXhpdE5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihpKXtpLmFjdGl2ZSA9IGZhbHNlO30pO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllckluZm8saW5kZXgpe1xyXG5cclxuICAgICAgICAgICAgdmFyIHBsYXkgPSB0aGlzLmNvbnRlbnRBbnNvd2VyRXhpdE5vZGUuY2hpbGRyZW5baW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgdmFyIG5hbWUgPSBwbGF5LmdldENoaWxkQnlOYW1lKFwibmlja25hbWVcIik7XHJcblxyXG4gICAgICAgICAgICB2YXIgYmFjayA9IHBsYXkuZ2V0Q2hpbGRCeU5hbWUoXCJmYW56aHVcIik7XHJcblxyXG4gICAgICAgICAgICB2YXIgaW1nID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcImF2YXRhcl9iZ1wiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzdHIgPSBwbGF5LmdldENoaWxkQnlOYW1lKFwiaWRcIik7XHJcblxyXG4gICAgICAgICAgICB2YXIgZGF0YUluZm8gPSBkYXRhSW5mb3NbaW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgcGxheS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgbmFtZS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHBsYXllckluZm8ubmlja25hbWU7XHJcblxyXG4gICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSBwbGF5ZXJJbmZvLmlkKXsvL+aYvuekuuaIv+S4u1xyXG5cclxuICAgICAgICAgICAgICAgIGJhY2suYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG5cclxuICAgICAgICAgICAgICAgIGJhY2suYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6cGxheWVySW5mby5hdmF0YXJVcmwsdHlwZTpcImpwZ1wifSwgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlcnIpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUoZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaW1nLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gZnJhbWU7XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgaWYoZGF0YUluZm8gPT0gMSl7XHJcblxyXG4gICAgICAgICAgICAgICAgc3RyLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCLlkIzmhI9cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG5cclxuICAgICAgICAgICAgICAgIHN0ci5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgbGV0IGRpc3NvbHZlTGVmdFRpbWUgPSBkZXNrSW5mby5kaXNzb2x2ZUxlZnRUaW1lIHx8IDYwO1xyXG5cclxuICAgICAgICBsZXQgY291bnRkb3duID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpO1xyXG5cclxuICAgICAgICBjb3VudGRvd24uc3RhcnRDb3VudGRvd24oZGlzc29sdmVMZWZ0VGltZSwgZnVuY3Rpb24oaXNUaW1lb3V0KSB7XHJcblxyXG4gICAgICAgICAgICBpZiAoaXNUaW1lb3V0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsaWNrQWdyZWVPdGhlclBsYXllckV4aXQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICBsZXQgZGlzc29sdmVVc2VySWQgPSBkZXNrSW5mby5kaXNzb2x2ZVVzZXJJZDtcclxuXHJcbiAgICAgICAgaWYgKGRpc3NvbHZlVXNlcklkID09IHRoaXMuX3VzZXJJZCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGFsZXJ0X2JnID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDaGlsZEJ5TmFtZShcImFsZXJ0X2JnXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGJ0bkFncmVlID0gYWxlcnRfYmcuZ2V0Q2hpbGRCeU5hbWUoXCJidG5BZ3JlZVwiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBidG5EaXNhZ3JlZSA9IGFsZXJ0X2JnLmdldENoaWxkQnlOYW1lKFwiYnRuRGlzYWdyZWVcIik7XHJcblxyXG4gICAgICAgICAgICBidG5BZ3JlZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGJ0bkRpc2FncmVlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL3RoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy90aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDYW5jZWxCdXR0b24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy90aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDb25maXJtQnV0dG9uLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vbGV0IGFsZXJ0ID0gdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgICAgIC8vYWxlcnQuc2V0TWVzc2FnZShcIuaCqOato+WcqOeUs+ivt+WNj+WVhumAgOWHuu+8jOetieW+heWFtuS7lueOqeWutuWQjOaEj1wiKTtcclxuICAgICAgICAgICAgLy90aGlzLmFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RhcnRDb3VudGRvd24oZGlzc29sdmVMZWZ0VGltZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAvL2xldCBkaXNzb2x2ZUFuc3dlckluZm9zID0gZGVza0luZm8uZGlzc29sdmVBbnN3ZXJJbmZvO1xyXG4gICAgICAgIC8vbGV0IGN1cnJlbnRVc2VySWRJbmRleCA9IGRlc2tJbmZvLnBsYXllcnNJbmRleC5maW5kSW5kZXgoZnVuY3Rpb24odXNlcklkKSB7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuIHRoaXMuX3VzZXJJZCA9PSB1c2VySWQ7XHJcbiAgICAgICAgLy99LmJpbmQodGhpcykpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy9sZXQgYW5zd2VyUmVzdWx0ID0gZGlzc29sdmVBbnN3ZXJJbmZvc1tjdXJyZW50VXNlcklkSW5kZXhdO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy9pZiAoYW5zd2VyUmVzdWx0ID09IC0xKSB7XHJcbiAgICAgICAgLy8gICAgLy8gLTEg6KGo56S65pyq5aSE55CGICAwIOihqOekuuaLkue7nSAgMeihqOekuuWQjOaEj1xyXG4gICAgICAgIC8vICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgIGxldCBjb3VudGRvd24gPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJyk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICBjb3VudGRvd24uc3RhcnRDb3VudGRvd24oZGlzc29sdmVMZWZ0VGltZSwgZnVuY3Rpb24oaXNUaW1lb3V0KSB7XHJcbiAgICAgICAgLy8gICAgICAgIGlmIChpc1RpbWVvdXQpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuY2xpY2tBZ3JlZU90aGVyUGxheWVyRXhpdCgpO1xyXG4gICAgICAgIC8vICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vfVxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgLy8g56Gu5a6a6KaB5by65Yi26YCA5Ye65ri45oiPXHJcbiAgICBjbGlja0NvbmZpcm1Gb3JjZUV4aXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIFNvY2tldC5zZW5kRm9yY2VFeGl0Um9vbSh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDnoa7orqTor7fmsYLpgIDlh7rmuLjmiI9cclxuICAgIGNsaWNrQ29uZmlybVJlcXVlc3RFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q29uZmlybUJ1dHRvbi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBhbGVydCA9IHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNJbmRleD4wKXtcclxuICAgICAgICAgICAgYWxlcnQuc2V0TWVzc2FnZShcIuaCqOato+WcqOeUs+ivt+WNj+WVhumAgOWHuu+8jOetieW+heWFtuS7lueOqeWutuWQjOaEj1wiKTtcclxuICAgICAgICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0YXJ0Q291bnRkb3duKDYwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgU29ja2V0LnNlbmRMZWF2ZURlc2sodGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5ZCM5oSP5LuW5Lq66YCA5Ye6XHJcbiAgICBjbGlja0FncmVlT3RoZXJQbGF5ZXJFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy90aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgLy90aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgLy90aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgICAgIHZhciBhbGVydF9iZyA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJhbGVydF9iZ1wiKTtcclxuICAgICAgICB2YXIgYnRuQWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkFncmVlXCIpO1xyXG4gICAgICAgIHZhciBidG5EaXNhZ3JlZSA9IGFsZXJ0X2JnLmdldENoaWxkQnlOYW1lKFwiYnRuRGlzYWdyZWVcIik7XHJcbiAgICAgICAgYnRuQWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgYnRuRGlzYWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgU29ja2V0LnNlbmRBbnN3ZXJEaXNzb2x2ZSh0aGlzLl91c2VySWQsIDEpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDkuI3lkIzmhI/ku5bkurrpgIDlh7pcclxuICAgIGNsaWNrRGlzYWdyZWVPdGhlclBsYXllckV4aXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL3RoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICAvL3RoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICAvL3RoaXMuYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdG9wKCk7XHJcbiAgICAgICAgdmFyIGFsZXJ0X2JnID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDaGlsZEJ5TmFtZShcImFsZXJ0X2JnXCIpO1xyXG4gICAgICAgIHZhciBidG5BZ3JlZSA9IGFsZXJ0X2JnLmdldENoaWxkQnlOYW1lKFwiYnRuQWdyZWVcIik7XHJcbiAgICAgICAgdmFyIGJ0bkRpc2FncmVlID0gYWxlcnRfYmcuZ2V0Q2hpbGRCeU5hbWUoXCJidG5EaXNhZ3JlZVwiKTtcclxuICAgICAgICBidG5BZ3JlZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBidG5EaXNhZ3JlZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBTb2NrZXQuc2VuZEFuc3dlckRpc3NvbHZlKHRoaXMuX3VzZXJJZCwgMCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOmakOiXj+ivt+axgumAgOWHuiBOb2RlXHJcbiAgICBfaGlkZVJlcWVzdEV4aXROb2RlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdG9wKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vLy8g5omT5p6qXHJcbiAgICBwbGF5U2hvb3Q6IGZ1bmN0aW9uIChmcm9tVXNlcklkLCB0b1VzZXJJZCkge1xyXG4gICAgICAgIGxldCB1c2VyID0gdGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZChmcm9tVXNlcklkKTtcclxuICAgICAgICBpZiAodXNlcikge1xyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUh1bWFuRGFRaWFuZyh1c2VyLnNleCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdG9Vc2VySW5kZXggPSB0aGlzLl9maW5kUGxheWVySW5kZXhCeVVzZXJJZCh0b1VzZXJJZCk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuX3VzZXJJZCA9PSBmcm9tVXNlcklkIHx8IHRoaXMuX3VzZXJJZCA9PSB0b1VzZXJJZCkgcGxheWVyLnNob3dOZXh0Q29tcGFyZVNjb3JlKCk7XHJcbiAgICAgICAgICAgIHBsYXllci5wbGF5U2hvb3RBbmltYXRpb24oZnJvbVVzZXJJZCwgdG9Vc2VySW5kZXgpO1xyXG4gICAgICAgICAgICBwbGF5ZXIucGxheUJ1bGxldEhvbGVBbmltYXRpb24odG9Vc2VySWQpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaSreaUvuWFqOWekuaJk+WKqOaViFxyXG4gICAgcGxheUhvbWVSdW46IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICBsZXQgdXNlciA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodXNlcklkKTtcclxuICAgICAgICBpZiAodXNlcikge1xyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUhvbWVSdW4odXNlci5zZXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiYW5pbWF0aW9uXCIpLl9xdWFubGVpZGFBbmltYXRpb24oJ2xvbmcnKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuXHJcbiAgICAgICAgICAgIHBsYXllci5zaG93TmV4dENvbXBhcmVTY29yZSgpO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcGxheVNwZWFrQW5pbWF0aW9uOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyLnBsYXlTcGVha0FuaW1hdGlvbih1c2VySWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc2hvb3REYXRhczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGxldCBob21lUnVuVXNlcklkID0gdGhpcy5faG9tZVJ1blVzZXJJZCgpOyAvLyDlhajlnpLmiZNcclxuICAgICAgICBsZXQgc2hvb3REYXRhcyA9IHRoaXMuX2Rlc2tJbmZvLnNob3REYXRhLmZpbHRlcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YS5mcm9tVXNlcklkID09IGhvbWVSdW5Vc2VySWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHNob290RGF0YXM7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zaG90RGF0YTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGxldCBob21lUnVuVXNlcklkID0gdGhpcy5faG9tZVJ1blVzZXJJZCgpOyAvLyDmiZPmnqpcclxuICAgICAgICBsZXQgc2hvdERhdGEgPSB0aGlzLl9kZXNrSW5mby5zaG90RGF0YS5maWx0ZXIoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGEuZnJvbVVzZXJJZCAhPSBob21lUnVuVXNlcklkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBzaG90RGF0YTtcclxuICAgIH0sXHJcblxyXG4gICAgX2hvbWVSdW5Vc2VySWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVza0luZm8uYWxsU2hvdERhdGE7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6IOaIv+mXtOS/oeaBr+mDqOWIhlxyXG5cclxuICAgIC8vIOiOt+WPluaIv+mXtOeahOeOqeazlVxyXG4gICAgX2Rlc2tJbmZvR2FtZVdheTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHNldHRpbmcgPSB0aGlzLl9kZXNrSW5mby5zZXR0aW5nMztcclxuICAgICAgICBpZihzZXR0aW5nID09IG51bGwpe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IG5hbWVzID0gW1wi5bqE5a625qih5byPXCIsIFwi5peg54m55q6K54mMXCIsXCLmma7pgJrmqKHlvI9cIl07XHJcbiAgICAgICAgcmV0dXJuIG5hbWVzW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGVza0luZm9OdW1iZXJPZkdhbWU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzE7XHJcbiAgICAgICAgbGV0IGluZm9zID0gWycxMOWxgCcsICcyMOWxgCcsICc0MOWxgCcsICc15bGAJ107XHJcbiAgICAgICAgLyppZiAoc2V0dGluZyA8PSAxKSB7XHJcbiAgICAgICAgIHJldHVybiAn5p2h5pWw77yaJyArIGluZm9zW3NldHRpbmddO1xyXG4gICAgICAgICB9Ki9cclxuICAgICAgICBpZihzZXR0aW5nID09IDIpe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZihzZXR0aW5nID09IDMpe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZihzZXR0aW5nID09IDQpe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZihzZXR0aW5nID09IDUpe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICflsYDmlbDvvJonICsgaW5mb3Nbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIF9kZXNrSW5mb051bWJlck9mUGVvcGxlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgc2V0dGluZyA9IHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcyO1xyXG4gICAgICAgIGxldCBpbmZvcyA9IFsnMuS6uicsICcz5Lq6JywgJzTkuronLCAnNeS6uiddO1xyXG4gICAgICAgIHJldHVybiBpbmZvc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rlc2tJbmZvUGF5SW5mbzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHNldHRpbmcgPSB0aGlzLl9kZXNrSW5mby5zZXR0aW5nNDtcclxuICAgICAgICBpZihzZXR0aW5nID09IG51bGwpe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoc2V0dGluZyA9PSAwKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpbmZvcyA9IFsn5oi/5Li76Zy45Li75bqEJywgJ+aIv+i0uUFBJ107XHJcbiAgICAgICAgcmV0dXJuIGluZm9zW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGVza0luZm9KaWFZaVNlSW5mbzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHNldHRpbmcgPSB0aGlzLl9kZXNrSW5mby5zZXR0aW5nNyA9PSAwID8gMSA6IDA7XHJcbiAgICAgICAgbGV0IGluZm9zID0gWyfml6DlpJrkuIDoibInLCAn5aSa5LiA6ImyJ107XHJcbiAgICAgICAgcmV0dXJuIGluZm9zW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGVza0luZm9HdWlQYWlJbmZvOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgc2V0dGluZztcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nOCA9PSBudWxsKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzggPT0gMCl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc4ID09IDEpe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGluZm9zID0gWyfml6DnjovniYwnLCAn5Lik5byg546L54mMJywgJ+Wbm+W8oOeOi+eJjCddO1xyXG4gICAgICAgIHJldHVybiBpbmZvc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gTUFSSzog5Ymp5L2Z5pe26Ze0XHJcbiAgICBfcmVtYWluVGltZVN0YXJ0VXBkYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL3RoaXMuc2NoZWR1bGUodGhpcy5fcmVtYWluVGltZVVwZGF0ZSwgMS4wLCBjYy5tYWNyby5SRVBFQVRfRk9SRVZFUik7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yZW1haW5UaW1lVXBkYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5faXNSYW5kb21Sb29tKCkgfHwgUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mbyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBpc1Rhb1NodSA9ICh0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSA9PSAwKSB8fCAodGhpcy5fZGVza0luZm8uc2V0dGluZzEgPT0gMSk7XHJcbiAgICAgICAgaWYgKGlzVGFvU2h1KSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5fZGVza0luZm8uY3JlYXRlVGltZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgbGV0IGNyZWF0ZVRpbWUgPSBmZWNoYS5wYXJzZSh0aGlzLl9kZXNrSW5mby5jcmVhdGVUaW1lLCAnWVlZWS1NTS1ERCBISDptbTpzcycpLmdldFRpbWUoKTtcclxuICAgICAgICBsZXQgb25lSG91ciA9IDYwICogNjA7XHJcbiAgICAgICAgbGV0IHJlbWFpbiA9IChEYXRlLm5vdygpIC0gY3JlYXRlVGltZSkgLyAxMDAwO1xyXG4gICAgICAgIHJlbWFpbiA9IE1hdGgubWF4KG9uZUhvdXIgLSByZW1haW4sIDApO1xyXG5cclxuICAgICAgICBsZXQgbWlucyA9IE1hdGguZmxvb3IocmVtYWluIC8gNjApO1xyXG4gICAgICAgIGxldCBzZWNzID0gTWF0aC5mbG9vcihyZW1haW4gJSA2MCk7XHJcbiAgICAgICAgaWYgKG1pbnMgPT0gMCAmJiBzZWNzID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIG1pbnNTdHJpbmcgPSBcIlwiICsgbWlucztcclxuICAgICAgICBpZiAobWluc1N0cmluZy5sZW5ndGggPCAyKSB7XHJcbiAgICAgICAgICAgIG1pbnNTdHJpbmcgPSBcIjBcIiArIG1pbnNTdHJpbmc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgc2Vjc1N0cmluZyA9IFwiXCIgKyBzZWNzO1xyXG4gICAgICAgIGlmIChzZWNzU3RyaW5nLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICAgICAgc2Vjc1N0cmluZyA9IFwiMFwiICsgc2Vjc1N0cmluZztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBzdHJpbmcgPSBcIuWJqeS9meaXtumXtO+8mjAwOlwiICsgbWluc1N0cmluZyArIFwiOlwiICsgc2Vjc1N0cmluZztcclxuICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5zdHJpbmcgPSBzdHJpbmc7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6IOWkhOeQhuWQjCBJUCDnmoTnlKjmiLdcclxuICAgIF9oYW5kbGVUaGVTYW1lT2ZJUEFkcmVzczogZnVuY3Rpb24odXNlckluZm9zKSB7XHJcbiAgICAgICAgaWYgKCF1c2VySW5mb3MgfHwgdXNlckluZm9zLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBpcFVzZXJJbmZvcyA9IHVzZXJJbmZvcy5yZWR1Y2UoZnVuY3Rpb24oaXBzLCB1c2VySW5mbykge1xyXG4gICAgICAgICAgICBsZXQgdXNlcnMgPSBpcHNbdXNlckluZm8uaXBBZGRyZXNzXSB8fCBbXTtcclxuICAgICAgICAgICAgdXNlcnMucHVzaCh1c2VySW5mbyk7XHJcblxyXG4gICAgICAgICAgICBpcHNbdXNlckluZm8uaXBBZGRyZXNzXSA9IHVzZXJzO1xyXG4gICAgICAgICAgICByZXR1cm4gaXBzO1xyXG4gICAgICAgIH0sIHt9KTtcclxuXHJcbiAgICAgICAgbGV0IHNhbWVJcFVzZXJzID0gbnVsbDtcclxuICAgICAgICBmb3IgKGxldCBpcCBpbiBpcFVzZXJJbmZvcykge1xyXG4gICAgICAgICAgICBsZXQgdXNlcnMgPSBpcFVzZXJJbmZvc1tpcF07XHJcbiAgICAgICAgICAgIGlmICh1c2Vycy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBzYW1lSXBVc2VycyA9IHVzZXJzO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChzYW1lSXBVc2VycyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX2FsZXJ0U2FtZUlwVXNlckluZm9zKHNhbWVJcFVzZXJzKTtcclxuICAgIH0sXHJcblxyXG4gICAgX2FsZXJ0U2FtZUlwVXNlckluZm9zOiBmdW5jdGlvbih1c2Vycykge1xyXG4gICAgICAgIGxldCBtZXNzYWdlID0gXCJcIjtcclxuICAgICAgICBsZXQgdXNlcklkcyA9IFwiXCI7XHJcbiAgICAgICAgdXNlcnMuZm9yRWFjaChmdW5jdGlvbih1c2VyLCBpbmRleCkge1xyXG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZSArIChpbmRleCA+IDAgPyAnIOWSjCAnIDogJycpICsgdXNlci5uaWNrbmFtZTtcclxuICAgICAgICAgICAgdXNlcklkcyA9IHVzZXJJZHMgKyB1c2VyLmlkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlICsgJyDlnKjlkIzkuIAgSVAg5LiL77yBJztcclxuXHJcbiAgICAgICAgdGhpcy5fZGlkQWxlcnRTYW1lSXBNZXNzYWdlID0gdGhpcy5fZGlkQWxlcnRTYW1lSXBNZXNzYWdlIHx8IHt9O1xyXG4gICAgICAgIGlmICh0aGlzLl9kaWRBbGVydFNhbWVJcE1lc3NhZ2VbdXNlcklkc10pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zaG93QWxlcnRNZXNzYWdlKG1lc3NhZ2UsIHRydWUpO1xyXG4gICAgICAgIHRoaXMuX2RpZEFsZXJ0U2FtZUlwTWVzc2FnZVt1c2VySWRzXSA9IHRydWU7XHJcbiAgICB9LFxyXG5cclxufSk7XHJcblBsYXkuZ29uZ1hpTmlTaG93ID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgIHRoaXMuaW5zdGFuY2VzLl9nb25nWGlOaVNob3codHlwZSk7XHJcbn07XHJcbm1vZHVsZS5leHBvcnRzID0gUGxheTtcclxuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgcHJvZHVjdElkOicnLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG4gICAgXG4gICAgY2xpY2tBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMub25DbGlja0FjdGlvbih0aGlzLnByb2R1Y3RJZCk7ICAgICAgICBcbiAgICB9LFxuICAgIFxuICAgIG9uQ2xpY2tBY3Rpb246ZnVuY3Rpb24ocHJvZHVjdElkKSB7XG4gICAgICAgIFxuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG1hdGNoaW5nTGFiZWw6Y2MuTGFiZWwsXG4gICAgICAgIHRpbWVOb2RlOmNjLk5vZGUsXG4gICAgICAgIG1hdGNoaW5nTm9kZTpjYy5Ob2RlLFxuICAgICAgICB3YWl0aW5nUHJlZmFiOiBjYy5QcmVmYWIsXG4gICAgICAgIGFsZXJ0UHJlZmFiOiBjYy5QcmVmYWIsXG5cbiAgICAgICAgdGlzaGk6Y2MuTm9kZSxcblxuICAgICAgICBfdXNlcklkOiBudWxsLFxuICAgICAgICBfcmVzcG9uc2U6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgY2MuaXNSb29tVmlld1Nob3cgPSB0cnVlO1xuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZURlc2tJbmZvLCB0aGlzLl9zb2NrZXRSZWNlaXZlRGVza0luZm8gLHRoaXMpO1xuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0RGlzY29ubmVjdCwgdGhpcy5fc29ja2V0RGlzY29ubmVjdCwgdGhpcyk7XG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0U3VjY2Vzc2VkLCB0aGlzLl9zb2NrZXRDb25uZWN0ZWQsIHRoaXMpO1xuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUludGVyUmFuZG9tLCB0aGlzLl9zb2NrZXRSZWNlaXZlSW50ZXJSYW5kb20sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBfc29ja2V0UmVjZWl2ZURlc2tJbmZvOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgfSxcblxuICAgIF9zb2NrZXRSZWNlaXZlSW50ZXJSYW5kb206IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIC8v5pyN5Yqh5Zmo5Y+R6YCBICB7J2FjdGlvbic6J2ludGVyUmFuZG9tJywncmVzdWx0JzpmYWxzZSwnZGF0YSc6eydyZWFzb24nOnJlYXNvbn19XG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gcmVzcG9uc2U7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLl90aW1lb3V0UmFuZG9tQWN0aW9uKTtcbiAgICAgICAgLy8g5aSE55CG6ZqP5py65Zy65Yy56YWN5LiN5oiQ5Yqf55qE5oOF5Ya1XG4gICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCByZWFzb24gPSByZXNwb25zZS5kYXRhLnJlYXNvbiB8fCBcIuWKoOWFpemaj+acuuWcuuWksei0pVwiO1xuICAgICAgICB0aGlzLnNob3dBbGVydE1lc3NhZ2UocmVhc29uKTtcblxuICAgICAgICBpZiAocmVhc29uID09ICfkvaDlt7Lnu4/lnKjljLnphY3pmJ/liJcnKSB7XG4gICAgICAgICAgICB0aGlzLl9zaG93TWF0Y2hpbmcoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVNYXRjaGluZygpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIF9zb2NrZXREaXNjb25uZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgIC8vIOi/nuaOpeW3suaWreW8gFxuICAgICAgdGhpcy5tYXRjaGluZ05vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLnNob3dOZXR3b3JrTWVzc2FnZSgn572R57uc6ZO+5o6l5pat5byA77yM6YeN5paw6L+e5o6l5LitLi4uJyk7XG4gICAgfSxcblxuICAgIF9zb2NrZXRDb25uZWN0ZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5oaWRkZW5OZXR3b3JrTWVzc2FnZSgpO1xuICAgIH0sXG5cblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xuICAgICAgS1FHbG9iYWxFdmVudC5vZmZUYXJnZXQodGhpcyk7XG4gICAgfSxcblxuICAgIGNsaWNrRXhpdDogZnVuY3Rpb24gKCkge1xuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcbiAgICB9LFxuXG4gICAgY2xpY2tTdGFydDogZnVuY3Rpb24gKCkge1xuICAgICAgU29ja2V0LnNlbmRFbnRlclJhbmRvbSh0aGlzLl91c2VySWQpO1xuICAgICAgdGhpcy5fc2hvd01hdGNoaW5nKCk7XG5cbiAgICAgIC8qIyMjIyNiZWdpbiovXG4gICAgICAvL3JlYXNvbuaYr+acjeWKoeWZqOWPkemAgeWbnuadpeeahFxuICAgICAgLyppZih0aGlzLl9yZXNwb25zZS5kYXRhLnJlYXNvbiA9PSBcIuS9oOeahOmSu+efs+S4jei2s1wiKXtcbiAgICAgICAgICB0aGlzLnRpc2hpLmFjdGl2ZSA9IHRydWU7XG4gICAgICB9Ki9cbiAgICAgIC8qIyMjIyNlbmQqL1xuXG4gICAgICB0aGlzLnNjaGVkdWxlT25jZSh0aGlzLl90aW1lb3V0UmFuZG9tQWN0aW9uLCA1KTtcbiAgICB9LFxuICAgIC8qIyMjIyPngrnlh7vnqbrnmb3lnLDmlrnvvIznoJbnn7PkuI3otrPmj5DnpLrmtojlpLEqL1xuICAgIC8qb25CdG5Lb25nOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYodGhpcy50aXNoaS5hY3RpdmUpe1xuICAgICAgICAgICAgdGhpcy50aXNoaS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAvL+S7gOS5iOS5n+S4jeWBmlxuICAgICAgICB9XG4gICAgfSwqL1xuICAgIC8q5Y+W5raI5Yy56YWNKi9cbiAgICBjbGlja0NhbmNlbDpmdW5jdGlvbiAoKSB7XG4gICAgICBTb2NrZXQuc2VuZENhbmNlbFJhbmRvbSh0aGlzLl91c2VySWQpO1xuXG4gICAgICB0aGlzLl9oaWRlTWF0Y2hpbmcoKTtcbiAgICB9LFxuXG4gICAgX3RpbWVvdXRSYW5kb21BY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9oaWRlTWF0Y2hpbmcoKTtcbiAgICAgICAgdGhpcy5zaG93QWxlcnRNZXNzYWdlKCfov5vlhaXljLnphY3lpLHotKUnKTtcbiAgICB9LFxuXG4gICAgX3Nob3dNYXRjaGluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5tYXRjaGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgICAgIHRoaXMubWF0Y2hpbmdMYWJlbC5zdHJpbmcgPSAn5q2j5Zyo5Yy56YWN5Lit77yM6K+356iN5ZCOLi4uJztcbiAgICAgICAgbGV0IG51bSA9IDA7XG4gICAgICAgIHRoaXMuc2NoZWR1bGUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBudW0gPSBudW0gKyAwLjU7XG4gICAgICAgICAgICB0aGlzLnRpbWVOb2RlLnJvdGF0aW9uID0gbnVtO1xuICAgICAgICAgfSwgMC4wMSk7XG4gICAgfSxcblxuICAgIF9oaWRlTWF0Y2hpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMubWF0Y2hpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5kaXNtaXNzQWN0aW9uKCk7XG4gICAgfSxcblxuICAgICBzaG93TmV0d29ya01lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLl90aW1lb3V0UmFuZG9tQWN0aW9uKTtcblxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUucnVuQWN0aW9uKHJlbW92ZVNlbGZBY3Rpb24pO1xuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLm5ldHdvcmtOb2RlKTtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLm5ldHdvcmtOb2RlID0gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgaGlkZGVuTmV0d29ya01lc3NhZ2U6ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzaG93QWxlcnRNZXNzYWdlOiBmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgaWYgKCFtc2cpIHtcbiAgICAgICAgICAgIGNjLmVycm9yKFwi5LiN6IO95pi+56S65Li656m655qE5L+h5oGvXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLmFsZXJ0TWVzc2FnZU5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYWxlcnRQcmVmYWIpO1xuICAgICAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMuYWxlcnRNZXNzYWdlTm9kZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZU5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2VOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xuY29uc3QgcmVjb3JkID0gcmVxdWlyZSgncmVjb3JkJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHRpbWVMYWJlbDpjYy5MYWJlbCwgICAvLyDml7bpl7RcbiAgICAgICAganVzaHVMYWJlbDpjYy5MYWJlbCwgIC8vIOWxgOaVsFxuICAgICAgICBjcmVhdGVVc2VyOmNjLk5vZGUsICAgLy8g5oi/5Li7XG4gICAgICAgIHJvb21JZDpjYy5MYWJlbCwgICAgICAvLyDmiL/pl7Tlj7dcbiAgICAgICAgamlmZW46Y2MuTGFiZWwsICAgICAgIC8vIOenr+WIhlxuICAgICAgICBpZDpjYy5MYWJlbCxcbiAgICAgICAgYXZhdGFyTm9kZTpjYy5Ob2RlLCAgIC8vIOWktOWDj1xuICAgICAgICBjcmVhdG9ySW1nOmNjLk5vZGUsICAgLy8g5Yib5oi/5aS05YOPXG4gICAgICAgIG5pY2tuYW1lTGFiZWxzOmNjLkxhYmVsLFxuICAgICAgICBzY29yZUxhYmVsczpbY2MuTGFiZWxdLFxuICAgICAgICAvL251bU5vZGU6Y2MuTGFiZWwsXG4gICAgICAgIF9wYXJlbnRJZDogbnVsbCxcbiAgICAgICAgLy9wbGF5YmFja05vZGU6Y2MuTm9kZSwvL+WbnuaUvuaMiemSrlxuICAgICAgICAvL3dhdGNoTm9kZTpjYy5Ob2RlLC8v5p+l55yL5oyJ6ZKuXG4gICAgICAgIHJlb3JkSW5mbzpjYy5Ob2RlLFxuICAgICAgICBfcmVjb3JkSXRlbUluZm86IG51bGwsXG4gICAgICAgIHRvdGFsR2FtZVJlc3VsdDpjYy5Ob2RlLFxuXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnRvdGFsR2FtZVJlc3VsdCA9IGNjLmZpbmQoXCJDYW52YXMvcmVjb3JkSW5mb1wiKTtcbiAgICB9LFxuXG4gICAgc2V0SW5mbzogZnVuY3Rpb24gKHJlY29yZEluZm8pIHtcbiAgICAgICAgdGhpcy5fcGFyZW50SWQgPSByZWNvcmRJbmZvLmlkO1xuICAgICAgICAvL3RoaXMud2F0Y2hOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIC8vdGhpcy5wbGF5YmFja05vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIGlmIChyZWNvcmRJbmZvLnBsYXllcnNJbmZvLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgcGxheWVyc0luZm8gPSBKU09OLnBhcnNlKHJlY29yZEluZm8ucGxheWVyc0luZm8pO1xuICAgICAgICByZWNvcmRJbmZvLnNjb3JlcyA9IEpTT04ucGFyc2UoIHJlY29yZEluZm8uc2NvcmVzICk7XG5cbiAgICAgICAgdmFyIGZlbiA9IHJlY29yZEluZm8uc2NvcmVzWyB0aGlzLmZlbihyZWNvcmRJbmZvLnVzZXJpZCxwbGF5ZXJzSW5mby5wbGF5ZXJzSW5kZXgpIF0gO1xuICAgICAgICAvL2NjLmxvZyhmZW4pXG4gICAgICAgIC8vY2MubG9nKHJlY29yZEluZm8uc2NvcmVzKVxuICAgICAgICAvL2NjLmxvZyh0aGlzLmZlbihyZWNvcmRJbmZvLnVzZXJpZCxwbGF5ZXJzSW5mby5wbGF5ZXJzSW5kZXgpKVxuICAgICAgICAvL2NjLmxvZyhyZWNvcmRJbmZvLnVzZXJpZClcbiAgICAgICAgLy9jYy5sb2cocGxheWVyc0luZm8ucGxheWVyc0luZGV4KVxuICAgICAgICAvL2NjLmxvZyhyZWNvcmRJbmZvKVxuICAgICAgICAvL2NjLmxvZyhwbGF5ZXJzSW5mbylcbiAgICAgICAgLy9jYy5sb2coJy0tLS00NycpXG4gICAgICAgIHRoaXMuamlmZW4uc3RyaW5nID0gKGZlbiA+PSAwP1wiK1wiK2ZlbiA6ZmVuKTtcblxuICAgICAgICB2YXIgaGVhZFVybCA9IHBsYXllcnNJbmZvLnBsYXllcnNbIHRoaXMuY3JlYXRvcihyZWNvcmRJbmZvLmNyZWF0ZVVzZXJJZCxwbGF5ZXJzSW5mby5wbGF5ZXJzSW5kZXgpIF0uYXZhdGFyVXJsOyAvLyDlpLTlg49VUkxcbiAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuYXZhdGFyTm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgY2MubG9hZGVyLmxvYWQoe3VybDpoZWFkVXJsLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIHRleCkge1xuICAgICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4KTtcbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWU9ZnJhbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucm9vbUlkLnN0cmluZyA9IFwi5oi/5Y+377yaXCIrIHBsYXllcnNJbmZvLnJvb21JZDtcbiAgICAgICAgdGhpcy50aW1lTGFiZWwuc3RyaW5nID0gXCLml7bpl7TvvJpcIiArIHBsYXllcnNJbmZvLnRpbWUuc3Vic3RyKDUsMTEpO1xuICAgICAgICB0aGlzLmp1c2h1TGFiZWwuc3RyaW5nID0gXCLlsYDmlbDvvJpcIisgdGhpcy5qcyhwbGF5ZXJzSW5mby5zZXR0aW5nMS0yKTtcblxuICAgICAgICAgLy9mb3IgKHZhciBpID0gMDtpIDwgcGxheWVyc0luZm8ucGxheWVycy5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAvLyAgdGhpcy5uaWNrbmFtZUxhYmVsc1tpXS5zdHJpbmcgPSBwbGF5ZXJzSW5mby5wbGF5ZXJzW2ldLm5pY2tuYW1lO1xuICAgICAgICAgLy8gIHRoaXMuc2NvcmVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc0luZm8ucGxheWVyc1tpXS50b3RhbFNjb3JlO1xuICAgICAgICAgLy99XG4gICAgfSxcbiAgICBqczogZnVuY3Rpb24oc2V0dGluZzIpe1xuICAgICAgICB2YXIganVzaHUgPSA1O1xuICAgICAgICBzd2l0Y2goc2V0dGluZzIpe1xuICAgICAgICAgICAgY2FzZSAwOiBqdXNodSA9IDU7IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOiBqdXNodSA9IDEwOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjoganVzaHUgPSAyMDsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6IGp1c2h1ID0gMzA7IGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBqdXNodTtcbiAgICB9LFxuXG4gICAgZmVuOmZ1bmN0aW9uKHVzZXJpZCxwbGF5ZXJzKXsgICAgICAgICAvLyDmib7np6/liIZcbiAgICAgICAgZm9yKHZhciBpID0wOyBpPHBsYXllcnMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICBpZihwbGF5ZXJzW2ldID09IHVzZXJpZCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGNyZWF0b3IgOmZ1bmN0aW9uKGNyZWF0b3IscGxheWVycyl7ICAgIC8v5Yib5oi/6ICFXG4gICAgICAgIGZvcih2YXIgaSA9MDsgaTxwbGF5ZXJzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgaWYocGxheWVyc1tpXSA9PSBjcmVhdG9yKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBjbGlja0FjdGlvbjogZnVuY3Rpb24oIGV2ZW50LCBkYXRhICkge1xuICAgICAgICBsZXQgcGxheWVyc0luZm8gPSBKU09OLnBhcnNlKGRhdGEucGxheWVyc0luZm8pO1xuICAgICAgICBsZXQgdG90YWxHYW1lUmVzdWx0Q29tcCA9IHRoaXMudG90YWxHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnVG90YWxHYW1lUmVzdWx0Jyk7XG4gICAgICAgIHRvdGFsR2FtZVJlc3VsdENvbXAuc2V0UGxheWVySW5mb3MocGxheWVyc0luZm8ucGxheWVycywgZGF0YSk7XG4gICAgICAgIHRvdGFsR2FtZVJlc3VsdENvbXAuX2NsaWNrQnRuKCk7XG4gICAgICAgIHRoaXMudG90YWxHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xuXG4gICAgICAgIC8vaWYgKHRoaXMuX3JlY29yZEl0ZW1JbmZvKSB7XG4gICAgICAgIC8vICB0aGlzLl9zdGFydFBsYXliYWNrKHRoaXMuX3JlY29yZEl0ZW1JbmZvLl9pbmZvOEFycmF5KTtcbiAgICAgICAgLy8gIHJldHVybjtcbiAgICAgICAgLy99XG4gICAgICAgIC8vLy9Tb2NrZXQuc2VuZEdldEl0ZW1SZWNvcmQoU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkLHRoaXMuX3BhcmVudElkKTtcbiAgICAgICAgLy9Tb2NrZXQuc2VuZEdldEl0ZW1SZWNvcmQoU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkLC0taW5kZXgpO1xuICAgIH0sXG5cbiAgICBfc3RhcnRQbGF5YmFjazogZnVuY3Rpb24gKHBsYXlCYWNrSW5mbykge1xuICAgICAgICAvL1BsYXliYWNrLmluc3RhbmNlLnNldFBsYXliYWNrRGF0YXMocGxheUJhY2tJbmZvKTtcbiAgICAgICAgLy9jYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3BsYXknKTtcbiAgICB9LFxuXG4gICAgZGV0YWlsQWN0aW9uOiBmdW5jdGlvbihyZWNvcmRJdGVtSW5mbywgaW5kZXgpIHtcbiAgICAgICAgLy90aGlzLl9yZWNvcmRJdGVtSW5mbyA9IHJlY29yZEl0ZW1JbmZvO1xuICAgICAgICAvLy8vdGhpcy5wbGF5YmFja05vZGUuYWN0aXZlID0gdHJ1ZVxuICAgICAgICAvLy8vY29uc29sZS5sb2coKTtcbiAgICAgICAgLy8vL3RoaXMubnVtTm9kZS5zdHJpbmcgPSBcIuesrFwiICsgKGluZGV4ICsgMSkgKyBcIuWxgFwiO1xuICAgICAgICAvL3RoaXMudGltZUxhYmVsLnN0cmluZyA9IHJlY29yZEl0ZW1JbmZvLmNyZWF0QXQuc3Vic3RyKDUsMTEpO1xuICAgICAgICAvL2xldCBvYmpBcnJheSA9IEpTT04ucGFyc2UocmVjb3JkSXRlbUluZm8uaW5mbzgpO1xuICAgICAgICAvL3RoaXMuX3JlY29yZEl0ZW1JbmZvLl9pbmZvOEFycmF5ID0gb2JqQXJyYXk7XG4gICAgICAgIC8vbGV0IHBsYXllcnNBcnJheSA9IG9iakFycmF5Lm1hcChmdW5jdGlvbihzdHIpe1xuICAgICAgICAvLyAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy9cbiAgICAgICAgLy92YXIgcGxheWVycyA9IHBsYXllcnNBcnJheVtwbGF5ZXJzQXJyYXkubGVuZ3RoLTFdLmRhdGEucGxheWVycztcbiAgICAgICAgLy9mb3IgKHZhciBpID0gMDtpIDwgcGxheWVycy5sZW5ndGg7aSsrKSB7XG4gICAgICAgIC8vICAgIHRoaXMubmlja25hbWVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc1tpXS5uaWNrbmFtZTtcbiAgICAgICAgLy8gICAgdGhpcy5zY29yZUxhYmVsc1tpXS5zdHJpbmcgPSBwbGF5ZXJzW2ldLmNTY29yZTtcbiAgICAgICAgLy99XG4gICAgfSxcbiAgICByZWNvcmRzOmZ1bmN0aW9uKCl7XG5cbiAgICB9LFxuXG5cbn0pOyIsImNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5jb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNjcm9sbFZpZXc6Y2MuTm9kZSxcbiAgICAgICAgcmVjb3JkSXRlbTpjYy5QcmVmYWIsXG4gICAgICAgIC8vc3ViU2Nyb2xsVmlldzpjYy5Ob2RlLFxuICAgICAgICAvL3N1YlJlY29yZEl0ZW06Y2MuTm9kZSxcbiAgICAgICAgLy9zcGxhc2g6Y2MuUHJlZmFiLFxuICAgICAgICAvL3Jlb3JkSW5mbzpjYy5Ob2RlLFxuICAgICAgICAvL1xuICAgICAgICAvL2ppZmVuOmNjLkxhYmVsLFxuICAgICAgICAvL2hlYWQ6Y2MuTm9kZSxcbiAgICAgICAgLy9pZDpjYy5MYWJlbCxcbiAgICAgICAgLy9uaWNrbmFtZTpjYy5MYWJlbCxcbiAgICAgICAgLy9jcmVhdDpjYy5MYWJlbCwgICAgICAgIC8vIOWIm+aIv+S6ulxuICAgICAgICAvL2NyZWF0ZVVzZXI6Y2MuTm9kZSwgICAgIC8vICDlpLTlg49cbiAgICAgICAgLy9cbiAgICAgICAgLy90aW1lTGFiZWw6Y2MuTGFiZWwsICAgLy8g5pe26Ze0XG4gICAgICAgIC8vanVzaHVMYWJlbDpjYy5MYWJlbCwgIC8vIOWxgOaVsFxuICAgICAgICAvLy8vY3JlYXRlVXNlcjpjYy5Ob2RlLCAgIC8vIOaIv+S4u1xuICAgICAgICAvL3Jvb21JZDpjYy5MYWJlbCwgICAgICAvLyDmiL/pl7Tlj7dcbiAgICAgICAgLy9fcmVjb3JkczpudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy90aGlzLmlzU3ViUGFnZSA9IGZhbHNlO1xuICAgICAgICAvL3RoaXMuc3ViU2Nyb2xsVmlldy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgLy9cbiAgICAgICAgLy90aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50ID0gdGhpcy5zdWJTY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xuICAgICAgICAvL2NvbnNvbGUubG9nKCB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50ICk7XG4gICAgICAgIC8vdGhpcy5yZWNvcmRJbmZvID0gdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudC5jaGlsZHJlblswXTtcbiAgICAgICAgLy90aGlzLnJlb3JkcyA9IHRoaXMuc3ViU2Nyb2xsVmlld0NvbnRlbnQuY2hpbGRyZW5bMF0uY2hpbGRyZW5bM107XG4gICAgICAgIHRoaXMuc2Nyb2xsVmlld0NvbnRlbnQgPSB0aGlzLnNjcm9sbFZpZXcuZ2V0Q29tcG9uZW50KGNjLlNjcm9sbFZpZXcpLmNvbnRlbnQ7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyU29ja2V0RXZlbnQoKTtcbiAgICB9LFxuXG4gICAgX3JlZ2lzdGVyU29ja2V0RXZlbnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LkdldFJlY29yZCwgdGhpcy5fUmVjZWl2ZVJlY29yZEluZm8sIHRoaXMpO1xuICAgICAgLy9LUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5HZXRJdGVtUmVjb3JkLCB0aGlzLl9SZWNlaXZlUmVjb3JkSXRlbSwgdGhpcyk7XG4gICAgfSxcblxuICAgIF9SZWNlaXZlUmVjb3JkSW5mbzpmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAvL2NjLmxvZyhyZXNwb25zZSlcbiAgICAgICAgLy9jYy5sb2coJy0tLS0tLTc4JylcbiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIC8vdGhpcy5fcmVjb3JkcyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIC8vdGhpcy5pc1N1YlBhZ2UgPSBmYWxzZTtcbiAgICAgICAgLy90aGlzLnN1YlNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIC8vdGhpcy5zY3JvbGxWaWV3LmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5zY3JvbGxWaWV3Q29udGVudC5yZW1vdmVBbGxDaGlsZHJlbigpO1xuICAgICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgICByZXNwb25zZS5kYXRhLmZpbHRlciggZnVuY3Rpb24gKHJlY29yZCkge3JldHVybiByZWNvcmQucGxheWVyc0luZm8ubGVuZ3RoID4gMDt9KS5mb3JFYWNoKGZ1bmN0aW9uIChyZWNvcmRJbmZvKSB7XG4gICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnJlY29yZEl0ZW0pO1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxWaWV3Q29udGVudC5hZGRDaGlsZChpdGVtKTtcbiAgICAgICAgICAgIHZhciBjb21wID0gaXRlbS5nZXRDb21wb25lbnQoJ3JlY29yZEluZm8nKTtcbiAgICAgICAgICAgIGNvbXAuc2V0SW5mbyhyZWNvcmRJbmZvKTtcbiAgICAgICAgICAgIHZhciByZWNvcmRCdG4gPSBpdGVtLmNoaWxkcmVuWzddLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xuICAgICAgICAgICAgcmVjb3JkQnRuLmNsaWNrRXZlbnRzWzBdLmN1c3RvbUV2ZW50RGF0YSA9IHJlY29yZEluZm87XG4gICAgICAgICAgICAvLyB2YXIgZXZlbnRIYW5kbGVyID0gbmV3IGNjLkNvbXBvbmVudC5FdmVudEhhbmRsZXIoKTtcbiAgICAgICAgICAgIC8vIGV2ZW50SGFuZGxlci50YXJnZXQgPSBjb21wLm5vZGUuY2hpbGRyZW5bN107XG4gICAgICAgICAgICAvLyBldmVudEhhbmRsZXIuY29tcG9uZW50ID0gXCJidG5cIjtcbiAgICAgICAgICAgIC8vIGV2ZW50SGFuZGxlci5oYW5kbGVyID0gXCJjbGlja0FjdGlvblwiO1xuICAgICAgICAgICAgLy9ldmVudEhhbmRsZXIuY3VzdG9tRXZlbnREYXRhID0gXCJteSBkYXRhXCI7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGNvbXAubm9kZS5jaGlsZHJlbls3XSk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsb3NlQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5pc1N1YlBhZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuaXNTdWJQYWdlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFZpZXcuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICB9XG4gICAgfSxcbiAgIC8qIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKCBpbmRleCApe1xuICAgICAgICAvL19SZWNlaXZlUmVjb3JkSXRlbSgpXG4gICAgfSxcbiAgICBfUmVjZWl2ZVJlY29yZEl0ZW06ZnVuY3Rpb24oUmVjb3JkSXRlbUluZm8pIHtcbiAgICAgICAgY2MubG9nKFJlY29yZEl0ZW1JbmZvKVxuICAgICAgICBjYy5sb2coJy0tLS0tLTc4JylcbiAgICAgICAgLy9jb25zb2xlLmxvZyhSZWNvcmRJdGVtSW5mbyk7cmV0dXJuO1xuICAgICAgICB2YXIgaW5kZXggPSBSZWNvcmRJdGVtSW5mby5kYXRhXG4gICAgICAgIHZhciBwbGF5ZXJzSW5mbyA9IEpTT04ucGFyc2UodGhpcy5fcmVjb3Jkc1tpbmRleF0ucGxheWVyc0luZm8pO1xuICAgICAgICBcbiAgICAgICAgdmFyIHBsYXllcnMgPSBwbGF5ZXJzSW5mby5wbGF5ZXJzOyAgICAgICAgICAgICAgICAgIC8vIOeOqeWutuS/oeaBr1xuICAgICAgICB2YXIgcGxheWVyc0luZGV4ID0gcGxheWVyc0luZm8ucGxheWVyc0luZGV4OyAgICAgICAgLy8g546p5a6255qE5L2N572uXG4gICAgICAgIHZhciBjcmVhdGVVc2VySWQgPSB0aGlzLl9yZWNvcmRzW2luZGV4XS5jcmVhdGVVc2VySWQ7ICAgLy8g5Yib5oi/SURcbiAgICAgICAgdmFyIHNlbmRVc2VySWQgPSB0aGlzLl9yZWNvcmRzW2luZGV4XS51c2VyaWQ7ICAgICAgICAgICAvLyDlj5HpgIHkurpJRFxuXG4gICAgICAgIHRoaXMuaXNTdWJQYWdlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuc2Nyb2xsVmlldy5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLnRpbWVMYWJlbC5zdHJpbmcgPSAodGhpcy5fcmVjb3Jkc1tpbmRleF0uY3JlYXRlQXQpLnN1YnN0cig1LDExKTsgICAgICAgICAgICAgICAvLyDml7bpl7RcbiAgICAgICAgdGhpcy5qdXNodUxhYmVsLnN0cmluZyA9IHRoaXMuanMoSlNPTi5wYXJzZSh0aGlzLl9yZWNvcmRzW2luZGV4XS5zZXR0aW5nMikpOyAgICAgICAgLy8g5bGA5pWwXG4gICAgICAgIHRoaXMucm9vbUlkLnN0cmluZyA9IHRoaXMuX3JlY29yZHNbaW5kZXhdLnJvb21JZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaIv+mXtOWPt1xuICAgICAgICB0aGlzLmNyZWF0LnN0cmluZyA9IHRoaXMuZmluZENyZWF0b3IodGhpcy5fcmVjb3Jkc1tpbmRleF0uY3JlYXRlVXNlcklkLHBsYXllcnMpOyAgICAvLyDmiL/kuLtcblxuICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50ID0gdGhpcy5zdWJTY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xuICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50LnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHBsYXllcnMubGVuZ3RoOyBpKysgKXtcbiAgICAgICAgICAgIHZhciBpdGVtID0gY2MuaW5zdGFudGlhdGUodGhpcy5zcGxhc2gpO1xuICAgICAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudC5hZGRDaGlsZChpdGVtKTtcbiAgICAgICAgICAgIHZhciBjb21wID0gaXRlbS5nZXRDb21wb25lbnQoJ3JlY29yZEluZm8nKTtcbiAgICAgICAgICAgIHZhciBjcmVhdG9yID0gMDsgICAgICAgXG4gICAgICAgICAgICB2YXIgc2VsZiA9IDA7ICAgICAgIC8vIOihqOekuuiHquW3se+8jOimgeWvueiHquW3seeahOavlOeJjOiusOW9leiDjOaZr+WBmuWkhOeQhlxuICAgICAgICAgICAgaWYoY3JlYXRlVXNlcklkID09IHBsYXllcnNbaV0uaWQpe1xuICAgICAgICAgICAgICAgIGNyZWF0b3IgPTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiggc2VuZFVzZXJJZCA9PSBwbGF5ZXJzW2ldLmlkKXtcbiAgICAgICAgICAgICAgICBzZWxmID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVjb3Jkcyhjb21wLGksY3JlYXRvcixzZWxmLGluZGV4KTtcbiAgICAgICAgfVxuXG4gICAgfSxcbiAgICByZWNvcmRzOmZ1bmN0aW9uKGluZm8saSxjcmVhdG9yLHNlbGYsaW5kZXgpe1xuICAgICAgICBpZihzZWxmKXtcbiAgICAgICAgICAgIGluZm8ubm9kZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMjUsIDEyNiwgMjAwKTtcbiAgICAgICAgfVxuICAgICAgICBjYy5sb2coaW5mbylcbiAgICAgICAgY2MubG9nKCctLS0tMTE5JylcbiAgICAgICAgdmFyIHBsYXllcnMgPSBKU09OLnBhcnNlKHRoaXMuX3JlY29yZHNbaW5kZXhdLnBsYXllcnNJbmZvKS5wbGF5ZXJzO1xuICAgICAgICB2YXIgc2NvcmVzID0gdGhpcy5fcmVjb3Jkc1tpbmRleF0uc2NvcmVzIDtcbiAgICAgICAgaW5mby5uaWNrbmFtZUxhYmVscy5zdHJpbmcgPSBwbGF5ZXJzW2ldLm5pY2tuYW1lO1xuICAgICAgICBpbmZvLmlkLnN0cmluZyA9IHBsYXllcnNbaV0uaWQ7XG4gICAgICAgIGluZm8uamlmZW4uc3RyaW5nID0gc2NvcmVzW2ldO1xuXG4gICAgICAgIHZhciBoZWFkVXJsID0gcGxheWVyc1tpXS5hdmF0YXJVcmw7ICAgLy/lpLTlg4/ov57mjqVcbiAgICAgICAgdmFyIHNwcml0ZSA9IGluZm8uYXZhdGFyTm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgY2MubG9hZGVyLmxvYWQoaGVhZFVybCtcIi5qcGdcIiwgZnVuY3Rpb24gKGVyciwgdGV4KSB7XG4gICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKHRleCk7XG4gICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZT1mcmFtZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpbmZvLmNyZWF0b3JJbWcuYWN0aXZlID0gY3JlYXRvcjtcbiAgICB9LFxuICAgIGZpbmRDcmVhdG9yOmZ1bmN0aW9uKGNyZWF0ZUlkLHBsYXllcnMpeyAvL+aJvuaIv+S4u1xuICAgICAgICBmb3IodmFyIGk9MDsgaTxwbGF5ZXJzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgaWYoY3JlYXRlSWQgPT0gcGxheWVyc1tpXS5pZCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXllcnNbaV0ubmlja25hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGpzOmZ1bmN0aW9uKG51bSl7XG4gICAgICAgIHZhciBKID0gNTtcbiAgICAgICAgc3dpdGNoKG51bSl7XG4gICAgICAgICAgICBjYXNlIDA6IEogPSA1O2JyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOiBKID0gMTA7YnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6IEogPSAyMDticmVhaztcbiAgICAgICAgICAgIGNhc2UgMzogSiA9IDMwO2JyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBKO1xuICAgIH0sKi9cblxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBjbGlja0V4aXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xuICAgIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgY29udGVudDpjYy5Ob2RlXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB2aXNpYmxlU2l6ZSA9IGNjLmRpcmVjdG9yLmdldFZpc2libGVTaXplKCk7XHJcbiAgICAgICAgdmFyIGNvbnRlbnRTaXplID0ge307XHJcbiAgICAgICAgY29udGVudFNpemUud2lkdGggPSB0aGlzLm5vZGUud2lkdGg7XHJcbiAgICAgICAgY29udGVudFNpemUuaGVpZ2h0ID0gdGhpcy5ub2RlLmhlaWdodDtcclxuICAgICAgICB2YXIgc2NhbGVYID0gdmlzaWJsZVNpemUud2lkdGgvY29udGVudFNpemUud2lkdGg7XHJcbiAgICAgICAgdmFyIHNjYWxlWSA9IHZpc2libGVTaXplLmhlaWdodC9jb250ZW50U2l6ZS5oZWlnaHQ7XHJcbiAgICAgICAgdmFyIHNjYWxlID0gTWF0aC5taW4oc2NhbGVYLHNjYWxlWSkudG9GaXhlZCgyKTtcclxuICAgICAgICB0aGlzLm5vZGUuc2NhbGVYID0gc2NhbGU7XHJcbiAgICAgICAgdGhpcy5ub2RlLnNjYWxlWSA9IHNjYWxlO1xyXG4gICAgfVxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbm9kZXM6W2NjLk5vZGVdLFxuICAgICAgICBzZWxlY3RlZEluZGV4OiAwLFxuICAgICAgICBfc2VsZWN0OltdLFxuICAgICAgICBfc2VsZWN0ZWQ6MCxcbiAgICAgICAgYmVpbHY6Y2MuTm9kZSwgIC8vIOWAjeeOh1xuICAgICAgICBfYmxTaG93OjAsICAgICAgLy8g5YCN546H55qE5pi+56S654q25oCBXG4gICAgfSxcblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmJlaWx2LmFjdGl2ZSA9IHRoaXMuX2JsU2hvdztcbiAgICAgICAgdGhpcy5fc2VsZWN0ID0gWzEsMSwxLDAsMF07IFxuICAgICAgICBpZihjYy5zZXQpeyAgLy8g6K6w5b2V5LiK5LiA5Y+l55qE5oi/6Ze05oOF5Ya1XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3QgPSBjYy5zZXRbJ3NldHRpbmczJ107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhY3RpdmUgPSB0aGlzLl9zZWxlY3RbaV07XG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jykuc2V0U2VsZWN0ZWQoYWN0aXZlKTtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMubm9kZXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XG4gICAgICAgICAgICBpZih0aGlzLl9zZWxlY3RbaV0pe1xuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoaT09Myl7XG4gICAgICAgICAgICAgICAgdGhpcy5iZWlsdi5hY3RpdmUgPSAodGhpcy5fYmxTaG93ID0gdGhpcy5fc2VsZWN0WzNdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRDb21wID0gdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgdENvbXAuaW5kZXggPSBpO1xuICAgICAgICAgICAgdENvbXAuY2xpY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmluZGV4O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcCA9IHNlbGYubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZCggc2VsZi5fc2VsZWN0W2luZGV4XSA9ICFzZWxmLl9zZWxlY3RbaW5kZXhdICk7XG4gICAgICAgICAgICAgICAgaWYoIHRoaXMuaW5kZXggPT0gMyApeyAgICAgICAgICAgICAgICAgICAgICAvLyDnrKzkuInkuKrmmK/luoTlrrbmqKHlvI/vvIzluoTlrrbmqKHlvI/mmL7npLrlgI3njodcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5iZWlsdi5hY3RpdmUgPSAodGhpcy5fYmxTaG93ID0gc2VsZi5fc2VsZWN0WzNdKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzZWxmLl9zZWxlY3RbaW5kZXhdID0gc2VsZi5fc2VsZWN0W2luZGV4XTtcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICBzZWxmLm9uU2VsZWN0Q2hhbmdlKGluZGV4KTtcblxuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMubm9kZS5jaGlsZHJlblswXTtcbiAgICAgICAgICAgICAgICBpZiggc2VsZi5fc2VsZWN0W2luZGV4XSApeyAgICAgICAgICAgICAvLyDlpoLmnpzlvZPliY3pgInpobnkuLpUUlVFIOWImeaYvuekuumdkuiJslxuICAgICAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgICAgICB9ZWxzZXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWPjeS5iyDnmb3oibJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uU2VsZWN0Q2hhbmdlOiBmdW5jdGlvbiAoc2VsZWN0SW5kZXgpIHtcbiAgICAgICAgLy9jYy5sb2coc2VsZWN0SW5kZXgpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuX3NlbGVjdCk7XG4gICAgfSxcblxuXG5cbn0pO1xuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIHBhaTpjYy5Ob2RlLFxyXG4gICAgICAgIG1hcGFpOntcclxuICAgICAgICAgICAgZGVmYXVsdDpbXSxcclxuICAgICAgICAgICAgdHlwZTpjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0TWEgPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwic2VsZWN0X21hXCIpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0TWEub25Mb2FkKCk7XHJcbiAgICAgICAgdGhpcy5jb20gPSB0aGlzLnBhaS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIGNsaWNrQnRuQ29tZmlybTpmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmNvbS5zcHJpdGVGcmFtZSA9IHRoaXMubWFwYWlbY2MuZnJvbS5tYV07XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLmNvbS5zcHJpdGVGcmFtZSk7XHJcbiAgICB9LFxyXG4gICAgXHJcblxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHJpZ2h0SWNvbjpbY2MuTm9kZV0sXG4gICAgICAgIG1hcGFpUmlnaHQ6Y2MuTm9kZVxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYoY2MuZnJvbSA9PSBudWxsKXtcbiAgICAgICAgICAgIGNjLmZyb20gPSB7fTtcbiAgICAgICAgfVxuICAgICAgICAvL+WmguaenOS4jeW4pumprO+8jOWImemprOeJjOS4uuepulxuICAgICAgICBpZih0aGlzLm1hcGFpUmlnaHQuYWN0aXZlID09IGZhbHNlKXtcbiAgICAgICAgICAgIGNjLmZyb20uaXNVc2VNYSA9IGZhbHNlO1xuICAgICAgICAgICAgY2MuZnJvbS5tYSA9IG51bGw7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgY2MuZnJvbS5pc1VzZU1hID0gdHJ1ZTtcbiAgICAgICAgICAgIC8v5ZCm5YiZ6ams54mM6buY6K6k5Li656ysMOS4qu+8jOWNs+m7keahgzVcbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5yaWdodEljb24ubGVuZ3RoO2krKykge1xuICAgICAgICAgICAgaWYoaT09MCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRJY29uW2ldLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QgPSB0aGlzLnJpZ2h0SWNvbltpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRJY29uW2ldLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH0sXG4gICAgb25NYVBhaUNsaWNrOmZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIHRhcmdldE5hbWUgPSBlLnRhcmdldC5uYW1lO1xuICAgICAgICAvL2NjLmxvZyh0YXJnZXROYW1lKVxuICAgICAgICBpZih0YXJnZXROYW1lICE9IHRoaXMuc2VsZWN0LnBhcmVudC5uYW1lKSB7XG4gICAgICAgICAgICBpZih0YXJnZXROYW1lID09IFwic2VsZWN0X2t1YW5nMVwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QgPSB0aGlzLnJpZ2h0SWNvblsyXTtcbiAgICAgICAgICAgICAgICBjYy5mcm9tLm1hID0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYodGFyZ2V0TmFtZSA9PSBcInNlbGVjdF9rdWFuZzJcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5yaWdodEljb25bMV07XG4gICAgICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRhcmdldE5hbWUgPT0gXCJzZWxlY3Rfa3VhbmczXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMucmlnaHRJY29uWzBdO1xuICAgICAgICAgICAgICAgIGNjLmZyb20ubWEgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLnJpZ2h0SWNvbi5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0SWNvbltpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy9jb25zb2xlLmxvZyhjYy5mcm9tLm1hKTtcbiAgICB9XG5cblxufSk7XG4iLCJjb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xyXG5jb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBfdXNlcmlkIDogMCxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9LFxyXG4gICAgY2xpY2tCZWlMdjpmdW5jdGlvbihldmVudCxudW0pe1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBTb2NrZXQuc2VuZEJlaUx2KG51bSx0aGlzLl91c2VyaWQpO1xyXG4gICAgfSxcclxuICAgXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBiZ05vZGU6Y2MuTm9kZSwgICAvL+mAieaLqeahhlxuICAgICAgICBzZWxlY3RlZE5vZGU6Y2MuTm9kZSwgIC8v5a+55Y+3XG4gICAgICAgIHBhaTpjYy5Ob2RlLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLm5vZGUpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjYy5zZXQpO1xuICAgIH0sXG4gICAgXG4gICAgY2xpY2tBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhdGhpcy5zZWxlY3RlZDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUuYWN0aXZlID0gdGhpcy5zZWxlY3RlZDtcbiAgICAgIFxuICAgIH0sXG4gICAgXG4gICAgc2V0U2VsZWN0ZWQ6ZnVuY3Rpb24oc2VsZWN0ZWQpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHNlbGVjdGVkO1xuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0aGlzLnNlbGVjdGVkO1xuICAgIH0sXG4gICAgLyojIyMjIyovXG4gICAgY2xpY2tTZWxlY3RLdWFuZzpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9ICF0aGlzLnNlbGVjdGVkO1xuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0aGlzLnNlbGVjdGVkO1xuICAgICAgICBjYy5mcm9tLmlzVXNlTWEgPSB0aGlzLnNlbGVjdGVkO1xuICAgICAgICB2YXIgbWFwYWlDb20gPSB0aGlzLnBhaS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcbiAgICAgICAgaWYodGhpcy5zZWxlY3RlZE5vZGUuYWN0aXZlID09PSBmYWxzZSl7XG4gICAgICAgICAgICBtYXBhaUNvbS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBtYXBhaUNvbS5pbnRlcmFjdGFibGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSxcblxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbm9kZXM6W2NjLk5vZGVdLFxuICAgICAgICBzZWxlY3RlZEluZGV4OiAwLFxuICAgIH0sXG5cbiAgICAvKiMjIyMqL1xuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBycyA9IDA7XG4gICAgICAgIHZhciBqcyA9IDA7XG4gICAgICAgIHZhciBzZiA9IDA7XG4gICAgICAgIHZhciBibCA9IDA7XG4gICAgICAgIGlmKGNjLnNldCl7XG4gICAgICAgICAgICBqcyA9IGNjLnNldC5zZXR0aW5nMTtcbiAgICAgICAgICAgIHJzID0gY2Muc2V0LnNldHRpbmcyO1xuICAgICAgICAgICAgc2YgPSBjYy5zZXQuc2V0dGluZzQ7XG4gICAgICAgICAgICBibCA9IGNjLnNldC5zZXR0aW5nNTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBpc1NlbGVjdGVkID0gKHRoaXMuc2VsZWN0ZWRJbmRleCA9PSBpKTtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKS5zZXRTZWxlY3RlZChpc1NlbGVjdGVkKTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICAgICAgICB2YXIgc2VsZWN0SW5kZXggPSB0aGlzLnNlbGVjdGVkSW5kZXggO1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XG4gICAgICAgICAgICBpZiggc2VsZWN0SW5kZXggPT0gaSl7XG4gICAgICAgICAgICAgICAgdGhpcy5ub2Rlc1tzZWxlY3RJbmRleF0uZ2V0Q2hpbGRCeU5hbWUoXCJ0aXRsZVwiKS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0Q29tcCA9IHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcbiAgICAgICAgICAgIHRDb21wLmluZGV4ID0gaTtcblxuICAgICAgICAgICAgdENvbXAuY2xpY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXAgPSBzZWxmLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0U2VsZWN0ZWQoZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgUGVlcnMgPSB0aGlzLm5vZGUucGFyZW50LmNoaWxkcmVuOyAgLy8g5ZCM6L6I6IqC54K5XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGE9MDsgYTxQZWVycy5sZW5ndGg7IGErKyl7XG4gICAgICAgICAgICAgICAgICAgIGlmKCBQZWVyc1thXS5jaGlsZHJlbi5sZW5ndGg+MCApeyAgICAgICAgICAgIC8vIOWmguaenOWQjOi+iOacieWtkOiKgueCuSDlpITnkIblrZDoioLngrnmloflrZfnmoTpopzoibJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IFBlZXJzW2FdLmdldENoaWxkQnlOYW1lKFwidGl0bGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKCd0aXRsZScpLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xuICAgICAgICAgICAgICAgIC8vdGhpcy5ub2RlLmNoaWxkcmVuW2luZGV4XS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRydWUpO1xuICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRJbmRleCA9IHRoaXMuaW5kZXg7XG4gICAgICAgICAgICAgICAgc2VsZi5vblNlbGVjdENoYW5nZSh0aGlzLmluZGV4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYoIHRoaXMubm9kZS5fbmFtZSA9PSBcInJlbnNodVwiICYmIGNjLnNldCApe1xuICAgICAgICAgICAgY29uc29sZS5sb2cocnMpO1xuICAgICAgICAgICAgdGhpcy5yZW1lbWJlcl9zZXQocnMpO1xuICAgICAgICB9XG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJqdXNodVwiICYmIGNjLnNldCApe1xuICAgICAgICAgICAgdGhpcy5yZW1lbWJlcl9zZXQoanMpO1xuICAgICAgICB9XG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJjYXJkc1wiICYmIGNjLnNldCApe1xuICAgICAgICAgICAgdGhpcy5yZW1lbWJlcl9zZXQoc2YpO1xuICAgICAgICB9XG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJiZWlMdlwiICYmIGNjLnNldCApe1xuICAgICAgICAgICAgdGhpcy5yZW1lbWJlcl9zZXQoYmwpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICByZW1lbWJlcl9zZXQ6ZnVuY3Rpb24obnVtKXtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gbnVtO1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBsZXQgaXNTZWxlY3RlZCA9IChudW0gPT0gaSk7XG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jykuc2V0U2VsZWN0ZWQoaXNTZWxlY3RlZCk7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XG4gICAgICAgICAgICBpZiggbnVtID09IGkpe1xuICAgICAgICAgICAgICAgIC8vIGlmKCB0aGlzLm5vZGVzW251bV0uY2hpbGRyZW5bMF0ubmFtZSA9PSBcInRpdGxlXCIgKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgaW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIC8vIH1lbHNlIGlmKHRoaXMubm9kZXNbbnVtXS5jaGlsZHJlblsxXS5uYW1lID09IFwidGl0bGVcIil7XG4gICAgICAgICAgICAgICAgLy8gICAgIGluZGV4ID0xO1xuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVzW251bV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJykuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvblNlbGVjdENoYW5nZTogZnVuY3Rpb24gKHNlbGVjdEluZGV4KSB7XG5cblxuICAgIH0sXG4gICAgXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGluZGljYXRvck5vZGU6Y2MuTm9kZSxcbiAgICAgICAgYmFja2dyb3VuZE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgc2VsZWN0ZWROb2RlOmNjLk5vZGUsXG5cbiAgICAgICAgdmFsdWU6MCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaW5kaWNhdG9yTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFLGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgcHQgPSBzZWxmLm5vZGUuY29udmVydFRvTm9kZVNwYWNlKGNjLnYyKGV2ZW50LmdldExvY2F0aW9uWCgpLGV2ZW50LmdldExvY2F0aW9uWSgpKSk7XG4gICAgICAgICAgICBzZWxmLnVwZGF0ZVNsaWRlcihwdCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgcHQgPSBzZWxmLm5vZGUuY29udmVydFRvTm9kZVNwYWNlKGNjLnYyKGV2ZW50LmdldExvY2F0aW9uWCgpLGV2ZW50LmdldExvY2F0aW9uWSgpKSk7XG4gICAgICAgICAgICBzZWxmLnVwZGF0ZVNsaWRlcihwdCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgcHQgPSBzZWxmLm5vZGUuY29udmVydFRvTm9kZVNwYWNlKGNjLnYyKGV2ZW50LmdldExvY2F0aW9uWCgpLGV2ZW50LmdldExvY2F0aW9uWSgpKSk7XG4gICAgICAgICAgICBzZWxmLnVwZGF0ZVNsaWRlcihwdCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vdGhpcy5tYXhXaWR0aCA9IHRoaXMubm9kZS53aWR0aCAtIDQwO1xuICAgICAgICB0aGlzLm1heFdpZHRoID0gdGhpcy5ub2RlLndpZHRoLTI4O1xuICAgICAgICB0aGlzLnNldFZhbHVlKHRoaXMudmFsdWUpO1xuICAgIH0sXG5cbiAgICB1cGRhdGVTbGlkZXI6ZnVuY3Rpb24ocHQpIHtcbiAgICAgICAgdmFyIHggPSBwdC54O1xuICAgICAgICBpZiAoeCA8IDApIHtcbiAgICAgICAgICAgIHggPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHggPiB0aGlzLm1heFdpZHRoKSB7XG4gICAgICAgICAgICB4ID0gdGhpcy5tYXhXaWR0aDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFZhbHVlKHgvdGhpcy5tYXhXaWR0aCk7XG4gICAgICAgIHRoaXMub25WYWx1ZUNoYW5nZSh0aGlzLnZhbHVlKTtcbiAgICB9LFxuXG4gICAgLyowIC0gMSovXG4gICAgc2V0VmFsdWU6ZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICBpZiAodGhpcy52YWx1ZSA8IDApIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZhbHVlID4gMSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgLy90aGlzLm1heFdpZHRoID0gdGhpcy5ub2RlLndpZHRoIC0gMzg7XG4gICAgICAgIHRoaXMubWF4V2lkdGggPSB0aGlzLm5vZGUud2lkdGgtMjg7XG4gICAgICAgIHRoaXMuaW5kaWNhdG9yTm9kZS54ID0gdGhpcy52YWx1ZSAqIHRoaXMubWF4V2lkdGgrMTA7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLndpZHRoID0gdGhpcy52YWx1ZSAqIHRoaXMubWF4V2lkdGggKyB0aGlzLmluZGljYXRvck5vZGUud2lkdGgvMjtcbiAgICB9LFxuXG4gICAgb25WYWx1ZUNoYW5nZTpmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBjYy5sb2codmFsdWUpO1xuICAgIH0sXG59KTtcbiIsInZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcblxubGV0IFNvY2tldENvbnN0YW50ID0ge1xuICBNYXhSZWNvbm5lY3RDaGVja0ludGVydmFsOiA1LCAvLyDph43ov57mo4DmtYvml7bpl7TniYdcbn07XG5cbi8qKlxuICog6L+Z5piv5a+5IFdlYlNvY2tldCDnmoTkuIDkuKrlsIHoo4VcbiAqIFxuICog6YeM6Z2i5YyF5ZCr6Ieq5Yqo6YeN6L+e55qE5Yqf6IO9XG4gKi9cbmxldCBTb2NrZXQgPSBjYy5DbGFzcyh7XG4gIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICBwcm9wZXJ0aWVzOiB7XG4gICAgX2xhc3RSZWNlaXZlTXNnVGltZTogMCwgLy8g5pyA5ZCO5LiA5qyh5pS25Yiw5raI5oGv5pe26Ze0KOavq+enkilcbiAgICBfdGltZW91dDogOCwgLy8g6LaF5pe25pe26ZW/IO+8iOenku+8iVxuICB9LFxuXG4gIHN0YXRpY3M6IHtcbiAgICBpbnN0YW5jZTogbnVsbCxcbiAgICAvLyB1cmw6XCJ3czovLzE4Mi4xOC4yNi4xMzo1MDQxXCIsXG4gICAgLy91cmw6XCJ3czovLzEyMy41Ni4yMC4xNjQ6NTA0MVwiLC8v5L+u5pS55YmNXG4gICAgdXJsOlwid3M6Ly8xMjcuMC4wLjE6NTA0MVwiLFxuICAgIC8vIHVybDpcIndzOi8vMTkyLjE2OC4wLjEwODo1MDQxXCIsXG4gICAgLy91cmw6XCJ3czovLzE4My4zLjIwNS4xNDk6NTAwMlwiLFxuICB9LFxuXG4gIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICBTb2NrZXQuaW5zdGFuY2UgPSB0aGlzO1xuXG4gICAgdGhpcy5uYW1lID0gXCJzb2NrZXRcIjtcblxuICAgIGNjLmdhbWUuYWRkUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSk7XG4gICAgaWYgKGNjLmdhbWUuaXNQZXJzaXN0Um9vdE5vZGUodGhpcy5ub2RlKSkge1xuICAgICAgY2MubG9nKCfmt7vliqDlhajlsYDoioLngrkgU29ja2V0IOaIkOWKnycpO1xuICAgIH1cblxuICAgIHRoaXMuX3JlZ2lzdGVyQXBwQWN0aXZlQ2hhbmdlKCk7XG5cbiAgICB0aGlzLmlzQ3JlYXRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmNyZWF0ZUluZGV4ID0gMDtcbiAgICB0aGlzLmNyZWF0ZVNvY2tldCgpO1xuXG4gICAgdGhpcy5zY2hlZHVsZShmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNoZWNrQ29ubmVjdGlvbigpO1xuICAgIH0sIDUpO1xuXG4gICAgdGhpcy5yZWN2VGltZSA9IERhdGUubm93KCk7IC8v5o6l5pS25Yiw5pyA5paw5LiA5p2h5pyN5Yqh5Zmo55qE5L+h5oGv55qE5pe26Ze0XG4gICAgLy9jYy5sb2cobWFuYWdlci52ZXJzaW9uKTtcblxuICAgIHRoaXMuX2NoZWNrU29ja2V0KCk7XG4gIH0sXG5cbiAgY2hlY2tDb25uZWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgLy/lrqLmiLfnq6/lrprml7bnu5nmnI3liqHnq6/lj5HpgIHngrnmlbDmja7vvIzpmLLmraLov57mjqXnlLHkuo7plb/ml7bpl7TmsqHmnInpgJrorq/ogIzooqvmn5DkupvoioLngrnnmoTpmLLngavlopnlhbPpl63lr7zoh7Tov57mjqXmlq3lvIDnmoTmg4XlhrXjgIJcbiAgICB0aGlzLnNlbmRNZXNzYWdlKCdjaGVja0FjdGlvbicsICcnKTtcbiAgfSxcblxuICBjcmVhdGVTb2NrZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5jcmVhdGVJbmRleCsrOyAvL+WIm+W7uuasoeaVsOWKoDFcbiAgICBpZiAodGhpcy5jcmVhdGVJbmRleCA+IDUpIHtcbiAgICAgIHRoaXMubmV0d29ya0Vycm9yKCk7XG4gICAgICBLUU5hdGl2ZUludm9rZS5mb3JjZUV4aXRBcHAoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5pc0NyZWF0aW5nID0gdHJ1ZTtcblxuICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdGluZyk7XG4gICAgdGhpcy53cyA9IG5ldyBXZWJTb2NrZXQoU29ja2V0LnVybCk7XG4gICAgaWYgKHRoaXMud3MgPT09IG51bGwpIHtcbiAgICAgIHRoaXMubmV0d29ya0Vycm9yKCk7XG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RFcnJvciwgeydkYXRhJzogJ1NvY2tldCDliJvlu7rlpLHotKUnfSk7XG4gICAgICBLUU5hdGl2ZUludm9rZS5mb3JjZUV4aXRBcHAoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5zb2NrZXRFcnJvciA9IGZhbHNlO1xuXG4gICAgLy8gc29ja2V0IOi/nuaOpeaIkOWKn1xuICAgIHRoaXMud3Mub25vcGVuID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDov57mjqXmiJDlip/vvJpcIiwgZXZlbnQpO1xuICAgICAgXG4gICAgICBzZWxmLl9sYXN0UmVjZWl2ZU1zZ1RpbWUgPSBjYy5zeXMubm93KCk7XG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RTdWNjZXNzZWQsIGV2ZW50KTtcblxuICAgICAgc2VsZi5pc0NyZWF0aW5nID0gZmFsc2U7XG4gICAgICBzZWxmLnNvY2tldEVycm9yID0gZmFsc2U7XG4gICAgICBzZWxmLmNyZWF0ZUluZGV4ID0gMDtcbiAgICAgIHNlbGYuY29ubmVjdGlvblN1Y2Nlc3MoKTtcbiAgICAgIHNlbGYuc2VuZFJlY29ubmVjdEluZm8oKTtcbiAgICB9O1xuXG4gICAgLy8gc29ja2V0IOaOpeaUtuWIsOa2iOaBr1xuICAgIHRoaXMud3Mub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBzZWxmLl9sYXN0UmVjZWl2ZU1zZ1RpbWUgPSBjYy5zeXMubm93KCk7XG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldFJlY2VpdmVNZXNzYWdlLCBldmVudC5kYXRhKTtcblxuICAgICAgc2VsZi5pc0NyZWF0aW5nID0gZmFsc2U7XG4gICAgICBzZWxmLnNvY2tldEVycm9yID0gZmFsc2U7XG4gICAgICBzZWxmLnJlY2V2aWNlTWVzc2FnZShldmVudC5kYXRhKTtcbiAgICAgIHNlbGYuX2Rpc3BhdGNoUmVzcG9uc2UoZXZlbnQuZGF0YSk7XG4gICAgICBzZWxmLnJlY3ZUaW1lID0gRGF0ZS5ub3coKTsgLy/mjqXmlLbmnIDmlrDkuIDmnaHkv6Hmga/nmoTml7bpl7RcblxuICAgICAgLyoqL1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBzb2NrZXQg5Y+R55Sf6ZSZ6K+vXG4gICAgICogXG4gICAgICogc29ja2V0IOacrOi6q+aciSBgb25lcnJvcmAg5Zue6LCD77yM5L2G5LqL5a6e6K+B5piO77yM5YW25LiN6Z2g6LCx77yMXG4gICAgICog5pyJ5b6I5aSn55qE5py6546H5pyJ6K+v5oql55qE6KGM5Li677yM5bi45bi45Zyo5rKh5pyJ6ZSZ6K+v5pe277yM5Lya57uZ6ZSZ6K+v5Zue6LCD44CCXG4gICAgICog5LiU5LiN6IO95a6a5Yi26LaF5pe25pe26ZW/XG4gICAgICogXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2UgXG4gICAgICovXG4gICAgdGhpcy53cy5fa3Ffb25lcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICBjYy5lcnJvcihgV2ViU29ja2V0IOi/nuaOpemUmeivr++8miR7bWVzc2FnZX1gKTtcblxuICAgICAgS1FHbG9iYWxFdmVudC5lbWl0KFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0RXJyb3IsIHtkYXRhOiBtZXNzYWdlfSk7XG4gICAgICBzZWxmLndzLmNsb3NlKCk7XG4gICAgICBpZiAoIXNlbGYud3MpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDomb3nhLbosIPnlKjkuoYgd2Vic29ja2V0IOeahCBjbG9zZSDmlrnms5XvvIzkvYbmmK9cbiAgICAgIC8vIOWug+W5tuS8mueri+WNs+iwg+eUqCBvbmNsb3NlIOWbnuiwg++8jOiAjOaYr+WcqOacquadpeeahOafkFxuICAgICAgLy8g5LiA5pe26Ze05YaN5Zue6LCDIG9uY2xvc2XvvJvkvYbov5nph4zmmI7mmL7lj6/ku6Xnm7TmjqXlm57osIPkuobjgIJcbiAgICAgIGxldCB3cyA9IHNlbGYud3M7XG5cbiAgICAgIHNlbGYud3Mub25jbG9zZSgpO1xuICAgICAgd3Mub25jbG9zZSA9IGZ1bmN0aW9uKCl7fTtcbiAgICB9O1xuXG4gICAgLy8gc29ja2Ug5bey5YWz6ZetXG4gICAgdGhpcy53cy5vbmNsb3NlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAvL2NjLmxvZygnV2ViU29ja2V0IOW3suWFs+mXrSBjbG9zZSB0aW1lPScgKyBEYXRlLm5vdygpICsgXCIgZXZlbnQ6IFwiICsgZXZlbnQpO1xuXG5cbiAgICAgIHNlbGYuaXNDcmVhdGluZyA9IGZhbHNlO1xuICAgICAgc2VsZi5zb2NrZXRFcnJvciA9IHRydWU7XG4gICAgICBzZWxmLndzID0gbnVsbDtcbiAgICAgIHNlbGYuY29ubmVjdGlvbkRpc2Nvbm5lY3QoKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0RGlzY29ubmVjdCwgZXZlbnQpO1xuICAgICAgLy9jYy5sb2coJ3NvY2tldCBjbG9zZScrSlNPTi5zdHJpbmdpZnkoZXZlbnQpKTtcbiAgICB9O1xuICB9LFxuXG4gIHJlY29ubmVjdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIXNlbGYuaXNDcmVhdGluZyAmJiBzZWxmLnNvY2tldEVycm9yKSB7XG4gICAgICAgIHNlbGYuY3JlYXRlU29ja2V0KCk7XG4gICAgICB9XG4gICAgfSwgMik7XG4gIH0sXG5cbiAgc2VuZFJlY29ubmVjdEluZm86IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMudXNlckluZm8gIT0gbnVsbCkge1xuICAgICAgICB2YXIgdXNlcklkID0gc2VsZi51c2VySW5mby51c2VyX2lkIHx8IHNlbGYudXNlckluZm8uaWQ7XG4gICAgICAgIHNlbGYuc2VuZE1lc3NhZ2UoJ3JlY29ubmVjdCcsIHtcbiAgICAgICAgICAndXNlcklkJzogdXNlcklkXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sIDEpO1xuICB9LFxuXG4gIHJlY2V2aWNlTWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgfSxcblxuICBjb25uZWN0aW9uRGlzY29ubmVjdDogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgY29ubmVjdGlvblN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIG5ldHdvcmtFcnJvcjogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgY2hlY2tOZXR3b3JrU3RhcnQ6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIGNoZWNrTmV0d29ya0VuZDogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgX2Rpc3BhdGNoUmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZVN0cmluZykge1xuICAgIC8vY2MubG9nKFwiV2ViU29ja2V0IOaOpeaUtuWIsOacjeWKoeWZqOa2iOaBr++8mlwiLCByZXNwb25zZVN0cmluZyk7XG4gICAgbGV0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShyZXNwb25zZVN0cmluZyk7XG4gICAgbGV0IGFjdGlvbiA9IHJlc3BvbnNlW1wiYWN0aW9uXCJdO1xuICAgIGlmIChhY3Rpb24pIHtcbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChhY3Rpb24sIHJlc3BvbnNlKTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gTUFSSzog5YmN5ZCO5Y+w5pON5L2cXG4gIF9yZWdpc3RlckFwcEFjdGl2ZUNoYW5nZTogZnVuY3Rpb24gKCkge1xuICAgIC8vY2MubG9nKFwiV2ViU29ja2V0IOazqOWGjOW6lOeUqOi/m+WFpeWJjeOAgeWQjuWPsOS6i+S7tlwiKTtcbiAgICBjYy5nYW1lLm9uKGNjLmdhbWUuRVZFTlRfSElERSwgdGhpcy5fYXBwRW50ZXJCYWNrZ3JvdW5kLCB0aGlzKTtcbiAgICBjYy5nYW1lLm9uKGNjLmdhbWUuRVZFTlRfU0hPVywgdGhpcy5fYXBwQmVjb21BY3RpdmUsIHRoaXMpO1xuICB9LFxuXG4gIC8qKlxuICAgKiDov5vlhaXlkI7lj7BcbiAgICovXG4gIF9hcHBFbnRlckJhY2tncm91bmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xuICAgIGlmIChub3cgLSB0aGlzLl9sYXN0QXBwRW50ZXJCYWNrZ3JvdW5kVGltZSA8IDEwMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9sYXN0QXBwRW50ZXJCYWNrZ3JvdW5kVGltZSA9IG5vdztcbiAgICBcbiAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDmo4DmtYvliLDlupTnlKjov5vlhaXlkI7lj7DvvJpcIiwgbmV3IERhdGUoKSk7XG4gICAgbGV0IGlkID0gdGhpcy51c2VySW5mbyA/IHRoaXMudXNlckluZm8uaWQgOiB1bmRlZmluZWQ7XG4gICAgU29ja2V0LnNlbmRBcHBQYXVzZShpZCk7XG4gICAgdGhpcy5fY2FuY2VsQ2hlY2tTb2NrZXQoKTtcbiAgfSxcblxuICAvKipcbiAgICog6L+b5YWl5YmN5Y+wIFxuICAgKi9cbiAgX2FwcEJlY29tQWN0aXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcbiAgICBpZiAobm93IC0gdGhpcy5fbGFzdEFwcEJlY29tQWN0aXZlVGltZSA8IDEwMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9sYXN0QXBwQmVjb21BY3RpdmVUaW1lID0gbm93O1xuXG4gICAgLy9jYy5sb2coXCJXZWJTb2NrZXQg5qOA5rWL5Yiw5bqU55So6L+b5YWl5YmN5Y+w77yaXCIsIG5ldyBEYXRlKCkpO1xuICAgIGxldCBpZCA9IHRoaXMudXNlckluZm8gPyB0aGlzLnVzZXJJbmZvLmlkIDogdW5kZWZpbmVkO1xuICAgIFNvY2tldC5zZW5kQXBwQWN0aXZlKGlkKTtcbiAgICB0aGlzLl9jaGVja1NvY2tldCgpO1xuXG4gICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9jaGVja1NvY2tldEV4ZWN1dGUoKTtcbiAgICB9LmJpbmQodGhpcyksIDEuNSk7XG4gIH0sXG5cbiAgLy/ov5vlhaXlkI7lj7Dmk43kvZxcbiAgZW50ZXJiYWNrZ3JvdWRBY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLl9hcHBFbnRlckJhY2tncm91bmQoKTtcbiAgfSxcblxuICAvL+i/m+WFpeWJjeWPsOaTjeS9nFxuICByZXN1bWVBY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICAvL+ajgOafpee9kee7nFxuICAgIHRoaXMuX2NoZWNrTmV0d29yaygpO1xuICAgIHRoaXMuX2FwcEJlY29tQWN0aXZlKCk7XG4gIH0sXG5cbiAgc2VuZE1lc3NhZ2U6IGZ1bmN0aW9uIChhY3Rpb24sIGRhdGEpIHtcbiAgICBkYXRhID0gdGhpcy5fc3Ryb25nVmVyaWZ5RGF0YShkYXRhKTtcblxuICAgIGlmICh0aGlzLnNvY2tldEVycm9yKSB7XG4gICAgICBjYy5lcnJvcihcInNvY2tldCDov57mjqXplJnor6/vvJpcIiArIHRoaXMuc29ja2V0RXJyb3IpO1xuICAgICAgdGhpcy5yZWNvbm5lY3QoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy9jYy5sb2coJ1dlYlNvY2tldCDlj5HpgIHmtojmga/vvJonICsgYWN0aW9uLCBkYXRhKTtcbiAgICBpZiAoY2Muc3lzLmlzT2JqZWN0VmFsaWQodGhpcy53cykpIHtcbiAgICAgIGlmICh0aGlzLndzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7XG4gICAgICAgIHRoaXMud3Muc2VuZCh0aGlzLl9jb252ZXJ0UGFyYW1ldGVyVG9TdHJpbmcoYWN0aW9uLCBkYXRhKSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29ubmVjdGlvbkRpc2Nvbm5lY3QoKTtcbiAgICB9XG4gIH0sXG5cbiAgX3N0cm9uZ1ZlcmlmeURhdGE6IGZ1bmN0aW9uKGRhdGEgPSB7fSkge1xuICAgIGlmICgodHlwZW9mIGRhdGEpID09ICdzdHJpbmcnKSB7XG4gICAgICBkYXRhID0ge1wic3RyaW5nXCI6IGRhdGF9O1xuICAgIH1cblxuICAgIGlmIChkYXRhID09IG51bGwpIHtcbiAgICAgIGRhdGEgPSB7fTtcbiAgICB9XG5cbiAgICBpZiAoIWRhdGFbXCJ1c2VySWRcIl0pIHtcbiAgICAgIGlmICh0aGlzLnVzZXJJbmZvICYmICh0eXBlb2YgdGhpcy51c2VySW5mbykgPT0gJ29iamVjdCcgJiYgdGhpcy51c2VySW5mby5pZCkge1xuICAgICAgICBkYXRhW1widXNlcklkXCJdID0gdGhpcy51c2VySW5mby5pZDtcbiAgICAgIH1cblxuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbiAgfSxcblxuICBfY29udmVydFBhcmFtZXRlclRvU3RyaW5nOiBmdW5jdGlvbiAoYWN0aW9uLCBkYXRhID0ge30pIHtcbiAgICB2YXIgb2JqID0ge307XG4gICAgb2JqLmFjdGlvbiA9IGFjdGlvbjtcbiAgICBvYmouZGF0YSA9IGRhdGE7XG4gICAgXG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iaik7XG4gIH0sXG5cbiAgLy8g5qOA5p+l572R57ucXG4gIF9jaGVja05ldHdvcms6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5jaGVja05ldHdvcmtOb3cpIHtcbiAgICAgIHRoaXMuY2hlY2tOZXR3b3JrTm93KCk7XG4gICAgfVxuXG4gICAgdGhpcy5zaG91bGRDaGVjayA9IHRydWU7XG4gICAgaWYgKCF0aGlzLnNvY2tldEVycm9yKSB7XG4gICAgICB0aGlzLnJlY3ZUaW1lID0gMDtcbiAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoJ2NoZWNrQWN0aW9uJywgJycpO1xuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNoZWNrTmV0d29ya0VuZCgpO1xuICAgICAgICB0aGlzLnNob3VsZENoZWNrID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnJlY3ZUaW1lID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5jb25uZWN0aW9uRGlzY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICB9LCAyLjUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb25EaXNjb25uZWN0KCk7XG4gICAgfVxuICB9LFxuXG4gIC8vIE1BUks6IHNvY2tldCDmjonnur/lsL3ml6nnoa7orqRcbiAgX2NoZWNrU29ja2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zY2hlZHVsZSh0aGlzLl9jaGVja1NvY2tldEV4ZWN1dGUsIFNvY2tldENvbnN0YW50Lk1heFJlY29ubmVjdENoZWNrSW50ZXJ2YWwsIGNjLm1hY3JvLlJFUEVBVF9GT1JFVkVSKTtcbiAgfSxcblxuICBfY2FuY2VsQ2hlY2tTb2NrZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fY2hlY2tTb2NrZXRFeGVjdXRlKTtcbiAgfSxcblxuICBfY2hlY2tTb2NrZXRFeGVjdXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuX2lzU29ja2V0VGltZW91dCgpICYmIHRoaXMud3MpIHtcbiAgICAgIHRoaXMud3MuX2txX29uZXJyb3IoJ+i/nuaOpei2heaXticpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfSxcblxuICAvLyBzb2NrZXQg5piv5ZCm5bey6LaF5pe2XG4gIF9pc1NvY2tldFRpbWVvdXQ6IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGFzdFJlY2VpdmVNZXNzYWdlSW50ZXJ2YWwoKSA+PSB0aGlzLl90aW1lb3V0O1xuICB9LFxuXG4gIC8vIOS4iuS4gOasoeaUtuWIsOa2iOaBr+WIsOeOsOWcqOeahOaXtumXtOmXtOmalFxuICBfbGFzdFJlY2VpdmVNZXNzYWdlSW50ZXJ2YWw6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xuICAgIGxldCBpbnRlcnZhbCA9IChub3cgLSB0aGlzLl9sYXN0UmVjZWl2ZU1zZ1RpbWUpIC8gMTAwMDtcbiAgICAvL2NjLmxvZyhgV2ViU29ja2V0IOeOsOWcqOi3neS4iuS4gOadoeaUtuWIsOa2iOaBr+eahOaXtumXtOmXtOmalOaYr++8miR7aW50ZXJ2YWx9IOenkmApO1xuICAgIHJldHVybiBpbnRlcnZhbDtcbiAgfSxcblxufSk7XG5cbi8vIE1BUks6IFNvY2tldCDkuovku7blrprkuYlcblNvY2tldC5FdmVudCA9IHtcbiAgU29ja2V0Q29ubmVjdGluZzogXCJTb2NrZXRDb25uZWN0aW5nXCIsICAgICAgICAgICAgIC8vIFNvY2tldCDmraPlnKjov57mjqVcbiAgU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZDogXCJTb2NrZXRDb25uZWN0U3VjY2Vzc2VkXCIsIC8vIOi/nuaOpeaIkOWKn1xuICBTb2NrZXREaXNjb25uZWN0OiBcIlNvY2tldERpc2Nvbm5lY3RcIiwgICAgICAgICAvLyBTb2NrZXQg5pat5byA6L+e5o6lXG4gIFNvY2tldENvbm5lY3RFcnJvcjogXCJTb2NrZXRDb25uZWN0RXJyb3JcIiwgICAgIC8vIFNvY2tldCDov57mjqXplJnor69cbiAgU29ja2V0UmVjZWl2ZU1lc3NhZ2U6IFwiU29ja2V0UmVjZWl2ZU1lc3NhZ2VcIiwgLy8gU29ja2V0IOaOpeaUtuWIsOa2iOaBr1xuXG4gIExvZ2luSm9pbjpcImxvZ2luSm9pblwiLCAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEg5LuO55m76ZmG55WM6Z2i6I635Y+W5oi/6Ze05Y+36L+b5YWl5ri45oiPXG4gIFJlY29yZElkOlwicmVjb3JkSWRcIiwgICAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgIFxuICBPbmNlQWdhaW46XCJvbmNlQWdhaW5cIiwgICAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgIFxuICBCZWlMdjogXCJiZWlMdlwiLCAgICAgICAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBICBcbiAgSW52aXRlQ29kZTogXCJpbnZpdGVDb2RlXCIsICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSAgIOmCgOivt+eggVxuICBKb2luRGVzazogXCJqb2luRGVza1wiLCAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXG4gIENyZWF0ZURlc2s6IFwiY3JlYXRlRGVza1wiLCAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcbiAgTGVhdmVEZXNrOiBcImxlYXZlRGVza1wiLCAgICAgICAgICAgICAgIC8vIOemu+W8gOahjOWtkFxuICBEaXNzb2x2ZURlc2s6IFwiZGlzc29sdmVEZXNrXCIsICAgICAgICAgLy8g6Kej5pWj5qGM5a2QXG4gIEFuc3dlckRpc3NvbHZlOiBcImFuc3dlckRpc3NvbHZlXCIsICAgICAvLyDlm57nrZTor7fmsYLpgIDlh7rlkb3ku6RcbiAgR2V0RGVza0luZm86IFwiZ2V0RGVza0luZm9cIiwgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxuICBTZW5kSW1hZ2U6IFwic2VuZEltYWdlXCIsICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXG4gIFNlbmRUZXh0OiBcInNlbmRUZXh0XCIsICAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcbiAgU2VuZEVtb2ppOiBcInNlbmRFbW9qaVwiLCAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxuICBDaGFuZ2VJbmZvOlwiY2hhbmdlSW5mb1wiLCAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXG4gIFNlbmRBdWRpb01lc3NhZ2U6IFwic2VuZEF1ZGlvTWVzc2FnZVwiLCAvLyDlrqLmiLfnq6/lj5HpgIEgIOWPkemAgeivremfs+a2iOaBr1xuICBHZXRSZWNvcmQ6IFwiZ2V0UmVjb3JkXCIsICAgICAgICAgICAgICAgLy8g6I635Y+W5oiY57up5L+h5oGvXG4gIEdldEl0ZW1SZWNvcmQ6IFwiZ2V0SXRlbVJlY29yZFwiLCAgICAgICAvLyDojrflj5bmiJjnu6nkv6Hmga9cbiAgUGxheUNhcmQ6IFwicGxheUNhcmRcIiwgICAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAge+8jOeUqOaIt+aJk+WHuueJjFxuICBUaW1lb3V0RGlzc29sdmU6IFwidGltZW91dERpc3NvbHZlXCIsICAgLy8g6K+35rGC6YCA5Ye66LaF5pe25pe277yM6ZyA6KaB5Y+R5Ye655qE5raI5oGvXG4gIEZlZWRiYWNrOiBcImZlZWRiYWNrXCIsICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBICDlj43ppojkv6Hmga9cbiAgU2hhcmVQbmc6IFwic2hhcmVQbmdcIiwgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgIOWIhuS6q+mihuWPluegluefs1xuICBFbnRlclJhbmRvbTogXCJpbnRlclJhbmRvbVwiLCAgIC8vIOWuouaIt+err+WPkemAgSAg6L+b5YWl6ZqP5py65Zy6XG4gIENhbmNlbFJhbmRvbTogXCJjYW5jZWxSYW5kb21cIiwgLy8g5a6i5oi356uv5Y+R6YCBICDlj5bmtojov5vlhaXpmo/mnLrlnLpcbiAgRm9yY2VFeGl0UmFuZG9tOiBcImRpc3NvbHZlXCIsICAvLyDlrqLmiLfnq6/lj5HpgIEg5by65Yi26YCA5Ye66ZqP5py65Zy6XG4gIFJlYWR5OiBcInJlYWR5XCIsICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBIOWHhuWkh1xuICBTdGFydEdhbWU6IFwic3RhcnRHYW1lXCIsIC8vIOWuouaIt+err+WPkemAgSDlvIDlp4vmuLjmiI9cbiAgR2V0SGFsbEluZm86IFwiZ2V0SGFsbEluZm9cIiwgICAvLyDlrqLmiLfnq6/lj5HpgIEg6I635Y+W5aSn5Y6F5L+h5oGvXG4gIEdldFVzZXJJbmZvOiBcImdldFVzZXJJbmZvXCIsICAgLy8g5a6i5oi356uv5Y+R6YCBIOiOt+WPlueUqOaIt+S/oeaBr1xuICBDaGVja0FjdGlvbjogXCJjaGVja0FjdGlvblwiLCAgIC8vIOWuouaIt+err+WPkemAge+8jOeUqOadpeajgOa1i+S4juacjeWKoeWZqOeahOi/numAmuaAp1xuICBQYXVzZTogXCJwYXVzZVwiLCAgICAgICAgICAgICAgIC8vIOWuouaIt+err+i/m+WFpeWQjuWPsOaXtuimgeWPkemAgeeahOa2iOaBr1xuICBBY3RpdmU6IFwiYWN0aXZlXCIsICAgICAgICAgICAgIC8vIOWuouaIt+err+WbnuWIsOWJjeWPsOaXtuimgeWPkemAgeeahOa2iOaBr1xuICBRaW5nbGk6IFwicWluZ2xpXCIsICAgICAgICAgICAgIC8vIOWuouaIt+err+WbnuWIsOWJjeWPsOaXtuimgeWPkemAgeeahOa2iOaBr1xuXG4gIFJlY2VpdmVSZXF1ZXN0RGlzc29sdmU6IFwicmVxdWVzdERpc3NvbHZlXCIsIC8vIOivt+axguino+aVo+ahjOWtkCDmnI3liqHlmajlj5HpgIFcbiAgUmVjZWl2ZVJlcXVlc3REaXNzb2x2ZVJlc3VsdDogXCJyZXF1ZXN0RGlzc29sdmVSZXN1bHRcIiwgLy8g6K+35rGC6Kej5pWj5qGM5a2Q57uT5p6cXG4gIFJlY2VpdmVDaGF0VGV4dDogXCJzZW5kVGV4dFwiLCAgICAvLyDmnI3liqHlmajlj5HpgIFcbiAgUmVjZWl2ZUNoYXRFbW9qaTogXCJzZW5kRW1vamlcIiwgIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlRGVza0luZm86IFwiZGVza0luZm9cIiwgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVHYW1lT3ZlcjogXCJnYW1lT3ZlclwiLCAgICAvLyDmnI3liqHlmajlj5HpgIFcbiAgUmVjZWl2ZUZhUGFpOiBcImZhcGFpXCIsICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlU2hhcmVQbmc6IFwic2hhcmVQbmdzXCIsICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVPbmxpbmVTdGF0dXM6IFwic2VuZE9ubGluZVN0YXR1c1wiLCAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVPbkNoYW5nZUluZm86IFwiY2hhbmdlSW5mb1wiLCAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVBdWRpb01lc3NhZ2U6IFwic2VuZEF1ZGlvTWVzc2FnZVwiLCAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5o6l5pS25Yiw55So5oi35Y+R6YCB5LqG6K+t6Z+z5raI5oGvXG4gIFJlY2VpdmVQbGF5Q2FyZDogXCJwbGF5Q2FyZFwiLCAgICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pyJ55So5oi35bey57uP5YeG5aSH5aW954mMXG4gIFJlY2VpdmVDcmVhdGVEZXNrOiBcImNyZWF0ZURlc2tcIiwgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5Yib5bu65oi/6Ze055qE5Zue6LCDXG4gIFJlY2VpdmVSZWFkeTogXCJyZWFkeVwiLCAgICAgICAgICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pyJ55So5oi354K55Ye75LqG5YeG5aSHXG4gIFJlY2VpdmVIYWxsSW5mbzogXCJnZXRIYWxsSW5mb1wiLCAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVHZXRVc2VySW5mbzogXCJnZXRVc2VySW5mb1wiLCAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBIOiOt+WPlueUqOaIt+S/oeaBr1xuICBSZWNlaXZlQ2hlY2tBY3Rpb246IFwiY2hlY2tBY3Rpb25cIiwgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgSAg55So5p2l56Gu6K6kIFNvY2tldCDov5jlnKjov57nnYBcbiAgUmVjZWl2ZUZvcmNlRXhpdDogXCJmb3JjZUV4aXRcIiwgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIEgIOeUqOadpeS9v+WuouaIt+err+W8uumAgFxuICBSZWNlaXZlRGlzc29sdmVEZXNrOiBcImRpc3NvbHZlRGVza1wiLCAgICAgIC8vIOacjeWKoeWZqOWPkemAgSAgIOW9k+aIv+S4u+mAgOWHuuaXtu+8jOino+aVo+ahjOWtkFxuICBSZWNlaXZlSW50ZXJSYW5kb206IFwiaW50ZXJSYW5kb21cIiwgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgSAgIOi/m+WFpemaj+acuuWcuueahOWPjemmiFxuICBSZWNlaXZlUGF1c2U6IFwicGF1c2VcIiwgICAgICAgICAgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgSAgIOW9k+acieeUqOaIt+iuvuWkh+i/m+WFpeWQjuWPsOaXtu+8jOS8muaUtuWIsOi/meadoea2iOaBr1xuICBSZWNlaXZlSW52aXRlQ29kZTogJ2ludml0ZUNvZGUnLCAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDpgoDor7fnoIHnmoTmtojmga9cbiAgUmVjZWl2ZUxlYXZlRGVzazogJ2xlYXZlRGVzaycsICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pS25Yiw6ZyA6KaB56a75byA5qGM5a2Q55qE5raI5oGvXG4gIFJlY2VpdmVTZWxlY3RCZWlMdjogJ3NlbGVjdEJlaUx2JywgICAgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOaUtuWIsOmAieaLqeWAjeeOh+eahOa2iOaBr1xuICBSZWNlaXZlQmVpTHY6J2JlaUx2JywgICAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDlgI3njofnmoTmtojmga9cbiAgUmVjZWl2ZVFpbmdMaToncWluZ2xpJywgICAgICAgICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pS25Yiw6K+356a7XG4gIFJlY2VpdmVSZWNvcmRJZDoncmVjb3JkSWQnLCAgICAgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOaUtuWIsOaImOe7qeS/oeaBr1xuICBSZWNlaXZlTG9naW5Kb2luOidsb2dpbkpvaW4nLCAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDku47pobXpnaLov5vlhaXmiL/pl7Tkv6Hmga9cbiAgUmVjZWl2ZU9uY2VBZ2Fpbjonb25jZUFnYWluJywgICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pS25Yiw5YaN5p2l5LiA5bGA5L+h5oGvXG4gIFJlY2VpdmVOb1Vpb25pZDonbm9VaW9uaWQnLCAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDmsqHmnIl1bmlvbklE5L+h5Y+3XG59O1xuXG5cbi8vIE1BUks6IFNvY2tldCDmj5DkvpvnmoTlj6/lj5Hnu5nmnI3liqHlmajmtojmga/nmoTmlrnms5VcblxuU29ja2V0LnNlbmRDaGVja0FjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ2hlY2tBY3Rpb24sIG51bGwpO1xufTtcbi8qKi9cblNvY2tldC5zZW5kRGlkUmVjZWl2ZUdhbWVPdmVyQWN0aW9uID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjb25zdCBwYXJhbSA9IHVzZXJJZCA/IHtcInVzZXJJZFwiOiB1c2VySWR9IDogbnVsbDtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZShTb2NrZXQuRXZlbnQuRGlkUmVjZWl2ZUdhbWVPdmVyQWN0aW9uLCBwYXJhbSk7XG59O1xuLyoqL1xuXG5cbi8qKlxuICog5b2TIEFQUCDov5vlhaXlkI7lj7Dml7bopoHlj5HpgIHnmoTmtojmga9cbiAqL1xuU29ja2V0LnNlbmRBcHBQYXVzZSA9IGZ1bmN0aW9uKHVzZXJJZCkge1xuICBsZXQgcGFyYW0gPSB1c2VySWQgPyB7XCJ1c2VySWRcIjogdXNlcklkfSA6IG51bGw7XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5QYXVzZSwgcGFyYW0pO1xufTtcblxuLyoqXG4gKiDlvZMgQVBQIOi/m+WFpeWJjeWPsOaXtuWPkemAgeeahOa2iOaBr1xuICovXG5Tb2NrZXQuc2VuZEFwcEFjdGl2ZSA9IGZ1bmN0aW9uKHVzZXJJZCkge1xuICBsZXQgcGFyYW0gPSB1c2VySWQgPyB7XCJ1c2VySWRcIjogdXNlcklkfSA6IG51bGw7XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5BY3RpdmUsIHBhcmFtKTtcbn07XG5cbi8vIOW8gOaIv1xuU29ja2V0LnNlbmRDcmVhdGVEZXNrID0gZnVuY3Rpb24gKGNyZWF0ZURlc2NJbmZvLCB1c2VySWQpIHtcbiAgY2MuYXNzZXJ0KGNyZWF0ZURlc2NJbmZvKTtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG5cbiAgY3JlYXRlRGVzY0luZm9bXCJ1c2VySWRcIl0gPSB1c2VySWQ7XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5DcmVhdGVEZXNrLCBjcmVhdGVEZXNjSW5mbyk7XG59O1xuXG5Tb2NrZXQuc2VuZFFpbmdsaSA9IGZ1bmN0aW9uKGxlYXZlSWQsdXNlcklkKXtcbiBsZXQgcGFyYW0gPSB7XG4gICAgXCJsZWF2ZUlkXCI6IGxlYXZlSWQsXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuUWluZ2xpLCBwYXJhbSk7XG59O1xuLy8g5LuO55m76ZmG6aG16Z2i5Yqg5YWl5oi/6Ze0XG5Tb2NrZXQuc2VuZExvZ2luSm9pbiA9IGZ1bmN0aW9uIChyb29tSWQsIHVzZXJJZCkge1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJyb29tSWRcIjogcm9vbUlkLFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkxvZ2luSm9pbiwgcGFyYW0pO1xufTtcbi8vIOWGjeadpeS4gOWxgFxuU29ja2V0LnNlbmRPbmNlQWdhaW4gPSBmdW5jdGlvbiAoYWdhaW4sdXNlcklkKSB7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgXCJhZ2FpblwiOmFnYWluLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuT25jZUFnYWluLCBwYXJhbSk7XG59O1xuLy8g5Yqg5YWl5oi/6Ze0XG5Tb2NrZXQuc2VuZEpvaW5EZXNrID0gZnVuY3Rpb24gKHJvb21JZCwgdXNlcklkKSB7XG4gIGNjLmFzc2VydChyb29tSWQpO1xuICBjYy5hc3NlcnQodXNlcklkKTtcblxuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJyb29tSWRcIjogcm9vbUlkLFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkpvaW5EZXNrLCBwYXJhbSk7XG59O1xuLy8g5ZCR5pyN5Yqh56uv5Y+R6YCB5oiR6YCJ5oup55qE5YCN546HXG5Tb2NrZXQuc2VuZEJlaUx2ID0gZnVuY3Rpb24oYmVpbHYsdXNlcklkKXtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwiYmVpbHZcIjogYmVpbHYsXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQmVpTHYsIHBhcmFtKTtcbn07XG4vLyDlj5HpgIHpgoDor7fnoIFcblNvY2tldC5zZW5kSW52aXRlQ29kZSA9IGZ1bmN0aW9uKGludml0ZUNvZGUsdXNlcklkKXtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwiaW52aXRlQ29kZVwiOiBpbnZpdGVDb2RlLFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50Lkludml0ZUNvZGUsIHBhcmFtKTtcbn07XG5cbi8vIOiOt+WPluaIv+mXtOS/oeaBr1xuU29ja2V0LnNlbmRHZXREZXNja0luZm8gPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXREZXNrSW5mbywgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRUZXh0ID0gZnVuY3Rpb24gKHVzZXJJZCwgdGV4dCkge1xuICAvL2NjLmFzc2VydCh1c2VySWQpO1xuICAvL2NjLmFzc2VydCh0ZXh0KTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwibXNnXCI6IHRleHQsXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU2VuZFRleHQsIHBhcmFtKTtcbn07XG5Tb2NrZXQuc2VuZEVtb2ppID0gZnVuY3Rpb24odXNlcklkLGVtb2ppKXtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwiZW1vamlcIjogZW1vamksXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU2VuZEVtb2ppLCBwYXJhbSk7XG59O1xuU29ja2V0LnNlbmRDaGFuZ2VJbmZvID0gZnVuY3Rpb24odXNlcklkLEluZm8pe1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJjaGFuZ2VJbmZvXCI6IEluZm8sXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ2hhbmdlSW5mbywgcGFyYW0pO1xufTtcblNvY2tldC5zZW5kQXVkaW9NZXNzYWdlID0gZnVuY3Rpb24gKHVzZXJJZCwgdXJsID0gXCJcIikge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgY2MuYXNzZXJ0KHVybC5sZW5ndGggPiAwKTtcblxuICBpZiAodXJsLmxlbmd0aCA9PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXJsXCI6IHVybCxcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TZW5kQXVkaW9NZXNzYWdlLCBwYXJhbSk7XG59O1xuXG5Tb2NrZXQuc2VuZEltYWdlID0gZnVuY3Rpb24gKHVzZXJJZCwgaW1hZ2UpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGNjLmFzc2VydChpbWFnZSk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcIm1zZ1wiOiBpbWFnZSxcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TZW5kSW1hZ2UsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kR2V0UmVjcm9kID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkdldFJlY29yZCwgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRHZXRSZWNyb2RGcm9tSWQgPSBmdW5jdGlvbihyZWNvcmRJZCl7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInJlY29yZElkXCI6cmVjb3JkSWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5SZWNvcmRJZCxwYXJhbSk7XG59O1xuXG5Tb2NrZXQuc2VuZERpc3NvbHZlRGVzayA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5EaXNzb2x2ZURlc2ssIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kR2V0SXRlbVJlY29yZCA9IGZ1bmN0aW9uICh1c2VySWQsIHBhcmVudElkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBjYy5hc3NlcnQocGFyZW50SWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIFwicGFyZW50SWRcIjogcGFyZW50SWQsXG4gIH07XG5cbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkdldEl0ZW1SZWNvcmQsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kTGVhdmVEZXNrID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgIGNjLmFzc2VydCh1c2VySWQpO1xuICAgIGxldCBwYXJhbSA9IHtcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICB9O1xuXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkxlYXZlRGVzaywgcGFyYW0pO1xufSxcblxuLyoqXG4gKiDlm57nrZTpgIDmiL/or7fmsYJcbiAqIFxuICogQHBhcmFtICB7TnVtYmVyfSB1c2VySWQg5b2T5YmN55So5oi3IGlkXG4gKiBAcGFyYW0gIHtOVW1iZXJ9IGFuc3dlcj0xIOWbnuetlOOAgjEg6KGo56S65ZCM5oSP77ybIDAg6KGo56S65ouS57ud77ybIC0xIOihqOekuuacqumAieaLqVxuICovXG5Tb2NrZXQuc2VuZEFuc3dlckRpc3NvbHZlID0gZnVuY3Rpb24gKHVzZXJJZCwgYW5zd2VyID0gMCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICBcImFuc3dlclwiOiBhbnN3ZXJcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQW5zd2VyRGlzc29sdmUsIHBhcmFtKTtcbn0sXG5cbiAgU29ja2V0LnNlbmRGb3JjZUV4aXRSb29tID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgIGNjLmFzc2VydCh1c2VySWQpO1xuICAgIGxldCBwYXJhbSA9IHtcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICB9O1xuXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkRpc3NvbHZlRGVzaywgcGFyYW0pO1xuICB9LFxuXG4gIC8vIOWNgeS4ieW8oOS4rVxuICAvLyBjYXJkSW5mbyDnsbvkvLzkuo7vvJpcbiAgLy8gW3tcbiAgLy8gICAgICAgICAnY2FyZHMnOlt7J3N1aXQnOnN1aXQsJ251bWJlcic6bnVtYmVyfSx7fV0sLy/nibnmrorniYzkuI3nlKjkvKBcbiAgLy8gICAgICAgICAndHlwZSc6MCxcbiAgLy8gICAgICAgICAndmFsdWUnOjQsXG4gIC8vICAgICAgICAgJ2lzQ29udGFpbkV4dHJhJzp0cnVlLC8vIOeJueauiueJjOaYr+WQpuWMheWQq+eJueauiueJjFxuICAvLyAgICAgfSxcbiAgLy8gICAgIHtcbiAgLy8gICAgICAgICAnY2FyZHMnOlt7J3N1aXQnOnN1aXQsJ251bWJlcic6bnVtYmVyfSx7fV0sXG4gIC8vICAgICAgICAgJ3R5cGUnOjAsXG4gIC8vICAgICAgICAgJ3ZhbHVlJzo0XG4gIC8vICAgICB9XVxuU29ja2V0LnNlbmRQbGF5Q2FyZCA9IGZ1bmN0aW9uICh1c2VySWQsIGNhcmRJbmZvKSB7XG4gICAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gICAgbGV0IHBhcmFtID0ge1xuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgICAgXCJjYXJkXCI6IGNhcmRJbmZvXG4gICAgfTtcblxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5QbGF5Q2FyZCwgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRUaW1lb3V0RGlzc29sdmUgPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5UaW1lb3V0RGlzc29sdmUsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kRmVlZGJhY2sgPSBmdW5jdGlvbiAodXNlcklkLCB0ZXh0KSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBjYy5hc3NlcnQodGV4dCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgXCJ0ZXh0XCI6IHRleHRcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuRmVlZGJhY2ssIHBhcmFtKTtcbn1cblxuU29ja2V0LnNlbmRTaGFyZVBuZyA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TaGFyZVBuZywgcGFyYW0pO1xufTtcbi8vIOW8gOWni+WMuemFjemaj+acuuWculxuU29ja2V0LnNlbmRFbnRlclJhbmRvbSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG5cbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkVudGVyUmFuZG9tLCBwYXJhbSk7XG59O1xuXG4vLyDlj5bmtojljLnphY3pmo/mnLrlnLpcblNvY2tldC5zZW5kQ2FuY2VsUmFuZG9tID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ2FuY2VsUmFuZG9tLCBwYXJhbSk7XG59O1xuXG4vLyDlh4blpIdcblNvY2tldC5zZW5kUmVhZHkgPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gICAgbGV0IHBhcmFtID0ge1xuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIH07XG5cbiAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuUmVhZHksIHBhcmFtKTtcbiAgfSxcbiAgICBTb2NrZXQuc2VuZFN0YXJ0R2FtZSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICAgIGNjLmFzc2VydCh1c2VySWQpO1xuICAgICAgbGV0IHBhcmFtID0ge1xuICAgICAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgICB9O1xuICAgICAgY2MubG9nKHRoaXMuRXZlbnQuU3RhcnRHYW1lKVxuICAgICAgY2MubG9nKClcbiAgICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TdGFydEdhbWUsIHBhcmFtKTtcbiAgICB9LFxuXG4vLyDojrflj5blpKfljoXkv6Hmga9cblNvY2tldC5zZW5kR2V0SGFsbEluZm8gPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgbGV0IHBhcmFtID0ge1xuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIH07XG5cbiAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuR2V0SGFsbEluZm8sIHBhcmFtKTtcbn0sXG5cbi8vIOiOt+WPlueUqOaIt+S/oeaBr1xuU29ja2V0LnNlbmRHZXRVc2VySW5mbyA9IGZ1bmN0aW9uICh1c2VySWQsIG9wZW5JZCkge1xuICAgIGxldCBwYXJhbSA9IHtcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICAgIFwib3BlbklkXCI6IG9wZW5JZCxcbiAgICB9O1xuXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkdldFVzZXJJbmZvLCBwYXJhbSk7XG59LFxuXG5tb2R1bGUuZXhwb3J0cyA9IFNvY2tldDsiLCJ0aGlzLl9jaGFuZ2VDYXJkU2NvcnMgPSBmdW5jdGlvbihjYXJkTW9kZWwpIHtcclxuXHJcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7Y2FyZC5zY29yZXMgPSBjYXJkLm51bWJlcjt9KTtcclxuXHJcbiAgICBjYXJkTW9kZWwgPSB0aGlzLl9jb252ZXJ0T25lVG9BKGNhcmRNb2RlbCk7XHJcblxyXG4gICAgdmFyIGlzMTQgPSB0cnVlOy8v5pivQSBLIFEgSiAxMCA7XHJcblxyXG4gICAgdmFyIGlzMSA9IHRydWU7Ly/mmK8xIDIgMyA0IDVcclxuXHJcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7aWYgKGNhcmQuc2NvcmVzIDwgMTApIGlzMTQgPSBmYWxzZTt9KTsvL+S4jeaYr0EgSyBRIEogMTBcclxuXHJcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7aWYgKChjYXJkLnNjb3JlcyA+IDUgfHwgY2FyZC5zY29yZXMgPT0gMTQpICYmIGNhcmQuc2NvcmVzICE9IDIwKWlzMSA9IGZhbHNlfSk7Ly/kuI3mmK8xIDIgMyA0IDV9KTtcclxuXHJcbiAgICBpZiAoaXMxNCkgeyAvL+aYr0EgSyBRIEogMTAgO1xyXG5cclxuICAgICAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtyZXR1cm4gYTIuc2NvcmVzIC0gYTEuc2NvcmVzO30pO1xyXG5cclxuICAgICAgICB2YXIgbnVtID0gMTQsXHJcbiAgICAgICAgICAgIHNjb3Jlc0F5eSA9IFtdOyAvL+S4gOWJr+eJjOeahOWIhuaVsFxyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgc2NvcmVzQXl5LnB1c2gobnVtKTtcclxuXHJcbiAgICAgICAgICAgIG51bSAtPSAxO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRNb2RlbC5sZW5ndGg7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjYXJkU2NvcmVzID0gY2FyZE1vZGVsW2ldLnNjb3JlcztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY2FyZFNjb3JlcyA9PSBzY29yZXNBeXlbal0gJiYgY2FyZFNjb3JlcyA8IDE1KSBzY29yZXNBeXkuc3BsaWNlKGosIDEpOyAvL+WIoOmZpOS4jeaYr+msvOeJjOeahOWIhlxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkgeyBpZiAoY2FyZC5zY29yZXMgPj0gMjApIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLCAxKVswXTt9KTsvL+aJvuWHuumAieS4reeahOeJjFxyXG4gICAgfVxyXG5cclxuICAgIGVsc2UgaWYgKGlzMSkgeyAvL+aYrzEgMiAzIDQgNVxyXG5cclxuICAgICAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtyZXR1cm4gYTIuc2NvcmVzIC0gYTEuc2NvcmVzO30pO1xyXG5cclxuICAgICAgICB2YXIgbnVtID0gNSxcclxuICAgICAgICAgICAgc2NvcmVzQXl5ID0gW107IC8v5LiA5Ymv54mM55qE5YiG5pWwXHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICBzY29yZXNBeXkucHVzaChudW0pO1xyXG5cclxuICAgICAgICAgICAgbnVtIC09IDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNjb3Jlc0F5eS5sZW5ndGg7IGorKykge1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkTW9kZWwubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkgc2NvcmVzQXl5LnNwbGljZShqLCAxKTsgLy/liKDpmaTkuI3mmK/prLzniYznmoTliIZcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtpZiAoY2FyZC5zY29yZXMgPj0gMjApIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLCAxKVswXTt9KTsvL+aJvuWHuumAieS4reeahOeJjFxyXG4gICAgfVxyXG5cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge3JldHVybiBhMS5zY29yZXMgLSBhMi5zY29yZXM7fSk7XHJcblxyXG4gICAgICAgIHZhciBzY29yZXNBeXkgPSBbXTsgLy/nlKjmnaXoo4XprLzniYzliIbmlbBcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBzID0gcGFyc2VJbnQoY2FyZE1vZGVsWzBdLnNjb3JlcykgKyBpOyAvL+acgOWwj+eahOeJjOeahOWIhuaVsFxyXG5cclxuICAgICAgICAgICAgc2NvcmVzQXl5LnB1c2gocyk7Ly/kuIDlia/niYznmoTliIbmlbBcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNjb3Jlc0F5eS5sZW5ndGg7IGorKykge1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkTW9kZWwubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkgc2NvcmVzQXl5LnNwbGljZShqLCAxKTsgLy/liKDpmaTkuI3mmK/prLzniYznmoTliIZcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge2lmIChjYXJkLnNjb3JlcyA+PSAyMCkgY2FyZC5zY29yZXMgPSBzY29yZXNBeXkuc3BsaWNlKDAsMSlbMF07fSk7IC8v5pS55Y+Y54mM55qE5YiG5pWwXHJcbiAgICB9XHJcblxyXG4gICAgY2FyZE1vZGVsID0gdGhpcy5fY29udmVydE9uZVRvQShjYXJkTW9kZWwpO1xyXG5cclxuICAgIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge3JldHVybiBhMS5zY29yZXMgLSBhMi5zY29yZXM7fSk7XHJcbiAgICByZXR1cm4gY2FyZE1vZGVsO1xyXG59OyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbGVmdE5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgUmlndGhOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIF90aW1lOm51bGwsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgc2V0VGltZTogZnVuY3Rpb24gKHRpbWUpIHtcclxuXHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX3RpbWUgPSB0aW1lO1xyXG5cclxuICAgICAgICB0aGlzLmxlZnROb2RlLnJvdGF0aW9uID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5SaWd0aE5vZGUucm90YXRpb24gPSAwO1xyXG5cclxuICAgICAgICB0aGlzLlJpZ3RoTm9kZS5zdG9wQWxsQWN0aW9ucygpO1xyXG5cclxuICAgICAgICB0aGlzLmxlZnROb2RlLnN0b3BBbGxBY3Rpb25zKCk7XHJcblxyXG4gICAgICAgIHRoaXMubGVmdE5vZGUucnVuQWN0aW9uKCBjYy5yb3RhdGVCeSAodGhpcy5fdGltZSwtMTgwKSApO1xyXG5cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICB0aGlzLlJpZ3RoTm9kZS5ydW5BY3Rpb24oIGNjLnJvdGF0ZUJ5ICh0aGlzLl90aW1lLDE4MCkgKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCB0aGlzLl90aW1lKTtcclxuXHJcbiAgICB9LFxyXG5cclxuXHJcblxyXG59KTtcclxuIiwiY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5jb25zdCBQbGF5YmFjayA9IHJlcXVpcmUoJ1BsYXliYWNrJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNwcml0ZUF2YXRhcjogY2MuU3ByaXRlLFxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxTY29yZTogY2MuTGFiZWwsXG4gICAgICAgIHNwcml0ZU9mZmxpbmU6IGNjLlNwcml0ZSxcbiAgICAgICAgdm9pY2VOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBob21lUnVuTm9kZTogY2MuTm9kZSxcbiAgICAgICAgcmVhZHlOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBiZWlsdjpjYy5MYWJlbCxcbiAgICAgICAgc2hvb3ROb2RlczogW2NjLk5vZGVdLFxuICAgICAgICBiYW5rZXJOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBmYW5nWmh1Tm9kZTogY2MuTm9kZSxcbiAgICAgICAgcWluZ2xpOmNjLk5vZGUsXG4gICAgICAgIGlkOmNjLkxhYmVsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMudXBkYXRlU2NvcmUoKTtcbiAgICB9LFxuXG4gICAgc2V0cWluZ2xpIDpmdW5jdGlvbih2aXNpYmxlID0gZmFsc2Upe1xuICAgICAgdGhpcy5xaW5nbGkuYWN0aXZlID0gKHZpc2libGUgIT0gZmFsc2UpO1xuICAgIH0sXG5cbiAgICBzZXRSZWFkeU5vZGVWaXNpYmxlOiBmdW5jdGlvbiAodmlzaWJsZSA9IGZhbHNlKSB7XG4gICAgICB0aGlzLnJlYWR5Tm9kZS5hY3RpdmUgPSAodmlzaWJsZSAhPSBmYWxzZSk7XG4gICAgfSxcbiAgICBzZXRCZWlsdkxhYmVsIDpmdW5jdGlvbihibCl7XG4gICAgICAvL3RoaXMuYmVpbHYuYWN0aXZlID0gdHJ1ZTtcbiAgICAgIHRoaXMuYmVpbHYuc3RyaW5nID0gYmw/YmwrXCLlgI1cIjonJztcbiAgICB9LFxuXG4gICAgc2V0RmFuZ1podU5vZGVWaXNpYmxlOiBmdW5jdGlvbiAodmlzaWJsZSA9IGZhbHNlKSB7XG4gICAgICAgIHRoaXMuZmFuZ1podU5vZGUuYWN0aXZlID0gKHZpc2libGUgIT0gZmFsc2UpO1xuICAgIH0sXG5cbiAgICB1cGRhdGVTY29yZTogZnVuY3Rpb24gKHNjb3JlID0gMCkge1xuICAgICAgICBpZihzY29yZSA+PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmxhYmVsU2NvcmUuc3RyaW5nID0gXCIrXCIgKyBzY29yZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubGFiZWxTY29yZS5zdHJpbmcgPSBcIlwiK3Njb3JlO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB1cGRhdGVVc2VySWQ6ZnVuY3Rpb24oaWQpe1xuICAgICAgdGhpcy5pZC5zdHJpbmcgPSBpZCA/IChcIklEOlwiK2lkKTpcIlwiO1xuICAgIH0sXG4gICAgdXBkYXRlTmlja25hbWU6IGZ1bmN0aW9uKG5pY2tuYW1lID0gXCJcIikge1xuICAgICAgdGhpcy5sYWJlbE5pY2tuYW1lLnN0cmluZyA9IG5pY2tuYW1lO1xuICAgIH0sXG5cbiAgICB1cGRhdGVBdmF0YXI6IGZ1bmN0aW9uIChhdmF0YXIpIHtcbiAgICAgIGlmIChhdmF0YXIuZW5kc1dpdGgoXCJwbmdcIilcbiAgICAgIHx8IGF2YXRhci5lbmRzV2l0aChcImpwZ1wiKVxuICAgICAgfHwgYXZhdGFyLmVuZHNXaXRoKFwiZ2lmXCIpKSB7XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vYXZhdGFyID0gYXZhdGFyICsgXCIucG5nXCI7XG4gICAgICB9XG5cbiAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6YXZhdGFyLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZShkYXRhKTtcbiAgICAgICAgdGhpcy5zcHJpdGVBdmF0YXIuc3ByaXRlRnJhbWUgPSBmcmFtZTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIHNldE9mZmxpbmVWaXNpYmxlOiBmdW5jdGlvbiAodmlzaWJsZSA9IGZhbHNlKSB7XG4gICAgICBpZiAoUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XG4gICAgICAgIC8vIOWmguaenOaYr+WkhOeQhuWbnuaUvueKtuaAge+8jOWwseS4jeeUqOWGjeWkhOeQhuemu+e6v+a2iOaBr+S6hlxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuc3ByaXRlT2ZmbGluZS5ub2RlLmFjdGl2ZSA9IHZpc2libGU7XG4gICAgfSxcblxuICAgIHNldElzQmFua2VyOiBmdW5jdGlvbihpc0JhbmtlciA9IGZhbHNlKSB7XG4gICAgICB0aGlzLmJhbmtlck5vZGUuYWN0aXZlID0gaXNCYW5rZXI7XG4gICAgfSxcblxuICAgIHBsYXlTaG9vdEFuaW1hdGlvbjogZnVuY3Rpb24gKHRvSW5kZXggPSAwKSB7XG4gICAgICAvL2xldCBzaG9vdE5vZGUgPSB0aGlzLnNob290Tm9kZXNbdG9JbmRleF07XG4gICAgICAvL3Nob290Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgLy9sZXQgYW5pbSA9IHNob290Tm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgIC8vYW5pbS5wbGF5KCdzaG9vdCcpLm9uKCdmaW5pc2hlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vICBzaG9vdE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAvL30sIHRoaXMpO1xuXG4gICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheURhUWlhbmcoKTtcbiAgICB9LFxuXG4gICAgcGxheUJ1bGxldEhvbGVBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBidWxsZXRIb2xlTm9kZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSgnYnVsbGV0SG9sZScpO1xuICAgICAgYnVsbGV0SG9sZU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgIGxldCBhbmltID0gYnVsbGV0SG9sZU5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICBhbmltLnBsYXkoJ2J1bGxldEhvbGUnKS5vbignZmluaXNoZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGJ1bGxldEhvbGVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIHBsYXlTcGVha0FuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy52b2ljZU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy52b2ljZU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB9LmJpbmQodGhpcyksIDQpO1xuICAgIH0sXG5cbiAgICAvLyDmkq3mlL7lhajlnpLmiZPliqjnlLtcbiAgICBwbGF5SG9tZVJ1bkFpbWF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAvL2xldCBhbGVydCA9IHRoaXMuaG9tZVJ1bk5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgLy9hbGVydC5hbGVydCgpO1xuICAgICAgLy90aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAvLyAgdGhpcy5ob21lUnVuTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIC8vfS5iaW5kKHRoaXMpLCAyKTtcbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB6aHVhbk51bUxhYmVsOmNjLkxhYmVsLFxuICAgICAgICBqdXNodTpjYy5Ob2RlLFxuICAgICAgICBBQTpjYy5Ob2RlLFxuICAgICAgICBfc2VsZWN0ZWRQZW9wbGVJbmRleDpudWxsLFxuICAgICAgICBfc2VsZWN0ZWRKdXNodUluZGV4Om51bGwsXG4gICAgICAgIF9zZWxlY3RlZEFBSW5kZXg6bnVsbFxuICAgIH0sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY3RybCgpO1xuICAgIH0sXG5cbiAgICBjbGlja1Blb3BsZUFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fY3RybCgpO1xuICAgIH0sXG5cbiAgICBjbGlja0FBQWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2N0cmwoKTtcbiAgICB9LFxuXG4gICAgY2xpY2tKdXNodUFjdGlvbjpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2N0cmwoKTtcbiAgICB9LFxuXG4gICAgIF9jdHJsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJzaW5nbGVTZWxlY3RcIikuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgdGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID0gdGhpcy5qdXNodS5nZXRDb21wb25lbnQoXCJzaW5nbGVTZWxlY3RcIikuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgdGhpcy5fc2VsZWN0ZWRBQUluZGV4ID0gdGhpcy5BQS5nZXRDb21wb25lbnQoXCJjaGVja1NlbGVjdFwiKS5zZWxlY3RlZEluZGV4O1xuICAgICAgICAvL+S6uuaVsOmAiTLkurrml7bkuJTmsqHpgInkuIpBQeWItuaUtui0uVxuICAgICAgICAgdmFyIHJlblNodSA9IDI7XG4gICAgICAgICBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDApe1xuICAgICAgICAgICAgIHJlblNodSA9IDI7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMSl7XG4gICAgICAgICAgICAgcmVuU2h1ID0gMztcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9PSAyKXtcbiAgICAgICAgICAgICByZW5TaHUgPSA0O1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDMpe1xuICAgICAgICAgICAgIHJlblNodSA9IDU7XG4gICAgICAgICB9XG4gICAgICAgICB2YXIgemh1YW5nU2hpID0gMjA7XG4gICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgICAgICAgemh1YW5nU2hpID0gMjA7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcbiAgICAgICAgICAgICB6aHVhbmdTaGkgPSA0MDtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDIpe1xuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IDgwO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMyl7XG4gICAgICAgICAgICAgemh1YW5nU2hpID0gMTA7XG4gICAgICAgICB9XG4gICAgICAgICAvL0FBXG4gICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEFBSW5kZXggIT0gbnVsbCl7XG4gICAgICAgICAgICAgemh1YW5nU2hpID0gTWF0aC5jZWlsKHpodWFuZ1NoaSAvIHJlblNodSk7XG4gICAgICAgICB9XG4gICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gemh1YW5nU2hpO1xuICAgICAgICAvL2lmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMCl7XG4gICAgICAgIC8vICAgIGlmKHRoaXMuX3NlbGVjdGVkQUFJbmRleCA9PSBudWxsKXtcbiAgICAgICAgICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XG4gICAgICAgICAgICAgICAgLy9pZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgICAgICAgICAgLy8gICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMTBcIjtcbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgICAgICAvLy8v5bGA5pWw6YCJMjDlsYDml7ZcbiAgICAgICAgICAgICAgICAvL2lmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcbiAgICAgICAgICAgICAgICAvLyAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIzMFwiO1xuICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgIC8vLy/lsYDmlbDpgIkzMOWxgOaXtlxuICAgICAgICAgICAgICAgIC8vaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDIpe1xuICAgICAgICAgICAgICAgIC8vICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjgwXCI7XG4gICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAvL31cbiAgICAgICAgLy8gICAgZWxzZXtcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI4XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMTVcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyM1wiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vXG4gICAgICAgIC8vfVxuICAgICAgICAvL+S6uuaVsOmAiTPkurpcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgIC8v5rKh6YCJ5LiKQUHliLbmlLbotLlcbiAgICAgICAgLy8gICAgaWYodGhpcy5fc2VsZWN0ZWRBQUluZGV4ID09IG51bGwpe1xuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjIxXCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiNDJcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI2MFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vICAgIC8v6YCJ5LqGQUHmlLbotLlcbiAgICAgICAgLy8gICAgZWxzZXtcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI3XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMTRcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyMFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vXG4gICAgICAgIC8vfVxuICAgICAgICAvLy8v5Lq65pWw6YCJNOS6uuS4lOayoemAieS4ikFB5Yi25pS26LS5XG4gICAgICAgIC8vZWxzZXtcbiAgICAgICAgLy8gICAgaWYodGhpcy5fc2VsZWN0ZWRBQUluZGV4ID09IG51bGwpe1xuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjI4XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiNTZcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI4NFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vICAgIC8vQUHliLbmlLbotLnpgInkuIrkuoZcbiAgICAgICAgLy8gICAgZWxzZXtcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI3XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMTRcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyMVwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vfVxuICAgIH0sXG59KTtcbiJdfQ==