require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"ArrayExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4fd85NSsFJLd4qHrH0UjHzl', 'ArrayExtension');
// scripts\Extensions\ArrayExtension.js

// 给 Array 添加方法
// arr.find(...)
// arr.findIndex(...)
// arr.includes(e)
// arr.unique(equalFunction, isNewArray)
// Array.from
// Array.equal
// arr.isEqual(otherArray, isStrict)
// Array.sortByNumber
// arr.findSubArrayIndexs([])   用于查找数组内的部分元素的索引
// arr.translationWithStartIndex(startIndex) 将数组内的元素平移
// 如：[1, 2, 3, 4, 5].translationWithStartIndex(3) => [4,5,1,2,3]
// arr.kq_insert(index, e)   插入一个元素
// arr.kq_excludes(array)   // 除了array数组中的元素

module.exports = {};

if (!Array.prototype.find) {
  Array.prototype.find = function (predicate) {
    'use strict';
    if (this == null) {
      throw new TypeError('Array.prototype.find called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return value;
      }
    }
    return undefined;
  };
}

if (!Array.prototype.findIndex) {
  Array.prototype.findIndex = function (predicate) {
    if (this === null) {
      throw new TypeError('Array.prototype.findIndex called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return i;
      }
    }
    return -1;
  };
}

// https://tc39.github.io/ecma262/#sec-array.prototype.includes
if (!Array.prototype.includes) {
  Object.defineProperty(Array.prototype, 'includes', {
    enumerable: false,
    value: function value(searchElement, fromIndex) {

      // 1. Let O be ? ToObject(this value).
      if (this == null) {
        throw new TypeError('"this" is null or not defined');
      }

      var o = Object(this);

      // 2. Let len be ? ToLength(? Get(O, "length")).
      var len = o.length >>> 0;

      // 3. If len is 0, return false.
      if (len === 0) {
        return false;
      }

      // 4. Let n be ? ToInteger(fromIndex).
      //    (If fromIndex is undefined, this step produces the value 0.)
      var n = fromIndex | 0;

      // 5. If n ≥ 0, then
      //  a. Let k be n.
      // 6. Else n < 0,
      //  a. Let k be len + n.
      //  b. If k < 0, let k be 0.
      var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

      // 7. Repeat, while k < len
      while (k < len) {
        // a. Let elementK be the result of ? Get(O, ! ToString(k)).
        // b. If SameValueZero(searchElement, elementK) is true, return true.
        // c. Increase k by 1.
        // NOTE: === provides the correct "SameValueZero" comparison needed here.
        if (o[k] === searchElement) {
          return true;
        }
        k++;
      }

      // 8. Return false
      return false;
    }
  });
}

// unique
if (!Array.prototype.unique) {
  Object.defineProperty(Array.prototype, 'unique', {
    enumerable: false,
    value: function value(equalFunction) {
      var newArray = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

      if (newArray) {
        return this._unqiue_new(equalFunction);
      }

      return this._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue_new', {
    enumerable: false,
    value: function value(equalFunction) {
      var array = Array.from(this);

      return array._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue', {
    enumerable: false,
    value: function value(equalFunction) {
      var len = this.length;
      var i = -1;

      while (i++ < len) {
        var j = i + 1;

        for (; j < this.length; ++j) {
          var isEqual = false;
          if (equalFunction) {
            isEqual = equalFunction(this[i], this[j]);
          } else {
            isEqual = this[i] === this[j];
          }

          if (isEqual) {
            this.splice(j--, 1);
          }
        }
      }
      return this;
    }
  });
}

// Production steps of ECMA-262, Edition 6, 22.1.2.1
// Reference: https://people.mozilla.org/~jorendorff/es6-draft.html#sec-array.from
if (!Array.from) {
  Array.from = (function () {
    var toStr = Object.prototype.toString;
    var isCallable = function isCallable(fn) {
      return typeof fn === 'function' || toStr.call(fn) === '[object Function]';
    };
    var toInteger = function toInteger(value) {
      var number = Number(value);
      if (isNaN(number)) {
        return 0;
      }
      if (number === 0 || !isFinite(number)) {
        return number;
      }
      return (number > 0 ? 1 : -1) * Math.floor(Math.abs(number));
    };
    var maxSafeInteger = Math.pow(2, 53) - 1;
    var toLength = function toLength(value) {
      var len = toInteger(value);
      return Math.min(Math.max(len, 0), maxSafeInteger);
    };

    // The length property of the from method is 1.
    return function from(arrayLike /*, mapFn, thisArg */) {
      // 1. Let C be the this value.
      var C = this;

      // 2. Let items be ToObject(arrayLike).
      var items = Object(arrayLike);

      // 3. ReturnIfAbrupt(items).
      if (arrayLike == null) {
        throw new TypeError("Array.from requires an array-like object - not null or undefined");
      }

      // 4. If mapfn is undefined, then let mapping be false.
      var mapFn = arguments.length > 1 ? arguments[1] : void undefined;
      var T;
      if (typeof mapFn !== 'undefined') {
        // 5. else
        // 5. a If IsCallable(mapfn) is false, throw a TypeError exception.
        if (!isCallable(mapFn)) {
          throw new TypeError('Array.from: when provided, the second argument must be a function');
        }

        // 5. b. If thisArg was supplied, let T be thisArg; else let T be undefined.
        if (arguments.length > 2) {
          T = arguments[2];
        }
      }

      // 10. Let lenValue be Get(items, "length").
      // 11. Let len be ToLength(lenValue).
      var len = toLength(items.length);

      // 13. If IsConstructor(C) is true, then
      // 13. a. Let A be the result of calling the [[Construct]] internal method of C with an argument list containing the single item len.
      // 14. a. Else, Let A be ArrayCreate(len).
      var A = isCallable(C) ? Object(new C(len)) : new Array(len);

      // 16. Let k be 0.
      var k = 0;
      // 17. Repeat, while k < len… (also steps a - h)
      var kValue;
      while (k < len) {
        kValue = items[k];
        if (mapFn) {
          A[k] = typeof T === 'undefined' ? mapFn(kValue, k) : mapFn.call(T, kValue, k);
        } else {
          A[k] = kValue;
        }
        k += 1;
      }
      // 18. Let putStatus be Put(A, "length", len, true).
      A.length = len;
      // 20. Return A.
      return A;
    };
  })();
}

if (!Array.equal) {
  Array.equal = function (arr1, arr2) {
    var strict = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (arr1 === undefined || arr2 === undefined) {
      return false;
    }

    var length = arr1.length;
    if (length !== arr2.length) return false;
    for (var i = 0; i < length; i++) {
      if (strict) {
        if (arr1[i] !== arr2[i]) {
          return false;
        }
      } else {
        var value1 = arr1[i];
        var value2 = arr2[i];
        var result = true;
        if (Array.isArray(value1) && Array.isArray(value2)) {
          result = Array.equal(value1, value2, strict);
        } else {
          result = value1 == value2;
        }
      }
    }

    return true;
  };
}

if (!Array.prototype.isEqual) {
  Object.defineProperty(Array.prototype, 'isEqual', {
    enumerable: false,
    value: function value(otherArray) {
      var strict = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

      return Array.equal(this, otherArray, strict);
    }
  });
}

if (!Array.sortByNumber) {
  Array.sortByNumber = function (n1, n2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    return (n1 - n2) * (asc ? 1 : -1);
  };
}

if (!Array.prototype.findSubArrayIndexs) {
  Object.defineProperty(Array.prototype, 'findSubArrayIndexs', {
    enumerable: false,
    value: function value(subArray, f) {
      var _this = this;

      var indexs = [];

      var _loop = function () {
        var subValue = subArray[i];
        var findFunc = f || function (thisValue) {
          return subValue === thisValue;
        };
        var index = _this.findIndex(findFunc);
        if (index >= 0) {
          indexs.push(index);
        } else {
          indexs = [];
          return 'break';
        }
      };

      for (var i in subArray) {
        var _ret = _loop();

        if (_ret === 'break') break;
      }

      return indexs.length > 0 ? indexs : null;
    }
  });
}

if (!Array.prototype.translationWithStartIndex) {
  Object.defineProperty(Array.prototype, 'translationWithStartIndex', {
    enumerable: false,
    value: function value(startIndex) {
      if (startIndex == 0) {
        return this;
      }

      if (startIndex >= this.length) {
        return this;
      }

      var pre = this.slice(startIndex);
      var last = this.slice(0, startIndex);
      var result = pre.concat(last);

      return result;
    }
  });
}

if (!Array.prototype.kq_insert) {
  Object.defineProperty(Array.prototype, 'kq_insert', {
    enumerable: false,
    value: function value(index, e) {
      if (e == null) {
        return this;
      }

      if (index >= this.length) {
        this.push(e);
        return;
      }

      this.splice(index, 0, e);

      return this;
    }
  });
}

if (!Array.prototype.kq_excludes) {
  Object.defineProperty(Array.prototype, 'kq_excludes', {
    enumerable: false,
    value: function value(otherArray) {
      if (otherArray == null) {
        return this;
      }

      var result = [];
      this.forEach(function (element) {
        if (!otherArray.includes(element)) {
          result.push(element);
        }
      });

      return result;
    }
  });
}

/*
if(!Array.prototype.min){
  Array.prototype.min = function() {
    var min = this[0];
    var len = this.length;
    for (var i = 1; i < len; i++) {
      if (this[i] < min) {
        min = this[i];
      }
    }
    return min;
  }
}*/

cc._RFpop();
},{}],"AudioManager":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd5deKFuSZAC4Ky0zI4+z6O', 'AudioManager');
// scripts\Audio\AudioManager.js

var manager = require('manager');

var AudioManager = cc.Class({
    "extends": cc.Component,

    properties: {
        hall_bgm: {
            "default": null,
            url: cc.AudioClip
        },

        // 打枪
        daQiang: {
            "default": null,
            url: cc.AudioClip
        },

        fapai: {
            "default": null,
            url: cc.AudioClip
        },

        window: {
            "default": null,
            url: cc.AudioClip
        },

        click_weixin_login: {
            "default": null,
            url: cc.AudioClip
        },

        fangPai: {
            "default": null,
            url: cc.AudioClip
        }

    },

    statics: {
        instance: null
    },

    onLoad: function onLoad() {
        AudioManager.instance = this;
        this._registerAppActiveChange();

        this.soundOn = true;
        cc.game.addPersistRootNode(this.node);
        if (cc.game.isPersistRootNode(this.node)) {
            // cc.log('添加全局节点成功');
        }
        this.mValue = manager.getMusicValue();
        this.mEValue = manager.getMusicEffectValue();
        this.bgAudioId = -1;
    },

    stopHallMusic: function stopHallMusic() {
        cc.audioEngine.stop(this.bgAudioId);
    },

    playMusic: function playMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.hall_bgm, true);
        if (this.bgAudioId != -1) {
            //cc.log('play');
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
        //cc.audioEngine.playMusic( url, true )
    },

    playCompareCardsMusic: function playCompareCardsMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.hall_bgm, true);
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
    },

    playDaQiang: function playDaQiang() {
        for (var start = 0; start <= 1.6; start = start + 0.5) {
            this.scheduleOnce((function () {
                this._playSFX(this.daQiang);
            }).bind(this), start);
        }
    },

    // “打枪”
    playHumanDaQiang: function playHumanDaQiang() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = "resources/sounds/man" /* + (sex == 1 ? "man" : "woman")*/;
        path = path + "/daqiang1.mp3";

        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // “中枪”
    playHumanZQiang: function playHumanZQiang() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = "resources/sounds/man" /* + (sex == 1 ? "man" : "woman")*/;
        path = path + "/daqiang3.mp3";

        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playPokerClick: function playPokerClick() {
        var url = cc.url.raw('resources/sounds/public/click_wx_login.mp3');
        this._playSFX(url);
    },

    // 播放全垒打音效
    playHomeRun: function playHomeRun() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "special1.mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放发牌音效
    playFaPai: function playFaPai() {
        var path1 = this._soundsHumanPath(1) + "room_start_compare.mp3";
        var url1 = cc.url.raw(path1);
        this._playSFX(url1);
        //let pokerDeal = this._soundsHumanPath(1) + "poker_deal.mp3";
        //let urlPokerDeal = cc.url.raw(pokerDeal);
        //this._playSFX(urlPokerDeal);
        this._playSFX(this.fapai);
        for (var index = 0; index < 6; index++) {
            this.scheduleOnce((function () {
                this._playSFX(this.fapai);
            }).bind(this), index * 0.1);
        }
    },

    playCardType: function playCardType() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];
        var type = arguments.length <= 1 || arguments[1] === undefined ? -1 : arguments[1];

        // 只播放普通类型的语音
        if (type >= 10 || type < 0) {
            // 10 及以上是特殊牌
            var _path = this._soundsHumanPath(sex) + type + ".mp3";
            var _url = cc.url.raw(_path);
            this._playSFX(_url);
            return;
        }

        var path = this._soundsHumanPath(sex) + "common" + (type + 1) + ".mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放 开始比牌
    playStartCompare: function playStartCompare() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "start_compare.mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playWin: function playWin() {
        var url = cc.url.raw('resources/sounds/openface/win.mp3');
        this._playSFX(url);
    },

    playLose: function playLose() {
        var url = cc.url.raw('resources/sounds/openface/lose.mp3');
        this._playSFX(url);
    },

    coinIncome: function coinIncome() {
        var url = cc.url.raw('resources/sounds/openface/coin_income.mp3');
        this._playSFX(url);
    },

    _soundsHumanPath: function _soundsHumanPath(sex) {
        var path = "resources/sounds/man/" /* + (sex == 1 ? "man" : "woman") + "/"*/;
        return path;
    },

    setBgMusicVolumn: function setBgMusicVolumn(value) {
        this.mValue = value;
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, value);
        }
    },

    setEffectMusicVolum: function setEffectMusicVolum(value) {
        this.mEValue = value;
    },

    /*聊天*/
    playChatAudio: function playChatAudio(sex, str) {
        var index = this.chatTexts().indexOf(str);
        if (index === -1) {
            return;
        }
        var number = "CHAT" + (index + 1);
        var path = "resources/sounds/chat/" + number + ".mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    chatTexts: function chatTexts() {
        return ['还不出牌，我都快去吃锅边糊了', '嗨呀，我家里老人都比你打的快', '嗨呀，打牌打的我都困了', '哎，你快慢慢找，我先去西湖逛一下', '快一点呀，我等你想好我厕所都上一趟了', '你这在干嘛，这么慢', '嗨呀，最近在忙什么，很久没见了', '来来来，三缺一', '来来来，赶紧坐下来打一圈', '跟你们这些高手打我会紧张，让我一点', '蛮晚到天亮，输了可以让你们先欠着'];
    },

    pauseMusic: function pauseMusic() {
        this.soundOn = false;
        cc.audioEngine.pauseMusic();
    },

    resumeMusic: function resumeMusic() {
        this.soundOn = true;
        cc.audioEngine.resumeMusic();
    },

    _playSFX: function _playSFX(clip) {
        if (this.soundOn) {
            var audioId = cc.audioEngine.playEffect(clip, false);
            cc.audioEngine.setVolume(audioId, this.mEValue);
            return audioId;
        }

        return null;
    },

    // MARK: 前后台操作
    _registerAppActiveChange: function _registerAppActiveChange() {
        cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
        cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
    },

    /**
     * 进入后台
     */
    _appEnterBackground: function _appEnterBackground() {
        var now = cc.sys.now();
        if (now - this._lastAppEnterBackgroundTime < 100) {
            return;
        }
        this._lastAppEnterBackgroundTime = now;

        this.pauseMusic();
    },

    /**
     * 进入前台
     */
    _appBecomActive: function _appBecomActive() {
        var now = cc.sys.now();
        if (now - this._lastAppBecomActiveTime < 100) {
            return;
        }
        this._lastAppBecomActiveTime = now;

        this.resumeMusic();
    },

    /*确定按钮音效*/
    playBtnClickSFX: function playBtnClickSFX() {
        this._playSFX(this.click_weixin_login);
    },
    /*公共按钮，按键或者关闭按钮之类的音效*/
    palyBtnPublicSFX: function palyBtnPublicSFX() {
        this._playSFX(this.click_weixin_login);
    },

    /*取消按钮音效*/
    palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyWindowSFX: function palyWindowSFX() {
        this._playSFX(this.window);
    },
    palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyFangPaiSFX: function palyFangPaiSFX() {
        this._playSFX(this.fangPai);
    }

});

module.exports = AudioManager;

cc._RFpop();
},{"manager":"manager"}],"CardPrefab":[function(require,module,exports){
"use strict";
cc._RFpush(module, '94cdbrbPc9KRqx+1sHumWI3', 'CardPrefab');
// scripts\CardPrefab.js

var KQCard = require('KQCard');

cc.Class({
  'extends': cc.Component,

  properties: {
    graySprite: cc.Sprite,

    _cardName: null,
    _kqCardMode: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.graySprite.node.active = false;
  },

  // 通过牌名设置牌
  setCard: function setCard(cardName) {
    this._setCardName(cardName);

    this._loadCardFrame(cardName, (function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }).bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._kqCardMode;
  },

  _setCardName: function _setCardName(cardName) {
    this._cardName = cardName;
    this._kqCardMode = new KQCard(cardName);
  },

  // 设置选择状态
  setSelected: function setSelected() {
    var selected = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.graySprite.node.active = selected;
  },

  isSelected: function isSelected() {
    return this.graySprite.node.active;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"CardTypeCombine":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45c41vwAhFNYYSXDvaKpEP0', 'CardTypeCombine');
// scripts\CardTypeCombine.js

var _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var AudioManager = require('AudioManager');
var play = require('play');
var KQCardScoretsHelper = require('KQCardScoretsHelper');
// 牌类型 component
//
cc.Class({
    'extends': cc.Component,
    statics: {
        instances: null
    },
    properties: {
        cardsLayout: cc.Layout,
        // btnDuiZi: cc.Button,
        // btnLiangDui: cc.Button,
        // btnSanTiao: cc.Button,
        // btnShunZi: cc.Button,
        // btnTongHua: cc.Button,
        // btnHuLu: cc.Button,
        // btnTieZhi: cc.Button,
        // btnTongHuaShun: cc.Button,
        // btnWuTong: cc.Button,
        // typeButtonsNode: cc.Node,
        btnDeleteTouDao: cc.Button, // 头道
        btnDeleteZhongDao: cc.Button, // 中道
        btnDeleteWeiDao: cc.Button, // 尾道
        btnCancelAll: cc.Button, // 全部取消
        btnDone: cc.Button, // 确定出牌
        timeNode: cc.Node,
        labelTime: cc.Label,
        layoutTouDao: cc.Layout,
        layoutZhongDao: cc.Layout,
        layoutWeiDao: cc.Layout,
        cardAllNode: cc.Node,
        cardPrefab: cc.Prefab,
        cardTypePrefab: cc.Prefab,

        touDaoNode: cc.Node,
        zhongDaoNode: cc.Node,
        weiDaoNode: cc.Node,

        autoCardScrollView: cc.ScrollView,
        autoCard: cc.Prefab,
        autoCardLayout: cc.Layout,
        autoCardAnimation: cc.Node,

        LayoutWithEvent: [],

        BtnClickGongXiNiComfirm: false, //用于检查用户是否点击了恭喜你页面的确定按钮
        cardsLayoutSortColor: false,
        /*#####*/

        _cardOffsetY: null,

        _kqCardModes: [],
        _allCardModes: [],
        _findCardTypeObject: null, // 用来记录找到的牌型对象
        _findCardIndex: null, // 用来记录找到的牌型对象

        _finishSelectCardsCallback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.BtnClickGongXiNiComfirm = false;
        this.cardsLayoutSortColor = false;
        this._cardOffsetY = 0;
        this._registerTouchEvents();
        this._registerDaosLayoutClickEvent();
        this.reset();
        this._findCardIndex = {};
        this.cardTime = 0.3;

        this.cardSpriteAtlas = this.node.parent.getComponent('play').cardSpriteAtlas;
        this.daoSpriteAtlas = this.node.parent.getComponent('play').daoSpriteAtlas;
    },

    /*#####点击空白地方将牌收回去*/
    onClickCardTypeCombineNode: function onClickCardTypeCombineNode() {
        this._resetCardsPositionY();
    },

    _hideDeleteButtons: function _hideDeleteButtons() {
        //this.btnDeleteTouDao.node.active = false;
        //this.btnDeleteZhongDao.node.active = false;
        //this.btnDeleteWeiDao.node.active = false;
    },

    // 重置，回到最初始有状态
    reset: function reset() {
        this._hideDeleteButtons();
        this.clearCards();
        this.timeStop();
        //this._typeButtons().forEach(function (button) {
        //    button.interactable = false;
        //});
        this._allCardModes = [];
    },

    cardsLayoutSort: function cardsLayoutSort(e) {
        var nodeAyy = e.target.children;
        if (nodeAyy[0].active == true) {
            //按大小
            this.cardsLayoutSortColor = true;
            nodeAyy[0].active = false;
            nodeAyy[1].active = true;
            this._resetCardsPositionX();
            return;
        } else if (nodeAyy[1].active == true) {
            //按花色
            this.cardsLayoutSortColor = false;
            nodeAyy[0].active = true;
            nodeAyy[1].active = false;
            this._resetCardsPositionX();
        }
        //this.cardsLayoutSortColor = nodeAyy[1].active == false;
        //this.cardsLayoutSortColor == true
    },

    addCards: function addCards(cardNames) {
        cc.assert(cardNames);
        this._resetCardsPositionY();
        //cardNames.sort(function(a1,a2){
        //    return a1.split('_')[0] - a2.split('_')[0];
        //})
        cardNames.forEach((function (card, index) {
            this.addCard(card, false, index);
        }).bind(this));
        //this.cardsLayoutSort();
        this._resetCardsPositionX();
        this._reloadKQCardModesInner();
        this._resetTypeButtonEnablesWithModels(this._kqCardModes);
    },

    addCard: function addCard(cardName) {
        var autoChangePositionX = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var index = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];

        cc.assert(cardName.length > 0);

        var cardPrefab = cc.instantiate(this.cardPrefab);
        cardPrefab.name = cardName;
        // if(cc.maPai){
        //     var cardMaPai = '3_' + cc.maPai;
        //     if(cardName == cardMaPai){
        //         cardPrefab.color = new cc.Color(226, 145, 145);
        //     }
        // }
        cardPrefab.getComponent('CardPrefab').setCard(cardName, index);
        this.cardsLayout.node.addChild(cardPrefab);
        cardPrefab.setPositionY(this._cardOffsetY);

        if (autoChangePositionX) {
            this._resetCardsPositionX();
        }
        //let newCard = new KQCard(cardName,null,index);
        //let originCard = this._allCardModes.find(function(card) {
        //    return card.isEqual(newCard);
        //});
        //if (originCard == null && !autoChangePositionX) {
        //    this._allCardModes.push(newCard);
        //}
    },

    addCardModes: function addCardModes(cardNames) {
        cc.assert(cardNames.length > 0);
        this._allCardModes = [];
        cardNames.forEach((function (cardName, index) {
            var newCard = new KQCard(cardName, null, index);
            this._allCardModes.push(newCard);
        }).bind(this));
    },

    reloadCards: function reloadCards(cardNames) {
        //cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //三度同花
        // cardNames=['2_13', '2_5', '2_7', '3_1', '3_2', '3_4', '3_3', '3_13', '1_12', '1_6', '1_1', '1_4', '1_5'];
        //三同花顺
        //  cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '4_1', '4_2', '4_3'];
        //一条龙
        // cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '1_11', '1_12', '1_13'];
        //三顺子
        //cardNames=['4_1', '3_2', '4_3', '1_7', '4_5', '4_6', '3_9', '4_8', '3_1', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_9', '3_9', '4_8', '3_10', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_5', '3_6', '4_8', '3_6', '1_13', '4_12', '4_11', '2_7'];
        //cardNames=['3_4', '3_4', '4_6', '2_20', '1_20', '1_20', '3_6', '4_8', '3_6', '1_8', '4_12', '4_11', '2_20'];
        //三丰天下
        //cardNames=['1_1', '2_1', '3_1', '1_2', '2_2', '3_2', '4_1', '4_2', '3_3', '2_3', '1_3', '4_3', '1_13'];
        //4丰天下
        // cardNames=['1_1', '2_1', '3_1', '1_4', '2_4', '3_2', '4_2', '1_2', '3_4', '2_3', '1_3', '4_3', '1_2'];
        //六岁半
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //cardNames=['1_9', '2_11', '3_8', '1_12', '2_2', '3_2', '1_13', '2_5', '3_5','1_4', '2_4', '3_4', '3_10'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //   cardNames=['4_2', '2_3', '3_4', '3_5', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //cardNames=['4_1', '2_1', '1_4', '3_4', '1_6', '2_6', '1_8', '3_8', '2_8','2_12', '1_12', '2_13', '3_13'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_8', '2_9', '2_10', '2_11', '2_13','3_13', '3_12', '2_12', '1_12'];
        // cardNames=['4_9', '2_9', '3_4', '3_6', '1_8', '2_1', '2_5', '2_4', '2_3','3_13', '3_12', '2_2', '1_12'];
        //cardNames=['3_2', '4_2', '2_4', '3_5', '1_5', '3_7', '2_7', '3_10', '2_1','2_13', '2_10', '2_12', '2_11'];
        //cardNames=['4_2', '4_3', '4_4', '4_5', '4_5', '4_6', '4_12', '4_13', '2_12','3_12', '2_8', '3_8', '2_11'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '3_5', '2_5', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '2_20', '1_20', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_3', '3_4', '4_6', '4_5', '2_7', '1_20', '1_3', '4_4', '3_6','4_7', '4_8', '2_12', '1_12'];
        cc.log(cardNames);
        this.clearCards();
        this._kqCardModes = [];
        this.addCards(cardNames);
    },

    clearCards: function clearCards() {
        this.cardsLayout.node.removeAllChildren();
        this.layoutTouDao.node.removeAllChildren();
        this.layoutZhongDao.node.removeAllChildren();
        this.layoutWeiDao.node.removeAllChildren();
    },

    removeCard: function removeCard(cardName) {
        if (!cardName.length) {
            return;
        }

        this.cardsLayout.node.getChildByName(cardName).removeFromParent();
    },

    setFinishSelectCardsCallback: function setFinishSelectCardsCallback(callback) {
        this._finishSelectCardsCallback = callback;
        this.node.active = false;
    },

    _reloadKQCardModesInner: function _reloadKQCardModesInner() {
        //this._kqCardModes = this.cardsLayout.node.children.map(function (cardPrefabNode) {
        //    let cardPrefab = cardPrefabNode.getComponent('CardPrefab');
        //    return cardPrefab.cardMode();
        //}).sort(KQCard.sort);
        //this._findCardTypeObject = null;
    },

    _typeButtons: function _typeButtons() {
        //return [
        //    this.btnDuiZi,
        //    this.btnLiangDui,
        //    this.btnSanTiao,
        //    this.btnShunZi,
        //    this.btnTongHua,
        //    this.btnHuLu,
        //    this.btnTieZhi,
        //    this.btnTongHuaShun,
        //    /*#####*/
        //    //this.btnWuTong,
        //    /*#####*/
        //];
    },

    _resetTypeButtonEnablesWithModels: function _resetTypeButtonEnablesWithModels(cardModes) {
        /*cardModes.length == 13*/
        //cardModes = cardModes || this._kqCardModes;
        //
        ///*#####初始化牌*/
        //var ButtonsLayoutChilds = this.typeButtonsNode.children;
        //for(var i=0;i<ButtonsLayoutChilds.length;i++){
        //    ButtonsLayoutChilds[i].interactable = false;
        //}
        //
        //this.btnDuiZi.interactable = KQCard.containDuiZi(cardModes);
        //this.btnLiangDui.interactable = KQCard.containLiaDui(cardModes);
        //this.btnSanTiao.interactable = KQCard.containSanTiao(cardModes);
        //this.btnShunZi.interactable = KQCard.containShunZi(cardModes);
        //this.btnTongHua.interactable = KQCard.containTongHua(cardModes);
        //this.btnHuLu.interactable = KQCard.containHuLu(cardModes);
        //this.btnTieZhi.interactable = KQCard.containTieZhi(cardModes);
        //this.btnTongHuaShun.interactable = KQCard.containTongHuaShun(cardModes);
        ////this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        ////KQCard.isTeShuPai(cardModes)
        ////let typeName = KQCard.cardsTyp-eName(cardModes);
        ////KQCard.isLiuDuiBan(cardModes);
        ////alert(this.btnShunZi.interactable)
        ///*#####如果有多一色，就是设置无同按钮的可交互性*/
        ////if(cc.duoYiSe == 0) {
        ////    this.wuTongNode = this.typeButtonsNode.getChildByName("btnWuTong");
        ////    this.btnWuTong = this.wuTongNode.getComponent(cc.Button);
        ////    this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        ////}
        ///*#####*/
        //
        //this._autoActiveTypeButtons();
        //
        ///*#####设置按钮可交互和不可交互时的透明度*/
        //for(var i=0;i<ButtonsLayoutChilds.length;i++){
        //    if(ButtonsLayoutChilds[i].getComponent(cc.Button).interactable){
        //        ButtonsLayoutChilds[i].opacity = 255;
        //    }else{
        //        ButtonsLayoutChilds[i].opacity = 125;
        //    }
        //}
    },

    // 将找到了牌类型的牌突出出来
    _stickOutFindCardType: function _stickOutFindCardType(title, findMethods) {

        // 先根据牌类型找出所有的索引集合
        //var findedIndexsArray = null;
        //this._findCardTypeObject = this._findCardTypeObject || {};
        //if (this._findCardTypeObject.title != title) {
        //    findedIndexsArray = (findMethods() || []).reverse();
        //
        //    for(var i =0;i<findedIndexsArray.length-1;i++){//删除同类型牌
        //        var index = findedIndexsArray[i];
        //        /*if(title == 'liangDui'){
        //         let jStringspoint = index.map(function(indexs){
        //         return this._kqCardModes[indexs].point;
        //         }.bind(this));
        //         var isBreak = false;
        //         var repNum = jStringspoint.reduce(function(p,n){
        //         if(!p[n]){
        //         p[n] = 1;
        //         }else{
        //         p[n] += 1
        //         }
        //         return p
        //         },{});
        //         for(var y in repNum){
        //         if(repNum[y] >= 3){
        //         isBreak = true;
        //         }
        //         }
        //         if(isBreak){
        //         cc.log(repNum)
        //         cc.log(findedIndexsArray)
        //         cc.log(i)
        //         cc.log('--------291')
        //         findedIndexsArray.splice(i,1);
        //         continue;
        //         }
        //         }*/
        //        var iString = '';
        //        for(var j =i+1;j<findedIndexsArray.length;j++){
        //            var s = findedIndexsArray[j];
        //            var jString = '';
        //
        //            let iStrings = s.map(function(index){
        //                let cardModel = this._kqCardModes[index];
        //                return cardModel.cardName();
        //            }.bind(this));
        //
        //            let jStrings = index.map(function(indexs){
        //                let cardModel = this._kqCardModes[indexs];
        //                return cardModel.cardName();
        //            }.bind(this));
        //
        //
        //            for(var r = 0;r < index.length;r++){
        //                jString = jString + iStrings[r];
        //                iString = iString + jStrings[r];
        //            }
        //
        //            if(jString == iString){
        //                findedIndexsArray.splice(i,1);
        //                break;
        //            }
        //        }
        //    }
        //
        //    this._findCardTypeObject = {
        //        title: title,
        //        indexsArray: findedIndexsArray,
        //        //index: title=="duiZi"?findedIndexsArray.length-1:0
        //        index: 0
        //    };
        //}
        //
        //findedIndexsArray = this._findCardTypeObject.indexsArray;
        //if (!findedIndexsArray || findedIndexsArray.length == 0) {
        //    return;
        //}
        //// 将已有的突出的牌的位置重置回初始位置
        //this._resetCardsPositionY();
        //
        //// 计算出要突出的牌数组
        //var index = this._findCardTypeObject.index;
        //let indexs = findedIndexsArray[index];
        //
        //let selectedCardNames = indexs.map(function(index){
        //    let cardModel = this._kqCardModes[index];
        //    return cardModel.cardName();
        //}.bind(this));
        //
        //let cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {
        //    let cardPrefab = cardNode.getComponent('CardPrefab');
        //    if(selectedCardNames.includes(cardPrefab.cardName())) {
        //        var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());
        //        selectedCardNames.splice(nameIndex,1);
        //        return true;
        //    }
        //    return false;
        //});

        //// 突出计算出来的牌数组
        //this._changeCardPrefabsY(cardNodes);
        //// 保存好，用于再次点击了突出下一组牌
        //index = (index + 1) % findedIndexsArray.length;
        //this._findCardTypeObject.index = index;
    },

    clickDuiZi: function clickDuiZi() {
        this._stickOutFindCardType("duiZi", (function () {
            return KQCard.findDuiZi(this._kqCardModes);
        }).bind(this));
    },

    clickLiangDui: function clickLiangDui() {
        this._stickOutFindCardType("liangDui", (function () {
            return KQCard.findLiaDui(this._kqCardModes);
        }).bind(this));
    },

    clickSanTiao: function clickSanTiao() {
        this._stickOutFindCardType("sanTiao", (function () {
            return KQCard.findSanTiao(this._kqCardModes);
        }).bind(this));
    },

    clickShunZi: function clickShunZi() {
        this._stickOutFindCardType("shunZi", (function () {
            return KQCard.findShunZi(this._kqCardModes);
        }).bind(this));
    },

    clickTongHua: function clickTongHua() {
        this._stickOutFindCardType("tongHua", (function () {
            return KQCard.findTongHua(this._kqCardModes);
        }).bind(this));
    },

    clickHuLu: function clickHuLu() {
        this._stickOutFindCardType("huLu", (function () {
            return KQCard.findHuLu(this._kqCardModes);
        }).bind(this));
    },

    clickTieZhi: function clickTieZhi() {
        this._stickOutFindCardType("tieZhi", (function () {
            return KQCard.findTieZhi(this._kqCardModes);
        }).bind(this));
    },

    /*#####*/
    clickWuTong: function clickWuTong() {
        this._stickOutFindCardType("wuTong", (function () {
            return KQCard.findWuTong(this._kqCardModes);
        }).bind(this));
    },
    /*#####*/

    clickTongHuaShun: function clickTongHuaShun() {
        this._stickOutFindCardType("tongHuaShun", (function () {
            return KQCard.findTongHuaShun(this._kqCardModes);
        }).bind(this));
    },

    clickCancelAll: function clickCancelAll() {
        this.clickDeleteTouDao();
        this.clickDeleteZhongDao();
        this.clickDeleteWeiDao();
    },

    /*点击完成按钮*/
    clickDone: function clickDone() {
        cc.sys.localStorage.removeItem("timestamp");
        this.cardAlls = this.cardAllNode.children.sort(function (a, b) {
            return b.y - a.y;
        }).map(function (i) {
            return i.children[0];
        });

        var touCardModels = this._taoDaoCardModes();
        var zhongCardModes = this._zhongDaoCardModes();
        var weiCardModes = this._weiDaoCardModes();
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    /*点击恭喜你页面的确定按钮*/
    onBtnGongXiNiComfirmClick: function onBtnGongXiNiComfirmClick() {
        //记录玩家点击了确定按钮：
        this.BtnClickGongXiNiComfirm = true;

        var cards = [];

        cc.teShuPaiCards.forEach(function (i) {
            cards = cards.concat(i);
        });

        var teShuPaiCardsServerInfo = this._convertCardsToServerModel2(cards);
        var result = [teShuPaiCardsServerInfo];
        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    _didSelectedCards: function _didSelectedCards(touCards, zhongCards, weiCards) {
        touCards = touCards || [];
        zhongCards = zhongCards || [];
        weiCards = weiCards || [];
        var touServerInfo = this._convertCardsToServerModel(touCards);
        var zhongServerInfo = this._convertCardsToServerModel(zhongCards);
        var weiServerInfo = this._convertCardsToServerModel(weiCards);

        //console.log(touServerInfo);
        //console.log(zhongServerInfo);
        //console.log(weiServerInfo);
        //console.log("---------------------------------512");
        if (!(touServerInfo.value < zhongServerInfo.value && zhongServerInfo.value <= weiServerInfo.value)) {
            this.autoCardAnimation.y = -50;
            this.autoCardAnimation.opacity = 255;
            this.autoCardAnimation.runAction(cc.moveTo(1, cc.p(0, 0)));
            this.scheduleOnce((function () {
                var action = cc.spawn(cc.moveTo(this.cardTime, cc.p(0, 10)), cc.fadeOut(this.cardTime));
                this.autoCardAnimation.runAction(action);
            }).bind(this), 1.5);
            return;
        }
        var result = [touServerInfo, zhongServerInfo, weiServerInfo];
        //return;
        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    clickDeleteTouDao: function clickDeleteTouDao() {
        this._deleteDaoCardsOfLayout(this.layoutTouDao.node);
    },

    clickDeleteZhongDao: function clickDeleteZhongDao() {
        this._deleteDaoCardsOfLayout(this.layoutZhongDao.node);
    },

    clickDeleteWeiDao: function clickDeleteWeiDao() {
        this._deleteDaoCardsOfLayout(this.layoutWeiDao.node);
    },

    // 计时器事件
    timeStart: function timeStart(duration) {
        cc.assert(duration > 0);
        this.timeStop();
        this.timeNode.active = true;
        var timestamp = cc.sys.localStorage.getItem("timestamp"); // 获取本地存储的时间戳
        if (timestamp) {
            // 如果有则证明玩家是重新进来了的
            var now = Date.parse(new Date());
            var time = duration * 1000;
            if (now - timestamp > time) {
                // 超时
                if (now - timestamp < 2 * time) {
                    duration = 5; // 玩家可能出于其他原因退出游戏导致超时，为其提供5秒时间整理牌型（这已经是很仁慈的了）。
                } else {
                        cc.sys.localStorage.removeItem("timestamp");
                    }
            } else {
                duration = Math.floor(duration - (now - timestamp) / 1000);
            }
        } else {
            // 如果没有时间戳，则保存，为玩家退出游戏保留证据；
            var timestamp = Date.parse(new Date());
            cc.sys.localStorage.setItem('timestamp', timestamp);
        }
        this._timeRemainDuration = duration;
        this.labelTime.string = String(duration);
        this.timeNode.getComponent("time").setTime(duration * 0.5);
        this.schedule(this._timeMethod, 1, duration);
    },

    timeStop: function timeStop() {
        this.unschedule(this._timeMethod);
        this.timeNode.active = false;
    },

    _timeMethod: function _timeMethod() {
        this._timeRemainDuration = this._timeRemainDuration - 1;

        var remain = Math.max(this._timeRemainDuration, 0);
        this.labelTime.string = remain < 10 && remain > 0 ? '0' + remain : remain;

        if (this._timeRemainDuration <= 0) {
            this.timeStop();
            if (cc.chaoShiChuPai == true) this._timeOutAutoSelectCards();
            cc.sys.localStorage.removeItem("timestamp");
            return;
        }
    },

    // 超时后，自动选牌
    _timeOutAutoSelectCards: function _timeOutAutoSelectCards() {
        /**
         * 隐藏恭喜你
         */
        play.gongXiNiShow(false);
        if (typeof cc.teShuPaiCards != "undefined" && cc.teShuPaiCards != null) {
            this.onBtnGongXiNiComfirmClick();
            return;
        }

        //let [touCardModels, zhongCardModes, weiCardModes] = this._cacleAutoSelectedCards();

        var _findCardIndex$arr$0 = _slicedToArray(this._findCardIndex.arr[0], 3);

        var touCardModels = _findCardIndex$arr$0[0];
        var zhongCardModes = _findCardIndex$arr$0[1];
        var weiCardModes = _findCardIndex$arr$0[2];

        if (touCardModels == null || zhongCardModes == null || weiCardModes == null) {
            touCardModels = this._allCardModes.slice(-3);
            zhongCardModes = this._allCardModes.slice(5, 10);
            weiCardModes = this._allCardModes.slice(0, 5);
        }

        // cc.log(touCardModels)
        // cc.log(zhongCardModes)
        // cc.log(weiCardModes)
        // cc.log(this._allCardModes)
        // cc.log("自动选牌 touCardModels zhongCardModes weiCardModes：");
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    _cacleAutoSelectedCards: function _cacleAutoSelectedCards() {
        var cards = this._allCardModes.filter(function (i) {
            return i;
        });
        var resultCards = [];
        for (var i = 1; i < 3; i++) {
            var cardss = KQCard.autoSelectCards(cards, 5);
            cards = cards.kq_excludes(cardss);
            resultCards.push(cardss);
        }
        resultCards.push(cards);
        //let touScore = KQCard.scoreOfCards(resultCards[2]);
        //let zhongScore = KQCard.scoreOfCards(resultCards[1]);
        //let weiScore = KQCard.scoreOfCards(resultCards[0]);
        // cc.log(resultCards)
        // cc.log(this._allCardModes)
        // cc.log("牌分数自动选牌：", touScore, zhongScore, weiScore);
        //let weiCardModes = KQCard.autoSelectCards(cards, 5);
        //cards = cards.kq_excludes(weiCardModes);
        //
        //let zhongCardModes = KQCard.autoSelectCards(cards, 5);
        //
        //let touCardModes = cards.kq_excludes(zhongCardModes);
        //if (touCardModes.length == 3 && zhongCardModes.length == 5 && weiCardModes.length == 5) {
        //    return [touCardModes, zhongCardModes, weiCardModes];
        //}
        if (resultCards[2].length == 3 && resultCards[1].length == 5 && resultCards[0].length == 5) {
            return [resultCards[2], resultCards[1], resultCards[0]];
        }

        return [];
    },

    _convertCardsToServerModel: function _convertCardsToServerModel(cards) {
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = KQCard.scoreOfCards(cards);
        cards = KQCard._typeCardsSortByNumberOfPoints1(cards);
        result.cards = KQCard.convertToServerCards(cards);

        return result;
    },

    /*#####*/
    _convertCardsToServerModel2: function _convertCardsToServerModel2(cards) {
        var convertToServerCards = [];

        cc.teShuPaiCards.forEach(function (cardMode) {
            var arr = [];
            cardMode = KQCard._typeCardsSortByNumberOfPoints(KQCard.cardsFromArray(cardMode));
            cardMode.forEach(function (cca) {
                var point = cca.point == 14 ? 1 : cca.point;
                arr.push({ number: point, suit: cca.color });
            });
            convertToServerCards.push(arr);
        });
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = 0;
        result.cards = convertToServerCards;

        if (result.type >= KQCard.TYPE.SanTaoHua && cc.moshi != 1) {
            // 特殊牌
            result.isContainExtra = true;
        }

        return result;
    },
    /*#####*/
    // 特殊牌里是否还含有特殊牌
    // 包含的情况有：
    // 三桃花 可能含有同花顺
    // 三顺子 可能含有同花顺
    // 六对半 可能含有铁支
    _isContainExtraCardsType: function _isContainExtraCardsType(type, cards) {
        if (type == KQCard.TYPE.SanTaoHua) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.SanShunZi) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.LiuDuiBan) {
            return KQCard.containTieZhi(cards);
        }
        return false;
    },

    // 触摸事件
    _registerTouchEvents: function _registerTouchEvents() {
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_START, this._touchCardLayout.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_MOVE, this._touchCardLayout.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_END, this._touchCardLayoutEnd.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_CANCEL, this._touchCardLayoutEnd.bind(this));
    },
    cacleAutoSelectedCardsIndex: function cacleAutoSelectedCardsIndex(cards) {
        //cc.log('------622')
        var testFind = KQCard.testFind(cards) || [];
        //cc.log('------6221')
        var result = [];
        for (var i = 0; i < testFind.length; i++) {
            var s = testFind[i];
            if (s.length >= 1) {
                for (var j = 0; j < s.length; j++) {
                    //result.push(s[0]);//只取一个
                    result.push(s[j]); //
                }
            }
        }
        return result;
    },

    cacleAutoSelectedCardsArray: function cacleAutoSelectedCardsArray(cards) {
        var indexs = this.cacleAutoSelectedCardsIndex(cards);
        if (indexs.length < 1) {
            return false;
        }
        var selectedCard = [];
        for (var i = 0; i < indexs.length; i++) {
            var s = indexs[i];
            var a = s.map(function (index) {
                return cards[index];
            });
            selectedCard.push(a);
        }
        return selectedCard;
    },

    cacleAutoSelectedCards2: function cacleAutoSelectedCards2() {
        var cards = this._allCardModes.slice();
        var cardsArray = this.cacleAutoSelectedCardsArray(cards);
        var resultArray = [];
        for (var i = 0; i < cardsArray.length; i++) {
            var _s = cardsArray[i] || [];
            var qwer = [];
            for (var j = 1; j < cardsArray.length; j++) {
                var d = cardsArray[j] || [];
                var sC = _s.kq_excludes(d);
                if (sC.length == _s.length && _s.length > 0) {
                    //判断牌相同 即没有重复的
                    qwer = [_s, d];
                }
            }
            if (qwer.length > 1) {
                resultArray.push(qwer);
            }
        }

        //补全计划1
        for (var i = 0; i < resultArray.length; i++) {

            var _s2 = resultArray[i];

            var cardss = this._allCardModes.slice();

            cardss = cardss.kq_excludes(_s2[0]);

            cardss = cardss.kq_excludes(_s2[1]);

            if (cardss.length >= 5) {
                _s2[2] = KQCard.autoSelectCards(cardss, 5);
            } else {
                _s2[2] = KQCard.autoSelectCards(cardss, 3);
            }

            resultArray[i].sort(function (a1, a2) {
                return KQCard.scoreOfCards(a1) - KQCard.scoreOfCards(a2);
            });
        }
        //补全计划2
        for (var i = 0; i < resultArray.length; i++) {
            var s = resultArray[i];
            var cardsqe = this._allCardModes.filter(function (ii) {
                //重新赋值cards
                return ii;
            });
            //去重
            var q = s[0].concat(s[1]).concat(s[2]);
            var cardsq = cardsqe.kq_excludes(q);
            s[0] = s[0].kq_excludes(s[1]);
            s[0] = s[0].kq_excludes(s[2]);
            s[1] = s[1].kq_excludes(s[0]);
            s[1] = s[1].kq_excludes(s[2]);
            s[2] = s[2].kq_excludes(s[1]);
            s[2] = s[2].kq_excludes(s[0]);
            //多余删除
            if (s[2].length > 5) {
                //尾道
                var a = s[2].splice(5, s[2].length - 5);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            if (s[1].length > 5) {
                //中道
                var a = s[1].splice(5, s[1].length - 5);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            if (s[0].length > 3) {
                //头道
                var a = s[0].splice(3, s[0].length - 3);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            //cardsq = KQCard._convertOneToA(cardsq);
            cardsq.sort(KQCard.sortByPoint);
            cardsq.forEach(function (card11) {
                if (card11.point == 14) {
                    card11.point = 1;
                }
            });
            //有缺添加
            while (s[2].length < 5) {
                //尾道
                s[2].push(cardsq.pop() || []);
            }
            while (s[1].length < 5) {
                //中道
                s[1].push(cardsq.pop() || []);
            }
            while (s[0].length < 3) {
                //头道
                s[0].push(cardsq.pop() || []);
            }
            /*if(cardsq.length > 0){
                while(s[2].length < 5) {//尾道
                    s[2].push(cardsq.pop());
                }
            }
            if(cardsq.length > 0){
                while(s[1].length < 5) {//中道
                    s[1].push(cardsq.pop());
                }
            }
            if(cardsq.length > 0){
                while(s[0].length < 3) {//头道
                    s[0].push(cardsq.pop());
                }
            }*/
            if (s[2][4] == null || s[1][4] == null || s[0][2] == null || s[2][4] == '' || s[1][4] == '' || s[0][2] == '') {
                resultArray.splice(i, 1);
            }
        }

        var resultCards = [];
        var cardss1 = this._allCardModes.filter(function (i) {
            return i;
        });
        var indexasdf = 2;
        for (var i = 0; i < 3; i++) {
            var _length = indexasdf == 0 ? 3 : 5;
            var cardss = KQCard.autoSelectCards(cardss1, _length) || [];
            cardss1 = cardss1.kq_excludes(cardss);
            resultCards[indexasdf] = cardss;
            indexasdf--;
        }

        for (var i = 0; i < resultCards.length; i++) {
            var _length2 = i == 0 ? 3 : 5;
            if (resultCards[i].length < _length2) {
                cardss1 = cardss1.kq_excludes(resultCards[i]);
                while (resultCards[i].length < _length2) {
                    resultCards[i].push(cardss1.pop());
                }
            }
        }

        resultArray.push(resultCards);

        var cardsTypeNames = [];
        var resultArrays = [];

        for (var i = 0; i < resultArray.length; i++) {
            //删除类型相同的组合
            var _s3 = resultArray[i];
            var typeName0 = KQCard.cardsTypeName(_s3[0]);
            typeName0 += KQCard.cardsTypeName(_s3[1]);
            typeName0 += KQCard.cardsTypeName(_s3[2]);
            if (cardsTypeNames.indexOf(typeName0) == -1) {
                var touScore = KQCard.scoreOfCards(_s3[0]);
                var zhongScore = KQCard.scoreOfCards(_s3[1]);
                var weiScore = KQCard.scoreOfCards(_s3[2]);
                if (zhongScore > touScore && zhongScore < weiScore) {
                    cardsTypeNames.push(typeName0);
                    resultArrays.push(_s3);
                }
            }
        }

        resultArrays.sort(function (a1, a2) {
            var b0 = parseInt(KQCard.cardsType(a2[0])) + "";
            var b1 = parseInt(KQCard.cardsType(a2[1])) + "";
            var b2 = parseInt(KQCard.cardsType(a2[2])) + "";

            var s0 = parseInt(KQCard.cardsType(a1[0])) + "";
            var s1 = parseInt(KQCard.cardsType(a1[1])) + "";
            var s2 = parseInt(KQCard.cardsType(a1[2])) + "";

            var s = parseInt(s2 + s1 + s0);
            var b = parseInt(b2 + b1 + b0);

            return b - s;
        });

        if (resultArrays.length > 7) {
            resultArrays = resultArrays.slice(0, 7);
        }
        //for(var i = 0;i < resultArrays.length;i++){//如果有相公牌则删除
        //    let s = resultArrays[i];
        //    let touScore = KQCard.scoreOfCards(s[0]);
        //    let zhongScore = KQCard.scoreOfCards(s[1]);
        //    let weiScore = KQCard.scoreOfCards(s[2]);
        //    cc.log(touScore,zhongScore,weiScore);
        //    if(weiScore < touScore || weiScore < zhongScore){
        //        resultArrays.splice(i,1);
        //    }
        //}
        //cc.log(resultArrays)
        //cc.log('-------897')

        //if(cc.teShuPaiCards){
        //    var TeShuCards = cc.teShuPaiCards.map(function(ca){
        //       return KQCard._typeCardsSortByNumberOfPoints(KQCard.cardsFromArray(ca));
        //    });
        //    resultArrays.unshift(TeShuCards);
        //
        //}

        if (resultArrays.length <= 0) {

            this._allCardModes.forEach(function (i) {
                if (i.scores == 1) i.scores = 14;
            });

            var card20 = KQCard.contain20(this._allCardModes);

            this._allCardModes = this._allCardModes.kq_excludes(card20);

            this._allCardModes = KQCard._typeCardsSortByNumberOfPoints(this._allCardModes);

            this._allCardModes = card20.concat(this._allCardModes);

            var asdf1 = this._allCardModes.slice(0, 5);

            var asdf2 = this._allCardModes.slice(5, 10);

            var asdf3 = this._allCardModes.slice(10, 13);

            resultArrays.push([asdf3, asdf2, asdf1]);
        }

        this.autoCardLayout.node.removeAllChildren();
        this.autoCardScrollView.scrollToLeft();
        for (var i = 0; i < resultArrays.length; i++) {
            //添加预制体
            var _s4 = resultArrays[i];
            var autoCard = cc.instantiate(this.autoCard);
            autoCard.y = 0;
            _s4[0].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            _s4[1].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            _s4[2].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            var cardsNode = [autoCard.children[1], autoCard.children[3], autoCard.children[2]];

            this._setCardDaoSprite(cardsNode, _s4);

            autoCard.cardArray = _s4;
            var eventHandler = new cc.Component.EventHandler();
            eventHandler.target = this.node;
            eventHandler.component = "CardTypeCombine";
            eventHandler.handler = "clickAutoSelectedCards";
            eventHandler.customEventData = i;
            autoCard.getComponent(cc.Button).clickEvents.push(eventHandler);
            this.autoCardLayout.node.addChild(autoCard);
        }
        this._findCardIndex.arr = resultArrays;

        this.autoSelectedCardsOne();
    },

    //daoCancelAll: function () {
    //    var nodes = [this.layoutTouDao.node,this.layoutZhongDao.node,this.layoutWeiDao.node];
    //    for(var i = 0;i < nodes.length;i++){
    //        nodes[i].removeAllChildren();
    //    }
    //},

    autoSelectedCardsOne: function autoSelectedCardsOne() {
        this.cardsLayout.node.removeAllChildren();

        var indexs = 0;

        for (var i = 0; i < this.autoCardLayout.node.children.length; i++) {

            var nodes = this.autoCardLayout.node.children[i];

            nodes.children[0].active = false;
        }

        this.autoCardLayout.node.children[indexs].children[0].active = true;

        var resultArray = this._findCardIndex.arr[indexs];

        this._findCardIndex.indexs = indexs;

        for (var i = 0; i < resultArray.length; i++) {

            var cardModes = resultArray[i];

            cardModes.sort(KQCard.sort);

            var num = 0;
            if (i == 1) {
                num = 3;
            } else if (i == 2) {
                num = 8;
            }
            //cardModes.forEach(function(i){if (i.point == 14) i.point = 1;})
            cardModes.forEach((function (cardMode, index) {

                var cardName = cardMode.cardName();

                var numBer = num + index;

                var nodds1 = new cc.Node(); //创建一个节点对象

                nodds1.anchorY = 1;

                nodds1.addComponent(cc.Sprite); //添加精灵组件

                this.cardAllNode.children[numBer].addChild(nodds1);

                this.cardAllNode.children[numBer].children[0].cardName = cardName;

                this.cardAllNode.children[numBer].children[0]._cardModel = new KQCard(cardName, null, index);

                var btnSprites = this.cardAllNode.children[numBer].children[0].getComponent(cc.Sprite);

                this.cardAllNode.children[numBer].getComponent(cc.Sprite).spriteFrame = '';

                btnSprites.node.removeAllChildren();

                if (cc.maPai == cardName) {

                    var nodds = new cc.Node(); //创建一个节点对象

                    nodds.addComponent(cc.Sprite); //添加精灵组件

                    cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                        if (err) {
                            cc.error(err.message || err);return;
                        }

                        var btnSprite1 = nodds.getComponent(cc.Sprite);

                        btnSprite1.spriteFrame = spriteFrame;

                        btnSprite1.node.width = 107;

                        btnSprite1.node.height = 155;

                        btnSprite1.node.y = -65.5;
                    }).bind(this));

                    btnSprites.node.addChild(nodds);
                }

                var path = 'public-pic-card-poker-' + cardName;

                this._loadCardFrame(this.cardSpriteAtlas, path, btnSprites, 95, 130);
            }).bind(this));
        }

        this.clickAutoSelectedCards(null);

        //this._setCardDaoSprite();
    },

    clickAutoSelectedCards: function clickAutoSelectedCards(event) {
        var indexs = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];

        for (var i = 0; i < this.autoCardLayout.node.children.length; i++) {

            var nodes = this.autoCardLayout.node.children[i];

            nodes.children[0].active = false;
        }

        this.autoCardLayout.node.children[indexs].children[0].active = true;

        AudioManager.instance.playPokerClick();

        if (event) {
            var resultArray = event.target.cardArray;
        } else {
            var resultArray = this._findCardIndex.arr[indexs];
        }
        var touScore = KQCard.scoreOfCards(resultArray[0]);
        var zhongScore = KQCard.scoreOfCards(resultArray[1]);
        var weiScore = KQCard.scoreOfCards(resultArray[2]);
        //cc.log(touScore);
        //cc.log(zhongScore);
        //cc.log(weiScore);
        //console.log('----------1180')
        resultArray = resultArray.map((function (cardMode) {

            cardMode = KQCard._typeCardsSortByNumberOfPoints(cardMode);

            return cardMode.map((function (cardModes) {

                return cardModes.cardName();
            }).bind(this));
        }).bind(this));
        //console.log(resultArray)

        this.LayoutWithEvent.forEach(function (nodes) {

            nodes.color = new cc.Color(255, 255, 255);

            nodes.children.forEach(function (i) {
                i.color = new cc.Color(255, 255, 255);
            });
        });

        this.LayoutWithEvent = [];

        resultArray = resultArray[0].concat(resultArray[1]).concat(resultArray[2]);

        var cardAllNode = this.cardAllNode.children.map(function (i) {
            return i;
        });

        for (var i = 0; i < resultArray.length; i++) {

            var s = resultArray[i];

            for (var j = 0; j < cardAllNode.length; j++) {

                var d = cardAllNode[j];

                d.getComponent(cc.Button).interactable = false;

                if (d.children[0].cardName == s) {

                    d.stopAllActions();

                    var detail = this.changeNodeSpaceAR[i];

                    var call = cc.callFunc((function () {

                        this.cardAllNode.children.forEach(function (nodes) {
                            nodes.getComponent(cc.Button).interactable = true;
                        });

                        this._setCardDaoSprite();
                    }).bind(this), this);

                    d.runAction(cc.sequence(cc.moveTo(this.cardTime, detail), call));

                    cardAllNode.splice(j, 1);

                    break;
                }
            }
        }
    },

    _loadCardFrame: function _loadCardFrame(SpriteFrame, path, SpritesNode, w, h) {

        var Sprite = SpriteFrame.getSpriteFrame(path);

        SpritesNode.spriteFrame = Sprite;

        if (w) SpritesNode.node.width = w;

        if (h) SpritesNode.node.height = h;
    },

    stickOutFindCardType1: function stickOutFindCardType1(cards) {
        var index = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];
    },

    //// 将已有的突出的牌的位置重置回初始位置
    //this._resetCardsPositionY();
    //let selectedCardNames = cards.map(function(cardModel){
    //    return cardModel.cardName();
    //}.bind(this));
    //
    //let cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {
    //    let cardPrefab = cardNode.getComponent('CardPrefab');
    //    if(selectedCardNames.includes(cardPrefab.cardName())) {
    //        var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());
    //        selectedCardNames.splice(nameIndex,1);
    //        return true;
    //    }
    //    return false;
    //});
    //
    //cc.log('-------696')
    //this._changeCardPrefabsY(cardNodes);
    //if(index == 1){
    //    this._addDaoCardToLayout(this.layoutTouDao.node, 3);
    //}
    //else if(index == 2){
    //    this._addDaoCardToLayout(this.layoutZhongDao.node);
    //}
    //else if(index == 3){
    //    this._addDaoCardToLayout(this.layoutWeiDao.node);
    //}

    _touchCardLayout: function _touchCardLayout(event) {
        //event.bubbles = true;
        //let location = event.getLocation();
        //let cardPrefab = this._cardPrefabInCardLayoutWithLocation(location);
        //if (cardPrefab) {
        //    cardPrefab.getComponent('CardPrefab').setSelected(true);
        //    event.stopPropagation();
        //}
    },

    _touchCardLayoutEnd: function _touchCardLayoutEnd(event) {
        //this._changeSelectedCardPrefabsY();
        //this._diseclectCardPrefabs();
    },

    _cardPrefabInCardLayoutWithLocation: function _cardPrefabInCardLayoutWithLocation(location) {
        //location = this.cardsLayout.node.convertToNodeSpaceAR(location);
        //let cardNodes = this.cardsLayout.node.children.sort(function (cardNode1, cardNode2) {
        //    let rect1 = cardNode1.getBoundingBox();
        //    let rect2 = cardNode2.getBoundingBox();
        //    return rect2.x - rect1.x;
        //});
        //for (let index in cardNodes) {
        //    let cardNode = cardNodes[index];
        //
        //    let rect = cardNode.getBoundingBox();
        //
        //    if (cc.rectContainsPoint(rect, location)) {
        //        return cardNode;
        //    }
        //}
        //
        //return null;
    },

    _changeSelectedCardPrefabsY: function _changeSelectedCardPrefabsY() {
        //let cardNodes = this._selectedCardPrefabs();
        //this._changeCardPrefabsY(cardNodes);
        //
        //AudioManager.instance.playPokerClick();
    },

    _changeCardPrefabsY: function _changeCardPrefabsY(cardNodes) {
        //cardNodes.forEach(function (cardNode) {
        //    let y = cardNode.getPositionY();
        //    if (y == this._cardOffsetY) {
        //        cardNode.setPositionY(this._cardOffsetY + 55);
        //    } else {
        //        cardNode.setPositionY(this._cardOffsetY);
        //    }
        //}.bind(this));
    },

    _selectedCardPrefabs: function _selectedCardPrefabs() {
        var includeStickOut = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];
    },

    //let cardNodes = this.cardsLayout.node.children || [];
    //return cardNodes.filter(function (cardNode) {
    //    let cardPrefab = cardNode.getComponent('CardPrefab');
    //    let isSelected = cardPrefab.isSelected();
    //    if (!isSelected && includeStickOut) {
    //        isSelected = cardNode.getPositionY() > 10;
    //    }
    //
    //    return isSelected;
    //});
    _diseclectCardPrefabs: function _diseclectCardPrefabs() {
        //let cardNodes = this.cardsLayout.node.children;
        //cardNodes.forEach(function (node) {
        //    node.getComponent('CardPrefab').setSelected(false);
        //});
    },

    // 重置 cards 的 X
    _resetCardsPositionX: function _resetCardsPositionX() {
        //let interval = 98;
        //let interval = 78;
        //let cardNodes = this.cardsLayout.node.children || [];
        //let length = cardNodes.length;
        //if (length == 0) {
        //    return;
        //}
        //
        //let middleIndex = length / 2;
        //let cardWidth = 154;
        //
        //
        ////this.cardsLayoutSort();
        //if(this.cardsLayoutSortColor == true){
        //    this.cardsLayout.node.children.sort(function (n1, n2) {
        //        let component1 = n1.getComponent('CardPrefab');
        //        let component2 = n2.getComponent('CardPrefab');
        //        return component2.cardMode().color - component1.cardMode().color;
        //    });
        //}else{
        //    this.cardsLayout.node.children.sort(function (n1, n2) {
        //        let component1 = n1.getComponent('CardPrefab');
        //        let component2 = n2.getComponent('CardPrefab');
        //        return component1.cardMode().sort(component2.cardMode());
        //    });
        //}
        ////cardNodes.sort(function (n1, n2) {
        ////    let component1 = n1.getComponent('CardPrefab');
        ////    let component2 = n2.getComponent('CardPrefab');
        ////
        ////    return component1.cardMode().sort(component2.cardMode());
        ////});
        //
        //cardNodes.forEach(function (cardNode, index) {
        //    cardNode.zIndex = index;
        //    let x = (index - middleIndex) * interval + cardWidth / 3;
        //    cardNode.setPositionX(x);
        //});
    },

    // 重置 cards 的 X为0
    resetCardsPositionX1: function resetCardsPositionX1() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //let length = cardNodes.length;
        //if (length == 0) {
        //    return;
        //}
        //cardNodes.forEach(function (cardNode) {
        //    cardNode.setPositionY(0);
        //});
    },

    _resetCardsPositionY: function _resetCardsPositionY() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //cardNodes.forEach(function (cardNode) {
        //    cardNode.setPositionY(this._cardOffsetY);
        //}.bind(this));
    },

    // 头、中、尾道 layout 的点击事件
    _registerDaosLayoutClickEvent: function _registerDaosLayoutClickEvent() {

        this.changeNodeSpaceAR = []; //记录所有牌的坐标
        this.cardAllNode.children.forEach((function (nodes) {
            //获取节点的世界坐标
            var cardBackWorldSpace1 = nodes.convertToWorldSpaceAR(cc.v2(0, 0));
            //获取相对父节点所在的坐标
            var detail = nodes.parent.convertToNodeSpaceAR(cardBackWorldSpace1);

            this.changeNodeSpaceAR.push(detail);
        }).bind(this));
    },

    clickAllCard: function clickAllCard(event) {
        AudioManager.instance.playPokerClick();
        if (this.LayoutWithEvent.length <= 1) {
            this.LayoutWithEvent.push(event.target);
            event.target.color = new cc.Color(182, 182, 182);
            event.target.children.forEach(function (i) {
                i.color = new cc.Color(182, 182, 182);
            });
        }
        if (this.LayoutWithEvent.length == 2) {

            var arr = [];

            this.LayoutWithEvent.forEach((function (nodes) {
                //获取节点的世界坐标
                var cardBackWorldSpace1 = nodes.convertToWorldSpaceAR(cc.v2(0, 0));
                //获取相对父节点所在的坐标
                var detail = nodes.parent.convertToNodeSpaceAR(cardBackWorldSpace1);

                arr.unshift(detail);
            }).bind(this));

            this.LayoutWithEvent.forEach((function (nodes, index) {

                nodes.color = new cc.Color(255, 255, 255);

                nodes.children.forEach(function (i) {
                    i.color = new cc.Color(255, 255, 255);
                });

                nodes.getComponent(cc.Button).interactable = false;

                this.scheduleOnce((function () {

                    nodes.getComponent(cc.Button).interactable = true;

                    this._setCardDaoSprite();
                }).bind(this), this.cardTime);

                nodes.stopAllActions();

                var detail = arr[index];

                nodes.runAction(cc.moveTo(this.cardTime, detail));
            }).bind(this));

            this.LayoutWithEvent = [];
        }
    },

    _setCardDaoSprite: function _setCardDaoSprite() {
        var nodes = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];
        var cards = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];

        if (!nodes) {

            this.cardAlls = this.cardAllNode.children.sort(function (a, b) {
                return b.y - a.y;
            }).map(function (i) {
                return i.children[0];
            });

            cards = [this._taoDaoCardModes(), this._zhongDaoCardModes(), this._weiDaoCardModes()];

            cards.forEach(function (card) {
                card.forEach(function (i) {
                    if (i.scores == 14) {
                        i.scores = 1;
                    }
                });
            });

            nodes = [this.touDaoNode, this.zhongDaoNode, this.weiDaoNode];
        }

        //头道
        var typeName0 = KQCard.cardsType(cards[0]) + 1;

        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;

        typeName0 = typeName0 == '04' ? '11' : typeName0;

        var path = 'game_poker_type' + typeName0;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[0].getComponent(cc.Sprite));

        //中道
        var typeName1 = KQCard.cardsType(cards[1]) + 1;

        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;

        typeName1 = typeName1 == '07' ? '22' : typeName1;

        path = 'game_poker_type' + typeName1;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[1].getComponent(cc.Sprite));

        //尾道
        var typeName2 = KQCard.cardsType(cards[2]) + 1;

        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        path = 'game_poker_type' + typeName2;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[2].getComponent(cc.Sprite));

        this.cardAllNode.children.forEach(function (n) {
            n.getComponent(cc.Sprite).spriteFrame = "";
        });

        if (cards) {

            if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards, this.cardAllNode.children, this.cardSpriteAtlas);

            if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards, this.cardAllNode.children, this.cardSpriteAtlas);

            if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards, this.cardAllNode.children, this.cardSpriteAtlas);
        }
    },

    _clickTouDaoLayout: function _clickTouDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutTouDao.node, event);
    },

    _clickZhongDaoLayout: function _clickZhongDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutZhongDao.node, event);
    },

    _clickWeiDaoLayout: function _clickWeiDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutWeiDao.node, event);
    },

    _daoCardNodeInLayoutWithEvent: function _daoCardNodeInLayoutWithEvent(node, event) {
        var cardNodes = node.children || [];
        var location = event.getLocation();
        location = node.convertToNodeSpaceAR(location);
        //var cardBackWorldSpace = this.layoutZhongDao.node.convertToWorldSpaceAR(cc.v2(0, 0));
        ////获取节点的世界坐标
        //var detail = this.layoutZhongDao.node.parent.convertToNodeSpaceAR(cardBackWorldSpace);
        ////获取相对父节点所在的坐标
        //this.layoutWeiDao.node.runAction(cc.moveTo(1,detail));
        for (var index in cardNodes) {
            var cardNode = cardNodes[index];
            var rect = cardNode.getBoundingBox();
            if (cc.rectContainsPoint(rect, location)) {
                AudioManager.instance.playPokerClick();
                var arrs = [node, cardNode];
                if (this.LayoutWithEvent.length == 1) {
                    if (this.LayoutWithEvent[0][0].name != node.name) {
                        cardNode.opacity = 200;
                        this.LayoutWithEvent.push(arrs);
                    } else {
                        this.LayoutWithEvent[0][1].opacity = 255;
                        this.LayoutWithEvent = [];
                    }
                } else if (this.LayoutWithEvent.length == 0) {
                    //cc.log(cardNode)
                    this.LayoutWithEvent.push(arrs);
                    cardNode.opacity = 200;
                }
                if (this.LayoutWithEvent.length == 2) {
                    var node1 = this.LayoutWithEvent[0][1];
                    var node2 = this.LayoutWithEvent[1][1];
                    //获取节点的世界坐标
                    var cardBackWorldSpace = node1.convertToWorldSpaceAR(cc.v2(0, 0));
                    //获取相对父节点所在的坐标
                    var detail = node1.parent.convertToNodeSpaceAR(cardBackWorldSpace);
                    node2.runAction(cc.moveTo(1, detail));
                }

                return;
            }
        }

        //return null;
    },

    _addDaoCardToLayout: function _addDaoCardToLayout(node) {
        var maxNumberCard = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];
    },

    //let cardNodes = node.children || [];
    //if (cardNodes.length >= 5) {
    //    return;
    //}
    //let remainCount = maxNumberCard - cardNodes.length;
    //
    //var selectedCards = this._selectedCardPrefabs(true) || [];
    //
    //if (selectedCards.length == 0) {
    //    return;
    //}
    //if (selectedCards.length > remainCount) {
    //    selectedCards = selectedCards.slice(0, remainCount);
    //}
    //
    //let selectedCardNames = selectedCards.map(function (cardPrefab) {
    //    return cardPrefab.getComponent('CardPrefab').cardName();
    //});
    //
    //cardNodes.forEach(function (cardTypeNode) {
    //    selectedCardNames.push(cardTypeNode.getComponent('CardTypeSprite').cardName());
    //});
    //
    //let cardModes = selectedCardNames.map(function (cardName,index) {
    //    return new KQCard(cardName,null,index);
    //}).sort(function (c1, c2) {
    //    return KQCard.sort(c1, c2, false);
    //});

    //let touCardModes = (node == this.layoutTouDao.node) ? cardModes : this._taoDaoCardModes();
    //let zhongCardModes = (node == this.layoutZhongDao.node) ? cardModes : this._zhongDaoCardModes();
    //let weiCardModes = (node == this.layoutWeiDao.node) ? cardModes : this._weiDaoCardModes();
    //if (!this._isValidCardModes(touCardModes, zhongCardModes, weiCardModes)) {
    //    this.cacleAutoSelectedCards1();
    //    cc.log('相公牌：自动选择牌')
    //    return;
    //}
    //
    //node.removeAllChildren();
    //
    //cardModes.forEach(function (cardMode,index) {
    //    let cardName = cardMode.cardName();
    //    let cardTypeSprite = cc.instantiate(this.cardTypePrefab);
    //    cardTypeSprite.names = cardName+'+'+index;
    //    cardTypeSprite.getComponent('CardTypeSprite').setCard(cardName,index);
    //    node.addChild(cardTypeSprite);
    //}.bind(this));
    //
    //
    //selectedCards.forEach(function (node) {
    //    node.removeFromParent();
    //});
    //this._resetCardsPositionY();
    //this._resetCardsPositionX();
    //
    //this._autoActiveDeleteDaoButtons();
    //
    //this._reloadKQCardModesInner();
    //this._resetTypeButtonEnablesWithModels();
    // 删除 头、中或尾道中的某中牌
    _deleteDaoCard: function _deleteDaoCard(cardTypeNode) {
        var reloadTypeButtonEnables = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
    },

    //let cardName = cardTypeNode.getComponent('CardTypeSprite').cardName();
    //this.addCard(cardName, true);
    //
    //this._resetCardsPositionY();
    //
    //cardTypeNode.removeFromParent(true);
    //this._autoActiveDeleteDaoButtons();
    //
    //if (reloadTypeButtonEnables) {
    //    this._reloadKQCardModesInner();
    //    this._resetTypeButtonEnablesWithModels();
    //}
    // 删除 头道或中道或尾道上所有的 牌
    _deleteDaoCardsOfLayout: function _deleteDaoCardsOfLayout(daoLayout) {
        //let cardNodes = Array.from(daoLayout.children);
        //cardNodes.forEach(this._deleteDaoCard.bind(this));
        //
        //this._reloadKQCardModesInner();
        //this._resetTypeButtonEnablesWithModels();
    },

    // 判断能否使用选择中的牌
    // 即：头道要小于中道、中道要小于尾道
    _isValidCardModes: function _isValidCardModes(touCardModes, zhongCardModes, weiCardModes) {
        touCardModes = touCardModes || [];
        zhongCardModes = zhongCardModes || [];
        weiCardModes = weiCardModes || [];
        if (touCardModes.length < 3 || zhongCardModes.length < 5 || weiCardModes.length < 5) {
            return true;
        }

        var touScore = KQCard.scoreOfCards(touCardModes);
        var zhongScore = KQCard.scoreOfCards(zhongCardModes);
        var weiScore = KQCard.scoreOfCards(weiCardModes);
        return touScore < zhongScore && zhongScore <= weiScore;
    },

    // 头道上已有的牌
    _taoDaoCardModes: function _taoDaoCardModes() {
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(0, 3));
    },

    // 中道上已有的牌
    _zhongDaoCardModes: function _zhongDaoCardModes() {
        //return this._cardModesOfCardPrefabs(this.layoutZhongDao.node.children);
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(3, 8));
    },

    // 尾道上已有的牌
    _weiDaoCardModes: function _weiDaoCardModes() {
        //return this._cardModesOfCardPrefabs(this.layoutWeiDao.node.children);
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(8, 13));
    },

    _cardModesOfCardPrefabs: function _cardModesOfCardPrefabs(cardTypeNodes) {
        if (!cardTypeNodes) {
            return [];
        }

        var cardModes = cardTypeNodes.map(function (node) {
            //let component = node.getComponent('CardTypeSprite');
            //return component.cardMode();._cardModel
            return node._cardModel;
        });

        return cardModes || [];
    },

    // 自动设置 头、中、尾道的删除按钮的可见性
    _autoActiveDeleteDaoButtons: function _autoActiveDeleteDaoButtons() {
        //this._autoActiveDeleteDaoButton(this.layoutTouDao.node, this.btnDeleteTouDao.node);
        //this._autoActiveDeleteDaoButton(this.layoutZhongDao.node, this.btnDeleteZhongDao.node);
        //this._autoActiveDeleteDaoButton(this.layoutWeiDao.node, this.btnDeleteWeiDao.node);
    },

    _autoActiveDeleteDaoButton: function _autoActiveDeleteDaoButton(layout, button) {
        //button.active = layout.children.length > 0;
    },

    // 自动设置 “全部取消”、“确定出牌”、“类型选择”按钮的可见性
    _autoActiveTypeButtons: function _autoActiveTypeButtons() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //let hasCardUnSelected = cardNodes.length > 0;
        //this.btnDone.node.active = !hasCardUnSelected;
        //this.btnCancelAll.node.active = this.btnDone.node.active;
        //this.typeButtonsNode.active = hasCardUnSelected;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardScoretsHelper":"KQCardScoretsHelper","play":"play"}],"CardTypeSprite":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e614c0FMndAtrOMcy8/PcZw', 'CardTypeSprite');
// scripts\CardTypeSprite.js

var KQCard = require('KQCard');
cc.Class({
  'extends': cc.Component,

  properties: {
    _cardName: null,
    _cardModel: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setCard: function setCard(cardName, index) {
    var asdf = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    this._cardName = cardName;
    if (asdf) {
      this._cardModel = new KQCard(cardName, null, index);
    }
    this._loadCardFrame(cardName, (function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }).bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._cardModel;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"ChatMessage":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dc8980X2ZVNKrH9BsIsSE4D', 'ChatMessage');
// scripts\Chat\ChatMessage.js

// 用于在游戏过程中，展示用户的聊天消息

var ChatMessage = cc.Class({
    "extends": cc.Component,

    properties: {
        richText: cc.RichText,
        spriteBackground: cc.Sprite,
        emoji: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        ChatMessage.instances = this;
    },

    setString: function setString() {
        var string = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];
        var autoHide = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (string.length == 0) {
            return;
        }

        this.node.active = true;
        this.richText.node.active = true;
        this.spriteBackground.node.active = true;
        this.emoji.active = false;
        var maxWidth = 300;
        var realStr = ChatMessage.parseString(string);

        // 由于 cc.RichText 在指定 maxWidth 后，该结点的 width 会一直
        // 是 maxWidth 值。而在将 maxWidth 指定为0时，其 contentSize.width 会
        // 是内容的真正所需的宽度
        //
        // 所以这里先将 maxWidth 设为 0，获取其实际内容 width 后再调整
        this.richText.maxWidth = 0;
        this.richText.string = realStr;

        var contentWidth = this.richText.node.getContentSize().width;
        if (contentWidth > maxWidth) {
            this.richText.maxWidth = maxWidth;
            this.richText.string = realStr;
            contentWidth = maxWidth;
        }

        this.node.width = contentWidth + 28;
        this.node.height = this.richText.node.getContentSize().height + 20;

        this.spriteBackground.node.width = this.node.width;
        this.spriteBackground.node.height = this.node.height;

        if (autoHide) {
            this._hideNode();
            //this.unscheduleAllCallbacks();
            //this.scheduleOnce(this._hideNode.bind(this), 3);
        }
    },

    showEmoji: function showEmoji(sprite) {
        this._hideNode();
        this.node.active = true;
        this.emoji.active = true;
        this.richText.node.active = false;
        this.spriteBackground.node.active = false;
        var btnSprites = this.emoji.getComponent(cc.Sprite);
        btnSprites.spriteFrame = sprite;
    },

    _hideNode: function _hideNode() {
        this.unscheduleAllCallbacks();
        this.scheduleOnce((function () {
            this.node.active = false;
        }).bind(this), 3);
    }

});
ChatMessage.setEmoji = function (sprite) {
    this.instances._hideNode();
    this.instances.node.active = true;
    this.instances.emoji.active = true;
    this.instances.richText.node.active = false;
    this.instances.spriteBackground.node.active = false;
    var btnSprites = this.instances.emoji.getComponent(cc.Sprite);
    btnSprites.spriteFrame = sprite;
    //console.log(this.emoji);
    //return;
    //
    //this.emoji.Sprite = sprite;
},

// 将 <bq10> 改为： <img src='bg10'/>
ChatMessage.parseString = function (str) {
    var result = str.replace(/<bq\d{1,2}>/g, function (match) {
        var bq = match.replace("<", " <img src='").replace(">", "'/> ");
        return bq;
    });
    return result;
}, module.exports = ChatMessage;

cc._RFpop();
},{}],"ChatTextRecord":[function(require,module,exports){
"use strict";
cc._RFpush(module, '88d10U9tIpHNK1entoUH0Ju', 'ChatTextRecord');
// scripts\Pefabs\ChatTextRecord.js

cc.Class({
    'extends': cc.Component,

    properties: {},

    // use this for initialization
    onLoad: function onLoad() {},

    setString: function setString(str) {
        this._richText().string = str;
    },

    _richText: function _richText() {
        return this.node.getComponent('cc.RichText');
    },

    setEmoji: function setEmoji(spraite) {
        this._spriteFrame().Spraite = spraite;
    },
    _spriteFrame: function _spriteFrame() {
        return this.node.getComponent('cc.Sprite');
    }
});

cc._RFpop();
},{}],"CompareCards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9aa4aH/Ha1JfaEeY5nFj5P1', 'CompareCards');
// scripts\Pefabs\CompareCards.js

var KQCardResHelper = require('KQCardResHelper');
var AudioManager = require('AudioManager');
var KQCard = require('KQCard');

cc.Class({
    'extends': cc.Component,

    properties: {
        touLayout: cc.Layout,
        zhongLayout: cc.Layout,
        weiLayout: cc.Layout,

        touLayoutBack: cc.Layout,
        zhongLayoutBack: cc.Layout,
        weiLayoutBack: cc.Layout,
        baoDao: cc.Node, //报道图,
        playTotalScore: cc.Layout, //所有玩家的总分数

        daoScoreLayouts: [cc.Layout],
        daoTitleNodes: [cc.Node],
        TScoreLayout: cc.Layout,
        TtitleNode: cc.Node,

        pNum: 0, //玩家人数
        teShuTime: 0, //特殊牌出牌顺序
        teShuNum: 0, //特殊牌人数

        _lCScore: null,
        _daoLayouts: null, // 头、中、尾集合
        _daoLayoutBacks: null, // 头、中、尾集合
        _scores: null,
        _user: null, // 用于比牌的数据
        _cardsInfo: null,
        _compareIndex: 0 },

    // 将要比较的 索引  0~2
    // use this for initialization
    onLoad: function onLoad() {

        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        this._daoLayoutBacks = [this.touLayoutBack, this.zhongLayoutBack, this.weiLayoutBack];
        this.reset();

        if (this._scores) {
            this.setScores(this._scores);
        }
    },

    reset: function reset() {
        this._compareIndex = 0;

        this.node.children.forEach(function (node) {
            node.active = false;
        });

        this.baoDao.getComponent(cc.Sprite).spriteFrame = null;

        var nodes = this.touLayoutBack.node.children.concat(this.zhongLayoutBack.node.children).concat(this.weiLayoutBack.node.children);

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        nodes.forEach((function (nod) {

            nod.removeAllChildren();

            var cardSprite = nod.getComponent(cc.Sprite);

            KQCard._loadCardFrame(this.cardSpriteAtlas, "public-pic-card-poker-back", cardSprite);
        }).bind(this));

        this.daoScoreLayouts.forEach((function (nod) {
            nod.node.active = false;
        }).bind(this));

        this.daoTitleNodes.forEach((function (nod) {
            nod.active = false;
        }).bind(this));

        if (this.TScoreLayout) this.TScoreLayout.node.active = false;

        if (this.TtitleNode) this.TtitleNode.active = false;

        this.unscheduleAllCallbacks();

        //console.log('执行了一遍清除定时器--------------------------------')

        if (this.TScoreLayout) this.TScoreLayout.node.stopAllActions();

        if (this.playTotalScore) this.playTotalScore.node.stopAllActions();
    },

    setCompareData: function setCompareData(user) {
        this._user = user;
        this._cardsInfo = user.cardInfo;
        var cardsInfo = user.cardInfo;
        this._lCScore = user.lCScore;
        var cards = cardsInfo.map(function (cardInfoItem) {
            return KQCard.cardsFromArray(cardInfoItem.cards);
        }).reduce(function (array, subCards) {
            return array.concat(subCards);
        }, []);

        var scores = [user.score1 || 0, user.score2 || 0, user.score3 || 0, user.lScore1 || 0, user.lScore2 || 0, user.lScore3 || 0];
        this.setCards(cards);
        this.setScores(scores);
    },

    //显示所有玩家的总分数
    showScoreResult: function showScoreResult() {
        if (!this._user) return;
        var scores = this._user.cScore;
        this.setScores([scores], [this.playTotalScore], true);
        this.playTotalScore.node.active = true;
        this.playTotalScore.node.opacity = 255;
        var x = this.playTotalScore.node.x;
        var y = this.playTotalScore.node.y;
        this.playTotalScore.node.runAction(cc.moveTo(0.8, cc.p(x, y + 30)));
        this.scheduleOnce((function () {
            this.playTotalScore.node.runAction(cc.fadeOut(0.2));
        }).bind(this), 0.6);
        this.scheduleOnce((function () {
            this.playTotalScore.node.y = y;
        }).bind(this), 1);
    },

    //显示三道分数
    showNextCompareScore: function showNextCompareScore(isContainExtra) {
        if (isContainExtra && this.TScoreLayout) {
            var scores1 = this._lCScore.splice(0, 1);
            if (scores1.length <= 0) return;
            this.setScores(scores1, [this.TScoreLayout], true);
            this.TtitleNode.active = true;
            this.TScoreLayout.node.active = true;

            var scaleTo11 = cc.scaleTo(0.3, 1.8);
            var scaleTo21 = cc.scaleTo(0.1, 1.1);
            var scaleTo31 = cc.scaleTo(0.1, 1.3);
            var scaleToSeq1 = cc.sequence(scaleTo11, scaleTo21, scaleTo31);
            this.TScoreLayout.node.runAction(scaleToSeq1);
        }

        if (this.daoScoreLayouts.length <= 0) return;
        if (!this._user.isContainExtra) {
            var index = this._compareIndex == 0 ? 1 : this._compareIndex;
            this.daoScoreLayouts[index - 1].node.active = true;
            this.daoScoreLayouts[index + 2].node.active = true;
            this.daoTitleNodes[index - 1].active = true;
        }

        var scores = this._lCScore.splice(0, 1);
        if (scores.length <= 0 && !this.TScoreLayout) return;
        this.setScores(scores, [this.TScoreLayout], true);
        this.TtitleNode.active = true;
        this.TScoreLayout.node.active = true;

        var scaleTo1 = cc.scaleTo(0.3, 1.8);
        var scaleTo2 = cc.scaleTo(0.1, 1.1);
        var scaleTo3 = cc.scaleTo(0.1, 1.3);
        var scaleToSeq = cc.sequence(scaleTo1, scaleTo2, scaleTo3);
        this.TScoreLayout.node.runAction(scaleToSeq);
    },

    // 下一个要比较的分数
    // 如果没有要比较的了，则返回 0
    nextCompareScore: function nextCompareScore() {
        if (!this._user) return 0;

        var data;
        if (this._user.isContainExtra) {
            data = this._cardsInfo[0];
            if (data) return data.type * 9000000000000000;
        } else {
            data = this._cardsInfo[this._compareIndex];
        }
        if (!data) return 0;
        return data.value;
    },

    setMaPai: function setMaPai(nodes, cardName) {
        if (cc.maPai == cardName) {

            var nodds = new cc.Node(); //创建一个节点对象

            nodds.addComponent(cc.Sprite); //添加精灵组件

            cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                if (err) {
                    cc.error(err.message || err);return;
                }

                var btnSprite1 = nodds.getComponent(cc.Sprite);

                btnSprite1.sizeMode = 0;

                btnSprite1.spriteFrame = spriteFrame;

                btnSprite1.node.width = nodes.width + 10;

                btnSprite1.node.height = nodes.height + 10;
            }).bind(this));

            nodes.addChild(nodds);
        }
    },

    setCards: function setCards(cards) {

        var cardSprites = this._allCardSprites();

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        cards.forEach((function (kqCard, index) {
            if (index >= cardSprites.length) {
                return;
            }
            cardSprites[index].node.removeAllChildren();

            cardSprites[index].node.getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.cardName = kqCard.cardName();

            nodds1.width = cardSprites[index].node.width;

            nodds1.height = cardSprites[index].node.height;

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var path = "public-pic-card-poker-" + kqCard.cardName();

            KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            this.setMaPai(cardSprite.node, kqCard.cardName());

            cardSprites[index].node.addChild(nodds1);
        }).bind(this));

        var cards0 = cards.slice(0, 3);
        var cards1 = cards.slice(3, 8);
        var cards2 = cards.slice(8, 13);

        var cards11 = [cards0, cards1, cards2];
        //头道
        var typeName0 = KQCard.cardsType(cards0) + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        typeName0 = typeName0 == '04' ? '11' : typeName0;

        //中道
        var typeName1 = KQCard.cardsType(cards1) + 1;
        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;
        typeName1 = typeName1 == '07' ? '22' : typeName1;

        //尾道
        var typeName2 = KQCard.cardsType(cards2) + 1;
        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        cardSprites = cardSprites.map(function (i) {
            return i.node;
        });

        if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards11, cardSprites, this.cardSpriteAtlas);
        if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards11, cardSprites, this.cardSpriteAtlas);
        if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards11, cardSprites, this.cardSpriteAtlas);
    },

    setScores: function setScores(scores) {
        var Layouts = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];
        var is_WH = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

        if (!Layouts) {
            Layouts = this.daoScoreLayouts;
            if (Layouts.length <= 0) return;
        }

        scores.forEach((function (string, index) {

            var labels = Layouts[index];

            labels.node.removeAllChildren();

            var path = "play/CardTypeCombine/" + (Number(string) >= 0 ? "addNum" : "delNum");

            this._creatorNodes(labels.node, 10, path, '', is_WH);

            var strings = string > 0 ? string + "" : string * -1 + "";

            var stringAyy = strings.split("");

            for (var i = 0; i < stringAyy.length; i++) {

                var s = stringAyy[i];

                this._creatorNodes(labels.node, Number(s), path, '', is_WH);
            }

            labels.type = 1;
        }).bind(this));
    },

    _creatorNodes: function _creatorNodes(nodes, name, path, paths) {
        var w_h = arguments.length <= 4 || arguments[4] === undefined ? false : arguments[4];

        var node = new cc.Node(); //创建一个节点对象

        node.addComponent(cc.Sprite); //添加精灵组件

        var btnSprite = node.getComponent(cc.Sprite);

        btnSprite.sizeMode = 0;

        btnSprite.node.width = 18;btnSprite.node.height = 23;
        //name = name + "";
        this._loadCardFrame(name, (function (spriteFrame) {

            btnSprite.spriteFrame = spriteFrame;

            if (w_h) {
                btnSprite.node.width = 30;btnSprite.node.height = 40;
            }
        }).bind(this), path, paths);

        nodes.addChild(node);
    },

    _setCardSpriteFrame: function _setCardSpriteFrame(indexs, nodes) {
        var cardsInfo = this._cardsInfo;
        var cards = cardsInfo.map(function (cardInfoItem) {
            return KQCard.cardsFromArray(cardInfoItem.cards);
        })[indexs] || [];

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        // cc.log(this._cardsInfo)
        // cc.log(cards)
        // cc.log('------555')

        cards.forEach((function (kqCard, index) {

            nodes.children[index].removeAllChildren();

            nodes.children[index].getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.cardName = kqCard.cardName();

            nodds1.width = nodes.children[index].width;

            if (nodes.parent.parent.name == "playSelf") {

                nodes.children[index].height = 130;

                nodds1.height = 130;
            } else {

                nodes.children[index].height = 115;

                nodds1.height = 115;

                //console.log(nodes);
                //console.log(nodds1);
            }

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var path = "public-pic-card-poker-" + kqCard.cardName();

            cardSprite.node.removeAllChildren();

            KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            this.setMaPai(cardSprite.node, kqCard.cardName());

            nodes.children[index].addChild(nodds1);
        }).bind(this));

        var typeName = KQCard.cardsType(cards) + 1;

        typeName = typeName >= 10 ? typeName + "" : "0" + typeName;

        //头道
        if (indexs == 0) {
            typeName = typeName == '04' ? '11' : typeName;
        } else if (indexs == 1) {
            typeName = typeName == '07' ? '22' : typeName;
        }

        var cardSprites = nodes.children.map(function (i) {
            return i;
        });

        KQCard._setGuiCards(typeName, cards, cardSprites, this.cardSpriteAtlas);
    },

    showTouCards: function showTouCards() {
        if (this._user.isContainExtra == true) return;
        //console.log('开始执行一次定时动作--------------------------------')

        this.touLayoutBack.node.active = false;
        this._setCardSpriteFrame(0, this.touLayoutBack.node);
        this.scheduleOnce((function () {
            this.touLayout.node.active = false;
            this.touLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.touLayout.node.active = true;
        this.touLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.touLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        var types = this._cardsInfo[this._compareIndex].type == 3 ? 333 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showZhongCards: function showZhongCards() {
        if (this._user.isContainExtra == true) return;

        this.zhongLayoutBack.node.active = false;
        this._setCardSpriteFrame(1, this.zhongLayoutBack.node);
        this.scheduleOnce((function () {
            this.zhongLayout.node.active = false;
            this.zhongLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.zhongLayout.node.active = true;
        this.zhongLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.zhongLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        var types = this._cardsInfo[this._compareIndex].type == 6 ? 555 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showWeiCards: function showWeiCards() {
        //console.log('执行了一次尾道动画---------------')
        if (this._user.isContainExtra == true) return;
        //this._setCardSpriteFrame(1,this.zhongLayoutBack.node);
        this.weiLayoutBack.node.active = false;
        this._setCardSpriteFrame(2, this.weiLayoutBack.node);
        this.scheduleOnce((function () {
            this.weiLayout.node.active = false;
            this.weiLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.weiLayout.node.active = true;
        this.weiLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.weiLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[this._compareIndex].type);
        this._compareIndex += 1;
    },

    showTeShuCards: function showTeShuCards(cards) {
        //let typeName = KQCard.cardsTypeName(cardsNames);
        this._daoLayoutBacks = [this.touLayoutBack, this.zhongLayoutBack, this.weiLayoutBack];

        var touCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[0]);
        var zhongCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[1]);
        var weiCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[2]);
        var cardSprites = touCardSprites.concat(zhongCardSprites).concat(weiCardSprites);
        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;
        this.scheduleOnce((function () {
            cards.forEach((function (kqCard, index) {
                if (index >= cardSprites.length) return;

                var cardSprite = cardSprites[index];

                var path = "public-pic-card-poker-" + kqCard.cardName();

                cardSprite.node.removeAllChildren();

                KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

                this.setMaPai(cardSprite.node, kqCard.cardName());
            }).bind(this));
            this._daoLayoutBacks.forEach((function (nodes) {
                nodes.node.active = true;
            }).bind(this));
            AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[0].type);
        }).bind(this), 0.1);
    },

    showNextCards: function showNextCards() {
        var cardTypeCombine = this.node.parent.parent.getChildByName('CardTypeCombine').getComponent('CardTypeCombine');
        cardTypeCombine.reset();
        cardTypeCombine.node.active = false;

        this.touLayoutBack.node.parent.active = true;
        if (this._user.isContainExtra) {
            var cards = this._cardsInfo[0].cards.map(function (cardInfoItem) {
                return KQCard.cardsFromArray(cardInfoItem);
            }).reduce(function (array, subCards) {
                return array.concat(subCards);
            }, []);
            this.showTeShuCards(cards);
            this.showBaoDao(0, 0);
            this.baoDao.active = true;
            return;
        }
        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        this._daoLayouts.forEach(function (nodes) {
            nodes.node.active = false;
        });
        if (this._compareIndex == 0) {
            this.showBaoDao(0, 140);
            this.showTouCards();
        } else if (this._compareIndex == 1) {
            this.showBaoDao(1, 85);
            this.showZhongCards();
        } else if (this._compareIndex == 2) {
            this.showBaoDao(2, 34);
            this.showWeiCards();
        }

        this.baoDao.active = true;
        this.scheduleOnce((function () {
            this.baoDao.active = false;
        }).bind(this), 0.7);
    },

    showAllCards: function showAllCards() {
        if (!this._user) return;

        if (this._user.isContainExtra) {

            var cards = this._cardsInfo[0].cards.map(function (cardInfoItem) {
                return KQCard.cardsFromArray(cardInfoItem);
            }).reduce(function (array, subCards) {
                return array.concat(subCards);
            }, []);

            this.showTeShuCards(cards);

            //return;
        }

        if (!this._daoLayoutBacks) return;

        this.touLayoutBack.node.parent.active = true;

        this._daoLayoutBacks.forEach((function (nodes, index) {

            nodes.node.active = true;

            nodes.node.children.forEach(function (no) {
                no.active = true;
            });

            this._setCardSpriteFrame(index, nodes.node);

            if (this.TScoreLayout) this.daoTitleNodes[index].active = true;
        }).bind(this));

        if (!this.TScoreLayout) return;

        this.daoScoreLayouts.forEach((function (nodes) {

            nodes.node.active = true;
        }).bind(this));

        this.setScores([this._user.cScore], [this.TScoreLayout], true);

        this.TtitleNode.active = true;

        this.TScoreLayout.node.active = true;
    },

    showBaoDao: function showBaoDao(index, positonY) {
        var cardsInfo = this._cardsInfo;
        var cardType = cardsInfo.map(function (cardInfoItem) {
            return cardInfoItem.type;
        });

        var typeName0 = cardType[index] + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        if (index == 0) typeName0 = typeName0 == '04' ? '11' : typeName0;
        if (index == 1) typeName0 = typeName0 == '07' ? '22' : typeName0;

        if (cardType[index] == 10) typeName0 = '15'; //特殊牌
        if (cardType[index] == 11) typeName0 = '14';
        if (cardType[index] == 12) typeName0 = '16';
        if (cardType[index] == 18) typeName0 = '25';
        if (cardType[index] == 19) typeName0 = '26';

        var path = this._user.isContainExtra ? "game-right_specia" : "game-poker_type";

        this._loadCardFrame(typeName0, (function (spriteFrame) {
            var btnSprites1 = this.baoDao.getComponent(cc.Sprite);
            btnSprites1.spriteFrame = spriteFrame;
        }).bind(this), "play/CardTypeCombine/game_txt", path);
        this.baoDao.y = positonY;
    },

    _loadCardFrame: function _loadCardFrame(cardName, callback) {
        var path = arguments.length <= 2 || arguments[2] === undefined ? "play/CardTypeCombine/pockList" : arguments[2];
        var paths = arguments.length <= 3 || arguments[3] === undefined ? "public-pic-card-poker-" : arguments[3];

        cc.loader.loadRes(path, cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                cc.error(err);
                return;
            }
            cardName = cardName + "";
            cardName = this._cardFullName(cardName, paths);
            var frame = atlas.getSpriteFrame(cardName);
            callback(frame);
        }).bind(this));
    },

    _cardFullName: function _cardFullName(cardShortName, paths) {
        if (!paths) return cardShortName;
        var cardName = cardShortName;
        if (!cardName.startsWith(paths)) {
            cardName = paths + cardName;
        }
        return cardName;
    },

    _clearCards: function _clearCards() {
        this._clearLayoutCards(this.touLayout);
        this._clearLayoutCards(this.zhongLayout);
        this._clearLayoutCards(this.weiLayout);
    },

    _clearLayoutCards: function _clearLayoutCards(layout) {
        this._cardSpritesWithLayout(layout).forEach(function (sprite) {
            sprite.spriteFrame = null;
        });
    },

    _cardSpritesWithLayout: function _cardSpritesWithLayout(layout) {
        var node = layout.node;
        return node.children.map(function (node) {
            return node.getComponent('cc.Sprite');
        });
    },

    _allCardSprites: function _allCardSprites() {
        var touCardSprites = this._cardSpritesWithLayout(this.touLayout);
        var zhongCardSprites = this._cardSpritesWithLayout(this.zhongLayout);
        var weiCardSprites = this._cardSpritesWithLayout(this.weiLayout);
        var result = touCardSprites.concat(zhongCardSprites).concat(weiCardSprites);
        return result;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardResHelper":"KQCardResHelper"}],"Countdown":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6406dyBk8tKVrlJ1+mg7cLt', 'Countdown');
// scripts\Pefabs\Countdown.js

cc.Class({
    "extends": cc.Component,

    properties: {
        labelTime: cc.Label,
        //timeNode: cc.Node,

        _callback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.labelTime.string = "0";
    },

    /**
     * 开始倒计时
     * 
     * @param  {Number} time 时长
     * @param  {Function} callback 倒计时的回调
     */
    startCountdown: function startCountdown(time, callback) {
        this.stop();
        this._callback = callback;

        this.node.active = true;
        this.labelTime.string = "" + time;
        this.schedule(this._countDown, 1, time);
        this.getComponent("time").setTime(time * 0.5);
    },

    stop: function stop() {
        this.unschedule(this._countDown);
        this.node.active = false;

        if (this._callback) {
            var isTimeout = Number(this.labelTime.string) <= 0;
            var callback = this._callback;
            this._callback = null;
            callback(isTimeout);
        }

        this._callback = null;
    },

    _countDown: function _countDown() {
        var time = Number(this.labelTime.string || "0");
        time = time - 1;

        if (time <= 0) {
            this.stop();
        }

        this.labelTime.string = String(time);
    }

});

cc._RFpop();
},{}],1:[function(require,module,exports){
'use strict'

exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function placeHoldersCount (b64) {
  var len = b64.length
  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // the number of equal signs (place holders)
  // if there are two placeholders, than the two characters before it
  // represent one byte
  // if there is only one, then the three characters before it represent 2 bytes
  // this is just a cheap hack to not do indexOf twice
  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0
}

function byteLength (b64) {
  // base64 is 4/3 + up to two characters of the original data
  return b64.length * 3 / 4 - placeHoldersCount(b64)
}

function toByteArray (b64) {
  var i, j, l, tmp, placeHolders, arr
  var len = b64.length
  placeHolders = placeHoldersCount(b64)

  arr = new Arr(len * 3 / 4 - placeHolders)

  // if there are placeholders, only get up to the last complete 4 chars
  l = placeHolders > 0 ? len - 4 : len

  var L = 0

  for (i = 0, j = 0; i < l; i += 4, j += 3) {
    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]
    arr[L++] = (tmp >> 16) & 0xFF
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  if (placeHolders === 2) {
    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[L++] = tmp & 0xFF
  } else if (placeHolders === 1) {
    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var output = ''
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    output += lookup[tmp >> 2]
    output += lookup[(tmp << 4) & 0x3F]
    output += '=='
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])
    output += lookup[tmp >> 10]
    output += lookup[(tmp >> 4) & 0x3F]
    output += lookup[(tmp << 2) & 0x3F]
    output += '='
  }

  parts.push(output)

  return parts.join('')
}

},{}],2:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

'use strict'

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('isarray')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":1,"ieee754":3,"isarray":4}],3:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],4:[function(require,module,exports){
var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};

},{}],"GameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6a3cdd+2shGlZ+jeI3trSsB', 'GameResult');
// scripts\Play\GameResult.js

var KQCard = require('KQCard');
var AudioManager = require('AudioManager');

var ResultStatus = {
  WIN: 2,
  DRAW: 1,
  LOSE: 0
};

var GameResult = cc.Class({
  'extends': cc.Component,

  properties: {
    winNode: cc.Node,
    loseNode: cc.Node,
    drawNode: cc.Node,
    contentNode: cc.Node,

    resultItems: [cc.Node],

    _deskInfo: null,
    _userId: null,
    _closeCallback: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._hideResultItems();
  },

  showResults: function showResults(deskInfo, currentUserId) {
    this._deskInfo = deskInfo;
    this._userId = currentUserId;

    var resultStatus = this._resultStatus();
    this.contentNode.active = true;
    this.winNode.active = resultStatus == ResultStatus.WIN;
    this.drawNode.active = resultStatus == ResultStatus.DRAW;
    this.loseNode.active = resultStatus == ResultStatus.LOSE;

    if (this.winNode.active) {
      AudioManager.instance.playWin();
    } else if (this.loseNode.active) {
      AudioManager.instance.playLose();
    }

    this.node.getComponent('alert').alert();
    this.node.getComponent('alert').setDismissCallback((function () {
      this._closeCallback;
    }).bind(this));

    var playerInfos = deskInfo.players.sort(function (p1, p2) {
      return p2.cScore - p1.cScore;
    });
    var itemComps = this.resultItems.map(function (node) {
      return node.getComponent('ResultItem');
    });
    itemComps.forEach((function (itemComp, index) {
      itemComp.node.active = index < playerInfos.length;
      if (!itemComp.node.active) {
        return;
      }

      var user = playerInfos[index];
      itemComp.updateWithPlayerInfo(user, deskInfo.isRandomDesk);
      var cards = this._cardsFromUser(user);
      itemComp.setCards(cards);
    }).bind(this));
  },

  setCloseCallback: function setCloseCallback(callback) {
    this._closeCallback = callback;
  },

  _cardsFromUser: function _cardsFromUser(user) {
    var cards = user.cardInfo.map(function (cardInfoItem) {
      return KQCard.cardsFromArray(cardInfoItem.cards);
    }).reduce(function (array, subCards) {
      return array.concat(subCards);
    }, []);

    return cards;
  },

  _hideResultItems: function _hideResultItems() {
    this.resultItems.forEach(function (node) {
      node.acitve = false;
    });
  },

  _resultStatus: function _resultStatus() {
    var playerInfos = this._deskInfo.players;
    var user = playerInfos.find((function (user) {
      return user.id == this._userId;
    }).bind(this));

    var score = user.cScore;
    if (this._deskInfo.isRandomDesk) {
      // 如果是随机场的话，应该用钻石来判断输赢
      score = user.diamond;
    }

    if (score > 0) {
      return ResultStatus.WIN;
    } else if (score < 0) {
      return ResultStatus.LOSE;
    }

    return ResultStatus.DRAW;
  }
});

module.exports = GameResult;

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard"}],"GetCardPointsSameCount":[function(require,module,exports){
"use strict";
cc._RFpush(module, '64665arSbVGtqTVZeISv/TD', 'GetCardPointsSameCount');
// scripts\KQCard\GetCardPointsSameCount.js

/*#####*/
//��������һ���������ڵ���ͬ�������Ƶ�����
var GetCardPointsSameCount = function GetCardPointsSameCount(cards) {
    this.cardNumbers = {};
    for (var i in cards) {
        var s;
        if (typeof cards[i].number == 'undefined') {
            s = cards[i].point;
        } else {
            s = cards[i].number;
        }
        if (this.cardNumbers[s]) {
            this.cardNumbers[s]++;
        } else {
            this.cardNumbers[s] = 1;
        }
        //cc.log(this.cardNumbers[cards[i].number])
        //cc.log(cards)
        //cc.log(cards[i].number)
        //cc.log('---7')
    }
    return this.cardNumbers;
};

module.exports = GetCardPointsSameCount;

cc._RFpop();
},{}],"Invit":[function(require,module,exports){
"use strict";
cc._RFpush(module, '37d962bf0NPxaQIYUcZDwR3', 'Invit');
// scripts\Invit.js

var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }
    var isComplete = this._lastEmptyLabel() == null;
    var inviteNumber = this._roomNumber();
    if (inviteNumber.length == 6) {
      this.callbackJoinRoom = inviteNumber;
    }
  },

  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackJoinRoom;
    console.log(inviteNumber, "------------------------");
    if (inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackJoinRoom = ''; //清空邀请码
    }
  },

  clickClear: function clickClear() {
    this.callbackJoinRoom = '';
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"KQCardColorsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf1deKQQ4NMMYVV+7xEr9Jf', 'KQCardColorsHelper');
// scripts\KQCard\KQCardColorsHelper.js

// 牌花色帮助类
// 用于计算一个牌数组的花色相同的牌的张数
var KQCardColorsHelper = function KQCardColorsHelper(cards) {
  this.colorNumber = {};

  cards.forEach((function (card) {
    var color = card.color;
    var number = this.colorNumber[color] || 0;
    this.colorNumber[color] = number + 1;
  }).bind(this));
};

// 相同花色的牌的最大数量
KQCardColorsHelper.prototype.maxNumber = function () {
  var result = 0;
  for (var prop in this.colorNumber) {
    var number = this.colorNumber[prop];
    result = Math.max(number, result);
  }

  return result;
};

module.exports = KQCardColorsHelper;

cc._RFpop();
},{}],"KQCardFindTypeExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '54a95JOLVRACIP91XEFodqF', 'KQCardFindTypeExtension');
// scripts\KQCard\KQCardFindTypeExtension.js

var KQCard = require('KQCard');
var ArrayExtension = require('ArrayExtension');
var KQCardPointsHelper = require('KQCardPointsHelper');

module.exports = {};

// 寻找 cardModes 中的 对子
// 这会返回 对子 的索引数组
// 如：[[1, 3], [4, 5]]
KQCard.findDuiZi = function (cardModes) {
  var sDuiZiIndexs = KQCard.findSanTiao(cardModes) || [];
  var result = KQCard._findPointLength(cardModes, 2) || [];
  if (result.length < 2) {
    if (sDuiZiIndexs.length > 0) {
      sDuiZiIndexs.forEach(function (indexs) {
        var s1 = [indexs[0], indexs[1]];
        //var s2 = [indexs[1],indexs[2]];
        //result.push(s2);
        result.push(s1);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 2);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }

  result = KQCard.repeat(result);

  return result.length > 0 ? result : [];
};

KQCard._findPointLength = function (cardModes, length) {
  if (cardModes.length < length) {
    return [];
  }

  var obj = cardModes.reduce(function (obj, card, index) {
    var pointIndexs = obj[card.point] || [];
    obj[card.point] = pointIndexs;
    pointIndexs.push(index);
    return obj;
  }, {});

  var result = [];
  for (var prop in obj) {
    var pointIndexs = obj[prop];
    // if (pointIndexs.length == length) {
    //   pointIndexs.sort(function (n1, n2) {
    //     return n1 - n2;
    //   });
    //   result.push(pointIndexs);
    // }
    while (pointIndexs.length >= length && length != 0) {
      //有多的分割多个数组
      var splices = pointIndexs.splice(0, length);
      if (splices.length >= length) {
        splices.sort(function (n1, n2) {
          return n1 - n2;
        });
        result.push(splices);
      }
    }
  }

  result.sort(function (arr1, arr2) {
    var n1 = arr1[0];
    var n2 = arr2[0];
    return n2 - n1;
  });
  return result.length > 0 ? result : [];
};

// 找 两对 的索引数组
// 如：[[1, 2, 3, 4], [5, 6, 7, 8]]
KQCard.findLiaDui = function (cardModes) {
  var duiZiIndexs = KQCard.findDuiZi(cardModes) || [];
  var duiZiIndex = KQCard.findGuiPai(cardModes, 2) || [];

  if (duiZiIndexs.length < 1 && duiZiIndex.length > 0) {
    duiZiIndex.forEach(function (indexs) {
      duiZiIndexs.unshift(indexs);
    });
  }
  if (duiZiIndexs.length < 2) {
    return [];
  }

  var result = [];
  for (var i = 0; i < duiZiIndexs.length; ++i) {
    for (var j = i + 1; j < duiZiIndexs.length; ++j) {
      if (result.length < 10) {
        var pre = duiZiIndexs[i];
        var next = duiZiIndexs[j];
        var s = pre.concat(next);
        var newS = [];
        for (var q = 0; q < s.length; q++) {
          if (newS.indexOf(s[q]) == -1) {
            newS.push(s[q]);
          } else {
            break;
          }
        }
        if (newS.length == 4) {
          newS.sort(function (n1, n2) {
            return n1 - n2;
          });
          result.unshift(newS);
        }
      } else {
        break;
      }
    }
  }
  result = KQCard.repeat(result);
  if (result.length > 6) {
    result = result.slice(0, 6);
  }
  return result;
};

// 找三条
// 如：[[1, 2, 3]];
KQCard.findSanTiao = function (cardModes) {
  if (cardModes.length < 3) {
    return [];
  }
  var result = KQCard._findPointLength(cardModes, 3) || [];
  //for(var q =0;q<result.length;q++){
  //  var indexs = result[q][0];
  //  if(cardModes[indexs].point >= 20){
  //    result.splice(q,1);
  //  }
  //}
  if (result.length < 2) {
    var tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray.length > 0) {
      tieZhiIndexsArray.forEach(function (indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        var sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 3);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }
  /*if(result.length < 1){
    // 铁支是包含三条的
    let tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray) {
      tieZhiIndexsArray.forEach(function(indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        let sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
  }*/

  //if(result.length > 10){
  //  result = result.slice(0,10);
  //}

  result = KQCard.repeat(result);
  return result.length > 0 ? result : [];
};

// 找同花顺
/*KQCard.findTongHuaShun = function (cardModes, length = 5) {
  if (cardModes.length < length) {
    return [];
  }
  let result = [];
  var sanShunZi = KQCard.sanShunZi1(cardModes,length);
  if(sanShunZi[0] == null){
    return false;
  }
  for(var i=0;i<sanShunZi[0].length;i++) {
    var s = sanShunZi[0][i];
    if (KQCard.isTongHuaShun(s, length)) {
      result.unshift(sanShunZi[1][i]);

    }
  }
  if(result.length > 0){
    return result
  }else{
    return KQCard.findTongHuaShun1(cardModes);
  }
};*/
KQCard.findTongHuaShun = function (cards) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cards.length < length) {
    return [];
  }
  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= 5) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var start = 0; start + 5 <= s.length; ++start) {
      var subCards = s.slice(start, start + 5);
      if (KQCard.isTongHuaShun(subCards)) {
        (function () {
          var indexs = [];
          subCards.forEach(function (ca) {
            for (var q = 0; q < cards.length; q++) {
              var r = cards[q];
              if (r === ca) {
                indexs.push(q);
                break;
              }
            }
          });
          indexs.sort(Array.sortByPoint);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
      cards.forEach(function (adfs) {
        if (adfs.point == 14) {
          adfs.point = 1;
          adfs.scores = 1;
        }
      });
      return KQCard.findTongHuaShun20(cards);
    }
    return KQCard.findTongHuaShun(convertedCards);
  }
  //return result.length > 0 ? result : null;
};
KQCard.findTongHuaShun20 = function (card) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (card.length < length) {
    return false;
  }
  var card20 = KQCard.contain20(card) || [];
  if (card20.length <= 0) {
    return false;
  }
  var cards = card.kq_excludes(card20);

  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= parseInt(5 - card20.length)) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  //cc.log(colorSum)

  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var j = 1; j <= card20.length; ++j) {
      var num = 5 - j;
      for (var start = 0; start + num <= s.length; ++start) {
        var subCards = s.slice(start, start + num);
        var bool = parseInt(subCards[num - 1]['scores']) - parseInt(subCards[0]['scores']) < 5;
        if (bool) {
          var newCard20;

          (function () {
            var indexs = [];
            newCard20 = card20.slice(0, j);

            subCards = subCards.concat(newCard20);
            subCards.forEach(function (ca) {
              for (var q = 0; q < card.length; q++) {
                var r = card[q];
                if (r === ca) {
                  indexs.push(q);
                  break;
                }
              }
            });
            indexs.sort(Array.sortByNumber);

            result.unshift(indexs);
          })();
        }
      }
    }
  }
  //cc.log(result)
  //cc.log('--------357')
  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(card);
    if (card === convertedCards) {
      return [];
    }
    return KQCard.findTongHuaShun20(convertedCards);
  }
  //return result.length > 0 ? result : null;
};

// 找铁支
// 如：[[1,2,3,4]]
KQCard.findTieZhi = function (cardModes) {
  var result = KQCard._findPointLength(cardModes, 4);
  if (result.length > 0) {
    return result;
  }
  result = [];
  // 五同是包含铁支的
  var wuTongIndexsArray = KQCard.findWuTong(cardModes);
  if (wuTongIndexsArray) {
    wuTongIndexsArray.forEach(function (indexs) {
      var tieZhiIndexs0 = [indexs[0], indexs[1], indexs[2], indexs[3]];
      var tieZhiIndexs1 = [indexs[0], indexs[1], indexs[2], indexs[4]];
      var tieZhiIndexs2 = [indexs[0], indexs[1], indexs[3], indexs[4]];
      var tieZhiIndexs3 = [indexs[0], indexs[2], indexs[3], indexs[4]];
      var tieZhiIndexs4 = [indexs[1], indexs[2], indexs[3], indexs[4]];
      result.push(tieZhiIndexs0);
      result.push(tieZhiIndexs1);
      result.push(tieZhiIndexs2);
      result.push(tieZhiIndexs3);
      result.push(tieZhiIndexs4);
    });
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result);
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 4);
};
//找五同
KQCard.findWuTong = function (cardModes) {
  if (cardModes.length < 5) {
    return [];
  }
  var result = this._findPointLength(cardModes, 5) || [];
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 5);
};
// 找顺子
// 如：[[1, 2, 3, 4, 5]]
KQCard.findShunZi = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  if (typeof cardModes[0]['point'] == "undefined") {
    cardModes = KQCard.cardsFromArray(cardModes);
  }
  // 先根据点数去重
  var uniqueCards = cardModes.unique(function (card1, card2) {
    return card1.point == card2.point;
  });
  uniqueCards.sort(KQCard.sortByPoint);

  // 如果有 A，则在最后添加 14
  var cardA = cardModes.find(function (card) {
    return card.point == 1;
  });
  if (cardA) {
    var cardAPlus = new KQCard(cardA);
    cardAPlus.point = 14;
    uniqueCards.push(cardAPlus);
  }

  var result = [];

  // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
  for (var start = 0; start + length <= uniqueCards.length; ++start) {
    var subCards = uniqueCards.slice(start, start + length);
    if (KQCard.isShunZi(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {

            if (card.point == 14) {
              return originCard.point == 1;
            }

            return card === originCard;
          });
          indexs.push(index);
        });

        indexs.sort(Array.sortByNumber);
        result.unshift(indexs);
      })();
    }
  }

  // 处理点数重复的情况
  // 比如 A A K Q J 10 这种
  var repeatIndexsArray = KQCard._findRepeatPointIndexsArray(result, cardModes);
  repeatIndexsArray.forEach(function (indexs) {
    result.unshift(indexs);
  });

  result.sort(function (arr1, arr2) {
    return arr1[0] - arr2[0];
  });

  return result.length > 0 ? result : KQCard.findShunZi20(cardModes);
};
KQCard.findShunZi20 = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes);
  if (card20.length <= 0) {
    return [];
  }
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  var newArr = [];
  var newArrs = [];
  for (var i = 0; i < cards.length; i++) {
    if (newArrs.indexOf(cards[i]['point']) == -1) {
      newArr.push(cards[i]);
      newArrs.push(cards[i].point);
    }
  }

  newArr.sort(function (n1, n2) {
    return n1.point - n2.point;
  });
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = length - j;
    for (var start = 0; start + num <= newArr.length; ++start) {
      var subCards = newArr.slice(start, start + num);
      var bool = parseInt(subCards[num - 1]['point']) - parseInt(subCards[0]['point']) < length;
      if (bool) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cardModes);
    if (cardModes === convertedCards) {
      return false;
    }
    return KQCard.findShunZi20(convertedCards);
  }
};
KQCard._findRepeatPointIndexsArray = function (indexsArray, originCards) {
  var repeatIndexsArray = [];
  indexsArray.forEach(function (indexs) {
    var cards = indexs.map(function (index) {
      return originCards[index];
    });

    cards.forEach(function (card, index) {
      var originIndex = originCards.findIndex(function (originCard) {
        if (typeof card == 'undefined') {
          return;
        }
        if (originCard !== card && originCard.point == card.point) {
          return true;
        }
        return false;
      });

      if (originIndex < 0) {
        return;
      }

      var repeatIndexs = indexs.slice();
      repeatIndexs[index] = originIndex;
      repeatIndexsArray.push(repeatIndexs);
    });
  });

  return repeatIndexsArray;
};

// 找同花
// 如：[[1, 2, 3, 4, 5]]
KQCard.findTongHua = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }

  var cards = Array.from(cardModes);
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var start = 0; start + length <= cards.length; ++start) {
    var subCards = cards.slice(start, start + length);
    if (KQCard.isTongHua(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {
            return card === originCard;
          });
          indexs.push(index);
        });
        //indexs = indexs.length > 5 ? indexs.splice(1,1) : indexs;
        indexs.sort(Array.sortByNumber);
        result.unshift(indexs);
      })();
    }
  }
  return result.length > 0 ? result : KQCard.findTongHua20(cardModes);
};
KQCard.findTongHua20 = function (cardModes) {
  if (cardModes.length < 5) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes);
  if (card20.length <= 0) {
    return [];
  }
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = 5 - j;
    for (var start = 0; start + num <= cards.length; ++start) {
      var subCards = cards.slice(start, start + num);
      if (KQCard.isTongHua(subCards, num)) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  return result.length > 0 ? result : [];
};

KQCard.findHuLu = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }

  var p_3 = KQCard.findSanTiao(cardModes);
  var p_4 = KQCard.findTieZhi(cardModes);
  var p2 = KQCard.findDuiZi(cardModes) || [];
  //var p_3 =  this._findPointLength(cardModes, 3) || [];
  //var p_4 = this._findPointLength(cardModes, 4) || [];
  //var p2 = this._findPointLength(cardModes, 2) || [];
  if (p2.length <= 0) {
    if (p_3) {
      p_3.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        var sanTiaoIndexs3 = [indexs[1], indexs[2]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        p2.push(sanTiaoIndexs3);
      });
    }

    if (p_4) {
      p_4.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[1], indexs[2]];
        //let sanTiaoIndexs4 = [indexs[1], indexs[3]];
        var sanTiaoIndexs6 = [indexs[2], indexs[3]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        //p2.unshift(sanTiaoIndexs2);
        //p2.unshift(sanTiaoIndexs3);
        //p2.unshift(sanTiaoIndexs4);
        p2.push(sanTiaoIndexs6);
      });
    }
  }

  if (p2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.unshift(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : KQCard.findHuLu20(cardModes);
};
KQCard.findHuLu20 = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes) || [];
  if (card20.length <= 0) {
    return [];
  }
  var p_3 = KQCard.findGuiPai(cardModes, 3);
  var p_4 = KQCard.findGuiPai(cardModes, 4);
  var p_2 = KQCard.findGuiPai(cardModes, 2);
  if (p_2 == null) {
    p_2 = [];
  }
  if (p_3) {
    p_3.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs3 = [indexs[1], indexs[2]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs3);
    });
  }

  if (p_4) {
    p_4.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs6 = [indexs[2], indexs[3]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs6);
    });
  }

  if (p_2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p_2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.unshift(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : [];
};

KQCard.findGuiPai = function (cardModes) {
  var numBer = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

  var card20 = KQCard.contain20(cardModes).map(function (card) {
    //得到鬼牌的索引
    for (var q = 0; q < cardModes.length; q++) {
      var r = cardModes[q];
      if (r === card) {
        return q;
      }
    }
  });
  if (card20.length <= 0) {
    return [];
  }
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = numBer - j; //除鬼牌外 我应该找多少张牌匹配
    var indexs = KQCard._findPointLength(cardModes, num) || [];
    for (var t = 0; t < indexs.length; t++) {
      if (numBer == 2) {
        //是对子的时候把鬼牌和单张匹配都循环一遍
        for (var o = 0; o < card20.length; ++o) {
          var s = indexs[t].concat(card20[o]);
          if (s.length == numBer) {
            result.push(s);
          }
        }
      } else {
        var s = indexs[t].concat(card20.slice(0, j)); //依次相加鬼牌第一次加一张 递增
        if (s.length == numBer) {
          result.push(s);
        }
      }
    }
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result); //去重
  return result.length > 0 ? result : [];
};

KQCard.repeat = function (result) {
  for (var i = 0; i < result.length; i++) {
    var index = result[i];

    var newAyy = [];
    for (var o = 0; o < index.length; o++) {
      //有重复干掉你
      if (newAyy.indexOf(index[o]) == -1) {
        newAyy.push(index[o]);
      } else {
        result.splice(i, 1);
        break;
      }
    }

    for (var j = i + 1; j < result.length - 1; j++) {
      var s = result[j];
      var jString = '';
      var iString = '';
      for (var r = 0; r < s.length; r++) {
        jString = jString + s[r];
        iString = iString + index[r];
      }
      if (jString == iString) {
        //有重复干掉你
        result.splice(i, 1);
        break;
      }
    }
  }
  return result;
};

KQCard.testFind = function (cardModes) {
  var WuTong = KQCard.findWuTong(cardModes) || [];
  var TongHuaShun = KQCard.findTongHuaShun(cardModes) || [];
  var TieZhi = KQCard.findTieZhi(cardModes) || [];
  var HuLu = KQCard.findHuLu(cardModes) || [];
  var TongHua = KQCard.findTongHua(cardModes) || [];
  var ShunZi = KQCard.findShunZi(cardModes) || [];
  var SanTiao = KQCard.findSanTiao(cardModes) || [];
  var LiaDui = KQCard.findLiaDui(cardModes) || [];
  var DuiZi = KQCard.findDuiZi(cardModes) || [];
  var result = [WuTong, TongHuaShun, TieZhi, HuLu, TongHua, ShunZi, SanTiao, LiaDui, DuiZi];
  return result;
};

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","KQCard":"KQCard","KQCardPointsHelper":"KQCardPointsHelper"}],"KQCardPointsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '42d3e866XhHdbkspy3Qytap', 'KQCardPointsHelper');
// scripts\KQCard\KQCardPointsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardPointsHelper = function KQCardPointsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.point;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardPointsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardPointsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardResHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'be420vtWaJOHoxQcZwP2xN2', 'KQCardResHelper');
// scripts\KQCard\KQCardResHelper.js

var Helper = {
  loadCardSpriteFrame: function loadCardSpriteFrame(cardName, callback) {
    this._loadCardFrame(cardName, callback);
  },

  setCardSpriteFrame: function setCardSpriteFrame(sprite, cardName) {
    this.loadCardSpriteFrame(cardName, function (spriteFrame) {
      sprite.spriteFrame = spriteFrame;
    });
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        callback(null, err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
};

module.exports = Helper;

cc._RFpop();
},{}],"KQCardScoreExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3f5d8wDA+tMPbPd/k4hBAAR', 'KQCardScoreExtension');
// scripts\KQCard\KQCardScoreExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardScoretsHelper = require('KQCardScoretsHelper');
var GetCardPointsSameCount = require('GetCardPointsSameCount');
var KQCardPointsHelper = require('KQCardPointsHelper');

KQCard.scoreOfCards = function (cards) {
  if (cards == null || cards.length == null) {
    cards = [];
  }

  var isTou = cards.length == 3;
  var typeScore = KQCard._typeScoreOfCards(cards);
  var caleCards = KQCard._convertOneToA(cards.slice());
  caleCards.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  //caleCards = KQCard.Sort(caleCards);
  var card20 = KQCard.contain20(caleCards);
  var pointHelper = new KQCardScoretsHelper(caleCards.kq_excludes(card20));
  var maxNum = pointHelper.maxNumber() /*-card20.length == 0 ? 1: pointHelper.maxNumber()-card20.length*/;

  var maxScore = 0; //获取除鬼牌外最大的的点数
  for (var i in pointHelper.pointNumbers) {
    if (parseInt(i) > maxScore && pointHelper.pointNumbers[i] == maxNum) {
      maxScore = parseInt(i);
    }
  }
  caleCards.forEach(function (card) {
    if (card.scores >= 20) {
      card.scores = maxScore;
    }
  });
  card20.forEach(function (card) {
    card.scores = maxScore;
  });
  //cc.log(maxNum)
  //cc.log(maxScore)
  //cc.log(caleCards.kq_excludes(card20))
  //cc.log('----35')
  caleCards.sort(KQCard.sort);
  if (typeScore == 9000000000000000) {
    //五同
    caleCards.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var totalValue = "";
    //var totalColor = "";
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      //var c = caleCards[i].color;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      //totalColor = c+totalColor;
    }
    //totalValue = totalValue+totalColor;
    //cc.log(totalValue)
    //cc.log(parseInt(totalValue))
    //cc.log(typeScore+parseInt(totalValue))
    return typeScore + parseInt(totalValue);
  } else if (typeScore == 8000000000000000) {
    //同花顺比最大的那张，如果两张相同那就是相同
    if (card20.length > 0) {
      //有鬼牌的时候要改变鬼牌的分数
      caleCards = KQCard._changeCardScors(caleCards);
    }
    var totalValue = "";
    var valueColor = ""; //牌色
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      var c = caleCards[i].color; //牌色
      valueColor = c + valueColor; //牌色
    }
    if (cc.huaSe == 0) return typeScore + parseInt(totalValue);
    return typeScore + parseInt(totalValue + valueColor);
  } else if (typeScore == 7000000000000000) {
    //铁支,找出那四张是什么牌

    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }
    //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
    //var qwe = '';
    //qwe = oneValueColor.substr(0,oneValueColor.length -1);
    //oneValueColor = oneValueColor.substr(oneValueColor.length -1);
    //str = str+oneValue + oneValueColor + valueColor + qwe;
    //return typeScore+parseInt(str);
    return typeScore + parseInt(str + oneValue);
  } else if (typeScore == 6000000000000000) {
    //葫芦
    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }

    if (isTou) {
      oneValue = oneValue + '0000';
      oneValueColor = oneValueColor + '00';
    }
    return typeScore + parseInt(str + oneValue);
    //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
    //str = str+oneValue + valueColor + oneValueColor;
    //return typeScore+parseInt(str);
  } else if (typeScore == 5000000000000000) {
      //同花,有可能需要比5张牌
      var totalScore = "";
      var totalColor = "";
      //var colors = 0;//获取牌的类型颜色
      //for(var i in caleCards) {
      //  if(parseInt(caleCards[i].point) < 20){
      //    colors = parseInt(caleCards[i].color);
      //    break;
      //  }
      //}

      for (var i in caleCards) {
        var paiPoint = parseInt(caleCards[i].point);
        var colors = parseInt(caleCards[i].point) < 20 ? caleCards[i].color : 5;
        totalColor = colors + totalColor;
        totalScore = (paiPoint >= 10 ? paiPoint : "0" + paiPoint) + totalScore;
      }
      return typeScore + parseInt(totalScore);
      //if(cc.huaSe == 0) return typeScore+parseInt(totalScore);
      //return typeScore+parseInt(totalScore+totalColor);
    } else if (typeScore == 4000000000000000) {
        //顺子
        if (card20.length > 0) {
          //有鬼牌的时候要改变鬼牌的分数
          caleCards = KQCard._changeCardScors(caleCards);
        }
        var totalValue = "";
        var valueColor = ""; //牌色
        for (var i in caleCards) {
          var s = caleCards[i].scores;
          totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;

          var c = caleCards[i].color; //牌色
          valueColor = c + valueColor; //牌色
        }
        return typeScore + parseInt(totalValue);
        //if(cc.huaSe == 0) return typeScore+parseInt(totalValue);
        //return typeScore+parseInt(totalValue + valueColor);
      } else if (typeScore == 3000000000000000) {
          //三条，找出是哪张牌有3张
          //caleCards.sort(KQCard.sort);
          var str = "";
          var oneValue = "";
          var valueColor = ""; //牌色
          var oneValueColor = ""; //牌色
          var oneValueColor20 = ""; //牌色
          for (var w in caleCards) {
            if (maxScore == caleCards[w].scores) {
              //三条
              var s = caleCards[w].scores;
              str = (parseInt(s) >= 10 ? s : "0" + s) + str;

              var c = caleCards[w].color; //牌色
              valueColor = c + valueColor; //牌色
            } else {
                var s = caleCards[w].scores;
                oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

                var c = caleCards[w].color; //牌色
                if (parseInt(s) < 20) {
                  oneValueColor = c + oneValueColor; //牌色
                } else {
                    oneValueColor20 = c + oneValueColor20; //牌色
                  }
              }
          }
          if (isTou) {
            oneValue = oneValue + '0000';
            valueColor = valueColor + '00';
          }
          return typeScore + parseInt(str + oneValue);
          //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
          //str = str+oneValue + oneValueColor + valueColor + oneValueColor20;
          //return typeScore+parseInt(str);
        } else if (typeScore == 2000000000000000) {
            //caleCards.sort(KQCard.sort);
            //两对,有可能需要比5张牌
            var str = "";
            var oneValue = '';
            var valueColor = ""; //牌色
            var oneValueColor = ""; //牌色
            for (var i in pointHelper.pointNumbers) {
              if (pointHelper.pointNumbers[i] == 2) {
                //两对
                for (var w in caleCards) {
                  if (i == caleCards[w].scores) {
                    var s = caleCards[w].scores;
                    str = (parseInt(s) >= 10 ? s : "0" + s) + str;
                    var c = caleCards[w].color; //牌色
                    valueColor = c + valueColor; //牌色
                  }
                }
              } else {
                  for (var q in caleCards) {
                    //单张加花色
                    if (i == caleCards[q].scores) {
                      var s = caleCards[q].scores;
                      oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

                      var c = caleCards[q].color; //牌色
                      oneValueColor = oneValueColor + c; //牌色
                    }
                  }
                }
            }
            return typeScore + parseInt(str + oneValue);
            //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
            ////cc.log(str)
            ////cc.log(oneValue)
            //str = str+oneValue +oneValueColor + valueColor;
            //return typeScore+parseInt(str);
          } else if (typeScore == 1000000000000000) {
              //对子
              //caleCards.sort(KQCard.sort);
              var str = "";
              var oneValue = "";
              var oneValueColor = "";
              var valueColor = "";

              if (card20.length > 0) {
                caleCards.sort(function (card1, card2) {
                  return card2.point - card1.point;
                });
                caleCards = caleCards.kq_excludes(card20);
                caleCards.forEach(function (card, index) {
                  var s = card.scores;
                  var c = card.color;
                  str = str + (parseInt(s) >= 10 ? s : "0" + s);
                  if (index == 0) {
                    var s20 = card20[0].scores;
                    str = str + (parseInt(s20) >= 10 ? s20 : "0" + s20);
                    valueColor = valueColor + c;
                    valueColor = valueColor + card20[0].color;
                  } else {
                    oneValueColor = oneValueColor + c;
                  }
                });
                //cc.log(str)
                //cc.log('--------274')
                if (isTou) {
                  str = str + '0000';
                  valueColor = valueColor + '00';
                }
                return typeScore + parseInt(str);
                //if(cc.huaSe == 0) return typeScore+parseInt(str);
                //str = str + oneValueColor + valueColor;
                //return typeScore+parseInt(str);
              }

              for (var i in pointHelper.pointNumbers) {
                if (pointHelper.pointNumbers[i] == maxNum) {
                  //对子
                  for (var w in caleCards) {
                    //对子加花色
                    if (i == caleCards[w].scores) {
                      var s = caleCards[w].scores;
                      valueColor = caleCards[w].color + valueColor;
                      str = (parseInt(s) >= 10 ? s : "0" + s) + str;
                    }
                  }
                } else {
                  for (var q in caleCards) {
                    //单张加花色
                    if (i == caleCards[q].scores) {
                      var s = caleCards[q].scores;
                      oneValueColor = caleCards[q].color + oneValueColor;
                      oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;
                    }
                  }
                }
              }
              if (isTou) {
                oneValue = oneValue + '0000';
                valueColor = valueColor + '00';
              }
              return typeScore + parseInt(str + oneValue);
              //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
              //str = str+oneValue+oneValueColor+valueColor;
              //return typeScore+parseInt(str);
            } else if (typeScore == 0) {
                //乌龙
                var valuePoint = "";
                var valueColor = "";
                for (var q in caleCards) {
                  var s = caleCards[q].scores;
                  var c = caleCards[q].color; //单张加花色
                  valuePoint = (parseInt(s) >= 10 ? s : "0" + s) + valuePoint;
                  valueColor = c + valueColor;
                }
                if (isTou) {
                  valuePoint = valuePoint + '0000';
                  valueColor = valueColor + '00';
                }
                return typeScore + parseInt(valuePoint);
                //if(cc.huaSe == 0) return typeScore+parseInt(valuePoint);
                //valuePoint = valuePoint + valueColor;
                //return typeScore+parseInt(valuePoint);
              }

  var cardsTotalPoint = 0;
  caleCards.forEach(function (card) {
    cardsTotalPoint += card.point;
  });

  var result = typeScore + cardsTotalPoint;
  return result;
};
KQCard._changeCardScors = function (cardModel) {
  cardModel.forEach(function (card) {
    card.scores = card.point;
    if (card.scores == 1) {
      card.scores = 14;
    }
  });

  var is14 = true; //是 k q j 10 A;
  var is1 = true; //是1 2 3 4 5

  cardModel.forEach(function (card) {
    if (card.scores < 10) {
      is14 = false; //不是 k q j 10 A;
    }
  });
  cardModel.forEach(function (card) {
    card.scores = card.point;
    if (card.scores == 14) {
      card.scores = 1;
    }
  });
  cardModel.forEach(function (card) {
    if (card.scores > 5 && card.scores != 20) {
      is1 = false; //不是1 2 3 4 5
    }
  });

  if (is14) {
    //是 k q j 10 A;
    cardModel.forEach(function (card) {
      if (card.scores == 1) {
        card.scores = 14;
      }
    });

    cardModel.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var num = 14;
    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      scoresAyy.push(num);
      num -= 1;
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    //cc.log('----------是 k q j 10 A',scoresAyy)
    cardModel.forEach((function (card) {
      //找出选中的牌
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  } else if (is1) {
    //是1 2 3 4 5
    cardModel.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var num = 5;
    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      scoresAyy.push(num);
      num -= 1;
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    //cc.log('----------是1 2 3 4 5')
    cardModel.forEach((function (card) {
      //找出选中的牌
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  } else {
    cardModel.sort(function (a1, a2) {
      return a1.scores - a2.scores;
    });
    var scoresAyy = []; //用来装鬼牌分数
    for (var i = 0; i < 5; i++) {
      var s = parseInt(cardModel[0].scores) + i; //最小的牌的分数
      scoresAyy.push(s); //一副牌的分数
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    cardModel.forEach((function (card) {
      //改变牌的分数
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  }

  cardModel.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  cardModel.sort(function (a1, a2) {
    return a1.scores - a2.scores;
  });
  return cardModel;
};
/*#####*/

KQCard._typeScoreOfCards = function (cards) {
  var typeScore = 0;
  if (KQCard.containWuTong(cards)) {
    typeScore = 9000000000000000;
  } else if (KQCard.containTongHuaShun(cards)) {
    typeScore = 8000000000000000;
  } else if (KQCard.containTieZhi(cards)) {
    typeScore = 7000000000000000;
  } else if (KQCard.containHuLu(cards)) {
    typeScore = 6000000000000000;
  } else if (KQCard.containTongHua(cards)) {
    typeScore = 5000000000000000;
  } else if (KQCard.containShunZi(cards)) {
    typeScore = 4000000000000000;
  } else if (KQCard.containSanTiao(cards)) {
    typeScore = 3000000000000000;
  } else if (KQCard.containLiaDui(cards)) {
    typeScore = 2000000000000000;
  } else if (KQCard.containDuiZi(cards)) {
    typeScore = 1000000000000000;
  }

  return typeScore;
};
/*
 // 根据牌型进行排序
 KQCard._typeCardsSort = function (cards) {
 if ((cards == null) || (cards.length == 0)) {
 return cards;
 }
 if(KQCard.containWuTong(cards)){
 return KQCard._typeCardsSortWutong(cards);
 } else if (KQCard.containTongHuaShun(cards)) {
 return KQCard._typeCardsSortShunZi(cards);
 } else if (KQCard.containTieZhi(cards)) {
 return KQCard._typeCardsSortTieZhi(cards);
 } else if (KQCard.containHuLu(cards)) {
 return KQCard._typeCardsSortHuLu(cards);
 } else if (KQCard.containTongHua(cards)) {
 return KQCard._typeCardsSortTongHua(cards);
 } else if (KQCard.containShunZi(cards)) {
 return KQCard._typeCardsSortShunZi(cards);
 } else if (KQCard.containSanTiao(cards)) {
 return KQCard._typeCardsSortSanTiao(cards);
 } else if (KQCard.containLiaDui(cards)) {
 return KQCard._typeCardsSortLiangDui(cards);
 } else if (KQCard.containDuiZi(cards)) {
 return KQCard._typeCardsSortDuiZi(cards);
 }

 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortShunZi = function (cards) {
 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortTieZhi = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 /!*#####*!/
 KQCard._typeCardsSortWutong = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };
 /!*#####*!/

 KQCard._typeCardsSortHuLu = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortTongHua = function (cards) {
 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortSanTiao = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortLiangDui = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortDuiZi = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };
 */
KQCard._typeCardsSortByNumberOfPoints = function (cards) {

  cards = KQCard._changeGuiCard(cards);

  cards.forEach(function (i) {
    if (i.scores == 1) i.scores = 14;
  });

  var pointHelper = new KQCardScoretsHelper(cards);
  var newCards = cards.slice().sort(function (card1, card2) {
    var numberOfCard1 = pointHelper.pointNumbers[card1.scores];
    var numberOfCard2 = pointHelper.pointNumbers[card2.scores];

    if (numberOfCard2 != numberOfCard1) {
      return numberOfCard2 - numberOfCard1;
    }
    var scores1 = card1.scores == 1 ? 14 : card1.scores;
    var scores2 = card2.scores == 1 ? 14 : card2.scores;
    return scores2 - scores1;
    //return card2.scores - card1.scores;
  });
  newCards.forEach(function (i) {
    if (i.scores == 14) i.scores = 1;
  });
  return newCards /*.concat(card20)*/;
};

KQCard._typeCardsSortByNumberOfPoints1 = function (cards) {

  cards = KQCard._changeGuiCard(cards);

  cards.forEach(function (i) {
    if (i.scores == 1) i.scores = 14;
  });

  var pointHelper = new KQCardScoretsHelper(cards);
  var newCards = cards.slice().sort(function (card1, card2) {
    var numberOfCard1 = pointHelper.pointNumbers[card1.scores];
    var numberOfCard2 = pointHelper.pointNumbers[card2.scores];

    if (numberOfCard2 != numberOfCard1) {
      return numberOfCard1 - numberOfCard2;
    }
    var scores1 = card1.scores == 1 ? 14 : card1.scores;
    var scores2 = card2.scores == 1 ? 14 : card2.scores;
    return scores1 - scores2;
    //return card1.scores - card2.scores;
  });
  newCards.forEach(function (i) {
    if (i.scores == 14) i.scores = 1;
  });
  return newCards;
};

KQCard._changeGuiCard = function (cards) {

  var card20 = KQCard.contain20(cards);

  var ca = cards.kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var type = KQCard.cardsType(cards) + 1;

  type = type >= 10 ? type : "0" + type;

  if (type == "05" || type == "09") {

    return KQCard._changeCardScors(cards);
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }
    color = ca[0].color;

    so = so == 14 ? 1 : so;

    card20.forEach(function (n) {

      n.scores = so;

      n.colorScores = color;
    });
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    card20.forEach((function (n) {

      n.scores = so;

      n.colorScores = color;
    }).bind(this));
  }

  return card20.concat(ca);
};

KQCard._setGuiCard = function (index, start, end, type, cards, nodes, cardSpriteAtlas) {
  //cc.log(cardSpriteAtlas)
  //cc.log('-----593')
  var card20 = KQCard.contain20(cards[index]);

  var ca = cards[index].kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var node = nodes.slice(start, end).filter(function (n) {

    if (n.childrenCount > 0 && n.children[0].cardName) {

      if (parseInt(n.children[0].cardName.split("_")[1]) == 20) return true;
    }
  });

  if (type == "05" || type == "09") {

    cards[index] = KQCard._changeCardScors(cards[index]);

    so = cards[index].filter(function (i) {
      if (i.point == 20) return true;
    }).map(function (i) {
      return i.scores == 14 ? 1 : i.scores;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = ca[0].color + "_" + so.splice(0, 1)[0];

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    color = ca[0].color;

    so = so == 14 ? 1 : so;

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
};

KQCard._setGuiCards = function (type, cards, nodes, cardSpriteAtlas) {
  //cc.log(cardSpriteAtlas)
  //cc.log('-----593')
  var card20 = KQCard.contain20(cards);

  var ca = cards.kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var node = nodes.slice().filter(function (n) {

    if (n.childrenCount > 0 && n.children[0].cardName) {

      if (parseInt(n.children[0].cardName.split("_")[1]) == 20) return true;
    }
  });

  if (type == "05" || type == "09") {

    cards = KQCard._changeCardScors(cards);

    so = cards.filter(function (i) {
      if (i.point == 20) return true;
    }).map(function (i) {
      return i.scores == 14 ? 1 : i.scores;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = ca[0].color + "_" + so.splice(0, 1)[0];

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    color = ca[0].color;

    so = so == 14 ? 1 : so;

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
};

KQCard._loadCardFrame = function (SpriteFrame, path, SpritesNode, w, h) {
  //cc.log(SpriteFrame)
  //cc.log('---769')
  var Sprite = SpriteFrame.getSpriteFrame(path);

  SpritesNode.spriteFrame = Sprite;

  if (w) SpritesNode.node.width = w;

  if (h) SpritesNode.node.height = h;
};

KQCard.testScore = function () {};

cc._RFpop();
},{"GetCardPointsSameCount":"GetCardPointsSameCount","KQCard":"KQCard","KQCardColorsHelper":"KQCardColorsHelper","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardPointsHelper":"KQCardPointsHelper","KQCardScoretsHelper":"KQCardScoretsHelper"}],"KQCardScoretsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3d3b5YPHXhN44h/B0miZFRE', 'KQCardScoretsHelper');
// scripts\KQCard\KQCardScoretsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardScoretsHelper = function KQCardScoretsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.scores;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardScoretsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardScoretsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardSelectExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '66642YNpFVIzb+JM2CkwEgS', 'KQCardSelectExtension');
// scripts\KQCard\KQCardSelectExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');

// 牌自动选择的扩展

/**
 * 自动选择牌，由大到小
 *
 * @param  {[KQCard]} originCards  被选择的原始牌数组
 *
 * @return {[KQCard]}
 */
KQCard.autoSelectCards = function (originCards, maxLength) {
    if (originCards.length <= maxLength) {
        return originCards;
    }
    originCards.forEach(function (card) {
        if (card.scores == 1) {
            card.scores = 14;
        }
    });
    var cards = originCards.slice().sort(function (a, b) {
        return a.scores - b.scores;
    });

    var findFuncs = [KQCard.findWuTong, KQCard.findTongHuaShun, KQCard.findTieZhi, KQCard.findHuLu, KQCard.findTongHua, KQCard.findShunZi, KQCard.findSanTiao, KQCard.findLiaDui, KQCard.findDuiZi];

    var indexArrays = null;
    for (var i = 0; i < findFuncs.length; ++i) {
        var func = findFuncs[i];
        indexArrays = func.bind(KQCard)(cards);
        if (indexArrays && indexArrays.length > 0) {
            break;
        }
    }

    var indexs = [];
    if (indexArrays && indexArrays.length > 0) {
        // 找出同类型的牌里的分数最大的牌
        var maxScore = 0;
        indexArrays.forEach(function (tempIndexs) {
            var tempCards = tempIndexs.map(function (index) {
                return cards[index];
            });
            var score = KQCard.scoreOfCards(tempCards);
            if (score > maxScore) {
                maxScore = score;
                indexs = tempIndexs;
            }
        });
    }

    var targetCards = indexs.map(function (index) {
        return cards[index];
    });

    /*if (targetCards.length < maxLength) {
     cards = cards.kq_excludes(targetCards);
     while(targetCards.length < maxLength) {
     targetCards.push(cards.pop());
     }
     } else */if (targetCards.length > maxLength) {
        targetCards = targetCards.slice(0, maxLength);
    }

    return targetCards || [];
};

KQCard.testAutoSelect = function (cards) {};

cc._RFpop();
},{"KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension"}],"KQCard":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c548c0gMf5BGIH4309MULw+', 'KQCard');
// scripts\KQCard\KQCard.js

var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardPointsHelper = require('KQCardPointsHelper');
var NumberExtension = require('NumberExtension');
var GetCardPointsSameCount = require('GetCardPointsSameCount');

cc = cc || {};
cc.assert = cc.assert || console.assert || function () {};
cc.log = cc.log || console.log || function () {};
cc.error = cc.error || console.error || function () {};

// 牌 Model 类，封装了花色和点数
// 使用：
// new KQCard(22);
var KQCard = function KQCard(point, color, index) {
    this.color = null;
    this.point = null;
    this.sindex = index;
    this._initWithColorAndPoint = function (color, point) {
        if (color == 's') {
            color = 4;
        }
        if (color == 'h') {
            color = 3;
        }
        if (color == 'c') {
            color = 2;
        }
        if (color == 'd') {
            color = 1;
        }

        this.point = Number(point);
        this.scores = Number(point);
        this.color = Number(color);
        this.colorScores = Number(color);

        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithNumber = function (number) {
        this.point = Math.floor(number / 10);
        this.color = number % 10;
        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithObject = function (object) {
        if (object.point) {
            this._initWithColorAndPoint(object.color, object.point);
        } else if (object.suit) {
            this._initWithColorAndPoint(object.suit, object.number);
        }
    };

    this.description = function () {
        return this.cardName();
    };

    this.cardName = function () {
        return this.color + "_" + this.point;
    };

    this.sort = function (otherCard) {
        var asc = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var AisMax = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

        return KQCard.sort(this, otherCard, asc, AisMax);
    };

    this.isEqual = function (otherCard) {
        if (!otherCard) {
            return false;
        }
        return this.point == otherCard.point && this.color == otherCard.color && this.sindex == otherCard.sindex;
    };

    if (point && color) {
        this._initWithColorAndPoint(color, point);
        return;
    }

    var number = Number(point);
    if (!Number.isNaN(number)) {
        this._initWithNumber(number);
        return;
    }

    if (typeof point == 'string') {
        // 解析 xxxxd_d 形式
        var found = point.match(/(\.)*\d_\d+/);
        if (found instanceof Array && found.length > 0) {
            var result = found[0];
            var numbers = result.split('_');

            var _color = Number(numbers[0]);
            var _point = Number(numbers[1]);

            this._initWithColorAndPoint(_color, _point);
        }

        return;
    }

    if (typeof point == 'object') {
        this._initWithObject(point);
        return;
    }

    cc.error("初始化错误：" + point + " " + color);
};

// 转换成服务器的牌 model
KQCard.prototype.toServerCard = function () {
    return {
        'suit': this.color,
        'number': this.point
    };
};

KQCard.COLOR_SPADE = 4;
KQCard.COLOR_HEART = 3;
KQCard.COLOR_CLUB = 2;
KQCard.COLOR_DIAMOND = 1;

module.exports = KQCard;

KQCard.cardsFromArray = function (cardNames) {
    return cardNames.map(function (cardName, index) {
        return new KQCard(cardName, null, index);
    });
};

// 将多张牌转换成服务器的形式
KQCard.convertToServerCards = function (cards) {
    return cards.map(function (card) {
        return card.toServerCard();
    });
};

KQCard.TYPE = {
    WuLong: 0,
    DuiZi: 1,
    LiangDui: 2,
    SanTiao: 3,
    ShunZi: 4,
    TongHua: 5,
    HuLu: 6,
    TieZhi: 7,
    TongHuaShun: 8,
    /*#####*/
    WuTong: 9,
    /*#####*/
    SanTaoHua: 10, // 特殊牌
    SanShunZi: 11,
    LiuDuiBan: 12,

    WuDuiSanTiao: 13,
    SiTaoSanTiao: 14,

    CouYiSe: 15,
    SanFenTianXia: 16,
    SanTongHuaShun: 17,
    YiTiaoLong: 18,
    QingLong: 19
};

// 牌类型名
KQCard.cardsTypeName = function (cards) {
    var names = ['乌龙', '对子', '两对', '三条', '顺子', '同花', '葫芦', '铁支', '同花顺', '五同', '三同花', '三顺子', '六对半', '五对三条', '四套三条', '凑一色', '三分天下', '三同花顺', '一条龙', '清龙'];
    var type = KQCard.cardsType(cards);
    return names[type];
};

// 找出牌的类型
KQCard.cardsType = function (cards) {
    if (KQCard.isQingLong(cards)) {
        return KQCard.TYPE.QingLong;
    }

    if (KQCard.isYiTiaoLong(cards)) {
        return KQCard.TYPE.YiTiaoLong;
    }

    //if (KQCard.isSanTongHuaShun(cards)) {
    //    return KQCard.TYPE.SanTongHuaShun;
    //}
    //
    //if (KQCard.isSanFenTianXia(cards)) {
    //    return KQCard.TYPE.SanFenTianXia;
    //}

    if (KQCard.isLiuDuiBan(cards)) {
        return KQCard.TYPE.LiuDuiBan;
    }

    if (KQCard.isSanTongHua(cards)) {
        return KQCard.TYPE.SanTaoHua;
    }

    if (KQCard.isSanShunZi(cards)) {
        return KQCard.TYPE.SanShunZi;
    }

    //if (KQCard.isCouYiSe(cards)) {
    //    return KQCard.TYPE.CouYiSe;
    //}
    //
    //if (KQCard.isWuDuiSanTiao(cards)) {
    //    return KQCard.TYPE.WuDuiSanTiao;
    //}
    //
    //if (KQCard.isSiTaoSanTiao(cards)) {
    //    return KQCard.TYPE.SiTaoSanTiao;
    //}

    /*#####*/
    if (KQCard.containWuTong(cards, 5)) {
        return KQCard.TYPE.WuTong;
    }

    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    //
    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    /*#####*/

    if (KQCard.containTongHuaShun(cards, 5)) {
        return KQCard.TYPE.TongHuaShun;
    }

    if (KQCard.containTieZhi(cards)) {
        return KQCard.TYPE.TieZhi;
    }

    if (KQCard.containHuLu(cards)) {
        return KQCard.TYPE.HuLu;
    }

    if (KQCard.containTongHua(cards)) {
        return KQCard.TYPE.TongHua;
    }

    if (KQCard.containShunZi(cards)) {
        return KQCard.TYPE.ShunZi;
    }

    if (KQCard.containSanTiao(cards)) {
        return KQCard.TYPE.SanTiao;
    }

    if (KQCard.containLiaDui(cards)) {
        return KQCard.TYPE.LiangDui;
    }

    if (KQCard.containDuiZi(cards)) {
        return KQCard.TYPE.DuiZi;
    }

    return KQCard.TYPE.WuLong;
};

// 判断是否是同花
KQCard.isTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    var colors = cards.map(function (card) {
        return card.color;
    });

    var color = colors[0];
    for (var index in colors) {
        var e = colors[index];
        if (e != color) {
            return false;
        }
    }
    return true;
};

// 是否包含同花
KQCard.containTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    //if (KQCard.findTongHua(cards).length > 0) {
    //    return true;
    //}
    //return false;
    cards = Array.from(cards);
    cards.sort(KQCard.sortByColor);

    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    minLength = minLength - card20.length;

    for (var start = 0; start + minLength <= cards.length; ++start) {
        var subCards = cards.slice(start, start + minLength);
        if (KQCard.isTongHua(subCards, minLength)) {
            return true;
        }
    }

    //return KQCard.containTongHua20(cards);
};
KQCard.containTongHua20 = function (card) {
    if (card.length < 5) {
        return false;
    }
    var card20 = KQCard.contain20(card);
    var cards = card.kq_excludes(card20);
    cards.sort(KQCard.sortByColor);

    for (var j = 1; j <= card20.length; ++j) {
        var num = 5 - j;
        for (var start = 0; start + num <= cards.length; ++start) {
            var subCards = cards.slice(start, start + num);
            if (KQCard.isTongHua(subCards, num)) {
                return true;
            }
        }
    }
    return false;
};
// 判断是否是顺子
KQCard.isShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    if (KQCard._isShunZiAKQ(cards)) {
        return true;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });

    var point = points[0];
    for (var index in points) {
        var e = points[index];
        if (e != point) {
            return false;
        }

        point = point + 1;
    }

    return true;
};

// 判断是否是 A K Q J 10 这个顺子
KQCard._isShunZiAKQ = function (cards) {
    var length = cards.length;
    if (length.length < 3) {
        return false;
    }

    var point1s = [1];
    var point14s = [14];
    var pointK = 13;

    Number(length - 1).kq_times(function (times) {
        point1s.push(pointK - times);
        point14s.push(pointK - times);
    });

    return KQCard._isCardsContainPoints(cards, point1s) || KQCard._isCardsContainPoints(cards, point14s);
};

// cards 中是否包含 points 这些点数

KQCard._isCardsContainPoints = function (cards, points) {
    var _loop = function (index) {
        var point = points[index];
        var pointCardIndex = cards.findIndex(function (card) {
            return card.point == point;
        });

        if (pointCardIndex < 0) {
            return {
                v: false
            };
        }
    };

    for (var index = 0; index < points.length; ++index) {
        var _ret = _loop(index);

        if (typeof _ret === 'object') return _ret.v;
    }

    return true;
};
KQCard.contain20 = function (cards) {
    if (cards.length <= 0) {
        return [];
    }
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var newCard = cards.filter(function (card) {
        //重新赋值cards
        if (card.point >= 20) {
            return card;
        }
    });
    return newCard || [];
};
// 是否包含顺子
KQCard.containShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findShunZi(cards).length > 0) {
        return true;
    }
    return false;
    //let uniqueCards = cards.unique(function(card1, card2) {
    //    return card1.point == card2.point;
    //});
    //uniqueCards.sort(KQCard.sortByPoint);
    //
    //let minPointCard = uniqueCards[0];
    //if (minPointCard.point == 1) {
    //    let APlusCard = new KQCard(minPointCard);
    //    APlusCard.point = 14;
    //    uniqueCards.push(APlusCard);
    //}
    //
    //for (var start = 0; (start + minLength) <= uniqueCards.length; ++start) {
    //    let subCards = uniqueCards.slice(start, start + minLength);
    //    if (KQCard.isShunZi(subCards, minLength)) {
    //        return true;
    //    }
    //}
    //
    //return KQCard.containShunZi20(cards);
};
/*KQCard.containShunZi20 = function (card) {
 if (card.length < 5) {
 return false;
 }
 var card20 = KQCard.contain20(card);
 var cards = card.kq_excludes(card20);
 // 先根据点数去重
 var newArr = [];
 var newArrs = [];
 for (var i = 0; i < cards.length; i++) {
 if (newArrs.indexOf(cards[i].point) == -1) {
 newArr.push(cards[i]);
 newArrs.push(cards[i].point);
 }
 }
 //newArr.forEach(function(card){
 //    if(card.scores == 14){
 //        card.scores = 1;
 //    }
 //})
 newArr.sort(function (n1, n2) {
 return n1.point - n2.point;
 });
 for(var j = 1;j <= card20.length;++j){
 var num = 5 - j;
 for (var start = 0; (start + num) <= newArr.length; ++start) {
 var subCards = newArr.slice(start, start + num);
 var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
 if(bool){
 return true;
 }
 }
 }
 // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
 let convertedCards = KQCard._convertOneToA1(card);
 if (card === convertedCards) {
 return false;
 }
 return KQCard.containShunZi20(convertedCards);
 };*/
// 是否是同花顺
KQCard.isTongHuaShun = function (cards) {
    return KQCard.isTongHua(cards) && KQCard.isShunZi(cards);
};

// 是否包含有同花顺
KQCard.containTongHuaShun = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findTongHuaShun(cards).length > 0) {
        return true;
    }
    return false;
    //var sanShunZi = KQCard.sanShunZi1(cards,minLength)[0];
    //if(sanShunZi == null){
    //    return false;
    //}
    //var result = false;
    //for(var i=0;i<sanShunZi.length;i++) {
    //    var s = sanShunZi[i];
    //    if (KQCard.isTongHuaShun(s, minLength)) {
    //        return true;
    //    }
    //}
    //return KQCard.containTongHuaShun1(cards);
};
/*KQCard.containTongHuaShun1 = function (cards, minLength = 5) {
 if (cards.length < minLength) {
 return false;
 }
 let tempCards = Array.from(cards).sort(KQCard.sortByColor);
 for (var start = 0; (start + minLength) <= tempCards.length; ++start) {
 let subCards = tempCards.slice(start, start + minLength);
 if (KQCard.isTongHuaShun(subCards, minLength)) {
 return true;
 }
 }

 let convertedCards = KQCard._convertOneToA1(cards);
 if (cards === convertedCards) {
 return KQCard.containTongHuaShun20(cards);
 }
 return KQCard.containTongHuaShun1(convertedCards);
 //return false;
 };
 KQCard.containTongHuaShun20 = function (card, minLength = 5) {
 if (card.length < minLength) {
 return false;
 }
 var card20 = KQCard.contain20(card) || [];
 var cards = card.kq_excludes(card20);

 cards = Array.from(cards);
 var colorS = []; //黑桃
 var colorH = []; //红心
 var colorC = []; //梅花
 var colorD = []; //方块
 var pointS = []; //黑桃
 var pointH = []; //红心
 var pointC = []; //梅花
 var pointD = []; //方块
 for(var i=0;i<cards.length;i++){
 if(cards[i].color == '4'){
 if(pointS.indexOf(cards[i].point) == -1){
 pointS.push(cards[i].point);
 colorS.push(cards[i]);
 }

 }else if(cards[i].color == '3'){
 if(pointH.indexOf(cards[i].point) == -1){
 pointH.push(cards[i].point);
 colorH.push(cards[i]);
 }
 }else if(cards[i].color == '2'){
 if(pointC.indexOf(cards[i].point) == -1){
 pointC.push(cards[i].point);
 colorC.push(cards[i]);
 }
 }else if(cards[i].color == '1'){
 if(pointD.indexOf(cards[i].point) == -1){
 pointD.push(cards[i].point);
 colorD.push(cards[i]);
 }
 }
 }

 var color = [colorS,colorH,colorC,colorD];
 var colorSum = [];    //总共有几种花色 [5,3,0....]
 for(var i=0;i<color.length;i++){
 if(color[i].length >= parseInt(5 - card20.length)){
 //color[i].forEach(function(ca){
 //    if(ca.scores == 14){
 //        ca.scores = 1;
 //    }
 //})
 color[i].sort(function(a1,a2){
 return a1 - a2;
 })
 colorSum.push(color[i]);
 }
 }

 for(var i=0;i<colorSum.length;i++) {
 var s = colorSum[i]
 for(var j = 1;j <= card20.length;++j){
 var num = 5 - j;
 for (var start = 0; (start + num) <= s.length; ++start) {
 var subCards = s.slice(start, start + num);
 var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
 if(bool){
 return true;
 }
 }
 }
 }



 let convertedCards = KQCard._convertOneToA1(card);
 if (card === convertedCards) {
 return false;
 }
 return KQCard.containTongHuaShun20(convertedCards);
 };*/

// 是否是清龙
KQCard.isQingLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    /**
     *
     */
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
        }
    }
    if (colorSum.length == 1) {
        if (colorSum[0] == 13) {

            if (KQCard.isYiTiaoLong(cards)) {

                var teShuCard = cards.filter(function (i) {
                    return i;
                });

                teShuCard = KQCard.cardsFromArray(teShuCard);

                teShuCard.forEach(function (a) {
                    if (a.scores == 1) a.scores = 14;
                });

                teShuCard.sort(function (a, b) {
                    return b.scores - a.scores;
                });

                teShuCard = KQCard.convertToServerCards(teShuCard);

                var a1 = teShuCard.splice(0, 5);

                var a2 = teShuCard.splice(0, 5);

                cc.teShuPaiCards = [teShuCard, a2, a1];

                return true;
            }
        }
    }
    //return KQCard.isTongHuaShun(cards);
    return false;
};

// 是否是一条龙
KQCard.isLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }

    return KQCard.isShunZi(cards);
};

/*#####*/
/*是否一条龙*/
KQCard.isYiTiaoLong = function (cards) {
    //cards:{number:1~13 ,'suit':'h'...}
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].number == 'undefined') {
        cards = KQCard.convertToServerCards(cards);
    }
    var number = cards.map(function (card) {
        return card.number;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });
    for (var i = 0; i < cards.length - 1; i++) {
        if (number[i] != number[i + 1] - 1) {
            return false;
        }
    }

    var teShuCard = cards.filter(function (i) {
        return i;
    });

    teShuCard = KQCard.cardsFromArray(teShuCard);

    teShuCard.forEach(function (a) {
        if (a.scores == 1) a.scores = 14;
    });

    teShuCard.sort(function (a, b) {
        return b.scores - a.scores;
    });

    teShuCard = KQCard.convertToServerCards(teShuCard);

    var a1 = teShuCard.splice(0, 5);

    var a2 = teShuCard.splice(0, 5);

    cc.teShuPaiCards = [teShuCard, a2, a1];
    //cc.log(cc.teShuPaiCards )
    //cc.log('--------728')
    return true;
};
/*#####*/
/*是否三同花*/
KQCard.isSanTongHua = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == "undefined") {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var sanCard = [colorS, colorH, colorC, colorD];
    var teShuCard = [];
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
            teShuCard.push(sanCard[i]);
        }
    }

    //三种花色
    if (colorSum.length == 3) {
        for (var i = 0; i < colorSum.length; i++) {
            if (colorSum[i] != 5 && colorSum[i] != 3) {
                return false;
            }
        }
        teShuCard.sort(function (a, b) {
            return a.length - b.length;
        });
        cc.teShuPaiCards = teShuCard;
        return true;
    }
    return false;
};
/*是否凑一色*/
KQCard.isCouYiSe = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's' || cards[i].suit == 'c') {
            colorS.push(cards[i]); //全黑
        } else if (cards[i].suit == 'h' || cards[i].suit == 'd') {
                colorH.push(cards[i]); //全红
            }
    }

    //如果牌中包含四种花色就不可能是三同花
    if (colorS.length == 13 || colorH.length == 13) {
        return true;
    }
    //else if(colorH.length == 13){
    //    return true;
    //}
    return false;
};
/*#####*/
// 是否是六对半
KQCard.isLiuDuiBan = function (cards) {
    var length = 12;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfYi = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength || value == 3) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value == 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        }
        //else if (value == 6 || value == 7 || value == 5) {
        //    numberOfDuiZi = numberOfDuiZi + 0;
        //}
        else if (value == 1) {
                numberOfYi += 1;
            }
    }

    if (numberOfDuiZi == 6) {

        var teShuCard = cards.filter(function (i) {
            return i;
        });

        teShuCard = KQCard.cardsFromArray(teShuCard);

        teShuCard.forEach(function (a) {
            if (a.scores == 1) a.scores = 14;
        });

        teShuCard.sort(function (a, b) {
            return b.scores - a.scores;
        });

        teShuCard = KQCard.convertToServerCards(teShuCard);

        var a1 = teShuCard.splice(0, 5);

        var a2 = teShuCard.splice(0, 5);

        cc.teShuPaiCards = [teShuCard, a2, a1];

        return true;
    }
    return false;
};

KQCard.isWuDuiSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    var sanTiaoLength = 3;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfSanTiao = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        } else if (value >= 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        }
    }
    return numberOfDuiZi == 5 && numberOfSanTiao == 1;
};

//判断5张或者3张是否顺子
KQCard.isShunZi1 = function (arr) {
    //console.log(arr);
    for (var i = 0; i < arr.length - 1; i++) {
        if (arr[i + 1] - arr[i] != 1) {
            //不是顺子
            //console.log("不是顺子");
            return false;
        }
    }
    return true;
};

KQCard.isSanShunZi = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }

    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }

    //取出牌的点数
    var number = cards.map(function (card) {
        return card.number;
    });
    //排序
    number.sort(function (n1, n2) {
        return n1 - n2;
    });
    if (KQCard.fenZhu(number, 5, 5) == false) {
        var number = cards.map(function (card) {
            return card.number;
        });
        //排序
        number.sort(function (n1, n2) {
            return n1 - n2;
        });
        if (KQCard.fenZhu(number, 5, 3) == false) {
            var number = cards.map(function (card) {
                return card.number;
            });
            //排序
            number.sort(function (n1, n2) {
                return n1 - n2;
            });
            if (KQCard.fenZhu(number, 3, 5) == false) {
                //不是三顺子
                var AIsExist = false; //是否存在A
                for (var i in cards) {
                    if (cards[i].number == 1) {
                        AIsExist = true;
                        //console.log("存在A");
                        break;
                    }
                }
                if (!AIsExist) {
                    //console.log("退出递归");
                    return false;
                }

                for (var i in cards) {
                    if (cards[i].number == 1) {
                        //console.log("A转为14");
                        cards[i].number = 14;
                        break;
                    }
                }
                if (cc.teShuPaiCards && cc.teShuPaiCards.length > 0 && cc.teShuPaiCards[0][0] && typeof cc.teShuPaiCards[0][0] == 'number') {
                    var newCards = cards.filter(function (i) {
                        return i;
                    });
                    var newCards1 = cc.teShuPaiCards.map(function (arr) {
                        var cad = arr.map(function (number) {
                            for (var i = 0; i < newCards.length; i++) {
                                if (newCards[i].number == number) {
                                    return newCards.splice(i, 1)[0];
                                    break;
                                }
                            }
                        });
                        return cad;
                    });
                    cc.teShuPaiCards = newCards1;
                }
                return KQCard.isSanShunZi(cards);
            }
        }
    }
    if (cc.teShuPaiCards && cc.teShuPaiCards.length > 0 && cc.teShuPaiCards[0][0] && typeof cc.teShuPaiCards[0][0] == 'number') {
        var newCards = cards.filter(function (i) {
            return i;
        });
        var newCards1 = cc.teShuPaiCards.map(function (arr) {
            var cad = arr.map(function (number) {
                for (var i = 0; i < newCards.length; i++) {
                    if (newCards[i].number == number) {
                        return newCards.splice(i, 1)[0];
                        break;
                    }
                }
            });
            return cad;
        });
        cc.teShuPaiCards = newCards1;
    }
    return true;
};

//分组553||535||355
KQCard.fenZhu = function (number, num1, num2) {
    var arr1 = [];
    var arr2 = [];
    var arr3 = [];
    for (var i = 0; i < number.length - 1; i++) {
        if (i == 0) {
            arr1.push(number[0]);
        }
        if (number[i + 1] - number[i] == 0) {
            continue;
        }
        arr1.push(number[i + 1]);
        if (arr1.length == num1) {
            //取第一组是顺子
            if (KQCard.isShunZi1(arr1)) {
                //这5个是顺子,从数组中移除
                for (var i = 0; i < arr1.length; i++) {
                    for (var j = 0; j < number.length; j++) {
                        if (number[j] == arr1[i]) {
                            //两个数一样的只删除一个
                            if (number[j] == number[j + 1]) {
                                continue;
                            }
                            number.splice(j, 1); //从number中移除
                        }
                    }
                }
                /*console.log("删除第一组后的number");
                 console.log(number);*/
                //接下来取第二组
                for (var i = 0; i < number.length - 1; i++) {
                    if (i == 0) {
                        arr2.push(number[0]);
                    }
                    if (number[i + 1] - number[i] == 0) {
                        continue;
                    }
                    arr2.push(number[i + 1]);
                    if (arr2.length == num2) {
                        //取第二组是顺子
                        if (KQCard.isShunZi1(arr2)) {
                            for (var i = 0; i < arr2.length; i++) {
                                for (var j = 0; j < number.length; j++) {
                                    if (number[j] == arr2[i]) {
                                        //两个数一样的只删除一个
                                        if (number[j] == number[j + 1]) {
                                            continue;
                                        }
                                        number.splice(j, 1); //从number中移除
                                    }
                                }
                            }
                            /*console.log("删除第二组后的number");
                             console.log(number);*/
                            arr3 = number;
                            //接下来就是剩下的了
                            if (KQCard.isShunZi1(arr3)) {
                                //第三组也是顺子
                                var asdf = [arr1, arr2, arr3];

                                asdf.sort(function (n1, n2) {
                                    return n1.length - n2.length;
                                });

                                if (!cc.teShuPaiCards) cc.teShuPaiCards = asdf;

                                return true;
                            }
                            //第三组不是顺子
                            return false;
                        }
                        //第二组不是顺子
                        return false;
                    }
                }
            }
            //第一组不是顺子
            return false;
        }
    }
    //如果取不到num1个数
    if (arr1.length < num1) {
        return false;
    }
    if (arr2.length < num2) {
        return false;
    }
};

KQCard.isSanShunZi1 = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }

    cards = Array.from(cards);
    cards.sort(KQCard.sortByPoint);
    var wei = [];
    var zhong = [];
    var tou = [];
    var sanShunZi = KQCard.sanShunZi1(cards)[0]; //获取所有组合的头道
    if (!sanShunZi) {
        //你连头道都没有 怎么更我混
        return false;
    }

    var newCard = cards.filter(function (i) {
        //重新赋值cards
        return i;
    });
    var newCards1 = [];
    var newPoint = []; //判断point是否相同
    var duiZi = []; //取出有对子当中的一张牌
    for (var s in cards) {
        if (newPoint.indexOf(cards[s].point) < 0) {
            newCards1.push(cards[s]);
            newPoint.push(cards[s].point);
        } else {
            //取出有对子当中的一张牌
            duiZi.push(cards[s]);
        }
    }

    for (var j = 0; j < sanShunZi.length; ++j) {
        //循环所有头道
        var number3 = sanShunZi[j];
        if (typeof number3 == 'undefined') {
            continue;
        }
        for (var i = 0; i < cards.length; ++i) {
            var newCards = newCards1.filter(function (i) {
                //重新赋值cards
                return i;
            });

            newCards = newCards.kq_excludes(number3); //删除牌里的头道
            if (wei.length != 5) {
                var subCards = newCards.slice(i, i + 5);
                if (subCards.length == 5 || KQCard.isShunZi(subCards)) {
                    //得到尾道 删除牌里的尾道
                    wei = subCards;
                    // cc.log(number3)
                    // cc.log(newCards1)
                    // cc.log(subCards)
                    // cc.log(newCards)
                    // cc.log(i)
                    // cc.log('-----716')
                    newCards = newCards.kq_excludes(subCards);
                }
            }

            if (wei.length == 5) {
                //把剩余的牌和对子的单张合并
                var tasks = duiZi.filter(function (i) {
                    //重新赋值对子
                    return i;
                });
                tasks = tasks.kq_excludes(number3); //判断头道和对子的单张是否有相同 有的话就删除
                newCards = newCards.concat(tasks); //把剩余的牌和对子的单张合并
            }

            if (zhong.length != 5 && newCards.length == 5) {
                if (KQCard.isShunZi(newCards)) {
                    //是三顺子
                    zhong = newCards;
                }
            }
            if (wei.length == 5 && zhong.length == 5) {
                //是三顺子终止循环
                break;
            } else {
                //来吧 继续吧
                zhong = [];wei = [];tou = [];
            }
        }
        if (wei.length == 5 && zhong.length == 5) {
            //是三顺子终止循环
            tou = number3;
            break;
        } else {
            //来吧 继续吧
            zhong = [];wei = [];tou = [];
        }
    }

    cards = newCard;
    if (KQCard._isSanShunZi(tou, zhong, wei)) {
        //是三顺子
        tou = KQCard.convertToServerCards(tou);
        zhong = KQCard.convertToServerCards(zhong);
        wei = KQCard.convertToServerCards(wei);

        if (!cc.teShuPaiCards) cc.teShuPaiCards = [tou, zhong, wei];
        return true;
    }
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
        cards.forEach(function (a) {
            if (a.point == 14) a.point = 1;
        });
        //return false;
        return KQCard.isSanShunZi1(cards);
    }
    return KQCard.isSanShunZi(convertedCards);
};

KQCard.sanShunZi1 = function (cards) {
    var length = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    var shunzi = KQCard.findShunZi(cards, length);
    var cardsT = [];
    var cardsIndex = [];
    if (shunzi == null) {
        return false;
    }
    for (var i = 0; i < shunzi.length; i++) {
        var a = shunzi[i];
        var cardsShunzi = [];
        // var cardsIndex = [];
        for (var j = 0; j < a.length; j++) {
            var index = a[j];
            if (typeof cards[index] == 'undefined') {
                continue;
            }
            cardsShunzi.push(cards[index]);
        }
        cardsIndex.push(a);
        cardsT.push(cardsShunzi);
    }
    return [cardsT, cardsIndex];
};

KQCard._isSanShunZi = function (touCards, zhongCards, weiCards) {
    return KQCard.isShunZi(touCards) && KQCard.isShunZi(zhongCards) && KQCard.isShunZi(weiCards);
};
// 是否是三同花顺
KQCard.isSanTongHuaShun = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorCardsObject = KQCard._colorClassCards(cards);

    var subCards = [];
    for (var prop in colorCardsObject) {
        var _cards = colorCardsObject[prop];
        subCards.push(_cards);
    }

    if (subCards.length != 3) {
        return false;
    }

    subCards = subCards.sort(function (s1, s2) {
        return s1.length > s2.length;
    });

    var touCards = subCards[0];
    var zhongCards = subCards[1];
    var weiCards = subCards[2];

    if (touCards.length != 3 || zhongCards.length != 5 || weiCards.length != 5) {
        return false;
    }

    return KQCard._isSanTongHuaShun(touCards, zhongCards, weiCards);
};

// 将牌根据 color 进行分类
KQCard._colorClassCards = function (cards) {
    var colorCardsObject = {};
    cards.forEach(function (card) {
        var color = card.color;
        var subCards = colorCardsObject[color];
        if (!subCards) {
            subCards = [];
            colorCardsObject[color] = subCards;
        }
        subCards.push(card);
    });

    return colorCardsObject;
};

// 是否是三同花顺
KQCard._isSanTongHuaShun = function (touCards, zhongCards, weiCards) {
    return KQCard.isTongHuaShun(touCards) && KQCard.isTongHuaShun(zhongCards) && KQCard.isTongHuaShun(weiCards);
};

// 是否是 “三分天下”
KQCard.isSanFenTianXia = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var tieZhiLength = 4;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfTieZhi = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == tieZhiLength) {
            numberOfTieZhi = numberOfTieZhi + 1;
        }
    }
    return numberOfTieZhi === 3;
};

// 是否是 “四套三条”
KQCard.isSiTaoSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var sanTiaoLength = 3;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfSanTiao = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        }
    }

    return numberOfSanTiao == 4;
};

// 是否是 “三桃花”
// 头、中、尾道为相同花色的牌
KQCard.isSanTaoHua = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorHelper = new KQCardColorsHelper(cards);
    var colorNumbers = [];
    for (var prop in colorHelper.colorNumber) {
        colorNumbers.push(colorHelper.colorNumber[prop]);
    }

    colorNumbers.sort(function (n1, n2) {
        return n1 - n2;
    });

    if (colorNumbers.length != 3) {
        return false;
    }

    if (colorNumbers[0] == 3 && colorNumbers[1] == 5 && colorNumbers[2] == 5) {
        return true;
    }

    return false;
};

// 判断是否包含铁支
// 四张同样点数的牌
KQCard.containTieZhi = function (cards) {
    var length = 4;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var helper = new KQCardPointsHelper(cards);

    for (var w in helper.pointNumbers) {
        var maxNumber = helper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}
    // else{
    //    return KQCard.containGuiPai(cards,4);
    //}
    //if (KQCard.findTieZhi(cards).length > 0) {
    //    return true;
    //}
    return false;
};

// 判断是否是铁支
KQCard.isTieZhi = function (cards) {
    var length = 4;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};

/*#####是否包含五同*/
//五张同样点数的牌
KQCard.containWuTong = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    //五张牌相同的
    var helper = new KQCardPointsHelper(cards);
    //for(var w in helper.pointNumbers) {
    //    cc.log(w)
    //}
    //cc.log(cards)
    //cc.log(helper)
    //cc.log(card20)
    //cc.log(helper.maxNumber())
    //cc.log('------1307')
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}
    for (var w in helper.pointNumbers) {
        var maxNumber = helper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return helper.maxNumber() >= length;
        }
    }
    return false;
};

/*判断是否五同*/
KQCard.isWuTong = function (cards) {
    var length = 5;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};
/*#####*/

// 是否是 “葫芦”
// 三张相同 + 一对
KQCard.containHuLu = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    if (KQCard.findHuLu(cards).length > 0) {
        return true;
    }
    //let pointHelper = new KQCardPointsHelper(cards);
    //var pointNumbers = [];
    //var index = 0;
    //for (let prop in pointHelper.pointNumbers) {
    //    pointNumbers[index] = pointHelper.pointNumbers[prop];
    //    index = index + 1;
    //}
    //var h=[];
    //var h1=[];
    //for(var i in pointNumbers){
    //    var s=pointNumbers[i];
    //    if(s == 3){
    //        h.push(s)
    //    }
    //    else if(s==4){
    //        h1.push(s)
    //    }
    //
    //}
    //
    //if ((pointNumbers.indexOf(3) != -1) && (pointNumbers.indexOf(2) != -1)
    // || h.length > 1 || h1.length > 1 ||(pointNumbers.indexOf(4) != -1)
    // && (pointNumbers.indexOf(2) != -1)) {
    //    return true;
    //}

    return false;
};

// 判断是否是 葫芦
KQCard.isHuLu = function (cards) {
    if (cards.length != 5) {
        return false;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (p1, p2) {
        return p1 - p2;
    });

    var p1 = points[0];
    var p2 = p1;
    var numberP1 = 0;
    var numberP2 = 0;

    points.forEach(function (point) {
        if (point != p1 && point != p2) {
            p2 = point;
            numberP2 = 0;
        }

        numberP1 = numberP1 + (point == p1 ? 1 : 0);
        numberP2 = numberP2 + (point == p2 ? 1 : 0);
    });

    var maxNumber = Math.max(numberP1);
    var minNumber = Math.min(numberP2);

    return minNumber == 2 && maxNumber == 3;
};

// 是否包含有 “三条”
KQCard.containSanTiao = function (cards) {
    var length = 3;
    if (cards.length < length) {
        return false;
    }
    //if (KQCard.findSanTiao(cards).length > 0) {
    //    return true;
    //}
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var pointHelper = new KQCardPointsHelper(cards);
    for (var w in pointHelper.pointNumbers) {
        var maxNumber = pointHelper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] >= length) {
    //        return true;
    //    }
    //}
    return false;

    //
    //return KQCard.containGuiPai(cards,3);
};

// 是否是 “三条”
KQCard.isSanTiao = function (cards) {
    if (cards.length != 3) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (card.point == point) {
            return point;
        }

        return -1;
    }, cards[0].point);

    return result != -1;
};

// 是否包含有 ：两对
KQCard.containLiaDui = function (cards) {
    if (cards.length < 4) {
        return false;
    }
    if (KQCard.findLiaDui(cards).length > 0) {
        return true;
    }
    //var numberOfDuiZi = 0;
    //let pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] == 2) {
    //        numberOfDuiZi = numberOfDuiZi + 1;
    //        if (numberOfDuiZi == 2) {
    //            return true;
    //        }
    //    }
    //}

    return false;
};

// 是否是 两对
KQCard.isLiaDui = function (cards) {
    if (cards.length != 4) {
        return false;
    }

    var pointHelper = new KQCardPointsHelper(cards);
    for (var prop in pointHelper.pointNumbers) {
        if (pointHelper.pointNumbers[prop] != 2) {
            return false;
        }
    }
    return true;
};

// 是不是对子
KQCard.isDuiZi = function (cards) {
    if (cards.length != 2) {
        return false;
    }

    var card1 = cards[0];
    var card2 = cards[1];

    return card1.point == card2.point;
};

// 是否包含对子
KQCard.containDuiZi = function (cards) {
    var length = 2;
    if (cards.length < length) {
        return false;
    }
    //if (KQCard.findDuiZi(cards).length > 0) {
    //    return true;
    //}
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] >= length) {
    //        return true;
    //    }
    //}
    for (var w in pointHelper.pointNumbers) {
        var maxNumber = pointHelper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    return false;
    //return KQCard.containGuiPai(cards,2);
};

KQCard.containGuiPai = function (cards, length) {
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    var helper = new KQCardPointsHelper(cards);
    var maxNumber = helper.maxNumber() + card20.length;
    return maxNumber >= length;
};
/*#####*/
// 是否是特殊牌
KQCard.isTeShuPai = function (cards) {
    if (cards.length < 13) {
        return false;
    }

    return KQCard.isQingLong(cards) || KQCard.isYiTiaoLong(cards) || KQCard.isLiuDuiBan(cards) || KQCard.isSanShunZi(cards) || KQCard.isSanTongHua(cards)
    /*|| KQCard.isSanTongHuaShun(cards)
     || KQCard.isSanFenTianXia(cards)
     || KQCard.isSiTaoSanTiao(cards)
      || KQCard.isWuDuiSanTiao(cards)
     || KQCard.isCouYiSe(cards)*/;
};

// 将牌中的 1 变化为 A（14)
KQCard._convertOneToA = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var result = cards.map(function (card) {
        if (card.point == 1) {
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

KQCard._convertOneToA1 = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var num = 0;
    var result = cards.map(function (card) {
        if (card.point == 1 && num == 0) {
            num++;
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

// KQCard 的排序方法
KQCard.sortByPoint = function (card1, card2) {
    var result = Number(card1.point) - Number(card2.point);
    return result;
};

KQCard.sortByColor = function (card1, card2) {
    var pointAsc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (card2.color == card1.color) {
        return (card1.point - card2.point) * (pointAsc ? 1 : -1);
    }
    return card2.color - card1.color;
};

KQCard.sort = function (card1, card2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];
    var AisMax = arguments.length <= 3 || arguments[3] === undefined ? true : arguments[3];

    var result = 1;
    if (card1.point == card2.point) {
        result = card1.color - card2.color;
    } else {
        var point1 = card1.point;
        var point2 = card2.point;
        if (AisMax && point1 == 1) {
            point1 = 14;
        }

        if (AisMax && point2 == 1) {
            point2 = 14;
        }

        result = point1 - point2;
    }

    return result * (asc ? 1 : -1);
};

//转为客户端的牌
KQCard._convertCardsToCardNames = function (cards) {
    // [{"suit":"s","number":10}]
    var suitColorMap = ['', 'd', 'c', 'h', 's'];
    return cards.map(function (card) {
        var cardNumber = card.point;
        var color = suitColorMap[card.color];
        var number = Math.max(Math.min(cardNumber, 13), 1);
        return { number: number, suit: color };
    });
};

cc._RFpop();
},{"GetCardPointsSameCount":"GetCardPointsSameCount","KQCardColorsHelper":"KQCardColorsHelper","KQCardPointsHelper":"KQCardPointsHelper","NumberExtension":"NumberExtension"}],"KQGlabolSocketEventHander":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'babea3CWj9G1pWM9AkXao0n', 'KQGlabolSocketEventHander');
// scripts\Socket\KQGlabolSocketEventHander.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var KQGlabolSocketEventHander = {
    start: function start() {
        if (this._didStart) {
            return;
        }
        this._didStart = true;

        KQGlobalEvent.on(Socket.Event.ReceiveForceExit, this._forceExitApp, this);
    },

    _forceExitApp: function _forceExitApp(response) {
        KQNativeInvoke.forceExitApp();
    }
};

module.exports = KQGlabolSocketEventHander;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","socket":"socket"}],"KQGlobalEvent":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd90d6OrggVEXa29ffA+vZY0', 'KQGlobalEvent');
// scripts\Event\KQGlobalEvent.js

var KQGlobalEvent = {
    _handles: {},
    //发送事件
    emit: function emit(eventName) {
        var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

        if (typeof data == 'string') {
            data = { 'data': data };
        }

        var returns = []; //返回值
        data.eventName = eventName; //保存一下事件名字

        for (var findEvenName in this._handles) {
            if (findEvenName == eventName) {
                for (var i = 0; i < this._handles[findEvenName].length; i++) {
                    var returnValue = this._handles[findEvenName][i](data);
                    returns.push(returnValue);
                }
            }
        }

        return returns;
    },
    //添加普通事件
    on: function on(eventName, callback, target) {
        // console.log('收到事件', eventName);
        this._handles[eventName] = this._handles[eventName] || [];

        this._handles[eventName].push(callback.bind(target));
        callback._caller = target;
    },

    //通过事件名移除一个监听器
    off: function off(eventName) {
        for (var i = 0; i < this._handles[eventName].length; i++) {
            this._handles[eventName][i] = null;
        }
    },

    // 移动一个 target 上所有的监听
    offTarget: function offTarget(target) {
        for (var name in this._handles) {
            var eventHandlers = this._handles[name];
            var indexs = eventHandlers.filter(function (callback) {
                return callback._caller = target;
            }).map(function (callback, index) {
                return index;
            });

            var indexOffset = 0;
            indexs.forEach(function (index) {
                eventHandlers.splice(index + indexOffset, 1);
                indexOffset = indexOffset + 1;
            });
        }
    }
};

module.exports = KQGlobalEvent;

cc._RFpop();
},{}],"KQNativeInvoke":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7327dLBqWVNaJ14fJQ4jq6Y', 'KQNativeInvoke');
// scripts\Utils\KQNativeInvoke.js

var KQNativeInvoke = {
  IOSClassName: "AppController",
  ANDRIODClassName: "com/gongpa/ssz/AppActivity",

  isNativeIOS: function isNativeIOS() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.IPHONE || platform == cc.sys.IPAD) {
      return true;
    }
    return false;
  },

  isNativeAndroid: function isNativeAndroid() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.ANDROID) {
      return true;
    }
    return false;
  },

  isNative: function isNative() {
    return cc.sys.isNative == true;
  }
};

// MARK: 可调用的本地方法
/**
 * 微信登录
 */
KQNativeInvoke.wxLogin = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
  } else if (KQNativeInvoke.isNativeAndroid()) {
      //Android
      jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
    }
};

/**
 * 分享大厅信息到微信好友
 * 
 */
KQNativeInvoke.shareHallToWeChatFriend = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallFriend", "()V");
  }
};

/**
 * 分享大厅信息到朋友圈
 * 
 */
KQNativeInvoke.shareHallToWeChatTimeline = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", "()V");
  }
};

/**
 * 强制退出 APP
 * 
 */
KQNativeInvoke.forceExitApp = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
  }
};

/**
 * 下载新版本
 * 
 * @param {String} iosUrl      iOS 版本地址
 * @param {String} androidUrl  安卓版本地址
 */
KQNativeInvoke.downloadNewVersion = function (iosUrl, androidUrl) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", iosUrl);
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", androidUrl);
  }
};

/**
 * 分享房间给微信好友
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatFriend = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V", id, description, title);
  }
};

/**
 * 分享房间到微信朋友圈
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatTimeline = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShare:description:", id, description, title);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShare", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V", id, description, title);
  }
};

/**
 * 分享屏幕截图到微信好友
 */
KQNativeInvoke.shareScreenToWeChatFriend = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShareFriend", "()V");
  }
};

/**
 * 分享屏幕截图到微信朋友圈
 */
KQNativeInvoke.shareScreenToWeChatTimeline = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
  }
};

/**
 * 开始录音
 */
KQNativeInvoke.startRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
  }
};

/**
 * 结束录音
 */
KQNativeInvoke.endRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
  }
};

KQNativeInvoke.screenshotShare = function () {
  var strings = arguments.length <= 0 || arguments[0] === undefined ? 'shareIMG' : arguments[0];

  if (this._isCapturing) {
    return;
  }
  this._isCapturing = true;
  var size = cc.director.getWinSize();
  var fileName = "result_share.jpg";
  var fullPath = jsb.fileUtils.getWritablePath() + fileName;
  if (jsb.fileUtils.isFileExist(fullPath)) {
    jsb.fileUtils.removeFile(fullPath);
  }
  var texture = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height), cc.IMAGE_FORMAT_PNG, gl.DEPTH24_STENCIL8_OES);
  texture.setPosition(cc.p(size.width / 2, size.height / 2));
  texture.begin();
  cc.director.getRunningScene().visit();
  texture.end();
  texture.saveToFile(fileName, cc.IMAGE_FORMAT_PNG);

  var self = this;
  var tryTimes = 0;
  var fn = function fn() {
    if (jsb.fileUtils.isFileExist(fullPath)) {

      if (cc.sys.os == cc.sys.OS_ANDROID) {
        jsb.reflection.callStaticMethod(self.ANDRIODClassName, strings, "(Ljava/lang/String;)V", fullPath);
      }
      self._isCapturing = false;
    } else {
      tryTimes++;
      if (tryTimes > 10) {
        console.log("time out...");
        return;
      }
      setTimeout(fn, 50);
    }
  };
  setTimeout(fn, 50);
};

/**
 * 播放网络语音
 * 
 * @param {String} audioUrl 语音地址
 */
KQNativeInvoke.playAudioWithUrl = function (audioUrl) {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", audioUrl);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", audioUrl);
  }
};

module.exports = KQNativeInvoke;

cc._RFpop();
},{}],"MsgControl":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd242dsY+hBG5LpL7ZF7Kn6', 'MsgControl');
// scripts\Chat\MsgControl.js

var Socket = require('socket');
var ChatMessage = require('ChatMessage');
var AudioManager = require('AudioManager');

// 用来发送消息的 component
cc.Class({
    'extends': cc.Component,

    properties: {
        //bqNode:cc.Node,
        //bqNode1:cc.Node,
        //btnLanguageNode:cc.Node,
        //btnLanguageNode1:cc.Node,
        //btnChartNode:cc.Node,
        //btnChartNode1:cc.Node,
        textScrollView: cc.Node,
        imageContentNode: cc.Node,

        editBox: cc.EditBox,

        textRecordScrollView: cc.ScrollView,
        textRecordLayout: cc.Layout,

        textPrefab: cc.Prefab,
        chatTextRecordPrefab: cc.Prefab,
        emojiPrefab: cc.Prefab,
        // imagePrefab:cc.Prefab,

        biaoqing: [cc.Node], // [亮的背景, 暗的背景]   快捷语
        kuaijieyu: [cc.Node], // [亮的背景, 暗的背景]   表情
        content: [cc.Node], // [快捷语, 表情]  
        inputNode: cc.Node,
        emoji: [cc.Node],
        _userId: null,

        _playerInfos: null, // 记录用户信息
        _chatTextMessageRecords: null },

    // 聊天文本消息记录
    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        this._playerInfos = [];
        this.textContent = this.textScrollView.getComponent(cc.ScrollView).content;
        // this.imageContent = this.imageScrollView.getComponent(cc.ScrollView).content;
        var self = this;
        var textData = AudioManager.instance.chatTexts();
        for (var i = 0; i < textData.length; i++) {
            var item = cc.instantiate(this.textPrefab);
            item.getComponent('cellText').setText(textData[i]);
            item.getComponent('cellText').onSelectAction = function (text) {
                self.onTextClickAction(text);
            };
            this.textContent.h = 1000;
            this.textContent.addChild(item);
        }
    },

    clickKuaiJieYu: function clickKuaiJieYu() {
        this.kuaijieyu[0].active = true; // 快捷语 背景
        this.kuaijieyu[1].active = false; // 快捷语 按钮
        this.biaoqing[0].active = false; // 背景表情
        this.biaoqing[1].active = true; // 表情按钮
        this.content[0].active = true;
        this.content[1].active = false;
    },
    clickBiaoQing: function clickBiaoQing() {
        this.biaoqing[0].active = true; // 背景表情
        this.biaoqing[1].active = false; // 表情按钮
        this.kuaijieyu[0].active = false; // 快捷语 背景
        this.kuaijieyu[1].active = true; // 快捷语 按钮
        this.content[0].active = false;
        this.content[1].active = true;
    },
    onTextClickAction: function onTextClickAction() {
        var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        this.editBox.string = "";
        this.sendText(text);
    },

    clickEmoji: function clickEmoji(event, emojiName) {
        var string = this.editBox.string;
        this.editBox.string = string + "<" + emojiName + ">";
        this.sendEmoji(emojiName);
    },

    clickSend: function clickSend() {
        var string = this.editBox.string || "";
        if (string.length == 0) {
            return;
        }
        this.editBox.string = "";
        this.sendText(string);
    },

    sendEmoji: function sendEmoji(emojiName) {
        if (emojiName.length == 0) {
            return;
        }
        Socket.sendEmoji(this._userId, emojiName);
        this.dismiss();
    },

    sendText: function sendText() {
        var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        if (text.length == 0) {
            return;
        }
        Socket.sendText(this._userId, text);
        this.dismiss();
    },

    dismiss: function dismiss() {
        this.node.active = false;
    },

    bqAction: function bqAction() {
        this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode1.active = true;
        this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode.active = false;
        this.textScrollView.active = false;
        this.imageContentNode.active = true;
        this.textRecordScrollView.node.active = false;
    },

    textAction: function textAction() {
        this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode.active = false;
        this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode1.active = true;
        this.textScrollView.active = true;
        this.imageContentNode.active = false;
        this.textRecordScrollView.node.active = false;
    },

    chartAction: function chartAction() {
        this.bqNode1.active = this.btnLanguageNode1.active = this.btnChartNode1.active = false;
        this.bqNode.active = this.btnLanguageNode.active = this.btnChartNode.active = true;
        this.textScrollView.active = this.imageContentNode.active = false;
        this.textRecordScrollView.node.active = true;
    },

    addPlayerInfos: function addPlayerInfos(playerInfos) {
        this._playerInfos = this._playerInfos || [];

        playerInfos.forEach((function (userInfo) {
            var haveUserInfo = this._playerInfos.find(function (ownUserInfo) {
                return ownUserInfo.id == userInfo.id;
            });

            if (haveUserInfo == null) {
                this._playerInfos.push(userInfo);
            }
        }).bind(this));
    },

    addChatTextMessage: function addChatTextMessage(userId, text) {
        this._playerInfos = this._playerInfos || [];

        var nickname = "[ID:" + userId + "说]：";
        var userInfo = this._playerInfos.find(function (userInfo) {
            return userInfo.id == userId;
        });

        if (userInfo) {
            nickname = "[" + userInfo.nickname + "说]：";
        }

        var str = nickname + text;
        str = ChatMessage.parseString(str);
        this._addChatTextToRecord(str);
    },

    addChatEmojiMessage: function addChatEmojiMessage(userId, emoji) {
        this._playerInfos = this._playerInfos || [];

        var nickname = "[ID:" + userId + "说]：";
        var userInfo = this._playerInfos.find(function (userInfo) {
            return userInfo.id == userId;
        });
        if (userInfo) {
            nickname = "[" + userInfo.nickname + "说]：";
        };
        var str = nickname + emoji;
        str = ChatMessage.parseString(str);
        this._addChatEmojiToRecord(emoji);
        // cc.log(emoji)
        // cc.log('---190')
    },

    _addChatEmojiToRecord: function _addChatEmojiToRecord(emoji) {
        var self = this;
        this._loadEmojiFrame(emoji, function (frame) {
            //var item  = cc.instantiate(self.emojiPrefab);
            //cc.log(frame)
            //var btnSprites =  item.getComponent(cc.Sprite);
            //btnSprites.spriteFrame = frame;
            //let chatEmojiRecord = item.getComponent('ChatTextRecord');
            //chatEmojiRecord.setEmoji(frame);
            ChatMessage.setEmoji(frame);
        });
    },

    _loadEmojiFrame: function _loadEmojiFrame(Emojiname, callback) {
        cc.loader.loadRes("/textures/chat/bq", cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                //console.log(null, err)
                return;
            }
            var frame = atlas.getSpriteFrame(Emojiname);
            callback(frame);
        }).bind(this));
    },

    _addChatTextToRecord: function _addChatTextToRecord(text) {
        var item = cc.instantiate(this.chatTextRecordPrefab);
        var chatTextRecord = item.getComponent('ChatTextRecord');
        chatTextRecord.setString(text);

        this.textRecordLayout.node.addChild(item);
        this.textRecordScrollView.scrollToBottom();
    }
});

cc._RFpop();
},{"AudioManager":"AudioManager","ChatMessage":"ChatMessage","socket":"socket"}],"NetworkError":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c99d35Sy6hDPbrte9nVczxP', 'NetworkError');
// scripts\NetworkError.js

var manager = require('manager');
var KQNativeInvoke = require('KQNativeInvoke');

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    exitAction: function exitAction() {
        cc.director.end();
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"NumberExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '80e21gZRpNM4pIiCpZ+7s8m', 'NumberExtension');
// scripts\Extensions\NumberExtension.js

// number.kq_times(f)   调用多次

if (!Number.prototype.kq_times) {

    /**
     * 调用一个方法 this 次
     * 
     * @param  {Function} f 要调用的方法
     * @param  {Object}   thisArg   可选； f 的 this值
     */
    Number.prototype.kq_times = function (f, thisArg) {
        if (!f) {
            return;
        }

        for (var i = 0; i < this; ++i) {
            if (thisArg) {
                f.apply(thisArg, i);
            } else {
                f(i);
            }
        }
    };
}

cc._RFpop();
},{}],"Playback":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0d3095dnBVFo5D1hEDDa5KQ', 'Playback');
// scripts\Playback\Playback.js

var Socket = require('socket');

// 用于回放的组件
var Playback = cc.Class({
  'extends': cc.Component,

  properties: {
    _playbackDatas: null, // 用于回放的数据
    _isPlaybacking: false
  },

  statics: {
    instance: null
  },

  onLoad: function onLoad() {
    Playback.instance = this;
    cc.game.addPersistRootNode(this.node);
  },

  // 设置回放数据
  setPlaybackDatas: function setPlaybackDatas(datas) {
    this._playbackDatas = datas;
  },

  // 清空回放数据。同时会清空回放
  removePlaybackDatas: function removePlaybackDatas() {
    this.setPlaybackDatas(null);
    this.stopPlayback();
  },

  // 是否包含回放数据
  isContainPlaybackDatas: function isContainPlaybackDatas() {
    return this._playbackDatas != null;
  },

  // 开始回放
  startPlayback: function startPlayback() {
    // 模拟 socket 接收到了事件即可
    //cc.log("Playback 开始回放");

    this._isPlaybacking = true;

    if (!this._playbackDatas) {
      cc.error("想回放，却没有回放数据");
      this.stopPlayback();
      return;
    }

    this._executePlayback();
  },

  // 停止回放
  stopPlayback: function stopPlayback() {
    this._isPlaybacking = false;
    this.unscheduleAllCallbacks();
  },

  // 是否正在回放
  isPlaybacking: function isPlaybacking() {
    return this._isPlaybacking;
  },

  // 执行真正的回放操作
  _executePlayback: function _executePlayback() {
    var startTime = 1.0;
    var interval = 3.0;
    cc.log(this._playbackDatas);

    // 在某些特殊情况下
    // 回放数据里会包含两套 gameOver action
    // 所以需要过滤掉其中一个
    this._playbackDatas = this._playbackDatas.filter((function (string, index) {
      if (index == this._playbackDatas.length - 1) {
        return true;
      }

      return string.indexOf('"action":"gameOver') == -1;
    }).bind(this));

    this._playbackDatas.forEach((function (data, index) {
      var delay = startTime + index * interval;
      if (index == this._playbackDatas.length - 1) {
        // 如果是最后一个，则应该只间隔一秒
        delay = startTime + (index - 1) * interval + 1;
      }

      this.scheduleOnce(function () {
        cc.log("回放开始模拟 Socket 接收到服务器消息, ", index);
        Socket.instance._dispatchResponse(data);
      }, delay);
    }).bind(this));
  }

});

module.exports = Playback;

cc._RFpop();
},{"socket":"socket"}],"Player":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6ffa0O02PFOp78QADTW5zGf', 'Player');
// scripts\Play\Player.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
var KQCardResHelper = require('KQCardResHelper');
var KQCard = require('KQCard');
var AudioManager = require('AudioManager');

cc.Class({
    'extends': cc.Component,

    properties: {
        foldCardNode: cc.Node, // 牌盖着时的样子
        teShuPaiNode: cc.Node, // 特殊牌盖着时的样子
        cardsBackLayout: cc.Layout, // 13张牌背影，可用来展示发牌动画 含 cardsBack Component
        compareCardsNode: cc.Node, // compareCards   含 CompareCards Component
        userInfoNode: cc.Node, // 包含用户信息 含 userInfo Component
        chatMessageNode: cc.Node, // 聊天消息 包含 ChatMessage Component
        userAvatarNode: cc.Node,
        //userSampleInfoNode: cc.Node,
        bulletHolePrefab: cc.Prefab, //中枪
        bulletHoleNode: cc.Node, //中枪
        shotNode: [cc.Node], //打枪
        userId: 0,
        cardTypePrefab: cc.Prefab,
        // 用户信息
        // 1、 如果 包含：cardInfo:[]，表明用户已经出牌
        //
        _userInfo: null,
        _deskInfo: null,
        /**/
        playedCompareCardsIndexs: {
            visible: false,
            'default': undefined
        }
        /**/
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.userAvatarNode.on(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
        this.reset();
        this.foldCardNodeBack = false; //判断是否点击了拍的背影
        this.cardSpriteAtlas = this.node.parent.getComponent('play').cardSpriteAtlas;
    },

    onDestroy: function onDestroy() {
        this.userAvatarNode.off(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
    },

    click_leave: function click_leave() {
        var userid = Socket.instance.userInfo.id;
        var leaveId = this._userInfo.id;
        Socket.sendQingli(leaveId, userid);
    },

    _showUserInfo: function _showUserInfo() {
        //this.userSampleInfoNode.getComponent('UserSampleInfo').updateWithUser(this._userInfo);
    },

    reset: function reset() {
        this.foldCardNode.active = false;
        this.cardsBackLayout.active = false;
        this.compareCardsNode.active = false;
        this.teShuPaiNode.active = false;
        this.bulletHoleNode.active = false;
        this.bulletHoleNode.removeAllChildren();
        this.bulletHoleNode.children.forEach(function (node) {
            node.active = false;
        });
        if (this.shotNode.length > 0) this.shotNode.forEach(function (node) {
            if (node) node.active = false;
        });
        this.compareCardsNode.getComponent('CompareCards').reset();
        this.compareCardsNode.getComponent('CompareCards').unscheduleAllCallbacks();
    },

    /*####*/
    reset2: function reset2() {
        this.foldCardNode.active = false;
        this.cardsBackLayout.active = false;
        this.teShuPaiNode.active = false;
        this.bulletHoleNode.active = false;
        this.bulletHoleNode.removeAllChildren();
        this.bulletHoleNode.children.forEach(function (node) {
            node.active = false;
        });
        if (this.shotNode.length > 0) this.shotNode.forEach(function (node) {
            if (node) node.active = false;
        });
        //this.compareCardsNode.active = false;
        //this.compareCardsNode.getComponent('CompareCards').reset();
    },
    /*#####*/

    updateUserInfoWithUsers: function updateUserInfoWithUsers(users) {
        var user = users.find((function (e) {
            return this.userId == e.id;
        }).bind(this));

        this.updateUserInfo(user);
    },
    showQingli: function showQingli(creator, index) {
        if (!this.node.active) {
            return;
        }
        if (index > 0) {
            this.userInfoNode.getComponent('userInfo').setqingli(false);
        } else {
            if (creator) {
                this.userInfoNode.getComponent('userInfo').setqingli(false);
            } else {
                this.userInfoNode.getComponent('userInfo').setqingli(true);
            }
        }
    },
    updateUserInfo: function updateUserInfo(user) {
        this._userInfo = user;
        this.node.active = user != null;
        this.userInfoNode.active = this.node.active;
        if (!user) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.updateAvatar(user.avatarUrl);
        userInfo.updateUserId(user.id);
        userInfo.updateNickname(user.nickname);
        userInfo.setOfflineVisible(!user.onlineStatus);

        //if (this._deskInfo && this._deskInfo.cIndex > 0) {
        //  if (UserModelHelper.isPlayedCards(user)) {
        //    this.playCard(user.id);
        //    this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
        //  }
        //}
        /**/
        var cIndex = this._deskInfo.cIndex;
        if (this._deskInfo && cIndex > 0 && this.playedCompareCardsIndexs.indexOf(cIndex) == -1) {
            if (UserModelHelper.isPlayedCards(user)) {
                this.playCard(user.id, user.cardInfo);
                this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
            }
        }
        /**/
    },

    // 更新房主信息
    updateBanker: function updateBanker() {
        var userInfoComp = this.userInfoNode.getComponent('userInfo');
        if (!this._userInfo) {
            userInfoComp.setIsBanker(false);
            return;
        }

        var isBanker = this._userInfo ? this._userInfo.isBanker : false;
        userInfoComp.setIsBanker(isBanker);
    },

    showFangZhuStatus: function showFangZhuStatus(createId) {
        var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (!this.node.active) {
            return;
        }
        if (this._userInfo.id == createId) {
            this.userInfoNode.getComponent('userInfo').setFangZhuNodeVisible(visible);
        }
    },

    /**
     * 更新分数
     *
     * @param {Number} score 用户分数、可选
     */
    updateScore: function updateScore(score) {
        if (!score && this._userInfo) {
            score = this._userInfo.totalScore;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.updateScore(score);
    },

    showReadyStatus: function showReadyStatus(userId) {
        var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (!this.node.active) {
            return;
        }

        if (this._userInfo.id == userId) {
            this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(visible);
        }
    },
    showBeilv: function showBeilv(userId, bl) {
        if (!this.node.active) {
            return;
        }
        if (this._userInfo.id == userId) {
            this.userInfoNode.getComponent('userInfo').setBeilvLabel(bl);
        }
    },
    /*setDeskInfo: function (deskInfo) {
     this._deskInfo = deskInfo;
     },*/
    updateDeskInfo: function updateDeskInfo(deskInfo) {
        this._deskInfo = deskInfo;

        if (deskInfo && !deskInfo.isCBegin) {
            this.reset();
        }
    },
    /**/

    hideReadyStatus: function hideReadyStatus() {
        this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(false);
    },

    playFaPaiAnimation: function playFaPaiAnimation() {
        if (!this.node.active) {
            return;
        }
        if (UserModelHelper.isPlayedCards(this._userInfo)) {
            return;
        }
        var cardsBack = this.cardsBackLayout.getComponent('cardsBack');
        cardsBack.showPlayCardBacks();
    },

    shouldShowFaPaiAnimation: function shouldShowFaPaiAnimation() {
        return UserModelHelper.isPlayedCards(this._userInfo);
    },

    setUserOnlineStatus: function setUserOnlineStatus(userId) {
        var status = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.setOfflineVisible(status != 1);
    },

    showChatText: function showChatText(userId, message) {
        if (userId != this.userId) {
            return;
        }

        var chatMessage = this.chatMessageNode.getComponent('ChatMessage');
        chatMessage.setString(message);
    },

    // 用户已经出牌，处于三堆盖着牌的状态
    playCard: function playCard(userId, cardInfo) {
        if (this.userId != userId) {
            return;
        }

        this.cardsBackLayout.node.active = false;
        this.compareCardsNode.active = false;
        this.foldCardNode.targetOff(this.foldCardNode);
        this.foldCardNode.active = true;
        this.foldCardNode.children.slice(0, 3).forEach((function (node) {
            node.active = true;
            node.children.forEach((function (noe) {
                noe.active = true;

                var cardSprite = noe.getComponent('cc.Sprite');

                var path = 'public-pic-card-poker-back';

                this._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);
            }).bind(this));
        }).bind(this));
        this.foldCardNode.on(cc.Node.EventType.TOUCH_END, (function (event) {
            this._clickFoldCardNode(event);
        }).bind(this), this.foldCardNode);
    },

    _clickFoldCardNode: function _clickFoldCardNode(event) {

        if (this.userId != Socket.instance.userInfo.id) return;

        var cardInfo = this._userInfo.cardInfo.length == 1 ? this._userInfo.cardInfo[0].cards : this._userInfo.cardInfo;

        var cards = cardInfo.map((function (cardInfoItem) {

            if (this._userInfo.cardInfo.length == 1) return KQCard.cardsFromArray(cardInfoItem);

            return KQCard.cardsFromArray(cardInfoItem.cards);
        }).bind(this)).reduce(function (array, subCards) {
            return array.concat(subCards);
        }, []);

        var foldCardNode = this.foldCardNode.children.slice(0, 3);

        var nodes = foldCardNode.map(function (node) {
            return node.children;
        }).reduce(function (array, sub) {
            return array.concat(sub);
        }, []);

        cards.forEach((function (kqCard, index) {

            if (index >= nodes.length) return;

            nodes[index].removeAllChildren();

            nodes[index].getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.width = nodes[0].width;

            nodds1.height = nodes[0].height;

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var cardName = this.foldCardNodeBack == false ? kqCard.cardName() : "back";

            nodds1.cardName = cardName;

            var path = 'public-pic-card-poker-' + cardName;

            this._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            if (cc.maPai == cardName) {

                var nodds = new cc.Node(); //创建一个节点对象

                nodds.addComponent(cc.Sprite); //添加精灵组件

                cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                    if (err) {
                        cc.error(err.message || err);return;
                    }

                    var btnSprite1 = nodds.getComponent(cc.Sprite);

                    btnSprite1.spriteFrame = spriteFrame;

                    btnSprite1.node.width = cardSprite.node.width + 10;

                    btnSprite1.node.height = cardSprite.node.height + 10;
                }).bind(this));

                cardSprite.node.addChild(nodds);
            }

            nodes[index].addChild(nodds1);
        }).bind(this));

        var cards0 = cards.slice(0, 3);
        var cards1 = cards.slice(3, 8);
        var cards2 = cards.slice(8, 13);

        cards = [cards0, cards1, cards2];
        //头道
        var typeName0 = KQCard.cardsType(cards0) + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        typeName0 = typeName0 == '04' ? '11' : typeName0;

        //中道
        var typeName1 = KQCard.cardsType(cards1) + 1;
        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;
        typeName1 = typeName1 == '07' ? '22' : typeName1;

        //尾道
        var typeName2 = KQCard.cardsType(cards2) + 1;
        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards, nodes, this.cardSpriteAtlas);
        if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards, nodes, this.cardSpriteAtlas);
        if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards, nodes, this.cardSpriteAtlas);
        if (this.foldCardNodeBack == false) {
            this.foldCardNodeBack = true;
        } else if (this.foldCardNodeBack == true) {
            this.foldCardNodeBack = false;
        }
    },

    _loadCardFrame: function _loadCardFrame(SpriteFrame, path, SpritesNode, w, h) {

        var Sprite = SpriteFrame.getSpriteFrame(path);

        SpritesNode.spriteFrame = Sprite;

        if (w) SpritesNode.node.width = w;

        if (h) SpritesNode.node.height = h;
    },

    // 准备好开始比牌
    // readyToCompareCards: function () {
    //     this.foldCardNode.targetOff(this.foldCardNode);
    //     this.foldCardNodeBack = true;
    //     this._clickFoldCardNode();
    //     this.cardsBackLayout.node.active = false;
    //     this.compareCardsNode.active = true;
    //     //this.foldCardNode.active = false;
    //     if(this.compareCardsNode.getComponent('CompareCards')._user){
    //         if(this.compareCardsNode.getComponent('CompareCards')._user.isContainExtra){
    //             this.teShuPaiNode.active = true;
    //         }else{
    //             this.teShuPaiNode.active = false;
    //         }
    //     }
    // },
    readyToCompareCards: function readyToCompareCards() {
        this.foldCardNode.targetOff(this.foldCardNode);
        this.foldCardNodeBack = true;
        this._clickFoldCardNode();
        this.cardsBackLayout.node.active = false;
        this.compareCardsNode.active = true;
        this.foldCardNode.active = true;
        if (this.compareCardsNode.getComponent('CompareCards')._user) {
            if (this.compareCardsNode.getComponent('CompareCards')._user.isContainExtra) {
                this.teShuPaiNode.active = true;
            } else {
                this.teShuPaiNode.active = false;
            }
        }
    },

    // 播放打枪动画
    // @param userId   要主动打枪的用户id
    // @param toUserIndex  挨枪的用户的 index
    playShootAnimation: function playShootAnimation(userId, toUserIndex) {
        if (userId != this.userId) {
            return;
        }
        var shotNode = this.shotNode[toUserIndex];
        shotNode.active = true;
        shotNode.children[0].active = true;
        shotNode.children[1].active = true;

        //枪
        var rotateBy = cc.rotateTo(0.1, -15);
        var delay1 = cc.delayTime(0.1);
        var rotateBy1 = cc.rotateTo(0.1, 0);
        var start_func1 = cc.callFunc(function () {
            shotNode.children[0].active = true;
        });
        var end_func1 = cc.callFunc(function () {
            shotNode.children[0].active = false;
        });
        var action = cc.repeat(cc.sequence(start_func1, rotateBy, delay1, rotateBy1, end_func1), 3);

        //烟
        var fadeIn = cc.fadeIn(0);
        var scaleTo1 = cc.scaleTo(0, 0.8);
        var scaleTo2 = cc.scaleTo(0.08, 1);
        var fadeOutAndScaleTo = cc.spawn(cc.fadeOut(0.02), cc.scaleTo(0.02, 0.5));
        var delay2 = cc.delayTime(.2);
        var start_func2 = cc.callFunc(function () {
            shotNode.children[1].active = true;
        });
        var end_func2 = cc.callFunc(function () {
            shotNode.children[1].active = false;
        });
        var action1 = cc.repeat(cc.sequence(start_func2, fadeIn, scaleTo1, scaleTo2, fadeOutAndScaleTo, delay2, end_func2), 3);

        shotNode.children[0].runAction(action);
        shotNode.children[1].runAction(action1);

        //let userInfo = this.userInfoNode.getComponent('userInfo');
        //userInfo.playShootAnimation(toUserIndex);
    },

    // 播放中枪动画
    playBulletHoleAnimation: function playBulletHoleAnimation(userId) {
        if (userId != this.userId) {
            return;
        }

        this.bulletHoleNode.active = true;

        var bulletHoleNode = cc.instantiate(this.bulletHolePrefab);

        bulletHoleNode.children.forEach((function (node) {
            node.active = false;
        }).bind(this));

        bulletHoleNode.children[0].y = 0;

        this.bulletHoleNode.addChild(bulletHoleNode);

        var interval = 0.3;

        var initTime = 0;

        bulletHoleNode.children.forEach((function (node) {

            this.scheduleOnce(function () {

                AudioManager.instance.playHumanZQiang();

                node.active = true;

                var y = Math.round(Math.random()) == 0 ? -1 : 1;

                y = Math.floor(Math.random() * 38) * y;

                var x = Math.round(Math.random()) == 0 ? -1 : 1;

                x = Math.floor(Math.random() * 38) * x;

                node.x = x;

                node.y = y;
            }, initTime);

            initTime = initTime + interval;
        }).bind(this));
    },

    // 播放全垒打动画
    playHomeRunAimation: function playHomeRunAimation(userId) {
        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.playHomeRunAimation();
    },

    playSpeakAnimation: function playSpeakAnimation(userId) {
        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.playSpeakAnimation();
    },

    nextCompareScore: function nextCompareScore() {
        if (!this.node.active) {
            return 0;
        }

        var score = this.compareCardsNode.getComponent('CompareCards').nextCompareScore();
        return score;
    },

    showNextCompareCards: function showNextCompareCards() {
        if (this.nextCompareScore() <= 0) {
            return;
        }
        this.teShuPaiNode.active = false;
        this.compareCardsNode.getComponent('CompareCards').showNextCards();
    },

    showAllCompareCards: function showAllCompareCards(users) {
        var user = users.find((function (e) {
            return this.userId == e.id;
        }).bind(this));
        this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
        this.compareCardsNode.getComponent('CompareCards').showAllCards();

        this.updateScore(this._userInfo.totalScore || 0);
    },

    showNextCompareScore: function showNextCompareScore(isContainExtra) {
        this.compareCardsNode.getComponent('CompareCards').showNextCompareScore(isContainExtra);
    },

    showScoreResult: function showScoreResult() {
        this.compareCardsNode.getComponent('CompareCards').showScoreResult();
    }
});

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","AudioManager":"AudioManager","KQCard":"KQCard","KQCardResHelper":"KQCardResHelper","KQGlobalEvent":"KQGlobalEvent","Playback":"Playback","UserModelHelper":"UserModelHelper","socket":"socket"}],"ResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9b2behcoUlLYL1MIMs+04wI', 'ResultItem');
// scripts\Play\ResultItem.js

var KQCardResHelper = require('KQCardResHelper');
var SpriteHelper = require('SpriteHelper');
var KQCard = require('KQCard');

cc.Class({
  'extends': cc.Component,

  properties: {
    avatarSprite: cc.Sprite,
    labelNickname: cc.Label,
    labelResultNumber: cc.Label,
    layoutTouDao: cc.Layout,
    layoutZhongDao: cc.Layout,
    layoutWeiDao: cc.Layout,
    layoutTeShu: cc.Layout,

    labelTeShuPaiTitle: cc.Label,

    scoreUnitNode: cc.Node, // 积分
    diamondUnitNode: cc.Node },

  // 钻石
  onLoad: function onLoad() {},

  //{"id":100049,"nickname":"imya","openId":"xx","avatarUrl":"xx","sex":1,
  // "cardNumber":3,"onlineStatus":1,"inviteCode":"","ipAddress":"::ffff:222.244.65.201",
  // "lastLoginTime":"2017-04-13 22:09:01","createAt":"2017-04-11 22:39:30",
  // "updateAt":"2017-04-13 22:09:01",
  // "cards":[],"roomId":"598883","readyStatus":true,"totalScore":0,
  // "cScore":0,"isBanker":false}
  updateWithPlayerInfo: function updateWithPlayerInfo(playerInfo) {
    var isRandomRoom = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];

    SpriteHelper.setImageUrl(this.avatarSprite, playerInfo.avatarUrl);
    this.labelNickname.string = playerInfo.nickname;
    //cc.log(this.labelResultNumber.string)
    //cc.log(playerInfo)
    //cc.log(playerInfo.cScore)
    //cc.log('---36')
    this.labelResultNumber.string = playerInfo.cScore;

    this.scoreUnitNode.active = !isRandomRoom;
    this.diamondUnitNode.active = isRandomRoom;
    var Number = playerInfo.cScore;
    if (isRandomRoom) {
      // 如果是随机场的话，则显示钻石数量
      Number = playerInfo.cScore * 5;
    }
    this.labelResultNumber.string = Number;
  },

  setCards: function setCards(cards) {
    cc.assert(cards.length == 13);

    // 不会再有特殊牌了
    /*if (KQCard.isTeShuPai(cards)) {
      this.setTeShuCards(cards);
      return;
      }
    */

    //let touCards = cards.slice(0, 3);
    //let zhongCards = cards.slice(3, 3 + 5);
    //let weiCards = cards.slice(8);
    //this.setTouCards(touCards);
    //this.setZhongCards(zhongCards);
    //this.setWeiCards(weiCards);
  }

});
/*setTouCards: function (cards) {
  this._setCardsToLayout(this.layoutTouDao, cards);
},
 setZhongCards: function (cards) {
  this._setCardsToLayout(this.layoutZhongDao, cards);
},
  setWeiCards: function (cards) {
  this._setCardsToLayout(this.layoutWeiDao, cards);
},*/

//结算  将特殊牌放入Layout
/*setTeShuCards: function (cards) {
  this.layoutTeShu.node.active = true;
  this.layoutTouDao.node.active = false;
  this.layoutZhongDao.node.active = false;
  this.layoutWeiDao.node.active = false;
  this._setCardsToLayout(this.layoutTeShu, cards);
   let typeName = KQCard.cardsTypeName(cards);
  this.labelTeShuPaiTitle.string = typeName;
},*/

//结算将牌放到Layout里面
/*_setCardsToLayout: function (layout, cards) {
  let node = layout.node;
  node.children.forEach(function (spriteNode, index) {
    let sprite = spriteNode.getComponent('cc.Sprite');
    let card = cards[index];
    if (!card) {
      return;
    }
     KQCardResHelper.setCardSpriteFrame(sprite, card.cardName());
  });
},*/

cc._RFpop();
},{"KQCard":"KQCard","KQCardResHelper":"KQCardResHelper","SpriteHelper":"SpriteHelper"}],"Setting":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3ad6mNk4BMBZzipGQDNlr4', 'Setting');
// scripts\Setting\Setting.js

var Manager = require('manager');
var KQNativeInvoke = require('KQNativeInvoke');

cc.Class({
  'extends': cc.Component,

  properties: {
    phone: cc.Label,
    musicSlider: cc.Node,
    effectSlider: cc.Node,
    btnSwitchAccount: cc.Button,
    shareBg: cc.Node,
    wx: cc.Node,
    pyq: cc.Node,
    music: cc.Node,
    sounds: cc.Node,
    _audioManager: null,
    _musicOn: 1,
    _soundsOn: 1,
    _phone: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._audioManager = cc.find('AudioManager') || {};
    this._audioManager = this._audioManager.getComponent('AudioManager');
    this._initSliders();
    this.phone.string = this._phone ? this._phone : "无";
    var bgMusic = cc.sys.localStorage.getItem("bgMusic");
    var bgSound = cc.sys.localStorage.getItem("bgSound");
    //console.log(bgMusic);
    if (bgMusic != '') {
      if (parseInt(bgMusic) == 1) {
        this._musicOn = 1;
        this.music.getChildByName('music_on').active = true;
        this.music.getChildByName('music_off').active = false;
      } else {
        this._musicOn = 0;
        this.music.getChildByName('music_on').active = false;
        this.music.getChildByName('music_off').active = true;
      }
    }
    if (bgSound == 0) {
      // 如果背景音效是关闭的
      if (parseInt(bgSound) == 0) {
        this._soundsOn = 0;
        this.sounds.getChildByName('sounds_on').active = false;
        this.sounds.getChildByName('sounds_off').active = true;
      } else {
        this._soundsOn = 1;
        this.sounds.getChildByName('sounds_on').active = true;
        this.sounds.getChildByName('sounds_off').active = false;
      }
      this._audioManager.setEffectMusicVolum(this._soundsOn);
    }
  },
  clickWx: function clickWx() {
    //点击微信
    if (!cc.sys.isNative) {
      this.shareBg.active = true;
      this.wx.active = true;
    } else {
      var title = cc.sys.localStorage.getItem('shareTitle');
      var description = cc.sys.localStorage.getItem('desc');
      var recordId = cc.sys.localStorage.getItem('recordId');
      var roomId = cc.sys.localStorage.getItem('roomId');
      var id = '';
      if (roomId) {
        id = 'roomId=' + roomId;
      }
      if (recordId) {
        id = 'recordId=' + recordId;
      }
      if (KQNativeInvoke.isNativeIOS()) {
        jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
      } else if (KQNativeInvoke.isNativeAndroid()) {
        //Android
        var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
        jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
      }
    }
  },
  clickPyq: function clickPyq() {
    //点击朋友圈
    if (!cc.sys.isNative) {
      this.shareBg.active = true;
      this.pyq.active = true;
    } else {
      var title = cc.sys.localStorage.getItem('shareTitle');
      var description = cc.sys.localStorage.getItem('desc');
      var recordId = cc.sys.localStorage.getItem('recordId');
      var roomId = cc.sys.localStorage.getItem('roomId');
      var id = '';
      if (roomId) {
        id = 'roomId=' + roomId;
      }
      if (recordId) {
        id = 'recordId=' + recordId;
      }
      if (KQNativeInvoke.isNativeIOS()) {
        jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline:description:", id, description, title);
      } else if (KQNativeInvoke.isNativeAndroid()) {
        //Android
        var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
        jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
      }
    }
  },

  clickshareBg: function clickshareBg() {
    // 点击分享背景图
    this.shareBg.active = false;
    this.wx.active = false;
    this.pyq.active = false;
  },
  clickMusic: function clickMusic() {
    //点击音乐
    this.music.children[1].active = this._musicOn = !this._musicOn;
    this.music.children[2].active = !this._musicOn;
    var volume = 0;
    if (this._musicOn) {
      this._audioManager.setBgMusicVolumn(1);
      this._audioManager.playMusic();
      volume = 1;
    } else {
      this._audioManager.setBgMusicVolumn(0);
      volume = 0;
    }
    cc.sys.localStorage.setItem("bgMusic", volume);
  },

  clickSounds: function clickSounds() {
    //点击了音效
    this.sounds.children[1].active = this._soundsOn = !this._soundsOn;
    this.sounds.children[2].active = !this._soundsOn;
    var volume = 0;
    if (this._soundsOn) {
      this._audioManager.setEffectMusicVolum(1);
      volume = 1;
    } else {
      this._audioManager.setEffectMusicVolum(0);
      volume = 0;
    }
    cc.sys.localStorage.setItem("bgSound", volume);
  },
  clickSetting: function clickSetting() {//点击设置

  },
  _initSliders: function _initSliders() {
    this._initSliderEvents();

    var musicVal = Manager.getMusicValue();
    var effectVal = Manager.getMusicEffectValue();

    this._audioManager.setBgMusicVolumn(musicVal);
    this._audioManager.setEffectMusicVolum(effectVal);

    this.musicSlider.getComponent('slider').setValue(musicVal);
    this.effectSlider.getComponent('slider').setValue(effectVal);
  },

  _initSliderEvents: function _initSliderEvents() {
    var self = this;
    this.musicSlider.getComponent('slider').onValueChange = function (value) {
      Manager.setMusicValue(value);
      self._audioManager.setBgMusicVolumn(value);
    };

    this.effectSlider.getComponent('slider').onValueChange = function (value) {
      Manager.setMusicEffectValue(value);
      self._audioManager.setEffectMusicVolum(value);
    };
  },

  clickSwitch: function clickSwitch() {},

  hideSwitch: function hideSwitch() {
    if (this.btnSwitchAccount) {
      this.btnSwitchAccount.node.active = false;
    }
  }
});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"SpriteHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '936f2uPA8NAuqUZv0R8ZxgP', 'SpriteHelper');
// scripts\Extensions\SpriteHelper.js

var SpriteHelper = {
  setImageUrl: function setImageUrl(sprite, url) {
    if (url.endsWith("png") || url.endsWith("jpg") || url.endsWith("gif")) {} else {
      //url = url + ".png";
    }

    cc.loader.load({ url: url, type: "jpg" }, function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      sprite.spriteFrame = frame;
    });
  }
};

module.exports = SpriteHelper;

cc._RFpop();
},{}],"StringExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7b106eQ/I5F1J85hMxFBIlw', 'StringExtension');
// scripts\Extensions\StringExtension.js

// 给 String 添加功能

// str.startsWith("");
// str.endsWith("");

if (!String.prototype.startsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`
		var defineProperty = (function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		})();
		var toString = ({}).toString;
		var startsWith = function startsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var position = arguments.length > 1 ? arguments[1] : undefined;
			// `ToInteger`
			var pos = position ? Number(position) : 0;
			if (pos != pos) {
				// better `isNaN`
				pos = 0;
			}
			var start = Math.min(Math.max(pos, 0), stringLength);
			// Avoid the `indexOf` call if no match is possible
			if (searchLength + start > stringLength) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'startsWith', {
				'value': startsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.startsWith = startsWith;
		}
	})();
}

// str.endsWith("");
if (!String.prototype.endsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`
		var defineProperty = (function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		})();
		var toString = ({}).toString;
		var endsWith = function endsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var pos = stringLength;
			if (arguments.length > 1) {
				var position = arguments[1];
				if (position !== undefined) {
					// `ToInteger`
					pos = position ? Number(position) : 0;
					if (pos != pos) {
						// better `isNaN`
						pos = 0;
					}
				}
			}
			var end = Math.min(Math.max(pos, 0), stringLength);
			var start = end - searchLength;
			if (start < 0) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'endsWith', {
				'value': endsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.endsWith = endsWith;
		}
	})();
}

cc._RFpop();
},{}],"TotalGameResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1c6f93a1BOnoSiX6kJ0Efn', 'TotalGameResultItem');
// scripts\Play\TotalGameResultItem.js

var SpriteHelper = require('SpriteHelper');
cc.Class({
  "extends": cc.Component,

  properties: {
    avatarSprite: cc.Sprite,
    labelUserId: cc.Label,
    labelScore: cc.Label,
    labelNickname: cc.Label,

    _deskInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setUserInfo: function setUserInfo(user, deskInfo) {
    if (!user) {
      return;
    }

    var totalScore = user.totalScore;
    if (deskInfo && (deskInfo.setting1 == 0 || deskInfo.setting1 == 1)) {
      var baseScore = deskInfo.setting1 == 0 ? 100 : 200;
      totalScore = totalScore - baseScore;
    }

    SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);
    this.labelUserId.string = "" + user.id;
    this.labelScore.string = totalScore > 0 ? "+ " + totalScore : "- " + totalScore * -1;
    if (totalScore == 0) {
      this.labelScore.string = "0";
    }
    this.labelNickname.string = user.nickname;
  }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"TotalGameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f7fb2e7foJFNJzjdtbAtk7O', 'TotalGameResult');
// scripts\Play\TotalGameResult.js

var KQNativeInvoke = require('KQNativeInvoke');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        itemLayout: cc.Layout,
        itemPrefab: cc.Prefab,
        timeLabel: cc.Label, // 时间
        jushuLabel: cc.Label, // 局数
        roomId: cc.Label, // 房间号
        nicknameLabels: cc.Label,
        recordInfo_sview: [cc.Node],

        sharrBg: cc.Node,
        btnWeiXin: cc.Node,
        btnGongXuoHao: cc.Node,
        btnZhuShou: cc.Node,
        btnZongFen: cc.Node,

        suanfen_sview: cc.Node,
        suanFenPrefab: cc.Prefab,
        suanFenBgPrefab: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {},

    onDisable: function onDisable() {
        //if(cc.sys.isBrowser){
        //
        var shareTitle = '开房玩[大众十三水]';
        var desc = '开好房了，就等你们一起来[大众十三水]啦！晚了位置就没了哟~';
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);

        // cc.sys.localStorage.removeItem("shareTitle");
        // cc.sys.localStorage.removeItem("desc");
        cc.sys.localStorage.removeItem("recordId");
        //cc.sys.localStorage.setItem("roomId",'');
        if (window.shareToTimeLine) {
            window.shareToTimeLine();
        }
        if (window.shareToSession) {
            window.shareToSession();
        }
        //}
    },
    js: function js(setting2) {
        var jushu = 5;
        switch (setting2) {
            case 0:
                jushu = 5;break;case 1:
                jushu = 10;break;
            case 2:
                jushu = 20;break;case 3:
                jushu = 30;break;
        }
        return jushu;
    },

    creator: function creator(_creator, players) {
        //创房者
        for (var i = 0; i < players.length; i++) {
            if (players[i].id == _creator) {
                return i;
            }
        }
    },

    _clickBtn: function _clickBtn() {
        this.btnZhuShou.active = true;
        this.btnZongFen.active = false;
    },

    clickZongFen: function clickZongFen() {

        this.btnZhuShou.active = true;

        this.btnZongFen.active = false;

        this.recordInfo_sview.forEach(function (node) {
            node.active = true;
        });

        this.suanfen_sview.active = false;
    },
    _globalMsg: function _globalMsg(recordInfo) {
        //if(cc.sys.isBrowser) {
        var roomId = "房间号：" + recordInfo.roomId;
        var pj = ["5 ", "10 ", "20 "];
        var js = "局数：" + pj[recordInfo.setting1 - 2];
        var time = "时间：" + (recordInfo.createAt ? recordInfo.createAt : recordInfo.createTime);
        var shareTitle = "[大众十三水]战绩";
        var desc = roomId + js + time + " 点击查看详情";
        var recordId = recordInfo.id != undefined ? recordInfo.id : recordInfo.recordId;
        cc.sys.localStorage.setItem("shareTitle", shareTitle);
        cc.sys.localStorage.setItem("desc", desc);
        cc.sys.localStorage.setItem("recordId", recordId);
        cc.sys.localStorage.setItem("roomId", '');

        if (window.shareToTimeLine) {
            window.shareToTimeLine();
        }
        if (window.shareToSession) {
            window.shareToSession();
        }
        //}
    },
    //大局
    setPlayerInfos: function setPlayerInfos(playerInfos, deskInfo) {
        playerInfos.sort(function (a, b) {
            return b.totalScore - a.totalScore;
        }); // 排序
        // cc.log(playerInfos)
        // cc.log(deskInfo)
        // cc.log('--65')

        this._globalMsg(deskInfo);
        this.recordInfo_sview.forEach(function (node) {
            node.active = true;
        });

        this.suanfen_sview.active = false;

        this.btnZhuShou.active = true;

        this.btnZongFen.active = false;

        this._playerInfos = playerInfos;

        this._deskInfo = deskInfo;

        var createId = deskInfo.createUserId ? deskInfo.createUserId : deskInfo.createId;

        var nickname = playerInfos[this.creator(createId, playerInfos)].nickname;

        this.roomId.string = deskInfo.roomId;

        var createAt = deskInfo.createAt ? deskInfo.createAt : deskInfo.createTime;

        this.timeLabel.string = createAt.substr(0, 11);

        this.jushuLabel.string = this.js(deskInfo.setting1 - 2);

        this.nicknameLabels.string = nickname;

        this.itemLayout.node.removeAllChildren();

        playerInfos.forEach((function (user) {

            var item = cc.instantiate(this.itemPrefab);

            item.getComponent('TotalGameResultItem').setUserInfo(user, deskInfo);

            if (deskInfo.createUserId == user.id || deskInfo.createId == user.id) {

                item.children[1].children[0].active = true;
            } else {

                item.children[1].children[0].active = false;
            }

            this.itemLayout.node.addChild(item);
        }).bind(this));
    },

    //算分能手
    clickSuanFen: function clickSuanFen() {

        this.btnZhuShou.active = false;

        this.btnZongFen.active = true;

        this.recordInfo_sview.forEach(function (node) {
            node.active = false;
        });

        this.suanfen_sview.active = true;

        var playersRigth = this._playerInfos.filter(function (player) {
            return player.totalScore > 0;
        });

        var playersLeft = this._playerInfos.filter(function (player) {
            return player.totalScore < 0;
        });

        var playersRigthScore = playersRigth.map(function (player) {
            return player.totalScore;
        });

        var playersLeftScore = playersLeft.map(function (player) {
            return player.totalScore * -1;
        });

        var playersIndex = [],
            arrs = [playersRigthScore.filter(function (i) {
            return i;
        }), playersLeftScore.filter(function (i) {
            return i;
        })],
            indexs = playersLeftScore.length > playersRigthScore.length ? 0 : 1; //1是赢的人 0输的人

        // for(var i = 0;i < arrs[indexs].length; i++){

        //     var score = arrs[indexs][i];

        //     var d = this.getCombBySum(arrs[indexs==1?0:1], score)[0] || [];

        //     if(d.length > 0){

        //         playersIndex.push([score,d]);

        //         d.forEach(function (s) {

        //             var index = arrs[indexs==1?0:1].indexOf(s);

        //             if(index != -1) arrs[indexs==1?0:1].splice(index,1);

        //         });
        //     }
        // }

        // if(playersIndex.length == 0) indexs = 2;
        indexs = 2;
        this.suanfen_sview.children[0].removeAllChildren();

        playersLeft.forEach((function (user, index) {

            var suanFenBgPrefab = cc.instantiate(this.suanFenBgPrefab);

            suanFenBgPrefab.removeAllChildren();

            this._ctarePrefab(1, suanFenBgPrefab, user, user.totalScore, this._deskInfo, -200, 0);

            var x = 0,
                y = 0;

            if (indexs == 1) {
                for (var j = 0; j < playersIndex[index][1].length; j++) {

                    var s = playersIndex[index][1][j];

                    var d = playersRigthScore.indexOf(s);

                    if (d != -1) {

                        var plays = playersRigth.splice(d, 1)[0];

                        playersRigthScore.splice(d, 1);

                        if (plays) {

                            if (suanFenBgPrefab.childrenCount >= 3) y = -90;

                            if (suanFenBgPrefab.childrenCount == 3) x = 0;

                            if (suanFenBgPrefab.childrenCount >= 5) y = -180;

                            if (suanFenBgPrefab.childrenCount == 5) x = 0;

                            this._ctarePrefab(0, suanFenBgPrefab, plays, plays.totalScore, this._deskInfo, x, y);

                            x += 200;
                        }
                    }
                }
            } else if (indexs == 0) {
                var fen = suanFenBgPrefab.children[0].getChildByName("fen").getComponent(cc.Label).string.substr(3) * -1;

                for (var j = 0; j < playersIndex.length; j++) {

                    var s = playersIndex[j];

                    var d = s[1].indexOf(fen);

                    var q = s[0];

                    var w = playersRigthScore.indexOf(q);

                    if (d != -1 && w != -1) {

                        var plays = playersRigth[w];

                        this._ctarePrefab(0, suanFenBgPrefab, plays, plays.totalScore, this._deskInfo, x, y, fen);
                    }
                }
            } else {
                var q = playersLeftScore[index];
                var addScore = 0;
                var arr = [];
                for (var j = 0; j < playersRigthScore.length; j++) {
                    var w = playersRigthScore[j];
                    if (addScore < q) {
                        addScore += w;
                        if (addScore > q) {
                            arr.push(w - (addScore - q));
                        } else {
                            arr.push(w);
                        }
                        if (q - w >= 0) {
                            playersRigthScore[j] = 0;
                        }
                    }
                    if (addScore > q) {
                        playersRigthScore[j] = addScore - q;
                        break;
                    }
                }

                for (var t = 0; t < arr.length; t++) {
                    var r = arr[t];
                    if (r == 0) continue;
                    if (suanFenBgPrefab.childrenCount >= 3) y = -90;

                    if (suanFenBgPrefab.childrenCount == 3) x = 0;

                    if (suanFenBgPrefab.childrenCount >= 5) y = -180;

                    if (suanFenBgPrefab.childrenCount == 5) x = 0;

                    var plays = playersRigth[t];

                    this._ctarePrefab(0, suanFenBgPrefab, plays, r, this._deskInfo, x, y);

                    x += 200;
                }
            }

            this.suanfen_sview.children[0].addChild(suanFenBgPrefab);
        }).bind(this));
    },

    _ctarePrefab: function _ctarePrefab(shu, node, user, totalScore, deskInfo, x, y) {
        var fen = arguments.length <= 7 || arguments[7] === undefined ? null : arguments[7];

        var suanFenPrefab = cc.instantiate(this.suanFenPrefab);

        suanFenPrefab.getChildByName("ID").getComponent(cc.Label).string = "ID:" + user.id;

        if (deskInfo.createUserId == user.id) suanFenPrefab.getChildByName("ID").color = new cc.Color(235, 115, 122);

        suanFenPrefab.getChildByName("shu").getComponent(cc.Label).string = shu == 0 ? "输" : "";

        var str = shu == 0 ? totalScore + "分" : "总分:" + totalScore;

        if (fen) str = fen + "分";

        suanFenPrefab.getChildByName("fen").getComponent(cc.Label).string = str;

        var sprite = suanFenPrefab.getChildByName("haed").getComponent(cc.Sprite);

        var headUrl = user.avatarUrl; // 头像URL

        cc.loader.load({ url: headUrl, type: "jpg" }, function (err, tex) {

            if (!err) {

                var frame = new cc.SpriteFrame(tex);

                sprite.spriteFrame = frame;

                sprite.node.height = 55;

                sprite.node.width = 55;
            }
        });

        suanFenPrefab.x = x;

        suanFenPrefab.y = y;

        node.height = 90 + y * -1;

        node.addChild(suanFenPrefab);
    },

    clickExit: function clickExit() {
        Socket.sendOnceAgain('false', this._userId);
        cc.director.loadScene('hall');
    },

    clickShareWeiChat: function clickShareWeiChat() {
        if (!cc.sys.isNative) {
            this.sharrBg.active = true;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
            } else {
                //Android
                KQNativeInvoke.screenshotShare();
            }
        }
    },
    clickShareBg: function clickShareBg() {
        this.sharrBg.active = false;
    },
    clickSharePengYouQuan: function clickSharePengYouQuan() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
        }
    },

    getCombBySum: function getCombBySum(array, sum, tolerance, targetCount) {
        var util = {
            /*
             get combination from array
             arr: target array
             num: combination item length
             return: one array that contain combination arrays
             */
            getCombination: function getCombination(arr, num) {
                var r = [];
                (function f(t, a, n) {
                    if (n == 0) {
                        return r.push(t);
                    }
                    for (var i = 0, l = a.length; i <= l - n; i++) {
                        f(t.concat(a[i]), a.slice(i + 1), n - 1);
                    }
                })([], arr, num);
                return r;
            },
            //take array index to a array
            getArrayIndex: function getArrayIndex(array) {
                var i = 0,
                    r = [];
                for (i = 0; i < array.length; i++) {
                    r.push(i);
                }

                return r;
            }
        },
            logic = {
            //sort the array,then get what's we need
            init: function init(array, sum) {
                //clone array
                var _array = array.concat(),
                    r = [],
                    i = 0;
                //sort by asc
                _array.sort(function (a, b) {
                    return a - b;
                });
                //get all number when it's less than or equal sum
                for (i = 0; i < _array.length; i++) {
                    if (_array[i] <= sum) {
                        r.push(_array[i]);
                    } else {
                        break;
                    }
                }

                return r;
            },
            //important function
            core: function core(array, sum, arrayIndex, count, r) {
                var i = 0,
                    k = 0,
                    combArray = [],
                    _sum = 0,
                    _cca = [],
                    _cache = [];

                if (count == _returnMark) {
                    return;
                }
                //get current count combination
                combArray = util.getCombination(arrayIndex, count);
                for (i = 0; i < combArray.length; i++) {
                    _cca = combArray[i];
                    _sum = 0;
                    _cache = [];
                    //calculate the sum from combination
                    for (k = 0; k < _cca.length; k++) {
                        _sum += array[_cca[k]];
                        _cache.push(array[_cca[k]]);
                    }
                    if (Math.abs(_sum - sum) <= _tolerance) {
                        r.push(_cache);
                    }
                }

                logic.core(array, sum, arrayIndex, count - 1, r);
            }

        },
            r = [],
            _array = [],
            _targetCount = 0,
            _tolerance = 0,
            _returnMark = 0;

        //check data
        _targetCount = targetCount || _targetCount;
        _tolerance = tolerance || _tolerance;

        _array = logic.init(array, sum);
        if (_targetCount) {
            _returnMark = _targetCount - 1;
        }

        logic.core(_array, sum, util.getArrayIndex(_array), _targetCount || _array.length, r);

        return r;
    }
});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","socket":"socket"}],"UserModelHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98854aScapF5oQnHKxJsvmF', 'UserModelHelper');
// scripts\ModelUtils\UserModelHelper.js

var UserModelHelper = {
  // 用户是否已出牌
  isPlayedCards: function isPlayedCards(user) {
    cc.assert(user);

    if (user && user.cardInfo && user.cardInfo.length > 0) {
      return true;
    }

    return false;
  },

  // 用户是否已准备
  isUserReady: function isUserReady(user) {
    return user.readyStatus == true;
  }
};

module.exports = UserModelHelper;

cc._RFpop();
},{}],"UserSampleInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3a9f7A0IgRGPrAZvy1p9s4i', 'UserSampleInfo');
// scripts\Play\UserSampleInfo.js

var SpriteHelper = require('SpriteHelper');

cc.Class({
  'extends': cc.Component,

  properties: {
    labelUserId: cc.Label,
    labelUserIP: cc.Label,
    labelNickname: cc.Label,
    avatarSprite: cc.Sprite,
    manSprite: cc.Sprite,
    womenSprite: cc.Sprite,

    _didShowUserInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  updateWithUser: function updateWithUser(user) {
    return;
    if (!user) {
      return;
    }

    if (this._didShowUserInfo == user) {
      this.unscheduleAllCallbacks();
      this._disappearUserInfo();
      return;
    }

    this._didShowUserInfo = user;
    if (!this.node.active) {
      this.node.getComponent('alert').alert();
    }

    this.unscheduleAllCallbacks();
    this.scheduleOnce((function () {
      this._disappearUserInfo();
    }).bind(this), 5);

    this.labelUserId.string = "UID:\n" + user.id;
    this.labelUserIP.string = "用户IP:\n" + user.ipAddress.replace("::ffff:", "");
    this.labelNickname.string = user.nickname;
    this.avatarSprite.spriteFrame = null;
    SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);

    var sex = user.sex; // sex: 1 男  2 女
    this.manSprite.node.active = sex == 1;
    this.womenSprite.node.active = sex != 1;
  },

  _disappearUserInfo: function _disappearUserInfo() {
    this.node.active = false;
    this._didShowUserInfo = null;
  }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"agreement":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8f601dzNnZLtq+KGT0uqDqF', 'agreement');
// scripts\agreement.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');
cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        agreement: {
            'default': null,
            type: cc.Label
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        // cc.log('----61')
        //  cc.log(this.agreement)
    },
    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (!response.result) {
            return;
        }
        var s = cc.find('Canvas/agreement');
        var data = response.data;
        //this._info1 = response.data;
        // cc.log(this.agreement)
        // cc.log(s)
        // cc.log('----61')
        this.agreement.string = data.info1 || "";
    }
});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"alert":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16cd2qs73lByZaHhJkQAEee', 'alert');
// scripts\alert.js

var AudioManager = require('AudioManager');
cc.Class({
  'extends': cc.Component,

  properties: {
    // foo: {
    //    default: null,      // The default value will be used only when the component attaching
    //                           to a node for the first time
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    popNode: cc.Node,
    label: cc.Label,

    _alertCallback: null,
    _willDismissCallback: null,
    _dismissCallback: null,
    _confirmCallback: null, // 点击确定后的回调
    _tishi: null,
    _card_num: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  alert: function alert() {
    this.node.active = true;
    var anim = this.popNode.getComponent(cc.Animation);
    anim.play('pop');

    if (this._alertCallback) {
      this._alertCallback(this.node);
    }
  },
  /*#####弹出结果*/
  alertResult: function alertResult() {
    this.node.active = true;
    cc.find("Canvas/show_result").active = false;
    var anim = this.popNode.getComponent(cc.Animation);
    anim.play('pop');

    if (this._alertCallback) {
      this._alertCallback(this.node);
    }
  },

  /*#####点击确定*/
  playBtnClickSFX: function playBtnClickSFX() {
    AudioManager.instance.playBtnClickSFX();
  },

  /*#####点击取消*/
  palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
    AudioManager.instance.palyBtnCancelClickSFX();
  },

  /*#####点击关闭或者按键之类的按钮，播放音效*/
  palyBtnPublicSFX: function palyBtnPublicSFX() {
    AudioManager.instance.palyBtnPublicSFX();
  },

  /*#####点击创建房间，播放音效*/
  palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
    AudioManager.instance.palyBtnCreateRoomSFX();
  },
  /*#####点击创建房间，播放音效*/
  palyWindowSFX: function palyWindowSFX() {
    AudioManager.instance.palyWindowSFX();
  },

  palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
    AudioManager.instance.palyWeiXinLoginSFX();
  },
  palyFangPaiSFX: function palyFangPaiSFX() {
    AudioManager.instance.palyFangPaiSFX();
  },

  dismissAction: function dismissAction() {
    var willDismissCallback = this._willDismissCallback;
    if (willDismissCallback) {
      var result = willDismissCallback();
      if (result) {
        this.dismissComplete();
        return;
      }
    }

    var anim = this.popNode.getComponent(cc.Animation);
    var dismissAnim = anim.getAnimationState('pop_dismiss');
    dismissAnim.on('finished', this.dismissComplete, this);
    anim.play('pop_dismiss');
  },

  /*#####隐藏结果页面*/
  dismissActionResult: function dismissActionResult() {
    var willDismissCallback = this._willDismissCallback;
    if (willDismissCallback) {
      var result = willDismissCallback();
      if (result) {
        this.dismissComplete();
        return;
      }
    }

    var anim = this.popNode.getComponent(cc.Animation);
    var dismissAnim = anim.getAnimationState('pop_dismiss');
    dismissAnim.on('finished', this.dismissComplete, this);
    anim.play('pop_dismiss');
    cc.find("Canvas/show_result").active = true;
  },

  dismissComplete: function dismissComplete() {
    this.node.active = false;

    if (this.onDismissComplete) {
      this.onDismissComplete();
    }

    if (this._dismissCallback) {
      this._dismissCallback(this.node);
    }
  },
  dismissPlay: function dismissPlay() {
    cc.director.loadScene("hall");
  },

  onDismissComplete: function onDismissComplete() {
    //cc.log("onDismissComplete");
  },

  doneAction: function doneAction() {
    this.dismissAction();
    this.onDoneAction();

    var confirmCallback = this._confirmCallback;
    if (confirmCallback) {
      confirmCallback(this.node);
    }
  },

  onDoneAction: function onDoneAction() {},

  setMessage: function setMessage(msg) {
    this.label.string = msg;
  },

  getMessage: function getMessage() {
    return this.label.string;
  },

  setAlertCallbck: function setAlertCallbck(callback) {
    this._alertCallback = callback;
  },

  setWillDismissCallback: function setWillDismissCallback(callback) {
    this._willDismissCallback = callback;
  },

  setDismissCallback: function setDismissCallback(callback) {
    this._dismissCallback = callback;
  },

  setConfirmCallback: function setConfirmCallback(callback) {
    this._confirmCallback = callback;
  }

});
/*setMessage: function (message) {
  this.label.getComponent('cc.Label').string = message;
},*/

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"AudioManager":"AudioManager"}],"animation":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c9ee9y0ua5NRLSZAxQqDjdw', 'animation');
// scripts\animation.js

/**
 *  房间特殊牌动画
 *
 *
 *
 * 
 */
cc.Class({
    "extends": cc.Component,

    properties: {
        fapaiNode: cc.Prefab, //
        liuduiban: cc.Prefab,
        santonghua: cc.Prefab,
        sanshunzi: cc.Prefab,
        quanleida: cc.Prefab,
        qinglong: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {},
    fapaiAnimation: function fapaiAnimation() {
        var fapai = this.node.getChildByName('fapai');
        fapai = cc.removeSelf();
        var fapaiAnim = cc.instantiate(this.fapaiNode);
        this.node.addChild(fapaiAnim);

        var Lgun = fapaiAnim.getChildByName("left_gang"); // 左边的抢
        var Rgun = fapaiAnim.getChildByName("right_gang"); // 右边的抢
        var mask = fapaiAnim.getChildByName("mask");
        /* -----------start及子节点----------- */
        var start = fapaiAnim.getChildByName("start"),
            quan = start.getChildByName("quan"),
            baodian = start.getChildByName("baodian"),
            ditan = start.getChildByName("ditan"),
            beginIco = start.getChildByName("begin_icon"),
            title = start.getChildByName("title"),
            rWing = start.getChildByName("rWing"),
            lWing = start.getChildByName("lWing");
        /* --------------------------------- */
        var self = this;
        fapaiAnim.active = true;
        mask.runAction(cc.scaleTo(0.2, 10, 10));
        Lgun.runAction(cc.sequence(self.LgunAction()));
        Rgun.runAction(cc.sequence(self.RgunAction()));

        var startFinished = cc.callFunc(function () {
            rWing.active = true;
            lWing.active = true;
            lWing.runAction(cc.sequence(cc.repeat(cc.sequence(cc.skewTo(0.05, 20, -10), cc.skewTo(0.05, 0, 0)), 3), cc.fadeOut(0)));
            rWing.runAction(cc.sequence(cc.repeat(cc.sequence(cc.skewTo(0.05, 20, -10), cc.skewTo(0.05, 0, 0)), 3), cc.fadeOut(0)));
        });
        var wingFinished = cc.callFunc(function () {
            setTimeout(function () {
                start.runAction(cc.scaleTo(0.2, 0, 0));
            }, 500);
        });
        setTimeout(function () {
            start.active = true;
            start.runAction(cc.sequence(cc.scaleTo(0.2, 1.5, 1.5), cc.scaleTo(0.2, 1, 1), startFinished, wingFinished));
            quan.runAction(cc.sequence(cc.scaleTo(0.2, 10, 10), cc.fadeOut(0)));
            baodian.runAction(cc.sequence(cc.scaleTo(0.2, 1.5, 1.5), cc.fadeOut(0)));
        }, 400);
        setTimeout(function () {
            lWing.active = false;
            rWing.active = false;
            start.active = false;
            fapaiAnim.active = false;
            fapaiAnim.removeFromParent(true);
        }, 2000);
    },
    LgunAction: function LgunAction() {
        // 左边的枪
        return [cc.spawn([cc.moveTo(0.2, cc.v2(-430, 152)), cc.scaleTo(0.2, 2, 2)]), cc.spawn([cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(-220, 0)), cc.rotateTo(0.2, 35)]), cc.fadeOut(0)];
    },
    RgunAction: function RgunAction() {
        // 右边的枪
        return [cc.spawn([cc.moveTo(0.2, cc.v2(430, 152)), cc.scaleTo(0.2, -2, 2)]), cc.spawn([cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(220, 0)), cc.rotateTo(0.2, -35)]), cc.fadeOut(0)];
    },
    _bezier1: function _bezier1(index) {
        var bezier = [];
        bezier[0] = [[cc.v2(100, 74), cc.v2(150, 174), cc.v2(200, -174)], cc.v2(100, 74)];
        bezier[1] = [[cc.v2(-72, 284), cc.v2(-122, 384), cc.v2(-222, -150)], cc.v2(-72, 284)];
        bezier[2] = [[cc.v2(-70, 200), cc.v2(-120, 300), cc.v2(-220, -200)], cc.v2(-70, 200)];
        bezier[3] = [[cc.v2(-123, 213), cc.v2(-173, 313), cc.v2(-273, -160)], cc.v2(-123, 213)];
        bezier[4] = [[cc.v2(110, 237), cc.v2(160, 337), cc.v2(260, -177)], cc.v2(210, 237)];
        bezier[5] = [[cc.v2(183, 115), cc.v2(233, 215), cc.v2(333, -155)], cc.v2(183, 115)];
        bezier[6] = [[cc.v2(92, 116), cc.v2(142, 216), cc.v2(242, -146)], cc.v2(92, 116)];
        bezier[7] = [[cc.v2(-26, 124), cc.v2(-76, 224), cc.v2(-176, -164)], cc.v2(-26, 124)];
        bezier[8] = [[cc.v2(-110, 81), cc.v2(-220, 131), cc.v2(-460, -180)], cc.v2(-110, 81)];
        bezier[9] = [[cc.v2(-125, 33), cc.v2(-225, 133), cc.v2(-275, -133)], cc.v2(-125, 33)];
        bezier[10] = [[cc.v2(0, 0), cc.v2(50, 100), cc.v2(150, -150)], cc.v2(0, 0)];
        bezier[11] = [[cc.v2(-235, 5), cc.v2(-275, 105), cc.v2(-375, -186)], cc.v2(-235, 5)];
        bezier[12] = [[cc.v2(-80, 4), cc.v2(-130, 104), cc.v2(-230, -233)], cc.v2(-80, 4)];
        bezier[13] = [[cc.v2(100, -7), cc.v2(150, 107), cc.v2(250, -177)], cc.v2(100, -7)];
        bezier[14] = [[cc.v2(154, 23), cc.v2(204, 113), cc.v2(254, -173)], cc.v2(254, 23)];
        return bezier[index];
    },
    // 青龙动画
    _qinglongAniamtion: function _qinglongAniamtion(type) {
        var qinglong = cc.instantiate(this.qinglong);
        this.node.addChild(qinglong);
        var bg = qinglong.getChildByName('bg');
        var title = '';
        if (type == "ql") {
            title = qinglong.getChildByName('qlongtitle');
        } else {
            title = qinglong.getChildByName('longtitle');
        }

        var yun1 = qinglong.getChildByName('yun1');
        var yun2 = qinglong.getChildByName('yun2');
        var yun3 = qinglong.getChildByName('yun3');
        var yun4 = qinglong.getChildByName('yun4');
        var long = qinglong.getChildByName("long");

        var hua1 = qinglong.getChildByName('hua1');
        var hua2 = qinglong.getChildByName('hua2');
        var hua3 = qinglong.getChildByName('hua3');
        var A = [],
            B = [],
            C = [];
        var hua = [];

        var test = cc.instantiate(hua1);

        var self = this;
        for (var i = 0; i < 5; i++) {
            A[i] = cc.instantiate(hua1);
            A[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(A[i]);
            B[i] = cc.instantiate(hua2);
            B[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(B[i]);
            C[i] = cc.instantiate(hua3);
            C[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(C[i]);
        };
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), cc.scaleTo(0.2, 2, 2), cc.spawn(cc.scaleTo(0.2, 1.5, 1.5), longStart)));
        });
        var longStart = cc.callFunc(function () {
            long.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 0.5)), cc.scaleTo(0.1, 3, 3), cc.spawn(cc.scaleTo(0.1, 1, 1), yunStart)));
        });
        var flowerStart = cc.callFunc(function () {});
        var yunStart = cc.callFunc(function () {
            yun1.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(-334, 234)), cc.moveTo(0.2, cc.v2(-344, 234))), 3)));
            yun2.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(-368, -82)), cc.moveTo(0.2, cc.v2(-358, -82))), 3)));
            yun3.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(408, -4)), cc.moveTo(0.2, cc.v2(398, -4))), 3)));
            yun4.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(406, 181)), cc.moveTo(0.2, cc.v2(416, 181))), 3)));
            for (var i = 1; i < hua.length; i++) {
                hua[i].setPosition(self._bezier(i)[1]);
                qinglong.addChild(hua[i]);
                hua[i].runAction(cc.sequence(cc.spawn(cc.bezierTo(0.3, self._bezier(i)[0]), cc.scaleTo(0.3, 1, 1), cc.fadeTo(0.3, 0))));
            }
            setTimeout(function () {
                qinglong.removeFromParent(true);
            }, 1500);
            //yun1
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.scaleTo(0.2, 2, 2));
    },
    // 三顺子动画
    _sanshunziAnimation: function _sanshunziAnimation() {
        var sanshunzi = cc.instantiate(this.sanshunzi);
        this.node.addChild(sanshunzi);
        var bg = sanshunzi.getChildByName('bg');
        var Ltu = sanshunzi.getChildByName('Ltu');
        var Rtu = sanshunzi.getChildByName('Rtu');
        var title = sanshunzi.getChildByName('title');
        var zushun1 = sanshunzi.getChildByName('zushun1');
        var zushun2 = sanshunzi.getChildByName('zushun2');
        var zushun3 = sanshunzi.getChildByName('zushun3');
        var zushun4 = sanshunzi.getChildByName('zushun4');
        var zushun5 = sanshunzi.getChildByName('zushun5');
        var self = this;
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.2, 2.5, 2.5), titleScale));
            Ltu.runAction(cc.sequence(cc.fadeTo(0.2, 255)));
            Rtu.runAction(cc.sequence(cc.fadeTo(0.2, 255)));
        });
        var titleScale = cc.callFunc(function () {
            // title放大完成后 竹笋2和3同时进行
            title.runAction(cc.scaleTo(0.2, 1.5, 1.5));
            zushun2.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10), ZS1));
            zushun3.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 22, 22)), cc.scaleTo(0.2, 20, 20), ZS4));
            setTimeout(function () {
                zushun5.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10)));
            }, 100);
            setTimeout(function () {
                self.sanshunzi.active = false;
                sanshunzi.removeFromParent(true);
            }, 2000);
        });
        var ZS1 = cc.callFunc(function () {
            zushun1.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10)));
        });
        var ZS4 = cc.callFunc(function () {
            zushun4.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 14, 14)), cc.scaleTo(0.2, 12, 12)));
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.scaleTo(0.2, 2, 2));
    },
    // 全垒打
    _quanleidaAnimation: function _quanleidaAnimation() {
        var quanleida = cc.instantiate(this.quanleida);
        this.node.addChild(quanleida);
        var bg = quanleida.getChildByName('bg');
        var ball = quanleida.getChildByName('ball');
        var bangqiutao = quanleida.getChildByName('bangqiutao');
        var bangqiugun = quanleida.getChildByName('bangqiugun');
        var Lyun = quanleida.getChildByName('Lyun');
        var Ryun = quanleida.getChildByName('Ryun');
        var title = quanleida.getChildByName('title');
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.2, 2.5, 2.5), cc.scaleTo(0.2, 1.5, 1.5), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(0, 20)), cc.moveTo(0.3, cc.v2(0, 0))), 2)));

            Lyun.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 20, 20), cc.moveTo(0.2, cc.v2(-270, 70))), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(-270, 26)), cc.moveTo(0.3, cc.v2(-270, 46))), 2)));

            Ryun.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 20, 20), cc.moveTo(0.2, cc.v2(270, 70))), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(270, 66)), cc.moveTo(0.3, cc.v2(270, 46))), 2)));

            bangqiutao.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.3, 10, 10), cc.moveTo(0.3, cc.v2(250, 50))), bqtFinished));
        });
        var bqtFinished = cc.callFunc(function () {
            bangqiutao.runAction(cc.repeat(cc.sequence(cc.rotateTo(0.2, -10), cc.rotateTo(0.2, 0)), 3));
            ball.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.1, 255), cc.moveTo(0.2, cc.v2(196, 83))), ballFinished));
        });
        var ballFinished = cc.callFunc(function () {
            ball.runAction(cc.spawn(cc.fadeTo(0.2, 0), cc.moveTo(0.2, cc.v2(0, 0)), cc.scaleTo(0.2, 4, 4)));
            bangqiugun.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 2, 2), cc.fadeTo(0.2, 255)), cc.scaleTo(0.3, 1.5, 1.5)));
            setTimeout(function () {
                bg.runAction(cc.fadeTo(0.2, 0));
                ball.runAction(cc.fadeTo(0.2, 0));
                bangqiutao.runAction(cc.fadeTo(0.2, 0));
                bangqiugun.runAction(cc.fadeTo(0.2, 0));
                Lyun.runAction(cc.fadeTo(0.2, 0));
                Ryun.runAction(cc.fadeTo(0.2, 0));
                title.runAction(cc.fadeTo(0.2, 0));

                quanleida.removeFromParent(true);
            }, 2000);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    },

    // 三同花动画
    _santonghuaAnimation: function _santonghuaAnimation() {
        var santonghua = cc.instantiate(this.santonghua);
        this.node.addChild(santonghua);
        var bg = santonghua.getChildByName('bg');
        var hua1 = santonghua.getChildByName('hua1');
        var hua2 = santonghua.getChildByName('hua2');
        var hua3 = santonghua.getChildByName('hua3');
        var Rtaohua = santonghua.getChildByName('Rtaohua');
        var Ltaohua = santonghua.getChildByName('Ltaohua');
        var title = santonghua.getChildByName('title');
        var self = this;
        //var H1 = cc.instantiate(hua1);
        var A = [],
            B = [],
            C = [];
        var hua = [];
        for (var i = 0; i < 5; i++) {
            A[i] = cc.instantiate(hua1);
            A[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(A[i]);
            B[i] = cc.instantiate(hua2);
            B[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(B[i]);
            C[i] = cc.instantiate(hua3);
            C[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(C[i]);
        };
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), cc.scaleTo(0.2, 1, 1), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.1, 1.8, 1.8)));
            Ltaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(-160, -60)))));
            Rtaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(140, -60)))));
            for (var i = 1; i < hua.length; i++) {
                hua[i].setPosition(self._bezier(i)[1]);
                santonghua.addChild(hua[i]);
                hua[i].runAction(cc.sequence(cc.spawn(cc.bezierTo(0.3, self._bezier(i)[0]), cc.scaleTo(0.3, 1, 1), cc.fadeTo(0.3, 0))));
            }
            setTimeout(function () {
                bg.runAction(cc.fadeTo(0.2, 0));
                Rtaohua.runAction(cc.fadeTo(0.2, 0));
                Ltaohua.runAction(cc.fadeTo(0.2, 0));
                title.runAction(cc.fadeTo(0.2, 0));
                santonghua.removeFromParent(true);
            }, 1500);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.3, 255), cc.scaleTo(0.3, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    },
    // 贝塞尔曲线(只能定三个点)
    _bezier: function _bezier(index) {
        var bezier = [];
        bezier[0] = [[cc.v2(200, 74), cc.v2(250, 124), cc.v2(400, -174)], cc.v2(200, 74)];
        bezier[1] = [[cc.v2(-72, 284), cc.v2(-122, 334), cc.v2(-272, -150)], cc.v2(-72, 284)];
        bezier[2] = [[cc.v2(-270, 300), cc.v2(-320, 350), cc.v2(-420, -200)], cc.v2(-270, 300)];
        bezier[3] = [[cc.v2(-223, 213), cc.v2(-273, 263), cc.v2(-373, -160)], cc.v2(-223, 213)];
        bezier[4] = [[cc.v2(210, 237), cc.v2(260, 287), cc.v2(360, -177)], cc.v2(210, 237)];
        bezier[5] = [[cc.v2(183, 115), cc.v2(233, 164), cc.v2(333, -155)], cc.v2(183, 115)];
        bezier[6] = [[cc.v2(92, 116), cc.v2(142, 166), cc.v2(242, -146)], cc.v2(92, 116)];
        bezier[7] = [[cc.v2(-26, 124), cc.v2(-76, 174), cc.v2(-176, -164)], cc.v2(-26, 124)];
        bezier[8] = [[cc.v2(-310, 81), cc.v2(-360, 131), cc.v2(-460, -180)], cc.v2(-310, 81)];
        bezier[9] = [[cc.v2(-125, 33), cc.v2(-175, 83), cc.v2(-275, -133)], cc.v2(-125, 33)];
        bezier[10] = [[cc.v2(0, 0), cc.v2(50, 50), cc.v2(150, -150)], cc.v2(0, 0)];
        bezier[11] = [[cc.v2(-235, 5), cc.v2(-275, 55), cc.v2(-375, -86)], cc.v2(-235, 5)];
        bezier[12] = [[cc.v2(-80, 4), cc.v2(-130, 54), cc.v2(-230, -233)], cc.v2(-80, 4)];
        bezier[13] = [[cc.v2(100, -7), cc.v2(150, 57), cc.v2(250, -177)], cc.v2(100, -7)];
        bezier[14] = [[cc.v2(254, 23), cc.v2(304, 73), cc.v2(404, -173)], cc.v2(254, 23)];
        return bezier[index];
    },

    // 六对半动画
    _liuduibanAnimation: function _liuduibanAnimation() {
        var liuduiban = cc.instantiate(this.liuduiban);
        this.node.addChild(liuduiban);
        var bg = liuduiban.getChildByName('bg');
        var Lqi = liuduiban.getChildByName('Lqi');
        var Rqi = liuduiban.getChildByName('Rqi');
        var Cqi = liuduiban.getChildByName('Cqi');
        var Rtaohua = liuduiban.getChildByName('Rtaohua');
        var Ltaohua = liuduiban.getChildByName('Ltaohua');
        var title = liuduiban.getChildByName('title');

        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.1, 2.5, 2.5), cc.scaleTo(0.1, 1.8, 1.8), Finished));
            Ltaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(-160, -60)))));
            Rtaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(140, -60)))));
        });
        var Finished = cc.callFunc(function () {
            Lqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(-103, 158))), cc.moveTo(0.2, cc.v2(-103, 168)), cc.moveTo(0.2, cc.v2(-103, 158))));
            Rqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(133, 160))), cc.moveTo(0.2, cc.v2(133, 170)), cc.moveTo(0.2, cc.v2(133, 160))));
            setTimeout(function () {
                Cqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(20, 96))), cc.moveTo(0.2, cc.v2(20, 106)), cc.moveTo(0.2, cc.v2(20, 96))));
                Ltaohua.runAction(cc.sequence(cc.repeat(cc.sequence(cc.rotateTo(0.3, 10), cc.rotateTo(0.3, 0)), 2), thFinished));
                Rtaohua.runAction(cc.repeat(cc.sequence(cc.rotateTo(0.3, -10), cc.rotateTo(0.3, 0)), 2));
            }, 500);
        });
        var thFinished = cc.callFunc(function () {
            bg.runAction(cc.fadeTo(0.2, 0));
            Lqi.runAction(cc.fadeTo(0.2, 0));
            Rqi.runAction(cc.fadeTo(0.2, 0));
            Cqi.runAction(cc.fadeTo(0.2, 0));
            Rtaohua.runAction(cc.fadeTo(0.2, 0));
            Ltaohua.runAction(cc.fadeTo(0.2, 0));
            title.runAction(cc.fadeTo(0.2, 0));
            liuduiban.removeFromParent(true);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    }
});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"cardNum":[function(require,module,exports){
"use strict";
cc._RFpush(module, '19329zUw3hCTpBk+7waBT2d', 'cardNum');
// scripts\cardNum.js

cc.Class({
    "extends": cc.Component,

    properties: {

        cards: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.totalCards();
    },
    totalCards: function totalCards() {
        // var create = this.node.children;
        //console.log(this.node);
        var renshu = this.node.getChildByName("renshu");
        var jushu = this.node.getChildByName("jushu");
        var getCard = this.node.getChildByName("cards");
        //var renshu = create[3], jushu = create[4], getCard = create[6];

        var rs = renshu.getComponent("singleSelect").selectedIndex;
        var js = jushu.getComponent("singleSelect").selectedIndex;
        var gc = getCard.getComponent("singleSelect").selectedIndex;

        var R = 1,
            J = 1,
            G = 1;
        switch (rs) {
            case 0:
                R = 1;break;
            case 1:
                R = 2;break;
            case 2:
                R = 3;break;
            case 3:
                R = 4;break;
        }
        switch (js) {
            case 0:
                J = 1;break;
            case 1:
                J = 2;break;
            case 2:
                J = 3;break;
        }
        switch (gc) {
            case 0:
                G = 1;break; // AA制
            default:
                G = 0;break;
        }
        this.cards.string = R + J;
        //this.cards.string = G ? (R+J):(R+J)*(R+3);  // (R+J)表示每个人要出的房卡量；(R+3)表示一共有多少人，  
    }
});

cc._RFpop();
},{}],"cardsBack":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98986IsXIdHiqLGEVIG2CWP', 'cardsBack');
// scripts\cardsBack.js

// 牌背影列表 component
// 可以显示、隐藏牌背影列表
cc.Class({
  "extends": cc.Component,

  properties: {
    cardsBackLayout: cc.Layout,
    cardsBackList: [cc.Sprite]
  },

  // use this for initialization
  onLoad: function onLoad() {},

  // 以动画的方式显示牌背影
  showPlayCardBacks: function showPlayCardBacks() {
    this.hideCardBacks();
    this.cardsBackLayout.node.active = true;

    var interval = 0.05;
    var startTime = 0;
    this.cardsBackList.forEach((function (cardBack) {
      this.scheduleOnce(function () {
        cardBack.node.active = true;
      }, startTime);
      startTime = startTime + interval;
    }).bind(this));
  },

  // 隐藏显示牌背影
  hideCardBacks: function hideCardBacks() {
    this.cardsBackLayout.node.active = false;
    this.cardsBackList.forEach(function (cardBack) {
      cardBack.node.active = false;
    });
  }
});

cc._RFpop();
},{}],"cards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0fcbct/TBxC742saKLuFviQ', 'cards');
// scripts\cards.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        /*牌花色*/
        spadesImages: [cc.SpriteFrame],
        heartsImages: [cc.SpriteFrame],
        clubImages: [cc.SpriteFrame],
        diamondImages: [cc.SpriteFrame]
    },

    // use this for initialization
    onLoad: function onLoad() {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"cellText":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9c9fd3OxWNEp4rijfjJv05t', 'cellText');
// scripts\cellText.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        labelMsg: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setText: function setText(text) {
        this.labelMsg.getComponent(cc.Label).string = text;
    },

    clickAction: function clickAction() {
        var text = this.labelMsg.getComponent(cc.Label).string;
        this.onSelectAction(text);
    },

    onSelectAction: function onSelectAction(msg) {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"changInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cb225d0jXtB0JToI7yXR0hG', 'changInfo');
// scripts\changInfo.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        phoneEditBox: cc.EditBox,
        wxEditBox: cc.EditBox,
        alert: cc.Prefab,
        canvas: cc.Node,
        _userId: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        this._registerSocketEvent();
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveOnChangeInfo, this._ReceiveChangeInfo, this);
    },
    _ReceiveChangeInfo: function _ReceiveChangeInfo(response) {
        var changedRows = response.data;
        var msg = '';
        //console.log(response);
        //console.log(changedRows);
        //console.log("-------------------------------38");
        if (changedRows) {
            msg = "更改成功";
        } else {
            msg = "今天已经更新过了，请明天再更新";
        }
        this.alertMsg(msg);
    },
    clickAction: function clickAction() {
        var wx = this.wxEditBox.string;
        var phone = this.phoneEditBox.string;
        var info = {};
        var msg = '';
        if (!wx && !phone) {
            msg = "请填写微信号和手机号";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (!/(^[1-9]\d*$)/.test(phone)) {
            msg = "您输入的手机号码格式不对，请重新输入";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (phone.length != 11) {
            msg = "您输入的手机号码不够11位，请重新输入";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (!/(^[1-9a-zA-Z]\d*$)/.test(wx)) {
            msg = "您输入的微信号格式不对，请重新输入";
            wx = "";
            this.alertMsg(msg);
            return;
        }
        if (wx.length < 6 || wx.length > 20) {
            msg = "您输入的微信号格式超出范围，请输入6~20位的微信号";
            wx = "";
            this.alertMsg(msg);
            return;
        }
        info.wx = wx;
        info.phone = phone;
        Socket.sendChangeInfo(this._userId, info);
    },

    alertMsg: function alertMsg(msg) {
        var alert = cc.instantiate(this.alert);
        this.canvas.addChild(alert);
        var comp = alert.getComponent('alert');
        comp.setMessage(msg);
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"change_mapai":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'ed8274emaRL471ny4dnQ8cA', 'change_mapai');
// scripts\change_mapai.js

cc.Class({
    "extends": cc.Component,

    properties: {

        mPtitle: cc.Label,
        _cards: [],
        renshuSelect: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        var hs = 3;
        var ds = 5;
        if (cc.set) {
            hs = cc.set.setting7[0];
            ds = cc.set.setting7[1];
        }
        this._cards = [hs, ds];
        this.mp(hs, ds);
    },
    change: function change() {
        var selectedIndex = this.renshuSelect.getComponent('singleSelect').selectedIndex;
        var hs = Math.ceil(Math.random() * 40 / 10); //获取一个1~4的数字，代表花色
        var ds = Math.ceil(Math.random() * 130 / 10); //获取一个1~13的数字，代表点数
        var card = [hs, ds];
        this._cards = card;
        this.mp(hs, ds, selectedIndex);
    },
    mp: function mp(h, d, index) {
        var ma = "单码";
        var hs = ["方块", "梅花", "红桃", "黑桃"];
        var ds = ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"];
        if (index) {
            var defaultMa = 4;
            if (h >= defaultMa - index + 1) {
                ma = "双码";
            }
        }
        this.mPtitle.string = hs[h - 1] + ds[d - 1] + ma;
    }
});

cc._RFpop();
},{}],"checkSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '974a0c6jzZPRI5AeaAb4U0z', 'checkSelect');
// scripts\checkSelect.js

cc.Class({
    "extends": cc.Component,

    properties: {
        selectedIndex: 0,
        selectedNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selected = true;
        this.selectedIndex = 0;
        this.selectedNode.active = true;
    },
    clickAction: function clickAction(e, data) {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        this.selectedIndex = this.selected ? 0 : null;
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"choujiang":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f64e0whLhNLmbOHtPpK94CG', 'choujiang');
// scripts\choujiang.js

var socket = require("socket");
cc.Class({
    "extends": cc.Component,

    properties: {
        option: {
            "default": [],
            type: cc.Node
        }
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickBtnchoujiang: function clickBtnchoujiang() {
        for (var i = 0; i < this.option.length; i++) {
            this.option[i].opacity = 255;
        }
        var index = 0;
        this._tishi = this.node.getChildByName("choujiang_bg").getChildByName("tishi");
        this._card_num = cc.find("Canvas/user/shop_bg/card_num");
        var comp = this._card_num.getComponent(cc.Label);
        this.callback = function () {
            if (index == 0) {
                this.option[index].opacity = 128;
                this.option[this.option.length - 1].opacity = 255;
            } else if (index == 1) {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            } else {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            }
            index++;
            if (index == this.option.length) {
                index = 0;
            }
        };
        if (comp.string < 20) {
            this._tishi.active = true;
        } else {
            //choujiang
            this.schedule(this.callback, 0.05);
            this.schedule(function () {
                this.unschedule(this.callback);
                for (var i = 0; i < this.option.length; i++) {
                    this.option[i].opacity = 255;
                }
                var i = Math.floor(Math.random() * 12);
                this.option[i].opacity = 128;
            }, 3, 0, 1);
        }
    },

    //***
    clickBtnComfirm: function clickBtnComfirm() {
        this._tishi.active = false;
        //this.node.active = false;
    }
});
//****

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"socket":"socket"}],"create_btn_anima":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'df337riLglP3YcI/IJFXecj', 'create_btn_anima');
// scripts\create_btn_anima.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...

    },

    // use this for initialization
    onLoad: function onLoad() {},
    loadCardSpriteFrame: function loadCardSpriteFrame(cardName, callback) {
        this._loadCardFrame(cardName, callback);
    },
    _cardFullName: function _cardFullName(cardShortName) {
        var cardName = cardShortName;
        if (!cardName.startsWith("public-pic-card-poker")) {
            cardName = "public-pic-card-poker-" + cardName;
        }
        return cardName;
    },
    _loadCardFrame: function _loadCardFrame(cardName, callback) {
        cc.assert(callback);
        cc.loader.loadRes("play/hall/public/all_effect_ttw_main", cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                callback(null, err);
                return;
            }
            cardName = this._cardFullName(cardName);
            var frame = atlas.getSpriteFrame(cardName);
            callback(frame);
        }).bind(this));
    },
    test: function test() {}

});

cc._RFpop();
},{}],"fecha":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e517077l0xMarB9uQsXGzvk', 'fecha');
// scripts\Extensions\fecha.js

(function (main) {
  'use strict';

  /**
   * Parse or format dates
   * @class fecha
   */
  var fecha = {};
  var token = /d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g;
  var twoDigits = /\d\d?/;
  var threeDigits = /\d{3}/;
  var fourDigits = /\d{4}/;
  var word = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;
  var literal = /\[([^]*?)\]/gm;
  var noop = function noop() {};

  function shorten(arr, sLen) {
    var newArr = [];
    for (var i = 0, len = arr.length; i < len; i++) {
      newArr.push(arr[i].substr(0, sLen));
    }
    return newArr;
  }

  function monthUpdate(arrName) {
    return function (d, v, i18n) {
      var index = i18n[arrName].indexOf(v.charAt(0).toUpperCase() + v.substr(1).toLowerCase());
      if (~index) {
        d.month = index;
      }
    };
  }

  function pad(val, len) {
    val = String(val);
    len = len || 2;
    while (val.length < len) {
      val = '0' + val;
    }
    return val;
  }

  var dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
  var monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  var monthNamesShort = shorten(monthNames, 3);
  var dayNamesShort = shorten(dayNames, 3);
  fecha.i18n = {
    dayNamesShort: dayNamesShort,
    dayNames: dayNames,
    monthNamesShort: monthNamesShort,
    monthNames: monthNames,
    amPm: ['am', 'pm'],
    DoFn: function DoFn(D) {
      return D + ['th', 'st', 'nd', 'rd'][D % 10 > 3 ? 0 : (D - D % 10 !== 10) * D % 10];
    }
  };

  var formatFlags = {
    D: function D(dateObj) {
      return dateObj.getDate();
    },
    DD: function DD(dateObj) {
      return pad(dateObj.getDate());
    },
    Do: function Do(dateObj, i18n) {
      return i18n.DoFn(dateObj.getDate());
    },
    d: function d(dateObj) {
      return dateObj.getDay();
    },
    dd: function dd(dateObj) {
      return pad(dateObj.getDay());
    },
    ddd: function ddd(dateObj, i18n) {
      return i18n.dayNamesShort[dateObj.getDay()];
    },
    dddd: function dddd(dateObj, i18n) {
      return i18n.dayNames[dateObj.getDay()];
    },
    M: function M(dateObj) {
      return dateObj.getMonth() + 1;
    },
    MM: function MM(dateObj) {
      return pad(dateObj.getMonth() + 1);
    },
    MMM: function MMM(dateObj, i18n) {
      return i18n.monthNamesShort[dateObj.getMonth()];
    },
    MMMM: function MMMM(dateObj, i18n) {
      return i18n.monthNames[dateObj.getMonth()];
    },
    YY: function YY(dateObj) {
      return String(dateObj.getFullYear()).substr(2);
    },
    YYYY: function YYYY(dateObj) {
      return dateObj.getFullYear();
    },
    h: function h(dateObj) {
      return dateObj.getHours() % 12 || 12;
    },
    hh: function hh(dateObj) {
      return pad(dateObj.getHours() % 12 || 12);
    },
    H: function H(dateObj) {
      return dateObj.getHours();
    },
    HH: function HH(dateObj) {
      return pad(dateObj.getHours());
    },
    m: function m(dateObj) {
      return dateObj.getMinutes();
    },
    mm: function mm(dateObj) {
      return pad(dateObj.getMinutes());
    },
    s: function s(dateObj) {
      return dateObj.getSeconds();
    },
    ss: function ss(dateObj) {
      return pad(dateObj.getSeconds());
    },
    S: function S(dateObj) {
      return Math.round(dateObj.getMilliseconds() / 100);
    },
    SS: function SS(dateObj) {
      return pad(Math.round(dateObj.getMilliseconds() / 10), 2);
    },
    SSS: function SSS(dateObj) {
      return pad(dateObj.getMilliseconds(), 3);
    },
    a: function a(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0] : i18n.amPm[1];
    },
    A: function A(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0].toUpperCase() : i18n.amPm[1].toUpperCase();
    },
    ZZ: function ZZ(dateObj) {
      var o = dateObj.getTimezoneOffset();
      return (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4);
    }
  };

  var parseFlags = {
    D: [twoDigits, function (d, v) {
      d.day = v;
    }],
    Do: [new RegExp(twoDigits.source + word.source), function (d, v) {
      d.day = parseInt(v, 10);
    }],
    M: [twoDigits, function (d, v) {
      d.month = v - 1;
    }],
    YY: [twoDigits, function (d, v) {
      var da = new Date(),
          cent = +('' + da.getFullYear()).substr(0, 2);
      d.year = '' + (v > 68 ? cent - 1 : cent) + v;
    }],
    h: [twoDigits, function (d, v) {
      d.hour = v;
    }],
    m: [twoDigits, function (d, v) {
      d.minute = v;
    }],
    s: [twoDigits, function (d, v) {
      d.second = v;
    }],
    YYYY: [fourDigits, function (d, v) {
      d.year = v;
    }],
    S: [/\d/, function (d, v) {
      d.millisecond = v * 100;
    }],
    SS: [/\d{2}/, function (d, v) {
      d.millisecond = v * 10;
    }],
    SSS: [threeDigits, function (d, v) {
      d.millisecond = v;
    }],
    d: [twoDigits, noop],
    ddd: [word, noop],
    MMM: [word, monthUpdate('monthNamesShort')],
    MMMM: [word, monthUpdate('monthNames')],
    a: [word, function (d, v, i18n) {
      var val = v.toLowerCase();
      if (val === i18n.amPm[0]) {
        d.isPm = false;
      } else if (val === i18n.amPm[1]) {
        d.isPm = true;
      }
    }],
    ZZ: [/([\+\-]\d\d:?\d\d|Z)/, function (d, v) {
      if (v === 'Z') v = '+00:00';
      var parts = (v + '').match(/([\+\-]|\d\d)/gi),
          minutes;

      if (parts) {
        minutes = +(parts[1] * 60) + parseInt(parts[2], 10);
        d.timezoneOffset = parts[0] === '+' ? minutes : -minutes;
      }
    }]
  };
  parseFlags.dd = parseFlags.d;
  parseFlags.dddd = parseFlags.ddd;
  parseFlags.DD = parseFlags.D;
  parseFlags.mm = parseFlags.m;
  parseFlags.hh = parseFlags.H = parseFlags.HH = parseFlags.h;
  parseFlags.MM = parseFlags.M;
  parseFlags.ss = parseFlags.s;
  parseFlags.A = parseFlags.a;

  // Some common format strings
  fecha.masks = {
    'default': 'ddd MMM DD YYYY HH:mm:ss',
    shortDate: 'M/D/YY',
    mediumDate: 'MMM D, YYYY',
    longDate: 'MMMM D, YYYY',
    fullDate: 'dddd, MMMM D, YYYY',
    shortTime: 'HH:mm',
    mediumTime: 'HH:mm:ss',
    longTime: 'HH:mm:ss.SSS'
  };

  /***
   * Format a date
   * @method format
   * @param {Date|number} dateObj
   * @param {string} mask Format of the date, i.e. 'mm-dd-yy' or 'shortDate'
   */
  fecha.format = function (dateObj, mask, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof dateObj === 'number') {
      dateObj = new Date(dateObj);
    }

    if (Object.prototype.toString.call(dateObj) !== '[object Date]' || isNaN(dateObj.getTime())) {
      throw new Error('Invalid Date in fecha.format');
    }

    mask = fecha.masks[mask] || mask || fecha.masks['default'];

    var literals = [];

    // Make literals inactive by replacing them with ??
    mask = mask.replace(literal, function ($0, $1) {
      literals.push($1);
      return '??';
    });
    // Apply formatting rules
    mask = mask.replace(token, function ($0) {
      return $0 in formatFlags ? formatFlags[$0](dateObj, i18n) : $0.slice(1, $0.length - 1);
    });
    // Inline literal values back into the formatted value
    return mask.replace(/\?\?/g, function () {
      return literals.shift();
    });
  };

  /**
   * Parse a date string into an object, changes - into /
   * @method parse
   * @param {string} dateStr Date string
   * @param {string} format Date parse format
   * @returns {Date|boolean}
   */
  fecha.parse = function (dateStr, format, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof format !== 'string') {
      throw new Error('Invalid format in fecha.parse');
    }

    format = fecha.masks[format] || format;

    // Avoid regular expression denial of service, fail early for really long strings
    // https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
    if (dateStr.length > 1000) {
      return false;
    }

    var isValid = true;
    var dateInfo = {};
    format.replace(token, function ($0) {
      if (parseFlags[$0]) {
        var info = parseFlags[$0];
        var index = dateStr.search(info[0]);
        if (! ~index) {
          isValid = false;
        } else {
          dateStr.replace(info[0], function (result) {
            info[1](dateInfo, result, i18n);
            dateStr = dateStr.substr(index + result.length);
            return result;
          });
        }
      }

      return parseFlags[$0] ? '' : $0.slice(1, $0.length - 1);
    });

    if (!isValid) {
      return false;
    }

    var today = new Date();
    if (dateInfo.isPm === true && dateInfo.hour != null && +dateInfo.hour !== 12) {
      dateInfo.hour = +dateInfo.hour + 12;
    } else if (dateInfo.isPm === false && +dateInfo.hour === 12) {
      dateInfo.hour = 0;
    }

    var date;
    if (dateInfo.timezoneOffset != null) {
      dateInfo.minute = +(dateInfo.minute || 0) - +dateInfo.timezoneOffset;
      date = new Date(Date.UTC(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0));
    } else {
      date = new Date(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0);
    }
    return date;
  };

  /* istanbul ignore next */
  if (typeof module !== 'undefined' && module.exports) {
    module.exports = fecha;
  } else if (typeof define === 'function' && define.amd) {
    define(function () {
      return fecha;
    });
  } else {
    main.fecha = fecha;
  }
})(this);

cc._RFpop();
},{}],"game":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45811N61jFFA6UrygQla5+x', 'game');
// scripts\game.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        messageNode: cc.Node,
        playNode: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {},

    showMessageAlert: function showMessageAlert() {
        this.messageNode.active = true;
        var comp = this.messageNode.getComponent(cc.Animation);
        comp.play('pop');
    },

    dismissMessageAlert: function dismissMessageAlert() {
        var self = this;
        this.scheduleOnce(function () {
            self.messageNode.active = false;
        }, 0.3);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"hall_btn_anima":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b8a30Txa91I27+7HOFLyJA6', 'hall_btn_anima');
// scripts\hall_btn_anima.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        create_anima: {
            type: cc.SpriteFrame,
            "default": []
        }
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"hall":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1e6741Q2VFGDLupV88mg60Z', 'hall');
// scripts\hall.js

var manager = require('manager');
var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var Playback = require('Playback');

var hall = cc.Class({
    'extends': cc.Component,

    properties: {

        //productNodes:[cc.Node],
        shopAlertNode: cc.Node,
        createNode: cc.Node,
        joinNode: cc.Node,
        gengxin: cc.Node,
        alertPrefab: cc.Prefab,
        tsSingleSelect: [cc.Node], // 创建房间信息，单选
        tsCheckSeclect: [cc.Node], // 创建房间信息，复选
        selectMoShi: cc.Node, // 创建房间信息，模式（庄家模式和无特殊牌）
        selectGuiPai: cc.Node, // 创建房间信息，模式（庄家模式和无特殊牌）
        overTime: cc.Node, // 超时出牌
        //labelNotice: cc.Label,      // 公告
        labelBanner: cc.Label, // banner label
        recordNode: cc.Node,
        waitingPrefab: cc.Prefab,
        setting: cc.Node,
        //用户信息
        avatarNode: cc.Node,
        nickNameLabel: cc.Label,
        cardNumberLabel: cc.Label,
        userIdLabel: cc.Label,
        codeLabel: cc.Label,
        //phone:cc.Label,
        // userInfoMsgNode:cc.Node,
        logoutNode: cc.Node,
        //战绩
        recordMsgNode: cc.Node,
        feedbackEditBox: cc.EditBox, //反馈
        feedbackNode: cc.Node,
        wxshare: cc.Node,
        _userId: 0,
        _openId: null,
        _help: null,
        _close: null,
        iosUrl: null,
        aUrl: null

    },

    statics: {
        lastHallInfo: null, // 上一次收到的大厅信息
        cacheImageInfo: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.keyBackListen();
        if (cc.sys.isBrowser) {
            if (window.shareToTimeLine) {
                window.shareToTimeLine();
            }
            if (window.shareToSession) {
                window.shareToSession();
            }
        }
        cc.sys.localStorage.removeItem("timestamp");
        var bg = this.node.getChildByName("room_bg");
        var windowP = cc.director.getWinSizeInPixels();
        var scaleX = windowP.width / bg.width;
        var scaleY = windowP.height / bg.height;
        var scale = Math.max(scaleX, scaleY);
        bg.scaleX = scale;
        bg.scaleY = scale;
        this.clearLocalStorage();
        cc.from = {};
        cc.from.isUseMa = true;
        cc.from.ma = 0;
        cc.isRoomViewShow = false;
        this._btn = this.node.getChildByName("btn");
        this._buttons = this.node.getChildByName("buttons");
        var volume = cc.sys.localStorage.getItem("bgVolume");
        if (volume != null && parseInt(volume)) {
            AudioManager.instance.playMusic();
        }

        var bgSound = cc.sys.localStorage.getItem("bgSound");
        if (bgSound == 0) {
            var audioManager = cc.find('AudioManager');
            audioManager = audioManager.getComponent('AudioManager');
            audioManager.setEffectMusicVolum(bgSound);
        }
        Playback.instance.removePlaybackDatas();

        hall.cacheImageInfo = hall.cacheImageInfo || {};

        this._registerSocketEvent();
        this._startBannerAnimation();
        this._initJoinRoom();

        this._userId = Socket.instance.userInfo.id;
        this._openId = Socket.instance.userInfo.openId;
        this._inviteCode = Socket.instance.userInfo.inviteCode; //邀请码
        var self = this;
        this.socket = cc.find('GameSocket').getComponent('socket');
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
        };

        this.socket.connectionSuccess = function () {
            self.hiddenNetworkMessage();
            self.hiddenCheckMessage();
        };
        this.socket.connectionDisconnect = function () {
            self.showNetworkMessage('网络链接断开，重新连接中...');
        };
        this.socket.checkNetworkNow = function () {
            self.showCheckMessage('检查网络中...');
        };
        this.socket.checkNetworkEnd = function () {
            self.hiddenCheckMessage();
            self.hiddenNetworkMessage();
        };

        //  /*设置用户信息*/
        this.updateUserInfo();
        /*刷新用户信息*/
        Socket.sendGetUserInfo(this._userId, this._openId);
        /*定时刷新用户信息*/
        this.schedule((function () {
            Socket.sendGetUserInfo(this._userId, this._openId);
        }).bind(this), 10); //10s一次
        Socket.sendGetHallInfo(this.socket.userInfo.id);
        if (hall.lastHallInfo) {
            this.updateBanner(hall.lastHallInfo.info);
        }
        cc.onShareWXResp = null;
        cc.director.preloadScene('play', function () {
            cc.director.preloadScene('login');
        });
        if (cc.joinDesk != null) {
            if (!cc.joinDesk.result) {
                var reason = cc.joinDesk.reason;
                this.alertMessage(reason);
            }
            cc.joinDesk = null;
        }
        if (cc.qingli != null) {
            this.alertMessage("您被房主请出房间");
            cc.qingli = null;
        }
        //var creatAnima = this.node.getChildByName("create_room");
    },

    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },

    clickWxShare: function clickWxShare() {
        if (!cc.sys.isNative) {
            this.wxshare.active = true;
        } else {
            var title = cc.sys.localStorage.getItem('shareTitle');
            var description = cc.sys.localStorage.getItem('desc');
            var recordId = cc.sys.localStorage.getItem('recordId');
            var id = '';
            if (recordId) {
                id = 'recordId=' + recordId;
            }

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
            }
        }
    },

    //分享到朋友圈
    shareHallTimeline: function shareHallTimeline() {
        if (!cc.sys.isNative) {
            this.wxshare.active = true;
        } else {
            var title = cc.sys.localStorage.getItem('shareTitle');
            var description = cc.sys.localStorage.getItem('desc');
            var recordId = cc.sys.localStorage.getItem('recordId');
            var id = '';
            if (recordId) {
                id = 'recordId=' + recordId;
            }

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
            }
        }
    },

    shareBg: function shareBg() {
        if (!cc.sys.isNative) {
            this.wxshare.active = false;
        } else {
            // if (KQNativeInvoke.isNativeIOS()) {
            //     jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,"wxShareHallTimeline",id, description,title);
            // }
            // else {//Android
            //     var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            //     jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str,id, description,title);
            // }
        }
    },

    clearLocalStorage: function clearLocalStorage() {
        var shareTitle = '开房玩[大众十三水]';
        var desc = '开好房了，就等你们一起来[大众十三水]啦！晚了位置就没了哟~';
        cc.sys.localStorage.removeItem('roomId');
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
        this.socket.connectionSuccess = function () {};
        this.socket.connectionDisconnect = function () {};
        this.socket.checkNetworkNow = function () {};
        this.socket.checkNetworkEnd = function () {};

        KQGlobalEvent.offTarget(this);
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.JoinDesk, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveCreateDesk, this._createRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGetUserInfo, this._socketReceiveUserInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        //KQGlobalEvent.on(Socket.Event.ReceiveInviteCode, this._socketReceiveInviteCode, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        //KQGlobalEvent.on(Socket.Event.ReceiveSharePng, this._socketSharePng, this);
    },

    // 跳转到公众号
    guanzhu: function guanzhu() {
        // var url = "http://www.honggefeng.cn/gzh/index.html";
        // cc.sys.openURL(url)
    },
    _startBannerAnimation: function _startBannerAnimation() {
        var anim = this.labelBanner.getComponent(cc.Animation);
        anim.play('banner');
    },
    downLoad: function downLoad() {
        var url = 'https://fir.im/5tne';
        cc.sys.openURL(url);

        //window.location.href = "http://www.baidu.com";
        //console.log("？？？？？？？？");
    },

    _initJoinRoom: function _initJoinRoom() {
        var self = this;
        var joinRoom = this.joinNode.getComponent('joinRoom');

        joinRoom.callbackJoinRoom = function (number) {
            // self.joinNode.getComponent('alert').dismissAction();
            // self.showWaitingMessage('加入中...');
            // self.scheduleOnce(function() {
            //     self.hiddenWaitingMessage();
            // }, 2.0);

            /*加入房间请求*/
            var userId = Socket.instance.userInfo.id;
            Socket.sendJoinDesk(number, userId);
        };
    },

    _jiinRoomSocketCallback: function _jiinRoomSocketCallback(response) {
        var _this2 = this;

        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            (function () {
                if (cc.from == null) {
                    cc.from = {};
                }
                var joinRoom = _this2.joinNode.getComponent('joinRoom');

                _this2.joinNode.getComponent('alert').setAlertCallbck(function () {
                    joinRoom.clickClear();
                });
                cc.from.ma = response.data.maPai;
                cc.director.loadScene('play');
            })();
        } else {
            var reasonInfo = this._joinReasonMap(response.data.reason);
            this.alertMessage(reasonInfo);
        }
    },

    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!response.result) {
            return;
        }
        var data = response.data;
        hall.lastHallInfo = data;
        var isIOS = data.isIOS;
        var isAndroid = data.isA;
        var vIOS = data.vIOS;
        var vA = data.vA;
        this.iosUrl = data.iosUrl;
        this.aUrl = data.aUrl;
        if (cc.sys.isNative) {
            if (KQNativeInvoke.isNativeIOS()) {
                if (isIOS == 1) {
                    if (vIOS != '1.0.3') {
                        this.gengxin.active = true;
                    }
                }
            } else {
                //Android
                if (isAndroid == 1) {
                    if (vA != '1.0.4') {
                        this.gengxin.active = true;
                    }
                }
            }
        }
        var notice = data.broadcast;
        var banner = data.info;
        //this.updateNotice(notice);
        this.updateBanner(banner);
    },
    downloadNewVersion: function downloadNewVersion() {
        if (KQNativeInvoke.isNativeIOS()) {
            cc.sys.openURL(this.iosUrl);
            // jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", this.iosUrl);
        } else {
                //Android
                cc.sys.openURL(this.aUrl);
                // jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", this.aUrl);
            }
    },
    _createRoomSocketCallback: function _createRoomSocketCallback(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            cc.director.loadScene('play');
        }
        /*如果钻石不足，则提示*/
        else {
                this.alertMessage("您的钻石不足");
            }
    },

    _joinReasonMap: function _joinReasonMap(reason) {
        var reasonInfo = {
            notExist: "房间不存在!",
            cardNumber: "您房卡不足!"
        };

        var info = reasonInfo[reason] || "房间已满!";
        return info;
    },

    /*shop*/
    shopAction: function shopAction() {
        var comp = this.shopAlertNode.getComponent('alert');
        comp.alert();
    },
    /*提示*/
    alertMessage: function alertMessage(msg) {
        var node = cc.instantiate(this.alertPrefab);
        this.node.addChild(node);
        var comp = node.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    //updateNotice: function (notice) {
    //    if(this.labelNotice == null){
    //        return;
    //    }
    //  this.labelNotice.string = notice || "";
    //},

    updateBanner: function updateBanner() {
        var banner = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        if (this.labelBanner == null) {
            return;
        }
        this.labelBanner.string = banner;
    },

    /*#####
    * setting1 局数  (0 | 1 | 2 )
    * setting2 人数  (0 | 1 | 2 | 3)
    * setting3 玩法  (0 | 1 | 2 | 3 | 4)
    * setting4 AA制收取房费  (0 | 1 | 2 )
    * setting5 其他  (0)
    * setting6  
    * setting7
    * */
    createDoneAction: function createDoneAction() {
        var info = {};
        var self = this;
        var key = ['setting1', 'setting2', 'setting4', 'setting5'];
        for (var i = 0; i < this.tsSingleSelect.length; i++) {
            var tsIndex = self.tsSingleSelect[i].getComponent('singleSelect').selectedIndex;
            info[key[i]] = tsIndex;
        }

        info['setting3'] = this.selectMoShi.getComponent('selectMoShi')._select;
        info['setting6'] = this.overTime.getComponent('overTime')._selected;
        //console.log( info['setting6'] );
        if (!info['setting3'][3]) {
            // 玩法 [疯狂场,鬼牌,比花色,坐庄,马牌] info['setting3'][3]第三项表示坐庄模式，非坐庄模式的倍率是1倍
            info['setting5'] = 0; // 倍率 (0~1) == (1~3倍)
        }
        info['setting8'] = null;

        info['setting7'] = this.selectMoShi.getComponent('change_mapai')._cards;
        cc.set = info;
        info['userId'] = this.socket.userInfo.id; //用户Id
        this.socket.sendMessage('createDesk', info);

        this.createNode.getComponent('alert').dismissAction();

        //let self = this;
        this.showWaitingMessage('创建中...');
        this.scheduleOnce(function () {
            self.hiddenWaitingMessage();
        }, 2.0);
    },

    // 随机场
    /*clickRandRoom: function () {
      cc.director.loadScene('randRoom');
    },*/

    clickRecord: function clickRecord() {
        var comp = this.recordNode.getComponent('alert');
        comp.alert();
        Socket.sendGetRecrod(Socket.instance.userInfo.id);
    },

    clickPlayRule: function clickPlayRule() {
        //cc.director.loadScene('rule');
        this.help = this.node.getChildByName("help");
        var comp = this.help.getComponent('alert');
        comp.alert();
    },

    clickPlay: function clickPlay() {
        if (cc.clickOut) cc.director.loadScene('play');
    },

    /*切换账号*/
    clickCancelLation: function clickCancelLation() {
        this.logoutNode.getComponent('alert').alert();
    },

    logoutAction: function logoutAction() {
        //manager.setUserInfo('');
        cc.director.loadScene('login');
        hall.cacheImageInfo = null;
    },

    exitAction: function exitAction() {
        //manager.setUserInfo('');
        if (!cc.sys.isNative) {
            cc.director.loadScene('login');
            hall.cacheImageInfo = null;
            return;
        }

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
        cc.director.end();
    },

    //接收处理用户数据
    _socketReceiveUserInfo: function _socketReceiveUserInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!this.socket.userInfo) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }
        //console.log(response,"----------------------用户信息");
        //this.phone.string = response.data.phone ? response.data.phone : "无";
        this.setting.getComponent('Setting')._phone = response.data.phone ? response.data.phone : null;
        this.setting.getComponent('Setting').phone.string = response.data.phone ? response.data.phone : '无';
        this.nickNameLabel.string = response.data.nickname; // 用户名
        this.userIdLabel.string = 'ID: ' + response.data.id; // ID
        this.cardNumberLabel.string = response.data.cardNumber;
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        cc.loader.load({ url: response.data.avatarUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;
            }
        });
    },

    _socketDisconnect: function _socketDisconnect() {
        this.showNetworkMessage("网络链接断开，重新连接中...");
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    //更新用户信息
    updateUserInfo: function updateUserInfo() {
        var info = this.socket.userInfo;
        if (!info) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }

        this.nickNameLabel.string = info.nickname;
        this.userIdLabel.string = 'ID: ' + info.id;
        this.cardNumberLabel.string = info.cardNumber;

        var avatarUrl = info.avatarUrl + ".jpg";
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        var texture = hall.cacheImageInfo[avatarUrl];
        if (texture) {
            var frame = new cc.SpriteFrame(texture);
            if (frame) {
                //cc.log("从缓存中加载头像");
                sprite.spriteFrame = frame;
                return;
            }
        }

        cc.loader.load({ url: info.avatarUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;

                hall.cacheImageInfo[avatarUrl] = tex;
            }
        });
    },

    /*提交意见*/
    feedbackAcion: function feedbackAcion() {
        var userId = this.socket.userInfo.id;
        var text = this.feedbackEditBox.string;
        if (text.length > 0) {
            this.feedbackNode.getComponent('alert').dismissAction();
            Socket.sendFeedback(userId, text);
            this.feedbackEditBox.string = '';
        }
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.sys.isObjectValid(this.waitingNode)) {
            this.waitingNode.destory();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    //network
    showNetworkMessage: function showNetworkMessage(msg) {
        if (this.networkNode && this.networkNode.active) {
            var _alert = this.networkNode.getComponent('alert');
            if (_alert.getMessage() == msg) {
                return;
            }
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage(msg) {
        if (!(this.checkNode && this.checkNode.active)) {} else {
            var _alert2 = this.checkNode.getComponent('alert');
            if (_alert2.getMessage() == msg) {
                return;
            }
        }

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },
    onBtnClick: function onBtnClick() {
        if (this._buttons.active) {
            this._buttons.active = false;
        } else {
            this._buttons.active = true;
        }
    }

});

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },
module.exports = hall;

cc._RFpop();
},{"AudioManager":"AudioManager","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","manager":"manager","socket":"socket"}],"help":[function(require,module,exports){
"use strict";
cc._RFpush(module, '09981CwNMZOI4DHUg8u9kcj', 'help');
// scripts\help.js

cc.Class({
    "extends": cc.Component,
    properties: {
        /*sprites: {
            default: null,
            type: cc.SpriteAtlas
        },*/
        play_method_before: cc.Node, //玩法介绍
        play_method_content_label: cc.Node, //玩法介绍内容
        introduce_pai_before: cc.Node, //牌型介绍
        details: cc.Node, //牌型介绍内容
        caozuo_before: cc.Node, //操作介绍
        caozuo_content: cc.Node, //操作介绍内容
        _btn: null,
        _content: null,
        _buttonCom: null,
        _play_method_button: null,
        _introduce_pai_button: null,
        _caozuo_button: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        //this._play_method_button = this.play_method_before.getComponent(cc.Button);
        //this._introduce_pai_button = this.introduce_pai_before.getComponent(cc.Button);
        //this._caozuo_button = this.caozuo_before.getComponent(cc.Button);
        //this._btn = [this.play_method_before,this.introduce_pai_before,this.caozuo_before];
        //this._content = [this.play_method_content_label,this.details,this.caozuo_content];
        //this._buttonCom = [this._play_method_button,this._introduce_pai_button,this._caozuo_button];
        ////刚开始牌型介绍的按钮不可用
        //this._buttonCom[1].interactable = false;
    },
    // 点击玩法介绍
    onBtnPlayMethodClick: function onBtnPlayMethodClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[0].interactable = false;
        ////当前点击的对应的内容可见
        this._content[0].active = true;
    },
    //点击牌型介绍
    onBtnIntroducePaiClick: function onBtnIntroducePaiClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[1].interactable = false;
        ////当前点击的对应的内容可见
        //this._content[1].active = true;
    },
    //点击操作介绍
    onBtnCaozuoClick: function onBtnCaozuoClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[2].interactable = false;
        ////当前点击的对应的内容可见
        //this._content[2].active = true;
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"inviteCode":[function(require,module,exports){
"use strict";
cc._RFpush(module, '777f9/eB7RKK4aO7FmNYFgO', 'inviteCode');
// scripts\inviteCode.js

/**
 * 邀请码
 * @authors 黄成(you@example.org)
 * @date    2017-06-16 09:44:10
 * @version $Id$
 */
var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackInviteCode: ''
  },

  onLoad: function onLoad() {
    this.clickClear(); //清除数字
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
      //cc.log(label.string ,"----------------");
    } else {
        return;
      }
    var isComplete = this._lastEmptyLabel() == null;
    //cc.log("isComplete-------------", this.callbackInviteCode);
    var inviteNumber = this._inviteNumber();

    if (inviteNumber.length == 6) {
      //cc.log(inviteNumber,"--------------------38"); //邀请码
      var userId = Socket.instance.userInfo.id;
      //Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = inviteNumber;
    }
  },
  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackInviteCode;
    //cc.log(inviteNumber,"--------------------38")
    if (inviteNumber && inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = ''; //清空邀请码
    }
  },
  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _inviteNumber: function _inviteNumber() {
    return this.labelNumbers.reduce(function (inviteNumber, label) {
      //cc.log(inviteNumber,"-----------------");
      return inviteNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"joinRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd5dcb9CJvpPJpnsCQ/q197x', 'joinRoom');
// scripts\joinRoom.js

cc.Class({
  "extends": cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }

    var isComplete = this._lastEmptyLabel() == null;
    if (isComplete && this.callbackJoinRoom) {
      var roomNumber = this._roomNumber();
      // cc.log("要加入的房间号是：", roomNumber);
      this.callbackJoinRoom(roomNumber);
    }
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{}],"launch":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0efb2ngHglDtK2A+W4dmfzt', 'launch');
// scripts\launch.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.scheduleOnce(function () {
            cc.director.loadScene('login');
        }, 0.5);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"login":[function(require,module,exports){
(function (Buffer){
"use strict";
cc._RFpush(module, '9c72dn88ytPxZWrZRaxt5cr', 'login');
// scripts\login.js

var manager = require('manager');
var KQCard = require('KQCard');
var Socket = require('socket');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');

var APPID = 'wxe8993f468b16fa5d';
var ROOMID = '';
//授权地址
//正式地址
// var REDIRECT_URI = "http%3A%2F%2Fwww.honggefeng.cn%2FsszWeb%2Findex.php";
// 测试地址
var REDIRECT_URI = "http%3a%2f%2fo1o2.cn";

var HREF = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + APPID + "&redirect_uri=" + REDIRECT_URI + "&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";

cc.Class({

    'extends': cc.Component,
    properties: {
        //selectNode:cc.Node,
        alertPrefab: cc.Prefab,
        canvasNode: cc.Node,
        loadingNode: cc.Node,
        //err:cc.Node,
        waitingPrefab: cc.Prefab,
        recordInfo: cc.Prefab,
        label: cc.Label
    },

    goUpdateAction: function goUpdateAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod("AppController", "downloadNewVersion:", this.iosUrl);
        } else {
            //Android
            jsb.reflection.callStaticMethod("com/gongpa/ssz/AppActivity", "downloadNewVersion", "(Ljava/lang/String;)V", this.androidUrl);
        }
    },

    checkVersion: function checkVersion(vData) {
        //var version = vData.version;
        cc.info1 = vData.version;
        this.iosUrl = vData.iosUrl;
        this.androidUrl = vData.androidUrl;
        //if (manager.version != version) {//更新版本
        //    this.versionEnable = false;
        //    this.goUpdateAction();
        //    //this.versionLabel.string = '请到服务器更新到最新版本';
        //}
        //else {
        //this.versionLabel.string = '当前版本 ' + manager.version;
        if (KQNativeInvoke.isNativeIOS()) {
            // if(iosVersion != manager.version) {
            //     this.versionEnable = false;
            //     var updateAlert = cc.find("Canvas/update").getComponent("alert");
            //     updateAlert.alert();
            // }
            // else {
            this.versionEnable = true;
            var self = this;
            var info = manager.getUserInfo();
            if (info.length == 0) {
                this.loginEnable = true;
            }
            this.scheduleOnce(function () {
                if (info.length > 0) {
                    this.loginEnable = true;
                    self.loginAction();
                }
            }, 0.5);
            //}
        } else if (KQNativeInvoke.isNativeAndroid()) {
                // if(androidVersion != manager.version) {
                //     this.versionEnable = false;
                //     var updateAlert = cc.find("Canvas/update").getComponent("alert");
                //     updateAlert.alert();
                // }
                // else {
                this.versionEnable = true;
                var self = this;
                var info = manager.getUserInfo();
                if (info.length == 0) {
                    this.loginEnable = true;
                }
                this.scheduleOnce(function () {
                    if (info.length > 0) {
                        this.loginEnable = true;
                        self.loginAction();
                    }
                }, 0.5);
                //}
            } else {
                    this.versionEnable = true;
                    var self = this;
                    // var info = manager.getUserInfo();
                    // if (info.length == 0) {
                    //     this.loginEnable = true;
                    // }
                    this.scheduleOnce(function () {
                        if (!cc.sys.isNative) {
                            var recordId = self.getQueryString('recordId');
                            if (recordId) {
                                Socket.sendGetRecrodFromId(recordId);
                                return;
                            }
                            var roomId = self.getQueryString("roomId");
                            if (roomId) {
                                var info = manager.getUserInfo();
                                if (info.length > 0) {
                                    var data = JSON.parse(info);
                                    if (!data.errcode) {
                                        self.sendLoginRequest(data);
                                    } else {
                                        manager.setUserInfo("");
                                    }
                                    return;
                                } else {
                                    self._get_HREF(roomId);
                                }
                            }
                        }
                        var info = manager.getUserInfo();
                        if (info.length > 0) {
                            var data = null;
                            try {
                                data = JSON.parse(info);
                            } catch (e) {
                                manager.setUserInfo("");
                                data = null;
                            }
                            if (!data || data.errcode) {
                                manager.setUserInfo("");
                            } else {
                                this.loginEnable = true;
                                self.loginAction();
                            }
                        } else {
                            if (!cc.sys.isNative) {
                                var code = self.getQueryString("code");
                                var roomId = self.getQueryString("roomId");
                                if (roomId) {
                                    var info = manager.getUserInfo();
                                    if (info.length > 0) {
                                        var data = JSON.parse(info);
                                        if (!data.errcode) {
                                            self.sendLoginRequest(data);
                                        } else {
                                            manager.setUserInfo("");
                                        }
                                        return;
                                    } else {
                                        self._get_HREF(roomId);
                                    }
                                }
                                if (code) {
                                    try {
                                        var obj = new XMLHttpRequest(); // XMLHttpRequest对象用于在后台与服务器交换数据
                                        var url = "./get_token.php";
                                        obj.open("POST", url, true);
                                        obj.setRequestHeader("Content-type", "application/x-www-form-urlencoded"); // 添加http头，发送信息至服务器时内容编码类型
                                        obj.onreadystatechange = function () {
                                            if (obj.readyState == 4 && (obj.status == 200 || obj.status == 304)) {
                                                // 304未修改
                                                //alert(obj.responseText);
                                                var data = JSON.parse(obj.responseText);
                                                if (!data.errcode) {
                                                    manager.setUserInfo(obj.responseText);
                                                    self.sendLoginRequest(data);
                                                }
                                            }
                                        };
                                        obj.send("code=" + code);
                                    } catch (e) {
                                        //alert(e);
                                    }
                                }
                            }
                        }
                    }, 0.5);
                }
        //}
    },
    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },
    //随机生成 num 位 的随机数 含大小写字母及数字
    getRandomAccount: function getRandomAccount(num) {
        /**
         * 返回一个字母
         */
        function getCharacter(flag) {
            var character = "";
            if (flag === "lower") {
                character = String.fromCharCode(Math.floor(Math.random() * 26) + "a".charCodeAt(0));
            }
            if (flag === "upper") {
                character = String.fromCharCode(Math.floor(Math.random() * 26) + "A".charCodeAt(0));
            }
            return character;
        }

        var str = "";
        for (var i = 0; i < num; i++) {
            var flag = "lower";
            var random = Math.floor(Math.random() * 3);
            if (random == 0) {
                flag = "upper";
                str += getCharacter(flag);
            } else if (random == 1) {
                str += getCharacter(flag);
            } else {
                str += Math.floor(Math.random() * 10);
            }
        }
        return str;
    },
    getGuestUserInfo: function getGuestUserInfo() {
        var search = window.location.search;
        var openid = "guest_" + this.getRandomAccount(8);
        var unionid = 'guest_' + this.getRandomAccount(8);
        var nickname = this.getRandomAccount(8);
        var testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
        return testData;
    },
    onLoad: function onLoad() {
        this.keyBackListen();
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var canvas = cc.find("Canvas");
            var cvs = canvas.getComponent(cc.Canvas);
        }
        KQGlabolSocketEventHander.start();
        this.socket = cc.find('GameSocket').getComponent('socket');
        var self = this;
        this.loginEnable = false;
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
            //console.log(data)
            if (data.action == 'checkVersion') {
                try {
                    self.checkVersion(data.data);
                } catch (e) {
                    //this.err.string = e;
                }
            } else if (data.action == 'login') {
                    if (data.result) {
                        //成功
                        self.socket.userInfo = data.data; //运行时态信息
                        if (!cc.sys.isNative) {
                            var roomId = self.getQueryString("roomId");
                            //console.log(roomId);
                            if (roomId) {
                                var userId = data.data.id;
                                var exitInRoom = data.data.roomId;
                                if (exitInRoom != "") {
                                    roomId = exitInRoom;
                                }
                                Socket.sendLoginJoin(roomId, userId);
                                return;
                            }
                        }
                        self._loadingLabel("登录中");
                        if (data.data.roomId.length > 0) {
                            cc.director.loadScene('play');
                        } else {
                            cc.director.loadScene('hall');
                        }
                    } else {
                        // self.alertMessage('登录失败!');
                    }
                }
        };
        this._registerSocketEvent();

        this.socket.getWxInfo = function (info) {
            manager.setUserInfo(info); //保存本地
            var data = JSON.parse(info); //str -> json(obj)
            self.scheduleOnce(function () {
                //延迟执行 1s
                self.sendLoginRequest(data); //登录请求
            }, 1);
        };
        this.getOnlyUserInfoByBrowser();
        //cc.sys.localStorage.removeItem("userinfo");
        // let search = window.location.search;
        // var openid = "JzIwMTcvNi8xNiDkuIrljYgxMMzowOCc=";
        // var unionid = '8dOtAcDic5Sichv3lxtMXYJgmunTLOLv';
        // var nickname = "哇哈哈";

        //var openid = "JzIwMTcvNi8xNiDkuIrljYgxMMzowOCc=";
        //var openid = "guest_" + this.getRandomAccount(8);
        //var unionid = '8dOtAcDic5Sichv3lxtMXYJgmunTLOLv';
        //var unionid = 'guest_' + this.getRandomAccount(8);
        //var nickname = this.getRandomAccount(8);

        //if (search) {
        //    var url = window.location.search;
        //    var loc = url.substring(url.lastIndexOf('=') + 1, url.length);
        //    if (loc == 1) {
        //        openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';
        //        unionid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc';
        //        nickname = loc;
        //    }
        //    else if (loc == 2) {
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';
        //        unionid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw';
        //        nickname = loc;
        //    }
        //    else if (loc == 3) {
        //        openid = 'JzIwMTctNi0xNiAwOTo0NToc=';
        //        unionid = '8dOtAcDic5Sichv3lxtMXYmunTLOLv';
        //        nickname = loc;
        //    }
        //    else if (loc == 4) {
        //        openid = 'ozlXIwgv_QJT0ykdUihaABmsWp2A';
        //        unionid = 'o-3911qWsQsW3wUodqFfUtbsAeNk';
        //        nickname = loc;
        //    }
        //    else if (loc == 5) {
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';
        //         unionid = 'o-JzIwMTcvNi8xNiDkuIrljYgxMDowM';
        //        nickname = loc;
        //    }else if(loc == 6){
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYgxMMzoc=';
        //         unionid = 'o-zIwMTcvNi8xNiDkuIrl';
        //        nickname = loc;
        //    }
        //
        //}
        // var testData = '{"openid":"'+openid+'","nickname":"'+nickname+'","unionid":"'+unionid+'","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';

        //if (!cc.sys.isNative){
        //    var info = manager.getUserInfo();
        //    if (info.length > 0) {
        //        //this.showWaitingMessage('已存有账号=====');
        //        //return;
        //    }else
        //    {
        //        //this.showWaitingMessage('新账号=====');
        //        var userInfo = this.getGuestUserInfo();
        //        manager.setUserInfo(userInfo);
        //    }
        //}
    },

    getOnlyUserInfoByBrowser: function getOnlyUserInfoByBrowser() {
        var openid = "";
        var unionid = "";
        var nickname = "";

        var testData = "";
        var userInfo = manager.getUserInfo();

        var search = window.location.search;
        if (userInfo.length > 0) {
            openid = userInfo.openId;
            unionid = userInfo.unionid;
            nickname = userInfo.nickname;
        }

        if (search) {
            var url = window.location.search;
            var loc = url.substring(url.lastIndexOf('=') + 1, url.length);
            if (loc == 1) {
                openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';
                unionid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc';
                nickname = "guest_1";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 2) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';
                unionid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw';
                nickname = "guest_2";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 3) {
                openid = 'JzIwMTctNi0xNiAwOTo0NToc=';
                unionid = '8dOtAcDic5Sichv3lxtMXYmunTLOLv';
                nickname = "guest_3";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 4) {
                openid = 'ozlXIwgv_QJT0ykdUihaABmsWp2A';
                unionid = 'o-3911qWsQsW3wUodqFfUtbsAeNk';
                nickname = "guest_4";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 5) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';
                unionid = 'o-JzIwMTcvNi8xNiDkuIrljYgxMDowM';
                nickname = "guest_5";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 6) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYgxMMzoc=';
                unionid = 'o-zIwMTcvNi8xNiDkuIrl';
                nickname = "guest_6";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            }
        }
        if (testData && testData.length > 0) {
            if (!cc.sys.isNative) {
                manager.setUserInfo(testData);
            }
        }
    },
    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveLoginJoin, this._LoginJoin, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRecordId, this._ReceiveRecordId, this);
        KQGlobalEvent.on(Socket.Event.ReceiveNoUionid, this._ReceiveNoUionid, this);
    },
    _get_HREF: function _get_HREF(roomId) {
        if (roomId != ROOMID) {
            ROOMID = roomId;
            roomId = "%3froomId%3d" + roomId;
            REDIRECT_URI = REDIRECT_URI + roomId;
            HREF = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + APPID + "&redirect_uri=" + REDIRECT_URI + "&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";
        }
    },
    _ReceiveNoUionid: function _ReceiveNoUionid(response) {
        manager.setUserInfo("");
        var self = this;
        var roomId = this.getQueryString("roomId");
        if (roomId) {
            //roomId = "%3froomId%3d"+roomId ;
            //REDIRECT_URI = REDIRECT_URI+roomId;
            this._get_HREF(roomId);
        }
        setTimeout(function () {
            self.loadingNode.parent.active = false;
            self.loadingNode.stopAllActions();
        }, 2000);
        this._loadingLabel("登录失败，请重新登录");
    },
    _ReceiveRecordId: function _ReceiveRecordId(response) {
        var data = response.data;
        if (data.recordMsg.length > 0) {
            var record = data.recordMsg[0];
            var playersInfo = JSON.parse(record.playersInfo).players;
            var recordNode = cc.instantiate(this.recordInfo);
            var totalGameResult = recordNode.getComponent("TotalGameResult");
            playersInfo.sort(function (a, b) {
                return b.totalScore - a.totalScore;
            }); // 排序
            totalGameResult.setPlayerInfos(playersInfo, record);
            totalGameResult._clickBtn();
            recordNode.getComponent('alert').alert();
            this.node.addChild(recordNode);
        }
    },
    _LoginJoin: function _LoginJoin(response) {
        this._loadingLabel("进入房间，正在为您请求数据");
        if (response.result) {
            if (cc.from == null) {
                cc.from = {};
            }
            cc.from.ma = response.data.maPai;
            cc.director.loadScene('play');
        } else {
            cc.joinDesk = {};
            cc.director.loadScene('hall');
            var reasonInfo = this._joinReasonMap(response.data.reason);
            cc.joinDesk.result = response.result;
            cc.joinDesk.reason = reasonInfo;
        }
    },
    _joinReasonMap: function _joinReasonMap(reason) {
        var reasonInfo = {
            notExist: "房间不存在!",
            cardNumber: "您房卡不足!"
        };
        var info = reasonInfo[reason] || "房间已满!";
        return info;
    },

    getQueryString: function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);return null;
    },

    agreements: function agreements() {
        this.agreementNode.active = true;
        //this.agreementLabel.string = cc.info1;
        this.agreementLabel.node.y = 0;
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
    },

    _loadingLabel: function _loadingLabel(label) {
        this.label.string = label;
    },

    sendLoginRequest: function sendLoginRequest(data) {
        //this.showWaitingMessage('登录中...');
        this.loadingNode.parent.active = true;
        this.loadingNode.runAction(cc.repeatForever(cc.rotateBy(2, 360)));
        //return;
        this.socket.sendMessage('login', data);
    },

    loginAction: function loginAction() {
        if (!cc.sys.isNative) {
            var info = manager.getUserInfo();
            if (info.length > 0) {
                //this.showWaitingMessage('已存有账号=====');
                //return;
            } else {
                    //this.showWaitingMessage('新账号=====');
                    var userInfo = this.getGuestUserInfo();
                    manager.setUserInfo(userInfo);
                }
        }

        var info = manager.getUserInfo();
        if (info.length > 0) {
            var data = JSON.parse(info);
            this.sendLoginRequest(data);
            return;
        }
        if (!cc.sys.isNative) {
            // cc.sys.openURL(HREF);
            window.location.href = HREF;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
            } else if (KQNativeInvoke.isNativeAndroid()) {
                    //Android
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
                }
        }
    },

    changeGuestUserInfo: function changeGuestUserInfo() {
        manager.setUserInfo('');
        this.loginAction();
    },

    loginYkAction: function loginYkAction() {
        //var comp = this.selectNode.getComponent('select');
        //if (!comp.selected) {
        //    this.showMsg = cc.instantiate(this.alertPrefab);
        //    this.canvasNode.addChild(this.showMsg);
        //    let comp = this.showMsg.getComponent('alert');
        //    comp.setMessage('请同意用户协议');
        //    return;
        //}
        var testDate = new Date();
        var time = "'" + testDate.toLocaleString() + "'";
        var openid = new Buffer(time).toString('base64');
        var testData = '{"openid":"' + openid + '","nickname":"游客","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/BVyz4R8q6puJibEv1hrsaTmIKQhkaTS9FyvcevvC5hlxFnfOuspDjicG0GtzyJXOhNT7g1WZDeCDQhnRdEOgz3QMnP0F9iboQGy\/0","privilege":[]}';
        var data = JSON.parse(testData);
        this.sendLoginRequest(data);
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.isValid(this.waitingNode)) {
            if (msg == this.waitingNode.getComponent('alert').getMessage()) {
                return;
            }
            this.waitingNode.removeFromParent();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.canvasNode.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        //console.log(comp);

        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    protocolAction: function protocolAction() {
        cc.log('protocol action');
    }
});

cc._RFpop();
}).call(this,require("buffer").Buffer)

},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","buffer":2,"manager":"manager","socket":"socket"}],"maPai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8b896xHkCtE1IzD8BDK4cWL', 'maPai');
// scripts\Play\maPai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        maPaiSprite: [cc.SpriteFrame],
        spriteNode: cc.Sprite,
        labelNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"manager":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4a47fj0J/VHup24OT7njkko', 'manager');
// scripts\manager.js

module.exports = {
    version: 'v1.0.0',

    setUserInfo: function setUserInfo(str) {
        cc.sys.localStorage.setItem('userinfo', str);
    },

    getUserInfo: function getUserInfo() {
        var value = cc.sys.localStorage.getItem('userinfo');
        if (!value) {
            return "";
        }
        return value;
    },

    setMusicValue: function setMusicValue(value) {
        cc.sys.localStorage.setItem('musicVolumn', value);
    },

    getMusicValue: function getMusicValue() {
        var value = cc.sys.localStorage.getItem('musicVolumn');
        if (!value) {
            return 1;
        }
        return value;
    },

    setMusicEffectValue: function setMusicEffectValue(value) {
        cc.sys.localStorage.setItem('musicEffectVolumn', value);
    },

    getMusicEffectValue: function getMusicEffectValue() {
        var value = cc.sys.localStorage.getItem('musicEffectVolumn');
        if (!value) {
            return 1;
        }
        return value;
    }
};

cc._RFpop();
},{}],"overTime":[function(require,module,exports){
"use strict";
cc._RFpush(module, '48748u5hxdOD4WTPWQqSQwN', 'overTime');
// scripts\overTime.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        //selectedIndex: 0,
        _selected: 1
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        this._select = true;
        var overTime = 0;
        if (cc.set) {
            overTime = cc.set.setting6;
            this._selected = this._select = overTime;
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select;
            this._selected = this._select;
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (self._select) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                this.setSelected(self._selected = self._select = !self._select);
                var title = this.node.getChildByName("title");
                if (self._select) {
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    title.color = new cc.Color(255, 255, 255);
                }
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "orders" && cc.set) {
            //this.remember_set(overTime);
        }
    },
    remember_set: function remember_set(obj) {
        for (var i = 0; i < this.nodes.length; i++) {
            this.nodes[i].getComponent('select').setSelected(obj);
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (obj) {
                var title = this.nodes[0].getChildByName('title');
                title.color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
    }

});

cc._RFpop();
},{}],"play":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16c65H2Pw9PBaQSvw69LGLQ', 'play');
// scripts\play.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var Manager = require('manager');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
var fecha = require('fecha');
var manager = require('manager');
/*#####*/
var KQCard = require('KQCard');
/**/
var Player = require('Player');
/**/
//const isTeShuPai = require('isTeShuPai');
//特殊牌类型
var TESHUPAITYPE = {
    isTeShuPai: false,
    isLiuDuiBan: false,
    isSanShunZi: false,
    isSanTaoHua: false,

    isQingLong: false,
    isYiTiaoLong: false,
    isSanTongHuaShun: false,
    isSanFenTianXia: false,
    isCouYiSe: false,
    isSiTaoSanTiao: false,
    isWuDuiSanTiao: false
};

var GAMESTATUS = {
    WAIT_PEOPLE: 0, // 等人
    WAIT_READY: 1, // 等待他人准备
    PLAYING: 2 };
// 正在玩游戏
var sTitle = '';
var sDescription = '';
var sId = '';
// 布局
//          2
//   3            1
//     self 0
var Play = cc.Class({
    'extends': cc.Component,

    properties: {
        playerNodes: [cc.Node],
        //playsCoins: [cc.Node],
        chatNode: cc.Node,
        cardTypeCombineNode: cc.Node,
        typeButtonsNode: cc.Node,
        phone: cc.Label,
        labelRoomNumber: cc.Label,
        labelOverview: cc.Label,
        labelRemainTime: cc.Label,
        btnShare: cc.Button,
        btnReady: cc.Button, // 准备按钮
        btnStartGame: cc.Button, // 开始按钮
        beilv: cc.Node, // 选择倍率节点
        btnChatVoice: cc.Button,
        btnChatText: cc.Button,
        againBtn: cc.Node,

        startCompareCardsNode: cc.Node,
        settingNode: cc.Node,
        VoiceMsgBg: cc.Node,
        exit: cc.Node, // 离开房间节点
        Dissolve: cc.Node, // 解散房间节点
        shareBg: cc.Node, // 分享背景
        totalGameResult: cc.Node, // 结果节点
        alertRequestExitNode: cc.Node, // 申请退出 Node
        dissolveAlter: cc.Node, // 申请退出 Node
        alertRequestExitCountdownNode: cc.Node, // 申请退出倒计时 Node
        alertAnsowerExitNode: cc.Node, // 回答申请退出  Node
        contentAnsowerExitNode: cc.Node, // 回答申请退出头像  Node
        alertAnsowerExitResult: cc.Node, // 回答申请退出结果  Node
        alertAnsowerExitCountdownNode: cc.Node, // 回答以上请退出的倒计时
        Countdown: cc.Node, // 倒计时
        labelTime: cc.Label,
        needCard: cc.Label,
        alert: cc.Node,
        coinsContainerNode: cc.Node,
        btnAlertRequestExitConfirmButton: cc.Button,
        btnAlertRequestExitCancelButton: cc.Button,

        autoTishi: cc.Prefab,
        waitingPrefab: cc.Prefab,
        coinsPrefab: cc.Prefab,
        playerComps: [Player],

        gongXiNi: cc.Node,
        teShuPai: cc.Node,

        cardSpriteAtlas: cc.SpriteAtlas,
        daoSpriteAtlas: cc.SpriteAtlas,

        _liuDuiBan: false,
        _sanShunZi: false,
        _sanTongHua: false,
        _yiTiaoLong: false,

        _QingLong: false,
        _SanTongHuaShun: false,
        _SanFenTianXia: false,
        _CouYiSe: false,
        _SiTaoSanTiao: false,
        _WuDuiSanTiao: false,

        _playerComponents: null,
        _msgControl: null,
        _nowTimeAgain: 0,

        _socket: null,
        _userId: 0,
        _playerInfos: null,
        _deskInfo: null, // createTime 创建时间  isDissolving 表示是否正在解散 dissolveLeftTime 离解散剩余多长时间 dissolveAnswerInfo [处理过的人的信息]
        _gameStatus: GAMESTATUS.WAIT_PEOPLE,
        _enterTime: null,
        _bigRecordInfo: null,
        _players: null,
        /**/
        _isComparingCardsNow: false, // 是否正在比牌
        _playedCompareCardsIndexs: [], // 已经播放过比牌的局数
        /**/
        fapaiNode: cc.Prefab,
        liuduiban: cc.Prefab,
        santonghua: cc.Prefab,
        sanshunzi: cc.Prefab,
        quanleida: cc.Prefab
    },
    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },
    // use this for initialization
    onLoad: function onLoad() {
        var _this2 = this;

        this.keyBackListen();
        this.headCardTime = 0.85;
        var bg = this.node.getChildByName("room_bg");
        var windowP = cc.director.getWinSizeInPixels();
        var scaleX = windowP.width / bg.width;
        var scaleY = windowP.height / bg.height;
        var scale = Math.max(scaleX, scaleY);
        bg.scaleX = scale;
        bg.scaleY = scale;

        this.BtnClickGongXiNiComfirm = this.cardTypeCombineNode.getComponent("CardTypeCombine").BtnClickGongXiNiComfirm;
        this._enterTime = Date.now();
        /**/
        this.playerComps.forEach(function (playerComp) {
            playerComp.playedCompareCardsIndexs = _this2._playedCompareCardsIndexs;
        });
        /**/
        /*AudioManager.instance.playDeskMusic();*/

        AudioManager.instance.stopHallMusic();
        var bgSound = cc.sys.localStorage.getItem("bgSound");
        if (bgSound == 0) {
            var audioManager = cc.find('AudioManager');
            audioManager = audioManager.getComponent('AudioManager');
            audioManager.setEffectMusicVolum(bgSound);
        }

        this._initPlayerComponents();
        this._initSelectCardNode();
        this._initOneGameResult();
        this._remainTimeStartUpdate();

        this._userId = Socket.instance.userInfo.id;
        this._msgControl = this.chatNode.getComponent('MsgControl');
        this._userId = Socket.instance.userInfo.id;
        this.beilv.getComponent("selectbeilv")._userid = this._userId;
        //this.settingNode.getComponent("Setting").hideSwitch();
        this.labelRoomNumber.string = "";
        this.labelRemainTime.node.active = false;

        this._registerVoiceNodeEvents();
        this._registerSocketEvent();

        Play.instances = this;
        this._gongXiNiShow(false);
        if (Playback.instance.isContainPlaybackDatas()) {
            Playback.instance.startPlayback();
            this.playbackNode.active = true;
            this.btnChatVoice.node.active = false;
            //this.cardsFromArray.node.active = false;
        } else {
                this._loadDeskInfo();
            }

        this._socket = Socket.instance;

        cc.director.preloadScene('hall', function () {
            cc.director.preloadScene('login');
        });

        cc.clickOut = false;
        //this.timeStart(5);
    },

    timeStart: function timeStart(duration, action) {
        cc.assert(duration > 0);
        this.timeStop();
        this.Countdown.active = true;
        if (action != "ready") {
            var timestamp = cc.sys.localStorage.getItem("timestamp"); // 获取本地存储的时间戳
            if (timestamp) {
                // 如果有则证明玩家是重新进来了的
                var now = Date.parse(new Date());
                var time = duration * 1000;
                if (now - timestamp > time) {
                    // 超时
                    if (now - timestamp < 2 * time) {
                        duration = 5; // 玩家可能出于其他原因退出游戏导致超时，为其提供5秒时间整理牌型（这已经是很仁慈的了）。
                    } else {
                            cc.sys.localStorage.removeItem("timestamp");
                        }
                } else {
                    duration = Math.floor(duration - (now - timestamp) / 1000);
                }
            } else {
                // 如果没有时间戳，则保存，为玩家退出游戏保留证据；
                var timestamp = Date.parse(new Date());
                cc.sys.localStorage.setItem('timestamp', timestamp);
            }
        }
        this._timeRemainDuration = duration;
        this.labelTime.string = String(duration);
        this.Countdown.getComponent("time").setTime(duration * 0.5);
        var self = this;
        this.callback = function () {
            self._timeMethod(action);
        };
        this.schedule(this.callback, 1, duration);
    },

    timeStop: function timeStop() {
        this.unschedule(this.callback);
        this.Countdown.active = false;
    },

    _timeMethod: function _timeMethod(action) {
        this._timeRemainDuration = this._timeRemainDuration - 1;

        var remain = Math.max(this._timeRemainDuration, 0);
        this.labelTime.string = remain < 10 && remain > 0 ? '0' + remain : remain;

        if (this._timeRemainDuration <= 0) {
            this.timeStop();
            if (action == "ready") {
                if (this._deskInfo.cIndex > 0) {
                    this.clickReady();
                }
            }
            cc.sys.localStorage.removeItem("timestamp");
            return;
        }
    },

    _globalMsg: function _globalMsg(data) {
        //if(!cc.sys.isNative){
        var roomId = data.roomId;
        var wf = data.setting3; ///[疯狂场,鬼牌,比花色,坐庄,马牌]
        var room = "房号：" + roomId;
        var fk = wf[0] ? "疯狂场 " : "普通场 "; // 疯狂场
        var gp = wf[1] ? "鬼牌 " : "无鬼 "; // 鬼牌
        var hs = wf[2] ? "比花色 " : "不比花色 "; // 比花色
        var zj = wf[3] ? "坐庄 " : "不坐庄 "; // 庄家
        var mp = wf[4] ? "买马 " : "不买马 "; // 马牌
        var sf = "房费:" + (data.setting4 ? data.setting4 == 1 ? "赢者扣 " : "房主扣 " : "平摊 "); //收费
        var shareTitle = room + " 模式:" + zj + sf;

        var pj = ["5局 ", "10局 ", "20局 "]; //牌局
        var ds = ["4人不加色 ", "5人加一色 ", "6人二色 ", "7人加三色 "]; //多色
        var rs = ds[data.setting2] + "";
        var js = pj[data.setting1 - 2];
        var desc = '[大众十三水] ' + zj + fk + mp + gp + sf + rs + js + " 点击直接进入房间";

        sTitle = shareTitle;
        sDescription = desc;
        sId = 'roomId=' + roomId;

        cc.sys.localStorage.setItem('roomId', roomId);
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);

        if (cc.sys.isBrowser) {
            if (window.shareToTimeLine) {
                window.shareToTimeLine();
            }
            if (window.shareToSession) {
                window.shareToSession();
            }
        }
        //}
    },

    /*#####*/
    /*显示马牌*/
    _initMaPai: function _initMaPai() {},

    _initPlayerComponents: function _initPlayerComponents(playerIndex) {
        this._playerComponents = this.playerNodes.map(function (node) {
            return node.getComponent('Player');
        });

        if (!playerIndex) {
            playerIndex = [0, 1, 2, 3, 4, 5];
        }

        var a = this._playerComponents.splice(1, 7);

        for (var i = 0; i < playerIndex.length - 1; i++) {
            var index1 = playerIndex[i];
            var index2 = playerIndex[i + 1];
            var tmp = null;
            tmp = a[index1];
            a[index1] = a[index2];
            a[index2] = tmp;
        }

        a.forEach((function (node) {
            this._playerComponents.push(node);
        }).bind(this));

        if (this.playsCoins && this.playsCoins.length > 0) {
            this.playsCoins.forEach((function (node) {
                node.active = false;
            }).bind(this));
        }

        this.playsCoins = [];

        this._playerComponents.forEach((function (plays, i) {
            var name = "coins" + i;

            var node = new cc.Node();

            node.name = name;

            node.x = plays.node.x;

            node.y = plays.node.y;

            this.node.addChild(node);

            this.playsCoins.push(node);
        }).bind(this));
    },

    _initSelectCardNode: function _initSelectCardNode() {
        var self = this;
        var cardTypeCombineComp = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombineComp.setFinishSelectCardsCallback(function (serverCardsInfo) {
            cardTypeCombineComp.reset();
            Socket.sendPlayCard(self._userId, serverCardsInfo);
            self.cardTypeCombineNode.active = false;
        });
    },

    /**/
    _initOneGameResult: function _initOneGameResult() {
        var self = this;
        // this.oneGameResult.setCloseCallback = function () {
        //     if (self._isRandomRoom()) {
        //         cc.director.loadScene('hall');
        //     }
        // };
    },

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickLeaveDesk: function clickLeaveDesk() {
        // 点击离开桌子
        if (this._deskInfo.cIndex == 0) {
            // 还没开始可以退出房间
            if (this._deskInfo.createId == this._userId) {
                cc.director.loadScene('hall');
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
        }
    },
    clickDissolveDesk: function clickDissolveDesk() {
        // 点击解散桌子
        if (this._deskInfo.createId == this._userId) {
            // 只有房主才能解散桌子
            this.btnAlertRequestExitCancelButton.node.active = true;
            this.btnAlertRequestExitConfirmButton.node.active = true;
            var _alert = this.alertRequestExitNode.getComponent('alert');
            _alert.unscheduleAllCallbacks();
            _alert.setMessage("是否要解散房间");
            _alert.alert();
        }
    },

    clickExitOut: function clickExitOut() {
        Socket.sendDissolveDesk(this._userId);
    },

    //解散退出房间
    clickExit: function clickExit() {
        if (Playback.instance.isPlaybacking()) {
            cc.director.loadScene('hall');
            return;
        }
        /**/
        if (this._deskInfo && this._deskInfo.isDeskOver) {
            if (!this._isComparingCardsNow) {
                // 如果房间已结束，并且不是正在播放打牌动画, 则直接离开房间
                cc.director.loadScene('hall');
            }
            return;
        }
        /**/
        //if (this._isRandomRoom()) {
        //    this.alertForceExitNode.getComponent('alert').alert();
        //    return;
        //}
        if (this._deskInfo.cIndex == 0) {
            if (this._deskInfo.createId == this._userId) {
                var alert1 = this.dissolveAlter.getComponent('alert');
                alert1.alert();
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
            return;
        }
        this.btnAlertRequestExitCancelButton.node.active = true;
        this.btnAlertRequestExitConfirmButton.node.active = true;

        var alert = this.alertRequestExitNode.getComponent('alert');
        alert.unscheduleAllCallbacks();
        alert.setMessage("是否解散房间？");
        alert.alert();

        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },
    //不解散退出房间
    clickOut: function clickOut() {
        if (this._deskInfo.cIndex == 0) {
            if (this._deskInfo.createId == this._userId) {
                cc.clickOut = true;
                cc.director.loadScene('hall');
                return;
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
        }
    },

    clickShareBg: function clickShareBg() {
        cc.find("Canvas/shareBg").active = false;
        this.shareBg.active = false;
    },
    guanzhu: function guanzhu() {
        // var url = "http://www.honggefeng.cn/gzh/index.html";
        // cc.sys.openURL(url)
    },
    recordShare: function recordShare() {
        if (this._deskInfo.recordId) {
            var shareTitle = "[大众十三水]战绩";
            var roomId = "房间号：" + this._deskInfo.roomId;
            var pj = ["5 ", "10 ", "20 "]; //牌局
            var js = "局数：" + pj[this._deskInfo.setting1 - 2];
            var time = "时间：" + this._deskInfo.createTime;
            var desc = roomId + js + time + "点击查看详情";

            var recordId = this._deskInfo.recordId;
            cc.sys.localStorage.setItem("shareTitle", shareTitle);
            cc.sys.localStorage.setItem("desc", desc);
            cc.sys.localStorage.setItem("recordId", recordId);
            cc.sys.localStorage.setItem("roomId", '');

            sTitle = shareTitle;
            sDescription = desc;
            sId = 'roomId=' + roomId;
            if (recordId) {
                sId = 'recordId=' + recordId;
            }

            if (cc.sys.isBrowser) {
                if (window.shareToTimeLine) {
                    window.shareToTimeLine();
                }
                if (window.shareToSession) {
                    window.shareToSession();
                }
            }
        };
        if (!cc.sys.isNative) {
            cc.find("Canvas/shareBg").active = true;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
            } else {
                //Android
                KQNativeInvoke.screenshotShare();
            }
        }
    },
    // 点击桌面分享
    clickDeskShare: function clickDeskShare() {
        //this._globalMsg(this._deskInfo);
        if (!cc.sys.isNative) {
            var shareBg = cc.find("Canvas/shareBg");
            shareBg.active = true;
            //var wxBg = this.shareBg.getChildByName("wx");
            //var pyqBg = this.shareBg.getChildByName("PYQ");
            //wxBg.active = true;
            //pyqBg.active = false;
            //this.shareBg.active = true;
        }
        var id = sId;
        var title = sTitle;
        var description = sDescription;
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
        }
    },
    //点击分享按钮
    clickShare: function clickShare() {
        //this._globalMsg(this._deskInfo);
        if (!cc.sys.isNative) {
            var wxBg = this.shareBg.getChildByName("wx");
            var pyqBg = this.shareBg.getChildByName("PYQ");
            wxBg.active = true;
            pyqBg.active = false;
            this.shareBg.active = true;
        }
        var id = sId;
        var title = sTitle;
        var description = sDescription;

        // let roomId = String(this._deskInfo.roomId);
        // var description = "大众十三水 玩法:"
        // description = description + " " + this._deskInfoNumberOfPeople();
        // description = description + "," + this._deskInfoPayInfo();
        // description = description + " " + this._deskInfoNumberOfGame();

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
        }
    },

    //分享到朋友圈
    shareHallTimeline: function shareHallTimeline() {
        if (!cc.sys.isNative) {
            var wxBg = this.shareBg.getChildByName("wx");
            var pyqBg = this.shareBg.getChildByName("PYQ");
            wxBg.active = false;
            pyqBg.active = true;
            this.shareBg.active = true;
        } else {
            var id = sId;
            var title = sTitle;
            var description = sDescription;

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
            }
        }
    },

    //点击准备按钮
    clickReady: function clickReady() {
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.timeStop();
        Socket.sendReady(this._userId);
    },

    //点击开始按钮
    clickStartGame: function clickStartGame() {
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.btnStartGame.node.active = false;
        Socket.sendStartGame(this._userId);
    },

    updateRoomNumber: function updateRoomNumber(roomNumber) {
        var gameNumberString = "";
        if (this._deskInfo.setting1 != 0 && this._deskInfo.setting1 != 1) {
            gameNumberString = "局数 : " + "" + this._deskInfo.cIndex + "/" + this._deskInfo.mMax;
        } else if (this._deskInfo.setting1 == 0) {
            gameNumberString = "局数 : 10局";
        } else if (this._deskInfo.setting1 == 1) {
            gameNumberString = "局数 : 20局";
        }
        this.labelRoomNumber.string = "房号 : " + "" + roomNumber + "    " + gameNumberString;
    },

    updateGameStatus: function updateGameStatus() {
        var status = arguments.length <= 0 || arguments[0] === undefined ? GAMESTATUS.WAIT_PEOPLE : arguments[0];

        this._gameStatus = status;

        this.btnShare.node.active = status == GAMESTATUS.WAIT_PEOPLE;
        this.btnReady.node.active = status == GAMESTATUS.WAIT_READY;
        this.isReadyStatus();
    },

    gameStatus: function gameStatus() {
        return this._gameStatus;
    },
    isReadyStatus: function isReadyStatus() {
        if (this._playerInfos && this._playerInfos.length > 0) {
            this._playerInfos.forEach((function (playerInfo) {
                var userInfoSelf = cc.find('Canvas/playSelf/userInfoSelf');
                if (playerInfo.id == this._userId) {
                    if (!playerInfo.readyStatus && !this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas()) {
                        userInfoSelf.getComponent('userInfo').setReadyNodeVisible(false);
                        if (this._deskInfo.cIndex == 0) {
                            //一局还没开始
                            this.btnReady.node.active = false;
                            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {
                                this.btnShare.node.active = true;
                            } else {
                                this.btnShare.node.active = false;
                            }

                            if (this._deskInfo.players.length >= 2 && this._deskInfo.createId == this._userId) {
                                //是否是房主
                                this.btnStartGame.node.active = true;
                            } else {
                                this.btnStartGame.node.active = false;
                            }
                        } else {
                            this.btnReady.node.active = true;
                            this.btnShare.node.active = false;
                            this.btnStartGame.node.active = false;
                            this.btnStartGame.node.active = false;
                        }
                    } else {
                        this.btnReady.node.active = false;
                        this.btnShare.node.active = false;
                        this.btnStartGame.node.active = false;
                        if (!this._isComparingCardsNow) {
                            userInfoSelf.getComponent('userInfo').setReadyNodeVisible(true);
                        } else {
                            this._playerComponents.forEach(function (playerComp) {
                                playerComp.hideReadyStatus();
                            });
                        }
                    }
                }
                //console.log(this._isComparingCardsNow)
                //console.log("准备状态--------")
                if (this._isComparingCardsNow) {
                    //
                    this._playerComponents.forEach(function (playerComp) {
                        playerComp.hideReadyStatus();
                    });
                }
            }).bind(this));
        }
    },

    isGameStart: function isGameStart() {
        if (this._deskInfo.cIndex == 0) {
            //一局还没开始
            if (this._deskInfo.createId == this._userId) {
                //是否是房主
                if (!this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas() && this._deskInfo.players.length >= 2) {
                    this.btnStartGame.node.active = true;
                    this.btnReady.node.active = false;
                } else {
                    this.btnStartGame.node.active = false;
                }
            } else {
                this.btnStartGame.node.active = false;
            }

            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {
                this.btnShare.node.active = true;
            } else {
                this.btnShare.node.active = false;
            }
        } else {
            this.btnStartGame.node.active = false;
            this.btnShare.node.active = false;
        }
    },

    /// 游戏动画
    _startGame: function _startGame(playMusic) {

        if (this.gameStatus() == GAMESTATUS.PLAYING) {
            return;
        }
        //this._playerInfos = players;
        //this._playerComponents.forEach(function (player) {
        //
        //});
        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset(); //#####
            playerComp.hideReadyStatus();
        });
        this.teShuPai.active = false;

        this.unscheduleAllCallbacks();

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        this._playerComponents.forEach((function (plays, i) {

            var name = "coins" + i;

            var node = this.node.getChildByName(name);

            if (node) {
                node.removeAllChildren();
                this.node.removeChild(node);
            }
        }).bind(this));
        // cc.log(this.node)
        // cc.log('------709')
        this._updateUserInfos(this._playerInfos);
        this.showCompareCard();
        this._isComparingCardsNow = true;
        this.updateGameStatus(GAMESTATUS.PLAYING);
        this._playFaPaiAnimation(playMusic);

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');

        cardTypeCombine.reset();

        cardTypeCombine.node.active = false;

        if (!UserModelHelper.isPlayedCards(this._findPlayerInfoByUserId(this._userId))) {
            this.node.getComponent("animation").fapaiAnimation();
            this.scheduleOnce((function () {
                this._showCardTypeCombine();
            }).bind(this), 1.9);
        }
    },

    _playFaPaiAnimation: function _playFaPaiAnimation(playMusic) {
        this._playerComponents.forEach(function (player) {
            player.playFaPaiAnimation();
        });
        if (playMusic) {
            AudioManager.instance.playFaPai();
        }
    },

    /*#####*/
    //是否特殊牌
    isTeShuPai: function isTeShuPai(cards) {
        var result = KQCard.isTeShuPai(cards);
        if (result) {
            TESHUPAITYPE.isTeShuPai = true;
        } else {
            TESHUPAITYPE.isTeShuPai = false;
        }
        return result;
    },
    //是否一条龙
    isYiTiaoLong: function isYiTiaoLong(cards) {
        var result = KQCard.isYiTiaoLong(cards);
        if (result) {
            TESHUPAITYPE.isYiTiaoLong = true;
        } else {
            TESHUPAITYPE.isYiTiaoLong = false;
        }
        return result;
    },
    //是否六对半
    isLiuDuiBan: function isLiuDuiBan(cards) {
        var result = KQCard.isLiuDuiBan(cards);
        if (result) {
            TESHUPAITYPE.isLiuDuiBan = true;
        } else {
            TESHUPAITYPE.isLiuDuiBan = false;
        }
    },
    //是否三顺子
    isSanShunZi: function isSanShunZi(cards) {
        var result = KQCard.isSanShunZi(cards);
        if (result) {
            TESHUPAITYPE.isSanShunZi = true;
        } else {
            TESHUPAITYPE.isSanShunZi = false;
        }
    },
    //是否三同花
    isSanTongHua: function isSanTongHua(cards) {
        var result = KQCard.isSanTongHua(cards);
        if (result) {
            TESHUPAITYPE.isSanTaoHua = true;
        } else {
            TESHUPAITYPE.isSanTaoHua = false;
        }
    },
    //是否三同花顺
    isSanTongHuaShun: function isSanTongHuaShun(cards) {
        var result = KQCard.isSanTongHuaShun(cards);
        if (result) {
            TESHUPAITYPE.isSanTongHuaShun = true;
        } else {
            TESHUPAITYPE.isSanTongHuaShun = false;
        }
    },
    //是否是清龙
    isQingLong: function isQingLong(cards) {
        var result = KQCard.isQingLong(cards);
        if (result) {
            TESHUPAITYPE.isQingLong = true;
        } else {
            TESHUPAITYPE.isQingLong = false;
        }
    },
    //是否是 “三分天下”
    isSanFenTianXia: function isSanFenTianXia(cards) {
        var result = KQCard.isSanFenTianXia(cards);
        if (result) {
            TESHUPAITYPE.isSanFenTianXia = true;
        } else {
            TESHUPAITYPE.isSanFenTianXia = false;
        }
    },
    //是否是 “四套三条”
    isSiTaoSanTiao: function isSiTaoSanTiao(cards) {
        var result = KQCard.isSiTaoSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isSiTaoSanTiao = true;
        } else {
            TESHUPAITYPE.isSiTaoSanTiao = false;
        }
    },
    //是否是五对三条
    isWuDuiSanTiao: function isWuDuiSanTiao(cards) {
        var result = KQCard.isWuDuiSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isWuDuiSanTiao = true;
        } else {
            TESHUPAITYPE.isWuDuiSanTiao = false;
        }
    },
    //是否是凑一色
    isCouYiSe: function isCouYiSe(cards) {
        var result = KQCard.isCouYiSe(cards);
        if (result) {
            TESHUPAITYPE.isCouYiSe = true;
        } else {
            TESHUPAITYPE.isCouYiSe = false;
        }
    },
    /*#####*/

    /*显示配牌页面*/
    _showCardTypeCombine: function _showCardTypeCombine() {
        if (Playback.instance.isPlaybacking()) {
            return;
        }
        if (this.cardTypeCombineNode.active) {
            return;
        }

        this.startCompareCardsNode.active = false;
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;

        cc.teShuPaiCards = null;

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombine.reset();
        cardTypeCombine.reloadCards([]);
        cardTypeCombine.node.active = true;
        cardTypeCombine.timeStart(60);
        this.timeStart(60, "");
        this.cardTypeCombineNode.scale = 1;

        var cards = this._findCardsByUserId(this._userId);
        //"1_9""3_9""2_9"
        // "2_7""1_7""3_3""2_12"
        //"1_1""1_3""2_6""1_11""2_1""3_4"//
        // if(this._userId == 2){
        //     cards = [{suit: "d", number:2},{suit: "d", number:2}, {suit: "d", number:2},//青龙

        //         {suit: "h", number:2}, {suit: "d", number:2},
        //         {suit: "c", number:3}, {suit: "c", number:3}, {suit: "c", number:3},

        //         {suit: "d", number:3}, {suit: "d", number:4},
        //         {suit: "d", number:4}, {suit: "d", number:4}, {suit: "d", number:4}];
        // }
        //if(this._userId == 1){d
        //    cards = [{suit: "c", number:1},{suit: "h", number:1}, {suit: "s", number:1},//青龙
        //
        //        {suit: "h", number:8}, {suit: "c", number:2},
        //        {suit: "d", number:8}, {suit: "h", number:8}, {suit: "d", number:20},
        //        {suit: "h", number:9}, {suit: "s", number:9},
        //        {suit: "s", number:9}, {suit: "s", number:9}, {suit: "h", number:9}];
        //}
        // else if(this._userId == 6){
        //     cards = [{suit: "d", number:11},{suit: "d", number:13}, {suit: "d", number:11},//青龙
        //         {suit: "d", number:1}, {suit: "d", number:1},
        //         {suit: "h", number:2}, {suit: "h", number:4}, {suit: "h", number:9},
        //         {suit: "s", number:7}, {suit: "s", number:7},
        //         {suit: "s", number:5}, {suit: "s", number:5}, {suit: "s", number:5},];
        // }

        //else if(this._userId == 3){
        //    cards = [{suit: "d", number:4},{suit: "d", number:13}, {suit: "s", number:13},//青龙
        //        {suit: "d", number:6}, {suit: "s", number:7},
        //        {suit: "d", number:8}, {suit: "c", number:9}, {suit: "c", number:10},
        //        {suit: "s", number:1}, {suit: "s", number:3},
        //        {suit: "s", number:10}, {suit: "s", number:8}, {suit: "s", number:12},];
        //}
        cc.moshi = 0;
        for (var i = 0; i < cards.length; i++) {
            var s = cards[i].number;
            if (s >= 20) {
                cc.moshi = 1;
                break;
            }
        }
        var cardNames = this._convertCardsToCardNames(cards);
        cardTypeCombine.reloadCards(cardNames);
        cardTypeCombine.addCardModes(cardNames);

        //cc.from.moshi == 0选择了庄家模式

        if (cc.moshi != 1) {
            this.isTeShuPai(cards);
            this.isQingLong(cards);
            this.isYiTiaoLong(cards);
            this.isLiuDuiBan(cards);
            this.isSanShunZi(cards);
            this.isSanTongHua(cards);
            if (TESHUPAITYPE.isTeShuPai) {
                this.cardTypeCombineNode.scale = 0;
                var nodes = this.gongXiNi.getChildByName("bg");
                nodes.opacity = 240;
            }
            //this.isSanTongHuaShun(cards);
            //this.isSanFenTianXia(cards);
            //this.isSiTaoSanTiao(cards);
            //this.isWuDuiSanTiao(cards);
            //this.isCouYiSe(cards);
            this._showGongXiNiAndBtnTeShuPai();
        }
        cardTypeCombine.cacleAutoSelectedCards2();

        if (cc.moshi == 1) cc.teShuPaiCards = null;
        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset(); //#####
            playerComp.hideReadyStatus();
        });
    },

    getIsTeShuPai: function getIsTeShuPai(userId) {
        var cards = this._findCardsByUserId(userId);
        return this.isTeShuPai(cards);
    },

    /*#####检测特殊牌类型，显示相对应的恭喜你页面和特殊牌精灵*/
    _showGongXiNiAndBtnTeShuPai: function _showGongXiNiAndBtnTeShuPai() {
        /*如果有特殊牌*/
        if (TESHUPAITYPE.isTeShuPai) {
            if (TESHUPAITYPE.isQingLong) {
                this._gongXiNiShow(true, "同花十三水");
                this._sanTongHua = true;
            } else if (TESHUPAITYPE.isYiTiaoLong) {
                this._gongXiNiShow(true, "十三水");
                this._yiTiaoLong = true;
            } else if (TESHUPAITYPE.isLiuDuiBan) {
                this._gongXiNiShow(true, "六对半");
                this._liuDuiBan = true;
            } else if (TESHUPAITYPE.isSanShunZi) {
                this._gongXiNiShow(true, "三顺子");
                this._sanShunZi = true;
            } else if (TESHUPAITYPE.isSanTaoHua) {
                this._gongXiNiShow(true, "三同花");
                this._sanTongHua = true;
            }
            //else if(TESHUPAITYPE.isSanTongHuaShun){
            //    this._gongXiNiShow(true);
            //    this._SanTongHuaShun = true;
            //}
            //else if(TESHUPAITYPE.isSanFenTianXia){
            //    this._gongXiNiShow(true);
            //    this._SanFenTianXia = true;
            //}
            //else if(TESHUPAITYPE.isCouYiSe){
            //    this._gongXiNiShow(true);
            //    this._CouYiSe = true;
            //}
            //else if(TESHUPAITYPE.isSiTaoSanTiao){
            //    this._gongXiNiShow(true);
            //    this._SiTaoSanTiao = true;
            //}
            //else if(TESHUPAITYPE.isWuDuiSanTiao){
            //    this._gongXiNiShow(true);
            //    this._WuDuiSanTiao = true;
            //}
            else {
                    this._gongXiNiShow(false);
                }
        }
        //this._initTeShuPaiSprite();
    },

    /*#####控制特殊牌精灵的显示*/
    _initTeShuPaiSprite: function _initTeShuPaiSprite() {
        /*把所有的特殊牌精灵都隐藏掉*/
        //for(var i=0;i<this.teshupai_min.length;i++){
        //    this.teshupai_min[i].active = false;
        //    this.teshupai_max[i].active = false;
        //}
        ///*如果是一条龙，就显示一条龙的精灵*/
        //if(this._yiTiaoLong){
        //    this.teshupai_min[3].active = true;
        //    this.teshupai_max[3].active = true;
        //}
        ///*如果是六对半就显示六对半的精灵*/
        //else if(this._liuDuiBan){
        //    this.teshupai_min[0].active = true;
        //    this.teshupai_max[0].active = true;
        //}
        ///*如果是三顺子就显示三顺子的精灵*/
        //else if(this._sanShunZi){
        //    this.teshupai_min[1].active = true;
        //    this.teshupai_max[1].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._sanTongHua){
        //    this.teshupai_min[2].active = true;
        //    this.teshupai_max[2].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._QingLong){
        //    this.teshupai_min[4].active = true;
        //    this.teshupai_max[4].active = true;
        //}_gongXiNiShow
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SanTongHuaShun){
        //    this.teshupai_min[5].active = true;
        //    this.teshupai_max[5].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SanFenTianXia){
        //    this.teshupai_min[6].active = true;
        //    this.teshupai_max[6].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._CouYiSe){
        //    this.teshupai_min[7].active = true;
        //    this.teshupai_max[7].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SiTaoSanTiao){
        //    this.teshupai_min[8].active = true;
        //    this.teshupai_max[8].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._WuDuiSanTiao){
        //    this.teshupai_min[9].active = true;
        //    this.teshupai_max[9].active = true;
        //}
    },

    /*#####*/
    //显示gongXiNi 页面和teShuPai
    clickGongXiNiShow: function clickGongXiNiShow() {
        this.cardTypeCombineNode.scale = 1;
        var nodes = this.gongXiNi.getChildByName("bg");
        nodes.opacity = 0;
    },

    _gongXiNiShow: function _gongXiNiShow(statues) {
        var test = arguments.length <= 1 || arguments[1] === undefined ? "" : arguments[1];

        //var alterCom = this.gongXiNi.getComponent("alert");
        var alterCom = this.gongXiNi.getComponent('alert');
        alterCom.unscheduleAllCallbacks();
        test = "是否按特殊牌型[" + test + "]出牌？" + "\n" + "(取消后点击左下角可再报道)";
        alterCom.setMessage(test);
        if (statues) {
            alterCom.alert();
        } else {
            alterCom.dismissAction();
        }
        this.teShuPai.active = statues;
        var nodes = this.teShuPai.getChildByName("btnTeshupai");
        nodes.children[0].runAction(cc.repeatForever(cc.rotateBy(1, -360)));
        nodes.children[1].runAction(cc.repeatForever(cc.rotateBy(1, 360)));
    },
    /*#####*/

    //  结果相关
    // 显示一局结果
    _showOneGameResult: function _showOneGameResult() {
        /**/
        this._isComparingCardsNow = false;
        /**/
        this.updateGameStatus(GAMESTATUS.WAIT_PEOPLE);
        //let oneGameResult = this.oneGameResult.getComponent('GameResult');
        //oneGameResult.unscheduleAllCallbacks();
        //oneGameResult.showResults(this._deskInfo, this._userId);
        this._updateUserScores();
        //this._updateBanker();
        //
        var self = this;
        this.scheduleOnce(function () {
            //self._playerComponents.forEach(function (playerComp) {
            //  //playerComp.reset();
            //  //playerComp.reset2();  //#####
            //});

            if (!self._isRandomRoom()) {
                //if (self._deskInfo.cIndex == 0) {//一局还没开始
                //    self.btnReady.node.active = true;
                //}
                if (self._isTotalGameOver()) {
                    self._showTotalGameResult();
                }
            }
        }, 0.5);

        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.scheduleOnce(function () {
                oneGameResult.getComponent('alert').dismissAction();
                cc.director.loadScene('hall');
            }, 2);
            return true;
        }
    },

    // 显示总结果
    _showTotalGameResult: function _showTotalGameResult() {
        var showDelay = arguments.length <= 0 || arguments[0] === undefined ? 2 : arguments[0];

        this.timeStop();
        //cc.find("Canvas/show_result").active = false;
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.alertAnsowerExitNode.active = false;
        this.alertRequestExitNode.active = false;
        if (this._deskInfo.cIndex == this._deskInfo.mMax) {
            this.againBtn.active = true;
        } else {
            this.againBtn.active = false;
        }

        var totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');
        if (totalGameResultComp.node.active) {
            return;
        }

        if (this._bigRecordInfo == null) {
            this._bigRecordInfo = this._deskInfo.players;
        }
        totalGameResultComp.setPlayerInfos(this._bigRecordInfo, this._deskInfo);

        var alert = this.totalGameResult.getComponent('alert');
        this.scheduleOnce((function () {
            //this.oneGameResult.active = false;
            //alert.alert();
            /**/
            if (!this.totalGameResult.active) {
                alert.alert();
            }
            /**/
        }).bind(this), showDelay);

        alert.setDismissCallback(function () {
            Socket.sendOnceAgain('false', this._userId);
            //cc.director.loadScene('hall');
        });
    },
    clickAgain: function clickAgain() {
        Socket.sendOnceAgain('true', this._userId);
    },

    // MARK: Socket 相关
    _loadDeskInfo: function _loadDeskInfo() {
        Socket.sendGetDesckInfo(this._userId);
    },
    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveOnlineStatus, this._socketReciveOnlineStatus, this);
        KQGlobalEvent.on(Socket.Event.ReceiveChatText, this._socketReciveChatTextMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveChatEmoji, this._socketReciveChatEmojiMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolve, this._socketReceiveRequestExitMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolveResult, this._socketReceiveRequestExitResultMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveAudioMessage, this._socketReceiveAudioMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceivePlayCard, this._socketReceivePlayCard, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGameOver, this._socketReceiveGameOver, this);
        KQGlobalEvent.on(Socket.Event.ReceiveFaPai, this._socketReciveFaPai, this);
        KQGlobalEvent.on(Socket.Event.ReceiveReady, this._socketReciveReady, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDissolveDesk, this._socketReceiveDissolveDesk, this);
        KQGlobalEvent.on(Socket.Event.ReceiveLeaveDesk, this._socketLeaveDesk, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._receiveSocketConnectError, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._receiveSocketConnectSuccessed, this);
        KQGlobalEvent.on(Socket.Event.ReceivePause, this._socketReceivePause, this);
        KQGlobalEvent.on(Socket.Event.ReceiveSelectBeiLv, this._ReceiveSelectBeiLv, this);
        KQGlobalEvent.on(Socket.Event.ReceiveBeiLv, this._ReceiveBeiLv, this);
        KQGlobalEvent.on(Socket.Event.ReceiveQingLi, this._ReceiveQingLi, this);
        KQGlobalEvent.on(Socket.Event.ReceiveOnceAgain, this._ReceiveOnceAgain, this);
    },

    _ReceiveOnceAgain: function _ReceiveOnceAgain(response) {
        var _this3 = this;

        /**
         * 再来一局
         * 总结果要隐藏掉
         * 比牌要隐藏掉
         * 发牌要显示
         */
        this._playedCompareCardsIndexs = [];
        this.playerComps.forEach(function (playerComp) {
            playerComp.playedCompareCardsIndexs = _this3._playedCompareCardsIndexs;
        });
        var data = response.data;
        if (!data.reason) {
            this.totalGameResult.active = false;
            this.startCompareCardsNode.active = false;
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset(); //#####
            });
            this._socketReceiveDeskInfo(response);
        } else {
            var now = Date.now();
            if (now - this._nowTimeAgain > 1500) {
                this._nowTimeAgain = now;
                this.alertAnsowerExitResult.y = -143;
                this.alertAnsowerExitResult.opacity = 255;
                this.alertAnsowerExitResult.children[0].getComponent(cc.Label).string = '房卡不足';
                var action = cc.spawn(cc.moveTo(0.3, cc.p(0, 20)), cc.fadeOut(0.3));
                this.alertAnsowerExitResult.runAction(cc.sequence(cc.moveTo(1, cc.p(0, 0)), action));
            }
        }
    },

    _ReceiveSelectBeiLv: function _ReceiveSelectBeiLv() {
        if (this._deskInfo.createId != this._userId) {
            this.beilv.active = true;
            var B3 = this.beilv.getChildByName('bg').getChildByName('btn3').getComponent(cc.Button);
            if (this._deskInfo.setting5 == 1) {
                /**
                 * 庄家选择两倍的时候 3倍按钮是不能响应的
                 * 选择三倍不用管，全部显示，
                 * 选择一倍也不用管，直接发牌，
                 */
                B3.interactable = false;
            }
            var selectBl = this.beilv.getComponent('selectBeilv');
            selectBl._userid = this._userid;
        }
    },

    _ReceiveBeiLv: function _ReceiveBeiLv(response) {
        var userId = response.data.userId;
        var bl = response.data.beilv;
        this._playerComponents.forEach(function (player) {
            player.showBeilv(userId, bl);
        });
    },

    _ReceiveQingLi: function _ReceiveQingLi(response) {
        var leaveId = response.data.leaveId;
        if (leaveId == this._userId) {
            if (cc.qingli == null) {
                var ql = response.action;
                cc.qingli = '';
                cc.qingli = ql;
            }
            cc.director.loadScene('hall');
        }
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        var data = response.data;

        this._initPlayerComponents(data.playersIndexAyy);
        /*#####添加五同按钮*/
        // cc.moshi = 0;

        // if(data.setting3[1] == true) cc.moshi = 1;  //  ？？？

        cc.maPai = null;

        if (data.maPai.length == 2) cc.maPai = data.maPai[0] + "_" + data.maPai[1];

        cc.huaSe = data.setting3[2];

        cc.chaoShiChuPai = data.setting6;

        cc.duoYiSe = response.data.setting2; //setting2为 4~7 人（0~3）

        this._deskInfo = data;
        this._globalMsg(data);
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(data.roomId);
        this.needCard.string = data.needCard; // 开放需要的房卡
        var playerIndexs = data.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._updateUserScores();
        this._updateBanker();
        this._msgControl.addPlayerInfos(this._playerInfos);

        var currentUserInfo = players.find((function (playerInfo) {
            return playerInfo.id == this._userId;
        }).bind(this));

        if (data.createId == this._userId) {
            if (data.cIndex > 0) {
                // 开始游戏了，请离按钮全部隐藏
                this._playerComponents.forEach(function (player) {
                    player.showQingli(false, data.cIndex);
                });
            } else {
                // 游戏没开始，房主的请离按钮不显示
                this._playerComponents.forEach(function (player) {
                    if (data.createId == player.userId) {
                        // 我是房主，不显示我的请离按钮
                        player.showQingli(true, data.cIndex);
                    } else {
                        player.showQingli(false, data.cIndex);
                    }
                });
            }
        }

        this._playerComponents.forEach(function (player) {
            if (data.createId == player.userId) {
                //显示房主
                player.showFangZhuStatus(data.createId, true);
            } else {
                player.showFangZhuStatus(player.userId, false);
            }
        });

        if (this._deskInfo.createId != this._userId) {
            // 非庄家
            if (this._deskInfo.cIndex == 0) {
                // 如果还没开始游戏，显示退出按钮，隐藏解散按钮
                this.exit.active = true;
                this.Dissolve.active = false;
            } else {
                // 反之
                this.exit.active = false;
                this.Dissolve.active = true;
            }
        } else {
            // 庄家
            if (this._deskInfo.cIndex > 0) {
                // 开局了 隐藏退出按钮
                this.exit.active = false;
                this.Dissolve.active = true;
            } else {
                // 没开局 两个都显示
                this.exit.active = true;
                this.Dissolve.active = true;
            }
        }

        if (!this._deskInfo.isCBegin) {
            this._gameStatus = GAMESTATUS.WAIT_READY;
        }
        for (var i = 0; i < players.length; i++) {
            var s = players[i];
            var is = s.readyStatus; //true/false
            var userId = s.id;
            this._playerComponents.forEach((function (player) {
                if (!this._deskInfo.isCBegin) player.showReadyStatus(userId, is);
            }).bind(this));
        }
        if (currentUserInfo && currentUserInfo.cards.length > 0 && this._deskInfo.isCBegin) {
            if (!currentUserInfo.cardInfo.length) {
                this._startGame(true);
            } else {
                this._startGame(false);
            }
        } else if (UserModelHelper.isPlayedCards(currentUserInfo) && !this._deskInfo.isCBegin) {
            this._socketReceiveGameOver(response);
        }
        this.isReadyStatus();
        this._handleUpdateDeskInfoAboutExitRoom(this._deskInfo);
        this.showCompareCard();
    },

    showCompareCard: function showCompareCard() {
        if (this._deskInfo.cIndex == 0 || this._deskInfo.isCBegin || !this._deskInfo.players || this._deskInfo.players.length <= 0 || this._deskInfo.players[0].cardInfo <= 0) {
            return;
        }

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        this.unscheduleAllCallbacks();

        this.node.stopAllActions();

        this._playerComponents.forEach(function (playerComp) {
            playerComp.readyToCompareCards();
        });

        this._playerComponents.forEach((function (player) {

            if (player.node.active) player.showAllCompareCards(this._deskInfo.players);
        }).bind(this));

        this.startCompareCardsNode.active = false;

        this._isComparingCardsNow = false;

        this.isReadyStatus();

        this.scheduleOnce((function () {

            if (this._isTotalGameOver()) this._showTotalGameResult();
        }).bind(this), 0.5);
    },

    _socketReciveFaPai: function _socketReciveFaPai(response) {
        //  发牌了开始比牌隐藏掉
        this.startCompareCardsNode.active = false;
        this.timeStop();
        this._isComparingCardsNow = true;
        this._gameStatus = GAMESTATUS.WAIT_READY;
        this._socketReceiveDeskInfo(response);
    },
    logoutAction: function logoutAction() {
        cc.director.loadScene('login');
        //manager.setUserInfo('');
        //hall.cacheImageInfo = null;
    },
    _socketReciveOnlineStatus: function _socketReciveOnlineStatus(response) {
        //{"action":"sendOnlineStatus","result":true,"data":{"userId":100049,"status":1}}
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }

        var data = response.data;
        var userId = data.userId;
        var status = data.status;

        this._playerComponents.forEach(function (player) {
            player.setUserOnlineStatus(userId, status);
        });
    },

    _socketReciveChatTextMessage: function _socketReciveChatTextMessage(response) {
        var userId = response.data.userId;
        var message = response.data.msg;

        this._playerComponents.forEach(function (player) {
            player.showChatText(userId, message);
        });

        this._msgControl.addChatTextMessage(userId, message);

        var sex = this._playerInfos.find(function (user) {
            return user.id == userId;
        }).sex;
        AudioManager.instance.playChatAudio(sex, message);
    },
    _socketReciveChatEmojiMessage: function _socketReciveChatEmojiMessage(response) {
        var userId = response.data.userId;
        var emoji = response.data.emoji;

        //this._playerComponents.forEach(function (player) {
        //    player.showChatText(userId, emoji);
        //});
        //this._msgControl.addChatEmojiMessage(userId, emoji);
        this._msgControl._loadEmojiFrame(emoji, (function (frame) {
            this._playerComponents.forEach(function (player) {
                if (player.userId == userId) player.chatMessageNode.getComponent('ChatMessage').showEmoji(frame);
            });
        }).bind(this));
    },

    _socketReceiveRequestExitMessage: function _socketReceiveRequestExitMessage(response) {
        //if (response.data.userId == this._userId) {
        //    return;
        //}

        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");

        var btnAgree = alert_bg.getChildByName("btnAgree");

        var btnDisagree = alert_bg.getChildByName("btnDisagree");

        btnAgree.active = true;

        btnDisagree.active = true;

        var dataInfos = response.data.info;

        if (!this.alertAnsowerExitNode.active) {

            var alertComp = this.alertAnsowerExitNode.getComponent('alert');

            alertComp.alert();

            alertComp.unscheduleAllCallbacks();

            this.contentAnsowerExitNode.children.forEach(function (i) {
                i.active = false;
            });

            this._playerInfos.forEach((function (playerInfo, index) {

                var play = this.contentAnsowerExitNode.children[index];

                var name = play.getChildByName("nickname");

                var back = play.getChildByName("fanzhu");

                var img = play.getChildByName("avatar_bg");

                play.active = true;

                name.getComponent(cc.Label).string = playerInfo.nickname;

                if (this._deskInfo.createId == playerInfo.id) {
                    //显示房主

                    back.active = true;
                } else {

                    back.active = false;
                }

                cc.loader.load({ url: playerInfo.avatarUrl, type: "jpg" }, (function (err, data) {

                    if (err) return;

                    var frame = new cc.SpriteFrame(data);

                    img.getComponent(cc.Sprite).spriteFrame = frame;
                }).bind(this));
            }).bind(this));

            var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');

            countdown.startCountdown(60, (function (isTimeout) {

                if (isTimeout) {

                    this.clickAgreeOtherPlayerExit();

                    return;
                }
            }).bind(this));
        }

        this._playerInfos.forEach((function (playerInfo, index) {

            var dataInfo = dataInfos[index];

            var play = this.contentAnsowerExitNode.children[index];

            var str = play.getChildByName("id");

            var dataInfo = dataInfos[index];

            if (dataInfo == 1) {

                if (this._userId == playerInfo.id) {
                    //显示房主

                    btnAgree.active = false;

                    btnDisagree.active = false;
                }

                str.getComponent(cc.Label).string = "同意";
            } else {

                str.getComponent(cc.Label).string = "";
            }
        }).bind(this));
    },

    _socketReceiveRequestExitResultMessage: function _socketReceiveRequestExitResultMessage(response) {
        this._hideReqestExitNode();
        if (this.alertAnsowerExitNode.active) {
            this.alertAnsowerExitNode.getComponent('alert').dismissAction();
            this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        }

        if (response.data.result) {
            // 解散成功
        } else {
                var userId = response.data.userId;
                var nickname = this._findPlayerInfoByUserId(userId).nickname;
                this.alertAnsowerExitResult.y = -143;
                this.alertAnsowerExitResult.opacity = 255;
                this.alertAnsowerExitResult.children[0].getComponent(cc.Label).string = nickname + '不同意退出';
                var action = cc.spawn(cc.moveTo(.3, cc.p(0, 20)), cc.fadeOut(this.cardTime));
                this.alertAnsowerExitResult.runAction(cc.sequence(cc.moveTo(1, cc.p(0, 0)), action));

                //this.showAlertMessage('解散失败，因为' + nickname + '不同意退出');
            }
    },

    _socketReceiveAudioMessage: function _socketReceiveAudioMessage(response) {
        var userId = response.data.userId;
        this.playSpeakAnimation(userId);

        if (userId == this._userId) {
            return;
        }

        var url = response.data.url;
        this.playAudioUrl(url);
    },

    _socketReceivePlayCard: function _socketReceivePlayCard(response) {
        // 有用户已经准备好了牌
        var userId = response.data[0].userId;
        var cardInfo = response.data[1].card;
        this._deskInfo = response.data[2].s;
        var players = response.data[2].s.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._playerComponents.forEach(function (player) {
            player.playCard(userId, cardInfo);
        });

        if (userId == this._userId) {
            this.cardTypeCombineNode.active = false;
        }
    },
    _getSelfReadyStatus: function _getSelfReadyStatus() {
        var self = this._findPlayerInfoByUserId(this._userId);
        return self.readyStatus;
    },
    _socketReciveReady: function _socketReciveReady(response) {
        var userId = response.data.userId;
        this._playerComponents.forEach((function (player) {
            if (!this._deskInfo.isCBegin) player.showReadyStatus(userId);
        }).bind(this));
    },

    //收到游戏结束
    _socketReceiveGameOver: function _socketReceiveGameOver(response) {
        this.timeStop();
        cc.sys.localStorage.removeItem("timestamp");

        this._hideReqestExitNode();

        // 一局游戏结束
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        /**/
        var deskInfo = response.data;
        if (response.action == 'gameOver' && deskInfo.isDeskOver) {

            Socket.sendDidReceiveGameOverAction(this._userId);
        }
        /**/
        this._deskInfo = response.data;

        // 如果是强制解散房间，则直接显示总成绩
        if (this._isDissvledRoom() && !Playback.instance.isPlaybacking()) {
            this._showTotalGameResult(0.1);
            return;
        }

        if (Date.now() - this._enterTime < 1000 * 4) {
            // 刚进来的话，不展示比牌动画
            //  let oneGameResult = this.oneGameResult.getComponent('GameResult');
            //  oneGameResult.unscheduleAllCallbacks();
            //  oneGameResult.showResults(this._deskInfo, this._userId);
            this.isReadyStatus();
            this.btnShare.node.active = false;
            this.btnReady.node.active = true;
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
            /**/
            this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
            /**/
            return;
        }

        var data = response.data;
        this._deskInfo = data;
        this._bigRecordInfo = data.bigRecordInfo;
        //console.log(data);
        //console.log("-----------------------------------1709");
        this._updatGameOverview(this._deskInfo);
        //let playerIndexs = data.playersIndex; // [100049]

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        //this._updateRecordInfo(players);

        if (UserModelHelper.isUserReady(this._findCurrentUserInfo())) {
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
        } else {
            this._startCompareCards(response);
        }

        if (Date.now() - this._enterTime < 1000 * 4) {
            this.showCompareCard();
            return;
        }
    },
    // _updateRecordInfo:function(players){

    //     // this._bigRecordInfo.push();
    // },
    _socketReceiveDissolveDesk: function _socketReceiveDissolveDesk(response) {
        this.cardTypeCombineNode.active = false;
        cc.director.loadScene('hall');

        // this.alert.getComponent('alert').setWillDismissCallback(function(){

        //   return true;
        // });

        // let message = "房主已解散房间";
        // if (this._isRandomRoom()) {
        //   message = "有玩家已强制退出房间，游戏结束。本局游戏不会扣除您的钻石。";
        // }

        // this.showAlertMessage(message, false);
    },
    /**/
    _socketLeaveDesk: function _socketLeaveDesk(response) {
        if (!response.result) {
            return;
        }

        if (this._deskInfo.isDeskOver) {
            // 如果房间已结束，也不用再自动退回到大厅了
            return;
        }

        cc.director.loadScene('hall');
    },
    /**/
    // socket 收到有人手机进入后台消息
    _socketReceivePause: function _socketReceivePause(response) {
        if (!response.result) {
            return;
        }

        var userId = response.data.userId;
        this._playerComponents.forEach(function (player) {
            if (player.userId == userId) {
                player.setUserOnlineStatus(userId, 0);
            }
        });
    },

    _receiveSocketConnectError: function _receiveSocketConnectError(response) {
        this.showNetworkMessage();
    },

    _receiveSocketConnectSuccessed: function _receiveSocketConnectSuccessed(response) {
        this.hiddenNetworkMessage();

        if (!Playback.instance.isPlaybacking()) {
            this._loadDeskInfo();
        }
    },
    /**/
    // MARK: 更新房间信息
    updateDeskInfo: function updateDeskInfo(deskInfo) {
        this._deskInfo = deskInfo;
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(deskInfo.roomId);

        var playerIndexs = deskInfo.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = deskInfo.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._msgControl.addPlayerInfos(this._playerInfos);
        if (deskInfo.cIndex == 0 && this._deskInfo.players.length < this._deskInfo.maxNumber) {
            this.btnShare.node.active = true;
        }
    },
    /**/
    _injectUserIdToPlayerComponents: function _injectUserIdToPlayerComponents(playerIndexs) {
        var currentUserIdIndex = playerIndexs.findIndex((function (userId) {
            return userId == this._userId;
        }).bind(this));

        var fixedPlayerIndexs = playerIndexs.translationWithStartIndex(currentUserIdIndex);
        this._playerComponents.forEach(function (playerComponent, index) {
            var userId = fixedPlayerIndexs.length > index ? fixedPlayerIndexs[index] : null;
            playerComponent.userId = userId;
        });
    },

    _updateUserInfos: function _updateUserInfos(userInfos) {
        var self = this;
        this._playerComponents.forEach(function (playerComponent, index) {
            //playerComponent.setDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateUserInfoWithUsers(userInfos);
        });

        //this._handleTheSameOfIPAdress(userInfos);
    },

    _updateUserScores: function _updateUserScores(userInfos) {
        this._playerComponents.forEach(function (player) {
            player.updateScore();
        });
    },

    _updateBanker: function _updateBanker() {
        this._playerComponents.forEach(function (player) {
            player.updateBanker();
        });
    },

    // 私有方法
    _findCardsByUserId: function _findCardsByUserId(userId) {
        var player = this._findPlayerInfoByUserId(userId);

        return player != null ? player.cards : null;
    },

    _findPlayerInfoByUserId: function _findPlayerInfoByUserId(userId) {
        var player = (this._playerInfos || []).find(function (playerInfo) {
            return userId == playerInfo.id;
        });

        return player;
    },

    _findPlayerIndexByUserId: function _findPlayerIndexByUserId(userId) {
        //let index = this._playerComponents.findIndex(function (playerComp) {
        //    return playerComp.userId == userId;
        //});
        var index = this.playerNodes.findIndex(function (node) {
            return node.getComponent('Player').userId == userId;
        });
        return index;
    },

    _findCurrentUserInfo: function _findCurrentUserInfo() {
        return this._findPlayerInfoByUserId(this._userId);
    },

    _convertCardsToCardNames: function _convertCardsToCardNames(cards) {
        // [{"suit":"s","number":10}]
        var suitColorMap = {
            s: 4,
            h: 3,
            c: 2,
            d: 1
        };
        return cards.map(function (card) {
            var cardNumber = card.number;

            // 服务器中的 14 是 A
            if (card.number == 14) {
                cardNumber = 1;
            }
            var color = suitColorMap[card.suit];
            var number = Math.max(Math.min(cardNumber, 21), 1);
            return color + "_" + number;
        });
    },

    // 更新游戏总览信息
    _updatGameOverview: function _updatGameOverview(deskInfo) {
        if (Playback.instance.isPlaybacking()) {
            this.labelOverview.string = "回放";
            return;
        }

        if (this._isRandomRoom()) {
            this.labelOverview.string = "";
            return;
        }
        var bihuase = "不比花色 ";
        var zuozhuang = "不坐庄 ";
        var putong = "普通场 ";
        var wugui = "无鬼 ";
        var maPai = '不买马 ';
        var renshu = "4人不加色 ";
        var card = "平摊";

        //[疯狂场,鬼牌,比花色,坐庄,马牌]
        if (this._deskInfo.setting3[2]) {
            bihuase = "比花色  ";
        }
        if (this._deskInfo.setting3[3]) {
            zuozhuang = "坐庄 ";
        }
        if (this._deskInfo.setting3[0]) {
            putong = "疯狂场  ";
        }
        if (this._deskInfo.setting3[1]) {
            wugui = "有鬼  ";
        }
        if (this._deskInfo.setting3[4]) {
            maPai = "买马";
            var huaSe = "方块";
            var dianShu = 1;
            switch (this._deskInfo.setting7[0]) {//setting7 [1~4,1~13] 表示 [花色，点数]
                case 1:
                    huaSe = "方块";break;
                case 2:
                    huaSe = "梅花";break;
                case 3:
                    huaSe = "红心";break;
                case 4:
                    huaSe = "黑桃";break;
            }
            switch (this._deskInfo.setting7[1]) {
                case 1:
                    dianShu = 'A';break;
                case 2:
                    dianShu = 2;break;
                case 3:
                    dianShu = 3;break;
                case 4:
                    dianShu = 4;break;
                case 5:
                    dianShu = 5;break;
                case 6:
                    dianShu = 6;break;
                case 7:
                    dianShu = 7;break;
                case 8:
                    dianShu = 8;break;
                case 9:
                    dianShu = 9;break;
                case 10:
                    dianShu = 10;break;
                case 11:
                    dianShu = 'J';break;
                case 12:
                    dianShu = 'Q';break;
                case 13:
                    dianShu = 'K';break;
            }
            maPai = huaSe + dianShu + maPai;
        }

        if (this._deskInfo.setting2 == 1) {
            renshu = "5人加一色 ";
        } else if (this._deskInfo.setting2 == 2) {
            renshu = "6人加二色 ";
        } else if (this._deskInfo.setting2 == 3) {
            renshu = "7人加三色 ";
        }
        if (this._deskInfo.setting4 == 1) {
            card = "赢者扣 ";
        } else if (this._deskInfo.setting4 == 2) {
            card = "房主扣 ";
        }

        this.labelOverview.string = "模式 : " + bihuase + zuozhuang + putong + wugui + maPai + "\n" + "其他：" + renshu + card;
        //this.labelOverview.string = "模式 : " + "" + deskInfo.maxNumber + "人" +bihuase+zuozhuang+putong+wugui+maPai;
    },

    // 是否是随机房
    _isRandomRoom: function _isRandomRoom() {
        if (this._deskInfo == null) {
            return true;
        }

        return this._deskInfo.isRandomDesk;
    },

    // 是否所有局数都用完了
    _isTotalGameOver: function _isTotalGameOver() {
        if (this._deskInfo == null) {
            return false;
        }

        if (this._deskInfo.isDeskOver) {
            return true;
        }

        return this._deskInfo.mMax <= this._deskInfo.cIndex;
    },

    // 是否已解散房间
    _isDissvledRoom: function _isDissvledRoom() {
        if (this._deskInfo) {
            return this._deskInfo.dissolveStatus;
        }

        return false;
    },

    _startCompareCards: function _startCompareCards(data) {
        this._isComparingCardsNow = true;
        this._gongXiNiShow(false);
        this._players = data.data.players;
        var user = this._findPlayerInfoByUserId(this._userId);
        if (!this.totalGameResult.active) {
            AudioManager.instance.playStartCompare(user.sex);
        }

        this.startCompareCardsNode.getComponent('alert').alert();
        this._playerComponents.forEach(function (playerComp) {
            playerComp.readyToCompareCards();
        });
        this.unscheduleAllCallbacks();
        this.scheduleOnce((function () {
            this.startCompareCardsNode.active = false;
            this._showCompareCardDetails(data);
        }).bind(this), 1.0);
    },

    _showCompareCardDetails: function _showCompareCardDetails(data) {

        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset();
            playerComp.readyToCompareCards();
        });

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');

        cardTypeCombine.reset();

        cardTypeCombine.node.active = false;

        var comparePlayers1 = this._playerComponents.filter(function (player) {

            if (player.node.active) {

                var user = player.compareCardsNode.getComponent('CompareCards')._user;

                if (!user.isContainExtra) return player.node.active;
            }
        });

        var teShuPlayers = this._playerComponents.filter(function (player) {

            if (player.node.active) {

                var user = player.compareCardsNode.getComponent('CompareCards')._user;

                if (user.isContainExtra) return player.node.active;
            }
        });
        var self = this;
        var duration = this._showCompareCardStep(0, comparePlayers1);

        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers1);
        }, duration);

        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers1);
        }, duration * 2);

        if (teShuPlayers.length > 0) {
            this.scheduleOnce(function () {
                self._showCompareCardStep(0, teShuPlayers, true);
            }, duration * 3);
        }

        duration = duration * 3 + 0.5;

        for (var i = 0; i < teShuPlayers.length; i++) {

            var user = teShuPlayers[i].compareCardsNode.getComponent('CompareCards')._user;

            if (user.isContainExtra) duration = duration + 2.5;
        }

        var shootDuration = this.headCardTime;

        var shootDatas = this._shootDatas() || [];

        var shotData = this._shotData() || [];

        var homeRunUserId = this._homeRunUserId();

        var shotDataTimes = 0;

        shotData.forEach(function (data, index) {

            self.scheduleOnce(function () {

                self.playShoot(data.fromUserId, data.toUserId);
            }, duration + index * shootDuration);

            shotDataTimes += self.headCardTime;

            duration += self.headCardTime;
        });

        if (homeRunUserId.length >= 1) {

            shootDatas.forEach(function (data, index) {

                self.scheduleOnce(function () {

                    self.playShoot(data.fromUserId, data.toUserId);
                }, duration + (index + shotDataTimes) * shootDuration);

                duration += self.headCardTime;
            });
        }

        duration = duration + shootDatas.length * shootDuration + shotData.length * shootDuration;

        if (homeRunUserId > 0) {

            self.scheduleOnce(function () {
                self.playHomeRun(homeRunUserId);
            }, duration);

            duration = duration + 1;
        }

        if (homeRunUserId) {
            duration = duration + 1;
        }

        //this.scheduleOnce(function () {this._jinBiAction();}.bind(this), duration);//显示结算金币//显示结果
        this._jinBiAction(duration);
        //this.scheduleOnce(function () {
        //
        //    this._playerComponents.forEach(function (playerComp) {playerComp.showScoreResult();});
        //
        //    self._showCompareCardFinished();
        //
        //}.bind(this), duration);
    },

    _jinBiAction: function _jinBiAction(duration) {
        var comparePlayers1 = this._playerComponents.filter(function (player) {
            return player.node.active;
        });

        var nextTime = 0; //下一个动作开始的时间

        var zTime = 0; //下下一个动作开始的时间

        var start = 0;

        var end = 0;

        var coinsContainerAyy = []; //所有的用户的金币 一个用户一个数组

        var coinsAyy = []; //所有的金币，一个数组

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        comparePlayers1.forEach((function (plays, index) {
            //根据积分创建金币

            var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

            if (cScore < 0) {

                cScore *= -1;

                var node = new cc.Node();

                node.name = "coinsContainer";

                var numScore = cScore > 30 ? 30 : cScore;
                for (var i = 0; i < numScore; i++) {
                    this._createJinBiPrefab(node, node); //根据积分创建金币
                }

                this.playsCoins[index].addChild(node);

                coinsContainerAyy.push(node.children);
            }
        }).bind(this));

        this.playsCoins.forEach(function (no) {
            if (no) no.active = false;
        });

        this.scheduleOnce((function () {
            //显示结果

            this.playsCoins.forEach(function (no) {
                if (no) no.active = true;
            });

            AudioManager.instance.coinIncome();

            coinsContainerAyy.forEach((function (coinsAyys) {
                //把金币移动到容器

                var initTime = 0;

                var interval = 0.002;

                coinsAyys.forEach((function (coins) {
                    //把金币移动到容器

                    var y = Math.round(Math.random()) == 0 ? -1 : 1;

                    y = Math.floor(Math.random() * 38) * y;

                    var x = Math.round(Math.random()) == 0 ? -1 : 1;

                    x = Math.floor(Math.random() * 38) * x;

                    var cardBackWorldSpace1 = this.node.convertToWorldSpaceAR(cc.v2(x, y));

                    var v2 = coins.convertToNodeSpaceAR(cardBackWorldSpace1);

                    this.scheduleOnce(function () {

                        coins.runAction(cc.moveBy(0.2, v2));
                    }, initTime);

                    initTime = initTime + interval;
                }).bind(this));

                nextTime = initTime;

                coinsAyy = coinsAyy.concat(coinsAyys); //把金币集合到一个数组
            }).bind(this));

            var zcScore = 0;

            comparePlayers1.forEach((function (plays) {
                //计算金币

                var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

                cScore = cScore > 30 ? 30 : cScore;

                if (cScore > 0) zcScore += cScore * 1;
            }).bind(this));

            var coinsAyy1 = coinsAyy.splice(zcScore, coinsAyy.length);

            coinsAyy1.forEach(function (node) {
                node.parent.removeChild(node);
            });

            comparePlayers1.forEach((function (plays) {
                //把金币到用户头像附近

                var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

                if (cScore > 0) {

                    var interval = 0.0025;

                    var initTime = nextTime + 1;

                    var numScore = cScore > 30 ? 30 : cScore;

                    //end += numScore;

                    coinsAyy.splice(0, numScore).forEach((function (coinsNode) {
                        //把金币到用户头像附近

                        this.scheduleOnce(function () {

                            //获取节点的世界坐标
                            var cardBackWorldSpace1 = plays.node.convertToWorldSpaceAR(cc.v2(0, 0));
                            //获取相对父节点所在的坐标
                            var detail = coinsNode.convertToNodeSpaceAR(cardBackWorldSpace1);

                            var moveBy = cc.moveBy(0.25, detail);

                            var nextFadeIn = cc.fadeOut(0.13);

                            var moveSeq = cc.sequence(moveBy, nextFadeIn);

                            coinsNode.runAction(moveSeq);
                        }, initTime);

                        initTime = initTime + interval;
                    }).bind(this));

                    //start += cScore;

                    zTime = initTime;
                }
            }).bind(this));

            this.scheduleOnce((function () {
                //显示结果

                //this.playsCoins.forEach(function(no){if(no) no.active = false;});

                this._showCompareCardFinished();

                comparePlayers1.forEach(function (playerComp) {
                    playerComp.showScoreResult();
                });
            }).bind(this), zTime);

            this.scheduleOnce((function () {
                //显示结果

                this.playsCoins.forEach(function (no) {
                    if (no) no.removeAllChildren();
                });
            }).bind(this), zTime + 5);
        }).bind(this), duration);
    },

    _createJinBiPrefab: function _createJinBiPrefab(node, v2Node) {

        var nodes = cc.instantiate(this.coinsPrefab);

        var y = Math.round(Math.random()) == 0 ? -1 : 1;

        y = Math.floor(Math.random() * 38) * y + v2Node.y;

        var x = Math.round(Math.random()) == 0 ? -1 : 1;

        x = Math.floor(Math.random() * 38) * x + v2Node.x;

        nodes.x = x;

        nodes.y = y;

        node.addChild(nodes);
    },

    _showCompareCardStep: function _showCompareCardStep() {
        var startTime = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];
        var comparePlayers = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];
        var isContainExtra = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

        var duration = startTime;
        var interval = this.headCardTime;
        var teshuTime = 0;
        var self = this;

        comparePlayers = comparePlayers.sort(function (player1, player2) {
            return player1.nextCompareScore() - player2.nextCompareScore();
        });

        var co = comparePlayers;
        //console.log(co)
        //console.log('-------------执行了几次')

        co.forEach(function (player) {

            self.scheduleOnce(function () {
                player.showNextCompareCards();
            }, duration + teshuTime);

            duration = duration + interval;
            var user = player.compareCardsNode.getComponent('CompareCards')._user;
            if (user.isContainExtra) {
                if (user.cardInfo[0].type == 10) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._santonghuaAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 11) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._sanshunziAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 12) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._liuduibanAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 18) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._qinglongAniamtion('long');
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 19) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._qinglongAniamtion("ql");
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                }
            }
        });

        if (isContainExtra) {

            for (var i = 0; i < co.length; i++) duration = duration + 2.5;

            this._playerComponents.forEach(function (player) {
                if (player.node.active) {
                    self.scheduleOnce(function () {
                        player.showNextCompareScore(isContainExtra);
                    }, duration - interval);
                }
            });
        } else {
            co.forEach(function (player) {
                self.scheduleOnce(function () {
                    player.showNextCompareScore();
                }, duration - interval);
            });
        }

        return duration + teshuTime;
    },

    _isGameOver: function _isGameOver() {},

    // 比牌完成后会调用的方法
    _showCompareCardFinished: function _showCompareCardFinished() {
        this.timeStart(5, "ready");
        this._showOneGameResult();
        /**/
        this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
        /**/
    },

    //network
    showNetworkMessage: function showNetworkMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? "网络链接断开，重新连接中..." : arguments[0];

        if (this.networkNode && this.networkNode.active) {
            return;
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg, autoDismiss) {
        var alertComp = this.alert.getComponent('alert');
        if (!this.alert.active) {
            alertComp.alert();
        }

        alertComp.setMessage(msg);
        alertComp.unscheduleAllCallbacks();
        if (autoDismiss) {
            alertComp.scheduleOnce(function () {
                alertComp.dismissAction();
            }, 5);
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? '检查网络中...' : arguments[0];

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null && this.checkNode.active) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },

    /////  聊天语音逻辑
    // _registerVoiceNodeEvents: function () {
    //     let self = this;
    //     let chatVoiceNode = this.btnChatVoice.node;
    //     this.endRecordTime = Date.now();
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_START,function(event) {
    //         if (Date.now() - self.endRecordTime >= 1000) {
    //             self.nativeRecordAction();
    //             //self.voiceRecordAnimationNode.active = true;

    //             let action = cc.scaleTo(0.12, 1.2);
    //             self.btnChatVoice.node.runAction(action);

    //             self._isRecording = true;
    //         }
    //     });
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_END,function(event) {
    //         if (self._isRecording) {
    //             self.endRecordTime = Date.now();
    //         }
    //         self._isRecording = false;

    //         self.nativeEndRecordAction();
    //         //self.voiceRecordAnimationNode.active = false;

    //         let action = cc.scaleTo(0.12, 1);
    //         self.btnChatVoice.node.runAction(action);
    //     });
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL,function(event) {
    //         if (self._isRecording) {
    //             self.endRecordTime = Date.now();
    //         }
    //         self._isRecording = false;

    //         self.nativeEndRecordAction();
    //         //self.voiceRecordAnimationNode.active = false;

    //         let action = cc.scaleTo(0.12, 1);
    //         self.btnChatVoice.node.runAction(action);
    //     });
    //     Socket.instance.uploadFinish = function(url) {
    //         let userId = self._userId;
    //         Socket.sendAudioMessage(userId, url);
    //         self.playSpeakAnimation(self._userId);
    //     };
    // },

    _registerVoiceNodeEvents: function _registerVoiceNodeEvents() {
        var self = this;
        var chatVoiceNode = this.btnChatVoice.node;
        this.endRecordTime = Date.now();
        chatVoiceNode.on(cc.Node.EventType.TOUCH_START, function (event) {
            // self.VoiceMsgBgAnimation();
            if (!cc.sys.isNative) {
                var runTime = 0.3;
                var tishi = cc.instantiate(self.autoTishi);
                self.node.addChild(tishi);
                var action = cc.spawn(cc.moveTo(0.3, cc.v2(0, 0)), cc.fadeIn(0.3));
                tishi.runAction(action);
                self.scheduleOnce((function () {
                    var finished = cc.callFunc(function () {
                        tishi.removeFromParent(true);
                    });
                    var action = cc.sequence(cc.spawn(cc.fadeOut(runTime), cc.moveTo(runTime, cc.v2(0, 50))), finished);
                    tishi.runAction(action);
                }).bind(this), 1.5);
                //var url = "www.baidu.com";
                //let userId = self._userId;
                //Socket.sendAudioMessage(userId, url);
            } else {
                    if (Date.now() - self.endRecordTime >= 1000) {
                        self.VoiceMsgBgAnimation();
                        self.nativeRecordAction();
                        var _action = cc.scaleTo(0.12, 1.2);
                        self.btnChatVoice.node.runAction(_action);
                        self._isRecording = true;
                    }
                }
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            self.VoiceMsgBg.active = false;
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            //self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            self.VoiceMsgBg.active = false;
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            //self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        Socket.instance.uploadFinish = function (url) {
            var userId = self._userId;
            Socket.sendAudioMessage(userId, url);
            self.playSpeakAnimation(self._userId);
        };
    },
    VoiceMsgBgAnimation: function VoiceMsgBgAnimation() {
        this.VoiceMsgBg.active = true;
        var whileLayout = this.VoiceMsgBg.getChildByName("whileLayout");
        var childWhile = whileLayout.getChildByName("childWhile");
        if (this.whileLayoutInterval) {
            clearInterval(this.whileLayoutInterval);
        }

        this.whileLayoutInterval = setInterval(function () {
            var node = cc.instantiate(childWhile);
            if (whileLayout.children.length > 5) {
                whileLayout.removeAllChildren();
            }
            whileLayout.addChild(node);
        }, 200);

        var layout = this.VoiceMsgBg.getChildByName("layout");
        var cWhile = layout.getChildByName("while");

        if (this.layoutInterval) {
            clearInterval(this.layoutInterval);
        }

        this.layoutInterval = setInterval(function () {
            var node = cc.instantiate(cWhile);
            if (layout.children.length > 3) {
                layout.removeAllChildren();
            }
            layout.addChild(node);
        }, 300);
    },
    nativeRecordAction: function nativeRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
            AudioManager.instance.pauseMusic();
        }
    },

    nativeEndRecordAction: function nativeEndRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
            AudioManager.instance.resumeMusic();
        }
    },

    playAudioUrl: function playAudioUrl(url) {
        //console.log("---------------------------2553");
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", url);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", url);
        }
    },

    // MARK:  退出游戏逻辑
    _handleUpdateDeskInfoAboutExitRoom: function _handleUpdateDeskInfoAboutExitRoom(deskInfo) {
        if (!deskInfo.isDissolving) {
            return;
        }
        var dataInfos = deskInfo.dissolveAnswerInfo;

        var alertComp = this.alertAnsowerExitNode.getComponent('alert');

        alertComp.alert();

        alertComp.unscheduleAllCallbacks();

        this.contentAnsowerExitNode.children.forEach(function (i) {
            i.active = false;
        });

        this._playerInfos.forEach((function (playerInfo, index) {

            var play = this.contentAnsowerExitNode.children[index];

            var name = play.getChildByName("nickname");

            var back = play.getChildByName("fanzhu");

            var img = play.getChildByName("avatar_bg");

            var str = play.getChildByName("id");

            var dataInfo = dataInfos[index];

            play.active = true;

            name.getComponent(cc.Label).string = playerInfo.nickname;

            if (this._deskInfo.createId == playerInfo.id) {
                //显示房主

                back.active = true;
            } else {

                back.active = false;
            }

            cc.loader.load({ url: playerInfo.avatarUrl, type: "jpg" }, (function (err, data) {

                if (err) return;

                var frame = new cc.SpriteFrame(data);

                img.getComponent(cc.Sprite).spriteFrame = frame;
            }).bind(this));

            if (dataInfo == 1) {

                str.getComponent(cc.Label).string = "同意";
            } else {

                str.getComponent(cc.Label).string = "";
            }
        }).bind(this));

        var dissolveLeftTime = deskInfo.dissolveLeftTime || 60;

        var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');

        countdown.startCountdown(dissolveLeftTime, (function (isTimeout) {

            if (isTimeout) {
                this.clickAgreeOtherPlayerExit();
                return;
            }
        }).bind(this));

        var dissolveUserId = deskInfo.dissolveUserId;

        if (dissolveUserId == this._userId) {

            var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");

            var btnAgree = alert_bg.getChildByName("btnAgree");

            var btnDisagree = alert_bg.getChildByName("btnDisagree");

            btnAgree.active = false;

            btnDisagree.active = false;
            //this.alertRequestExitNode.active = true;
            //this.btnAlertRequestExitCancelButton.node.active = false;
            //this.btnAlertRequestExitConfirmButton.node.active = false;
            //let alert = this.alertRequestExitNode.getComponent('alert');
            //alert.setMessage("您正在申请协商退出，等待其他玩家同意");
            //this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(dissolveLeftTime);
            return;
        }

        //let dissolveAnswerInfos = deskInfo.dissolveAnswerInfo;
        //let currentUserIdIndex = deskInfo.playersIndex.findIndex(function(userId) {
        //    return this._userId == userId;
        //}.bind(this));
        //
        //let answerResult = dissolveAnswerInfos[currentUserIdIndex];
        //
        //if (answerResult == -1) {
        //    // -1 表示未处理  0 表示拒绝  1表示同意
        //    this.alertAnsowerExitNode.active = true;
        //
        //    let countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');
        //
        //    countdown.startCountdown(dissolveLeftTime, function(isTimeout) {
        //        if (isTimeout) {
        //            this.clickAgreeOtherPlayerExit();
        //        }
        //    }.bind(this));
        //
        //}
    },

    // 确定要强制退出游戏
    clickConfirmForceExit: function clickConfirmForceExit() {
        Socket.sendForceExitRoom(this._userId);
        cc.director.loadScene('hall');
    },

    // 确认请求退出游戏
    clickConfirmRequestExit: function clickConfirmRequestExit() {
        this.btnAlertRequestExitCancelButton.node.active = false;
        this.btnAlertRequestExitConfirmButton.node.active = false;
        var alert = this.alertRequestExitNode.getComponent('alert');
        if (this._deskInfo.cIndex > 0) {
            alert.setMessage("您正在申请协商退出，等待其他玩家同意");
            this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(60);
        }
        Socket.sendLeaveDesk(this._userId);
    },

    // 同意他人退出
    clickAgreeOtherPlayerExit: function clickAgreeOtherPlayerExit() {
        //this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        //this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        //this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");
        var btnAgree = alert_bg.getChildByName("btnAgree");
        var btnDisagree = alert_bg.getChildByName("btnDisagree");
        btnAgree.active = false;
        btnDisagree.active = false;
        Socket.sendAnswerDissolve(this._userId, 1);
    },

    // 不同意他人退出
    clickDisagreeOtherPlayerExit: function clickDisagreeOtherPlayerExit() {
        //this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        //this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        //this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");
        var btnAgree = alert_bg.getChildByName("btnAgree");
        var btnDisagree = alert_bg.getChildByName("btnDisagree");
        btnAgree.active = false;
        btnDisagree.active = false;
        Socket.sendAnswerDissolve(this._userId, 0);
    },

    // 隐藏请求退出 Node
    _hideReqestExitNode: function _hideReqestExitNode() {
        if (!this.alertRequestExitNode.active) {
            return;
        }

        this.alertRequestExitNode.active = false;
        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },

    //// 打枪
    playShoot: function playShoot(fromUserId, toUserId) {
        var user = this._findPlayerInfoByUserId(fromUserId);
        if (user) {
            AudioManager.instance.playHumanDaQiang(user.sex);
        }

        var toUserIndex = this._findPlayerIndexByUserId(toUserId);

        this._playerComponents.forEach((function (player) {
            if (this._userId == fromUserId || this._userId == toUserId) player.showNextCompareScore();
            player.playShootAnimation(fromUserId, toUserIndex);
            player.playBulletHoleAnimation(toUserId);
        }).bind(this));
    },

    // 播放全垒打动效
    playHomeRun: function playHomeRun(userId) {
        var user = this._findPlayerInfoByUserId(userId);
        if (user) {
            AudioManager.instance.playHomeRun(user.sex);
        }
        this.node.getComponent("animation")._quanleidaAnimation('long');

        this._playerComponents.forEach((function (player) {

            player.showNextCompareScore();
        }).bind(this));
    },

    playSpeakAnimation: function playSpeakAnimation(userId) {
        this._playerComponents.forEach(function (player) {
            player.playSpeakAnimation(userId);
        });
    },

    _shootDatas: function _shootDatas() {
        var homeRunUserId = this._homeRunUserId(); // 全垒打
        var shootDatas = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId == homeRunUserId;
        });
        return shootDatas;
    },

    _shotData: function _shotData() {
        var homeRunUserId = this._homeRunUserId(); // 打枪
        var shotData = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId != homeRunUserId;
        });
        return shotData;
    },

    _homeRunUserId: function _homeRunUserId() {
        return this._deskInfo.allShotData;
    },

    // MARK: 房间信息部分

    // 获取房间的玩法
    _deskInfoGameWay: function _deskInfoGameWay() {
        var setting = this._deskInfo.setting3;
        if (setting == null) {
            setting = 2;
        }
        var names = ["庄家模式", "无特殊牌", "普通模式"];
        return names[setting];
    },

    _deskInfoNumberOfGame: function _deskInfoNumberOfGame() {
        var setting = this._deskInfo.setting1;
        var infos = ['10局', '20局', '40局', '5局'];
        /*if (setting <= 1) {
         return '条数：' + infos[setting];
         }*/
        if (setting == 2) {
            setting = 0;
        } else if (setting == 3) {
            setting = 1;
        } else if (setting == 4) {
            setting = 2;
        } else if (setting == 5) {
            setting = 3;
        }
        return '局数：' + infos[setting];
    },

    _deskInfoNumberOfPeople: function _deskInfoNumberOfPeople() {
        var setting = this._deskInfo.setting2;
        var infos = ['2人', '3人', '4人', '5人'];
        return infos[setting];
    },

    _deskInfoPayInfo: function _deskInfoPayInfo() {
        var setting = this._deskInfo.setting4;
        if (setting == null) {
            setting = 0;
        }
        if (setting == 0) {
            setting = 1;
        }
        var infos = ['房主霸主庄', '房费AA'];
        return infos[setting];
    },

    _deskInfoJiaYiSeInfo: function _deskInfoJiaYiSeInfo() {
        var setting = this._deskInfo.setting7 == 0 ? 1 : 0;
        var infos = ['无多一色', '多一色'];
        return infos[setting];
    },

    _deskInfoGuiPaiInfo: function _deskInfoGuiPaiInfo() {
        var setting = undefined;
        if (this._deskInfo.setting8 == null) {
            setting = 0;
        } else if (this._deskInfo.setting8 == 0) {
            setting = 1;
        } else if (this._deskInfo.setting8 == 1) {
            setting = 2;
        }
        var infos = ['无王牌', '两张王牌', '四张王牌'];
        return infos[setting];
    },

    // MARK: 剩余时间
    _remainTimeStartUpdate: function _remainTimeStartUpdate() {
        //this.schedule(this._remainTimeUpdate, 1.0, cc.macro.REPEAT_FOREVER);
    },

    _remainTimeUpdate: function _remainTimeUpdate() {
        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        if (this._deskInfo == null) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        var isTaoShu = this._deskInfo.setting1 == 0 || this._deskInfo.setting1 == 1;
        if (isTaoShu) {
            this.labelRemainTime.node.active = false;
            return;
        }

        if (!this._deskInfo.createTime) {
            return;
        }

        this.labelRemainTime.node.active = true;
        var createTime = fecha.parse(this._deskInfo.createTime, 'YYYY-MM-DD HH:mm:ss').getTime();
        var oneHour = 60 * 60;
        var remain = (Date.now() - createTime) / 1000;
        remain = Math.max(oneHour - remain, 0);

        var mins = Math.floor(remain / 60);
        var secs = Math.floor(remain % 60);
        if (mins == 0 && secs == 0) {
            this.labelRemainTime.string = "";
            return;
        }

        var minsString = "" + mins;
        if (minsString.length < 2) {
            minsString = "0" + minsString;
        }

        var secsString = "" + secs;
        if (secsString.length < 2) {
            secsString = "0" + secsString;
        }

        var string = "剩余时间：00:" + minsString + ":" + secsString;
        this.labelRemainTime.string = string;
    },

    // MARK: 处理同 IP 的用户
    _handleTheSameOfIPAdress: function _handleTheSameOfIPAdress(userInfos) {
        if (!userInfos || userInfos.length == 0) {
            return;
        }

        var ipUserInfos = userInfos.reduce(function (ips, userInfo) {
            var users = ips[userInfo.ipAddress] || [];
            users.push(userInfo);

            ips[userInfo.ipAddress] = users;
            return ips;
        }, {});

        var sameIpUsers = null;
        for (var ip in ipUserInfos) {
            var users = ipUserInfos[ip];
            if (users.length > 1) {
                sameIpUsers = users;
                break;
            }
        }

        if (sameIpUsers == null) {
            return;
        }

        this._alertSameIpUserInfos(sameIpUsers);
    },

    _alertSameIpUserInfos: function _alertSameIpUserInfos(users) {
        var message = "";
        var userIds = "";
        users.forEach(function (user, index) {
            message = message + (index > 0 ? ' 和 ' : '') + user.nickname;
            userIds = userIds + user.id;
        });
        message = message + ' 在同一 IP 下！';

        this._didAlertSameIpMessage = this._didAlertSameIpMessage || {};
        if (this._didAlertSameIpMessage[userIds]) {
            return;
        }

        this.showAlertMessage(message, true);
        this._didAlertSameIpMessage[userIds] = true;
    }

});
Play.gongXiNiShow = function (type) {
    this.instances._gongXiNiShow(type);
};
module.exports = Play;

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","AudioManager":"AudioManager","KQCard":"KQCard","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","Player":"Player","UserModelHelper":"UserModelHelper","fecha":"fecha","manager":"manager","socket":"socket"}],"product":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'a9ad2cC2BdEiaFSqV4XCWQV', 'product');
// scripts\product.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        productId: ''
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickAction: function clickAction() {
        this.onClickAction(this.productId);
    },

    onClickAction: function onClickAction(productId) {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"randRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4d298BlaelCHqiV5dTDjhuY', 'randRoom');
// scripts\randRoom.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');

cc.Class({
    'extends': cc.Component,

    properties: {
        matchingLabel: cc.Label,
        timeNode: cc.Node,
        matchingNode: cc.Node,
        waitingPrefab: cc.Prefab,
        alertPrefab: cc.Prefab,

        tishi: cc.Node,

        _userId: null,
        _response: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        cc.isRoomViewShow = true;
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        KQGlobalEvent.on(Socket.Event.ReceiveInterRandom, this._socketReceiveInterRandom, this);
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            return;
        }

        cc.director.loadScene('play');
    },

    _socketReceiveInterRandom: function _socketReceiveInterRandom(response) {
        //服务器发送  {'action':'interRandom','result':false,'data':{'reason':reason}}
        this._response = response;
        this.unschedule(this._timeoutRandomAction);
        // 处理随机场匹配不成功的情况
        if (response.result) {
            return;
        }

        var reason = response.data.reason || "加入随机场失败";
        this.showAlertMessage(reason);

        if (reason == '你已经在匹配队列') {
            this._showMatching();
        } else {
            this._hideMatching();
        }
    },

    _socketDisconnect: function _socketDisconnect() {
        // 连接已断开
        this.matchingNode.active = false;
        this.showNetworkMessage('网络链接断开，重新连接中...');
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    },

    clickStart: function clickStart() {
        Socket.sendEnterRandom(this._userId);
        this._showMatching();

        /*#####begin*/
        //reason是服务器发送回来的
        /*if(this._response.data.reason == "你的钻石不足"){
            this.tishi.active = true;
        }*/
        /*#####end*/

        this.scheduleOnce(this._timeoutRandomAction, 5);
    },
    /*#####点击空白地方，砖石不足提示消失*/
    /*onBtnKong:function () {
        if(this.tishi.active){
            this.tishi.active = false;
        }else{
            //什么也不做
        }
    },*/
    /*取消匹配*/
    clickCancel: function clickCancel() {
        Socket.sendCancelRandom(this._userId);

        this._hideMatching();
    },

    _timeoutRandomAction: function _timeoutRandomAction() {
        this._hideMatching();
        this.showAlertMessage('进入匹配失败');
    },

    _showMatching: function _showMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.alert();
        this.matchingLabel.string = '正在匹配中，请稍后...';
        var num = 0;
        this.schedule(function () {
            num = num + 0.5;
            this.timeNode.rotation = num;
        }, 0.01);
    },

    _hideMatching: function _hideMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.dismissAction();
    },

    showNetworkMessage: function showNetworkMessage(msg) {
        this.unschedule(this._timeoutRandomAction);

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg) {
        if (!msg) {
            cc.error("不能显示为空的信息");
            return;
        }

        if (!this.alertMessageNode) {
            this.alertMessageNode = cc.instantiate(this.alertPrefab);
            this.node.addChild(this.alertMessageNode);
        }

        this.alertMessageNode.getComponent('alert').setMessage(msg);
        this.alertMessageNode.getComponent('alert').alert();
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"recordInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1457gdvd5I5aENjKvCTkCd', 'recordInfo');
// scripts\recordInfo.js

var Socket = require('socket');
var Playback = require('Playback');
var record = require('record');

cc.Class({
    'extends': cc.Component,

    properties: {
        timeLabel: cc.Label, // 时间
        jushuLabel: cc.Label, // 局数
        createUser: cc.Node, // 房主
        roomId: cc.Label, // 房间号
        jifen: cc.Label, // 积分
        id: cc.Label,
        avatarNode: cc.Node, // 头像
        creatorImg: cc.Node, // 创房头像
        nicknameLabels: cc.Label,
        scoreLabels: [cc.Label],
        //numNode:cc.Label,
        _parentId: null,
        //playbackNode:cc.Node,//回放按钮
        //watchNode:cc.Node,//查看按钮
        reordInfo: cc.Node,
        _recordItemInfo: null,
        totalGameResult: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {
        this.totalGameResult = cc.find("Canvas/recordInfo");
    },

    setInfo: function setInfo(recordInfo) {
        this._parentId = recordInfo.id;
        //this.watchNode.active = true;
        //this.playbackNode.active = false;
        if (recordInfo.playersInfo.length == 0) {
            return;
        }

        var playersInfo = JSON.parse(recordInfo.playersInfo);
        recordInfo.scores = JSON.parse(recordInfo.scores);

        var fen = recordInfo.scores[this.fen(recordInfo.userid, playersInfo.playersIndex)];
        //cc.log(fen)
        //cc.log(recordInfo.scores)
        //cc.log(this.fen(recordInfo.userid,playersInfo.playersIndex))
        //cc.log(recordInfo.userid)
        //cc.log(playersInfo.playersIndex)
        //cc.log(recordInfo)
        //cc.log(playersInfo)
        //cc.log('----47')
        this.jifen.string = fen >= 0 ? "+" + fen : fen;

        var headUrl = playersInfo.players[this.creator(recordInfo.createUserId, playersInfo.playersIndex)].avatarUrl; // 头像URL
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        cc.loader.load({ url: headUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;
            }
        });

        this.roomId.string = "房号：" + playersInfo.roomId;
        this.timeLabel.string = "时间：" + playersInfo.time.substr(5, 11);
        this.jushuLabel.string = "局数：" + this.js(playersInfo.setting1 - 2);

        //for (var i = 0;i < playersInfo.players.length;i++) {
        //  this.nicknameLabels[i].string = playersInfo.players[i].nickname;
        //  this.scoreLabels[i].string = playersInfo.players[i].totalScore;
        //}
    },
    js: function js(setting2) {
        var jushu = 5;
        switch (setting2) {
            case 0:
                jushu = 5;break;
            case 1:
                jushu = 10;break;
            case 2:
                jushu = 20;break;
            case 3:
                jushu = 30;break;
        }
        return jushu;
    },

    fen: function fen(userid, players) {
        // 找积分
        for (var i = 0; i < players.length; i++) {
            if (players[i] == userid) {
                return i;
            }
        }
    },
    creator: function creator(_creator, players) {
        //创房者
        for (var i = 0; i < players.length; i++) {
            if (players[i] == _creator) {
                return i;
            }
        }
    },

    clickAction: function clickAction(event, data) {
        var playersInfo = JSON.parse(data.playersInfo);
        var totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');
        totalGameResultComp.setPlayerInfos(playersInfo.players, data);
        totalGameResultComp._clickBtn();
        this.totalGameResult.getComponent('alert').alert();

        //if (this._recordItemInfo) {
        //  this._startPlayback(this._recordItemInfo._info8Array);
        //  return;
        //}
        ////Socket.sendGetItemRecord(Socket.instance.userInfo.id,this._parentId);
        //Socket.sendGetItemRecord(Socket.instance.userInfo.id,--index);
    },

    _startPlayback: function _startPlayback(playBackInfo) {
        //Playback.instance.setPlaybackDatas(playBackInfo);
        //cc.director.loadScene('play');
    },

    detailAction: function detailAction(recordItemInfo, index) {
        //this._recordItemInfo = recordItemInfo;
        ////this.playbackNode.active = true
        ////console.log();
        ////this.numNode.string = "第" + (index + 1) + "局";
        //this.timeLabel.string = recordItemInfo.creatAt.substr(5,11);
        //let objArray = JSON.parse(recordItemInfo.info8);
        //this._recordItemInfo._info8Array = objArray;
        //let playersArray = objArray.map(function(str){
        //  return JSON.parse(str);
        //});
        //
        //var players = playersArray[playersArray.length-1].data.players;
        //for (var i = 0;i < players.length;i++) {
        //    this.nicknameLabels[i].string = players[i].nickname;
        //    this.scoreLabels[i].string = players[i].cScore;
        //}
    },
    records: function records() {}

});

cc._RFpop();
},{"Playback":"Playback","record":"record","socket":"socket"}],"record":[function(require,module,exports){
"use strict";
cc._RFpush(module, '452f4rFUqRLFYlGEJS5kEWs', 'record');
// scripts\record.js

var KQGlobalEvent = require('KQGlobalEvent');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        scrollView: cc.Node,
        recordItem: cc.Prefab
    },

    //subScrollView:cc.Node,
    //subRecordItem:cc.Node,
    //splash:cc.Prefab,
    //reordInfo:cc.Node,
    //
    //jifen:cc.Label,
    //head:cc.Node,
    //id:cc.Label,
    //nickname:cc.Label,
    //creat:cc.Label,        // 创房人
    //createUser:cc.Node,     //  头像
    //
    //timeLabel:cc.Label,   // 时间
    //jushuLabel:cc.Label,  // 局数
    ////createUser:cc.Node,   // 房主
    //roomId:cc.Label,      // 房间号
    //_records:null,
    // use this for initialization
    onLoad: function onLoad() {
        //this.isSubPage = false;
        //this.subScrollView.active = false;
        //
        //this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;
        //console.log( this.subScrollViewContent );
        //this.recordInfo = this.subScrollViewContent.children[0];
        //this.reords = this.subScrollViewContent.children[0].children[3];
        this.scrollViewContent = this.scrollView.getComponent(cc.ScrollView).content;
        this._registerSocketEvent();
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.GetRecord, this._ReceiveRecordInfo, this);
        //KQGlobalEvent.on(Socket.Event.GetItemRecord, this._ReceiveRecordItem, this);
    },

    _ReceiveRecordInfo: function _ReceiveRecordInfo(response) {
        //cc.log(response)
        //cc.log('------78')
        //console.log(response);
        //this._records = response.data;
        //this.isSubPage = false;
        //this.subScrollView.active = false;
        //this.scrollView.active = true;

        this.scrollViewContent.removeAllChildren();
        var index = 0;
        response.data.filter(function (record) {
            return record.playersInfo.length > 0;
        }).forEach((function (recordInfo) {
            index++;
            var item = cc.instantiate(this.recordItem);
            this.scrollViewContent.addChild(item);
            var comp = item.getComponent('recordInfo');
            comp.setInfo(recordInfo);
            var recordBtn = item.children[7].getComponent(cc.Button);
            recordBtn.clickEvents[0].customEventData = recordInfo;
            // var eventHandler = new cc.Component.EventHandler();
            // eventHandler.target = comp.node.children[7];
            // eventHandler.component = "btn";
            // eventHandler.handler = "clickAction";
            //eventHandler.customEventData = "my data";
            //console.log(comp.node.children[7]);
        }).bind(this));
    },

    closeAction: function closeAction() {
        if (this.isSubPage) {
            this.isSubPage = false;
            this.subScrollView.active = false;
            this.scrollView.active = true;
        } else {
            this.node.getComponent('alert').dismissAction();
        }
    }
});
/* clickAction:function( index ){
     //_ReceiveRecordItem()
 },
 _ReceiveRecordItem:function(RecordItemInfo) {
     cc.log(RecordItemInfo)
     cc.log('------78')
     //console.log(RecordItemInfo);return;
     var index = RecordItemInfo.data
     var playersInfo = JSON.parse(this._records[index].playersInfo);
     
     var players = playersInfo.players;                  // 玩家信息
     var playersIndex = playersInfo.playersIndex;        // 玩家的位置
     var createUserId = this._records[index].createUserId;   // 创房ID
     var sendUserId = this._records[index].userid;           // 发送人ID
      this.isSubPage = true;
     this.subScrollView.active = true;
     this.scrollView.active = false;
      this.timeLabel.string = (this._records[index].createAt).substr(5,11);               // 时间
     this.jushuLabel.string = this.js(JSON.parse(this._records[index].setting2));        // 局数
     this.roomId.string = this._records[index].roomId;                                   // 房间号
     this.creat.string = this.findCreator(this._records[index].createUserId,players);    // 房主
      this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;
     this.subScrollViewContent.removeAllChildren();
      for(var i = 0; i < players.length; i++ ){
         var item = cc.instantiate(this.splash);
         this.subScrollViewContent.addChild(item);
         var comp = item.getComponent('recordInfo');
         var creator = 0;       
         var self = 0;       // 表示自己，要对自己的比牌记录背景做处理
         if(createUserId == players[i].id){
             creator =1;
         }
         if( sendUserId == players[i].id){
             self = 1;
         }
         this.records(comp,i,creator,self,index);
     }
  },
 records:function(info,i,creator,self,index){
     if(self){
         info.node.color = new cc.Color(125, 126, 200);
     }
     cc.log(info)
     cc.log('----119')
     var players = JSON.parse(this._records[index].playersInfo).players;
     var scores = this._records[index].scores ;
     info.nicknameLabels.string = players[i].nickname;
     info.id.string = players[i].id;
     info.jifen.string = scores[i];
      var headUrl = players[i].avatarUrl;   //头像连接
     var sprite = info.avatarNode.getComponent(cc.Sprite);
     cc.loader.load(headUrl+".jpg", function (err, tex) {
       if (!err) {
           var frame = new cc.SpriteFrame(tex);
           sprite.spriteFrame=frame;
       }
     });
     info.creatorImg.active = creator;
 },
 findCreator:function(createId,players){ //找房主
     for(var i=0; i<players.length;i++){
         if(createId == players[i].id){
             return players[i].nickname;
         }
     }
 },
 js:function(num){
     var J = 5;
     switch(num){
         case 0: J = 5;break;
         case 1: J = 10;break;
         case 2: J = 20;break;
         case 3: J = 30;break;
     }
     return J;
 },*/

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"rule":[function(require,module,exports){
"use strict";
cc._RFpush(module, '92f6eNs7RdDRJIRLCZnyulJ', 'rule');
// scripts\rule.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    }
});

cc._RFpop();
},{}],"scale":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c1c33tgIe9JvLb/mE+2mRnK', 'scale');
// scripts\scale.js

cc.Class({
    "extends": cc.Component,

    properties: {
        content: cc.Node
    },

    onLoad: function onLoad() {
        var visibleSize = cc.director.getVisibleSize();
        var contentSize = {};
        contentSize.width = this.node.width;
        contentSize.height = this.node.height;
        var scaleX = visibleSize.width / contentSize.width;
        var scaleY = visibleSize.height / contentSize.height;
        var scale = Math.min(scaleX, scaleY).toFixed(2);
        this.node.scaleX = scale;
        this.node.scaleY = scale;
    }
});

cc._RFpop();
},{}],"selectMoShi":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0030eDrh7xEm6AeR3FCg5WU', 'selectMoShi');
// scripts\selectMoShi.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        selectedIndex: 0,
        _select: [],
        _selected: 0,
        beilv: cc.Node, // 倍率
        _blShow: 0 },

    // 倍率的显示状态
    onLoad: function onLoad() {
        this.beilv.active = this._blShow;
        this._select = [1, 1, 1, 0, 0];
        if (cc.set) {
            // 记录上一句的房间情况
            this._select = cc.set['setting3'];
        }
        var self = this;
        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select[i];
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (this._select[i]) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
            if (i == 3) {
                this.beilv.active = this._blShow = this._select[3];
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                var index = this.index;
                for (var i = 0; i < self.nodes.length; i++) {
                    var comp = self.nodes[i].getComponent('select');
                }
                this.setSelected(self._select[index] = !self._select[index]);
                if (this.index == 3) {
                    // 第三个是庄家模式，庄家模式显示倍率
                    self.beilv.active = this._blShow = self._select[3];
                }

                self._select[index] = self._select[index];
                self.selectedIndex = index;
                self.onSelectChange(index);

                var title = this.node.children[0];
                if (self._select[index]) {
                    // 如果当前选项为TRUE 则显示青色
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    // 反之 白色
                    title.color = new cc.Color(255, 255, 255);
                }
            };
        }
    },
    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
        //console.log(this._select);
    }

});

cc._RFpop();
},{}],"select_mapai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8e7e53kJcJK9rwMSxnloqI5', 'select_mapai');
// scripts\select_mapai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        pai: cc.Node,
        mapai: {
            "default": [],
            type: cc.SpriteFrame
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selectMa = this.node.getComponent("select_ma");
        this.selectMa.onLoad();
        this.com = this.pai.getComponent(cc.Sprite);
    },

    clickBtnComfirm: function clickBtnComfirm() {
        this.com.spriteFrame = this.mapai[cc.from.ma];
        //console.log(this.com.spriteFrame);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"select_ma":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4bc0b2bZGRGXoAfdO3Y6Squ', 'select_ma');
// scripts\select_ma.js

cc.Class({
    "extends": cc.Component,

    properties: {
        rightIcon: [cc.Node],
        mapaiRight: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.from == null) {
            cc.from = {};
        }
        //如果不带马，则马牌为空
        if (this.mapaiRight.active == false) {
            cc.from.isUseMa = false;
            cc.from.ma = null;
        } else {
            cc.from.isUseMa = true;
            //否则马牌默认为第0个，即黑桃5
            cc.from.ma = 0;
        }
        for (var i = 0; i < this.rightIcon.length; i++) {
            if (i == 0) {
                this.rightIcon[i].active = true;
                cc.from.ma = 0;
                this.select = this.rightIcon[i];
            } else {
                this.rightIcon[i].active = false;
            }
        }
    },
    onMaPaiClick: function onMaPaiClick(e) {
        var targetName = e.target.name;
        //cc.log(targetName)
        if (targetName != this.select.parent.name) {
            if (targetName == "select_kuang1") {
                this.select = this.rightIcon[2];
                cc.from.ma = 2;
            } else if (targetName == "select_kuang2") {
                this.select = this.rightIcon[1];
                cc.from.ma = 1;
            } else if (targetName == "select_kuang3") {
                this.select = this.rightIcon[0];
                cc.from.ma = 0;
            }
            for (var i = 0; i < this.rightIcon.length; i++) {
                this.rightIcon[i].active = false;
            }
            this.select.active = true;
        }
        //console.log(cc.from.ma);
    }

});

cc._RFpop();
},{}],"selectbeilv":[function(require,module,exports){
"use strict";
cc._RFpush(module, '253cf+Bll9FV5ngl0DW3PxZ', 'selectbeilv');
// scripts\selectbeilv.js

var KQGlobalEvent = require('KQGlobalEvent');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        _userid: 0
    },

    // use this for initialization
    onLoad: function onLoad() {},
    clickBeiLv: function clickBeiLv(event, num) {
        this.node.active = false;
        Socket.sendBeiLv(num, this._userid);
    }

});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"select":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e913aIwAtVEo5jMrf40D5rw', 'select');
// scripts\select.js

cc.Class({
    "extends": cc.Component,

    properties: {
        bgNode: cc.Node, //选择框
        selectedNode: cc.Node, //对号
        pai: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        //console.log(this.node);
        this.selected = true;
        //console.log(cc.set);
    },

    clickAction: function clickAction() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
    },

    setSelected: function setSelected(selected) {
        this.selected = selected;
        this.selectedNode.active = this.selected;
    },
    /*#####*/
    clickSelectKuang: function clickSelectKuang() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        cc.from.isUseMa = this.selected;
        var mapaiCom = this.pai.getComponent(cc.Button);
        if (this.selectedNode.active === false) {
            mapaiCom.interactable = false;
        } else {
            mapaiCom.interactable = true;
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"singleSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '194a8h4vXFO+bXX92yzqbfq', 'singleSelect');
// scripts\singleSelect.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        selectedIndex: 0
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        var rs = 0;
        var js = 0;
        var sf = 0;
        var bl = 0;
        if (cc.set) {
            js = cc.set.setting1;
            rs = cc.set.setting2;
            sf = cc.set.setting4;
            bl = cc.set.setting5;
        }
        for (var i = 0; i < this.nodes.length; i++) {
            var isSelected = this.selectedIndex == i;
            this.nodes[i].getComponent('select').setSelected(isSelected);
            var index = 0;
            var selectIndex = this.selectedIndex;
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (selectIndex == i) {
                this.nodes[selectIndex].getChildByName("title").color = new cc.Color(13, 210, 222);
            }
        }
        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;

            tComp.clickAction = function () {
                for (var i = 0; i < self.nodes.length; i++) {
                    var comp = self.nodes[i].getComponent('select');
                    comp.setSelected(false);
                }
                var Peers = this.node.parent.children; // 同辈节点
                var index = 0;
                for (var a = 0; a < Peers.length; a++) {
                    if (Peers[a].children.length > 0) {
                        // 如果同辈有子节点 处理子节点文字的颜色
                        var title = Peers[a].getChildByName("title");
                        title.color = new cc.Color(255, 255, 255);
                    }
                }
                this.node.getChildByName('title').color = new cc.Color(13, 210, 222);
                //this.node.children[index].color = new cc.Color(13,210,222);
                this.setSelected(true);
                self.selectedIndex = this.index;
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "renshu" && cc.set) {
            console.log(rs);
            this.remember_set(rs);
        }
        if (this.node._name == "jushu" && cc.set) {
            this.remember_set(js);
        }
        if (this.node._name == "cards" && cc.set) {
            this.remember_set(sf);
        }
        if (this.node._name == "beiLv" && cc.set) {
            this.remember_set(bl);
        }
    },
    remember_set: function remember_set(num) {
        this.selectedIndex = num;
        for (var i = 0; i < this.nodes.length; i++) {
            var isSelected = num == i;
            this.nodes[i].getComponent('select').setSelected(isSelected);
            var index = 0;
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (num == i) {
                // if( this.nodes[num].children[0].name == "title" ){
                //     index = 0;
                // }else if(this.nodes[num].children[1].name == "title"){
                //     index =1;
                // }
                this.nodes[num].getChildByName('title').color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {}

});

cc._RFpop();
},{}],"slider":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1c921w7bEFKUIdNwItOX3oG', 'slider');
// scripts\slider.js

cc.Class({
    "extends": cc.Component,

    properties: {
        indicatorNode: cc.Node,
        backgroundNode: cc.Node,
        selectedNode: cc.Node,

        value: 0
    },

    // use this for initialization
    onLoad: function onLoad() {
        var self = this;
        this.indicatorNode.on(cc.Node.EventType.TOUCH_START, function (event) {});
        this.indicatorNode.on(cc.Node.EventType.TOUCH_MOVE, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });

        //this.maxWidth = this.node.width - 40;
        this.maxWidth = this.node.width - 28;
        this.setValue(this.value);
    },

    updateSlider: function updateSlider(pt) {
        var x = pt.x;
        if (x < 0) {
            x = 0;
        }

        if (x > this.maxWidth) {
            x = this.maxWidth;
        }
        this.setValue(x / this.maxWidth);
        this.onValueChange(this.value);
    },

    /*0 - 1*/
    setValue: function setValue(value) {
        this.value = value;
        if (this.value < 0) {
            this.value = 0;
        }
        if (this.value > 1) {
            this.value = 1;
        }
        //this.maxWidth = this.node.width - 38;
        this.maxWidth = this.node.width - 28;
        this.indicatorNode.x = this.value * this.maxWidth + 10;
        this.selectedNode.width = this.value * this.maxWidth + this.indicatorNode.width / 2;
    },

    onValueChange: function onValueChange(value) {
        cc.log(value);
    }
});

cc._RFpop();
},{}],"socket":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf75cLLNo1ETbJFrx/23i/H', 'socket');
// scripts\socket.js

var manager = require('manager');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var SocketConstant = {
  MaxReconnectCheckInterval: 5 };

/**
 * 这是对 WebSocket 的一个封装
 * 
 * 里面包含自动重连的功能
 */
// 重连检测时间片
var Socket = cc.Class({
  'extends': cc.Component,

  properties: {
    _lastReceiveMsgTime: 0, // 最后一次收到消息时间(毫秒)
    _timeout: 8 },

  // 超时时长 （秒）
  statics: {
    instance: null,
    // url:"ws://182.18.26.13:5041",
    //url:"ws://123.56.20.164:5041",//修改前
    url: "ws://127.0.0.1:5041"
  },

  // url:"ws://192.168.0.108:5041",
  //url:"ws://183.3.205.149:5002",
  // use this for initialization
  onLoad: function onLoad() {
    Socket.instance = this;

    this.name = "socket";

    cc.game.addPersistRootNode(this.node);
    if (cc.game.isPersistRootNode(this.node)) {
      cc.log('添加全局节点 Socket 成功');
    }

    this._registerAppActiveChange();

    this.isCreating = false;
    this.createIndex = 0;
    this.createSocket();

    this.schedule(function () {
      this.checkConnection();
    }, 5);

    this.recvTime = Date.now(); //接收到最新一条服务器的信息的时间
    //cc.log(manager.version);

    this._checkSocket();
  },

  checkConnection: function checkConnection() {
    //客户端定时给服务端发送点数据，防止连接由于长时间没有通讯而被某些节点的防火墙关闭导致连接断开的情况。
    this.sendMessage('checkAction', '');
  },

  createSocket: function createSocket() {
    var self = this;
    this.createIndex++; //创建次数加1
    if (this.createIndex > 5) {
      this.networkError();
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.isCreating = true;

    KQGlobalEvent.emit(Socket.Event.SocketConnecting);
    this.ws = new WebSocket(Socket.url);
    if (this.ws === null) {
      this.networkError();
      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { 'data': 'Socket 创建失败' });
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.socketError = false;

    // socket 连接成功
    this.ws.onopen = function (event) {
      //cc.log("WebSocket 连接成功：", event);

      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketConnectSuccessed, event);

      self.isCreating = false;
      self.socketError = false;
      self.createIndex = 0;
      self.connectionSuccess();
      self.sendReconnectInfo();
    };

    // socket 接收到消息
    this.ws.onmessage = function (event) {
      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketReceiveMessage, event.data);

      self.isCreating = false;
      self.socketError = false;
      self.receviceMessage(event.data);
      self._dispatchResponse(event.data);
      self.recvTime = Date.now(); //接收最新一条信息的时间

      /**/
    };

    /**
     * socket 发生错误
     * 
     * socket 本身有 `onerror` 回调，但事实证明，其不靠谱，
     * 有很大的机率有误报的行为，常常在没有错误时，会给错误回调。
     * 且不能定制超时时长
     * 
     * @param {String} message 
     */
    this.ws._kq_onerror = function (message) {
      cc.error('WebSocket 连接错误：' + message);

      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { data: message });
      self.ws.close();
      if (!self.ws) {
        return;
      }

      // 虽然调用了 websocket 的 close 方法，但是
      // 它并会立即调用 onclose 回调，而是在未来的某
      // 一时间再回调 onclose；但这里明显可以直接回调了。
      var ws = self.ws;

      self.ws.onclose();
      ws.onclose = function () {};
    };

    // socke 已关闭
    this.ws.onclose = function (event) {
      //cc.log('WebSocket 已关闭 close time=' + Date.now() + " event: " + event);

      self.isCreating = false;
      self.socketError = true;
      self.ws = null;
      self.connectionDisconnect();
      KQGlobalEvent.emit(Socket.Event.SocketDisconnect, event);
      //cc.log('socket close'+JSON.stringify(event));
    };
  },

  reconnect: function reconnect() {
    var self = this;
    this.scheduleOnce(function () {
      if (!self.isCreating && self.socketError) {
        self.createSocket();
      }
    }, 2);
  },

  sendReconnectInfo: function sendReconnectInfo() {
    var self = this;
    this.scheduleOnce(function () {
      if (this.userInfo != null) {
        var userId = self.userInfo.user_id || self.userInfo.id;
        self.sendMessage('reconnect', {
          'userId': userId
        });
      }
    }, 1);
  },

  receviceMessage: function receviceMessage(response) {},

  connectionDisconnect: function connectionDisconnect() {},

  connectionSuccess: function connectionSuccess() {},

  networkError: function networkError() {},

  checkNetworkStart: function checkNetworkStart() {},

  checkNetworkEnd: function checkNetworkEnd() {},

  _dispatchResponse: function _dispatchResponse(responseString) {
    //cc.log("WebSocket 接收到服务器消息：", responseString);
    var response = JSON.parse(responseString);
    var action = response["action"];
    if (action) {
      KQGlobalEvent.emit(action, response);
    }
  },

  // MARK: 前后台操作
  _registerAppActiveChange: function _registerAppActiveChange() {
    //cc.log("WebSocket 注册应用进入前、后台事件");
    cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
    cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
  },

  /**
   * 进入后台
   */
  _appEnterBackground: function _appEnterBackground() {
    var now = cc.sys.now();
    if (now - this._lastAppEnterBackgroundTime < 100) {
      return;
    }
    this._lastAppEnterBackgroundTime = now;

    //cc.log("WebSocket 检测到应用进入后台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppPause(id);
    this._cancelCheckSocket();
  },

  /**
   * 进入前台 
   */
  _appBecomActive: function _appBecomActive() {
    var now = cc.sys.now();
    if (now - this._lastAppBecomActiveTime < 100) {
      return;
    }
    this._lastAppBecomActiveTime = now;

    //cc.log("WebSocket 检测到应用进入前台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppActive(id);
    this._checkSocket();

    this.scheduleOnce((function () {
      this._checkSocketExecute();
    }).bind(this), 1.5);
  },

  //进入后台操作
  enterbackgroudAction: function enterbackgroudAction() {
    this._appEnterBackground();
  },

  //进入前台操作
  resumeAction: function resumeAction() {
    //检查网络
    this._checkNetwork();
    this._appBecomActive();
  },

  sendMessage: function sendMessage(action, data) {
    data = this._strongVerifyData(data);

    if (this.socketError) {
      cc.error("socket 连接错误：" + this.socketError);
      this.reconnect();
      return;
    }
    //cc.log('WebSocket 发送消息：' + action, data);
    if (cc.sys.isObjectValid(this.ws)) {
      if (this.ws.readyState === WebSocket.OPEN) {
        this.ws.send(this._convertParameterToString(action, data));
      }
    } else {
      this.connectionDisconnect();
    }
  },

  _strongVerifyData: function _strongVerifyData() {
    var data = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

    if (typeof data == 'string') {
      data = { "string": data };
    }

    if (data == null) {
      data = {};
    }

    if (!data["userId"]) {
      if (this.userInfo && typeof this.userInfo == 'object' && this.userInfo.id) {
        data["userId"] = this.userInfo.id;
      }
    }
    return data;
  },

  _convertParameterToString: function _convertParameterToString(action) {
    var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var obj = {};
    obj.action = action;
    obj.data = data;

    return JSON.stringify(obj);
  },

  // 检查网络
  _checkNetwork: function _checkNetwork() {
    if (this.checkNetworkNow) {
      this.checkNetworkNow();
    }

    this.shouldCheck = true;
    if (!this.socketError) {
      this.recvTime = 0;
      this.sendMessage('checkAction', '');
      this.scheduleOnce(function () {
        this.checkNetworkEnd();
        this.shouldCheck = false;
        if (this.recvTime === 0) {
          this.connectionDisconnect();
        }
      }, 2.5);
    } else {
      this.connectionDisconnect();
    }
  },

  // MARK: socket 掉线尽早确认
  _checkSocket: function _checkSocket() {
    this.schedule(this._checkSocketExecute, SocketConstant.MaxReconnectCheckInterval, cc.macro.REPEAT_FOREVER);
  },

  _cancelCheckSocket: function _cancelCheckSocket() {
    this.unschedule(this._checkSocketExecute);
  },

  _checkSocketExecute: function _checkSocketExecute() {
    if (this._isSocketTimeout() && this.ws) {
      this.ws._kq_onerror('连接超时');
      return;
    }
  },

  // socket 是否已超时
  _isSocketTimeout: function _isSocketTimeout() {
    return this._lastReceiveMessageInterval() >= this._timeout;
  },

  // 上一次收到消息到现在的时间间隔
  _lastReceiveMessageInterval: function _lastReceiveMessageInterval() {
    var now = cc.sys.now();
    var interval = (now - this._lastReceiveMsgTime) / 1000;
    //cc.log(`WebSocket 现在距上一条收到消息的时间间隔是：${interval} 秒`);
    return interval;
  }

});

// MARK: Socket 事件定义
Socket.Event = {
  SocketConnecting: "SocketConnecting", // Socket 正在连接
  SocketConnectSuccessed: "SocketConnectSuccessed", // 连接成功
  SocketDisconnect: "SocketDisconnect", // Socket 断开连接
  SocketConnectError: "SocketConnectError", // Socket 连接错误
  SocketReceiveMessage: "SocketReceiveMessage", // Socket 接收到消息

  LoginJoin: "loginJoin", // 客户端发送 从登陆界面获取房间号进入游戏
  RecordId: "recordId", // 客户端发送 
  OnceAgain: "onceAgain", // 客户端发送 
  BeiLv: "beiLv", // 客户端发送 
  InviteCode: "inviteCode", // 客户端发送   邀请码
  JoinDesk: "joinDesk", // 客户端发送
  CreateDesk: "createDesk", // 客户端发送
  LeaveDesk: "leaveDesk", // 离开桌子
  DissolveDesk: "dissolveDesk", // 解散桌子
  AnswerDissolve: "answerDissolve", // 回答请求退出命令
  GetDeskInfo: "getDeskInfo", // 客户端发送
  SendImage: "sendImage", // 客户端发送
  SendText: "sendText", // 客户端发送
  SendEmoji: "sendEmoji", // 客户端发送
  ChangeInfo: "changeInfo", // 客户端发送
  SendAudioMessage: "sendAudioMessage", // 客户端发送  发送语音消息
  GetRecord: "getRecord", // 获取战绩信息
  GetItemRecord: "getItemRecord", // 获取战绩信息
  PlayCard: "playCard", // 客户端发送，用户打出牌
  TimeoutDissolve: "timeoutDissolve", // 请求退出超时时，需要发出的消息
  Feedback: "feedback", // 客户端发送  反馈信息
  SharePng: "sharePng", // 客户端发送  分享领取砖石
  EnterRandom: "interRandom", // 客户端发送  进入随机场
  CancelRandom: "cancelRandom", // 客户端发送  取消进入随机场
  ForceExitRandom: "dissolve", // 客户端发送 强制退出随机场
  Ready: "ready", // 客户端发送 准备
  StartGame: "startGame", // 客户端发送 开始游戏
  GetHallInfo: "getHallInfo", // 客户端发送 获取大厅信息
  GetUserInfo: "getUserInfo", // 客户端发送 获取用户信息
  CheckAction: "checkAction", // 客户端发送，用来检测与服务器的连通性
  Pause: "pause", // 客户端进入后台时要发送的消息
  Active: "active", // 客户端回到前台时要发送的消息
  Qingli: "qingli", // 客户端回到前台时要发送的消息

  ReceiveRequestDissolve: "requestDissolve", // 请求解散桌子 服务器发送
  ReceiveRequestDissolveResult: "requestDissolveResult", // 请求解散桌子结果
  ReceiveChatText: "sendText", // 服务器发送
  ReceiveChatEmoji: "sendEmoji", // 服务器发送
  ReceiveDeskInfo: "deskInfo", // 服务器发送
  ReceiveGameOver: "gameOver", // 服务器发送
  ReceiveFaPai: "fapai", // 服务器发送
  ReceiveSharePng: "sharePngs", // 服务器发送
  ReceiveOnlineStatus: "sendOnlineStatus", // 服务器发送
  ReceiveOnChangeInfo: "changeInfo", // 服务器发送
  ReceiveAudioMessage: "sendAudioMessage", // 服务器发送，接收到用户发送了语音消息
  ReceivePlayCard: "playCard", // 服务器发送，有用户已经准备好牌
  ReceiveCreateDesk: "createDesk", // 服务器发送，创建房间的回调
  ReceiveReady: "ready", // 服务器发送，有用户点击了准备
  ReceiveHallInfo: "getHallInfo", // 服务器发送
  ReceiveGetUserInfo: "getUserInfo", // 服务器发送 获取用户信息
  ReceiveCheckAction: "checkAction", // 服务器发送  用来确认 Socket 还在连着
  ReceiveForceExit: "forceExit", // 服务器发送  用来使客户端强退
  ReceiveDissolveDesk: "dissolveDesk", // 服务器发送   当房主退出时，解散桌子
  ReceiveInterRandom: "interRandom", // 服务器发送   进入随机场的反馈
  ReceivePause: "pause", // 服务器发送   当有用户设备进入后台时，会收到这条消息
  ReceiveInviteCode: 'inviteCode', // 服务器发送，收到邀请码的消息
  ReceiveLeaveDesk: 'leaveDesk', // 服务器发送，收到需要离开桌子的消息
  ReceiveSelectBeiLv: 'selectBeiLv', // 服务器发送，收到选择倍率的消息
  ReceiveBeiLv: 'beiLv', // 服务器发送，收到倍率的消息
  ReceiveQingLi: 'qingli', // 服务器发送，收到请离
  ReceiveRecordId: 'recordId', // 服务器发送，收到战绩信息
  ReceiveLoginJoin: 'loginJoin', // 服务器发送，收到从页面进入房间信息
  ReceiveOnceAgain: 'onceAgain', // 服务器发送，收到再来一局信息
  ReceiveNoUionid: 'noUionid' };

// MARK: Socket 提供的可发给服务器消息的方法

// 服务器发送，收到没有unionID信号
Socket.sendCheckAction = function () {
  this.instance.sendMessage(this.Event.CheckAction, null);
};
/**/
Socket.sendDidReceiveGameOverAction = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(Socket.Event.DidReceiveGameOverAction, param);
};
/**/

/**
 * 当 APP 进入后台时要发送的消息
 */
Socket.sendAppPause = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Pause, param);
};

/**
 * 当 APP 进入前台时发送的消息
 */
Socket.sendAppActive = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Active, param);
};

// 开房
Socket.sendCreateDesk = function (createDescInfo, userId) {
  cc.assert(createDescInfo);
  cc.assert(userId);

  createDescInfo["userId"] = userId;
  this.instance.sendMessage(this.Event.CreateDesk, createDescInfo);
};

Socket.sendQingli = function (leaveId, userId) {
  var param = {
    "leaveId": leaveId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.Qingli, param);
};
// 从登陆页面加入房间
Socket.sendLoginJoin = function (roomId, userId) {
  var param = {
    "roomId": roomId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.LoginJoin, param);
};
// 再来一局
Socket.sendOnceAgain = function (again, userId) {
  var param = {
    "userId": userId,
    "again": again
  };
  this.instance.sendMessage(this.Event.OnceAgain, param);
};
// 加入房间
Socket.sendJoinDesk = function (roomId, userId) {
  cc.assert(roomId);
  cc.assert(userId);

  var param = {
    "roomId": roomId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.JoinDesk, param);
};
// 向服务端发送我选择的倍率
Socket.sendBeiLv = function (beilv, userId) {
  var param = {
    "beilv": beilv,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.BeiLv, param);
};
// 发送邀请码
Socket.sendInviteCode = function (inviteCode, userId) {
  var param = {
    "inviteCode": inviteCode,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.InviteCode, param);
};

// 获取房间信息
Socket.sendGetDesckInfo = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetDeskInfo, param);
};

Socket.sendText = function (userId, text) {
  //cc.assert(userId);
  //cc.assert(text);
  var param = {
    "msg": text,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendText, param);
};
Socket.sendEmoji = function (userId, emoji) {
  var param = {
    "emoji": emoji,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendEmoji, param);
};
Socket.sendChangeInfo = function (userId, Info) {
  var param = {
    "changeInfo": Info,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.ChangeInfo, param);
};
Socket.sendAudioMessage = function (userId) {
  var url = arguments.length <= 1 || arguments[1] === undefined ? "" : arguments[1];

  cc.assert(userId);
  cc.assert(url.length > 0);

  if (url.length == 0) {
    return;
  }

  var param = {
    "url": url,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendAudioMessage, param);
};

Socket.sendImage = function (userId, image) {
  cc.assert(userId);
  cc.assert(image);
  var param = {
    "msg": image,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendImage, param);
};

Socket.sendGetRecrod = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.GetRecord, param);
};

Socket.sendGetRecrodFromId = function (recordId) {
  var param = {
    "recordId": recordId
  };
  this.instance.sendMessage(this.Event.RecordId, param);
};

Socket.sendDissolveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.DissolveDesk, param);
};

Socket.sendGetItemRecord = function (userId, parentId) {
  cc.assert(userId);
  cc.assert(parentId);
  var param = {
    "userId": userId,
    "parentId": parentId
  };

  this.instance.sendMessage(this.Event.GetItemRecord, param);
};

Socket.sendLeaveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.LeaveDesk, param);
},

/**
 * 回答退房请求
 * 
 * @param  {Number} userId 当前用户 id
 * @param  {NUmber} answer=1 回答。1 表示同意； 0 表示拒绝； -1 表示未选择
 */
Socket.sendAnswerDissolve = function (userId) {
  var answer = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];

  cc.assert(userId);
  var param = {
    "userId": userId,
    "answer": answer
  };

  this.instance.sendMessage(this.Event.AnswerDissolve, param);
}, Socket.sendForceExitRoom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.DissolveDesk, param);
},

// 十三张中
// cardInfo 类似于：
// [{
//         'cards':[{'suit':suit,'number':number},{}],//特殊牌不用传
//         'type':0,
//         'value':4,
//         'isContainExtra':true,// 特殊牌是否包含特殊牌
//     },
//     {
//         'cards':[{'suit':suit,'number':number},{}],
//         'type':0,
//         'value':4
//     }]
Socket.sendPlayCard = function (userId, cardInfo) {
  cc.assert(userId);
  var param = {
    "userId": userId,
    "card": cardInfo
  };

  this.instance.sendMessage(this.Event.PlayCard, param);
};

Socket.sendTimeoutDissolve = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.TimeoutDissolve, param);
};

Socket.sendFeedback = function (userId, text) {
  cc.assert(userId);
  cc.assert(text);
  var param = {
    "userId": userId,
    "text": text
  };

  this.instance.sendMessage(this.Event.Feedback, param);
};

Socket.sendSharePng = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SharePng, param);
};
// 开始匹配随机场
Socket.sendEnterRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.EnterRandom, param);
};

// 取消匹配随机场
Socket.sendCancelRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.CancelRandom, param);
};

// 准备
Socket.sendReady = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.Ready, param);
}, Socket.sendStartGame = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  cc.log(this.Event.StartGame);
  cc.log();
  this.instance.sendMessage(this.Event.StartGame, param);
},

// 获取大厅信息
Socket.sendGetHallInfo = function (userId) {
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetHallInfo, param);
},

// 获取用户信息
Socket.sendGetUserInfo = function (userId, openId) {
  var param = {
    "userId": userId,
    "openId": openId
  };

  this.instance.sendMessage(this.Event.GetUserInfo, param);
}, module.exports = Socket;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"test":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3a5ah1deZEh6HfPdghRXyA', 'test');
// scripts\KQCard\test.js

this._changeCardScors = function (cardModel) {

    cardModel.forEach(function (card) {
        card.scores = card.number;
    });

    cardModel = this._convertOneToA(cardModel);

    var is14 = true; //是A K Q J 10 ;

    var is1 = true; //是1 2 3 4 5

    cardModel.forEach(function (card) {
        if (card.scores < 10) is14 = false;
    }); //不是A K Q J 10

    cardModel.forEach(function (card) {
        if ((card.scores > 5 || card.scores == 14) && card.scores != 20) is1 = false;
    }); //不是1 2 3 4 5});

    if (is14) {
        //是A K Q J 10 ;

        cardModel.sort(function (a1, a2) {
            return a2.scores - a1.scores;
        });

        var num = 14,
            scoresAyy = []; //一副牌的分数

        for (var i = 0; i < 5; i++) {

            scoresAyy.push(num);

            num -= 1;
        }

        for (var j = 0; j < scoresAyy.length; j++) {

            for (var i = 0; i < cardModel.length; i++) {

                var cardScores = cardModel[i].scores;

                if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
            }
        }

        cardModel.forEach(function (card) {
            if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
        }); //找出选中的牌
    } else if (is1) {
            //是1 2 3 4 5

            cardModel.sort(function (a1, a2) {
                return a2.scores - a1.scores;
            });

            var num = 5,
                scoresAyy = []; //一副牌的分数

            for (var i = 0; i < 5; i++) {

                scoresAyy.push(num);

                num -= 1;
            }

            for (var j = 0; j < scoresAyy.length; j++) {

                for (var i = 0; i < cardModel.length; i++) {

                    var cardScores = cardModel[i].scores;

                    if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
                }
            }

            cardModel.forEach(function (card) {
                if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
            }); //找出选中的牌
        } else {
                cardModel.sort(function (a1, a2) {
                    return a1.scores - a2.scores;
                });

                var scoresAyy = []; //用来装鬼牌分数

                for (var i = 0; i < 5; i++) {

                    var s = parseInt(cardModel[0].scores) + i; //最小的牌的分数

                    scoresAyy.push(s); //一副牌的分数
                }

                for (var j = 0; j < scoresAyy.length; j++) {

                    for (var i = 0; i < cardModel.length; i++) {

                        var cardScores = cardModel[i].scores;

                        if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
                    }
                }
                cardModel.forEach(function (card) {
                    if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
                }); //改变牌的分数
            }

    cardModel = this._convertOneToA(cardModel);

    cardModel.sort(function (a1, a2) {
        return a1.scores - a2.scores;
    });
    return cardModel;
};

cc._RFpop();
},{}],"time":[function(require,module,exports){
"use strict";
cc._RFpush(module, '458d4VWlwNDT6xQ+pFW8Bby', 'time');
// scripts\time.js

cc.Class({
        "extends": cc.Component,

        properties: {
                leftNode: cc.Node,
                RigthNode: cc.Node,
                _time: null
        },

        // use this for initialization
        onLoad: function onLoad() {},

        setTime: function setTime(time) {

                this.unscheduleAllCallbacks();

                this._time = time;

                this.leftNode.rotation = 0;

                this.RigthNode.rotation = 0;

                this.RigthNode.stopAllActions();

                this.leftNode.stopAllActions();

                this.leftNode.runAction(cc.rotateBy(this._time, -180));

                this.scheduleOnce((function () {

                        this.RigthNode.runAction(cc.rotateBy(this._time, 180));
                }).bind(this), this._time);
        }

});

cc._RFpop();
},{}],"userInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e8d10xRGnJAn42wJsuC6aBi', 'userInfo');
// scripts\userInfo.js

var AudioManager = require('AudioManager');
var Playback = require('Playback');

cc.Class({
  'extends': cc.Component,

  properties: {
    spriteAvatar: cc.Sprite,
    labelNickname: cc.Label,
    labelScore: cc.Label,
    spriteOffline: cc.Sprite,
    voiceNode: cc.Node,
    homeRunNode: cc.Node,
    readyNode: cc.Node,
    beilv: cc.Label,
    shootNodes: [cc.Node],
    bankerNode: cc.Node,
    fangZhuNode: cc.Node,
    qingli: cc.Node,
    id: cc.Label
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.updateScore();
  },

  setqingli: function setqingli() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.qingli.active = visible != false;
  },

  setReadyNodeVisible: function setReadyNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.readyNode.active = visible != false;
  },
  setBeilvLabel: function setBeilvLabel(bl) {
    //this.beilv.active = true;
    this.beilv.string = bl ? bl + "倍" : '';
  },

  setFangZhuNodeVisible: function setFangZhuNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.fangZhuNode.active = visible != false;
  },

  updateScore: function updateScore() {
    var score = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    if (score >= 0) {
      this.labelScore.string = "+" + score;
    } else {
      this.labelScore.string = "" + score;
    }
  },
  updateUserId: function updateUserId(id) {
    this.id.string = id ? "ID:" + id : "";
  },
  updateNickname: function updateNickname() {
    var nickname = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

    this.labelNickname.string = nickname;
  },

  updateAvatar: function updateAvatar(avatar) {
    if (avatar.endsWith("png") || avatar.endsWith("jpg") || avatar.endsWith("gif")) {} else {
      //avatar = avatar + ".png";
    }

    cc.loader.load({ url: avatar, type: "jpg" }, (function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      this.spriteAvatar.spriteFrame = frame;
    }).bind(this));
  },

  setOfflineVisible: function setOfflineVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    if (Playback.instance.isPlaybacking()) {
      // 如果是处理回放状态，就不用再处理离线消息了
      return;
    }

    this.spriteOffline.node.active = visible;
  },

  setIsBanker: function setIsBanker() {
    var isBanker = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.bankerNode.active = isBanker;
  },

  playShootAnimation: function playShootAnimation() {
    var toIndex = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    //let shootNode = this.shootNodes[toIndex];
    //shootNode.active = true;
    //let anim = shootNode.getComponent(cc.Animation);
    //anim.play('shoot').on('finished', function () {
    //  shootNode.active = false;
    //}, this);

    AudioManager.instance.playDaQiang();
  },

  playBulletHoleAnimation: function playBulletHoleAnimation() {
    var bulletHoleNode = this.node.getChildByName('bulletHole');
    bulletHoleNode.active = true;
    var anim = bulletHoleNode.getComponent(cc.Animation);
    anim.play('bulletHole').on('finished', function () {
      bulletHoleNode.active = false;
    }, this);
  },

  playSpeakAnimation: function playSpeakAnimation() {
    this.voiceNode.active = true;
    this.scheduleOnce((function () {
      this.voiceNode.active = false;
    }).bind(this), 4);
  },

  // 播放全垒打动画
  playHomeRunAimation: function playHomeRunAimation() {
    //let alert = this.homeRunNode.getComponent('alert');
    //alert.alert();
    //this.scheduleOnce(function () {
    //  this.homeRunNode.active = false;
    //}.bind(this), 2);
  }
});

cc._RFpop();
},{"AudioManager":"AudioManager","Playback":"Playback"}],"zhuanNumCtrl":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1b0dfWuicJLYJDmjjT1lmQc', 'zhuanNumCtrl');
// scripts\zhuanNumCtrl.js

cc.Class({
    "extends": cc.Component,

    properties: {
        zhuanNumLabel: cc.Label,
        jushu: cc.Node,
        AA: cc.Node,
        _selectedPeopleIndex: null,
        _selectedJushuIndex: null,
        _selectedAAIndex: null
    },

    onLoad: function onLoad() {
        this._ctrl();
    },

    clickPeopleAction: function clickPeopleAction() {
        this._ctrl();
    },

    clickAAAction: function clickAAAction() {
        this._ctrl();
    },

    clickJushuAction: function clickJushuAction() {
        this._ctrl();
    },

    _ctrl: function _ctrl() {
        this._selectedPeopleIndex = this.node.getComponent("singleSelect").selectedIndex;
        this._selectedJushuIndex = this.jushu.getComponent("singleSelect").selectedIndex;
        this._selectedAAIndex = this.AA.getComponent("checkSelect").selectedIndex;
        //人数选2人时且没选上AA制收费
        var renShu = 2;
        if (this._selectedPeopleIndex == 0) {
            renShu = 2;
        } else if (this._selectedPeopleIndex == 1) {
            renShu = 3;
        } else if (this._selectedPeopleIndex == 2) {
            renShu = 4;
        } else if (this._selectedPeopleIndex == 3) {
            renShu = 5;
        }
        var zhuangShi = 20;
        if (this._selectedJushuIndex == 0) {
            zhuangShi = 20;
        } else if (this._selectedJushuIndex == 1) {
            zhuangShi = 40;
        } else if (this._selectedJushuIndex == 2) {
            zhuangShi = 80;
        } else if (this._selectedJushuIndex == 3) {
            zhuangShi = 10;
        }
        //AA
        if (this._selectedAAIndex != null) {
            zhuangShi = Math.ceil(zhuangShi / renShu);
        }
        this.zhuanNumLabel.string = zhuangShi;
        //if(this._selectedPeopleIndex == 0){
        //    if(this._selectedAAIndex == null){
        //局数选10局时
        //if(this._selectedJushuIndex == 0){
        //    this.zhuanNumLabel.string = "10";
        //}
        ////局数选20局时
        //if(this._selectedJushuIndex == 1){
        //    this.zhuanNumLabel.string = "30";
        //}
        ////局数选30局时
        //if(this._selectedJushuIndex == 2){
        //    this.zhuanNumLabel.string = "80";
        //}
        //}
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "8";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "15";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "23";
        //        }
        //    }
        //
        //}
        //人数选3人
        //else if(this._selectedPeopleIndex == 1){
        //    //没选上AA制收费
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "42";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "60";
        //        }
        //    }
        //    //选了AA收费
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "20";
        //        }
        //    }
        //
        //}
        ////人数选4人且没选上AA制收费
        //else{
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "28";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "56";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "84";
        //        }
        //    }
        //    //AA制收费选上了
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //    }
        //}
    }
});

cc._RFpop();
},{}]},{},["AudioManager","CardPrefab","CardTypeCombine","CardTypeSprite","ChatMessage","MsgControl","KQGlobalEvent","ArrayExtension","NumberExtension","SpriteHelper","StringExtension","fecha","Invit","GetCardPointsSameCount","KQCard","KQCardColorsHelper","KQCardFindTypeExtension","KQCardPointsHelper","KQCardResHelper","KQCardScoreExtension","KQCardScoretsHelper","KQCardSelectExtension","test","UserModelHelper","NetworkError","ChatTextRecord","CompareCards","Countdown","GameResult","Player","ResultItem","TotalGameResult","TotalGameResultItem","UserSampleInfo","maPai","Playback","Setting","KQGlabolSocketEventHander","KQNativeInvoke","agreement","alert","animation","cardNum","cards","cardsBack","cellText","changInfo","change_mapai","checkSelect","choujiang","create_btn_anima","game","hall","hall_btn_anima","help","inviteCode","joinRoom","launch","login","manager","overTime","play","product","randRoom","record","recordInfo","rule","scale","select","selectMoShi","select_ma","select_mapai","selectbeilv","singleSelect","slider","socket","time","userInfo","zhuanNumCtrl"])

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL0NvY29zQ3JlYXRvci9yZXNvdXJjZXMvYXBwLmFzYXIvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvQXJyYXlFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9BdWRpby9BdWRpb01hbmFnZXIuanMiLCJhc3NldHMvc2NyaXB0cy9DYXJkUHJlZmFiLmpzIiwiYXNzZXRzL3NjcmlwdHMvQ2FyZFR5cGVDb21iaW5lLmpzIiwiYXNzZXRzL3NjcmlwdHMvQ2FyZFR5cGVTcHJpdGUuanMiLCJhc3NldHMvc2NyaXB0cy9DaGF0L0NoYXRNZXNzYWdlLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGVmYWJzL0NoYXRUZXh0UmVjb3JkLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGVmYWJzL0NvbXBhcmVDYXJkcy5qcyIsImFzc2V0cy9zY3JpcHRzL1BlZmFicy9Db3VudGRvd24uanMiLCIuLi8uLi8uLi8uLi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9iYXNlNjQtanMvaW5kZXguanMiLCIuLi8uLi8uLi8uLi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9idWZmZXIvaW5kZXguanMiLCIuLi8uLi8uLi8uLi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9pZWVlNzU0L2luZGV4LmpzIiwiLi4vLi4vLi4vLi4vQ29jb3NDcmVhdG9yL3Jlc291cmNlcy9hcHAuYXNhci9ub2RlX21vZHVsZXMvaXNhcnJheS9pbmRleC5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvR2FtZVJlc3VsdC5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9HZXRDYXJkUG9pbnRzU2FtZUNvdW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvSW52aXQuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkQ29sb3JzSGVscGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZFBvaW50c0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRSZXNIZWxwZXIuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2NvcmVFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2NvcmV0c0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRTZWxlY3RFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkLmpzIiwiYXNzZXRzL3NjcmlwdHMvU29ja2V0L0tRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIuanMiLCJhc3NldHMvc2NyaXB0cy9FdmVudC9LUUdsb2JhbEV2ZW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvVXRpbHMvS1FOYXRpdmVJbnZva2UuanMiLCJhc3NldHMvc2NyaXB0cy9DaGF0L01zZ0NvbnRyb2wuanMiLCJhc3NldHMvc2NyaXB0cy9OZXR3b3JrRXJyb3IuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL051bWJlckV4dGVuc2lvbi5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXliYWNrL1BsYXliYWNrLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9QbGF5ZXIuanMiLCJhc3NldHMvc2NyaXB0cy9QbGF5L1Jlc3VsdEl0ZW0uanMiLCJhc3NldHMvc2NyaXB0cy9TZXR0aW5nL1NldHRpbmcuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL1Nwcml0ZUhlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvU3RyaW5nRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9Ub3RhbEdhbWVSZXN1bHRJdGVtLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9Ub3RhbEdhbWVSZXN1bHQuanMiLCJhc3NldHMvc2NyaXB0cy9Nb2RlbFV0aWxzL1VzZXJNb2RlbEhlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvVXNlclNhbXBsZUluZm8uanMiLCJhc3NldHMvc2NyaXB0cy9hZ3JlZW1lbnQuanMiLCJhc3NldHMvc2NyaXB0cy9hbGVydC5qcyIsImFzc2V0cy9zY3JpcHRzL2FuaW1hdGlvbi5qcyIsImFzc2V0cy9zY3JpcHRzL2NhcmROdW0uanMiLCJhc3NldHMvc2NyaXB0cy9jYXJkc0JhY2suanMiLCJhc3NldHMvc2NyaXB0cy9jYXJkcy5qcyIsImFzc2V0cy9zY3JpcHRzL2NlbGxUZXh0LmpzIiwiYXNzZXRzL3NjcmlwdHMvY2hhbmdJbmZvLmpzIiwiYXNzZXRzL3NjcmlwdHMvY2hhbmdlX21hcGFpLmpzIiwiYXNzZXRzL3NjcmlwdHMvY2hlY2tTZWxlY3QuanMiLCJhc3NldHMvc2NyaXB0cy9jaG91amlhbmcuanMiLCJhc3NldHMvc2NyaXB0cy9jcmVhdGVfYnRuX2FuaW1hLmpzIiwiYXNzZXRzL3NjcmlwdHMvRXh0ZW5zaW9ucy9mZWNoYS5qcyIsImFzc2V0cy9zY3JpcHRzL2dhbWUuanMiLCJhc3NldHMvc2NyaXB0cy9oYWxsX2J0bl9hbmltYS5qcyIsImFzc2V0cy9zY3JpcHRzL2hhbGwuanMiLCJhc3NldHMvc2NyaXB0cy9oZWxwLmpzIiwiYXNzZXRzL3NjcmlwdHMvaW52aXRlQ29kZS5qcyIsImFzc2V0cy9zY3JpcHRzL2pvaW5Sb29tLmpzIiwiYXNzZXRzL3NjcmlwdHMvbGF1bmNoLmpzIiwiYXNzZXRzL3NjcmlwdHMvbG9naW4uanMiLCJhc3NldHMvc2NyaXB0cy9QbGF5L21hUGFpLmpzIiwiYXNzZXRzL3NjcmlwdHMvbWFuYWdlci5qcyIsImFzc2V0cy9zY3JpcHRzL292ZXJUaW1lLmpzIiwiYXNzZXRzL3NjcmlwdHMvcGxheS5qcyIsImFzc2V0cy9zY3JpcHRzL3Byb2R1Y3QuanMiLCJhc3NldHMvc2NyaXB0cy9yYW5kUm9vbS5qcyIsImFzc2V0cy9zY3JpcHRzL3JlY29yZEluZm8uanMiLCJhc3NldHMvc2NyaXB0cy9yZWNvcmQuanMiLCJhc3NldHMvc2NyaXB0cy9ydWxlLmpzIiwiYXNzZXRzL3NjcmlwdHMvc2NhbGUuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3RNb1NoaS5qcyIsImFzc2V0cy9zY3JpcHRzL3NlbGVjdF9tYXBhaS5qcyIsImFzc2V0cy9zY3JpcHRzL3NlbGVjdF9tYS5qcyIsImFzc2V0cy9zY3JpcHRzL3NlbGVjdGJlaWx2LmpzIiwiYXNzZXRzL3NjcmlwdHMvc2VsZWN0LmpzIiwiYXNzZXRzL3NjcmlwdHMvc2luZ2xlU2VsZWN0LmpzIiwiYXNzZXRzL3NjcmlwdHMvc2xpZGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvc29ja2V0LmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL3Rlc3QuanMiLCJhc3NldHMvc2NyaXB0cy90aW1lLmpzIiwiYXNzZXRzL3NjcmlwdHMvdXNlckluZm8uanMiLCJhc3NldHMvc2NyaXB0cy96aHVhbk51bUN0cmwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUVBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQUo7QUFFSTtBQUNFO0FBQ0E7QUFDRTtBQUFSO0FBQ0E7QUFFSTtBQUFKO0FBQ0E7QUFDQTtBQUVBO0FBQ0U7QUFDRTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFBUjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0U7QUFDRTtBQUNBO0FBREo7QUFDQTtBQUdNO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFETjtBQUNBO0FBR007QUFETjtBQUNBO0FBR007QUFDRTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHTTtBQUROO0FBQ0E7QUFHTTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBR1E7QUFDRTtBQURWO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFHTTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNFO0FBQ0U7QUFDQTtBQURKO0FBQ0E7QUFDTTtBQUNFO0FBQ1I7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNOO0FBQ007QUFDRTtBQUNSO0FBQ1E7QUFDRTtBQUNBO0FBQ0U7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNVO0FBQ0U7QUFDWjtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFDQTtBQUNFO0FBQVI7QUFFTTtBQUNFO0FBQVI7QUFFTTtBQUFOO0FBRUk7QUFDQTtBQUNFO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRU07QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUVNO0FBQ0E7QUFDQTtBQUFOO0FBQ0E7QUFFUTtBQUNFO0FBQVY7QUFDQTtBQUNBO0FBRVE7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFTTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRU07QUFBTjtBQUVNO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFBVjtBQUVVO0FBQVY7QUFFUTtBQUFSO0FBQ0E7QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0U7QUFBRjtBQUNBO0FBQUk7QUFDRTtBQUVOO0FBQ0E7QUFBSTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFFVjtBQUNBO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUVWO0FBQVU7QUFFVjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDSjtBQUNBO0FBRE07QUFHTjtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0U7QUFHRjtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBQ0E7QUFIQTtBQUNFO0FBQ0U7QUFDQTtBQUtKO0FBQ0E7QUFMTTtBQU9OO0FBQ0E7QUFOUTtBQUNBO0FBQ0U7QUFRVjtBQU5RO0FBQ0E7QUFDRTtBQVFWO0FBTlU7QUFDQTtBQVFWO0FBQ0E7QUFDQTtBQXBCTTtBQXNCTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWk07QUFjTjtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQWNSO0FBQ0E7QUFaTTtBQUNFO0FBY1I7QUFDQTtBQVpNO0FBQ0E7QUFDQTtBQWNOO0FBWk07QUFjTjtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQWNSO0FBQ0E7QUFaTTtBQUNFO0FBQ0E7QUFjUjtBQUNBO0FBWk07QUFjTjtBQVpNO0FBY047QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFjUjtBQUNBO0FBWk07QUFDQTtBQUNFO0FBQ0U7QUFjVjtBQUNBO0FBQ0E7QUFaTTtBQWNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVpBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0k7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFDSTtBQUFoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQVE7QUFDQTtBQUVSO0FBQVE7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUZRO0FBQ0E7QUFJUjtBQUZRO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBRkk7QUFJSjtBQUNBO0FBSlE7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBQ0E7QUFKUTtBQUNBO0FBQ0k7QUFDSTtBQU1oQjtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFQUTtBQVNSO0FBUFk7QUFDQTtBQUNBO0FBQ0E7QUFTWjtBQUNBO0FBUFE7QUFDQTtBQUNBO0FBU1I7QUFDQTtBQUNBO0FBUEk7QUFTSjtBQUNBO0FBVFE7QUFDQTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFDSTtBQVdaO0FBQ0E7QUFDQTtBQVRJO0FBQ0k7QUFXUjtBQUNBO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFDSTtBQVdaO0FBVFE7QUFDQTtBQUNBO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQVdSO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFEWjtBQUNBO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBQ0k7QUFEWjtBQUdRO0FBRFI7QUFHUTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBR1E7QUFEUjtBQUdRO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDelNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNNO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRE07QUFHTjtBQUNBO0FBREk7QUFDRTtBQUdOO0FBQ0E7QUFESTtBQUNFO0FBQ0E7QUFDRTtBQUdSO0FBQ0E7QUFETTtBQUdOO0FBQ0E7QUFESTtBQUNFO0FBR047QUFETTtBQUNFO0FBQ0U7QUFDQTtBQUdWO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0VBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQURBO0FBQ0k7QUFDQTtBQUNJO0FBR1I7QUFESTtBQUNJO0FBR1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBQVE7QUFFUjtBQUFRO0FBQ0E7QUFFUjtBQUNBO0FBQVE7QUFFUjtBQUFRO0FBQ0E7QUFDQTtBQUNBO0FBRVI7QUFBUTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVSO0FBQVE7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFFUjtBQUNBO0FBQUk7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFRO0FBRVI7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUVSO0FBRFk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdaO0FBQ0E7QUFEWTtBQUNBO0FBQ0E7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFEUTtBQUNJO0FBR1o7QUFDQTtBQURRO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUpRO0FBTVI7QUFKUTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSlE7QUFDQTtBQUNBO0FBTVI7QUFKUTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUpRO0FBTVI7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQU1SO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQU1aO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFBOEQ7QUFPdEU7QUFQMEc7QUFTMUc7QUFDQTtBQVJRO0FBQ0E7QUFDQTtBQUNBO0FBVVI7QUFDQTtBQUNBO0FBUkk7QUFVSjtBQVJRO0FBVVI7QUFSUTtBQVVSO0FBUlE7QUFBcUM7QUFXN0M7QUFDQTtBQVZRO0FBQ0E7QUFDQTtBQUNJO0FBWVo7QUFDQTtBQUNBO0FBVkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVlE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFZaEI7QUFWWTtBQVlaO0FBVlE7QUFZUjtBQVZRO0FBQ0k7QUFZWjtBQUNBO0FBQ0E7QUFWSTtBQUNJO0FBWVI7QUFDQTtBQVZJO0FBQ0k7QUFZUjtBQUNBO0FBVkk7QUFDSTtBQVlSO0FBQ0E7QUFDQTtBQVZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVlSO0FBWFk7QUFDQTtBQUNBO0FBYVo7QUFaZ0I7QUFDSTtBQWNwQjtBQVpvQjtBQWNwQjtBQUNBO0FBWmdCO0FBY2hCO0FBQ0E7QUFDQTtBQWJZO0FBQ0E7QUFlWjtBQWJRO0FBQ0E7QUFDQTtBQUNBO0FBZVI7QUFDQTtBQWJJO0FBQ0k7QUFDQTtBQWVSO0FBQ0E7QUFiSTtBQUNJO0FBZVI7QUFiUTtBQUNBO0FBZVI7QUFiUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBZVo7QUFDQTtBQUNBO0FBQ0E7QUFiSTtBQWVKO0FBQ0E7QUFDQTtBQWJRO0FBQ0E7QUFDSTtBQUNBO0FBZVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQlE7QUFDSTtBQUNBO0FBQ0E7QUFtQlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQlE7QUFtQlI7QUFDQTtBQWpCSTtBQUNJO0FBQ0k7QUFtQlo7QUFqQlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQW1CWjtBQWpCUTtBQW1CUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQlE7QUFDSTtBQW1CWjtBQUNBO0FBakJRO0FBbUJSO0FBQ0E7QUFqQkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbUJSO0FBakJRO0FBbUJSO0FBQ0E7QUFDQTtBQWpCSTtBQUNJO0FBbUJSO0FBakJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQW1CaEI7QUFqQlk7QUFtQlo7QUFqQlE7QUFDQTtBQUNBO0FBQ0E7QUFtQlI7QUFqQlE7QUFtQlI7QUFqQlk7QUFtQlo7QUFDQTtBQWpCUTtBQW1CUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpCSTtBQUNJO0FBQ0k7QUFtQlo7QUFqQlk7QUFtQlo7QUFqQlk7QUFtQlo7QUFqQlE7QUFtQlI7QUFDQTtBQUNBO0FBakJJO0FBbUJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQkk7QUFtQko7QUFqQlE7QUFtQlI7QUFqQlE7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQW1CaEI7QUFqQm9CO0FBbUJwQjtBQUNBO0FBQ0E7QUFqQlE7QUFtQlI7QUFDQTtBQWpCSTtBQUNJO0FBQ0E7QUFDSTtBQW1CWjtBQWpCUTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBbUJoQjtBQWpCWTtBQW1CWjtBQWpCUTtBQW1CUjtBQUNBO0FBakJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFtQmhCO0FBbEJvQjtBQW9CcEI7QUFDQTtBQWxCWTtBQUNJO0FBb0JoQjtBQUNBO0FBQ0E7QUFDQTtBQWxCUTtBQW9CUjtBQWxCWTtBQW9CWjtBQWxCWTtBQW9CWjtBQWxCWTtBQW9CWjtBQWxCWTtBQW9CWjtBQWxCWTtBQUNJO0FBb0JoQjtBQWxCZ0I7QUFvQmhCO0FBQ0E7QUFsQlk7QUFDSTtBQW9CaEI7QUFDQTtBQUNBO0FBbEJRO0FBQ0k7QUFDQTtBQW9CWjtBQW5CZ0I7QUFxQmhCO0FBQ0E7QUFuQlk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXFCWjtBQW5CWTtBQXFCWjtBQXBCZ0I7QUFDQTtBQUNJO0FBc0JwQjtBQUNBO0FBcEJZO0FBc0JaO0FBckJnQjtBQUNBO0FBQ0k7QUF1QnBCO0FBQ0E7QUFyQlk7QUF1Qlo7QUF0QmdCO0FBQ0E7QUFDSTtBQXdCcEI7QUFDQTtBQUNBO0FBdEJZO0FBQ0E7QUFDSTtBQUNJO0FBd0JwQjtBQUNBO0FBQ0E7QUF0Qlk7QUF3Qlo7QUF2QmdCO0FBeUJoQjtBQXZCWTtBQXlCWjtBQXhCZ0I7QUEwQmhCO0FBeEJZO0FBMEJaO0FBekJnQjtBQTJCaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF6Qlk7QUFFSTtBQTBCaEI7QUFDQTtBQUNBO0FBeEJRO0FBQ0E7QUFBb0Q7QUEyQjVEO0FBMUJRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNEJaO0FBQ0E7QUExQlE7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBNEJwQjtBQUNBO0FBQ0E7QUFDQTtBQTFCUTtBQTRCUjtBQTFCUTtBQUNBO0FBNEJSO0FBMUJRO0FBNEJSO0FBM0JZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUE2QnBCO0FBQ0E7QUFDQTtBQUNBO0FBM0JRO0FBQ0k7QUFDQTtBQUNBO0FBNkJaO0FBM0JZO0FBQ0E7QUFDQTtBQTZCWjtBQTNCWTtBQUNBO0FBNkJaO0FBM0JZO0FBNkJaO0FBQ0E7QUEzQlE7QUFDSTtBQTZCWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTNCUTtBQTZCUjtBQTNCWTtBQUF1QztBQThCbkQ7QUFDQTtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQUNBO0FBN0JRO0FBQ0E7QUFDQTtBQStCUjtBQTlCWTtBQUNBO0FBQ0E7QUFDQTtBQUF5QjtBQWlDckM7QUFoQ1k7QUFBeUI7QUFtQ3JDO0FBbENZO0FBQXlCO0FBcUNyQztBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQXBDWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBc0NaO0FBcENRO0FBc0NSO0FBcENRO0FBc0NSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBDSTtBQUNJO0FBc0NSO0FBcENRO0FBc0NSO0FBcENRO0FBc0NSO0FBcENZO0FBc0NaO0FBcENZO0FBc0NaO0FBQ0E7QUFuQ1E7QUFxQ1I7QUFuQ1E7QUFxQ1I7QUFuQ1E7QUFxQ1I7QUFsQ1E7QUFvQ1I7QUFsQ1k7QUFvQ1o7QUFsQ1k7QUFvQ1o7QUFsQ1k7QUFDQTtBQUNJO0FBb0NoQjtBQWpDZ0I7QUFtQ2hCO0FBQ0E7QUFqQ1k7QUFtQ1o7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ29CO0FBbUNwQjtBQWpDb0I7QUFtQ3BCO0FBakNvQjtBQW1DcEI7QUFqQ3dCO0FBQVU7QUFvQ2xDO0FBQ0E7QUFuQ3dCO0FBcUN4QjtBQW5Dd0I7QUFxQ3hCO0FBbkN3QjtBQXFDeEI7QUFuQ3dCO0FBcUN4QjtBQW5Dd0I7QUFxQ3hCO0FBQ0E7QUFsQ29CO0FBb0NwQjtBQUNBO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQUNBO0FBQ0E7QUFoQ1E7QUFrQ1I7QUFDQTtBQUNBO0FBQ0E7QUEvQkk7QUFpQ0o7QUFDQTtBQWhDUTtBQWtDUjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQUNBO0FBL0JRO0FBaUNSO0FBL0JRO0FBaUNSO0FBL0JRO0FBQ0k7QUFpQ1o7QUE5Qlk7QUFnQ1o7QUE5QlE7QUFDQTtBQUNBO0FBZ0NSO0FBQ0E7QUFDQTtBQUNBO0FBOUJRO0FBZ0NSO0FBOUJZO0FBZ0NaO0FBOUJZO0FBZ0NaO0FBOUJnQjtBQWdDaEI7QUFDQTtBQUNBO0FBQ0E7QUE1QlE7QUE4QlI7QUE1Qlk7QUE4Qlo7QUE1Qlk7QUFBbUM7QUErQi9DO0FBQ0E7QUFDQTtBQTlCUTtBQWdDUjtBQTlCUTtBQWdDUjtBQTlCUTtBQUE0RDtBQWlDcEU7QUFDQTtBQWhDUTtBQWtDUjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQWhDZ0I7QUFrQ2hCO0FBaENnQjtBQWtDaEI7QUFoQ2dCO0FBa0NoQjtBQWhDb0I7QUFrQ3BCO0FBaENvQjtBQWtDcEI7QUFoQ29CO0FBa0NwQjtBQWhDd0I7QUFDSTtBQWtDNUI7QUFDQTtBQWhDd0I7QUFrQ3hCO0FBQ0E7QUEvQm9CO0FBaUNwQjtBQS9Cb0I7QUFpQ3BCO0FBL0JvQjtBQWlDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTNCSTtBQTZCSjtBQTNCUTtBQTZCUjtBQTNCUTtBQTZCUjtBQTNCUTtBQTZCUjtBQTNCUTtBQTZCUjtBQUNBO0FBM0JJO0FBNkJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJJO0FBOEJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdCSTtBQStCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdCSTtBQStCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdCSTtBQStCSjtBQTdCUTtBQUNBO0FBK0JSO0FBN0JZO0FBK0JaO0FBN0JZO0FBK0JaO0FBN0JZO0FBK0JaO0FBQ0E7QUFDQTtBQTVCSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFBMEM7QUErQnREO0FBQ0E7QUE5QlE7QUFnQ1I7QUE5Qlk7QUFnQ1o7QUE5Qlk7QUFnQ1o7QUE5QmdCO0FBZ0NoQjtBQTlCZ0I7QUFnQ2hCO0FBOUJnQjtBQWdDaEI7QUFDQTtBQTdCWTtBQStCWjtBQTdCZ0I7QUErQmhCO0FBN0JnQjtBQUFtQztBQWdDbkQ7QUFDQTtBQS9CZ0I7QUFpQ2hCO0FBL0JnQjtBQWlDaEI7QUEvQm9CO0FBaUNwQjtBQS9Cb0I7QUFpQ3BCO0FBQ0E7QUE5QmdCO0FBZ0NoQjtBQTlCZ0I7QUFnQ2hCO0FBOUJnQjtBQWdDaEI7QUFDQTtBQTdCWTtBQStCWjtBQUNBO0FBQ0E7QUEzQkk7QUE2Qko7QUFDQTtBQUNBO0FBN0JRO0FBK0JSO0FBN0JZO0FBQThEO0FBZ0MxRTtBQWhDOEc7QUFrQzlHO0FBQ0E7QUFqQ1k7QUFtQ1o7QUFqQ1k7QUFBNkI7QUFBeUI7QUFBb0I7QUFzQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBdkNZO0FBeUNaO0FBQ0E7QUFDQTtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQUNBO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBQ0E7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUFBOEM7QUF5Q3REO0FBQ0E7QUF4Q1E7QUEwQ1I7QUF4Q1k7QUEwQ1o7QUF4Q1k7QUEwQ1o7QUF4Q1k7QUEwQ1o7QUFDQTtBQUNBO0FBdkNJO0FBQ0k7QUF5Q1I7QUFDQTtBQXZDSTtBQUNJO0FBeUNSO0FBQ0E7QUF2Q0k7QUFDSTtBQXlDUjtBQUNBO0FBdkNJO0FBQ0k7QUFDQTtBQUNBO0FBeUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2Q1E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUF5Q3hCO0FBdkN3QjtBQUNBO0FBeUN4QjtBQUNBO0FBQ0E7QUF0Q29CO0FBQ0E7QUF3Q3BCO0FBdENnQjtBQUNJO0FBQ0E7QUF3Q3BCO0FBdENvQjtBQXdDcEI7QUF0Q29CO0FBQ0E7QUF3Q3BCO0FBQ0E7QUFyQ2dCO0FBdUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFyQ0k7QUF1Q0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdENJO0FBd0NKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkNJO0FBeUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUF5Q1o7QUFDQTtBQXZDUTtBQUNBO0FBQ0E7QUFDQTtBQXlDUjtBQUNBO0FBQ0E7QUF2Q0k7QUFDSTtBQXlDUjtBQUNBO0FBQ0E7QUF2Q0k7QUF5Q0o7QUF2Q1E7QUF5Q1I7QUFDQTtBQUNBO0FBdkNJO0FBeUNKO0FBdkNRO0FBeUNSO0FBQ0E7QUF2Q0k7QUFDSTtBQUNJO0FBeUNaO0FBQ0E7QUF2Q1E7QUF5Q1I7QUFDQTtBQXZDWTtBQXlDWjtBQUNBO0FBdkNRO0FBeUNSO0FBQ0E7QUFDQTtBQXZDSTtBQXlDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkNJO0FBeUNKO0FBQ0E7QUFDQTtBQUNBO0FBdkNJO0FBeUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbHNEQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQURKO0FBQ0E7QUFDTTtBQUNBO0FBQ0k7QUFDVjtBQUNNO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ007QUFDRTtBQUNFO0FBQ0E7QUFDVjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdEQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBRlE7QUFDSTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGUTtBQUNBO0FBSVI7QUFGUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBSVo7QUFDQTtBQUZRO0FBQ0E7QUFJUjtBQUZRO0FBQ0E7QUFJUjtBQUZRO0FBQ0k7QUFJWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFDSTtBQUlaO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDSTtBQUNJO0FBQ0E7QUFJUjtBQUZJO0FBSUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEdBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUVJO0FBQUo7QUFJSTtBQUNFO0FBRk47QUFDQTtBQUlJO0FBQ0U7QUFGTjtBQUNBO0FBSUk7QUFDSTtBQUZSO0FBSUk7QUFDSTtBQUZSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFBUjtBQUVRO0FBQTRDO0FBQ3BEO0FBQ0E7QUFBUTtBQUVSO0FBQVE7QUFFUjtBQUFRO0FBRVI7QUFBUTtBQUVSO0FBQVk7QUFFWjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQ0E7QUFDUTtBQUE2QztBQUVyRDtBQUNBO0FBRFE7QUFBMkM7QUFJbkQ7QUFDQTtBQUhRO0FBS1I7QUFIUTtBQUtSO0FBSFE7QUFLUjtBQUNBO0FBQ0E7QUFIUTtBQUtSO0FBSFE7QUFLUjtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFLWjtBQUhZO0FBS1o7QUFDQTtBQUZRO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFJWjtBQUZRO0FBQThCO0FBS3RDO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNWjtBQUpZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNWjtBQUNBO0FBSlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNUjtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFLUjtBQUhRO0FBQ0E7QUFDSTtBQUNBO0FBS1o7QUFIWTtBQUtaO0FBSFE7QUFDQTtBQUtSO0FBQ0E7QUFISTtBQUNJO0FBS1I7QUFIWTtBQUtaO0FBSFk7QUFLWjtBQUhZO0FBS1o7QUFIZ0I7QUFBVTtBQU0xQjtBQUNBO0FBTGdCO0FBT2hCO0FBTGdCO0FBT2hCO0FBTGdCO0FBT2hCO0FBTGdCO0FBT2hCO0FBTGdCO0FBT2hCO0FBQ0E7QUFKWTtBQU1aO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFKUTtBQU1SO0FBSlE7QUFNUjtBQUpRO0FBQ0k7QUFDSTtBQU1oQjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFDQTtBQUhRO0FBQ0E7QUFDQTtBQUtSO0FBSFE7QUFLUjtBQUhRO0FBQ0E7QUFDQTtBQUtSO0FBQ0E7QUFIUTtBQUNBO0FBQ0E7QUFLUjtBQUNBO0FBSFE7QUFDQTtBQUtSO0FBSFE7QUFBMEM7QUFNbEQ7QUFDQTtBQUxRO0FBQ0E7QUFDQTtBQU9SO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFDQTtBQU5RO0FBQ0k7QUFDQTtBQVFaO0FBQ0E7QUFOUTtBQVFSO0FBTlk7QUFRWjtBQU5ZO0FBUVo7QUFOWTtBQVFaO0FBTlk7QUFRWjtBQU5ZO0FBUVo7QUFOWTtBQVFaO0FBTlk7QUFRWjtBQU5nQjtBQVFoQjtBQU5nQjtBQVFoQjtBQUNBO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMWTtBQU9aO0FBTFk7QUFBUTtBQVFwQjtBQUNBO0FBQ0E7QUFOUTtBQVFSO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDUTtBQU9oQjtBQUNBO0FBTFE7QUFPUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFPUjtBQUxZO0FBT1o7QUFMWTtBQU9aO0FBTFk7QUFPWjtBQUxZO0FBT1o7QUFMWTtBQU9aO0FBTFk7QUFPWjtBQUxnQjtBQU9oQjtBQUxnQjtBQU9oQjtBQUNBO0FBSmdCO0FBTWhCO0FBSmdCO0FBTWhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUNBO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUhRO0FBQ0k7QUFLWjtBQUZZO0FBSVo7QUFDQTtBQUZRO0FBQWlEO0FBS3pEO0FBQ0E7QUFKUTtBQU1SO0FBQ0E7QUFISTtBQUNJO0FBS1I7QUFDQTtBQUhRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFLWjtBQUNBO0FBSFE7QUFDQTtBQUNBO0FBQ0k7QUFLWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBQ0k7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBSUo7QUFGUTtBQUlSO0FBRlE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFDSTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBSUo7QUFGUTtBQUlSO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUloQjtBQUZnQjtBQUloQjtBQUZnQjtBQUloQjtBQUZnQjtBQUloQjtBQUZnQjtBQUloQjtBQUZnQjtBQUloQjtBQURZO0FBQStDO0FBSTNEO0FBSFk7QUFLWjtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDQTtBQUtSO0FBSFE7QUFDQTtBQUNJO0FBQ0k7QUFLaEI7QUFIZ0I7QUFLaEI7QUFIWTtBQUNBO0FBQ0E7QUFDQTtBQUtaO0FBSFE7QUFDQTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBQ0E7QUFLWjtBQUZZO0FBQ0E7QUFJWjtBQURZO0FBQ0E7QUFHWjtBQUNBO0FBRFE7QUFDQTtBQUE4QjtBQUl0QztBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBSVI7QUFGUTtBQUlSO0FBRlk7QUFBa0U7QUFLOUU7QUFKb0Q7QUFNcEQ7QUFDQTtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMWTtBQU9aO0FBTFk7QUFBMkM7QUFRdkQ7QUFDQTtBQVBZO0FBU1o7QUFQWTtBQVNaO0FBQ0E7QUFOUTtBQVFSO0FBTlE7QUFRUjtBQU5ZO0FBUVo7QUFDQTtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQ0k7QUFNWjtBQUNBO0FBSlE7QUFDQTtBQUNBO0FBQ0E7QUFNUjtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNUjtBQUpRO0FBTVI7QUFKUTtBQUNJO0FBQ0E7QUFNWjtBQUpRO0FBTVI7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBTlE7QUFDSTtBQUNJO0FBQ0E7QUFRaEI7QUFOWTtBQUNBO0FBQ0E7QUFDQTtBQVFaO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFRWjtBQU5RO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNBO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFDSTtBQVFaO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNJO0FBUVo7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNwQkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ1o7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0RBLEFENERBO0FDM0RBLEFENERBO0FDM0RBLEFENERBO0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNsSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzd2REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRjtBQUNBO0FBRUE7QUFDRTtBQUFGO0FBRUU7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBRUk7QUFBSjtBQUVJO0FBQ0E7QUFDQTtBQUFKO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFBSjtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQUo7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUo7QUFFSTtBQUNFO0FBQU47QUFFTTtBQUFOO0FBQ0E7QUFFSTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFBUjtBQUNBO0FBRU07QUFDQTtBQUNBO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQUo7QUFDQTtBQUVFO0FBQ0U7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBRUU7QUFDRTtBQUNFO0FBQU47QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBRUk7QUFDQTtBQUFKO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0SEE7QUFDQTtBQUNDO0FBQ0c7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNaO0FBQ1k7QUFDWjtBQUNRO0FBQ0k7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ1E7QUFDUjtBQUNNO0FBQ0E7QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUFNO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBQ0U7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0U7QUFDQTtBQUVFO0FBQ1Y7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDVjtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckZBO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNKO0FBQ0E7QUFDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDQTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0o7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFBTTtBQUNBO0FBQ0U7QUFDRTtBQUVWO0FBQVE7QUFFUjtBQUNBO0FBQ0E7QUFDQTtBQUFFO0FBQ0U7QUFDQTtBQUNBO0FBRUo7QUFBRTtBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDRTtBQUNBO0FBRUY7QUFBRTtBQUNFO0FBQ0k7QUFFUjtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQ0E7QUFBRTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBRVo7QUFBWTtBQUVaO0FBQ0E7QUFBUTtBQUNFO0FBQ0U7QUFFWjtBQUFVO0FBRVY7QUFDQTtBQUFRO0FBRVI7QUFDQTtBQUNBO0FBRUU7QUFDQTtBQUNFO0FBQUo7QUFFRTtBQUFGO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDRTtBQUNFO0FBQUo7QUFFRTtBQUFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFDQTtBQUNBO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDQTtBQUFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUVSO0FBQ0E7QUFDTTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ1I7QUFDTTtBQUNOO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDTjtBQUFRO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBRWQ7QUFDQTtBQUNBO0FBQVE7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFERTtBQUNFO0FBR0o7QUFESTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ0E7QUFHVjtBQUNBO0FBRE07QUFHTjtBQURJO0FBR0o7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBSEU7QUFDRTtBQUtKO0FBSEU7QUFDQTtBQUNFO0FBS0o7QUFIRTtBQUtGO0FBSEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUtSO0FBQ0E7QUFGTTtBQUNFO0FBQ0E7QUFJUjtBQUNBO0FBRk07QUFDRTtBQUNBO0FBSVI7QUFDQTtBQUZNO0FBQ0U7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUNBO0FBRkU7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBSVI7QUFGTTtBQUlOO0FBQ0E7QUFDQTtBQUNBO0FBRkU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBTFU7QUFDSTtBQU9kO0FBTlU7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFRaEI7QUFDQTtBQUNBO0FBTFU7QUFPVjtBQUxVO0FBT1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMRTtBQUNFO0FBT0o7QUFMSTtBQUNBO0FBQ0U7QUFPTjtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFDRTtBQUNBO0FBQ0U7QUFPSjtBQUxFO0FBT0Y7QUFMRTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9OO0FBQ0E7QUFMRTtBQUNFO0FBT0o7QUFMRTtBQUNBO0FBT0Y7QUFDQTtBQUxBO0FBQ0U7QUFDRTtBQU9KO0FBTEU7QUFDQTtBQU9GO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQVBFO0FBQ0U7QUFTSjtBQVBFO0FBQ0U7QUFTSjtBQUNBO0FBUEU7QUFDRTtBQVNKO0FBUEU7QUFTRjtBQUNBO0FBUEU7QUFDRTtBQVNKO0FBUEU7QUFDRTtBQUNBO0FBQ0E7QUFTSjtBQUNBO0FBUEU7QUFTRjtBQUNBO0FBUEU7QUFDRTtBQUNBO0FBU0o7QUFSTTtBQUNBO0FBQ0U7QUFVUjtBQVJVO0FBQ0U7QUFVWjtBQUNBO0FBUlU7QUFVVjtBQVJRO0FBVVI7QUFDQTtBQVJNO0FBQ0E7QUFVTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFURTtBQUNBO0FBQ0U7QUFXSjtBQUNBO0FBVEU7QUFDRTtBQVdKO0FBQ0E7QUFURTtBQVdGO0FBVEE7QUFXQTtBQUNBO0FBWEU7QUFDRTtBQWFKO0FBWEU7QUFDQTtBQUNFO0FBYUo7QUFYRTtBQWFGO0FBWEU7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBYU47QUFDQTtBQUNBO0FBWEU7QUFDRTtBQWFKO0FBWEU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFhTjtBQUNBO0FBQ0E7QUFkUTtBQUNJO0FBZ0JaO0FBZlE7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFpQmQ7QUFDQTtBQUNBO0FBQ0E7QUFkUTtBQUNBO0FBZ0JSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmRTtBQUNFO0FBaUJKO0FBZkk7QUFDQTtBQUNFO0FBaUJOO0FBZkk7QUFpQko7QUFDQTtBQWZBO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFpQk47QUFDQTtBQWZJO0FBQ0U7QUFDRTtBQUNFO0FBaUJWO0FBZlE7QUFDRTtBQWlCVjtBQWZRO0FBaUJSO0FBQ0E7QUFmTTtBQUNFO0FBaUJSO0FBQ0E7QUFmTTtBQUNBO0FBQ0E7QUFpQk47QUFDQTtBQUNBO0FBZkU7QUFpQkY7QUFDQTtBQUNBO0FBQ0E7QUFmQTtBQWlCQTtBQUNBO0FBakJFO0FBQ0U7QUFtQko7QUFDQTtBQWpCRTtBQUNBO0FBbUJGO0FBakJFO0FBQ0E7QUFDRTtBQUNBO0FBbUJKO0FBbEJNO0FBQ0E7QUFDRTtBQUNFO0FBb0JWO0FBbEJVO0FBb0JWO0FBQ0E7QUFsQk07QUFDQTtBQW9CTjtBQUNBO0FBQ0E7QUFuQkU7QUFxQkY7QUFuQkE7QUFDRTtBQUNFO0FBcUJKO0FBbkJFO0FBQ0E7QUFDRTtBQXFCSjtBQW5CRTtBQXFCRjtBQW5CRTtBQXFCRjtBQW5CRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFxQk47QUFDQTtBQUNBO0FBdEJRO0FBQ0k7QUF3Qlo7QUF2QlE7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUF5QmQ7QUFDQTtBQUNBO0FBQ0E7QUF0QlE7QUFDQTtBQXdCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkJFO0FBeUJGO0FBQ0E7QUF2QkE7QUFDRTtBQUNBO0FBQ0U7QUF5Qko7QUFDQTtBQXRCRTtBQUNBO0FBQ0E7QUF3QkY7QUFDQTtBQUNBO0FBdEJFO0FBQ0U7QUFDRTtBQUNFO0FBd0JSO0FBdEJRO0FBQ0E7QUF3QlI7QUF0QlE7QUF3QlI7QUFDQTtBQUNBO0FBdEJJO0FBQ0U7QUFDRTtBQXdCUjtBQUNBO0FBQ0E7QUFDQTtBQXRCUTtBQUNBO0FBd0JSO0FBQ0E7QUFDQTtBQUNBO0FBdEJRO0FBd0JSO0FBQ0E7QUFDQTtBQUNBO0FBcEJFO0FBQ0U7QUFzQko7QUFwQkU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQXNCWjtBQUNBO0FBcEJRO0FBQ0U7QUFzQlY7QUFDQTtBQXBCTTtBQUNFO0FBc0JSO0FBQ0E7QUFDQTtBQXBCRTtBQUNFO0FBc0JKO0FBcEJFO0FBc0JGO0FBcEJBO0FBQ0U7QUFDQTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0E7QUFDRTtBQXNCSjtBQXBCRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQXNCTjtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBc0JOO0FBQ0E7QUFDQTtBQXBCRTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFzQlo7QUFDQTtBQXBCUTtBQUNFO0FBc0JWO0FBQ0E7QUFwQk07QUFDRTtBQXNCUjtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQXNCSjtBQXBCRTtBQXNCRjtBQUNBO0FBcEJBO0FBc0JBO0FBQ0E7QUF0QkU7QUF3QkY7QUF2Qkk7QUFDRTtBQUNBO0FBQ0U7QUF5QlI7QUFDQTtBQUNBO0FBdkJFO0FBQ0U7QUF5Qko7QUF2QkU7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBeUJOO0FBeEJRO0FBQ0U7QUFDQTtBQUNFO0FBMEJaO0FBQ0E7QUFDQTtBQXhCUTtBQUNBO0FBQ0U7QUEwQlY7QUFDQTtBQUNBO0FBQ0E7QUF4QkU7QUFDRTtBQTBCSjtBQXhCRTtBQUNBO0FBMEJGO0FBQ0E7QUF4QkE7QUFDRTtBQUNFO0FBMEJKO0FBeEJJO0FBQ0E7QUEwQko7QUF6Qk07QUFDRTtBQTJCUjtBQXpCUTtBQUNBO0FBMkJSO0FBQ0E7QUFDQTtBQXpCSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQTJCVjtBQXpCTTtBQTJCTjtBQTFCUTtBQUNBO0FBNEJSO0FBQ0E7QUFDQTtBQXpCRTtBQTJCRjtBQUNBO0FBeEJBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQWdCRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0NEJBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0o7QUFDVTtBQUNWO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDQTtBQUdBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDRTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBQ007QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0Y7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNOO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDTjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0Y7QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNKO0FBQ0k7QUFDRTtBQUNOO0FBQ007QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFFSTtBQUFKO0FBQ007QUFDTjtBQUNJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDSTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQU47QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUdJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUROO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUROO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFDQTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBSE47QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBTUk7QUFKSjtBQUtNO0FBSE47QUFLSTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBSE47QUFLTTtBQUNBO0FBSE47QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUpOO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUNFO0FBSFY7QUFLVTtBQUhWO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDQTtBQUhOO0FBS0k7QUFISjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFMTjtBQU1RO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUpaO0FBQ0E7QUFDQTtBQVFRO0FBTlI7QUFPVTtBQUNFO0FBQ0E7QUFMWjtBQU9ZO0FBQ0E7QUFMWjtBQUNBO0FBQ0E7QUFDQTtBQVVJO0FBUko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdJO0FBQ0E7QUFDQTtBQUNBO0FBVEo7QUFXSTtBQUNFO0FBQ0U7QUFUUjtBQVdNO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBVFY7QUFXVTtBQVRWO0FBQ0E7QUFDQTtBQUNBO0FBV007QUFDRTtBQUNBO0FBVFI7QUFXTTtBQVROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXSTtBQUNFO0FBVE47QUFVUTtBQVJSO0FBU1U7QUFDRTtBQUNBO0FBQ0E7QUFQWjtBQUNBO0FBQ0E7QUFVUTtBQVJSO0FBU1U7QUFDRTtBQUNBO0FBQ0E7QUFQWjtBQUNBO0FBQ0E7QUFDQTtBQVdJO0FBQ0U7QUFDQTtBQVROO0FBV0k7QUFUSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWUk7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFWTjtBQVlJO0FBQ0U7QUFDQTtBQVZOO0FBWUk7QUFWSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYUU7QUFDQTtBQUNFO0FBWEo7QUFDQTtBQWFFO0FBQ0E7QUFYRjtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFYTjtBQUNBO0FBQ0E7QUFhRTtBQUNBO0FBWEY7QUFhRTtBQUNFO0FBQ0U7QUFYTjtBQUNBO0FBYUU7QUFDRTtBQUNBO0FBQ0U7QUFYTjtBQUNBO0FBYUU7QUFDRTtBQUNFO0FBWE47QUFDQTtBQUNBO0FBYUU7QUFYRjtBQVlJO0FBQ0U7QUFDRTtBQVZSO0FBQ0E7QUFDQTtBQVlJO0FBQ0U7QUFWTjtBQVlJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFWTjtBQVlJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFWVjtBQUNBO0FBQ0E7QUFDQTtBQVlJO0FBVko7QUFXTTtBQUNFO0FBVFI7QUFDQTtBQUNBO0FBQ0E7QUFXSTtBQUNFO0FBVE47QUFXSTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBVE47QUFXSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBVFY7QUFDQTtBQUNBO0FBQ0E7QUFXSTtBQVRKO0FBVU07QUFDRTtBQVJSO0FBQ0E7QUFDQTtBQVdJO0FBQ0U7QUFUTjtBQVdJO0FBQ0E7QUFDRTtBQUNBO0FBVE47QUFXSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBVFY7QUFDQTtBQUNBO0FBV0k7QUFUSjtBQVVNO0FBQ0U7QUFSUjtBQUNBO0FBQ0E7QUFDQTtBQVVFO0FBQ0U7QUFDRTtBQVJOO0FBQ0E7QUFVRTtBQUNFO0FBUko7QUFVRTtBQVJGO0FBQ0E7QUFDQTtBQVVBO0FBQ0U7QUFDQTtBQUNFO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQVVJO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQVVJO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQUNBO0FBVUU7QUFSRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBUkE7QUFVRTtBQVJGO0FBVUU7QUFBMEI7QUFQNUI7QUFDQTtBQVFFO0FBQ0E7QUFDRTtBQUNBO0FBTko7QUFRSTtBQUNFO0FBTk47QUFRSTtBQUNBO0FBQ0E7QUFOSjtBQUNBO0FBUUU7QUFBNkI7QUFML0I7QUFNRTtBQUpGO0FBQ0E7QUFNQTtBQUpBO0FBTUU7QUFKRjtBQU1FO0FBQTBCO0FBSDVCO0FBQ0E7QUFJRTtBQUNBO0FBQ0U7QUFDQTtBQUZKO0FBSUk7QUFDRTtBQUZOO0FBSUk7QUFDQTtBQUNBO0FBRko7QUFDQTtBQUlFO0FBQTZCO0FBRC9CO0FBRUU7QUFBRjtBQUNBO0FBRUE7QUFBQTtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUU7QUFBRjtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUU7QUFBRjtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUk7QUFBSjtBQUdFO0FBREY7QUFHSTtBQURKO0FBR007QUFETjtBQUdNO0FBRE47QUFHTTtBQUE2RTtBQUFuRjtBQUNBO0FBRUk7QUFBSjtBQUVJO0FBQUo7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUlFO0FBRkY7QUFLSTtBQUhKO0FBS007QUFITjtBQUtNO0FBSE47QUFLTTtBQUE2RTtBQUZuRjtBQUNBO0FBQ0E7QUFJSTtBQUZKO0FBSUk7QUFBdUI7QUFEM0I7QUFDQTtBQUVJO0FBQUo7QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFJRTtBQUZGO0FBQ0E7QUFJQTtBQUZBO0FBQ0E7QUFJRTtBQUZGO0FBSUU7QUFGRjtBQUlFO0FBRkY7QUFJRTtBQUZGO0FBSUU7QUFGRjtBQUlFO0FBRkY7QUFJSTtBQUZKO0FBSU07QUFGTjtBQUNBO0FBQ0E7QUFLRTtBQUhGO0FBS0k7QUFISjtBQUtJO0FBQXFDO0FBRnpDO0FBRXlGO0FBQXpGO0FBQ0E7QUFDSTtBQUNKO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNBO0FBR0U7QUFERjtBQUdJO0FBREo7QUFHTTtBQUROO0FBR007QUFETjtBQUdNO0FBQTZFO0FBQW5GO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFFSTtBQUFKO0FBRUk7QUFBSjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUdFO0FBREY7QUFJSTtBQUZKO0FBSU07QUFGTjtBQUlNO0FBRk47QUFJTTtBQUE2RTtBQURuRjtBQUNBO0FBQ0E7QUFHSTtBQURKO0FBR0k7QUFBdUI7QUFBM0I7QUFDQTtBQUNJO0FBQ0o7QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFIQTtBQUNBO0FBS0U7QUFIRjtBQUtFO0FBSEY7QUFLRTtBQUhGO0FBS0U7QUFIRjtBQUtFO0FBSEY7QUFLRTtBQUhGO0FBS0k7QUFISjtBQUtNO0FBSE47QUFDQTtBQUNBO0FBTUU7QUFKRjtBQU1JO0FBSko7QUFNSTtBQUE4QjtBQUhsQztBQUdrRjtBQURsRjtBQUNBO0FBRUk7QUFBSjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUlFO0FBRkY7QUFJSTtBQUZKO0FBSU07QUFGTjtBQUlNO0FBRk47QUFJTTtBQUE2RTtBQURuRjtBQUNBO0FBQ0E7QUFHSTtBQURKO0FBR0k7QUFESjtBQUdJO0FBREo7QUFHTTtBQUROO0FBR007QUFETjtBQUdNO0FBRE47QUFHTTtBQUROO0FBQ0E7QUFJRTtBQUZGO0FBS0k7QUFISjtBQUtNO0FBSE47QUFLTTtBQUhOO0FBS007QUFBNkU7QUFGbkY7QUFDQTtBQUNBO0FBSUk7QUFGSjtBQUlJO0FBQXVCO0FBRDNCO0FBQ0E7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBSkE7QUFDQTtBQU1FO0FBSkY7QUFNRTtBQUpGO0FBTUU7QUFKRjtBQU1FO0FBSkY7QUFDQTtBQU9BO0FBTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzE0QkE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDSjtBQUNVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSjtBQVdJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQVRaO0FBQ0E7QUFDQTtBQVdJO0FBQ0E7QUFUSjtBQVdRO0FBQ0E7QUFDSTtBQVRaO0FBQ0E7QUFTUTtBQUNBO0FBQ0k7QUFDQTtBQVBaO0FBQ0E7QUFDQTtBQUNBO0FBU0k7QUFDSTtBQVBSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTUTtBQVBSO0FBQ0E7QUFTSTtBQVBKO0FBQ0E7QUFTQTtBQVBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBb0I7QUFFNUI7QUFEUTtBQUFvQjtBQUk1QjtBQUhRO0FBQW9CO0FBTTVCO0FBTFE7QUFBb0I7QUFRNUI7QUFDQTtBQVBRO0FBQ0E7QUFDQTtBQUNBO0FBU1I7QUFQUTtBQUNBO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQUNJO0FBU1o7QUFQWTtBQVNaO0FBQ0E7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQVNKO0FBQ0E7QUFDQTtBQVZRO0FBWVI7QUFDQTtBQVZJO0FBQ0k7QUFDSTtBQVlaO0FBVlE7QUFZUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0E7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBV0o7QUFUUTtBQUNBO0FBQ0k7QUFDQTtBQVdaO0FBVFk7QUFDQTtBQVdaO0FBVFk7QUFXWjtBQUNBO0FBVFE7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBV0o7QUFDQTtBQUNBO0FBVEE7QUFDSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBQ0E7QUFUQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBVEE7QUFXQTtBQVRBO0FBQ0k7QUFDSTtBQVdSO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFDSTtBQUNJO0FBV1I7QUFDQTtBQUNBO0FBVEE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXSjtBQVRJO0FBV0o7QUFUSTtBQUNBO0FBQ0E7QUFXSjtBQVRJO0FBQ0E7QUFXSjtBQVRJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXSjtBQUNBO0FBQ0E7QUFUQTtBQUNJO0FBR0E7QUFDQTtBQVNKO0FBQ0E7QUFDQTtBQVBBO0FBQ0k7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBUUo7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBQ0E7QUFSSTtBQUNJO0FBVVI7QUFDQTtBQVJJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFVWjtBQUNBO0FBUkk7QUFVSjtBQUNBO0FBQ0E7QUFSQTtBQVVBO0FBQ0E7QUFWSTtBQUNJO0FBWVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZJO0FBQ0E7QUFZSjtBQVZJO0FBQ0E7QUFDQTtBQVlKO0FBVkk7QUFDSTtBQUNBO0FBQ0k7QUFZWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFDSTtBQUNJO0FBWVI7QUFWSTtBQUNBO0FBQ0E7QUFZSjtBQVZJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQVloQjtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBQ0E7QUFWQTtBQVlBO0FBQ0E7QUFaSTtBQUNJO0FBY1I7QUFDQTtBQVpJO0FBQ0k7QUFjUjtBQUNBO0FBWkk7QUFDSTtBQWNSO0FBWlE7QUFjUjtBQUNBO0FBWkk7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQWNaO0FBQ0E7QUFaUTtBQWNSO0FBQ0E7QUFaSTtBQWNKO0FBQ0E7QUFDQTtBQVpBO0FBQ0k7QUFDQTtBQUNJO0FBY1I7QUFDQTtBQVpJO0FBQ0E7QUFDQTtBQWNKO0FBWkk7QUFDSTtBQUNBO0FBY1I7QUFDQTtBQVpJO0FBY0o7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQWNBO0FBWlE7QUFDQTtBQUNJO0FBY1o7QUFDQTtBQVpRO0FBQ0k7QUFjWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBekJJO0FBMkJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQkk7QUFzQko7QUFwQkE7QUFDSTtBQUNJO0FBc0JSO0FBcEJJO0FBQ0k7QUFzQlI7QUFwQkk7QUFzQko7QUFyQlE7QUFDSTtBQXVCWjtBQUNBO0FBckJJO0FBdUJKO0FBQ0E7QUFyQkE7QUF1QkE7QUFDQTtBQXZCSTtBQUNJO0FBeUJSO0FBdkJJO0FBQ0k7QUF5QlI7QUF2Qkk7QUF5Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZCQTtBQUNJO0FBeUJKO0FBQ0E7QUFDQTtBQXZCQTtBQXlCQTtBQUNBO0FBekJJO0FBQ0k7QUEyQlI7QUF6Qkk7QUFDSTtBQTJCUjtBQXpCSTtBQTJCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkJBO0FBQ0k7QUFDQTtBQUNJO0FBeUJSO0FBdkJJO0FBQ0E7QUFDSTtBQXlCUjtBQUNBO0FBQ0E7QUFDQTtBQXZCSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQXlCWjtBQXZCWTtBQXlCWjtBQXZCWTtBQXlCWjtBQXZCWTtBQXlCWjtBQUNBO0FBdkJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQXlCWjtBQUNBO0FBdkJJO0FBQ0k7QUF5QlI7QUF2Qlk7QUF5Qlo7QUF2QmdCO0FBQXlDO0FBMEJ6RDtBQUNBO0FBekJnQjtBQTJCaEI7QUF6QmdCO0FBQ0k7QUEyQnBCO0FBQ0E7QUF6QmdCO0FBQ0k7QUEyQnBCO0FBQ0E7QUF6QmdCO0FBMkJoQjtBQXpCZ0I7QUEyQmhCO0FBekJnQjtBQTJCaEI7QUF6QmdCO0FBMkJoQjtBQXpCZ0I7QUEyQmhCO0FBQ0E7QUFDQTtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0E7QUFDSTtBQTBCUjtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQUNBO0FBeEJBO0FBMEJBO0FBeEJJO0FBQ0E7QUFDSTtBQTBCUjtBQXhCSTtBQUNBO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBMEJSO0FBeEJRO0FBMEJSO0FBeEJJO0FBQ0k7QUFDSTtBQTBCWjtBQUNBO0FBQ0E7QUF4Qkk7QUFBeUM7QUEyQjdDO0FBQ0E7QUExQkk7QUE0Qko7QUExQkk7QUFDSTtBQTRCUjtBQUNBO0FBMUJJO0FBQ0k7QUE0QlI7QUFDQTtBQTFCSTtBQTRCSjtBQTFCSTtBQTRCSjtBQTFCSTtBQTRCSjtBQTFCSTtBQTRCSjtBQUNBO0FBMUJJO0FBNEJKO0FBQ0E7QUFDQTtBQTFCQTtBQUNJO0FBQ0E7QUFDSTtBQTRCUjtBQTFCSTtBQUNBO0FBQ0k7QUE0QlI7QUExQkk7QUFDSTtBQTRCUjtBQTFCSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQTRCWjtBQTFCWTtBQTRCWjtBQTFCWTtBQTRCWjtBQTFCWTtBQTRCWjtBQUNBO0FBMUJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQTRCWjtBQUNBO0FBQ0E7QUFDQTtBQTFCSTtBQUNJO0FBQ0k7QUFDSTtBQTRCaEI7QUFDQTtBQTFCUTtBQUNJO0FBNEJaO0FBMUJRO0FBQ0E7QUE0QlI7QUExQkk7QUE0Qko7QUFDQTtBQXpCQTtBQUNJO0FBQ0E7QUFDSTtBQTJCUjtBQXpCSTtBQUNBO0FBQ0k7QUEyQlI7QUF6Qkk7QUFDSTtBQTJCUjtBQXpCSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBMkJaO0FBekJZO0FBMkJaO0FBQ0E7QUFDQTtBQUNBO0FBekJJO0FBQ0k7QUEyQlI7QUFDQTtBQUNBO0FBQ0E7QUF6Qkk7QUEyQko7QUFDQTtBQUNBO0FBekJBO0FBQ0k7QUFDQTtBQUNJO0FBMkJSO0FBQ0E7QUF6Qkk7QUEyQko7QUF6Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUEyQlo7QUF4Qlk7QUEwQlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCWTtBQTBCWjtBQUNBO0FBQ0E7QUF4Qkk7QUEwQko7QUF4QlE7QUFBeUM7QUEyQmpEO0FBQ0E7QUExQlE7QUE0QlI7QUExQlE7QUFDSTtBQTRCWjtBQUNBO0FBMUJRO0FBQ0k7QUE0Qlo7QUFDQTtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCSTtBQTRCSjtBQUNBO0FBMUJBO0FBQ0k7QUFDQTtBQUNJO0FBNEJSO0FBQ0E7QUExQkk7QUFDQTtBQTRCSjtBQTFCSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQTRCWjtBQXpCWTtBQTJCWjtBQXhCWTtBQTBCWjtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQTBCQTtBQXhCSTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qlk7QUEwQlo7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUFDSTtBQTBCUjtBQUNBO0FBQ0E7QUF4Qkk7QUFDSTtBQTBCUjtBQUNBO0FBeEJJO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQUNJO0FBMEJaO0FBQ0E7QUF4QlE7QUFDSTtBQTBCWjtBQXhCUTtBQUNJO0FBQ0k7QUEwQmhCO0FBQ0E7QUF4Qlk7QUFDSTtBQTBCaEI7QUF4Qlk7QUEwQlo7QUF4QmdCO0FBQ0E7QUFDSTtBQUNJO0FBMEJ4QjtBQXhCd0I7QUEwQnhCO0FBQ0E7QUF4QmdCO0FBMEJoQjtBQXhCb0I7QUEwQnBCO0FBQ0E7QUF4QmdCO0FBQ0k7QUEwQnBCO0FBeEJ3QjtBQUNBO0FBMEJ4QjtBQUNBO0FBeEJnQjtBQUNJO0FBQXdDO0FBMkI1RDtBQTFCb0I7QUFDSTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBNEJwQztBQUNBO0FBQ0E7QUExQndCO0FBNEJ4QjtBQTFCb0I7QUE0QnBCO0FBMUJnQjtBQTRCaEI7QUFDQTtBQUNBO0FBMUJJO0FBQ0k7QUFBd0M7QUE2QmhEO0FBNUJRO0FBQ0k7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQThCeEI7QUFDQTtBQUNBO0FBNUJZO0FBOEJaO0FBNUJRO0FBOEJSO0FBNUJJO0FBOEJKO0FBQ0E7QUFDQTtBQTVCQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQThCWjtBQTVCUTtBQUNJO0FBOEJaO0FBNUJRO0FBQ0E7QUE4QlI7QUE1Qlk7QUE4Qlo7QUE1QmdCO0FBQ0k7QUFDSTtBQThCeEI7QUE1QjRCO0FBQ0k7QUE4QmhDO0FBNUI0QjtBQThCNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJnQjtBQUNJO0FBQ0k7QUE4QnhCO0FBNUJvQjtBQUNJO0FBOEJ4QjtBQTVCb0I7QUFDQTtBQThCcEI7QUE1QndCO0FBQ0k7QUFDSTtBQUNJO0FBOEJwQztBQTVCd0M7QUFDSTtBQThCNUM7QUE1QndDO0FBOEJ4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUI0QjtBQThCNUI7QUE1QjRCO0FBOEI1QjtBQTVCZ0M7QUE4QmhDO0FBNUJnQztBQUE2QjtBQStCN0Q7QUFDQTtBQTlCZ0M7QUFnQ2hDO0FBOUJnQztBQWdDaEM7QUFDQTtBQTlCNEI7QUFnQzVCO0FBQ0E7QUE5QndCO0FBZ0N4QjtBQUNBO0FBQ0E7QUFDQTtBQTlCWTtBQWdDWjtBQUNBO0FBQ0E7QUE5Qkk7QUFDSTtBQWdDUjtBQTlCSTtBQUNJO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCQTtBQUNJO0FBQ0E7QUFDSTtBQWdDUjtBQTlCSTtBQUNJO0FBZ0NSO0FBOUJJO0FBQ0E7QUFDSTtBQWdDUjtBQUNBO0FBOUJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0NKO0FBL0JRO0FBaUNSO0FBQ0E7QUEvQkk7QUFpQ0o7QUFoQ1E7QUFrQ1I7QUFoQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFrQ1o7QUFDQTtBQWpDWTtBQW1DWjtBQUNBO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFsQ1E7QUFDQTtBQUNJO0FBb0NaO0FBbENRO0FBQ0k7QUFvQ1o7QUFuQ2dCO0FBcUNoQjtBQUNBO0FBbkNZO0FBQ0E7QUFDSTtBQUNBO0FBcUNoQjtBQXBDb0I7QUFzQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBDb0I7QUFzQ3BCO0FBQ0E7QUFDQTtBQW5DWTtBQXFDWjtBQXBDZ0I7QUFzQ2hCO0FBckNvQjtBQXVDcEI7QUFyQ2dCO0FBQ0E7QUF1Q2hCO0FBQ0E7QUFyQ1k7QUFDSTtBQXVDaEI7QUF0Q29CO0FBd0NwQjtBQUNBO0FBdENZO0FBd0NaO0FBdkNnQjtBQXlDaEI7QUFDQTtBQXZDZ0I7QUF5Q2hCO0FBQ0E7QUF2Q1E7QUF5Q1I7QUF4Q1k7QUFDQTtBQTBDWjtBQUNBO0FBeENZO0FBMENaO0FBQ0E7QUFDQTtBQXhDSTtBQUNBO0FBMENKO0FBekNRO0FBQ0E7QUFDQTtBQTJDUjtBQXpDUTtBQUNBO0FBMkNSO0FBekNJO0FBQ0E7QUFDSTtBQUNJO0FBMkNaO0FBQ0E7QUF6Q1E7QUEyQ1I7QUF6Q0k7QUEyQ0o7QUFDQTtBQXpDQTtBQTJDQTtBQUNBO0FBM0NJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUE2Q1I7QUEzQ0k7QUFDSTtBQUNBO0FBNkNSO0FBM0NRO0FBQ0k7QUFDQTtBQUNJO0FBNkNoQjtBQTNDWTtBQTZDWjtBQTFDUTtBQUNBO0FBNENSO0FBMUNJO0FBNENKO0FBQ0E7QUExQ0E7QUFDSTtBQTRDSjtBQUNBO0FBekNBO0FBQ0k7QUFDQTtBQUNJO0FBMkNSO0FBekNJO0FBQ0E7QUFDSTtBQTJDUjtBQXpDSTtBQTJDSjtBQXpDSTtBQUNBO0FBQ0k7QUFDQTtBQTJDUjtBQUNBO0FBekNJO0FBQ0k7QUEyQ1I7QUFDQTtBQXpDSTtBQUNJO0FBMkNSO0FBQ0E7QUF6Q0k7QUFDQTtBQUNBO0FBMkNKO0FBekNJO0FBQ0k7QUEyQ1I7QUFDQTtBQXpDSTtBQTJDSjtBQUNBO0FBQ0E7QUF6Q0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQTJDWjtBQXpDUTtBQTJDUjtBQUNBO0FBekNJO0FBMkNKO0FBQ0E7QUFDQTtBQXpDQTtBQUNJO0FBMkNKO0FBQ0E7QUFDQTtBQXZDQTtBQUNJO0FBQ0E7QUFDSTtBQXlDUjtBQUNBO0FBdkNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBeUNaO0FBQ0E7QUF2Q0k7QUF5Q0o7QUFDQTtBQUNBO0FBdENBO0FBQ0k7QUFDQTtBQUNJO0FBd0NSO0FBdENJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBd0NaO0FBQ0E7QUFDQTtBQXRDSTtBQXdDSjtBQUNBO0FBQ0E7QUFDQTtBQXJDQTtBQUNJO0FBQ0E7QUFDSTtBQXVDUjtBQXJDSTtBQUNBO0FBQ0k7QUF1Q1I7QUFyQ0k7QUFDQTtBQUNBO0FBQ0k7QUF1Q1I7QUFDQTtBQXJDSTtBQUNJO0FBdUNSO0FBQ0E7QUFyQ0k7QUFDSTtBQXVDUjtBQUNBO0FBckNJO0FBR0k7QUFxQ1I7QUFDQTtBQW5DSTtBQXFDSjtBQUNBO0FBQ0E7QUFDQTtBQWxDQTtBQUNJO0FBQ0E7QUFDSTtBQW9DUjtBQWxDSTtBQUNBO0FBQ0E7QUFDQTtBQW9DSjtBQWxDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBb0NoQjtBQWxDWTtBQW9DWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbENJO0FBb0NKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0E7QUFDSTtBQW1DUjtBQUNBO0FBakNJO0FBQ0k7QUFDSTtBQW1DWjtBQWpDUTtBQW1DUjtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBakNJO0FBQ0E7QUFDQTtBQW1DSjtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFtQ2hCO0FBakNZO0FBbUNaO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDSTtBQUNJO0FBbUNaO0FBakNRO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0E7QUFDSTtBQW1DUjtBQWpDSTtBQUNJO0FBbUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDSTtBQW1DUjtBQWpDUTtBQW1DUjtBQUNBO0FBakNJO0FBQ0E7QUFDQTtBQUNBO0FBbUNKO0FBakNJO0FBQ0k7QUFDSTtBQUNBO0FBbUNaO0FBQ0E7QUFqQ1E7QUFDQTtBQW1DUjtBQUNBO0FBakNJO0FBQ0E7QUFtQ0o7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQW1DaEI7QUFqQ1k7QUFtQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDSTtBQW1DUjtBQUNBO0FBakNJO0FBQ0k7QUFDSTtBQW1DWjtBQUNBO0FBakNRO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDSTtBQW1DUjtBQWpDSTtBQUNJO0FBbUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDQTtBQUNJO0FBQ0k7QUFtQ1o7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDQTtBQW1DSjtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNBO0FBQ0k7QUFtQ1I7QUFDQTtBQUNBO0FBQ0E7QUFqQ0k7QUFDQTtBQUNBO0FBQ0E7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBbUNoQjtBQWpDWTtBQW1DWjtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0k7QUFtQ1I7QUFqQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCQTtBQUNJO0FBQ1E7QUE4Qlo7QUE1QlE7QUE4QlI7QUE1Qkk7QUFDSTtBQUNJO0FBQ0E7QUE4Qlo7QUE1QlE7QUE4QlI7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBNUJBO0FBQ0k7QUFDUTtBQThCWjtBQTVCUTtBQThCUjtBQTVCSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUE4Qlo7QUE1QlE7QUE4QlI7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUE1QkE7QUFDSTtBQUNBO0FBOEJKO0FBQ0E7QUE1QkE7QUE4QkE7QUFDQTtBQTlCSTtBQUNJO0FBZ0NSO0FBOUJJO0FBZ0NKO0FBQ0E7QUE5QkE7QUFnQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0E7QUFDSTtBQW1DUjtBQWpDUTtBQUNBO0FBQ0E7QUFDSTtBQW1DWjtBQUNBO0FBakNRO0FBQ0k7QUFtQ1o7QUFDQTtBQWpDUTtBQW1DUjtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQW1DQTtBQWpDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFtQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6eURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQUNBO0FBRFE7QUFDQTtBQUdSO0FBRFE7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUdwQjtBQUNBO0FBQ0E7QUFDQTtBQURRO0FBR1I7QUFDQTtBQURJO0FBR0o7QUFEUTtBQUdSO0FBRFE7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUdWO0FBRFU7QUFHVjtBQUNBO0FBRFE7QUFDQTtBQUNFO0FBQ0E7QUFHVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakVBO0FBQ0U7QUFDQTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNJO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ047QUFDSTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFBSTtBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQUk7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNFO0FBQ0U7QUFFSjtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0U7QUFDRTtBQUdKO0FBQ0E7QUFGSTtBQUlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0U7QUFDRTtBQUlKO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQ0U7QUFDRTtBQUtKO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0U7QUFDRTtBQU1KO0FBQ0E7QUFKRTtBQUNFO0FBTUo7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0U7QUFDRTtBQU1KO0FBQ0E7QUFKRTtBQUNFO0FBTUo7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQU5RO0FBQ0k7QUFRWjtBQU5RO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBTlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUVI7QUFOUTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBTmdCO0FBQ0k7QUFRcEI7QUFOZ0I7QUFRaEI7QUFMZ0I7QUFDQTtBQUNJO0FBQ0E7QUFPcEI7QUFMZ0I7QUFPaEI7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNFO0FBQ0U7QUFNSjtBQUNBO0FBSkU7QUFDRTtBQU1KO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNZO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBR0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUdJO0FBREo7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQURRO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUdSO0FBRFE7QUFDSTtBQUNJO0FBR2hCO0FBQ0E7QUFEWTtBQUNJO0FBR2hCO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUdSO0FBRFE7QUFDQTtBQUNJO0FBR1o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQUNBO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFHUjtBQURRO0FBQ0E7QUFDSTtBQUdaO0FBRFE7QUFDSTtBQUdaO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEWTtBQUdaO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDSTtBQUVaO0FBQWdCO0FBRWhCO0FBQVk7QUFDQTtBQUVaO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuT0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBQ0E7QUFHWTtBQURaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFDQTtBQUVRO0FBQ0k7QUFDSTtBQUFoQjtBQUVnQjtBQUFoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNNO0FBQ047QUFDTTtBQUNFO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDRTtBQUNFO0FBQ1Y7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ1U7QUFDVjtBQUNBO0FBQ1E7QUFDRTtBQUNBO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFvRDtBQUU1RDtBQURRO0FBQWtFO0FBSTFFO0FBSFE7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQW9EO0FBTTVEO0FBTFE7QUFBa0U7QUFRMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEk7QUFDSTtBQUNJO0FBU1o7QUFDQTtBQVBRO0FBU1I7QUFQSTtBQUNJO0FBQ0k7QUFTWjtBQVBRO0FBQ0k7QUFTWjtBQVBZO0FBQ0k7QUFTaEI7QUFQZ0I7QUFTaEI7QUFDQTtBQUNBO0FBUEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBU1o7QUFDQTtBQVBRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUFE7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQVNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBU1o7QUFDQTtBQVBRO0FBQ0E7QUFTUjtBQUNBO0FBUEk7QUFTSjtBQUNBO0FBVFE7QUFDSTtBQVdaO0FBVFE7QUFDSTtBQVdaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUSTtBQUNJO0FBQ0k7QUFXWjtBQUNBO0FBVFE7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQVdKO0FBQ0E7QUFYUTtBQUNJO0FBYVo7QUFDQTtBQVhRO0FBQ0k7QUFhWjtBQUNBO0FBWEk7QUFDSTtBQUNJO0FBYVo7QUFYUTtBQUNLO0FBYWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhJO0FBQ0k7QUFhUjtBQVhRO0FBQ0k7QUFhWjtBQUNBO0FBQ0E7QUFDQTtBQVhJO0FBQ0k7QUFhUjtBQUNBO0FBWEk7QUFDSTtBQUNJO0FBYVo7QUFYUTtBQUNJO0FBYVo7QUFYUTtBQUNBO0FBYVI7QUFDQTtBQVhJO0FBQ0k7QUFhUjtBQUNBO0FBWEk7QUFhSjtBQUNBO0FBYlE7QUFDSTtBQWVaO0FBQ0E7QUFiUTtBQUNBO0FBZVI7QUFDQTtBQWJJO0FBQ0k7QUFDSTtBQWVaO0FBQ0E7QUFiUTtBQUNBO0FBZVI7QUFDQTtBQUNBO0FBYkk7QUFDSTtBQUNJO0FBZVo7QUFDQTtBQWJRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFDQTtBQVpRO0FBQ0k7QUFjWjtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBVlE7QUFZUjtBQVZRO0FBWVI7QUFWUTtBQVlSO0FBVlk7QUFZWjtBQVZZO0FBWVo7QUFWeUQ7QUFZekQ7QUFDQTtBQVhRO0FBYVI7QUFYUTtBQUE4QztBQWN0RDtBQWQ0RztBQWdCNUc7QUFDQTtBQWZRO0FBaUJSO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZnQjtBQWlCaEI7QUFmZ0I7QUFpQmhCO0FBZmdCO0FBaUJoQjtBQWZvQjtBQUFVO0FBa0I5QjtBQUNBO0FBakJvQjtBQW1CcEI7QUFqQm9CO0FBbUJwQjtBQWpCb0I7QUFtQnBCO0FBakJvQjtBQW1CcEI7QUFDQTtBQWhCZ0I7QUFrQmhCO0FBQ0E7QUFmWTtBQWlCWjtBQUNBO0FBZlE7QUFDQTtBQUNBO0FBaUJSO0FBZlE7QUFpQlI7QUFmUTtBQUNBO0FBQ0E7QUFpQlI7QUFDQTtBQWZRO0FBQ0E7QUFDQTtBQWlCUjtBQUNBO0FBZlE7QUFDQTtBQWlCUjtBQWRRO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFnQlo7QUFiWTtBQWVaO0FBQ0E7QUFDQTtBQVpJO0FBY0o7QUFaUTtBQWNSO0FBWlE7QUFjUjtBQVpRO0FBY1I7QUFaUTtBQWNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBY2hCO0FBWmdCO0FBY2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkk7QUFDSTtBQUNJO0FBY1o7QUFaUTtBQUNBO0FBQ0E7QUFDQTtBQWNSO0FBQ0E7QUFaUTtBQUNBO0FBQ0E7QUFDQTtBQUF5QztBQWVqRDtBQWRRO0FBQXVDO0FBaUIvQztBQWhCUTtBQWtCUjtBQUNBO0FBaEJRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUF5QztBQW1CakQ7QUFsQlE7QUFBdUM7QUFxQi9DO0FBcEJRO0FBc0JSO0FBcEJRO0FBQ0E7QUFzQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkJJO0FBQ0k7QUFDSTtBQXFCWjtBQUNBO0FBbkJRO0FBcUJSO0FBbkJRO0FBcUJSO0FBbkJRO0FBQStDO0FBc0J2RDtBQUNBO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJZO0FBdUJaO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQXJCZ0I7QUF1QmhCO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQXJCZ0I7QUF1QmhCO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQUNBO0FBcEJZO0FBc0JaO0FBQ0E7QUFDQTtBQUNBO0FBbEJJO0FBQ0k7QUFDSTtBQW9CWjtBQUNBO0FBbEJRO0FBQ0E7QUFvQlI7QUFDQTtBQWxCSTtBQUNJO0FBQ0k7QUFvQlo7QUFDQTtBQWxCUTtBQUNBO0FBb0JSO0FBQ0E7QUFsQkk7QUFDSTtBQUNJO0FBb0JaO0FBQ0E7QUFsQlE7QUFDQTtBQW9CUjtBQUNBO0FBbEJJO0FBQ0k7QUFDSTtBQW9CWjtBQWxCUTtBQUNBO0FBb0JSO0FBQ0E7QUFsQkk7QUFDSTtBQUNJO0FBb0JaO0FBbEJRO0FBQ0E7QUFvQlI7QUFsQlE7QUFvQlI7QUFDQTtBQWxCSTtBQUNJO0FBb0JSO0FBQ0E7QUFsQkk7QUFDSTtBQW9CUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQU07QUFDQTtBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQU07QUFFTjtBQUFNO0FBQ0E7QUFDQTtBQUNBO0FBRU47QUFBVTtBQUVWO0FBQVE7QUFFUjtBQUNBO0FBQUk7QUFDRTtBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNoQjtBQUVnQjtBQUNBO0FBQ0E7QUFBaEI7QUFDQTtBQUVRO0FBQVI7QUFDWTtBQUNJO0FBQ0E7QUFDQTtBQUNoQjtBQUVnQjtBQUNBO0FBQ0E7QUFBaEI7QUFFWTtBQUFaO0FBQ0E7QUFFSTtBQUFKO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDSTtBQUNaO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFBWTtBQUNBO0FBRVo7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUFNO0FBQ0U7QUFDQTtBQUVSO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBRFk7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFFSjtBQURNO0FBQ0E7QUFDQTtBQUdOO0FBREk7QUFHSjtBQUZNO0FBQ0E7QUFDRTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBSVY7QUFGUTtBQUNFO0FBSVY7QUFGUTtBQUlSO0FBQ0E7QUFGSTtBQUlKO0FBSE07QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBS1I7QUFIUTtBQUNBO0FBS1I7QUFITTtBQUtOO0FBSEk7QUFLSjtBQUNBO0FBSEk7QUFDRTtBQUtOO0FBSE07QUFDQTtBQUtOO0FBSE07QUFDQTtBQUtOO0FBSE07QUFDQTtBQUtOO0FBQ0E7QUFISTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBS1I7QUFDQTtBQUhNO0FBQ0U7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUhJO0FBS0o7QUFESTtBQUNFO0FBQ0U7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0xBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDQTtBQUdJO0FBQ0U7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0o7QUFDTTtBQUNFO0FBQ0E7QUFDQTtBQUNSO0FBQ007QUFDTjtBQUNJO0FBQ0E7QUFDRTtBQUNFO0FBQ1I7QUFDTTtBQUNBO0FBQ0U7QUFDUjtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDTTtBQUNBO0FBQ047QUFBUTtBQUVSO0FBQU07QUFFTjtBQUFNO0FBQ0U7QUFFUjtBQUFNO0FBQ0E7QUFDRTtBQUNFO0FBRVY7QUFDQTtBQUFNO0FBRU47QUFBSTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBRVI7QUFDQTtBQUFNO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0M7QUFDQztBQUNBO0FBRUY7QUFBRztBQUNDO0FBQ0E7QUFDQTtBQUVKO0FBQUc7QUFFSDtBQUFFO0FBQ0E7QUFDQztBQUNDO0FBRUo7QUFBRztBQUNBO0FBQ0M7QUFFSjtBQUFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBRUo7QUFBSztBQUNBO0FBRUw7QUFETTtBQUdOO0FBQ0E7QUFDQTtBQURHO0FBQ0E7QUFDQTtBQUNDO0FBR0o7QUFERztBQUNBO0FBQ0M7QUFDQztBQUdMO0FBQ0E7QUFERztBQUdIO0FBREU7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUdKO0FBQ0E7QUFERztBQUdIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSEE7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNFO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNFO0FBQ0E7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQURSO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBREo7QUFDQTtBQUdZO0FBQ0E7QUFDQTtBQUNBO0FBRFo7QUFDQTtBQUNBO0FBR1k7QUFEWjtBQUdZO0FBQ0k7QUFEaEI7QUFHWTtBQUNJO0FBRGhCO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDQTtBQUNJO0FBQVE7QUFBeUI7QUFBa0I7QUFDM0M7QUFBMEI7QUFBa0I7QUFFeEQ7QUFFUjtBQUNBO0FBQUk7QUFFSjtBQURRO0FBQ0k7QUFDSTtBQUdoQjtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUdKO0FBRFE7QUFHUjtBQURRO0FBR1I7QUFEUTtBQUErQztBQUl2RDtBQUNBO0FBSFE7QUFLUjtBQUhJO0FBS0o7QUFIWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS1o7QUFIWTtBQUNJO0FBS2hCO0FBSFk7QUFDSTtBQUtoQjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFBK0I7QUFNdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBQ0E7QUFBK0M7QUFRdkQ7QUFDQTtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFk7QUFTWjtBQVBZO0FBU1o7QUFQWTtBQVNaO0FBUGdCO0FBU2hCO0FBQ0E7QUFOZ0I7QUFRaEI7QUFDQTtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUtKO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFIUTtBQUErQztBQU12RDtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBQStEO0FBUXZFO0FBQ0E7QUFQUTtBQUE4RDtBQVV0RTtBQUNBO0FBVFE7QUFBNEQ7QUFZcEU7QUFDQTtBQVhRO0FBQTBEO0FBY2xFO0FBQ0E7QUFiUTtBQWVSO0FBYnlEO0FBZXpEO0FBZnlHO0FBaUJ6RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmUTtBQUNBO0FBaUJSO0FBZlE7QUFpQlI7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQUNBO0FBaEJZO0FBQ0k7QUFrQmhCO0FBaEJvQjtBQWtCcEI7QUFoQm9CO0FBa0JwQjtBQWhCb0I7QUFrQnBCO0FBaEJ3QjtBQWtCeEI7QUFoQndCO0FBa0J4QjtBQWhCd0I7QUFrQnhCO0FBaEI0QjtBQWtCNUI7QUFoQjRCO0FBa0I1QjtBQWhCNEI7QUFrQjVCO0FBaEI0QjtBQWtCNUI7QUFoQjRCO0FBa0I1QjtBQWhCNEI7QUFrQjVCO0FBQ0E7QUFDQTtBQUNBO0FBZGdCO0FBZ0JoQjtBQWRnQjtBQWdCaEI7QUFkb0I7QUFnQnBCO0FBZG9CO0FBZ0JwQjtBQWRvQjtBQWdCcEI7QUFkb0I7QUFnQnBCO0FBZG9CO0FBZ0JwQjtBQWR3QjtBQWdCeEI7QUFkd0I7QUFnQnhCO0FBQ0E7QUFDQTtBQWJnQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFlNUI7QUFiNEI7QUFlNUI7QUFid0I7QUFDSTtBQWU1QjtBQUNBO0FBYm9CO0FBQ0k7QUFDQTtBQWV4QjtBQUNBO0FBQ0E7QUFiZ0I7QUFDSTtBQUNBO0FBQ0E7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFDQTtBQUNBO0FBWlk7QUFjWjtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBQ0E7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFk7QUFhWjtBQVhnQjtBQWFoQjtBQVhnQjtBQWFoQjtBQVhnQjtBQWFoQjtBQVhnQjtBQWFoQjtBQUNBO0FBQ0E7QUFUUTtBQVdSO0FBVFE7QUFXUjtBQVRRO0FBV1I7QUFUUTtBQVdSO0FBQ0E7QUFSSTtBQUNJO0FBQ0E7QUFVUjtBQUNBO0FBUkk7QUFDSTtBQUNJO0FBVVo7QUFSWTtBQUNJO0FBVWhCO0FBQ0E7QUFSa0I7QUFVbEI7QUFDQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBUkk7QUFDRTtBQUNJO0FBVVY7QUFDQTtBQVJVO0FBVVY7QUFDQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJnQjtBQUNJO0FBQ0E7QUFFSTtBQUVJO0FBUTVCO0FBTndCO0FBRUk7QUFPNUI7QUFDQTtBQUxvQjtBQU9wQjtBQUNBO0FBTGdCO0FBQ0k7QUFPcEI7QUFMb0I7QUFDSTtBQU94QjtBQUNBO0FBTG9CO0FBT3BCO0FBQ0E7QUFDQTtBQUNBO0FBTmdCO0FBUWhCO0FBTm9CO0FBUXBCO0FBQ0E7QUFDQTtBQU5vQjtBQUNJO0FBUXhCO0FBQ0E7QUFOb0I7QUFDSTtBQUNJO0FBUTVCO0FBTjRCO0FBUTVCO0FBQ0E7QUFDQTtBQU5vQjtBQVFwQjtBQUNBO0FBTmdCO0FBQ0k7QUFRcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTm9CO0FBQ0k7QUFReEI7QUFDQTtBQU5vQjtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBUXhCO0FBTndCO0FBQ0k7QUFDQTtBQVE1QjtBQU53QjtBQUNJO0FBUTVCO0FBQ0E7QUFDQTtBQU5vQjtBQVFwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5RO0FBQ0E7QUFRUjtBQU5RO0FBQ0E7QUFDSTtBQVFaO0FBQ0E7QUFOUTtBQVFSO0FBTlE7QUFRUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JnQkE7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDRTtBQUNBO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFDRTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNFO0FBRFI7QUFDQTtBQUdNO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRE47QUFHTTtBQUNBO0FBQ0E7QUFETjtBQUNBO0FBR0k7QUFDRTtBQUNBO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkRBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFDRTtBQURWO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUdRO0FBQ0U7QUFEVjtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBRFY7QUFDQTtBQUNBO0FBR1E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQURWO0FBQ0E7QUFDQTtBQUdRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBR1E7QUFDRTtBQURWO0FBQ0E7QUFHUTtBQUNFO0FBRFY7QUFDQTtBQUdJO0FBQ0U7QUFETjtBQUNBO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUdRO0FBQ0E7QUFDRTtBQURWO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFLSTtBQUNJO0FBSFI7QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFLSTtBQUNFO0FBSE47QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUdBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUdRO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQURaO0FBR1E7QUFDSTtBQUNJO0FBRGhCO0FBQ0E7QUFHUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBRFo7QUFHUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEWjtBQUNBO0FBSUk7QUFGSjtBQUdRO0FBRFI7QUFjSTtBQVpKO0FBYVE7QUFYUjtBQXdCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0QlI7QUFDQTtBQXdCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQXRCWjtBQXdCWTtBQXRCWjtBQUNBO0FBd0JRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0QlI7QUF3QlE7QUFDQTtBQUNBO0FBQ0E7QUF0QlI7QUFDQTtBQXNCUTtBQXBCUjtBQXNCUTtBQXBCUjtBQXNCUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcEJaO0FBc0JRO0FBQ0k7QUFwQlo7QUFzQlE7QUFDSTtBQXBCWjtBQXNCUTtBQUdBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQXRCaEI7QUF3Qlk7QUFDSTtBQXRCaEI7QUFDQTtBQUNBO0FBd0JRO0FBQ0E7QUF0QlI7QUFDQTtBQXlCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUF2Qlo7QUF5QlE7QUFDSTtBQUNBO0FBQ0E7QUF2Qlo7QUF5QlE7QUF2QlI7QUF3Qlk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQXRCaEI7QUF3Qlk7QUFDSTtBQUNBO0FBdEJoQjtBQUNBO0FBeUJRO0FBQ0k7QUF2Qlo7QUF5QlE7QUFDSTtBQXZCWjtBQXlCUTtBQUNBO0FBdkJSO0FBQ0E7QUEwQkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBeEJaO0FBMEJRO0FBQ0k7QUF4Qlo7QUEyQlk7QUF6Qlo7QUE0Qlk7QUExQlo7QUE2Qlk7QUEzQlo7QUE2QlE7QUFDSTtBQUNBO0FBM0JaO0FBNkJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzQmhCO0FBNkJnQjtBQTNCaEI7QUFDQTtBQTZCUTtBQUNBO0FBM0JSO0FBQ0E7QUFDQTtBQThCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJSO0FBOEJRO0FBNUJSO0FBQ0E7QUE0QlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCWjtBQTRCUTtBQUNJO0FBMUJaO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUExQmhCO0FBNEJZO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCaEI7QUFDQTtBQTRCUTtBQUNBO0FBMUJSO0FBQ0E7QUE0Qkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBMUJSO0FBQ0E7QUFDQTtBQTRCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCUjtBQTRCUTtBQUNJO0FBMUJaO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBMUJaO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBMUJoQjtBQUNBO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCWjtBQTRCUTtBQUNBO0FBMUJSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6WEE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0k7QUFDSjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBRFE7QUFDSTtBQUFRO0FBQVk7QUFDWjtBQUFZO0FBQ1o7QUFBWTtBQUNaO0FBQVk7QUFFeEI7QUFDSTtBQUFRO0FBQVk7QUFDWjtBQUFZO0FBQ1o7QUFBWTtBQUV4QjtBQUNJO0FBQVE7QUFDUjtBQUFRO0FBQVk7QUFFeEI7QUFZUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFETjtBQUdNO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFEVjtBQUdRO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDSztBQUNHO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ1E7QUFDUjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEdBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDWjtBQUNRO0FBQ0M7QUFDVDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ2hCO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDSTtBQUNJO0FBRFo7QUFHUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBRHBCO0FBR29CO0FBQ0E7QUFEcEI7QUFHb0I7QUFDQTtBQURwQjtBQUdnQjtBQUNBO0FBQ0k7QUFEcEI7QUFDQTtBQUdRO0FBQ0k7QUFEWjtBQUNBO0FBR1k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQURwQjtBQUdnQjtBQUNBO0FBRGhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBRlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZFQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUtBO0FBQ0k7QUFIUjtBQUtJO0FBQ0k7QUFDQTtBQUNFO0FBSFY7QUFLUTtBQUhSO0FBS0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBSGhCO0FBS1k7QUFDQTtBQUNBO0FBSFo7QUFDQTtBQUtJO0FBSEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Y7QUFFRTtBQUNFO0FBQ0E7QUFDRTtBQUFOO0FBRUk7QUFBSjtBQUNBO0FBRUU7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUFOO0FBRUk7QUFBSjtBQUNBO0FBRUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQU47QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUNNO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQU07QUFDRTtBQUNBO0FBRVI7QUFDQTtBQUNBO0FBQUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVGO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ1Y7QUFDVTtBQUNFO0FBQ0E7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNBO0FBQ0U7QUFDTjtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBQ047QUFFTTtBQUFOO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFHRTtBQUNFO0FBREo7QUFHSTtBQUNFO0FBRE47QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqVkE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ1E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNoQjtBQUNZO0FBQ0k7QUFDaEI7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUNRO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDQTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ0k7QUFDQTtBQUNoQjtBQUNZO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDaEI7QUFDQTtBQUNZO0FBQ0k7QUFDaEI7QUFDQTtBQUNnQjtBQUNBO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNBO0FBQ1k7QUFDSTtBQUNoQjtBQUNBO0FBQ2dCO0FBQ0E7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBRVE7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVZO0FBQ0E7QUFBWjtBQUNBO0FBQ0E7QUFHSTtBQURKO0FBQ0E7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUFZO0FBQ0k7QUFFaEI7QUFBWTtBQUVaO0FBQVk7QUFDSTtBQUVoQjtBQUFZO0FBQ0E7QUFFWjtBQUNBO0FBRFk7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUdaO0FBRFE7QUFDSTtBQUdaO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ0k7QUFHeEI7QUFDQTtBQUNBO0FBQ0E7QUFEZ0I7QUFDSTtBQUNJO0FBR3hCO0FBQ0E7QUFDQTtBQUNBO0FBQVE7QUFDQTtBQUVSO0FBQVE7QUFFUjtBQUFJO0FBQ0k7QUFDSTtBQUVaO0FBQ0E7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFEUTtBQUdSO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUNFO0FBQ0E7QUFHUjtBQUNBO0FBRE07QUFDQTtBQUdOO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFIUTtBQUNJO0FBS1o7QUFITTtBQUtOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBSVI7QUFGUTtBQUlSO0FBSFk7QUFLWjtBQUhRO0FBS1I7QUFIUTtBQUNBO0FBQ0E7QUFDQTtBQUtSO0FBSFE7QUFLUjtBQUNBO0FBSFE7QUFDQTtBQUNJO0FBS1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBS1I7QUFDQTtBQUZJO0FBSUo7QUFGUTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUlSO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFJUjtBQUNBO0FBRkk7QUFJSjtBQUZRO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFJSjtBQUZNO0FBQ0U7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUZRO0FBQ0k7QUFJWjtBQUNBO0FBSFk7QUFLWjtBQUhRO0FBS1I7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNJO0FBSVo7QUFGTTtBQUNFO0FBQ0E7QUFJUjtBQUNBO0FBQ0E7QUFGTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUlkO0FBQ0E7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUlSO0FBQ0E7QUFGSTtBQUNJO0FBSVI7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBQ0U7QUFDQTtBQUlWO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUlaO0FBRmdCO0FBQ0E7QUFJaEI7QUFDQTtBQUNBO0FBRlE7QUFDSTtBQUNJO0FBQ0E7QUFJaEI7QUFGZ0I7QUFJaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZJO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBRkk7QUFDRTtBQUNJO0FBQ0E7QUFJVjtBQUZNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJTjtBQUNBO0FBRkk7QUFDRTtBQUNJO0FBSVY7QUFDQTtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBSWhCO0FBQ0E7QUFDQTtBQUZRO0FBQ0k7QUFDQTtBQUNBO0FBSVo7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFJWjtBQUZRO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNJO0FBSVo7QUFDQTtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBRUk7QUFDQTtBQUNJO0FBR2hCO0FBQ0E7QUFDQTtBQURRO0FBQ0k7QUFDQTtBQUNBO0FBR1o7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFHWjtBQURRO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUdaO0FBRFk7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3cUJBO0FBQ0k7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNBO0FBQ1E7QUFDUjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQU07QUFDQTtBQUVOO0FBQU07QUFDRTtBQUNBO0FBRVI7QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNFO0FBQ0E7QUFFRTtBQUNWO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ1Y7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUZBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNNO0FBQ0E7QUFDRTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNBO0FBRUU7QUFBVjtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQ0U7QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFSTtBQUNBO0FBQUo7QUFFUTtBQUNBO0FBQ0E7QUFBUjtBQUVRO0FBQ0E7QUFDQTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBRVk7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBRVE7QUFDQTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFWTtBQUFaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVvQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQXhCO0FBRW9CO0FBQ0k7QUFDSTtBQUNBO0FBQTVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR29CO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFEeEI7QUFHb0I7QUFDSTtBQUNJO0FBQ0E7QUFENUI7QUFDQTtBQUNBO0FBQ0E7QUFJYztBQUNBO0FBRmQ7QUFDQTtBQUNBO0FBQ0E7QUFJYztBQUNJO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFGeEI7QUFJc0I7QUFDQTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFGOUI7QUFJOEI7QUFGOUI7QUFJNEI7QUFGNUI7QUFJNEI7QUFGNUI7QUFDQTtBQUNBO0FBSWtCO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFGdEI7QUFLc0I7QUFDQTtBQUh0QjtBQUtvQjtBQUNFO0FBSHRCO0FBS3NCO0FBQ0E7QUFIdEI7QUFDQTtBQU1vQjtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFKaEM7QUFNZ0M7QUFKaEM7QUFNOEI7QUFKOUI7QUFNOEI7QUFKOUI7QUFDQTtBQU13QjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBSmxDO0FBQ0E7QUFLc0M7QUFDQTtBQUNJO0FBQ0E7QUFIMUM7QUFDQTtBQUNBO0FBS2dDO0FBSGhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBSHBCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQU1RO0FBQ0k7QUFDQTtBQUNJO0FBSmhCO0FBTVk7QUFDSTtBQUpoQjtBQU1ZO0FBSlo7QUFDQTtBQU1RO0FBQ0E7QUFFSTtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBTmhCO0FBU2dCO0FBUGhCO0FBVWdCO0FBUmhCO0FBQ0E7QUFVUTtBQVJSO0FBVUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSUjtBQVVJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFSWjtBQVVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQVJaO0FBVVk7QUFDRTtBQUNFO0FBUmhCO0FBQ0E7QUFDQTtBQUNBO0FBV2U7QUFUZjtBQVVtQjtBQUNBO0FBQ0c7QUFSdEI7QUFVc0I7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQVIxQjtBQVV3QjtBQUNBO0FBUnhCO0FBQ0E7QUFVb0I7QUFDRDtBQUNLO0FBUnhCO0FBV3dCO0FBVHhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVlRO0FBVlI7QUFZUTtBQUNHO0FBQ0E7QUFDQTtBQVZYO0FBV2U7QUFUZjtBQUNBO0FBV1E7QUFUUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBY0k7QUFFSTtBQUNBO0FBQ0E7QUFiUjtBQWVRO0FBQ0E7QUFiUjtBQWVRO0FBQ0E7QUFFSTtBQUNBO0FBQ0E7QUFkWjtBQUNBO0FBZ0JRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFkaEI7QUFpQmdCO0FBQ0E7QUFDQTtBQUNBO0FBZmhCO0FBa0JnQjtBQUNBO0FBQ0E7QUFDQTtBQWhCaEI7QUFtQmdCO0FBQ0E7QUFDQTtBQUNBO0FBakJoQjtBQW9CZ0I7QUFDQztBQUNEO0FBQ0E7QUFsQmhCO0FBb0JnQjtBQUNDO0FBQ0Q7QUFDQTtBQWxCaEI7QUFDQTtBQW9CUztBQUVJO0FBQ0k7QUFuQmpCO0FBQ0E7QUFDQTtBQXFCSTtBQUNJO0FBQ0E7QUFDQTtBQW5CUjtBQXFCSTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFuQlI7QUFDQTtBQXFCSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBbkJOO0FBQ0E7QUFxQlE7QUFuQlI7QUFxQk07QUFDRTtBQUNBO0FBbkJSO0FBcUJNO0FBbkJOO0FBcUJJO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBK0I7QUFsQnpDO0FBbUJVO0FBQ0E7QUFDQTtBQUNBO0FBakJWO0FBQ0E7QUFtQkk7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQWpCaEI7QUFtQlk7QUFDQTtBQWpCWjtBQW1CWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJaO0FBQ0E7QUFtQkk7QUFDRTtBQUNFO0FBQ0E7QUFqQlI7QUFtQk07QUFDQTtBQWpCTjtBQUNBO0FBbUJJO0FBQ0k7QUFDQTtBQUNBO0FBakJSO0FBQ0E7QUFtQkk7QUFDSTtBQWpCUjtBQW1CUTtBQWpCUjtBQUNBO0FBbUJJO0FBQ0U7QUFqQk47QUFDQTtBQW1CSTtBQUNJO0FBakJSO0FBQ0E7QUFtQkk7QUFqQko7QUFtQlE7QUFDQTtBQWpCUjtBQW1CUTtBQWpCUjtBQUNBO0FBbUJJO0FBQ0k7QUFDSTtBQUNBO0FBakJaO0FBQ0E7QUFDQTtBQUNBO0FBb0JnQjtBQUNBO0FBbEJoQjtBQUNBO0FBQ0E7QUFvQlE7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQWxCVjtBQW9CUTtBQWxCUjtBQW9CWTtBQWxCWjtBQW9CVTtBQUNFO0FBbEJaO0FBQ0E7QUFtQlk7QUFqQlo7QUFDQTtBQUNBO0FBQ0E7QUFvQkk7QUFFSTtBQUNBO0FBbkJSO0FBQ0E7QUFxQkk7QUFuQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXFCUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFuQlI7QUFDQTtBQXNCSTtBQUNJO0FBQ0U7QUFDRTtBQXBCWjtBQXNCWTtBQUNBO0FBcEJaO0FBc0JRO0FBQ0E7QUFDQTtBQXBCUjtBQUNBO0FBc0JRO0FBQ0E7QUFwQlI7QUFDQTtBQXNCSTtBQUNJO0FBQ0k7QUFwQlo7QUFDQTtBQUNBO0FBc0JJO0FBQ0k7QUFwQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ2psQkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1Q0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ1M7QUFDVDtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ3BCO0FBQ29CO0FBQ3BCO0FBQ2dCO0FBQ2hCO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSjtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFHUjtBQURRO0FBQ0k7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQURRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUdaO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUdaO0FBQ0E7QUFEWTtBQUdaO0FBQ0E7QUFBUTtBQUVSO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ1o7QUFBZ0I7QUFDQTtBQUNBO0FBRWhCO0FBRG9CO0FBQ0k7QUFHeEI7QUFEd0I7QUFHeEI7QUFDQTtBQURvQjtBQUdwQjtBQUNBO0FBQ0E7QUFGZ0I7QUFDQTtBQUloQjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBSVo7QUFGUztBQUlUO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUlSO0FBRlE7QUFDQTtBQUlSO0FBRlE7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUlwQjtBQUNBO0FBRlk7QUFDQTtBQUlaO0FBQ0E7QUFDQTtBQUZJO0FBSUo7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlSO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlSO0FBRlE7QUFDQTtBQUNBO0FBSVI7QUFGUTtBQUNBO0FBQ0E7QUFJUjtBQUZRO0FBQ0k7QUFDSTtBQUloQjtBQUZZO0FBQ0k7QUFJaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUVKO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFDQTtBQUVRO0FBQ0k7QUFBWjtBQUNBO0FBRVE7QUFBUjtBQUVRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVo7QUFDQTtBQUVRO0FBQXlCO0FBQ2pDO0FBQ0E7QUFBUTtBQUNJO0FBQ0k7QUFFaEI7QUFDQTtBQUNBO0FBQVE7QUFFUjtBQUFRO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQVk7QUFFWjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUFaO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQURKO0FBRVE7QUFBUjtBQUNZO0FBQ0k7QUFDaEI7QUFDZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUFRO0FBRVI7QUFEWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBR1I7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBQ0E7QUFHWjtBQUNBO0FBRFE7QUFDSTtBQUdaO0FBRGdCO0FBR2hCO0FBRFk7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUTtBQUNJO0FBQ0k7QUFDQTtBQUdoQjtBQURnQjtBQUdoQjtBQURZO0FBR1o7QUFEUTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBR2hCO0FBRGdCO0FBR2hCO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBRVI7QUFBSztBQUVMO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFWjtBQUFZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFWjtBQUFZO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFFaEI7QUFDQTtBQUFZO0FBQ0k7QUFDSTtBQUVwQjtBQUFnQjtBQUNJO0FBRXBCO0FBQ0E7QUFDQTtBQUFRO0FBQ0s7QUFFYjtBQUFZO0FBQ0k7QUFFaEI7QUFDQTtBQUFnQjtBQUVoQjtBQUNBO0FBQ0E7QUFDQTtBQUFJO0FBRUo7QUFBUTtBQUNJO0FBQ0E7QUFFWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBRVo7QUFDQTtBQURZO0FBQ0E7QUFHWjtBQUNBO0FBQ0E7QUFESTtBQUdKO0FBRFE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1o7QUFEUTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBRFk7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQURZO0FBQ0E7QUFDQTtBQUdaO0FBRFk7QUFDSTtBQUdoQjtBQUNBO0FBRGdCO0FBQ0E7QUFHaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNJO0FBR1o7QUFEWTtBQUdaO0FBRFk7QUFHWjtBQURRO0FBR1I7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUhRO0FBS1I7QUFIUTtBQUNBO0FBQ0E7QUFLUjtBQUNBO0FBSEk7QUFDSTtBQUtSO0FBSEk7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUt4QjtBQUo0QjtBQUNBO0FBQ0k7QUFNaEM7QUFKZ0M7QUFNaEM7QUFDQTtBQUo0QjtBQU01QjtBQUxnQztBQU9oQztBQUxnQztBQU9oQztBQUNBO0FBTDRCO0FBQ0E7QUFDQTtBQUNBO0FBTzVCO0FBQ0E7QUFKd0I7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQU01QjtBQUo0QjtBQUNJO0FBTWhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpnQjtBQU1oQjtBQUxvQjtBQUNJO0FBT3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFPUjtBQU5ZO0FBUVo7QUFQZ0I7QUFFSTtBQUNBO0FBUXBCO0FBTm9CO0FBUXBCO0FBQ0E7QUFMZ0I7QUFPaEI7QUFDQTtBQUxZO0FBQ0k7QUFPaEI7QUFMZ0I7QUFPaEI7QUFDQTtBQUxZO0FBQ0E7QUFPWjtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBT0o7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBQ0k7QUFDQTtBQU9aO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQUFxQztBQVE3QztBQUNBO0FBUFE7QUFTUjtBQVBZO0FBU1o7QUFQWTtBQVNaO0FBUFk7QUFDSTtBQUNBO0FBU2hCO0FBQ0E7QUFDQTtBQUNBO0FBTlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVFSO0FBTlE7QUFRUjtBQU5RO0FBUVI7QUFOUTtBQVFSO0FBTlE7QUFDSTtBQUNBO0FBQ0k7QUFRaEI7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0k7QUFPWjtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFMUTtBQU9SO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUxRO0FBT1I7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0k7QUFPWjtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFDQTtBQUNBO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPUjtBQUxRO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQU9oQjtBQUNBO0FBTFE7QUFDQTtBQUNBO0FBT1I7QUFDQTtBQUNBO0FBTFE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQU9oQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMWTtBQU9aO0FBTFE7QUFPUjtBQUxRO0FBQ0E7QUFDSTtBQUNBO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBT1I7QUFDQTtBQUNBO0FBTEk7QUFPSjtBQUxRO0FBQ0k7QUFDSTtBQUNBO0FBT2hCO0FBSmdCO0FBQ0E7QUFNaEI7QUFIZ0I7QUFDQTtBQUtoQjtBQUZnQjtBQUNBO0FBSWhCO0FBRGdCO0FBQ0E7QUFHaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEZ0I7QUFHaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFHSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFHSjtBQUNBO0FBQ0E7QUFIUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFLWjtBQUhZO0FBS1o7QUFIUTtBQUNBO0FBQ0E7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUtKO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUNBO0FBSFE7QUFLUjtBQUNBO0FBSFE7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIWTtBQUtaO0FBQ0E7QUFDQTtBQUhnQjtBQUNJO0FBS3BCO0FBQ0E7QUFDQTtBQUNBO0FBSFE7QUFDSTtBQUNJO0FBQ0E7QUFLaEI7QUFIWTtBQUtaO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBTFE7QUFDQTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQUxRO0FBT1I7QUFMUTtBQUNBO0FBT1I7QUFDQTtBQUNBO0FBTFk7QUFDSTtBQU9oQjtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBT1I7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQU9SO0FBTEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT1I7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBRO0FBQ0E7QUFDSTtBQVNaO0FBUFE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBU2hCO0FBUFk7QUFTWjtBQVBZO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTaEI7QUFDQTtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBUVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5nQjtBQVFoQjtBQU5ZO0FBQ0E7QUFRWjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBUVo7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFRaEI7QUFOWTtBQVFaO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDSTtBQUNBO0FBT1o7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9SO0FBTFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT1I7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQU5nQjtBQUNJO0FBUXBCO0FBQ0E7QUFDQTtBQVBnQjtBQUNJO0FBU3BCO0FBUndCO0FBVXhCO0FBUndCO0FBVXhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSUTtBQUNJO0FBVVo7QUFUZ0I7QUFXaEI7QUFUZ0I7QUFXaEI7QUFDQTtBQUNBO0FBVFE7QUFXUjtBQVZZO0FBWVo7QUFYZ0I7QUFDQTtBQWFoQjtBQUNBO0FBWmdCO0FBQ0E7QUFjaEI7QUFDQTtBQUNBO0FBWlk7QUFjWjtBQWJnQjtBQUNBO0FBZWhCO0FBQ0E7QUFiZ0I7QUFDQTtBQWVoQjtBQUNBO0FBQ0E7QUFiUTtBQUNJO0FBZVo7QUFiUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFlaEI7QUFDQTtBQWJRO0FBQ0k7QUFDSTtBQWVoQjtBQWJnQjtBQWVoQjtBQUNBO0FBWlk7QUFjWjtBQVpRO0FBQ0E7QUFDQTtBQWNSO0FBQ0E7QUFaSTtBQUNJO0FBRUk7QUFhWjtBQUNBO0FBWFE7QUFBcUM7QUFjN0M7QUFDQTtBQWJRO0FBZVI7QUFiUTtBQWVSO0FBYlE7QUFBc0Q7QUFnQjlEO0FBQ0E7QUFmUTtBQWlCUjtBQWZZO0FBaUJaO0FBQ0E7QUFkUTtBQWdCUjtBQWRRO0FBZ0JSO0FBZFE7QUFnQlI7QUFkUTtBQWdCUjtBQWRZO0FBZ0JaO0FBQ0E7QUFDQTtBQVpJO0FBY0o7QUFaUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBY1I7QUFaSTtBQUNJO0FBY1I7QUFDQTtBQUNBO0FBWkk7QUFjSjtBQVpRO0FBQ0k7QUFDQTtBQWNaO0FBQ0E7QUFaUTtBQUNBO0FBQ0E7QUFjUjtBQVpRO0FBQ0k7QUFjWjtBQUNBO0FBQ0E7QUFaSTtBQUNJO0FBQ0E7QUFjUjtBQVpRO0FBQ0k7QUFjWjtBQUNBO0FBWlE7QUFjUjtBQVpRO0FBQ0k7QUFjWjtBQVpRO0FBY1I7QUFaSTtBQUNJO0FBQ0E7QUFjUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWlE7QUFDSTtBQUNJO0FBY2hCO0FBQ0E7QUFDQTtBQUNBO0FBWkk7QUFjSjtBQUNBO0FBQ0E7QUFDQTtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYWTtBQWFaO0FBWFk7QUFhWjtBQVhZO0FBYVo7QUFYWTtBQUF5RDtBQWNyRTtBQUNBO0FBYlk7QUFlWjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQUNBO0FBZG9CO0FBZ0JwQjtBQUNBO0FBYm9CO0FBZXBCO0FBQ0E7QUFiZ0I7QUFlaEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFDQTtBQUNBO0FBVlk7QUFZWjtBQVZZO0FBWVo7QUFWZ0I7QUFZaEI7QUFWb0I7QUFZcEI7QUFWb0I7QUFZcEI7QUFDQTtBQUNBO0FBQ0E7QUFSUTtBQVVSO0FBUlk7QUFVWjtBQVJZO0FBVVo7QUFSWTtBQVVaO0FBUlk7QUFVWjtBQVJZO0FBVVo7QUFSZ0I7QUFVaEI7QUFDQTtBQVRvQjtBQVdwQjtBQVRvQjtBQVdwQjtBQUNBO0FBVGdCO0FBV2hCO0FBQ0E7QUFSZ0I7QUFVaEI7QUFDQTtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBUVo7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUxZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQU9SO0FBTFE7QUFDSTtBQU9aO0FBQ0E7QUFMUTtBQUNBO0FBT1I7QUFDQTtBQUxJO0FBT0o7QUFMUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBT1I7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBT1I7QUFMUTtBQU9SO0FBQ0E7QUFMUTtBQUNJO0FBQ0E7QUFPWjtBQUNBO0FBTFE7QUFDQTtBQU9SO0FBTFk7QUFPWjtBQUNBO0FBTFE7QUFPUjtBQUNBO0FBTFE7QUFDSTtBQUNBO0FBT1o7QUFDQTtBQUpRO0FBTVI7QUFDQTtBQUNBO0FBQ0E7QUFKWTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBTWhCO0FBQ0E7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUNBO0FBSlE7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUpRO0FBTVI7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQU1SO0FBQ0E7QUFKUTtBQUNJO0FBQ0k7QUFNaEI7QUFDQTtBQUpZO0FBTVo7QUFDQTtBQUpRO0FBQ0k7QUFDQTtBQU1aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQU1SO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBSlE7QUFNUjtBQUpZO0FBTVo7QUFDQTtBQUpRO0FBTVI7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDSTtBQUNJO0FBTWhCO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQU1SO0FBQ0E7QUFKSTtBQUNJO0FBTVI7QUFKUTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFDQTtBQU1SO0FBSlE7QUFDQTtBQU1SO0FBSlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDSTtBQUNBO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBTVI7QUFDQTtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBQ0k7QUFLWjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFDSTtBQUtaO0FBQ0E7QUFIUTtBQUtSO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFDQTtBQUhRO0FBQ0k7QUFLWjtBQUhRO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFLUjtBQUNBO0FBSEk7QUFLSjtBQUhRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFLWjtBQUhRO0FBQ0k7QUFLWjtBQUNBO0FBSFk7QUFDSTtBQUtoQjtBQUhZO0FBQ0E7QUFDQTtBQUtaO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNJO0FBQ0E7QUFLWjtBQUNBO0FBSFE7QUFDSTtBQUNBO0FBS1o7QUFIUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtSO0FBQ0E7QUFIUTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBUTtBQUFtQjtBQUNuQjtBQUFtQjtBQUNuQjtBQUFtQjtBQUNuQjtBQUFtQjtBQUUvQjtBQUNJO0FBQVE7QUFBb0I7QUFDcEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDakI7QUFBbUI7QUFDbkI7QUFBb0I7QUFDcEI7QUFBb0I7QUFDcEI7QUFBb0I7QUFFakM7QUFzQlo7QUFDQTtBQXBCUTtBQUNJO0FBc0JaO0FBcEJZO0FBc0JaO0FBcEJZO0FBc0JaO0FBcEJRO0FBQ0k7QUFzQlo7QUFwQlk7QUFzQlo7QUFDQTtBQXBCUTtBQXNCUjtBQUNBO0FBQ0E7QUFDQTtBQXBCSTtBQUNJO0FBQ0k7QUFzQlo7QUFDQTtBQXBCUTtBQXNCUjtBQUNBO0FBQ0E7QUFwQkk7QUFDSTtBQUNJO0FBc0JaO0FBQ0E7QUFwQlE7QUFDSTtBQXNCWjtBQUNBO0FBcEJRO0FBc0JSO0FBQ0E7QUFDQTtBQXBCSTtBQUNJO0FBQ0k7QUFzQlo7QUFDQTtBQXBCUTtBQXNCUjtBQUNBO0FBbkJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBcUJaO0FBQ0E7QUFuQlE7QUFDQTtBQUFzRDtBQXNCOUQ7QUFyQlE7QUFDQTtBQUNJO0FBQ0E7QUF1Qlo7QUFDQTtBQUNBO0FBckJJO0FBdUJKO0FBckJRO0FBQ0k7QUFDQTtBQXVCWjtBQUNBO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJZO0FBdUJaO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQUNBO0FBQ0E7QUFwQlE7QUFzQlI7QUFwQlk7QUFzQlo7QUFwQmdCO0FBc0JoQjtBQXBCZ0I7QUFzQmhCO0FBQ0E7QUFuQlE7QUFDQTtBQXFCUjtBQW5CUTtBQUErQjtBQXNCdkM7QUFDQTtBQXJCUTtBQUErQjtBQXdCdkM7QUFDQTtBQXZCUTtBQUNJO0FBQStCO0FBMEIzQztBQUNBO0FBQ0E7QUF4QlE7QUEwQlI7QUF4QlE7QUEwQlI7QUF4Qlk7QUEwQlo7QUF4Qlk7QUEwQlo7QUFDQTtBQXZCUTtBQXlCUjtBQXZCUTtBQXlCUjtBQXZCUTtBQXlCUjtBQXZCUTtBQXlCUjtBQXZCUTtBQXlCUjtBQXZCUTtBQXlCUjtBQXZCWTtBQXlCWjtBQXZCZ0I7QUF5QmhCO0FBQ0E7QUF0Qlk7QUF3Qlo7QUF0Qlk7QUF3Qlo7QUFDQTtBQXJCUTtBQXVCUjtBQXJCWTtBQXVCWjtBQXJCZ0I7QUF1QmhCO0FBckJvQjtBQXVCcEI7QUFDQTtBQXBCZ0I7QUFzQmhCO0FBQ0E7QUFDQTtBQWxCUTtBQW9CUjtBQWxCUTtBQW9CUjtBQWxCWTtBQUErQjtBQXFCM0M7QUFDQTtBQXBCWTtBQXNCWjtBQUNBO0FBcEJRO0FBQ0k7QUFzQlo7QUFDQTtBQUNBO0FBcEJRO0FBc0JSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5CSTtBQUNJO0FBQXVFO0FBc0IvRTtBQUNBO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBQXFDO0FBd0I3QztBQUNBO0FBdkJRO0FBeUJSO0FBQ0E7QUF4Qlk7QUEwQlo7QUF4Qlk7QUEwQlo7QUF2QmdCO0FBeUJoQjtBQXZCZ0I7QUF5QmhCO0FBdkJnQjtBQXlCaEI7QUF2QmdCO0FBQ0E7QUFDSTtBQXlCcEI7QUFDQTtBQXZCZ0I7QUF5QmhCO0FBdkJnQjtBQXlCaEI7QUFDQTtBQUNBO0FBckJRO0FBQXFDO0FBd0I3QztBQUNBO0FBdkJRO0FBeUJSO0FBQ0E7QUF4Qlk7QUFBcUM7QUEyQmpEO0FBQ0E7QUExQlk7QUE0Qlo7QUExQlk7QUE0Qlo7QUFDQTtBQTNCZ0I7QUE2QmhCO0FBM0JnQjtBQTZCaEI7QUEzQmdCO0FBNkJoQjtBQUNBO0FBNUJvQjtBQThCcEI7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUE1QndCO0FBOEJ4QjtBQUNBO0FBM0JvQjtBQTZCcEI7QUFDQTtBQTFCZ0I7QUE0QmhCO0FBMUJnQjtBQTRCaEI7QUFDQTtBQXpCWTtBQTJCWjtBQXpCWTtBQTJCWjtBQUNBO0FBMUJnQjtBQTRCaEI7QUExQmdCO0FBNEJoQjtBQTFCZ0I7QUE0QmhCO0FBQ0E7QUF6Qlk7QUEyQlo7QUF6Qlk7QUFBaUM7QUE0QjdDO0FBQ0E7QUEzQlk7QUE2Qlo7QUFDQTtBQTVCZ0I7QUE4QmhCO0FBNUJnQjtBQThCaEI7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUFDQTtBQUNBO0FBNUJvQjtBQThCcEI7QUFDQTtBQTdCd0I7QUErQnhCO0FBQ0E7QUE3QjRCO0FBK0I1QjtBQTdCNEI7QUErQjVCO0FBN0I0QjtBQStCNUI7QUE3QjRCO0FBK0I1QjtBQTdCNEI7QUErQjVCO0FBN0I0QjtBQStCNUI7QUFDQTtBQTVCd0I7QUE4QnhCO0FBQ0E7QUFDQTtBQUNBO0FBM0JvQjtBQTZCcEI7QUFDQTtBQUNBO0FBekJZO0FBMkJaO0FBQ0E7QUFDQTtBQUNBO0FBMUJnQjtBQTRCaEI7QUExQmdCO0FBQStDO0FBNkIvRDtBQUNBO0FBQ0E7QUExQlk7QUE0Qlo7QUFDQTtBQTNCZ0I7QUFBcUM7QUE4QnJEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExQkk7QUE0Qko7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUFDQTtBQTFCSTtBQTRCSjtBQUNBO0FBQ0E7QUFDQTtBQTlCUTtBQUNBO0FBQ0E7QUFDQTtBQWdDUjtBQTlCUTtBQUNJO0FBZ0NaO0FBQ0E7QUE5QlE7QUFnQ1I7QUFDQTtBQUNBO0FBOUJRO0FBZ0NSO0FBOUJZO0FBQ0k7QUFnQ2hCO0FBQ0E7QUE5Qlk7QUFDQTtBQUNBO0FBQ0k7QUFnQ2hCO0FBOUJvQjtBQUErQjtBQWlDbkQ7QUFDQTtBQWhDb0I7QUFrQ3BCO0FBQ0E7QUE5Qm9CO0FBQStCO0FBaUNuRDtBQUNBO0FBaENvQjtBQWtDcEI7QUFDQTtBQTlCb0I7QUFBK0I7QUFpQ25EO0FBQ0E7QUFoQ29CO0FBa0NwQjtBQUNBO0FBL0JvQjtBQUErQjtBQWtDbkQ7QUFDQTtBQWpDb0I7QUFtQ3BCO0FBQ0E7QUEvQm9CO0FBQStCO0FBa0NuRDtBQUNBO0FBakNvQjtBQW1DcEI7QUFDQTtBQUNBO0FBQ0E7QUFoQ1E7QUFrQ1I7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFDSTtBQUNJO0FBQ0k7QUFrQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBL0JZO0FBQ0k7QUFDSTtBQWlDcEI7QUFDQTtBQUNBO0FBQ0E7QUEvQlE7QUFpQ1I7QUFDQTtBQS9CSTtBQWlDSjtBQUNBO0FBN0JJO0FBQ0k7QUFDQTtBQStCUjtBQTdCUTtBQStCUjtBQUNBO0FBQ0E7QUFDQTtBQTdCSTtBQStCSjtBQUNBO0FBL0JRO0FBQ0k7QUFpQ1o7QUFDQTtBQS9CUTtBQUNJO0FBQ0E7QUFDQTtBQWlDWjtBQS9CUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFpQ1o7QUEvQlE7QUFDQTtBQWlDUjtBQUNBO0FBL0JJO0FBQ0k7QUFDSTtBQWlDWjtBQUNBO0FBQ0E7QUEvQkk7QUFDSTtBQUNBO0FBQ0k7QUFpQ1o7QUFDQTtBQS9CUTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBaUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBL0JJO0FBaUNKO0FBQ0E7QUFqQ1E7QUFDSTtBQUNBO0FBQ0E7QUFtQ1o7QUFqQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBbUNaO0FBakNRO0FBQ0E7QUFtQ1I7QUFDQTtBQWpDSTtBQUNJO0FBQ0k7QUFtQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBbUNSO0FBakNZO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSztBQW1DekI7QUFqQ29CO0FBQ0E7QUFtQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFoQ2dCO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWtDcEI7QUFDQTtBQUNBO0FBaENRO0FBQ0k7QUFDQTtBQUNJO0FBa0NoQjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQUNBO0FBaENZO0FBQ0E7QUFrQ1o7QUFoQ1E7QUFDSTtBQUNBO0FBQ0k7QUFrQ2hCO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBQ0E7QUFoQ1k7QUFDQTtBQWtDWjtBQWhDUTtBQUNJO0FBQ0E7QUFDQTtBQWtDWjtBQUNBO0FBaENJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQWtDWjtBQUNBO0FBaENRO0FBQ0k7QUFDQTtBQUNJO0FBa0NoQjtBQWhDWTtBQWtDWjtBQUNBO0FBaENRO0FBQ0E7QUFrQ1I7QUEvQlE7QUFDSTtBQWlDWjtBQUNBO0FBL0JRO0FBQ0k7QUFDQTtBQUNJO0FBaUNoQjtBQS9CWTtBQWlDWjtBQUNBO0FBL0JJO0FBQ0k7QUFDSTtBQWlDWjtBQUNBO0FBaENZO0FBQ0E7QUFrQ1o7QUFDQTtBQUNBO0FBaENJO0FBQ0k7QUFDSTtBQWtDWjtBQUNBO0FBakNZO0FBQ0E7QUFtQ1o7QUFDQTtBQUNBO0FBakNJO0FBbUNKO0FBakNRO0FBQ0k7QUFtQ1o7QUFDQTtBQWxDWTtBQW9DWjtBQUNBO0FBQ0E7QUFDQTtBQWxDSTtBQUNJO0FBQ0k7QUFvQ1o7QUFsQ1E7QUFvQ1I7QUFsQ1E7QUFvQ1I7QUFsQ1E7QUFvQ1I7QUFsQ1E7QUFvQ1I7QUFsQ1E7QUFBeUQ7QUFxQ2pFO0FBQ0E7QUFwQ1E7QUFzQ1I7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFDQTtBQXJDZ0I7QUF1Q2hCO0FBQ0E7QUFwQ2dCO0FBc0NoQjtBQUNBO0FBcENZO0FBc0NaO0FBcENnQjtBQXNDaEI7QUFwQ2dCO0FBc0NoQjtBQXBDZ0I7QUFzQ2hCO0FBQ0E7QUFuQ1k7QUFxQ1o7QUFuQ2dCO0FBcUNoQjtBQUNBO0FBbENnQjtBQW9DaEI7QUFDQTtBQUNBO0FBakNRO0FBbUNSO0FBakNRO0FBbUNSO0FBakNRO0FBbUNSO0FBakNZO0FBQ0k7QUFDQTtBQW1DaEI7QUFDQTtBQUNBO0FBaENRO0FBa0NSO0FBaENRO0FBa0NSO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWhDWTtBQWtDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlCSTtBQUNJO0FBQ0E7QUFnQ1I7QUFDQTtBQUNBO0FBOUJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBZ0NaO0FBOUJRO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCSTtBQWdDSjtBQUNBO0FBQ0E7QUE5QlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCSTtBQWdDSjtBQUNBO0FBQ0E7QUE5QlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCSTtBQUNJO0FBQ0k7QUFnQ1o7QUFDQTtBQTlCUTtBQUNBO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCSTtBQUNJO0FBQ0E7QUFDSTtBQWdDWjtBQUNBO0FBOUJRO0FBZ0NSO0FBOUJRO0FBQ0k7QUFDQTtBQUNBO0FBZ0NaO0FBQ0E7QUFDQTtBQUNBO0FBOUJJO0FBQ0k7QUFDQTtBQUNJO0FBZ0NaO0FBOUJRO0FBZ0NSO0FBOUJRO0FBZ0NSO0FBOUJZO0FBZ0NaO0FBQ0E7QUFDQTtBQTVCSTtBQUNJO0FBQ0k7QUE4Qlo7QUFDQTtBQUNBO0FBNUJJO0FBQ0k7QUFDQTtBQUNJO0FBOEJaO0FBNUJRO0FBOEJSO0FBQ0E7QUE1Qkk7QUFDSTtBQUNBO0FBQ0k7QUE4Qlo7QUE1QlE7QUE4QlI7QUFDQTtBQTVCSTtBQUNJO0FBOEJSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUFDSTtBQUNBO0FBQ0k7QUE4Qlo7QUE1QlE7QUFDQTtBQThCUjtBQUNBO0FBNUJJO0FBQ0k7QUFDQTtBQThCUjtBQUNBO0FBQ0E7QUE1QlE7QUFDSTtBQThCWjtBQTNCWTtBQTZCWjtBQTFCWTtBQTRCWjtBQXpCWTtBQTJCWjtBQXpCUTtBQTJCUjtBQUNBO0FBekJJO0FBQ0k7QUFDQTtBQUNBO0FBMkJSO0FBQ0E7QUF6Qkk7QUFDSTtBQUNBO0FBQ0k7QUEyQlo7QUF6QlE7QUFDSTtBQTJCWjtBQXpCUTtBQUNBO0FBMkJSO0FBQ0E7QUF6Qkk7QUFDSTtBQUNBO0FBQ0E7QUEyQlI7QUFDQTtBQXpCSTtBQUNJO0FBQ0E7QUFDSTtBQTJCWjtBQXhCWTtBQTBCWjtBQXZCWTtBQXlCWjtBQXZCUTtBQUNBO0FBeUJSO0FBQ0E7QUFDQTtBQXZCSTtBQXlCSjtBQUNBO0FBQ0E7QUF2Qkk7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0k7QUFDQTtBQUNBO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQUNJO0FBQ0E7QUF5Qlo7QUFDQTtBQXZCUTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXlCUjtBQXZCUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQXlCUjtBQUNBO0FBQ0E7QUF2Qkk7QUFDSTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUFDSTtBQUNBO0FBeUJaO0FBdkJZO0FBQ0E7QUF5Qlo7QUFDQTtBQXZCUTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUF5QmhCO0FBQ0E7QUFDQTtBQXZCUTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUF5QlI7QUFDQTtBQXZCSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUF5Qlo7QUF2QlE7QUF5QlI7QUF2QlE7QUFDQTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQXlCUjtBQUNBO0FBQ0E7QUF2QkE7QUFDSTtBQXlCSjtBQXZCQTtBQXlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL2lHQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQURKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDTTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBQ0E7QUFFSTtBQUNJO0FBQVI7QUFDQTtBQUVJO0FBQ0U7QUFDQTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFTTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFBUjtBQUNBO0FBRUs7QUFDRztBQUFSO0FBRVE7QUFDSTtBQUNBO0FBQ0E7QUFBWjtBQUVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUFaO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFDQTtBQUFaO0FBQ0E7QUFFUTtBQUNJO0FBQ0E7QUFBWjtBQUNBO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ2hCO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQVE7QUFBaUI7QUFDakI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFFOUI7QUFLUjtBQUNBO0FBSEk7QUFLSjtBQUpRO0FBQ0k7QUFDSTtBQU1oQjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBTFE7QUFDSTtBQUNJO0FBT2hCO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFPSjtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SkE7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQXlDO0FBRWpEO0FBRFk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBR1o7QUFBWTtBQUVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RLQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0U7QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUFZO0FBRVo7QUFBUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUVoQjtBQUFnQjtBQUVoQjtBQUFZO0FBQ0k7QUFFaEI7QUFDQTtBQUNBO0FBQVE7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFFcEI7QUFBZ0I7QUFDQTtBQUVoQjtBQURvQjtBQUdwQjtBQUNBO0FBRGdCO0FBQ0E7QUFDQTtBQUdoQjtBQURnQjtBQUNBO0FBR2hCO0FBRm9CO0FBSXBCO0FBQ0E7QUFIb0I7QUFLcEI7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUVBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0NBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNZO0FBQ1o7QUFDWTtBQUNaO0FBQ1E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNoQjtBQUVnQjtBQUFoQjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFHUTtBQUNJO0FBQ0k7QUFDQTtBQURoQjtBQUlnQjtBQUNBO0FBRmhCO0FBS2dCO0FBQ0E7QUFIaEI7QUFLWTtBQUNJO0FBSGhCO0FBS1k7QUFIWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBR0E7QUFDSTtBQUNBO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBWjtBQUVZO0FBQVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoREE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNaO0FBQ1E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDWTtBQUNJO0FBQ0k7QUFDQTtBQUNwQjtBQUNnQjtBQUNBO0FBQ0E7QUFDSTtBQUNwQjtBQUF3QjtBQUNBO0FBRXhCO0FBQ0E7QUFBZ0I7QUFFaEI7QUFBZ0I7QUFDQTtBQUNBO0FBRWhCO0FBQ0E7QUFBUTtBQUNJO0FBQ0E7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBZ0I7QUFFaEI7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEdBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUdBO0FBQ0k7QUFDQTtBQURaO0FBR1E7QUFDSTtBQUNBO0FBRFo7QUFHUTtBQUNJO0FBQ0E7QUFEWjtBQUNBO0FBQ0E7QUFHUTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFDQTtBQUdRO0FBQ0k7QUFEWjtBQUdRO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBR1E7QUFDSTtBQURaO0FBQ0E7QUFHUTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDSjtBQUNJO0FBQ0E7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDQTtBQUNBO0FBQ0o7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNFO0FBQ0Y7QUFDSTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNOO0FBQ0k7QUFDSjtBQUNJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDSTtBQUNKO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDTTtBQUNBO0FBQ047QUFDTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDTTtBQUNBO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ007QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUVNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQVY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVFO0FBQUY7QUFJRTtBQUZGO0FBTUU7QUFKRjtBQVFFO0FBTkY7QUFVRTtBQVJGO0FBWUU7QUFWRjtBQWNFO0FBWkY7QUFjSTtBQUNBO0FBQ0E7QUFDRTtBQVpOO0FBQ0E7QUFDQTtBQUNBO0FBY0U7QUFaRjtBQWNJO0FBQ0E7QUFaSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBY0U7QUFDRTtBQUNBO0FBQ0U7QUFaTjtBQWNJO0FBWko7QUFDQTtBQWNJO0FBQ0E7QUFDQTtBQVpKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFjRTtBQUNFO0FBQ0E7QUFDRTtBQVpOO0FBY0k7QUFaSjtBQUNBO0FBY0k7QUFDQTtBQUNBO0FBWko7QUFjSTtBQUNFO0FBWk47QUFDQTtBQUNBO0FBQ0E7QUFjRTtBQUNFO0FBWko7QUFDQTtBQUNBO0FBY0U7QUFaRjtBQWNJO0FBQ0E7QUFaSjtBQUNBO0FBY0U7QUFDRTtBQVpKO0FBY0k7QUFDRTtBQUNBO0FBQ0E7QUFaTjtBQUNBO0FBY0k7QUFDRTtBQUNFO0FBWlI7QUFDQTtBQWNNO0FBWk47QUFDQTtBQUNBO0FBY0U7QUFaRjtBQUNBO0FBWUk7QUFDRTtBQVZOO0FBQ0E7QUFZSTtBQUNFO0FBVk47QUFDQTtBQVlJO0FBQ0U7QUFDRTtBQVZSO0FBQ0E7QUFhSTtBQVhKO0FBQ0E7QUFhRTtBQVhGO0FBQ0E7QUFXSTtBQUNBO0FBQ0E7QUFUSjtBQVdJO0FBVEo7QUFDQTtBQUNBO0FBV0U7QUFDRTtBQUNFO0FBVE47QUFDQTtBQVdJO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQVRWO0FBQ0E7QUFDQTtBQVdNO0FBVE47QUFDQTtBQUNBO0FBQ0E7QUFXRTtBQUNFO0FBVEo7QUFDQTtBQVdFO0FBQ0U7QUFUSjtBQUNBO0FBV0U7QUFDRTtBQUNFO0FBQ0E7QUFUTjtBQUNBO0FBQ0E7QUFDQTtBQVdFO0FBQ0U7QUFUSjtBQUNBO0FBQ0E7QUFXRTtBQUNFO0FBQ0E7QUFUSjtBQVdJO0FBVEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRGO0FBV0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEY7QUFXRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFURjtBQUNBO0FBQ0E7QUFDQTtBQVlBO0FBQ0U7QUFWRjtBQUNBO0FBWUE7QUFDRTtBQUNBO0FBVkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYUE7QUFDRTtBQUNBO0FBWEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWFBO0FBQ0U7QUFDQTtBQVhGO0FBQ0E7QUFDQTtBQWFBO0FBQ0U7QUFDQTtBQVhGO0FBYUU7QUFDQTtBQVhGO0FBQ0E7QUFhQTtBQUNDO0FBQ0c7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQUNBO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFDQTtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBQ0E7QUFhQTtBQUNFO0FBQ0E7QUFYRjtBQWFFO0FBQ0U7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQUNBO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFDQTtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBQ0E7QUFDQTtBQWFBO0FBQ0U7QUFDQTtBQUNFO0FBWEo7QUFDQTtBQWFFO0FBWEY7QUFDQTtBQWFBO0FBWEE7QUFDQTtBQWFFO0FBQ0U7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFhQTtBQVhBO0FBQ0E7QUFXRTtBQUNBO0FBVEY7QUFXRTtBQUNFO0FBVEo7QUFDQTtBQVdFO0FBQ0U7QUFDQTtBQVRKO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBVEo7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNFO0FBVEo7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBVEo7QUFDQTtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0k7QUFDQTtBQUNFO0FBVE47QUFDQTtBQVdJO0FBVEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBVEE7QUFDQTtBQVNFO0FBQ0E7QUFDRTtBQUNBO0FBUEo7QUFDQTtBQVNFO0FBUEY7QUFXSTtBQUNBO0FBQ0U7QUFUTjtBQUNBO0FBV0k7QUFUSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBVE47QUFDQTtBQVdJO0FBVEo7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNFO0FBVEo7QUFDQTtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQVRKO0FBQ0E7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0U7QUFUSjtBQUNBO0FBV0U7QUFURjtBQUNBO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBQ0E7QUFXRTtBQVRGO0FBQ0E7QUFDQTtBQVdBO0FBQ0k7QUFDQTtBQUNFO0FBVE47QUFDQTtBQVdJO0FBVEo7QUFZTTtBQUNBO0FBQ0U7QUFWUjtBQVlNO0FBQ0E7QUFDQTtBQVZOO0FBQ0E7QUFDQTtBQVlBO0FBQ0k7QUFDRTtBQVZOO0FBQ0E7QUFZSTtBQVZKO0FBQ0E7QUFDQTtBQVlBO0FBQ0k7QUFDRTtBQUNBO0FBVk47QUFDQTtBQVlJO0FBVko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNXVCQTtBQUNBO0FBQ0k7QUFBa0M7QUFFdEM7QUFDQTtBQURJO0FBR0o7QUFESTtBQUdKO0FBREk7QUFHSjtBQURJO0FBQWtDO0FBSXRDO0FBQ0E7QUFISTtBQUFrQztBQU10QztBQUNBO0FBTEk7QUFPSjtBQUNBO0FBTlE7QUFBaUM7QUFTekM7QUFDQTtBQVJRO0FBVVI7QUFDQTtBQVJRO0FBVVI7QUFSWTtBQVVaO0FBUlk7QUFVWjtBQUNBO0FBUFE7QUFTUjtBQVBZO0FBU1o7QUFQZ0I7QUFTaEI7QUFQZ0I7QUFTaEI7QUFDQTtBQUNBO0FBTlE7QUFBbUM7QUFTM0M7QUFDQTtBQUNBO0FBQ0E7QUFQUTtBQUFpQztBQVV6QztBQUNBO0FBVFE7QUFXUjtBQUNBO0FBVFE7QUFXUjtBQVRZO0FBV1o7QUFUWTtBQVdaO0FBQ0E7QUFUUTtBQVdSO0FBVFk7QUFXWjtBQVRnQjtBQVdoQjtBQVRnQjtBQVdoQjtBQUNBO0FBQ0E7QUFSUTtBQUFrQztBQVcxQztBQUNBO0FBUlE7QUFBaUM7QUFXekM7QUFDQTtBQVZRO0FBWVI7QUFWUTtBQVlSO0FBVlk7QUFZWjtBQVZZO0FBWVo7QUFDQTtBQVRRO0FBV1I7QUFUWTtBQVdaO0FBVGdCO0FBV2hCO0FBVGdCO0FBV2hCO0FBQ0E7QUFSUTtBQUFrQztBQVcxQztBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBVkk7QUFBaUM7QUFhckM7QUFaSTtBQWNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hIQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFJSTtBQUZKO0FBSVE7QUFGUjtBQUlRO0FBRlI7QUFJUTtBQUZSO0FBSVE7QUFGUjtBQUlRO0FBRlI7QUFJUTtBQUZSO0FBSVE7QUFGUjtBQUlRO0FBRlI7QUFJWTtBQUZaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFETTtBQUdOO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFITTtBQUtOO0FBSEk7QUFLSjtBQUhNO0FBS047QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQVBRO0FBQ0k7QUFTWjtBQU5ZO0FBUVo7QUFDQTtBQU5JO0FBQ0U7QUFRTjtBQU5JO0FBUUo7QUFDQTtBQVJNO0FBVU47QUFDQTtBQVJJO0FBQ0U7QUFVTjtBQUNBO0FBQ0E7QUFKTTtBQUNFO0FBQ0U7QUFNVjtBQUNBO0FBSlE7QUFDQTtBQU1SO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQU5NO0FBUU47QUFOUTtBQVFSO0FBQ0E7QUFOTTtBQVFOO0FBQ0E7QUFOSTtBQVFKO0FBQ0E7QUFSTTtBQVVOO0FBQ0E7QUFSSTtBQVVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZNO0FBWU47QUFDQTtBQVZJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQVlSO0FBQ0E7QUFDQTtBQVZJO0FBQ0U7QUFDQTtBQUNFO0FBWVI7QUFDQTtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlJQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNLO0FBQ0c7QUFDQTtBQUNBO0FBQ1I7QUFDUztBQUNBO0FBQ0k7QUFDYjtBQUVhO0FBQWI7QUFHYTtBQURiO0FBSWE7QUFGYjtBQUlTO0FBQ0E7QUFDSTtBQUZiO0FBS2E7QUFIYjtBQU1hO0FBSmI7QUFPYTtBQUxiO0FBQ0E7QUFPUztBQUNJO0FBTGI7QUFPUztBQUxUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIOe7mSBBcnJheSDmt7vliqDmlrnms5Vcbi8vIGFyci5maW5kKC4uLilcbi8vIGFyci5maW5kSW5kZXgoLi4uKVxuLy8gYXJyLmluY2x1ZGVzKGUpXG4vLyBhcnIudW5pcXVlKGVxdWFsRnVuY3Rpb24sIGlzTmV3QXJyYXkpXG4vLyBBcnJheS5mcm9tXG4vLyBBcnJheS5lcXVhbFxuLy8gYXJyLmlzRXF1YWwob3RoZXJBcnJheSwgaXNTdHJpY3QpXG4vLyBBcnJheS5zb3J0QnlOdW1iZXJcbi8vIGFyci5maW5kU3ViQXJyYXlJbmRleHMoW10pICAg55So5LqO5p+l5om+5pWw57uE5YaF55qE6YOo5YiG5YWD57Sg55qE57Si5byVXG4vLyBhcnIudHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleChzdGFydEluZGV4KSDlsIbmlbDnu4TlhoXnmoTlhYPntKDlubPnp7tcbi8vIOWmgu+8mlsxLCAyLCAzLCA0LCA1XS50cmFuc2xhdGlvbldpdGhTdGFydEluZGV4KDMpID0+IFs0LDUsMSwyLDNdXG4vLyBhcnIua3FfaW5zZXJ0KGluZGV4LCBlKSAgIOaPkuWFpeS4gOS4quWFg+e0oFxuLy8gYXJyLmtxX2V4Y2x1ZGVzKGFycmF5KSAgIC8vIOmZpOS6hmFycmF55pWw57uE5Lit55qE5YWD57SgXG5cblxubW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuaWYgKCFBcnJheS5wcm90b3R5cGUuZmluZCkge1xuICBBcnJheS5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uKHByZWRpY2F0ZSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBpZiAodGhpcyA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcnJheS5wcm90b3R5cGUuZmluZCBjYWxsZWQgb24gbnVsbCBvciB1bmRlZmluZWQnKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBwcmVkaWNhdGUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ByZWRpY2F0ZSBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG4gICAgdmFyIGxpc3QgPSBPYmplY3QodGhpcyk7XG4gICAgdmFyIGxlbmd0aCA9IGxpc3QubGVuZ3RoID4+PiAwO1xuICAgIHZhciB0aGlzQXJnID0gYXJndW1lbnRzWzFdO1xuICAgIHZhciB2YWx1ZTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhbHVlID0gbGlzdFtpXTtcbiAgICAgIGlmIChwcmVkaWNhdGUuY2FsbCh0aGlzQXJnLCB2YWx1ZSwgaSwgbGlzdCkpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9O1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS5maW5kSW5kZXgpIHtcbiAgQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleCA9IGZ1bmN0aW9uKHByZWRpY2F0ZSkge1xuICAgIGlmICh0aGlzID09PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcnJheS5wcm90b3R5cGUuZmluZEluZGV4IGNhbGxlZCBvbiBudWxsIG9yIHVuZGVmaW5lZCcpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHByZWRpY2F0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigncHJlZGljYXRlIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgIH1cbiAgICB2YXIgbGlzdCA9IE9iamVjdCh0aGlzKTtcbiAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGggPj4+IDA7XG4gICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHNbMV07XG4gICAgdmFyIHZhbHVlO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFsdWUgPSBsaXN0W2ldO1xuICAgICAgaWYgKHByZWRpY2F0ZS5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpLCBsaXN0KSkge1xuICAgICAgICByZXR1cm4gaTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIC0xO1xuICB9O1xufVxuXG5cbi8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS5pbmNsdWRlc1xuaWYgKCFBcnJheS5wcm90b3R5cGUuaW5jbHVkZXMpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2luY2x1ZGVzJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihzZWFyY2hFbGVtZW50LCBmcm9tSW5kZXgpIHtcblxuICAgICAgLy8gMS4gTGV0IE8gYmUgPyBUb09iamVjdCh0aGlzIHZhbHVlKS5cbiAgICAgIGlmICh0aGlzID09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJ0aGlzXCIgaXMgbnVsbCBvciBub3QgZGVmaW5lZCcpO1xuICAgICAgfVxuXG4gICAgICB2YXIgbyA9IE9iamVjdCh0aGlzKTtcblxuICAgICAgLy8gMi4gTGV0IGxlbiBiZSA/IFRvTGVuZ3RoKD8gR2V0KE8sIFwibGVuZ3RoXCIpKS5cbiAgICAgIHZhciBsZW4gPSBvLmxlbmd0aCA+Pj4gMDtcblxuICAgICAgLy8gMy4gSWYgbGVuIGlzIDAsIHJldHVybiBmYWxzZS5cbiAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyA0LiBMZXQgbiBiZSA/IFRvSW50ZWdlcihmcm9tSW5kZXgpLlxuICAgICAgLy8gICAgKElmIGZyb21JbmRleCBpcyB1bmRlZmluZWQsIHRoaXMgc3RlcCBwcm9kdWNlcyB0aGUgdmFsdWUgMC4pXG4gICAgICB2YXIgbiA9IGZyb21JbmRleCB8IDA7XG5cbiAgICAgIC8vIDUuIElmIG4g4omlIDAsIHRoZW5cbiAgICAgIC8vICBhLiBMZXQgayBiZSBuLlxuICAgICAgLy8gNi4gRWxzZSBuIDwgMCxcbiAgICAgIC8vICBhLiBMZXQgayBiZSBsZW4gKyBuLlxuICAgICAgLy8gIGIuIElmIGsgPCAwLCBsZXQgayBiZSAwLlxuICAgICAgdmFyIGsgPSBNYXRoLm1heChuID49IDAgPyBuIDogbGVuIC0gTWF0aC5hYnMobiksIDApO1xuXG4gICAgICAvLyA3LiBSZXBlYXQsIHdoaWxlIGsgPCBsZW5cbiAgICAgIHdoaWxlIChrIDwgbGVuKSB7XG4gICAgICAgIC8vIGEuIExldCBlbGVtZW50SyBiZSB0aGUgcmVzdWx0IG9mID8gR2V0KE8sICEgVG9TdHJpbmcoaykpLlxuICAgICAgICAvLyBiLiBJZiBTYW1lVmFsdWVaZXJvKHNlYXJjaEVsZW1lbnQsIGVsZW1lbnRLKSBpcyB0cnVlLCByZXR1cm4gdHJ1ZS5cbiAgICAgICAgLy8gYy4gSW5jcmVhc2UgayBieSAxLlxuICAgICAgICAvLyBOT1RFOiA9PT0gcHJvdmlkZXMgdGhlIGNvcnJlY3QgXCJTYW1lVmFsdWVaZXJvXCIgY29tcGFyaXNvbiBuZWVkZWQgaGVyZS5cbiAgICAgICAgaWYgKG9ba10gPT09IHNlYXJjaEVsZW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBrKys7XG4gICAgICB9XG5cbiAgICAgIC8vIDguIFJldHVybiBmYWxzZVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSk7XG59XG5cbi8vIHVuaXF1ZVxuaWYgKCFBcnJheS5wcm90b3R5cGUudW5pcXVlKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICd1bmlxdWUnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKGVxdWFsRnVuY3Rpb24sIG5ld0FycmF5ID0gdHJ1ZSkge1xuICAgICAgaWYgKG5ld0FycmF5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl91bnFpdWVfbmV3KGVxdWFsRnVuY3Rpb24pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5fdW5xaXVlKGVxdWFsRnVuY3Rpb24pO1xuICAgIH0sXG4gIH0pO1xuXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdfdW5xaXVlX25ldycsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oZXF1YWxGdW5jdGlvbikge1xuICAgICAgbGV0IGFycmF5ID0gQXJyYXkuZnJvbSh0aGlzKTtcblxuICAgICAgcmV0dXJuIGFycmF5Ll91bnFpdWUoZXF1YWxGdW5jdGlvbik7XG4gICAgfVxuICB9KTtcblxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnX3VucWl1ZScsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oZXF1YWxGdW5jdGlvbikge1xuICAgICAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoO1xuICAgICAgdmFyIGkgPSAtMTtcblxuICAgICAgd2hpbGUgKGkrKyA8IGxlbikge1xuICAgICAgICB2YXIgaiA9IGkgKyAxO1xuXG4gICAgICAgIGZvciAoOyBqIDwgdGhpcy5sZW5ndGg7ICsraikge1xuICAgICAgICAgIHZhciBpc0VxdWFsID0gZmFsc2U7XG4gICAgICAgICAgaWYgKGVxdWFsRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIGlzRXF1YWwgPSBlcXVhbEZ1bmN0aW9uKHRoaXNbaV0sIHRoaXNbal0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpc0VxdWFsID0gdGhpc1tpXSA9PT0gdGhpc1tqXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaXNFcXVhbCkge1xuICAgICAgICAgICAgdGhpcy5zcGxpY2Uoai0tLCAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gIH0pO1xufVxuXG5cbi8vIFByb2R1Y3Rpb24gc3RlcHMgb2YgRUNNQS0yNjIsIEVkaXRpb24gNiwgMjIuMS4yLjFcbi8vIFJlZmVyZW5jZTogaHR0cHM6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0Lmh0bWwjc2VjLWFycmF5LmZyb21cbmlmICghQXJyYXkuZnJvbSkge1xuICBBcnJheS5mcm9tID0gKGZ1bmN0aW9uKCkge1xuICAgIHZhciB0b1N0ciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG4gICAgdmFyIGlzQ2FsbGFibGUgPSBmdW5jdGlvbihmbikge1xuICAgICAgcmV0dXJuIHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyB8fCB0b1N0ci5jYWxsKGZuKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcbiAgICB9O1xuICAgIHZhciB0b0ludGVnZXIgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIG51bWJlciA9IE51bWJlcih2YWx1ZSk7XG4gICAgICBpZiAoaXNOYU4obnVtYmVyKSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cbiAgICAgIGlmIChudW1iZXIgPT09IDAgfHwgIWlzRmluaXRlKG51bWJlcikpIHtcbiAgICAgICAgcmV0dXJuIG51bWJlcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiAobnVtYmVyID4gMCA/IDEgOiAtMSkgKiBNYXRoLmZsb29yKE1hdGguYWJzKG51bWJlcikpO1xuICAgIH07XG4gICAgdmFyIG1heFNhZmVJbnRlZ2VyID0gTWF0aC5wb3coMiwgNTMpIC0gMTtcbiAgICB2YXIgdG9MZW5ndGggPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIGxlbiA9IHRvSW50ZWdlcih2YWx1ZSk7XG4gICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgobGVuLCAwKSwgbWF4U2FmZUludGVnZXIpO1xuICAgIH07XG5cbiAgICAvLyBUaGUgbGVuZ3RoIHByb3BlcnR5IG9mIHRoZSBmcm9tIG1ldGhvZCBpcyAxLlxuICAgIHJldHVybiBmdW5jdGlvbiBmcm9tKGFycmF5TGlrZSAvKiwgbWFwRm4sIHRoaXNBcmcgKi8gKSB7XG4gICAgICAvLyAxLiBMZXQgQyBiZSB0aGUgdGhpcyB2YWx1ZS5cbiAgICAgIHZhciBDID0gdGhpcztcblxuICAgICAgLy8gMi4gTGV0IGl0ZW1zIGJlIFRvT2JqZWN0KGFycmF5TGlrZSkuXG4gICAgICB2YXIgaXRlbXMgPSBPYmplY3QoYXJyYXlMaWtlKTtcblxuICAgICAgLy8gMy4gUmV0dXJuSWZBYnJ1cHQoaXRlbXMpLlxuICAgICAgaWYgKGFycmF5TGlrZSA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcnJheS5mcm9tIHJlcXVpcmVzIGFuIGFycmF5LWxpa2Ugb2JqZWN0IC0gbm90IG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgICAgfVxuXG4gICAgICAvLyA0LiBJZiBtYXBmbiBpcyB1bmRlZmluZWQsIHRoZW4gbGV0IG1hcHBpbmcgYmUgZmFsc2UuXG4gICAgICB2YXIgbWFwRm4gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHZvaWQgdW5kZWZpbmVkO1xuICAgICAgdmFyIFQ7XG4gICAgICBpZiAodHlwZW9mIG1hcEZuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAvLyA1LiBlbHNlXG4gICAgICAgIC8vIDUuIGEgSWYgSXNDYWxsYWJsZShtYXBmbikgaXMgZmFsc2UsIHRocm93IGEgVHlwZUVycm9yIGV4Y2VwdGlvbi5cbiAgICAgICAgaWYgKCFpc0NhbGxhYmxlKG1hcEZuKSkge1xuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FycmF5LmZyb206IHdoZW4gcHJvdmlkZWQsIHRoZSBzZWNvbmQgYXJndW1lbnQgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyA1LiBiLiBJZiB0aGlzQXJnIHdhcyBzdXBwbGllZCwgbGV0IFQgYmUgdGhpc0FyZzsgZWxzZSBsZXQgVCBiZSB1bmRlZmluZWQuXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMikge1xuICAgICAgICAgIFQgPSBhcmd1bWVudHNbMl07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gMTAuIExldCBsZW5WYWx1ZSBiZSBHZXQoaXRlbXMsIFwibGVuZ3RoXCIpLlxuICAgICAgLy8gMTEuIExldCBsZW4gYmUgVG9MZW5ndGgobGVuVmFsdWUpLlxuICAgICAgdmFyIGxlbiA9IHRvTGVuZ3RoKGl0ZW1zLmxlbmd0aCk7XG5cbiAgICAgIC8vIDEzLiBJZiBJc0NvbnN0cnVjdG9yKEMpIGlzIHRydWUsIHRoZW5cbiAgICAgIC8vIDEzLiBhLiBMZXQgQSBiZSB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgdGhlIFtbQ29uc3RydWN0XV0gaW50ZXJuYWwgbWV0aG9kIG9mIEMgd2l0aCBhbiBhcmd1bWVudCBsaXN0IGNvbnRhaW5pbmcgdGhlIHNpbmdsZSBpdGVtIGxlbi5cbiAgICAgIC8vIDE0LiBhLiBFbHNlLCBMZXQgQSBiZSBBcnJheUNyZWF0ZShsZW4pLlxuICAgICAgdmFyIEEgPSBpc0NhbGxhYmxlKEMpID8gT2JqZWN0KG5ldyBDKGxlbikpIDogbmV3IEFycmF5KGxlbik7XG5cbiAgICAgIC8vIDE2LiBMZXQgayBiZSAwLlxuICAgICAgdmFyIGsgPSAwO1xuICAgICAgLy8gMTcuIFJlcGVhdCwgd2hpbGUgayA8IGxlbuKApiAoYWxzbyBzdGVwcyBhIC0gaClcbiAgICAgIHZhciBrVmFsdWU7XG4gICAgICB3aGlsZSAoayA8IGxlbikge1xuICAgICAgICBrVmFsdWUgPSBpdGVtc1trXTtcbiAgICAgICAgaWYgKG1hcEZuKSB7XG4gICAgICAgICAgQVtrXSA9IHR5cGVvZiBUID09PSAndW5kZWZpbmVkJyA/IG1hcEZuKGtWYWx1ZSwgaykgOiBtYXBGbi5jYWxsKFQsIGtWYWx1ZSwgayk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgQVtrXSA9IGtWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBrICs9IDE7XG4gICAgICB9XG4gICAgICAvLyAxOC4gTGV0IHB1dFN0YXR1cyBiZSBQdXQoQSwgXCJsZW5ndGhcIiwgbGVuLCB0cnVlKS5cbiAgICAgIEEubGVuZ3RoID0gbGVuO1xuICAgICAgLy8gMjAuIFJldHVybiBBLlxuICAgICAgcmV0dXJuIEE7XG4gICAgfTtcbiAgfSgpKTtcbn1cblxuaWYgKCFBcnJheS5lcXVhbCkge1xuICBBcnJheS5lcXVhbCA9IGZ1bmN0aW9uKGFycjEsIGFycjIsIHN0cmljdCA9IHRydWUpIHtcbiAgICBpZiAoYXJyMSA9PT0gdW5kZWZpbmVkIHx8IGFycjIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHZhciBsZW5ndGggPSBhcnIxLmxlbmd0aFxuICAgIGlmIChsZW5ndGggIT09IGFycjIubGVuZ3RoKSByZXR1cm4gZmFsc2VcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoc3RyaWN0KSB7XG4gICAgICAgIGlmIChhcnIxW2ldICE9PSBhcnIyW2ldKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciB2YWx1ZTEgPSBhcnIxW2ldO1xuICAgICAgICB2YXIgdmFsdWUyID0gYXJyMltpXTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlMSkgJiYgQXJyYXkuaXNBcnJheSh2YWx1ZTIpKSB7XG4gICAgICAgICAgcmVzdWx0ID0gQXJyYXkuZXF1YWwodmFsdWUxLCB2YWx1ZTIsIHN0cmljdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzdWx0ID0gKHZhbHVlMSA9PSB2YWx1ZTIpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9O1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS5pc0VxdWFsKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpc0VxdWFsJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihvdGhlckFycmF5LCBzdHJpY3QgPSB0cnVlKSB7XG4gICAgICByZXR1cm4gQXJyYXkuZXF1YWwodGhpcywgb3RoZXJBcnJheSwgc3RyaWN0KTtcbiAgICB9LFxuICB9KTtcbn1cblxuaWYgKCFBcnJheS5zb3J0QnlOdW1iZXIpIHtcbiAgQXJyYXkuc29ydEJ5TnVtYmVyID0gZnVuY3Rpb24gKG4xLCBuMiwgYXNjID0gdHJ1ZSkge1xuICAgIHJldHVybiAobjEgLSBuMikgKiAoYXNjID8gMSA6IC0xKTtcbiAgfTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUuZmluZFN1YkFycmF5SW5kZXhzKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdmaW5kU3ViQXJyYXlJbmRleHMnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIChzdWJBcnJheSwgZikge1xuICAgICAgbGV0IGluZGV4cyA9IFtdO1xuICAgICAgZm9yICh2YXIgaSBpbiBzdWJBcnJheSkge1xuICAgICAgICBsZXQgc3ViVmFsdWUgPSBzdWJBcnJheVtpXTtcbiAgICAgICAgbGV0IGZpbmRGdW5jID0gZiB8fCBmdW5jdGlvbiAodGhpc1ZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHN1YlZhbHVlID09PSB0aGlzVmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5maW5kSW5kZXgoZmluZEZ1bmMpO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgIGluZGV4cy5wdXNoKGluZGV4KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpbmRleHMgPSBbXTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gaW5kZXhzLmxlbmd0aCA+IDAgPyBpbmRleHMgOiBudWxsO1xuICAgIH0sXG4gIH0pO1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS50cmFuc2xhdGlvbldpdGhTdGFydEluZGV4KSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICd0cmFuc2xhdGlvbldpdGhTdGFydEluZGV4Jywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoc3RhcnRJbmRleCkge1xuICAgICAgaWYgKHN0YXJ0SW5kZXggPT0gMCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgaWYgKHN0YXJ0SW5kZXggPj0gdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGxldCBwcmUgPSB0aGlzLnNsaWNlKHN0YXJ0SW5kZXgpO1xuICAgICAgbGV0IGxhc3QgPSB0aGlzLnNsaWNlKDAsIHN0YXJ0SW5kZXgpO1xuICAgICAgbGV0IHJlc3VsdCA9IHByZS5jb25jYXQobGFzdCk7XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcbiAgfSk7XG59XG5cbmlmICghQXJyYXkucHJvdG90eXBlLmtxX2luc2VydCkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAna3FfaW5zZXJ0Jywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihpbmRleCwgZSkge1xuICAgICAgaWYgKGUgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgaWYgKGluZGV4ID49IHRoaXMubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMucHVzaChlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNwbGljZShpbmRleCwgMCwgZSk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gIH0pO1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS5rcV9leGNsdWRlcykge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAna3FfZXhjbHVkZXMnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKG90aGVyQXJyYXkpIHtcbiAgICAgIGlmIChvdGhlckFycmF5ID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGxldCByZXN1bHQgPSBbXTtcbiAgICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgIGlmICghb3RoZXJBcnJheS5pbmNsdWRlcyhlbGVtZW50KSkge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuICB9KTtcbn1cblxuLypcbmlmKCFBcnJheS5wcm90b3R5cGUubWluKXtcbiAgQXJyYXkucHJvdG90eXBlLm1pbiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBtaW4gPSB0aGlzWzBdO1xuICAgIHZhciBsZW4gPSB0aGlzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBpZiAodGhpc1tpXSA8IG1pbikge1xuICAgICAgICBtaW4gPSB0aGlzW2ldO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbWluO1xuICB9XG59Ki9cbiIsInZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xuXG5sZXQgQXVkaW9NYW5hZ2VyID0gY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgaGFsbF9iZ206IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIOaJk+aeqlxuICAgICAgICBkYVFpYW5nOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcblxuICAgICAgICBmYXBhaToge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICAgICAgd2luZG93OiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcblxuICAgICAgICBjbGlja193ZWl4aW5fbG9naW46e1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICAgICAgZmFuZ1BhaTp7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcblxuICAgIH0sXG5cbiAgICBzdGF0aWNzOiB7XG4gICAgICAgIGluc3RhbmNlOiBudWxsLFxuICAgIH0sXG5cbiAgICBvbkxvYWQ6ZnVuY3Rpb24oKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZSA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyQXBwQWN0aXZlQ2hhbmdlKCk7XG5cbiAgICAgICAgdGhpcy5zb3VuZE9uID0gdHJ1ZTtcbiAgICAgICAgY2MuZ2FtZS5hZGRQZXJzaXN0Um9vdE5vZGUodGhpcy5ub2RlKTtcbiAgICAgICAgaWYgKGNjLmdhbWUuaXNQZXJzaXN0Um9vdE5vZGUodGhpcy5ub2RlKSkge1xuICAgICAgICAgICAgLy8gY2MubG9nKCfmt7vliqDlhajlsYDoioLngrnmiJDlip8nKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1WYWx1ZSA9IG1hbmFnZXIuZ2V0TXVzaWNWYWx1ZSgpO1xuICAgICAgICB0aGlzLm1FVmFsdWUgPSBtYW5hZ2VyLmdldE11c2ljRWZmZWN0VmFsdWUoKTtcbiAgICAgICAgdGhpcy5iZ0F1ZGlvSWQgPSAtMTtcbiAgICB9LFxuXG4gICAgc3RvcEhhbGxNdXNpYzogZnVuY3Rpb24oKXtcbiAgICAgICAgY2MuYXVkaW9FbmdpbmUuc3RvcCh0aGlzLmJnQXVkaW9JZCk7XG4gICAgfSxcblxuICAgIHBsYXlNdXNpYzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYmdBdWRpb0lkID0gY2MuYXVkaW9FbmdpbmUucGxheU11c2ljKCB0aGlzLmhhbGxfYmdtLCB0cnVlKTtcbiAgICAgICAgaWYgKHRoaXMuYmdBdWRpb0lkICE9IC0xKSB7XG4gICAgICAgICAgICAvL2NjLmxvZygncGxheScpO1xuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc2V0Vm9sdW1lKHRoaXMuYmdBdWRpb0lkLHRoaXMubVZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICAvL2NjLmF1ZGlvRW5naW5lLnBsYXlNdXNpYyggdXJsLCB0cnVlIClcbiAgICB9LFxuXG5cbiAgICBwbGF5Q29tcGFyZUNhcmRzTXVzaWM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5iZ0F1ZGlvSWQgPSBjYy5hdWRpb0VuZ2luZS5wbGF5TXVzaWMoIHRoaXMuaGFsbF9iZ20sIHRydWUpO1xuICAgICAgICBpZiAodGhpcy5iZ0F1ZGlvSWQgIT0gLTEpIHtcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnNldFZvbHVtZSh0aGlzLmJnQXVkaW9JZCx0aGlzLm1WYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcGxheURhUWlhbmc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgc3RhcnQgPSAwOyBzdGFydCA8PSAxLjY7IHN0YXJ0ID0gc3RhcnQgKyAwLjUpIHtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuZGFRaWFuZyk7XG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIHN0YXJ0KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyDigJzmiZPmnqrigJ1cbiAgICBwbGF5SHVtYW5EYVFpYW5nOiBmdW5jdGlvbiAoc2V4ID0gMSkge1xuICAgICAgICB2YXIgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9tYW5cIi8qICsgKHNleCA9PSAxID8gXCJtYW5cIiA6IFwid29tYW5cIikqLztcbiAgICAgICAgcGF0aCA9IHBhdGggKyBcIi9kYXFpYW5nMS5tcDNcIjtcblxuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICAvLyDigJzkuK3mnqrigJ1cbiAgICBwbGF5SHVtYW5aUWlhbmc6IGZ1bmN0aW9uIChzZXggPSAxKSB7XG4gICAgICAgIHZhciBwYXRoID0gXCJyZXNvdXJjZXMvc291bmRzL21hblwiLyogKyAoc2V4ID09IDEgPyBcIm1hblwiIDogXCJ3b21hblwiKSovO1xuICAgICAgICBwYXRoID0gcGF0aCArIFwiL2RhcWlhbmczLm1wM1wiO1xuXG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIHBsYXlQb2tlckNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KCdyZXNvdXJjZXMvc291bmRzL3B1YmxpYy9jbGlja193eF9sb2dpbi5tcDMnKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICAvLyDmkq3mlL7lhajlnpLmiZPpn7PmlYhcbiAgICBwbGF5SG9tZVJ1bjogZnVuY3Rpb24gKHNleCA9IDEpIHtcbiAgICAgICAgbGV0IHBhdGggPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoc2V4KSArIFwic3BlY2lhbDEubXAzXCI7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIC8vIOaSreaUvuWPkeeJjOmfs+aViFxuICAgIHBsYXlGYVBhaTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBwYXRoMSA9IHRoaXMuX3NvdW5kc0h1bWFuUGF0aCgxKSArIFwicm9vbV9zdGFydF9jb21wYXJlLm1wM1wiO1xuICAgICAgICBsZXQgdXJsMSA9IGNjLnVybC5yYXcocGF0aDEpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybDEpO1xuICAgICAgICAvL2xldCBwb2tlckRlYWwgPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoMSkgKyBcInBva2VyX2RlYWwubXAzXCI7XG4gICAgICAgIC8vbGV0IHVybFBva2VyRGVhbCA9IGNjLnVybC5yYXcocG9rZXJEZWFsKTtcbiAgICAgICAgLy90aGlzLl9wbGF5U0ZYKHVybFBva2VyRGVhbCk7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5mYXBhaSk7XG4gICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCA2OyBpbmRleCsrKSB7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuZmFwYWkpO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCBpbmRleCAqIDAuMSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcGxheUNhcmRUeXBlOiBmdW5jdGlvbiAoc2V4ID0gMSwgdHlwZSA9IC0xKSB7XG4gICAgICAgIC8vIOWPquaSreaUvuaZrumAmuexu+Wei+eahOivremfs1xuICAgICAgICBpZiAoKHR5cGUgPj0gMTApIHx8ICh0eXBlIDwgMCkpIHtcbiAgICAgICAgICAgIC8vIDEwIOWPiuS7peS4iuaYr+eJueauiueJjFxuICAgICAgICAgICAgbGV0IHBhdGggPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoc2V4KSArICh0eXBlKSArIFwiLm1wM1wiO1xuICAgICAgICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcocGF0aCk7XG4gICAgICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgcGF0aCA9IHRoaXMuX3NvdW5kc0h1bWFuUGF0aChzZXgpICsgXCJjb21tb25cIiArICh0eXBlICsgMSkgKyBcIi5tcDNcIjtcbiAgICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcocGF0aCk7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+IOW8gOWni+avlOeJjFxuICAgIHBsYXlTdGFydENvbXBhcmU6IGZ1bmN0aW9uIChzZXggPSAxKSB7XG4gICAgICAgIGxldCBwYXRoID0gdGhpcy5fc291bmRzSHVtYW5QYXRoKHNleCkgKyBcInN0YXJ0X2NvbXBhcmUubXAzXCI7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIHBsYXlXaW46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcoJ3Jlc291cmNlcy9zb3VuZHMvb3BlbmZhY2Uvd2luLm1wMycpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIHBsYXlMb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KCdyZXNvdXJjZXMvc291bmRzL29wZW5mYWNlL2xvc2UubXAzJyk7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgY29pbkluY29tZTogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdygncmVzb3VyY2VzL3NvdW5kcy9vcGVuZmFjZS9jb2luX2luY29tZS5tcDMnKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICBfc291bmRzSHVtYW5QYXRoOiBmdW5jdGlvbiAoc2V4KSB7XG4gICAgICAgIGxldCBwYXRoID0gXCJyZXNvdXJjZXMvc291bmRzL21hbi9cIi8qICsgKHNleCA9PSAxID8gXCJtYW5cIiA6IFwid29tYW5cIikgKyBcIi9cIiovO1xuICAgICAgICByZXR1cm4gcGF0aDtcbiAgICB9LFxuXG4gICAgc2V0QmdNdXNpY1ZvbHVtbjogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdGhpcy5tVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMuYmdBdWRpb0lkICE9IC0xKSB7XG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUodGhpcy5iZ0F1ZGlvSWQsdmFsdWUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHNldEVmZmVjdE11c2ljVm9sdW06IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubUVWYWx1ZSA9IHZhbHVlO1xuICAgIH0sXG5cbiAgICAvKuiBiuWkqSovXG4gICAgcGxheUNoYXRBdWRpbzpmdW5jdGlvbihzZXgsIHN0cikge1xuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmNoYXRUZXh0cygpLmluZGV4T2Yoc3RyKTtcbiAgICAgICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBudW1iZXIgPSBcIkNIQVRcIisoaW5kZXgrMSk7XG4gICAgICAgIGxldCBwYXRoID0gXCJyZXNvdXJjZXMvc291bmRzL2NoYXQvXCIgKyBudW1iZXIgKyBcIi5tcDNcIjtcbiAgICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcocGF0aCk7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgY2hhdFRleHRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAn6L+Y5LiN5Ye654mM77yM5oiR6YO95b+r5Y675ZCD6ZSF6L6557OK5LqGJyxcbiAgICAgICAgICAgICfll6jlkYDvvIzmiJHlrrbph4zogIHkurrpg73mr5TkvaDmiZPnmoTlv6snLFxuICAgICAgICAgICAgJ+WXqOWRgO+8jOaJk+eJjOaJk+eahOaIkemDveWbsOS6hicsXG4gICAgICAgICAgICAn5ZOO77yM5L2g5b+r5oWi5oWi5om+77yM5oiR5YWI5Y676KW/5rmW6YCb5LiA5LiLJyxcbiAgICAgICAgICAgICflv6vkuIDngrnlkYDvvIzmiJHnrYnkvaDmg7Plpb3miJHljpXmiYDpg73kuIrkuIDotp/kuoYnLFxuICAgICAgICAgICAgJ+S9oOi/meWcqOW5suWYm++8jOi/meS5iOaFoicsXG4gICAgICAgICAgICAn5Zeo5ZGA77yM5pyA6L+R5Zyo5b+Z5LuA5LmI77yM5b6I5LmF5rKh6KeB5LqGJyxcbiAgICAgICAgICAgICfmnaXmnaXmnaXvvIzkuInnvLrkuIAnLFxuICAgICAgICAgICAgJ+adpeadpeadpe+8jOi1tue0p+WdkOS4i+adpeaJk+S4gOWciCcsXG4gICAgICAgICAgICAn6Lef5L2g5Lus6L+Z5Lqb6auY5omL5omT5oiR5Lya57Sn5byg77yM6K6p5oiR5LiA54K5JyxcbiAgICAgICAgICAgICfom67mmZrliLDlpKnkuq7vvIzovpPkuoblj6/ku6XorqnkvaDku6zlhYjmrKDnnYAnXG4gICAgICAgIF07XG4gICAgfSxcblxuICAgIHBhdXNlTXVzaWM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNvdW5kT24gPSBmYWxzZTtcbiAgICAgICAgY2MuYXVkaW9FbmdpbmUucGF1c2VNdXNpYygpO1xuICAgIH0sXG5cbiAgICByZXN1bWVNdXNpYzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc291bmRPbiA9IHRydWU7XG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnJlc3VtZU11c2ljKCk7XG4gICAgfSxcblxuICAgIF9wbGF5U0ZYOiBmdW5jdGlvbihjbGlwKSB7XG4gICAgICAgIGlmICh0aGlzLnNvdW5kT24pIHtcbiAgICAgICAgICAgIHZhciBhdWRpb0lkID0gY2MuYXVkaW9FbmdpbmUucGxheUVmZmVjdCggY2xpcCwgZmFsc2UgKTtcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnNldFZvbHVtZShhdWRpb0lkLHRoaXMubUVWYWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gYXVkaW9JZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICAvLyBNQVJLOiDliY3lkI7lj7Dmk43kvZxcbiAgICBfcmVnaXN0ZXJBcHBBY3RpdmVDaGFuZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX0hJREUsIHRoaXMuX2FwcEVudGVyQmFja2dyb3VuZCwgdGhpcyk7XG4gICAgICAgIGNjLmdhbWUub24oY2MuZ2FtZS5FVkVOVF9TSE9XLCB0aGlzLl9hcHBCZWNvbUFjdGl2ZSwgdGhpcyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOi/m+WFpeWQjuWPsFxuICAgICAqL1xuICAgIF9hcHBFbnRlckJhY2tncm91bmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcbiAgICAgICAgaWYgKG5vdyAtIHRoaXMuX2xhc3RBcHBFbnRlckJhY2tncm91bmRUaW1lIDwgMTAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbGFzdEFwcEVudGVyQmFja2dyb3VuZFRpbWUgPSBub3c7XG5cbiAgICAgICAgdGhpcy5wYXVzZU11c2ljKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOi/m+WFpeWJjeWPsFxuICAgICAqL1xuICAgIF9hcHBCZWNvbUFjdGl2ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xuICAgICAgICBpZiAobm93IC0gdGhpcy5fbGFzdEFwcEJlY29tQWN0aXZlVGltZSA8IDEwMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xhc3RBcHBCZWNvbUFjdGl2ZVRpbWUgPSBub3c7XG5cbiAgICAgICAgdGhpcy5yZXN1bWVNdXNpYygpO1xuICAgIH0sXG5cbiAgICAvKuehruWumuaMiemSrumfs+aViCovXG4gICAgcGxheUJ0bkNsaWNrU0ZYOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuY2xpY2tfd2VpeGluX2xvZ2luKTtcbiAgICB9LFxuICAgIC8q5YWs5YWx5oyJ6ZKu77yM5oyJ6ZSu5oiW6ICF5YWz6Zet5oyJ6ZKu5LmL57G755qE6Z+z5pWIKi9cbiAgICBwYWx5QnRuUHVibGljU0ZYOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX3dlaXhpbl9sb2dpbik7XG4gICAgfSxcblxuICAgIC8q5Y+W5raI5oyJ6ZKu6Z+z5pWIKi9cbiAgICBwYWx5QnRuQ2FuY2VsQ2xpY2tTRlg6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuY2xpY2tfd2VpeGluX2xvZ2luKTtcbiAgICB9LFxuICAgIHBhbHlCdG5DcmVhdGVSb29tU0ZYOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX3dlaXhpbl9sb2dpbik7XG4gICAgfSxcbiAgICBwYWx5V2luZG93U0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy53aW5kb3cpO1xuICAgIH0sXG4gICAgcGFseVdlaVhpbkxvZ2luU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5jbGlja193ZWl4aW5fbG9naW4pO1xuICAgIH0sXG4gICAgcGFseUZhbmdQYWlTRlg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmZhbmdQYWkpO1xuICAgIH0sXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEF1ZGlvTWFuYWdlcjtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBncmF5U3ByaXRlOiBjYy5TcHJpdGUsXG5cbiAgICAgICAgX2NhcmROYW1lOiBudWxsLFxuICAgICAgICBfa3FDYXJkTW9kZTogbnVsbFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuZ3JheVNwcml0ZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICAvLyDpgJrov4fniYzlkI3orr7nva7niYxcbiAgICBzZXRDYXJkOiBmdW5jdGlvbiAoY2FyZE5hbWUpIHtcbiAgICAgIHRoaXMuX3NldENhcmROYW1lKGNhcmROYW1lKTtcblxuICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZShjYXJkTmFtZSwgZnVuY3Rpb24gKHNwcml0ZUZyYW1lKSB7XG4gICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBjYXJkTmFtZTogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhcmROYW1lO1xuICAgIH0sXG5cbiAgICBjYXJkTW9kZTogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2txQ2FyZE1vZGU7XG4gICAgfSxcblxuICAgIF9zZXRDYXJkTmFtZTogZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICB0aGlzLl9jYXJkTmFtZSA9IGNhcmROYW1lO1xuICAgICAgdGhpcy5fa3FDYXJkTW9kZSA9IG5ldyBLUUNhcmQoY2FyZE5hbWUpO1xuICAgIH0sXG5cbiAgICAvLyDorr7nva7pgInmi6nnirbmgIFcbiAgICBzZXRTZWxlY3RlZDogZnVuY3Rpb24gKHNlbGVjdGVkID0gZmFsc2UpIHtcbiAgICAgIHRoaXMuZ3JheVNwcml0ZS5ub2RlLmFjdGl2ZSA9IHNlbGVjdGVkO1xuICAgIH0sXG5cbiAgICBpc1NlbGVjdGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5ncmF5U3ByaXRlLm5vZGUuYWN0aXZlO1xuICAgIH0sXG5cbiAgICBfY2FyZEZ1bGxOYW1lOiBmdW5jdGlvbiAoY2FyZFNob3J0TmFtZSkge1xuICAgICAgdmFyIGNhcmROYW1lID0gY2FyZFNob3J0TmFtZTtcbiAgICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChcInB1YmxpYy1waWMtY2FyZC1wb2tlclwiKSkge1xuICAgICAgICBjYXJkTmFtZSA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjYXJkTmFtZTtcbiAgICB9LFxuXG4gICAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2spIHtcbiAgICAgIGNjLmFzc2VydChjYWxsYmFjayk7XG5cbiAgICAgIGNjLmxvYWRlci5sb2FkUmVzKFwicGxheS9DYXJkVHlwZUNvbWJpbmUvcG9ja0xpc3RcIiwgY2MuU3ByaXRlQXRsYXMsIGZ1bmN0aW9uIChlcnIsIGF0bGFzKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICBjYy5lcnJvcihlcnIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNhcmROYW1lID0gdGhpcy5fY2FyZEZ1bGxOYW1lKGNhcmROYW1lKTtcbiAgICAgICAgdmFyIGZyYW1lID0gYXRsYXMuZ2V0U3ByaXRlRnJhbWUoY2FyZE5hbWUpO1xuICAgICAgICBjYWxsYmFjayhmcmFtZSk7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY29uc3QgS1FDYXJkRmluZFR5cGVFeHRlbnNpb24gPSByZXF1aXJlKCdLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbicpO1xuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5jb25zdCBwbGF5ID0gcmVxdWlyZSgncGxheScpO1xuY29uc3QgS1FDYXJkU2NvcmV0c0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFNjb3JldHNIZWxwZXInKTtcbi8vIOeJjOexu+WeiyBjb21wb25lbnRcbi8vXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuICAgIHN0YXRpY3M6IHtcbiAgICAgICAgaW5zdGFuY2VzOiBudWxsLFxuICAgIH0sXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBjYXJkc0xheW91dDogY2MuTGF5b3V0LFxuICAgICAgICAvLyBidG5EdWlaaTogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5MaWFuZ0R1aTogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5TYW5UaWFvOiBjYy5CdXR0b24sXG4gICAgICAgIC8vIGJ0blNodW5aaTogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5Ub25nSHVhOiBjYy5CdXR0b24sXG4gICAgICAgIC8vIGJ0bkh1THU6IGNjLkJ1dHRvbixcbiAgICAgICAgLy8gYnRuVGllWmhpOiBjYy5CdXR0b24sXG4gICAgICAgIC8vIGJ0blRvbmdIdWFTaHVuOiBjYy5CdXR0b24sXG4gICAgICAgIC8vIGJ0bld1VG9uZzogY2MuQnV0dG9uLFxuICAgICAgICAvLyB0eXBlQnV0dG9uc05vZGU6IGNjLk5vZGUsXG4gICAgICAgIGJ0bkRlbGV0ZVRvdURhbzogY2MuQnV0dG9uLCAgIC8vIOWktOmBk1xuICAgICAgICBidG5EZWxldGVaaG9uZ0RhbzogY2MuQnV0dG9uLCAvLyDkuK3pgZNcbiAgICAgICAgYnRuRGVsZXRlV2VpRGFvOiBjYy5CdXR0b24sICAgLy8g5bC+6YGTXG4gICAgICAgIGJ0bkNhbmNlbEFsbDogY2MuQnV0dG9uLCAgICAgIC8vIOWFqOmDqOWPlua2iFxuICAgICAgICBidG5Eb25lOiBjYy5CdXR0b24sICAgICAgICAgICAvLyDnoa7lrprlh7rniYxcbiAgICAgICAgdGltZU5vZGU6IGNjLk5vZGUsXG4gICAgICAgIGxhYmVsVGltZTogY2MuTGFiZWwsXG4gICAgICAgIGxheW91dFRvdURhbzogY2MuTGF5b3V0LFxuICAgICAgICBsYXlvdXRaaG9uZ0RhbzogY2MuTGF5b3V0LFxuICAgICAgICBsYXlvdXRXZWlEYW86IGNjLkxheW91dCxcbiAgICAgICAgY2FyZEFsbE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgY2FyZFByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBjYXJkVHlwZVByZWZhYjogY2MuUHJlZmFiLFxuXG4gICAgICAgIHRvdURhb05vZGU6Y2MuTm9kZSxcbiAgICAgICAgemhvbmdEYW9Ob2RlOmNjLk5vZGUsXG4gICAgICAgIHdlaURhb05vZGU6Y2MuTm9kZSxcblxuICAgICAgICBhdXRvQ2FyZFNjcm9sbFZpZXc6IGNjLlNjcm9sbFZpZXcsXG4gICAgICAgIGF1dG9DYXJkOiBjYy5QcmVmYWIsXG4gICAgICAgIGF1dG9DYXJkTGF5b3V0OiBjYy5MYXlvdXQsXG4gICAgICAgIGF1dG9DYXJkQW5pbWF0aW9uOmNjLk5vZGUsXG5cblxuICAgICAgICBMYXlvdXRXaXRoRXZlbnQ6IFtdLFxuXG4gICAgICAgIEJ0bkNsaWNrR29uZ1hpTmlDb21maXJtOmZhbHNlLCAgLy/nlKjkuo7mo4Dmn6XnlKjmiLfmmK/lkKbngrnlh7vkuobmga3llpzkvaDpobXpnaLnmoTnoa7lrprmjInpkq5cbiAgICAgICAgY2FyZHNMYXlvdXRTb3J0Q29sb3I6IGZhbHNlLFxuICAgICAgICAvKiMjIyMjKi9cblxuICAgICAgICBfY2FyZE9mZnNldFk6IG51bGwsXG5cbiAgICAgICAgX2txQ2FyZE1vZGVzOiBbXSxcbiAgICAgICAgX2FsbENhcmRNb2RlczogW10sXG4gICAgICAgIF9maW5kQ2FyZFR5cGVPYmplY3Q6IG51bGwsICAvLyDnlKjmnaXorrDlvZXmib7liLDnmoTniYzlnovlr7nosaFcbiAgICAgICAgX2ZpbmRDYXJkSW5kZXg6IG51bGwsICAvLyDnlKjmnaXorrDlvZXmib7liLDnmoTniYzlnovlr7nosaFcblxuICAgICAgICBfZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjazogbnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuQnRuQ2xpY2tHb25nWGlOaUNvbWZpcm0gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jYXJkT2Zmc2V0WSA9IDA7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyVG91Y2hFdmVudHMoKTtcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJEYW9zTGF5b3V0Q2xpY2tFdmVudCgpO1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIHRoaXMuX2ZpbmRDYXJkSW5kZXggPSB7fTtcbiAgICAgICAgdGhpcy5jYXJkVGltZSA9IDAuMztcblxuICAgICAgICB0aGlzLmNhcmRTcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQuZ2V0Q29tcG9uZW50KCdwbGF5JykuY2FyZFNwcml0ZUF0bGFzO1xuICAgICAgICB0aGlzLmRhb1Nwcml0ZUF0bGFzID0gdGhpcy5ub2RlLnBhcmVudC5nZXRDb21wb25lbnQoJ3BsYXknKS5kYW9TcHJpdGVBdGxhcztcbiAgICB9LFxuXG4gICAgLyojIyMjI+eCueWHu+epuueZveWcsOaWueWwhueJjOaUtuWbnuWOuyovXG4gICAgb25DbGlja0NhcmRUeXBlQ29tYmluZU5vZGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xuICAgIH0sXG5cbiAgICBfaGlkZURlbGV0ZUJ1dHRvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy90aGlzLmJ0bkRlbGV0ZVRvdURhby5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAvL3RoaXMuYnRuRGVsZXRlWmhvbmdEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgLy90aGlzLmJ0bkRlbGV0ZVdlaURhby5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICAvLyDph43nva7vvIzlm57liLDmnIDliJ3lp4vmnInnirbmgIFcbiAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9oaWRlRGVsZXRlQnV0dG9ucygpO1xuICAgICAgICB0aGlzLmNsZWFyQ2FyZHMoKTtcbiAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xuICAgICAgICAvL3RoaXMuX3R5cGVCdXR0b25zKCkuZm9yRWFjaChmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICAgIC8vICAgIGJ1dHRvbi5pbnRlcmFjdGFibGUgPSBmYWxzZTtcbiAgICAgICAgLy99KTtcbiAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzID0gW107XG4gICAgfSxcblxuICAgIGNhcmRzTGF5b3V0U29ydDogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIG5vZGVBeXkgPSBlLnRhcmdldC5jaGlsZHJlbjtcbiAgICAgICAgaWYobm9kZUF5eVswXS5hY3RpdmUgPT0gdHJ1ZSl7Ly/mjInlpKflsI9cbiAgICAgICAgICAgIHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSB0cnVlO1xuICAgICAgICAgICAgbm9kZUF5eVswXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIG5vZGVBeXlbMV0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKG5vZGVBeXlbMV0uYWN0aXZlID09IHRydWUpey8v5oyJ6Iqx6ImyXG4gICAgICAgICAgICB0aGlzLmNhcmRzTGF5b3V0U29ydENvbG9yID0gZmFsc2U7XG4gICAgICAgICAgICBub2RlQXl5WzBdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICBub2RlQXl5WzFdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWCgpO1xuICAgICAgICB9XG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9IG5vZGVBeXlbMV0uYWN0aXZlID09IGZhbHNlO1xuICAgICAgICAvL3RoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPT0gdHJ1ZVxuICAgIH0sXG5cbiAgICBhZGRDYXJkczogZnVuY3Rpb24gKGNhcmROYW1lcykge1xuICAgICAgICBjYy5hc3NlcnQoY2FyZE5hbWVzKTtcbiAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xuICAgICAgICAvL2NhcmROYW1lcy5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiAgICAgICAgLy8gICAgcmV0dXJuIGExLnNwbGl0KCdfJylbMF0gLSBhMi5zcGxpdCgnXycpWzBdO1xuICAgICAgICAvL30pXG4gICAgICAgIGNhcmROYW1lcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQsaW5kZXgpe1xuICAgICAgICAgICAgdGhpcy5hZGRDYXJkKGNhcmQsZmFsc2UsaW5kZXgpXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dFNvcnQoKTtcbiAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWCgpO1xuICAgICAgICB0aGlzLl9yZWxvYWRLUUNhcmRNb2Rlc0lubmVyKCk7XG4gICAgICAgIHRoaXMuX3Jlc2V0VHlwZUJ1dHRvbkVuYWJsZXNXaXRoTW9kZWxzKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICB9LFxuXG4gICAgYWRkQ2FyZDogZnVuY3Rpb24gKGNhcmROYW1lLCBhdXRvQ2hhbmdlUG9zaXRpb25YID0gZmFsc2UsaW5kZXggPSBudWxsKSB7XG4gICAgICAgIGNjLmFzc2VydChjYXJkTmFtZS5sZW5ndGggPiAwKTtcblxuICAgICAgICBsZXQgY2FyZFByZWZhYiA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2FyZFByZWZhYik7XG4gICAgICAgIGNhcmRQcmVmYWIubmFtZSA9IGNhcmROYW1lO1xuICAgICAgICAvLyBpZihjYy5tYVBhaSl7XG4gICAgICAgIC8vICAgICB2YXIgY2FyZE1hUGFpID0gJzNfJyArIGNjLm1hUGFpO1xuICAgICAgICAvLyAgICAgaWYoY2FyZE5hbWUgPT0gY2FyZE1hUGFpKXtcbiAgICAgICAgLy8gICAgICAgICBjYXJkUHJlZmFiLmNvbG9yID0gbmV3IGNjLkNvbG9yKDIyNiwgMTQ1LCAxNDUpO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyB9XG4gICAgICAgIGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuc2V0Q2FyZChjYXJkTmFtZSxpbmRleCk7XG4gICAgICAgIHRoaXMuY2FyZHNMYXlvdXQubm9kZS5hZGRDaGlsZChjYXJkUHJlZmFiKTtcbiAgICAgICAgY2FyZFByZWZhYi5zZXRQb3NpdGlvblkodGhpcy5fY2FyZE9mZnNldFkpO1xuXG4gICAgICAgIGlmIChhdXRvQ2hhbmdlUG9zaXRpb25YKSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25YKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy9sZXQgbmV3Q2FyZCA9IG5ldyBLUUNhcmQoY2FyZE5hbWUsbnVsbCxpbmRleCk7XG4gICAgICAgIC8vbGV0IG9yaWdpbkNhcmQgPSB0aGlzLl9hbGxDYXJkTW9kZXMuZmluZChmdW5jdGlvbihjYXJkKSB7XG4gICAgICAgIC8vICAgIHJldHVybiBjYXJkLmlzRXF1YWwobmV3Q2FyZCk7XG4gICAgICAgIC8vfSk7XG4gICAgICAgIC8vaWYgKG9yaWdpbkNhcmQgPT0gbnVsbCAmJiAhYXV0b0NoYW5nZVBvc2l0aW9uWCkge1xuICAgICAgICAvLyAgICB0aGlzLl9hbGxDYXJkTW9kZXMucHVzaChuZXdDYXJkKTtcbiAgICAgICAgLy99XG4gICAgfSxcblxuICAgIGFkZENhcmRNb2RlczogZnVuY3Rpb24gKGNhcmROYW1lcykge1xuICAgICAgICBjYy5hc3NlcnQoY2FyZE5hbWVzLmxlbmd0aCA+IDApO1xuICAgICAgICB0aGlzLl9hbGxDYXJkTW9kZXMgPSBbXTtcbiAgICAgICAgY2FyZE5hbWVzLmZvckVhY2goZnVuY3Rpb24oY2FyZE5hbWUsaW5kZXgpe1xuICAgICAgICAgICAgbGV0IG5ld0NhcmQgPSBuZXcgS1FDYXJkKGNhcmROYW1lLG51bGwsaW5kZXgpO1xuICAgICAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzLnB1c2gobmV3Q2FyZCk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIHJlbG9hZENhcmRzOiBmdW5jdGlvbiAoY2FyZE5hbWVzKSB7XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnMV8xJywgJzJfMScsICczXzExJywgJzFfMTInLCAnMl8yJywgJzNfMicsICc0XzExJywgJzRfMTInLCAnM18xMycsICcyXzUnLCAnMV8xMycsICc0XzMnLCAnMV8zJ107XG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzFfMScsICcyXzEnLCAnM18xMScsICcxXzEyJywgJzJfMicsICczXzInLCAnNF8xMScsICc0XzEyJywgJzNfMTMnLCAnMl81JywgJzFfMTMnLCAnNF8zJywgJzFfMyddO1xuICAgICAgICAvL+S4ieW6puWQjOiKsVxuICAgICAgICAvLyBjYXJkTmFtZXM9WycyXzEzJywgJzJfNScsICcyXzcnLCAnM18xJywgJzNfMicsICczXzQnLCAnM18zJywgJzNfMTMnLCAnMV8xMicsICcxXzYnLCAnMV8xJywgJzFfNCcsICcxXzUnXTtcbiAgICAgICAgLy/kuInlkIzoirHpobpcbiAgICAgICAgLy8gIGNhcmROYW1lcz1bJzJfMScsICcyXzInLCAnMl8zJywgJzJfNCcsICcyXzUnLCAnM182JywgJzNfNycsICczXzgnLCAnM185JywgJzNfMTAnLCAnNF8xJywgJzRfMicsICc0XzMnXTtcbiAgICAgICAgLy/kuIDmnaHpvplcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMl8xJywgJzJfMicsICcyXzMnLCAnMl80JywgJzJfNScsICczXzYnLCAnM183JywgJzNfOCcsICczXzknLCAnM18xMCcsICcxXzExJywgJzFfMTInLCAnMV8xMyddO1xuICAgICAgICAvL+S4iemhuuWtkFxuICAgICAgICAvL2NhcmROYW1lcz1bJzRfMScsICczXzInLCAnNF8zJywgJzFfNycsICc0XzUnLCAnNF82JywgJzNfOScsICc0XzgnLCAnM18xJywgJzFfMTMnLCAnNF8xMicsICc0XzExJywgJzJfMTAnXTtcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnM181JywgJzNfNCcsICc0XzMnLCAnMV8yJywgJzNfMScsICc0XzknLCAnM185JywgJzRfOCcsICczXzEwJywgJzFfMTMnLCAnNF8xMicsICc0XzExJywgJzJfMTAnXTtcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnM181JywgJzNfNCcsICc0XzMnLCAnMV8yJywgJzNfMScsICc0XzUnLCAnM182JywgJzRfOCcsICczXzYnLCAnMV8xMycsICc0XzEyJywgJzRfMTEnLCAnMl83J107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnM180JywgJzNfNCcsICc0XzYnLCAnMl8yMCcsICcxXzIwJywgJzFfMjAnLCAnM182JywgJzRfOCcsICczXzYnLCAnMV84JywgJzRfMTInLCAnNF8xMScsICcyXzIwJ107XG4gICAgICAgIC8v5LiJ5Liw5aSp5LiLXG4gICAgICAgIC8vY2FyZE5hbWVzPVsnMV8xJywgJzJfMScsICczXzEnLCAnMV8yJywgJzJfMicsICczXzInLCAnNF8xJywgJzRfMicsICczXzMnLCAnMl8zJywgJzFfMycsICc0XzMnLCAnMV8xMyddO1xuICAgICAgICAvLzTkuLDlpKnkuItcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMV8xJywgJzJfMScsICczXzEnLCAnMV80JywgJzJfNCcsICczXzInLCAnNF8yJywgJzFfMicsICczXzQnLCAnMl8zJywgJzFfMycsICc0XzMnLCAnMV8yJ107XG4gICAgICAgIC8v5YWt5bKB5Y2KXG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzFfMScsICcyXzEnLCAnM18xMScsICcxXzEyJywgJzJfMicsICczXzInLCAnNF8xMScsICc0XzEyJywgJzNfMTMnLCAnMl81JywgJzFfMTMnLCAnNF8zJywgJzFfMyddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzFfOScsICcyXzExJywgJzNfOCcsICcxXzEyJywgJzJfMicsICczXzInLCAnMV8xMycsICcyXzUnLCAnM181JywnMV80JywgJzJfNCcsICczXzQnLCAnM18xMCddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9Wyc0XzknLCAnMl8zJywgJzNfNCcsICczXzYnLCAnMl8xJywgJzJfNCcsICcyXzInLCAnMl81JywgJzJfMTMnLCcyXzgnLCAnMl8xMCcsICcyXzExJywgJzJfMTInXTtcbiAgICAgICAgLy8gICBjYXJkTmFtZXM9Wyc0XzInLCAnMl8zJywgJzNfNCcsICczXzUnLCAnMl8xJywgJzJfNCcsICcyXzInLCAnMl81JywgJzJfMTMnLCcyXzgnLCAnMl8xMCcsICcyXzExJywgJzJfMTInXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzEnLCAnMl8xJywgJzFfNCcsICczXzQnLCAnMV82JywgJzJfNicsICcxXzgnLCAnM184JywgJzJfOCcsJzJfMTInLCAnMV8xMicsICcyXzEzJywgJzNfMTMnXTtcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnNF85JywgJzJfMycsICczXzQnLCAnM182JywgJzJfOCcsICcyXzknLCAnMl8xMCcsICcyXzExJywgJzJfMTMnLCczXzEzJywgJzNfMTInLCAnMl8xMicsICcxXzEyJ107XG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzRfOScsICcyXzknLCAnM180JywgJzNfNicsICcxXzgnLCAnMl8xJywgJzJfNScsICcyXzQnLCAnMl8zJywnM18xMycsICczXzEyJywgJzJfMicsICcxXzEyJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnM18yJywgJzRfMicsICcyXzQnLCAnM181JywgJzFfNScsICczXzcnLCAnMl83JywgJzNfMTAnLCAnMl8xJywnMl8xMycsICcyXzEwJywgJzJfMTInLCAnMl8xMSddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzRfMicsICc0XzMnLCAnNF80JywgJzRfNScsICc0XzUnLCAnNF82JywgJzRfMTInLCAnNF8xMycsICcyXzEyJywnM18xMicsICcyXzgnLCAnM184JywgJzJfMTEnXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzMnLCAnMV8zJywgJzRfNScsICc0XzUnLCAnM181JywgJzJfNScsICcxXzIwJywgJzRfMTEnLCAnM18xMicsJzRfMTInLCAnNF84JywgJzRfMScsICcxXzEyJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8zJywgJzFfMycsICc0XzUnLCAnNF81JywgJzJfMjAnLCAnMV8yMCcsICcxXzIwJywgJzRfMTEnLCAnM18xMicsJzRfMTInLCAnNF84JywgJzRfMScsICcxXzEyJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8zJywgJzNfNCcsICc0XzYnLCAnNF81JywgJzJfNycsICcxXzIwJywgJzFfMycsICc0XzQnLCAnM182JywnNF83JywgJzRfOCcsICcyXzEyJywgJzFfMTInXTtcbiAgICAgICAgY2MubG9nKGNhcmROYW1lcylcbiAgICAgICAgdGhpcy5jbGVhckNhcmRzKCk7XG4gICAgICAgIHRoaXMuX2txQ2FyZE1vZGVzID0gW107XG4gICAgICAgIHRoaXMuYWRkQ2FyZHMoY2FyZE5hbWVzKTtcbiAgICB9LFxuXG4gICAgY2xlYXJDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdGhpcy5sYXlvdXRUb3VEYW8ubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuICAgICAgICB0aGlzLmxheW91dFpob25nRGFvLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdGhpcy5sYXlvdXRXZWlEYW8ubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuICAgIH0sXG5cbiAgICByZW1vdmVDYXJkOiBmdW5jdGlvbiAoY2FyZE5hbWUpIHtcbiAgICAgICAgaWYgKCFjYXJkTmFtZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2FyZHNMYXlvdXQubm9kZS5nZXRDaGlsZEJ5TmFtZShjYXJkTmFtZSkucmVtb3ZlRnJvbVBhcmVudCgpO1xuICAgIH0sXG5cbiAgICBzZXRGaW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIF9yZWxvYWRLUUNhcmRNb2Rlc0lubmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhpcy5fa3FDYXJkTW9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjYXJkUHJlZmFiTm9kZSkge1xuICAgICAgICAvLyAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmRQcmVmYWJOb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAvLyAgICByZXR1cm4gY2FyZFByZWZhYi5jYXJkTW9kZSgpO1xuICAgICAgICAvL30pLnNvcnQoS1FDYXJkLnNvcnQpO1xuICAgICAgICAvL3RoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCA9IG51bGw7XG4gICAgfSxcblxuICAgIF90eXBlQnV0dG9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3JldHVybiBbXG4gICAgICAgIC8vICAgIHRoaXMuYnRuRHVpWmksXG4gICAgICAgIC8vICAgIHRoaXMuYnRuTGlhbmdEdWksXG4gICAgICAgIC8vICAgIHRoaXMuYnRuU2FuVGlhbyxcbiAgICAgICAgLy8gICAgdGhpcy5idG5TaHVuWmksXG4gICAgICAgIC8vICAgIHRoaXMuYnRuVG9uZ0h1YSxcbiAgICAgICAgLy8gICAgdGhpcy5idG5IdUx1LFxuICAgICAgICAvLyAgICB0aGlzLmJ0blRpZVpoaSxcbiAgICAgICAgLy8gICAgdGhpcy5idG5Ub25nSHVhU2h1bixcbiAgICAgICAgLy8gICAgLyojIyMjIyovXG4gICAgICAgIC8vICAgIC8vdGhpcy5idG5XdVRvbmcsXG4gICAgICAgIC8vICAgIC8qIyMjIyMqL1xuICAgICAgICAvL107XG4gICAgfSxcblxuICAgIF9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVsczogZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICAgICAgICAvKmNhcmRNb2Rlcy5sZW5ndGggPT0gMTMqL1xuICAgICAgICAvL2NhcmRNb2RlcyA9IGNhcmRNb2RlcyB8fCB0aGlzLl9rcUNhcmRNb2RlcztcbiAgICAgICAgLy9cbiAgICAgICAgLy8vKiMjIyMj5Yid5aeL5YyW54mMKi9cbiAgICAgICAgLy92YXIgQnV0dG9uc0xheW91dENoaWxkcyA9IHRoaXMudHlwZUJ1dHRvbnNOb2RlLmNoaWxkcmVuO1xuICAgICAgICAvL2Zvcih2YXIgaT0wO2k8QnV0dG9uc0xheW91dENoaWxkcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgLy8gICAgQnV0dG9uc0xheW91dENoaWxkc1tpXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcbiAgICAgICAgLy99XG4gICAgICAgIC8vXG4gICAgICAgIC8vdGhpcy5idG5EdWlaaS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbkR1aVppKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vdGhpcy5idG5MaWFuZ0R1aS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbkxpYUR1aShjYXJkTW9kZXMpO1xuICAgICAgICAvL3RoaXMuYnRuU2FuVGlhby5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpblNhblRpYW8oY2FyZE1vZGVzKTtcbiAgICAgICAgLy90aGlzLmJ0blNodW5aaS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpblNodW5aaShjYXJkTW9kZXMpO1xuICAgICAgICAvL3RoaXMuYnRuVG9uZ0h1YS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpblRvbmdIdWEoY2FyZE1vZGVzKTtcbiAgICAgICAgLy90aGlzLmJ0bkh1THUuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5IdUx1KGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vdGhpcy5idG5UaWVaaGkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5UaWVaaGkoY2FyZE1vZGVzKTtcbiAgICAgICAgLy90aGlzLmJ0blRvbmdIdWFTaHVuLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZE1vZGVzKTtcbiAgICAgICAgLy8vL3RoaXMuYnRuV3VUb25nLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vLy9LUUNhcmQuaXNUZVNodVBhaShjYXJkTW9kZXMpXG4gICAgICAgIC8vLy9sZXQgdHlwZU5hbWUgPSBLUUNhcmQuY2FyZHNUeXAtZU5hbWUoY2FyZE1vZGVzKTtcbiAgICAgICAgLy8vL0tRQ2FyZC5pc0xpdUR1aUJhbihjYXJkTW9kZXMpO1xuICAgICAgICAvLy8vYWxlcnQodGhpcy5idG5TaHVuWmkuaW50ZXJhY3RhYmxlKVxuICAgICAgICAvLy8qIyMjIyPlpoLmnpzmnInlpJrkuIDoibLvvIzlsLHmmK/orr7nva7ml6DlkIzmjInpkq7nmoTlj6/kuqTkupLmgKcqL1xuICAgICAgICAvLy8vaWYoY2MuZHVvWWlTZSA9PSAwKSB7XG4gICAgICAgIC8vLy8gICAgdGhpcy53dVRvbmdOb2RlID0gdGhpcy50eXBlQnV0dG9uc05vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5XdVRvbmdcIik7XG4gICAgICAgIC8vLy8gICAgdGhpcy5idG5XdVRvbmcgPSB0aGlzLnd1VG9uZ05vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XG4gICAgICAgIC8vLy8gICAgdGhpcy5idG5XdVRvbmcuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZE1vZGVzKTtcbiAgICAgICAgLy8vL31cbiAgICAgICAgLy8vKiMjIyMjKi9cbiAgICAgICAgLy9cbiAgICAgICAgLy90aGlzLl9hdXRvQWN0aXZlVHlwZUJ1dHRvbnMoKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8vKiMjIyMj6K6+572u5oyJ6ZKu5Y+v5Lqk5LqS5ZKM5LiN5Y+v5Lqk5LqS5pe255qE6YCP5piO5bqmKi9cbiAgICAgICAgLy9mb3IodmFyIGk9MDtpPEJ1dHRvbnNMYXlvdXRDaGlsZHMubGVuZ3RoO2krKyl7XG4gICAgICAgIC8vICAgIGlmKEJ1dHRvbnNMYXlvdXRDaGlsZHNbaV0uZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlKXtcbiAgICAgICAgLy8gICAgICAgIEJ1dHRvbnNMYXlvdXRDaGlsZHNbaV0ub3BhY2l0eSA9IDI1NTtcbiAgICAgICAgLy8gICAgfWVsc2V7XG4gICAgICAgIC8vICAgICAgICBCdXR0b25zTGF5b3V0Q2hpbGRzW2ldLm9wYWNpdHkgPSAxMjU7XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy99XG4gICAgfSxcblxuICAgIC8vIOWwhuaJvuWIsOS6hueJjOexu+Wei+eahOeJjOeqgeWHuuWHuuadpVxuICAgIF9zdGlja091dEZpbmRDYXJkVHlwZTogZnVuY3Rpb24gKHRpdGxlLCBmaW5kTWV0aG9kcykge1xuXG4gICAgICAgIC8vIOWFiOagueaNrueJjOexu+Wei+aJvuWHuuaJgOacieeahOe0ouW8lembhuWQiFxuICAgICAgICAvL3ZhciBmaW5kZWRJbmRleHNBcnJheSA9IG51bGw7XG4gICAgICAgIC8vdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0ID0gdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0IHx8IHt9O1xuICAgICAgICAvL2lmICh0aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QudGl0bGUgIT0gdGl0bGUpIHtcbiAgICAgICAgLy8gICAgZmluZGVkSW5kZXhzQXJyYXkgPSAoZmluZE1ldGhvZHMoKSB8fCBbXSkucmV2ZXJzZSgpO1xuICAgICAgICAvL1xuICAgICAgICAvLyAgICBmb3IodmFyIGkgPTA7aTxmaW5kZWRJbmRleHNBcnJheS5sZW5ndGgtMTtpKyspey8v5Yig6Zmk5ZCM57G75Z6L54mMXG4gICAgICAgIC8vICAgICAgICB2YXIgaW5kZXggPSBmaW5kZWRJbmRleHNBcnJheVtpXTtcbiAgICAgICAgLy8gICAgICAgIC8qaWYodGl0bGUgPT0gJ2xpYW5nRHVpJyl7XG4gICAgICAgIC8vICAgICAgICAgbGV0IGpTdHJpbmdzcG9pbnQgPSBpbmRleC5tYXAoZnVuY3Rpb24oaW5kZXhzKXtcbiAgICAgICAgLy8gICAgICAgICByZXR1cm4gdGhpcy5fa3FDYXJkTW9kZXNbaW5kZXhzXS5wb2ludDtcbiAgICAgICAgLy8gICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAvLyAgICAgICAgIHZhciBpc0JyZWFrID0gZmFsc2U7XG4gICAgICAgIC8vICAgICAgICAgdmFyIHJlcE51bSA9IGpTdHJpbmdzcG9pbnQucmVkdWNlKGZ1bmN0aW9uKHAsbil7XG4gICAgICAgIC8vICAgICAgICAgaWYoIXBbbl0pe1xuICAgICAgICAvLyAgICAgICAgIHBbbl0gPSAxO1xuICAgICAgICAvLyAgICAgICAgIH1lbHNle1xuICAgICAgICAvLyAgICAgICAgIHBbbl0gKz0gMVxuICAgICAgICAvLyAgICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgICByZXR1cm4gcFxuICAgICAgICAvLyAgICAgICAgIH0se30pO1xuICAgICAgICAvLyAgICAgICAgIGZvcih2YXIgeSBpbiByZXBOdW0pe1xuICAgICAgICAvLyAgICAgICAgIGlmKHJlcE51bVt5XSA+PSAzKXtcbiAgICAgICAgLy8gICAgICAgICBpc0JyZWFrID0gdHJ1ZTtcbiAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgIGlmKGlzQnJlYWspe1xuICAgICAgICAvLyAgICAgICAgIGNjLmxvZyhyZXBOdW0pXG4gICAgICAgIC8vICAgICAgICAgY2MubG9nKGZpbmRlZEluZGV4c0FycmF5KVxuICAgICAgICAvLyAgICAgICAgIGNjLmxvZyhpKVxuICAgICAgICAvLyAgICAgICAgIGNjLmxvZygnLS0tLS0tLS0yOTEnKVxuICAgICAgICAvLyAgICAgICAgIGZpbmRlZEluZGV4c0FycmF5LnNwbGljZShpLDEpO1xuICAgICAgICAvLyAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAvLyAgICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgICB9Ki9cbiAgICAgICAgLy8gICAgICAgIHZhciBpU3RyaW5nID0gJyc7XG4gICAgICAgIC8vICAgICAgICBmb3IodmFyIGogPWkrMTtqPGZpbmRlZEluZGV4c0FycmF5Lmxlbmd0aDtqKyspe1xuICAgICAgICAvLyAgICAgICAgICAgIHZhciBzID0gZmluZGVkSW5kZXhzQXJyYXlbal07XG4gICAgICAgIC8vICAgICAgICAgICAgdmFyIGpTdHJpbmcgPSAnJztcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgICAgICAgICBsZXQgaVN0cmluZ3MgPSBzLm1hcChmdW5jdGlvbihpbmRleCl7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgIGxldCBjYXJkTW9kZWwgPSB0aGlzLl9rcUNhcmRNb2Rlc1tpbmRleF07XG4gICAgICAgIC8vICAgICAgICAgICAgICAgIHJldHVybiBjYXJkTW9kZWwuY2FyZE5hbWUoKTtcbiAgICAgICAgLy8gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAvL1xuICAgICAgICAvLyAgICAgICAgICAgIGxldCBqU3RyaW5ncyA9IGluZGV4Lm1hcChmdW5jdGlvbihpbmRleHMpe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBsZXQgY2FyZE1vZGVsID0gdGhpcy5fa3FDYXJkTW9kZXNbaW5kZXhzXTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgcmV0dXJuIGNhcmRNb2RlbC5jYXJkTmFtZSgpO1xuICAgICAgICAvLyAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgICAgICAgICAgZm9yKHZhciByID0gMDtyIDwgaW5kZXgubGVuZ3RoO3IrKyl7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgIGpTdHJpbmcgPSBqU3RyaW5nICsgaVN0cmluZ3Nbcl07XG4gICAgICAgIC8vICAgICAgICAgICAgICAgIGlTdHJpbmcgPSBpU3RyaW5nICsgalN0cmluZ3Nbcl07XG4gICAgICAgIC8vICAgICAgICAgICAgfVxuICAgICAgICAvL1xuICAgICAgICAvLyAgICAgICAgICAgIGlmKGpTdHJpbmcgPT0gaVN0cmluZyl7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgIGZpbmRlZEluZGV4c0FycmF5LnNwbGljZShpLDEpO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gICAgICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0ID0ge1xuICAgICAgICAvLyAgICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgICAvLyAgICAgICAgaW5kZXhzQXJyYXk6IGZpbmRlZEluZGV4c0FycmF5LFxuICAgICAgICAvLyAgICAgICAgLy9pbmRleDogdGl0bGU9PVwiZHVpWmlcIj9maW5kZWRJbmRleHNBcnJheS5sZW5ndGgtMTowXG4gICAgICAgIC8vICAgICAgICBpbmRleDogMFxuICAgICAgICAvLyAgICB9O1xuICAgICAgICAvL31cbiAgICAgICAgLy9cbiAgICAgICAgLy9maW5kZWRJbmRleHNBcnJheSA9IHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdC5pbmRleHNBcnJheTtcbiAgICAgICAgLy9pZiAoIWZpbmRlZEluZGV4c0FycmF5IHx8IGZpbmRlZEluZGV4c0FycmF5Lmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgLy99XG4gICAgICAgIC8vLy8g5bCG5bey5pyJ55qE56qB5Ye655qE54mM55qE5L2N572u6YeN572u5Zue5Yid5aeL5L2N572uXG4gICAgICAgIC8vdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xuICAgICAgICAvL1xuICAgICAgICAvLy8vIOiuoeeul+WHuuimgeeqgeWHuueahOeJjOaVsOe7hFxuICAgICAgICAvL3ZhciBpbmRleCA9IHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdC5pbmRleDtcbiAgICAgICAgLy9sZXQgaW5kZXhzID0gZmluZGVkSW5kZXhzQXJyYXlbaW5kZXhdO1xuICAgICAgICAvL1xuICAgICAgICAvL2xldCBzZWxlY3RlZENhcmROYW1lcyA9IGluZGV4cy5tYXAoZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICAvLyAgICBsZXQgY2FyZE1vZGVsID0gdGhpcy5fa3FDYXJkTW9kZXNbaW5kZXhdO1xuICAgICAgICAvLyAgICByZXR1cm4gY2FyZE1vZGVsLmNhcmROYW1lKCk7XG4gICAgICAgIC8vfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLmZpbHRlcihmdW5jdGlvbiAoY2FyZE5vZGUpIHtcbiAgICAgICAgLy8gICAgbGV0IGNhcmRQcmVmYWIgPSBjYXJkTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgLy8gICAgaWYoc2VsZWN0ZWRDYXJkTmFtZXMuaW5jbHVkZXMoY2FyZFByZWZhYi5jYXJkTmFtZSgpKSkge1xuICAgICAgICAvLyAgICAgICAgdmFyIG5hbWVJbmRleCA9IHNlbGVjdGVkQ2FyZE5hbWVzLmluZGV4T2YoY2FyZFByZWZhYi5jYXJkTmFtZSgpKTtcbiAgICAgICAgLy8gICAgICAgIHNlbGVjdGVkQ2FyZE5hbWVzLnNwbGljZShuYW1lSW5kZXgsMSk7XG4gICAgICAgIC8vICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvLyAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIC8vfSk7XG5cbiAgICAgICAgLy8vLyDnqoHlh7rorqHnrpflh7rmnaXnmoTniYzmlbDnu4RcbiAgICAgICAgLy90aGlzLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcbiAgICAgICAgLy8vLyDkv53lrZjlpb3vvIznlKjkuo7lho3mrKHngrnlh7vkuobnqoHlh7rkuIvkuIDnu4TniYxcbiAgICAgICAgLy9pbmRleCA9IChpbmRleCArIDEpICUgZmluZGVkSW5kZXhzQXJyYXkubGVuZ3RoO1xuICAgICAgICAvL3RoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdC5pbmRleCA9IGluZGV4O1xuICAgIH0sXG5cbiAgICBjbGlja0R1aVppOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwiZHVpWmlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kRHVpWmkodGhpcy5fa3FDYXJkTW9kZXMpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBjbGlja0xpYW5nRHVpOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwibGlhbmdEdWlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kTGlhRHVpKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tTYW5UaWFvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwic2FuVGlhb1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRTYW5UaWFvKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tTaHVuWmk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJzaHVuWmlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kU2h1blppKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tUb25nSHVhOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwidG9uZ0h1YVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tIdUx1OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwiaHVMdVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRIdUx1KHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tUaWVaaGk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJ0aWVaaGlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kVGllWmhpKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgLyojIyMjIyovXG4gICAgY2xpY2tXdVRvbmc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJ3dVRvbmdcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kV3VUb25nKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuICAgIC8qIyMjIyMqL1xuXG4gICAgY2xpY2tUb25nSHVhU2h1bjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcInRvbmdIdWFTaHVuXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZFRvbmdIdWFTaHVuKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tDYW5jZWxBbGw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jbGlja0RlbGV0ZVRvdURhbygpO1xuICAgICAgICB0aGlzLmNsaWNrRGVsZXRlWmhvbmdEYW8oKTtcbiAgICAgICAgdGhpcy5jbGlja0RlbGV0ZVdlaURhbygpO1xuICAgIH0sXG5cbiAgICAvKueCueWHu+WujOaIkOaMiemSriovXG4gICAgY2xpY2tEb25lOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRpbWVzdGFtcFwiKTtcbiAgICAgICAgdGhpcy5jYXJkQWxscyA9ICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi55IC0gYS55O30pLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS5jaGlsZHJlblswXTt9KTtcblxuICAgICAgICBsZXQgdG91Q2FyZE1vZGVscyA9IHRoaXMuX3Rhb0Rhb0NhcmRNb2RlcygpO1xuICAgICAgICBsZXQgemhvbmdDYXJkTW9kZXMgPSB0aGlzLl96aG9uZ0Rhb0NhcmRNb2RlcygpO1xuICAgICAgICBsZXQgd2VpQ2FyZE1vZGVzID0gdGhpcy5fd2VpRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIHRoaXMuX2RpZFNlbGVjdGVkQ2FyZHModG91Q2FyZE1vZGVscywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2Rlcyk7XG4gICAgfSxcblxuICAgIC8q54K55Ye75oGt5Zac5L2g6aG16Z2i55qE56Gu5a6a5oyJ6ZKuKi9cbiAgICBvbkJ0bkdvbmdYaU5pQ29tZmlybUNsaWNrOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy/orrDlvZXnjqnlrrbngrnlh7vkuobnoa7lrprmjInpkq7vvJpcbiAgICAgICAgdGhpcy5CdG5DbGlja0dvbmdYaU5pQ29tZmlybSA9IHRydWU7XG5cbiAgICAgICAgdmFyIGNhcmRzID0gW107XG5cbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2NhcmRzID0gY2FyZHMuY29uY2F0KGkpO30pO1xuXG4gICAgICAgIHZhciB0ZVNodVBhaUNhcmRzU2VydmVySW5mbyA9IHRoaXMuX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWwyKGNhcmRzKTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFt0ZVNodVBhaUNhcmRzU2VydmVySW5mb107XG4gICAgICAgIGlmICh0aGlzLl9maW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9maW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX2RpZFNlbGVjdGVkQ2FyZHM6IGZ1bmN0aW9uICh0b3VDYXJkcywgemhvbmdDYXJkcywgd2VpQ2FyZHMpIHtcbiAgICAgICAgdG91Q2FyZHMgPSB0b3VDYXJkcyB8fCBbXTtcbiAgICAgICAgemhvbmdDYXJkcyA9IHpob25nQ2FyZHMgfHwgW107XG4gICAgICAgIHdlaUNhcmRzID0gd2VpQ2FyZHMgfHwgW107XG4gICAgICAgIGxldCB0b3VTZXJ2ZXJJbmZvID0gdGhpcy5fY29udmVydENhcmRzVG9TZXJ2ZXJNb2RlbCh0b3VDYXJkcyk7XG4gICAgICAgIGxldCB6aG9uZ1NlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsKHpob25nQ2FyZHMpO1xuICAgICAgICBsZXQgd2VpU2VydmVySW5mbyA9IHRoaXMuX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWwod2VpQ2FyZHMpO1xuXG4gICAgICAgIC8vY29uc29sZS5sb2codG91U2VydmVySW5mbyk7XG4gICAgICAgIC8vY29uc29sZS5sb2coemhvbmdTZXJ2ZXJJbmZvKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyh3ZWlTZXJ2ZXJJbmZvKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTUxMlwiKTtcbiAgICAgICAgaWYoISh0b3VTZXJ2ZXJJbmZvLnZhbHVlIDwgemhvbmdTZXJ2ZXJJbmZvLnZhbHVlICYmIHpob25nU2VydmVySW5mby52YWx1ZSA8PSB3ZWlTZXJ2ZXJJbmZvLnZhbHVlKSl7XG4gICAgICAgICAgICB0aGlzLmF1dG9DYXJkQW5pbWF0aW9uLnkgPSAtNTA7XG4gICAgICAgICAgICB0aGlzLmF1dG9DYXJkQW5pbWF0aW9uLm9wYWNpdHkgPSAyNTU7XG4gICAgICAgICAgICB0aGlzLmF1dG9DYXJkQW5pbWF0aW9uLnJ1bkFjdGlvbihjYy5tb3ZlVG8oMSwgY2MucCgwLCAwKSkpO1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBjYy5zcGF3bihjYy5tb3ZlVG8odGhpcy5jYXJkVGltZSwgY2MucCgwLCAxMCkpLCBjYy5mYWRlT3V0KHRoaXMuY2FyZFRpbWUpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9DYXJkQW5pbWF0aW9uLnJ1bkFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCAxLjUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXN1bHQgPSBbdG91U2VydmVySW5mbywgemhvbmdTZXJ2ZXJJbmZvLCB3ZWlTZXJ2ZXJJbmZvXTtcbiAgICAgICAgLy9yZXR1cm47XG4gICAgICAgIGlmICh0aGlzLl9maW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9maW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xpY2tEZWxldGVUb3VEYW86IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGVsZXRlRGFvQ2FyZHNPZkxheW91dCh0aGlzLmxheW91dFRvdURhby5ub2RlKTtcbiAgICB9LFxuXG4gICAgY2xpY2tEZWxldGVaaG9uZ0RhbzogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkc09mTGF5b3V0KHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZSk7XG4gICAgfSxcblxuICAgIGNsaWNrRGVsZXRlV2VpRGFvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2RlbGV0ZURhb0NhcmRzT2ZMYXlvdXQodGhpcy5sYXlvdXRXZWlEYW8ubm9kZSk7XG4gICAgfSxcblxuICAgIC8vIOiuoeaXtuWZqOS6i+S7tlxuICAgIHRpbWVTdGFydDogZnVuY3Rpb24gKGR1cmF0aW9uKSB7XG4gICAgICAgIGNjLmFzc2VydChkdXJhdGlvbiA+IDApO1xuICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XG4gICAgICAgIHRoaXMudGltZU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInRpbWVzdGFtcFwiKTsgIC8vIOiOt+WPluacrOWcsOWtmOWCqOeahOaXtumXtOaIs1xuICAgICAgICBpZih0aW1lc3RhbXApeyAgLy8g5aaC5p6c5pyJ5YiZ6K+B5piO546p5a625piv6YeN5paw6L+b5p2l5LqG55qEXG4gICAgICAgICAgICB2YXIgbm93ID0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTtcbiAgICAgICAgICAgIHZhciB0aW1lID0gZHVyYXRpb24qMTAwMDtcbiAgICAgICAgICAgIGlmKG5vdyAtIHRpbWVzdGFtcCA+IHRpbWUpeyAvLyDotoXml7ZcbiAgICAgICAgICAgICAgICBpZihub3cgLSB0aW1lc3RhbXAgPCAyKnRpbWUpe1xuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IDU7ICAvLyDnjqnlrrblj6/og73lh7rkuo7lhbbku5bljp/lm6DpgIDlh7rmuLjmiI/lr7zoh7TotoXml7bvvIzkuLrlhbbmj5Dkvps156eS5pe26Ze05pW055CG54mM5Z6L77yI6L+Z5bey57uP5piv5b6I5LuB5oWI55qE5LqG77yJ44CCXG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRpbWVzdGFtcFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IE1hdGguZmxvb3IoIGR1cmF0aW9uIC0gKG5vdyAtIHRpbWVzdGFtcCkvMTAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1lbHNleyAgLy8g5aaC5p6c5rKh5pyJ5pe26Ze05oiz77yM5YiZ5L+d5a2Y77yM5Li6546p5a626YCA5Ye65ri45oiP5L+d55WZ6K+B5o2u77ybXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTsgICAgIFxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0aW1lc3RhbXAnLHRpbWVzdGFtcCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IFN0cmluZyhkdXJhdGlvbik7XG4gICAgICAgIHRoaXMudGltZU5vZGUuZ2V0Q29tcG9uZW50KFwidGltZVwiKS5zZXRUaW1lKGR1cmF0aW9uICogMC41KTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZSh0aGlzLl90aW1lTWV0aG9kLCAxLCBkdXJhdGlvbik7XG4gICAgfSxcblxuICAgIHRpbWVTdG9wOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLl90aW1lTWV0aG9kKTtcbiAgICAgICAgdGhpcy50aW1lTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgX3RpbWVNZXRob2Q6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uID0gdGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uIC0gMTtcblxuICAgICAgICB2YXIgcmVtYWluID0gTWF0aC5tYXgodGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uLCAwKTtcbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gKHJlbWFpbiA8IDEwICYmIHJlbWFpbiA+IDApID8gKCcwJyArIHJlbWFpbikgOiByZW1haW47XG5cbiAgICAgICAgaWYgKHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA8PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XG4gICAgICAgICAgICBpZihjYy5jaGFvU2hpQ2h1UGFpID09IHRydWUpIHRoaXMuX3RpbWVPdXRBdXRvU2VsZWN0Q2FyZHMoKTtcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRpbWVzdGFtcFwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyDotoXml7blkI7vvIzoh6rliqjpgInniYxcbiAgICBfdGltZU91dEF1dG9TZWxlY3RDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICog6ZqQ6JeP5oGt5Zac5L2gXG4gICAgICAgICAqL1xuICAgICAgICBwbGF5LmdvbmdYaU5pU2hvdyhmYWxzZSk7XG4gICAgICAgIGlmICh0eXBlb2YoY2MudGVTaHVQYWlDYXJkcykgIT0gXCJ1bmRlZmluZWRcIiAmJiBjYy50ZVNodVBhaUNhcmRzICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMub25CdG5Hb25nWGlOaUNvbWZpcm1DbGljaygpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9sZXQgW3RvdUNhcmRNb2RlbHMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXNdID0gdGhpcy5fY2FjbGVBdXRvU2VsZWN0ZWRDYXJkcygpO1xuICAgICAgICBsZXQgW3RvdUNhcmRNb2RlbHMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXNdID0gdGhpcy5fZmluZENhcmRJbmRleC5hcnJbMF07XG5cblxuICAgICAgICBpZiAodG91Q2FyZE1vZGVscyA9PSBudWxsIHx8IHpob25nQ2FyZE1vZGVzID09IG51bGwgfHwgd2VpQ2FyZE1vZGVzID09IG51bGwpIHtcbiAgICAgICAgICAgIHRvdUNhcmRNb2RlbHMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoLTMpO1xuICAgICAgICAgICAgemhvbmdDYXJkTW9kZXMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoNSwgMTApO1xuICAgICAgICAgICAgd2VpQ2FyZE1vZGVzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLnNsaWNlKDAsIDUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2MubG9nKHRvdUNhcmRNb2RlbHMpXG4gICAgICAgIC8vIGNjLmxvZyh6aG9uZ0NhcmRNb2RlcylcbiAgICAgICAgLy8gY2MubG9nKHdlaUNhcmRNb2RlcylcbiAgICAgICAgLy8gY2MubG9nKHRoaXMuX2FsbENhcmRNb2RlcylcbiAgICAgICAgLy8gY2MubG9nKFwi6Ieq5Yqo6YCJ54mMIHRvdUNhcmRNb2RlbHMgemhvbmdDYXJkTW9kZXMgd2VpQ2FyZE1vZGVz77yaXCIpO1xuICAgICAgICB0aGlzLl9kaWRTZWxlY3RlZENhcmRzKHRvdUNhcmRNb2RlbHMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXMpO1xuICAgIH0sXG5cbiAgICBfY2FjbGVBdXRvU2VsZWN0ZWRDYXJkczogZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBjYXJkcyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5maWx0ZXIoZnVuY3Rpb24oaSl7XG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciByZXN1bHRDYXJkcyA9IFtdO1xuICAgICAgICBmb3IodmFyIGkgPSAxO2kgPCAzOyBpKyspe1xuICAgICAgICAgICAgbGV0IGNhcmRzcyA9IEtRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMoY2FyZHMsIDUpO1xuICAgICAgICAgICAgY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkc3MpO1xuICAgICAgICAgICAgcmVzdWx0Q2FyZHMucHVzaChjYXJkc3MpO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdENhcmRzLnB1c2goY2FyZHMpO1xuICAgICAgICAvL2xldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0Q2FyZHNbMl0pO1xuICAgICAgICAvL2xldCB6aG9uZ1Njb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhyZXN1bHRDYXJkc1sxXSk7XG4gICAgICAgIC8vbGV0IHdlaVNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhyZXN1bHRDYXJkc1swXSk7XG4gICAgICAgIC8vIGNjLmxvZyhyZXN1bHRDYXJkcylcbiAgICAgICAgLy8gY2MubG9nKHRoaXMuX2FsbENhcmRNb2RlcylcbiAgICAgICAgLy8gY2MubG9nKFwi54mM5YiG5pWw6Ieq5Yqo6YCJ54mM77yaXCIsIHRvdVNjb3JlLCB6aG9uZ1Njb3JlLCB3ZWlTY29yZSk7XG4gICAgICAgIC8vbGV0IHdlaUNhcmRNb2RlcyA9IEtRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMoY2FyZHMsIDUpO1xuICAgICAgICAvL2NhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMod2VpQ2FyZE1vZGVzKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgemhvbmdDYXJkTW9kZXMgPSBLUUNhcmQuYXV0b1NlbGVjdENhcmRzKGNhcmRzLCA1KTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgdG91Q2FyZE1vZGVzID0gY2FyZHMua3FfZXhjbHVkZXMoemhvbmdDYXJkTW9kZXMpO1xuICAgICAgICAvL2lmICh0b3VDYXJkTW9kZXMubGVuZ3RoID09IDMgJiYgemhvbmdDYXJkTW9kZXMubGVuZ3RoID09IDUgJiYgd2VpQ2FyZE1vZGVzLmxlbmd0aCA9PSA1KSB7XG4gICAgICAgIC8vICAgIHJldHVybiBbdG91Q2FyZE1vZGVzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzXTtcbiAgICAgICAgLy99XG4gICAgICAgIGlmIChyZXN1bHRDYXJkc1syXS5sZW5ndGggPT0gMyAmJiByZXN1bHRDYXJkc1sxXS5sZW5ndGggPT0gNSAmJiByZXN1bHRDYXJkc1swXS5sZW5ndGggPT0gNSkge1xuICAgICAgICAgICAgcmV0dXJuIFtyZXN1bHRDYXJkc1syXSwgcmVzdWx0Q2FyZHNbMV0sIHJlc3VsdENhcmRzWzBdXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9LFxuXG4gICAgX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWw6IGZ1bmN0aW9uIChjYXJkcykge1xuICAgICAgICBsZXQgcmVzdWx0ID0ge307XG4gICAgICAgIHJlc3VsdC50eXBlID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkcyk7XG4gICAgICAgIHJlc3VsdC52YWx1ZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoY2FyZHMpO1xuICAgICAgICBjYXJkcyA9IEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMxKGNhcmRzKTtcbiAgICAgICAgcmVzdWx0LmNhcmRzID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKGNhcmRzKTtcblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG5cbiAgICAvKiMjIyMjKi9cbiAgICBfY29udmVydENhcmRzVG9TZXJ2ZXJNb2RlbDI6IGZ1bmN0aW9uIChjYXJkcykge1xuICAgICAgICB2YXIgY29udmVydFRvU2VydmVyQ2FyZHMgPSBbXTtcblxuICAgICAgICBjYy50ZVNodVBhaUNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZE1vZGUpe1xuICAgICAgICAgICAgdmFyIGFyciA9IFtdO1xuICAgICAgICAgICAgY2FyZE1vZGUgPSBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkTW9kZSkpO1xuICAgICAgICAgICAgY2FyZE1vZGUuZm9yRWFjaChmdW5jdGlvbihjY2Epe1xuICAgICAgICAgICAgICAgIHZhciBwb2ludCA9IGNjYS5wb2ludCA9PSAxNCA/IDE6Y2NhLnBvaW50O1xuICAgICAgICAgICAgICAgIGFyci5wdXNoKHtudW1iZXI6cG9pbnQsc3VpdDpjY2EuY29sb3J9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29udmVydFRvU2VydmVyQ2FyZHMucHVzaChhcnIpO1xuICAgICAgICB9KTtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHt9O1xuICAgICAgICByZXN1bHQudHlwZSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMpO1xuICAgICAgICByZXN1bHQudmFsdWUgPSAwO1xuICAgICAgICByZXN1bHQuY2FyZHMgPSBjb252ZXJ0VG9TZXJ2ZXJDYXJkcztcblxuICAgICAgICBpZiAocmVzdWx0LnR5cGUgPj0gS1FDYXJkLlRZUEUuU2FuVGFvSHVhICYmIGNjLm1vc2hpICE9IDEpIHtcbiAgICAgICAgICAgIC8vIOeJueauiueJjFxuICAgICAgICAgICAgcmVzdWx0LmlzQ29udGFpbkV4dHJhID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcbiAgICAvKiMjIyMjKi9cbiAgICAvLyDnibnmrorniYzph4zmmK/lkKbov5jlkKvmnInnibnmrorniYxcbiAgICAvLyDljIXlkKvnmoTmg4XlhrXmnInvvJpcbiAgICAvLyDkuInmoYPoirEg5Y+v6IO95ZCr5pyJ5ZCM6Iqx6aG6XG4gICAgLy8g5LiJ6aG65a2QIOWPr+iDveWQq+acieWQjOiKsemhulxuICAgIC8vIOWFreWvueWNiiDlj6/og73lkKvmnInpk4HmlK9cbiAgICBfaXNDb250YWluRXh0cmFDYXJkc1R5cGU6IGZ1bmN0aW9uICh0eXBlLCBjYXJkcykge1xuICAgICAgICBpZiAodHlwZSA9PSBLUUNhcmQuVFlQRS5TYW5UYW9IdWEpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRzKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IEtRQ2FyZC5UWVBFLlNhblNodW5aaSkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gS1FDYXJkLlRZUEUuTGl1RHVpQmFuKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNvbnRhaW5UaWVaaGkoY2FyZHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LFxuXG4gICAgLy8g6Kem5pG45LqL5Lu2XG4gICAgX3JlZ2lzdGVyVG91Y2hFdmVudHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIHRoaXMuX3RvdWNoQ2FyZExheW91dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRSwgdGhpcy5fdG91Y2hDYXJkTGF5b3V0LmJpbmQodGhpcykpO1xuICAgICAgICAvL3RoaXMuY2FyZHNMYXlvdXQubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsIHRoaXMuX3RvdWNoQ2FyZExheW91dEVuZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLCB0aGlzLl90b3VjaENhcmRMYXlvdXRFbmQuYmluZCh0aGlzKSk7XG4gICAgfSxcbiAgICBjYWNsZUF1dG9TZWxlY3RlZENhcmRzSW5kZXg6IGZ1bmN0aW9uKGNhcmRzKSB7XG4gICAgICAgIC8vY2MubG9nKCctLS0tLS02MjInKVxuICAgICAgICBsZXQgdGVzdEZpbmQgPSBLUUNhcmQudGVzdEZpbmQoY2FyZHMpIHx8IFtdO1xuICAgICAgICAvL2NjLmxvZygnLS0tLS0tNjIyMScpXG4gICAgICAgIHZhciByZXN1bHQgPSBbXVxuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCB0ZXN0RmluZC5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB2YXIgcyA9IHRlc3RGaW5kW2ldO1xuICAgICAgICAgICAgaWYocy5sZW5ndGggPj0gMSl7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBqID0gMDtqIDwgcy5sZW5ndGg7IGorKyl7XG4gICAgICAgICAgICAgICAgICAgIC8vcmVzdWx0LnB1c2goc1swXSk7Ly/lj6rlj5bkuIDkuKpcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goc1tqXSk7Ly9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuXG4gICAgY2FjbGVBdXRvU2VsZWN0ZWRDYXJkc0FycmF5OiBmdW5jdGlvbihjYXJkcykge1xuICAgICAgICB2YXIgaW5kZXhzID0gdGhpcy5jYWNsZUF1dG9TZWxlY3RlZENhcmRzSW5kZXgoY2FyZHMpO1xuICAgICAgICBpZihpbmRleHMubGVuZ3RoIDwgMSl7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHNlbGVjdGVkQ2FyZCA9IFtdO1xuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCBpbmRleHMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgbGV0IHMgPSBpbmRleHNbaV07XG4gICAgICAgICAgICBsZXQgYSA9IHMubWFwKGZ1bmN0aW9uKGluZGV4KXtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FyZHNbaW5kZXhdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWxlY3RlZENhcmQucHVzaChhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VsZWN0ZWRDYXJkO1xuICAgIH0sXG5cbiAgICBjYWNsZUF1dG9TZWxlY3RlZENhcmRzMjogZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBjYXJkcyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSgpO1xuICAgICAgICB2YXIgY2FyZHNBcnJheSA9IHRoaXMuY2FjbGVBdXRvU2VsZWN0ZWRDYXJkc0FycmF5KGNhcmRzKTtcbiAgICAgICAgdmFyIHJlc3VsdEFycmF5ID0gW107XG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IGNhcmRzQXJyYXkubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICBsZXQgcyA9IGNhcmRzQXJyYXlbaV0gfHwgW107XG4gICAgICAgICAgICBsZXQgcXdlciA9IFtdO1xuICAgICAgICAgICAgZm9yKHZhciBqID0gMTtqIDwgY2FyZHNBcnJheS5sZW5ndGg7aisrKXtcbiAgICAgICAgICAgICAgICBsZXQgZCA9IGNhcmRzQXJyYXlbal0gfHwgW107XG4gICAgICAgICAgICAgICAgbGV0IHNDID0gcy5rcV9leGNsdWRlcyhkKTtcbiAgICAgICAgICAgICAgICBpZihzQy5sZW5ndGggPT0gcy5sZW5ndGggJiYgcy5sZW5ndGggPiAwKXsvL+WIpOaWreeJjOebuOWQjCDljbPmsqHmnInph43lpI3nmoRcbiAgICAgICAgICAgICAgICAgICAgcXdlciA9IFtzLGRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHF3ZXIubGVuZ3RoID4gMSl7XG4gICAgICAgICAgICAgICAgcmVzdWx0QXJyYXkucHVzaChxd2VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8v6KGl5YWo6K6h5YiSMVxuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCByZXN1bHRBcnJheS5sZW5ndGg7aSsrKXtcblxuICAgICAgICAgICAgbGV0IHMgPSByZXN1bHRBcnJheVtpXTtcblxuICAgICAgICAgICAgbGV0IGNhcmRzcyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSgpO1xuXG4gICAgICAgICAgICBjYXJkc3MgPSBjYXJkc3Mua3FfZXhjbHVkZXMoc1swXSk7XG5cbiAgICAgICAgICAgIGNhcmRzcyA9IGNhcmRzcy5rcV9leGNsdWRlcyhzWzFdKTtcblxuICAgICAgICAgICAgaWYoY2FyZHNzLmxlbmd0aCA+PSA1KXtcbiAgICAgICAgICAgICAgICBzWzJdID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkc3MsIDUpO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgc1syXSA9IEtRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMoY2FyZHNzLCAzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVzdWx0QXJyYXlbaV0uc29ydChmdW5jdGlvbiAoYTEsYTIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gS1FDYXJkLnNjb3JlT2ZDYXJkcyhhMSktS1FDYXJkLnNjb3JlT2ZDYXJkcyhhMik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvL+ihpeWFqOiuoeWIkjJcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXkubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICB2YXIgcyA9IHJlc3VsdEFycmF5W2ldO1xuICAgICAgICAgICAgdmFyIGNhcmRzcWUgPSB0aGlzLl9hbGxDYXJkTW9kZXMuZmlsdGVyKGZ1bmN0aW9uKGlpKXsvL+mHjeaWsOi1i+WAvGNhcmRzXG4gICAgICAgICAgICAgICAgcmV0dXJuIGlpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL+WOu+mHjVxuICAgICAgICAgICAgdmFyIHEgPSBzWzBdLmNvbmNhdChzWzFdKS5jb25jYXQoc1syXSk7XG4gICAgICAgICAgICB2YXIgY2FyZHNxID0gY2FyZHNxZS5rcV9leGNsdWRlcyhxKTtcbiAgICAgICAgICAgIHNbMF0gPSBzWzBdLmtxX2V4Y2x1ZGVzKHNbMV0pO1xuICAgICAgICAgICAgc1swXSA9IHNbMF0ua3FfZXhjbHVkZXMoc1syXSk7XG4gICAgICAgICAgICBzWzFdID0gc1sxXS5rcV9leGNsdWRlcyhzWzBdKTtcbiAgICAgICAgICAgIHNbMV0gPSBzWzFdLmtxX2V4Y2x1ZGVzKHNbMl0pO1xuICAgICAgICAgICAgc1syXSA9IHNbMl0ua3FfZXhjbHVkZXMoc1sxXSk7XG4gICAgICAgICAgICBzWzJdID0gc1syXS5rcV9leGNsdWRlcyhzWzBdKTtcbiAgICAgICAgICAgIC8v5aSa5L2Z5Yig6ZmkXG4gICAgICAgICAgICBpZiAoc1syXS5sZW5ndGggPiA1KSB7Ly/lsL7pgZNcbiAgICAgICAgICAgICAgICBsZXQgYSA9IHNbMl0uc3BsaWNlKDUsIHNbMl0ubGVuZ3RoLTUpO1xuICAgICAgICAgICAgICAgIGZvcih2YXIgeSBpbiBhKXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZHNxLnB1c2goYVt5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNbMV0ubGVuZ3RoID4gNSkgey8v5Lit6YGTXG4gICAgICAgICAgICAgICAgbGV0IGEgPSBzWzFdLnNwbGljZSg1LCBzWzFdLmxlbmd0aC01KTtcbiAgICAgICAgICAgICAgICBmb3IodmFyIHkgaW4gYSl7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRzcS5wdXNoKGFbeV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzWzBdLmxlbmd0aCA+IDMpIHsvL+WktOmBk1xuICAgICAgICAgICAgICAgIGxldCBhID0gc1swXS5zcGxpY2UoMywgc1swXS5sZW5ndGgtMyk7XG4gICAgICAgICAgICAgICAgZm9yKHZhciB5IGluIGEpe1xuICAgICAgICAgICAgICAgICAgICBjYXJkc3EucHVzaChhW3ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2NhcmRzcSA9IEtRQ2FyZC5fY29udmVydE9uZVRvQShjYXJkc3EpO1xuICAgICAgICAgICAgY2FyZHNxLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KTtcbiAgICAgICAgICAgIGNhcmRzcS5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQxMSl7XG4gICAgICAgICAgICAgICAgaWYoY2FyZDExLnBvaW50ID09IDE0KXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZDExLnBvaW50ID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8v5pyJ57y65re75YqgXG4gICAgICAgICAgICB3aGlsZShzWzJdLmxlbmd0aCA8IDUpIHsvL+WwvumBk1xuICAgICAgICAgICAgICAgIHNbMl0ucHVzaChjYXJkc3EucG9wKCkgfHwgW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUoc1sxXS5sZW5ndGggPCA1KSB7Ly/kuK3pgZNcbiAgICAgICAgICAgICAgICBzWzFdLnB1c2goY2FyZHNxLnBvcCgpIHx8IFtdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlKHNbMF0ubGVuZ3RoIDwgMykgey8v5aS06YGTXG4gICAgICAgICAgICAgICAgc1swXS5wdXNoKGNhcmRzcS5wb3AoKSB8fCBbXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKmlmKGNhcmRzcS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICB3aGlsZShzWzJdLmxlbmd0aCA8IDUpIHsvL+WwvumBk1xuICAgICAgICAgICAgICAgICAgICBzWzJdLnB1c2goY2FyZHNxLnBvcCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihjYXJkc3EubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgd2hpbGUoc1sxXS5sZW5ndGggPCA1KSB7Ly/kuK3pgZNcbiAgICAgICAgICAgICAgICAgICAgc1sxXS5wdXNoKGNhcmRzcS5wb3AoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoY2FyZHNxLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgIHdoaWxlKHNbMF0ubGVuZ3RoIDwgMykgey8v5aS06YGTXG4gICAgICAgICAgICAgICAgICAgIHNbMF0ucHVzaChjYXJkc3EucG9wKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0qL1xuICAgICAgICAgICAgaWYoc1syXVs0XSA9PSBudWxsIHx8IHNbMV1bNF0gPT0gbnVsbCB8fCBzWzBdWzJdID09IG51bGxcbiAgICAgICAgICAgICAgICB8fCBzWzJdWzRdID09ICcnIHx8IHNbMV1bNF0gPT0gJycgfHwgc1swXVsyXSA9PSAnJyl7XG4gICAgICAgICAgICAgICAgcmVzdWx0QXJyYXkuc3BsaWNlKGksMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcmVzdWx0Q2FyZHMgPSBbXTtcbiAgICAgICAgbGV0IGNhcmRzczEgPSB0aGlzLl9hbGxDYXJkTW9kZXMuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpO30pO1xuICAgICAgICB2YXIgaW5kZXhhc2RmID0gMjtcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgMzsgaSsrKXtcbiAgICAgICAgICAgIGxldCBsZW5ndGggPSBpbmRleGFzZGYgPT0gMD8gMzogNTtcbiAgICAgICAgICAgIGxldCBjYXJkc3MgPSBLUUNhcmQuYXV0b1NlbGVjdENhcmRzKGNhcmRzczEsIGxlbmd0aCkgfHwgW107XG4gICAgICAgICAgICBjYXJkc3MxID0gY2FyZHNzMS5rcV9leGNsdWRlcyhjYXJkc3MpO1xuICAgICAgICAgICAgcmVzdWx0Q2FyZHNbaW5kZXhhc2RmXSA9IGNhcmRzcztcbiAgICAgICAgICAgIGluZGV4YXNkZi0tO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0Q2FyZHMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgbGV0IGxlbmd0aCA9IGkgPT0gMD8gMzogNTtcbiAgICAgICAgICAgIGlmIChyZXN1bHRDYXJkc1tpXS5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjYXJkc3MxID0gY2FyZHNzMS5rcV9leGNsdWRlcyhyZXN1bHRDYXJkc1tpXSk7XG4gICAgICAgICAgICAgICAgd2hpbGUocmVzdWx0Q2FyZHNbaV0ubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdENhcmRzW2ldLnB1c2goY2FyZHNzMS5wb3AoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmVzdWx0QXJyYXkucHVzaChyZXN1bHRDYXJkcyk7XG5cbiAgICAgICAgdmFyIGNhcmRzVHlwZU5hbWVzID0gW107XG4gICAgICAgIHZhciByZXN1bHRBcnJheXMgPSBbXTtcblxuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCByZXN1bHRBcnJheS5sZW5ndGg7aSsrKXsvL+WIoOmZpOexu+Wei+ebuOWQjOeahOe7hOWQiFxuICAgICAgICAgICAgbGV0IHMgPSByZXN1bHRBcnJheVtpXTtcbiAgICAgICAgICAgIGxldCB0eXBlTmFtZTAgPSBLUUNhcmQuY2FyZHNUeXBlTmFtZShzWzBdKTtcbiAgICAgICAgICAgIHR5cGVOYW1lMCArPSBLUUNhcmQuY2FyZHNUeXBlTmFtZShzWzFdKTtcbiAgICAgICAgICAgIHR5cGVOYW1lMCArPSBLUUNhcmQuY2FyZHNUeXBlTmFtZShzWzJdKTtcbiAgICAgICAgICAgIGlmKGNhcmRzVHlwZU5hbWVzLmluZGV4T2YodHlwZU5hbWUwKSA9PSAtMSl7XG4gICAgICAgICAgICAgICAgbGV0IHRvdVNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhzWzBdKTtcbiAgICAgICAgICAgICAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1sxXSk7XG4gICAgICAgICAgICAgICAgbGV0IHdlaVNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhzWzJdKTtcbiAgICAgICAgICAgICAgICBpZih6aG9uZ1Njb3JlID4gdG91U2NvcmUgJiYgemhvbmdTY29yZSA8IHdlaVNjb3JlKXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZHNUeXBlTmFtZXMucHVzaCh0eXBlTmFtZTApO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRBcnJheXMucHVzaChzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXN1bHRBcnJheXMuc29ydChmdW5jdGlvbiAoYTEsYTIpIHtcbiAgICAgICAgICAgIHZhciBiMCA9IHBhcnNlSW50KEtRQ2FyZC5jYXJkc1R5cGUoYTJbMF0pICkgKyBcIlwiO1xuICAgICAgICAgICAgdmFyIGIxID0gcGFyc2VJbnQoS1FDYXJkLmNhcmRzVHlwZShhMlsxXSkgKSArIFwiXCI7XG4gICAgICAgICAgICB2YXIgYjIgPSBwYXJzZUludChLUUNhcmQuY2FyZHNUeXBlKGEyWzJdKSApICsgXCJcIjtcblxuICAgICAgICAgICAgdmFyIHMwID0gcGFyc2VJbnQoS1FDYXJkLmNhcmRzVHlwZShhMVswXSkgKSArIFwiXCI7XG4gICAgICAgICAgICB2YXIgczEgPSBwYXJzZUludChLUUNhcmQuY2FyZHNUeXBlKGExWzFdKSApICsgXCJcIjtcbiAgICAgICAgICAgIHZhciBzMiA9IHBhcnNlSW50KEtRQ2FyZC5jYXJkc1R5cGUoYTFbMl0pICkgKyBcIlwiO1xuXG4gICAgICAgICAgICB2YXIgcyA9IHBhcnNlSW50KHMyICsgczEgKyBzMCk7XG4gICAgICAgICAgICB2YXIgYiA9IHBhcnNlSW50KGIyICsgYjEgKyBiMCk7XG5cbiAgICAgICAgICAgIHJldHVybiBiIC0gcztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYocmVzdWx0QXJyYXlzLmxlbmd0aCA+IDcpe1xuICAgICAgICAgICAgcmVzdWx0QXJyYXlzID0gcmVzdWx0QXJyYXlzLnNsaWNlKDAsNyk7XG4gICAgICAgIH1cbiAgICAgICAgLy9mb3IodmFyIGkgPSAwO2kgPCByZXN1bHRBcnJheXMubGVuZ3RoO2krKyl7Ly/lpoLmnpzmnInnm7jlhazniYzliJnliKDpmaRcbiAgICAgICAgLy8gICAgbGV0IHMgPSByZXN1bHRBcnJheXNbaV07XG4gICAgICAgIC8vICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1swXSk7XG4gICAgICAgIC8vICAgIGxldCB6aG9uZ1Njb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhzWzFdKTtcbiAgICAgICAgLy8gICAgbGV0IHdlaVNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhzWzJdKTtcbiAgICAgICAgLy8gICAgY2MubG9nKHRvdVNjb3JlLHpob25nU2NvcmUsd2VpU2NvcmUpO1xuICAgICAgICAvLyAgICBpZih3ZWlTY29yZSA8IHRvdVNjb3JlIHx8IHdlaVNjb3JlIDwgemhvbmdTY29yZSl7XG4gICAgICAgIC8vICAgICAgICByZXN1bHRBcnJheXMuc3BsaWNlKGksMSk7XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy99XG4gICAgICAgIC8vY2MubG9nKHJlc3VsdEFycmF5cylcbiAgICAgICAgLy9jYy5sb2coJy0tLS0tLS04OTcnKVxuXG4gICAgICAgIC8vaWYoY2MudGVTaHVQYWlDYXJkcyl7XG4gICAgICAgIC8vICAgIHZhciBUZVNodUNhcmRzID0gY2MudGVTaHVQYWlDYXJkcy5tYXAoZnVuY3Rpb24oY2Epe1xuICAgICAgICAvLyAgICAgICByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2EpKTtcbiAgICAgICAgLy8gICAgfSk7XG4gICAgICAgIC8vICAgIHJlc3VsdEFycmF5cy51bnNoaWZ0KFRlU2h1Q2FyZHMpO1xuICAgICAgICAvL1xuICAgICAgICAvL31cblxuICAgICAgICBpZihyZXN1bHRBcnJheXMubGVuZ3RoIDw9IDApe1xuXG4gICAgICAgICAgICB0aGlzLl9hbGxDYXJkTW9kZXMuZm9yRWFjaChmdW5jdGlvbihpKXtpZihpLnNjb3JlcyA9PSAxKSBpLnNjb3JlcyA9IDE0O30pO1xuXG4gICAgICAgICAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMCh0aGlzLl9hbGxDYXJkTW9kZXMpO1xuXG4gICAgICAgICAgICB0aGlzLl9hbGxDYXJkTW9kZXMgPSB0aGlzLl9hbGxDYXJkTW9kZXMua3FfZXhjbHVkZXMoY2FyZDIwKTtcblxuICAgICAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzID0gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyh0aGlzLl9hbGxDYXJkTW9kZXMpO1xuXG4gICAgICAgICAgICB0aGlzLl9hbGxDYXJkTW9kZXMgPSBjYXJkMjAuY29uY2F0KHRoaXMuX2FsbENhcmRNb2Rlcyk7XG5cbiAgICAgICAgICAgIHZhciBhc2RmMSA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSgwLDUpO1xuXG4gICAgICAgICAgICB2YXIgYXNkZjIgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoNSwxMCk7XG5cbiAgICAgICAgICAgIHZhciBhc2RmMyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSgxMCwxMyk7XG5cbiAgICAgICAgICAgIHJlc3VsdEFycmF5cy5wdXNoKFthc2RmMyxhc2RmMixhc2RmMV0pXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmF1dG9DYXJkTGF5b3V0Lm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdGhpcy5hdXRvQ2FyZFNjcm9sbFZpZXcuc2Nyb2xsVG9MZWZ0KCk7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHJlc3VsdEFycmF5cy5sZW5ndGg7aSsrKXsvL+a3u+WKoOmihOWItuS9k1xuICAgICAgICAgICAgbGV0IHMgPSByZXN1bHRBcnJheXNbaV07XG4gICAgICAgICAgICBsZXQgYXV0b0NhcmQgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmF1dG9DYXJkKTtcbiAgICAgICAgICAgIGF1dG9DYXJkLnkgPSAwO1xuICAgICAgICAgICAgc1swXS5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmIChpLnBvaW50ID09IDE0KSBpLnBvaW50ID0gMTt9KVxuICAgICAgICAgICAgc1sxXS5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmIChpLnBvaW50ID09IDE0KSBpLnBvaW50ID0gMTt9KVxuICAgICAgICAgICAgc1syXS5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmIChpLnBvaW50ID09IDE0KSBpLnBvaW50ID0gMTt9KVxuICAgICAgICAgICAgdmFyIGNhcmRzTm9kZSA9IFthdXRvQ2FyZC5jaGlsZHJlblsxXSxhdXRvQ2FyZC5jaGlsZHJlblszXSxhdXRvQ2FyZC5jaGlsZHJlblsyXV07XG5cbiAgICAgICAgICAgIHRoaXMuX3NldENhcmREYW9TcHJpdGUoY2FyZHNOb2RlLHMpO1xuXG4gICAgICAgICAgICBhdXRvQ2FyZC5jYXJkQXJyYXkgPSBzO1xuICAgICAgICAgICAgdmFyIGV2ZW50SGFuZGxlciA9IG5ldyBjYy5Db21wb25lbnQuRXZlbnRIYW5kbGVyKCk7XG4gICAgICAgICAgICBldmVudEhhbmRsZXIudGFyZ2V0ID0gdGhpcy5ub2RlO1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVyLmNvbXBvbmVudCA9IFwiQ2FyZFR5cGVDb21iaW5lXCI7XG4gICAgICAgICAgICBldmVudEhhbmRsZXIuaGFuZGxlciA9IFwiY2xpY2tBdXRvU2VsZWN0ZWRDYXJkc1wiO1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVyLmN1c3RvbUV2ZW50RGF0YSA9IGk7XG4gICAgICAgICAgICBhdXRvQ2FyZC5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5jbGlja0V2ZW50cy5wdXNoKGV2ZW50SGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLmF1dG9DYXJkTGF5b3V0Lm5vZGUuYWRkQ2hpbGQoYXV0b0NhcmQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2ZpbmRDYXJkSW5kZXguYXJyID0gcmVzdWx0QXJyYXlzO1xuXG4gICAgICAgIHRoaXMuYXV0b1NlbGVjdGVkQ2FyZHNPbmUoKTtcbiAgICB9LFxuXG4gICAgLy9kYW9DYW5jZWxBbGw6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyAgICB2YXIgbm9kZXMgPSBbdGhpcy5sYXlvdXRUb3VEYW8ubm9kZSx0aGlzLmxheW91dFpob25nRGFvLm5vZGUsdGhpcy5sYXlvdXRXZWlEYW8ubm9kZV07XG4gICAgLy8gICAgZm9yKHZhciBpID0gMDtpIDwgbm9kZXMubGVuZ3RoO2krKyl7XG4gICAgLy8gICAgICAgIG5vZGVzW2ldLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgLy8gICAgfVxuICAgIC8vfSxcblxuICAgIGF1dG9TZWxlY3RlZENhcmRzT25lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgdmFyIGluZGV4cyA9IDA7XG5cbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMuYXV0b0NhcmRMYXlvdXQubm9kZS5jaGlsZHJlbi5sZW5ndGg7aSsrKXtcblxuICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLmNoaWxkcmVuW2ldO1xuXG4gICAgICAgICAgICBub2Rlcy5jaGlsZHJlblswXS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLmNoaWxkcmVuW2luZGV4c10uY2hpbGRyZW5bMF0uYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICBsZXQgcmVzdWx0QXJyYXkgPSB0aGlzLl9maW5kQ2FyZEluZGV4LmFycltpbmRleHNdO1xuXG4gICAgICAgIHRoaXMuX2ZpbmRDYXJkSW5kZXguaW5kZXhzID0gaW5kZXhzO1xuXG5cbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXkubGVuZ3RoO2krKyl7XG5cbiAgICAgICAgICAgIHZhciBjYXJkTW9kZXMgPSByZXN1bHRBcnJheVtpXTtcblxuICAgICAgICAgICAgY2FyZE1vZGVzLnNvcnQoS1FDYXJkLnNvcnQpO1xuXG4gICAgICAgICAgICB2YXIgbnVtID0gMDtcbiAgICAgICAgICAgIGlmKGkgPT0gMSl7XG4gICAgICAgICAgICAgICAgbnVtID0gMztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoaSA9PSAyKXtcbiAgICAgICAgICAgICAgICBudW0gPSA4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9jYXJkTW9kZXMuZm9yRWFjaChmdW5jdGlvbihpKXtpZiAoaS5wb2ludCA9PSAxNCkgaS5wb2ludCA9IDE7fSlcbiAgICAgICAgICAgIGNhcmRNb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTW9kZSxpbmRleCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGNhcmROYW1lID0gY2FyZE1vZGUuY2FyZE5hbWUoKTtcblxuICAgICAgICAgICAgICAgIHZhciBudW1CZXIgPSBudW0raW5kZXg7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZHMxID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcblxuICAgICAgICAgICAgICAgIG5vZGRzMS5hbmNob3JZID0gMTtcblxuICAgICAgICAgICAgICAgIG5vZGRzMS5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTsgLy/mt7vliqDnsr7ngbXnu4Tku7ZcblxuICAgICAgICAgICAgICAgIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW5bbnVtQmVyXS5hZGRDaGlsZChub2RkczEpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbltudW1CZXJdLmNoaWxkcmVuWzBdLmNhcmROYW1lID0gY2FyZE5hbWU7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuW251bUJlcl0uY2hpbGRyZW5bMF0uX2NhcmRNb2RlbCA9IG5ldyBLUUNhcmQoY2FyZE5hbWUsbnVsbCxpbmRleCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYnRuU3ByaXRlcyA9ICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuW251bUJlcl0uY2hpbGRyZW5bMF0uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuW251bUJlcl0uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSAnJztcblxuICAgICAgICAgICAgICAgIGJ0blNwcml0ZXMubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICAgICAgaWYoY2MubWFQYWkgPT0gY2FyZE5hbWUpe1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RkcyA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXG5cbiAgICAgICAgICAgICAgICAgICAgbm9kZHMuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XG5cbiAgICAgICAgICAgICAgICAgICAgY2MubG9hZGVyLmxvYWRSZXMoJ3BsYXkvZGVzay9pbWdfcmVkNV8xJywgY2MuU3ByaXRlRnJhbWUsIGZ1bmN0aW9uIChlcnIsIHNwcml0ZUZyYW1lKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtjYy5lcnJvcihlcnIubWVzc2FnZSB8fCBlcnIpO3JldHVybjt9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidG5TcHJpdGUxID0gbm9kZHMuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5ub2RlLndpZHRoID0gMTA3O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUuaGVpZ2h0ID0gMTU1O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUueSA9IC02NS41O1xuXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgYnRuU3ByaXRlcy5ub2RlLmFkZENoaWxkKG5vZGRzKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gJ3B1YmxpYy1waWMtY2FyZC1wb2tlci0nKyBjYXJkTmFtZTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZXMsIDk1LCAxMzApO1xuXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jbGlja0F1dG9TZWxlY3RlZENhcmRzKG51bGwpO1xuXG4gICAgICAgIC8vdGhpcy5fc2V0Q2FyZERhb1Nwcml0ZSgpO1xuXG4gICAgfSxcblxuICAgIGNsaWNrQXV0b1NlbGVjdGVkQ2FyZHM6IGZ1bmN0aW9uKGV2ZW50LGluZGV4cyA9IDApIHtcblxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLmNoaWxkcmVuLmxlbmd0aDtpKyspe1xuXG4gICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzLmF1dG9DYXJkTGF5b3V0Lm5vZGUuY2hpbGRyZW5baV07XG5cbiAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmF1dG9DYXJkTGF5b3V0Lm5vZGUuY2hpbGRyZW5baW5kZXhzXS5jaGlsZHJlblswXS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5UG9rZXJDbGljaygpO1xuXG4gICAgICAgIGlmKGV2ZW50KXtcbiAgICAgICAgICAgIHZhciByZXN1bHRBcnJheSA9IGV2ZW50LnRhcmdldC5jYXJkQXJyYXk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIHZhciByZXN1bHRBcnJheSA9IHRoaXMuX2ZpbmRDYXJkSW5kZXguYXJyW2luZGV4c107XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHRvdVNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhyZXN1bHRBcnJheVswXSk7XG4gICAgICAgIGxldCB6aG9uZ1Njb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhyZXN1bHRBcnJheVsxXSk7XG4gICAgICAgIGxldCB3ZWlTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0QXJyYXlbMl0pO1xuICAgICAgICAvL2NjLmxvZyh0b3VTY29yZSk7XG4gICAgICAgIC8vY2MubG9nKHpob25nU2NvcmUpO1xuICAgICAgICAvL2NjLmxvZyh3ZWlTY29yZSk7XG4gICAgICAgIC8vY29uc29sZS5sb2coJy0tLS0tLS0tLS0xMTgwJylcbiAgICAgICAgcmVzdWx0QXJyYXkgPSByZXN1bHRBcnJheS5tYXAoZnVuY3Rpb24gKGNhcmRNb2RlKXtcblxuICAgICAgICAgICAgY2FyZE1vZGUgPSBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRNb2RlKTtcblxuICAgICAgICAgICAgcmV0dXJuIGNhcmRNb2RlLm1hcChmdW5jdGlvbiAoY2FyZE1vZGVzKXtcblxuICAgICAgICAgICAgICAgIHJldHVybiBjYXJkTW9kZXMuY2FyZE5hbWUoKTtcblxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKHJlc3VsdEFycmF5KVxuXG4gICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50LmZvckVhY2goZnVuY3Rpb24obm9kZXMpe1xuXG4gICAgICAgICAgICBub2Rlcy5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTtcblxuICAgICAgICAgICAgbm9kZXMuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihpKXtpLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwgMjU1LCAyNTUpO30pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudCA9IFtdO1xuXG4gICAgICAgIHJlc3VsdEFycmF5ID0gcmVzdWx0QXJyYXlbMF0uY29uY2F0KHJlc3VsdEFycmF5WzFdKS5jb25jYXQocmVzdWx0QXJyYXlbMl0pO1xuXG4gICAgICAgIHZhciBjYXJkQWxsTm9kZSA9IHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBpO30pO1xuXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHJlc3VsdEFycmF5Lmxlbmd0aDtpKyspe1xuXG4gICAgICAgICAgICB2YXIgcyA9IHJlc3VsdEFycmF5W2ldO1xuXG4gICAgICAgICAgICBmb3IodmFyIGogPSAwO2ogPCBjYXJkQWxsTm9kZS5sZW5ndGg7aisrKXtcblxuICAgICAgICAgICAgICAgIHZhciBkID0gY2FyZEFsbE5vZGVbal07XG5cbiAgICAgICAgICAgICAgICBkLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgaWYoZC5jaGlsZHJlblswXS5jYXJkTmFtZSA9PSBzKXtcblxuICAgICAgICAgICAgICAgICAgICBkLnN0b3BBbGxBY3Rpb25zKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGRldGFpbCA9IHRoaXMuY2hhbmdlTm9kZVNwYWNlQVJbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGwgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2Rlcyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRDYXJkRGFvU3ByaXRlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCB0aGlzKTtcblxuICAgICAgICAgICAgICAgICAgICBkLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5tb3ZlVG8odGhpcy5jYXJkVGltZSxkZXRhaWwpLCBjYWxsKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FyZEFsbE5vZGUuc3BsaWNlKGosMSlcblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgIH0sXG5cbiAgICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24oU3ByaXRlRnJhbWUsIHBhdGgsIFNwcml0ZXNOb2RlLCB3LCBoKSB7XG5cbiAgICAgICAgdmFyIFNwcml0ZSA9IFNwcml0ZUZyYW1lLmdldFNwcml0ZUZyYW1lKCBwYXRoICk7XG5cbiAgICAgICAgU3ByaXRlc05vZGUuc3ByaXRlRnJhbWUgPSBTcHJpdGU7XG5cbiAgICAgICAgaWYodykgU3ByaXRlc05vZGUubm9kZS53aWR0aCA9IHc7XG5cbiAgICAgICAgaWYoaCkgU3ByaXRlc05vZGUubm9kZS5oZWlnaHQgPSBoO1xuICAgIH0sXG5cbiAgICBzdGlja091dEZpbmRDYXJkVHlwZTE6IGZ1bmN0aW9uIChjYXJkcyxpbmRleCA9IDApIHtcbiAgICAgICAgLy8vLyDlsIblt7LmnInnmoTnqoHlh7rnmoTniYznmoTkvY3nva7ph43nva7lm57liJ3lp4vkvY3nva5cbiAgICAgICAgLy90aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XG4gICAgICAgIC8vbGV0IHNlbGVjdGVkQ2FyZE5hbWVzID0gY2FyZHMubWFwKGZ1bmN0aW9uKGNhcmRNb2RlbCl7XG4gICAgICAgIC8vICAgIHJldHVybiBjYXJkTW9kZWwuY2FyZE5hbWUoKTtcbiAgICAgICAgLy99LmJpbmQodGhpcykpO1xuICAgICAgICAvL1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4uZmlsdGVyKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xuICAgICAgICAvLyAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmROb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAvLyAgICBpZihzZWxlY3RlZENhcmROYW1lcy5pbmNsdWRlcyhjYXJkUHJlZmFiLmNhcmROYW1lKCkpKSB7XG4gICAgICAgIC8vICAgICAgICB2YXIgbmFtZUluZGV4ID0gc2VsZWN0ZWRDYXJkTmFtZXMuaW5kZXhPZihjYXJkUHJlZmFiLmNhcmROYW1lKCkpO1xuICAgICAgICAvLyAgICAgICAgc2VsZWN0ZWRDYXJkTmFtZXMuc3BsaWNlKG5hbWVJbmRleCwxKTtcbiAgICAgICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9jYy5sb2coJy0tLS0tLS02OTYnKVxuICAgICAgICAvL3RoaXMuX2NoYW5nZUNhcmRQcmVmYWJzWShjYXJkTm9kZXMpO1xuICAgICAgICAvL2lmKGluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICB0aGlzLl9hZGREYW9DYXJkVG9MYXlvdXQodGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgMyk7XG4gICAgICAgIC8vfVxuICAgICAgICAvL2Vsc2UgaWYoaW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgIHRoaXMuX2FkZERhb0NhcmRUb0xheW91dCh0aGlzLmxheW91dFpob25nRGFvLm5vZGUpO1xuICAgICAgICAvL31cbiAgICAgICAgLy9lbHNlIGlmKGluZGV4ID09IDMpe1xuICAgICAgICAvLyAgICB0aGlzLl9hZGREYW9DYXJkVG9MYXlvdXQodGhpcy5sYXlvdXRXZWlEYW8ubm9kZSk7XG4gICAgICAgIC8vfVxuXG4gICAgfSxcblxuICAgIF90b3VjaENhcmRMYXlvdXQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvL2V2ZW50LmJ1YmJsZXMgPSB0cnVlO1xuICAgICAgICAvL2xldCBsb2NhdGlvbiA9IGV2ZW50LmdldExvY2F0aW9uKCk7XG4gICAgICAgIC8vbGV0IGNhcmRQcmVmYWIgPSB0aGlzLl9jYXJkUHJlZmFiSW5DYXJkTGF5b3V0V2l0aExvY2F0aW9uKGxvY2F0aW9uKTtcbiAgICAgICAgLy9pZiAoY2FyZFByZWZhYikge1xuICAgICAgICAvLyAgICBjYXJkUHJlZmFiLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpLnNldFNlbGVjdGVkKHRydWUpO1xuICAgICAgICAvLyAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgLy99XG4gICAgfSxcblxuICAgIF90b3VjaENhcmRMYXlvdXRFbmQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvL3RoaXMuX2NoYW5nZVNlbGVjdGVkQ2FyZFByZWZhYnNZKCk7XG4gICAgICAgIC8vdGhpcy5fZGlzZWNsZWN0Q2FyZFByZWZhYnMoKTtcbiAgICB9LFxuXG4gICAgX2NhcmRQcmVmYWJJbkNhcmRMYXlvdXRXaXRoTG9jYXRpb246IGZ1bmN0aW9uIChsb2NhdGlvbikge1xuICAgICAgICAvL2xvY2F0aW9uID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZUFSKGxvY2F0aW9uKTtcbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLnNvcnQoZnVuY3Rpb24gKGNhcmROb2RlMSwgY2FyZE5vZGUyKSB7XG4gICAgICAgIC8vICAgIGxldCByZWN0MSA9IGNhcmROb2RlMS5nZXRCb3VuZGluZ0JveCgpO1xuICAgICAgICAvLyAgICBsZXQgcmVjdDIgPSBjYXJkTm9kZTIuZ2V0Qm91bmRpbmdCb3goKTtcbiAgICAgICAgLy8gICAgcmV0dXJuIHJlY3QyLnggLSByZWN0MS54O1xuICAgICAgICAvL30pO1xuICAgICAgICAvL2ZvciAobGV0IGluZGV4IGluIGNhcmROb2Rlcykge1xuICAgICAgICAvLyAgICBsZXQgY2FyZE5vZGUgPSBjYXJkTm9kZXNbaW5kZXhdO1xuICAgICAgICAvL1xuICAgICAgICAvLyAgICBsZXQgcmVjdCA9IGNhcmROb2RlLmdldEJvdW5kaW5nQm94KCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgIGlmIChjYy5yZWN0Q29udGFpbnNQb2ludChyZWN0LCBsb2NhdGlvbikpIHtcbiAgICAgICAgLy8gICAgICAgIHJldHVybiBjYXJkTm9kZTtcbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvL31cbiAgICAgICAgLy9cbiAgICAgICAgLy9yZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX2NoYW5nZVNlbGVjdGVkQ2FyZFByZWZhYnNZOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuX3NlbGVjdGVkQ2FyZFByZWZhYnMoKTtcbiAgICAgICAgLy90aGlzLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9BdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVBva2VyQ2xpY2soKTtcbiAgICB9LFxuXG4gICAgX2NoYW5nZUNhcmRQcmVmYWJzWTogZnVuY3Rpb24gKGNhcmROb2Rlcykge1xuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xuICAgICAgICAvLyAgICBsZXQgeSA9IGNhcmROb2RlLmdldFBvc2l0aW9uWSgpO1xuICAgICAgICAvLyAgICBpZiAoeSA9PSB0aGlzLl9jYXJkT2Zmc2V0WSkge1xuICAgICAgICAvLyAgICAgICAgY2FyZE5vZGUuc2V0UG9zaXRpb25ZKHRoaXMuX2NhcmRPZmZzZXRZICsgNTUpO1xuICAgICAgICAvLyAgICB9IGVsc2Uge1xuICAgICAgICAvLyAgICAgICAgY2FyZE5vZGUuc2V0UG9zaXRpb25ZKHRoaXMuX2NhcmRPZmZzZXRZKTtcbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvL30uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIF9zZWxlY3RlZENhcmRQcmVmYWJzOiBmdW5jdGlvbiAoaW5jbHVkZVN0aWNrT3V0ID0gZmFsc2UpIHtcbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICAvL3JldHVybiBjYXJkTm9kZXMuZmlsdGVyKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xuICAgICAgICAvLyAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmROb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAvLyAgICBsZXQgaXNTZWxlY3RlZCA9IGNhcmRQcmVmYWIuaXNTZWxlY3RlZCgpO1xuICAgICAgICAvLyAgICBpZiAoIWlzU2VsZWN0ZWQgJiYgaW5jbHVkZVN0aWNrT3V0KSB7XG4gICAgICAgIC8vICAgICAgICBpc1NlbGVjdGVkID0gY2FyZE5vZGUuZ2V0UG9zaXRpb25ZKCkgPiAxMDtcbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvL1xuICAgICAgICAvLyAgICByZXR1cm4gaXNTZWxlY3RlZDtcbiAgICAgICAgLy99KTtcbiAgICB9LFxuXG4gICAgX2Rpc2VjbGVjdENhcmRQcmVmYWJzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbjtcbiAgICAgICAgLy9jYXJkTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAvLyAgICBub2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpLnNldFNlbGVjdGVkKGZhbHNlKTtcbiAgICAgICAgLy99KTtcbiAgICB9LFxuXG4gICAgLy8g6YeN572uIGNhcmRzIOeahCBYXG4gICAgX3Jlc2V0Q2FyZHNQb3NpdGlvblg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9sZXQgaW50ZXJ2YWwgPSA5ODtcbiAgICAgICAgLy9sZXQgaW50ZXJ2YWwgPSA3ODtcbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICAvL2xldCBsZW5ndGggPSBjYXJkTm9kZXMubGVuZ3RoO1xuICAgICAgICAvL2lmIChsZW5ndGggPT0gMCkge1xuICAgICAgICAvLyAgICByZXR1cm47XG4gICAgICAgIC8vfVxuICAgICAgICAvL1xuICAgICAgICAvL2xldCBtaWRkbGVJbmRleCA9IGxlbmd0aCAvIDI7XG4gICAgICAgIC8vbGV0IGNhcmRXaWR0aCA9IDE1NDtcbiAgICAgICAgLy9cbiAgICAgICAgLy9cbiAgICAgICAgLy8vL3RoaXMuY2FyZHNMYXlvdXRTb3J0KCk7XG4gICAgICAgIC8vaWYodGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9PSB0cnVlKXtcbiAgICAgICAgLy8gICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICAvLyAgICAgICAgbGV0IGNvbXBvbmVudDEgPSBuMS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgLy8gICAgICAgIGxldCBjb21wb25lbnQyID0gbjIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vICAgICAgICByZXR1cm4gY29tcG9uZW50Mi5jYXJkTW9kZSgpLmNvbG9yIC0gY29tcG9uZW50MS5jYXJkTW9kZSgpLmNvbG9yO1xuICAgICAgICAvLyAgICB9KTtcbiAgICAgICAgLy99ZWxzZXtcbiAgICAgICAgLy8gICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICAvLyAgICAgICAgbGV0IGNvbXBvbmVudDEgPSBuMS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgLy8gICAgICAgIGxldCBjb21wb25lbnQyID0gbjIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vICAgICAgICByZXR1cm4gY29tcG9uZW50MS5jYXJkTW9kZSgpLnNvcnQoY29tcG9uZW50Mi5jYXJkTW9kZSgpKTtcbiAgICAgICAgLy8gICAgfSk7XG4gICAgICAgIC8vfVxuICAgICAgICAvLy8vY2FyZE5vZGVzLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICAvLy8vICAgIGxldCBjb21wb25lbnQxID0gbjEuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vLy8gICAgbGV0IGNvbXBvbmVudDIgPSBuMi5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgLy8vL1xuICAgICAgICAvLy8vICAgIHJldHVybiBjb21wb25lbnQxLmNhcmRNb2RlKCkuc29ydChjb21wb25lbnQyLmNhcmRNb2RlKCkpO1xuICAgICAgICAvLy8vfSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmROb2RlLCBpbmRleCkge1xuICAgICAgICAvLyAgICBjYXJkTm9kZS56SW5kZXggPSBpbmRleDtcbiAgICAgICAgLy8gICAgbGV0IHggPSAoaW5kZXggLSBtaWRkbGVJbmRleCkgKiBpbnRlcnZhbCArIGNhcmRXaWR0aCAvIDM7XG4gICAgICAgIC8vICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWCh4KTtcbiAgICAgICAgLy99KTtcbiAgICB9LFxuXG4gICAgLy8g6YeN572uIGNhcmRzIOeahCBY5Li6MFxuICAgIHJlc2V0Q2FyZHNQb3NpdGlvblgxOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgLy9sZXQgbGVuZ3RoID0gY2FyZE5vZGVzLmxlbmd0aDtcbiAgICAgICAgLy9pZiAobGVuZ3RoID09IDApIHtcbiAgICAgICAgLy8gICAgcmV0dXJuO1xuICAgICAgICAvL31cbiAgICAgICAgLy9jYXJkTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZE5vZGUpIHtcbiAgICAgICAgLy8gICAgY2FyZE5vZGUuc2V0UG9zaXRpb25ZKDApO1xuICAgICAgICAvL30pO1xuICAgIH0sXG5cbiAgICBfcmVzZXRDYXJkc1Bvc2l0aW9uWTogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4gfHwgW107XG4gICAgICAgIC8vY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgIC8vICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSk7XG4gICAgICAgIC8vfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgLy8g5aS044CB5Lit44CB5bC+6YGTIGxheW91dCDnmoTngrnlh7vkuovku7ZcbiAgICBfcmVnaXN0ZXJEYW9zTGF5b3V0Q2xpY2tFdmVudDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHRoaXMuY2hhbmdlTm9kZVNwYWNlQVIgPSBbXTsvL+iusOW9leaJgOacieeJjOeahOWdkOagh1xuICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24obm9kZXMpe1xuICAgICAgICAgICAgLy/ojrflj5boioLngrnnmoTkuJbnlYzlnZDmoIdcbiAgICAgICAgICAgIHZhciBjYXJkQmFja1dvcmxkU3BhY2UxID0gbm9kZXMuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLnYyKDAsIDApKTtcbiAgICAgICAgICAgIC8v6I635Y+W55u45a+554i26IqC54K55omA5Zyo55qE5Z2Q5qCHXG4gICAgICAgICAgICB2YXIgZGV0YWlsID0gbm9kZXMucGFyZW50LmNvbnZlcnRUb05vZGVTcGFjZUFSKGNhcmRCYWNrV29ybGRTcGFjZTEpO1xuXG4gICAgICAgICAgICB0aGlzLmNoYW5nZU5vZGVTcGFjZUFSLnB1c2goZGV0YWlsKTtcblxuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBjbGlja0FsbENhcmQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVBva2VyQ2xpY2soKTtcbiAgICAgICAgaWYodGhpcy5MYXlvdXRXaXRoRXZlbnQubGVuZ3RoIDw9IDEpe1xuICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQucHVzaChldmVudC50YXJnZXQpO1xuICAgICAgICAgICAgZXZlbnQudGFyZ2V0LmNvbG9yID0gbmV3IGNjLkNvbG9yKDE4MiwgMTgyLCAxODIpO1xuICAgICAgICAgICAgZXZlbnQudGFyZ2V0LmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oaSl7aS5jb2xvciA9IG5ldyBjYy5Db2xvcigxODIsIDE4MiwgMTgyKTt9KTtcbiAgICAgICAgfVxuICAgICAgICBpZih0aGlzLkxheW91dFdpdGhFdmVudC5sZW5ndGggPT0gMil7XG5cbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcblxuICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQuZm9yRWFjaChmdW5jdGlvbihub2Rlcyl7XG4gICAgICAgICAgICAgICAgLy/ojrflj5boioLngrnnmoTkuJbnlYzlnZDmoIdcbiAgICAgICAgICAgICAgICB2YXIgY2FyZEJhY2tXb3JsZFNwYWNlMSA9IG5vZGVzLmNvbnZlcnRUb1dvcmxkU3BhY2VBUihjYy52MigwLCAwKSk7XG4gICAgICAgICAgICAgICAgLy/ojrflj5bnm7jlr7nniLboioLngrnmiYDlnKjnmoTlnZDmoIdcbiAgICAgICAgICAgICAgICB2YXIgZGV0YWlsID0gbm9kZXMucGFyZW50LmNvbnZlcnRUb05vZGVTcGFjZUFSKGNhcmRCYWNrV29ybGRTcGFjZTEpO1xuXG4gICAgICAgICAgICAgICAgYXJyLnVuc2hpZnQoZGV0YWlsKTtcblxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQuZm9yRWFjaChmdW5jdGlvbihub2RlcyxpbmRleCl7XG5cbiAgICAgICAgICAgICAgICBub2Rlcy5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTtcblxuICAgICAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oaSl7aS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTt9KTtcblxuICAgICAgICAgICAgICAgIG5vZGVzLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0Q2FyZERhb1Nwcml0ZSgpO1xuXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCB0aGlzLmNhcmRUaW1lKTtcblxuICAgICAgICAgICAgICAgIG5vZGVzLnN0b3BBbGxBY3Rpb25zKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZGV0YWlsID0gYXJyW2luZGV4XTtcblxuICAgICAgICAgICAgICAgIG5vZGVzLnJ1bkFjdGlvbihjYy5tb3ZlVG8odGhpcy5jYXJkVGltZSxkZXRhaWwpKTtcblxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQgPSBbXTtcblxuICAgICAgICB9XG5cbiAgICB9LFxuXG4gICAgX3NldENhcmREYW9TcHJpdGU6IGZ1bmN0aW9uIChub2RlcyA9IG51bGwgLGNhcmRzID0gbnVsbCkge1xuXG4gICAgICAgIGlmKCFub2Rlcyl7XG5cbiAgICAgICAgICAgIHRoaXMuY2FyZEFsbHMgPSAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbi5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIueSAtIGEueTt9KS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkuY2hpbGRyZW5bMF07fSk7XG5cbiAgICAgICAgICAgIGNhcmRzID0gW3RoaXMuX3Rhb0Rhb0NhcmRNb2RlcygpLHRoaXMuX3pob25nRGFvQ2FyZE1vZGVzKCksdGhpcy5fd2VpRGFvQ2FyZE1vZGVzKCldO1xuXG4gICAgICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe2NhcmQuZm9yRWFjaChmdW5jdGlvbihpKXtpZiAoaS5zY29yZXMgPT0gMTQpe2kuc2NvcmVzID0gMTt9fSk7fSk7XG5cbiAgICAgICAgICAgIG5vZGVzID0gW3RoaXMudG91RGFvTm9kZSx0aGlzLnpob25nRGFvTm9kZSx0aGlzLndlaURhb05vZGVdO1xuXG4gICAgICAgIH1cblxuICAgICAgICAvL+WktOmBk1xuICAgICAgICBsZXQgdHlwZU5hbWUwID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkc1swXSkrMTtcblxuICAgICAgICB0eXBlTmFtZTAgPSB0eXBlTmFtZTA+PTEwID8gdHlwZU5hbWUwIDpcIjBcIit0eXBlTmFtZTA7XG5cbiAgICAgICAgdHlwZU5hbWUwID0gdHlwZU5hbWUwPT0nMDQnID8gJzExJyA6dHlwZU5hbWUwO1xuXG4gICAgICAgIHZhciBwYXRoID0gJ2dhbWVfcG9rZXJfdHlwZScrIHR5cGVOYW1lMDtcblxuICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuZGFvU3ByaXRlQXRsYXMsIHBhdGggLG5vZGVzWzBdLmdldENvbXBvbmVudChjYy5TcHJpdGUpKTtcblxuICAgICAgICAvL+S4remBk1xuICAgICAgICBsZXQgdHlwZU5hbWUxID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkc1sxXSkrMTtcblxuICAgICAgICB0eXBlTmFtZTEgPSB0eXBlTmFtZTE+PTEwID8gdHlwZU5hbWUxIDpcIjBcIit0eXBlTmFtZTE7XG5cbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPT0nMDcnID8gJzIyJyA6dHlwZU5hbWUxO1xuXG4gICAgICAgIHBhdGggPSAnZ2FtZV9wb2tlcl90eXBlJysgdHlwZU5hbWUxO1xuXG4gICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUodGhpcy5kYW9TcHJpdGVBdGxhcywgcGF0aCAsbm9kZXNbMV0uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkpO1xuXG4gICAgICAgIC8v5bC+6YGTXG4gICAgICAgIGxldCB0eXBlTmFtZTIgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzWzJdKSsxO1xuXG4gICAgICAgIHR5cGVOYW1lMiA9IHR5cGVOYW1lMj49MTAgPyB0eXBlTmFtZTIgOlwiMFwiK3R5cGVOYW1lMjtcblxuICAgICAgICBwYXRoID0gJ2dhbWVfcG9rZXJfdHlwZScrIHR5cGVOYW1lMjtcblxuICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuZGFvU3ByaXRlQXRsYXMsIHBhdGggLG5vZGVzWzJdLmdldENvbXBvbmVudChjYy5TcHJpdGUpKTtcblxuICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24obil7bi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IFwiXCI7fSk7XG5cbiAgICAgICAgaWYoY2FyZHMpe1xuXG4gICAgICAgICAgICBpZih0eXBlTmFtZTApIEtRQ2FyZC5fc2V0R3VpQ2FyZCgwLCAwLCAzLCB0eXBlTmFtZTAsIGNhcmRzLCB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG5cbiAgICAgICAgICAgIGlmKHR5cGVOYW1lMSkgS1FDYXJkLl9zZXRHdWlDYXJkKDEsIDMsIDgsIHR5cGVOYW1lMSwgY2FyZHMsIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW4sIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcblxuICAgICAgICAgICAgaWYodHlwZU5hbWUyKSBLUUNhcmQuX3NldEd1aUNhcmQoMiwgOCwgMTMsIHR5cGVOYW1lMiwgY2FyZHMsIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW4sIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcblxuICAgICAgICB9XG4gICAgfSxcblxuICAgIF9jbGlja1RvdURhb0xheW91dDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQodGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgZXZlbnQpO1xuICAgIH0sXG5cbiAgICBfY2xpY2taaG9uZ0Rhb0xheW91dDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQodGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLCBldmVudCk7XG4gICAgfSxcblxuICAgIF9jbGlja1dlaURhb0xheW91dDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQodGhpcy5sYXlvdXRXZWlEYW8ubm9kZSwgZXZlbnQpO1xuICAgIH0sXG5cbiAgICBfZGFvQ2FyZE5vZGVJbkxheW91dFdpdGhFdmVudDogZnVuY3Rpb24gKG5vZGUsIGV2ZW50KSB7XG4gICAgICAgIGxldCBjYXJkTm9kZXMgPSBub2RlLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICB2YXIgbG9jYXRpb24gPSBldmVudC5nZXRMb2NhdGlvbigpO1xuICAgICAgICBsb2NhdGlvbiA9IG5vZGUuY29udmVydFRvTm9kZVNwYWNlQVIobG9jYXRpb24pO1xuICAgICAgICAvL3ZhciBjYXJkQmFja1dvcmxkU3BhY2UgPSB0aGlzLmxheW91dFpob25nRGFvLm5vZGUuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLnYyKDAsIDApKTtcbiAgICAgICAgLy8vL+iOt+WPluiKgueCueeahOS4lueVjOWdkOagh1xuICAgICAgICAvL3ZhciBkZXRhaWwgPSB0aGlzLmxheW91dFpob25nRGFvLm5vZGUucGFyZW50LmNvbnZlcnRUb05vZGVTcGFjZUFSKGNhcmRCYWNrV29ybGRTcGFjZSk7XG4gICAgICAgIC8vLy/ojrflj5bnm7jlr7nniLboioLngrnmiYDlnKjnmoTlnZDmoIdcbiAgICAgICAgLy90aGlzLmxheW91dFdlaURhby5ub2RlLnJ1bkFjdGlvbihjYy5tb3ZlVG8oMSxkZXRhaWwpKTtcbiAgICAgICAgZm9yIChsZXQgaW5kZXggaW4gY2FyZE5vZGVzKSB7XG4gICAgICAgICAgICBsZXQgY2FyZE5vZGUgPSBjYXJkTm9kZXNbaW5kZXhdO1xuICAgICAgICAgICAgbGV0IHJlY3QgPSBjYXJkTm9kZS5nZXRCb3VuZGluZ0JveCgpO1xuICAgICAgICAgICAgaWYgKGNjLnJlY3RDb250YWluc1BvaW50KHJlY3QsIGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5UG9rZXJDbGljaygpO1xuICAgICAgICAgICAgICAgIGxldCBhcnJzID0gW25vZGUgLGNhcmROb2RlXTtcbiAgICAgICAgICAgICAgICBpZih0aGlzLkxheW91dFdpdGhFdmVudC5sZW5ndGggPT0gMSl7XG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuTGF5b3V0V2l0aEV2ZW50WzBdWzBdLm5hbWUgIT0gbm9kZS5uYW1lKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmROb2RlLm9wYWNpdHkgPSAyMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudC5wdXNoKGFycnMpO1xuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50WzBdWzFdLm9wYWNpdHkgPSAyNTU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5MYXlvdXRXaXRoRXZlbnQubGVuZ3RoID09IDApe1xuICAgICAgICAgICAgICAgICAgICAvL2NjLmxvZyhjYXJkTm9kZSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQucHVzaChhcnJzKTtcbiAgICAgICAgICAgICAgICAgICAgY2FyZE5vZGUub3BhY2l0eSA9IDIwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYodGhpcy5MYXlvdXRXaXRoRXZlbnQubGVuZ3RoID09IDIpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZTEgPSB0aGlzLkxheW91dFdpdGhFdmVudFswXVsxXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUyID0gdGhpcy5MYXlvdXRXaXRoRXZlbnRbMV1bMV07XG4gICAgICAgICAgICAgICAgICAgIC8v6I635Y+W6IqC54K555qE5LiW55WM5Z2Q5qCHXG4gICAgICAgICAgICAgICAgICAgIHZhciBjYXJkQmFja1dvcmxkU3BhY2UgPSBub2RlMS5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoMCwgMCkpO1xuICAgICAgICAgICAgICAgICAgICAvL+iOt+WPluebuOWvueeItuiKgueCueaJgOWcqOeahOWdkOagh1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGV0YWlsID0gbm9kZTEucGFyZW50LmNvbnZlcnRUb05vZGVTcGFjZUFSKGNhcmRCYWNrV29ybGRTcGFjZSk7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUyLnJ1bkFjdGlvbihjYy5tb3ZlVG8oMSxkZXRhaWwpKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL3JldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICBfYWRkRGFvQ2FyZFRvTGF5b3V0OiBmdW5jdGlvbiAobm9kZSwgbWF4TnVtYmVyQ2FyZCA9IDUpIHtcbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gbm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgLy9pZiAoY2FyZE5vZGVzLmxlbmd0aCA+PSA1KSB7XG4gICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgLy99XG4gICAgICAgIC8vbGV0IHJlbWFpbkNvdW50ID0gbWF4TnVtYmVyQ2FyZCAtIGNhcmROb2Rlcy5sZW5ndGg7XG4gICAgICAgIC8vXG4gICAgICAgIC8vdmFyIHNlbGVjdGVkQ2FyZHMgPSB0aGlzLl9zZWxlY3RlZENhcmRQcmVmYWJzKHRydWUpIHx8IFtdO1xuICAgICAgICAvL1xuICAgICAgICAvL2lmIChzZWxlY3RlZENhcmRzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgLy99XG4gICAgICAgIC8vaWYgKHNlbGVjdGVkQ2FyZHMubGVuZ3RoID4gcmVtYWluQ291bnQpIHtcbiAgICAgICAgLy8gICAgc2VsZWN0ZWRDYXJkcyA9IHNlbGVjdGVkQ2FyZHMuc2xpY2UoMCwgcmVtYWluQ291bnQpO1xuICAgICAgICAvL31cbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgc2VsZWN0ZWRDYXJkTmFtZXMgPSBzZWxlY3RlZENhcmRzLm1hcChmdW5jdGlvbiAoY2FyZFByZWZhYikge1xuICAgICAgICAvLyAgICByZXR1cm4gY2FyZFByZWZhYi5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKS5jYXJkTmFtZSgpO1xuICAgICAgICAvL30pO1xuICAgICAgICAvL1xuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkVHlwZU5vZGUpIHtcbiAgICAgICAgLy8gICAgc2VsZWN0ZWRDYXJkTmFtZXMucHVzaChjYXJkVHlwZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLmNhcmROYW1lKCkpO1xuICAgICAgICAvL30pO1xuICAgICAgICAvL1xuICAgICAgICAvL2xldCBjYXJkTW9kZXMgPSBzZWxlY3RlZENhcmROYW1lcy5tYXAoZnVuY3Rpb24gKGNhcmROYW1lLGluZGV4KSB7XG4gICAgICAgIC8vICAgIHJldHVybiBuZXcgS1FDYXJkKGNhcmROYW1lLG51bGwsaW5kZXgpO1xuICAgICAgICAvL30pLnNvcnQoZnVuY3Rpb24gKGMxLCBjMikge1xuICAgICAgICAvLyAgICByZXR1cm4gS1FDYXJkLnNvcnQoYzEsIGMyLCBmYWxzZSk7XG4gICAgICAgIC8vfSk7XG5cbiAgICAgICAgLy9sZXQgdG91Q2FyZE1vZGVzID0gKG5vZGUgPT0gdGhpcy5sYXlvdXRUb3VEYW8ubm9kZSkgPyBjYXJkTW9kZXMgOiB0aGlzLl90YW9EYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgLy9sZXQgemhvbmdDYXJkTW9kZXMgPSAobm9kZSA9PSB0aGlzLmxheW91dFpob25nRGFvLm5vZGUpID8gY2FyZE1vZGVzIDogdGhpcy5femhvbmdEYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgLy9sZXQgd2VpQ2FyZE1vZGVzID0gKG5vZGUgPT0gdGhpcy5sYXlvdXRXZWlEYW8ubm9kZSkgPyBjYXJkTW9kZXMgOiB0aGlzLl93ZWlEYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgLy9pZiAoIXRoaXMuX2lzVmFsaWRDYXJkTW9kZXModG91Q2FyZE1vZGVzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzKSkge1xuICAgICAgICAvLyAgICB0aGlzLmNhY2xlQXV0b1NlbGVjdGVkQ2FyZHMxKCk7XG4gICAgICAgIC8vICAgIGNjLmxvZygn55u45YWs54mM77ya6Ieq5Yqo6YCJ5oup54mMJylcbiAgICAgICAgLy8gICAgcmV0dXJuO1xuICAgICAgICAvL31cbiAgICAgICAgLy9cbiAgICAgICAgLy9ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vY2FyZE1vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmRNb2RlLGluZGV4KSB7XG4gICAgICAgIC8vICAgIGxldCBjYXJkTmFtZSA9IGNhcmRNb2RlLmNhcmROYW1lKCk7XG4gICAgICAgIC8vICAgIGxldCBjYXJkVHlwZVNwcml0ZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2FyZFR5cGVQcmVmYWIpO1xuICAgICAgICAvLyAgICBjYXJkVHlwZVNwcml0ZS5uYW1lcyA9IGNhcmROYW1lKycrJytpbmRleDtcbiAgICAgICAgLy8gICAgY2FyZFR5cGVTcHJpdGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLnNldENhcmQoY2FyZE5hbWUsaW5kZXgpO1xuICAgICAgICAvLyAgICBub2RlLmFkZENoaWxkKGNhcmRUeXBlU3ByaXRlKTtcbiAgICAgICAgLy99LmJpbmQodGhpcykpO1xuICAgICAgICAvL1xuICAgICAgICAvL1xuICAgICAgICAvL3NlbGVjdGVkQ2FyZHMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAvLyAgICBub2RlLnJlbW92ZUZyb21QYXJlbnQoKTtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy90aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XG4gICAgICAgIC8vdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWCgpO1xuICAgICAgICAvL1xuICAgICAgICAvL3RoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b25zKCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICAvL3RoaXMuX3Jlc2V0VHlwZUJ1dHRvbkVuYWJsZXNXaXRoTW9kZWxzKCk7XG4gICAgfSxcblxuICAgIC8vIOWIoOmZpCDlpLTjgIHkuK3miJblsL7pgZPkuK3nmoTmn5DkuK3niYxcbiAgICBfZGVsZXRlRGFvQ2FyZDogZnVuY3Rpb24gKGNhcmRUeXBlTm9kZSwgcmVsb2FkVHlwZUJ1dHRvbkVuYWJsZXMgPSBmYWxzZSkge1xuICAgICAgICAvL2xldCBjYXJkTmFtZSA9IGNhcmRUeXBlTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlU3ByaXRlJykuY2FyZE5hbWUoKTtcbiAgICAgICAgLy90aGlzLmFkZENhcmQoY2FyZE5hbWUsIHRydWUpO1xuICAgICAgICAvL1xuICAgICAgICAvL3RoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9jYXJkVHlwZU5vZGUucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcbiAgICAgICAgLy90aGlzLl9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9ucygpO1xuICAgICAgICAvL1xuICAgICAgICAvL2lmIChyZWxvYWRUeXBlQnV0dG9uRW5hYmxlcykge1xuICAgICAgICAvLyAgICB0aGlzLl9yZWxvYWRLUUNhcmRNb2Rlc0lubmVyKCk7XG4gICAgICAgIC8vICAgIHRoaXMuX3Jlc2V0VHlwZUJ1dHRvbkVuYWJsZXNXaXRoTW9kZWxzKCk7XG4gICAgICAgIC8vfVxuICAgIH0sXG5cbiAgICAvLyDliKDpmaQg5aS06YGT5oiW5Lit6YGT5oiW5bC+6YGT5LiK5omA5pyJ55qEIOeJjFxuICAgIF9kZWxldGVEYW9DYXJkc09mTGF5b3V0OiBmdW5jdGlvbiAoZGFvTGF5b3V0KSB7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IEFycmF5LmZyb20oZGFvTGF5b3V0LmNoaWxkcmVuKTtcbiAgICAgICAgLy9jYXJkTm9kZXMuZm9yRWFjaCh0aGlzLl9kZWxldGVEYW9DYXJkLmJpbmQodGhpcykpO1xuICAgICAgICAvL1xuICAgICAgICAvL3RoaXMuX3JlbG9hZEtRQ2FyZE1vZGVzSW5uZXIoKTtcbiAgICAgICAgLy90aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscygpO1xuICAgIH0sXG5cbiAgICAvLyDliKTmlq3og73lkKbkvb/nlKjpgInmi6nkuK3nmoTniYxcbiAgICAvLyDljbPvvJrlpLTpgZPopoHlsI/kuo7kuK3pgZPjgIHkuK3pgZPopoHlsI/kuo7lsL7pgZNcbiAgICBfaXNWYWxpZENhcmRNb2RlczogZnVuY3Rpb24gKHRvdUNhcmRNb2RlcywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2Rlcykge1xuICAgICAgICB0b3VDYXJkTW9kZXMgPSB0b3VDYXJkTW9kZXMgfHwgW107XG4gICAgICAgIHpob25nQ2FyZE1vZGVzID0gemhvbmdDYXJkTW9kZXMgfHwgW107XG4gICAgICAgIHdlaUNhcmRNb2RlcyA9IHdlaUNhcmRNb2RlcyB8fCBbXTtcbiAgICAgICAgaWYgKHRvdUNhcmRNb2Rlcy5sZW5ndGggPCAzIHx8IHpob25nQ2FyZE1vZGVzLmxlbmd0aCA8IDUgfHwgd2VpQ2FyZE1vZGVzLmxlbmd0aCA8IDUpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHRvdVNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyh0b3VDYXJkTW9kZXMpO1xuICAgICAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoemhvbmdDYXJkTW9kZXMpO1xuICAgICAgICBsZXQgd2VpU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHdlaUNhcmRNb2Rlcyk7XG4gICAgICAgIHJldHVybiAodG91U2NvcmUgPCB6aG9uZ1Njb3JlKSAmJiAoemhvbmdTY29yZSA8PSB3ZWlTY29yZSk7XG4gICAgfSxcblxuICAgIC8vIOWktOmBk+S4iuW3suacieeahOeJjFxuICAgIF90YW9EYW9DYXJkTW9kZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmRNb2Rlc09mQ2FyZFByZWZhYnModGhpcy5jYXJkQWxscy5zbGljZSgwLDMpKTtcbiAgICB9LFxuXG4gICAgLy8g5Lit6YGT5LiK5bey5pyJ55qE54mMXG4gICAgX3pob25nRGFvQ2FyZE1vZGVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcmV0dXJuIHRoaXMuX2NhcmRNb2Rlc09mQ2FyZFByZWZhYnModGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLmNoaWxkcmVuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmRNb2Rlc09mQ2FyZFByZWZhYnModGhpcy5jYXJkQWxscy5zbGljZSgzLDgpKTtcbiAgICB9LFxuXG4gICAgLy8g5bC+6YGT5LiK5bey5pyJ55qE54mMXG4gICAgX3dlaURhb0NhcmRNb2RlczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3JldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMubGF5b3V0V2VpRGFvLm5vZGUuY2hpbGRyZW4pO1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZE1vZGVzT2ZDYXJkUHJlZmFicyh0aGlzLmNhcmRBbGxzLnNsaWNlKDgsMTMpKTtcbiAgICB9LFxuXG4gICAgX2NhcmRNb2Rlc09mQ2FyZFByZWZhYnM6IGZ1bmN0aW9uIChjYXJkVHlwZU5vZGVzKSB7XG4gICAgICAgIGlmICghY2FyZFR5cGVOb2Rlcykge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGNhcmRNb2RlcyA9IGNhcmRUeXBlTm9kZXMubWFwKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICAvL2xldCBjb21wb25lbnQgPSBub2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVTcHJpdGUnKTtcbiAgICAgICAgICAgIC8vcmV0dXJuIGNvbXBvbmVudC5jYXJkTW9kZSgpOy5fY2FyZE1vZGVsXG4gICAgICAgICAgICByZXR1cm4gbm9kZS5fY2FyZE1vZGVsO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY2FyZE1vZGVzIHx8IFtdO1xuICAgIH0sXG5cbiAgICAvLyDoh6rliqjorr7nva4g5aS044CB5Lit44CB5bC+6YGT55qE5Yig6Zmk5oyJ6ZKu55qE5Y+v6KeB5oCnXG4gICAgX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b25zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbih0aGlzLmxheW91dFRvdURhby5ub2RlLCB0aGlzLmJ0bkRlbGV0ZVRvdURhby5ub2RlKTtcbiAgICAgICAgLy90aGlzLl9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9uKHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZSwgdGhpcy5idG5EZWxldGVaaG9uZ0Rhby5ub2RlKTtcbiAgICAgICAgLy90aGlzLl9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9uKHRoaXMubGF5b3V0V2VpRGFvLm5vZGUsIHRoaXMuYnRuRGVsZXRlV2VpRGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICBfYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbjogZnVuY3Rpb24gKGxheW91dCwgYnV0dG9uKSB7XG4gICAgICAgIC8vYnV0dG9uLmFjdGl2ZSA9IGxheW91dC5jaGlsZHJlbi5sZW5ndGggPiAwO1xuICAgIH0sXG5cbiAgICAvLyDoh6rliqjorr7nva4g4oCc5YWo6YOo5Y+W5raI4oCd44CB4oCc56Gu5a6a5Ye654mM4oCd44CB4oCc57G75Z6L6YCJ5oup4oCd5oyJ6ZKu55qE5Y+v6KeB5oCnXG4gICAgX2F1dG9BY3RpdmVUeXBlQnV0dG9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4gfHwgW107XG4gICAgICAgIC8vbGV0IGhhc0NhcmRVblNlbGVjdGVkID0gY2FyZE5vZGVzLmxlbmd0aCA+IDA7XG4gICAgICAgIC8vdGhpcy5idG5Eb25lLm5vZGUuYWN0aXZlID0gIWhhc0NhcmRVblNlbGVjdGVkO1xuICAgICAgICAvL3RoaXMuYnRuQ2FuY2VsQWxsLm5vZGUuYWN0aXZlID0gdGhpcy5idG5Eb25lLm5vZGUuYWN0aXZlO1xuICAgICAgICAvL3RoaXMudHlwZUJ1dHRvbnNOb2RlLmFjdGl2ZSA9IGhhc0NhcmRVblNlbGVjdGVkO1xuICAgIH0sXG5cbn0pO1xuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgX2NhcmROYW1lOiBudWxsLFxuICAgICAgX2NhcmRNb2RlbDogbnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2V0Q2FyZDogZnVuY3Rpb24gKGNhcmROYW1lLCBpbmRleCwgYXNkZiA9IHRydWUpIHtcbiAgICAgIHRoaXMuX2NhcmROYW1lID0gY2FyZE5hbWU7XG4gICAgICBpZihhc2RmKXtcbiAgICAgICAgICB0aGlzLl9jYXJkTW9kZWwgPSBuZXcgS1FDYXJkKGNhcmROYW1lLG51bGwsaW5kZXgpO1xuICAgICAgfVxuICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZShjYXJkTmFtZSwgZnVuY3Rpb24gKHNwcml0ZUZyYW1lKSB7XG4gICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBjYXJkTmFtZTogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhcmROYW1lO1xuICAgIH0sXG5cbiAgICBjYXJkTW9kZTogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhcmRNb2RlbDtcbiAgICB9LFxuXG4gICAgX2NhcmRGdWxsTmFtZTogZnVuY3Rpb24gKGNhcmRTaG9ydE5hbWUpIHtcbiAgICAgIHZhciBjYXJkTmFtZSA9IGNhcmRTaG9ydE5hbWU7XG4gICAgICBpZiAoIWNhcmROYW1lLnN0YXJ0c1dpdGgoXCJwdWJsaWMtcGljLWNhcmQtcG9rZXJcIikpIHtcbiAgICAgICAgY2FyZE5hbWUgPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY2FyZE5hbWU7XG4gICAgfSxcblxuICAgIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICBjYy5hc3NlcnQoY2FsbGJhY2spO1xuXG4gICAgICBjYy5sb2FkZXIubG9hZFJlcyhcInBsYXkvQ2FyZFR5cGVDb21iaW5lL3BvY2tMaXN0XCIsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY2MuZXJyb3IoZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjYXJkTmFtZSA9IHRoaXMuX2NhcmRGdWxsTmFtZShjYXJkTmFtZSk7XG4gICAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcbiAgICAgICAgY2FsbGJhY2soZnJhbWUpO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxufSk7XG4iLCIvLyDnlKjkuo7lnKjmuLjmiI/ov4fnqIvkuK3vvIzlsZXnpLrnlKjmiLfnmoTogYrlpKnmtojmga9cblxubGV0IENoYXRNZXNzYWdlID0gY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgcmljaFRleHQ6IGNjLlJpY2hUZXh0LFxuICAgICAgICBzcHJpdGVCYWNrZ3JvdW5kOiBjYy5TcHJpdGUsXG4gICAgICAgIGVtb2ppOmNjLk5vZGUsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBDaGF0TWVzc2FnZS5pbnN0YW5jZXMgPSB0aGlzO1xuICAgIH0sXG5cbiAgICBzZXRTdHJpbmc6IGZ1bmN0aW9uIChzdHJpbmcgPSBcIlwiLCBhdXRvSGlkZSA9IHRydWUpIHtcbiAgICAgICAgaWYgKHN0cmluZy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMucmljaFRleHQubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnNwcml0ZUJhY2tncm91bmQubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmVtb2ppLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBsZXQgbWF4V2lkdGggPSAzMDA7XG4gICAgICAgIGxldCByZWFsU3RyID0gQ2hhdE1lc3NhZ2UucGFyc2VTdHJpbmcoc3RyaW5nKTtcblxuICAgICAgICAvLyDnlLHkuo4gY2MuUmljaFRleHQg5Zyo5oyH5a6aIG1heFdpZHRoIOWQju+8jOivpee7k+eCueeahCB3aWR0aCDkvJrkuIDnm7RcbiAgICAgICAgLy8g5pivIG1heFdpZHRoIOWAvOOAguiAjOWcqOWwhiBtYXhXaWR0aCDmjIflrprkuLow5pe277yM5YW2IGNvbnRlbnRTaXplLndpZHRoIOS8mlxuICAgICAgICAvLyDmmK/lhoXlrrnnmoTnnJ/mraPmiYDpnIDnmoTlrr3luqZcbiAgICAgICAgLy9cbiAgICAgICAgLy8g5omA5Lul6L+Z6YeM5YWI5bCGIG1heFdpZHRoIOiuvuS4uiAw77yM6I635Y+W5YW25a6e6ZmF5YaF5a65IHdpZHRoIOWQjuWGjeiwg+aVtFxuICAgICAgICB0aGlzLnJpY2hUZXh0Lm1heFdpZHRoID0gMDtcbiAgICAgICAgdGhpcy5yaWNoVGV4dC5zdHJpbmcgPSByZWFsU3RyO1xuXG4gICAgICAgIGxldCBjb250ZW50V2lkdGggPSB0aGlzLnJpY2hUZXh0Lm5vZGUuZ2V0Q29udGVudFNpemUoKS53aWR0aDtcbiAgICAgICAgaWYgKGNvbnRlbnRXaWR0aCA+IG1heFdpZHRoKSB7XG4gICAgICAgICAgICB0aGlzLnJpY2hUZXh0Lm1heFdpZHRoID0gbWF4V2lkdGg7XG4gICAgICAgICAgICB0aGlzLnJpY2hUZXh0LnN0cmluZyA9IHJlYWxTdHI7XG4gICAgICAgICAgICBjb250ZW50V2lkdGggPSBtYXhXaWR0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubm9kZS53aWR0aCA9IGNvbnRlbnRXaWR0aCArIDI4O1xuICAgICAgICB0aGlzLm5vZGUuaGVpZ2h0ID0gdGhpcy5yaWNoVGV4dC5ub2RlLmdldENvbnRlbnRTaXplKCkuaGVpZ2h0ICsgMjA7XG5cbiAgICAgICAgdGhpcy5zcHJpdGVCYWNrZ3JvdW5kLm5vZGUud2lkdGggPSB0aGlzLm5vZGUud2lkdGg7XG4gICAgICAgIHRoaXMuc3ByaXRlQmFja2dyb3VuZC5ub2RlLmhlaWdodCA9IHRoaXMubm9kZS5oZWlnaHQ7XG5cbiAgICAgICAgaWYgKGF1dG9IaWRlKSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlTm9kZSgpXG4gICAgICAgICAgICAvL3RoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xuICAgICAgICAgICAgLy90aGlzLnNjaGVkdWxlT25jZSh0aGlzLl9oaWRlTm9kZS5iaW5kKHRoaXMpLCAzKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzaG93RW1vamk6IGZ1bmN0aW9uIChzcHJpdGUpIHtcbiAgICAgICAgdGhpcy5faGlkZU5vZGUoKTtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZW1vamkuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5yaWNoVGV4dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNwcml0ZUJhY2tncm91bmQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGJ0blNwcml0ZXMgPSAgdGhpcy5lbW9qaS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgYnRuU3ByaXRlcy5zcHJpdGVGcmFtZSA9IHNwcml0ZTtcbiAgICB9LFxuXG4gICAgX2hpZGVOb2RlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9LmJpbmQodGhpcyksIDMpO1xuICAgIH0sXG5cbn0pO1xuQ2hhdE1lc3NhZ2Uuc2V0RW1vamkgPSBmdW5jdGlvbihzcHJpdGUpe1xuICAgIHRoaXMuaW5zdGFuY2VzLl9oaWRlTm9kZSgpO1xuICAgIHRoaXMuaW5zdGFuY2VzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICB0aGlzLmluc3RhbmNlcy5lbW9qaS5hY3RpdmUgPSB0cnVlO1xuICAgIHRoaXMuaW5zdGFuY2VzLnJpY2hUZXh0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5pbnN0YW5jZXMuc3ByaXRlQmFja2dyb3VuZC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIHZhciBidG5TcHJpdGVzID0gIHRoaXMuaW5zdGFuY2VzLmVtb2ppLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgIGJ0blNwcml0ZXMuc3ByaXRlRnJhbWUgPSBzcHJpdGU7XG4gICAgLy9jb25zb2xlLmxvZyh0aGlzLmVtb2ppKTtcbiAgICAvL3JldHVybjtcbiAgICAvL1xuICAgIC8vdGhpcy5lbW9qaS5TcHJpdGUgPSBzcHJpdGU7XG59LFxuXG4vLyDlsIYgPGJxMTA+IOaUueS4uu+8miA8aW1nIHNyYz0nYmcxMCcvPlxuQ2hhdE1lc3NhZ2UucGFyc2VTdHJpbmcgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgbGV0IHJlc3VsdCA9IHN0ci5yZXBsYWNlKC88YnFcXGR7MSwyfT4vZywgZnVuY3Rpb24obWF0Y2gpe1xuICAgICAgICB2YXIgYnEgPSBtYXRjaC5yZXBsYWNlKFwiPFwiLCBcIiA8aW1nIHNyYz0nXCIpLnJlcGxhY2UoXCI+XCIsIFwiJy8+IFwiKTtcbiAgICAgICAgcmV0dXJuIGJxO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59LFxuXG5tb2R1bGUuZXhwb3J0cyA9IENoYXRNZXNzYWdlO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2V0U3RyaW5nOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICB0aGlzLl9yaWNoVGV4dCgpLnN0cmluZyA9IHN0cjtcbiAgICB9LFxuXG4gICAgX3JpY2hUZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5ub2RlLmdldENvbXBvbmVudCgnY2MuUmljaFRleHQnKTtcbiAgICB9LFxuICAgIFxuICAgIHNldEVtb2ppOmZ1bmN0aW9uKHNwcmFpdGUpe1xuICAgICAgICB0aGlzLl9zcHJpdGVGcmFtZSgpLlNwcmFpdGUgPSBzcHJhaXRlO1xuICAgIH0sXG4gICAgX3Nwcml0ZUZyYW1lOmZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBLUUNhcmRSZXNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRSZXNIZWxwZXInKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHRvdUxheW91dDogY2MuTGF5b3V0LFxuICAgICAgICB6aG9uZ0xheW91dDogY2MuTGF5b3V0LFxuICAgICAgICB3ZWlMYXlvdXQ6IGNjLkxheW91dCxcblxuICAgICAgICB0b3VMYXlvdXRCYWNrOiBjYy5MYXlvdXQsXG4gICAgICAgIHpob25nTGF5b3V0QmFjazogY2MuTGF5b3V0LFxuICAgICAgICB3ZWlMYXlvdXRCYWNrOiBjYy5MYXlvdXQsXG4gICAgICAgIGJhb0RhbzogY2MuTm9kZSwgIC8v5oql6YGT5Zu+LFxuICAgICAgICBwbGF5VG90YWxTY29yZTogY2MuTGF5b3V0LCAgLy/miYDmnInnjqnlrrbnmoTmgLvliIbmlbBcblxuICAgICAgICBkYW9TY29yZUxheW91dHM6IFtjYy5MYXlvdXRdLFxuICAgICAgICBkYW9UaXRsZU5vZGVzOiBbY2MuTm9kZV0sXG4gICAgICAgIFRTY29yZUxheW91dDogY2MuTGF5b3V0LFxuICAgICAgICBUdGl0bGVOb2RlOiBjYy5Ob2RlLFxuXG4gICAgICAgIHBOdW06MCwgICAgICAgICAvL+eOqeWutuS6uuaVsFxuICAgICAgICB0ZVNodVRpbWU6MCwgICAgLy/nibnmrorniYzlh7rniYzpobrluo9cbiAgICAgICAgdGVTaHVOdW06MCwgICAgIC8v54m55q6K54mM5Lq65pWwXG5cbiAgICAgICAgX2xDU2NvcmU6bnVsbCxcbiAgICAgICAgX2Rhb0xheW91dHM6IG51bGwsIC8vIOWktOOAgeS4reOAgeWwvumbhuWQiFxuICAgICAgICBfZGFvTGF5b3V0QmFja3M6IG51bGwsIC8vIOWktOOAgeS4reOAgeWwvumbhuWQiFxuICAgICAgICBfc2NvcmVzOiBudWxsLFxuICAgICAgICBfdXNlcjogbnVsbCwgICAgICAgLy8g55So5LqO5q+U54mM55qE5pWw5o2uXG4gICAgICAgIF9jYXJkc0luZm86IG51bGwsXG4gICAgICAgIF9jb21wYXJlSW5kZXg6IDAsICAvLyDlsIbopoHmr5TovoPnmoQg57Si5byVICAwfjJcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0cyA9IFt0aGlzLnRvdUxheW91dCwgdGhpcy56aG9uZ0xheW91dCwgdGhpcy53ZWlMYXlvdXRdO1xuICAgICAgICB0aGlzLl9kYW9MYXlvdXRCYWNrcyA9IFt0aGlzLnRvdUxheW91dEJhY2ssIHRoaXMuemhvbmdMYXlvdXRCYWNrLCB0aGlzLndlaUxheW91dEJhY2tdO1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG5cbiAgICAgICAgaWYgKHRoaXMuX3Njb3Jlcykge1xuICAgICAgICAgICAgdGhpcy5zZXRTY29yZXModGhpcy5fc2NvcmVzKTtcbiAgICAgICAgfVxuXG4gICAgfSxcblxuICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NvbXBhcmVJbmRleCA9IDA7XG5cbiAgICAgICAgdGhpcy5ub2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtub2RlLmFjdGl2ZSA9IGZhbHNlO30pO1xuXG4gICAgICAgIHRoaXMuYmFvRGFvLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gbnVsbDtcblxuICAgICAgICB2YXIgbm9kZXMgPSB0aGlzLnRvdUxheW91dEJhY2subm9kZS5jaGlsZHJlbi5jb25jYXQodGhpcy56aG9uZ0xheW91dEJhY2subm9kZS5jaGlsZHJlbikuY29uY2F0KHRoaXMud2VpTGF5b3V0QmFjay5ub2RlLmNoaWxkcmVuKTtcblxuICAgICAgICB0aGlzLmNhcmRTcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcblxuICAgICAgICBub2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChub2QpIHtcblxuICAgICAgICAgICAgbm9kLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgICAgIHZhciBjYXJkU3ByaXRlID0gbm9kLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIFwicHVibGljLXBpYy1jYXJkLXBva2VyLWJhY2tcIiAsY2FyZFNwcml0ZSk7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLmRhb1Njb3JlTGF5b3V0cy5mb3JFYWNoKGZ1bmN0aW9uIChub2QpIHtub2Qubm9kZS5hY3RpdmUgPSBmYWxzZTt9LmJpbmQodGhpcykpO1xuXG4gICAgICAgIHRoaXMuZGFvVGl0bGVOb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChub2QpIHtub2QuYWN0aXZlID0gZmFsc2U7fS5iaW5kKHRoaXMpKTtcblxuICAgICAgICBpZih0aGlzLlRTY29yZUxheW91dCkgdGhpcy5UU2NvcmVMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICBpZih0aGlzLlR0aXRsZU5vZGUpIHRoaXMuVHRpdGxlTm9kZS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcblxuICAgICAgICAvL2NvbnNvbGUubG9nKCfmiafooYzkuobkuIDpgY3muIXpmaTlrprml7blmagtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpXG5cbiAgICAgICAgaWYodGhpcy5UU2NvcmVMYXlvdXQpIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcblxuICAgICAgICBpZih0aGlzLnBsYXlUb3RhbFNjb3JlKSB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcbiAgICB9LFxuXG4gICAgc2V0Q29tcGFyZURhdGE6IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIHRoaXMuX3VzZXIgPSB1c2VyO1xuICAgICAgICB0aGlzLl9jYXJkc0luZm8gPSB1c2VyLmNhcmRJbmZvO1xuICAgICAgICBsZXQgY2FyZHNJbmZvID0gdXNlci5jYXJkSW5mbztcbiAgICAgICAgdGhpcy5fbENTY29yZSA9IHVzZXIubENTY29yZTtcbiAgICAgICAgbGV0IGNhcmRzID0gY2FyZHNJbmZvLm1hcChmdW5jdGlvbiAoY2FyZEluZm9JdGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRJbmZvSXRlbS5jYXJkcyk7XG4gICAgICAgIH0pLnJlZHVjZShmdW5jdGlvbiAoYXJyYXksIHN1YkNhcmRzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXJyYXkuY29uY2F0KHN1YkNhcmRzKTtcbiAgICAgICAgfSwgW10pO1xuXG5cbiAgICAgICAgbGV0IHNjb3JlcyA9IFt1c2VyLnNjb3JlMSB8fCAwLCB1c2VyLnNjb3JlMiB8fCAwLCB1c2VyLnNjb3JlMyB8fCAwLHVzZXIubFNjb3JlMSB8fCAwLCB1c2VyLmxTY29yZTIgfHwgMCwgdXNlci5sU2NvcmUzIHx8IDBdO1xuICAgICAgICB0aGlzLnNldENhcmRzKGNhcmRzKTtcbiAgICAgICAgdGhpcy5zZXRTY29yZXMoc2NvcmVzKTtcbiAgICB9LFxuXG4gICAgLy/mmL7npLrmiYDmnInnjqnlrrbnmoTmgLvliIbmlbBcbiAgICBzaG93U2NvcmVSZXN1bHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZighdGhpcy5fdXNlcikgcmV0dXJuO1xuICAgICAgICB2YXIgc2NvcmVzID0gdGhpcy5fdXNlci5jU2NvcmU7XG4gICAgICAgIHRoaXMuc2V0U2NvcmVzKFtzY29yZXNdLFt0aGlzLnBsYXlUb3RhbFNjb3JlXSx0cnVlKTtcbiAgICAgICAgdGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMucGxheVRvdGFsU2NvcmUubm9kZS5vcGFjaXR5ID0gMjU1O1xuICAgICAgICB2YXIgeCA9IHRoaXMucGxheVRvdGFsU2NvcmUubm9kZS54O1xuICAgICAgICB2YXIgeSA9IHRoaXMucGxheVRvdGFsU2NvcmUubm9kZS55O1xuICAgICAgICB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUucnVuQWN0aW9uKGNjLm1vdmVUbygwLjgsIGNjLnAoeCwgeSszMCkpKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUucnVuQWN0aW9uKGNjLmZhZGVPdXQoMC4yKSk7XG4gICAgICAgIH0uYmluZCh0aGlzKSwwLjYpO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHt0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUueSA9IHk7fS5iaW5kKHRoaXMpLDEpO1xuICAgIH0sXG5cbiAgICAvL+aYvuekuuS4iemBk+WIhuaVsFxuICAgIHNob3dOZXh0Q29tcGFyZVNjb3JlOiBmdW5jdGlvbihpc0NvbnRhaW5FeHRyYSkge1xuICAgICAgICBpZihpc0NvbnRhaW5FeHRyYSAmJiB0aGlzLlRTY29yZUxheW91dCl7XG4gICAgICAgICAgICB2YXIgc2NvcmVzMSA9IHRoaXMuX2xDU2NvcmUuc3BsaWNlKDAsMSk7XG4gICAgICAgICAgICBpZihzY29yZXMxLmxlbmd0aCA8PSAwKSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLnNldFNjb3JlcyhzY29yZXMxLFt0aGlzLlRTY29yZUxheW91dF0sdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLlR0aXRsZU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICAgICAgdmFyIHNjYWxlVG8xMSA9IGNjLnNjYWxlVG8gKDAuMywgMS44KVxuICAgICAgICAgICAgdmFyIHNjYWxlVG8yMSA9IGNjLnNjYWxlVG8gKDAuMSwgMS4xKVxuICAgICAgICAgICAgdmFyIHNjYWxlVG8zMSA9IGNjLnNjYWxlVG8gKDAuMSwgMS4zKVxuICAgICAgICAgICAgdmFyIHNjYWxlVG9TZXExID1jYy5zZXF1ZW5jZShzY2FsZVRvMTEsc2NhbGVUbzIxLHNjYWxlVG8zMSk7XG4gICAgICAgICAgICB0aGlzLlRTY29yZUxheW91dC5ub2RlLnJ1bkFjdGlvbihzY2FsZVRvU2VxMSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZih0aGlzLmRhb1Njb3JlTGF5b3V0cy5sZW5ndGggPD0gMCkgcmV0dXJuO1xuICAgICAgICBpZighdGhpcy5fdXNlci5pc0NvbnRhaW5FeHRyYSl7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9jb21wYXJlSW5kZXggPT0gMCA/IDE6IHRoaXMuX2NvbXBhcmVJbmRleDtcbiAgICAgICAgICAgIHRoaXMuZGFvU2NvcmVMYXlvdXRzW2luZGV4LTFdLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZGFvU2NvcmVMYXlvdXRzW2luZGV4KzJdLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZGFvVGl0bGVOb2Rlc1tpbmRleC0xXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNjb3JlcyA9IHRoaXMuX2xDU2NvcmUuc3BsaWNlKDAsMSk7XG4gICAgICAgIGlmKHNjb3Jlcy5sZW5ndGggPD0gMCAgJiYgIXRoaXMuVFNjb3JlTGF5b3V0KSByZXR1cm47XG4gICAgICAgIHRoaXMuc2V0U2NvcmVzKHNjb3JlcyxbdGhpcy5UU2NvcmVMYXlvdXRdLHRydWUpO1xuICAgICAgICB0aGlzLlR0aXRsZU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5UU2NvcmVMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHZhciBzY2FsZVRvMSA9IGNjLnNjYWxlVG8gKDAuMywgMS44KVxuICAgICAgICB2YXIgc2NhbGVUbzIgPSBjYy5zY2FsZVRvICgwLjEsIDEuMSlcbiAgICAgICAgdmFyIHNjYWxlVG8zID0gY2Muc2NhbGVUbyAoMC4xLCAxLjMpXG4gICAgICAgIHZhciBzY2FsZVRvU2VxID1jYy5zZXF1ZW5jZShzY2FsZVRvMSxzY2FsZVRvMixzY2FsZVRvMyk7XG4gICAgICAgIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUucnVuQWN0aW9uKHNjYWxlVG9TZXEpO1xuXG4gICAgfSxcblxuICAgIC8vIOS4i+S4gOS4quimgeavlOi+g+eahOWIhuaVsFxuICAgIC8vIOWmguaenOayoeacieimgeavlOi+g+eahOS6hu+8jOWImei/lOWbniAwXG4gICAgbmV4dENvbXBhcmVTY29yZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghdGhpcy5fdXNlcikgcmV0dXJuIDA7XG5cbiAgICAgICAgdmFyIGRhdGE7XG4gICAgICAgIGlmKHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEpe1xuICAgICAgICAgICAgZGF0YSA9IHRoaXMuX2NhcmRzSW5mb1swXTtcbiAgICAgICAgICAgIGlmIChkYXRhKSByZXR1cm4gZGF0YS50eXBlICogOTAwMDAwMDAwMDAwMDAwMDtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBkYXRhID0gdGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkYXRhKSByZXR1cm4gMDtcbiAgICAgICAgcmV0dXJuIGRhdGEudmFsdWU7XG4gICAgfSxcblxuICAgIHNldE1hUGFpOiBmdW5jdGlvbiAobm9kZXMgLGNhcmROYW1lKSB7XG4gICAgICAgIGlmKGNjLm1hUGFpID09IGNhcmROYW1lKXtcblxuICAgICAgICAgICAgdmFyIG5vZGRzID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcblxuICAgICAgICAgICAgbm9kZHMuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XG5cbiAgICAgICAgICAgIGNjLmxvYWRlci5sb2FkUmVzKCdwbGF5L2Rlc2svaW1nX3JlZDVfMScsIGNjLlNwcml0ZUZyYW1lLCBmdW5jdGlvbiAoZXJyLCBzcHJpdGVGcmFtZSkge1xuXG4gICAgICAgICAgICAgICAgaWYgKGVycikge2NjLmVycm9yKGVyci5tZXNzYWdlIHx8IGVycik7cmV0dXJuO31cblxuICAgICAgICAgICAgICAgIHZhciBidG5TcHJpdGUxID0gbm9kZHMuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgICAgICAgICAgICBidG5TcHJpdGUxLnNpemVNb2RlID0gMDtcblxuICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcblxuICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEubm9kZS53aWR0aCA9IG5vZGVzLndpZHRoICsgMTA7XG5cbiAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUuaGVpZ2h0ID0gbm9kZXMuaGVpZ2h0ICsgMTA7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIG5vZGVzLmFkZENoaWxkKG5vZGRzKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzZXRDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XG5cbiAgICAgICAgbGV0IGNhcmRTcHJpdGVzID0gdGhpcy5fYWxsQ2FyZFNwcml0ZXMoKTtcblxuICAgICAgICB0aGlzLmNhcmRTcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcblxuICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChrcUNhcmQsIGluZGV4KSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPj0gY2FyZFNwcml0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FyZFNwcml0ZXNbaW5kZXhdLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcblxuICAgICAgICAgICAgY2FyZFNwcml0ZXNbaW5kZXhdLm5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBcIlwiO1xuXG4gICAgICAgICAgICB2YXIgbm9kZHMxID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcblxuICAgICAgICAgICAgbm9kZHMxLmNhcmROYW1lID0ga3FDYXJkLmNhcmROYW1lKCk7XG5cbiAgICAgICAgICAgIG5vZGRzMS53aWR0aCA9IGNhcmRTcHJpdGVzW2luZGV4XS5ub2RlLndpZHRoO1xuXG4gICAgICAgICAgICBub2RkczEuaGVpZ2h0ID0gY2FyZFNwcml0ZXNbaW5kZXhdLm5vZGUuaGVpZ2h0O1xuXG4gICAgICAgICAgICBub2RkczEuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XG5cbiAgICAgICAgICAgIHZhciBjYXJkU3ByaXRlID0gbm9kZHMxLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XG5cbiAgICAgICAgICAgIGNhcmRTcHJpdGUuc2l6ZU1vZGUgPSAwO1xuXG4gICAgICAgICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsga3FDYXJkLmNhcmROYW1lKCk7XG5cbiAgICAgICAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZSh0aGlzLmNhcmRTcHJpdGVBdGxhcywgcGF0aCAsY2FyZFNwcml0ZSk7XG5cbiAgICAgICAgICAgIHRoaXMuc2V0TWFQYWkoY2FyZFNwcml0ZS5ub2RlLCBrcUNhcmQuY2FyZE5hbWUoKSk7XG5cbiAgICAgICAgICAgIGNhcmRTcHJpdGVzW2luZGV4XS5ub2RlLmFkZENoaWxkKG5vZGRzMSk7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB2YXIgY2FyZHMwID0gY2FyZHMuc2xpY2UoMCwzKVxuICAgICAgICB2YXIgY2FyZHMxID0gY2FyZHMuc2xpY2UoMyw4KVxuICAgICAgICB2YXIgY2FyZHMyID0gY2FyZHMuc2xpY2UoOCwxMylcblxuICAgICAgICB2YXIgY2FyZHMxMSA9IFtjYXJkczAsIGNhcmRzMSwgY2FyZHMyXVxuICAgICAgICAvL+WktOmBk1xuICAgICAgICBsZXQgdHlwZU5hbWUwID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkczApKzE7XG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD49MTAgPyB0eXBlTmFtZTAgOlwiMFwiK3R5cGVOYW1lMDtcbiAgICAgICAgdHlwZU5hbWUwID0gdHlwZU5hbWUwPT0nMDQnID8gJzExJyA6dHlwZU5hbWUwO1xuXG4gICAgICAgIC8v5Lit6YGTXG4gICAgICAgIGxldCB0eXBlTmFtZTEgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzMSkrMTtcbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPj0xMCA/IHR5cGVOYW1lMSA6XCIwXCIrdHlwZU5hbWUxO1xuICAgICAgICB0eXBlTmFtZTEgPSB0eXBlTmFtZTE9PScwNycgPyAnMjInIDp0eXBlTmFtZTE7XG5cbiAgICAgICAgLy/lsL7pgZNcbiAgICAgICAgbGV0IHR5cGVOYW1lMiA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMyKSsxO1xuICAgICAgICB0eXBlTmFtZTIgPSB0eXBlTmFtZTI+PTEwID8gdHlwZU5hbWUyIDpcIjBcIit0eXBlTmFtZTI7XG5cbiAgICAgICAgY2FyZFNwcml0ZXMgPSBjYXJkU3ByaXRlcy5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkubm9kZTt9KTtcblxuICAgICAgICBpZih0eXBlTmFtZTApIEtRQ2FyZC5fc2V0R3VpQ2FyZCgwLCAwLCAzLCB0eXBlTmFtZTAsIGNhcmRzMTEsIGNhcmRTcHJpdGVzLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG4gICAgICAgIGlmKHR5cGVOYW1lMSkgS1FDYXJkLl9zZXRHdWlDYXJkKDEsIDMsIDgsIHR5cGVOYW1lMSwgY2FyZHMxMSwgY2FyZFNwcml0ZXMsIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcbiAgICAgICAgaWYodHlwZU5hbWUyKSBLUUNhcmQuX3NldEd1aUNhcmQoMiwgOCwgMTMsIHR5cGVOYW1lMiwgY2FyZHMxMSwgY2FyZFNwcml0ZXMsIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcblxuICAgIH0sXG5cblxuICAgIHNldFNjb3JlczogZnVuY3Rpb24gKHNjb3JlcyAsTGF5b3V0cyA9IG51bGwgLGlzX1dIID0gZmFsc2UpIHtcbiAgICAgICAgaWYoIUxheW91dHMpe1xuICAgICAgICAgICAgTGF5b3V0cyA9IHRoaXMuZGFvU2NvcmVMYXlvdXRzO1xuICAgICAgICAgICAgaWYoTGF5b3V0cy5sZW5ndGggPD0gMCkgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc2NvcmVzLmZvckVhY2goZnVuY3Rpb24gKHN0cmluZywgaW5kZXgpIHtcblxuICAgICAgICAgICAgbGV0IGxhYmVscyA9IExheW91dHNbaW5kZXhdO1xuXG4gICAgICAgICAgICBsYWJlbHMubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICB2YXIgcGF0aCA9IFwicGxheS9DYXJkVHlwZUNvbWJpbmUvXCIgKyAoKE51bWJlcihzdHJpbmcpID49IDApID8gXCJhZGROdW1cIiA6IFwiZGVsTnVtXCIpO1xuXG4gICAgICAgICAgICB0aGlzLl9jcmVhdG9yTm9kZXMobGFiZWxzLm5vZGUgLDEwICxwYXRoICwnJyAsaXNfV0gpO1xuXG4gICAgICAgICAgICB2YXIgc3RyaW5ncyA9IChzdHJpbmcgPiAwKSA/IChzdHJpbmcpICsgXCJcIjogKHN0cmluZyAqIC0xKSArIFwiXCI7XG5cbiAgICAgICAgICAgIHZhciBzdHJpbmdBeXkgPSBzdHJpbmdzLnNwbGl0KFwiXCIpO1xuXG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCBzdHJpbmdBeXkubGVuZ3RoO2krKyl7XG5cbiAgICAgICAgICAgICAgICBsZXQgcyA9IHN0cmluZ0F5eVtpXTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2NyZWF0b3JOb2RlcyhsYWJlbHMubm9kZSAsTnVtYmVyKHMpICxwYXRoICwnJyAsaXNfV0gpO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxhYmVscy50eXBlID0gMTtcblxuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBfY3JlYXRvck5vZGVzOmZ1bmN0aW9uKG5vZGVzLG5hbWUscGF0aCxwYXRocyx3X2ggPSBmYWxzZSl7XG5cbiAgICAgICAgdmFyIG5vZGUgPSBuZXcgY2MuTm9kZSgpOyAvL+WIm+W7uuS4gOS4quiKgueCueWvueixoVxuXG4gICAgICAgIG5vZGUuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XG5cbiAgICAgICAgdmFyIGJ0blNwcml0ZSA9IG5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgICAgYnRuU3ByaXRlLnNpemVNb2RlID0gMDtcblxuICAgICAgICBidG5TcHJpdGUubm9kZS53aWR0aCA9IDE4O2J0blNwcml0ZS5ub2RlLmhlaWdodCA9IDIzO1xuICAgICAgICAvL25hbWUgPSBuYW1lICsgXCJcIjtcbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZShuYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcblxuICAgICAgICAgICAgYnRuU3ByaXRlLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG5cbiAgICAgICAgICAgIGlmKHdfaCl7YnRuU3ByaXRlLm5vZGUud2lkdGggPSAzMDtidG5TcHJpdGUubm9kZS5oZWlnaHQgPSA0MDt9XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpLCBwYXRoLCBwYXRocyk7XG5cbiAgICAgICAgbm9kZXMuYWRkQ2hpbGQobm9kZSk7XG5cbiAgICB9LFxuXG4gICAgX3NldENhcmRTcHJpdGVGcmFtZTogZnVuY3Rpb24gKGluZGV4cyxub2Rlcykge1xuICAgICAgICBsZXQgY2FyZHNJbmZvID0gdGhpcy5fY2FyZHNJbmZvO1xuICAgICAgICBsZXQgY2FyZHMgPSBjYXJkc0luZm8ubWFwKGZ1bmN0aW9uIChjYXJkSW5mb0l0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRJbmZvSXRlbS5jYXJkcyk7XG4gICAgICAgICAgICB9KVtpbmRleHNdIHx8IFtdO1xuXG4gICAgICAgIHRoaXMuY2FyZFNwcml0ZUF0bGFzID0gdGhpcy5ub2RlLnBhcmVudC5wYXJlbnQuZ2V0Q29tcG9uZW50KCdwbGF5JykuY2FyZFNwcml0ZUF0bGFzO1xuXG4gICAgICAgIC8vIGNjLmxvZyh0aGlzLl9jYXJkc0luZm8pXG4gICAgICAgIC8vIGNjLmxvZyhjYXJkcylcbiAgICAgICAgLy8gY2MubG9nKCctLS0tLS01NTUnKVxuXG4gICAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGtxQ2FyZCwgaW5kZXgpIHtcblxuICAgICAgICAgICAgbm9kZXMuY2hpbGRyZW5baW5kZXhdLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IFwiXCJcblxuICAgICAgICAgICAgdmFyIG5vZGRzMSA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXG5cbiAgICAgICAgICAgIG5vZGRzMS5jYXJkTmFtZSA9IGtxQ2FyZC5jYXJkTmFtZSgpO1xuXG4gICAgICAgICAgICBub2RkczEud2lkdGggPSBub2Rlcy5jaGlsZHJlbltpbmRleF0ud2lkdGg7XG5cbiAgICAgICAgICAgIGlmKG5vZGVzLnBhcmVudC5wYXJlbnQubmFtZSA9PSBcInBsYXlTZWxmXCIpe1xuXG4gICAgICAgICAgICAgICAgbm9kZXMuY2hpbGRyZW5baW5kZXhdLmhlaWdodCA9IDEzMDtcblxuICAgICAgICAgICAgICAgIG5vZGRzMS5oZWlnaHQgPSAxMzA7XG5cbiAgICAgICAgICAgIH1lbHNle1xuXG4gICAgICAgICAgICAgICAgbm9kZXMuY2hpbGRyZW5baW5kZXhdLmhlaWdodCA9IDExNTtcblxuICAgICAgICAgICAgICAgIG5vZGRzMS5oZWlnaHQgPSAxMTU7XG5cbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG5vZGVzKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG5vZGRzMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5vZGRzMS5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTsgLy/mt7vliqDnsr7ngbXnu4Tku7ZcblxuICAgICAgICAgICAgdmFyIGNhcmRTcHJpdGUgPSBub2RkczEuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcblxuICAgICAgICAgICAgY2FyZFNwcml0ZS5zaXplTW9kZSA9IDA7XG5cbiAgICAgICAgICAgIHZhciBwYXRoID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBrcUNhcmQuY2FyZE5hbWUoKTtcblxuICAgICAgICAgICAgY2FyZFNwcml0ZS5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZSh0aGlzLmNhcmRTcHJpdGVBdGxhcywgcGF0aCAsY2FyZFNwcml0ZSk7XG5cbiAgICAgICAgICAgIHRoaXMuc2V0TWFQYWkoY2FyZFNwcml0ZS5ub2RlLCBrcUNhcmQuY2FyZE5hbWUoKSk7XG5cbiAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5hZGRDaGlsZChub2RkczEpO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdmFyIHR5cGVOYW1lID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkcykrMTtcblxuICAgICAgICB0eXBlTmFtZSA9IHR5cGVOYW1lPj0xMCA/IHR5cGVOYW1lK1wiXCIgOlwiMFwiK3R5cGVOYW1lO1xuXG4gICAgICAgIC8v5aS06YGTXG4gICAgICAgIGlmKGluZGV4cyA9PSAwKXtcbiAgICAgICAgICAgIHR5cGVOYW1lID0gdHlwZU5hbWU9PScwNCcgPyAnMTEnIDp0eXBlTmFtZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGluZGV4cyA9PSAxKXtcbiAgICAgICAgICAgIHR5cGVOYW1lID0gdHlwZU5hbWU9PScwNycgPyAnMjInIDp0eXBlTmFtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBjYXJkU3ByaXRlcyA9IG5vZGVzLmNoaWxkcmVuLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaTt9KTtcblxuICAgICAgICBLUUNhcmQuX3NldEd1aUNhcmRzKHR5cGVOYW1lLCBjYXJkcywgY2FyZFNwcml0ZXMsIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcblxuICAgIH0sXG5cbiAgICBzaG93VG91Q2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYodGhpcy5fdXNlci5pc0NvbnRhaW5FeHRyYSA9PSB0cnVlKSByZXR1cm47XG4gICAgICAgIC8vY29uc29sZS5sb2coJ+W8gOWni+aJp+ihjOS4gOasoeWumuaXtuWKqOS9nC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJylcblxuICAgICAgICB0aGlzLnRvdUxheW91dEJhY2subm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fc2V0Q2FyZFNwcml0ZUZyYW1lKDAsdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUpO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMudG91TGF5b3V0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnRvdUxheW91dEJhY2subm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9LmJpbmQodGhpcyksIDAuNyk7XG5cbiAgICAgICAgdGhpcy50b3VMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnRvdUxheW91dC5ub2RlLnNjYWxlWSA9IDAuNztcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnRvdUxheW91dC5ub2RlLnNjYWxlWSA9IDE7XG4gICAgICAgIH0uYmluZCh0aGlzKSwgMC4wMik7XG5cblxuICAgICAgICB2YXIgdHlwZXMgPSB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlID09IDMgPyAzMzM6dGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF0udHlwZTtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlDYXJkVHlwZSh0aGlzLl91c2VyLnNleCwgdHlwZXMpO1xuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggKz0gMTtcbiAgICB9LFxuXG4gICAgc2hvd1pob25nQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYodGhpcy5fdXNlci5pc0NvbnRhaW5FeHRyYSA9PSB0cnVlKSByZXR1cm47XG5cbiAgICAgICAgdGhpcy56aG9uZ0xheW91dEJhY2subm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fc2V0Q2FyZFNwcml0ZUZyYW1lKDEsdGhpcy56aG9uZ0xheW91dEJhY2subm9kZSk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy56aG9uZ0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy56aG9uZ0xheW91dEJhY2subm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9LmJpbmQodGhpcyksIDAuNyk7XG5cbiAgICAgICAgdGhpcy56aG9uZ0xheW91dC5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuemhvbmdMYXlvdXQubm9kZS5zY2FsZVkgPSAwLjc7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy56aG9uZ0xheW91dC5ub2RlLnNjYWxlWSA9IDE7XG4gICAgICAgIH0uYmluZCh0aGlzKSwgMC4wMik7XG5cbiAgICAgICAgdmFyIHR5cGVzID0gdGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF0udHlwZSA9PSA2ID8gNTU1OnRoaXMuX2NhcmRzSW5mb1t0aGlzLl9jb21wYXJlSW5kZXhdLnR5cGU7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5Q2FyZFR5cGUodGhpcy5fdXNlci5zZXgsIHR5cGVzKTtcbiAgICAgICAgdGhpcy5fY29tcGFyZUluZGV4ICs9IDE7XG4gICAgfSxcblxuICAgIHNob3dXZWlDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2NvbnNvbGUubG9nKCfmiafooYzkuobkuIDmrKHlsL7pgZPliqjnlLstLS0tLS0tLS0tLS0tLS0nKVxuICAgICAgICBpZih0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhID09IHRydWUpIHJldHVybjtcbiAgICAgICAgLy90aGlzLl9zZXRDYXJkU3ByaXRlRnJhbWUoMSx0aGlzLnpob25nTGF5b3V0QmFjay5ub2RlKTtcbiAgICAgICAgdGhpcy53ZWlMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3NldENhcmRTcHJpdGVGcmFtZSgyLHRoaXMud2VpTGF5b3V0QmFjay5ub2RlKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLndlaUxheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy53ZWlMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjcpO1xuXG4gICAgICAgIHRoaXMud2VpTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy53ZWlMYXlvdXQubm9kZS5zY2FsZVkgPSAwLjc7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy53ZWlMYXlvdXQubm9kZS5zY2FsZVkgPSAxO1xuICAgICAgICB9LmJpbmQodGhpcyksIDAuMDIpO1xuXG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5Q2FyZFR5cGUodGhpcy5fdXNlci5zZXgsIHRoaXMuX2NhcmRzSW5mb1t0aGlzLl9jb21wYXJlSW5kZXhdLnR5cGUpO1xuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggKz0gMTtcbiAgICB9LFxuXG4gICAgc2hvd1RlU2h1Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xuICAgICAgICAvL2xldCB0eXBlTmFtZSA9IEtRQ2FyZC5jYXJkc1R5cGVOYW1lKGNhcmRzTmFtZXMpO1xuICAgICAgICB0aGlzLl9kYW9MYXlvdXRCYWNrcyA9IFt0aGlzLnRvdUxheW91dEJhY2ssIHRoaXMuemhvbmdMYXlvdXRCYWNrLCB0aGlzLndlaUxheW91dEJhY2tdO1xuXG4gICAgICAgIGxldCB0b3VDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLl9kYW9MYXlvdXRCYWNrc1swXSk7XG4gICAgICAgIGxldCB6aG9uZ0NhcmRTcHJpdGVzID0gdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KHRoaXMuX2Rhb0xheW91dEJhY2tzWzFdKTtcbiAgICAgICAgbGV0IHdlaUNhcmRTcHJpdGVzID0gdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KHRoaXMuX2Rhb0xheW91dEJhY2tzWzJdKTtcbiAgICAgICAgbGV0IGNhcmRTcHJpdGVzID0gdG91Q2FyZFNwcml0ZXMuY29uY2F0KHpob25nQ2FyZFNwcml0ZXMpLmNvbmNhdCh3ZWlDYXJkU3ByaXRlcyk7XG4gICAgICAgIHRoaXMuY2FyZFNwcml0ZUF0bGFzID0gdGhpcy5ub2RlLnBhcmVudC5wYXJlbnQuZ2V0Q29tcG9uZW50KCdwbGF5JykuY2FyZFNwcml0ZUF0bGFzO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGtxQ2FyZCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPj0gY2FyZFNwcml0ZXMubGVuZ3RoKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBsZXQgY2FyZFNwcml0ZSA9IGNhcmRTcHJpdGVzW2luZGV4XTtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBrcUNhcmQuY2FyZE5hbWUoKTtcblxuICAgICAgICAgICAgICAgIGNhcmRTcHJpdGUubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICAgICAgS1FDYXJkLl9sb2FkQ2FyZEZyYW1lKHRoaXMuY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxjYXJkU3ByaXRlKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuc2V0TWFQYWkoY2FyZFNwcml0ZS5ub2RlLCBrcUNhcmQuY2FyZE5hbWUoKSk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB0aGlzLl9kYW9MYXlvdXRCYWNrcy5mb3JFYWNoKGZ1bmN0aW9uIChub2Rlcykge25vZGVzLm5vZGUuYWN0aXZlID0gdHJ1ZTt9LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlDYXJkVHlwZSh0aGlzLl91c2VyLnNleCwgdGhpcy5fY2FyZHNJbmZvWzBdLnR5cGUpO1xuICAgICAgICB9LmJpbmQodGhpcyksMC4xKTtcbiAgICB9LFxuXG4gICAgc2hvd05leHRDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2FyZFR5cGVDb21iaW5lID0gdGhpcy5ub2RlLnBhcmVudC5wYXJlbnQuZ2V0Q2hpbGRCeU5hbWUoJ0NhcmRUeXBlQ29tYmluZScpLmdldENvbXBvbmVudCgnQ2FyZFR5cGVDb21iaW5lJyk7XG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZXNldCgpO1xuICAgICAgICBjYXJkVHlwZUNvbWJpbmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLnRvdUxheW91dEJhY2subm9kZS5wYXJlbnQuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEpIHtcbiAgICAgICAgICAgIHZhciBjYXJkcyA9IHRoaXMuX2NhcmRzSW5mb1swXS5jYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZEluZm9JdGVtKTtcbiAgICAgICAgICAgIH0pLnJlZHVjZShmdW5jdGlvbiAoYXJyYXksIHN1YkNhcmRzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7XG4gICAgICAgICAgICB9LCBbXSk7XG4gICAgICAgICAgICB0aGlzLnNob3dUZVNodUNhcmRzKGNhcmRzKTtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Jhb0RhbygwLDApO1xuICAgICAgICAgICAgdGhpcy5iYW9EYW8uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9kYW9MYXlvdXRzID0gW3RoaXMudG91TGF5b3V0LCB0aGlzLnpob25nTGF5b3V0LCB0aGlzLndlaUxheW91dF07XG4gICAgICAgIHRoaXMuX2Rhb0xheW91dHMuZm9yRWFjaChmdW5jdGlvbiAobm9kZXMpIHtcbiAgICAgICAgICAgIG5vZGVzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5fY29tcGFyZUluZGV4ID09IDApIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Jhb0RhbygwLDE0MCk7XG4gICAgICAgICAgICB0aGlzLnNob3dUb3VDYXJkcygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX2NvbXBhcmVJbmRleCA9PSAxKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dCYW9EYW8oMSw4NSk7XG4gICAgICAgICAgICB0aGlzLnNob3daaG9uZ0NhcmRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fY29tcGFyZUluZGV4ID09IDIpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Jhb0RhbygyLDM0KTtcbiAgICAgICAgICAgIHRoaXMuc2hvd1dlaUNhcmRzKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmJhb0Rhby5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHt0aGlzLmJhb0Rhby5hY3RpdmUgPSBmYWxzZTt9LmJpbmQodGhpcyksIDAuNyk7XG5cbiAgICB9LFxuXG4gICAgc2hvd0FsbENhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKCF0aGlzLl91c2VyKSByZXR1cm47XG5cbiAgICAgICAgaWYgKHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEpIHtcblxuICAgICAgICAgICAgdmFyIGNhcmRzID0gdGhpcy5fY2FyZHNJbmZvWzBdLmNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZEluZm9JdGVtKSB7cmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0pO30pXG4gICAgICAgICAgICAgICAgLnJlZHVjZShmdW5jdGlvbiAoYXJyYXksIHN1YkNhcmRzKSB7cmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7fSwgW10pO1xuXG4gICAgICAgICAgICB0aGlzLnNob3dUZVNodUNhcmRzKGNhcmRzKTtcblxuICAgICAgICAgICAgLy9yZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZighdGhpcy5fZGFvTGF5b3V0QmFja3MpIHJldHVybjtcblxuICAgICAgICB0aGlzLnRvdUxheW91dEJhY2subm9kZS5wYXJlbnQuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLl9kYW9MYXlvdXRCYWNrcy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlcyxpbmRleCkge1xuXG4gICAgICAgICAgICBub2Rlcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAgIG5vZGVzLm5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAobm8pIHtuby5hY3RpdmUgPSB0cnVlO30pO1xuXG4gICAgICAgICAgICB0aGlzLl9zZXRDYXJkU3ByaXRlRnJhbWUoaW5kZXgsbm9kZXMubm9kZSk7XG5cbiAgICAgICAgICAgIGlmKHRoaXMuVFNjb3JlTGF5b3V0KSB0aGlzLmRhb1RpdGxlTm9kZXNbaW5kZXhdLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICBpZighdGhpcy5UU2NvcmVMYXlvdXQpIHJldHVybjtcblxuICAgICAgICB0aGlzLmRhb1Njb3JlTGF5b3V0cy5mb3JFYWNoKGZ1bmN0aW9uIChub2Rlcykge1xuXG4gICAgICAgICAgICBub2Rlcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLnNldFNjb3JlcyhbdGhpcy5fdXNlci5jU2NvcmVdLFt0aGlzLlRTY29yZUxheW91dF0sdHJ1ZSk7XG5cbiAgICAgICAgdGhpcy5UdGl0bGVOb2RlLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5UU2NvcmVMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgfSxcblxuICAgIHNob3dCYW9EYW86IGZ1bmN0aW9uIChpbmRleCxwb3NpdG9uWSkge1xuICAgICAgICBsZXQgY2FyZHNJbmZvID0gdGhpcy5fY2FyZHNJbmZvO1xuICAgICAgICBsZXQgY2FyZFR5cGUgPSBjYXJkc0luZm8ubWFwKGZ1bmN0aW9uIChjYXJkSW5mb0l0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybiBjYXJkSW5mb0l0ZW0udHlwZVxuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgdHlwZU5hbWUwID0gY2FyZFR5cGVbaW5kZXhdKzE7XG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD49MTAgPyB0eXBlTmFtZTAgOlwiMFwiK3R5cGVOYW1lMDtcbiAgICAgICAgaWYoaW5kZXggPT0gMCkgdHlwZU5hbWUwID0gdHlwZU5hbWUwPT0nMDQnID8gJzExJyA6dHlwZU5hbWUwO1xuICAgICAgICBpZihpbmRleCA9PSAxKSB0eXBlTmFtZTAgPSB0eXBlTmFtZTA9PScwNycgPyAnMjInIDp0eXBlTmFtZTA7XG5cbiAgICAgICAgaWYoY2FyZFR5cGVbaW5kZXhdID09IDEwKSB0eXBlTmFtZTAgPSAnMTUnOy8v54m55q6K54mMXG4gICAgICAgIGlmKGNhcmRUeXBlW2luZGV4XSA9PSAxMSkgdHlwZU5hbWUwID0gJzE0JztcbiAgICAgICAgaWYoY2FyZFR5cGVbaW5kZXhdID09IDEyKSB0eXBlTmFtZTAgPSAnMTYnO1xuICAgICAgICBpZihjYXJkVHlwZVtpbmRleF0gPT0gMTgpIHR5cGVOYW1lMCA9ICcyNSc7XG4gICAgICAgIGlmKGNhcmRUeXBlW2luZGV4XSA9PSAxOSkgdHlwZU5hbWUwID0gJzI2JztcblxuICAgICAgICB2YXIgcGF0aCA9IHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmE/XCJnYW1lLXJpZ2h0X3NwZWNpYVwiOlwiZ2FtZS1wb2tlcl90eXBlXCI7XG5cbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZSh0eXBlTmFtZTAsIGZ1bmN0aW9uIChzcHJpdGVGcmFtZSkge1xuICAgICAgICAgICAgdmFyIGJ0blNwcml0ZXMxID0gIHRoaXMuYmFvRGFvLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgYnRuU3ByaXRlczEuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCBcInBsYXkvQ2FyZFR5cGVDb21iaW5lL2dhbWVfdHh0XCIscGF0aCk7XG4gICAgICAgIHRoaXMuYmFvRGFvLnkgPSBwb3NpdG9uWTtcbiAgICB9LFxuXG4gICAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2ssIHBhdGggPSBcInBsYXkvQ2FyZFR5cGVDb21iaW5lL3BvY2tMaXN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRocyA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiKSB7XG4gICAgICAgIGNjLmxvYWRlci5sb2FkUmVzKHBhdGgsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIGNjLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FyZE5hbWUgPSBjYXJkTmFtZSArIFwiXCI7XG4gICAgICAgICAgICBjYXJkTmFtZSA9IHRoaXMuX2NhcmRGdWxsTmFtZShjYXJkTmFtZSxwYXRocyk7XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShjYXJkTmFtZSk7XG4gICAgICAgICAgICBjYWxsYmFjayhmcmFtZSk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lLHBhdGhzKSB7XG4gICAgICAgIGlmKCFwYXRocykgcmV0dXJuIGNhcmRTaG9ydE5hbWU7XG4gICAgICAgIHZhciBjYXJkTmFtZSA9IGNhcmRTaG9ydE5hbWU7XG4gICAgICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChwYXRocykpIHtcbiAgICAgICAgICAgIGNhcmROYW1lID0gcGF0aHMgKyBjYXJkTmFtZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FyZE5hbWU7XG4gICAgfSxcblxuICAgIF9jbGVhckNhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NsZWFyTGF5b3V0Q2FyZHModGhpcy50b3VMYXlvdXQpO1xuICAgICAgICB0aGlzLl9jbGVhckxheW91dENhcmRzKHRoaXMuemhvbmdMYXlvdXQpO1xuICAgICAgICB0aGlzLl9jbGVhckxheW91dENhcmRzKHRoaXMud2VpTGF5b3V0KTtcbiAgICB9LFxuXG4gICAgX2NsZWFyTGF5b3V0Q2FyZHM6IGZ1bmN0aW9uIChsYXlvdXQpIHtcbiAgICAgICAgdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KGxheW91dCkuZm9yRWFjaChmdW5jdGlvbiAoc3ByaXRlKSB7XG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBudWxsO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgX2NhcmRTcHJpdGVzV2l0aExheW91dDogZnVuY3Rpb24gKGxheW91dCkge1xuICAgICAgICBsZXQgbm9kZSA9IGxheW91dC5ub2RlO1xuICAgICAgICByZXR1cm4gbm9kZS5jaGlsZHJlbi5tYXAoZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybiBub2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBfYWxsQ2FyZFNwcml0ZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IHRvdUNhcmRTcHJpdGVzID0gdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KHRoaXMudG91TGF5b3V0KTtcbiAgICAgICAgbGV0IHpob25nQ2FyZFNwcml0ZXMgPSB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQodGhpcy56aG9uZ0xheW91dCk7XG4gICAgICAgIGxldCB3ZWlDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLndlaUxheW91dCk7XG4gICAgICAgIGxldCByZXN1bHQgPSB0b3VDYXJkU3ByaXRlcy5jb25jYXQoemhvbmdDYXJkU3ByaXRlcykuY29uY2F0KHdlaUNhcmRTcHJpdGVzKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGxhYmVsVGltZTogY2MuTGFiZWwsXG4gICAgICAgIC8vdGltZU5vZGU6IGNjLk5vZGUsXG5cbiAgICAgICAgX2NhbGxiYWNrOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gXCIwXCI7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOW8gOWni+WAkuiuoeaXtlxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge051bWJlcn0gdGltZSDml7bplb9cbiAgICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2sg5YCS6K6h5pe255qE5Zue6LCDXG4gICAgICovXG4gICAgc3RhcnRDb3VudGRvd246IGZ1bmN0aW9uKHRpbWUsIGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuc3RvcCgpO1xuICAgICAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xuXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBcIlwiICsgdGltZTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZSh0aGlzLl9jb3VudERvd24sIDEsIHRpbWUpO1xuICAgICAgICB0aGlzLmdldENvbXBvbmVudChcInRpbWVcIikuc2V0VGltZSh0aW1lICogMC41KVxuICAgIH0sXG5cbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuX2NvdW50RG93bik7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICBpZiAodGhpcy5fY2FsbGJhY2spIHtcbiAgICAgICAgICAgIGxldCBpc1RpbWVvdXQgPSBOdW1iZXIodGhpcy5sYWJlbFRpbWUuc3RyaW5nKSA8PSAwO1xuICAgICAgICAgICAgbGV0IGNhbGxiYWNrID0gdGhpcy5fY2FsbGJhY2s7XG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFjayA9IG51bGw7XG4gICAgICAgICAgICBjYWxsYmFjayhpc1RpbWVvdXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBudWxsO1xuICAgIH0sXG5cbiAgICBfY291bnREb3duOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHRpbWUgPSBOdW1iZXIodGhpcy5sYWJlbFRpbWUuc3RyaW5nIHx8IFwiMFwiKTtcbiAgICAgICAgdGltZSA9IHRpbWUgLSAxO1xuXG4gICAgICAgIGlmICh0aW1lIDw9IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gU3RyaW5nKHRpbWUpO1xuICAgIH0sXG5cblxufSk7XG4iLCIndXNlIHN0cmljdCdcblxuZXhwb3J0cy5ieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aFxuZXhwb3J0cy50b0J5dGVBcnJheSA9IHRvQnl0ZUFycmF5XG5leHBvcnRzLmZyb21CeXRlQXJyYXkgPSBmcm9tQnl0ZUFycmF5XG5cbnZhciBsb29rdXAgPSBbXVxudmFyIHJldkxvb2t1cCA9IFtdXG52YXIgQXJyID0gdHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnID8gVWludDhBcnJheSA6IEFycmF5XG5cbnZhciBjb2RlID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nXG5mb3IgKHZhciBpID0gMCwgbGVuID0gY29kZS5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICBsb29rdXBbaV0gPSBjb2RlW2ldXG4gIHJldkxvb2t1cFtjb2RlLmNoYXJDb2RlQXQoaSldID0gaVxufVxuXG5yZXZMb29rdXBbJy0nLmNoYXJDb2RlQXQoMCldID0gNjJcbnJldkxvb2t1cFsnXycuY2hhckNvZGVBdCgwKV0gPSA2M1xuXG5mdW5jdGlvbiBwbGFjZUhvbGRlcnNDb3VudCAoYjY0KSB7XG4gIHZhciBsZW4gPSBiNjQubGVuZ3RoXG4gIGlmIChsZW4gJSA0ID4gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdHJpbmcuIExlbmd0aCBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNCcpXG4gIH1cblxuICAvLyB0aGUgbnVtYmVyIG9mIGVxdWFsIHNpZ25zIChwbGFjZSBob2xkZXJzKVxuICAvLyBpZiB0aGVyZSBhcmUgdHdvIHBsYWNlaG9sZGVycywgdGhhbiB0aGUgdHdvIGNoYXJhY3RlcnMgYmVmb3JlIGl0XG4gIC8vIHJlcHJlc2VudCBvbmUgYnl0ZVxuICAvLyBpZiB0aGVyZSBpcyBvbmx5IG9uZSwgdGhlbiB0aGUgdGhyZWUgY2hhcmFjdGVycyBiZWZvcmUgaXQgcmVwcmVzZW50IDIgYnl0ZXNcbiAgLy8gdGhpcyBpcyBqdXN0IGEgY2hlYXAgaGFjayB0byBub3QgZG8gaW5kZXhPZiB0d2ljZVxuICByZXR1cm4gYjY0W2xlbiAtIDJdID09PSAnPScgPyAyIDogYjY0W2xlbiAtIDFdID09PSAnPScgPyAxIDogMFxufVxuXG5mdW5jdGlvbiBieXRlTGVuZ3RoIChiNjQpIHtcbiAgLy8gYmFzZTY0IGlzIDQvMyArIHVwIHRvIHR3byBjaGFyYWN0ZXJzIG9mIHRoZSBvcmlnaW5hbCBkYXRhXG4gIHJldHVybiBiNjQubGVuZ3RoICogMyAvIDQgLSBwbGFjZUhvbGRlcnNDb3VudChiNjQpXG59XG5cbmZ1bmN0aW9uIHRvQnl0ZUFycmF5IChiNjQpIHtcbiAgdmFyIGksIGosIGwsIHRtcCwgcGxhY2VIb2xkZXJzLCBhcnJcbiAgdmFyIGxlbiA9IGI2NC5sZW5ndGhcbiAgcGxhY2VIb2xkZXJzID0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KVxuXG4gIGFyciA9IG5ldyBBcnIobGVuICogMyAvIDQgLSBwbGFjZUhvbGRlcnMpXG5cbiAgLy8gaWYgdGhlcmUgYXJlIHBsYWNlaG9sZGVycywgb25seSBnZXQgdXAgdG8gdGhlIGxhc3QgY29tcGxldGUgNCBjaGFyc1xuICBsID0gcGxhY2VIb2xkZXJzID4gMCA/IGxlbiAtIDQgOiBsZW5cblxuICB2YXIgTCA9IDBcblxuICBmb3IgKGkgPSAwLCBqID0gMDsgaSA8IGw7IGkgKz0gNCwgaiArPSAzKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTgpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDEyKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDIpXSA8PCA2KSB8IHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMyldXG4gICAgYXJyW0wrK10gPSAodG1wID4+IDE2KSAmIDB4RkZcbiAgICBhcnJbTCsrXSA9ICh0bXAgPj4gOCkgJiAweEZGXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH1cblxuICBpZiAocGxhY2VIb2xkZXJzID09PSAyKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMikgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPj4gNClcbiAgICBhcnJbTCsrXSA9IHRtcCAmIDB4RkZcbiAgfSBlbHNlIGlmIChwbGFjZUhvbGRlcnMgPT09IDEpIHtcbiAgICB0bXAgPSAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAxMCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPDwgNCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAyKV0gPj4gMilcbiAgICBhcnJbTCsrXSA9ICh0bXAgPj4gOCkgJiAweEZGXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH1cblxuICByZXR1cm4gYXJyXG59XG5cbmZ1bmN0aW9uIHRyaXBsZXRUb0Jhc2U2NCAobnVtKSB7XG4gIHJldHVybiBsb29rdXBbbnVtID4+IDE4ICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDEyICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDYgJiAweDNGXSArIGxvb2t1cFtudW0gJiAweDNGXVxufVxuXG5mdW5jdGlvbiBlbmNvZGVDaHVuayAodWludDgsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHRtcFxuICB2YXIgb3V0cHV0ID0gW11cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpICs9IDMpIHtcbiAgICB0bXAgPSAodWludDhbaV0gPDwgMTYpICsgKHVpbnQ4W2kgKyAxXSA8PCA4KSArICh1aW50OFtpICsgMl0pXG4gICAgb3V0cHV0LnB1c2godHJpcGxldFRvQmFzZTY0KHRtcCkpXG4gIH1cbiAgcmV0dXJuIG91dHB1dC5qb2luKCcnKVxufVxuXG5mdW5jdGlvbiBmcm9tQnl0ZUFycmF5ICh1aW50OCkge1xuICB2YXIgdG1wXG4gIHZhciBsZW4gPSB1aW50OC5sZW5ndGhcbiAgdmFyIGV4dHJhQnl0ZXMgPSBsZW4gJSAzIC8vIGlmIHdlIGhhdmUgMSBieXRlIGxlZnQsIHBhZCAyIGJ5dGVzXG4gIHZhciBvdXRwdXQgPSAnJ1xuICB2YXIgcGFydHMgPSBbXVxuICB2YXIgbWF4Q2h1bmtMZW5ndGggPSAxNjM4MyAvLyBtdXN0IGJlIG11bHRpcGxlIG9mIDNcblxuICAvLyBnbyB0aHJvdWdoIHRoZSBhcnJheSBldmVyeSB0aHJlZSBieXRlcywgd2UnbGwgZGVhbCB3aXRoIHRyYWlsaW5nIHN0dWZmIGxhdGVyXG4gIGZvciAodmFyIGkgPSAwLCBsZW4yID0gbGVuIC0gZXh0cmFCeXRlczsgaSA8IGxlbjI7IGkgKz0gbWF4Q2h1bmtMZW5ndGgpIHtcbiAgICBwYXJ0cy5wdXNoKGVuY29kZUNodW5rKHVpbnQ4LCBpLCAoaSArIG1heENodW5rTGVuZ3RoKSA+IGxlbjIgPyBsZW4yIDogKGkgKyBtYXhDaHVua0xlbmd0aCkpKVxuICB9XG5cbiAgLy8gcGFkIHRoZSBlbmQgd2l0aCB6ZXJvcywgYnV0IG1ha2Ugc3VyZSB0byBub3QgZm9yZ2V0IHRoZSBleHRyYSBieXRlc1xuICBpZiAoZXh0cmFCeXRlcyA9PT0gMSkge1xuICAgIHRtcCA9IHVpbnQ4W2xlbiAtIDFdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFt0bXAgPj4gMl1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPDwgNCkgJiAweDNGXVxuICAgIG91dHB1dCArPSAnPT0nXG4gIH0gZWxzZSBpZiAoZXh0cmFCeXRlcyA9PT0gMikge1xuICAgIHRtcCA9ICh1aW50OFtsZW4gLSAyXSA8PCA4KSArICh1aW50OFtsZW4gLSAxXSlcbiAgICBvdXRwdXQgKz0gbG9va3VwW3RtcCA+PiAxMF1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPj4gNCkgJiAweDNGXVxuICAgIG91dHB1dCArPSBsb29rdXBbKHRtcCA8PCAyKSAmIDB4M0ZdXG4gICAgb3V0cHV0ICs9ICc9J1xuICB9XG5cbiAgcGFydHMucHVzaChvdXRwdXQpXG5cbiAgcmV0dXJuIHBhcnRzLmpvaW4oJycpXG59XG4iLCIvKiFcbiAqIFRoZSBidWZmZXIgbW9kdWxlIGZyb20gbm9kZS5qcywgZm9yIHRoZSBicm93c2VyLlxuICpcbiAqIEBhdXRob3IgICBGZXJvc3MgQWJvdWtoYWRpamVoIDxmZXJvc3NAZmVyb3NzLm9yZz4gPGh0dHA6Ly9mZXJvc3Mub3JnPlxuICogQGxpY2Vuc2UgIE1JVFxuICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqL1xuXG4ndXNlIHN0cmljdCdcblxudmFyIGJhc2U2NCA9IHJlcXVpcmUoJ2Jhc2U2NC1qcycpXG52YXIgaWVlZTc1NCA9IHJlcXVpcmUoJ2llZWU3NTQnKVxudmFyIGlzQXJyYXkgPSByZXF1aXJlKCdpc2FycmF5JylcblxuZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXJcbmV4cG9ydHMuU2xvd0J1ZmZlciA9IFNsb3dCdWZmZXJcbmV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVMgPSA1MFxuXG4vKipcbiAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6XG4gKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KVxuICogICA9PT0gZmFsc2UgICBVc2UgT2JqZWN0IGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KVxuICpcbiAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKyxcbiAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy5cbiAqXG4gKiBEdWUgdG8gdmFyaW91cyBicm93c2VyIGJ1Z3MsIHNvbWV0aW1lcyB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uIHdpbGwgYmUgdXNlZCBldmVuXG4gKiB3aGVuIHRoZSBicm93c2VyIHN1cHBvcnRzIHR5cGVkIGFycmF5cy5cbiAqXG4gKiBOb3RlOlxuICpcbiAqICAgLSBGaXJlZm94IDQtMjkgbGFja3Mgc3VwcG9ydCBmb3IgYWRkaW5nIG5ldyBwcm9wZXJ0aWVzIHRvIGBVaW50OEFycmF5YCBpbnN0YW5jZXMsXG4gKiAgICAgU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02OTU0MzguXG4gKlxuICogICAtIENocm9tZSA5LTEwIGlzIG1pc3NpbmcgdGhlIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24uXG4gKlxuICogICAtIElFMTAgaGFzIGEgYnJva2VuIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhcnJheXMgb2ZcbiAqICAgICBpbmNvcnJlY3QgbGVuZ3RoIGluIHNvbWUgc2l0dWF0aW9ucy5cblxuICogV2UgZGV0ZWN0IHRoZXNlIGJ1Z2d5IGJyb3dzZXJzIGFuZCBzZXQgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYCB0byBgZmFsc2VgIHNvIHRoZXlcbiAqIGdldCB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uLCB3aGljaCBpcyBzbG93ZXIgYnV0IGJlaGF2ZXMgY29ycmVjdGx5LlxuICovXG5CdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCA9IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUICE9PSB1bmRlZmluZWRcbiAgPyBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVFxuICA6IHR5cGVkQXJyYXlTdXBwb3J0KClcblxuLypcbiAqIEV4cG9ydCBrTWF4TGVuZ3RoIGFmdGVyIHR5cGVkIGFycmF5IHN1cHBvcnQgaXMgZGV0ZXJtaW5lZC5cbiAqL1xuZXhwb3J0cy5rTWF4TGVuZ3RoID0ga01heExlbmd0aCgpXG5cbmZ1bmN0aW9uIHR5cGVkQXJyYXlTdXBwb3J0ICgpIHtcbiAgdHJ5IHtcbiAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSlcbiAgICBhcnIuX19wcm90b19fID0ge19fcHJvdG9fXzogVWludDhBcnJheS5wcm90b3R5cGUsIGZvbzogZnVuY3Rpb24gKCkgeyByZXR1cm4gNDIgfX1cbiAgICByZXR1cm4gYXJyLmZvbygpID09PSA0MiAmJiAvLyB0eXBlZCBhcnJheSBpbnN0YW5jZXMgY2FuIGJlIGF1Z21lbnRlZFxuICAgICAgICB0eXBlb2YgYXJyLnN1YmFycmF5ID09PSAnZnVuY3Rpb24nICYmIC8vIGNocm9tZSA5LTEwIGxhY2sgYHN1YmFycmF5YFxuICAgICAgICBhcnIuc3ViYXJyYXkoMSwgMSkuYnl0ZUxlbmd0aCA9PT0gMCAvLyBpZTEwIGhhcyBicm9rZW4gYHN1YmFycmF5YFxuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZnVuY3Rpb24ga01heExlbmd0aCAoKSB7XG4gIHJldHVybiBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVFxuICAgID8gMHg3ZmZmZmZmZlxuICAgIDogMHgzZmZmZmZmZlxufVxuXG5mdW5jdGlvbiBjcmVhdGVCdWZmZXIgKHRoYXQsIGxlbmd0aCkge1xuICBpZiAoa01heExlbmd0aCgpIDwgbGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgdHlwZWQgYXJyYXkgbGVuZ3RoJylcbiAgfVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKVxuICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3NcbiAgICBpZiAodGhhdCA9PT0gbnVsbCkge1xuICAgICAgdGhhdCA9IG5ldyBCdWZmZXIobGVuZ3RoKVxuICAgIH1cbiAgICB0aGF0Lmxlbmd0aCA9IGxlbmd0aFxuICB9XG5cbiAgcmV0dXJuIHRoYXRcbn1cblxuLyoqXG4gKiBUaGUgQnVmZmVyIGNvbnN0cnVjdG9yIHJldHVybnMgaW5zdGFuY2VzIG9mIGBVaW50OEFycmF5YCB0aGF0IGhhdmUgdGhlaXJcbiAqIHByb3RvdHlwZSBjaGFuZ2VkIHRvIGBCdWZmZXIucHJvdG90eXBlYC4gRnVydGhlcm1vcmUsIGBCdWZmZXJgIGlzIGEgc3ViY2xhc3Mgb2ZcbiAqIGBVaW50OEFycmF5YCwgc28gdGhlIHJldHVybmVkIGluc3RhbmNlcyB3aWxsIGhhdmUgYWxsIHRoZSBub2RlIGBCdWZmZXJgIG1ldGhvZHNcbiAqIGFuZCB0aGUgYFVpbnQ4QXJyYXlgIG1ldGhvZHMuIFNxdWFyZSBicmFja2V0IG5vdGF0aW9uIHdvcmtzIGFzIGV4cGVjdGVkIC0tIGl0XG4gKiByZXR1cm5zIGEgc2luZ2xlIG9jdGV0LlxuICpcbiAqIFRoZSBgVWludDhBcnJheWAgcHJvdG90eXBlIHJlbWFpbnMgdW5tb2RpZmllZC5cbiAqL1xuXG5mdW5jdGlvbiBCdWZmZXIgKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgJiYgISh0aGlzIGluc3RhbmNlb2YgQnVmZmVyKSkge1xuICAgIHJldHVybiBuZXcgQnVmZmVyKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgLy8gQ29tbW9uIGNhc2UuXG4gIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykge1xuICAgIGlmICh0eXBlb2YgZW5jb2RpbmdPck9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ0lmIGVuY29kaW5nIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nJ1xuICAgICAgKVxuICAgIH1cbiAgICByZXR1cm4gYWxsb2NVbnNhZmUodGhpcywgYXJnKVxuICB9XG4gIHJldHVybiBmcm9tKHRoaXMsIGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxufVxuXG5CdWZmZXIucG9vbFNpemUgPSA4MTkyIC8vIG5vdCB1c2VkIGJ5IHRoaXMgaW1wbGVtZW50YXRpb25cblxuLy8gVE9ETzogTGVnYWN5LCBub3QgbmVlZGVkIGFueW1vcmUuIFJlbW92ZSBpbiBuZXh0IG1ham9yIHZlcnNpb24uXG5CdWZmZXIuX2F1Z21lbnQgPSBmdW5jdGlvbiAoYXJyKSB7XG4gIGFyci5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIHJldHVybiBhcnJcbn1cblxuZnVuY3Rpb24gZnJvbSAodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1widmFsdWVcIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpXG4gIH1cblxuICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgcmV0dXJuIGZyb21BcnJheUJ1ZmZlcih0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZnJvbVN0cmluZyh0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldClcbiAgfVxuXG4gIHJldHVybiBmcm9tT2JqZWN0KHRoYXQsIHZhbHVlKVxufVxuXG4vKipcbiAqIEZ1bmN0aW9uYWxseSBlcXVpdmFsZW50IHRvIEJ1ZmZlcihhcmcsIGVuY29kaW5nKSBidXQgdGhyb3dzIGEgVHlwZUVycm9yXG4gKiBpZiB2YWx1ZSBpcyBhIG51bWJlci5cbiAqIEJ1ZmZlci5mcm9tKHN0clssIGVuY29kaW5nXSlcbiAqIEJ1ZmZlci5mcm9tKGFycmF5KVxuICogQnVmZmVyLmZyb20oYnVmZmVyKVxuICogQnVmZmVyLmZyb20oYXJyYXlCdWZmZXJbLCBieXRlT2Zmc2V0WywgbGVuZ3RoXV0pXG4gKiovXG5CdWZmZXIuZnJvbSA9IGZ1bmN0aW9uICh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBmcm9tKG51bGwsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpXG59XG5cbmlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICBCdWZmZXIucHJvdG90eXBlLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkucHJvdG90eXBlXG4gIEJ1ZmZlci5fX3Byb3RvX18gPSBVaW50OEFycmF5XG4gIGlmICh0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wuc3BlY2llcyAmJlxuICAgICAgQnVmZmVyW1N5bWJvbC5zcGVjaWVzXSA9PT0gQnVmZmVyKSB7XG4gICAgLy8gRml4IHN1YmFycmF5KCkgaW4gRVMyMDE2LiBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvYnVmZmVyL3B1bGwvOTdcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVmZmVyLCBTeW1ib2wuc3BlY2llcywge1xuICAgICAgdmFsdWU6IG51bGwsXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KVxuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFNpemUgKHNpemUpIHtcbiAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3QgYmUgYSBudW1iZXInKVxuICB9IGVsc2UgaWYgKHNpemUgPCAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG5lZ2F0aXZlJylcbiAgfVxufVxuXG5mdW5jdGlvbiBhbGxvYyAodGhhdCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHtcbiAgYXNzZXJ0U2l6ZShzaXplKVxuICBpZiAoc2l6ZSA8PSAwKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKVxuICB9XG4gIGlmIChmaWxsICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBPbmx5IHBheSBhdHRlbnRpb24gdG8gZW5jb2RpbmcgaWYgaXQncyBhIHN0cmluZy4gVGhpc1xuICAgIC8vIHByZXZlbnRzIGFjY2lkZW50YWxseSBzZW5kaW5nIGluIGEgbnVtYmVyIHRoYXQgd291bGRcbiAgICAvLyBiZSBpbnRlcnByZXR0ZWQgYXMgYSBzdGFydCBvZmZzZXQuXG4gICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZydcbiAgICAgID8gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpLmZpbGwoZmlsbCwgZW5jb2RpbmcpXG4gICAgICA6IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKS5maWxsKGZpbGwpXG4gIH1cbiAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS5cbiAqIGFsbG9jKHNpemVbLCBmaWxsWywgZW5jb2RpbmddXSlcbiAqKi9cbkJ1ZmZlci5hbGxvYyA9IGZ1bmN0aW9uIChzaXplLCBmaWxsLCBlbmNvZGluZykge1xuICByZXR1cm4gYWxsb2MobnVsbCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpXG59XG5cbmZ1bmN0aW9uIGFsbG9jVW5zYWZlICh0aGF0LCBzaXplKSB7XG4gIGFzc2VydFNpemUoc2l6ZSlcbiAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplIDwgMCA/IDAgOiBjaGVja2VkKHNpemUpIHwgMClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgKytpKSB7XG4gICAgICB0aGF0W2ldID0gMFxuICAgIH1cbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gQnVmZmVyKG51bSksIGJ5IGRlZmF1bHQgY3JlYXRlcyBhIG5vbi16ZXJvLWZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuXG4gKiAqL1xuQnVmZmVyLmFsbG9jVW5zYWZlID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgcmV0dXJuIGFsbG9jVW5zYWZlKG51bGwsIHNpemUpXG59XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gU2xvd0J1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICovXG5CdWZmZXIuYWxsb2NVbnNhZmVTbG93ID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgcmV0dXJuIGFsbG9jVW5zYWZlKG51bGwsIHNpemUpXG59XG5cbmZ1bmN0aW9uIGZyb21TdHJpbmcgKHRoYXQsIHN0cmluZywgZW5jb2RpbmcpIHtcbiAgaWYgKHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycgfHwgZW5jb2RpbmcgPT09ICcnKSB7XG4gICAgZW5jb2RpbmcgPSAndXRmOCdcbiAgfVxuXG4gIGlmICghQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJlbmNvZGluZ1wiIG11c3QgYmUgYSB2YWxpZCBzdHJpbmcgZW5jb2RpbmcnKVxuICB9XG5cbiAgdmFyIGxlbmd0aCA9IGJ5dGVMZW5ndGgoc3RyaW5nLCBlbmNvZGluZykgfCAwXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKVxuXG4gIHZhciBhY3R1YWwgPSB0aGF0LndyaXRlKHN0cmluZywgZW5jb2RpbmcpXG5cbiAgaWYgKGFjdHVhbCAhPT0gbGVuZ3RoKSB7XG4gICAgLy8gV3JpdGluZyBhIGhleCBzdHJpbmcsIGZvciBleGFtcGxlLCB0aGF0IGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycyB3aWxsXG4gICAgLy8gY2F1c2UgZXZlcnl0aGluZyBhZnRlciB0aGUgZmlyc3QgaW52YWxpZCBjaGFyYWN0ZXIgdG8gYmUgaWdub3JlZC4gKGUuZy5cbiAgICAvLyAnYWJ4eGNkJyB3aWxsIGJlIHRyZWF0ZWQgYXMgJ2FiJylcbiAgICB0aGF0ID0gdGhhdC5zbGljZSgwLCBhY3R1YWwpXG4gIH1cblxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXlMaWtlICh0aGF0LCBhcnJheSkge1xuICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoIDwgMCA/IDAgOiBjaGVja2VkKGFycmF5Lmxlbmd0aCkgfCAwXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgdGhhdFtpXSA9IGFycmF5W2ldICYgMjU1XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5QnVmZmVyICh0aGF0LCBhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKSB7XG4gIGFycmF5LmJ5dGVMZW5ndGggLy8gdGhpcyB0aHJvd3MgaWYgYGFycmF5YCBpcyBub3QgYSB2YWxpZCBBcnJheUJ1ZmZlclxuXG4gIGlmIChieXRlT2Zmc2V0IDwgMCB8fCBhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcXCdvZmZzZXRcXCcgaXMgb3V0IG9mIGJvdW5kcycpXG4gIH1cblxuICBpZiAoYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQgKyAobGVuZ3RoIHx8IDApKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1xcJ2xlbmd0aFxcJyBpcyBvdXQgb2YgYm91bmRzJylcbiAgfVxuXG4gIGlmIChieXRlT2Zmc2V0ID09PSB1bmRlZmluZWQgJiYgbGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5KVxuICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldClcbiAgfSBlbHNlIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0LCBsZW5ndGgpXG4gIH1cblxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gYXJyYXlcbiAgICB0aGF0Ll9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzXG4gICAgdGhhdCA9IGZyb21BcnJheUxpa2UodGhhdCwgYXJyYXkpXG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbU9iamVjdCAodGhhdCwgb2JqKSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIob2JqKSkge1xuICAgIHZhciBsZW4gPSBjaGVja2VkKG9iai5sZW5ndGgpIHwgMFxuICAgIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuKVxuXG4gICAgaWYgKHRoYXQubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gdGhhdFxuICAgIH1cblxuICAgIG9iai5jb3B5KHRoYXQsIDAsIDAsIGxlbilcbiAgICByZXR1cm4gdGhhdFxuICB9XG5cbiAgaWYgKG9iaikge1xuICAgIGlmICgodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICBvYmouYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHx8ICdsZW5ndGgnIGluIG9iaikge1xuICAgICAgaWYgKHR5cGVvZiBvYmoubGVuZ3RoICE9PSAnbnVtYmVyJyB8fCBpc25hbihvYmoubGVuZ3RoKSkge1xuICAgICAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIDApXG4gICAgICB9XG4gICAgICByZXR1cm4gZnJvbUFycmF5TGlrZSh0aGF0LCBvYmopXG4gICAgfVxuXG4gICAgaWYgKG9iai50eXBlID09PSAnQnVmZmVyJyAmJiBpc0FycmF5KG9iai5kYXRhKSkge1xuICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqLmRhdGEpXG4gICAgfVxuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcignRmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZywgQnVmZmVyLCBBcnJheUJ1ZmZlciwgQXJyYXksIG9yIGFycmF5LWxpa2Ugb2JqZWN0LicpXG59XG5cbmZ1bmN0aW9uIGNoZWNrZWQgKGxlbmd0aCkge1xuICAvLyBOb3RlOiBjYW5ub3QgdXNlIGBsZW5ndGggPCBrTWF4TGVuZ3RoKClgIGhlcmUgYmVjYXVzZSB0aGF0IGZhaWxzIHdoZW5cbiAgLy8gbGVuZ3RoIGlzIE5hTiAod2hpY2ggaXMgb3RoZXJ3aXNlIGNvZXJjZWQgdG8gemVyby4pXG4gIGlmIChsZW5ndGggPj0ga01heExlbmd0aCgpKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gYWxsb2NhdGUgQnVmZmVyIGxhcmdlciB0aGFuIG1heGltdW0gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ3NpemU6IDB4JyArIGtNYXhMZW5ndGgoKS50b1N0cmluZygxNikgKyAnIGJ5dGVzJylcbiAgfVxuICByZXR1cm4gbGVuZ3RoIHwgMFxufVxuXG5mdW5jdGlvbiBTbG93QnVmZmVyIChsZW5ndGgpIHtcbiAgaWYgKCtsZW5ndGggIT0gbGVuZ3RoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZXFlcWVxXG4gICAgbGVuZ3RoID0gMFxuICB9XG4gIHJldHVybiBCdWZmZXIuYWxsb2MoK2xlbmd0aClcbn1cblxuQnVmZmVyLmlzQnVmZmVyID0gZnVuY3Rpb24gaXNCdWZmZXIgKGIpIHtcbiAgcmV0dXJuICEhKGIgIT0gbnVsbCAmJiBiLl9pc0J1ZmZlcilcbn1cblxuQnVmZmVyLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlIChhLCBiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGEpIHx8ICFCdWZmZXIuaXNCdWZmZXIoYikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzJylcbiAgfVxuXG4gIGlmIChhID09PSBiKSByZXR1cm4gMFxuXG4gIHZhciB4ID0gYS5sZW5ndGhcbiAgdmFyIHkgPSBiLmxlbmd0aFxuXG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBNYXRoLm1pbih4LCB5KTsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKGFbaV0gIT09IGJbaV0pIHtcbiAgICAgIHggPSBhW2ldXG4gICAgICB5ID0gYltpXVxuICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbkJ1ZmZlci5pc0VuY29kaW5nID0gZnVuY3Rpb24gaXNFbmNvZGluZyAoZW5jb2RpbmcpIHtcbiAgc3dpdGNoIChTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlICdoZXgnOlxuICAgIGNhc2UgJ3V0ZjgnOlxuICAgIGNhc2UgJ3V0Zi04JzpcbiAgICBjYXNlICdhc2NpaSc6XG4gICAgY2FzZSAnbGF0aW4xJzpcbiAgICBjYXNlICdiaW5hcnknOlxuICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgY2FzZSAndWNzMic6XG4gICAgY2FzZSAndWNzLTInOlxuICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgIHJldHVybiB0cnVlXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbkJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQgKGxpc3QsIGxlbmd0aCkge1xuICBpZiAoIWlzQXJyYXkobGlzdCkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImxpc3RcIiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKVxuICB9XG5cbiAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5hbGxvYygwKVxuICB9XG5cbiAgdmFyIGlcbiAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbGVuZ3RoID0gMFxuICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7XG4gICAgICBsZW5ndGggKz0gbGlzdFtpXS5sZW5ndGhcbiAgICB9XG4gIH1cblxuICB2YXIgYnVmZmVyID0gQnVmZmVyLmFsbG9jVW5zYWZlKGxlbmd0aClcbiAgdmFyIHBvcyA9IDBcbiAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgYnVmID0gbGlzdFtpXVxuICAgIGlmICghQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wibGlzdFwiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpXG4gICAgfVxuICAgIGJ1Zi5jb3B5KGJ1ZmZlciwgcG9zKVxuICAgIHBvcyArPSBidWYubGVuZ3RoXG4gIH1cbiAgcmV0dXJuIGJ1ZmZlclxufVxuXG5mdW5jdGlvbiBieXRlTGVuZ3RoIChzdHJpbmcsIGVuY29kaW5nKSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIoc3RyaW5nKSkge1xuICAgIHJldHVybiBzdHJpbmcubGVuZ3RoXG4gIH1cbiAgaWYgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIEFycmF5QnVmZmVyLmlzVmlldyA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgKEFycmF5QnVmZmVyLmlzVmlldyhzdHJpbmcpIHx8IHN0cmluZyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSkge1xuICAgIHJldHVybiBzdHJpbmcuYnl0ZUxlbmd0aFxuICB9XG4gIGlmICh0eXBlb2Ygc3RyaW5nICE9PSAnc3RyaW5nJykge1xuICAgIHN0cmluZyA9ICcnICsgc3RyaW5nXG4gIH1cblxuICB2YXIgbGVuID0gc3RyaW5nLmxlbmd0aFxuICBpZiAobGVuID09PSAwKSByZXR1cm4gMFxuXG4gIC8vIFVzZSBhIGZvciBsb29wIHRvIGF2b2lkIHJlY3Vyc2lvblxuICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZVxuICBmb3IgKDs7KSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBsZW5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICAgIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aFxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIGxlbiAqIDJcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBsZW4gPj4+IDFcbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRUb0J5dGVzKHN0cmluZykubGVuZ3RoXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aCAvLyBhc3N1bWUgdXRmOFxuICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuQnVmZmVyLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoXG5cbmZ1bmN0aW9uIHNsb3dUb1N0cmluZyAoZW5jb2RpbmcsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcblxuICAvLyBObyBuZWVkIHRvIHZlcmlmeSB0aGF0IFwidGhpcy5sZW5ndGggPD0gTUFYX1VJTlQzMlwiIHNpbmNlIGl0J3MgYSByZWFkLW9ubHlcbiAgLy8gcHJvcGVydHkgb2YgYSB0eXBlZCBhcnJheS5cblxuICAvLyBUaGlzIGJlaGF2ZXMgbmVpdGhlciBsaWtlIFN0cmluZyBub3IgVWludDhBcnJheSBpbiB0aGF0IHdlIHNldCBzdGFydC9lbmRcbiAgLy8gdG8gdGhlaXIgdXBwZXIvbG93ZXIgYm91bmRzIGlmIHRoZSB2YWx1ZSBwYXNzZWQgaXMgb3V0IG9mIHJhbmdlLlxuICAvLyB1bmRlZmluZWQgaXMgaGFuZGxlZCBzcGVjaWFsbHkgYXMgcGVyIEVDTUEtMjYyIDZ0aCBFZGl0aW9uLFxuICAvLyBTZWN0aW9uIDEzLjMuMy43IFJ1bnRpbWUgU2VtYW50aWNzOiBLZXllZEJpbmRpbmdJbml0aWFsaXphdGlvbi5cbiAgaWYgKHN0YXJ0ID09PSB1bmRlZmluZWQgfHwgc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgPSAwXG4gIH1cbiAgLy8gUmV0dXJuIGVhcmx5IGlmIHN0YXJ0ID4gdGhpcy5sZW5ndGguIERvbmUgaGVyZSB0byBwcmV2ZW50IHBvdGVudGlhbCB1aW50MzJcbiAgLy8gY29lcmNpb24gZmFpbCBiZWxvdy5cbiAgaWYgKHN0YXJ0ID4gdGhpcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGlmIChlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiB0aGlzLmxlbmd0aCkge1xuICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gIH1cblxuICBpZiAoZW5kIDw9IDApIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIC8vIEZvcmNlIGNvZXJzaW9uIHRvIHVpbnQzMi4gVGhpcyB3aWxsIGFsc28gY29lcmNlIGZhbHNleS9OYU4gdmFsdWVzIHRvIDAuXG4gIGVuZCA+Pj49IDBcbiAgc3RhcnQgPj4+PSAwXG5cbiAgaWYgKGVuZCA8PSBzdGFydCkge1xuICAgIHJldHVybiAnJ1xuICB9XG5cbiAgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSAndXRmOCdcblxuICB3aGlsZSAodHJ1ZSkge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBoZXhTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICAgIHJldHVybiBhc2NpaVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICByZXR1cm4gbGF0aW4xU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgICAgcmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgIHJldHVybiB1dGYxNmxlU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpXG4gICAgICAgIGVuY29kaW5nID0gKGVuY29kaW5nICsgJycpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlXG4gICAgfVxuICB9XG59XG5cbi8vIFRoZSBwcm9wZXJ0eSBpcyB1c2VkIGJ5IGBCdWZmZXIuaXNCdWZmZXJgIGFuZCBgaXMtYnVmZmVyYCAoaW4gU2FmYXJpIDUtNykgdG8gZGV0ZWN0XG4vLyBCdWZmZXIgaW5zdGFuY2VzLlxuQnVmZmVyLnByb3RvdHlwZS5faXNCdWZmZXIgPSB0cnVlXG5cbmZ1bmN0aW9uIHN3YXAgKGIsIG4sIG0pIHtcbiAgdmFyIGkgPSBiW25dXG4gIGJbbl0gPSBiW21dXG4gIGJbbV0gPSBpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDE2ID0gZnVuY3Rpb24gc3dhcDE2ICgpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIGlmIChsZW4gJSAyICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAxNi1iaXRzJylcbiAgfVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7XG4gICAgc3dhcCh0aGlzLCBpLCBpICsgMSlcbiAgfVxuICByZXR1cm4gdGhpc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uIHN3YXAzMiAoKSB7XG4gIHZhciBsZW4gPSB0aGlzLmxlbmd0aFxuICBpZiAobGVuICUgNCAhPT0gMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMzItYml0cycpXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xuICAgIHN3YXAodGhpcywgaSwgaSArIDMpXG4gICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDIpXG4gIH1cbiAgcmV0dXJuIHRoaXNcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5zd2FwNjQgPSBmdW5jdGlvbiBzd2FwNjQgKCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgaWYgKGxlbiAlIDggIT09IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDY0LWJpdHMnKVxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDgpIHtcbiAgICBzd2FwKHRoaXMsIGksIGkgKyA3KVxuICAgIHN3YXAodGhpcywgaSArIDEsIGkgKyA2KVxuICAgIHN3YXAodGhpcywgaSArIDIsIGkgKyA1KVxuICAgIHN3YXAodGhpcywgaSArIDMsIGkgKyA0KVxuICB9XG4gIHJldHVybiB0aGlzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZyAoKSB7XG4gIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCB8IDBcbiAgaWYgKGxlbmd0aCA9PT0gMCkgcmV0dXJuICcnXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIDAsIGxlbmd0aClcbiAgcmV0dXJuIHNsb3dUb1N0cmluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gZXF1YWxzIChiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyJylcbiAgaWYgKHRoaXMgPT09IGIpIHJldHVybiB0cnVlXG4gIHJldHVybiBCdWZmZXIuY29tcGFyZSh0aGlzLCBiKSA9PT0gMFxufVxuXG5CdWZmZXIucHJvdG90eXBlLmluc3BlY3QgPSBmdW5jdGlvbiBpbnNwZWN0ICgpIHtcbiAgdmFyIHN0ciA9ICcnXG4gIHZhciBtYXggPSBleHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTXG4gIGlmICh0aGlzLmxlbmd0aCA+IDApIHtcbiAgICBzdHIgPSB0aGlzLnRvU3RyaW5nKCdoZXgnLCAwLCBtYXgpLm1hdGNoKC8uezJ9L2cpLmpvaW4oJyAnKVxuICAgIGlmICh0aGlzLmxlbmd0aCA+IG1heCkgc3RyICs9ICcgLi4uICdcbiAgfVxuICByZXR1cm4gJzxCdWZmZXIgJyArIHN0ciArICc+J1xufVxuXG5CdWZmZXIucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlICh0YXJnZXQsIHN0YXJ0LCBlbmQsIHRoaXNTdGFydCwgdGhpc0VuZCkge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcih0YXJnZXQpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIH1cblxuICBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCkge1xuICAgIHN0YXJ0ID0gMFxuICB9XG4gIGlmIChlbmQgPT09IHVuZGVmaW5lZCkge1xuICAgIGVuZCA9IHRhcmdldCA/IHRhcmdldC5sZW5ndGggOiAwXG4gIH1cbiAgaWYgKHRoaXNTdGFydCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpc1N0YXJ0ID0gMFxuICB9XG4gIGlmICh0aGlzRW5kID09PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzRW5kID0gdGhpcy5sZW5ndGhcbiAgfVxuXG4gIGlmIChzdGFydCA8IDAgfHwgZW5kID4gdGFyZ2V0Lmxlbmd0aCB8fCB0aGlzU3RhcnQgPCAwIHx8IHRoaXNFbmQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdvdXQgb2YgcmFuZ2UgaW5kZXgnKVxuICB9XG5cbiAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kICYmIHN0YXJ0ID49IGVuZCkge1xuICAgIHJldHVybiAwXG4gIH1cbiAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kKSB7XG4gICAgcmV0dXJuIC0xXG4gIH1cbiAgaWYgKHN0YXJ0ID49IGVuZCkge1xuICAgIHJldHVybiAxXG4gIH1cblxuICBzdGFydCA+Pj49IDBcbiAgZW5kID4+Pj0gMFxuICB0aGlzU3RhcnQgPj4+PSAwXG4gIHRoaXNFbmQgPj4+PSAwXG5cbiAgaWYgKHRoaXMgPT09IHRhcmdldCkgcmV0dXJuIDBcblxuICB2YXIgeCA9IHRoaXNFbmQgLSB0aGlzU3RhcnRcbiAgdmFyIHkgPSBlbmQgLSBzdGFydFxuICB2YXIgbGVuID0gTWF0aC5taW4oeCwgeSlcblxuICB2YXIgdGhpc0NvcHkgPSB0aGlzLnNsaWNlKHRoaXNTdGFydCwgdGhpc0VuZClcbiAgdmFyIHRhcmdldENvcHkgPSB0YXJnZXQuc2xpY2Uoc3RhcnQsIGVuZClcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKHRoaXNDb3B5W2ldICE9PSB0YXJnZXRDb3B5W2ldKSB7XG4gICAgICB4ID0gdGhpc0NvcHlbaV1cbiAgICAgIHkgPSB0YXJnZXRDb3B5W2ldXG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIGlmICh4IDwgeSkgcmV0dXJuIC0xXG4gIGlmICh5IDwgeCkgcmV0dXJuIDFcbiAgcmV0dXJuIDBcbn1cblxuLy8gRmluZHMgZWl0aGVyIHRoZSBmaXJzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPj0gYGJ5dGVPZmZzZXRgLFxuLy8gT1IgdGhlIGxhc3QgaW5kZXggb2YgYHZhbGAgaW4gYGJ1ZmZlcmAgYXQgb2Zmc2V0IDw9IGBieXRlT2Zmc2V0YC5cbi8vXG4vLyBBcmd1bWVudHM6XG4vLyAtIGJ1ZmZlciAtIGEgQnVmZmVyIHRvIHNlYXJjaFxuLy8gLSB2YWwgLSBhIHN0cmluZywgQnVmZmVyLCBvciBudW1iZXJcbi8vIC0gYnl0ZU9mZnNldCAtIGFuIGluZGV4IGludG8gYGJ1ZmZlcmA7IHdpbGwgYmUgY2xhbXBlZCB0byBhbiBpbnQzMlxuLy8gLSBlbmNvZGluZyAtIGFuIG9wdGlvbmFsIGVuY29kaW5nLCByZWxldmFudCBpcyB2YWwgaXMgYSBzdHJpbmdcbi8vIC0gZGlyIC0gdHJ1ZSBmb3IgaW5kZXhPZiwgZmFsc2UgZm9yIGxhc3RJbmRleE9mXG5mdW5jdGlvbiBiaWRpcmVjdGlvbmFsSW5kZXhPZiAoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHtcbiAgLy8gRW1wdHkgYnVmZmVyIG1lYW5zIG5vIG1hdGNoXG4gIGlmIChidWZmZXIubGVuZ3RoID09PSAwKSByZXR1cm4gLTFcblxuICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldFxuICBpZiAodHlwZW9mIGJ5dGVPZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgZW5jb2RpbmcgPSBieXRlT2Zmc2V0XG4gICAgYnl0ZU9mZnNldCA9IDBcbiAgfSBlbHNlIGlmIChieXRlT2Zmc2V0ID4gMHg3ZmZmZmZmZikge1xuICAgIGJ5dGVPZmZzZXQgPSAweDdmZmZmZmZmXG4gIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA8IC0weDgwMDAwMDAwKSB7XG4gICAgYnl0ZU9mZnNldCA9IC0weDgwMDAwMDAwXG4gIH1cbiAgYnl0ZU9mZnNldCA9ICtieXRlT2Zmc2V0ICAvLyBDb2VyY2UgdG8gTnVtYmVyLlxuICBpZiAoaXNOYU4oYnl0ZU9mZnNldCkpIHtcbiAgICAvLyBieXRlT2Zmc2V0OiBpdCBpdCdzIHVuZGVmaW5lZCwgbnVsbCwgTmFOLCBcImZvb1wiLCBldGMsIHNlYXJjaCB3aG9sZSBidWZmZXJcbiAgICBieXRlT2Zmc2V0ID0gZGlyID8gMCA6IChidWZmZXIubGVuZ3RoIC0gMSlcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSBieXRlT2Zmc2V0OiBuZWdhdGl2ZSBvZmZzZXRzIHN0YXJ0IGZyb20gdGhlIGVuZCBvZiB0aGUgYnVmZmVyXG4gIGlmIChieXRlT2Zmc2V0IDwgMCkgYnl0ZU9mZnNldCA9IGJ1ZmZlci5sZW5ndGggKyBieXRlT2Zmc2V0XG4gIGlmIChieXRlT2Zmc2V0ID49IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICBpZiAoZGlyKSByZXR1cm4gLTFcbiAgICBlbHNlIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoIC0gMVxuICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAwKSB7XG4gICAgaWYgKGRpcikgYnl0ZU9mZnNldCA9IDBcbiAgICBlbHNlIHJldHVybiAtMVxuICB9XG5cbiAgLy8gTm9ybWFsaXplIHZhbFxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICB2YWwgPSBCdWZmZXIuZnJvbSh2YWwsIGVuY29kaW5nKVxuICB9XG5cbiAgLy8gRmluYWxseSwgc2VhcmNoIGVpdGhlciBpbmRleE9mIChpZiBkaXIgaXMgdHJ1ZSkgb3IgbGFzdEluZGV4T2ZcbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7XG4gICAgLy8gU3BlY2lhbCBjYXNlOiBsb29raW5nIGZvciBlbXB0eSBzdHJpbmcvYnVmZmVyIGFsd2F5cyBmYWlsc1xuICAgIGlmICh2YWwubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gLTFcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcilcbiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykge1xuICAgIHZhbCA9IHZhbCAmIDB4RkYgLy8gU2VhcmNoIGZvciBhIGJ5dGUgdmFsdWUgWzAtMjU1XVxuICAgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCAmJlxuICAgICAgICB0eXBlb2YgVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgaWYgKGRpcikge1xuICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnJheUluZGV4T2YoYnVmZmVyLCBbIHZhbCBdLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKVxuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcigndmFsIG11c3QgYmUgc3RyaW5nLCBudW1iZXIgb3IgQnVmZmVyJylcbn1cblxuZnVuY3Rpb24gYXJyYXlJbmRleE9mIChhcnIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikge1xuICB2YXIgaW5kZXhTaXplID0gMVxuICB2YXIgYXJyTGVuZ3RoID0gYXJyLmxlbmd0aFxuICB2YXIgdmFsTGVuZ3RoID0gdmFsLmxlbmd0aFxuXG4gIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZW5jb2RpbmcgPSBTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKClcbiAgICBpZiAoZW5jb2RpbmcgPT09ICd1Y3MyJyB8fCBlbmNvZGluZyA9PT0gJ3Vjcy0yJyB8fFxuICAgICAgICBlbmNvZGluZyA9PT0gJ3V0ZjE2bGUnIHx8IGVuY29kaW5nID09PSAndXRmLTE2bGUnKSB7XG4gICAgICBpZiAoYXJyLmxlbmd0aCA8IDIgfHwgdmFsLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIC0xXG4gICAgICB9XG4gICAgICBpbmRleFNpemUgPSAyXG4gICAgICBhcnJMZW5ndGggLz0gMlxuICAgICAgdmFsTGVuZ3RoIC89IDJcbiAgICAgIGJ5dGVPZmZzZXQgLz0gMlxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYWQgKGJ1ZiwgaSkge1xuICAgIGlmIChpbmRleFNpemUgPT09IDEpIHtcbiAgICAgIHJldHVybiBidWZbaV1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGJ1Zi5yZWFkVUludDE2QkUoaSAqIGluZGV4U2l6ZSlcbiAgICB9XG4gIH1cblxuICB2YXIgaVxuICBpZiAoZGlyKSB7XG4gICAgdmFyIGZvdW5kSW5kZXggPSAtMVxuICAgIGZvciAoaSA9IGJ5dGVPZmZzZXQ7IGkgPCBhcnJMZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHJlYWQoYXJyLCBpKSA9PT0gcmVhZCh2YWwsIGZvdW5kSW5kZXggPT09IC0xID8gMCA6IGkgLSBmb3VuZEluZGV4KSkge1xuICAgICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIGZvdW5kSW5kZXggPSBpXG4gICAgICAgIGlmIChpIC0gZm91bmRJbmRleCArIDEgPT09IHZhbExlbmd0aCkgcmV0dXJuIGZvdW5kSW5kZXggKiBpbmRleFNpemVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkgaSAtPSBpIC0gZm91bmRJbmRleFxuICAgICAgICBmb3VuZEluZGV4ID0gLTFcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGJ5dGVPZmZzZXQgKyB2YWxMZW5ndGggPiBhcnJMZW5ndGgpIGJ5dGVPZmZzZXQgPSBhcnJMZW5ndGggLSB2YWxMZW5ndGhcbiAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpID49IDA7IGktLSkge1xuICAgICAgdmFyIGZvdW5kID0gdHJ1ZVxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB2YWxMZW5ndGg7IGorKykge1xuICAgICAgICBpZiAocmVhZChhcnIsIGkgKyBqKSAhPT0gcmVhZCh2YWwsIGopKSB7XG4gICAgICAgICAgZm91bmQgPSBmYWxzZVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGlcbiAgICB9XG4gIH1cblxuICByZXR1cm4gLTFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbmNsdWRlcyA9IGZ1bmN0aW9uIGluY2x1ZGVzICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7XG4gIHJldHVybiB0aGlzLmluZGV4T2YodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgIT09IC0xXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIHRydWUpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUubGFzdEluZGV4T2YgPSBmdW5jdGlvbiBsYXN0SW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICByZXR1cm4gYmlkaXJlY3Rpb25hbEluZGV4T2YodGhpcywgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZmFsc2UpXG59XG5cbmZ1bmN0aW9uIGhleFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgb2Zmc2V0ID0gTnVtYmVyKG9mZnNldCkgfHwgMFxuICB2YXIgcmVtYWluaW5nID0gYnVmLmxlbmd0aCAtIG9mZnNldFxuICBpZiAoIWxlbmd0aCkge1xuICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICB9IGVsc2Uge1xuICAgIGxlbmd0aCA9IE51bWJlcihsZW5ndGgpXG4gICAgaWYgKGxlbmd0aCA+IHJlbWFpbmluZykge1xuICAgICAgbGVuZ3RoID0gcmVtYWluaW5nXG4gICAgfVxuICB9XG5cbiAgLy8gbXVzdCBiZSBhbiBldmVuIG51bWJlciBvZiBkaWdpdHNcbiAgdmFyIHN0ckxlbiA9IHN0cmluZy5sZW5ndGhcbiAgaWYgKHN0ckxlbiAlIDIgIT09IDApIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpXG5cbiAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHtcbiAgICBsZW5ndGggPSBzdHJMZW4gLyAyXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBwYXJzZWQgPSBwYXJzZUludChzdHJpbmcuc3Vic3RyKGkgKiAyLCAyKSwgMTYpXG4gICAgaWYgKGlzTmFOKHBhcnNlZCkpIHJldHVybiBpXG4gICAgYnVmW29mZnNldCArIGldID0gcGFyc2VkXG4gIH1cbiAgcmV0dXJuIGlcbn1cblxuZnVuY3Rpb24gdXRmOFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIodXRmOFRvQnl0ZXMoc3RyaW5nLCBidWYubGVuZ3RoIC0gb2Zmc2V0KSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYXNjaWlXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKGFzY2lpVG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBsYXRpbjFXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBhc2NpaVdyaXRlKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYmFzZTY0V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcihiYXNlNjRUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIHVjczJXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKHV0ZjE2bGVUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiB3cml0ZSAoc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCwgZW5jb2RpbmcpIHtcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZylcbiAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZW5jb2RpbmcgPSAndXRmOCdcbiAgICBsZW5ndGggPSB0aGlzLmxlbmd0aFxuICAgIG9mZnNldCA9IDBcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgZW5jb2RpbmcpXG4gIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIG9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICBlbmNvZGluZyA9IG9mZnNldFxuICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoXG4gICAgb2Zmc2V0ID0gMFxuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBvZmZzZXRbLCBsZW5ndGhdWywgZW5jb2RpbmddKVxuICB9IGVsc2UgaWYgKGlzRmluaXRlKG9mZnNldCkpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gICAgaWYgKGlzRmluaXRlKGxlbmd0aCkpIHtcbiAgICAgIGxlbmd0aCA9IGxlbmd0aCB8IDBcbiAgICAgIGlmIChlbmNvZGluZyA9PT0gdW5kZWZpbmVkKSBlbmNvZGluZyA9ICd1dGY4J1xuICAgIH0gZWxzZSB7XG4gICAgICBlbmNvZGluZyA9IGxlbmd0aFxuICAgICAgbGVuZ3RoID0gdW5kZWZpbmVkXG4gICAgfVxuICAvLyBsZWdhY3kgd3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0LCBsZW5ndGgpIC0gcmVtb3ZlIGluIHYwLjEzXG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ0J1ZmZlci53cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXRbLCBsZW5ndGhdKSBpcyBubyBsb25nZXIgc3VwcG9ydGVkJ1xuICAgIClcbiAgfVxuXG4gIHZhciByZW1haW5pbmcgPSB0aGlzLmxlbmd0aCAtIG9mZnNldFxuICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgfHwgbGVuZ3RoID4gcmVtYWluaW5nKSBsZW5ndGggPSByZW1haW5pbmdcblxuICBpZiAoKHN0cmluZy5sZW5ndGggPiAwICYmIChsZW5ndGggPCAwIHx8IG9mZnNldCA8IDApKSB8fCBvZmZzZXQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIHdyaXRlIG91dHNpZGUgYnVmZmVyIGJvdW5kcycpXG4gIH1cblxuICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4J1xuXG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG4gIGZvciAoOzspIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gaGV4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndXRmOCc6XG4gICAgICBjYXNlICd1dGYtOCc6XG4gICAgICAgIHJldHVybiB1dGY4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICByZXR1cm4gYXNjaWlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdsYXRpbjEnOlxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGxhdGluMVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIC8vIFdhcm5pbmc6IG1heExlbmd0aCBub3QgdGFrZW4gaW50byBhY2NvdW50IGluIGJhc2U2NFdyaXRlXG4gICAgICAgIHJldHVybiBiYXNlNjRXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdWNzMldyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIHRvSlNPTiAoKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0J1ZmZlcicsXG4gICAgZGF0YTogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5fYXJyIHx8IHRoaXMsIDApXG4gIH1cbn1cblxuZnVuY3Rpb24gYmFzZTY0U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBpZiAoc3RhcnQgPT09IDAgJiYgZW5kID09PSBidWYubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1ZilcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmLnNsaWNlKHN0YXJ0LCBlbmQpKVxuICB9XG59XG5cbmZ1bmN0aW9uIHV0ZjhTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcbiAgdmFyIHJlcyA9IFtdXG5cbiAgdmFyIGkgPSBzdGFydFxuICB3aGlsZSAoaSA8IGVuZCkge1xuICAgIHZhciBmaXJzdEJ5dGUgPSBidWZbaV1cbiAgICB2YXIgY29kZVBvaW50ID0gbnVsbFxuICAgIHZhciBieXRlc1BlclNlcXVlbmNlID0gKGZpcnN0Qnl0ZSA+IDB4RUYpID8gNFxuICAgICAgOiAoZmlyc3RCeXRlID4gMHhERikgPyAzXG4gICAgICA6IChmaXJzdEJ5dGUgPiAweEJGKSA/IDJcbiAgICAgIDogMVxuXG4gICAgaWYgKGkgKyBieXRlc1BlclNlcXVlbmNlIDw9IGVuZCkge1xuICAgICAgdmFyIHNlY29uZEJ5dGUsIHRoaXJkQnl0ZSwgZm91cnRoQnl0ZSwgdGVtcENvZGVQb2ludFxuXG4gICAgICBzd2l0Y2ggKGJ5dGVzUGVyU2VxdWVuY2UpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGlmIChmaXJzdEJ5dGUgPCAweDgwKSB7XG4gICAgICAgICAgICBjb2RlUG9pbnQgPSBmaXJzdEJ5dGVcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHgxRikgPDwgMHg2IHwgKHNlY29uZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkge1xuICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweEYpIDw8IDB4QyB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKHRoaXJkQnl0ZSAmIDB4M0YpXG4gICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0ZGICYmICh0ZW1wQ29kZVBvaW50IDwgMHhEODAwIHx8IHRlbXBDb2RlUG9pbnQgPiAweERGRkYpKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXVxuICAgICAgICAgIGZvdXJ0aEJ5dGUgPSBidWZbaSArIDNdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwICYmIChmb3VydGhCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweDEyIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweEMgfCAodGhpcmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKGZvdXJ0aEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweEZGRkYgJiYgdGVtcENvZGVQb2ludCA8IDB4MTEwMDAwKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNvZGVQb2ludCA9PT0gbnVsbCkge1xuICAgICAgLy8gd2UgZGlkIG5vdCBnZW5lcmF0ZSBhIHZhbGlkIGNvZGVQb2ludCBzbyBpbnNlcnQgYVxuICAgICAgLy8gcmVwbGFjZW1lbnQgY2hhciAoVStGRkZEKSBhbmQgYWR2YW5jZSBvbmx5IDEgYnl0ZVxuICAgICAgY29kZVBvaW50ID0gMHhGRkZEXG4gICAgICBieXRlc1BlclNlcXVlbmNlID0gMVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50ID4gMHhGRkZGKSB7XG4gICAgICAvLyBlbmNvZGUgdG8gdXRmMTYgKHN1cnJvZ2F0ZSBwYWlyIGRhbmNlKVxuICAgICAgY29kZVBvaW50IC09IDB4MTAwMDBcbiAgICAgIHJlcy5wdXNoKGNvZGVQb2ludCA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMClcbiAgICAgIGNvZGVQb2ludCA9IDB4REMwMCB8IGNvZGVQb2ludCAmIDB4M0ZGXG4gICAgfVxuXG4gICAgcmVzLnB1c2goY29kZVBvaW50KVxuICAgIGkgKz0gYnl0ZXNQZXJTZXF1ZW5jZVxuICB9XG5cbiAgcmV0dXJuIGRlY29kZUNvZGVQb2ludHNBcnJheShyZXMpXG59XG5cbi8vIEJhc2VkIG9uIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIyNzQ3MjcyLzY4MDc0MiwgdGhlIGJyb3dzZXIgd2l0aFxuLy8gdGhlIGxvd2VzdCBsaW1pdCBpcyBDaHJvbWUsIHdpdGggMHgxMDAwMCBhcmdzLlxuLy8gV2UgZ28gMSBtYWduaXR1ZGUgbGVzcywgZm9yIHNhZmV0eVxudmFyIE1BWF9BUkdVTUVOVFNfTEVOR1RIID0gMHgxMDAwXG5cbmZ1bmN0aW9uIGRlY29kZUNvZGVQb2ludHNBcnJheSAoY29kZVBvaW50cykge1xuICB2YXIgbGVuID0gY29kZVBvaW50cy5sZW5ndGhcbiAgaWYgKGxlbiA8PSBNQVhfQVJHVU1FTlRTX0xFTkdUSCkge1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZywgY29kZVBvaW50cykgLy8gYXZvaWQgZXh0cmEgc2xpY2UoKVxuICB9XG5cbiAgLy8gRGVjb2RlIGluIGNodW5rcyB0byBhdm9pZCBcImNhbGwgc3RhY2sgc2l6ZSBleGNlZWRlZFwiLlxuICB2YXIgcmVzID0gJydcbiAgdmFyIGkgPSAwXG4gIHdoaWxlIChpIDwgbGVuKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoXG4gICAgICBTdHJpbmcsXG4gICAgICBjb2RlUG9pbnRzLnNsaWNlKGksIGkgKz0gTUFYX0FSR1VNRU5UU19MRU5HVEgpXG4gICAgKVxuICB9XG4gIHJldHVybiByZXNcbn1cblxuZnVuY3Rpb24gYXNjaWlTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIHZhciByZXQgPSAnJ1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG5cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0gJiAweDdGKVxuICB9XG4gIHJldHVybiByZXRcbn1cblxuZnVuY3Rpb24gbGF0aW4xU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldKVxuICB9XG4gIHJldHVybiByZXRcbn1cblxuZnVuY3Rpb24gaGV4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gYnVmLmxlbmd0aFxuXG4gIGlmICghc3RhcnQgfHwgc3RhcnQgPCAwKSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgfHwgZW5kIDwgMCB8fCBlbmQgPiBsZW4pIGVuZCA9IGxlblxuXG4gIHZhciBvdXQgPSAnJ1xuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgIG91dCArPSB0b0hleChidWZbaV0pXG4gIH1cbiAgcmV0dXJuIG91dFxufVxuXG5mdW5jdGlvbiB1dGYxNmxlU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgYnl0ZXMgPSBidWYuc2xpY2Uoc3RhcnQsIGVuZClcbiAgdmFyIHJlcyA9ICcnXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpICs9IDIpIHtcbiAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSArIGJ5dGVzW2kgKyAxXSAqIDI1NilcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZSAoc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgc3RhcnQgPSB+fnN0YXJ0XG4gIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogfn5lbmRcblxuICBpZiAoc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgKz0gbGVuXG4gICAgaWYgKHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIH0gZWxzZSBpZiAoc3RhcnQgPiBsZW4pIHtcbiAgICBzdGFydCA9IGxlblxuICB9XG5cbiAgaWYgKGVuZCA8IDApIHtcbiAgICBlbmQgKz0gbGVuXG4gICAgaWYgKGVuZCA8IDApIGVuZCA9IDBcbiAgfSBlbHNlIGlmIChlbmQgPiBsZW4pIHtcbiAgICBlbmQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCBzdGFydCkgZW5kID0gc3RhcnRcblxuICB2YXIgbmV3QnVmXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIG5ld0J1ZiA9IHRoaXMuc3ViYXJyYXkoc3RhcnQsIGVuZClcbiAgICBuZXdCdWYuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIHZhciBzbGljZUxlbiA9IGVuZCAtIHN0YXJ0XG4gICAgbmV3QnVmID0gbmV3IEJ1ZmZlcihzbGljZUxlbiwgdW5kZWZpbmVkKVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2xpY2VMZW47ICsraSkge1xuICAgICAgbmV3QnVmW2ldID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ld0J1ZlxufVxuXG4vKlxuICogTmVlZCB0byBtYWtlIHN1cmUgdGhhdCBidWZmZXIgaXNuJ3QgdHJ5aW5nIHRvIHdyaXRlIG91dCBvZiBib3VuZHMuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrT2Zmc2V0IChvZmZzZXQsIGV4dCwgbGVuZ3RoKSB7XG4gIGlmICgob2Zmc2V0ICUgMSkgIT09IDAgfHwgb2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ29mZnNldCBpcyBub3QgdWludCcpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBsZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludExFID0gZnVuY3Rpb24gcmVhZFVJbnRMRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldF1cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludEJFID0gZnVuY3Rpb24gcmVhZFVJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcbiAgfVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF1cbiAgdmFyIG11bCA9IDFcbiAgd2hpbGUgKGJ5dGVMZW5ndGggPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXSAqIG11bFxuICB9XG5cbiAgcmV0dXJuIHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50OCA9IGZ1bmN0aW9uIHJlYWRVSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkxFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiB0aGlzW29mZnNldF0gfCAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCA4KSB8IHRoaXNbb2Zmc2V0ICsgMV1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDMyTEUgPSBmdW5jdGlvbiByZWFkVUludDMyTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcblxuICByZXR1cm4gKCh0aGlzW29mZnNldF0pIHxcbiAgICAgICh0aGlzW29mZnNldCArIDFdIDw8IDgpIHxcbiAgICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSkgK1xuICAgICAgKHRoaXNbb2Zmc2V0ICsgM10gKiAweDEwMDAwMDApXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkJFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gKiAweDEwMDAwMDApICtcbiAgICAoKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgdGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50TEUgPSBmdW5jdGlvbiByZWFkSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cbiAgbXVsICo9IDB4ODBcblxuICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50QkUgPSBmdW5jdGlvbiByZWFkSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgaSA9IGJ5dGVMZW5ndGhcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgLS1pXVxuICB3aGlsZSAoaSA+IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyAtLWldICogbXVsXG4gIH1cbiAgbXVsICo9IDB4ODBcblxuICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50OCA9IGZ1bmN0aW9uIHJlYWRJbnQ4IChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpXG4gIGlmICghKHRoaXNbb2Zmc2V0XSAmIDB4ODApKSByZXR1cm4gKHRoaXNbb2Zmc2V0XSlcbiAgcmV0dXJuICgoMHhmZiAtIHRoaXNbb2Zmc2V0XSArIDEpICogLTEpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2TEUgPSBmdW5jdGlvbiByZWFkSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbiAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gcmVhZEludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgMV0gfCAodGhpc1tvZmZzZXRdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJMRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0pIHxcbiAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAzXSA8PCAyNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgMjQpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCAxNikgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDgpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdExFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCAyMywgNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRCRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdEJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUxFID0gZnVuY3Rpb24gcmVhZERvdWJsZUxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCA1MiwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlQkUgPSBmdW5jdGlvbiByZWFkRG91YmxlQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCA1MiwgOClcbn1cblxuZnVuY3Rpb24gY2hlY2tJbnQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImJ1ZmZlclwiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKVxuICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInZhbHVlXCIgYXJndW1lbnQgaXMgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlVUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKVxuICB9XG5cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlVUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVVSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweGZmLCAwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIHJldHVybiBvZmZzZXQgKyAxXG59XG5cbmZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDE2IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZiArIHZhbHVlICsgMVxuICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDIpOyBpIDwgajsgKytpKSB7XG4gICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlICYgKDB4ZmYgPDwgKDggKiAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSkpKSA+Pj5cbiAgICAgIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpICogOFxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbmZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDMyIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZmZmZmYgKyB2YWx1ZSArIDFcbiAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCA0KTsgaSA8IGo7ICsraSkge1xuICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSA+Pj4gKGxpdHRsZUVuZGlhbiA/IGkgOiAzIC0gaSkgKiA4KSAmIDB4ZmZcbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyTEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSAwXG4gIHZhciBtdWwgPSAxXG4gIHZhciBzdWIgPSAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSAtIDFdICE9PSAwKSB7XG4gICAgICBzdWIgPSAxXG4gICAgfVxuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gMFxuICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSArIDFdICE9PSAwKSB7XG4gICAgICBzdWIgPSAxXG4gICAgfVxuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4N2YsIC0weDgwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZiArIHZhbHVlICsgMVxuICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICByZXR1cm4gb2Zmc2V0ICsgMVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQxNkJFID0gZnVuY3Rpb24gd3JpdGVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5mdW5jdGlvbiBjaGVja0lFRUU3NTQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG4gIGlmIChvZmZzZXQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuZnVuY3Rpb24gd3JpdGVGbG9hdCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA0LCAzLjQwMjgyMzQ2NjM4NTI4ODZlKzM4LCAtMy40MDI4MjM0NjYzODUyODg2ZSszOClcbiAgfVxuICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCAyMywgNClcbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0TEUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUsIG5vQXNzZXJ0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRCRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KVxufVxuXG5mdW5jdGlvbiB3cml0ZURvdWJsZSAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA4LCAxLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCwgLTEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4KVxuICB9XG4gIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDUyLCA4KVxuICByZXR1cm4gb2Zmc2V0ICsgOFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVCRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpXG59XG5cbi8vIGNvcHkodGFyZ2V0QnVmZmVyLCB0YXJnZXRTdGFydD0wLCBzb3VyY2VTdGFydD0wLCBzb3VyY2VFbmQ9YnVmZmVyLmxlbmd0aClcbkJ1ZmZlci5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIGNvcHkgKHRhcmdldCwgdGFyZ2V0U3RhcnQsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKCFzdGFydCkgc3RhcnQgPSAwXG4gIGlmICghZW5kICYmIGVuZCAhPT0gMCkgZW5kID0gdGhpcy5sZW5ndGhcbiAgaWYgKHRhcmdldFN0YXJ0ID49IHRhcmdldC5sZW5ndGgpIHRhcmdldFN0YXJ0ID0gdGFyZ2V0Lmxlbmd0aFxuICBpZiAoIXRhcmdldFN0YXJ0KSB0YXJnZXRTdGFydCA9IDBcbiAgaWYgKGVuZCA+IDAgJiYgZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgLy8gQ29weSAwIGJ5dGVzOyB3ZSdyZSBkb25lXG4gIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm4gMFxuICBpZiAodGFyZ2V0Lmxlbmd0aCA9PT0gMCB8fCB0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcblxuICAvLyBGYXRhbCBlcnJvciBjb25kaXRpb25zXG4gIGlmICh0YXJnZXRTdGFydCA8IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcigndGFyZ2V0U3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIH1cbiAgaWYgKHN0YXJ0IDwgMCB8fCBzdGFydCA+PSB0aGlzLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZVN0YXJ0IG91dCBvZiBib3VuZHMnKVxuICBpZiAoZW5kIDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZUVuZCBvdXQgb2YgYm91bmRzJylcblxuICAvLyBBcmUgd2Ugb29iP1xuICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmICh0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgPCBlbmQgLSBzdGFydCkge1xuICAgIGVuZCA9IHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCArIHN0YXJ0XG4gIH1cblxuICB2YXIgbGVuID0gZW5kIC0gc3RhcnRcbiAgdmFyIGlcblxuICBpZiAodGhpcyA9PT0gdGFyZ2V0ICYmIHN0YXJ0IDwgdGFyZ2V0U3RhcnQgJiYgdGFyZ2V0U3RhcnQgPCBlbmQpIHtcbiAgICAvLyBkZXNjZW5kaW5nIGNvcHkgZnJvbSBlbmRcbiAgICBmb3IgKGkgPSBsZW4gLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF1cbiAgICB9XG4gIH0gZWxzZSBpZiAobGVuIDwgMTAwMCB8fCAhQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBhc2NlbmRpbmcgY29weSBmcm9tIHN0YXJ0XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBVaW50OEFycmF5LnByb3RvdHlwZS5zZXQuY2FsbChcbiAgICAgIHRhcmdldCxcbiAgICAgIHRoaXMuc3ViYXJyYXkoc3RhcnQsIHN0YXJ0ICsgbGVuKSxcbiAgICAgIHRhcmdldFN0YXJ0XG4gICAgKVxuICB9XG5cbiAgcmV0dXJuIGxlblxufVxuXG4vLyBVc2FnZTpcbi8vICAgIGJ1ZmZlci5maWxsKG51bWJlclssIG9mZnNldFssIGVuZF1dKVxuLy8gICAgYnVmZmVyLmZpbGwoYnVmZmVyWywgb2Zmc2V0WywgZW5kXV0pXG4vLyAgICBidWZmZXIuZmlsbChzdHJpbmdbLCBvZmZzZXRbLCBlbmRdXVssIGVuY29kaW5nXSlcbkJ1ZmZlci5wcm90b3R5cGUuZmlsbCA9IGZ1bmN0aW9uIGZpbGwgKHZhbCwgc3RhcnQsIGVuZCwgZW5jb2RpbmcpIHtcbiAgLy8gSGFuZGxlIHN0cmluZyBjYXNlczpcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKHR5cGVvZiBzdGFydCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGVuY29kaW5nID0gc3RhcnRcbiAgICAgIHN0YXJ0ID0gMFxuICAgICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbmQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBlbmNvZGluZyA9IGVuZFxuICAgICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgICB9XG4gICAgaWYgKHZhbC5sZW5ndGggPT09IDEpIHtcbiAgICAgIHZhciBjb2RlID0gdmFsLmNoYXJDb2RlQXQoMClcbiAgICAgIGlmIChjb2RlIDwgMjU2KSB7XG4gICAgICAgIHZhbCA9IGNvZGVcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIGVuY29kaW5nICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZW5jb2RpbmcgbXVzdCBiZSBhIHN0cmluZycpXG4gICAgfVxuICAgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnICYmICFCdWZmZXIuaXNFbmNvZGluZyhlbmNvZGluZykpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICB2YWwgPSB2YWwgJiAyNTVcbiAgfVxuXG4gIC8vIEludmFsaWQgcmFuZ2VzIGFyZSBub3Qgc2V0IHRvIGEgZGVmYXVsdCwgc28gY2FuIHJhbmdlIGNoZWNrIGVhcmx5LlxuICBpZiAoc3RhcnQgPCAwIHx8IHRoaXMubGVuZ3RoIDwgc3RhcnQgfHwgdGhpcy5sZW5ndGggPCBlbmQpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignT3V0IG9mIHJhbmdlIGluZGV4JylcbiAgfVxuXG4gIGlmIChlbmQgPD0gc3RhcnQpIHtcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgc3RhcnQgPSBzdGFydCA+Pj4gMFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IHRoaXMubGVuZ3RoIDogZW5kID4+PiAwXG5cbiAgaWYgKCF2YWwpIHZhbCA9IDBcblxuICB2YXIgaVxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgICB0aGlzW2ldID0gdmFsXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBieXRlcyA9IEJ1ZmZlci5pc0J1ZmZlcih2YWwpXG4gICAgICA/IHZhbFxuICAgICAgOiB1dGY4VG9CeXRlcyhuZXcgQnVmZmVyKHZhbCwgZW5jb2RpbmcpLnRvU3RyaW5nKCkpXG4gICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aFxuICAgIGZvciAoaSA9IDA7IGkgPCBlbmQgLSBzdGFydDsgKytpKSB7XG4gICAgICB0aGlzW2kgKyBzdGFydF0gPSBieXRlc1tpICUgbGVuXVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8vIEhFTFBFUiBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PT1cblxudmFyIElOVkFMSURfQkFTRTY0X1JFID0gL1teK1xcLzAtOUEtWmEtei1fXS9nXG5cbmZ1bmN0aW9uIGJhc2U2NGNsZWFuIChzdHIpIHtcbiAgLy8gTm9kZSBzdHJpcHMgb3V0IGludmFsaWQgY2hhcmFjdGVycyBsaWtlIFxcbiBhbmQgXFx0IGZyb20gdGhlIHN0cmluZywgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHN0ciA9IHN0cmluZ3RyaW0oc3RyKS5yZXBsYWNlKElOVkFMSURfQkFTRTY0X1JFLCAnJylcbiAgLy8gTm9kZSBjb252ZXJ0cyBzdHJpbmdzIHdpdGggbGVuZ3RoIDwgMiB0byAnJ1xuICBpZiAoc3RyLmxlbmd0aCA8IDIpIHJldHVybiAnJ1xuICAvLyBOb2RlIGFsbG93cyBmb3Igbm9uLXBhZGRlZCBiYXNlNjQgc3RyaW5ncyAobWlzc2luZyB0cmFpbGluZyA9PT0pLCBiYXNlNjQtanMgZG9lcyBub3RcbiAgd2hpbGUgKHN0ci5sZW5ndGggJSA0ICE9PSAwKSB7XG4gICAgc3RyID0gc3RyICsgJz0nXG4gIH1cbiAgcmV0dXJuIHN0clxufVxuXG5mdW5jdGlvbiBzdHJpbmd0cmltIChzdHIpIHtcbiAgaWYgKHN0ci50cmltKSByZXR1cm4gc3RyLnRyaW0oKVxuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKVxufVxuXG5mdW5jdGlvbiB0b0hleCAobikge1xuICBpZiAobiA8IDE2KSByZXR1cm4gJzAnICsgbi50b1N0cmluZygxNilcbiAgcmV0dXJuIG4udG9TdHJpbmcoMTYpXG59XG5cbmZ1bmN0aW9uIHV0ZjhUb0J5dGVzIChzdHJpbmcsIHVuaXRzKSB7XG4gIHVuaXRzID0gdW5pdHMgfHwgSW5maW5pdHlcbiAgdmFyIGNvZGVQb2ludFxuICB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aFxuICB2YXIgbGVhZFN1cnJvZ2F0ZSA9IG51bGxcbiAgdmFyIGJ5dGVzID0gW11cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgY29kZVBvaW50ID0gc3RyaW5nLmNoYXJDb2RlQXQoaSlcblxuICAgIC8vIGlzIHN1cnJvZ2F0ZSBjb21wb25lbnRcbiAgICBpZiAoY29kZVBvaW50ID4gMHhEN0ZGICYmIGNvZGVQb2ludCA8IDB4RTAwMCkge1xuICAgICAgLy8gbGFzdCBjaGFyIHdhcyBhIGxlYWRcbiAgICAgIGlmICghbGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgICAvLyBubyBsZWFkIHlldFxuICAgICAgICBpZiAoY29kZVBvaW50ID4gMHhEQkZGKSB7XG4gICAgICAgICAgLy8gdW5leHBlY3RlZCB0cmFpbFxuICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH0gZWxzZSBpZiAoaSArIDEgPT09IGxlbmd0aCkge1xuICAgICAgICAgIC8vIHVucGFpcmVkIGxlYWRcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gdmFsaWQgbGVhZFxuICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50XG5cbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gMiBsZWFkcyBpbiBhIHJvd1xuICAgICAgaWYgKGNvZGVQb2ludCA8IDB4REMwMCkge1xuICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICAvLyB2YWxpZCBzdXJyb2dhdGUgcGFpclxuICAgICAgY29kZVBvaW50ID0gKGxlYWRTdXJyb2dhdGUgLSAweEQ4MDAgPDwgMTAgfCBjb2RlUG9pbnQgLSAweERDMDApICsgMHgxMDAwMFxuICAgIH0gZWxzZSBpZiAobGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgLy8gdmFsaWQgYm1wIGNoYXIsIGJ1dCBsYXN0IGNoYXIgd2FzIGEgbGVhZFxuICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgfVxuXG4gICAgbGVhZFN1cnJvZ2F0ZSA9IG51bGxcblxuICAgIC8vIGVuY29kZSB1dGY4XG4gICAgaWYgKGNvZGVQb2ludCA8IDB4ODApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMSkgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChjb2RlUG9pbnQpXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDgwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2IHwgMHhDMCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTAwMDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMykgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4QyB8IDB4RTAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTEwMDAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDQpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDEyIHwgMHhGMCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4QyAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjb2RlIHBvaW50JylcbiAgICB9XG4gIH1cblxuICByZXR1cm4gYnl0ZXNcbn1cblxuZnVuY3Rpb24gYXNjaWlUb0J5dGVzIChzdHIpIHtcbiAgdmFyIGJ5dGVBcnJheSA9IFtdXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgLy8gTm9kZSdzIGNvZGUgc2VlbXMgdG8gYmUgZG9pbmcgdGhpcyBhbmQgbm90ICYgMHg3Ri4uXG4gICAgYnl0ZUFycmF5LnB1c2goc3RyLmNoYXJDb2RlQXQoaSkgJiAweEZGKVxuICB9XG4gIHJldHVybiBieXRlQXJyYXlcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVRvQnl0ZXMgKHN0ciwgdW5pdHMpIHtcbiAgdmFyIGMsIGhpLCBsb1xuICB2YXIgYnl0ZUFycmF5ID0gW11cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWtcblxuICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKVxuICAgIGhpID0gYyA+PiA4XG4gICAgbG8gPSBjICUgMjU2XG4gICAgYnl0ZUFycmF5LnB1c2gobG8pXG4gICAgYnl0ZUFycmF5LnB1c2goaGkpXG4gIH1cblxuICByZXR1cm4gYnl0ZUFycmF5XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFRvQnl0ZXMgKHN0cikge1xuICByZXR1cm4gYmFzZTY0LnRvQnl0ZUFycmF5KGJhc2U2NGNsZWFuKHN0cikpXG59XG5cbmZ1bmN0aW9uIGJsaXRCdWZmZXIgKHNyYywgZHN0LCBvZmZzZXQsIGxlbmd0aCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgaWYgKChpICsgb2Zmc2V0ID49IGRzdC5sZW5ndGgpIHx8IChpID49IHNyYy5sZW5ndGgpKSBicmVha1xuICAgIGRzdFtpICsgb2Zmc2V0XSA9IHNyY1tpXVxuICB9XG4gIHJldHVybiBpXG59XG5cbmZ1bmN0aW9uIGlzbmFuICh2YWwpIHtcbiAgcmV0dXJuIHZhbCAhPT0gdmFsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2VsZi1jb21wYXJlXG59XG4iLCJleHBvcnRzLnJlYWQgPSBmdW5jdGlvbiAoYnVmZmVyLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykge1xuICB2YXIgZSwgbVxuICB2YXIgZUxlbiA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMVxuICB2YXIgZU1heCA9ICgxIDw8IGVMZW4pIC0gMVxuICB2YXIgZUJpYXMgPSBlTWF4ID4+IDFcbiAgdmFyIG5CaXRzID0gLTdcbiAgdmFyIGkgPSBpc0xFID8gKG5CeXRlcyAtIDEpIDogMFxuICB2YXIgZCA9IGlzTEUgPyAtMSA6IDFcbiAgdmFyIHMgPSBidWZmZXJbb2Zmc2V0ICsgaV1cblxuICBpICs9IGRcblxuICBlID0gcyAmICgoMSA8PCAoLW5CaXRzKSkgLSAxKVxuICBzID4+PSAoLW5CaXRzKVxuICBuQml0cyArPSBlTGVuXG4gIGZvciAoOyBuQml0cyA+IDA7IGUgPSBlICogMjU2ICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHt9XG5cbiAgbSA9IGUgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgZSA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gbUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBtID0gbSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fVxuXG4gIGlmIChlID09PSAwKSB7XG4gICAgZSA9IDEgLSBlQmlhc1xuICB9IGVsc2UgaWYgKGUgPT09IGVNYXgpIHtcbiAgICByZXR1cm4gbSA/IE5hTiA6ICgocyA/IC0xIDogMSkgKiBJbmZpbml0eSlcbiAgfSBlbHNlIHtcbiAgICBtID0gbSArIE1hdGgucG93KDIsIG1MZW4pXG4gICAgZSA9IGUgLSBlQmlhc1xuICB9XG4gIHJldHVybiAocyA/IC0xIDogMSkgKiBtICogTWF0aC5wb3coMiwgZSAtIG1MZW4pXG59XG5cbmV4cG9ydHMud3JpdGUgPSBmdW5jdGlvbiAoYnVmZmVyLCB2YWx1ZSwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHtcbiAgdmFyIGUsIG0sIGNcbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBydCA9IChtTGVuID09PSAyMyA/IE1hdGgucG93KDIsIC0yNCkgLSBNYXRoLnBvdygyLCAtNzcpIDogMClcbiAgdmFyIGkgPSBpc0xFID8gMCA6IChuQnl0ZXMgLSAxKVxuICB2YXIgZCA9IGlzTEUgPyAxIDogLTFcbiAgdmFyIHMgPSB2YWx1ZSA8IDAgfHwgKHZhbHVlID09PSAwICYmIDEgLyB2YWx1ZSA8IDApID8gMSA6IDBcblxuICB2YWx1ZSA9IE1hdGguYWJzKHZhbHVlKVxuXG4gIGlmIChpc05hTih2YWx1ZSkgfHwgdmFsdWUgPT09IEluZmluaXR5KSB7XG4gICAgbSA9IGlzTmFOKHZhbHVlKSA/IDEgOiAwXG4gICAgZSA9IGVNYXhcbiAgfSBlbHNlIHtcbiAgICBlID0gTWF0aC5mbG9vcihNYXRoLmxvZyh2YWx1ZSkgLyBNYXRoLkxOMilcbiAgICBpZiAodmFsdWUgKiAoYyA9IE1hdGgucG93KDIsIC1lKSkgPCAxKSB7XG4gICAgICBlLS1cbiAgICAgIGMgKj0gMlxuICAgIH1cbiAgICBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIHZhbHVlICs9IHJ0IC8gY1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZSArPSBydCAqIE1hdGgucG93KDIsIDEgLSBlQmlhcylcbiAgICB9XG4gICAgaWYgKHZhbHVlICogYyA+PSAyKSB7XG4gICAgICBlKytcbiAgICAgIGMgLz0gMlxuICAgIH1cblxuICAgIGlmIChlICsgZUJpYXMgPj0gZU1heCkge1xuICAgICAgbSA9IDBcbiAgICAgIGUgPSBlTWF4XG4gICAgfSBlbHNlIGlmIChlICsgZUJpYXMgPj0gMSkge1xuICAgICAgbSA9ICh2YWx1ZSAqIGMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pXG4gICAgICBlID0gZSArIGVCaWFzXG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSB2YWx1ZSAqIE1hdGgucG93KDIsIGVCaWFzIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IDBcbiAgICB9XG4gIH1cblxuICBmb3IgKDsgbUxlbiA+PSA4OyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBtICYgMHhmZiwgaSArPSBkLCBtIC89IDI1NiwgbUxlbiAtPSA4KSB7fVxuXG4gIGUgPSAoZSA8PCBtTGVuKSB8IG1cbiAgZUxlbiArPSBtTGVuXG4gIGZvciAoOyBlTGVuID4gMDsgYnVmZmVyW29mZnNldCArIGldID0gZSAmIDB4ZmYsIGkgKz0gZCwgZSAvPSAyNTYsIGVMZW4gLT0gOCkge31cblxuICBidWZmZXJbb2Zmc2V0ICsgaSAtIGRdIHw9IHMgKiAxMjhcbn1cbiIsInZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGFycikge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChhcnIpID09ICdbb2JqZWN0IEFycmF5XSc7XG59O1xuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcblxubGV0IFJlc3VsdFN0YXR1cyA9IHtcbiAgV0lOOiAyLFxuICBEUkFXOiAxLFxuICBMT1NFOiAwLFxufTtcblxuXG5sZXQgR2FtZVJlc3VsdCA9IGNjLkNsYXNzKHtcbiAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gIHByb3BlcnRpZXM6IHtcbiAgICB3aW5Ob2RlOiBjYy5Ob2RlLFxuICAgIGxvc2VOb2RlOiBjYy5Ob2RlLFxuICAgIGRyYXdOb2RlOiBjYy5Ob2RlLFxuICAgIGNvbnRlbnROb2RlOiBjYy5Ob2RlLFxuXG4gICAgcmVzdWx0SXRlbXM6IFtjYy5Ob2RlXSxcblxuICAgIF9kZXNrSW5mbzogbnVsbCxcbiAgICBfdXNlcklkOiBudWxsLFxuICAgIF9jbG9zZUNhbGxiYWNrOiBudWxsLFxuICB9LFxuXG4gIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLl9oaWRlUmVzdWx0SXRlbXMoKTtcbiAgfSxcblxuICBzaG93UmVzdWx0czogZnVuY3Rpb24gKGRlc2tJbmZvLCBjdXJyZW50VXNlcklkKSB7XG4gICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcbiAgICB0aGlzLl91c2VySWQgPSBjdXJyZW50VXNlcklkO1xuXG4gICAgbGV0IHJlc3VsdFN0YXR1cyA9IHRoaXMuX3Jlc3VsdFN0YXR1cygpO1xuICAgIHRoaXMuY29udGVudE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICB0aGlzLndpbk5vZGUuYWN0aXZlID0gIChyZXN1bHRTdGF0dXMgPT0gUmVzdWx0U3RhdHVzLldJTik7XG4gICAgdGhpcy5kcmF3Tm9kZS5hY3RpdmUgPSAocmVzdWx0U3RhdHVzID09IFJlc3VsdFN0YXR1cy5EUkFXKTtcbiAgICB0aGlzLmxvc2VOb2RlLmFjdGl2ZSA9IChyZXN1bHRTdGF0dXMgPT0gUmVzdWx0U3RhdHVzLkxPU0UpO1xuXG4gICAgaWYgKHRoaXMud2luTm9kZS5hY3RpdmUpIHtcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5V2luKCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmxvc2VOb2RlLmFjdGl2ZSkge1xuICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlMb3NlKCk7XG4gICAgfVxuXG4gICAgdGhpcy5ub2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xuICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jykuc2V0RGlzbWlzc0NhbGxiYWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2Nsb3NlQ2FsbGJhY2tcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgbGV0IHBsYXllckluZm9zID0gZGVza0luZm8ucGxheWVycy5zb3J0KGZ1bmN0aW9uIChwMSwgcDIpIHtcbiAgICAgIHJldHVybiBwMi5jU2NvcmUgLSBwMS5jU2NvcmU7XG4gICAgfSk7XG4gICAgbGV0IGl0ZW1Db21wcyA9IHRoaXMucmVzdWx0SXRlbXMubWFwKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICByZXR1cm4gbm9kZS5nZXRDb21wb25lbnQoJ1Jlc3VsdEl0ZW0nKTtcbiAgICB9KTtcbiAgICBpdGVtQ29tcHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbUNvbXAsIGluZGV4KSB7XG4gICAgICBpdGVtQ29tcC5ub2RlLmFjdGl2ZSA9IGluZGV4IDwgcGxheWVySW5mb3MubGVuZ3RoO1xuICAgICAgaWYgKCFpdGVtQ29tcC5ub2RlLmFjdGl2ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCB1c2VyID0gcGxheWVySW5mb3NbaW5kZXhdO1xuICAgICAgaXRlbUNvbXAudXBkYXRlV2l0aFBsYXllckluZm8odXNlciwgZGVza0luZm8uaXNSYW5kb21EZXNrKTtcbiAgICAgIGxldCBjYXJkcyA9IHRoaXMuX2NhcmRzRnJvbVVzZXIodXNlcik7XG4gICAgICBpdGVtQ29tcC5zZXRDYXJkcyhjYXJkcyk7XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfSxcblxuICBzZXRDbG9zZUNhbGxiYWNrOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICB0aGlzLl9jbG9zZUNhbGxiYWNrID0gY2FsbGJhY2s7XG4gIH0sXG5cbiAgX2NhcmRzRnJvbVVzZXI6IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgbGV0IGNhcmRzID0gdXNlci5jYXJkSW5mby5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xuICAgICAgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0uY2FyZHMpO1xuICAgIH0pLnJlZHVjZShmdW5jdGlvbiAoYXJyYXksIHN1YkNhcmRzKSB7XG4gICAgICByZXR1cm4gYXJyYXkuY29uY2F0KHN1YkNhcmRzKTtcbiAgICB9LCBbXSk7XG5cbiAgICByZXR1cm4gY2FyZHM7XG4gIH0sXG5cbiAgX2hpZGVSZXN1bHRJdGVtczogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMucmVzdWx0SXRlbXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgbm9kZS5hY2l0dmUgPSBmYWxzZTtcbiAgICB9KTtcbiAgfSxcblxuICBfcmVzdWx0U3RhdHVzOiBmdW5jdGlvbigpIHtcbiAgICBsZXQgcGxheWVySW5mb3MgPSB0aGlzLl9kZXNrSW5mby5wbGF5ZXJzO1xuICAgIGxldCB1c2VyID0gcGxheWVySW5mb3MuZmluZChmdW5jdGlvbiAodXNlcikge1xuICAgICAgcmV0dXJuIHVzZXIuaWQgPT0gdGhpcy5fdXNlcklkO1xuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICBsZXQgc2NvcmUgPSB1c2VyLmNTY29yZTtcbiAgICBpZiAodGhpcy5fZGVza0luZm8uaXNSYW5kb21EZXNrKSB7XG4gICAgICAvLyDlpoLmnpzmmK/pmo/mnLrlnLrnmoTor53vvIzlupTor6XnlKjpkrvnn7PmnaXliKTmlq3ovpPotaJcbiAgICAgIHNjb3JlID0gdXNlci5kaWFtb25kO1xuICAgIH1cblxuICAgIGlmIChzY29yZSA+IDApIHtcbiAgICAgIHJldHVybiBSZXN1bHRTdGF0dXMuV0lOO1xuICAgIH0gZWxzZSBpZiAoc2NvcmUgPCAwKSB7XG4gICAgICByZXR1cm4gUmVzdWx0U3RhdHVzLkxPU0U7XG4gICAgfVxuXG4gICAgcmV0dXJuIFJlc3VsdFN0YXR1cy5EUkFXO1xuICB9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZVJlc3VsdDtcbiIsIi8qIyMjIyMqL1xyXG4vL++/ve+/ve+/ve+/ve+/ve+/ve+/ve+/vdK777+977+977+977+977+977+977+977+977+92rXvv73vv73vv73NrO+/ve+/ve+/ve+/ve+/ve+/ve+/vca177+977+977+977+977+9XHJcbiB2YXIgR2V0Q2FyZFBvaW50c1NhbWVDb3VudCA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdGhpcy5jYXJkTnVtYmVycyA9IHt9O1xyXG4gICAgZm9yKHZhciBpIGluIGNhcmRzKXtcclxuICAgICAgICB2YXIgcztcclxuICAgICAgICBpZih0eXBlb2YoY2FyZHNbaV0ubnVtYmVyKSA9PSAndW5kZWZpbmVkJyl7XHJcbiAgICAgICAgICAgIHMgPSBjYXJkc1tpXS5wb2ludDtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcyA9IGNhcmRzW2ldLm51bWJlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5jYXJkTnVtYmVyc1tzXSl7XHJcbiAgICAgICAgICAgIHRoaXMuY2FyZE51bWJlcnNbc10gKys7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuY2FyZE51bWJlcnNbc10gPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL2NjLmxvZyh0aGlzLmNhcmROdW1iZXJzW2NhcmRzW2ldLm51bWJlcl0pXHJcbiAgICAgICAgLy9jYy5sb2coY2FyZHMpXHJcbiAgICAgICAgLy9jYy5sb2coY2FyZHNbaV0ubnVtYmVyKVxyXG4gICAgICAgIC8vY2MubG9nKCctLS03JylcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLmNhcmROdW1iZXJzO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBHZXRDYXJkUG9pbnRzU2FtZUNvdW50O1xyXG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGxhYmVsTnVtYmVyczogW2NjLkxhYmVsXSxcbiAgICAgICAgY2FsbGJhY2tKb2luUm9vbTogbnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNsaWNrQ2xlYXIoKTtcbiAgICB9LFxuXG4gICAgY2xpY2tOdW1iZXI6IGZ1bmN0aW9uIChldmVudCwgbnVtYmVyKSB7XG4gICAgICB2YXIgbGFiZWwgPSB0aGlzLl9sYXN0RW1wdHlMYWJlbCgpO1xuICAgICAgaWYgKGxhYmVsKSB7XG4gICAgICAgIGxhYmVsLnN0cmluZyA9IG51bWJlcjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGxldCBpc0NvbXBsZXRlID0gKHRoaXMuX2xhc3RFbXB0eUxhYmVsKCkgPT0gbnVsbCk7XG4gICAgICBsZXQgaW52aXRlTnVtYmVyID0gdGhpcy5fcm9vbU51bWJlcigpO1xuICAgICAgaWYgKGludml0ZU51bWJlci5sZW5ndGggPT0gNikge1xuICAgICAgICB0aGlzLmNhbGxiYWNrSm9pblJvb20gPSBpbnZpdGVOdW1iZXI7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHNlbmRDb2RlIDpmdW5jdGlvbigpeyAgLy/lj5HpgIHpgoDor7fnoIFcbiAgICAgIGxldCB1c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XG4gICAgICBsZXQgaW52aXRlTnVtYmVyID0gdGhpcy5jYWxsYmFja0pvaW5Sb29tO1xuICAgICAgY29uc29sZS5sb2coaW52aXRlTnVtYmVyICxcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVwiKTtcbiAgICAgIGlmKCBpbnZpdGVOdW1iZXIubGVuZ3RoPT02KXsgIFxuICAgICAgICBTb2NrZXQuc2VuZEludml0ZUNvZGUoaW52aXRlTnVtYmVyLCB1c2VySWQpO1xuICAgICAgICB0aGlzLmNhbGxiYWNrSm9pblJvb20gPSAnJzsgICAvL+a4heepuumCgOivt+eggVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBjbGlja0NsZWFyOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNhbGxiYWNrSm9pblJvb20gPSAnJztcbiAgICAgIHRoaXMubGFiZWxOdW1iZXJzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7XG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgY2xpY2tEZWxldGVPbmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBsYWJlbCA9IHRoaXMuX2xhc3ROdW1iZXJMYWJlbCgpO1xuICAgICAgaWYgKGxhYmVsKSB7XG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XG4gICAgICB9XG4gICAgfSxcblxuICAgIF9sYXN0RW1wdHlMYWJlbDogZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgaW5kZXggaW4gdGhpcy5sYWJlbE51bWJlcnMpIHtcbiAgICAgICAgdmFyIGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xuICAgICAgICBpZiAobGFiZWwuc3RyaW5nID09IG51bGxcbiAgICAgICAgfHwgbGFiZWwuc3RyaW5nLmxlbmd0aCA8PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX2xhc3ROdW1iZXJMYWJlbDogZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgaW5kZXggPSB0aGlzLmxhYmVsTnVtYmVycy5sZW5ndGggLSAxOyBpbmRleCA+PSAwOyAtLWluZGV4KSB7XG4gICAgICAgIGxldCBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyAmJiBsYWJlbC5zdHJpbmcubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX3Jvb21OdW1iZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLmxhYmVsTnVtYmVycy5yZWR1Y2UoZnVuY3Rpb24gKHJvb21OdW1iZXIsIGxhYmVsKSB7XG4gICAgICAgIHJldHVybiByb29tTnVtYmVyICsgKGxhYmVsLnN0cmluZyB8fCBcIlwiKTtcbiAgICAgIH0sIFwiXCIpO1xuICAgIH0sXG59KTtcbiIsIi8vIOeJjOiKseiJsuW4ruWKqeexu1xuLy8g55So5LqO6K6h566X5LiA5Liq54mM5pWw57uE55qE6Iqx6Imy55u45ZCM55qE54mM55qE5byg5pWwXG52YXIgS1FDYXJkQ29sb3JzSGVscGVyID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gIHRoaXMuY29sb3JOdW1iZXIgPSB7fTtcblxuICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgbGV0IGNvbG9yID0gY2FyZC5jb2xvcjtcbiAgICB2YXIgbnVtYmVyID0gdGhpcy5jb2xvck51bWJlcltjb2xvcl0gfHwgMDtcbiAgICB0aGlzLmNvbG9yTnVtYmVyW2NvbG9yXSA9IG51bWJlciArIDE7XG4gIH0uYmluZCh0aGlzKSk7XG59O1xuXG4vLyDnm7jlkIzoirHoibLnmoTniYznmoTmnIDlpKfmlbDph49cbktRQ2FyZENvbG9yc0hlbHBlci5wcm90b3R5cGUubWF4TnVtYmVyID0gZnVuY3Rpb24gKCkge1xuICB2YXIgcmVzdWx0ID0gMDtcbiAgZm9yIChsZXQgcHJvcCBpbiB0aGlzLmNvbG9yTnVtYmVyKSB7XG4gICAgbGV0IG51bWJlciA9IHRoaXMuY29sb3JOdW1iZXJbcHJvcF07XG4gICAgcmVzdWx0ID0gTWF0aC5tYXgobnVtYmVyLCByZXN1bHQpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gS1FDYXJkQ29sb3JzSGVscGVyO1xuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jb25zdCBBcnJheUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0FycmF5RXh0ZW5zaW9uJyk7XG5jb25zdCBLUUNhcmRQb2ludHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRQb2ludHNIZWxwZXInKTtcblxubW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8g5a+75om+IGNhcmRNb2RlcyDkuK3nmoQg5a+55a2QXG4vLyDov5nkvJrov5Tlm54g5a+55a2QIOeahOe0ouW8leaVsOe7hFxuLy8g5aaC77yaW1sxLCAzXSwgWzQsIDVdXVxuS1FDYXJkLmZpbmREdWlaaSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgbGV0IHNEdWlaaUluZGV4cyA9IEtRQ2FyZC5maW5kU2FuVGlhbyhjYXJkTW9kZXMpIHx8IFtdO1xuICBsZXQgcmVzdWx0ID0gS1FDYXJkLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCAyKSB8fCBbXTtcbiAgaWYocmVzdWx0Lmxlbmd0aCA8IDIgKXtcbiAgICBpZihzRHVpWmlJbmRleHMubGVuZ3RoID4gMCl7XG4gICAgICBzRHVpWmlJbmRleHMuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgdmFyIHMxID0gW2luZGV4c1swXSxpbmRleHNbMV1dO1xuICAgICAgICAvL3ZhciBzMiA9IFtpbmRleHNbMV0saW5kZXhzWzJdXTtcbiAgICAgICAgLy9yZXN1bHQucHVzaChzMik7XG4gICAgICAgIHJlc3VsdC5wdXNoKHMxKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICB2YXIgdHJlc3VsdCA9IEtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2RlcywyKTtcbiAgICBmb3IodmFyIGkgPSAwO2kgPCB0cmVzdWx0Lmxlbmd0aDtpKyspe1xuICAgICAgcmVzdWx0LnB1c2godHJlc3VsdFtpXSk7XG4gICAgfVxuICB9XG5cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpO1xuXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IFtdO1xufTtcblxuS1FDYXJkLl9maW5kUG9pbnRMZW5ndGggPSBmdW5jdGlvbiAoY2FyZE1vZGVzLCBsZW5ndGgpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBsZXQgb2JqID0gY2FyZE1vZGVzLnJlZHVjZShmdW5jdGlvbihvYmosIGNhcmQsIGluZGV4KSB7XG4gICAgbGV0IHBvaW50SW5kZXhzID0gb2JqW2NhcmQucG9pbnRdIHx8IFtdO1xuICAgIG9ialtjYXJkLnBvaW50XSA9IHBvaW50SW5kZXhzO1xuICAgIHBvaW50SW5kZXhzLnB1c2goaW5kZXgpO1xuICAgIHJldHVybiBvYmo7XG4gIH0sIHt9KTtcblxuICBsZXQgcmVzdWx0ID0gW107XG4gIGZvciAodmFyIHByb3AgaW4gb2JqKSB7XG4gICAgbGV0IHBvaW50SW5kZXhzID0gb2JqW3Byb3BdO1xuICAgIC8vIGlmIChwb2ludEluZGV4cy5sZW5ndGggPT0gbGVuZ3RoKSB7XG4gICAgLy8gICBwb2ludEluZGV4cy5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAvLyAgICAgcmV0dXJuIG4xIC0gbjI7XG4gICAgLy8gICB9KTtcbiAgICAvLyAgIHJlc3VsdC5wdXNoKHBvaW50SW5kZXhzKTtcbiAgICAvLyB9XG4gICAgd2hpbGUocG9pbnRJbmRleHMubGVuZ3RoID49IGxlbmd0aCAmJiBsZW5ndGggIT0gMCl7Ly/mnInlpJrnmoTliIblibLlpJrkuKrmlbDnu4RcbiAgICAgIHZhciBzcGxpY2VzID0gcG9pbnRJbmRleHMuc3BsaWNlKDAsbGVuZ3RoKTtcbiAgICAgIGlmIChzcGxpY2VzLmxlbmd0aCA+PSBsZW5ndGgpe1xuICAgICAgICBzcGxpY2VzLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVzdWx0LnB1c2goc3BsaWNlcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmVzdWx0LnNvcnQoZnVuY3Rpb24gKGFycjEsIGFycjIpIHtcbiAgICBsZXQgbjEgPSBhcnIxWzBdO1xuICAgIGxldCBuMiA9IGFycjJbMF07XG4gICAgcmV0dXJuIG4yIC0gbjE7XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBbXTtcbn07XG5cbi8vIOaJviDkuKTlr7kg55qE57Si5byV5pWw57uEXG4vLyDlpoLvvJpbWzEsIDIsIDMsIDRdLCBbNSwgNiwgNywgOF1dXG5LUUNhcmQuZmluZExpYUR1aSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgbGV0IGR1aVppSW5kZXhzID0gS1FDYXJkLmZpbmREdWlaaShjYXJkTW9kZXMpIHx8IFtdO1xuICBsZXQgZHVpWmlJbmRleCA9IEtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2RlcywyKSB8fCBbXTtcblxuICBpZihkdWlaaUluZGV4cy5sZW5ndGggPCAxICYmIGR1aVppSW5kZXgubGVuZ3RoID4gMCl7XG4gICAgZHVpWmlJbmRleC5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICBkdWlaaUluZGV4cy51bnNoaWZ0KGluZGV4cyk7XG4gICAgfSk7XG4gIH1cbiAgaWYgKGR1aVppSW5kZXhzLmxlbmd0aCA8IDIpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBsZXQgcmVzdWx0ID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZHVpWmlJbmRleHMubGVuZ3RoOyArK2kpIHtcbiAgICBmb3IgKGxldCBqID0gaSArIDE7IGogPCBkdWlaaUluZGV4cy5sZW5ndGg7ICsraikge1xuICAgICAgaWYocmVzdWx0Lmxlbmd0aCA8IDEwKXtcbiAgICAgICAgbGV0IHByZSA9IGR1aVppSW5kZXhzW2ldO1xuICAgICAgICBsZXQgbmV4dCA9IGR1aVppSW5kZXhzW2pdO1xuICAgICAgICB2YXIgcyA9IHByZS5jb25jYXQobmV4dCk7XG4gICAgICAgIHZhciBuZXdTID0gW107XG4gICAgICAgIGZvcih2YXIgcSA9IDA7cSA8IHMubGVuZ3RoIDtxKyspe1xuICAgICAgICAgIGlmKG5ld1MuaW5kZXhPZihzW3FdKSA9PSAtMSl7XG4gICAgICAgICAgICBuZXdTLnB1c2goc1txXSk7XG4gICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYobmV3Uy5sZW5ndGggPT0gNCl7XG4gICAgICAgICAgbmV3Uy5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJlc3VsdC51bnNoaWZ0KG5ld1MpO1xuICAgICAgICB9XG4gICAgICB9ZWxzZXtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cblxuICAgIH1cbiAgfVxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7XG4gIGlmKHJlc3VsdC5sZW5ndGggPiA2KXtcbiAgICByZXN1bHQgPSByZXN1bHQuc2xpY2UoMCw2KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuLy8g5om+5LiJ5p2hXG4vLyDlpoLvvJpbWzEsIDIsIDNdXTtcbktRQ2FyZC5maW5kU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgaWYoY2FyZE1vZGVzLmxlbmd0aCA8IDMpe1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBsZXQgcmVzdWx0ID0gS1FDYXJkLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCAzKSB8fCBbXTtcbiAgLy9mb3IodmFyIHEgPTA7cTxyZXN1bHQubGVuZ3RoO3ErKyl7XG4gIC8vICB2YXIgaW5kZXhzID0gcmVzdWx0W3FdWzBdO1xuICAvLyAgaWYoY2FyZE1vZGVzW2luZGV4c10ucG9pbnQgPj0gMjApe1xuICAvLyAgICByZXN1bHQuc3BsaWNlKHEsMSk7XG4gIC8vICB9XG4gIC8vfVxuICBpZihyZXN1bHQubGVuZ3RoIDwgMiApe1xuICAgIGxldCB0aWVaaGlJbmRleHNBcnJheSA9IEtRQ2FyZC5maW5kVGllWmhpKGNhcmRNb2Rlcyk7XG4gICAgaWYodGllWmhpSW5kZXhzQXJyYXkubGVuZ3RoID4gMCl7XG4gICAgICB0aWVaaGlJbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMV0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czIgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMzID0gW2luZGV4c1swXSwgaW5kZXhzWzJdLCBpbmRleHNbM11dO1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1syXV07XG4gICAgICAgIHJlc3VsdC5wdXNoKHNhblRpYW9JbmRleHMwKTtcbiAgICAgICAgLy9yZXN1bHQudW5zaGlmdChzYW5UaWFvSW5kZXhzMSk7XG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czIpO1xuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMzKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICB2YXIgdHJlc3VsdCA9IEtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2RlcywzKTtcbiAgICBmb3IodmFyIGkgPSAwO2kgPCB0cmVzdWx0Lmxlbmd0aDtpKyspe1xuICAgICAgcmVzdWx0LnB1c2godHJlc3VsdFtpXSk7XG4gICAgfVxuICB9XG4gIC8qaWYocmVzdWx0Lmxlbmd0aCA8IDEpe1xuICAgIC8vIOmTgeaUr+aYr+WMheWQq+S4ieadoeeahFxuICAgIGxldCB0aWVaaGlJbmRleHNBcnJheSA9IEtRQ2FyZC5maW5kVGllWmhpKGNhcmRNb2Rlcyk7XG4gICAgaWYgKHRpZVpoaUluZGV4c0FycmF5KSB7XG4gICAgICB0aWVaaGlJbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMV0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czIgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMzID0gW2luZGV4c1swXSwgaW5kZXhzWzJdLCBpbmRleHNbM11dO1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1syXV07XG4gICAgICAgIHJlc3VsdC5wdXNoKHNhblRpYW9JbmRleHMwKTtcbiAgICAgICAgLy9yZXN1bHQudW5zaGlmdChzYW5UaWFvSW5kZXhzMSk7XG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czIpO1xuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMzKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSovXG5cbiAgLy9pZihyZXN1bHQubGVuZ3RoID4gMTApe1xuICAvLyAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsMTApO1xuICAvL31cblxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7XG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IFtdO1xufTtcblxuLy8g5om+5ZCM6Iqx6aG6XG4vKktRQ2FyZC5maW5kVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAoY2FyZE1vZGVzLCBsZW5ndGggPSA1KSB7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGxldCByZXN1bHQgPSBbXTtcbiAgdmFyIHNhblNodW5aaSA9IEtRQ2FyZC5zYW5TaHVuWmkxKGNhcmRNb2RlcyxsZW5ndGgpO1xuICBpZihzYW5TaHVuWmlbMF0gPT0gbnVsbCl7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGZvcih2YXIgaT0wO2k8c2FuU2h1blppWzBdLmxlbmd0aDtpKyspIHtcbiAgICB2YXIgcyA9IHNhblNodW5aaVswXVtpXTtcbiAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YVNodW4ocywgbGVuZ3RoKSkge1xuICAgICAgcmVzdWx0LnVuc2hpZnQoc2FuU2h1blppWzFdW2ldKTtcblxuICAgIH1cbiAgfVxuICBpZihyZXN1bHQubGVuZ3RoID4gMCl7XG4gICAgcmV0dXJuIHJlc3VsdFxuICB9ZWxzZXtcbiAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bjEoY2FyZE1vZGVzKTtcbiAgfVxufTsqL1xuS1FDYXJkLmZpbmRUb25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkcywgbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGNhcmRzID0gQXJyYXkuZnJvbShjYXJkcyk7XG4gIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcbiAgdmFyIGNvbG9ySCA9IFtdOyAvL+e6ouW/g1xuICB2YXIgY29sb3JDID0gW107IC8v5qKF6IqxXG4gIHZhciBjb2xvckQgPSBbXTsgLy/mlrnlnZdcbiAgdmFyIHBvaW50UyA9IFtdOyAvL+m7keahg1xuICB2YXIgcG9pbnRIID0gW107IC8v57qi5b+DXG4gIHZhciBwb2ludEMgPSBbXTsgLy/mooXoirFcbiAgdmFyIHBvaW50RCA9IFtdOyAvL+aWueWdl1xuICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aDtpKyspe1xuICAgIGlmKGNhcmRzW2ldLmNvbG9yID09ICc0Jyl7XG4gICAgICBpZihwb2ludFMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludFMucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9yUy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cblxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICczJyl7XG4gICAgICBpZihwb2ludEguaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludEgucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9ySC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMicpe1xuICAgICAgaWYocG9pbnRDLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRDLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzEnKXtcbiAgICAgIGlmKHBvaW50RC5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50RC5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JELnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBjb2xvciA9IFtjb2xvclMsY29sb3JILGNvbG9yQyxjb2xvckRdO1xuICB2YXIgY29sb3JTdW0gPSBbXTsgICAgLy/mgLvlhbHmnInlh6Dnp43oirHoibIgWzUsMywwLi4uLl1cbiAgZm9yKHZhciBpPTA7aTxjb2xvci5sZW5ndGg7aSsrKXtcbiAgICBpZihjb2xvcltpXS5sZW5ndGggPj0gNSl7XG4gICAgICBjb2xvcltpXS5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiAgICAgICAgcmV0dXJuIGExLnBvaW50IC0gYTIucG9pbnQ7XG4gICAgICB9KVxuICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgfVxuICB9XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBpPTA7aTxjb2xvclN1bS5sZW5ndGg7aSsrKSB7XG4gICAgdmFyIHMgPSBjb2xvclN1bVtpXVxuICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgNSkgPD0gcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgIHZhciBzdWJDYXJkcyA9IHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgNSk7XG4gICAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YVNodW4oc3ViQ2FyZHMpKSB7XG4gICAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgICAgc3ViQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYSkge1xuICAgICAgICAgIGZvcih2YXIgcSA9IDA7cSA8IGNhcmRzLmxlbmd0aDsgcSsrKXtcbiAgICAgICAgICAgIHZhciByID0gY2FyZHNbcV07XG4gICAgICAgICAgICBpZihyID09PSBjYSl7XG4gICAgICAgICAgICAgIGluZGV4cy5wdXNoKHEpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlQb2ludCk7XG4gICAgICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1lbHNle1xuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZHMpO1xuICAgIGlmIChjYXJkcyA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24oYWRmcyl7XG4gICAgICAgIGlmKGFkZnMucG9pbnQgPT0gMTQpe1xuICAgICAgICAgIGFkZnMucG9pbnQgPSAxO1xuICAgICAgICAgIGFkZnMuc2NvcmVzID0gMTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiBLUUNhcmQuZmluZFRvbmdIdWFTaHVuMjAoY2FyZHMpO1xuICAgIH1cbiAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bihjb252ZXJ0ZWRDYXJkcyk7XG4gIH1cbiAgLy9yZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBudWxsO1xufTtcbktRQ2FyZC5maW5kVG9uZ0h1YVNodW4yMCA9IGZ1bmN0aW9uIChjYXJkLCBsZW5ndGggPSA1KSB7XG4gIGlmIChjYXJkLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkKSB8fCBbXTtcbiAgaWYoY2FyZDIwLmxlbmd0aCA8PSAwKXtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIGNhcmRzID0gY2FyZC5rcV9leGNsdWRlcyhjYXJkMjApO1xuXG4gIGNhcmRzID0gQXJyYXkuZnJvbShjYXJkcyk7XG4gIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcbiAgdmFyIGNvbG9ySCA9IFtdOyAvL+e6ouW/g1xuICB2YXIgY29sb3JDID0gW107IC8v5qKF6IqxXG4gIHZhciBjb2xvckQgPSBbXTsgLy/mlrnlnZdcbiAgdmFyIHBvaW50UyA9IFtdOyAvL+m7keahg1xuICB2YXIgcG9pbnRIID0gW107IC8v57qi5b+DXG4gIHZhciBwb2ludEMgPSBbXTsgLy/mooXoirFcbiAgdmFyIHBvaW50RCA9IFtdOyAvL+aWueWdl1xuICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aDtpKyspe1xuICAgIGlmKGNhcmRzW2ldLmNvbG9yID09ICc0Jyl7XG4gICAgICBpZihwb2ludFMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludFMucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9yUy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cblxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICczJyl7XG4gICAgICBpZihwb2ludEguaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludEgucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9ySC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMicpe1xuICAgICAgaWYocG9pbnRDLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRDLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzEnKXtcbiAgICAgIGlmKHBvaW50RC5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50RC5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JELnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBjb2xvciA9IFtjb2xvclMsY29sb3JILGNvbG9yQyxjb2xvckRdO1xuICB2YXIgY29sb3JTdW0gPSBbXTsgICAgLy/mgLvlhbHmnInlh6Dnp43oirHoibIgWzUsMywwLi4uLl1cbiAgZm9yKHZhciBpPTA7aTxjb2xvci5sZW5ndGg7aSsrKXtcbiAgICBpZihjb2xvcltpXS5sZW5ndGggPj0gcGFyc2VJbnQoNSAtIGNhcmQyMC5sZW5ndGgpKXtcbiAgICAgIGNvbG9yW2ldLnNvcnQoZnVuY3Rpb24oYTEsYTIpe1xuICAgICAgICByZXR1cm4gYTEucG9pbnQgLSBhMi5wb2ludDtcbiAgICAgIH0pXG4gICAgICBjb2xvclN1bS5wdXNoKGNvbG9yW2ldKTtcbiAgICB9XG4gIH1cbiAgLy9jYy5sb2coY29sb3JTdW0pXG5cbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBmb3IodmFyIGk9MDtpPGNvbG9yU3VtLmxlbmd0aDtpKyspIHtcbiAgICB2YXIgcyA9IGNvbG9yU3VtW2ldXG4gICAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICAgIHZhciBudW0gPSA1IC0gajtcbiAgICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbnVtKSA8PSBzLmxlbmd0aDsgKytzdGFydCkge1xuICAgICAgICB2YXIgc3ViQ2FyZHMgPSBzLnNsaWNlKHN0YXJ0LCBzdGFydCArIG51bSk7XG4gICAgICAgIHZhciBib29sID0gcGFyc2VJbnQoc3ViQ2FyZHNbbnVtLTFdWydzY29yZXMnXSkgLSBwYXJzZUludChzdWJDYXJkc1swXVsnc2NvcmVzJ10pIDwgNTtcbiAgICAgICAgaWYoYm9vbCl7XG4gICAgICAgICAgbGV0IGluZGV4cyA9IFtdO1xuICAgICAgICAgIHZhciBuZXdDYXJkMjAgPSBjYXJkMjAuc2xpY2UoMCxqKTtcbiAgICAgICAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLmNvbmNhdChuZXdDYXJkMjApO1xuICAgICAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2EpIHtcbiAgICAgICAgICAgIGZvcih2YXIgcSA9IDA7cSA8IGNhcmQubGVuZ3RoOyBxKyspe1xuICAgICAgICAgICAgICB2YXIgciA9IGNhcmRbcV07XG4gICAgICAgICAgICAgIGlmKHIgPT09IGNhKXtcbiAgICAgICAgICAgICAgICBpbmRleHMucHVzaChxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaW5kZXhzLnNvcnQoQXJyYXkuc29ydEJ5TnVtYmVyKTtcblxuICAgICAgICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XG5cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICAvL2NjLmxvZyhyZXN1bHQpXG4gIC8vY2MubG9nKCctLS0tLS0tLTM1NycpXG4gIGlmKHJlc3VsdC5sZW5ndGggPiAwKXtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9ZWxzZXtcbiAgICBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmQpO1xuICAgIGlmIChjYXJkID09PSBjb252ZXJ0ZWRDYXJkcykge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bjIwKGNvbnZlcnRlZENhcmRzKTtcbiAgfVxuICAvL3JldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IG51bGw7XG59O1xuXG4vLyDmib7pk4HmlK9cbi8vIOWmgu+8mltbMSwyLDMsNF1dXG5LUUNhcmQuZmluZFRpZVpoaSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgdmFyIHJlc3VsdCA9ICBLUUNhcmQuX2ZpbmRQb2ludExlbmd0aChjYXJkTW9kZXMsIDQpO1xuICBpZihyZXN1bHQubGVuZ3RoID4gMCl7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuICByZXN1bHQgPSBbXTtcbiAgLy8g5LqU5ZCM5piv5YyF5ZCr6ZOB5pSv55qEXG4gIGxldCB3dVRvbmdJbmRleHNBcnJheSA9IEtRQ2FyZC5maW5kV3VUb25nKGNhcmRNb2Rlcyk7XG4gIGlmICh3dVRvbmdJbmRleHNBcnJheSkge1xuICAgIHd1VG9uZ0luZGV4c0FycmF5LmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XG4gICAgICBsZXQgdGllWmhpSW5kZXhzMCA9IFtpbmRleHNbMF0sIGluZGV4c1sxXSwgaW5kZXhzWzJdLCBpbmRleHNbM11dO1xuICAgICAgbGV0IHRpZVpoaUluZGV4czEgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1syXSwgaW5kZXhzWzRdXTtcbiAgICAgIGxldCB0aWVaaGlJbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbM10sIGluZGV4c1s0XV07XG4gICAgICBsZXQgdGllWmhpSW5kZXhzMyA9IFtpbmRleHNbMF0sIGluZGV4c1syXSwgaW5kZXhzWzNdLCBpbmRleHNbNF1dO1xuICAgICAgbGV0IHRpZVpoaUluZGV4czQgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1szXSwgaW5kZXhzWzRdXTtcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czApO1xuICAgICAgcmVzdWx0LnB1c2godGllWmhpSW5kZXhzMSk7XG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHMyKTtcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czMpO1xuICAgICAgcmVzdWx0LnB1c2godGllWmhpSW5kZXhzNCk7XG4gICAgfSk7XG4gIH1cbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDEwKXtcbiAgICByZXN1bHQgPSByZXN1bHQuc2xpY2UoMCwxMCk7XG4gIH1cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpO1xuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsNCk7XG59O1xuLy/mib7kupTlkIxcbktRQ2FyZC5maW5kV3VUb25nID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICBpZihjYXJkTW9kZXMubGVuZ3RoIDwgNSl7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciByZXN1bHQgPSB0aGlzLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCA1KSB8fCBbXTtcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogS1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDUpO1xufTtcbi8vIOaJvumhuuWtkFxuLy8g5aaC77yaW1sxLCAyLCAzLCA0LCA1XV1cbktRQ2FyZC5maW5kU2h1blppID0gZnVuY3Rpb24gKGNhcmRNb2RlcyxsZW5ndGggPSA1KSB7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGlmKHR5cGVvZihjYXJkTW9kZXNbMF1bJ3BvaW50J10pPT1cInVuZGVmaW5lZFwiKXtcbiAgICBjYXJkTW9kZXMgPSBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZE1vZGVzKTtcbiAgfVxuICAvLyDlhYjmoLnmja7ngrnmlbDljrvph41cbiAgbGV0IHVuaXF1ZUNhcmRzID0gY2FyZE1vZGVzLnVuaXF1ZShmdW5jdGlvbihjYXJkMSwgY2FyZDIpIHtcbiAgICByZXR1cm4gY2FyZDEucG9pbnQgPT0gY2FyZDIucG9pbnQ7XG4gIH0pO1xuICB1bmlxdWVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XG5cbiAgLy8g5aaC5p6c5pyJIEHvvIzliJnlnKjmnIDlkI7mt7vliqAgMTRcbiAgbGV0IGNhcmRBID0gY2FyZE1vZGVzLmZpbmQoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICByZXR1cm4gY2FyZC5wb2ludCA9PSAxO1xuICB9KTtcbiAgaWYgKGNhcmRBKSB7XG4gICAgbGV0IGNhcmRBUGx1cyA9IG5ldyBLUUNhcmQoY2FyZEEpO1xuICAgIGNhcmRBUGx1cy5wb2ludCA9IDE0O1xuICAgIHVuaXF1ZUNhcmRzLnB1c2goY2FyZEFQbHVzKTtcbiAgfVxuXG4gIGxldCByZXN1bHQgPSBbXTtcblxuICAvLyDnlLHkuo7ngrnmlbDmmK/llK/kuIDkuJTljYfluo/vvIzlj6rpnIDopoHkvp3mrKHpgY3ljobliKTmlq3mmK/lkKbmmK/pobrlrZDljbPlj69cbiAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBsZW5ndGgpIDw9IHVuaXF1ZUNhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuICAgIGxldCBzdWJDYXJkcyA9IHVuaXF1ZUNhcmRzLnNsaWNlKHN0YXJ0LCBzdGFydCArIGxlbmd0aCk7XG4gICAgaWYgKEtRQ2FyZC5pc1NodW5aaShzdWJDYXJkcywgbGVuZ3RoKSkge1xuICAgICAgbGV0IGluZGV4cyA9IFtdO1xuICAgICAgc3ViQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgICAgIGxldCBpbmRleCA9IGNhcmRNb2Rlcy5maW5kSW5kZXgoZnVuY3Rpb24gKG9yaWdpbkNhcmQpIHtcblxuICAgICAgICAgIGlmIChjYXJkLnBvaW50ID09IDE0KSB7XG4gICAgICAgICAgICByZXR1cm4gb3JpZ2luQ2FyZC5wb2ludCA9PSAxO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBjYXJkID09PSBvcmlnaW5DYXJkO1xuICAgICAgICB9KTtcbiAgICAgICAgaW5kZXhzLnB1c2goaW5kZXgpO1xuICAgICAgfSk7XG5cbiAgICAgIGluZGV4cy5zb3J0KEFycmF5LnNvcnRCeU51bWJlcik7XG4gICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgIH1cbiAgfVxuXG4gIC8vIOWkhOeQhueCueaVsOmHjeWkjeeahOaDheWGtVxuICAvLyDmr5TlpoIgQSBBIEsgUSBKIDEwIOi/meenjSBcbiAgbGV0IHJlcGVhdEluZGV4c0FycmF5ID0gS1FDYXJkLl9maW5kUmVwZWF0UG9pbnRJbmRleHNBcnJheShyZXN1bHQsIGNhcmRNb2Rlcyk7XG4gIHJlcGVhdEluZGV4c0FycmF5LmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XG4gICAgcmVzdWx0LnVuc2hpZnQoaW5kZXhzKTtcbiAgfSk7XG5cbiAgcmVzdWx0LnNvcnQoZnVuY3Rpb24gKGFycjEsIGFycjIpIHtcbiAgICByZXR1cm4gYXJyMVswXSAtIGFycjJbMF07XG4gIH0pO1xuXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IEtRQ2FyZC5maW5kU2h1blppMjAoY2FyZE1vZGVzKTtcbn07XG5LUUNhcmQuZmluZFNodW5aaTIwID0gZnVuY3Rpb24gKGNhcmRNb2RlcyAsbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkTW9kZXMpO1xuICBpZihjYXJkMjAubGVuZ3RoIDw9IDApe1xuICAgIHJldHVybiBbXTtcbiAgfVxuICB2YXIgY2FyZHMgPSBjYXJkTW9kZXMua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgLy8g5YWI5qC55o2u54K55pWw5Y676YeNXG4gIHZhciBuZXdBcnIgPSBbXTtcbiAgdmFyIG5ld0FycnMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkcy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChuZXdBcnJzLmluZGV4T2YoY2FyZHNbaV1bJ3BvaW50J10pID09IC0xKSB7XG4gICAgICBuZXdBcnIucHVzaChjYXJkc1tpXSk7XG4gICAgICBuZXdBcnJzLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgIH1cbiAgfVxuXG4gIG5ld0Fyci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICByZXR1cm4gbjEucG9pbnQgLSBuMi5wb2ludDtcbiAgfSk7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICB2YXIgbnVtID0gbGVuZ3RoIC0gajtcbiAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gbmV3QXJyLmxlbmd0aDsgKytzdGFydCkge1xuICAgICAgdmFyIHN1YkNhcmRzID0gbmV3QXJyLnNsaWNlKHN0YXJ0LCBzdGFydCArIG51bSk7XG4gICAgICB2YXIgYm9vbCA9IHBhcnNlSW50KHN1YkNhcmRzW251bS0xXVsncG9pbnQnXSkgLSBwYXJzZUludChzdWJDYXJkc1swXVsncG9pbnQnXSkgPCBsZW5ndGg7XG4gICAgICBpZihib29sKXtcbiAgICAgICAgbGV0IGluZGV4cyA9IFtdO1xuICAgICAgICB2YXIgbmV3Q2FyZDIwID0gY2FyZDIwLnNsaWNlKDAsaik7XG4gICAgICAgIHN1YkNhcmRzID0gc3ViQ2FyZHMuY29uY2F0KG5ld0NhcmQyMCk7XG4gICAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgICAgICAgIGZvcih2YXIgcSA9IDA7cSA8IGNhcmRNb2Rlcy5sZW5ndGg7IHErKyl7XG4gICAgICAgICAgICB2YXIgciA9IGNhcmRNb2Rlc1txXTtcbiAgICAgICAgICAgIGlmKHIgPT09IGNhcmQpe1xuICAgICAgICAgICAgICBpbmRleHMucHVzaChxKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGluZGV4cy5zb3J0KEFycmF5LnNvcnRCeU51bWJlcik7XG4gICAgICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1lbHNle1xuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZE1vZGVzKTtcbiAgICBpZiAoY2FyZE1vZGVzID09PSBjb252ZXJ0ZWRDYXJkcykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gS1FDYXJkLmZpbmRTaHVuWmkyMChjb252ZXJ0ZWRDYXJkcyk7XG4gIH1cbn07XG5LUUNhcmQuX2ZpbmRSZXBlYXRQb2ludEluZGV4c0FycmF5ID0gZnVuY3Rpb24oaW5kZXhzQXJyYXksIG9yaWdpbkNhcmRzKSB7XG4gIGxldCByZXBlYXRJbmRleHNBcnJheSA9IFtdO1xuICBpbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgIGxldCBjYXJkcyA9IGluZGV4cy5tYXAoZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgIHJldHVybiBvcmlnaW5DYXJkc1tpbmRleF07XG4gICAgfSk7XG5cbiAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQsIGluZGV4KSB7XG4gICAgICBsZXQgb3JpZ2luSW5kZXggPSBvcmlnaW5DYXJkcy5maW5kSW5kZXgoZnVuY3Rpb24ob3JpZ2luQ2FyZCkge1xuICAgICAgICBpZih0eXBlb2YoY2FyZCkgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3JpZ2luQ2FyZCAhPT0gY2FyZCAmJiBvcmlnaW5DYXJkLnBvaW50ID09IGNhcmQucG9pbnQpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9KTtcblxuICAgICAgaWYgKG9yaWdpbkluZGV4IDwgMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCByZXBlYXRJbmRleHMgPSBpbmRleHMuc2xpY2UoKTtcbiAgICAgIHJlcGVhdEluZGV4c1tpbmRleF0gPSBvcmlnaW5JbmRleDtcbiAgICAgIHJlcGVhdEluZGV4c0FycmF5LnB1c2gocmVwZWF0SW5kZXhzKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgcmV0dXJuIHJlcGVhdEluZGV4c0FycmF5O1xufTtcblxuLy8g5om+5ZCM6IqxXG4vLyDlpoLvvJpbWzEsIDIsIDMsIDQsIDVdXVxuS1FDYXJkLmZpbmRUb25nSHVhID0gZnVuY3Rpb24gKGNhcmRNb2RlcywgbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIGxldCBjYXJkcyA9IEFycmF5LmZyb20oY2FyZE1vZGVzKTtcbiAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuXG4gIGxldCByZXN1bHQgPSBbXTtcbiAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBsZW5ndGgpIDw9IGNhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuICAgIGxldCBzdWJDYXJkcyA9IGNhcmRzLnNsaWNlKHN0YXJ0LCBzdGFydCArIGxlbmd0aCk7XG4gICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWEoc3ViQ2FyZHMsIGxlbmd0aCkpIHtcbiAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgICAgICBsZXQgaW5kZXggPSBjYXJkTW9kZXMuZmluZEluZGV4KGZ1bmN0aW9uIChvcmlnaW5DYXJkKSB7XG4gICAgICAgICAgcmV0dXJuIGNhcmQgPT09IG9yaWdpbkNhcmQ7XG4gICAgICAgIH0pO1xuICAgICAgICAgIGluZGV4cy5wdXNoKGluZGV4KTtcbiAgICAgIH0pO1xuICAgICAgLy9pbmRleHMgPSBpbmRleHMubGVuZ3RoID4gNSA/IGluZGV4cy5zcGxpY2UoMSwxKSA6IGluZGV4cztcbiAgICAgIGluZGV4cy5zb3J0KEFycmF5LnNvcnRCeU51bWJlcik7XG4gICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBLUUNhcmQuZmluZFRvbmdIdWEyMChjYXJkTW9kZXMpO1xufTtcbktRQ2FyZC5maW5kVG9uZ0h1YTIwID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IDUpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZE1vZGVzKTtcbiAgaWYoY2FyZDIwLmxlbmd0aCA8PSAwKXtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIGNhcmRzID0gY2FyZE1vZGVzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gIC8vIOWFiOagueaNrueCueaVsOWOu+mHjVxuICBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlDb2xvcik7XG5cbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xuICAgIHZhciBudW0gPSA1IC0gajtcbiAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gY2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICB2YXIgc3ViQ2FyZHMgPSBjYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuICAgICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWEoc3ViQ2FyZHMsIG51bSkpIHtcbiAgICAgICAgbGV0IGluZGV4cyA9IFtdO1xuICAgICAgICB2YXIgbmV3Q2FyZDIwID0gY2FyZDIwLnNsaWNlKDAsaik7XG4gICAgICAgIHN1YkNhcmRzID0gc3ViQ2FyZHMuY29uY2F0KG5ld0NhcmQyMCk7XG4gICAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgICAgICAgIGZvcih2YXIgcSA9IDA7cSA8IGNhcmRNb2Rlcy5sZW5ndGg7IHErKyl7XG4gICAgICAgICAgICB2YXIgciA9IGNhcmRNb2Rlc1txXTtcbiAgICAgICAgICAgIGlmKHIgPT09IGNhcmQpe1xuICAgICAgICAgICAgICBpbmRleHMucHVzaChxKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGluZGV4cy5zb3J0KEFycmF5LnNvcnRCeU51bWJlcik7XG4gICAgICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XG59O1xuXG5LUUNhcmQuZmluZEh1THUgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGxldCBsZW5ndGggPSA1O1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG5cbiAgdmFyIHBfMz1LUUNhcmQuZmluZFNhblRpYW8oY2FyZE1vZGVzKTtcbiAgdmFyIHBfND1LUUNhcmQuZmluZFRpZVpoaShjYXJkTW9kZXMpO1xuICB2YXIgcDI9S1FDYXJkLmZpbmREdWlaaShjYXJkTW9kZXMpIHx8IFtdO1xuICAvL3ZhciBwXzMgPSAgdGhpcy5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgMykgfHwgW107XG4gIC8vdmFyIHBfNCA9IHRoaXMuX2ZpbmRQb2ludExlbmd0aChjYXJkTW9kZXMsIDQpIHx8IFtdO1xuICAvL3ZhciBwMiA9IHRoaXMuX2ZpbmRQb2ludExlbmd0aChjYXJkTW9kZXMsIDIpIHx8IFtdO1xuICBpZihwMi5sZW5ndGggPD0gMCl7XG4gICAgaWYgKHBfMykge1xuICAgICAgcF8zLmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XG4gICAgICAgIGxldCBzYW5UaWFvSW5kZXhzMCA9IFtpbmRleHNbMF0sIGluZGV4c1sxXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMxID0gW2luZGV4c1swXSwgaW5kZXhzWzJdXTtcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHMzID0gW2luZGV4c1sxXSwgaW5kZXhzWzJdXTtcbiAgICAgICAgcDIucHVzaChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICAgIC8vcDIudW5zaGlmdChzYW5UaWFvSW5kZXhzMSk7XG4gICAgICAgIHAyLnB1c2goc2FuVGlhb0luZGV4czMpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHBfNCkge1xuICAgICAgcF80LmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XG4gICAgICAgIGxldCBzYW5UaWFvSW5kZXhzMCA9IFtpbmRleHNbMF0sIGluZGV4c1sxXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMxID0gW2luZGV4c1swXSwgaW5kZXhzWzJdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czIgPSBbaW5kZXhzWzBdLCBpbmRleHNbM11dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMV0sIGluZGV4c1syXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHM0ID0gW2luZGV4c1sxXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHM2ID0gW2luZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgcDIucHVzaChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICAgIC8vcDIudW5zaGlmdChzYW5UaWFvSW5kZXhzMSk7XG4gICAgICAgIC8vcDIudW5zaGlmdChzYW5UaWFvSW5kZXhzMik7XG4gICAgICAgIC8vcDIudW5zaGlmdChzYW5UaWFvSW5kZXhzMyk7XG4gICAgICAgIC8vcDIudW5zaGlmdChzYW5UaWFvSW5kZXhzNCk7XG4gICAgICAgIHAyLnB1c2goc2FuVGlhb0luZGV4czYpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cblxuXG4gIGlmICgocDIgPT0gbnVsbCkgfHwgKHBfMyA9PSBudWxsKSkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICB2YXIgdHJlc3VsdD1bXVxuICBwMi5mb3JFYWNoKGZ1bmN0aW9uIChpXzMpIHtcbiAgICB2YXIgcz1pXzM7XG4gICAgcF8zLmZvckVhY2goZnVuY3Rpb24gKGlfMikge1xuICAgICAgcyA9IGlfMy5jb25jYXQoaV8yKTtcbiAgICAgIGZvcih2YXIgaSA9MDtpPHMubGVuZ3RoLTE7aSsrKXtcbiAgICAgICAgdmFyIGluZGV4ID0gc1tpXTtcbiAgICAgICAgZm9yKHZhciBqID1pKzE7ajxzLmxlbmd0aDtqKyspe1xuICAgICAgICAgIGlmKGluZGV4ID09IHNbal0pIHtcbiAgICAgICAgICAgIHMgPSBudWxsO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKHMgPT0gbnVsbCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZihzICE9PSBudWxsKXtcbiAgICAgICAgdHJlc3VsdC51bnNoaWZ0KHMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiAgaWYodHJlc3VsdC5sZW5ndGggPiAxMCl7XG4gICAgdHJlc3VsdCA9IHRyZXN1bHQuc2xpY2UoMCwxMCk7XG4gIH1cbiAgcmV0dXJuIHRyZXN1bHQubGVuZ3RoID4gMCA/IHRyZXN1bHQgOiBLUUNhcmQuZmluZEh1THUyMChjYXJkTW9kZXMpO1xufTtcbktRQ2FyZC5maW5kSHVMdTIwID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICBsZXQgbGVuZ3RoID0gNTtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZE1vZGVzKSB8fCBbXTtcbiAgaWYoY2FyZDIwLmxlbmd0aCA8PSAwKXtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIHBfMz1LUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMyk7XG4gIHZhciBwXzQ9S1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDQpO1xuICB2YXIgcF8yPUtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2RlcywyKTtcbiAgaWYocF8yPT1udWxsKXtcbiAgICBwXzI9W107XG4gIH1cbiAgaWYgKHBfMykge1xuICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdXTtcbiAgICAgIGxldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMV0sIGluZGV4c1syXV07XG4gICAgICBwXzIudW5zaGlmdChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICBwXzIudW5zaGlmdChzYW5UaWFvSW5kZXhzMyk7XG4gICAgfSk7XG4gIH1cblxuICBpZiAocF80KSB7XG4gICAgcF80LmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XG4gICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV1dO1xuICAgICAgbGV0IHNhblRpYW9JbmRleHM2ID0gW2luZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgIHBfMi51bnNoaWZ0KHNhblRpYW9JbmRleHMwKTtcbiAgICAgIHBfMi51bnNoaWZ0KHNhblRpYW9JbmRleHM2KTtcbiAgICB9KTtcbiAgfVxuXG4gIGlmICgocF8yID09IG51bGwpIHx8IChwXzMgPT0gbnVsbCkpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIHRyZXN1bHQ9W11cbiAgcF8yLmZvckVhY2goZnVuY3Rpb24gKGlfMykge1xuICAgIHZhciBzPWlfMztcbiAgICBwXzMuZm9yRWFjaChmdW5jdGlvbiAoaV8yKSB7XG4gICAgICBzID0gaV8zLmNvbmNhdChpXzIpO1xuICAgICAgZm9yKHZhciBpID0wO2k8cy5sZW5ndGgtMTtpKyspe1xuICAgICAgICB2YXIgaW5kZXggPSBzW2ldO1xuICAgICAgICBmb3IodmFyIGogPWkrMTtqPHMubGVuZ3RoO2orKyl7XG4gICAgICAgICAgaWYoaW5kZXggPT0gc1tqXSkge1xuICAgICAgICAgICAgcyA9IG51bGw7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYocyA9PSBudWxsKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmKHMgIT09IG51bGwpe1xuICAgICAgICB0cmVzdWx0LnVuc2hpZnQocyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICBpZih0cmVzdWx0Lmxlbmd0aCA+IDEwKXtcbiAgICB0cmVzdWx0ID0gdHJlc3VsdC5zbGljZSgwLDEwKTtcbiAgfVxuICByZXR1cm4gdHJlc3VsdC5sZW5ndGggPiAwID8gdHJlc3VsdCA6IFtdO1xufTtcblxuS1FDYXJkLmZpbmRHdWlQYWkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzLG51bUJlciA9IDEpIHtcbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZE1vZGVzKS5tYXAoZnVuY3Rpb24oY2FyZCl7Ly/lvpfliLDprLzniYznmoTntKLlvJVcbiAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkTW9kZXMubGVuZ3RoOyBxKyspe1xuICAgICAgdmFyIHIgPSBjYXJkTW9kZXNbcV07XG4gICAgICBpZihyID09PSBjYXJkKXtcbiAgICAgICAgcmV0dXJuIHE7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgaWYoY2FyZDIwLmxlbmd0aCA8PSAwKXtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xuICAgIHZhciBudW0gPSBudW1CZXItajsvL+mZpOmsvOeJjOWkliDmiJHlupTor6Xmib7lpJrlsJHlvKDniYzljLnphY1cbiAgICB2YXIgaW5kZXhzID0gS1FDYXJkLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCBudW0pIHx8IFtdO1xuICAgIGZvcih2YXIgdCA9IDA7dCA8IGluZGV4cy5sZW5ndGg7IHQrKykge1xuICAgICAgaWYobnVtQmVyID09IDIpey8v5piv5a+55a2Q55qE5pe25YCZ5oqK6ay854mM5ZKM5Y2V5byg5Yy56YWN6YO95b6q546v5LiA6YGNXG4gICAgICAgIGZvcih2YXIgbyA9IDA7byA8IGNhcmQyMC5sZW5ndGg7KytvKXtcbiAgICAgICAgICB2YXIgcyA9IGluZGV4c1t0XS5jb25jYXQoY2FyZDIwW29dKTtcbiAgICAgICAgICBpZihzLmxlbmd0aCA9PSBudW1CZXIpe1xuICAgICAgICAgICAgcmVzdWx0LnB1c2gocyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHMgPSBpbmRleHNbdF0uY29uY2F0KGNhcmQyMC5zbGljZSgwLGopKTsvL+S+neasoeebuOWKoOmsvOeJjOesrOS4gOasoeWKoOS4gOW8oCDpgJLlop5cbiAgICAgICAgaWYocy5sZW5ndGggPT0gbnVtQmVyKXtcbiAgICAgICAgICByZXN1bHQucHVzaChzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZihyZXN1bHQubGVuZ3RoID4gMTApe1xuICAgIHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLDEwKTtcbiAgfVxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7Ly/ljrvph41cbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XG59O1xuXG5LUUNhcmQucmVwZWF0ID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICBmb3IodmFyIGkgPTA7aTxyZXN1bHQubGVuZ3RoO2krKyl7XG4gICAgdmFyIGluZGV4ID0gcmVzdWx0W2ldO1xuXG4gICAgdmFyIG5ld0F5eSA9IFtdO1xuICAgIGZvcih2YXIgbyA9IDA7byA8IGluZGV4Lmxlbmd0aDtvKyspey8v5pyJ6YeN5aSN5bmy5o6J5L2gXG4gICAgICBpZihuZXdBeXkuaW5kZXhPZihpbmRleFtvXSkgPT0gLTEpe1xuICAgICAgICBuZXdBeXkucHVzaChpbmRleFtvXSk7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgcmVzdWx0LnNwbGljZShpLDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IodmFyIGogPWkrMTtqPHJlc3VsdC5sZW5ndGgtMTtqKyspe1xuICAgICAgdmFyIHMgPSByZXN1bHRbal07XG4gICAgICB2YXIgalN0cmluZyA9ICcnO1xuICAgICAgdmFyIGlTdHJpbmcgPSAnJztcbiAgICAgIGZvcih2YXIgciA9IDA7ciA8IHMubGVuZ3RoO3IrKyl7XG4gICAgICAgICAgalN0cmluZyA9IGpTdHJpbmcgKyBzW3JdO1xuICAgICAgICAgIGlTdHJpbmcgPSBpU3RyaW5nICsgaW5kZXhbcl07XG4gICAgICB9XG4gICAgICBpZihqU3RyaW5nID09IGlTdHJpbmcpey8v5pyJ6YeN5aSN5bmy5o6J5L2gXG4gICAgICAgIHJlc3VsdC5zcGxpY2UoaSwxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cblxuS1FDYXJkLnRlc3RGaW5kID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICB2YXIgV3VUb25nID0gS1FDYXJkLmZpbmRXdVRvbmcoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIFRvbmdIdWFTaHVuID0gS1FDYXJkLmZpbmRUb25nSHVhU2h1bihjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgVGllWmhpID0gS1FDYXJkLmZpbmRUaWVaaGkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIEh1THUgPSBLUUNhcmQuZmluZEh1THUoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIFRvbmdIdWEgPSBLUUNhcmQuZmluZFRvbmdIdWEoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIFNodW5aaSA9IEtRQ2FyZC5maW5kU2h1blppKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBTYW5UaWFvID0gS1FDYXJkLmZpbmRTYW5UaWFvKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBMaWFEdWkgPSBLUUNhcmQuZmluZExpYUR1aShjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgRHVpWmkgPSBLUUNhcmQuZmluZER1aVppKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciByZXN1bHQgPSBbXG4gICAgV3VUb25nLFxuICAgIFRvbmdIdWFTaHVuLFxuICAgIFRpZVpoaSxcbiAgICBIdUx1LFxuICAgIFRvbmdIdWEsXG4gICAgU2h1blppLFxuICAgIFNhblRpYW8sXG4gICAgTGlhRHVpLFxuICAgIER1aVppLFxuICBdXG4gIHJldHVybiByZXN1bHQ7XG59O1xuIiwiLy8g54mM54K55pWw5biu5Yqp57G7XG4vLyDnlKjmnaXorqHnrpfkuIDkuKrniYzmlbDnu4TlhoXnmoTnm7jlkIzngrnmlbDnmoTniYznmoTlvKDmlbBcbnZhciBLUUNhcmRQb2ludHNIZWxwZXIgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB0aGlzLnBvaW50TnVtYmVycyA9IHt9O1xuICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgbGV0IHBvaW50ID0gY2FyZC5wb2ludDtcbiAgICAgICAgdmFyIG51bWJlciA9IHRoaXMucG9pbnROdW1iZXJzW3BvaW50XSB8fCAwO1xuICAgICAgICB0aGlzLnBvaW50TnVtYmVyc1twb2ludF0gPSBudW1iZXIgKyAxO1xuICAgIH0uYmluZCh0aGlzKSk7XG59O1xuXG4vLyDnm7jlkIzngrnmlbDniYznmoTmnIDlpKfmlbDph49cbktRQ2FyZFBvaW50c0hlbHBlci5wcm90b3R5cGUubWF4TnVtYmVyID0gZnVuY3Rpb24gKCkge1xuICB2YXIgcmVzdWx0ID0gMDtcbiAgZm9yIChsZXQgcHJvcCBpbiB0aGlzLnBvaW50TnVtYmVycykge1xuICAgIGxldCBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twcm9wXTtcbiAgICAgIC8vaWYobnVtYmVyIDwgMjApe1xuICAgICAgICAgIHJlc3VsdCA9IE1hdGgubWF4KG51bWJlciwgcmVzdWx0KTtcbiAgICAgIC8vfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IEtRQ2FyZFBvaW50c0hlbHBlcjtcblxuLyp2YXIgY2FyZHMgPSBbXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjJ9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoyfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjR9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo2fSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjh9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo4fSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMH0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEyfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTJ9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxNH1cbl07XG52YXIgdGVzdCA9IG5ldyBLUUNhcmRQb2ludHNTYW1lKGNhcmRzKTtcbmNvbnNvbGUubG9nKHRlc3QpOyovXG4iLCJsZXQgSGVscGVyID0ge1xuICBsb2FkQ2FyZFNwcml0ZUZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgdGhpcy5fbG9hZENhcmRGcmFtZShjYXJkTmFtZSwgY2FsbGJhY2spO1xuICB9LFxuXG4gIHNldENhcmRTcHJpdGVGcmFtZTogZnVuY3Rpb24gKHNwcml0ZSwgY2FyZE5hbWUpIHtcbiAgICB0aGlzLmxvYWRDYXJkU3ByaXRlRnJhbWUoY2FyZE5hbWUsIGZ1bmN0aW9uIChzcHJpdGVGcmFtZSkge1xuICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG4gICAgfSk7XG4gIH0sXG5cbiAgX2NhcmRGdWxsTmFtZTogZnVuY3Rpb24gKGNhcmRTaG9ydE5hbWUpIHtcbiAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xuICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChcInB1YmxpYy1waWMtY2FyZC1wb2tlclwiKSkge1xuICAgICAgY2FyZE5hbWUgPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xuICAgIH1cblxuICAgIHJldHVybiBjYXJkTmFtZTtcbiAgfSxcblxuICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaykge1xuICAgIGNjLmFzc2VydChjYWxsYmFjayk7XG5cbiAgICBjYy5sb2FkZXIubG9hZFJlcyhcInBsYXkvQ2FyZFR5cGVDb21iaW5lL3BvY2tMaXN0XCIsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICBjYWxsYmFjayhudWxsLCBlcnIpXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUpO1xuICAgICAgdmFyIGZyYW1lID0gYXRsYXMuZ2V0U3ByaXRlRnJhbWUoY2FyZE5hbWUpO1xuICAgICAgY2FsbGJhY2soZnJhbWUpO1xuICAgIH0uYmluZCh0aGlzKSk7XG4gIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEhlbHBlcjtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY29uc3QgS1FDYXJkRmluZFR5cGVFeHRlbnNpb24gPSByZXF1aXJlKCdLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbicpO1xuY29uc3QgS1FDYXJkQ29sb3JzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkQ29sb3JzSGVscGVyJyk7XG5jb25zdCBLUUNhcmRTY29yZXRzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkU2NvcmV0c0hlbHBlcicpO1xuY29uc3QgR2V0Q2FyZFBvaW50c1NhbWVDb3VudCA9IHJlcXVpcmUoJ0dldENhcmRQb2ludHNTYW1lQ291bnQnKTtcbmNvbnN0IEtRQ2FyZFBvaW50c0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFBvaW50c0hlbHBlcicpO1xuXG5LUUNhcmQuc2NvcmVPZkNhcmRzID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gIGlmKGNhcmRzID09IG51bGwgfHwgY2FyZHMubGVuZ3RoID09IG51bGwpIHtcbiAgICBjYXJkcyA9IFtdO1xuICB9XG5cbiAgdmFyIGlzVG91ID0gY2FyZHMubGVuZ3RoID09IDM7XG4gIGxldCB0eXBlU2NvcmUgPSBLUUNhcmQuX3R5cGVTY29yZU9mQ2FyZHMoY2FyZHMpO1xuICB2YXIgY2FsZUNhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BKGNhcmRzLnNsaWNlKCkpO1xuICBjYWxlQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcbiAgICBpZihjYXJkLnNjb3JlcyA9PSAxKXtcbiAgICAgIGNhcmQuc2NvcmVzID0gMTQ7XG4gICAgfVxuICB9KVxuICAvL2NhbGVDYXJkcyA9IEtRQ2FyZC5Tb3J0KGNhbGVDYXJkcyk7XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhbGVDYXJkcyk7XG4gIHZhciBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRTY29yZXRzSGVscGVyKGNhbGVDYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApKTtcbiAgdmFyIG1heE51bSA9IHBvaW50SGVscGVyLm1heE51bWJlcigpLyotY2FyZDIwLmxlbmd0aCA9PSAwID8gMTogcG9pbnRIZWxwZXIubWF4TnVtYmVyKCktY2FyZDIwLmxlbmd0aCovO1xuXG4gIHZhciBtYXhTY29yZSA9IDA7Ly/ojrflj5bpmaTprLzniYzlpJbmnIDlpKfnmoTnmoTngrnmlbBcbiAgZm9yKHZhciBpIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIGlmIChwYXJzZUludChpKSA+IG1heFNjb3JlICYmIHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tpXSA9PSBtYXhOdW0pIHtcbiAgICAgIG1heFNjb3JlID0gcGFyc2VJbnQoaSk7XG4gICAgfVxuICB9XG4gIGNhbGVDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe1xuICAgIGlmKGNhcmQuc2NvcmVzID49IDIwKXtcbiAgICAgIGNhcmQuc2NvcmVzID0gbWF4U2NvcmU7XG4gICAgfVxuICB9KVxuICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcbiAgICBjYXJkLnNjb3JlcyA9IG1heFNjb3JlO1xuICB9KVxuICAvL2NjLmxvZyhtYXhOdW0pXG4gIC8vY2MubG9nKG1heFNjb3JlKVxuICAvL2NjLmxvZyhjYWxlQ2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKSlcbiAgLy9jYy5sb2coJy0tLS0zNScpXG4gIGNhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcbiAgaWYodHlwZVNjb3JlID09IDkwMDAwMDAwMDAwMDAwMDApe1xuICAgIC8v5LqU5ZCMXG4gICAgY2FsZUNhcmRzLnNvcnQoZnVuY3Rpb24oYTEsYTIpe1xuICAgICAgcmV0dXJuIGEyLnNjb3JlcyAtIGExLnNjb3JlcztcbiAgICB9KTtcbiAgICB2YXIgdG90YWxWYWx1ZSA9IFwiXCI7XG4gICAgLy92YXIgdG90YWxDb2xvciA9IFwiXCI7XG4gICAgZm9yKHZhciBpIGluIGNhbGVDYXJkcykge1xuICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbaV0uc2NvcmVzO1xuICAgICAgLy92YXIgYyA9IGNhbGVDYXJkc1tpXS5jb2xvcjtcbiAgICAgIHRvdGFsVmFsdWUgPSAocGFyc2VJbnQocykgPj0gMTAgPyBzIDogXCIwXCIrcykrdG90YWxWYWx1ZTtcbiAgICAgIC8vdG90YWxDb2xvciA9IGMrdG90YWxDb2xvcjtcbiAgICB9XG4gICAgLy90b3RhbFZhbHVlID0gdG90YWxWYWx1ZSt0b3RhbENvbG9yO1xuICAgIC8vY2MubG9nKHRvdGFsVmFsdWUpXG4gICAgLy9jYy5sb2cocGFyc2VJbnQodG90YWxWYWx1ZSkpXG4gICAgLy9jYy5sb2codHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpKVxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxWYWx1ZSk7XG4gIH1cbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gODAwMDAwMDAwMDAwMDAwMCkge1xuICAgIC8v5ZCM6Iqx6aG65q+U5pyA5aSn55qE6YKj5byg77yM5aaC5p6c5Lik5byg55u45ZCM6YKj5bCx5piv55u45ZCMXG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApey8v5pyJ6ay854mM55qE5pe25YCZ6KaB5pS55Y+Y6ay854mM55qE5YiG5pWwXG4gICAgICBjYWxlQ2FyZHMgPSBLUUNhcmQuX2NoYW5nZUNhcmRTY29ycyhjYWxlQ2FyZHMpO1xuICAgIH1cbiAgICB2YXIgdG90YWxWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciBpIGluIGNhbGVDYXJkcykge1xuICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbaV0uc2NvcmVzO1xuICAgICAgdG90YWxWYWx1ZSA9IChwYXJzZUludChzKSA+PSAxMCA/IHMgOiBcIjBcIitzKSt0b3RhbFZhbHVlO1xuICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbaV0uY29sb3I7Ly/niYzoibJcbiAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuICAgIH1cbiAgICBpZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpO1xuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxWYWx1ZSArIHZhbHVlQ29sb3IpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDcwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+mTgeaUryzmib7lh7rpgqPlm5vlvKDmmK/ku4DkuYjniYxcblxuICAgIHZhciBzdHIgPSBcIlwiO1xuICAgIHZhciBvbmVWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciB3IGluIGNhbGVDYXJkcykge1xuICAgICAgaWYobWF4U2NvcmUgPT0gY2FsZUNhcmRzW3ddLnNjb3Jlcyl7Ly/kuInmnaFcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XG5cbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yOy8v54mM6ImyXG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIG9uZVZhbHVlQ29sb3IgPSBjICsgb25lVmFsdWVDb2xvcjsvL+eJjOiJslxuXG4gICAgICB9XG4gICAgfVxuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vdmFyIHF3ZSA9ICcnO1xuICAgIC8vcXdlID0gb25lVmFsdWVDb2xvci5zdWJzdHIoMCxvbmVWYWx1ZUNvbG9yLmxlbmd0aCAtMSk7XG4gICAgLy9vbmVWYWx1ZUNvbG9yID0gb25lVmFsdWVDb2xvci5zdWJzdHIob25lVmFsdWVDb2xvci5sZW5ndGggLTEpO1xuICAgIC8vc3RyID0gc3RyK29uZVZhbHVlICsgb25lVmFsdWVDb2xvciArIHZhbHVlQ29sb3IgKyBxd2U7XG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDYwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+iRq+iKplxuICAgIHZhciBzdHIgPSBcIlwiO1xuICAgIHZhciBvbmVWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciB3IGluIGNhbGVDYXJkcykge1xuICAgICAgaWYobWF4U2NvcmUgPT0gY2FsZUNhcmRzW3ddLnNjb3Jlcyl7Ly/kuInmnaFcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XG5cbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yOy8v54mM6ImyXG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIG9uZVZhbHVlQ29sb3IgPSBjICsgb25lVmFsdWVDb2xvcjsvL+eJjOiJslxuXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYoaXNUb3Upe1xuICAgICAgb25lVmFsdWUgPSBvbmVWYWx1ZSsnMDAwMCc7XG4gICAgICBvbmVWYWx1ZUNvbG9yID0gb25lVmFsdWVDb2xvcisnMDAnO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0citvbmVWYWx1ZSk7XG4gICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0citvbmVWYWx1ZSk7XG4gICAgLy9zdHIgPSBzdHIrb25lVmFsdWUgKyB2YWx1ZUNvbG9yICsgb25lVmFsdWVDb2xvcjtcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcblxuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDUwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+WQjOiKsSzmnInlj6/og73pnIDopoHmr5Q15byg54mMXG4gICAgdmFyIHRvdGFsU2NvcmUgPSBcIlwiO1xuICAgIHZhciB0b3RhbENvbG9yID0gXCJcIjtcbiAgICAvL3ZhciBjb2xvcnMgPSAwOy8v6I635Y+W54mM55qE57G75Z6L6aKc6ImyXG4gICAgLy9mb3IodmFyIGkgaW4gY2FsZUNhcmRzKSB7XG4gICAgLy8gIGlmKHBhcnNlSW50KGNhbGVDYXJkc1tpXS5wb2ludCkgPCAyMCl7XG4gICAgLy8gICAgY29sb3JzID0gcGFyc2VJbnQoY2FsZUNhcmRzW2ldLmNvbG9yKTtcbiAgICAvLyAgICBicmVhaztcbiAgICAvLyAgfVxuICAgIC8vfVxuXG4gICAgZm9yKHZhciBpIGluIGNhbGVDYXJkcykge1xuICAgICAgdmFyIHBhaVBvaW50ID0gcGFyc2VJbnQoY2FsZUNhcmRzW2ldLnBvaW50KTtcbiAgICAgIHZhciBjb2xvcnMgPSBwYXJzZUludChjYWxlQ2FyZHNbaV0ucG9pbnQpIDwgMjAgPyBjYWxlQ2FyZHNbaV0uY29sb3I6IDU7XG4gICAgICB0b3RhbENvbG9yID0gY29sb3JzICsgdG90YWxDb2xvcjtcbiAgICAgIHRvdGFsU2NvcmUgPSAocGFpUG9pbnQ+PTEwID8gcGFpUG9pbnQgOiBcIjBcIitwYWlQb2ludCkrdG90YWxTY29yZTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFNjb3JlKTtcbiAgICAvL2lmKGNjLmh1YVNlID09IDApIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxTY29yZSk7XG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsU2NvcmUrdG90YWxDb2xvcik7XG4gIH1cbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gNDAwMDAwMDAwMDAwMDAwMCkge1xuICAgIC8v6aG65a2QXG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApey8v5pyJ6ay854mM55qE5pe25YCZ6KaB5pS55Y+Y6ay854mM55qE5YiG5pWwXG4gICAgICBjYWxlQ2FyZHMgPSBLUUNhcmQuX2NoYW5nZUNhcmRTY29ycyhjYWxlQ2FyZHMpO1xuICAgIH1cbiAgICB2YXIgdG90YWxWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciBpIGluIGNhbGVDYXJkcykge1xuICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbaV0uc2NvcmVzO1xuICAgICAgdG90YWxWYWx1ZSA9IChwYXJzZUludChzKSA+PSAxMCA/IHMgOiBcIjBcIitzKSt0b3RhbFZhbHVlO1xuXG4gICAgICB2YXIgYyA9IGNhbGVDYXJkc1tpXS5jb2xvcjsvL+eJjOiJslxuICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yOy8v54mM6ImyXG4gICAgfVxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxWYWx1ZSk7XG4gICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpO1xuICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlICsgdmFsdWVDb2xvcik7XG4gIH1cbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gMzAwMDAwMDAwMDAwMDAwMCkge1xuICAgIC8v5LiJ5p2h77yM5om+5Ye65piv5ZOq5byg54mM5pyJM+W8oFxuICAgIC8vY2FsZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnQpO1xuICAgIHZhciBzdHIgPSBcIlwiO1xuICAgIHZhciBvbmVWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IyMCA9IFwiXCI7Ly/niYzoibJcbiAgICBmb3IodmFyIHcgaW4gY2FsZUNhcmRzKSB7XG4gICAgICBpZihtYXhTY29yZSA9PSBjYWxlQ2FyZHNbd10uc2NvcmVzKXsvL+S4ieadoVxuICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XG4gICAgICAgIHN0ciA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIHN0cjtcblxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxuICAgICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcbiAgICAgIH1lbHNle1xuICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XG4gICAgICAgIG9uZVZhbHVlID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgb25lVmFsdWU7XG5cbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgaWYocGFyc2VJbnQocykgPCAyMCl7XG4gICAgICAgICAgb25lVmFsdWVDb2xvciA9IGMgKyBvbmVWYWx1ZUNvbG9yOy8v54mM6ImyXG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIG9uZVZhbHVlQ29sb3IyMCA9IGMgKyBvbmVWYWx1ZUNvbG9yMjA7Ly/niYzoibJcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZihpc1RvdSl7XG4gICAgICBvbmVWYWx1ZSA9IG9uZVZhbHVlKycwMDAwJztcbiAgICAgIHZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yKycwMCc7XG4gICAgfVxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcbiAgICAvL2lmKGNjLmh1YVNlID09IDApIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcbiAgICAvL3N0ciA9IHN0citvbmVWYWx1ZSArIG9uZVZhbHVlQ29sb3IgKyB2YWx1ZUNvbG9yICsgb25lVmFsdWVDb2xvcjIwO1xuICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuXG4gIH1cbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gMjAwMDAwMDAwMDAwMDAwMCkge1xuICAgIC8vY2FsZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnQpO1xuICAgIC8v5Lik5a+5LOacieWPr+iDvemcgOimgeavlDXlvKDniYxcbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSAnJztcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcbiAgICB2YXIgb25lVmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcbiAgICBmb3IodmFyIGkgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICBpZihwb2ludEhlbHBlci5wb2ludE51bWJlcnNbaV0gPT0gMikgey8v5Lik5a+5XG4gICAgICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgICAgICBpZihpID09IGNhbGVDYXJkc1t3XS5zY29yZXMpe1xuICAgICAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xuICAgICAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgZm9yKHZhciBxIGluIGNhbGVDYXJkcykgey8v5Y2V5byg5Yqg6Iqx6ImyXG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbcV0uc2NvcmVzKXtcbiAgICAgICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3FdLnNjb3JlcztcbiAgICAgICAgICAgIG9uZVZhbHVlID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgb25lVmFsdWU7XG5cbiAgICAgICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3FdLmNvbG9yOy8v54mM6ImyXG4gICAgICAgICAgICBvbmVWYWx1ZUNvbG9yID0gb25lVmFsdWVDb2xvciArIGM7Ly/niYzoibJcblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICB9XG5cbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vLy9jYy5sb2coc3RyKVxuICAgIC8vLy9jYy5sb2cob25lVmFsdWUpXG4gICAgLy9zdHIgPSBzdHIrb25lVmFsdWUgK29uZVZhbHVlQ29sb3IgKyB2YWx1ZUNvbG9yO1xuICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDEwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+WvueWtkFxuICAgIC8vY2FsZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnQpO1xuICAgIHZhciBzdHIgPSBcIlwiO1xuICAgIHZhciBvbmVWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjtcblxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKXtcbiAgICAgIGNhbGVDYXJkcy5zb3J0KGZ1bmN0aW9uKGNhcmQxLGNhcmQyKSB7XG4gICAgICAgIHJldHVybiBjYXJkMi5wb2ludC1jYXJkMS5wb2ludDtcbiAgICAgIH0pO1xuICAgICAgY2FsZUNhcmRzID0gY2FsZUNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgICBjYWxlQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkLGluZGV4KSB7XG4gICAgICAgIHZhciBzID0gY2FyZC5zY29yZXM7XG4gICAgICAgIHZhciBjID0gY2FyZC5jb2xvcjtcbiAgICAgICAgc3RyID0gc3RyKyhwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKTtcbiAgICAgICAgaWYoaW5kZXggPT0gMCl7XG4gICAgICAgICAgdmFyIHMyMCA9IGNhcmQyMFswXS5zY29yZXM7XG4gICAgICAgICAgc3RyID0gc3RyKyhwYXJzZUludChzMjApPj0xMCA/IHMyMCA6XCIwXCIrczIwKTtcbiAgICAgICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcitjO1xuICAgICAgICAgIHZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yK2NhcmQyMFswXS5jb2xvcjtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgb25lVmFsdWVDb2xvciA9IG9uZVZhbHVlQ29sb3IrYztcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICAvL2NjLmxvZyhzdHIpXG4gICAgICAvL2NjLmxvZygnLS0tLS0tLS0yNzQnKVxuICAgICAgaWYoaXNUb3Upe1xuICAgICAgICBzdHIgPSBzdHIrJzAwMDAnO1xuICAgICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcisnMDAnO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICAgICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XG4gICAgICAvL3N0ciA9IHN0ciArIG9uZVZhbHVlQ29sb3IgKyB2YWx1ZUNvbG9yO1xuICAgICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XG4gICAgfVxuXG4gICAgZm9yKHZhciBpIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgaWYocG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW2ldID09IG1heE51bSkgey8v5a+55a2QXG4gICAgICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHsvL+WvueWtkOWKoOiKseiJslxuICAgICAgICAgIGlmKGkgPT0gY2FsZUNhcmRzW3ddLnNjb3Jlcyl7XG4gICAgICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XG4gICAgICAgICAgICB2YWx1ZUNvbG9yID0gY2FsZUNhcmRzW3ddLmNvbG9yICsgdmFsdWVDb2xvcjtcbiAgICAgICAgICAgIHN0ciA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIHN0cjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBmb3IodmFyIHEgaW4gY2FsZUNhcmRzKSB7Ly/ljZXlvKDliqDoirHoibJcbiAgICAgICAgICBpZihpID09IGNhbGVDYXJkc1txXS5zY29yZXMpe1xuICAgICAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbcV0uc2NvcmVzO1xuICAgICAgICAgICAgb25lVmFsdWVDb2xvciA9IGNhbGVDYXJkc1txXS5jb2xvciArIG9uZVZhbHVlQ29sb3I7XG4gICAgICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICB9XG5cbiAgICB9XG4gICAgaWYoaXNUb3Upe1xuICAgICAgb25lVmFsdWUgPSBvbmVWYWx1ZSsnMDAwMCc7XG4gICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcisnMDAnO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0citvbmVWYWx1ZSk7XG4gICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0citvbmVWYWx1ZSk7XG4gICAgLy9zdHIgPSBzdHIrb25lVmFsdWUrb25lVmFsdWVDb2xvcit2YWx1ZUNvbG9yO1xuICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDApIHtcbiAgICAvL+S5jOm+mVxuICAgIHZhciB2YWx1ZVBvaW50ID0gXCJcIjtcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7XG4gICAgZm9yKHZhciBxIGluIGNhbGVDYXJkcykge1xuICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbcV0uc2NvcmVzO1xuICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbcV0uY29sb3I7Ly/ljZXlvKDliqDoirHoibJcbiAgICAgIHZhbHVlUG9pbnQgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyB2YWx1ZVBvaW50O1xuICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yO1xuICAgIH1cbiAgICBpZihpc1RvdSl7XG4gICAgICB2YWx1ZVBvaW50ID0gdmFsdWVQb2ludCsnMDAwMCc7XG4gICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcisnMDAnO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHZhbHVlUG9pbnQpO1xuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh2YWx1ZVBvaW50KTtcbiAgICAvL3ZhbHVlUG9pbnQgPSB2YWx1ZVBvaW50ICsgdmFsdWVDb2xvcjtcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodmFsdWVQb2ludCk7XG4gIH1cblxuXG4gIHZhciBjYXJkc1RvdGFsUG9pbnQ9MDtcbiAgY2FsZUNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgIGNhcmRzVG90YWxQb2ludCArPSBjYXJkLnBvaW50O1xuICB9KTtcblxuICBsZXQgcmVzdWx0ID0gdHlwZVNjb3JlICsgY2FyZHNUb3RhbFBvaW50O1xuICByZXR1cm4gcmVzdWx0O1xufTtcbktRQ2FyZC5fY2hhbmdlQ2FyZFNjb3JzID0gZnVuY3Rpb24oY2FyZE1vZGVsKSB7XG4gIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICBjYXJkLnNjb3JlcyA9IGNhcmQucG9pbnQ7XG4gICAgaWYgKGNhcmQuc2NvcmVzID09IDEpIHtcbiAgICAgIGNhcmQuc2NvcmVzID0gMTQ7XG4gICAgfVxuICB9KTtcblxuICB2YXIgaXMxNCA9IHRydWU7Ly/mmK8gayBxIGogMTAgQTtcbiAgdmFyIGlzMSA9IHRydWU7Ly/mmK8xIDIgMyA0IDVcblxuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgaWYgKGNhcmQuc2NvcmVzIDwgMTApIHtcbiAgICAgIGlzMTQgPSBmYWxzZTsgLy/kuI3mmK8gayBxIGogMTAgQTtcbiAgICB9XG4gIH0pO1xuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgY2FyZC5zY29yZXMgPSBjYXJkLnBvaW50O1xuICAgIGlmIChjYXJkLnNjb3JlcyA9PSAxNCkge1xuICAgICAgY2FyZC5zY29yZXMgPSAxO1xuICAgIH1cbiAgfSk7XG4gIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICBpZiAoY2FyZC5zY29yZXMgPiA1ICYmIGNhcmQuc2NvcmVzICE9IDIwKSB7XG4gICAgICBpczEgPSBmYWxzZTsvL+S4jeaYrzEgMiAzIDQgNVxuICAgIH1cbiAgfSk7XG5cbiAgaWYgKGlzMTQpIHsgLy/mmK8gayBxIGogMTAgQTtcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgICBpZiAoY2FyZC5zY29yZXMgPT0gMSkge1xuICAgICAgICBjYXJkLnNjb3JlcyA9IDE0O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY2FyZE1vZGVsLnNvcnQoZnVuY3Rpb24oYTEsIGEyKSB7XG4gICAgICByZXR1cm4gYTIuc2NvcmVzIC0gYTEuc2NvcmVzO1xuICAgIH0pO1xuICAgIHZhciBudW0gPSAxNDtcbiAgICB2YXIgc2NvcmVzQXl5ID0gW107IC8v5LiA5Ymv54mM55qE5YiG5pWwXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgIHNjb3Jlc0F5eS5wdXNoKG51bSk7XG4gICAgICBudW0gLT0gMTtcbiAgICB9XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBzY29yZXNBeXkubGVuZ3RoOyBqKyspIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjYXJkU2NvcmVzID0gY2FyZE1vZGVsW2ldLnNjb3JlcztcbiAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkge1xuICAgICAgICAgIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgLy9jYy5sb2coJy0tLS0tLS0tLS3mmK8gayBxIGogMTAgQScsc2NvcmVzQXl5KVxuICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHsgLy/mib7lh7rpgInkuK3nmoTniYxcbiAgICAgIGlmIChjYXJkLnBvaW50ID49IDIwKSB7XG4gICAgICAgIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLCAxKVswXTtcbiAgICAgIH1cbiAgICB9LmJpbmQodGhpcykpO1xuICB9XG4gIGVsc2UgaWYgKGlzMSkgeyAvL+aYrzEgMiAzIDQgNVxuICAgIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge1xuICAgICAgcmV0dXJuIGEyLnNjb3JlcyAtIGExLnNjb3JlcztcbiAgICB9KTtcbiAgICB2YXIgbnVtID0gNTtcbiAgICB2YXIgc2NvcmVzQXl5ID0gW107IC8v5LiA5Ymv54mM55qE5YiG5pWwXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgIHNjb3Jlc0F5eS5wdXNoKG51bSk7XG4gICAgICBudW0gLT0gMTtcbiAgICB9XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBzY29yZXNBeXkubGVuZ3RoOyBqKyspIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjYXJkU2NvcmVzID0gY2FyZE1vZGVsW2ldLnNjb3JlcztcbiAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkge1xuICAgICAgICAgIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgLy9jYy5sb2coJy0tLS0tLS0tLS3mmK8xIDIgMyA0IDUnKVxuICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHsgLy/mib7lh7rpgInkuK3nmoTniYxcbiAgICAgIGlmIChjYXJkLnBvaW50ID49IDIwKSB7XG4gICAgICAgIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLCAxKVswXTtcbiAgICAgIH1cbiAgICB9LmJpbmQodGhpcykpO1xuICB9XG4gIGVsc2Uge1xuICAgIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge1xuICAgICAgcmV0dXJuIGExLnNjb3JlcyAtIGEyLnNjb3JlcztcbiAgICB9KTtcbiAgICB2YXIgc2NvcmVzQXl5ID0gW107IC8v55So5p2l6KOF6ay854mM5YiG5pWwXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgIHZhciBzID0gcGFyc2VJbnQoY2FyZE1vZGVsWzBdLnNjb3JlcykgKyBpOyAvL+acgOWwj+eahOeJjOeahOWIhuaVsFxuICAgICAgc2NvcmVzQXl5LnB1c2gocyk7Ly/kuIDlia/niYznmoTliIbmlbBcbiAgICB9XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBzY29yZXNBeXkubGVuZ3RoOyBqKyspIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjYXJkU2NvcmVzID0gY2FyZE1vZGVsW2ldLnNjb3JlcztcbiAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkge1xuICAgICAgICAgIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkgeyAvL+aUueWPmOeJjOeahOWIhuaVsFxuICAgICAgaWYgKGNhcmQucG9pbnQgPj0gMjApIHtcbiAgICAgICAgY2FyZC5zY29yZXMgPSBzY29yZXNBeXkuc3BsaWNlKDAsMSlbMF07XG4gICAgICB9XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICBpZiAoY2FyZC5zY29yZXMgPT0gMSkge1xuICAgICAgY2FyZC5zY29yZXMgPSAxNDtcbiAgICB9XG4gIH0pO1xuICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtcbiAgICByZXR1cm4gYTEuc2NvcmVzIC0gYTIuc2NvcmVzO1xuICB9KTtcbiAgcmV0dXJuIGNhcmRNb2RlbDtcbn07XG4vKiMjIyMjKi9cblxuS1FDYXJkLl90eXBlU2NvcmVPZkNhcmRzID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gIHZhciB0eXBlU2NvcmUgPSAwO1xuICBpZihLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcykpe1xuICAgIHR5cGVTY29yZSA9IDkwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bihjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSA4MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDcwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5IdUx1KGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDYwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDUwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5TaHVuWmkoY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gNDAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblNhblRpYW8oY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gMzAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkxpYUR1aShjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSAyMDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluRHVpWmkoY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gMTAwMDAwMDAwMDAwMDAwMDtcbiAgfVxuXG4gIHJldHVybiB0eXBlU2NvcmU7XG59O1xuLypcbiAvLyDmoLnmja7niYzlnovov5vooYzmjpLluo9cbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnQgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiBpZiAoKGNhcmRzID09IG51bGwpIHx8IChjYXJkcy5sZW5ndGggPT0gMCkpIHtcbiByZXR1cm4gY2FyZHM7XG4gfVxuIGlmKEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRzKSl7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFd1dG9uZyhjYXJkcyk7XG4gfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRzKSkge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRTaHVuWmkoY2FyZHMpO1xuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5UaWVaaGkoY2FyZHMpKSB7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFRpZVpoaShjYXJkcyk7XG4gfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkh1THUoY2FyZHMpKSB7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEh1THUoY2FyZHMpO1xuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhKGNhcmRzKSkge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRUb25nSHVhKGNhcmRzKTtcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2h1blppKGNhcmRzKSkge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRTaHVuWmkoY2FyZHMpO1xuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5TYW5UaWFvKGNhcmRzKSkge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRTYW5UaWFvKGNhcmRzKTtcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluTGlhRHVpKGNhcmRzKSkge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRMaWFuZ0R1aShjYXJkcyk7XG4gfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkR1aVppKGNhcmRzKSkge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnREdWlaaShjYXJkcyk7XG4gfVxuXG4gcmV0dXJuIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KS5yZXZlcnNlKCk7XG4gfTtcblxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFNodW5aaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuIHJldHVybiBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCkucmV2ZXJzZSgpO1xuIH07XG5cbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRUaWVaaGkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhjYXJkcyk7XG4gfTtcblxuIC8hKiMjIyMjKiEvXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0V3V0b25nID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xuIH07XG4gLyEqIyMjIyMqIS9cblxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEh1THUgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhjYXJkcyk7XG4gfTtcblxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFRvbmdIdWEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiByZXR1cm4gY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpLnJldmVyc2UoKTtcbiB9O1xuXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkcykge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcbiB9O1xuXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0TGlhbmdEdWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhjYXJkcyk7XG4gfTtcblxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydER1aVppID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xuIH07XG4gKi9cbktRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMgPSBmdW5jdGlvbihjYXJkcykge1xuXG4gIGNhcmRzID0gS1FDYXJkLl9jaGFuZ2VHdWlDYXJkKGNhcmRzKTtcblxuICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmKGkuc2NvcmVzID09IDEpIGkuc2NvcmVzID0gMTQ7fSlcblxuICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkU2NvcmV0c0hlbHBlcihjYXJkcyk7XG4gIGxldCBuZXdDYXJkcyA9IGNhcmRzLnNsaWNlKCkuc29ydChmdW5jdGlvbihjYXJkMSwgY2FyZDIpIHtcbiAgICBsZXQgbnVtYmVyT2ZDYXJkMSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tjYXJkMS5zY29yZXNdO1xuICAgIGxldCBudW1iZXJPZkNhcmQyID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW2NhcmQyLnNjb3Jlc107XG5cbiAgICBpZiAobnVtYmVyT2ZDYXJkMiAhPSBudW1iZXJPZkNhcmQxKSB7XG4gICAgICByZXR1cm4gbnVtYmVyT2ZDYXJkMiAtIG51bWJlck9mQ2FyZDE7XG4gICAgfVxuICAgIHZhciBzY29yZXMxID0gY2FyZDEuc2NvcmVzID09IDE/IDE0OmNhcmQxLnNjb3JlcztcbiAgICB2YXIgc2NvcmVzMiA9IGNhcmQyLnNjb3JlcyA9PSAxPyAxNDpjYXJkMi5zY29yZXM7XG4gICAgcmV0dXJuIHNjb3JlczIgLSBzY29yZXMxO1xuICAgIC8vcmV0dXJuIGNhcmQyLnNjb3JlcyAtIGNhcmQxLnNjb3JlcztcbiAgfSk7XG4gIG5ld0NhcmRzLmZvckVhY2goZnVuY3Rpb24oaSl7aWYoaS5zY29yZXMgPT0gMTQpIGkuc2NvcmVzID0gMTt9KVxuICByZXR1cm4gbmV3Q2FyZHMvKi5jb25jYXQoY2FyZDIwKSovO1xufTtcblxuS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50czEgPSBmdW5jdGlvbihjYXJkcykge1xuXG4gIGNhcmRzID0gS1FDYXJkLl9jaGFuZ2VHdWlDYXJkKGNhcmRzKTtcblxuICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmKGkuc2NvcmVzID09IDEpIGkuc2NvcmVzID0gMTQ7fSlcblxuICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkU2NvcmV0c0hlbHBlcihjYXJkcyk7XG4gIGxldCBuZXdDYXJkcyA9IGNhcmRzLnNsaWNlKCkuc29ydChmdW5jdGlvbihjYXJkMSwgY2FyZDIpIHtcbiAgICBsZXQgbnVtYmVyT2ZDYXJkMSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tjYXJkMS5zY29yZXNdO1xuICAgIGxldCBudW1iZXJPZkNhcmQyID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW2NhcmQyLnNjb3Jlc107XG5cbiAgICBpZiAobnVtYmVyT2ZDYXJkMiAhPSBudW1iZXJPZkNhcmQxKSB7XG4gICAgICByZXR1cm4gbnVtYmVyT2ZDYXJkMSAtIG51bWJlck9mQ2FyZDI7XG4gICAgfVxuICAgIHZhciBzY29yZXMxID0gY2FyZDEuc2NvcmVzID09IDE/IDE0OmNhcmQxLnNjb3JlcztcbiAgICB2YXIgc2NvcmVzMiA9IGNhcmQyLnNjb3JlcyA9PSAxPyAxNDpjYXJkMi5zY29yZXM7XG4gICAgcmV0dXJuIHNjb3JlczEgLSBzY29yZXMyO1xuICAgIC8vcmV0dXJuIGNhcmQxLnNjb3JlcyAtIGNhcmQyLnNjb3JlcztcbiAgfSk7XG4gIG5ld0NhcmRzLmZvckVhY2goZnVuY3Rpb24oaSl7aWYoaS5zY29yZXMgPT0gMTQpIGkuc2NvcmVzID0gMTt9KVxuICByZXR1cm4gbmV3Q2FyZHM7XG59O1xuXG5LUUNhcmQuX2NoYW5nZUd1aUNhcmQgPSBmdW5jdGlvbiAoY2FyZHMpIHtcblxuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG5cbiAgdmFyIGNhID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKTtcblxuICB2YXIgaGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYSk7XG5cbiAgdmFyIHNvID0gMDtcblxuICB2YXIgY29sb3IgPSAxO1xuXG4gIHZhciB0eXBlID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkcykgKyAxO1xuXG4gIHR5cGUgPSB0eXBlID49IDEwID8gdHlwZSA6IFwiMFwiICsgdHlwZTtcblxuICBpZih0eXBlID09IFwiMDVcIiB8fCB0eXBlID09IFwiMDlcIil7XG5cbiAgICByZXR1cm4gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FyZHMpO1xuXG4gIH1cbiAgaWYodHlwZSA9PSBcIjA2XCIpe1xuXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcblxuICAgICAgdmFyIG1heE51bWJlciA9IGhlbHBlci5wb2ludE51bWJlcnNbd107XG5cbiAgICAgIGlmKHcgPT0gMSkgdyA9IDE0O1xuXG4gICAgICBpZihtYXhOdW1iZXIgPj0gaGVscGVyLm1heE51bWJlcigpICYmIHNvIDwgcGFyc2VJbnQodykgJiYgcGFyc2VJbnQodykgIT0gMjApe3NvID0gcGFyc2VJbnQodyk7fVxuXG4gICAgfVxuICAgIGNvbG9yID0gY2FbMF0uY29sb3I7XG5cbiAgICBzbyA9IHNvID09IDE0PyAxOiBzbztcblxuICAgIGNhcmQyMC5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICBuLnNjb3JlcyA9IHNvO1xuXG4gICAgICBuLmNvbG9yU2NvcmVzID0gY29sb3I7XG5cbiAgICB9KTtcblxuICB9XG4gIGlmKHR5cGUgPT0gXCIwN1wiIHx8IHR5cGUgPT0gXCIyMlwiIHx8IHR5cGUgPT0gXCIwOFwiIHx8IHR5cGUgPT0gXCIxMFwiXG4gICAgICB8fCB0eXBlID09IFwiMDRcIiB8fCB0eXBlID09IFwiMTFcIiB8fCB0eXBlID09IFwiMDJcIil7XG5cbiAgICBmb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xuXG4gICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcblxuICAgICAgaWYodyA9PSAxKSB3ID0gMTQ7XG5cbiAgICAgIGlmKG1heE51bWJlciA+PSBoZWxwZXIubWF4TnVtYmVyKCkgJiYgc28gPCBwYXJzZUludCh3KSAmJiBwYXJzZUludCh3KSAhPSAyMCl7c28gPSBwYXJzZUludCh3KTt9XG5cbiAgICB9XG5cbiAgICBzbyA9IHNvID09IDE0ID8gMTogc29cblxuICAgIGNhLmZvckVhY2goZnVuY3Rpb24obil7aWYoc28gPT0gbi5wb2ludCAmJiBjb2xvciA8IG4uY29sb3IpIGNvbG9yID0gbi5jb2xvcjt9KTtcblxuICAgIGNhcmQyMC5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICBuLnNjb3JlcyA9IHNvO1xuXG4gICAgICBuLmNvbG9yU2NvcmVzID0gY29sb3I7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuXG4gIH1cblxuICByZXR1cm4gY2FyZDIwLmNvbmNhdChjYSk7XG59O1xuXG5LUUNhcmQuX3NldEd1aUNhcmQgPSBmdW5jdGlvbiAoaW5kZXgsIHN0YXJ0LCBlbmQsIHR5cGUsIGNhcmRzICxub2RlcywgY2FyZFNwcml0ZUF0bGFzKSB7XG4gIC8vY2MubG9nKGNhcmRTcHJpdGVBdGxhcylcbiAgLy9jYy5sb2coJy0tLS0tNTkzJylcbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHNbaW5kZXhdKTtcblxuICB2YXIgY2EgPSBjYXJkc1tpbmRleF0ua3FfZXhjbHVkZXMoY2FyZDIwKTtcblxuICB2YXIgaGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYSk7XG5cbiAgdmFyIHNvID0gMDtcblxuICB2YXIgY29sb3IgPSAxO1xuXG4gIHZhciBub2RlID0gbm9kZXMuc2xpY2Uoc3RhcnQsIGVuZCkuZmlsdGVyKGZ1bmN0aW9uKG4pe1xuXG4gICAgaWYobi5jaGlsZHJlbkNvdW50ID4gMCAmJiBuLmNoaWxkcmVuWzBdLmNhcmROYW1lKXtcblxuICAgICAgaWYocGFyc2VJbnQobi5jaGlsZHJlblswXS5jYXJkTmFtZS5zcGxpdChcIl9cIilbMV0pID09IDIwKSByZXR1cm4gdHJ1ZTtcblxuICAgIH1cbiAgfSk7XG5cbiAgaWYodHlwZSA9PSBcIjA1XCIgfHwgdHlwZSA9PSBcIjA5XCIpe1xuXG4gICAgY2FyZHNbaW5kZXhdID0gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FyZHNbaW5kZXhdKTtcblxuICAgIHNvID0gY2FyZHNbaW5kZXhdLmZpbHRlcihmdW5jdGlvbihpKXtpZihpLnBvaW50ID09IDIwKXJldHVybiB0cnVlO30pLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS5zY29yZXMgPT0gMTQ/IDE6aS5zY29yZXM7fSk7XG5cbiAgICBub2RlLmZvckVhY2goZnVuY3Rpb24obil7XG5cbiAgICAgIHZhciBidG5TcHJpdGUgPSBuLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICB2YXIgY2FyZE5hbWUgPSBjYVswXS5jb2xvciArIFwiX1wiICsgc28uc3BsaWNlKDAsMSlbMF07XG5cbiAgICAgIHZhciBwYXRoID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcblxuICAgICAgS1FDYXJkLl9sb2FkQ2FyZEZyYW1lKGNhcmRTcHJpdGVBdGxhcywgcGF0aCAsYnRuU3ByaXRlKTtcblxuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgfVxuICBpZih0eXBlID09IFwiMDZcIil7XG5cbiAgICBmb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xuXG4gICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcblxuICAgICAgaWYodyA9PSAxKSB3ID0gMTQ7XG5cbiAgICAgIGlmKG1heE51bWJlciA+PSBoZWxwZXIubWF4TnVtYmVyKCkgJiYgc28gPCBwYXJzZUludCh3KSAmJiBwYXJzZUludCh3KSAhPSAyMCl7c28gPSBwYXJzZUludCh3KTt9XG5cbiAgICB9XG5cbiAgICBjb2xvciA9IGNhWzBdLmNvbG9yO1xuXG4gICAgc28gPSBzbyA9PSAxND8gMTogc287XG5cbiAgICBub2RlLmZvckVhY2goZnVuY3Rpb24obil7XG5cbiAgICAgIHZhciBidG5TcHJpdGUgPSBuLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICB2YXIgY2FyZE5hbWUgPSBjb2xvciArIFwiX1wiICsgc287XG5cbiAgICAgIHZhciBwYXRoID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcblxuICAgICAgS1FDYXJkLl9sb2FkQ2FyZEZyYW1lKGNhcmRTcHJpdGVBdGxhcywgcGF0aCAsYnRuU3ByaXRlKTtcblxuICAgIH0uYmluZCh0aGlzKSk7XG4gIH1cbiAgaWYodHlwZSA9PSBcIjA3XCIgfHwgdHlwZSA9PSBcIjIyXCIgfHwgdHlwZSA9PSBcIjA4XCIgfHwgdHlwZSA9PSBcIjEwXCJcbiAgICAgIHx8IHR5cGUgPT0gXCIwNFwiIHx8IHR5cGUgPT0gXCIxMVwiIHx8IHR5cGUgPT0gXCIwMlwiKXtcblxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XG5cbiAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xuXG4gICAgICBpZih3ID09IDEpIHcgPSAxNDtcblxuICAgICAgaWYobWF4TnVtYmVyID49IGhlbHBlci5tYXhOdW1iZXIoKSAmJiBzbyA8IHBhcnNlSW50KHcpICYmIHBhcnNlSW50KHcpICE9IDIwKXtzbyA9IHBhcnNlSW50KHcpO31cblxuICAgIH1cblxuICAgIHNvID0gc28gPT0gMTQgPyAxOiBzb1xuXG4gICAgY2EuZm9yRWFjaChmdW5jdGlvbihuKXtpZihzbyA9PSBuLnBvaW50ICYmIGNvbG9yIDwgbi5jb2xvcikgY29sb3IgPSBuLmNvbG9yO30pO1xuXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgdmFyIGNhcmROYW1lID0gY29sb3IgKyBcIl9cIiArIHNvO1xuXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG5cbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuXG5cbiAgfVxuXG59O1xuXG5LUUNhcmQuX3NldEd1aUNhcmRzID0gZnVuY3Rpb24gKHR5cGUsIGNhcmRzICxub2RlcywgY2FyZFNwcml0ZUF0bGFzKSB7XG4gIC8vY2MubG9nKGNhcmRTcHJpdGVBdGxhcylcbiAgLy9jYy5sb2coJy0tLS0tNTkzJylcbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuXG4gIHZhciBjYSA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG5cbiAgdmFyIGhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2EpO1xuXG4gIHZhciBzbyA9IDA7XG5cbiAgdmFyIGNvbG9yID0gMTtcblxuICB2YXIgbm9kZSA9IG5vZGVzLnNsaWNlKCkuZmlsdGVyKGZ1bmN0aW9uKG4pe1xuXG4gICAgaWYobi5jaGlsZHJlbkNvdW50ID4gMCAmJiBuLmNoaWxkcmVuWzBdLmNhcmROYW1lKXtcblxuICAgICAgaWYocGFyc2VJbnQobi5jaGlsZHJlblswXS5jYXJkTmFtZS5zcGxpdChcIl9cIilbMV0pID09IDIwKSByZXR1cm4gdHJ1ZTtcblxuICAgIH1cbiAgfSk7XG5cbiAgaWYodHlwZSA9PSBcIjA1XCIgfHwgdHlwZSA9PSBcIjA5XCIpe1xuXG4gICAgY2FyZHMgPSBLUUNhcmQuX2NoYW5nZUNhcmRTY29ycyhjYXJkcyk7XG5cbiAgICBzbyA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihpKXtpZihpLnBvaW50ID09IDIwKXJldHVybiB0cnVlO30pLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS5zY29yZXMgPT0gMTQ/IDE6aS5zY29yZXM7fSk7XG5cbiAgICBub2RlLmZvckVhY2goZnVuY3Rpb24obil7XG5cbiAgICAgIHZhciBidG5TcHJpdGUgPSBuLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICB2YXIgY2FyZE5hbWUgPSBjYVswXS5jb2xvciArIFwiX1wiICsgc28uc3BsaWNlKDAsMSlbMF07XG5cbiAgICAgIHZhciBwYXRoID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcblxuICAgICAgS1FDYXJkLl9sb2FkQ2FyZEZyYW1lKGNhcmRTcHJpdGVBdGxhcywgcGF0aCAsYnRuU3ByaXRlKTtcblxuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgfVxuICBpZih0eXBlID09IFwiMDZcIil7XG5cbiAgICBmb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xuXG4gICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcblxuICAgICAgaWYodyA9PSAxKSB3ID0gMTQ7XG5cbiAgICAgIGlmKG1heE51bWJlciA+PSBoZWxwZXIubWF4TnVtYmVyKCkgJiYgc28gPCBwYXJzZUludCh3KSAmJiBwYXJzZUludCh3KSAhPSAyMCl7c28gPSBwYXJzZUludCh3KTt9XG5cbiAgICB9XG5cbiAgICBjb2xvciA9IGNhWzBdLmNvbG9yO1xuXG4gICAgc28gPSBzbyA9PSAxND8gMTogc287XG5cbiAgICBub2RlLmZvckVhY2goZnVuY3Rpb24obil7XG5cbiAgICAgIHZhciBidG5TcHJpdGUgPSBuLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICB2YXIgY2FyZE5hbWUgPSBjb2xvciArIFwiX1wiICsgc287XG5cbiAgICAgIHZhciBwYXRoID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcblxuICAgICAgS1FDYXJkLl9sb2FkQ2FyZEZyYW1lKGNhcmRTcHJpdGVBdGxhcywgcGF0aCAsYnRuU3ByaXRlKTtcblxuICAgIH0uYmluZCh0aGlzKSk7XG4gIH1cbiAgaWYodHlwZSA9PSBcIjA3XCIgfHwgdHlwZSA9PSBcIjIyXCIgfHwgdHlwZSA9PSBcIjA4XCIgfHwgdHlwZSA9PSBcIjEwXCJcbiAgICAgIHx8IHR5cGUgPT0gXCIwNFwiIHx8IHR5cGUgPT0gXCIxMVwiIHx8IHR5cGUgPT0gXCIwMlwiKXtcblxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XG5cbiAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xuXG4gICAgICBpZih3ID09IDEpIHcgPSAxNDtcblxuICAgICAgaWYobWF4TnVtYmVyID49IGhlbHBlci5tYXhOdW1iZXIoKSAmJiBzbyA8IHBhcnNlSW50KHcpICYmIHBhcnNlSW50KHcpICE9IDIwKXtzbyA9IHBhcnNlSW50KHcpO31cblxuICAgIH1cblxuICAgIHNvID0gc28gPT0gMTQgPyAxOiBzb1xuXG4gICAgY2EuZm9yRWFjaChmdW5jdGlvbihuKXtpZihzbyA9PSBuLnBvaW50ICYmIGNvbG9yIDwgbi5jb2xvcikgY29sb3IgPSBuLmNvbG9yO30pO1xuXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgdmFyIGNhcmROYW1lID0gY29sb3IgKyBcIl9cIiArIHNvO1xuXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG5cbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuXG5cbiAgfVxuXG59O1xuXG5LUUNhcmQuX2xvYWRDYXJkRnJhbWUgPSBmdW5jdGlvbihTcHJpdGVGcmFtZSwgcGF0aCwgU3ByaXRlc05vZGUsIHcsIGgpIHtcbiAgLy9jYy5sb2coU3ByaXRlRnJhbWUpXG4gIC8vY2MubG9nKCctLS03NjknKVxuICB2YXIgU3ByaXRlID0gU3ByaXRlRnJhbWUuZ2V0U3ByaXRlRnJhbWUoIHBhdGggKTtcblxuICBTcHJpdGVzTm9kZS5zcHJpdGVGcmFtZSA9IFNwcml0ZTtcblxuICBpZih3KSBTcHJpdGVzTm9kZS5ub2RlLndpZHRoID0gdztcblxuICBpZihoKSBTcHJpdGVzTm9kZS5ub2RlLmhlaWdodCA9IGg7XG59O1xuXG5cbktRQ2FyZC50ZXN0U2NvcmUgPSBmdW5jdGlvbigpIHtcblxufTsiLCIvLyDniYzngrnmlbDluK7liqnnsbtcclxuLy8g55So5p2l6K6h566X5LiA5Liq54mM5pWw57uE5YaF55qE55u45ZCM54K55pWw55qE54mM55qE5byg5pWwXHJcbnZhciBLUUNhcmRTY29yZXRzSGVscGVyID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICB0aGlzLnBvaW50TnVtYmVycyA9IHt9O1xyXG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgIGxldCBwb2ludCA9IGNhcmQuc2NvcmVzO1xyXG4gICAgICAgIHZhciBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twb2ludF0gfHwgMDtcclxuICAgICAgICB0aGlzLnBvaW50TnVtYmVyc1twb2ludF0gPSBudW1iZXIgKyAxO1xyXG4gICAgfS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8vIOebuOWQjOeCueaVsOeJjOeahOacgOWkp+aVsOmHj1xyXG5LUUNhcmRTY29yZXRzSGVscGVyLnByb3RvdHlwZS5tYXhOdW1iZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIHJlc3VsdCA9IDA7XHJcbiAgZm9yIChsZXQgcHJvcCBpbiB0aGlzLnBvaW50TnVtYmVycykge1xyXG4gICAgbGV0IG51bWJlciA9IHRoaXMucG9pbnROdW1iZXJzW3Byb3BdO1xyXG4gICAgICAvL2lmKG51bWJlciA8IDIwKXtcclxuICAgICAgICAgIHJlc3VsdCA9IE1hdGgubWF4KG51bWJlciwgcmVzdWx0KTtcclxuICAgICAgLy99XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVzdWx0O1xyXG59O1xyXG5cclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEtRQ2FyZFNjb3JldHNIZWxwZXI7XHJcblxyXG4vKnZhciBjYXJkcyA9IFtcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoyfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoyfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo0fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo0fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo2fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo2fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo4fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo4fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEyfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTR9XHJcbl07XHJcbnZhciB0ZXN0ID0gbmV3IEtRQ2FyZFBvaW50c1NhbWUoY2FyZHMpO1xyXG5jb25zb2xlLmxvZyh0ZXN0KTsqL1xyXG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcblxuLy8g54mM6Ieq5Yqo6YCJ5oup55qE5omp5bGVXG5cbi8qKlxuICog6Ieq5Yqo6YCJ5oup54mM77yM55Sx5aSn5Yiw5bCPXG4gKlxuICogQHBhcmFtICB7W0tRQ2FyZF19IG9yaWdpbkNhcmRzICDooqvpgInmi6nnmoTljp/lp4vniYzmlbDnu4RcbiAqXG4gKiBAcmV0dXJuIHtbS1FDYXJkXX1cbiAqL1xuS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyA9IGZ1bmN0aW9uKG9yaWdpbkNhcmRzLCBtYXhMZW5ndGgpIHtcbiAgICBpZiAob3JpZ2luQ2FyZHMubGVuZ3RoIDw9IG1heExlbmd0aCkge1xuICAgICAgICByZXR1cm4gb3JpZ2luQ2FyZHM7XG4gICAgfVxuICAgIG9yaWdpbkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XG4gICAgICAgIGlmKGNhcmQuc2NvcmVzID09IDEpe1xuICAgICAgICAgICAgY2FyZC5zY29yZXMgPSAxNDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGxldCBjYXJkcyA9IG9yaWdpbkNhcmRzLnNsaWNlKCkuc29ydChmdW5jdGlvbihhLGIpe1xuICAgICAgICByZXR1cm4gYS5zY29yZXMgLSBiLnNjb3JlcztcbiAgICB9KTtcblxuICAgIGxldCBmaW5kRnVuY3MgPSBbXG4gICAgICAgIEtRQ2FyZC5maW5kV3VUb25nLFxuICAgICAgICBLUUNhcmQuZmluZFRvbmdIdWFTaHVuLFxuICAgICAgICBLUUNhcmQuZmluZFRpZVpoaSxcbiAgICAgICAgS1FDYXJkLmZpbmRIdUx1LFxuICAgICAgICBLUUNhcmQuZmluZFRvbmdIdWEsXG4gICAgICAgIEtRQ2FyZC5maW5kU2h1blppLFxuICAgICAgICBLUUNhcmQuZmluZFNhblRpYW8sXG4gICAgICAgIEtRQ2FyZC5maW5kTGlhRHVpLFxuICAgICAgICBLUUNhcmQuZmluZER1aVppXG4gICAgXTtcblxuICAgIGxldCBpbmRleEFycmF5cyA9IG51bGw7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaW5kRnVuY3MubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgbGV0IGZ1bmMgPSBmaW5kRnVuY3NbaV07XG4gICAgICAgIGluZGV4QXJyYXlzID0gKGZ1bmMuYmluZChLUUNhcmQpKShjYXJkcyk7XG4gICAgICAgIGlmIChpbmRleEFycmF5cyAmJiBpbmRleEFycmF5cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBpbmRleHMgPSBbXTtcbiAgICBpZiAoaW5kZXhBcnJheXMgJiYgaW5kZXhBcnJheXMubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyDmib7lh7rlkIznsbvlnovnmoTniYzph4znmoTliIbmlbDmnIDlpKfnmoTniYxcbiAgICAgICAgdmFyIG1heFNjb3JlID0gMDtcbiAgICAgICAgaW5kZXhBcnJheXMuZm9yRWFjaCh0ZW1wSW5kZXhzID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRlbXBDYXJkcyA9IHRlbXBJbmRleHMubWFwKGluZGV4ID0+IGNhcmRzW2luZGV4XSk7XG4gICAgICAgIGNvbnN0IHNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyh0ZW1wQ2FyZHMpO1xuICAgICAgICBpZiAoc2NvcmUgPiBtYXhTY29yZSkge1xuICAgICAgICAgICAgbWF4U2NvcmUgPSBzY29yZTtcbiAgICAgICAgICAgIGluZGV4cyA9IHRlbXBJbmRleHM7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICB9XG5cbiAgICBsZXQgdGFyZ2V0Q2FyZHMgPSBpbmRleHMubWFwKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgIHJldHVybiBjYXJkc1tpbmRleF07XG4gICAgfSk7XG5cbiAgICAvKmlmICh0YXJnZXRDYXJkcy5sZW5ndGggPCBtYXhMZW5ndGgpIHtcbiAgICAgY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyh0YXJnZXRDYXJkcyk7XG4gICAgIHdoaWxlKHRhcmdldENhcmRzLmxlbmd0aCA8IG1heExlbmd0aCkge1xuICAgICB0YXJnZXRDYXJkcy5wdXNoKGNhcmRzLnBvcCgpKTtcbiAgICAgfVxuICAgICB9IGVsc2UgKi9pZiAodGFyZ2V0Q2FyZHMubGVuZ3RoID4gbWF4TGVuZ3RoKSB7XG4gICAgICAgIHRhcmdldENhcmRzID0gdGFyZ2V0Q2FyZHMuc2xpY2UoMCwgbWF4TGVuZ3RoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGFyZ2V0Q2FyZHMgfHwgW107XG59O1xuXG5LUUNhcmQudGVzdEF1dG9TZWxlY3QgPSBmdW5jdGlvbihjYXJkcykge1xuXG59OyIsImNvbnN0IEtRQ2FyZENvbG9yc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZENvbG9yc0hlbHBlcicpO1xuY29uc3QgS1FDYXJkUG9pbnRzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUG9pbnRzSGVscGVyJyk7XG5jb25zdCBOdW1iZXJFeHRlbnNpb24gPSByZXF1aXJlKCdOdW1iZXJFeHRlbnNpb24nKTtcbmNvbnN0IEdldENhcmRQb2ludHNTYW1lQ291bnQgPSByZXF1aXJlKCdHZXRDYXJkUG9pbnRzU2FtZUNvdW50Jyk7XG5cbmNjID0gY2MgfHwge307XG5jYy5hc3NlcnQgPSBjYy5hc3NlcnQgfHwgY29uc29sZS5hc3NlcnQgfHwgZnVuY3Rpb24gKCkge307XG5jYy5sb2cgPSBjYy5sb2cgfHwgY29uc29sZS5sb2cgfHwgZnVuY3Rpb24gKCkge307XG5jYy5lcnJvciA9IGNjLmVycm9yIHx8IGNvbnNvbGUuZXJyb3IgfHwgZnVuY3Rpb24gKCkge307XG5cbi8vIOeJjCBNb2RlbCDnsbvvvIzlsIHoo4XkuoboirHoibLlkozngrnmlbBcbi8vIOS9v+eUqO+8mlxuLy8gbmV3IEtRQ2FyZCgyMik7XG52YXIgS1FDYXJkID0gZnVuY3Rpb24gKHBvaW50LCBjb2xvciAsaW5kZXgpIHtcbiAgICB0aGlzLmNvbG9yID0gbnVsbDtcbiAgICB0aGlzLnBvaW50ID0gbnVsbDtcbiAgICB0aGlzLnNpbmRleCA9IGluZGV4O1xuICAgIHRoaXMuX2luaXRXaXRoQ29sb3JBbmRQb2ludCA9IGZ1bmN0aW9uIChjb2xvciwgcG9pbnQpIHtcbiAgICAgICAgaWYgKGNvbG9yID09ICdzJykgeyBjb2xvciA9IDQ7fVxuICAgICAgICBpZiAoY29sb3IgPT0gJ2gnKSB7IGNvbG9yID0gMzt9XG4gICAgICAgIGlmIChjb2xvciA9PSAnYycpIHsgY29sb3IgPSAyO31cbiAgICAgICAgaWYgKGNvbG9yID09ICdkJykgeyBjb2xvciA9IDE7fVxuXG4gICAgICAgIHRoaXMucG9pbnQgPSBOdW1iZXIocG9pbnQpO1xuICAgICAgICB0aGlzLnNjb3JlcyA9IE51bWJlcihwb2ludCk7XG4gICAgICAgIHRoaXMuY29sb3IgPSBOdW1iZXIoY29sb3IpO1xuICAgICAgICB0aGlzLmNvbG9yU2NvcmVzID0gTnVtYmVyKGNvbG9yKTtcblxuICAgICAgICBjYy5hc3NlcnQodGhpcy5wb2ludCA+IDApO1xuICAgICAgICBjYy5hc3NlcnQodGhpcy5jb2xvciA+IDApO1xuICAgIH07XG5cbiAgICB0aGlzLl9pbml0V2l0aE51bWJlciA9IGZ1bmN0aW9uIChudW1iZXIpIHtcbiAgICAgICAgdGhpcy5wb2ludCA9IE1hdGguZmxvb3IobnVtYmVyIC8gMTApO1xuICAgICAgICB0aGlzLmNvbG9yID0gbnVtYmVyICUgMTA7XG4gICAgICAgIGNjLmFzc2VydCh0aGlzLnBvaW50ID4gMCk7XG4gICAgICAgIGNjLmFzc2VydCh0aGlzLmNvbG9yID4gMCk7XG4gICAgfTtcblxuICAgIHRoaXMuX2luaXRXaXRoT2JqZWN0ID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgICBpZiAob2JqZWN0LnBvaW50KSB7XG4gICAgICAgICAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQob2JqZWN0LmNvbG9yLCBvYmplY3QucG9pbnQpO1xuICAgICAgICB9IGVsc2UgaWYgKG9iamVjdC5zdWl0KSB7XG4gICAgICAgICAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQob2JqZWN0LnN1aXQsIG9iamVjdC5udW1iZXIpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhcmROYW1lKCk7XG4gICAgfTtcblxuICAgIHRoaXMuY2FyZE5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbG9yICsgXCJfXCIgKyB0aGlzLnBvaW50O1xuICAgIH07XG5cbiAgICB0aGlzLnNvcnQgPSBmdW5jdGlvbiAob3RoZXJDYXJkLCBhc2MgPSBmYWxzZSwgQWlzTWF4ID0gdHJ1ZSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLnNvcnQodGhpcywgb3RoZXJDYXJkLCBhc2MsIEFpc01heCk7XG4gICAgfTtcblxuICAgIHRoaXMuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlckNhcmQpIHtcbiAgICAgICAgaWYgKCFvdGhlckNhcmQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHRoaXMucG9pbnQgPT0gb3RoZXJDYXJkLnBvaW50KSAmJiAodGhpcy5jb2xvciA9PSBvdGhlckNhcmQuY29sb3IpXG4gICAgICAgICAgICAmJiAodGhpcy5zaW5kZXggPT0gb3RoZXJDYXJkLnNpbmRleCk7XG4gICAgfTtcblxuICAgIGlmIChwb2ludCAmJiBjb2xvcikge1xuICAgICAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQoY29sb3IsIHBvaW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBudW1iZXIgPSBOdW1iZXIocG9pbnQpO1xuICAgIGlmICghTnVtYmVyLmlzTmFOKG51bWJlcikpIHtcbiAgICAgICAgdGhpcy5faW5pdFdpdGhOdW1iZXIobnVtYmVyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YocG9pbnQpID09ICdzdHJpbmcnKSB7XG4gICAgICAgIC8vIOino+aekCB4eHh4ZF9kIOW9ouW8j1xuICAgICAgICBsZXQgZm91bmQgPSBwb2ludC5tYXRjaCgvKFxcLikqXFxkX1xcZCsvKTtcbiAgICAgICAgaWYgKChmb3VuZCBpbnN0YW5jZW9mIEFycmF5KSAmJiBmb3VuZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gZm91bmRbMF07XG4gICAgICAgICAgICBsZXQgbnVtYmVycyA9IHJlc3VsdC5zcGxpdCgnXycpO1xuXG4gICAgICAgICAgICBsZXQgY29sb3IgPSBOdW1iZXIobnVtYmVyc1swXSk7XG4gICAgICAgICAgICBsZXQgcG9pbnQgPSBOdW1iZXIobnVtYmVyc1sxXSk7XG5cbiAgICAgICAgICAgIHRoaXMuX2luaXRXaXRoQ29sb3JBbmRQb2ludChjb2xvciwgcG9pbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YocG9pbnQpID09ICdvYmplY3QnKSB7XG4gICAgICAgIHRoaXMuX2luaXRXaXRoT2JqZWN0KHBvaW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNjLmVycm9yKFwi5Yid5aeL5YyW6ZSZ6K+v77yaXCIgKyBwb2ludCArIFwiIFwiICsgY29sb3IpO1xufTtcblxuLy8g6L2s5o2i5oiQ5pyN5Yqh5Zmo55qE54mMIG1vZGVsXG5LUUNhcmQucHJvdG90eXBlLnRvU2VydmVyQ2FyZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICAnc3VpdCc6IHRoaXMuY29sb3IsXG4gICAgICAgICdudW1iZXInOiB0aGlzLnBvaW50LFxuICAgIH07XG59O1xuXG5LUUNhcmQuQ09MT1JfU1BBREUgICA9IDQ7XG5LUUNhcmQuQ09MT1JfSEVBUlQgICA9IDM7XG5LUUNhcmQuQ09MT1JfQ0xVQiAgICA9IDI7XG5LUUNhcmQuQ09MT1JfRElBTU9ORCA9IDE7XG5cbm1vZHVsZS5leHBvcnRzID0gS1FDYXJkO1xuXG5LUUNhcmQuY2FyZHNGcm9tQXJyYXkgPSBmdW5jdGlvbiAoY2FyZE5hbWVzKSB7XG4gICAgcmV0dXJuIGNhcmROYW1lcy5tYXAoZnVuY3Rpb24gKGNhcmROYW1lLGluZGV4KSB7XG4gICAgICAgIHJldHVybiBuZXcgS1FDYXJkKGNhcmROYW1lLG51bGwsaW5kZXgpO1xuICAgIH0pO1xufTtcblxuLy8g5bCG5aSa5byg54mM6L2s5o2i5oiQ5pyN5Yqh5Zmo55qE5b2i5byPXG5LUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICByZXR1cm4gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLnRvU2VydmVyQ2FyZCgpO1xuICAgIH0pO1xufTtcblxuS1FDYXJkLlRZUEUgPSB7XG4gICAgV3VMb25nOiAwLFxuICAgIER1aVppOiAxLFxuICAgIExpYW5nRHVpOiAyLFxuICAgIFNhblRpYW86IDMsXG4gICAgU2h1blppOiA0LFxuICAgIFRvbmdIdWE6IDUsXG4gICAgSHVMdTogNixcbiAgICBUaWVaaGk6IDcsXG4gICAgVG9uZ0h1YVNodW46IDgsXG4gICAgLyojIyMjIyovXG4gICAgV3VUb25nOjksXG4gICAgLyojIyMjIyovXG4gICAgU2FuVGFvSHVhOiAxMCwgIC8vIOeJueauiueJjFxuICAgIFNhblNodW5aaTogMTEsXG4gICAgTGl1RHVpQmFuOiAxMixcblxuICAgIFd1RHVpU2FuVGlhbzoxMyxcbiAgICBTaVRhb1NhblRpYW86IDE0LFxuXG4gICAgQ291WWlTZTogMTUsXG4gICAgU2FuRmVuVGlhblhpYTogMTYsXG4gICAgU2FuVG9uZ0h1YVNodW46IDE3LFxuICAgIFlpVGlhb0xvbmc6IDE4LFxuICAgIFFpbmdMb25nOiAxOSxcbn07XG5cbi8vIOeJjOexu+Wei+WQjVxuS1FDYXJkLmNhcmRzVHlwZU5hbWUgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbmFtZXMgPSBbJ+S5jOm+mScsICflr7nlrZAnLCAn5Lik5a+5JywgJ+S4ieadoScsICfpobrlrZAnLCAn5ZCM6IqxJywgJ+iRq+iKpicsICfpk4HmlK8nLCAn5ZCM6Iqx6aG6JywgJ+S6lOWQjCcsXG4gICAgICAgICfkuInlkIzoirEnLCAn5LiJ6aG65a2QJywn5YWt5a+55Y2KJywgJ+S6lOWvueS4ieadoScsICflm5vlpZfkuInmnaEnLFxuICAgICAgICAn5YeR5LiA6ImyJywn5LiJ5YiG5aSp5LiLJywgJ+S4ieWQjOiKsemhuicsICfkuIDmnaHpvpknLCAn5riF6b6ZJ107XG4gICAgbGV0IHR5cGUgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzKTtcbiAgICByZXR1cm4gbmFtZXNbdHlwZV07XG59O1xuXG4vLyDmib7lh7rniYznmoTnsbvlnotcbktRQ2FyZC5jYXJkc1R5cGUgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoS1FDYXJkLmlzUWluZ0xvbmcoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5RaW5nTG9uZztcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmlzWWlUaWFvTG9uZyhjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLllpVGlhb0xvbmc7XG4gICAgfVxuXG4gICAgLy9pZiAoS1FDYXJkLmlzU2FuVG9uZ0h1YVNodW4oY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNhblRvbmdIdWFTaHVuO1xuICAgIC8vfVxuICAgIC8vXG4gICAgLy9pZiAoS1FDYXJkLmlzU2FuRmVuVGlhblhpYShjYXJkcykpIHtcbiAgICAvLyAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuRmVuVGlhblhpYTtcbiAgICAvL31cblxuICAgIGlmIChLUUNhcmQuaXNMaXVEdWlCYW4oY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5MaXVEdWlCYW47XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1NhblRvbmdIdWEoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5UYW9IdWE7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1NhblNodW5aaShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNhblNodW5aaTtcbiAgICB9XG5cblxuICAgIC8vaWYgKEtRQ2FyZC5pc0NvdVlpU2UoY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLkNvdVlpU2U7XG4gICAgLy99XG4gICAgLy9cbiAgICAvL2lmIChLUUNhcmQuaXNXdUR1aVNhblRpYW8oY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1RHVpU2FuVGlhbztcbiAgICAvL31cbiAgICAvL1xuICAgIC8vaWYgKEtRQ2FyZC5pc1NpVGFvU2FuVGlhbyhjYXJkcykpIHtcbiAgICAvLyAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2lUYW9TYW5UaWFvO1xuICAgIC8vfVxuXG4gICAgLyojIyMjIyovXG4gICAgaWYgKEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRzLCA1KSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuV3VUb25nO1xuICAgIH1cblxuICAgIC8vaWYgKEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRzKSkge1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5XdVRvbmc7XG4gICAgLy99XG4gICAgLy9cbiAgICAvL2lmIChLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcykpIHtcbiAgICAvLyAgICByZXR1cm4gS1FDYXJkLlRZUEUuV3VUb25nO1xuICAgIC8vfVxuICAgIC8qIyMjIyMqL1xuXG4gICAgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMsIDUpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5Ub25nSHVhU2h1bjtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5UaWVaaGkoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5UaWVaaGk7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5jb250YWluSHVMdShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLkh1THU7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlRvbmdIdWE7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5jb250YWluU2h1blppKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2h1blppO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpblNhblRpYW8oY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5UaWFvO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpbkxpYUR1aShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLkxpYW5nRHVpO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpbkR1aVppKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuRHVpWmk7XG4gICAgfVxuXG4gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1TG9uZztcbn07XG5cbi8vIOWIpOaWreaYr+WQpuaYr+WQjOiKsVxuS1FDYXJkLmlzVG9uZ0h1YSA9IGZ1bmN0aW9uKGNhcmRzLCBtaW5MZW5ndGggPSAzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGNvbG9ycyA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC5jb2xvcjtcbiAgICB9KTtcblxuICAgIGxldCBjb2xvciA9IGNvbG9yc1swXTtcbiAgICBmb3IgKGxldCBpbmRleCBpbiBjb2xvcnMpIHtcbiAgICAgICAgbGV0IGUgPSBjb2xvcnNbaW5kZXhdO1xuICAgICAgICBpZiAoZSAhPSBjb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcblxuLy8g5piv5ZCm5YyF5ZCr5ZCM6IqxXG5LUUNhcmQuY29udGFpblRvbmdIdWEgPSBmdW5jdGlvbiAoY2FyZHMsIG1pbkxlbmd0aCA9IDUpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy9pZiAoS1FDYXJkLmZpbmRUb25nSHVhKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgLy8gICAgcmV0dXJuIHRydWU7XG4gICAgLy99XG4gICAgLy9yZXR1cm4gZmFsc2U7XG4gICAgY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRzKTtcbiAgICBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlDb2xvcik7XG5cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAgIG1pbkxlbmd0aCA9IG1pbkxlbmd0aC1jYXJkMjAubGVuZ3RoO1xuXG4gICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBtaW5MZW5ndGgpIDw9IGNhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuICAgICAgICBsZXQgc3ViQ2FyZHMgPSBjYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBtaW5MZW5ndGgpO1xuICAgICAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YShzdWJDYXJkcywgbWluTGVuZ3RoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWEyMChjYXJkcyk7XG59O1xuS1FDYXJkLmNvbnRhaW5Ub25nSHVhMjAgPSBmdW5jdGlvbiAoY2FyZCkge1xuICAgIGlmIChjYXJkLmxlbmd0aCA8IDUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkKTtcbiAgICB2YXIgY2FyZHMgPSBjYXJkLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuXG4gICAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICAgICAgdmFyIG51bSA9IDUgLSBqO1xuICAgICAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gY2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICAgICAgICB2YXIgc3ViQ2FyZHMgPSBjYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuICAgICAgICAgICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWEoc3ViQ2FyZHMsIG51bSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuLy8g5Yik5pat5piv5ZCm5piv6aG65a2QXG5LUUNhcmQuaXNTaHVuWmkgPSBmdW5jdGlvbihjYXJkcywgbWluTGVuZ3RoID0gMykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuX2lzU2h1blppQUtRKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBsZXQgcG9pbnRzID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLnBvaW50O1xuICAgIH0pLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICB9KTtcblxuICAgIHZhciBwb2ludCA9IHBvaW50c1swXTtcbiAgICBmb3IgKHZhciBpbmRleCBpbiBwb2ludHMpIHtcbiAgICAgICAgdmFyIGUgPSBwb2ludHNbaW5kZXhdO1xuICAgICAgICBpZiAoZSAhPSBwb2ludCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcG9pbnQgPSBwb2ludCArIDE7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG4vLyDliKTmlq3mmK/lkKbmmK8gQSBLIFEgSiAxMCDov5nkuKrpobrlrZBcbktRQ2FyZC5faXNTaHVuWmlBS1EgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gY2FyZHMubGVuZ3RoO1xuICAgIGlmIChsZW5ndGgubGVuZ3RoIDwgMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHBvaW50MXMgPSBbMV07XG4gICAgbGV0IHBvaW50MTRzID0gWzE0XTtcbiAgICBsZXQgcG9pbnRLID0gMTM7XG5cbiAgICBOdW1iZXIobGVuZ3RoIC0gMSkua3FfdGltZXMoZnVuY3Rpb24odGltZXMpIHtcbiAgICAgICAgcG9pbnQxcy5wdXNoKHBvaW50SyAtIHRpbWVzKTtcbiAgICAgICAgcG9pbnQxNHMucHVzaChwb2ludEsgLSB0aW1lcyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gS1FDYXJkLl9pc0NhcmRzQ29udGFpblBvaW50cyhjYXJkcywgcG9pbnQxcykgfHwgS1FDYXJkLl9pc0NhcmRzQ29udGFpblBvaW50cyhjYXJkcywgcG9pbnQxNHMpO1xufTtcblxuLy8gY2FyZHMg5Lit5piv5ZCm5YyF5ZCrIHBvaW50cyDov5nkupvngrnmlbBcblxuS1FDYXJkLl9pc0NhcmRzQ29udGFpblBvaW50cyA9IGZ1bmN0aW9uKGNhcmRzLCBwb2ludHMpIHtcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcG9pbnRzLmxlbmd0aDsgKytpbmRleCkge1xuICAgICAgICBsZXQgcG9pbnQgPSBwb2ludHNbaW5kZXhdO1xuICAgICAgICBsZXQgcG9pbnRDYXJkSW5kZXggPSBjYXJkcy5maW5kSW5kZXgoZnVuY3Rpb24oY2FyZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gcG9pbnQ7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChwb2ludENhcmRJbmRleCA8IDApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufTtcbktRQ2FyZC5jb250YWluMjAgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZihjYXJkcy5sZW5ndGggPD0gMCl7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgaWYodHlwZW9mKGNhcmRzWzBdLnBvaW50KSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRzKTtcbiAgICB9XG4gICAgdmFyIG5ld0NhcmQgPSBjYXJkcy5maWx0ZXIoZnVuY3Rpb24oY2FyZCl7Ly/ph43mlrDotYvlgLxjYXJkc1xuICAgICAgICBpZihjYXJkLnBvaW50ID49IDIwKXtcbiAgICAgICAgICAgIHJldHVybiBjYXJkO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIG5ld0NhcmQgfHwgW107XG59O1xuLy8g5piv5ZCm5YyF5ZCr6aG65a2QXG5LUUNhcmQuY29udGFpblNodW5aaSA9IGZ1bmN0aW9uIChjYXJkcywgbWluTGVuZ3RoID0gNSkge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoS1FDYXJkLmZpbmRTaHVuWmkoY2FyZHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgICAvL2xldCB1bmlxdWVDYXJkcyA9IGNhcmRzLnVuaXF1ZShmdW5jdGlvbihjYXJkMSwgY2FyZDIpIHtcbiAgICAvLyAgICByZXR1cm4gY2FyZDEucG9pbnQgPT0gY2FyZDIucG9pbnQ7XG4gICAgLy99KTtcbiAgICAvL3VuaXF1ZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KTtcbiAgICAvL1xuICAgIC8vbGV0IG1pblBvaW50Q2FyZCA9IHVuaXF1ZUNhcmRzWzBdO1xuICAgIC8vaWYgKG1pblBvaW50Q2FyZC5wb2ludCA9PSAxKSB7XG4gICAgLy8gICAgbGV0IEFQbHVzQ2FyZCA9IG5ldyBLUUNhcmQobWluUG9pbnRDYXJkKTtcbiAgICAvLyAgICBBUGx1c0NhcmQucG9pbnQgPSAxNDtcbiAgICAvLyAgICB1bmlxdWVDYXJkcy5wdXNoKEFQbHVzQ2FyZCk7XG4gICAgLy99XG4gICAgLy9cbiAgICAvL2ZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbWluTGVuZ3RoKSA8PSB1bmlxdWVDYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAvLyAgICBsZXQgc3ViQ2FyZHMgPSB1bmlxdWVDYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBtaW5MZW5ndGgpO1xuICAgIC8vICAgIGlmIChLUUNhcmQuaXNTaHVuWmkoc3ViQ2FyZHMsIG1pbkxlbmd0aCkpIHtcbiAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgfVxuICAgIC8vfVxuICAgIC8vXG4gICAgLy9yZXR1cm4gS1FDYXJkLmNvbnRhaW5TaHVuWmkyMChjYXJkcyk7XG59O1xuLypLUUNhcmQuY29udGFpblNodW5aaTIwID0gZnVuY3Rpb24gKGNhcmQpIHtcbiBpZiAoY2FyZC5sZW5ndGggPCA1KSB7XG4gcmV0dXJuIGZhbHNlO1xuIH1cbiB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkKTtcbiB2YXIgY2FyZHMgPSBjYXJkLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gLy8g5YWI5qC55o2u54K55pWw5Y676YeNXG4gdmFyIG5ld0FyciA9IFtdO1xuIHZhciBuZXdBcnJzID0gW107XG4gZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkcy5sZW5ndGg7IGkrKykge1xuIGlmIChuZXdBcnJzLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKSB7XG4gbmV3QXJyLnB1c2goY2FyZHNbaV0pO1xuIG5ld0FycnMucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gfVxuIH1cbiAvL25ld0Fyci5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe1xuIC8vICAgIGlmKGNhcmQuc2NvcmVzID09IDE0KXtcbiAvLyAgICAgICAgY2FyZC5zY29yZXMgPSAxO1xuIC8vICAgIH1cbiAvL30pXG4gbmV3QXJyLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuIHJldHVybiBuMS5wb2ludCAtIG4yLnBvaW50O1xuIH0pO1xuIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gdmFyIG51bSA9IDUgLSBqO1xuIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbnVtKSA8PSBuZXdBcnIubGVuZ3RoOyArK3N0YXJ0KSB7XG4gdmFyIHN1YkNhcmRzID0gbmV3QXJyLnNsaWNlKHN0YXJ0LCBzdGFydCArIG51bSk7XG4gdmFyIGJvb2wgPSBwYXJzZUludChzdWJDYXJkc1tudW0tMV1bJ3Njb3JlcyddKSAtIHBhcnNlSW50KHN1YkNhcmRzWzBdWydzY29yZXMnXSkgPCA1O1xuIGlmKGJvb2wpe1xuIHJldHVybiB0cnVlO1xuIH1cbiB9XG4gfVxuIC8vIOeUseS6jueCueaVsOaYr+WUr+S4gOS4lOWNh+W6j++8jOWPqumcgOimgeS+neasoemBjeWOhuWIpOaWreaYr+WQpuaYr+mhuuWtkOWNs+WPr1xuIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZCk7XG4gaWYgKGNhcmQgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gcmV0dXJuIGZhbHNlO1xuIH1cbiByZXR1cm4gS1FDYXJkLmNvbnRhaW5TaHVuWmkyMChjb252ZXJ0ZWRDYXJkcyk7XG4gfTsqL1xuLy8g5piv5ZCm5piv5ZCM6Iqx6aG6XG5LUUNhcmQuaXNUb25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHJldHVybiBLUUNhcmQuaXNUb25nSHVhKGNhcmRzKSAmJiBLUUNhcmQuaXNTaHVuWmkoY2FyZHMpO1xufTtcblxuLy8g5piv5ZCm5YyF5ZCr5pyJ5ZCM6Iqx6aG6XG5LUUNhcmQuY29udGFpblRvbmdIdWFTaHVuID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChLUUNhcmQuZmluZFRvbmdIdWFTaHVuKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gICAgLy92YXIgc2FuU2h1blppID0gS1FDYXJkLnNhblNodW5aaTEoY2FyZHMsbWluTGVuZ3RoKVswXTtcbiAgICAvL2lmKHNhblNodW5aaSA9PSBudWxsKXtcbiAgICAvLyAgICByZXR1cm4gZmFsc2U7XG4gICAgLy99XG4gICAgLy92YXIgcmVzdWx0ID0gZmFsc2U7XG4gICAgLy9mb3IodmFyIGk9MDtpPHNhblNodW5aaS5sZW5ndGg7aSsrKSB7XG4gICAgLy8gICAgdmFyIHMgPSBzYW5TaHVuWmlbaV07XG4gICAgLy8gICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHMsIG1pbkxlbmd0aCkpIHtcbiAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgfVxuICAgIC8vfVxuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4xKGNhcmRzKTtcblxufTtcbi8qS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bjEgPSBmdW5jdGlvbiAoY2FyZHMsIG1pbkxlbmd0aCA9IDUpIHtcbiBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gcmV0dXJuIGZhbHNlO1xuIH1cbiBsZXQgdGVtcENhcmRzID0gQXJyYXkuZnJvbShjYXJkcykuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbWluTGVuZ3RoKSA8PSB0ZW1wQ2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gbGV0IHN1YkNhcmRzID0gdGVtcENhcmRzLnNsaWNlKHN0YXJ0LCBzdGFydCArIG1pbkxlbmd0aCk7XG4gaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHN1YkNhcmRzLCBtaW5MZW5ndGgpKSB7XG4gcmV0dXJuIHRydWU7XG4gfVxuIH1cblxuIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZHMpO1xuIGlmIChjYXJkcyA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiByZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bjIwKGNhcmRzKTtcbiB9XG4gcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4xKGNvbnZlcnRlZENhcmRzKTtcbiAvL3JldHVybiBmYWxzZTtcbiB9O1xuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4yMCA9IGZ1bmN0aW9uIChjYXJkLCBtaW5MZW5ndGggPSA1KSB7XG4gaWYgKGNhcmQubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gcmV0dXJuIGZhbHNlO1xuIH1cbiB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkKSB8fCBbXTtcbiB2YXIgY2FyZHMgPSBjYXJkLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG5cbiBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xuIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcbiB2YXIgY29sb3JIID0gW107IC8v57qi5b+DXG4gdmFyIGNvbG9yQyA9IFtdOyAvL+aiheiKsVxuIHZhciBjb2xvckQgPSBbXTsgLy/mlrnlnZdcbiB2YXIgcG9pbnRTID0gW107IC8v6buR5qGDXG4gdmFyIHBvaW50SCA9IFtdOyAvL+e6ouW/g1xuIHZhciBwb2ludEMgPSBbXTsgLy/mooXoirFcbiB2YXIgcG9pbnREID0gW107IC8v5pa55Z2XXG4gZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiBpZihjYXJkc1tpXS5jb2xvciA9PSAnNCcpe1xuIGlmKHBvaW50Uy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gcG9pbnRTLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuIGNvbG9yUy5wdXNoKGNhcmRzW2ldKTtcbiB9XG5cbiB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMycpe1xuIGlmKHBvaW50SC5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gcG9pbnRILnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuIGNvbG9ySC5wdXNoKGNhcmRzW2ldKTtcbiB9XG4gfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzInKXtcbiBpZihwb2ludEMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuIHBvaW50Qy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiBjb2xvckMucHVzaChjYXJkc1tpXSk7XG4gfVxuIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcxJyl7XG4gaWYocG9pbnRELmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiBwb2ludEQucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gY29sb3JELnB1c2goY2FyZHNbaV0pO1xuIH1cbiB9XG4gfVxuXG4gdmFyIGNvbG9yID0gW2NvbG9yUyxjb2xvckgsY29sb3JDLGNvbG9yRF07XG4gdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gZm9yKHZhciBpPTA7aTxjb2xvci5sZW5ndGg7aSsrKXtcbiBpZihjb2xvcltpXS5sZW5ndGggPj0gcGFyc2VJbnQoNSAtIGNhcmQyMC5sZW5ndGgpKXtcbiAvL2NvbG9yW2ldLmZvckVhY2goZnVuY3Rpb24oY2Epe1xuIC8vICAgIGlmKGNhLnNjb3JlcyA9PSAxNCl7XG4gLy8gICAgICAgIGNhLnNjb3JlcyA9IDE7XG4gLy8gICAgfVxuIC8vfSlcbiBjb2xvcltpXS5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiByZXR1cm4gYTEgLSBhMjtcbiB9KVxuIGNvbG9yU3VtLnB1c2goY29sb3JbaV0pO1xuIH1cbiB9XG5cbiBmb3IodmFyIGk9MDtpPGNvbG9yU3VtLmxlbmd0aDtpKyspIHtcbiB2YXIgcyA9IGNvbG9yU3VtW2ldXG4gZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiB2YXIgbnVtID0gNSAtIGo7XG4gZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gdmFyIHN1YkNhcmRzID0gcy5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuIHZhciBib29sID0gcGFyc2VJbnQoc3ViQ2FyZHNbbnVtLTFdWydzY29yZXMnXSkgLSBwYXJzZUludChzdWJDYXJkc1swXVsnc2NvcmVzJ10pIDwgNTtcbiBpZihib29sKXtcbiByZXR1cm4gdHJ1ZTtcbiB9XG4gfVxuIH1cbiB9XG5cblxuXG4gbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkKTtcbiBpZiAoY2FyZCA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiByZXR1cm4gZmFsc2U7XG4gfVxuIHJldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMjAoY29udmVydGVkQ2FyZHMpO1xuIH07Ki9cblxuXG4vLyDmmK/lkKbmmK/muIXpvplcbktRQ2FyZC5pc1FpbmdMb25nID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEzO1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gICAgdmFyIGNvbG9ySCA9IFtdOyAvL+e6ouW/g1xuICAgIHZhciBjb2xvckMgPSBbXTsgLy/mooXoirFcbiAgICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gICAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY2FyZHNbaV0uc3VpdCA9PSAncycpe1xuICAgICAgICAgICAgY29sb3JTLnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5zdWl0ID09ICdoJyl7XG4gICAgICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2MnKXtcbiAgICAgICAgICAgIGNvbG9yQy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnZCcpe1xuICAgICAgICAgICAgY29sb3JELnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBscyA9IGNvbG9yUy5sZW5ndGg7ICAvL+m7keahg+S4quaVsFxuICAgIHZhciBsaCA9IGNvbG9ySC5sZW5ndGg7ICAvL+e6ouahg+S4quaVsFxuICAgIHZhciBsYyA9IGNvbG9yQy5sZW5ndGg7ICAvL+aiheiKseS4quaVsFxuICAgIHZhciBsZCA9IGNvbG9yRC5sZW5ndGg7ICAvL+aWueWdl+S4quaVsFxuICAgIHZhciBjb2xvciA9IFtscyxsaCxsYyxsZF07XG4gICAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gICAgZm9yKHZhciBpPTA7aTxjb2xvci5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY29sb3JbaV0gIT0gMCl7XG4gICAgICAgICAgICBjb2xvclN1bS5wdXNoKGNvbG9yW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZihjb2xvclN1bS5sZW5ndGggPT0gMSl7XG4gICAgICAgIGlmKGNvbG9yU3VtWzBdID09IDEzKXtcblxuICAgICAgICAgICAgaWYoS1FDYXJkLmlzWWlUaWFvTG9uZyhjYXJkcykpe1xuXG4gICAgICAgICAgICAgICAgdmFyIHRlU2h1Q2FyZCA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaX0pO1xuXG4gICAgICAgICAgICAgICAgdGVTaHVDYXJkID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KHRlU2h1Q2FyZCk7XG5cbiAgICAgICAgICAgICAgICB0ZVNodUNhcmQuZm9yRWFjaChmdW5jdGlvbihhKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoYS5zY29yZXMgPT0gMSkgYS5zY29yZXMgPSAxNDtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRlU2h1Q2FyZC5zb3J0KGZ1bmN0aW9uKGEsYil7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiLnNjb3JlcyAtIGEuc2NvcmVzO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGVTaHVDYXJkID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKHRlU2h1Q2FyZCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYTEgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYTIgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XG5cbiAgICAgICAgICAgICAgICBjYy50ZVNodVBhaUNhcmRzID0gW3RlU2h1Q2FyZCwgYTIsIGExXTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG4gICAgLy9yZXR1cm4gS1FDYXJkLmlzVG9uZ0h1YVNodW4oY2FyZHMpO1xuICAgIHJldHVybiBmYWxzZTtcbn07XG5cbi8vIOaYr+WQpuaYr+S4gOadoem+mVxuS1FDYXJkLmlzTG9uZyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSAxMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIEtRQ2FyZC5pc1NodW5aaShjYXJkcyk7XG59O1xuXG4vKiMjIyMjKi9cbi8q5piv5ZCm5LiA5p2h6b6ZKi9cbktRQ2FyZC5pc1lpVGlhb0xvbmcgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAvL2NhcmRzOntudW1iZXI6MX4xMyAsJ3N1aXQnOidoJy4uLn1cbiAgICB2YXIgbGVuZ3RoID0gMTM7XG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5udW1iZXIpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMoY2FyZHMpO1xuICAgIH1cbiAgICB2YXIgbnVtYmVyID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLm51bWJlcjtcbiAgICB9KS5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgcmV0dXJuIG4xIC0gbjI7XG4gICAgfSk7XG4gICAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGgtMTtpKyspIHtcbiAgICAgICAgaWYobnVtYmVyW2ldICE9IG51bWJlcltpKzFdIC0gMSl7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgdGVTaHVDYXJkID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpfSk7XG5cbiAgICB0ZVNodUNhcmQgPSBLUUNhcmQuY2FyZHNGcm9tQXJyYXkodGVTaHVDYXJkKTtcblxuICAgIHRlU2h1Q2FyZC5mb3JFYWNoKGZ1bmN0aW9uKGEpe1xuICAgICAgICBpZihhLnNjb3JlcyA9PSAxKSBhLnNjb3JlcyA9IDE0O1xuICAgIH0pO1xuXG4gICAgdGVTaHVDYXJkLnNvcnQoZnVuY3Rpb24oYSxiKXtcbiAgICAgICAgcmV0dXJuIGIuc2NvcmVzIC0gYS5zY29yZXM7XG4gICAgfSk7XG5cbiAgICB0ZVNodUNhcmQgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHModGVTaHVDYXJkKTtcblxuICAgIHZhciBhMSA9IHRlU2h1Q2FyZC5zcGxpY2UoMCw1KTtcblxuICAgIHZhciBhMiA9IHRlU2h1Q2FyZC5zcGxpY2UoMCw1KTtcblxuICAgIGNjLnRlU2h1UGFpQ2FyZHMgPSBbdGVTaHVDYXJkLCBhMiwgYTFdO1xuICAgIC8vY2MubG9nKGNjLnRlU2h1UGFpQ2FyZHMgKVxuICAgIC8vY2MubG9nKCctLS0tLS0tLTcyOCcpXG4gICAgcmV0dXJuIHRydWU7XG59O1xuLyojIyMjIyovXG4vKuaYr+WQpuS4ieWQjOiKsSovXG5LUUNhcmQuaXNTYW5Ub25nSHVhID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdmFyIGxlbmd0aCA9IDEzO1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mKGNhcmRzWzBdLnN1aXQpID09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzKGNhcmRzKTtcbiAgICB9XG4gICAgdmFyIGNvbG9yUyA9IFtdOyAvL+m7keahg1xuICAgIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgICB2YXIgY29sb3JDID0gW107IC8v5qKF6IqxXG4gICAgdmFyIGNvbG9yRCA9IFtdOyAvL+aWueWdl1xuICAgIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ3MnKXtcbiAgICAgICAgICAgIGNvbG9yUy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnaCcpe1xuICAgICAgICAgICAgY29sb3JILnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5zdWl0ID09ICdjJyl7XG4gICAgICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2QnKXtcbiAgICAgICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgbHMgPSBjb2xvclMubGVuZ3RoOyAgLy/pu5HmoYPkuKrmlbBcbiAgICB2YXIgbGggPSBjb2xvckgubGVuZ3RoOyAgLy/nuqLmoYPkuKrmlbBcbiAgICB2YXIgbGMgPSBjb2xvckMubGVuZ3RoOyAgLy/mooXoirHkuKrmlbBcbiAgICB2YXIgbGQgPSBjb2xvckQubGVuZ3RoOyAgLy/mlrnlnZfkuKrmlbBcbiAgICB2YXIgc2FuQ2FyZCA9IFtjb2xvclMsY29sb3JILGNvbG9yQyxjb2xvckRdO1xuICAgIHZhciB0ZVNodUNhcmQgPSBbXTtcbiAgICB2YXIgY29sb3IgPSBbbHMsbGgsbGMsbGRdO1xuICAgIHZhciBjb2xvclN1bSA9IFtdOyAgICAvL+aAu+WFseacieWHoOenjeiKseiJsiBbNSwzLDAuLi4uXVxuICAgIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKGNvbG9yW2ldICE9IDApe1xuICAgICAgICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgICAgICAgICB0ZVNodUNhcmQucHVzaChzYW5DYXJkW2ldKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8v5LiJ56eN6Iqx6ImyXG4gICAgaWYoY29sb3JTdW0ubGVuZ3RoID09IDMpe1xuICAgICAgICBmb3IodmFyIGk9MDtpPGNvbG9yU3VtLmxlbmd0aDtpKyspIHtcbiAgICAgICAgICAgIGlmIChjb2xvclN1bVtpXSAhPSA1ICYmIGNvbG9yU3VtW2ldICE9IDMpe1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0ZVNodUNhcmQuc29ydChmdW5jdGlvbihhLGIpe1xuICAgICAgICAgICAgcmV0dXJuIGEubGVuZ3RoIC0gYi5sZW5ndGg7XG4gICAgICAgIH0pO1xuICAgICAgICBjYy50ZVNodVBhaUNhcmRzID0gdGVTaHVDYXJkO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuXG59O1xuLyrmmK/lkKblh5HkuIDoibIqL1xuS1FDYXJkLmlzQ291WWlTZSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYodHlwZW9mKGNhcmRzWzBdLnN1aXQpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzKGNhcmRzKTtcbiAgICB9XG4gICAgdmFyIGNvbG9yUyA9IFtdOyAvL+m7keahg1xuICAgIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihjYXJkc1tpXS5zdWl0ID09ICdzJyB8fCBjYXJkc1tpXS5zdWl0ID09ICdjJyl7XG4gICAgICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7Ly/lhajpu5FcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnaCcgfHwgY2FyZHNbaV0uc3VpdCA9PSAnZCcpe1xuICAgICAgICAgICAgY29sb3JILnB1c2goY2FyZHNbaV0pOy8v5YWo57qiXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL+WmguaenOeJjOS4reWMheWQq+Wbm+enjeiKseiJsuWwseS4jeWPr+iDveaYr+S4ieWQjOiKsVxuICAgIGlmKGNvbG9yUy5sZW5ndGggPT0gMTMgfHwgY29sb3JILmxlbmd0aCA9PSAxMyl7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvL2Vsc2UgaWYoY29sb3JILmxlbmd0aCA9PSAxMyl7XG4gICAgLy8gICAgcmV0dXJuIHRydWU7XG4gICAgLy99XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcbi8qIyMjIyMqL1xuLy8g5piv5ZCm5piv5YWt5a+55Y2KXG5LUUNhcmQuaXNMaXVEdWlCYW4gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTI7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGR1aVppTGVuZ3RoID0gMjtcbiAgICAvL+iuoeeul+S4gOS4queJjOaVsOe7hOWGheeahOebuOWQjOeCueaVsOeahOeJjOeahOW8oOaVsFxuICAgIGxldCBjYXJkTnVtYmVycyA9IG5ldyBHZXRDYXJkUG9pbnRzU2FtZUNvdW50KGNhcmRzKTtcbiAgICBsZXQgbnVtYmVyT2ZEdWlaaSA9IDA7XG4gICAgbGV0IG51bWJlck9mWWkgPSAwO1xuICAgIGZvciAobGV0IHByb3AgaW4gY2FyZE51bWJlcnMpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gY2FyZE51bWJlcnNbcHJvcF07XG4gICAgICAgIGlmICh2YWx1ZSA9PSBkdWlaaUxlbmd0aCB8fCB2YWx1ZSA9PSAzKSB7XG4gICAgICAgICAgICBudW1iZXJPZkR1aVppID0gbnVtYmVyT2ZEdWlaaSArIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPT0gNCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAyO1xuICAgICAgICB9XG4gICAgICAgIC8vZWxzZSBpZiAodmFsdWUgPT0gNiB8fCB2YWx1ZSA9PSA3IHx8IHZhbHVlID09IDUpIHtcbiAgICAgICAgLy8gICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAwO1xuICAgICAgICAvL31cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPT0gMSkge1xuICAgICAgICAgICAgbnVtYmVyT2ZZaSArPSAxO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYobnVtYmVyT2ZEdWlaaSA9PSA2KXtcblxuICAgICAgICB2YXIgdGVTaHVDYXJkID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpfSk7XG5cbiAgICAgICAgdGVTaHVDYXJkID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KHRlU2h1Q2FyZCk7XG5cbiAgICAgICAgdGVTaHVDYXJkLmZvckVhY2goZnVuY3Rpb24oYSl7XG4gICAgICAgICAgICBpZihhLnNjb3JlcyA9PSAxKSBhLnNjb3JlcyA9IDE0O1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZVNodUNhcmQuc29ydChmdW5jdGlvbihhLGIpe1xuICAgICAgICAgICAgcmV0dXJuIGIuc2NvcmVzIC0gYS5zY29yZXM7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyh0ZVNodUNhcmQpO1xuXG4gICAgICAgIHZhciBhMSA9IHRlU2h1Q2FyZC5zcGxpY2UoMCw1KTtcblxuICAgICAgICB2YXIgYTIgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XG5cbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9IFt0ZVNodUNhcmQsIGEyLCBhMV07XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cbktRQ2FyZC5pc1d1RHVpU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSAxMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgZHVpWmlMZW5ndGggPSAyO1xuICAgIGxldCBzYW5UaWFvTGVuZ3RoID0gMztcbiAgICAvL+iuoeeul+S4gOS4queJjOaVsOe7hOWGheeahOebuOWQjOeCueaVsOeahOeJjOeahOW8oOaVsFxuICAgIGxldCBjYXJkTnVtYmVycyA9IG5ldyBHZXRDYXJkUG9pbnRzU2FtZUNvdW50KGNhcmRzKTtcbiAgICBsZXQgbnVtYmVyT2ZEdWlaaSA9IDA7XG4gICAgbGV0IG51bWJlck9mU2FuVGlhbyA9IDA7XG4gICAgZm9yIChsZXQgcHJvcCBpbiBjYXJkTnVtYmVycykge1xuICAgICAgICBsZXQgdmFsdWUgPSBjYXJkTnVtYmVyc1twcm9wXTtcbiAgICAgICAgaWYgKHZhbHVlID09IGR1aVppTGVuZ3RoKSB7XG4gICAgICAgICAgICBudW1iZXJPZkR1aVppID0gbnVtYmVyT2ZEdWlaaSArIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPT0gc2FuVGlhb0xlbmd0aCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZTYW5UaWFvID0gbnVtYmVyT2ZTYW5UaWFvICsgMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSA+PSA0KSB7XG4gICAgICAgICAgICBudW1iZXJPZkR1aVppID0gbnVtYmVyT2ZEdWlaaSArIDI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bWJlck9mRHVpWmkgPT0gNSAmJiBudW1iZXJPZlNhblRpYW8gPT0gMTtcbn07XG5cbi8v5Yik5patNeW8oOaIluiAhTPlvKDmmK/lkKbpobrlrZBcbktRQ2FyZC5pc1NodW5aaTEgPSBmdW5jdGlvbihhcnIpe1xuICAgIC8vY29uc29sZS5sb2coYXJyKTtcbiAgICBmb3IodmFyIGk9MDtpPGFyci5sZW5ndGgtMTtpKyspe1xuICAgICAgICBpZihhcnJbaSsxXSAtIGFycltpXSAhPSAxKXtcbiAgICAgICAgICAgIC8v5LiN5piv6aG65a2QXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwi5LiN5piv6aG65a2QXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcblxuS1FDYXJkLmlzU2FuU2h1blppID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdmFyIGxlbmd0aCA9IDEzO1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5zdWl0KSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XG4gICAgfVxuXG4gICAgLy/lj5blh7rniYznmoTngrnmlbBcbiAgICB2YXIgbnVtYmVyID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLm51bWJlcjtcbiAgICB9KTtcbiAgICAvL+aOkuW6j1xuICAgIG51bWJlci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgcmV0dXJuIG4xIC0gbjI7XG4gICAgfSk7XG4gICAgaWYoS1FDYXJkLmZlblpodShudW1iZXIsNSw1KSA9PSBmYWxzZSl7XG4gICAgICAgIHZhciBudW1iZXIgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgICAgIHJldHVybiBjYXJkLm51bWJlcjtcbiAgICAgICAgfSk7XG4gICAgICAgIC8v5o6S5bqPXG4gICAgICAgIG51bWJlci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYoS1FDYXJkLmZlblpodShudW1iZXIsNSwzKSA9PSBmYWxzZSl7XG4gICAgICAgICAgICB2YXIgbnVtYmVyID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhcmQubnVtYmVyO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL+aOkuW6j1xuICAgICAgICAgICAgbnVtYmVyLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZihLUUNhcmQuZmVuWmh1KG51bWJlciwzLDUpID09IGZhbHNlKXtcbiAgICAgICAgICAgICAgICAvL+S4jeaYr+S4iemhuuWtkFxuICAgICAgICAgICAgICAgIHZhciBBSXNFeGlzdCA9IGZhbHNlOyAgLy/mmK/lkKblrZjlnKhBXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpIGluIGNhcmRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKGNhcmRzW2ldLm51bWJlciA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBBSXNFeGlzdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwi5a2Y5ZyoQVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKCFBSXNFeGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwi6YCA5Ye66YCS5b2SXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpIGluIGNhcmRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKGNhcmRzW2ldLm51bWJlciA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiQei9rOS4ujE0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNbaV0ubnVtYmVyID0gMTQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZihjYy50ZVNodVBhaUNhcmRzICYmIGNjLnRlU2h1UGFpQ2FyZHMubGVuZ3RoID4gMCAmJiBjYy50ZVNodVBhaUNhcmRzWzBdWzBdICAmJiB0eXBlb2YoY2MudGVTaHVQYWlDYXJkc1swXVswXSkgPT0gJ251bWJlcicpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q2FyZHMgPSBjYXJkcy5maWx0ZXIoZnVuY3Rpb24oaSl7cmV0dXJuIGk7fSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdDYXJkczEgPSBjYy50ZVNodVBhaUNhcmRzLm1hcChmdW5jdGlvbihhcnIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhZCA9IGFyci5tYXAoZnVuY3Rpb24obnVtYmVyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbmV3Q2FyZHMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihuZXdDYXJkc1tpXS5udW1iZXIgPT0gbnVtYmVyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdDYXJkcy5zcGxpY2UoaSwxKVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FkO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9IG5ld0NhcmRzMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5pc1NhblNodW5aaShjYXJkcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYoY2MudGVTaHVQYWlDYXJkcyAmJiBjYy50ZVNodVBhaUNhcmRzLmxlbmd0aCA+IDAgJiYgY2MudGVTaHVQYWlDYXJkc1swXVswXSAgJiYgdHlwZW9mKGNjLnRlU2h1UGFpQ2FyZHNbMF1bMF0pID09ICdudW1iZXInKXtcbiAgICAgICAgdmFyIG5ld0NhcmRzID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpO30pO1xuICAgICAgICB2YXIgbmV3Q2FyZHMxID0gY2MudGVTaHVQYWlDYXJkcy5tYXAoZnVuY3Rpb24oYXJyKXtcbiAgICAgICAgICAgIHZhciBjYWQgPSBhcnIubWFwKGZ1bmN0aW9uKG51bWJlcil7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IG5ld0NhcmRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgaWYobmV3Q2FyZHNbaV0ubnVtYmVyID09IG51bWJlcil7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3Q2FyZHMuc3BsaWNlKGksMSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGNhZDtcbiAgICAgICAgfSk7XG4gICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMgPSBuZXdDYXJkczE7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcblxuLy/liIbnu4Q1NTN8fDUzNXx8MzU1XG5LUUNhcmQuZmVuWmh1ID0gZnVuY3Rpb24gKG51bWJlcixudW0xLG51bTIpICB7XG4gICAgdmFyIGFycjEgPSBbXTtcbiAgICB2YXIgYXJyMiA9IFtdO1xuICAgIHZhciBhcnIzID0gW107XG4gICAgZm9yKHZhciBpPTA7aTxudW1iZXIubGVuZ3RoLTE7aSsrKXtcbiAgICAgICAgaWYoaSA9PSAwKXtcbiAgICAgICAgICAgIGFycjEucHVzaChudW1iZXJbMF0pO1xuICAgICAgICB9XG4gICAgICAgIGlmKG51bWJlcltpKzFdIC0gbnVtYmVyW2ldID09IDApe1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgYXJyMS5wdXNoKG51bWJlcltpKzFdKTtcbiAgICAgICAgaWYoYXJyMS5sZW5ndGggPT0gbnVtMSl7XG4gICAgICAgICAgICAvL+WPluesrOS4gOe7hOaYr+mhuuWtkFxuICAgICAgICAgICAgaWYoS1FDYXJkLmlzU2h1blppMShhcnIxKSl7XG4gICAgICAgICAgICAgICAgLy/ov5k15Liq5piv6aG65a2QLOS7juaVsOe7hOS4reenu+mZpFxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8YXJyMS5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBqPTA7ajxudW1iZXIubGVuZ3RoO2orKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXJbal0gPT0gYXJyMVtpXSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/kuKTkuKrmlbDkuIDmoLfnmoTlj6rliKDpmaTkuIDkuKpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXJbal0gPT0gbnVtYmVyW2orMV0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyLnNwbGljZShqLDEpOyAgICAvL+S7jm51bWJlcuS4reenu+mZpFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qY29uc29sZS5sb2coXCLliKDpmaTnrKzkuIDnu4TlkI7nmoRudW1iZXJcIik7XG4gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG51bWJlcik7Ki9cbiAgICAgICAgICAgICAgICAvL+aOpeS4i+adpeWPluesrOS6jOe7hFxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8bnVtYmVyLmxlbmd0aC0xO2krKyl7XG4gICAgICAgICAgICAgICAgICAgIGlmKGkgPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcnIyLnB1c2gobnVtYmVyWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZihudW1iZXJbaSsxXSAtIG51bWJlcltpXSA9PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGFycjIucHVzaChudW1iZXJbaSsxXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmKGFycjIubGVuZ3RoID09IG51bTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5Y+W56ys5LqM57uE5piv6aG65a2QXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoS1FDYXJkLmlzU2h1blppMShhcnIyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8YXJyMi5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBqPTA7ajxudW1iZXIubGVuZ3RoO2orKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXJbal0gPT0gYXJyMltpXSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/kuKTkuKrmlbDkuIDmoLfnmoTlj6rliKDpmaTkuIDkuKpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXJbal0gPT0gbnVtYmVyW2orMV0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyLnNwbGljZShqLDEpOyAgICAvL+S7jm51bWJlcuS4reenu+mZpFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qY29uc29sZS5sb2coXCLliKDpmaTnrKzkuoznu4TlkI7nmoRudW1iZXJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG51bWJlcik7Ki9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnIzID0gbnVtYmVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5o6l5LiL5p2l5bCx5piv5Ymp5LiL55qE5LqGXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoS1FDYXJkLmlzU2h1blppMShhcnIzKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v56ys5LiJ57uE5Lmf5piv6aG65a2QXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc2RmID0gW2FycjEsYXJyMixhcnIzXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc2RmLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge3JldHVybiBuMS5sZW5ndGggLSBuMi5sZW5ndGg7fSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWNjLnRlU2h1UGFpQ2FyZHMpIGNjLnRlU2h1UGFpQ2FyZHMgPSBhc2RmO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+esrOS4iee7hOS4jeaYr+mhuuWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8v56ys5LqM57uE5LiN5piv6aG65a2QXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL+esrOS4gOe7hOS4jeaYr+mhuuWtkFxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8v5aaC5p6c5Y+W5LiN5YiwbnVtMeS4quaVsFxuICAgIGlmKGFycjEubGVuZ3RoIDwgbnVtMSl7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYoYXJyMi5sZW5ndGggPCBudW0yKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn07XG5cbktRQ2FyZC5pc1NhblNodW5aaTEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gMTM7XG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5wb2ludCkgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICBjYXJkcyA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkcyk7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRzKTtcbiAgICBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XG4gICAgdmFyIHdlaSA9IFtdO1xuICAgIHZhciB6aG9uZyA9IFtdO1xuICAgIHZhciB0b3UgPSBbXTtcbiAgICB2YXIgc2FuU2h1blppID0gS1FDYXJkLnNhblNodW5aaTEoY2FyZHMpWzBdOy8v6I635Y+W5omA5pyJ57uE5ZCI55qE5aS06YGTXG4gICAgaWYoIXNhblNodW5aaSl7IC8v5L2g6L+e5aS06YGT6YO95rKh5pyJIOaAjuS5iOabtOaIkea3t1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIG5ld0NhcmQgPSBjYXJkcy5maWx0ZXIoZnVuY3Rpb24oaSl7Ly/ph43mlrDotYvlgLxjYXJkc1xuICAgICAgICByZXR1cm4gaTtcbiAgICB9KTtcbiAgICB2YXIgbmV3Q2FyZHMxID0gW107XG4gICAgdmFyIG5ld1BvaW50ID0gW107Ly/liKTmlq1wb2ludOaYr+WQpuebuOWQjFxuICAgIHZhciBkdWlaaSA9IFtdOy8v5Y+W5Ye65pyJ5a+55a2Q5b2T5Lit55qE5LiA5byg54mMXG4gICAgZm9yKHZhciBzIGluIGNhcmRzKXtcbiAgICAgICAgaWYobmV3UG9pbnQuaW5kZXhPZihjYXJkc1tzXS5wb2ludCk8MCl7XG4gICAgICAgICAgICBuZXdDYXJkczEucHVzaChjYXJkc1tzXSk7XG4gICAgICAgICAgICBuZXdQb2ludC5wdXNoKGNhcmRzW3NdLnBvaW50KTtcbiAgICAgICAgfWVsc2V7Ly/lj5blh7rmnInlr7nlrZDlvZPkuK3nmoTkuIDlvKDniYxcbiAgICAgICAgICAgIGR1aVppLnB1c2goY2FyZHNbc10pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBzYW5TaHVuWmkubGVuZ3RoOyArK2opIHsvL+W+queOr+aJgOacieWktOmBk1xuICAgICAgICB2YXIgbnVtYmVyMyA9IHNhblNodW5aaVtqXTtcbiAgICAgICAgaWYodHlwZW9mKG51bWJlcjMpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyAoaSkgPCBjYXJkcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIG5ld0NhcmRzID0gbmV3Q2FyZHMxLmZpbHRlcihmdW5jdGlvbihpKXsvL+mHjeaWsOi1i+WAvGNhcmRzXG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbmV3Q2FyZHMgPSBuZXdDYXJkcy5rcV9leGNsdWRlcyhudW1iZXIzKTsvL+WIoOmZpOeJjOmHjOeahOWktOmBk1xuICAgICAgICAgICAgaWYgKHdlaS5sZW5ndGggIT0gNSkge1xuICAgICAgICAgICAgICAgIGxldCBzdWJDYXJkcyA9IG5ld0NhcmRzLnNsaWNlKGksIGkgKyA1KTtcbiAgICAgICAgICAgICAgICBpZiAoc3ViQ2FyZHMubGVuZ3RoID09IDUgfHwgS1FDYXJkLmlzU2h1blppKHN1YkNhcmRzKSkgey8v5b6X5Yiw5bC+6YGTIOWIoOmZpOeJjOmHjOeahOWwvumBk1xuICAgICAgICAgICAgICAgICAgICB3ZWkgPSBzdWJDYXJkcztcbiAgICAgICAgICAgICAgICAgICAgLy8gY2MubG9nKG51bWJlcjMpXG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhuZXdDYXJkczEpXG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhzdWJDYXJkcylcbiAgICAgICAgICAgICAgICAgICAgLy8gY2MubG9nKG5ld0NhcmRzKVxuICAgICAgICAgICAgICAgICAgICAvLyBjYy5sb2coaSlcbiAgICAgICAgICAgICAgICAgICAgLy8gY2MubG9nKCctLS0tLTcxNicpXG4gICAgICAgICAgICAgICAgICAgIG5ld0NhcmRzID0gbmV3Q2FyZHMua3FfZXhjbHVkZXMoc3ViQ2FyZHMpO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZih3ZWkubGVuZ3RoID09IDUpey8v5oqK5Ymp5L2Z55qE54mM5ZKM5a+55a2Q55qE5Y2V5byg5ZCI5bm2XG4gICAgICAgICAgICAgICAgbGV0IHRhc2tzID0gZHVpWmkuZmlsdGVyKGZ1bmN0aW9uKGkpey8v6YeN5paw6LWL5YC85a+55a2QXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRhc2tzID0gdGFza3Mua3FfZXhjbHVkZXMobnVtYmVyMyk7Ly/liKTmlq3lpLTpgZPlkozlr7nlrZDnmoTljZXlvKDmmK/lkKbmnInnm7jlkIwg5pyJ55qE6K+d5bCx5Yig6ZmkXG4gICAgICAgICAgICAgICAgbmV3Q2FyZHMgPSBuZXdDYXJkcy5jb25jYXQodGFza3MpOy8v5oqK5Ymp5L2Z55qE54mM5ZKM5a+55a2Q55qE5Y2V5byg5ZCI5bm2XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh6aG9uZy5sZW5ndGggIT0gNSAmJiBuZXdDYXJkcy5sZW5ndGggPT0gNSkge1xuICAgICAgICAgICAgICAgIGlmIChLUUNhcmQuaXNTaHVuWmkobmV3Q2FyZHMpKSB7Ly/mmK/kuInpobrlrZBcbiAgICAgICAgICAgICAgICAgICAgemhvbmcgPSBuZXdDYXJkcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih3ZWkubGVuZ3RoID09IDUgJiYgemhvbmcubGVuZ3RoID09IDUgKXsvL+aYr+S4iemhuuWtkOe7iOatouW+queOr1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXsvL+adpeWQpyDnu6fnu63lkKdcbiAgICAgICAgICAgICAgICB6aG9uZyA9IFtdO3dlaSA9IFtdO3RvdSA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKHdlaS5sZW5ndGggPT0gNSAmJiB6aG9uZy5sZW5ndGggPT0gNSApey8v5piv5LiJ6aG65a2Q57uI5q2i5b6q546vXG4gICAgICAgICAgICB0b3UgPSBudW1iZXIzO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXsvL+adpeWQpyDnu6fnu63lkKdcbiAgICAgICAgICAgIHpob25nID0gW107d2VpID0gW107dG91ID0gW107XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjYXJkcyA9IG5ld0NhcmQ7XG4gICAgaWYgKEtRQ2FyZC5faXNTYW5TaHVuWmkodG91LHpob25nLHdlaSkpIHsvL+aYr+S4iemhuuWtkFxuICAgICAgICB0b3UgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHModG91KTtcbiAgICAgICAgemhvbmcgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMoemhvbmcpO1xuICAgICAgICB3ZWkgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMod2VpKTtcblxuICAgICAgICBpZighY2MudGVTaHVQYWlDYXJkcykgY2MudGVTaHVQYWlDYXJkcyA9IFt0b3Usemhvbmcsd2VpXTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZHMpO1xuICAgIGlmIChjYXJkcyA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihhKXtcbiAgICAgICAgICAgIGlmKGEucG9pbnQgPT0gMTQpIGEucG9pbnQgPSAxO1xuICAgICAgICB9KTtcbiAgICAgICAgLy9yZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiBLUUNhcmQuaXNTYW5TaHVuWmkxKGNhcmRzKTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5pc1NhblNodW5aaShjb252ZXJ0ZWRDYXJkcyk7XG59O1xuXG5LUUNhcmQuc2FuU2h1blppMSA9IGZ1bmN0aW9uIChjYXJkcyxsZW5ndGggPSAzKSB7XG4gICAgdmFyIHNodW56aSA9IEtRQ2FyZC5maW5kU2h1blppKGNhcmRzLGxlbmd0aCk7XG4gICAgdmFyIGNhcmRzVCA9IFtdO1xuICAgIHZhciBjYXJkc0luZGV4ID0gW107XG4gICAgaWYoc2h1bnppID09IG51bGwpe1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBzaHVuemkubGVuZ3RoO2krKyl7XG4gICAgICAgIHZhciBhID0gc2h1bnppW2ldO1xuICAgICAgICB2YXIgY2FyZHNTaHVuemkgPSBbXTtcbiAgICAgICAgLy8gdmFyIGNhcmRzSW5kZXggPSBbXTtcbiAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IGEubGVuZ3RoO2orKyl7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSBhW2pdO1xuICAgICAgICAgICAgaWYodHlwZW9mKGNhcmRzW2luZGV4XSkgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FyZHNTaHVuemkucHVzaChjYXJkc1tpbmRleF0pO1xuXG4gICAgICAgIH1cbiAgICAgICAgY2FyZHNJbmRleC5wdXNoKGEpO1xuICAgICAgICBjYXJkc1QucHVzaChjYXJkc1NodW56aSk7XG4gICAgfVxuICAgIHJldHVybiBbY2FyZHNULGNhcmRzSW5kZXhdO1xufTtcblxuS1FDYXJkLl9pc1NhblNodW5aaSA9IGZ1bmN0aW9uICh0b3VDYXJkcywgemhvbmdDYXJkcywgd2VpQ2FyZHMpIHtcbiAgICByZXR1cm4gS1FDYXJkLmlzU2h1blppKHRvdUNhcmRzKSAmJiBLUUNhcmQuaXNTaHVuWmkoemhvbmdDYXJkcylcbiAgICAgICAgJiYgS1FDYXJkLmlzU2h1blppKHdlaUNhcmRzKTtcbn07XG4vLyDmmK/lkKbmmK/kuInlkIzoirHpobpcbktRQ2FyZC5pc1NhblRvbmdIdWFTaHVuID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdmFyIGxlbmd0aCA9IDEzO1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBsZXQgY29sb3JDYXJkc09iamVjdCA9IEtRQ2FyZC5fY29sb3JDbGFzc0NhcmRzKGNhcmRzKTtcblxuICAgIHZhciBzdWJDYXJkcyA9IFtdO1xuICAgIGZvciAobGV0IHByb3AgaW4gY29sb3JDYXJkc09iamVjdCkge1xuICAgICAgICBsZXQgY2FyZHMgPSBjb2xvckNhcmRzT2JqZWN0W3Byb3BdO1xuICAgICAgICBzdWJDYXJkcy5wdXNoKGNhcmRzKTtcbiAgICB9XG5cbiAgICBpZiAoc3ViQ2FyZHMubGVuZ3RoICE9IDMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHN1YkNhcmRzID0gc3ViQ2FyZHMuc29ydChmdW5jdGlvbiAoczEsIHMyKSB7XG4gICAgICAgIHJldHVybiBzMS5sZW5ndGggPiBzMi5sZW5ndGg7XG4gICAgfSk7XG5cbiAgICBsZXQgdG91Q2FyZHMgPSBzdWJDYXJkc1swXTtcbiAgICBsZXQgemhvbmdDYXJkcyA9IHN1YkNhcmRzWzFdO1xuICAgIGxldCB3ZWlDYXJkcyA9IHN1YkNhcmRzWzJdO1xuXG4gICAgaWYgKCh0b3VDYXJkcy5sZW5ndGggIT0gMykgfHwgKHpob25nQ2FyZHMubGVuZ3RoICE9IDUpIHx8ICh3ZWlDYXJkcy5sZW5ndGggIT0gNSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiBLUUNhcmQuX2lzU2FuVG9uZ0h1YVNodW4odG91Q2FyZHMsIHpob25nQ2FyZHMsIHdlaUNhcmRzKTtcbn07XG5cbi8vIOWwhueJjOagueaNriBjb2xvciDov5vooYzliIbnsbtcbktRQ2FyZC5fY29sb3JDbGFzc0NhcmRzID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGNvbG9yQ2FyZHNPYmplY3QgPSB7fTtcbiAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIGxldCBjb2xvciA9IGNhcmQuY29sb3I7XG4gICAgICAgIHZhciBzdWJDYXJkcyA9IGNvbG9yQ2FyZHNPYmplY3RbY29sb3JdO1xuICAgICAgICBpZiAoIXN1YkNhcmRzKSB7XG4gICAgICAgICAgICBzdWJDYXJkcyA9IFtdO1xuICAgICAgICAgICAgY29sb3JDYXJkc09iamVjdFtjb2xvcl0gPSBzdWJDYXJkcztcbiAgICAgICAgfVxuICAgICAgICBzdWJDYXJkcy5wdXNoKGNhcmQpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNvbG9yQ2FyZHNPYmplY3Q7XG59O1xuXG4vLyDmmK/lkKbmmK/kuInlkIzoirHpobpcbktRQ2FyZC5faXNTYW5Ub25nSHVhU2h1biA9IGZ1bmN0aW9uICh0b3VDYXJkcywgemhvbmdDYXJkcywgd2VpQ2FyZHMpIHtcbiAgICByZXR1cm4gS1FDYXJkLmlzVG9uZ0h1YVNodW4odG91Q2FyZHMpICYmIEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHpob25nQ2FyZHMpXG4gICAgICAgICYmIEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHdlaUNhcmRzKTtcbn07XG5cblxuLy8g5piv5ZCm5pivIOKAnOS4ieWIhuWkqeS4i+KAnVxuS1FDYXJkLmlzU2FuRmVuVGlhblhpYSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSAxMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgdGllWmhpTGVuZ3RoID0gNDtcbiAgICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICBsZXQgbnVtYmVyT2ZUaWVaaGkgPSAwO1xuICAgIGZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXTtcbiAgICAgICAgaWYgKHZhbHVlID09IHRpZVpoaUxlbmd0aCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZUaWVaaGkgPSBudW1iZXJPZlRpZVpoaSArIDE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bWJlck9mVGllWmhpID09PSAzO1xufTtcblxuXG4vLyDmmK/lkKbmmK8g4oCc5Zub5aWX5LiJ5p2h4oCdXG5LUUNhcmQuaXNTaVRhb1NhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGxldCBzYW5UaWFvTGVuZ3RoID0gMztcbiAgICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICBsZXQgbnVtYmVyT2ZTYW5UaWFvID0gMDtcbiAgICBmb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgICBsZXQgdmFsdWUgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF07XG4gICAgICAgIGlmICh2YWx1ZSA9PSBzYW5UaWFvTGVuZ3RoKSB7XG4gICAgICAgICAgICBudW1iZXJPZlNhblRpYW8gPSBudW1iZXJPZlNhblRpYW8gKyAxO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bWJlck9mU2FuVGlhbyA9PSA0O1xufTtcblxuXG4vLyDmmK/lkKbmmK8g4oCc5LiJ5qGD6Iqx4oCdXG4vLyDlpLTjgIHkuK3jgIHlsL7pgZPkuLrnm7jlkIzoirHoibLnmoTniYxcbktRQ2FyZC5pc1NhblRhb0h1YSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSAxMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGV0IGNvbG9ySGVscGVyID0gbmV3IEtRQ2FyZENvbG9yc0hlbHBlcihjYXJkcyk7XG4gICAgdmFyIGNvbG9yTnVtYmVycyA9IFtdO1xuICAgIGZvciAobGV0IHByb3AgaW4gY29sb3JIZWxwZXIuY29sb3JOdW1iZXIpIHtcbiAgICAgICAgY29sb3JOdW1iZXJzLnB1c2goY29sb3JIZWxwZXIuY29sb3JOdW1iZXJbcHJvcF0pO1xuICAgIH1cblxuICAgIGNvbG9yTnVtYmVycy5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgcmV0dXJuIG4xIC0gbjI7XG4gICAgfSk7XG5cbiAgICBpZiAoY29sb3JOdW1iZXJzLmxlbmd0aCAhPSAzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoY29sb3JOdW1iZXJzWzBdID09IDNcbiAgICAgICAgJiYgKGNvbG9yTnVtYmVyc1sxXSA9PSA1KVxuICAgICAgICAmJiAoY29sb3JOdW1iZXJzWzJdID09IDUpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cblxuLy8g5Yik5pat5piv5ZCm5YyF5ZCr6ZOB5pSvXG4vLyDlm5vlvKDlkIzmoLfngrnmlbDnmoTniYxcbktRQ2FyZC5jb250YWluVGllWmhpID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDQ7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgbGVuZ3RoID0gbGVuZ3RoLWNhcmQyMC5sZW5ndGg7XG4gICAgbGV0IGhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgICAgdmFyIG1heE51bWJlciA9IGhlbHBlci5wb2ludE51bWJlcnNbd107XG4gICAgICAgIGlmKG1heE51bWJlciA+PSBsZW5ndGgpe1xuICAgICAgICAgICAgY2FyZDIwLmZvckVhY2goZnVuY3Rpb24oY2Epe1xuICAgICAgICAgICAgICAgIGNhLnNjb3JlcyA9IHBhcnNlSW50KHcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvL2lmKGhlbHBlci5tYXhOdW1iZXIoKSA+PSBsZW5ndGgpe1xuICAgIC8vICAgIHJldHVybiBoZWxwZXIubWF4TnVtYmVyKCkgPj0gbGVuZ3RoO1xuICAgIC8vfVxuICAgIC8vIGVsc2V7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5jb250YWluR3VpUGFpKGNhcmRzLDQpO1xuICAgIC8vfVxuICAgIC8vaWYgKEtRQ2FyZC5maW5kVGllWmhpKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgLy8gICAgcmV0dXJuIHRydWU7XG4gICAgLy99XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuXG4vLyDliKTmlq3mmK/lkKbmmK/pk4HmlK9cbktRQ2FyZC5pc1RpZVpoaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSA0O1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMucmVkdWNlKGZ1bmN0aW9uIChwb2ludCwgY2FyZCkge1xuICAgICAgICBpZiAocG9pbnQgPT0gY2FyZC5wb2ludCkge1xuICAgICAgICAgICAgcmV0dXJuIHBvaW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9LCBjYXJkc1swXS5wb2ludCk7XG5cbiAgICByZXR1cm4gcmVzdWx0ICE9IC0xO1xufTtcblxuLyojIyMjI+aYr+WQpuWMheWQq+S6lOWQjCovXG4vL+S6lOW8oOWQjOagt+eCueaVsOeahOeJjFxuS1FDYXJkLmNvbnRhaW5XdVRvbmcgPSBmdW5jdGlvbihjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSA1O1xuICAgIGlmKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCl7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgICBsZW5ndGggPSBsZW5ndGgtY2FyZDIwLmxlbmd0aDtcbiAgICAvL+S6lOW8oOeJjOebuOWQjOeahFxuICAgIGxldCBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICAvL2Zvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgY2MubG9nKHcpXG4gICAgLy99XG4gICAgLy9jYy5sb2coY2FyZHMpXG4gICAgLy9jYy5sb2coaGVscGVyKVxuICAgIC8vY2MubG9nKGNhcmQyMClcbiAgICAvL2NjLmxvZyhoZWxwZXIubWF4TnVtYmVyKCkpXG4gICAgLy9jYy5sb2coJy0tLS0tLTEzMDcnKVxuICAgIC8vaWYoaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aCl7XG4gICAgLy8gICAgcmV0dXJuIGhlbHBlci5tYXhOdW1iZXIoKSA+PSBsZW5ndGg7XG4gICAgLy99XG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgICAgdmFyIG1heE51bWJlciA9IGhlbHBlci5wb2ludE51bWJlcnNbd107XG4gICAgICAgIGlmKG1heE51bWJlciA+PSBsZW5ndGgpe1xuICAgICAgICAgICAgY2FyZDIwLmZvckVhY2goZnVuY3Rpb24oY2Epe1xuICAgICAgICAgICAgICAgIGNhLnNjb3JlcyA9IHBhcnNlSW50KHcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG4vKuWIpOaWreaYr+WQpuS6lOWQjCovXG5LUUNhcmQuaXNXdVRvbmcgPSBmdW5jdGlvbihjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSA1O1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCByZXN1bHQgPSBjYXJkcy5yZWR1Y2UoZnVuY3Rpb24gKHBvaW50LCBjYXJkKSB7XG4gICAgICAgIGlmIChwb2ludCA9PSBjYXJkLnBvaW50KSB7XG4gICAgICAgICAgICByZXR1cm4gcG9pbnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH0sIGNhcmRzWzBdLnBvaW50KTtcblxuICAgIHJldHVybiByZXN1bHQgIT0gLTE7XG59O1xuLyojIyMjIyovXG5cbi8vIOaYr+WQpuaYryDigJzokavoiqbigJ1cbi8vIOS4ieW8oOebuOWQjCArIOS4gOWvuVxuS1FDYXJkLmNvbnRhaW5IdUx1ID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDU7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChLUUNhcmQuZmluZEh1THUoY2FyZHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8vbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgLy92YXIgcG9pbnROdW1iZXJzID0gW107XG4gICAgLy92YXIgaW5kZXggPSAwO1xuICAgIC8vZm9yIChsZXQgcHJvcCBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAvLyAgICBwb2ludE51bWJlcnNbaW5kZXhdID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3Byb3BdO1xuICAgIC8vICAgIGluZGV4ID0gaW5kZXggKyAxO1xuICAgIC8vfVxuICAgIC8vdmFyIGg9W107XG4gICAgLy92YXIgaDE9W107XG4gICAgLy9mb3IodmFyIGkgaW4gcG9pbnROdW1iZXJzKXtcbiAgICAvLyAgICB2YXIgcz1wb2ludE51bWJlcnNbaV07XG4gICAgLy8gICAgaWYocyA9PSAzKXtcbiAgICAvLyAgICAgICAgaC5wdXNoKHMpXG4gICAgLy8gICAgfVxuICAgIC8vICAgIGVsc2UgaWYocz09NCl7XG4gICAgLy8gICAgICAgIGgxLnB1c2gocylcbiAgICAvLyAgICB9XG4gICAgLy9cbiAgICAvL31cbiAgICAvL1xuICAgIC8vaWYgKChwb2ludE51bWJlcnMuaW5kZXhPZigzKSAhPSAtMSkgJiYgKHBvaW50TnVtYmVycy5pbmRleE9mKDIpICE9IC0xKVxuICAgIC8vIHx8IGgubGVuZ3RoID4gMSB8fCBoMS5sZW5ndGggPiAxIHx8KHBvaW50TnVtYmVycy5pbmRleE9mKDQpICE9IC0xKVxuICAgIC8vICYmIChwb2ludE51bWJlcnMuaW5kZXhPZigyKSAhPSAtMSkpIHtcbiAgICAvLyAgICByZXR1cm4gdHJ1ZTtcbiAgICAvL31cblxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cbi8vIOWIpOaWreaYr+WQpuaYryDokavoiqZcbktRQ2FyZC5pc0h1THUgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IDUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBwb2ludHMgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgcmV0dXJuIGNhcmQucG9pbnQ7XG4gICAgfSkuc29ydChmdW5jdGlvbiAocDEsIHAyKSB7XG4gICAgICAgIHJldHVybiBwMSAtIHAyO1xuICAgIH0pO1xuXG4gICAgdmFyIHAxID0gcG9pbnRzWzBdO1xuICAgIHZhciBwMiA9IHAxO1xuICAgIHZhciBudW1iZXJQMSA9IDA7XG4gICAgdmFyIG51bWJlclAyID0gMDtcblxuICAgIHBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwb2ludCkge1xuICAgICAgICBpZiAocG9pbnQgIT0gcDEgJiYgcG9pbnQgIT0gcDIpIHtcbiAgICAgICAgICAgIHAyID0gcG9pbnQ7XG4gICAgICAgICAgICBudW1iZXJQMiA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBudW1iZXJQMSA9IG51bWJlclAxICsgKChwb2ludCA9PSBwMSkgPyAxIDogMCk7XG4gICAgICAgIG51bWJlclAyID0gbnVtYmVyUDIgKyAoKHBvaW50ID09IHAyKSA/IDEgOiAwKTtcbiAgICB9KTtcblxuICAgIGxldCBtYXhOdW1iZXIgPSBNYXRoLm1heChudW1iZXJQMSk7XG4gICAgbGV0IG1pbk51bWJlciA9IE1hdGgubWluKG51bWJlclAyKTtcblxuICAgIHJldHVybiAobWluTnVtYmVyID09IDIpICYmIChtYXhOdW1iZXIgPT0gMyk7XG59O1xuXG4vLyDmmK/lkKbljIXlkKvmnIkg4oCc5LiJ5p2h4oCdXG5LUUNhcmQuY29udGFpblNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy9pZiAoS1FDYXJkLmZpbmRTYW5UaWFvKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgLy8gICAgcmV0dXJuIHRydWU7XG4gICAgLy99XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgICBsZW5ndGggPSBsZW5ndGgtY2FyZDIwLmxlbmd0aDtcbiAgICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICBmb3IodmFyIHcgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIHZhciBtYXhOdW1iZXIgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbd107XG4gICAgICAgIGlmKG1heE51bWJlciA+PSBsZW5ndGgpe1xuICAgICAgICAgICAgY2FyZDIwLmZvckVhY2goZnVuY3Rpb24oY2Epe1xuICAgICAgICAgICAgICAgIGNhLnNjb3JlcyA9IHBhcnNlSW50KHcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvL2ZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgaWYgKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXSA+PSBsZW5ndGgpIHtcbiAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgfVxuICAgIC8vfVxuICAgIHJldHVybiBmYWxzZTtcblxuICAgIC8vXG4gICAgLy9yZXR1cm4gS1FDYXJkLmNvbnRhaW5HdWlQYWkoY2FyZHMsMyk7XG59O1xuXG4vLyDmmK/lkKbmmK8g4oCc5LiJ5p2h4oCdXG5LUUNhcmQuaXNTYW5UaWFvID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCAhPSAzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMucmVkdWNlKGZ1bmN0aW9uIChwb2ludCwgY2FyZCkge1xuICAgICAgICBpZiAoY2FyZC5wb2ludCA9PSBwb2ludCkge1xuICAgICAgICAgICAgcmV0dXJuIHBvaW50O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH0sIGNhcmRzWzBdLnBvaW50KTtcblxuICAgIHJldHVybiByZXN1bHQgIT0gLTE7XG59O1xuXG4vLyDmmK/lkKbljIXlkKvmnIkg77ya5Lik5a+5XG5LUUNhcmQuY29udGFpbkxpYUR1aSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCA0KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKEtRQ2FyZC5maW5kTGlhRHVpKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvL3ZhciBudW1iZXJPZkR1aVppID0gMDtcbiAgICAvL2xldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIC8vZm9yIChsZXQgcHJvcCBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAvLyAgICBpZiAocG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3Byb3BdID09IDIpIHtcbiAgICAvLyAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAxO1xuICAgIC8vICAgICAgICBpZiAobnVtYmVyT2ZEdWlaaSA9PSAyKSB7XG4gICAgLy8gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAvLyAgICAgICAgfVxuICAgIC8vICAgIH1cbiAgICAvL31cblxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cbi8vIOaYr+WQpuaYryDkuKTlr7lcbktRQ2FyZC5pc0xpYUR1aSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gNCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgZm9yIChsZXQgcHJvcCBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgICAgaWYgKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXSAhPSAyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG4vLyDmmK/kuI3mmK/lr7nlrZBcbktRQ2FyZC5pc0R1aVppID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCAhPSAyKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgY2FyZDEgPSBjYXJkc1swXTtcbiAgICBsZXQgY2FyZDIgPSBjYXJkc1sxXTtcblxuICAgIHJldHVybiBjYXJkMS5wb2ludCA9PSBjYXJkMi5wb2ludDtcbn07XG5cbi8vIOaYr+WQpuWMheWQq+WvueWtkFxuS1FDYXJkLmNvbnRhaW5EdWlaaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAyO1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvL2lmIChLUUNhcmQuZmluZER1aVppKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgLy8gICAgcmV0dXJuIHRydWU7XG4gICAgLy99XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgICBsZW5ndGggPSBsZW5ndGgtY2FyZDIwLmxlbmd0aDtcbiAgICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICAvL2ZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgaWYgKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXSA+PSBsZW5ndGgpIHtcbiAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgfVxuICAgIC8vfVxuICAgIGZvcih2YXIgdyBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgICAgdmFyIG1heE51bWJlciA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1t3XTtcbiAgICAgICAgaWYobWF4TnVtYmVyID49IGxlbmd0aCl7XG4gICAgICAgICAgICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihjYSl7XG4gICAgICAgICAgICAgICAgY2Euc2NvcmVzID0gcGFyc2VJbnQodyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpbkd1aVBhaShjYXJkcywyKTtcbn07XG5cbktRQ2FyZC5jb250YWluR3VpUGFpID0gZnVuY3Rpb24gKGNhcmRzICwgbGVuZ3RoKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgbGV0IGhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIHZhciBtYXhOdW1iZXIgPSAoaGVscGVyLm1heE51bWJlcigpICsgY2FyZDIwLmxlbmd0aCk7XG4gICAgcmV0dXJuIG1heE51bWJlciA+PSBsZW5ndGg7XG59O1xuLyojIyMjIyovXG4vLyDmmK/lkKbmmK/nibnmrorniYxcbktRQ2FyZC5pc1RlU2h1UGFpID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IDEzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gS1FDYXJkLmlzUWluZ0xvbmcoY2FyZHMpXG4gICAgICAgIHx8IEtRQ2FyZC5pc1lpVGlhb0xvbmcoY2FyZHMpXG4gICAgICAgIHx8IEtRQ2FyZC5pc0xpdUR1aUJhbihjYXJkcylcbiAgICAgICAgfHwgS1FDYXJkLmlzU2FuU2h1blppKGNhcmRzKVxuICAgICAgICB8fCBLUUNhcmQuaXNTYW5Ub25nSHVhKGNhcmRzKVxuICAgICAgICAvKnx8IEtRQ2FyZC5pc1NhblRvbmdIdWFTaHVuKGNhcmRzKVxuICAgICAgICAgfHwgS1FDYXJkLmlzU2FuRmVuVGlhblhpYShjYXJkcylcbiAgICAgICAgIHx8IEtRQ2FyZC5pc1NpVGFvU2FuVGlhbyhjYXJkcylcblxuICAgICAgICAgfHwgS1FDYXJkLmlzV3VEdWlTYW5UaWFvKGNhcmRzKVxuICAgICAgICAgfHwgS1FDYXJkLmlzQ291WWlTZShjYXJkcykqLztcbn07XG5cbi8vIOWwhueJjOS4reeahCAxIOWPmOWMluS4uiBB77yIMTQpXG5LUUNhcmQuX2NvbnZlcnRPbmVUb0EgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMuZmluZChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gMTtcbiAgICAgICAgfSkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBjYXJkcztcbiAgICB9XG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICBpZiAoY2FyZC5wb2ludCA9PSAxKSB7XG4gICAgICAgICAgICBsZXQgbmV3Q2FyZCA9IG5ldyBLUUNhcmQoMTQsIGNhcmQuY29sb3IpO1xuICAgICAgICAgICAgcmV0dXJuIG5ld0NhcmQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuS1FDYXJkLl9jb252ZXJ0T25lVG9BMSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5maW5kKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FyZC5wb2ludCA9PSAxO1xuICAgICAgICB9KSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGNhcmRzO1xuICAgIH1cbiAgICB2YXIgbnVtID0gMDtcbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIGlmIChjYXJkLnBvaW50ID09IDEgJiYgbnVtID09IDApIHtcbiAgICAgICAgICAgIG51bSsrO1xuICAgICAgICAgICAgbGV0IG5ld0NhcmQgPSBuZXcgS1FDYXJkKDE0LCBjYXJkLmNvbG9yKTtcbiAgICAgICAgICAgIHJldHVybiBuZXdDYXJkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYXJkO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8vIEtRQ2FyZCDnmoTmjpLluo/mlrnms5VcbktRQ2FyZC5zb3J0QnlQb2ludCA9IGZ1bmN0aW9uIChjYXJkMSwgY2FyZDIpIHtcbiAgICBsZXQgcmVzdWx0ID0gTnVtYmVyKGNhcmQxLnBvaW50KSAtIE51bWJlcihjYXJkMi5wb2ludClcbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuS1FDYXJkLnNvcnRCeUNvbG9yID0gZnVuY3Rpb24gKGNhcmQxLCBjYXJkMiwgcG9pbnRBc2MgPSB0cnVlKSB7XG4gICAgaWYgKGNhcmQyLmNvbG9yID09IGNhcmQxLmNvbG9yKSB7XG4gICAgICAgIHJldHVybiAoY2FyZDEucG9pbnQgLSBjYXJkMi5wb2ludCkgKiAocG9pbnRBc2MgPyAxIDogLTEpO1xuICAgIH1cbiAgICByZXR1cm4gY2FyZDIuY29sb3IgLSBjYXJkMS5jb2xvcjtcbn1cblxuS1FDYXJkLnNvcnQgPSBmdW5jdGlvbiAoY2FyZDEsIGNhcmQyLCBhc2MgPSB0cnVlLCBBaXNNYXggPSB0cnVlKSB7XG4gICAgbGV0IHJlc3VsdCA9IDE7XG4gICAgaWYgKGNhcmQxLnBvaW50ID09IGNhcmQyLnBvaW50KSB7XG4gICAgICAgIHJlc3VsdCA9IGNhcmQxLmNvbG9yIC0gY2FyZDIuY29sb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHBvaW50MSA9IGNhcmQxLnBvaW50O1xuICAgICAgICB2YXIgcG9pbnQyID0gY2FyZDIucG9pbnQ7XG4gICAgICAgIGlmIChBaXNNYXggJiYgcG9pbnQxID09IDEpIHtcbiAgICAgICAgICAgIHBvaW50MSA9IDE0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEFpc01heCAmJiBwb2ludDIgPT0gMSkge1xuICAgICAgICAgICAgcG9pbnQyID0gMTQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXN1bHQgPSBwb2ludDEgLSBwb2ludDI7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdCAqIChhc2MgPyAxIDogLTEpO1xufTtcblxuLy/ovazkuLrlrqLmiLfnq6/nmoTniYxcbktRQ2FyZC5fY29udmVydENhcmRzVG9DYXJkTmFtZXMgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAvLyBbe1wic3VpdFwiOlwic1wiLFwibnVtYmVyXCI6MTB9XVxuICAgIGxldCBzdWl0Q29sb3JNYXAgPVsnJywnZCcsJ2MnLCdoJywncyddO1xuICAgIHJldHVybiBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgdmFyIGNhcmROdW1iZXIgPSBjYXJkLnBvaW50O1xuICAgICAgICBsZXQgY29sb3IgPSBzdWl0Q29sb3JNYXBbY2FyZC5jb2xvcl07XG4gICAgICAgIGxldCBudW1iZXIgPSBNYXRoLm1heChNYXRoLm1pbihjYXJkTnVtYmVyLCAxMyksIDEpO1xuICAgICAgICByZXR1cm4ge251bWJlcjpudW1iZXIsc3VpdDpjb2xvcn07XG4gICAgfSk7XG59OyIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcblxubGV0IEtRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIgPSB7XG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5fZGlkU3RhcnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9kaWRTdGFydCA9IHRydWU7XG5cbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUZvcmNlRXhpdCwgdGhpcy5fZm9yY2VFeGl0QXBwLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgX2ZvcmNlRXhpdEFwcDogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgS1FOYXRpdmVJbnZva2UuZm9yY2VFeGl0QXBwKCk7XG4gICAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlcjsiLCJsZXQgS1FHbG9iYWxFdmVudCA9IHtcbiAgICBfaGFuZGxlczoge30sXG4gICAgLy/lj5HpgIHkuovku7ZcbiAgICBlbWl0OiBmdW5jdGlvbiAoZXZlbnROYW1lLCBkYXRhID0ge30pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRhID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBkYXRhID0geydkYXRhJzogZGF0YX07XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcmV0dXJucyA9IFtdIC8v6L+U5Zue5YC8XG4gICAgICAgIGRhdGEuZXZlbnROYW1lID0gZXZlbnROYW1lLy/kv53lrZjkuIDkuIvkuovku7blkI3lrZdcblxuICAgICAgICBmb3IgKCB2YXIgZmluZEV2ZW5OYW1lIGluIHRoaXMuX2hhbmRsZXMpe1xuICAgICAgICAgICAgaWYgKGZpbmRFdmVuTmFtZSA9PSBldmVudE5hbWUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2hhbmRsZXNbZmluZEV2ZW5OYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0dXJuVmFsdWUgPSB0aGlzLl9oYW5kbGVzW2ZpbmRFdmVuTmFtZV1baV0oZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJucy5wdXNoKHJldHVyblZhbHVlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXR1cm5zXG4gICAgfSxcbiAgICAvL+a3u+WKoOaZrumAmuS6i+S7tlxuICAgIG9uOiBmdW5jdGlvbiAoZXZlbnROYW1lLCBjYWxsYmFjaywgdGFyZ2V0KSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCfmlLbliLDkuovku7YnLCBldmVudE5hbWUpO1xuICAgICAgICB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV0gPSB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV0gfHwgW11cblxuICAgICAgICB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjay5iaW5kKHRhcmdldCkpXG4gICAgICAgIGNhbGxiYWNrLl9jYWxsZXIgPSB0YXJnZXQ7XG4gICAgfSxcblxuICAgIC8v6YCa6L+H5LqL5Lu25ZCN56e76Zmk5LiA5Liq55uR5ZCs5ZmoXG4gICAgb2ZmOiBmdW5jdGlvbiAoZXZlbnROYW1lKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5faGFuZGxlc1tldmVudE5hbWVdLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV1baV0gPSBudWxsXG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8g56e75Yqo5LiA5LiqIHRhcmdldCDkuIrmiYDmnInnmoTnm5HlkKxcbiAgICBvZmZUYXJnZXQ6IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcy5faGFuZGxlcykge1xuICAgICAgICB2YXIgZXZlbnRIYW5kbGVycyA9IHRoaXMuX2hhbmRsZXNbbmFtZV07XG4gICAgICAgIHZhciBpbmRleHMgPSBldmVudEhhbmRsZXJzLmZpbHRlcihmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2suX2NhbGxlciA9IHRhcmdldDtcbiAgICAgICAgfSkubWFwKGZ1bmN0aW9uIChjYWxsYmFjaywgaW5kZXgpIHtcbiAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBpbmRleE9mZnNldCA9IDA7XG4gICAgICAgIGluZGV4cy5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgIGV2ZW50SGFuZGxlcnMuc3BsaWNlKGluZGV4ICsgaW5kZXhPZmZzZXQsIDEpO1xuICAgICAgICAgIGluZGV4T2Zmc2V0ID0gaW5kZXhPZmZzZXQgKyAxO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBLUUdsb2JhbEV2ZW50O1xuIiwibGV0IEtRTmF0aXZlSW52b2tlID0ge1xuICBJT1NDbGFzc05hbWU6IFwiQXBwQ29udHJvbGxlclwiLFxuICBBTkRSSU9EQ2xhc3NOYW1lOiBcImNvbS9nb25ncGEvc3N6L0FwcEFjdGl2aXR5XCIsXG5cbiAgaXNOYXRpdmVJT1M6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgcGxhdGZvcm0gPSBjYy5zeXMucGxhdGZvcm07XG4gICAgaWYgKChwbGF0Zm9ybSA9PSBjYy5zeXMuSVBIT05FKSB8fCAocGxhdGZvcm0gPT0gY2Muc3lzLklQQUQpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIGlzTmF0aXZlQW5kcm9pZDogZnVuY3Rpb24gKCkge1xuICAgIGxldCBwbGF0Zm9ybSA9IGNjLnN5cy5wbGF0Zm9ybTtcbiAgICBpZiAocGxhdGZvcm0gPT0gY2Muc3lzLkFORFJPSUQpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG5cbiAgaXNOYXRpdmU6IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY2Muc3lzLmlzTmF0aXZlID09IHRydWU7XG4gIH1cbn07XG5cbi8vIE1BUks6IOWPr+iwg+eUqOeahOacrOWcsOaWueazlVxuLyoqXG4gKiDlvq7kv6HnmbvlvZVcbiAqL1xuS1FOYXRpdmVJbnZva2Uud3hMb2dpbiA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eExvZ2luXCIpOyAvL0lPU1xuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eExvZ2luXCIsIFwiKClWXCIpO1xuICB9XG59O1xuXG5cbi8qKlxuICog5YiG5Lqr5aSn5Y6F5L+h5oGv5Yiw5b6u5L+h5aW95Y+LXG4gKiBcbiAqL1xuS1FOYXRpdmVJbnZva2Uuc2hhcmVIYWxsVG9XZUNoYXRGcmllbmQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxGcmllbmRcIiwgKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVIYWxsRnJpZW5kXCIsIFwiKClWXCIpO1xuICB9XG59O1xuXG5cbi8qKlxuICog5YiG5Lqr5aSn5Y6F5L+h5oGv5Yiw5pyL5Y+L5ZyIXG4gKiBcbiAqL1xuS1FOYXRpdmVJbnZva2Uuc2hhcmVIYWxsVG9XZUNoYXRUaW1lbGluZSA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsICk7XG4gIH0gZWxzZSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsIFwiKClWXCIpO1xuICB9XG59O1xuXG4vKipcbiAqIOW8uuWItumAgOWHuiBBUFBcbiAqIFxuICovXG5LUU5hdGl2ZUludm9rZS5mb3JjZUV4aXRBcHAgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwiZXhpdEFwcFwiLCApO1xuICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZXhpdEFwcFwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIOS4i+i9veaWsOeJiOacrFxuICogXG4gKiBAcGFyYW0ge1N0cmluZ30gaW9zVXJsICAgICAgaU9TIOeJiOacrOWcsOWdgFxuICogQHBhcmFtIHtTdHJpbmd9IGFuZHJvaWRVcmwgIOWuieWNk+eJiOacrOWcsOWdgFxuICovXG5LUU5hdGl2ZUludm9rZS5kb3dubG9hZE5ld1ZlcnNpb24gPSBmdW5jdGlvbiAoaW9zVXJsLCBhbmRyb2lkVXJsKSB7XG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwiZG93bmxvYWROZXdWZXJzaW9uOlwiLCBpb3NVcmwpO1xuICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZG93bmxvYWROZXdWZXJzaW9uXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGFuZHJvaWRVcmwpO1xuICB9XG59O1xuXG5cbi8qKlxuICog5YiG5Lqr5oi/6Ze057uZ5b6u5L+h5aW95Y+LXG4gKiBcbiAqIEBwYXJhbSB7U3RyaW5nfSByb29tSWQgICAgICAgICDmiL/pl7QgaWQg5L+h5oGvXG4gKiBAcGFyYW0ge1N0cmluZ30gZGVzY3JpcHRpb24gICAg5paH5pys5o+P6L+wXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlUm9vbVRvV2VDaGF0RnJpZW5kID0gZnVuY3Rpb24gKHJvb21JZCwgZGVzY3JpcHRpb24pIHtcbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNoYXJlRnJpZW5kOmRlc2NyaXB0aW9uOlwiLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlRnJpZW5kXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XG4gIH1cbn07XG5cbi8qKlxuICog5YiG5Lqr5oi/6Ze05Yiw5b6u5L+h5pyL5Y+L5ZyIXG4gKiBcbiAqIEBwYXJhbSB7U3RyaW5nfSByb29tSWQgICAgICAgICDmiL/pl7QgaWQg5L+h5oGvXG4gKiBAcGFyYW0ge1N0cmluZ30gZGVzY3JpcHRpb24gICAg5paH5pys5o+P6L+wXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlUm9vbVRvV2VDaGF0VGltZWxpbmUgPSBmdW5jdGlvbiAocm9vbUlkLCBkZXNjcmlwdGlvbikge1xuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2hhcmU6ZGVzY3JpcHRpb246XCIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XG4gIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVcIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcbiAgfVxufTtcblxuLyoqXG4gKiDliIbkuqvlsY/luZXmiKrlm77liLDlvq7kv6Hlpb3lj4tcbiAqL1xuS1FOYXRpdmVJbnZva2Uuc2hhcmVTY3JlZW5Ub1dlQ2hhdEZyaWVuZCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNjcmVlblNoYXJlRnJpZW5kXCIsICk7XG4gIH0gZWxzZSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNjcmVlblNoYXJlRnJpZW5kXCIsIFwiKClWXCIpO1xuICB9XG59O1xuXG4vKipcbiAqIOWIhuS6q+Wxj+W5leaIquWbvuWIsOW+ruS/oeaci+WPi+WciFxuICovXG5LUU5hdGl2ZUludm9rZS5zaGFyZVNjcmVlblRvV2VDaGF0VGltZWxpbmUgPSBmdW5jdGlvbiAoKSB7XG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZVwiLCApO1xuICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZVwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuLyoqXG4gKiDlvIDlp4vlvZXpn7NcbiAqL1xuS1FOYXRpdmVJbnZva2Uuc3RhcnRSZWNvcmQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwicmVjb3JkXCIpO1xuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInJlY29yZFwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuLyoqXG4gKiDnu5PmnZ/lvZXpn7NcbiAqL1xuS1FOYXRpdmVJbnZva2UuZW5kUmVjb3JkID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcImVuZFJlY29yZFwiKTtcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJlbmRSZWNvcmRcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cbktRTmF0aXZlSW52b2tlLnNjcmVlbnNob3RTaGFyZSA9IGZ1bmN0aW9uKHN0cmluZ3MgPSAnc2hhcmVJTUcnKSB7XG4gICAgICAgIGlmKHRoaXMuX2lzQ2FwdHVyaW5nKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pc0NhcHR1cmluZyA9IHRydWU7XG4gICAgICAgIHZhciBzaXplID0gY2MuZGlyZWN0b3IuZ2V0V2luU2l6ZSgpO1xuICAgICAgICB2YXIgZmlsZU5hbWUgPSBcInJlc3VsdF9zaGFyZS5qcGdcIjtcbiAgICAgICAgdmFyIGZ1bGxQYXRoID0ganNiLmZpbGVVdGlscy5nZXRXcml0YWJsZVBhdGgoKSArIGZpbGVOYW1lO1xuICAgICAgICBpZihqc2IuZmlsZVV0aWxzLmlzRmlsZUV4aXN0KGZ1bGxQYXRoKSl7XG4gICAgICAgICAgICBqc2IuZmlsZVV0aWxzLnJlbW92ZUZpbGUoZnVsbFBhdGgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0ZXh0dXJlID0gbmV3IGNjLlJlbmRlclRleHR1cmUoTWF0aC5mbG9vcihzaXplLndpZHRoKSwgTWF0aC5mbG9vcihzaXplLmhlaWdodCksY2MuSU1BR0VfRk9STUFUX1BORyxnbC5ERVBUSDI0X1NURU5DSUw4X09FUyk7XG4gICAgICAgIHRleHR1cmUuc2V0UG9zaXRpb24oY2MucChzaXplLndpZHRoLzIsIHNpemUuaGVpZ2h0LzIpKTtcbiAgICAgICAgdGV4dHVyZS5iZWdpbigpO1xuICAgICAgICBjYy5kaXJlY3Rvci5nZXRSdW5uaW5nU2NlbmUoKS52aXNpdCgpO1xuICAgICAgICB0ZXh0dXJlLmVuZCgpO1xuICAgICAgICB0ZXh0dXJlLnNhdmVUb0ZpbGUoZmlsZU5hbWUsIGNjLklNQUdFX0ZPUk1BVF9QTkcpO1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIHRyeVRpbWVzID0gMDtcbiAgICAgICAgdmFyIGZuID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmKGpzYi5maWxlVXRpbHMuaXNGaWxlRXhpc3QoZnVsbFBhdGgpKXtcblxuICAgICAgICAgICAgICAgIGlmKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfQU5EUk9JRCl7XG4gICAgICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2Qoc2VsZi5BTkRSSU9EQ2xhc3NOYW1lLCBzdHJpbmdzLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLGZ1bGxQYXRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VsZi5faXNDYXB0dXJpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgdHJ5VGltZXMrKztcbiAgICAgICAgICAgICAgICBpZih0cnlUaW1lcyA+IDEwKXtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0aW1lIG91dC4uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZuLDUwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzZXRUaW1lb3V0KGZuLDUwKTtcbn1cblxuXG4vKipcbiAqIOaSreaUvue9kee7nOivremfs1xuICogXG4gKiBAcGFyYW0ge1N0cmluZ30gYXVkaW9Vcmwg6K+t6Z+z5Zyw5Z2AXG4gKi9cbktRTmF0aXZlSW52b2tlLnBsYXlBdWRpb1dpdGhVcmwgPSBmdW5jdGlvbiAoYXVkaW9VcmwpIHtcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJwbGF5VXJsOlwiLCBhdWRpb1VybCk7XG4gIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInBsYXlVcmxcIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgYXVkaW9VcmwpO1xuICB9XG59O1xuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBLUU5hdGl2ZUludm9rZTsiLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IENoYXRNZXNzYWdlID0gcmVxdWlyZSgnQ2hhdE1lc3NhZ2UnKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuXG4vLyDnlKjmnaXlj5HpgIHmtojmga/nmoQgY29tcG9uZW50XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvL2JxTm9kZTpjYy5Ob2RlLFxuICAgICAgICAvL2JxTm9kZTE6Y2MuTm9kZSxcbiAgICAgICAgLy9idG5MYW5ndWFnZU5vZGU6Y2MuTm9kZSxcbiAgICAgICAgLy9idG5MYW5ndWFnZU5vZGUxOmNjLk5vZGUsXG4gICAgICAgIC8vYnRuQ2hhcnROb2RlOmNjLk5vZGUsXG4gICAgICAgIC8vYnRuQ2hhcnROb2RlMTpjYy5Ob2RlLFxuICAgICAgICB0ZXh0U2Nyb2xsVmlldzpjYy5Ob2RlLFxuICAgICAgICBpbWFnZUNvbnRlbnROb2RlOmNjLk5vZGUsXG5cbiAgICAgICAgZWRpdEJveDogY2MuRWRpdEJveCxcblxuICAgICAgICB0ZXh0UmVjb3JkU2Nyb2xsVmlldzogY2MuU2Nyb2xsVmlldyxcbiAgICAgICAgdGV4dFJlY29yZExheW91dDogY2MuTGF5b3V0LFxuXG4gICAgICAgIHRleHRQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICBjaGF0VGV4dFJlY29yZFByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBlbW9qaVByZWZhYjpjYy5QcmVmYWIsXG4gICAgICAgIC8vIGltYWdlUHJlZmFiOmNjLlByZWZhYixcblxuICAgICAgICBiaWFvcWluZzogW2NjLk5vZGVdLCAgICAvLyBb5Lqu55qE6IOM5pmvLCDmmpfnmoTog4zmma9dICAg5b+r5o236K+tXG4gICAgICAgIGt1YWlqaWV5dTogW2NjLk5vZGVdLCAgIC8vIFvkuq7nmoTog4zmma8sIOaal+eahOiDjOaZr10gICDooajmg4VcbiAgICAgICAgY29udGVudDpbY2MuTm9kZV0sICAgICAgLy8gW+W/q+aNt+ivrSwg6KGo5oOFXSAgIFxuICAgICAgICBpbnB1dE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgZW1vamk6W2NjLk5vZGVdLFxuICAgICAgICBfdXNlcklkOiBudWxsLFxuXG4gICAgICAgIF9wbGF5ZXJJbmZvczogbnVsbCwgICAgICAgIC8vIOiusOW9leeUqOaIt+S/oeaBr1xuICAgICAgICBfY2hhdFRleHRNZXNzYWdlUmVjb3JkczogbnVsbCwgLy8g6IGK5aSp5paH5pys5raI5oGv6K6w5b2VXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl91c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gW107XG4gICAgICAgIHRoaXMudGV4dENvbnRlbnQgPSB0aGlzLnRleHRTY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xuICAgICAgICAvLyB0aGlzLmltYWdlQ29udGVudCA9IHRoaXMuaW1hZ2VTY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciB0ZXh0RGF0YSA9IEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5jaGF0VGV4dHMoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0RGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnRleHRQcmVmYWIpO1xuICAgICAgICAgICAgaXRlbS5nZXRDb21wb25lbnQoJ2NlbGxUZXh0Jykuc2V0VGV4dCh0ZXh0RGF0YVtpXSk7XG4gICAgICAgICAgICBpdGVtLmdldENvbXBvbmVudCgnY2VsbFRleHQnKS5vblNlbGVjdEFjdGlvbiA9IGZ1bmN0aW9uKHRleHQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm9uVGV4dENsaWNrQWN0aW9uKHRleHQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudGV4dENvbnRlbnQuaCA9IDEwMDA7XG4gICAgICAgICAgICB0aGlzLnRleHRDb250ZW50LmFkZENoaWxkKGl0ZW0pO1xuICAgICAgICB9XG5cbiAgICB9LFxuXG5cbiAgICBjbGlja0t1YWlKaWVZdSA6ZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5rdWFpamlleXVbMF0uYWN0aXZlID0gdHJ1ZTsgICAgLy8g5b+r5o236K+tIOiDjOaZr1xuICAgICAgICB0aGlzLmt1YWlqaWV5dVsxXS5hY3RpdmUgPSBmYWxzZTsgICAvLyDlv6vmjbfor60g5oyJ6ZKuXG4gICAgICAgIHRoaXMuYmlhb3FpbmdbMF0uYWN0aXZlID0gZmFsc2U7ICAgIC8vIOiDjOaZr+ihqOaDhVxuICAgICAgICB0aGlzLmJpYW9xaW5nWzFdLmFjdGl2ZSA9IHRydWU7ICAgICAvLyDooajmg4XmjInpkq5cbiAgICAgICAgdGhpcy5jb250ZW50WzBdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuY29udGVudFsxXS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuICAgIGNsaWNrQmlhb1FpbmcgOmZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuYmlhb3FpbmdbMF0uYWN0aXZlID0gdHJ1ZTsgICAgIC8vIOiDjOaZr+ihqOaDhVxuICAgICAgICB0aGlzLmJpYW9xaW5nWzFdLmFjdGl2ZSA9IGZhbHNlOyAgICAvLyDooajmg4XmjInpkq5cbiAgICAgICAgdGhpcy5rdWFpamlleXVbMF0uYWN0aXZlID0gZmFsc2U7ICAgLy8g5b+r5o236K+tIOiDjOaZr1xuICAgICAgICB0aGlzLmt1YWlqaWV5dVsxXS5hY3RpdmUgPSB0cnVlIDsgICAvLyDlv6vmjbfor60g5oyJ6ZKuXG4gICAgICAgIHRoaXMuY29udGVudFswXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb250ZW50WzFdLmFjdGl2ZSA9IHRydWU7XG4gICAgfSxcbiAgICBvblRleHRDbGlja0FjdGlvbjpmdW5jdGlvbih0ZXh0ID0gXCJcIikge1xuICAgICAgICB0aGlzLmVkaXRCb3guc3RyaW5nID0gXCJcIjtcbiAgICAgICAgdGhpcy5zZW5kVGV4dCh0ZXh0KTtcbiAgICB9LFxuXG4gICAgY2xpY2tFbW9qaTogZnVuY3Rpb24gKGV2ZW50LCBlbW9qaU5hbWUpIHtcbiAgICAgICAgbGV0IHN0cmluZyA9IHRoaXMuZWRpdEJveC5zdHJpbmc7XG4gICAgICAgIHRoaXMuZWRpdEJveC5zdHJpbmcgPSBzdHJpbmcgKyBcIjxcIiArIGVtb2ppTmFtZSArIFwiPlwiO1xuICAgICAgICB0aGlzLnNlbmRFbW9qaShlbW9qaU5hbWUpO1xuICAgIH0sXG5cbiAgICBjbGlja1NlbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IHN0cmluZyA9IHRoaXMuZWRpdEJveC5zdHJpbmcgfHwgXCJcIjtcbiAgICAgICAgaWYgKHN0cmluZy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZWRpdEJveC5zdHJpbmcgPSBcIlwiO1xuICAgICAgICB0aGlzLnNlbmRUZXh0KHN0cmluZyk7XG4gICAgfSxcblxuICAgIHNlbmRFbW9qaSA6ZnVuY3Rpb24oZW1vamlOYW1lKXtcbiAgICAgICAgaWYoZW1vamlOYW1lLmxlbmd0aCA9PTApe1xuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgU29ja2V0LnNlbmRFbW9qaSh0aGlzLl91c2VySWQsIGVtb2ppTmFtZSk7XG4gICAgICAgIHRoaXMuZGlzbWlzcygpO1xuICAgIH0sXG5cbiAgICBzZW5kVGV4dDogZnVuY3Rpb24gKHRleHQgPSBcIlwiKSB7XG4gICAgICAgIGlmICh0ZXh0Lmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgU29ja2V0LnNlbmRUZXh0KHRoaXMuX3VzZXJJZCwgdGV4dCk7XG4gICAgICAgIHRoaXMuZGlzbWlzcygpO1xuICAgIH0sXG5cbiAgICBkaXNtaXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgYnFBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYnFOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZTEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5icU5vZGUuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRleHRTY3JvbGxWaWV3LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmltYWdlQ29udGVudE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkU2Nyb2xsVmlldy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICB0ZXh0QWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmJxTm9kZTEuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnFOb2RlLmFjdGl2ZSA9IHRoaXMuYnRuTGFuZ3VhZ2VOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZTEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50ZXh0U2Nyb2xsVmlldy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmltYWdlQ29udGVudE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGV4dFJlY29yZFNjcm9sbFZpZXcubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgY2hhcnRBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYnFOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZTEuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUxLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJxTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnRleHRTY3JvbGxWaWV3LmFjdGl2ZSA9IHRoaXMuaW1hZ2VDb250ZW50Tm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkU2Nyb2xsVmlldy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgfSxcblxuICAgIGFkZFBsYXllckluZm9zOiBmdW5jdGlvbiAocGxheWVySW5mb3MpIHtcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSB0aGlzLl9wbGF5ZXJJbmZvcyB8fCBbXTtcblxuICAgICAgICBwbGF5ZXJJbmZvcy5mb3JFYWNoKGZ1bmN0aW9uICh1c2VySW5mbykge1xuICAgICAgICAgICAgbGV0IGhhdmVVc2VySW5mbyA9IHRoaXMuX3BsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKG93blVzZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG93blVzZXJJbmZvLmlkID09IHVzZXJJbmZvLmlkO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChoYXZlVXNlckluZm8gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BsYXllckluZm9zLnB1c2godXNlckluZm8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBhZGRDaGF0VGV4dE1lc3NhZ2U6IGZ1bmN0aW9uICh1c2VySWQsIHRleHQpIHtcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSB0aGlzLl9wbGF5ZXJJbmZvcyB8fCBbXTtcblxuICAgICAgICB2YXIgbmlja25hbWUgPSBcIltJRDpcIiArIHVzZXJJZCArIFwi6K+0Xe+8mlwiO1xuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLl9wbGF5ZXJJbmZvcy5maW5kKGZ1bmN0aW9uICh1c2VySW5mbykge1xuICAgICAgICAgICAgcmV0dXJuIHVzZXJJbmZvLmlkID09IHVzZXJJZDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHVzZXJJbmZvKSB7XG4gICAgICAgICAgICBuaWNrbmFtZSA9IFwiW1wiICsgdXNlckluZm8ubmlja25hbWUgKyBcIuivtF3vvJpcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzdHIgPSBuaWNrbmFtZSArIHRleHQ7XG4gICAgICAgIHN0ciA9IENoYXRNZXNzYWdlLnBhcnNlU3RyaW5nKHN0cik7XG4gICAgICAgIHRoaXMuX2FkZENoYXRUZXh0VG9SZWNvcmQoc3RyKTtcbiAgICB9LFxuXG4gICAgYWRkQ2hhdEVtb2ppTWVzc2FnZTpmdW5jdGlvbih1c2VySWQsZW1vamkpe1xuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHRoaXMuX3BsYXllckluZm9zIHx8IFtdO1xuXG4gICAgICAgIHZhciBuaWNrbmFtZSA9IFwiW0lEOlwiICsgdXNlcklkICsgXCLor7Rd77yaXCI7XG4gICAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMuX3BsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKHVzZXJJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gdXNlckluZm8uaWQgPT0gdXNlcklkO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHVzZXJJbmZvKSB7XG4gICAgICAgICAgICBuaWNrbmFtZSA9IFwiW1wiICsgdXNlckluZm8ubmlja25hbWUgKyBcIuivtF3vvJpcIjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHN0ciA9IG5pY2tuYW1lICsgZW1vamk7XG4gICAgICAgIHN0ciA9IENoYXRNZXNzYWdlLnBhcnNlU3RyaW5nKHN0cik7XG4gICAgICAgIHRoaXMuX2FkZENoYXRFbW9qaVRvUmVjb3JkKGVtb2ppKTtcbiAgICAgICAgLy8gY2MubG9nKGVtb2ppKVxuICAgICAgICAvLyBjYy5sb2coJy0tLTE5MCcpXG4gICAgfSxcblxuICAgIF9hZGRDaGF0RW1vamlUb1JlY29yZDpmdW5jdGlvbihlbW9qaSl7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5fbG9hZEVtb2ppRnJhbWUoZW1vamksZnVuY3Rpb24oZnJhbWUpe1xuICAgICAgICAgICAgLy92YXIgaXRlbSAgPSBjYy5pbnN0YW50aWF0ZShzZWxmLmVtb2ppUHJlZmFiKTtcbiAgICAgICAgICAgIC8vY2MubG9nKGZyYW1lKVxuICAgICAgICAgICAgLy92YXIgYnRuU3ByaXRlcyA9ICBpdGVtLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgLy9idG5TcHJpdGVzLnNwcml0ZUZyYW1lID0gZnJhbWU7XG4gICAgICAgICAgICAvL2xldCBjaGF0RW1vamlSZWNvcmQgPSBpdGVtLmdldENvbXBvbmVudCgnQ2hhdFRleHRSZWNvcmQnKTtcbiAgICAgICAgICAgIC8vY2hhdEVtb2ppUmVjb3JkLnNldEVtb2ppKGZyYW1lKTtcbiAgICAgICAgICAgIENoYXRNZXNzYWdlLnNldEVtb2ppKGZyYW1lKTtcblxuICAgICAgICB9KVxuICAgIH0sXG5cbiAgICBfbG9hZEVtb2ppRnJhbWUgOmZ1bmN0aW9uKEVtb2ppbmFtZSAsY2FsbGJhY2spe1xuICAgICAgICBjYy5sb2FkZXIubG9hZFJlcyhcIi90ZXh0dXJlcy9jaGF0L2JxXCIsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xuICAgICAgICAgICAgaWYoZXJyKXtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG51bGwsIGVycilcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShFbW9qaW5hbWUpO1xuICAgICAgICAgICAgY2FsbGJhY2soZnJhbWUpO1xuICAgICAgICB9LmJpbmQodGhpcykpXG5cbiAgICB9LFxuXG4gICAgX2FkZENoYXRUZXh0VG9SZWNvcmQ6IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgIHZhciBpdGVtID0gY2MuaW5zdGFudGlhdGUodGhpcy5jaGF0VGV4dFJlY29yZFByZWZhYik7XG4gICAgICAgIGxldCBjaGF0VGV4dFJlY29yZCA9IGl0ZW0uZ2V0Q29tcG9uZW50KCdDaGF0VGV4dFJlY29yZCcpO1xuICAgICAgICBjaGF0VGV4dFJlY29yZC5zZXRTdHJpbmcodGV4dCk7XG5cbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkTGF5b3V0Lm5vZGUuYWRkQ2hpbGQoaXRlbSk7XG4gICAgICAgIHRoaXMudGV4dFJlY29yZFNjcm9sbFZpZXcuc2Nyb2xsVG9Cb3R0b20oKTtcbiAgICB9LFxufSk7XG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgZXhpdEFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgY2MuZGlyZWN0b3IuZW5kKCk7XG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcImV4aXRBcHBcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZXhpdEFwcFwiLCBcIigpVlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCIvLyBudW1iZXIua3FfdGltZXMoZikgICDosIPnlKjlpJrmrKFcblxuXG5pZiAoIU51bWJlci5wcm90b3R5cGUua3FfdGltZXMpIHtcbiAgICBcbiAgICAvKipcbiAgICAgKiDosIPnlKjkuIDkuKrmlrnms5UgdGhpcyDmrKFcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gZiDopoHosIPnlKjnmoTmlrnms5VcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICAgdGhpc0FyZyAgIOWPr+mAie+8myBmIOeahCB0aGlz5YC8XG4gICAgICovXG4gICAgTnVtYmVyLnByb3RvdHlwZS5rcV90aW1lcyA9IGZ1bmN0aW9uKGYsIHRoaXNBcmcpIHtcbiAgICAgICAgaWYgKCFmKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXM7ICsraSkge1xuICAgICAgICAgICAgaWYgKHRoaXNBcmcpIHtcbiAgICAgICAgICAgICAgICBmLmFwcGx5KHRoaXNBcmcsIGkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuXG4vLyDnlKjkuo7lm57mlL7nmoTnu4Tku7ZcbmNvbnN0IFBsYXliYWNrID0gY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgIF9wbGF5YmFja0RhdGFzOiBudWxsLCAgIC8vIOeUqOS6juWbnuaUvueahOaVsOaNrlxuICAgICAgX2lzUGxheWJhY2tpbmc6IGZhbHNlLFxuICAgIH0sXG5cbiAgICBzdGF0aWNzOiB7XG4gICAgICBpbnN0YW5jZTogbnVsbCxcbiAgICB9LFxuXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICBQbGF5YmFjay5pbnN0YW5jZSA9IHRoaXM7XG4gICAgICBjYy5nYW1lLmFkZFBlcnNpc3RSb290Tm9kZSh0aGlzLm5vZGUpO1xuICAgIH0sXG5cbiAgICAvLyDorr7nva7lm57mlL7mlbDmja5cbiAgICBzZXRQbGF5YmFja0RhdGFzOiBmdW5jdGlvbiAoZGF0YXMpIHtcbiAgICAgIHRoaXMuX3BsYXliYWNrRGF0YXMgPSBkYXRhcztcbiAgICB9LFxuXG4gICAgLy8g5riF56m65Zue5pS+5pWw5o2u44CC5ZCM5pe25Lya5riF56m65Zue5pS+XG4gICAgcmVtb3ZlUGxheWJhY2tEYXRhczogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5zZXRQbGF5YmFja0RhdGFzKG51bGwpO1xuICAgICAgdGhpcy5zdG9wUGxheWJhY2soKTtcbiAgICB9LFxuXG4gICAgLy8g5piv5ZCm5YyF5ZCr5Zue5pS+5pWw5o2uXG4gICAgaXNDb250YWluUGxheWJhY2tEYXRhczogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3BsYXliYWNrRGF0YXMgIT0gbnVsbDtcbiAgICB9LFxuXG4gICAgLy8g5byA5aeL5Zue5pS+XG4gICAgc3RhcnRQbGF5YmFjazogZnVuY3Rpb24gKCkge1xuICAgICAgLy8g5qih5oufIHNvY2tldCDmjqXmlLbliLDkuobkuovku7bljbPlj69cbiAgICAgIC8vY2MubG9nKFwiUGxheWJhY2sg5byA5aeL5Zue5pS+XCIpO1xuXG4gICAgICB0aGlzLl9pc1BsYXliYWNraW5nID0gdHJ1ZTtcblxuICAgICAgaWYgKCF0aGlzLl9wbGF5YmFja0RhdGFzKSB7XG4gICAgICAgIGNjLmVycm9yKFwi5oOz5Zue5pS+77yM5Y205rKh5pyJ5Zue5pS+5pWw5o2uXCIpO1xuICAgICAgICB0aGlzLnN0b3BQbGF5YmFjaygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2V4ZWN1dGVQbGF5YmFjaygpO1xuICAgIH0sXG5cbiAgICAvLyDlgZzmraLlm57mlL5cbiAgICBzdG9wUGxheWJhY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2lzUGxheWJhY2tpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xuICAgIH0sXG5cbiAgICAvLyDmmK/lkKbmraPlnKjlm57mlL5cbiAgICBpc1BsYXliYWNraW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5faXNQbGF5YmFja2luZztcbiAgICB9LFxuXG4gICAgLy8g5omn6KGM55yf5q2j55qE5Zue5pS+5pON5L2cXG4gICAgX2V4ZWN1dGVQbGF5YmFjazogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHN0YXJ0VGltZSA9IDEuMDtcbiAgICAgIGxldCBpbnRlcnZhbCA9IDMuMDtcbiAgICAgIGNjLmxvZyh0aGlzLl9wbGF5YmFja0RhdGFzKTtcblxuICAgICAgLy8g5Zyo5p+Q5Lqb54m55q6K5oOF5Ya15LiLXG4gICAgICAvLyDlm57mlL7mlbDmja7ph4zkvJrljIXlkKvkuKTlpZcgZ2FtZU92ZXIgYWN0aW9uXG4gICAgICAvLyDmiYDku6XpnIDopoHov4fmu6TmjonlhbbkuK3kuIDkuKpcbiAgICAgIHRoaXMuX3BsYXliYWNrRGF0YXMgPSB0aGlzLl9wbGF5YmFja0RhdGFzLmZpbHRlcihmdW5jdGlvbihzdHJpbmcsIGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA9PSB0aGlzLl9wbGF5YmFja0RhdGFzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoc3RyaW5nLmluZGV4T2YoJ1wiYWN0aW9uXCI6XCJnYW1lT3ZlcicpID09IC0xKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgIHRoaXMuX3BsYXliYWNrRGF0YXMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIGRlbGF5ID0gc3RhcnRUaW1lICsgaW5kZXggKiBpbnRlcnZhbDtcbiAgICAgICAgaWYgKGluZGV4ID09IHRoaXMuX3BsYXliYWNrRGF0YXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIC8vIOWmguaenOaYr+acgOWQjuS4gOS4qu+8jOWImeW6lOivpeWPqumXtOmalOS4gOenklxuICAgICAgICAgIGRlbGF5ID0gc3RhcnRUaW1lICsgKGluZGV4IC0gMSkgKiBpbnRlcnZhbCArIDE7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgY2MubG9nKFwi5Zue5pS+5byA5aeL5qih5oufIFNvY2tldCDmjqXmlLbliLDmnI3liqHlmajmtojmga8sIFwiLCBpbmRleCk7XG4gICAgICAgICAgU29ja2V0Lmluc3RhbmNlLl9kaXNwYXRjaFJlc3BvbnNlKGRhdGEpO1xuICAgICAgICB9LCBkZWxheSk7XG5cbiAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICB9LFxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBQbGF5YmFjaztcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IEFycmF5RXh0ZW5zaW9uID0gcmVxdWlyZSgnQXJyYXlFeHRlbnNpb24nKTtcbmNvbnN0IFVzZXJNb2RlbEhlbHBlciA9IHJlcXVpcmUoJ1VzZXJNb2RlbEhlbHBlcicpO1xuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xuY29uc3QgS1FDYXJkUmVzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUmVzSGVscGVyJyk7XG5jb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBmb2xkQ2FyZE5vZGU6IGNjLk5vZGUsICAgICAgLy8g54mM55uW552A5pe255qE5qC35a2QXG4gICAgICAgIHRlU2h1UGFpTm9kZTogY2MuTm9kZSwgICAgICAvLyDnibnmrorniYznm5bnnYDml7bnmoTmoLflrZBcbiAgICAgICAgY2FyZHNCYWNrTGF5b3V0OiBjYy5MYXlvdXQsIC8vIDEz5byg54mM6IOM5b2x77yM5Y+v55So5p2l5bGV56S65Y+R54mM5Yqo55S7IOWQqyBjYXJkc0JhY2sgQ29tcG9uZW50XG4gICAgICAgIGNvbXBhcmVDYXJkc05vZGU6IGNjLk5vZGUsICAvLyBjb21wYXJlQ2FyZHMgICDlkKsgQ29tcGFyZUNhcmRzIENvbXBvbmVudFxuICAgICAgICB1c2VySW5mb05vZGU6IGNjLk5vZGUsICAgICAgICAgIC8vIOWMheWQq+eUqOaIt+S/oeaBryDlkKsgdXNlckluZm8gQ29tcG9uZW50XG4gICAgICAgIGNoYXRNZXNzYWdlTm9kZTogY2MuTm9kZSwgICAgICAgLy8g6IGK5aSp5raI5oGvIOWMheWQqyBDaGF0TWVzc2FnZSBDb21wb25lbnRcbiAgICAgICAgdXNlckF2YXRhck5vZGU6IGNjLk5vZGUsXG4gICAgICAgIC8vdXNlclNhbXBsZUluZm9Ob2RlOiBjYy5Ob2RlLFxuICAgICAgICBidWxsZXRIb2xlUHJlZmFiOiBjYy5QcmVmYWIsLy/kuK3mnqpcbiAgICAgICAgYnVsbGV0SG9sZU5vZGU6IGNjLk5vZGUsLy/kuK3mnqpcbiAgICAgICAgc2hvdE5vZGU6IFtjYy5Ob2RlXSwvL+aJk+aeqlxuICAgICAgICB1c2VySWQ6IDAsXG4gICAgICAgIGNhcmRUeXBlUHJlZmFiOiBjYy5QcmVmYWIsXG4gICAgICAgIC8vIOeUqOaIt+S/oeaBr1xuICAgICAgICAvLyAx44CBIOWmguaenCDljIXlkKvvvJpjYXJkSW5mbzpbXe+8jOihqOaYjueUqOaIt+W3sue7j+WHuueJjFxuICAgICAgICAvL1xuICAgICAgICBfdXNlckluZm86IG51bGwsXG4gICAgICAgIF9kZXNrSW5mbzogbnVsbCxcbiAgICAgICAgLyoqL1xuICAgICAgICBwbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHM6IHtcbiAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgZGVmYXVsdDogdW5kZWZpbmVkLFxuICAgICAgICB9XG4gICAgICAgIC8qKi9cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudXNlckF2YXRhck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIHRoaXMuX3Nob3dVc2VySW5mbywgdGhpcyk7XG4gICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID0gZmFsc2U7Ly/liKTmlq3mmK/lkKbngrnlh7vkuobmi43nmoTog4zlvbFcbiAgICAgICAgdGhpcy5jYXJkU3ByaXRlQXRsYXMgPSB0aGlzLm5vZGUucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcbiAgICB9LFxuXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudXNlckF2YXRhck5vZGUub2ZmKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCB0aGlzLl9zaG93VXNlckluZm8sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBjbGlja19sZWF2ZTpmdW5jdGlvbigpe1xuICAgICAgICB2YXIgdXNlcmlkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgICB2YXIgbGVhdmVJZCA9IHRoaXMuX3VzZXJJbmZvLmlkO1xuICAgICAgICBTb2NrZXQuc2VuZFFpbmdsaShsZWF2ZUlkLHVzZXJpZCk7XG4gICAgfSxcbiAgICBcbiAgICBfc2hvd1VzZXJJbmZvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhpcy51c2VyU2FtcGxlSW5mb05vZGUuZ2V0Q29tcG9uZW50KCdVc2VyU2FtcGxlSW5mbycpLnVwZGF0ZVdpdGhVc2VyKHRoaXMuX3VzZXJJbmZvKTtcbiAgICB9LFxuXG4gICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGVTaHVQYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJ1bGxldEhvbGVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJ1bGxldEhvbGVOb2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2RlKXtub2RlLmFjdGl2ZSA9IGZhbHNlO30pO1xuICAgICAgICBpZih0aGlzLnNob3ROb2RlLmxlbmd0aCA+IDApIHRoaXMuc2hvdE5vZGUuZm9yRWFjaChmdW5jdGlvbihub2RlKXtpZihub2RlKSBub2RlLmFjdGl2ZSA9IGZhbHNlO30pO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5yZXNldCgpO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XG4gICAgfSxcblxuICAgIC8qIyMjIyovXG4gICAgcmVzZXQyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50ZVNodVBhaU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe25vZGUuYWN0aXZlID0gZmFsc2U7fSk7XG4gICAgICAgIGlmKHRoaXMuc2hvdE5vZGUubGVuZ3RoID4gMCkgdGhpcy5zaG90Tm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe2lmKG5vZGUpIG5vZGUuYWN0aXZlID0gZmFsc2U7fSk7XG4gICAgICAgIC8vdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAvL3RoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnJlc2V0KCk7XG4gICAgfSxcbiAgICAvKiMjIyMjKi9cblxuICAgIHVwZGF0ZVVzZXJJbmZvV2l0aFVzZXJzOiBmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgbGV0IHVzZXIgPSB1c2Vycy5maW5kKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy51c2VySWQgPT0gZS5pZDtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZVVzZXJJbmZvKHVzZXIpO1xuICAgIH0sXG4gICAgc2hvd1FpbmdsaTpmdW5jdGlvbihjcmVhdG9yLCBpbmRleCl7XG4gICAgICAgIGlmKCF0aGlzLm5vZGUuYWN0aXZlKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZihpbmRleD4wKXtcbiAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRxaW5nbGkoZmFsc2UpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIGlmKGNyZWF0b3Ipe1xuICAgICAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRxaW5nbGkoZmFsc2UpO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldHFpbmdsaSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgdXBkYXRlVXNlckluZm86IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIHRoaXMuX3VzZXJJbmZvID0gdXNlcjtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9ICh1c2VyICE9IG51bGwpO1xuICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5hY3RpdmUgPSB0aGlzLm5vZGUuYWN0aXZlO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcbiAgICAgICAgdXNlckluZm8udXBkYXRlQXZhdGFyKHVzZXIuYXZhdGFyVXJsKTtcbiAgICAgICAgdXNlckluZm8udXBkYXRlVXNlcklkKHVzZXIuaWQpO1xuICAgICAgICB1c2VySW5mby51cGRhdGVOaWNrbmFtZSh1c2VyLm5pY2tuYW1lKTtcbiAgICAgICAgdXNlckluZm8uc2V0T2ZmbGluZVZpc2libGUoIXVzZXIub25saW5lU3RhdHVzKTtcblxuICAgICAgICAvL2lmICh0aGlzLl9kZXNrSW5mbyAmJiB0aGlzLl9kZXNrSW5mby5jSW5kZXggPiAwKSB7XG4gICAgICAgIC8vICBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModXNlcikpIHtcbiAgICAgICAgLy8gICAgdGhpcy5wbGF5Q2FyZCh1c2VyLmlkKTtcbiAgICAgICAgLy8gICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuc2V0Q29tcGFyZURhdGEodXNlcik7XG4gICAgICAgIC8vICB9XG4gICAgICAgIC8vfVxuICAgICAgICAvKiovXG4gICAgICAgIGNvbnN0IGNJbmRleCA9IHRoaXMuX2Rlc2tJbmZvLmNJbmRleDtcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvICYmIGNJbmRleCA+IDAgJiYgKHRoaXMucGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzLmluZGV4T2YoY0luZGV4KSA9PSAtMSkpIHtcbiAgICAgICAgICAgIGlmIChVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyh1c2VyKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGxheUNhcmQodXNlci5pZCx1c2VyLmNhcmRJbmZvKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zZXRDb21wYXJlRGF0YSh1c2VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiovXG4gICAgfSxcblxuICAgIC8vIOabtOaWsOaIv+S4u+S/oeaBr1xuICAgIHVwZGF0ZUJhbmtlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCB1c2VySW5mb0NvbXAgPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICAgIGlmICghdGhpcy5fdXNlckluZm8pIHtcbiAgICAgICAgICAgIHVzZXJJbmZvQ29tcC5zZXRJc0JhbmtlcihmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaXNCYW5rZXIgPSB0aGlzLl91c2VySW5mbyA/IHRoaXMuX3VzZXJJbmZvLmlzQmFua2VyIDogZmFsc2U7XG4gICAgICAgIHVzZXJJbmZvQ29tcC5zZXRJc0Jhbmtlcihpc0Jhbmtlcik7XG4gICAgfSxcblxuICAgIHNob3dGYW5nWmh1U3RhdHVzOiBmdW5jdGlvbiAoY3JlYXRlSWQsIHZpc2libGUgPSB0cnVlKSB7XG4gICAgICAgIGlmICghdGhpcy5ub2RlLmFjdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl91c2VySW5mby5pZCA9PSBjcmVhdGVJZCkge1xuICAgICAgICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldEZhbmdaaHVOb2RlVmlzaWJsZSh2aXNpYmxlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDmm7TmlrDliIbmlbBcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzY29yZSDnlKjmiLfliIbmlbDjgIHlj6/pgIlcbiAgICAgKi9cbiAgICB1cGRhdGVTY29yZTogZnVuY3Rpb24oc2NvcmUpIHtcbiAgICAgICAgaWYgKCFzY29yZSAmJiB0aGlzLl91c2VySW5mbykge1xuICAgICAgICAgICAgc2NvcmUgPSB0aGlzLl91c2VySW5mby50b3RhbFNjb3JlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xuICAgICAgICB1c2VySW5mby51cGRhdGVTY29yZShzY29yZSk7XG4gICAgfSxcblxuICAgIHNob3dSZWFkeVN0YXR1czogZnVuY3Rpb24gKHVzZXJJZCwgdmlzaWJsZSA9IHRydWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fdXNlckluZm8uaWQgPT0gdXNlcklkKSB7XG4gICAgICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZSh2aXNpYmxlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgc2hvd0JlaWx2OmZ1bmN0aW9uKHVzZXJJZCxibCl7XG4gICAgICAgIGlmKCF0aGlzLm5vZGUuYWN0aXZlKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiggdGhpcy5fdXNlckluZm8uaWQgPT0gdXNlcklkICl7XG4gICAgICAgICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldEJlaWx2TGFiZWwoYmwpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvKnNldERlc2tJbmZvOiBmdW5jdGlvbiAoZGVza0luZm8pIHtcbiAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcbiAgICAgfSwqL1xuICAgIHVwZGF0ZURlc2tJbmZvOiBmdW5jdGlvbiAoZGVza0luZm8pIHtcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcblxuICAgICAgICBpZiAoZGVza0luZm8gJiYgIWRlc2tJbmZvLmlzQ0JlZ2luKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8qKi9cblxuICAgIGhpZGVSZWFkeVN0YXR1czogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZShmYWxzZSk7XG4gICAgfSxcblxuICAgIHBsYXlGYVBhaUFuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModGhpcy5fdXNlckluZm8pKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGNhcmRzQmFjayA9IHRoaXMuY2FyZHNCYWNrTGF5b3V0LmdldENvbXBvbmVudCgnY2FyZHNCYWNrJyk7XG4gICAgICAgIGNhcmRzQmFjay5zaG93UGxheUNhcmRCYWNrcygpO1xuICAgIH0sXG5cbiAgICBzaG91bGRTaG93RmFQYWlBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKHRoaXMuX3VzZXJJbmZvKTtcbiAgICB9LFxuXG4gICAgc2V0VXNlck9ubGluZVN0YXR1czogZnVuY3Rpb24gKHVzZXJJZCwgc3RhdHVzID0gMSkge1xuICAgICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICAgIHVzZXJJbmZvLnNldE9mZmxpbmVWaXNpYmxlKHN0YXR1cyAhPSAxKTtcbiAgICB9LFxuXG4gICAgc2hvd0NoYXRUZXh0OiBmdW5jdGlvbiAodXNlcklkLCBtZXNzYWdlKSB7XG4gICAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjaGF0TWVzc2FnZSA9IHRoaXMuY2hhdE1lc3NhZ2VOb2RlLmdldENvbXBvbmVudCgnQ2hhdE1lc3NhZ2UnKTtcbiAgICAgICAgY2hhdE1lc3NhZ2Uuc2V0U3RyaW5nKG1lc3NhZ2UpO1xuICAgIH0sXG5cbiAgICAvLyDnlKjmiLflt7Lnu4/lh7rniYzvvIzlpITkuo7kuInloIbnm5bnnYDniYznmoTnirbmgIFcbiAgICBwbGF5Q2FyZDogZnVuY3Rpb24gKHVzZXJJZCxjYXJkSW5mbykge1xuICAgICAgICBpZiAodGhpcy51c2VySWQgIT0gdXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLnRhcmdldE9mZih0aGlzLmZvbGRDYXJkTm9kZSk7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmNoaWxkcmVuLnNsaWNlKDAsMykuZm9yRWFjaChmdW5jdGlvbihub2RlKXtcbiAgICAgICAgICAgIG5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2Upe1xuICAgICAgICAgICAgICAgIG5vZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRTcHJpdGUgPSBub2UuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gJ3B1YmxpYy1waWMtY2FyZC1wb2tlci1iYWNrJztcblxuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGNhcmRTcHJpdGUpO1xuXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdGhpcy5fY2xpY2tGb2xkQ2FyZE5vZGUoZXZlbnQpO1xuICAgICAgICB9LmJpbmQodGhpcyksdGhpcy5mb2xkQ2FyZE5vZGUpO1xuXG5cbiAgICB9LFxuXG4gICAgX2NsaWNrRm9sZENhcmROb2RlOiBmdW5jdGlvbiAoZXZlbnQpIHtcblxuICAgICAgICBpZiAodGhpcy51c2VySWQgIT0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkKSByZXR1cm47XG5cbiAgICAgICAgdmFyIGNhcmRJbmZvID0gdGhpcy5fdXNlckluZm8uY2FyZEluZm8ubGVuZ3RoID09IDE/IHRoaXMuX3VzZXJJbmZvLmNhcmRJbmZvWzBdLmNhcmRzOiB0aGlzLl91c2VySW5mby5jYXJkSW5mbztcblxuICAgICAgICB2YXIgY2FyZHMgPSBjYXJkSW5mby5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xuXG4gICAgICAgICAgICBpZih0aGlzLl91c2VySW5mby5jYXJkSW5mby5sZW5ndGggPT0gMSkgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0pO1xuXG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRJbmZvSXRlbS5jYXJkcyk7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge3JldHVybiBhcnJheS5jb25jYXQoc3ViQ2FyZHMpO30sIFtdKTtcblxuICAgICAgICB2YXIgZm9sZENhcmROb2RlID0gdGhpcy5mb2xkQ2FyZE5vZGUuY2hpbGRyZW4uc2xpY2UoMCwzKTtcblxuICAgICAgICB2YXIgbm9kZXMgPSBmb2xkQ2FyZE5vZGUubWFwKGZ1bmN0aW9uIChub2RlKSB7cmV0dXJuIG5vZGUuY2hpbGRyZW47fSkucmVkdWNlKGZ1bmN0aW9uIChhcnJheSwgc3ViKSB7cmV0dXJuIGFycmF5LmNvbmNhdChzdWIpO30sIFtdKTtcblxuICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChrcUNhcmQsIGluZGV4KSB7XG5cbiAgICAgICAgICAgIGlmIChpbmRleCA+PSBub2Rlcy5sZW5ndGgpIHJldHVybjtcblxuICAgICAgICAgICAgbm9kZXNbaW5kZXhdLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgICAgIG5vZGVzW2luZGV4XS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IFwiXCI7XG5cbiAgICAgICAgICAgIHZhciBub2RkczEgPSBuZXcgY2MuTm9kZSgpOyAvL+WIm+W7uuS4gOS4quiKgueCueWvueixoVxuXG4gICAgICAgICAgICBub2RkczEud2lkdGggPSBub2Rlc1swXS53aWR0aDtcblxuICAgICAgICAgICAgbm9kZHMxLmhlaWdodCA9IG5vZGVzWzBdLmhlaWdodDtcblxuICAgICAgICAgICAgbm9kZHMxLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgICAgICB2YXIgY2FyZFNwcml0ZSA9IG5vZGRzMS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpO1xuXG4gICAgICAgICAgICBjYXJkU3ByaXRlLnNpemVNb2RlID0gMDtcblxuICAgICAgICAgICAgdmFyIGNhcmROYW1lID0gdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID09IGZhbHNlPyBrcUNhcmQuY2FyZE5hbWUoKTogXCJiYWNrXCI7XG5cbiAgICAgICAgICAgIG5vZGRzMS5jYXJkTmFtZSA9IGNhcmROYW1lO1xuXG4gICAgICAgICAgICB2YXIgcGF0aCA9ICdwdWJsaWMtcGljLWNhcmQtcG9rZXItJysgY2FyZE5hbWU7XG5cbiAgICAgICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGNhcmRTcHJpdGUpO1xuXG4gICAgICAgICAgICBpZihjYy5tYVBhaSA9PSBjYXJkTmFtZSl7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZHMgPSBuZXcgY2MuTm9kZSgpOyAvL+WIm+W7uuS4gOS4quiKgueCueWvueixoVxuXG4gICAgICAgICAgICAgICAgbm9kZHMuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XG5cbiAgICAgICAgICAgICAgICBjYy5sb2FkZXIubG9hZFJlcygncGxheS9kZXNrL2ltZ19yZWQ1XzEnLCBjYy5TcHJpdGVGcmFtZSwgZnVuY3Rpb24gKGVyciwgc3ByaXRlRnJhbWUpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7Y2MuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyKTtyZXR1cm47fVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBidG5TcHJpdGUxID0gbm9kZHMuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEubm9kZS53aWR0aCA9IGNhcmRTcHJpdGUubm9kZS53aWR0aCArIDEwO1xuXG4gICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEubm9kZS5oZWlnaHQgPSBjYXJkU3ByaXRlLm5vZGUuaGVpZ2h0ICsgMTA7XG5cbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgY2FyZFNwcml0ZS5ub2RlLmFkZENoaWxkKG5vZGRzKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBub2Rlc1tpbmRleF0uYWRkQ2hpbGQobm9kZHMxKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB2YXIgY2FyZHMwID0gY2FyZHMuc2xpY2UoMCwzKVxuICAgICAgICB2YXIgY2FyZHMxID0gY2FyZHMuc2xpY2UoMyw4KVxuICAgICAgICB2YXIgY2FyZHMyID0gY2FyZHMuc2xpY2UoOCwxMylcblxuICAgICAgICBjYXJkcyA9IFtjYXJkczAsIGNhcmRzMSwgY2FyZHMyXVxuICAgICAgICAvL+WktOmBk1xuICAgICAgICBsZXQgdHlwZU5hbWUwID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkczApKzE7XG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD49MTAgPyB0eXBlTmFtZTAgOlwiMFwiK3R5cGVOYW1lMDtcbiAgICAgICAgdHlwZU5hbWUwID0gdHlwZU5hbWUwPT0nMDQnID8gJzExJyA6dHlwZU5hbWUwO1xuXG4gICAgICAgIC8v5Lit6YGTXG4gICAgICAgIGxldCB0eXBlTmFtZTEgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzMSkrMTtcbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPj0xMCA/IHR5cGVOYW1lMSA6XCIwXCIrdHlwZU5hbWUxO1xuICAgICAgICB0eXBlTmFtZTEgPSB0eXBlTmFtZTE9PScwNycgPyAnMjInIDp0eXBlTmFtZTE7XG5cbiAgICAgICAgLy/lsL7pgZNcbiAgICAgICAgbGV0IHR5cGVOYW1lMiA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMyKSsxO1xuICAgICAgICB0eXBlTmFtZTIgPSB0eXBlTmFtZTI+PTEwID8gdHlwZU5hbWUyIDpcIjBcIit0eXBlTmFtZTI7XG5cblxuICAgICAgICBpZih0eXBlTmFtZTApIEtRQ2FyZC5fc2V0R3VpQ2FyZCgwLCAwLCAzLCB0eXBlTmFtZTAsIGNhcmRzLCBub2RlcywgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xuICAgICAgICBpZih0eXBlTmFtZTEpIEtRQ2FyZC5fc2V0R3VpQ2FyZCgxLCAzLCA4LCB0eXBlTmFtZTEsIGNhcmRzLCBub2RlcywgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xuICAgICAgICBpZih0eXBlTmFtZTIpIEtRQ2FyZC5fc2V0R3VpQ2FyZCgyLCA4LCAxMywgdHlwZU5hbWUyLCBjYXJkcywgbm9kZXMsIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcbiAgICAgICAgaWYodGhpcy5mb2xkQ2FyZE5vZGVCYWNrID09IGZhbHNlKXtcbiAgICAgICAgICAgIHRoaXMuZm9sZENhcmROb2RlQmFjayA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZih0aGlzLmZvbGRDYXJkTm9kZUJhY2sgPT0gdHJ1ZSl7XG4gICAgICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZUJhY2sgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgfSxcblxuICAgIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbihTcHJpdGVGcmFtZSwgcGF0aCwgU3ByaXRlc05vZGUsIHcsIGgpIHtcblxuICAgICAgICB2YXIgU3ByaXRlID0gU3ByaXRlRnJhbWUuZ2V0U3ByaXRlRnJhbWUoIHBhdGggKTtcblxuICAgICAgICBTcHJpdGVzTm9kZS5zcHJpdGVGcmFtZSA9IFNwcml0ZTtcblxuICAgICAgICBpZih3KSBTcHJpdGVzTm9kZS5ub2RlLndpZHRoID0gdztcblxuICAgICAgICBpZihoKSBTcHJpdGVzTm9kZS5ub2RlLmhlaWdodCA9IGg7XG4gICAgfSxcblxuICAgIC8vIOWHhuWkh+WlveW8gOWni+avlOeJjFxuICAgIC8vIHJlYWR5VG9Db21wYXJlQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyAgICAgdGhpcy5mb2xkQ2FyZE5vZGUudGFyZ2V0T2ZmKHRoaXMuZm9sZENhcmROb2RlKTtcbiAgICAvLyAgICAgdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID0gdHJ1ZTtcbiAgICAvLyAgICAgdGhpcy5fY2xpY2tGb2xkQ2FyZE5vZGUoKTtcbiAgICAvLyAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAvLyAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgLy8gICAgIC8vdGhpcy5mb2xkQ2FyZE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgLy8gICAgIGlmKHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyKXtcbiAgICAvLyAgICAgICAgIGlmKHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyLmlzQ29udGFpbkV4dHJhKXtcbiAgICAvLyAgICAgICAgICAgICB0aGlzLnRlU2h1UGFpTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgIC8vICAgICAgICAgfWVsc2V7XG4gICAgLy8gICAgICAgICAgICAgdGhpcy50ZVNodVBhaU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgIH1cbiAgICAvLyB9LFxuICAgIHJlYWR5VG9Db21wYXJlQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUudGFyZ2V0T2ZmKHRoaXMuZm9sZENhcmROb2RlKTtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fY2xpY2tGb2xkQ2FyZE5vZGUoKTtcbiAgICAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGlmKHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyKXtcbiAgICAgICAgICAgIGlmKHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyLmlzQ29udGFpbkV4dHJhKXtcbiAgICAgICAgICAgICAgICB0aGlzLnRlU2h1UGFpTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdGhpcy50ZVNodVBhaU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5omT5p6q5Yqo55S7XG4gICAgLy8gQHBhcmFtIHVzZXJJZCAgIOimgeS4u+WKqOaJk+aequeahOeUqOaIt2lkXG4gICAgLy8gQHBhcmFtIHRvVXNlckluZGV4ICDmjKjmnqrnmoTnlKjmiLfnmoQgaW5kZXhcbiAgICBwbGF5U2hvb3RBbmltYXRpb246IGZ1bmN0aW9uICh1c2VySWQsIHRvVXNlckluZGV4KSB7XG4gICAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2hvdE5vZGUgPSB0aGlzLnNob3ROb2RlW3RvVXNlckluZGV4XTtcbiAgICAgICAgc2hvdE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgc2hvdE5vZGUuY2hpbGRyZW5bMF0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgc2hvdE5vZGUuY2hpbGRyZW5bMV0uYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICAvL+aeqlxuICAgICAgICB2YXIgcm90YXRlQnkgPSBjYy5yb3RhdGVUbygwLjEsLTE1KTtcbiAgICAgICAgdmFyIGRlbGF5MSA9IGNjLmRlbGF5VGltZSgwLjEpO1xuICAgICAgICB2YXIgcm90YXRlQnkxID0gY2Mucm90YXRlVG8oMC4xLDApO1xuICAgICAgICB2YXIgc3RhcnRfZnVuYzEgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe3Nob3ROb2RlLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IHRydWU7fSk7XG4gICAgICAgIHZhciBlbmRfZnVuYzEgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe3Nob3ROb2RlLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IGZhbHNlO30pO1xuICAgICAgICB2YXIgYWN0aW9uID0gY2MucmVwZWF0KGNjLnNlcXVlbmNlKHN0YXJ0X2Z1bmMxICxyb3RhdGVCeSwgZGVsYXkxLCByb3RhdGVCeTEsIGVuZF9mdW5jMSksMyk7XG5cbiAgICAgICAgLy/ng59cbiAgICAgICAgdmFyIGZhZGVJbiA9IGNjLmZhZGVJbiAoMCk7XG4gICAgICAgIHZhciBzY2FsZVRvMSA9IGNjLnNjYWxlVG8gKDAsIDAuOCk7XG4gICAgICAgIHZhciBzY2FsZVRvMiA9IGNjLnNjYWxlVG8gKDAuMDgsIDEpO1xuICAgICAgICB2YXIgZmFkZU91dEFuZFNjYWxlVG8gPSBjYy5zcGF3bihjYy5mYWRlT3V0KDAuMDIpLCBjYy5zY2FsZVRvKDAuMDIsIDAuNSkpO1xuICAgICAgICB2YXIgZGVsYXkyID0gY2MuZGVsYXlUaW1lKC4yKTtcbiAgICAgICAgdmFyIHN0YXJ0X2Z1bmMyID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtzaG90Tm9kZS5jaGlsZHJlblsxXS5hY3RpdmUgPSB0cnVlO30pO1xuICAgICAgICB2YXIgZW5kX2Z1bmMyID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtzaG90Tm9kZS5jaGlsZHJlblsxXS5hY3RpdmUgPSBmYWxzZTt9KTtcbiAgICAgICAgdmFyIGFjdGlvbjEgPSAgY2MucmVwZWF0KGNjLnNlcXVlbmNlKHN0YXJ0X2Z1bmMyLCBmYWRlSW4sIHNjYWxlVG8xLCBzY2FsZVRvMiwgZmFkZU91dEFuZFNjYWxlVG8sIGRlbGF5MiwgZW5kX2Z1bmMyKSwzKTtcblxuICAgICAgICBzaG90Tm9kZS5jaGlsZHJlblswXS5ydW5BY3Rpb24oYWN0aW9uKTtcbiAgICAgICAgc2hvdE5vZGUuY2hpbGRyZW5bMV0ucnVuQWN0aW9uKGFjdGlvbjEpO1xuXG5cbiAgICAgICAgLy9sZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICAgIC8vdXNlckluZm8ucGxheVNob290QW5pbWF0aW9uKHRvVXNlckluZGV4KTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5Lit5p6q5Yqo55S7XG4gICAgcGxheUJ1bGxldEhvbGVBbmltYXRpb246IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICAgICAgaWYgKHVzZXJJZCAhPSB0aGlzLnVzZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIGxldCBidWxsZXRIb2xlTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYnVsbGV0SG9sZVByZWZhYik7XG5cbiAgICAgICAgYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2RlKXtub2RlLmFjdGl2ZSA9IGZhbHNlO30uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW5bMF0ueSA9IDA7XG5cbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5hZGRDaGlsZChidWxsZXRIb2xlTm9kZSk7XG5cbiAgICAgICAgdmFyIGludGVydmFsID0gMC4zO1xuXG4gICAgICAgIHZhciBpbml0VGltZSA9IDA7XG5cbiAgICAgICAgYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2RlKXtcblxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUh1bWFuWlFpYW5nKCk7XG5cbiAgICAgICAgICAgICAgICBub2RlLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgeSA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcblxuICAgICAgICAgICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMzgpICogeTtcblxuICAgICAgICAgICAgICAgIHZhciB4ID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSA9PSAwID8gLTEgOiAxO1xuXG4gICAgICAgICAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozOCkgKiB4O1xuXG4gICAgICAgICAgICAgICAgbm9kZS54ID0geDtcblxuICAgICAgICAgICAgICAgIG5vZGUueSA9IHk7XG5cbiAgICAgICAgICAgIH0sIGluaXRUaW1lKTtcblxuICAgICAgICAgICAgaW5pdFRpbWUgPSBpbml0VGltZSArIGludGVydmFsO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5YWo5Z6S5omT5Yqo55S7XG4gICAgcGxheUhvbWVSdW5BaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICAgIHVzZXJJbmZvLnBsYXlIb21lUnVuQWltYXRpb24oKTtcbiAgICB9LFxuXG4gICAgcGxheVNwZWFrQW5pbWF0aW9uOiBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcbiAgICAgICAgdXNlckluZm8ucGxheVNwZWFrQW5pbWF0aW9uKCk7XG4gICAgfSxcblxuICAgIG5leHRDb21wYXJlU2NvcmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBzY29yZSA9IHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLm5leHRDb21wYXJlU2NvcmUoKTtcbiAgICAgICAgcmV0dXJuIHNjb3JlO1xuICAgIH0sXG5cbiAgICBzaG93TmV4dENvbXBhcmVDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5uZXh0Q29tcGFyZVNjb3JlKCkgPD0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudGVTaHVQYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zaG93TmV4dENhcmRzKCk7XG4gICAgfSxcblxuICAgIHNob3dBbGxDb21wYXJlQ2FyZHM6IGZ1bmN0aW9uICh1c2Vycykge1xuICAgICAgICBsZXQgdXNlciA9IHVzZXJzLmZpbmQoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnVzZXJJZCA9PSBlLmlkO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zZXRDb21wYXJlRGF0YSh1c2VyKTtcbiAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuc2hvd0FsbENhcmRzKCk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVTY29yZSh0aGlzLl91c2VySW5mby50b3RhbFNjb3JlIHx8IDApO1xuICAgIH0sXG5cbiAgICBzaG93TmV4dENvbXBhcmVTY29yZTogZnVuY3Rpb24gKGlzQ29udGFpbkV4dHJhKSB7XG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNob3dOZXh0Q29tcGFyZVNjb3JlKGlzQ29udGFpbkV4dHJhKTtcbiAgICB9LFxuXG4gICAgc2hvd1Njb3JlUmVzdWx0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNob3dTY29yZVJlc3VsdCgpO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IEtRQ2FyZFJlc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFJlc0hlbHBlcicpO1xuY29uc3QgU3ByaXRlSGVscGVyID0gcmVxdWlyZSgnU3ByaXRlSGVscGVyJyk7XG5jb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgYXZhdGFyU3ByaXRlOiBjYy5TcHJpdGUsXG4gICAgICAgIGxhYmVsTmlja25hbWU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFJlc3VsdE51bWJlcjogY2MuTGFiZWwsXG4gICAgICAgIGxheW91dFRvdURhbzogY2MuTGF5b3V0LFxuICAgICAgICBsYXlvdXRaaG9uZ0RhbzogY2MuTGF5b3V0LFxuICAgICAgICBsYXlvdXRXZWlEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0VGVTaHU6IGNjLkxheW91dCxcblxuICAgICAgICBsYWJlbFRlU2h1UGFpVGl0bGU6IGNjLkxhYmVsLFxuXG4gICAgICAgIHNjb3JlVW5pdE5vZGU6IGNjLk5vZGUsICAgICAgLy8g56ev5YiGXG4gICAgICAgIGRpYW1vbmRVbml0Tm9kZTogY2MuTm9kZSwgICAgLy8g6ZK755+zXG4gICAgfSxcblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIH0sXG5cbiAgICAvL3tcImlkXCI6MTAwMDQ5LFwibmlja25hbWVcIjpcImlteWFcIixcIm9wZW5JZFwiOlwieHhcIixcImF2YXRhclVybFwiOlwieHhcIixcInNleFwiOjEsXG4gICAgLy8gXCJjYXJkTnVtYmVyXCI6MyxcIm9ubGluZVN0YXR1c1wiOjEsXCJpbnZpdGVDb2RlXCI6XCJcIixcImlwQWRkcmVzc1wiOlwiOjpmZmZmOjIyMi4yNDQuNjUuMjAxXCIsXG4gICAgLy8gXCJsYXN0TG9naW5UaW1lXCI6XCIyMDE3LTA0LTEzIDIyOjA5OjAxXCIsXCJjcmVhdGVBdFwiOlwiMjAxNy0wNC0xMSAyMjozOTozMFwiLFxuICAgIC8vIFwidXBkYXRlQXRcIjpcIjIwMTctMDQtMTMgMjI6MDk6MDFcIixcbiAgICAvLyBcImNhcmRzXCI6W10sXCJyb29tSWRcIjpcIjU5ODg4M1wiLFwicmVhZHlTdGF0dXNcIjp0cnVlLFwidG90YWxTY29yZVwiOjAsXG4gICAgLy8gXCJjU2NvcmVcIjowLFwiaXNCYW5rZXJcIjpmYWxzZX1cbiAgICB1cGRhdGVXaXRoUGxheWVySW5mbzogZnVuY3Rpb24gKHBsYXllckluZm8sIGlzUmFuZG9tUm9vbSA9IGZhbHNlKSB7XG4gICAgICBTcHJpdGVIZWxwZXIuc2V0SW1hZ2VVcmwodGhpcy5hdmF0YXJTcHJpdGUsIHBsYXllckluZm8uYXZhdGFyVXJsKTtcbiAgICAgIHRoaXMubGFiZWxOaWNrbmFtZS5zdHJpbmcgPSBwbGF5ZXJJbmZvLm5pY2tuYW1lO1xuICAgICAgICAvL2NjLmxvZyh0aGlzLmxhYmVsUmVzdWx0TnVtYmVyLnN0cmluZylcbiAgICAgICAgLy9jYy5sb2cocGxheWVySW5mbylcbiAgICAgICAgLy9jYy5sb2cocGxheWVySW5mby5jU2NvcmUpXG4gICAgICAgIC8vY2MubG9nKCctLS0zNicpXG4gICAgICB0aGlzLmxhYmVsUmVzdWx0TnVtYmVyLnN0cmluZyA9IHBsYXllckluZm8uY1Njb3JlO1xuXG4gICAgICB0aGlzLnNjb3JlVW5pdE5vZGUuYWN0aXZlID0gIWlzUmFuZG9tUm9vbTtcbiAgICAgIHRoaXMuZGlhbW9uZFVuaXROb2RlLmFjdGl2ZSA9IGlzUmFuZG9tUm9vbTtcbiAgICAgIHZhciBOdW1iZXIgPSBwbGF5ZXJJbmZvLmNTY29yZTtcbiAgICAgIGlmIChpc1JhbmRvbVJvb20pIHtcbiAgICAgICAgLy8g5aaC5p6c5piv6ZqP5py65Zy655qE6K+d77yM5YiZ5pi+56S66ZK755+z5pWw6YePXG4gICAgICAgICAgTnVtYmVyID0gcGxheWVySW5mby5jU2NvcmUgKiA1O1xuICAgICAgfVxuICAgICAgICB0aGlzLmxhYmVsUmVzdWx0TnVtYmVyLnN0cmluZyA9IE51bWJlcjtcbiAgICB9LFxuXG4gICAgc2V0Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xuICAgICAgY2MuYXNzZXJ0KGNhcmRzLmxlbmd0aCA9PSAxMyk7XG5cbiAgICAgIC8vIOS4jeS8muWGjeacieeJueauiueJjOS6hlxuICAgICAgIC8qaWYgKEtRQ2FyZC5pc1RlU2h1UGFpKGNhcmRzKSkge1xuICAgICAgICAgdGhpcy5zZXRUZVNodUNhcmRzKGNhcmRzKTtcbiAgICAgICAgIHJldHVybjtcbiAgICAgICAgIH1cbiAgICAgICovXG5cbiAgICAgIC8vbGV0IHRvdUNhcmRzID0gY2FyZHMuc2xpY2UoMCwgMyk7XG4gICAgICAvL2xldCB6aG9uZ0NhcmRzID0gY2FyZHMuc2xpY2UoMywgMyArIDUpO1xuICAgICAgLy9sZXQgd2VpQ2FyZHMgPSBjYXJkcy5zbGljZSg4KTtcbiAgICAgIC8vdGhpcy5zZXRUb3VDYXJkcyh0b3VDYXJkcyk7XG4gICAgICAvL3RoaXMuc2V0WmhvbmdDYXJkcyh6aG9uZ0NhcmRzKTtcbiAgICAgIC8vdGhpcy5zZXRXZWlDYXJkcyh3ZWlDYXJkcyk7XG4gICAgfSxcblxuICAgIC8qc2V0VG91Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xuICAgICAgdGhpcy5fc2V0Q2FyZHNUb0xheW91dCh0aGlzLmxheW91dFRvdURhbywgY2FyZHMpO1xuICAgIH0sXG5cbiAgICBzZXRaaG9uZ0NhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy5sYXlvdXRaaG9uZ0RhbywgY2FyZHMpO1xuICAgIH0sXG5cblxuICAgIHNldFdlaUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy5sYXlvdXRXZWlEYW8sIGNhcmRzKTtcbiAgICB9LCovXG5cbiAgICAvL+e7k+eulyAg5bCG54m55q6K54mM5pS+5YWlTGF5b3V0XG4gICAgLypzZXRUZVNodUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMubGF5b3V0VGVTaHUubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgdGhpcy5sYXlvdXRUb3VEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMubGF5b3V0V2VpRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLl9zZXRDYXJkc1RvTGF5b3V0KHRoaXMubGF5b3V0VGVTaHUsIGNhcmRzKTtcblxuICAgICAgbGV0IHR5cGVOYW1lID0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoY2FyZHMpO1xuICAgICAgdGhpcy5sYWJlbFRlU2h1UGFpVGl0bGUuc3RyaW5nID0gdHlwZU5hbWU7XG4gICAgfSwqL1xuXG4gICAvL+e7k+eul+WwhueJjOaUvuWIsExheW91dOmHjOmdolxuICAgIC8qX3NldENhcmRzVG9MYXlvdXQ6IGZ1bmN0aW9uIChsYXlvdXQsIGNhcmRzKSB7XG4gICAgICBsZXQgbm9kZSA9IGxheW91dC5ub2RlO1xuICAgICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChzcHJpdGVOb2RlLCBpbmRleCkge1xuICAgICAgICBsZXQgc3ByaXRlID0gc3ByaXRlTm9kZS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpO1xuICAgICAgICBsZXQgY2FyZCA9IGNhcmRzW2luZGV4XTtcbiAgICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgS1FDYXJkUmVzSGVscGVyLnNldENhcmRTcHJpdGVGcmFtZShzcHJpdGUsIGNhcmQuY2FyZE5hbWUoKSk7XG4gICAgICB9KTtcbiAgICB9LCovXG59KTtcbiIsImNvbnN0IE1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICBwaG9uZTpjYy5MYWJlbCxcbiAgICAgIG11c2ljU2xpZGVyOmNjLk5vZGUsXG4gICAgICBlZmZlY3RTbGlkZXI6Y2MuTm9kZSxcbiAgICAgIGJ0blN3aXRjaEFjY291bnQ6IGNjLkJ1dHRvbixcbiAgICAgIHNoYXJlQmc6Y2MuTm9kZSxcbiAgICAgIHd4OmNjLk5vZGUsXG4gICAgICBweXE6Y2MuTm9kZSxcbiAgICAgIG11c2ljOmNjLk5vZGUsXG4gICAgICBzb3VuZHM6Y2MuTm9kZSxcbiAgICAgIF9hdWRpb01hbmFnZXI6IG51bGwsXG4gICAgICBfbXVzaWNPbiA6IDEsXG4gICAgICBfc291bmRzT24gOiAxLFxuICAgICAgX3Bob25lOm51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyID0gY2MuZmluZCgnQXVkaW9NYW5hZ2VyJykgfHwge307XG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIgPSB0aGlzLl9hdWRpb01hbmFnZXIuZ2V0Q29tcG9uZW50KCdBdWRpb01hbmFnZXInKTtcbiAgICAgIHRoaXMuX2luaXRTbGlkZXJzKCk7XG4gICAgICB0aGlzLnBob25lLnN0cmluZyA9IHRoaXMuX3Bob25lP3RoaXMuX3Bob25lOlwi5pegXCI7XG4gICAgICAgIHZhciBiZ011c2ljID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdNdXNpY1wiKTtcbiAgICAgICAgdmFyIGJnU291bmQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJiZ1NvdW5kXCIpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKGJnTXVzaWMpO1xuICAgICAgICBpZihiZ011c2ljICE9ICcnKSB7XG4gICAgICAgICAgICBpZiAocGFyc2VJbnQoYmdNdXNpYykgPT0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX211c2ljT24gPSAxO1xuICAgICAgICAgICAgICAgIHRoaXMubXVzaWMuZ2V0Q2hpbGRCeU5hbWUoJ211c2ljX29uJykuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLm11c2ljLmdldENoaWxkQnlOYW1lKCdtdXNpY19vZmYnKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX211c2ljT24gPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMubXVzaWMuZ2V0Q2hpbGRCeU5hbWUoJ211c2ljX29uJykuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5tdXNpYy5nZXRDaGlsZEJ5TmFtZSgnbXVzaWNfb2ZmJykuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZihiZ1NvdW5kID09IDApeyAvLyDlpoLmnpzog4zmma/pn7PmlYjmmK/lhbPpl63nmoRcbiAgICAgICAgICAgIGlmIChwYXJzZUludChiZ1NvdW5kKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc291bmRzT24gPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuc291bmRzLmdldENoaWxkQnlOYW1lKCdzb3VuZHNfb24nKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnNvdW5kcy5nZXRDaGlsZEJ5TmFtZSgnc291bmRzX29mZicpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zb3VuZHNPbiA9IDE7XG4gICAgICAgICAgICAgICAgdGhpcy5zb3VuZHMuZ2V0Q2hpbGRCeU5hbWUoJ3NvdW5kc19vbicpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5zb3VuZHMuZ2V0Q2hpbGRCeU5hbWUoJ3NvdW5kc19vZmYnKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKHRoaXMuX3NvdW5kc09uKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgY2xpY2tXeDogZnVuY3Rpb24oKXsgIC8v54K55Ye75b6u5L+hXG4gICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgdGhpcy5zaGFyZUJnLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMud3guYWN0aXZlID0gdHJ1ZTtcbiAgICAgIH1lbHNle1xuICAgICAgICB2YXIgdGl0bGUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3NoYXJlVGl0bGUnKTtcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkZXNjJyk7XG4gICAgICAgIHZhciByZWNvcmRJZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVjb3JkSWQnKTtcbiAgICAgICAgdmFyIHJvb21JZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncm9vbUlkJyk7XG4gICAgICAgIHZhciBpZD0gJyc7XG4gICAgICAgIGlmKHJvb21JZCl7XG4gICAgICAgICAgICBpZCA9ICdyb29tSWQ9Jytyb29tSWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYocmVjb3JkSWQpe1xuICAgICAgICAgICAgaWQgPSAncmVjb3JkSWQ9JytyZWNvcmRJZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNoYXJlRnJpZW5kOmRlc2NyaXB0aW9uOlwiLGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVGcmllbmRcIixzdHIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgIH0sXG4gICAgY2xpY2tQeXE6IGZ1bmN0aW9uKCl7IC8v54K55Ye75pyL5Y+L5ZyIXG4gICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgdGhpcy5zaGFyZUJnLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMucHlxLmFjdGl2ZSA9IHRydWU7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHRpdGxlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzaGFyZVRpdGxlJyk7XG4gICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGVzYycpO1xuICAgICAgICB2YXIgcmVjb3JkSWQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JlY29yZElkJyk7XG4gICAgICAgIHZhciByb29tSWQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Jvb21JZCcpO1xuICAgICAgICB2YXIgaWQ9ICcnO1xuICAgICAgICBpZihyb29tSWQpe1xuICAgICAgICAgICAgaWQgPSAncm9vbUlkPScrcm9vbUlkO1xuICAgICAgICB9XG4gICAgICAgIGlmKHJlY29yZElkKXtcbiAgICAgICAgICAgIGlkID0gJ3JlY29yZElkPScrcmVjb3JkSWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUhhbGxUaW1lbGluZTpkZXNjcmlwdGlvbjpcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICB2YXIgc3RyID0gXCIoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVZcIjtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsc3RyLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICB9LFxuXG4gICAgY2xpY2tzaGFyZUJnOiBmdW5jdGlvbigpeyAgLy8g54K55Ye75YiG5Lqr6IOM5pmv5Zu+XG4gICAgICB0aGlzLnNoYXJlQmcuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLnd4LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5weXEuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcbiAgICBjbGlja011c2ljIDpmdW5jdGlvbigpeyAgIC8v54K55Ye76Z+z5LmQXG4gICAgICB0aGlzLm11c2ljLmNoaWxkcmVuWzFdLmFjdGl2ZSA9ICh0aGlzLl9tdXNpY09uID0gIXRoaXMuX211c2ljT24pOyAgIFxuICAgICAgdGhpcy5tdXNpYy5jaGlsZHJlblsyXS5hY3RpdmUgPSAhdGhpcy5fbXVzaWNPbjtcbiAgICAgICAgdmFyIHZvbHVtZSA9IDA7XG4gICAgICBpZih0aGlzLl9tdXNpY09uKXtcbiAgICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnNldEJnTXVzaWNWb2x1bW4oMSk7XG4gICAgICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnBsYXlNdXNpYygpO1xuICAgICAgICAgIHZvbHVtZSA9IDE7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnNldEJnTXVzaWNWb2x1bW4oMCk7XG4gICAgICAgICAgdm9sdW1lID0gMDtcbiAgICAgIH1cbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYmdNdXNpY1wiLHZvbHVtZSk7XG4gICAgfSxcblxuICAgIGNsaWNrU291bmRzIDpmdW5jdGlvbigpeyAgLy/ngrnlh7vkuobpn7PmlYhcbiAgICAgIHRoaXMuc291bmRzLmNoaWxkcmVuWzFdLmFjdGl2ZSA9ICh0aGlzLl9zb3VuZHNPbiA9ICF0aGlzLl9zb3VuZHNPbik7XG4gICAgICB0aGlzLnNvdW5kcy5jaGlsZHJlblsyXS5hY3RpdmUgPSAhdGhpcy5fc291bmRzT247XG4gICAgICB2YXIgdm9sdW1lPTA7XG4gICAgICBpZih0aGlzLl9zb3VuZHNPbil7XG4gICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKDEpO1xuICAgICAgICB2b2x1bWUgPSAxO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKDApO1xuICAgICAgICB2b2x1bWUgPSAwO1xuICAgICAgfVxuICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYmdTb3VuZFwiLHZvbHVtZSk7XG4gICAgfSxcbiAgICBjbGlja1NldHRpbmc6ZnVuY3Rpb24oKXsgIC8v54K55Ye76K6+572uXG4gICAgICAgIFxuICAgIH0sXG4gICAgX2luaXRTbGlkZXJzOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9pbml0U2xpZGVyRXZlbnRzKCk7XG5cbiAgICAgIGxldCBtdXNpY1ZhbCA9IE1hbmFnZXIuZ2V0TXVzaWNWYWx1ZSgpO1xuICAgICAgbGV0IGVmZmVjdFZhbCA9IE1hbmFnZXIuZ2V0TXVzaWNFZmZlY3RWYWx1ZSgpO1xuXG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0QmdNdXNpY1ZvbHVtbihtdXNpY1ZhbCk7XG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bShlZmZlY3RWYWwpO1xuXG4gICAgICB0aGlzLm11c2ljU2xpZGVyLmdldENvbXBvbmVudCgnc2xpZGVyJykuc2V0VmFsdWUobXVzaWNWYWwpO1xuICAgICAgdGhpcy5lZmZlY3RTbGlkZXIuZ2V0Q29tcG9uZW50KCdzbGlkZXInKS5zZXRWYWx1ZShlZmZlY3RWYWwpO1xuICAgIH0sXG5cbiAgICBfaW5pdFNsaWRlckV2ZW50czogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5tdXNpY1NsaWRlci5nZXRDb21wb25lbnQoJ3NsaWRlcicpLm9uVmFsdWVDaGFuZ2UgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBNYW5hZ2VyLnNldE11c2ljVmFsdWUodmFsdWUpO1xuICAgICAgICBzZWxmLl9hdWRpb01hbmFnZXIuc2V0QmdNdXNpY1ZvbHVtbih2YWx1ZSk7XG4gICAgICB9O1xuXG4gICAgICB0aGlzLmVmZmVjdFNsaWRlci5nZXRDb21wb25lbnQoJ3NsaWRlcicpLm9uVmFsdWVDaGFuZ2UgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBNYW5hZ2VyLnNldE11c2ljRWZmZWN0VmFsdWUodmFsdWUpO1xuICAgICAgICBzZWxmLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bSh2YWx1ZSk7XG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBjbGlja1N3aXRjaDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIGhpZGVTd2l0Y2g6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuYnRuU3dpdGNoQWNjb3VudCkge1xuICAgICAgICB0aGlzLmJ0blN3aXRjaEFjY291bnQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9LFxufSk7XG4iLCJsZXQgU3ByaXRlSGVscGVyID0ge1xuICBzZXRJbWFnZVVybDogZnVuY3Rpb24gKHNwcml0ZSwgdXJsKSB7XG4gICAgaWYgKHVybC5lbmRzV2l0aChcInBuZ1wiKSB8fCB1cmwuZW5kc1dpdGgoXCJqcGdcIikgfHwgdXJsLmVuZHNXaXRoKFwiZ2lmXCIpKSB7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgLy91cmwgPSB1cmwgKyBcIi5wbmdcIjtcbiAgICB9XG5cbiAgICBjYy5sb2FkZXIubG9hZCh7dXJsOnVybCx0eXBlOlwianBnXCJ9LCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKGRhdGEpO1xuICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gZnJhbWU7XG4gICAgfSk7XG4gIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNwcml0ZUhlbHBlcjtcbiIsIi8vIOe7mSBTdHJpbmcg5re75Yqg5Yqf6IO9XG5cbi8vIHN0ci5zdGFydHNXaXRoKFwiXCIpO1xuLy8gc3RyLmVuZHNXaXRoKFwiXCIpO1xuXG5pZiAoIVN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aCkge1xuICAoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnOyAvLyBuZWVkZWQgdG8gc3VwcG9ydCBgYXBwbHlgL2BjYWxsYCB3aXRoIGB1bmRlZmluZWRgL2BudWxsYFxuICAgIHZhciBkZWZpbmVQcm9wZXJ0eSA9IChmdW5jdGlvbigpIHtcbiAgICAgIC8vIElFIDggb25seSBzdXBwb3J0cyBgT2JqZWN0LmRlZmluZVByb3BlcnR5YCBvbiBET00gZWxlbWVudHNcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciBvYmplY3QgPSB7fTtcbiAgICAgICAgdmFyICRkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbiAgICAgICAgdmFyIHJlc3VsdCA9ICRkZWZpbmVQcm9wZXJ0eShvYmplY3QsIG9iamVjdCwgb2JqZWN0KSAmJiAkZGVmaW5lUHJvcGVydHk7XG4gICAgICB9IGNhdGNoKGVycm9yKSB7fVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KCkpO1xuICAgIHZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuICAgIHZhciBzdGFydHNXaXRoID0gZnVuY3Rpb24oc2VhcmNoKSB7XG4gICAgICBpZiAodGhpcyA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IFR5cGVFcnJvcigpO1xuICAgICAgfVxuICAgICAgdmFyIHN0cmluZyA9IFN0cmluZyh0aGlzKTtcbiAgICAgIGlmIChzZWFyY2ggJiYgdG9TdHJpbmcuY2FsbChzZWFyY2gpID09ICdbb2JqZWN0IFJlZ0V4cF0nKSB7XG4gICAgICAgIHRocm93IFR5cGVFcnJvcigpO1xuICAgICAgfVxuICAgICAgdmFyIHN0cmluZ0xlbmd0aCA9IHN0cmluZy5sZW5ndGg7XG4gICAgICB2YXIgc2VhcmNoU3RyaW5nID0gU3RyaW5nKHNlYXJjaCk7XG4gICAgICB2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyaW5nLmxlbmd0aDtcbiAgICAgIHZhciBwb3NpdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkO1xuICAgICAgLy8gYFRvSW50ZWdlcmBcbiAgICAgIHZhciBwb3MgPSBwb3NpdGlvbiA/IE51bWJlcihwb3NpdGlvbikgOiAwO1xuICAgICAgaWYgKHBvcyAhPSBwb3MpIHsgLy8gYmV0dGVyIGBpc05hTmBcbiAgICAgICAgcG9zID0gMDtcbiAgICAgIH1cbiAgICAgIHZhciBzdGFydCA9IE1hdGgubWluKE1hdGgubWF4KHBvcywgMCksIHN0cmluZ0xlbmd0aCk7XG4gICAgICAvLyBBdm9pZCB0aGUgYGluZGV4T2ZgIGNhbGwgaWYgbm8gbWF0Y2ggaXMgcG9zc2libGVcbiAgICAgIGlmIChzZWFyY2hMZW5ndGggKyBzdGFydCA+IHN0cmluZ0xlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgaW5kZXggPSAtMTtcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgc2VhcmNoTGVuZ3RoKSB7XG4gICAgICAgIGlmIChzdHJpbmcuY2hhckNvZGVBdChzdGFydCArIGluZGV4KSAhPSBzZWFyY2hTdHJpbmcuY2hhckNvZGVBdChpbmRleCkpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgaWYgKGRlZmluZVByb3BlcnR5KSB7XG4gICAgICBkZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAnc3RhcnRzV2l0aCcsIHtcbiAgICAgICAgJ3ZhbHVlJzogc3RhcnRzV2l0aCxcbiAgICAgICAgJ2NvbmZpZ3VyYWJsZSc6IHRydWUsXG4gICAgICAgICd3cml0YWJsZSc6IHRydWVcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGggPSBzdGFydHNXaXRoO1xuICAgIH1cbiAgfSgpKTtcbn1cblxuLy8gc3RyLmVuZHNXaXRoKFwiXCIpO1xuaWYgKCFTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoKSB7XG5cdChmdW5jdGlvbigpIHtcblx0XHQndXNlIHN0cmljdCc7IC8vIG5lZWRlZCB0byBzdXBwb3J0IGBhcHBseWAvYGNhbGxgIHdpdGggYHVuZGVmaW5lZGAvYG51bGxgXG5cdFx0dmFyIGRlZmluZVByb3BlcnR5ID0gKGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gSUUgOCBvbmx5IHN1cHBvcnRzIGBPYmplY3QuZGVmaW5lUHJvcGVydHlgIG9uIERPTSBlbGVtZW50c1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dmFyIG9iamVjdCA9IHt9O1xuXHRcdFx0XHR2YXIgJGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXHRcdFx0XHR2YXIgcmVzdWx0ID0gJGRlZmluZVByb3BlcnR5KG9iamVjdCwgb2JqZWN0LCBvYmplY3QpICYmICRkZWZpbmVQcm9wZXJ0eTtcblx0XHRcdH0gY2F0Y2goZXJyb3IpIHt9XG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH0oKSk7XG5cdFx0dmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7XG5cdFx0dmFyIGVuZHNXaXRoID0gZnVuY3Rpb24oc2VhcmNoKSB7XG5cdFx0XHRpZiAodGhpcyA9PSBudWxsKSB7XG5cdFx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xuXHRcdFx0fVxuXHRcdFx0dmFyIHN0cmluZyA9IFN0cmluZyh0aGlzKTtcblx0XHRcdGlmIChzZWFyY2ggJiYgdG9TdHJpbmcuY2FsbChzZWFyY2gpID09ICdbb2JqZWN0IFJlZ0V4cF0nKSB7XG5cdFx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xuXHRcdFx0fVxuXHRcdFx0dmFyIHN0cmluZ0xlbmd0aCA9IHN0cmluZy5sZW5ndGg7XG5cdFx0XHR2YXIgc2VhcmNoU3RyaW5nID0gU3RyaW5nKHNlYXJjaCk7XG5cdFx0XHR2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyaW5nLmxlbmd0aDtcblx0XHRcdHZhciBwb3MgPSBzdHJpbmdMZW5ndGg7XG5cdFx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcblx0XHRcdFx0dmFyIHBvc2l0aW9uID0gYXJndW1lbnRzWzFdO1xuXHRcdFx0XHRpZiAocG9zaXRpb24gIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdC8vIGBUb0ludGVnZXJgXG5cdFx0XHRcdFx0cG9zID0gcG9zaXRpb24gPyBOdW1iZXIocG9zaXRpb24pIDogMDtcblx0XHRcdFx0XHRpZiAocG9zICE9IHBvcykgeyAvLyBiZXR0ZXIgYGlzTmFOYFxuXHRcdFx0XHRcdFx0cG9zID0gMDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHZhciBlbmQgPSBNYXRoLm1pbihNYXRoLm1heChwb3MsIDApLCBzdHJpbmdMZW5ndGgpO1xuXHRcdFx0dmFyIHN0YXJ0ID0gZW5kIC0gc2VhcmNoTGVuZ3RoO1xuXHRcdFx0aWYgKHN0YXJ0IDwgMCkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR2YXIgaW5kZXggPSAtMTtcblx0XHRcdHdoaWxlICgrK2luZGV4IDwgc2VhcmNoTGVuZ3RoKSB7XG5cdFx0XHRcdGlmIChzdHJpbmcuY2hhckNvZGVBdChzdGFydCArIGluZGV4KSAhPSBzZWFyY2hTdHJpbmcuY2hhckNvZGVBdChpbmRleCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH07XG5cdFx0aWYgKGRlZmluZVByb3BlcnR5KSB7XG5cdFx0XHRkZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAnZW5kc1dpdGgnLCB7XG5cdFx0XHRcdCd2YWx1ZSc6IGVuZHNXaXRoLFxuXHRcdFx0XHQnY29uZmlndXJhYmxlJzogdHJ1ZSxcblx0XHRcdFx0J3dyaXRhYmxlJzogdHJ1ZVxuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdFN0cmluZy5wcm90b3R5cGUuZW5kc1dpdGggPSBlbmRzV2l0aDtcblx0XHR9XG5cdH0oKSk7XG59XG4iLCJjb25zdCBTcHJpdGVIZWxwZXIgPSByZXF1aXJlKCdTcHJpdGVIZWxwZXInKTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGF2YXRhclNwcml0ZTogY2MuU3ByaXRlLFxuICAgICAgICBsYWJlbFVzZXJJZDogY2MuTGFiZWwsXG4gICAgICAgIGxhYmVsU2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcblxuICAgICAgICBfZGVza0luZm86IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldFVzZXJJbmZvOiBmdW5jdGlvbiAodXNlciwgZGVza0luZm8pIHtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciB0b3RhbFNjb3JlID0gdXNlci50b3RhbFNjb3JlO1xuICAgICAgaWYgKGRlc2tJbmZvICYmICgoZGVza0luZm8uc2V0dGluZzEgPT0gMCkgfHwgKGRlc2tJbmZvLnNldHRpbmcxID09IDEpKSkge1xuICAgICAgICBsZXQgYmFzZVNjb3JlID0gKGRlc2tJbmZvLnNldHRpbmcxID09IDApID8gMTAwIDogMjAwO1xuICAgICAgICB0b3RhbFNjb3JlID0gdG90YWxTY29yZSAtIGJhc2VTY29yZTtcbiAgICAgIH1cblxuICAgICAgU3ByaXRlSGVscGVyLnNldEltYWdlVXJsKHRoaXMuYXZhdGFyU3ByaXRlLCB1c2VyLmF2YXRhclVybCk7XG4gICAgICB0aGlzLmxhYmVsVXNlcklkLnN0cmluZyA9IFwiXCIgKyB1c2VyLmlkO1xuICAgICAgdGhpcy5sYWJlbFNjb3JlLnN0cmluZyA9ICh0b3RhbFNjb3JlID4gMCkgPyAoXCIrIFwiICsgdG90YWxTY29yZSkgOiAoXCItIFwiICsgdG90YWxTY29yZSAqIC0xKTtcbiAgICAgIGlmICh0b3RhbFNjb3JlID09IDApIHtcbiAgICAgICAgdGhpcy5sYWJlbFNjb3JlLnN0cmluZyA9IFwiMFwiO1xuICAgICAgfVxuICAgICAgdGhpcy5sYWJlbE5pY2tuYW1lLnN0cmluZyA9IHVzZXIubmlja25hbWU7XG4gICAgfSxcbn0pO1xuIiwiY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBpdGVtTGF5b3V0OiBjYy5MYXlvdXQsXG4gICAgICAgIGl0ZW1QcmVmYWI6IGNjLlByZWZhYixcbiAgICAgICAgdGltZUxhYmVsOmNjLkxhYmVsLCAgIC8vIOaXtumXtFxuICAgICAgICBqdXNodUxhYmVsOmNjLkxhYmVsLCAgLy8g5bGA5pWwXG4gICAgICAgIHJvb21JZDpjYy5MYWJlbCwgICAgICAvLyDmiL/pl7Tlj7dcbiAgICAgICAgbmlja25hbWVMYWJlbHM6Y2MuTGFiZWwsXG4gICAgICAgIHJlY29yZEluZm9fc3ZpZXc6W2NjLk5vZGVdLFxuXG4gICAgICAgIHNoYXJyQmc6Y2MuTm9kZSxcbiAgICAgICAgYnRuV2VpWGluOmNjLk5vZGUsXG4gICAgICAgIGJ0bkdvbmdYdW9IYW86Y2MuTm9kZSxcbiAgICAgICAgYnRuWmh1U2hvdTpjYy5Ob2RlLFxuICAgICAgICBidG5ab25nRmVuOmNjLk5vZGUsXG5cbiAgICAgICAgc3VhbmZlbl9zdmlldzpjYy5Ob2RlLFxuICAgICAgICBzdWFuRmVuUHJlZmFiOiBjYy5QcmVmYWIsXG4gICAgICAgIHN1YW5GZW5CZ1ByZWZhYjogY2MuUHJlZmFiLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBvbkRpc2FibGU6ZnVuY3Rpb24oKXtcbiAgICAgICAgLy9pZihjYy5zeXMuaXNCcm93c2VyKXtcbiAgICAgICAgLy9cbiAgICAgICAgICAgIHZhciBzaGFyZVRpdGxlID0gJ+W8gOaIv+eOqVvlpKfkvJfljYHkuInmsLRdJztcbiAgICAgICAgICAgIHZhciBkZXNjID0gJ+W8gOWlveaIv+S6hu+8jOWwseetieS9oOS7rOS4gOi1t+adpVvlpKfkvJfljYHkuInmsLRd5ZWm77yB5pma5LqG5L2N572u5bCx5rKh5LqG5ZOffic7IFxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzaGFyZVRpdGxlJyxzaGFyZVRpdGxlKTtcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGVzYycsZGVzYyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInNoYXJlVGl0bGVcIik7XG4gICAgICAgICAgICAvLyBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJkZXNjXCIpO1xuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwicmVjb3JkSWRcIik7XG4gICAgICAgICAgICAvL2NjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInJvb21JZFwiLCcnKTtcbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvVGltZUxpbmUpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1Nlc3Npb24pIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1Nlc3Npb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgLy99XG5cbiAgICB9LFxuICAgIGpzOiBmdW5jdGlvbihzZXR0aW5nMil7XG4gICAgICAgIHZhciBqdXNodSA9IDU7XG4gICAgICAgIHN3aXRjaChzZXR0aW5nMil7XG4gICAgICAgICAgICBjYXNlIDA6IGp1c2h1ID0gNTsgYnJlYWs7Y2FzZSAxOiBqdXNodSA9IDEwOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjoganVzaHUgPSAyMDsgYnJlYWs7Y2FzZSAzOiBqdXNodSA9IDMwOyBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ganVzaHU7XG4gICAgfSxcblxuICAgIGNyZWF0b3IgOmZ1bmN0aW9uKGNyZWF0b3IscGxheWVycyl7ICAgIC8v5Yib5oi/6ICFXG4gICAgICAgIGZvcih2YXIgaSA9MDsgaTxwbGF5ZXJzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgaWYocGxheWVyc1tpXS5pZCA9PSBjcmVhdG9yKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfY2xpY2tCdG4gOmZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuYnRuWmh1U2hvdS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmJ0blpvbmdGZW4uYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGNsaWNrWm9uZ0ZlbiA6ZnVuY3Rpb24oKXtcblxuICAgICAgICB0aGlzLmJ0blpodVNob3UuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLmJ0blpvbmdGZW4uYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5yZWNvcmRJbmZvX3N2aWV3LmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtub2RlLmFjdGl2ZSA9IHRydWU7fSk7XG5cbiAgICAgICAgdGhpcy5zdWFuZmVuX3N2aWV3LmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG4gICAgX2dsb2JhbE1zZzpmdW5jdGlvbihyZWNvcmRJbmZvKXtcbiAgICAgICAgLy9pZihjYy5zeXMuaXNCcm93c2VyKSB7XG4gICAgICAgICAgICB2YXIgcm9vbUlkID1cIuaIv+mXtOWPt++8mlwiK3JlY29yZEluZm8ucm9vbUlkO1xuICAgICAgICAgICAgdmFyIHBqID0gW1wiNSBcIixcIjEwIFwiLFwiMjAgXCJdOyAgXG4gICAgICAgICAgICB2YXIganMgPSBcIuWxgOaVsO+8mlwiK3BqW3JlY29yZEluZm8uc2V0dGluZzEtMl07XG4gICAgICAgICAgICB2YXIgdGltZSA9IFwi5pe26Ze077yaXCIrKHJlY29yZEluZm8uY3JlYXRlQXQ/cmVjb3JkSW5mby5jcmVhdGVBdDpyZWNvcmRJbmZvLmNyZWF0ZVRpbWUpO1xuICAgICAgICAgICAgdmFyIHNoYXJlVGl0bGUgPSBcIlvlpKfkvJfljYHkuInmsLRd5oiY57upXCI7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IHJvb21JZCtqcyt0aW1lK1wiIOeCueWHu+afpeeci+ivpuaDhVwiO1xuICAgICAgICAgICAgdmFyIHJlY29yZElkID0gKHJlY29yZEluZm8uaWQhPXVuZGVmaW5lZCk/cmVjb3JkSW5mby5pZDpyZWNvcmRJbmZvLnJlY29yZElkOyAgXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJzaGFyZVRpdGxlXCIsc2hhcmVUaXRsZSk7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJkZXNjXCIsZGVzYyk7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJyZWNvcmRJZFwiLHJlY29yZElkKTtcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInJvb21JZFwiLCcnKTtcblxuICAgICAgICAgICAgaWYod2luZG93LnNoYXJlVG9UaW1lTGluZSkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvVGltZUxpbmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvU2Vzc2lvbikge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvU2Vzc2lvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAvL31cbiAgICB9LFxuICAgIC8v5aSn5bGAXG4gICAgc2V0UGxheWVySW5mb3M6IGZ1bmN0aW9uIChwbGF5ZXJJbmZvcywgZGVza0luZm8pe1xuICAgICAgICBwbGF5ZXJJbmZvcy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIudG90YWxTY29yZS1hLnRvdGFsU2NvcmV9KTsgLy8g5o6S5bqPXG4gICAgICAgIC8vIGNjLmxvZyhwbGF5ZXJJbmZvcylcbiAgICAgICAgLy8gY2MubG9nKGRlc2tJbmZvKVxuICAgICAgICAvLyBjYy5sb2coJy0tNjUnKVxuICAgICAgICAgXG4gICAgICAgIHRoaXMuX2dsb2JhbE1zZyhkZXNrSW5mbyk7XG4gICAgICAgIHRoaXMucmVjb3JkSW5mb19zdmlldy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7bm9kZS5hY3RpdmUgPSB0cnVlO30pO1xuXG4gICAgICAgIHRoaXMuc3VhbmZlbl9zdmlldy5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLmJ0blpodVNob3UuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLmJ0blpvbmdGZW4uYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSBwbGF5ZXJJbmZvcztcblxuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IGRlc2tJbmZvO1xuXG4gICAgICAgIHZhciBjcmVhdGVJZCA9IGRlc2tJbmZvLmNyZWF0ZVVzZXJJZD8gZGVza0luZm8uY3JlYXRlVXNlcklkOiBkZXNrSW5mby5jcmVhdGVJZDtcblxuICAgICAgICB2YXIgbmlja25hbWUgPSBwbGF5ZXJJbmZvc1sgdGhpcy5jcmVhdG9yKGNyZWF0ZUlkLCBwbGF5ZXJJbmZvcykgXS5uaWNrbmFtZTtcblxuICAgICAgICB0aGlzLnJvb21JZC5zdHJpbmcgPSBkZXNrSW5mby5yb29tSWQ7XG5cbiAgICAgICAgdmFyIGNyZWF0ZUF0ID0gZGVza0luZm8uY3JlYXRlQXQ/IGRlc2tJbmZvLmNyZWF0ZUF0OiBkZXNrSW5mby5jcmVhdGVUaW1lO1xuXG4gICAgICAgIHRoaXMudGltZUxhYmVsLnN0cmluZyA9IGNyZWF0ZUF0LnN1YnN0cigwLDExKTtcblxuICAgICAgICB0aGlzLmp1c2h1TGFiZWwuc3RyaW5nID0gdGhpcy5qcyhkZXNrSW5mby5zZXR0aW5nMS0yKTtcblxuICAgICAgICB0aGlzLm5pY2tuYW1lTGFiZWxzLnN0cmluZyA9IG5pY2tuYW1lO1xuXG4gICAgICAgIHRoaXMuaXRlbUxheW91dC5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbiAodXNlcikge1xuXG4gICAgICAgICAgICBsZXQgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuaXRlbVByZWZhYik7XG5cbiAgICAgICAgICAgIGl0ZW0uZ2V0Q29tcG9uZW50KCdUb3RhbEdhbWVSZXN1bHRJdGVtJykuc2V0VXNlckluZm8odXNlciwgZGVza0luZm8pO1xuXG4gICAgICAgICAgICBpZihkZXNrSW5mby5jcmVhdGVVc2VySWQgPT0gdXNlci5pZCB8fCBkZXNrSW5mby5jcmVhdGVJZCA9PSB1c2VyLmlkKXtcblxuICAgICAgICAgICAgICAgIGl0ZW0uY2hpbGRyZW5bMV0uY2hpbGRyZW5bMF0uYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICAgICAgfWVsc2V7XG5cbiAgICAgICAgICAgICAgICBpdGVtLmNoaWxkcmVuWzFdLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuaXRlbUxheW91dC5ub2RlLmFkZENoaWxkKGl0ZW0pO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICB9LFxuXG4gICAgLy/nrpfliIbog73miYtcbiAgICBjbGlja1N1YW5GZW46IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB0aGlzLmJ0blpodVNob3UuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5idG5ab25nRmVuLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5yZWNvcmRJbmZvX3N2aWV3LmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtub2RlLmFjdGl2ZSA9IGZhbHNlO30pO1xuXG4gICAgICAgIHRoaXMuc3VhbmZlbl9zdmlldy5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHZhciBwbGF5ZXJzUmlndGggPSB0aGlzLl9wbGF5ZXJJbmZvcy5maWx0ZXIoZnVuY3Rpb24gKHBsYXllcikge3JldHVybiBwbGF5ZXIudG90YWxTY29yZSA+IDA7fSk7XG5cbiAgICAgICAgdmFyIHBsYXllcnNMZWZ0ID0gdGhpcy5fcGxheWVySW5mb3MuZmlsdGVyKGZ1bmN0aW9uIChwbGF5ZXIpIHtyZXR1cm4gcGxheWVyLnRvdGFsU2NvcmUgPCAwO30pO1xuXG4gICAgICAgIHZhciBwbGF5ZXJzUmlndGhTY29yZSA9IHBsYXllcnNSaWd0aC5tYXAoZnVuY3Rpb24gKHBsYXllcikge3JldHVybiBwbGF5ZXIudG90YWxTY29yZTt9KTtcblxuICAgICAgICB2YXIgcGxheWVyc0xlZnRTY29yZSA9IHBsYXllcnNMZWZ0Lm1hcChmdW5jdGlvbiAocGxheWVyKSB7cmV0dXJuIHBsYXllci50b3RhbFNjb3JlICogLTE7fSk7XG5cbiAgICAgICAgdmFyIHBsYXllcnNJbmRleCA9IFtdLFxuXG4gICAgICAgICAgICBhcnJzID0gW3BsYXllcnNSaWd0aFNjb3JlLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaTt9KSxwbGF5ZXJzTGVmdFNjb3JlLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaTt9KV0sXG5cbiAgICAgICAgICAgIGluZGV4cyA9IHBsYXllcnNMZWZ0U2NvcmUubGVuZ3RoID4gcGxheWVyc1JpZ3RoU2NvcmUubGVuZ3RoPyAwOiAxOy8vMeaYr+i1oueahOS6uiAw6L6T55qE5Lq6XG5cbiAgICAgICAgLy8gZm9yKHZhciBpID0gMDtpIDwgYXJyc1tpbmRleHNdLmxlbmd0aDsgaSsrKXtcblxuICAgICAgICAvLyAgICAgdmFyIHNjb3JlID0gYXJyc1tpbmRleHNdW2ldO1xuXG4gICAgICAgIC8vICAgICB2YXIgZCA9IHRoaXMuZ2V0Q29tYkJ5U3VtKGFycnNbaW5kZXhzPT0xPzA6MV0sIHNjb3JlKVswXSB8fCBbXTtcblxuICAgICAgICAvLyAgICAgaWYoZC5sZW5ndGggPiAwKXtcblxuICAgICAgICAvLyAgICAgICAgIHBsYXllcnNJbmRleC5wdXNoKFtzY29yZSxkXSk7XG5cbiAgICAgICAgLy8gICAgICAgICBkLmZvckVhY2goZnVuY3Rpb24gKHMpIHtcblxuICAgICAgICAvLyAgICAgICAgICAgICB2YXIgaW5kZXggPSBhcnJzW2luZGV4cz09MT8wOjFdLmluZGV4T2Yocyk7XG5cbiAgICAgICAgLy8gICAgICAgICAgICAgaWYoaW5kZXggIT0gLTEpIGFycnNbaW5kZXhzPT0xPzA6MV0uc3BsaWNlKGluZGV4LDEpO1xuXG4gICAgICAgIC8vICAgICAgICAgfSk7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH1cblxuICAgICAgICAvLyBpZihwbGF5ZXJzSW5kZXgubGVuZ3RoID09IDApIGluZGV4cyA9IDI7XG4gICAgICAgIGluZGV4cyA9IDJcbiAgICAgICAgdGhpcy5zdWFuZmVuX3N2aWV3LmNoaWxkcmVuWzBdLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgcGxheWVyc0xlZnQuZm9yRWFjaChmdW5jdGlvbiAodXNlciwgaW5kZXgpIHtcblxuICAgICAgICAgICAgdmFyIHN1YW5GZW5CZ1ByZWZhYiA9IGNjLmluc3RhbnRpYXRlKHRoaXMuc3VhbkZlbkJnUHJlZmFiKTtcblxuICAgICAgICAgICAgc3VhbkZlbkJnUHJlZmFiLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2N0YXJlUHJlZmFiKDEgLHN1YW5GZW5CZ1ByZWZhYiwgdXNlciwgdXNlci50b3RhbFNjb3JlLCB0aGlzLl9kZXNrSW5mbyAsLTIwMCAsMCk7XG5cbiAgICAgICAgICAgIHZhciB4ID0gMCwgeSA9IDA7XG5cbiAgICAgICAgICAgIGlmKGluZGV4cyA9PSAxKXtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgcGxheWVyc0luZGV4W2luZGV4XVsxXS5sZW5ndGg7IGorKyl7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBwbGF5ZXJzSW5kZXhbaW5kZXhdWzFdW2pdO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gcGxheWVyc1JpZ3RoU2NvcmUuaW5kZXhPZihzKTtcblxuICAgICAgICAgICAgICAgICAgICBpZihkICE9IC0xKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXlzID0gcGxheWVyc1JpZ3RoLnNwbGljZShkLDEpWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJzUmlndGhTY29yZS5zcGxpY2UoZCwxKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYocGxheXMpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPj0gMykgeSA9IC05MDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID09IDMpIHggPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPj0gNSkgeSA9IC0xODA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdWFuRmVuQmdQcmVmYWIuY2hpbGRyZW5Db3VudCA9PSA1KSB4ID0gMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2N0YXJlUHJlZmFiKDAsIHN1YW5GZW5CZ1ByZWZhYiwgcGxheXMsIHBsYXlzLnRvdGFsU2NvcmUsIHRoaXMuX2Rlc2tJbmZvLCB4ICx5KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggKz0gMjAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGluZGV4cyA9PSAwKXtcbiAgICAgICAgICAgICAgICB2YXIgZmVuID0gc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuWzBdLmdldENoaWxkQnlOYW1lKFwiZmVuXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nLnN1YnN0cigzKSAqIC0xO1xuXG4gICAgICAgICAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IHBsYXllcnNJbmRleC5sZW5ndGg7IGorKyl7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBwbGF5ZXJzSW5kZXhbal07XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBzWzFdLmluZGV4T2YoZmVuKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcSA9IHNbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHcgPSBwbGF5ZXJzUmlndGhTY29yZS5pbmRleE9mKHEpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKGQgIT0gLTEgJiYgdyAhPSAtMSl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbGF5cyA9IHBsYXllcnNSaWd0aFt3XTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3RhcmVQcmVmYWIoMCwgc3VhbkZlbkJnUHJlZmFiLCBwbGF5cywgcGxheXMudG90YWxTY29yZSwgdGhpcy5fZGVza0luZm8sIHgsIHksIGZlbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcSA9IHBsYXllcnNMZWZ0U2NvcmVbaW5kZXhdO1xuICAgICAgICAgICAgICAgIHZhciBhZGRTY29yZSA9IDA7XG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IFtdO1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCBwbGF5ZXJzUmlndGhTY29yZS5sZW5ndGg7IGorKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB3ID0gcGxheWVyc1JpZ3RoU2NvcmVbal07XG4gICAgICAgICAgICAgICAgICAgIGlmKGFkZFNjb3JlIDwgcSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRTY29yZSArPSB3O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYWRkU2NvcmUgPiBxKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnIucHVzaCh3IC0gKGFkZFNjb3JlIC0gcSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2godyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihxIC0gdyA+PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJzUmlndGhTY29yZVtqXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYoYWRkU2NvcmUgPiBxKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllcnNSaWd0aFNjb3JlW2pdID0gYWRkU2NvcmUgLSBxO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IodmFyIHQgPSAwOyB0IDwgYXJyLmxlbmd0aDsgdCsrKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBhcnJbdF07XG4gICAgICAgICAgICAgICAgICAgIGlmKHIgPT0gMCkgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID49IDMpIHkgPSAtOTA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPT0gMykgeCA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPj0gNSkgeSA9IC0xODA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPT0gNSkgeCA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXlzID0gcGxheWVyc1JpZ3RoW3RdO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N0YXJlUHJlZmFiKDAsIHN1YW5GZW5CZ1ByZWZhYiwgcGxheXMsIHIsIHRoaXMuX2Rlc2tJbmZvLCB4LCB5KTtcblxuICAgICAgICAgICAgICAgICAgICB4ICs9IDIwMDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zdWFuZmVuX3N2aWV3LmNoaWxkcmVuWzBdLmFkZENoaWxkKHN1YW5GZW5CZ1ByZWZhYik7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIH0sXG5cbiAgICBfY3RhcmVQcmVmYWI6IGZ1bmN0aW9uIChzaHUsIG5vZGUsIHVzZXIsIHRvdGFsU2NvcmUsIGRlc2tJbmZvLCB4LCB5LCBmZW4gPSBudWxsKSB7XG5cbiAgICAgICAgdmFyIHN1YW5GZW5QcmVmYWIgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnN1YW5GZW5QcmVmYWIpO1xuXG4gICAgICAgIHN1YW5GZW5QcmVmYWIuZ2V0Q2hpbGRCeU5hbWUoXCJJRFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwiSUQ6XCIrdXNlci5pZDtcblxuICAgICAgICBpZihkZXNrSW5mby5jcmVhdGVVc2VySWQgPT0gdXNlci5pZClzdWFuRmVuUHJlZmFiLmdldENoaWxkQnlOYW1lKFwiSURcIikuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjM1LCAxMTUsIDEyMik7XG5cbiAgICAgICAgc3VhbkZlblByZWZhYi5nZXRDaGlsZEJ5TmFtZShcInNodVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHNodSA9PSAwPyBcIui+k1wiOiBcIlwiO1xuXG4gICAgICAgIHZhciBzdHIgPSBzaHUgPT0gMD8gdG90YWxTY29yZStcIuWIhlwiOiBcIuaAu+WIhjpcIit0b3RhbFNjb3JlO1xuXG4gICAgICAgIGlmKGZlbikgc3RyID0gZmVuK1wi5YiGXCI7XG5cbiAgICAgICAgc3VhbkZlblByZWZhYi5nZXRDaGlsZEJ5TmFtZShcImZlblwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHN0cjtcblxuICAgICAgICB2YXIgc3ByaXRlID0gc3VhbkZlblByZWZhYi5nZXRDaGlsZEJ5TmFtZShcImhhZWRcIikuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgICAgdmFyIGhlYWRVcmwgPSB1c2VyLmF2YXRhclVybDsgLy8g5aS05YOPVVJMXG5cbiAgICAgICAgY2MubG9hZGVyLmxvYWQoe3VybDpoZWFkVXJsLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIHRleCkge1xuXG4gICAgICAgICAgICBpZiAoIWVycikge1xuXG4gICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKHRleCk7XG5cbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBmcmFtZTtcblxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmhlaWdodCA9IDU1O1xuXG4gICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUud2lkdGggPSA1NTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHN1YW5GZW5QcmVmYWIueCA9IHg7XG5cbiAgICAgICAgc3VhbkZlblByZWZhYi55ID0geTtcblxuICAgICAgICBub2RlLmhlaWdodCA9IDkwICsgeSAqIC0xO1xuXG4gICAgICAgIG5vZGUuYWRkQ2hpbGQoc3VhbkZlblByZWZhYik7XG5cbiAgICB9LFxuXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFNvY2tldC5zZW5kT25jZUFnYWluKCdmYWxzZScsdGhpcy5fdXNlcklkKTtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgfSxcblxuICAgIGNsaWNrU2hhcmVXZWlDaGF0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgdGhpcy5zaGFyckJnLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2NyZWVuU2hhcmVGcmllbmRcIiwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAgICAgICAgS1FOYXRpdmVJbnZva2Uuc2NyZWVuc2hvdFNoYXJlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgfVxuICAgIH0sXG4gICAgY2xpY2tTaGFyZUJnIDpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2hhcnJCZy5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuICAgIGNsaWNrU2hhcmVQZW5nWW91UXVhbjogZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2NyZWVuU2hhcmVcIiwpO1xuICAgICAgfVxuICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVcIiwgXCIoKVZcIik7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGdldENvbWJCeVN1bTogZnVuY3Rpb24gKGFycmF5LHN1bSx0b2xlcmFuY2UsdGFyZ2V0Q291bnQpIHtcbiAgICAgICAgdmFyIHV0aWwgPSB7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgZ2V0IGNvbWJpbmF0aW9uIGZyb20gYXJyYXlcbiAgICAgICAgICAgICAgICAgYXJyOiB0YXJnZXQgYXJyYXlcbiAgICAgICAgICAgICAgICAgbnVtOiBjb21iaW5hdGlvbiBpdGVtIGxlbmd0aFxuICAgICAgICAgICAgICAgICByZXR1cm46IG9uZSBhcnJheSB0aGF0IGNvbnRhaW4gY29tYmluYXRpb24gYXJyYXlzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZ2V0Q29tYmluYXRpb246IGZ1bmN0aW9uKGFyciwgbnVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByPVtdO1xuICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gZih0LGEsbilcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG49PTApXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIucHVzaCh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MCxsPWEubGVuZ3RoOyBpPD1sLW47IGkrKylcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmKHQuY29uY2F0KGFbaV0pLCBhLnNsaWNlKGkrMSksIG4tMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pKFtdLGFycixudW0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vdGFrZSBhcnJheSBpbmRleCB0byBhIGFycmF5XG4gICAgICAgICAgICAgICAgZ2V0QXJyYXlJbmRleDogZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgciA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7aTxhcnJheS5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHIucHVzaChpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sbG9naWMgPSB7XG4gICAgICAgICAgICAgICAgLy9zb3J0IHRoZSBhcnJheSx0aGVuIGdldCB3aGF0J3Mgd2UgbmVlZFxuICAgICAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uKGFycmF5LHN1bSkge1xuICAgICAgICAgICAgICAgICAgICAvL2Nsb25lIGFycmF5XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYXJyYXkgPSBhcnJheS5jb25jYXQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAwO1xuICAgICAgICAgICAgICAgICAgICAvL3NvcnQgYnkgYXNjXG4gICAgICAgICAgICAgICAgICAgIF9hcnJheS5zb3J0KGZ1bmN0aW9uKGEsYil7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSAtIGI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvL2dldCBhbGwgbnVtYmVyIHdoZW4gaXQncyBsZXNzIHRoYW4gb3IgZXF1YWwgc3VtXG4gICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDtpPF9hcnJheS5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKF9hcnJheVtpXTw9c3VtKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnB1c2goX2FycmF5W2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAvL2ltcG9ydGFudCBmdW5jdGlvblxuICAgICAgICAgICAgICAgIGNvcmU6IGZ1bmN0aW9uKGFycmF5LHN1bSxhcnJheUluZGV4LGNvdW50LHIpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBrID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbWJBcnJheSA9IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgX3N1bSA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2NhID0gW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2FjaGUgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICBpZihjb3VudCA9PSBfcmV0dXJuTWFyayl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgY3VycmVudCBjb3VudCBjb21iaW5hdGlvblxuICAgICAgICAgICAgICAgICAgICBjb21iQXJyYXkgPSB1dGlsLmdldENvbWJpbmF0aW9uKGFycmF5SW5kZXgsY291bnQpO1xuICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7aTxjb21iQXJyYXkubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2NhID0gY29tYkFycmF5W2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3N1bSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2FjaGUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRlIHRoZSBzdW0gZnJvbSBjb21iaW5hdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGsgPSAwO2s8X2NjYS5sZW5ndGg7aysrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3VtICs9IGFycmF5W19jY2Fba11dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jYWNoZS5wdXNoKGFycmF5W19jY2Fba11dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKE1hdGguYWJzKF9zdW0tc3VtKSA8PSBfdG9sZXJhbmNlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnB1c2goX2NhY2hlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGxvZ2ljLmNvcmUoYXJyYXksc3VtLGFycmF5SW5kZXgsY291bnQtMSxyKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByID0gW10sXG4gICAgICAgICAgICBfYXJyYXkgPSBbXSxcbiAgICAgICAgICAgIF90YXJnZXRDb3VudCA9IDAsXG4gICAgICAgICAgICBfdG9sZXJhbmNlID0gMCxcbiAgICAgICAgICAgIF9yZXR1cm5NYXJrID0gMDtcblxuICAgICAgICAvL2NoZWNrIGRhdGFcbiAgICAgICAgX3RhcmdldENvdW50ID0gdGFyZ2V0Q291bnQgfHwgX3RhcmdldENvdW50O1xuICAgICAgICBfdG9sZXJhbmNlID0gdG9sZXJhbmNlIHx8IF90b2xlcmFuY2U7XG5cbiAgICAgICAgX2FycmF5ID0gbG9naWMuaW5pdChhcnJheSxzdW0pO1xuICAgICAgICBpZihfdGFyZ2V0Q291bnQpe1xuICAgICAgICAgICAgX3JldHVybk1hcmsgPSBfdGFyZ2V0Q291bnQtMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvZ2ljLmNvcmUoX2FycmF5LHN1bSx1dGlsLmdldEFycmF5SW5kZXgoX2FycmF5KSwoX3RhcmdldENvdW50IHx8IF9hcnJheS5sZW5ndGgpLHIpO1xuXG4gICAgICAgIHJldHVybiByO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IFVzZXJNb2RlbEhlbHBlciA9IHtcbiAgLy8g55So5oi35piv5ZCm5bey5Ye654mMXG4gIGlzUGxheWVkQ2FyZHM6IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgY2MuYXNzZXJ0KHVzZXIpO1xuXG4gICAgaWYgKHVzZXIgJiYgdXNlci5jYXJkSW5mbyAmJiB1c2VyLmNhcmRJbmZvLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcblxuICAvLyDnlKjmiLfmmK/lkKblt7Llh4blpIdcbiAgaXNVc2VyUmVhZHk6IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgcmV0dXJuIHVzZXIucmVhZHlTdGF0dXMgPT0gdHJ1ZTtcbiAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVXNlck1vZGVsSGVscGVyO1xuIiwiY29uc3QgU3ByaXRlSGVscGVyID0gcmVxdWlyZSgnU3ByaXRlSGVscGVyJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGxhYmVsVXNlcklkOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxVc2VySVA6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcbiAgICAgICAgYXZhdGFyU3ByaXRlOiBjYy5TcHJpdGUsXG4gICAgICAgIG1hblNwcml0ZTogY2MuU3ByaXRlLFxuICAgICAgICB3b21lblNwcml0ZTogY2MuU3ByaXRlLFxuXG4gICAgICAgIF9kaWRTaG93VXNlckluZm86IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHVwZGF0ZVdpdGhVc2VyOiBmdW5jdGlvbiAodXNlcikge1xuICAgICAgcmV0dXJuO1xuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2RpZFNob3dVc2VySW5mbyA9PSB1c2VyKSB7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xuICAgICAgICB0aGlzLl9kaXNhcHBlYXJVc2VySW5mbygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2RpZFNob3dVc2VySW5mbyA9IHVzZXI7XG4gICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGlzYXBwZWFyVXNlckluZm8oKTtcbiAgICAgIH0uYmluZCh0aGlzKSwgNSk7XG5cbiAgICAgIHRoaXMubGFiZWxVc2VySWQuc3RyaW5nID1cIlVJRDpcXG5cIit1c2VyLmlkO1xuICAgICAgdGhpcy5sYWJlbFVzZXJJUC5zdHJpbmcgPVwi55So5oi3SVA6XFxuXCIrdXNlci5pcEFkZHJlc3MucmVwbGFjZShcIjo6ZmZmZjpcIiwgXCJcIik7XG4gICAgICB0aGlzLmxhYmVsTmlja25hbWUuc3RyaW5nID0gdXNlci5uaWNrbmFtZTtcbiAgICAgIHRoaXMuYXZhdGFyU3ByaXRlLnNwcml0ZUZyYW1lID0gbnVsbDtcbiAgICAgIFNwcml0ZUhlbHBlci5zZXRJbWFnZVVybCh0aGlzLmF2YXRhclNwcml0ZSwgdXNlci5hdmF0YXJVcmwpO1xuXG4gICAgICBsZXQgc2V4ID0gdXNlci5zZXg7ICAvLyBzZXg6IDEg55S3ICAyIOWls1xuICAgICAgdGhpcy5tYW5TcHJpdGUubm9kZS5hY3RpdmUgPSAoc2V4ID09IDEpO1xuICAgICAgdGhpcy53b21lblNwcml0ZS5ub2RlLmFjdGl2ZSA9IChzZXggIT0gMSk7XG4gICAgfSxcblxuICAgIF9kaXNhcHBlYXJVc2VySW5mbzogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5fZGlkU2hvd1VzZXJJbmZvID0gbnVsbDtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcclxuY29uc3QgS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlciA9IHJlcXVpcmUoJ0tRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXInKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIGFncmVlbWVudDoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUhhbGxJbmZvLCB0aGlzLl9zb2NrZXRSZWNlaXZlSGFsbEluZm8sIHRoaXMpO1xyXG4gICAgICAgIC8vIGNjLmxvZygnLS0tLTYxJylcclxuICAgICAgICAvLyAgY2MubG9nKHRoaXMuYWdyZWVtZW50KVxyXG4gICAgfSxcclxuICAgIF9zb2NrZXRSZWNlaXZlSGFsbEluZm86IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHMgPSBjYy5maW5kKCdDYW52YXMvYWdyZWVtZW50Jyk7XHJcbiAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIC8vdGhpcy5faW5mbzEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIC8vIGNjLmxvZyh0aGlzLmFncmVlbWVudClcclxuICAgICAgICAvLyBjYy5sb2cocylcclxuICAgICAgICAvLyBjYy5sb2coJy0tLS02MScpXHJcbiAgICAgICAgdGhpcy5hZ3JlZW1lbnQuc3RyaW5nID0gZGF0YS5pbmZvMSB8fCBcIlwiO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJ2YXIgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBwb3BOb2RlOmNjLk5vZGUsXG4gICAgICAgIGxhYmVsOmNjLkxhYmVsLFxuXG4gICAgICAgIF9hbGVydENhbGxiYWNrOiBudWxsLFxuICAgICAgICBfd2lsbERpc21pc3NDYWxsYmFjazogbnVsbCxcbiAgICAgICAgX2Rpc21pc3NDYWxsYmFjazogbnVsbCxcbiAgICAgICAgX2NvbmZpcm1DYWxsYmFjazogbnVsbCwgICAvLyDngrnlh7vnoa7lrprlkI7nmoTlm57osINcbiAgICAgICAgX3Rpc2hpOm51bGwsXG4gICAgICAgIF9jYXJkX251bTpudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIFxuICAgIH0sXG5cbiAgICBhbGVydDpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciBhbmltID0gdGhpcy5wb3BOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICBhbmltLnBsYXkoJ3BvcCcpO1xuXG4gICAgICAgIGlmICh0aGlzLl9hbGVydENhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy5fYWxlcnRDYWxsYmFjayh0aGlzLm5vZGUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvKiMjIyMj5by55Ye657uT5p6cKi9cbiAgICBhbGVydFJlc3VsdDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgY2MuZmluZChcIkNhbnZhcy9zaG93X3Jlc3VsdFwiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBvcE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgIGFuaW0ucGxheSgncG9wJyk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2FsZXJ0Q2FsbGJhY2spIHtcbiAgICAgICAgICB0aGlzLl9hbGVydENhbGxiYWNrKHRoaXMubm9kZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyojIyMjI+eCueWHu+ehruWumiovXG4gICAgcGxheUJ0bkNsaWNrU0ZYOmZ1bmN0aW9uKCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUJ0bkNsaWNrU0ZYKCk7XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vlj5bmtogqL1xuICAgIHBhbHlCdG5DYW5jZWxDbGlja1NGWDpmdW5jdGlvbigpe1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseUJ0bkNhbmNlbENsaWNrU0ZYKCk7XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vlhbPpl63miJbogIXmjInplK7kuYvnsbvnmoTmjInpkq7vvIzmkq3mlL7pn7PmlYgqL1xuICAgIHBhbHlCdG5QdWJsaWNTRlg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlCdG5QdWJsaWNTRlgoKTtcbiAgICB9LFxuXG4gICAgLyojIyMjI+eCueWHu+WIm+W7uuaIv+mXtO+8jOaSreaUvumfs+aViCovXG4gICAgcGFseUJ0bkNyZWF0ZVJvb21TRlg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlCdG5DcmVhdGVSb29tU0ZYKCk7XG4gICAgfSxcbiAgICAvKiMjIyMj54K55Ye75Yib5bu65oi/6Ze077yM5pKt5pS+6Z+z5pWIKi9cbiAgICBwYWx5V2luZG93U0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5V2luZG93U0ZYKCk7XG4gICAgfSxcblxuICAgIHBhbHlXZWlYaW5Mb2dpblNGWDpmdW5jdGlvbigpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlXZWlYaW5Mb2dpblNGWCgpO1xuICAgIH0sXG4gICAgcGFseUZhbmdQYWlTRlg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlGYW5nUGFpU0ZYKCk7XG4gICAgfSxcblxuICAgIGRpc21pc3NBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICBsZXQgd2lsbERpc21pc3NDYWxsYmFjayA9IHRoaXMuX3dpbGxEaXNtaXNzQ2FsbGJhY2s7XG4gICAgICBpZiAod2lsbERpc21pc3NDYWxsYmFjaykge1xuICAgICAgICBsZXQgcmVzdWx0ID0gd2lsbERpc21pc3NDYWxsYmFjaygpO1xuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgdGhpcy5kaXNtaXNzQ29tcGxldGUoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgICB2YXIgYW5pbSA9IHRoaXMucG9wTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgdmFyIGRpc21pc3NBbmltID0gYW5pbS5nZXRBbmltYXRpb25TdGF0ZSgncG9wX2Rpc21pc3MnKTtcbiAgICAgICAgZGlzbWlzc0FuaW0ub24oJ2ZpbmlzaGVkJyx0aGlzLmRpc21pc3NDb21wbGV0ZSx0aGlzKTtcbiAgICAgICAgYW5pbS5wbGF5KCdwb3BfZGlzbWlzcycpO1xuICAgIH0sXG5cbiAgICAvKiMjIyMj6ZqQ6JeP57uT5p6c6aG16Z2iKi9cbiAgICBkaXNtaXNzQWN0aW9uUmVzdWx0OmZ1bmN0aW9uKCkge1xuICAgICAgbGV0IHdpbGxEaXNtaXNzQ2FsbGJhY2sgPSB0aGlzLl93aWxsRGlzbWlzc0NhbGxiYWNrO1xuICAgICAgaWYgKHdpbGxEaXNtaXNzQ2FsbGJhY2spIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHdpbGxEaXNtaXNzQ2FsbGJhY2soKTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgIHRoaXMuZGlzbWlzc0NvbXBsZXRlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBvcE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgIHZhciBkaXNtaXNzQW5pbSA9IGFuaW0uZ2V0QW5pbWF0aW9uU3RhdGUoJ3BvcF9kaXNtaXNzJyk7XG4gICAgICAgIGRpc21pc3NBbmltLm9uKCdmaW5pc2hlZCcsdGhpcy5kaXNtaXNzQ29tcGxldGUsdGhpcyk7XG4gICAgICAgIGFuaW0ucGxheSgncG9wX2Rpc21pc3MnKTtcbiAgICAgICAgY2MuZmluZChcIkNhbnZhcy9zaG93X3Jlc3VsdFwiKS5hY3RpdmUgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBkaXNtaXNzQ29tcGxldGU6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICBpZiAodGhpcy5vbkRpc21pc3NDb21wbGV0ZSkge1xuICAgICAgICAgIHRoaXMub25EaXNtaXNzQ29tcGxldGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9kaXNtaXNzQ2FsbGJhY2spIHtcbiAgICAgICAgICB0aGlzLl9kaXNtaXNzQ2FsbGJhY2sodGhpcy5ub2RlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgZGlzbWlzc1BsYXk6ZnVuY3Rpb24oKSB7XG4gICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJoYWxsXCIpOyAgXG4gICAgfSxcblxuICAgIG9uRGlzbWlzc0NvbXBsZXRlOmZ1bmN0aW9uKCkge1xuICAgICAgLy9jYy5sb2coXCJvbkRpc21pc3NDb21wbGV0ZVwiKTtcbiAgICB9LFxuXG4gICAgZG9uZUFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIHRoaXMub25Eb25lQWN0aW9uKCk7XG5cbiAgICAgICAgbGV0IGNvbmZpcm1DYWxsYmFjayA9IHRoaXMuX2NvbmZpcm1DYWxsYmFjaztcbiAgICAgICAgaWYgKGNvbmZpcm1DYWxsYmFjaykge1xuICAgICAgICAgIGNvbmZpcm1DYWxsYmFjayh0aGlzLm5vZGUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uRG9uZUFjdGlvbjpmdW5jdGlvbigpIHtcblxuICAgIH0sXG5cbiAgICBzZXRNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgICB0aGlzLmxhYmVsLnN0cmluZyA9IG1zZztcbiAgICB9LFxuXG4gICAgZ2V0TWVzc2FnZTogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubGFiZWwuc3RyaW5nO1xuICAgIH0sXG5cbiAgICBzZXRBbGVydENhbGxiY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgdGhpcy5fYWxlcnRDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH0sXG5cbiAgICBzZXRXaWxsRGlzbWlzc0NhbGxiYWNrOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX3dpbGxEaXNtaXNzQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9LFxuXG4gICAgc2V0RGlzbWlzc0NhbGxiYWNrOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX2Rpc21pc3NDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH0sXG5cbiAgICBzZXRDb25maXJtQ2FsbGJhY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgdGhpcy5fY29uZmlybUNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfSxcblxuICAgIC8qc2V0TWVzc2FnZTogZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgIHRoaXMubGFiZWwuZ2V0Q29tcG9uZW50KCdjYy5MYWJlbCcpLnN0cmluZyA9IG1lc3NhZ2U7XG4gICAgfSwqL1xuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiLyoqXHJcbiAqICDmiL/pl7TnibnmrorniYzliqjnlLtcclxuICpcclxuICpcclxuICpcclxuICogXHJcbiAqL1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGZhcGFpTm9kZTogY2MuUHJlZmFiLCAgLy9cclxuICAgICAgICBsaXVkdWliYW46Y2MuUHJlZmFiLFxyXG4gICAgICAgIHNhbnRvbmdodWE6Y2MuUHJlZmFiLFxyXG4gICAgICAgIHNhbnNodW56aTpjYy5QcmVmYWIsXHJcbiAgICAgICAgcXVhbmxlaWRhOmNjLlByZWZhYixcclxuICAgICAgICBxaW5nbG9uZzpjYy5QcmVmYWIsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuICAgIGZhcGFpQW5pbWF0aW9uOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGZhcGFpID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKCdmYXBhaScpO1xyXG4gICAgICAgIGZhcGFpID0gY2MucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgIHZhciBmYXBhaUFuaW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmZhcGFpTm9kZSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKGZhcGFpQW5pbSk7XHJcblxyXG4gICAgICAgIHZhciBMZ3VuID0gZmFwYWlBbmltLmdldENoaWxkQnlOYW1lKFwibGVmdF9nYW5nXCIpOyAgIC8vIOW3pui+ueeahOaKolxyXG4gICAgICAgIHZhciBSZ3VuID0gIGZhcGFpQW5pbS5nZXRDaGlsZEJ5TmFtZShcInJpZ2h0X2dhbmdcIik7IC8vIOWPs+i+ueeahOaKolxyXG4gICAgICAgIHZhciBtYXNrID0gZmFwYWlBbmltLmdldENoaWxkQnlOYW1lKFwibWFza1wiKTtcclxuICAgICAgICAvKiAtLS0tLS0tLS0tLXN0YXJ05Y+K5a2Q6IqC54K5LS0tLS0tLS0tLS0gKi9cclxuICAgICAgICB2YXIgc3RhcnQgPSBmYXBhaUFuaW0uZ2V0Q2hpbGRCeU5hbWUoXCJzdGFydFwiKSxcclxuICAgICAgICAgICAgcXVhbiA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwicXVhblwiKSxcclxuICAgICAgICAgICAgYmFvZGlhbiA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwiYmFvZGlhblwiKSxcclxuICAgICAgICAgICAgZGl0YW4gPSBzdGFydC5nZXRDaGlsZEJ5TmFtZShcImRpdGFuXCIpLFxyXG4gICAgICAgICAgICBiZWdpbkljbyA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwiYmVnaW5faWNvblwiKSxcclxuICAgICAgICAgICAgdGl0bGUgPSBzdGFydC5nZXRDaGlsZEJ5TmFtZShcInRpdGxlXCIpLFxyXG4gICAgICAgICAgICByV2luZyA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwicldpbmdcIiksXHJcbiAgICAgICAgICAgIGxXaW5nID0gc3RhcnQuZ2V0Q2hpbGRCeU5hbWUoXCJsV2luZ1wiKTtcclxuICAgICAgICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgZmFwYWlBbmltLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgbWFzay5ydW5BY3Rpb24oIGNjLnNjYWxlVG8oMC4yLDEwLDEwKSApO1xyXG4gICAgICAgIExndW4ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShzZWxmLkxndW5BY3Rpb24oKSkgKTtcclxuICAgICAgICBSZ3VuLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2Uoc2VsZi5SZ3VuQWN0aW9uKCkpICk7XHJcblxyXG4gICAgICAgIHZhciBzdGFydEZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgcldpbmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgbFdpbmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgbFdpbmcucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZSggY2MucmVwZWF0KCBjYy5zZXF1ZW5jZSggY2Muc2tld1RvKDAuMDUsMjAsLTEwKSxjYy5za2V3VG8oMC4wNSwwLDApICksMyksY2MuZmFkZU91dCgwKSkgKTtcclxuICAgICAgICAgICAgcldpbmcucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZSggY2MucmVwZWF0KCBjYy5zZXF1ZW5jZSggY2Muc2tld1RvKDAuMDUsMjAsLTEwKSxjYy5za2V3VG8oMC4wNSwwLDApICksMyksY2MuZmFkZU91dCgwKSkgKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgd2luZ0ZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgc3RhcnQucnVuQWN0aW9uKGNjLnNjYWxlVG8oMC4yLDAsMCkpO1xyXG4gICAgICAgICAgICB9LDUwMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzdGFydC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBzdGFydC5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4yLDEuNSwxLjUpLGNjLnNjYWxlVG8oMC4yLDEsMSksc3RhcnRGaW5pc2hlZCx3aW5nRmluaXNoZWQpICk7XHJcbiAgICAgICAgICAgIHF1YW4ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zY2FsZVRvKDAuMiwxMCwxMCksY2MuZmFkZU91dCgwKSkpO1xyXG4gICAgICAgICAgICBiYW9kaWFuLnJ1bkFjdGlvbiggIGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4yLDEuNSwxLjUpLGNjLmZhZGVPdXQoMCkpICk7XHJcbiAgICAgICAgfSw0MDApO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgbFdpbmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJXaW5nLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzdGFydC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgZmFwYWlBbmltLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmYXBhaUFuaW0ucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcclxuICAgICAgICB9LDIwMDApXHJcblxyXG4gICAgfSxcclxuICAgIExndW5BY3Rpb246ZnVuY3Rpb24oKXsgLy8g5bem6L6555qE5p6qXHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgY2Muc3Bhd24oW1xyXG4gICAgICAgICAgICAgICAgY2MubW92ZVRvKCAwLjIsIGNjLnYyKC00MzAsIDE1MikgKSxcclxuICAgICAgICAgICAgICAgIGNjLnNjYWxlVG8oMC4yLDIsMilcclxuICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgIGNjLnNwYXduKFtcclxuICAgICAgICAgICAgICAgIGNjLmZhZGVUbygwLjIsIDI1NSksXHJcbiAgICAgICAgICAgICAgICBjYy5tb3ZlVG8oIDAuMiwgY2MudjIoLTIyMCwgMCkgKSxcclxuICAgICAgICAgICAgICAgIGNjLnJvdGF0ZVRvKDAuMiwzNSlcclxuICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgIGNjLmZhZGVPdXQoMCksXHJcbiAgICAgICAgXTtcclxuICAgIH0sXHJcbiAgICBSZ3VuQWN0aW9uOmZ1bmN0aW9uKCl7IC8vIOWPs+i+ueeahOaeqlxyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIGNjLnNwYXduKFtcclxuICAgICAgICAgICAgICAgIGNjLm1vdmVUbyggMC4yLCBjYy52Mig0MzAsIDE1MikgKSxcclxuICAgICAgICAgICAgICAgIGNjLnNjYWxlVG8oMC4yLC0yLDIpXHJcbiAgICAgICAgICAgIF0pLFxyXG4gICAgICAgICAgICBjYy5zcGF3bihbXHJcbiAgICAgICAgICAgICAgICBjYy5mYWRlVG8oMC4yLCAyNTUpLFxyXG4gICAgICAgICAgICAgICAgY2MubW92ZVRvKCAwLjIsIGNjLnYyKDIyMCwgMCkgKSxcclxuICAgICAgICAgICAgICAgIGNjLnJvdGF0ZVRvKDAuMiwtMzUpXHJcbiAgICAgICAgICAgIF0pLFxyXG4gICAgICAgICAgICBjYy5mYWRlT3V0KDApXHJcbiAgICAgICAgXTtcclxuICAgIH0sXHJcbiAgICBfYmV6aWVyMTpmdW5jdGlvbihpbmRleCl7XHJcbiAgICAgICAgdmFyIGJlemllciA9IFtdO1xyXG4gICAgICAgIGJlemllclswXSA9IFsgW2NjLnYyKDEwMCwgNzQpLGNjLnYyKDE1MCwxNzQpLGNjLnYyKDIwMCwgLTE3NCldLCBjYy52MigxMDAsIDc0KSBdO1xyXG4gICAgICAgIGJlemllclsxXSA9IFsgW2NjLnYyKC03MiwgMjg0KSxjYy52MigtMTIyLDM4NCksY2MudjIoLTIyMiwgLTE1MCldLCBjYy52MigtNzIsIDI4NCkgXTtcclxuICAgICAgICBiZXppZXJbMl0gPSBbIFtjYy52MigtNzAsIDIwMCksY2MudjIoLTEyMCwzMDApLGNjLnYyKC0yMjAsIC0yMDApXSwgY2MudjIoLTcwLCAyMDApIF07XHJcbiAgICAgICAgYmV6aWVyWzNdID0gWyBbY2MudjIoLTEyMywgMjEzKSxjYy52MigtMTczLDMxMyksY2MudjIoLTI3MywgLTE2MCldLCBjYy52MigtMTIzLCAyMTMpIF07XHJcbiAgICAgICAgYmV6aWVyWzRdID0gWyBbY2MudjIoMTEwLCAyMzcpLGNjLnYyKDE2MCwzMzcpLGNjLnYyKDI2MCwgLTE3NyldLCBjYy52MigyMTAsIDIzNykgXTtcclxuICAgICAgICBiZXppZXJbNV0gPSBbIFtjYy52MigxODMsIDExNSksY2MudjIoMjMzLDIxNSksY2MudjIoMzMzLCAtMTU1KV0sIGNjLnYyKDE4MywgMTE1KSBdO1xyXG4gICAgICAgIGJlemllcls2XSA9IFsgW2NjLnYyKDkyLCAxMTYpLGNjLnYyKDE0MiwyMTYpLGNjLnYyKDI0MiwgLTE0NildLCBjYy52Mig5MiwgMTE2KSBdO1xyXG4gICAgICAgIGJlemllcls3XSA9IFsgW2NjLnYyKC0yNiwgMTI0KSxjYy52MigtNzYsMjI0KSxjYy52MigtMTc2LCAtMTY0KV0sIGNjLnYyKC0yNiwgMTI0KSBdO1xyXG4gICAgICAgIGJlemllcls4XSA9IFsgW2NjLnYyKC0xMTAsIDgxKSxjYy52MigtMjIwLDEzMSksY2MudjIoLTQ2MCwgLTE4MCldLCBjYy52MigtMTEwLCA4MSkgXTtcclxuICAgICAgICBiZXppZXJbOV0gPSBbIFtjYy52MigtMTI1LCAzMyksY2MudjIoLTIyNSwxMzMpLGNjLnYyKC0yNzUsIC0xMzMpXSwgY2MudjIoLTEyNSwgMzMpIF07XHJcbiAgICAgICAgYmV6aWVyWzEwXSA9IFsgW2NjLnYyKDAsIDApLGNjLnYyKDUwLDEwMCksY2MudjIoMTUwLCAtMTUwKV0sIGNjLnYyKDAsIDApIF07XHJcbiAgICAgICAgYmV6aWVyWzExXSA9IFsgW2NjLnYyKC0yMzUsIDUpLGNjLnYyKC0yNzUsMTA1KSxjYy52MigtMzc1LCAtMTg2KV0sIGNjLnYyKC0yMzUsIDUpIF07XHJcbiAgICAgICAgYmV6aWVyWzEyXSA9IFsgW2NjLnYyKC04MCwgNCksY2MudjIoLTEzMCwxMDQpLGNjLnYyKC0yMzAsIC0yMzMpXSwgY2MudjIoLTgwLCA0KSBdO1xyXG4gICAgICAgIGJlemllclsxM10gPSBbIFtjYy52MigxMDAsIC03KSxjYy52MigxNTAsMTA3KSxjYy52MigyNTAsIC0xNzcpXSwgY2MudjIoMTAwLCAtNykgXTtcclxuICAgICAgICBiZXppZXJbMTRdID0gWyBbY2MudjIoMTU0LCAyMyksY2MudjIoMjA0LDExMyksY2MudjIoMjU0LCAtMTczKV0sIGNjLnYyKDI1NCwgMjMpIF07XHJcbiAgICAgICAgcmV0dXJuIGJlemllcltpbmRleF07XHJcbiAgICB9LFxyXG4gICAgLy8g6Z2S6b6Z5Yqo55S7XHJcbiAgICBfcWluZ2xvbmdBbmlhbXRpb246ZnVuY3Rpb24odHlwZSl7XHJcbiAgICAgICAgdmFyIHFpbmdsb25nID0gY2MuaW5zdGFudGlhdGUodGhpcy5xaW5nbG9uZyk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHFpbmdsb25nKTtcclxuICAgICAgICB2YXIgYmcgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgnYmcnKTtcclxuICAgICAgICB2YXIgdGl0bGUgPSAnJztcclxuICAgICAgICBpZih0eXBlID09IFwicWxcIil7XHJcbiAgICAgICAgICAgIHRpdGxlID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ3Fsb25ndGl0bGUnKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGl0bGUgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgnbG9uZ3RpdGxlJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgeXVuMSA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCd5dW4xJyk7XHJcbiAgICAgICAgdmFyIHl1bjIgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgneXVuMicpO1xyXG4gICAgICAgIHZhciB5dW4zID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ3l1bjMnKTtcclxuICAgICAgICB2YXIgeXVuNCA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCd5dW40Jyk7XHJcbiAgICAgICAgdmFyIGxvbmcgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZShcImxvbmdcIik7XHJcblxyXG4gICAgICAgIHZhciBodWExID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ2h1YTEnKTtcclxuICAgICAgICB2YXIgaHVhMiA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCdodWEyJyk7XHJcbiAgICAgICAgdmFyIGh1YTMgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgnaHVhMycpO1xyXG4gICAgICAgIHZhciBBID0gW10gLCBCID0gW10gLCBDID0gW107XHJcbiAgICAgICAgdmFyIGh1YSA9IFtdO1xyXG5cclxuICAgICAgICB2YXIgdGVzdCA9IGNjLmluc3RhbnRpYXRlKGh1YTEpO1xyXG5cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgZm9yICh2YXIgaT0wO2k8NTtpKyspe1xyXG4gICAgICAgICAgICBBW2ldID0gY2MuaW5zdGFudGlhdGUoaHVhMSk7XHJcbiAgICAgICAgICAgIEFbaV0ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjEsMjU1KSk7XHJcbiAgICAgICAgICAgIGh1YS5wdXNoKCBBW2ldICk7XHJcbiAgICAgICAgICAgIEJbaV0gPSBjYy5pbnN0YW50aWF0ZShodWEyKTtcclxuICAgICAgICAgICAgQltpXS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMSwyNTUpKTtcclxuICAgICAgICAgICAgaHVhLnB1c2goIEJbaV0gKTtcclxuICAgICAgICAgICAgQ1tpXSA9IGNjLmluc3RhbnRpYXRlKGh1YTMpO1xyXG4gICAgICAgICAgICBDW2ldLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4xLDI1NSkpO1xyXG4gICAgICAgICAgICBodWEucHVzaCggQ1tpXSApO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJnRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2Muc2NhbGVUbygwLjIsMSwxKSxjYy5mYWRlVG8oMC4yLDI1NSkpLGNjLnNjYWxlVG8oMC4yLDIsMiksY2Muc3Bhd24oY2Muc2NhbGVUbygwLjIsMS41LDEuNSksbG9uZ1N0YXJ0KSApICk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGxvbmdTdGFydCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGxvbmcucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwwLjUpKSxjYy5zY2FsZVRvKDAuMSwzLDMpLGNjLnNwYXduKGNjLnNjYWxlVG8oMC4xLDEsMSkseXVuU3RhcnQpICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBmbG93ZXJTdGFydCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIH0pOyBcclxuICAgICAgICB2YXIgeXVuU3RhcnQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB5dW4xLnJ1bkFjdGlvbihjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnJlcGVhdChjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4yLGNjLnYyKC0zMzQsMjM0KSksY2MubW92ZVRvKDAuMixjYy52MigtMzQ0LDIzNCkpKSwzKSApKTtcclxuICAgICAgICAgICAgeXVuMi5ydW5BY3Rpb24oY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMixjYy52MigtMzY4LC04MikpLGNjLm1vdmVUbygwLjIsY2MudjIoLTM1OCwtODIpKSksMykgKSk7XHJcbiAgICAgICAgICAgIHl1bjMucnVuQWN0aW9uKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLm1vdmVUbygwLjIsY2MudjIoNDA4LC00KSksY2MubW92ZVRvKDAuMixjYy52MigzOTgsLTQpKSksMykpKTtcclxuICAgICAgICAgICAgeXVuNC5ydW5BY3Rpb24oY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMixjYy52Mig0MDYsMTgxKSksY2MubW92ZVRvKDAuMixjYy52Mig0MTYsMTgxKSkpLDMpICkpO1xyXG4gICAgICAgICAgICBmb3IodmFyIGk9MTtpPGh1YS5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgIGh1YVtpXS5zZXRQb3NpdGlvbihzZWxmLl9iZXppZXIoaSlbMV0pO1xyXG4gICAgICAgICAgICAgICAgcWluZ2xvbmcuYWRkQ2hpbGQoaHVhW2ldKTtcclxuICAgICAgICAgICAgICAgIGh1YVtpXS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5iZXppZXJUbygwLjMsc2VsZi5fYmV6aWVyKGkpWzBdKSxjYy5zY2FsZVRvKDAuMywxLDEpLGNjLmZhZGVUbygwLjMsMCkgKSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHFpbmdsb25nLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0sMTUwMCk7XHJcbiAgICAgICAgICAgIC8veXVuMVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgYmcucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjQsMjU1KSxjYy5zY2FsZVRvKDAuNCwzMCwzMCkpLGJnRmluaXNoZWQgKSk7XHJcbiAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNjYWxlVG8oMC4yLDIsMikpO1xyXG5cclxuICAgIH0sXHJcbiAgICAvLyDkuInpobrlrZDliqjnlLtcclxuICAgIF9zYW5zaHVuemlBbmltYXRpb246ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgc2Fuc2h1bnppID0gY2MuaW5zdGFudGlhdGUodGhpcy5zYW5zaHVuemkpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChzYW5zaHVuemkpO1xyXG4gICAgICAgIHZhciBiZyA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnYmcnKTtcclxuICAgICAgICB2YXIgTHR1ID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCdMdHUnKTtcclxuICAgICAgICB2YXIgUnR1ID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCdSdHUnKTtcclxuICAgICAgICB2YXIgdGl0bGUgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XHJcbiAgICAgICAgdmFyIHp1c2h1bjEgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ3p1c2h1bjEnKTtcclxuICAgICAgICB2YXIgenVzaHVuMiA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnenVzaHVuMicpO1xyXG4gICAgICAgIHZhciB6dXNodW4zID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCd6dXNodW4zJyk7XHJcbiAgICAgICAgdmFyIHp1c2h1bjQgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ3p1c2h1bjQnKTtcclxuICAgICAgICB2YXIgenVzaHVuNSA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnenVzaHVuNScpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgYmdGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2Muc2NhbGVUbygwLjIsMSwxKSxjYy5mYWRlVG8oMC4yLDI1NSkpLHRpdGxlRmluaXNoZWQgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHRpdGxlRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKCBjYy5zY2FsZVRvKDAuMiwyLjUsMi41KSx0aXRsZVNjYWxlKSk7XHJcbiAgICAgICAgICAgIEx0dS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLmZhZGVUbygwLjIsMjU1KSApKTtcclxuICAgICAgICAgICAgUnR1LnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2MuZmFkZVRvKDAuMiwyNTUpKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHRpdGxlU2NhbGUgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpeyAgICAvLyB0aXRsZeaUvuWkp+WujOaIkOWQjiDnq7nnrIsy5ZKMM+WQjOaXtui/m+ihjFxyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNjYWxlVG8oMC4yLDEuNSwxLjUpICk7XHJcbiAgICAgICAgICAgIHp1c2h1bjIucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDEyLDEyKSksY2Muc2NhbGVUbygwLjIsMTAsMTApLFpTMSApKTtcclxuICAgICAgICAgICAgenVzaHVuMy5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMjIsMjIpKSxjYy5zY2FsZVRvKDAuMiwyMCwyMCksWlM0ICkpO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICB6dXNodW41LnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwxMiwxMikpLGNjLnNjYWxlVG8oMC4yLDEwLDEwKSkgKTtcclxuICAgICAgICAgICAgfSwxMDApXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2Fuc2h1bnppLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgc2Fuc2h1bnppLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0sMjAwMClcclxuXHJcbiAgICAgICAgfSlcclxuICAgICAgICB2YXIgWlMxID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgenVzaHVuMS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMTIsMTIpKSxjYy5zY2FsZVRvKDAuMiwxMCwxMCkpICk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICB2YXIgWlM0ID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgenVzaHVuNC5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMTQsMTQpKSxjYy5zY2FsZVRvKDAuMiwxMiwxMikpICk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICBiZy5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuNCwyNTUpLGNjLnNjYWxlVG8oMC40LDMwLDMwKSksYmdGaW5pc2hlZCApKTtcclxuICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2NhbGVUbygwLjIsMiwyKSk7XHJcblxyXG4gICAgfSxcclxuICAgIC8vIOWFqOWekuaJk1xyXG4gICAgX3F1YW5sZWlkYUFuaW1hdGlvbjpmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBxdWFubGVpZGEgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnF1YW5sZWlkYSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHF1YW5sZWlkYSk7XHJcbiAgICAgICAgdmFyIGJnID0gcXVhbmxlaWRhLmdldENoaWxkQnlOYW1lKCdiZycpO1xyXG4gICAgICAgIHZhciBiYWxsID0gcXVhbmxlaWRhLmdldENoaWxkQnlOYW1lKCdiYWxsJyk7XHJcbiAgICAgICAgdmFyIGJhbmdxaXV0YW8gPSBxdWFubGVpZGEuZ2V0Q2hpbGRCeU5hbWUoJ2JhbmdxaXV0YW8nKTtcclxuICAgICAgICB2YXIgYmFuZ3FpdWd1biA9IHF1YW5sZWlkYS5nZXRDaGlsZEJ5TmFtZSgnYmFuZ3FpdWd1bicpO1xyXG4gICAgICAgIHZhciBMeXVuID0gcXVhbmxlaWRhLmdldENoaWxkQnlOYW1lKCdMeXVuJyk7XHJcbiAgICAgICAgdmFyIFJ5dW4gPSBxdWFubGVpZGEuZ2V0Q2hpbGRCeU5hbWUoJ1J5dW4nKTtcclxuICAgICAgICB2YXIgdGl0bGUgPSBxdWFubGVpZGEuZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XHJcbiAgICAgICAgdmFyIGJnRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLnNjYWxlVG8oMC4yLDEsMSksY2MuZmFkZVRvKDAuMiwyNTUpKSx0aXRsZUZpbmlzaGVkICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aXRsZUZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZSggY2Muc2NhbGVUbygwLjIsMi41LDIuNSksY2Muc2NhbGVUbygwLjIsMS41LDEuNSksXHJcbiAgICAgICAgICAgICAgICBjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMyxjYy52MigwLDIwKSksY2MubW92ZVRvKDAuMyxjYy52MigwLDApKSksMikgKSk7XHJcblxyXG4gICAgICAgICAgICBMeXVuLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDIwLDIwKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0yNzAsNzApKSApLFxyXG4gICAgICAgICAgICAgICAgY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLm1vdmVUbygwLjMsY2MudjIoLTI3MCwyNikpLGNjLm1vdmVUbygwLjMsY2MudjIoLTI3MCw0NikpKSwyKSApKTtcclxuXHJcbiAgICAgICAgICAgIFJ5dW4ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMjAsMjApLGNjLm1vdmVUbygwLjIsY2MudjIoMjcwLDcwKSkgKSxcclxuICAgICAgICAgICAgICAgIGNjLnJlcGVhdChjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4zLGNjLnYyKDI3MCw2NikpLGNjLm1vdmVUbygwLjMsY2MudjIoMjcwLDQ2KSkpLDIpICkpO1xyXG5cclxuICAgICAgICAgICAgYmFuZ3FpdXRhby5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoIGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMywxMCwxMCksY2MubW92ZVRvKDAuMyxjYy52MigyNTAsNTApKSksYnF0RmluaXNoZWQgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGJxdEZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgYmFuZ3FpdXRhby5ydW5BY3Rpb24oY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLnJvdGF0ZVRvKDAuMiwtMTApLGNjLnJvdGF0ZVRvKDAuMiwwKSksMykpO1xyXG4gICAgICAgICAgICBiYWxsLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMSwyNTUpLGNjLm1vdmVUbygwLjIsY2MudjIoMTk2LDgzKSkpLGJhbGxGaW5pc2hlZCApKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgYmFsbEZpbmlzaGVkID0gY2MuIGNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGJhbGwucnVuQWN0aW9uKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMCksY2MubW92ZVRvKDAuMixjYy52MigwLDApKSxjYy5zY2FsZVRvKDAuMiw0LDQpICkpO1xyXG4gICAgICAgICAgICBiYW5ncWl1Z3VuLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoIGNjLnNwYXduKGNjLnNjYWxlVG8oMC4yLDIsMiksY2MuZmFkZVRvKDAuMiwyNTUpKSxjYy5zY2FsZVRvKDAuMywxLjUsMS41KSApKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgYmcucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgYmFsbC5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBiYW5ncWl1dGFvLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIGJhbmdxaXVndW4ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgTHl1bi5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBSeXVuLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuXHJcbiAgICAgICAgICAgICAgICBxdWFubGVpZGEucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcclxuICAgICAgICAgICAgfSwyMDAwKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBiZy5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuNCwyNTUpLGNjLnNjYWxlVG8oMC40LDMwLDMwKSksYmdGaW5pc2hlZCApKTtcclxuICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc2NhbGVUbygwLjIsMiwyKSkpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5LiJ5ZCM6Iqx5Yqo55S7XHJcbiAgICBfc2FudG9uZ2h1YUFuaW1hdGlvbjpmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBzYW50b25naHVhID0gY2MuaW5zdGFudGlhdGUodGhpcy5zYW50b25naHVhKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQoc2FudG9uZ2h1YSk7XHJcbiAgICAgICAgdmFyIGJnID0gc2FudG9uZ2h1YS5nZXRDaGlsZEJ5TmFtZSgnYmcnKTtcclxuICAgICAgICB2YXIgaHVhMSA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ2h1YTEnKTtcclxuICAgICAgICB2YXIgaHVhMiA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ2h1YTInKTtcclxuICAgICAgICB2YXIgaHVhMyA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ2h1YTMnKTtcclxuICAgICAgICB2YXIgUnRhb2h1YSA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ1J0YW9odWEnKTtcclxuICAgICAgICB2YXIgTHRhb2h1YSA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ0x0YW9odWEnKTtcclxuICAgICAgICB2YXIgdGl0bGUgPSBzYW50b25naHVhLmdldENoaWxkQnlOYW1lKCd0aXRsZScpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAvL3ZhciBIMSA9IGNjLmluc3RhbnRpYXRlKGh1YTEpO1xyXG4gICAgICAgIHZhciBBID0gW10gLCBCID0gW10gLCBDID0gW107XHJcbiAgICAgICAgdmFyIGh1YSA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGk9MDtpPDU7aSsrKXtcclxuICAgICAgICAgICAgQVtpXSA9IGNjLmluc3RhbnRpYXRlKGh1YTEpO1xyXG4gICAgICAgICAgICBBW2ldLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4xLDI1NSkpO1xyXG4gICAgICAgICAgICBodWEucHVzaCggQVtpXSApO1xyXG4gICAgICAgICAgICBCW2ldID0gY2MuaW5zdGFudGlhdGUoaHVhMik7XHJcbiAgICAgICAgICAgIEJbaV0ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjEsMjU1KSk7XHJcbiAgICAgICAgICAgIGh1YS5wdXNoKCBCW2ldICk7XHJcbiAgICAgICAgICAgIENbaV0gPSBjYy5pbnN0YW50aWF0ZShodWEzKTtcclxuICAgICAgICAgICAgQ1tpXS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMSwyNTUpKTtcclxuICAgICAgICAgICAgaHVhLnB1c2goIENbaV0gKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBiZ0ZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5zY2FsZVRvKDAuMiwxLDEpLGNjLmZhZGVUbygwLjIsMjU1KSksY2Muc2NhbGVUbygwLjIsMSwxKSx0aXRsZUZpbmlzaGVkICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aXRsZUZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4xLDEuOCwxLjgpICkpO1xyXG4gICAgICAgICAgICBMdGFvaHVhLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMywzKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0xNjAsLTYwKSkgKSApKTtcclxuICAgICAgICAgICAgUnRhb2h1YS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDMsMyksY2MubW92ZVRvKDAuMixjYy52MigxNDAsLTYwKSkgKSApKTtcclxuICAgICAgICAgICAgZm9yKHZhciBpPTE7aTxodWEubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICBodWFbaV0uc2V0UG9zaXRpb24oc2VsZi5fYmV6aWVyKGkpWzFdKTtcclxuICAgICAgICAgICAgICAgIHNhbnRvbmdodWEuYWRkQ2hpbGQoaHVhW2ldKTtcclxuICAgICAgICAgICAgICAgIGh1YVtpXS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5iZXppZXJUbygwLjMsc2VsZi5fYmV6aWVyKGkpWzBdKSxjYy5zY2FsZVRvKDAuMywxLDEpLGNjLmZhZGVUbygwLjMsMCkgKSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGJnLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIFJ0YW9odWEucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgTHRhb2h1YS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBzYW50b25naHVhLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0sMTUwMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYmcucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjMsMjU1KSxjYy5zY2FsZVRvKDAuMywzMCwzMCkpLGJnRmluaXNoZWQgKSk7XHJcbiAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4yLDIsMikpKTtcclxuICAgIH0sXHJcbiAgICAvLyDotJ3loZ7lsJTmm7Lnur8o5Y+q6IO95a6a5LiJ5Liq54K5KVxyXG4gICAgX2JlemllcjpmdW5jdGlvbihpbmRleCl7XHJcbiAgICAgICAgdmFyIGJlemllciA9IFtdO1xyXG4gICAgICAgIGJlemllclswXSA9IFsgW2NjLnYyKDIwMCwgNzQpLGNjLnYyKDI1MCwxMjQpLGNjLnYyKDQwMCwgLTE3NCldLCBjYy52MigyMDAsIDc0KSBdO1xyXG4gICAgICAgIGJlemllclsxXSA9IFsgW2NjLnYyKC03MiwgMjg0KSxjYy52MigtMTIyLDMzNCksY2MudjIoLTI3MiwgLTE1MCldLCBjYy52MigtNzIsIDI4NCkgXTtcclxuICAgICAgICBiZXppZXJbMl0gPSBbIFtjYy52MigtMjcwLCAzMDApLGNjLnYyKC0zMjAsMzUwKSxjYy52MigtNDIwLCAtMjAwKV0sIGNjLnYyKC0yNzAsIDMwMCkgXTtcclxuICAgICAgICBiZXppZXJbM10gPSBbIFtjYy52MigtMjIzLCAyMTMpLGNjLnYyKC0yNzMsMjYzKSxjYy52MigtMzczLCAtMTYwKV0sIGNjLnYyKC0yMjMsIDIxMykgXTtcclxuICAgICAgICBiZXppZXJbNF0gPSBbIFtjYy52MigyMTAsIDIzNyksY2MudjIoMjYwLDI4NyksY2MudjIoMzYwLCAtMTc3KV0sIGNjLnYyKDIxMCwgMjM3KSBdO1xyXG4gICAgICAgIGJlemllcls1XSA9IFsgW2NjLnYyKDE4MywgMTE1KSxjYy52MigyMzMsMTY0KSxjYy52MigzMzMsIC0xNTUpXSwgY2MudjIoMTgzLCAxMTUpIF07XHJcbiAgICAgICAgYmV6aWVyWzZdID0gWyBbY2MudjIoOTIsIDExNiksY2MudjIoMTQyLDE2NiksY2MudjIoMjQyLCAtMTQ2KV0sIGNjLnYyKDkyLCAxMTYpIF07XHJcbiAgICAgICAgYmV6aWVyWzddID0gWyBbY2MudjIoLTI2LCAxMjQpLGNjLnYyKC03NiwxNzQpLGNjLnYyKC0xNzYsIC0xNjQpXSwgY2MudjIoLTI2LCAxMjQpIF07XHJcbiAgICAgICAgYmV6aWVyWzhdID0gWyBbY2MudjIoLTMxMCwgODEpLGNjLnYyKC0zNjAsMTMxKSxjYy52MigtNDYwLCAtMTgwKV0sIGNjLnYyKC0zMTAsIDgxKSBdO1xyXG4gICAgICAgIGJlemllcls5XSA9IFsgW2NjLnYyKC0xMjUsIDMzKSxjYy52MigtMTc1LDgzKSxjYy52MigtMjc1LCAtMTMzKV0sIGNjLnYyKC0xMjUsIDMzKSBdO1xyXG4gICAgICAgIGJlemllclsxMF0gPSBbIFtjYy52MigwLCAwKSxjYy52Mig1MCw1MCksY2MudjIoMTUwLCAtMTUwKV0sIGNjLnYyKDAsIDApIF07XHJcbiAgICAgICAgYmV6aWVyWzExXSA9IFsgW2NjLnYyKC0yMzUsIDUpLGNjLnYyKC0yNzUsNTUpLGNjLnYyKC0zNzUsIC04NildLCBjYy52MigtMjM1LCA1KSBdO1xyXG4gICAgICAgIGJlemllclsxMl0gPSBbIFtjYy52MigtODAsIDQpLGNjLnYyKC0xMzAsNTQpLGNjLnYyKC0yMzAsIC0yMzMpXSwgY2MudjIoLTgwLCA0KSBdO1xyXG4gICAgICAgIGJlemllclsxM10gPSBbIFtjYy52MigxMDAsIC03KSxjYy52MigxNTAsNTcpLGNjLnYyKDI1MCwgLTE3NyldLCBjYy52MigxMDAsIC03KSBdO1xyXG4gICAgICAgIGJlemllclsxNF0gPSBbIFtjYy52MigyNTQsIDIzKSxjYy52MigzMDQsNzMpLGNjLnYyKDQwNCwgLTE3MyldLCBjYy52MigyNTQsIDIzKSBdO1xyXG4gICAgICAgIHJldHVybiBiZXppZXJbaW5kZXhdO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDlha3lr7nljYrliqjnlLtcclxuICAgIF9saXVkdWliYW5BbmltYXRpb246IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGxpdWR1aWJhbiA9IGNjLmluc3RhbnRpYXRlKHRoaXMubGl1ZHVpYmFuKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQobGl1ZHVpYmFuKTtcclxuICAgICAgICB2YXIgYmcgPSBsaXVkdWliYW4uZ2V0Q2hpbGRCeU5hbWUoJ2JnJyk7XHJcbiAgICAgICAgdmFyIExxaSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgnTHFpJyk7XHJcbiAgICAgICAgdmFyIFJxaSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgnUnFpJyk7XHJcbiAgICAgICAgdmFyIENxaSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgnQ3FpJyk7XHJcbiAgICAgICAgdmFyIFJ0YW9odWEgPSBsaXVkdWliYW4uZ2V0Q2hpbGRCeU5hbWUoJ1J0YW9odWEnKTtcclxuICAgICAgICB2YXIgTHRhb2h1YSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgnTHRhb2h1YScpO1xyXG4gICAgICAgIHZhciB0aXRsZSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcclxuXHJcbiAgICAgICAgdmFyIGJnRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLnNjYWxlVG8oMC4yLDEsMSksY2MuZmFkZVRvKDAuMiwyNTUpKSx0aXRsZUZpbmlzaGVkICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aXRsZUZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKCBjYy5zY2FsZVRvKDAuMSwyLjUsMi41KSxjYy5zY2FsZVRvKDAuMSwxLjgsMS44KSxGaW5pc2hlZCApKTtcclxuICAgICAgICAgICAgTHRhb2h1YS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDMsMyksY2MubW92ZVRvKDAuMixjYy52MigtMTYwLC02MCkpICkgKSk7XHJcbiAgICAgICAgICAgIFJ0YW9odWEucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwzLDMpLGNjLm1vdmVUbygwLjIsY2MudjIoMTQwLC02MCkpICkgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIEZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgTHFpLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2MubW92ZVRvKDAuMixjYy52MigtMTAzLDE1OCkpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0xMDMsMTY4KSksY2MubW92ZVRvKDAuMixjYy52MigtMTAzLDE1OCkpICkpO1xyXG4gICAgICAgICAgICBScWkucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDEzMywxNjApKSksY2MubW92ZVRvKDAuMixjYy52MigxMzMsMTcwKSksY2MubW92ZVRvKDAuMixjYy52MigxMzMsMTYwKSkgKSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIENxaS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLm1vdmVUbygwLjIsY2MudjIoMjAsOTYpKSksY2MubW92ZVRvKDAuMixjYy52MigyMCwxMDYpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDIwLDk2KSkgKSk7XHJcbiAgICAgICAgICAgICAgICBMdGFvaHVhLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2MucmVwZWF0KCBjYy5zZXF1ZW5jZShjYy5yb3RhdGVUbygwLjMsMTApLGNjLnJvdGF0ZVRvKDAuMywwKSksMiApLHRoRmluaXNoZWQpKTtcclxuICAgICAgICAgICAgICAgIFJ0YW9odWEucnVuQWN0aW9uKCBjYy5yZXBlYXQoIGNjLnNlcXVlbmNlKGNjLnJvdGF0ZVRvKDAuMywtMTApLGNjLnJvdGF0ZVRvKDAuMywwKSksMiApKTtcclxuICAgICAgICAgICAgfSw1MDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aEZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgYmcucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICBMcWkucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICBScWkucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICBDcWkucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICBSdGFvaHVhLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgTHRhb2h1YS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgbGl1ZHVpYmFuLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYmcucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjQsMjU1KSxjYy5zY2FsZVRvKDAuNCwzMCwzMCkpLGJnRmluaXNoZWQgKSk7XHJcbiAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4yLDIsMikpKTtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuXHJcbiAgICAgICAgY2FyZHMgOiBjYy5MYWJlbCxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnRvdGFsQ2FyZHMoKTtcclxuICAgIH0sXHJcbiAgICB0b3RhbENhcmRzIDpmdW5jdGlvbigpe1xyXG4gICAgICAgIC8vIHZhciBjcmVhdGUgPSB0aGlzLm5vZGUuY2hpbGRyZW47XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLm5vZGUpO1xyXG4gICAgICAgIHZhciByZW5zaHUgPSAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicmVuc2h1XCIpO1xyXG4gICAgICAgIHZhciBqdXNodSA9ICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJqdXNodVwiKTtcclxuICAgICAgICB2YXIgZ2V0Q2FyZCA9ICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjYXJkc1wiKTtcclxuICAgICAgICAvL3ZhciByZW5zaHUgPSBjcmVhdGVbM10sIGp1c2h1ID0gY3JlYXRlWzRdLCBnZXRDYXJkID0gY3JlYXRlWzZdO1xyXG5cclxuICAgICAgICB2YXIgcnMgPSByZW5zaHUuZ2V0Q29tcG9uZW50KFwic2luZ2xlU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XHJcbiAgICAgICAgdmFyIGpzID0ganVzaHUuZ2V0Q29tcG9uZW50KFwic2luZ2xlU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XHJcbiAgICAgICAgdmFyIGdjID0gZ2V0Q2FyZC5nZXRDb21wb25lbnQoXCJzaW5nbGVTZWxlY3RcIikuc2VsZWN0ZWRJbmRleDtcclxuXHJcbiAgICAgICAgdmFyIFIgPSAxLCBKID0gMSwgRyA9IDE7XHJcbiAgICAgICAgc3dpdGNoKHJzKXtcclxuICAgICAgICAgICAgY2FzZSAwOiBSID0gMTticmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiBSID0gMjticmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOiBSID0gMzticmVhaztcclxuICAgICAgICAgICAgY2FzZSAzOiBSID0gNDticmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgc3dpdGNoKGpzKXtcclxuICAgICAgICAgICAgY2FzZSAwOiBKID0gMTticmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiBKID0gMjticmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOiBKID0gMzticmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgc3dpdGNoKGdjKXtcclxuICAgICAgICAgICAgY2FzZSAwOiBHID0gMTticmVhazsgLy8gQUHliLZcclxuICAgICAgICAgICAgZGVmYXVsdDpHID0gMDticmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYXJkcy5zdHJpbmcgPSBSK0o7XHJcbiAgICAgICAgLy90aGlzLmNhcmRzLnN0cmluZyA9IEcgPyAoUitKKTooUitKKSooUiszKTsgIC8vIChSK0op6KGo56S65q+P5Liq5Lq66KaB5Ye655qE5oi/5Y2h6YeP77ybKFIrMynooajnpLrkuIDlhbHmnInlpJrlsJHkurrvvIwgICAgXHJcbiAgICB9XHJcbn0pO1xyXG4iLCIvLyDniYzog4zlvbHliJfooaggY29tcG9uZW50XG4vLyDlj6/ku6XmmL7npLrjgIHpmpDol4/niYzog4zlvbHliJfooahcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGNhcmRzQmFja0xheW91dDogY2MuTGF5b3V0LFxuICAgICAgICBjYXJkc0JhY2tMaXN0OiBbY2MuU3ByaXRlXSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgLy8g5Lul5Yqo55S755qE5pa55byP5pi+56S654mM6IOM5b2xXG4gICAgc2hvd1BsYXlDYXJkQmFja3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuaGlkZUNhcmRCYWNrcygpO1xuICAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICBsZXQgaW50ZXJ2YWwgPSAwLjA1O1xuICAgICAgdmFyIHN0YXJ0VGltZSA9IDA7XG4gICAgICB0aGlzLmNhcmRzQmFja0xpc3QuZm9yRWFjaChmdW5jdGlvbihjYXJkQmFjayl7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNhcmRCYWNrLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfSwgc3RhcnRUaW1lKTtcbiAgICAgICAgc3RhcnRUaW1lID0gc3RhcnRUaW1lICsgaW50ZXJ2YWw7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICAvLyDpmpDol4/mmL7npLrniYzog4zlvbFcbiAgICBoaWRlQ2FyZEJhY2tzOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5jYXJkc0JhY2tMaXN0LmZvckVhY2goZnVuY3Rpb24oY2FyZEJhY2spe1xuICAgICAgICBjYXJkQmFjay5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgLyrniYzoirHoibIqL1xuICAgICAgICBzcGFkZXNJbWFnZXM6W2NjLlNwcml0ZUZyYW1lXSxcbiAgICAgICAgaGVhcnRzSW1hZ2VzOltjYy5TcHJpdGVGcmFtZV0sXG4gICAgICAgIGNsdWJJbWFnZXM6W2NjLlNwcml0ZUZyYW1lXSxcbiAgICAgICAgZGlhbW9uZEltYWdlczpbY2MuU3ByaXRlRnJhbWVdLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBsYWJlbE1zZzpjYy5MYWJlbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2V0VGV4dDpmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgIHRoaXMubGFiZWxNc2cuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0ZXh0O1xuICAgIH0sXG5cbiAgICBjbGlja0FjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0ZXh0ID0gdGhpcy5sYWJlbE1zZy5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZztcbiAgICAgICAgdGhpcy5vblNlbGVjdEFjdGlvbih0ZXh0KTtcbiAgICB9LFxuXG4gICAgb25TZWxlY3RBY3Rpb246ZnVuY3Rpb24obXNnKSB7XG5cbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgcGhvbmVFZGl0Qm94OmNjLkVkaXRCb3gsXHJcbiAgICAgICAgd3hFZGl0Qm94OmNjLkVkaXRCb3gsXHJcbiAgICAgICAgYWxlcnQ6Y2MuUHJlZmFiLFxyXG4gICAgICAgIGNhbnZhczpjYy5Ob2RlLFxyXG4gICAgICAgIF91c2VySWQ6bnVsbCxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJTb2NrZXRFdmVudCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAgX3JlZ2lzdGVyU29ja2V0RXZlbnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlT25DaGFuZ2VJbmZvLCB0aGlzLl9SZWNlaXZlQ2hhbmdlSW5mbywgdGhpcyk7XHJcbiAgICB9LFxyXG4gICAgX1JlY2VpdmVDaGFuZ2VJbmZvIDpmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgdmFyIGNoYW5nZWRSb3dzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICB2YXIgbXNnID0gJyc7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjaGFuZ2VkUm93cyk7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0zOFwiKTtcclxuICAgICAgICBpZihjaGFuZ2VkUm93cyl7XHJcbiAgICAgICAgICAgIG1zZyA9IFwi5pu05pS55oiQ5YqfXCI7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIG1zZyA9IFwi5LuK5aSp5bey57uP5pu05paw6L+H5LqG77yM6K+35piO5aSp5YaN5pu05pawXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgIH0sXHJcbiAgICBjbGlja0FjdGlvbiA6ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgd3ggPSB0aGlzLnd4RWRpdEJveC5zdHJpbmc7XHJcbiAgICAgICAgdmFyIHBob25lID0gdGhpcy5waG9uZUVkaXRCb3guc3RyaW5nO1xyXG4gICAgICAgIHZhciBpbmZvID0ge307XHJcbiAgICAgICAgdmFyIG1zZyA9ICcnO1xyXG4gICAgICAgIGlmKCF3eCAmJiAhcGhvbmUpe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuivt+Whq+WGmeW+ruS/oeWPt+WSjOaJi+acuuWPt1wiO1xyXG4gICAgICAgICAgICBwaG9uZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiggISgvKF5bMS05XVxcZCokKS8udGVzdChwaG9uZSkpICl7XHJcbiAgICAgICAgICAgIG1zZyA9IFwi5oKo6L6T5YWl55qE5omL5py65Y+356CB5qC85byP5LiN5a+577yM6K+36YeN5paw6L6T5YWlXCI7XHJcbiAgICAgICAgICAgIHBob25lID0gXCJcIjtcclxuICAgICAgICAgICAgdGhpcy5hbGVydE1zZyhtc2cpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCBwaG9uZS5sZW5ndGggIT0xMSApe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuaCqOi+k+WFpeeahOaJi+acuuWPt+eggeS4jeWknzEx5L2N77yM6K+36YeN5paw6L6T5YWlXCI7XHJcbiAgICAgICAgICAgIHBob25lID0gXCJcIjtcclxuICAgICAgICAgICAgdGhpcy5hbGVydE1zZyhtc2cpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCEoLyheWzEtOWEtekEtWl1cXGQqJCkvLnRlc3Qod3gpKSApe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuaCqOi+k+WFpeeahOW+ruS/oeWPt+agvOW8j+S4jeWvue+8jOivt+mHjeaWsOi+k+WFpVwiO1xyXG4gICAgICAgICAgICB3eCA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiggd3gubGVuZ3RoPDYgfHwgd3gubGVuZ3RoPjIwICl7XHJcbiAgICAgICAgICAgIG1zZyA9IFwi5oKo6L6T5YWl55qE5b6u5L+h5Y+35qC85byP6LaF5Ye66IyD5Zu077yM6K+36L6T5YWlNn4yMOS9jeeahOW+ruS/oeWPt1wiO1xyXG4gICAgICAgICAgICB3eCA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpbmZvLnd4ID0gd3g7XHJcbiAgICAgICAgaW5mby5waG9uZSA9IHBob25lO1xyXG4gICAgICAgIFNvY2tldC5zZW5kQ2hhbmdlSW5mbyh0aGlzLl91c2VySWQsaW5mbyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGFsZXJ0TXNnOiBmdW5jdGlvbihtc2cpe1xyXG4gICAgICAgIHZhciBhbGVydCA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYWxlcnQpO1xyXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZENoaWxkKGFsZXJ0KTtcclxuICAgICAgICBsZXQgY29tcCA9IGFsZXJ0LmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgIH0sXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIFxyXG4gICAgICAgIG1QdGl0bGU6Y2MuTGFiZWwsXHJcbiAgICAgICAgX2NhcmRzOltdLFxyXG4gICAgICAgIHJlbnNodVNlbGVjdDpjYy5Ob2RlLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBocyA9IDM7XHJcbiAgICAgICAgdmFyIGRzID0gNTtcclxuICAgICAgICBpZihjYy5zZXQpe1xyXG4gICAgICAgICAgICBocyA9IGNjLnNldC5zZXR0aW5nN1swXTtcclxuICAgICAgICAgICAgZHMgPSBjYy5zZXQuc2V0dGluZzdbMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2NhcmRzID0gW2hzLGRzXTtcclxuICAgICAgICAgdGhpcy5tcChocyxkcyk7XHJcbiAgICB9LFxyXG4gICAgY2hhbmdlOiBmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gdGhpcy5yZW5zaHVTZWxlY3QuZ2V0Q29tcG9uZW50KCdzaW5nbGVTZWxlY3QnKS5zZWxlY3RlZEluZGV4O1xyXG4gICAgICAgIHZhciBocyA9IE1hdGguY2VpbCggKE1hdGgucmFuZG9tKCkqNDApLzEwICk7ICAgIC8v6I635Y+W5LiA5LiqMX4055qE5pWw5a2X77yM5Luj6KGo6Iqx6ImyXHJcbiAgICAgICAgdmFyIGRzID0gTWF0aC5jZWlsKCAoTWF0aC5yYW5kb20oKSoxMzApLzEwICk7ICAgLy/ojrflj5bkuIDkuKoxfjEz55qE5pWw5a2X77yM5Luj6KGo54K55pWwXHJcbiAgICAgICAgdmFyIGNhcmQgPSBbaHMsZHNdO1xyXG4gICAgICAgIHRoaXMuX2NhcmRzID0gY2FyZDtcclxuICAgICAgICB0aGlzLm1wKGhzLGRzLHNlbGVjdGVkSW5kZXgpXHJcbiAgICB9LFxyXG4gICAgbXA6IGZ1bmN0aW9uKGgsZCxpbmRleCl7XHJcbiAgICAgICAgdmFyIG1hID0gXCLljZXnoIFcIjtcclxuICAgICAgICB2YXIgaHMgPSBbIFwi5pa55Z2XXCIsXCLmooXoirFcIixcIue6ouahg1wiLFwi6buR5qGDXCJdO1xyXG4gICAgICAgIHZhciBkcyA9IFsgXCIxXCIsXCIyXCIsXCIzXCIsXCI0XCIsXCI1XCIsXCI2XCIsXCI3XCIsXCI4XCIsXCI5XCIsXCIxMFwiLFwiSlwiLFwiUVwiLFwiS1wiIF07XHJcbiAgICAgICAgaWYoaW5kZXgpeyAgXHJcbiAgICAgICAgICAgIHZhciBkZWZhdWx0TWEgPSA0O1xyXG4gICAgICAgICAgICBpZihoID49IChkZWZhdWx0TWEtaW5kZXgrMSkgKXtcclxuICAgICAgICAgICAgICAgIG1hID0gXCLlj4znoIFcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm1QdGl0bGUuc3RyaW5nID0gaHNbaC0xXStkc1tkLTFdK21hO1xyXG4gICB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBzZWxlY3RlZEluZGV4IDogMCxcclxuICAgICAgICBzZWxlY3RlZE5vZGUgOiBjYy5Ob2RlICBcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAwO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgY2xpY2tBY3Rpb246ZnVuY3Rpb24oZSxkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9ICF0aGlzLnNlbGVjdGVkO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRoaXMuc2VsZWN0ZWQ7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gdGhpcy5zZWxlY3RlZD8wOm51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsInZhciBzb2NrZXQgPSByZXF1aXJlKFwic29ja2V0XCIpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIG9wdGlvbjp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6W10sXHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgY2xpY2tCdG5jaG91amlhbmc6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLm9wdGlvbi5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgdGhpcy5vcHRpb25baV0ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLl90aXNoaSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImNob3VqaWFuZ19iZ1wiKS5nZXRDaGlsZEJ5TmFtZShcInRpc2hpXCIpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRfbnVtID0gY2MuZmluZChcIkNhbnZhcy91c2VyL3Nob3BfYmcvY2FyZF9udW1cIik7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLl9jYXJkX251bS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgaWYoaW5kZXggPT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXhdLm9wYWNpdHkgPSAxMjg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25bdGhpcy5vcHRpb24ubGVuZ3RoLTFdLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZihpbmRleCA9PSAxKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleF0ub3BhY2l0eSA9IDEyODtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleCAtIDFdLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleF0ub3BhY2l0eSA9IDEyODtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleC0xXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaW5kZXggKys7XHJcbiAgICAgICAgICAgICAgICBpZihpbmRleCA9PSB0aGlzLm9wdGlvbi5sZW5ndGgpe1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICBpZihjb21wLnN0cmluZyA8IDIwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Rpc2hpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIC8vY2hvdWppYW5nXHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5jYWxsYmFjaywwLjA1KTtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuY2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLm9wdGlvbi5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpXS5vcGFjaXR5ID0gMTI4O1xyXG4gICAgICAgICAgICB9LDMsMCwxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyoqKlxyXG4gICAgY2xpY2tCdG5Db21maXJtOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3Rpc2hpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8vKioqKlxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgIFxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuICAgIGxvYWRDYXJkU3ByaXRlRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKGNhcmROYW1lLCBjYWxsYmFjayk7XHJcbiAgICB9LFxyXG4gICAgX2NhcmRGdWxsTmFtZTogZnVuY3Rpb24gKGNhcmRTaG9ydE5hbWUpIHtcclxuICAgICAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xyXG4gICAgICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChcInB1YmxpYy1waWMtY2FyZC1wb2tlclwiKSkge1xyXG4gICAgICAgICAgY2FyZE5hbWUgPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2FyZE5hbWU7XHJcbiAgICB9LFxyXG4gICAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICBjYy5hc3NlcnQoY2FsbGJhY2spO1xyXG4gICAgICAgIGNjLmxvYWRlci5sb2FkUmVzKFwicGxheS9oYWxsL3B1YmxpYy9hbGxfZWZmZWN0X3R0d19tYWluXCIsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xyXG4gICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCBlcnIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUpO1xyXG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShjYXJkTmFtZSk7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGZyYW1lKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICB9LFxyXG4gICAgdGVzdDpmdW5jdGlvbigpe1xyXG5cclxuICAgICBcclxuICAgIH0sXHJcbiAgICBcclxufSk7XHJcbiIsIihmdW5jdGlvbiAobWFpbikge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLyoqXG4gICAqIFBhcnNlIG9yIGZvcm1hdCBkYXRlc1xuICAgKiBAY2xhc3MgZmVjaGFcbiAgICovXG4gIHZhciBmZWNoYSA9IHt9O1xuICB2YXIgdG9rZW4gPSAvZHsxLDR9fE17MSw0fXxZWSg/OllZKT98U3sxLDN9fERvfFpafChbSGhNc0RtXSlcXDE/fFthQV18XCJbXlwiXSpcInwnW14nXSonL2c7XG4gIHZhciB0d29EaWdpdHMgPSAvXFxkXFxkPy87XG4gIHZhciB0aHJlZURpZ2l0cyA9IC9cXGR7M30vO1xuICB2YXIgZm91ckRpZ2l0cyA9IC9cXGR7NH0vO1xuICB2YXIgd29yZCA9IC9bMC05XSpbJ2EtelxcdTAwQTAtXFx1MDVGRlxcdTA3MDAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0rfFtcXHUwNjAwLVxcdTA2RkZcXC9dKyhcXHMqP1tcXHUwNjAwLVxcdTA2RkZdKyl7MSwyfS9pO1xuICB2YXIgbGl0ZXJhbCA9IC9cXFsoW15dKj8pXFxdL2dtO1xuICB2YXIgbm9vcCA9IGZ1bmN0aW9uICgpIHtcbiAgfTtcblxuICBmdW5jdGlvbiBzaG9ydGVuKGFyciwgc0xlbikge1xuICAgIHZhciBuZXdBcnIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYXJyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBuZXdBcnIucHVzaChhcnJbaV0uc3Vic3RyKDAsIHNMZW4pKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ld0FycjtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1vbnRoVXBkYXRlKGFyck5hbWUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIHYsIGkxOG4pIHtcbiAgICAgIHZhciBpbmRleCA9IGkxOG5bYXJyTmFtZV0uaW5kZXhPZih2LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdi5zdWJzdHIoMSkudG9Mb3dlckNhc2UoKSk7XG4gICAgICBpZiAofmluZGV4KSB7XG4gICAgICAgIGQubW9udGggPSBpbmRleDtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gcGFkKHZhbCwgbGVuKSB7XG4gICAgdmFsID0gU3RyaW5nKHZhbCk7XG4gICAgbGVuID0gbGVuIHx8IDI7XG4gICAgd2hpbGUgKHZhbC5sZW5ndGggPCBsZW4pIHtcbiAgICAgIHZhbCA9ICcwJyArIHZhbDtcbiAgICB9XG4gICAgcmV0dXJuIHZhbDtcbiAgfVxuXG4gIHZhciBkYXlOYW1lcyA9IFsnU3VuZGF5JywgJ01vbmRheScsICdUdWVzZGF5JywgJ1dlZG5lc2RheScsICdUaHVyc2RheScsICdGcmlkYXknLCAnU2F0dXJkYXknXTtcbiAgdmFyIG1vbnRoTmFtZXMgPSBbJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLCAnSnVseScsICdBdWd1c3QnLCAnU2VwdGVtYmVyJywgJ09jdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInXTtcbiAgdmFyIG1vbnRoTmFtZXNTaG9ydCA9IHNob3J0ZW4obW9udGhOYW1lcywgMyk7XG4gIHZhciBkYXlOYW1lc1Nob3J0ID0gc2hvcnRlbihkYXlOYW1lcywgMyk7XG4gIGZlY2hhLmkxOG4gPSB7XG4gICAgZGF5TmFtZXNTaG9ydDogZGF5TmFtZXNTaG9ydCxcbiAgICBkYXlOYW1lczogZGF5TmFtZXMsXG4gICAgbW9udGhOYW1lc1Nob3J0OiBtb250aE5hbWVzU2hvcnQsXG4gICAgbW9udGhOYW1lczogbW9udGhOYW1lcyxcbiAgICBhbVBtOiBbJ2FtJywgJ3BtJ10sXG4gICAgRG9GbjogZnVuY3Rpb24gRG9GbihEKSB7XG4gICAgICByZXR1cm4gRCArIFsndGgnLCAnc3QnLCAnbmQnLCAncmQnXVtEICUgMTAgPiAzID8gMCA6IChEIC0gRCAlIDEwICE9PSAxMCkgKiBEICUgMTBdO1xuICAgIH1cbiAgfTtcblxuICB2YXIgZm9ybWF0RmxhZ3MgPSB7XG4gICAgRDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0RGF0ZSgpO1xuICAgIH0sXG4gICAgREQ6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXREYXRlKCkpO1xuICAgIH0sXG4gICAgRG86IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcbiAgICAgIHJldHVybiBpMThuLkRvRm4oZGF0ZU9iai5nZXREYXRlKCkpO1xuICAgIH0sXG4gICAgZDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0RGF5KCk7XG4gICAgfSxcbiAgICBkZDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldERheSgpKTtcbiAgICB9LFxuICAgIGRkZDogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGkxOG4uZGF5TmFtZXNTaG9ydFtkYXRlT2JqLmdldERheSgpXTtcbiAgICB9LFxuICAgIGRkZGQ6IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcbiAgICAgIHJldHVybiBpMThuLmRheU5hbWVzW2RhdGVPYmouZ2V0RGF5KCldO1xuICAgIH0sXG4gICAgTTogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0TW9udGgoKSArIDE7XG4gICAgfSxcbiAgICBNTTogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldE1vbnRoKCkgKyAxKTtcbiAgICB9LFxuICAgIE1NTTogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGkxOG4ubW9udGhOYW1lc1Nob3J0W2RhdGVPYmouZ2V0TW9udGgoKV07XG4gICAgfSxcbiAgICBNTU1NOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gaTE4bi5tb250aE5hbWVzW2RhdGVPYmouZ2V0TW9udGgoKV07XG4gICAgfSxcbiAgICBZWTogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIFN0cmluZyhkYXRlT2JqLmdldEZ1bGxZZWFyKCkpLnN1YnN0cigyKTtcbiAgICB9LFxuICAgIFlZWVk6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldEZ1bGxZZWFyKCk7XG4gICAgfSxcbiAgICBoOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRIb3VycygpICUgMTIgfHwgMTI7XG4gICAgfSxcbiAgICBoaDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldEhvdXJzKCkgJSAxMiB8fCAxMik7XG4gICAgfSxcbiAgICBIOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRIb3VycygpO1xuICAgIH0sXG4gICAgSEg6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRIb3VycygpKTtcbiAgICB9LFxuICAgIG06IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldE1pbnV0ZXMoKTtcbiAgICB9LFxuICAgIG1tOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0TWludXRlcygpKTtcbiAgICB9LFxuICAgIHM6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldFNlY29uZHMoKTtcbiAgICB9LFxuICAgIHNzOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0U2Vjb25kcygpKTtcbiAgICB9LFxuICAgIFM6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBNYXRoLnJvdW5kKGRhdGVPYmouZ2V0TWlsbGlzZWNvbmRzKCkgLyAxMDApO1xuICAgIH0sXG4gICAgU1M6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoTWF0aC5yb3VuZChkYXRlT2JqLmdldE1pbGxpc2Vjb25kcygpIC8gMTApLCAyKTtcbiAgICB9LFxuICAgIFNTUzogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldE1pbGxpc2Vjb25kcygpLCAzKTtcbiAgICB9LFxuICAgIGE6IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldEhvdXJzKCkgPCAxMiA/IGkxOG4uYW1QbVswXSA6IGkxOG4uYW1QbVsxXTtcbiAgICB9LFxuICAgIEE6IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldEhvdXJzKCkgPCAxMiA/IGkxOG4uYW1QbVswXS50b1VwcGVyQ2FzZSgpIDogaTE4bi5hbVBtWzFdLnRvVXBwZXJDYXNlKCk7XG4gICAgfSxcbiAgICBaWjogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgdmFyIG8gPSBkYXRlT2JqLmdldFRpbWV6b25lT2Zmc2V0KCk7XG4gICAgICByZXR1cm4gKG8gPiAwID8gJy0nIDogJysnKSArIHBhZChNYXRoLmZsb29yKE1hdGguYWJzKG8pIC8gNjApICogMTAwICsgTWF0aC5hYnMobykgJSA2MCwgNCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBwYXJzZUZsYWdzID0ge1xuICAgIEQ6IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLmRheSA9IHY7XG4gICAgfV0sXG4gICAgRG86IFtuZXcgUmVnRXhwKHR3b0RpZ2l0cy5zb3VyY2UgKyB3b3JkLnNvdXJjZSksIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLmRheSA9IHBhcnNlSW50KHYsIDEwKTtcbiAgICB9XSxcbiAgICBNOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5tb250aCA9IHYgLSAxO1xuICAgIH1dLFxuICAgIFlZOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgdmFyIGRhID0gbmV3IERhdGUoKSwgY2VudCA9ICsoJycgKyBkYS5nZXRGdWxsWWVhcigpKS5zdWJzdHIoMCwgMik7XG4gICAgICBkLnllYXIgPSAnJyArICh2ID4gNjggPyBjZW50IC0gMSA6IGNlbnQpICsgdjtcbiAgICB9XSxcbiAgICBoOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5ob3VyID0gdjtcbiAgICB9XSxcbiAgICBtOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5taW51dGUgPSB2O1xuICAgIH1dLFxuICAgIHM6IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLnNlY29uZCA9IHY7XG4gICAgfV0sXG4gICAgWVlZWTogW2ZvdXJEaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLnllYXIgPSB2O1xuICAgIH1dLFxuICAgIFM6IFsvXFxkLywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQubWlsbGlzZWNvbmQgPSB2ICogMTAwO1xuICAgIH1dLFxuICAgIFNTOiBbL1xcZHsyfS8sIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLm1pbGxpc2Vjb25kID0gdiAqIDEwO1xuICAgIH1dLFxuICAgIFNTUzogW3RocmVlRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5taWxsaXNlY29uZCA9IHY7XG4gICAgfV0sXG4gICAgZDogW3R3b0RpZ2l0cywgbm9vcF0sXG4gICAgZGRkOiBbd29yZCwgbm9vcF0sXG4gICAgTU1NOiBbd29yZCwgbW9udGhVcGRhdGUoJ21vbnRoTmFtZXNTaG9ydCcpXSxcbiAgICBNTU1NOiBbd29yZCwgbW9udGhVcGRhdGUoJ21vbnRoTmFtZXMnKV0sXG4gICAgYTogW3dvcmQsIGZ1bmN0aW9uIChkLCB2LCBpMThuKSB7XG4gICAgICB2YXIgdmFsID0gdi50b0xvd2VyQ2FzZSgpO1xuICAgICAgaWYgKHZhbCA9PT0gaTE4bi5hbVBtWzBdKSB7XG4gICAgICAgIGQuaXNQbSA9IGZhbHNlO1xuICAgICAgfSBlbHNlIGlmICh2YWwgPT09IGkxOG4uYW1QbVsxXSkge1xuICAgICAgICBkLmlzUG0gPSB0cnVlO1xuICAgICAgfVxuICAgIH1dLFxuICAgIFpaOiBbLyhbXFwrXFwtXVxcZFxcZDo/XFxkXFxkfFopLywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGlmICh2ID09PSAnWicpIHYgPSAnKzAwOjAwJztcbiAgICAgIHZhciBwYXJ0cyA9ICh2ICsgJycpLm1hdGNoKC8oW1xcK1xcLV18XFxkXFxkKS9naSksIG1pbnV0ZXM7XG5cbiAgICAgIGlmIChwYXJ0cykge1xuICAgICAgICBtaW51dGVzID0gKyhwYXJ0c1sxXSAqIDYwKSArIHBhcnNlSW50KHBhcnRzWzJdLCAxMCk7XG4gICAgICAgIGQudGltZXpvbmVPZmZzZXQgPSBwYXJ0c1swXSA9PT0gJysnID8gbWludXRlcyA6IC1taW51dGVzO1xuICAgICAgfVxuICAgIH1dXG4gIH07XG4gIHBhcnNlRmxhZ3MuZGQgPSBwYXJzZUZsYWdzLmQ7XG4gIHBhcnNlRmxhZ3MuZGRkZCA9IHBhcnNlRmxhZ3MuZGRkO1xuICBwYXJzZUZsYWdzLkREID0gcGFyc2VGbGFncy5EO1xuICBwYXJzZUZsYWdzLm1tID0gcGFyc2VGbGFncy5tO1xuICBwYXJzZUZsYWdzLmhoID0gcGFyc2VGbGFncy5IID0gcGFyc2VGbGFncy5ISCA9IHBhcnNlRmxhZ3MuaDtcbiAgcGFyc2VGbGFncy5NTSA9IHBhcnNlRmxhZ3MuTTtcbiAgcGFyc2VGbGFncy5zcyA9IHBhcnNlRmxhZ3MucztcbiAgcGFyc2VGbGFncy5BID0gcGFyc2VGbGFncy5hO1xuXG5cbiAgLy8gU29tZSBjb21tb24gZm9ybWF0IHN0cmluZ3NcbiAgZmVjaGEubWFza3MgPSB7XG4gICAgZGVmYXVsdDogJ2RkZCBNTU0gREQgWVlZWSBISDptbTpzcycsXG4gICAgc2hvcnREYXRlOiAnTS9EL1lZJyxcbiAgICBtZWRpdW1EYXRlOiAnTU1NIEQsIFlZWVknLFxuICAgIGxvbmdEYXRlOiAnTU1NTSBELCBZWVlZJyxcbiAgICBmdWxsRGF0ZTogJ2RkZGQsIE1NTU0gRCwgWVlZWScsXG4gICAgc2hvcnRUaW1lOiAnSEg6bW0nLFxuICAgIG1lZGl1bVRpbWU6ICdISDptbTpzcycsXG4gICAgbG9uZ1RpbWU6ICdISDptbTpzcy5TU1MnXG4gIH07XG5cbiAgLyoqKlxuICAgKiBGb3JtYXQgYSBkYXRlXG4gICAqIEBtZXRob2QgZm9ybWF0XG4gICAqIEBwYXJhbSB7RGF0ZXxudW1iZXJ9IGRhdGVPYmpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1hc2sgRm9ybWF0IG9mIHRoZSBkYXRlLCBpLmUuICdtbS1kZC15eScgb3IgJ3Nob3J0RGF0ZSdcbiAgICovXG4gIGZlY2hhLmZvcm1hdCA9IGZ1bmN0aW9uIChkYXRlT2JqLCBtYXNrLCBpMThuU2V0dGluZ3MpIHtcbiAgICB2YXIgaTE4biA9IGkxOG5TZXR0aW5ncyB8fCBmZWNoYS5pMThuO1xuXG4gICAgaWYgKHR5cGVvZiBkYXRlT2JqID09PSAnbnVtYmVyJykge1xuICAgICAgZGF0ZU9iaiA9IG5ldyBEYXRlKGRhdGVPYmopO1xuICAgIH1cblxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZGF0ZU9iaikgIT09ICdbb2JqZWN0IERhdGVdJyB8fCBpc05hTihkYXRlT2JqLmdldFRpbWUoKSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBEYXRlIGluIGZlY2hhLmZvcm1hdCcpO1xuICAgIH1cblxuICAgIG1hc2sgPSBmZWNoYS5tYXNrc1ttYXNrXSB8fCBtYXNrIHx8IGZlY2hhLm1hc2tzWydkZWZhdWx0J107XG5cbiAgICB2YXIgbGl0ZXJhbHMgPSBbXTtcblxuICAgIC8vIE1ha2UgbGl0ZXJhbHMgaW5hY3RpdmUgYnkgcmVwbGFjaW5nIHRoZW0gd2l0aCA/P1xuICAgIG1hc2sgPSBtYXNrLnJlcGxhY2UobGl0ZXJhbCwgZnVuY3Rpb24oJDAsICQxKSB7XG4gICAgICBsaXRlcmFscy5wdXNoKCQxKTtcbiAgICAgIHJldHVybiAnPz8nO1xuICAgIH0pO1xuICAgIC8vIEFwcGx5IGZvcm1hdHRpbmcgcnVsZXNcbiAgICBtYXNrID0gbWFzay5yZXBsYWNlKHRva2VuLCBmdW5jdGlvbiAoJDApIHtcbiAgICAgIHJldHVybiAkMCBpbiBmb3JtYXRGbGFncyA/IGZvcm1hdEZsYWdzWyQwXShkYXRlT2JqLCBpMThuKSA6ICQwLnNsaWNlKDEsICQwLmxlbmd0aCAtIDEpO1xuICAgIH0pO1xuICAgIC8vIElubGluZSBsaXRlcmFsIHZhbHVlcyBiYWNrIGludG8gdGhlIGZvcm1hdHRlZCB2YWx1ZVxuICAgIHJldHVybiBtYXNrLnJlcGxhY2UoL1xcP1xcPy9nLCBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBsaXRlcmFscy5zaGlmdCgpO1xuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXJzZSBhIGRhdGUgc3RyaW5nIGludG8gYW4gb2JqZWN0LCBjaGFuZ2VzIC0gaW50byAvXG4gICAqIEBtZXRob2QgcGFyc2VcbiAgICogQHBhcmFtIHtzdHJpbmd9IGRhdGVTdHIgRGF0ZSBzdHJpbmdcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZvcm1hdCBEYXRlIHBhcnNlIGZvcm1hdFxuICAgKiBAcmV0dXJucyB7RGF0ZXxib29sZWFufVxuICAgKi9cbiAgZmVjaGEucGFyc2UgPSBmdW5jdGlvbiAoZGF0ZVN0ciwgZm9ybWF0LCBpMThuU2V0dGluZ3MpIHtcbiAgICB2YXIgaTE4biA9IGkxOG5TZXR0aW5ncyB8fCBmZWNoYS5pMThuO1xuXG4gICAgaWYgKHR5cGVvZiBmb3JtYXQgIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZm9ybWF0IGluIGZlY2hhLnBhcnNlJyk7XG4gICAgfVxuXG4gICAgZm9ybWF0ID0gZmVjaGEubWFza3NbZm9ybWF0XSB8fCBmb3JtYXQ7XG5cbiAgICAvLyBBdm9pZCByZWd1bGFyIGV4cHJlc3Npb24gZGVuaWFsIG9mIHNlcnZpY2UsIGZhaWwgZWFybHkgZm9yIHJlYWxseSBsb25nIHN0cmluZ3NcbiAgICAvLyBodHRwczovL3d3dy5vd2FzcC5vcmcvaW5kZXgucGhwL1JlZ3VsYXJfZXhwcmVzc2lvbl9EZW5pYWxfb2ZfU2VydmljZV8tX1JlRG9TXG4gICAgaWYgKGRhdGVTdHIubGVuZ3RoID4gMTAwMCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHZhciBpc1ZhbGlkID0gdHJ1ZTtcbiAgICB2YXIgZGF0ZUluZm8gPSB7fTtcbiAgICBmb3JtYXQucmVwbGFjZSh0b2tlbiwgZnVuY3Rpb24gKCQwKSB7XG4gICAgICBpZiAocGFyc2VGbGFnc1skMF0pIHtcbiAgICAgICAgdmFyIGluZm8gPSBwYXJzZUZsYWdzWyQwXTtcbiAgICAgICAgdmFyIGluZGV4ID0gZGF0ZVN0ci5zZWFyY2goaW5mb1swXSk7XG4gICAgICAgIGlmICghfmluZGV4KSB7XG4gICAgICAgICAgaXNWYWxpZCA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRhdGVTdHIucmVwbGFjZShpbmZvWzBdLCBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBpbmZvWzFdKGRhdGVJbmZvLCByZXN1bHQsIGkxOG4pO1xuICAgICAgICAgICAgZGF0ZVN0ciA9IGRhdGVTdHIuc3Vic3RyKGluZGV4ICsgcmVzdWx0Lmxlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBwYXJzZUZsYWdzWyQwXSA/ICcnIDogJDAuc2xpY2UoMSwgJDAubGVuZ3RoIC0gMSk7XG4gICAgfSk7XG5cbiAgICBpZiAoIWlzVmFsaWQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuICAgIGlmIChkYXRlSW5mby5pc1BtID09PSB0cnVlICYmIGRhdGVJbmZvLmhvdXIgIT0gbnVsbCAmJiArZGF0ZUluZm8uaG91ciAhPT0gMTIpIHtcbiAgICAgIGRhdGVJbmZvLmhvdXIgPSArZGF0ZUluZm8uaG91ciArIDEyO1xuICAgIH0gZWxzZSBpZiAoZGF0ZUluZm8uaXNQbSA9PT0gZmFsc2UgJiYgK2RhdGVJbmZvLmhvdXIgPT09IDEyKSB7XG4gICAgICBkYXRlSW5mby5ob3VyID0gMDtcbiAgICB9XG5cbiAgICB2YXIgZGF0ZTtcbiAgICBpZiAoZGF0ZUluZm8udGltZXpvbmVPZmZzZXQgIT0gbnVsbCkge1xuICAgICAgZGF0ZUluZm8ubWludXRlID0gKyhkYXRlSW5mby5taW51dGUgfHwgMCkgLSArZGF0ZUluZm8udGltZXpvbmVPZmZzZXQ7XG4gICAgICBkYXRlID0gbmV3IERhdGUoRGF0ZS5VVEMoZGF0ZUluZm8ueWVhciB8fCB0b2RheS5nZXRGdWxsWWVhcigpLCBkYXRlSW5mby5tb250aCB8fCAwLCBkYXRlSW5mby5kYXkgfHwgMSxcbiAgICAgICAgZGF0ZUluZm8uaG91ciB8fCAwLCBkYXRlSW5mby5taW51dGUgfHwgMCwgZGF0ZUluZm8uc2Vjb25kIHx8IDAsIGRhdGVJbmZvLm1pbGxpc2Vjb25kIHx8IDApKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGF0ZSA9IG5ldyBEYXRlKGRhdGVJbmZvLnllYXIgfHwgdG9kYXkuZ2V0RnVsbFllYXIoKSwgZGF0ZUluZm8ubW9udGggfHwgMCwgZGF0ZUluZm8uZGF5IHx8IDEsXG4gICAgICAgIGRhdGVJbmZvLmhvdXIgfHwgMCwgZGF0ZUluZm8ubWludXRlIHx8IDAsIGRhdGVJbmZvLnNlY29uZCB8fCAwLCBkYXRlSW5mby5taWxsaXNlY29uZCB8fCAwKTtcbiAgICB9XG4gICAgcmV0dXJuIGRhdGU7XG4gIH07XG5cbiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmZWNoYTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGZlY2hhO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIG1haW4uZmVjaGEgPSBmZWNoYTtcbiAgfVxufSkodGhpcyk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBtZXNzYWdlTm9kZTpjYy5Ob2RlLFxuICAgICAgICBwbGF5Tm9kZTpjYy5Ob2RlLFxuXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNob3dNZXNzYWdlQWxlcnQ6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm1lc3NhZ2VOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICBjb21wLnBsYXkoJ3BvcCcpO1xuICAgIH0sXG5cbiAgICBkaXNtaXNzTWVzc2FnZUFsZXJ0OmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzZWxmLm1lc3NhZ2VOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9LDAuMyk7XG4gICAgfSxcblxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIGNyZWF0ZV9hbmltYTp7XHJcbiAgICAgICAgICAgIHR5cGU6Y2MuU3ByaXRlRnJhbWUsXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6W10sXHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9LFxyXG4gXHJcbiAgICBcclxufSk7XHJcbiIsInZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5jb25zdCBQbGF5YmFjayA9IHJlcXVpcmUoJ1BsYXliYWNrJyk7XG5cbmxldCBoYWxsID0gY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcblxuICAgICAgICAvL3Byb2R1Y3ROb2RlczpbY2MuTm9kZV0sXG4gICAgICAgIHNob3BBbGVydE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgY3JlYXRlTm9kZTpjYy5Ob2RlLFxuICAgICAgICBqb2luTm9kZTpjYy5Ob2RlLFxuICAgICAgICBnZW5neGluOmNjLk5vZGUsXG4gICAgICAgIGFsZXJ0UHJlZmFiOmNjLlByZWZhYixcbiAgICAgICAgdHNTaW5nbGVTZWxlY3Q6W2NjLk5vZGVdLCAgIC8vIOWIm+W7uuaIv+mXtOS/oeaBr++8jOWNlemAiVxuICAgICAgICB0c0NoZWNrU2VjbGVjdDpbY2MuTm9kZV0sICAgLy8g5Yib5bu65oi/6Ze05L+h5oGv77yM5aSN6YCJXG4gICAgICAgIHNlbGVjdE1vU2hpOmNjLk5vZGUsICAgICAgICAvLyDliJvlu7rmiL/pl7Tkv6Hmga/vvIzmqKHlvI/vvIjluoTlrrbmqKHlvI/lkozml6DnibnmrorniYzvvIlcbiAgICAgICAgc2VsZWN0R3VpUGFpOmNjLk5vZGUsICAgICAgIC8vIOWIm+W7uuaIv+mXtOS/oeaBr++8jOaooeW8j++8iOW6hOWutuaooeW8j+WSjOaXoOeJueauiueJjO+8iVxuICAgICAgICBvdmVyVGltZTpjYy5Ob2RlLCAgICAgICAgICAgLy8g6LaF5pe25Ye654mMXG4gICAgICAgIC8vbGFiZWxOb3RpY2U6IGNjLkxhYmVsLCAgICAgIC8vwqDlhazlkYpcbiAgICAgICAgbGFiZWxCYW5uZXI6IGNjLkxhYmVsLCAgICAgIC8vIGJhbm5lciBsYWJlbFxuICAgICAgICByZWNvcmROb2RlOmNjLk5vZGUsXG4gICAgICAgIHdhaXRpbmdQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICBzZXR0aW5nOmNjLk5vZGUsXG4gICAgICAgIC8v55So5oi35L+h5oGvXG4gICAgICAgIGF2YXRhck5vZGU6Y2MuTm9kZSxcbiAgICAgICAgbmlja05hbWVMYWJlbDpjYy5MYWJlbCxcbiAgICAgICAgY2FyZE51bWJlckxhYmVsOmNjLkxhYmVsLFxuICAgICAgICB1c2VySWRMYWJlbDpjYy5MYWJlbCxcbiAgICAgICAgY29kZUxhYmVsOmNjLkxhYmVsLFxuICAgICAgICAvL3Bob25lOmNjLkxhYmVsLFxuICAgICAgICAvLyB1c2VySW5mb01zZ05vZGU6Y2MuTm9kZSxcbiAgICAgICAgbG9nb3V0Tm9kZTogY2MuTm9kZSxcbiAgICAgICAgLy/miJjnu6lcbiAgICAgICAgcmVjb3JkTXNnTm9kZTpjYy5Ob2RlLFxuICAgICAgICBmZWVkYmFja0VkaXRCb3g6Y2MuRWRpdEJveCwvL+WPjemmiFxuICAgICAgICBmZWVkYmFja05vZGU6Y2MuTm9kZSxcbiAgICAgICAgd3hzaGFyZTpjYy5Ob2RlLFxuICAgICAgICBfdXNlcklkOjAsXG4gICAgICAgIF9vcGVuSWQ6bnVsbCxcbiAgICAgICAgX2hlbHA6bnVsbCxcbiAgICAgICAgX2Nsb3NlOm51bGwsXG4gICAgICAgIGlvc1VybDpudWxsLFxuICAgICAgICBhVXJsOm51bGwsXG5cbiAgICB9LFxuXG4gICAgc3RhdGljczoge1xuICAgICAgICBsYXN0SGFsbEluZm86IG51bGwsICAgLy8g5LiK5LiA5qyh5pS25Yiw55qE5aSn5Y6F5L+h5oGvXG4gICAgICAgIGNhY2hlSW1hZ2VJbmZvOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5rZXlCYWNrTGlzdGVuKCk7XG4gICAgICAgIGlmKGNjLnN5cy5pc0Jyb3dzZXIpIHtcbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvVGltZUxpbmUpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1Nlc3Npb24pIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1Nlc3Npb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XG4gICAgICAgIHZhciBiZyA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInJvb21fYmdcIik7XG4gICAgICAgIHZhciB3aW5kb3dQID0gY2MuZGlyZWN0b3IuZ2V0V2luU2l6ZUluUGl4ZWxzKCk7XG4gICAgICAgIHZhciBzY2FsZVggPSB3aW5kb3dQLndpZHRoL2JnLndpZHRoO1xuICAgICAgICB2YXIgc2NhbGVZID0gd2luZG93UC5oZWlnaHQvYmcuaGVpZ2h0O1xuICAgICAgICB2YXIgc2NhbGUgPSBNYXRoLm1heChzY2FsZVgsc2NhbGVZKTtcbiAgICAgICAgYmcuc2NhbGVYID0gc2NhbGU7XG4gICAgICAgIGJnLnNjYWxlWSA9IHNjYWxlO1xuICAgICAgICB0aGlzLmNsZWFyTG9jYWxTdG9yYWdlKCk7XG4gICAgICAgIGNjLmZyb20gPSB7fTtcbiAgICAgICAgY2MuZnJvbS5pc1VzZU1hID0gdHJ1ZTtcbiAgICAgICAgY2MuZnJvbS5tYSA9IDA7XG4gICAgICAgIGNjLmlzUm9vbVZpZXdTaG93ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2J0biA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0blwiKTtcbiAgICAgICAgdGhpcy5fYnV0dG9ucyA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ1dHRvbnNcIik7XG4gICAgICAgIHZhciB2b2x1bWUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJiZ1ZvbHVtZVwiKTtcbiAgICAgICAgaWYodm9sdW1lIT1udWxsICYmIHBhcnNlSW50KHZvbHVtZSkpIHtcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5TXVzaWMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBiZ1NvdW5kID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdTb3VuZFwiKTtcbiAgICAgICAgaWYoYmdTb3VuZCA9PSAwKXtcbiAgICAgICAgICAgIHZhciBhdWRpb01hbmFnZXIgPSBjYy5maW5kKCdBdWRpb01hbmFnZXInKTtcbiAgICAgICAgICAgIGF1ZGlvTWFuYWdlciA9IGF1ZGlvTWFuYWdlci5nZXRDb21wb25lbnQoJ0F1ZGlvTWFuYWdlcicpO1xuICAgICAgICAgICAgYXVkaW9NYW5hZ2VyLnNldEVmZmVjdE11c2ljVm9sdW0oYmdTb3VuZCk7XG4gICAgICAgIH1cbiAgICAgICAgUGxheWJhY2suaW5zdGFuY2UucmVtb3ZlUGxheWJhY2tEYXRhcygpO1xuXG4gICAgICAgIGhhbGwuY2FjaGVJbWFnZUluZm8gPSBoYWxsLmNhY2hlSW1hZ2VJbmZvIHx8IHt9O1xuXG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyU29ja2V0RXZlbnQoKTtcbiAgICAgICAgdGhpcy5fc3RhcnRCYW5uZXJBbmltYXRpb24oKTtcbiAgICAgICAgdGhpcy5faW5pdEpvaW5Sb29tKCk7XG5cbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgICB0aGlzLl9vcGVuSWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8ub3BlbklkO1xuICAgICAgICB0aGlzLl9pbnZpdGVDb2RlID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmludml0ZUNvZGU7ICAvL+mCgOivt+eggVxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuc29ja2V0ID0gY2MuZmluZCgnR2FtZVNvY2tldCcpLmdldENvbXBvbmVudCgnc29ja2V0Jyk7XG4gICAgICAgIHRoaXMuc29ja2V0LnJlY2V2aWNlTWVzc2FnZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2UpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25TdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLmhpZGRlbk5ldHdvcmtNZXNzYWdlKCk7XG4gICAgICAgICAgICBzZWxmLmhpZGRlbkNoZWNrTWVzc2FnZSgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNvY2tldC5jb25uZWN0aW9uRGlzY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5zaG93TmV0d29ya01lc3NhZ2UoJ+e9kee7nOmTvuaOpeaWreW8gO+8jOmHjeaWsOi/nuaOpeS4rS4uLicpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNvY2tldC5jaGVja05ldHdvcmtOb3cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYuc2hvd0NoZWNrTWVzc2FnZSgn5qOA5p+l572R57uc5LitLi4uJyk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc29ja2V0LmNoZWNrTmV0d29ya0VuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5oaWRkZW5DaGVja01lc3NhZ2UoKTtcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyAgLyrorr7nva7nlKjmiLfkv6Hmga8qL1xuICAgICAgICB0aGlzLnVwZGF0ZVVzZXJJbmZvKCk7XG4gICAgICAgIC8q5Yi35paw55So5oi35L+h5oGvKi9cbiAgICAgICAgU29ja2V0LnNlbmRHZXRVc2VySW5mbyh0aGlzLl91c2VySWQsdGhpcy5fb3BlbklkKTtcbiAgICAgICAgLyrlrprml7bliLfmlrDnlKjmiLfkv6Hmga8qL1xuICAgICAgICB0aGlzLnNjaGVkdWxlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBTb2NrZXQuc2VuZEdldFVzZXJJbmZvKHRoaXMuX3VzZXJJZCx0aGlzLl9vcGVuSWQpO1xuICAgICAgICB9LmJpbmQodGhpcyksMTApOy8vMTBz5LiA5qyhXG4gICAgICAgIFNvY2tldC5zZW5kR2V0SGFsbEluZm8odGhpcy5zb2NrZXQudXNlckluZm8uaWQpO1xuICAgICAgICBpZiAoaGFsbC5sYXN0SGFsbEluZm8pIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQmFubmVyKGhhbGwubGFzdEhhbGxJbmZvLmluZm8pO1xuICAgICAgICB9XG4gICAgICAgIGNjLm9uU2hhcmVXWFJlc3AgPSBudWxsO1xuICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ3BsYXknLGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ2xvZ2luJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZihjYy5qb2luRGVzayE9bnVsbCl7XG4gICAgICAgICAgICBpZighY2Muam9pbkRlc2sucmVzdWx0KXtcbiAgICAgICAgICAgICAgICB2YXIgcmVhc29uID0gY2Muam9pbkRlc2sucmVhc29uO1xuICAgICAgICAgICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlKHJlYXNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYy5qb2luRGVzayA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYoY2MucWluZ2xpICE9IG51bGwpe1xuICAgICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UoXCLmgqjooqvmiL/kuLvor7flh7rmiL/pl7RcIik7XG4gICAgICAgICAgICBjYy5xaW5nbGkgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIC8vdmFyIGNyZWF0QW5pbWEgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjcmVhdGVfcm9vbVwiKTtcbiAgICB9LFxuXG4gICAga2V5QmFja0xpc3RlbjpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGNjLnN5c3RlbUV2ZW50Lm9uKGNjLlN5c3RlbUV2ZW50LkV2ZW50VHlwZS5LRVlfRE9XTixmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT0gY2MuS0VZLmJhY2spIHtcbiAgICAgICAgICAgICAgICBpZighS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSl7XG4gICAgICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJiYWNrVG9EZXNrXCIsIFwiKClWXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSx0aGlzKTtcbiAgICB9LFxuXG4gICAgY2xpY2tXeFNoYXJlOmZ1bmN0aW9uKCl7XG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgdGhpcy53eHNoYXJlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzaGFyZVRpdGxlJyk7XG4gICAgICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Rlc2MnKTtcbiAgICAgICAgICAgIHZhciByZWNvcmRJZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVjb3JkSWQnKTtcbiAgICAgICAgICAgIHZhciBpZD0gJyc7XG4gICAgICAgICAgICBpZihyZWNvcmRJZCl7XG4gICAgICAgICAgICAgICAgaWQgPSAncmVjb3JkSWQ9JytyZWNvcmRJZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVGcmllbmRcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XG4gICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVGcmllbmRcIiwgc3RyLGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy/liIbkuqvliLDmnIvlj4vlnIhcbiAgICBzaGFyZUhhbGxUaW1lbGluZTpmdW5jdGlvbigpe1xuICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgIHRoaXMud3hzaGFyZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2hhcmVUaXRsZScpO1xuICAgICAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkZXNjJyk7XG4gICAgICAgICAgICB2YXIgcmVjb3JkSWQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JlY29yZElkJyk7XG4gICAgICAgICAgICB2YXIgaWQ9ICcnO1xuICAgICAgICAgICAgaWYocmVjb3JkSWQpe1xuICAgICAgICAgICAgICAgIGlkID0gJ3JlY29yZElkPScrcmVjb3JkSWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAgICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xuICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsIHN0cixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBzaGFyZUJnOmZ1bmN0aW9uKCl7XG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgdGhpcy53eHNoYXJlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIC8vIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICAvLyAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAgLy8gICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xuICAgICAgICAgICAgLy8gICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsIHN0cixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNsZWFyTG9jYWxTdG9yYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzaGFyZVRpdGxlID0gJ+W8gOaIv+eOqVvlpKfkvJfljYHkuInmsLRdJztcbiAgICAgICAgdmFyIGRlc2MgPSAn5byA5aW95oi/5LqG77yM5bCx562J5L2g5Lus5LiA6LW35p2lW+Wkp+S8l+WNgeS4ieawtF3llabvvIHmmZrkuobkvY3nva7lsLHmsqHkuoblk59+JzsgXG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgncm9vbUlkJyk7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2hhcmVUaXRsZScsc2hhcmVUaXRsZSk7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGVzYycsZGVzYyk7XG4gICAgfSxcblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNvY2tldC5yZWNldmljZU1lc3NhZ2UgPSBmdW5jdGlvbigpIHt9O1xuICAgICAgICB0aGlzLnNvY2tldC5jb25uZWN0aW9uU3VjY2VzcyA9IGZ1bmN0aW9uKCkge307XG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25EaXNjb25uZWN0ID0gZnVuY3Rpb24oKSB7fTtcbiAgICAgICAgdGhpcy5zb2NrZXQuY2hlY2tOZXR3b3JrTm93ID0gZnVuY3Rpb24oKXt9O1xuICAgICAgICB0aGlzLnNvY2tldC5jaGVja05ldHdvcmtFbmQgPSBmdW5jdGlvbigpIHt9O1xuICAgICAgICBcbiAgICAgIEtRR2xvYmFsRXZlbnQub2ZmVGFyZ2V0KHRoaXMpO1xuICAgIH0sXG5cbiAgICBfcmVnaXN0ZXJTb2NrZXRFdmVudDogZnVuY3Rpb24gKCkge1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Kb2luRGVzaywgdGhpcy5famlpblJvb21Tb2NrZXRDYWxsYmFjaywgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEZXNrSW5mbywgdGhpcy5famlpblJvb21Tb2NrZXRDYWxsYmFjaywgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVDcmVhdGVEZXNrLCB0aGlzLl9jcmVhdGVSb29tU29ja2V0Q2FsbGJhY2ssIHRoaXMpO1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlSGFsbEluZm8sIHRoaXMuX3NvY2tldFJlY2VpdmVIYWxsSW5mbywgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVHZXRVc2VySW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZVVzZXJJbmZvLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0RGlzY29ubmVjdCwgdGhpcy5fc29ja2V0RGlzY29ubmVjdCwgdGhpcyk7XG4gICAgICAgIC8vS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUludml0ZUNvZGUsIHRoaXMuX3NvY2tldFJlY2VpdmVJbnZpdGVDb2RlLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcy5fc29ja2V0Q29ubmVjdGVkLCB0aGlzKTtcbiAgICAgICAgLy9LUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlU2hhcmVQbmcsIHRoaXMuX3NvY2tldFNoYXJlUG5nLCB0aGlzKTtcbiAgICB9LFxuXG5cbiAgICAvLyDot7PovazliLDlhazkvJflj7dcbiAgICBndWFuemh1OmZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIHZhciB1cmwgPSBcImh0dHA6Ly93d3cuaG9uZ2dlZmVuZy5jbi9nemgvaW5kZXguaHRtbFwiO1xuICAgICAgICAvLyBjYy5zeXMub3BlblVSTCh1cmwpXG4gICAgfSxcbiAgICBfc3RhcnRCYW5uZXJBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLmxhYmVsQmFubmVyLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICBhbmltLnBsYXkoJ2Jhbm5lcicpO1xuICAgIH0sXG4gICAgZG93bkxvYWQ6ZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIHVybCA9J2h0dHBzOi8vZmlyLmltLzV0bmUnO1xuICAgICAgICBjYy5zeXMub3BlblVSTCh1cmwpO1xuXG4gICAgICAgIC8vd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcImh0dHA6Ly93d3cuYmFpZHUuY29tXCI7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCLvvJ/vvJ/vvJ/vvJ/vvJ/vvJ/vvJ/vvJ9cIik7XG4gICAgfSxcblxuICAgIF9pbml0Sm9pblJvb206IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBsZXQgam9pblJvb20gPSB0aGlzLmpvaW5Ob2RlLmdldENvbXBvbmVudCgnam9pblJvb20nKTtcblxuICAgICAgICBqb2luUm9vbS5jYWxsYmFja0pvaW5Sb29tID0gZnVuY3Rpb24gKG51bWJlcikge1xuICAgICAgICAgICAgLy8gc2VsZi5qb2luTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICAgICAgLy8gc2VsZi5zaG93V2FpdGluZ01lc3NhZ2UoJ+WKoOWFpeS4rS4uLicpO1xuICAgICAgICAgICAgLy8gc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyAgICAgc2VsZi5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xuICAgICAgICAgICAgLy8gfSwgMi4wKTtcblxuICAgICAgICAgICAgLyrliqDlhaXmiL/pl7Tor7fmsYIqL1xuICAgICAgICAgICAgbGV0IHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcbiAgICAgICAgICAgIFNvY2tldC5zZW5kSm9pbkRlc2sobnVtYmVyLCB1c2VySWQpO1xuICAgICAgICB9O1xuICAgIH0sXG5cblxuICAgIF9qaWluUm9vbVNvY2tldENhbGxiYWNrOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYoY2MuaXNSb29tVmlld1Nob3cpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGlkZGVuV2FpdGluZ01lc3NhZ2UoKTtcblxuICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0KSB7XG4gICAgICAgICAgICBpZihjYy5mcm9tID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjYy5mcm9tID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgam9pblJvb20gPSB0aGlzLmpvaW5Ob2RlLmdldENvbXBvbmVudCgnam9pblJvb20nKTtcblxuICAgICAgICAgICAgdGhpcy5qb2luTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jykuc2V0QWxlcnRDYWxsYmNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBqb2luUm9vbS5jbGlja0NsZWFyKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSByZXNwb25zZS5kYXRhLm1hUGFpO1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcmVhc29uSW5mbyA9IHRoaXMuX2pvaW5SZWFzb25NYXAocmVzcG9uc2UuZGF0YS5yZWFzb24pO1xuICAgICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UocmVhc29uSW5mbyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX3NvY2tldFJlY2VpdmVIYWxsSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmKGNjLmlzUm9vbVZpZXdTaG93KXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgaGFsbC5sYXN0SGFsbEluZm8gPSBkYXRhO1xuICAgICAgICBsZXQgaXNJT1MgPSBkYXRhLmlzSU9TO1xuICAgICAgICBsZXQgaXNBbmRyb2lkID0gZGF0YS5pc0E7XG4gICAgICAgIGxldCB2SU9TID0gZGF0YS52SU9TO1xuICAgICAgICBsZXQgdkEgPSBkYXRhLnZBO1xuICAgICAgICB0aGlzLmlvc1VybCA9IGRhdGEuaW9zVXJsO1xuICAgICAgICB0aGlzLmFVcmwgPSBkYXRhLmFVcmw7XG4gICAgICAgIGlmKGNjLnN5cy5pc05hdGl2ZSl7XG4gICAgICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAgICAgIGlmKGlzSU9TID09IDEpe1xuICAgICAgICAgICAgICAgICAgICBpZih2SU9TICE9ICcxLjAuMycgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VuZ3hpbi5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICAgICAgaWYoaXNBbmRyb2lkID09IDEpe1xuICAgICAgICAgICAgICAgICAgICBpZih2QSAhPSAnMS4wLjQnICl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdlbmd4aW4uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxldCBub3RpY2UgPSBkYXRhLmJyb2FkY2FzdDtcbiAgICAgICAgbGV0IGJhbm5lciA9IGRhdGEuaW5mbztcbiAgICAgICAgLy90aGlzLnVwZGF0ZU5vdGljZShub3RpY2UpO1xuICAgICAgICB0aGlzLnVwZGF0ZUJhbm5lcihiYW5uZXIpO1xuICAgIH0sXG4gICAgZG93bmxvYWROZXdWZXJzaW9uOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgIGNjLnN5cy5vcGVuVVJMKHRoaXMuaW9zVXJsKTtcbiAgICAgICAgICAgIC8vIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcImRvd25sb2FkTmV3VmVyc2lvbjpcIiwgdGhpcy5pb3NVcmwpO1xuICAgICAgICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICAgICAgICAgIGNjLnN5cy5vcGVuVVJMKHRoaXMuYVVybCk7XG4gICAgICAgICAgICAvLyBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZG93bmxvYWROZXdWZXJzaW9uXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIHRoaXMuYVVybCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIF9jcmVhdGVSb29tU29ja2V0Q2FsbGJhY2s6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZihjYy5pc1Jvb21WaWV3U2hvdyl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xuXG4gICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgICAgICB9XG4gICAgICAgIC8q5aaC5p6c6ZK755+z5LiN6Laz77yM5YiZ5o+Q56S6Ki9cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZShcIuaCqOeahOmSu+efs+S4jei2s1wiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfam9pblJlYXNvbk1hcDogZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgbGV0IHJlYXNvbkluZm8gPSB7XG4gICAgICAgIG5vdEV4aXN0OiBcIuaIv+mXtOS4jeWtmOWcqCFcIixcbiAgICAgICAgY2FyZE51bWJlcjogXCLmgqjmiL/ljaHkuI3otrMhXCIsXG4gICAgICB9O1xuXG4gICAgICBsZXQgaW5mbyA9IHJlYXNvbkluZm9bcmVhc29uXSB8fCBcIuaIv+mXtOW3sua7oSFcIjtcbiAgICAgIHJldHVybiBpbmZvO1xuICAgIH0sXG5cbiAgICAvKnNob3AqL1xuICAgIHNob3BBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5zaG9wQWxlcnROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG4gICAgLyrmj5DnpLoqL1xuICAgIGFsZXJ0TWVzc2FnZTpmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmFsZXJ0UHJlZmFiKTtcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKG5vZGUpO1xuICAgICAgICB2YXIgY29tcCA9IG5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICAvL3VwZGF0ZU5vdGljZTogZnVuY3Rpb24gKG5vdGljZSkge1xuICAgIC8vICAgIGlmKHRoaXMubGFiZWxOb3RpY2UgPT0gbnVsbCl7XG4gICAgLy8gICAgICAgIHJldHVybjtcbiAgICAvLyAgICB9XG4gICAgLy8gIHRoaXMubGFiZWxOb3RpY2Uuc3RyaW5nID0gbm90aWNlIHx8IFwiXCI7XG4gICAgLy99LFxuXG4gICAgdXBkYXRlQmFubmVyOiBmdW5jdGlvbiAoYmFubmVyID0gXCJcIikge1xuICAgICAgICBpZih0aGlzLmxhYmVsQmFubmVyID09IG51bGwpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB0aGlzLmxhYmVsQmFubmVyLnN0cmluZyA9IGJhbm5lcjtcbiAgICB9LFxuXG5cbiAgICAvKiMjIyMjXG4gICAgKiBzZXR0aW5nMSDlsYDmlbAgICgwIHwgMSB8IDIgKVxuICAgICogc2V0dGluZzIg5Lq65pWwICAoMCB8IDEgfCAyIHwgMylcbiAgICAqIHNldHRpbmczIOeOqeazlSAgKDAgfCAxIHwgMiB8IDMgfCA0KVxuICAgICogc2V0dGluZzQgQUHliLbmlLblj5bmiL/otLkgICgwIHwgMSB8IDIgKVxuICAgICogc2V0dGluZzUg5YW25LuWICAoMClcbiAgICAqIHNldHRpbmc2ICBcbiAgICAqIHNldHRpbmc3XG4gICAgKiAqL1xuICAgIGNyZWF0ZURvbmVBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpbmZvID0ge307XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGtleSA9IFsnc2V0dGluZzEnLCdzZXR0aW5nMicsJ3NldHRpbmc0Jywnc2V0dGluZzUnXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRzU2luZ2xlU2VsZWN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdHNJbmRleCA9IHNlbGYudHNTaW5nbGVTZWxlY3RbaV0uZ2V0Q29tcG9uZW50KCdzaW5nbGVTZWxlY3QnKS5zZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgaW5mb1trZXlbaV1dID0gdHNJbmRleDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaW5mb1snc2V0dGluZzMnXSA9IHRoaXMuc2VsZWN0TW9TaGkuZ2V0Q29tcG9uZW50KCdzZWxlY3RNb1NoaScpLl9zZWxlY3Q7XG4gICAgICAgIGluZm9bJ3NldHRpbmc2J10gPSB0aGlzLm92ZXJUaW1lLmdldENvbXBvbmVudCgnb3ZlclRpbWUnKS5fc2VsZWN0ZWQ7XG4gICAgICAgIC8vY29uc29sZS5sb2coIGluZm9bJ3NldHRpbmc2J10gKTtcbiAgICAgICAgaWYoICFpbmZvWydzZXR0aW5nMyddWzNdICl7ICAgLy8g546p5rOVIFvnlq/ni4LlnLos6ay854mMLOavlOiKseiJsizlnZDluoQs6ams54mMXSBpbmZvWydzZXR0aW5nMyddWzNd56ys5LiJ6aG56KGo56S65Z2Q5bqE5qih5byP77yM6Z2e5Z2Q5bqE5qih5byP55qE5YCN546H5pivMeWAjVxuICAgICAgICAgICAgaW5mb1snc2V0dGluZzUnXSA9IDA7ICAgICAvLyDlgI3njocgKDB+MSkgPT0gKDF+M+WAjSlcbiAgICAgICAgfVxuICAgICAgICBpbmZvWydzZXR0aW5nOCddID0gbnVsbDtcbiAgICAgXG4gICAgICAgIGluZm9bJ3NldHRpbmc3J10gPSB0aGlzLnNlbGVjdE1vU2hpLmdldENvbXBvbmVudCgnY2hhbmdlX21hcGFpJykuX2NhcmRzO1xuICAgICAgICBjYy5zZXQgPSBpbmZvO1xuICAgICAgICBpbmZvWyd1c2VySWQnXSA9IHRoaXMuc29ja2V0LnVzZXJJbmZvLmlkOyAgICAgIC8v55So5oi3SWRcbiAgICAgICAgdGhpcy5zb2NrZXQuc2VuZE1lc3NhZ2UoJ2NyZWF0ZURlc2snLGluZm8pO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuXG4gICAgICAgIC8vbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5Yib5bu65LitLi4uJyk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xuICAgICAgICB9LCAyLjApO1xuICAgIH0sXG5cbiAgICAvLyDpmo/mnLrlnLpcbiAgICAvKmNsaWNrUmFuZFJvb206IGZ1bmN0aW9uICgpIHtcbiAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncmFuZFJvb20nKTtcbiAgICB9LCovXG5cbiAgICBjbGlja1JlY29yZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMucmVjb3JkTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICAgICAgU29ja2V0LnNlbmRHZXRSZWNyb2QoU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkKTtcblxuICAgIH0sXG5cbiAgICBjbGlja1BsYXlSdWxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdydWxlJyk7XG4gICAgICAgIHRoaXMuaGVscCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImhlbHBcIik7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5oZWxwLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICBjbGlja1BsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYoY2MuY2xpY2tPdXQpIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgIH0sXG5cbiAgICAvKuWIh+aNoui0puWPtyovXG4gICAgY2xpY2tDYW5jZWxMYXRpb246ZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxvZ291dE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGxvZ291dEFjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vbWFuYWdlci5zZXRVc2VySW5mbygnJyk7XG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnbG9naW4nKTtcbiAgICAgICAgaGFsbC5jYWNoZUltYWdlSW5mbyA9IG51bGw7XG4gICAgfSxcblxuICAgIGV4aXRBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAvL21hbmFnZXIuc2V0VXNlckluZm8oJycpO1xuICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdsb2dpbicpO1xuICAgICAgICBoYWxsLmNhY2hlSW1hZ2VJbmZvID0gbnVsbDtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcImV4aXRBcHBcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWQgY29tLmxsaW5nLnFpYW5qaWFuZ2x6Z1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImV4aXRBcHBcIiwgXCIoKVZcIik7XG4gICAgICAgIH1cbiAgICAgICAgY2MuZGlyZWN0b3IuZW5kKCk7XG5cbiAgICB9LFxuXG4gICAgLy/mjqXmlLblpITnkIbnlKjmiLfmlbDmja5cbiAgICBfc29ja2V0UmVjZWl2ZVVzZXJJbmZvOmZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmKGNjLmlzUm9vbVZpZXdTaG93KXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgaWYgKCF0aGlzLnNvY2tldC51c2VySW5mbykge1xuICAgICAgICBjYy5lcnJvcihcInRoaXMuc29ja2V0LnVzZXJJbmZvIOS4uuepuiEhIVwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy9jb25zb2xlLmxvZyhyZXNwb25zZSxcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS3nlKjmiLfkv6Hmga9cIik7XG4gICAgICAvL3RoaXMucGhvbmUuc3RyaW5nID0gcmVzcG9uc2UuZGF0YS5waG9uZSA/IHJlc3BvbnNlLmRhdGEucGhvbmUgOiBcIuaXoFwiO1xuICAgICAgdGhpcy5zZXR0aW5nLmdldENvbXBvbmVudCgnU2V0dGluZycpLl9waG9uZSA9IHJlc3BvbnNlLmRhdGEucGhvbmU/cmVzcG9uc2UuZGF0YS5waG9uZTpudWxsO1xuICAgICAgdGhpcy5zZXR0aW5nLmdldENvbXBvbmVudCgnU2V0dGluZycpLnBob25lLnN0cmluZyA9IHJlc3BvbnNlLmRhdGEucGhvbmU/cmVzcG9uc2UuZGF0YS5waG9uZTon5pegJztcbiAgICAgIHRoaXMubmlja05hbWVMYWJlbC5zdHJpbmcgPSByZXNwb25zZS5kYXRhLm5pY2tuYW1lOyAgIC8vIOeUqOaIt+WQjVxuICAgICAgdGhpcy51c2VySWRMYWJlbC5zdHJpbmcgPSAnSUQ6ICcgKyByZXNwb25zZS5kYXRhLmlkOyAgLy8gSURcbiAgICAgIHRoaXMuY2FyZE51bWJlckxhYmVsLnN0cmluZyA9IHJlc3BvbnNlLmRhdGEuY2FyZE51bWJlcjtcbiAgICAgIHZhciBzcHJpdGUgPSB0aGlzLmF2YXRhck5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICBjYy5sb2FkZXIubG9hZCh7dXJsOnJlc3BvbnNlLmRhdGEuYXZhdGFyVXJsLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIHRleCkge1xuICAgICAgICAgIGlmICghZXJyKSB7XG4gICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xuICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWU9ZnJhbWU7XG4gICAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9zb2NrZXREaXNjb25uZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zaG93TmV0d29ya01lc3NhZ2UoXCLnvZHnu5zpk77mjqXmlq3lvIDvvIzph43mlrDov57mjqXkuK0uLi5cIik7XG4gICAgfSxcblxuICAgIF9zb2NrZXRDb25uZWN0ZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmhpZGRlbk5ldHdvcmtNZXNzYWdlKCk7XG4gICAgfSxcblxuICAgIC8v5pu05paw55So5oi35L+h5oGvXG4gICAgdXBkYXRlVXNlckluZm86ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpbmZvID0gdGhpcy5zb2NrZXQudXNlckluZm87XG4gICAgICAgIGlmICghaW5mbykge1xuICAgICAgICAgIGNjLmVycm9yKFwidGhpcy5zb2NrZXQudXNlckluZm8g5Li656m6ISEhXCIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubmlja05hbWVMYWJlbC5zdHJpbmcgPSBpbmZvLm5pY2tuYW1lO1xuICAgICAgICB0aGlzLnVzZXJJZExhYmVsLnN0cmluZyA9ICdJRDogJyArIGluZm8uaWQ7XG4gICAgICAgIHRoaXMuY2FyZE51bWJlckxhYmVsLnN0cmluZyA9IGluZm8uY2FyZE51bWJlcjtcblxuICAgICAgICBsZXQgYXZhdGFyVXJsID0gaW5mby5hdmF0YXJVcmwgKyBcIi5qcGdcIjtcbiAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuYXZhdGFyTm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgdmFyIHRleHR1cmUgPSBoYWxsLmNhY2hlSW1hZ2VJbmZvW2F2YXRhclVybF07XG4gICAgICAgIGlmICh0ZXh0dXJlKSB7XG4gICAgICAgICAgICBsZXQgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4dHVyZSk7XG4gICAgICAgICAgICBpZiAoZnJhbWUpIHtcbiAgICAgICAgICAgICAgICAvL2NjLmxvZyhcIuS7jue8k+WtmOS4reWKoOi9veWktOWDj1wiKTtcbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBmcmFtZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjYy5sb2FkZXIubG9hZCh7dXJsOmluZm8uYXZhdGFyVXJsLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIHRleCkge1xuICAgICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4KTtcbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWU9ZnJhbWU7XG5cbiAgICAgICAgICAgICAgICBoYWxsLmNhY2hlSW1hZ2VJbmZvW2F2YXRhclVybF0gPSB0ZXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKuaPkOS6pOaEj+ingSovXG4gICAgZmVlZGJhY2tBY2lvbjpmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdXNlcklkID0gdGhpcy5zb2NrZXQudXNlckluZm8uaWQ7XG4gICAgICB2YXIgdGV4dCA9IHRoaXMuZmVlZGJhY2tFZGl0Qm94LnN0cmluZztcbiAgICAgIGlmICh0ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5mZWVkYmFja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgU29ja2V0LnNlbmRGZWVkYmFjayh1c2VySWQsdGV4dCk7XG4gICAgICAgIHRoaXMuZmVlZGJhY2tFZGl0Qm94LnN0cmluZyA9ICcnO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBzaG93V2FpdGluZ01lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICBpZiAodGhpcy53YWl0aW5nTm9kZSAhPSBudWxsICYmIGNjLnN5cy5pc05hdGl2ZSAmJiBjYy5zeXMuaXNPYmplY3RWYWxpZCh0aGlzLndhaXRpbmdOb2RlKSkge1xuICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUuZGVzdG9yeSgpO1xuICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUgPSBudWxsO1xuICAgICAgfVxuICAgICAgdGhpcy53YWl0aW5nTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XG4gICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy53YWl0aW5nTm9kZSk7XG4gICAgICB2YXIgY29tcCA9IHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGhpZGRlbldhaXRpbmdNZXNzYWdlOmZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy9uZXR3b3JrXG4gICAgc2hvd05ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAmJiB0aGlzLm5ldHdvcmtOb2RlLmFjdGl2ZSkge1xuICAgICAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgICAgICBpZiAoYWxlcnQuZ2V0TWVzc2FnZSgpID09IG1zZykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciByZW1vdmVTZWxmQWN0aW9uID0gY2MucmVtb3ZlU2VsZigpO1xuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZS5ydW5BY3Rpb24ocmVtb3ZlU2VsZkFjdGlvbik7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5ldHdvcmtOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMubmV0d29ya05vZGUpO1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGNvbXAub25EaXNtaXNzQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYubmV0d29ya05vZGUgPSBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICBoaWRkZW5OZXR3b3JrTWVzc2FnZTpmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vY2hlY2tOb2RlXG4gICAgc2hvd0NoZWNrTWVzc2FnZTpmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgaWYgKCEodGhpcy5jaGVja05vZGUgJiYgdGhpcy5jaGVja05vZGUuYWN0aXZlKSkge1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICAgICAgaWYgKGFsZXJ0LmdldE1lc3NhZ2UoKSA9PSBtc2cpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLmNoZWNrTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNoZWNrTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLmNoZWNrTm9kZSk7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGNvbXAub25EaXNtaXNzQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYuY2hlY2tOb2RlID0gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgaGlkZGVuQ2hlY2tNZXNzYWdlOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5jaGVja05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgb25CdG5DbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKHRoaXMuX2J1dHRvbnMuYWN0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLl9idXR0b25zLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbnMuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gaGFsbDtcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvKnNwcml0ZXM6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlQXRsYXNcclxuICAgICAgICB9LCovXHJcbiAgICAgICAgcGxheV9tZXRob2RfYmVmb3JlOmNjLk5vZGUsICAvL+eOqeazleS7i+e7jVxyXG4gICAgICAgIHBsYXlfbWV0aG9kX2NvbnRlbnRfbGFiZWw6Y2MuTm9kZSwgIC8v546p5rOV5LuL57uN5YaF5a65XHJcbiAgICAgICAgaW50cm9kdWNlX3BhaV9iZWZvcmU6Y2MuTm9kZSwvL+eJjOWei+S7i+e7jVxyXG4gICAgICAgIGRldGFpbHM6Y2MuTm9kZSwgICAvL+eJjOWei+S7i+e7jeWGheWuuVxyXG4gICAgICAgIGNhb3p1b19iZWZvcmU6Y2MuTm9kZSwgICAgIC8v5pON5L2c5LuL57uNXHJcbiAgICAgICAgY2FvenVvX2NvbnRlbnQ6Y2MuTm9kZSwgIC8v5pON5L2c5LuL57uN5YaF5a65XHJcbiAgICAgICAgX2J0bjpudWxsLFxyXG4gICAgICAgIF9jb250ZW50Om51bGwsXHJcbiAgICAgICAgX2J1dHRvbkNvbTpudWxsLFxyXG4gICAgICAgIF9wbGF5X21ldGhvZF9idXR0b246bnVsbCxcclxuICAgICAgICBfaW50cm9kdWNlX3BhaV9idXR0b246bnVsbCxcclxuICAgICAgICBfY2FvenVvX2J1dHRvbjpudWxsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy90aGlzLl9wbGF5X21ldGhvZF9idXR0b24gPSB0aGlzLnBsYXlfbWV0aG9kX2JlZm9yZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICAvL3RoaXMuX2ludHJvZHVjZV9wYWlfYnV0dG9uID0gdGhpcy5pbnRyb2R1Y2VfcGFpX2JlZm9yZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICAvL3RoaXMuX2Nhb3p1b19idXR0b24gPSB0aGlzLmNhb3p1b19iZWZvcmUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XHJcbiAgICAgICAgLy90aGlzLl9idG4gPSBbdGhpcy5wbGF5X21ldGhvZF9iZWZvcmUsdGhpcy5pbnRyb2R1Y2VfcGFpX2JlZm9yZSx0aGlzLmNhb3p1b19iZWZvcmVdO1xyXG4gICAgICAgIC8vdGhpcy5fY29udGVudCA9IFt0aGlzLnBsYXlfbWV0aG9kX2NvbnRlbnRfbGFiZWwsdGhpcy5kZXRhaWxzLHRoaXMuY2FvenVvX2NvbnRlbnRdO1xyXG4gICAgICAgIC8vdGhpcy5fYnV0dG9uQ29tID0gW3RoaXMuX3BsYXlfbWV0aG9kX2J1dHRvbix0aGlzLl9pbnRyb2R1Y2VfcGFpX2J1dHRvbix0aGlzLl9jYW96dW9fYnV0dG9uXTtcclxuICAgICAgICAvLy8v5Yia5byA5aeL54mM5Z6L5LuL57uN55qE5oyJ6ZKu5LiN5Y+v55SoXHJcbiAgICAgICAgLy90aGlzLl9idXR0b25Db21bMV0uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgLy8g54K55Ye7546p5rOV5LuL57uNXHJcbiAgICBvbkJ0blBsYXlNZXRob2RDbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy9mb3IodmFyIGk9MDtpPDM7aSsrKXtcclxuICAgICAgICAvLyAgICAvL+aJgOacieaMiemSruiuvue9ruS4uuWPr+eUqFxyXG4gICAgICAgIC8vICAgIHRoaXMuX2J1dHRvbkNvbVtpXS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIC8v5omA5pyJ55qE5YaF5a656YO96ZqQ6JeP5o6JXHJcbiAgICAgICAgLy8gICAgdGhpcy5fY29udGVudFtpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8v5b2T5YmN54K55Ye755qE6K6+572u5Li65LiN5Y+v55SoXHJcbiAgICAgICAgLy90aGlzLl9idXR0b25Db21bMF0uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgLy8vL+W9k+WJjeeCueWHu+eahOWvueW6lOeahOWGheWuueWPr+ingVxyXG4gICAgICAgIHRoaXMuX2NvbnRlbnRbMF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICAvL+eCueWHu+eJjOWei+S7i+e7jVxyXG4gICAgb25CdG5JbnRyb2R1Y2VQYWlDbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy9mb3IodmFyIGk9MDtpPDM7aSsrKXtcclxuICAgICAgICAvLyAgICAvL+aJgOacieaMiemSruiuvue9ruS4uuWPr+eUqFxyXG4gICAgICAgIC8vICAgIHRoaXMuX2J1dHRvbkNvbVtpXS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIC8v5omA5pyJ55qE5YaF5a656YO96ZqQ6JeP5o6JXHJcbiAgICAgICAgLy8gICAgdGhpcy5fY29udGVudFtpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8v5b2T5YmN54K55Ye755qE6K6+572u5Li65LiN5Y+v55SoXHJcbiAgICAgICAgLy90aGlzLl9idXR0b25Db21bMV0uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgLy8vL+W9k+WJjeeCueWHu+eahOWvueW6lOeahOWGheWuueWPr+ingVxyXG4gICAgICAgIC8vdGhpcy5fY29udGVudFsxXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIC8v54K55Ye75pON5L2c5LuL57uNXHJcbiAgICBvbkJ0bkNhb3p1b0NsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL2Zvcih2YXIgaT0wO2k8MztpKyspe1xyXG4gICAgICAgIC8vICAgIC8v5omA5pyJ5oyJ6ZKu6K6+572u5Li65Y+v55SoXHJcbiAgICAgICAgLy8gICAgdGhpcy5fYnV0dG9uQ29tW2ldLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgLy/miYDmnInnmoTlhoXlrrnpg73pmpDol4/mjolcclxuICAgICAgICAvLyAgICB0aGlzLl9jb250ZW50W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLy/lvZPliY3ngrnlh7vnmoTorr7nva7kuLrkuI3lj6/nlKhcclxuICAgICAgICAvL3RoaXMuX2J1dHRvbkNvbVsyXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAvLy8v5b2T5YmN54K55Ye755qE5a+55bqU55qE5YaF5a655Y+v6KeBXHJcbiAgICAgICAgLy90aGlzLl9jb250ZW50WzJdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwiLyoqXHJcbiAqIOmCgOivt+eggVxyXG4gKiBAYXV0aG9ycyDpu4TmiJAoeW91QGV4YW1wbGUub3JnKVxyXG4gKiBAZGF0ZSAgICAyMDE3LTA2LTE2IDA5OjQ0OjEwXHJcbiAqIEB2ZXJzaW9uICRJZCRcclxuICovXHJcbmNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGxhYmVsTnVtYmVyczogW2NjLkxhYmVsXSxcclxuICAgICAgICBjYWxsYmFja0ludml0ZUNvZGU6ICcnLFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5jbGlja0NsZWFyKCk7IC8v5riF6Zmk5pWw5a2XXHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrQ2xlYXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5sYWJlbE51bWJlcnMuZm9yRWFjaChmdW5jdGlvbiAobGFiZWwpIHtcclxuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tOdW1iZXI6IGZ1bmN0aW9uIChldmVudCwgbnVtYmVyKSB7XHJcbiAgICAgIHZhciBsYWJlbCA9IHRoaXMuX2xhc3RFbXB0eUxhYmVsKCk7XHJcbiAgICAgIGlmIChsYWJlbCkge1xyXG4gICAgICAgIGxhYmVsLnN0cmluZyA9IG51bWJlcjtcclxuICAgICAgIFx0Ly9jYy5sb2cobGFiZWwuc3RyaW5nICxcIi0tLS0tLS0tLS0tLS0tLS1cIik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGxldCBpc0NvbXBsZXRlID0gKHRoaXMuX2xhc3RFbXB0eUxhYmVsKCkgPT0gbnVsbCk7XHJcbiAgICAgIC8vY2MubG9nKFwiaXNDb21wbGV0ZS0tLS0tLS0tLS0tLS1cIiwgdGhpcy5jYWxsYmFja0ludml0ZUNvZGUpO1xyXG4gICAgICBsZXQgaW52aXRlTnVtYmVyID0gdGhpcy5faW52aXRlTnVtYmVyKCk7XHJcblxyXG4gICAgICBpZiAoIGludml0ZU51bWJlci5sZW5ndGggPT0gNiApe1xyXG4gICAgICAgIC8vY2MubG9nKGludml0ZU51bWJlcixcIi0tLS0tLS0tLS0tLS0tLS0tLS0tMzhcIik7IC8v6YKA6K+356CBXHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcclxuICAgICAgICAvL1NvY2tldC5zZW5kSW52aXRlQ29kZShpbnZpdGVOdW1iZXIsIHVzZXJJZCk7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja0ludml0ZUNvZGUgPSBpbnZpdGVOdW1iZXI7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzZW5kQ29kZSA6ZnVuY3Rpb24oKXsgIC8v5Y+R6YCB6YKA6K+356CBXHJcbiAgICAgIGxldCB1c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XHJcbiAgICAgIGxldCBpbnZpdGVOdW1iZXIgPSB0aGlzLmNhbGxiYWNrSW52aXRlQ29kZTtcclxuICAgICAgLy9jYy5sb2coaW52aXRlTnVtYmVyLFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0zOFwiKVxyXG4gICAgICBpZiggaW52aXRlTnVtYmVyICYmIGludml0ZU51bWJlci5sZW5ndGg9PTYpeyAgXHJcbiAgICAgICAgU29ja2V0LnNlbmRJbnZpdGVDb2RlKGludml0ZU51bWJlciwgdXNlcklkKTtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrSW52aXRlQ29kZSA9ICcnOyAgIC8v5riF56m66YKA6K+356CBXHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjbGlja0RlbGV0ZU9uZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgbGFiZWwgPSB0aGlzLl9sYXN0TnVtYmVyTGFiZWwoKTtcclxuICAgICAgaWYgKGxhYmVsKSB7XHJcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gXCJcIjtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfbGFzdEVtcHR5TGFiZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgZm9yICh2YXIgaW5kZXggaW4gdGhpcy5sYWJlbE51bWJlcnMpIHtcclxuICAgICAgICB2YXIgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XHJcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyA9PSBudWxsXHJcbiAgICAgICAgfHwgbGFiZWwuc3RyaW5nLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfSxcclxuXHJcbiAgICBfbGFzdE51bWJlckxhYmVsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGZvciAodmFyIGluZGV4ID0gdGhpcy5sYWJlbE51bWJlcnMubGVuZ3RoIC0gMTsgaW5kZXggPj0gMDsgLS1pbmRleCkge1xyXG4gICAgICAgIGxldCBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcclxuICAgICAgICBpZiAobGFiZWwuc3RyaW5nICYmIGxhYmVsLnN0cmluZy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgX2ludml0ZU51bWJlcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5sYWJlbE51bWJlcnMucmVkdWNlKGZ1bmN0aW9uIChpbnZpdGVOdW1iZXIsIGxhYmVsKSB7XHJcbiAgICAgICAgLy9jYy5sb2coaW52aXRlTnVtYmVyLFwiLS0tLS0tLS0tLS0tLS0tLS1cIik7XHJcbiAgICAgICAgcmV0dXJuIGludml0ZU51bWJlciArIChsYWJlbC5zdHJpbmcgfHwgXCJcIik7XHJcbiAgICAgIH0sIFwiXCIpO1xyXG4gICAgfSxcclxufSkiLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYWJlbE51bWJlcnM6IFtjYy5MYWJlbF0sXG4gICAgICAgIGNhbGxiYWNrSm9pblJvb206IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jbGlja0NsZWFyKCk7XG4gICAgfSxcblxuICAgIGNsaWNrTnVtYmVyOiBmdW5jdGlvbiAoZXZlbnQsIG51bWJlcikge1xuICAgICAgdmFyIGxhYmVsID0gdGhpcy5fbGFzdEVtcHR5TGFiZWwoKTtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBudW1iZXI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBpc0NvbXBsZXRlID0gKHRoaXMuX2xhc3RFbXB0eUxhYmVsKCkgPT0gbnVsbCk7XG4gICAgICBpZiAoaXNDb21wbGV0ZSAmJiB0aGlzLmNhbGxiYWNrSm9pblJvb20pIHtcbiAgICAgICAgbGV0IHJvb21OdW1iZXIgPSB0aGlzLl9yb29tTnVtYmVyKCk7XG4gICAgICAgIC8vIGNjLmxvZyhcIuimgeWKoOWFpeeahOaIv+mXtOWPt+aYr++8mlwiLCByb29tTnVtYmVyKTtcbiAgICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tKHJvb21OdW1iZXIpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBjbGlja0NsZWFyOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmxhYmVsTnVtYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGNsaWNrRGVsZXRlT25lOiBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgbGFiZWwgPSB0aGlzLl9sYXN0TnVtYmVyTGFiZWwoKTtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBfbGFzdEVtcHR5TGFiZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGluZGV4IGluIHRoaXMubGFiZWxOdW1iZXJzKSB7XG4gICAgICAgIHZhciBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyA9PSBudWxsXG4gICAgICAgIHx8IGxhYmVsLnN0cmluZy5sZW5ndGggPD0gMCkge1xuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9sYXN0TnVtYmVyTGFiZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGluZGV4ID0gdGhpcy5sYWJlbE51bWJlcnMubGVuZ3RoIC0gMTsgaW5kZXggPj0gMDsgLS1pbmRleCkge1xuICAgICAgICBsZXQgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgJiYgbGFiZWwuc3RyaW5nLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9yb29tTnVtYmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5sYWJlbE51bWJlcnMucmVkdWNlKGZ1bmN0aW9uIChyb29tTnVtYmVyLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gcm9vbU51bWJlciArIChsYWJlbC5zdHJpbmcgfHwgXCJcIik7XG4gICAgICB9LCBcIlwiKTtcbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnbG9naW4nKTtcbiAgICAgICAgfSwgMC41KTtcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwidmFyIG1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XG5jb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgS1FDYXJkRmluZFR5cGVFeHRlbnNpb24gPSByZXF1aXJlKCdLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbicpO1xuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xuY29uc3QgS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlciA9IHJlcXVpcmUoJ0tRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXInKTtcblxudmFyIEFQUElEID0gJ3d4ZTg5OTNmNDY4YjE2ZmE1ZCc7XG52YXIgUk9PTUlEID0gJyc7XG4vL+aOiOadg+WcsOWdgFxuLy/mraPlvI/lnLDlnYBcbi8vIHZhciBSRURJUkVDVF9VUkkgPSBcImh0dHAlM0ElMkYlMkZ3d3cuaG9uZ2dlZmVuZy5jbiUyRnNzeldlYiUyRmluZGV4LnBocFwiO1xuLy8g5rWL6K+V5Zyw5Z2AXG52YXIgUkVESVJFQ1RfVVJJID0gXCJodHRwJTNhJTJmJTJmbzFvMi5jblwiO1xuXG5sZXQgSFJFRiA9IFwiaHR0cHM6Ly9vcGVuLndlaXhpbi5xcS5jb20vY29ubmVjdC9vYXV0aDIvYXV0aG9yaXplP2FwcGlkPVwiK0FQUElEK1wiJnJlZGlyZWN0X3VyaT1cIitSRURJUkVDVF9VUkkrXCImcmVzcG9uc2VfdHlwZT1jb2RlJnNjb3BlPXNuc2FwaV91c2VyaW5mbyZzdGF0ZT1TVEFURSN3ZWNoYXRfcmVkaXJlY3RcIjtcblxuXG5jYy5DbGFzcyh7XG5cbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvL3NlbGVjdE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgYWxlcnRQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICBjYW52YXNOb2RlOmNjLk5vZGUsXG4gICAgICAgIGxvYWRpbmdOb2RlOmNjLk5vZGUsXG4gICAgICAgIC8vZXJyOmNjLk5vZGUsXG4gICAgICAgIHdhaXRpbmdQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICByZWNvcmRJbmZvOmNjLlByZWZhYixcbiAgICAgICAgbGFiZWw6Y2MuTGFiZWwsXG4gICAgfSxcblxuICAgIGdvVXBkYXRlQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcIkFwcENvbnRyb2xsZXJcIixcImRvd25sb2FkTmV3VmVyc2lvbjpcIix0aGlzLmlvc1VybCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL2dvbmdwYS9zc3ovQXBwQWN0aXZpdHlcIiwgXCJkb3dubG9hZE5ld1ZlcnNpb25cIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgdGhpcy5hbmRyb2lkVXJsKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBjaGVja1ZlcnNpb246ZnVuY3Rpb24odkRhdGEpIHtcbiAgICAgICAgLy92YXIgdmVyc2lvbiA9IHZEYXRhLnZlcnNpb247XG4gICAgICAgIGNjLmluZm8xID0gdkRhdGEudmVyc2lvbjtcbiAgICAgICAgdGhpcy5pb3NVcmwgPSB2RGF0YS5pb3NVcmw7XG4gICAgICAgIHRoaXMuYW5kcm9pZFVybCA9IHZEYXRhLmFuZHJvaWRVcmw7XG4gICAgICAgIC8vaWYgKG1hbmFnZXIudmVyc2lvbiAhPSB2ZXJzaW9uKSB7Ly/mm7TmlrDniYjmnKxcbiAgICAgICAgLy8gICAgdGhpcy52ZXJzaW9uRW5hYmxlID0gZmFsc2U7XG4gICAgICAgIC8vICAgIHRoaXMuZ29VcGRhdGVBY3Rpb24oKTtcbiAgICAgICAgLy8gICAgLy90aGlzLnZlcnNpb25MYWJlbC5zdHJpbmcgPSAn6K+35Yiw5pyN5Yqh5Zmo5pu05paw5Yiw5pyA5paw54mI5pysJztcbiAgICAgICAgLy99XG4gICAgICAgIC8vZWxzZSB7XG4gICAgICAgICAgICAvL3RoaXMudmVyc2lvbkxhYmVsLnN0cmluZyA9ICflvZPliY3niYjmnKwgJyArIG1hbmFnZXIudmVyc2lvbjtcbiAgICAgICAgICAgIGlmKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgICAgICAvLyBpZihpb3NWZXJzaW9uICE9IG1hbmFnZXIudmVyc2lvbikge1xuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLnZlcnNpb25FbmFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvLyAgICAgdmFyIHVwZGF0ZUFsZXJ0ID0gY2MuZmluZChcIkNhbnZhcy91cGRhdGVcIikuZ2V0Q29tcG9uZW50KFwiYWxlcnRcIik7XG4gICAgICAgICAgICAgICAgLy8gICAgIHVwZGF0ZUFsZXJ0LmFsZXJ0KCk7XG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIC8vIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZlcnNpb25FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2luRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2luQWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sMC41KTtcbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHtcbiAgICAgICAgICAgICAgICAvLyBpZihhbmRyb2lkVmVyc2lvbiAhPSBtYW5hZ2VyLnZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy52ZXJzaW9uRW5hYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgLy8gICAgIHZhciB1cGRhdGVBbGVydCA9IGNjLmZpbmQoXCJDYW52YXMvdXBkYXRlXCIpLmdldENvbXBvbmVudChcImFsZXJ0XCIpO1xuICAgICAgICAgICAgICAgIC8vICAgICB1cGRhdGVBbGVydC5hbGVydCgpO1xuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICAvLyBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52ZXJzaW9uRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9naW5FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2dpbkFjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LDAuNSk7XG4gICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICB0aGlzLnZlcnNpb25FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgIC8vIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgICAvLyBpZiAoaW5mby5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAvLyAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgICAgICAgICAgIHZhciByZWNvcmRJZCA9IHNlbGYuZ2V0UXVlcnlTdHJpbmcoJ3JlY29yZElkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgaWYocmVjb3JkSWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgU29ja2V0LnNlbmRHZXRSZWNyb2RGcm9tSWQocmVjb3JkSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB2YXIgcm9vbUlkID0gc2VsZi5nZXRRdWVyeVN0cmluZyhcInJvb21JZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICBpZihyb29tSWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighZGF0YS5lcnJjb2RlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VuZExvZ2luUmVxdWVzdChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZ2V0X0hSRUYocm9vbUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoaW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpe1xuICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYoIWRhdGEgfHwgZGF0YS5lcnJjb2RlKXtcbiAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2luRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2luQWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBzZWxmLmdldFF1ZXJ5U3RyaW5nKFwiY29kZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByb29tSWQgPSBzZWxmLmdldFF1ZXJ5U3RyaW5nKFwicm9vbUlkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHJvb21JZCApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFkYXRhLmVycmNvZGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbmRMb2dpblJlcXVlc3QoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyhcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2dldF9IUkVGKHJvb21JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGNvZGUgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsgIC8vIFhNTEh0dHBSZXF1ZXN05a+56LGh55So5LqO5Zyo5ZCO5Y+w5LiO5pyN5Yqh5Zmo5Lqk5o2i5pWw5o2uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBcIi4vZ2V0X3Rva2VuLnBocFwiOyAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLm9wZW4oXCJQT1NUXCIsIHVybCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC10eXBlXCIsIFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIpOyAgLy8g5re75YqgaHR0cOWktO+8jOWPkemAgeS/oeaBr+iHs+acjeWKoeWZqOaXtuWGheWuuee8lueggeexu+Wei1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5yZWFkeVN0YXRlID09IDQgJiYgKG9iai5zdGF0dXMgPT0gMjAwIHx8IG9iai5zdGF0dXMgPT0gMzA0KSkgeyAgLy8gMzA05pyq5L+u5pS5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQob2JqLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZSggb2JqLnJlc3BvbnNlVGV4dCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighZGF0YS5lcnJjb2RlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oIG9iai5yZXNwb25zZVRleHQgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VuZExvZ2luUmVxdWVzdCggZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmouc2VuZChcImNvZGU9XCIrY29kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfWNhdGNoKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LDAuNSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIC8vfVxuICAgIH0sXG4gICAga2V5QmFja0xpc3RlbjpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGNjLnN5c3RlbUV2ZW50Lm9uKGNjLlN5c3RlbUV2ZW50LkV2ZW50VHlwZS5LRVlfRE9XTixmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT0gY2MuS0VZLmJhY2spIHtcbiAgICAgICAgICAgICAgICBpZighS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSl7XG4gICAgICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJiYWNrVG9EZXNrXCIsIFwiKClWXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSx0aGlzKTtcbiAgICB9LFxuICAgIC8v6ZqP5py655Sf5oiQIG51bSDkvY0g55qE6ZqP5py65pWwIOWQq+Wkp+Wwj+WGmeWtl+avjeWPiuaVsOWtl1xuICAgIGdldFJhbmRvbUFjY291bnQ6ZnVuY3Rpb24obnVtKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOi/lOWbnuS4gOS4quWtl+avjVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q2hhcmFjdGVyKGZsYWcpe1xuICAgICAgICAgICAgdmFyIGNoYXJhY3RlciA9IFwiXCI7XG4gICAgICAgICAgICBpZihmbGFnID09PSBcImxvd2VyXCIpe1xuICAgICAgICAgICAgICAgIGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoTWF0aC5mbG9vciggTWF0aC5yYW5kb20oKSAqIDI2KSArIFwiYVwiLmNoYXJDb2RlQXQoMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoZmxhZyA9PT0gXCJ1cHBlclwiKXtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKE1hdGguZmxvb3IoIE1hdGgucmFuZG9tKCkgKiAyNikgKyBcIkFcIi5jaGFyQ29kZUF0KDApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjaGFyYWN0ZXI7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3RyID0gXCJcIjtcbiAgICAgICAgZm9yKHZhciBpPTA7aTxudW07aSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgZmxhZyA9IFwibG93ZXJcIiA7XG4gICAgICAgICAgICB2YXIgcmFuZG9tID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyk7XG4gICAgICAgICAgICBpZihyYW5kb20gPT0gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmbGFnID0gXCJ1cHBlclwiIDtcbiAgICAgICAgICAgICAgICBzdHIgKz0gZ2V0Q2hhcmFjdGVyKGZsYWcpO1xuICAgICAgICAgICAgfWVsc2UgaWYocmFuZG9tID09IDEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RyICs9IGdldENoYXJhY3RlcihmbGFnKTtcbiAgICAgICAgICAgIH1lbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RyICs9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH0sXG4gICAgZ2V0R3Vlc3RVc2VySW5mbzpmdW5jdGlvbigpe1xuICAgICAgICBsZXQgc2VhcmNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcbiAgICAgICAgdmFyIG9wZW5pZCA9IFwiZ3Vlc3RfXCIgKyB0aGlzLmdldFJhbmRvbUFjY291bnQoOCk7XG4gICAgICAgIHZhciB1bmlvbmlkID0gJ2d1ZXN0XycgKyB0aGlzLmdldFJhbmRvbUFjY291bnQoOCk7XG4gICAgICAgIHZhciBuaWNrbmFtZSA9IHRoaXMuZ2V0UmFuZG9tQWNjb3VudCg4KTtcbiAgICAgICAgdmFyIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcbiAgICAgICAgcmV0dXJuIHRlc3REYXRhO1xuICAgIH0sXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMua2V5QmFja0xpc3RlbigpO1xuICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlICYmIGNjLnN5cy5pc01vYmlsZSl7XG4gICAgICAgICAgICB2YXIgY2FudmFzID0gY2MuZmluZChcIkNhbnZhc1wiKTtcbiAgICAgICAgICAgIHZhciBjdnMgPSBjYW52YXMuZ2V0Q29tcG9uZW50KGNjLkNhbnZhcyk7XG4gICAgICAgIH1cbiAgICAgICAgS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlci5zdGFydCgpO1xuICAgICAgICB0aGlzLnNvY2tldCA9IGNjLmZpbmQoJ0dhbWVTb2NrZXQnKS5nZXRDb21wb25lbnQoJ3NvY2tldCcpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMubG9naW5FbmFibGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zb2NrZXQucmVjZXZpY2VNZXNzYWdlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpXG4gICAgICAgICAgICBpZiAoZGF0YS5hY3Rpb24gPT0gJ2NoZWNrVmVyc2lvbicpIHtcbiAgICAgICAgICAgICAgdHJ5e1xuICAgICAgICAgICAgICAgIHNlbGYuY2hlY2tWZXJzaW9uKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgIH1jYXRjaChlKXtcbiAgICAgICAgICAgICAgICAvL3RoaXMuZXJyLnN0cmluZyA9IGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGEuYWN0aW9uID09ICdsb2dpbicpIHtcbiAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3VsdCkgey8v5oiQ5YqfXG4gICAgICAgICAgICAgICAgICAgc2VsZi5zb2NrZXQudXNlckluZm8gPSBkYXRhLmRhdGE7Ly/ov5DooYzml7bmgIHkv6Hmga9cbiAgICAgICAgICAgICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgcm9vbUlkID0gc2VsZi5nZXRRdWVyeVN0cmluZyhcInJvb21JZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHJvb21JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgaWYocm9vbUlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhLmRhdGEuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhpdEluUm9vbSA9IGRhdGEuZGF0YS5yb29tSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihleGl0SW5Sb29tICE9IFwiXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICByb29tSWQgPSBleGl0SW5Sb29tO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgU29ja2V0LnNlbmRMb2dpbkpvaW4ocm9vbUlkLCB1c2VySWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9sb2FkaW5nTGFiZWwoXCLnmbvlvZXkuK1cIik7XG4gICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZGF0YS5yb29tSWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAvLyBzZWxmLmFsZXJ0TWVzc2FnZSgn55m75b2V5aSx6LSlIScpO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyU29ja2V0RXZlbnQoKTtcblxuICAgICAgICB0aGlzLnNvY2tldC5nZXRXeEluZm8gPSBmdW5jdGlvbihpbmZvKSB7XG4gICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oaW5mbyk7Ly/kv53lrZjmnKzlnLBcbiAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pOy8vc3RyIC0+IGpzb24ob2JqKVxuICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbigpey8v5bu26L+f5omn6KGMIDFzXG4gICAgICAgICAgICAgICBzZWxmLnNlbmRMb2dpblJlcXVlc3QoZGF0YSk7Ly/nmbvlvZXor7fmsYJcbiAgICAgICAgICAgfSwxKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5nZXRPbmx5VXNlckluZm9CeUJyb3dzZXIoKTtcbiAgICAgICAgLy9jYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ1c2VyaW5mb1wiKTtcbiAgICAgICAgLy8gbGV0IHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG4gICAgICAgIC8vIHZhciBvcGVuaWQgPSBcIkp6SXdNVGN2Tmk4eE5pRGt1SXJsallneE1Nem93T0NjPVwiO1xuICAgICAgICAvLyB2YXIgdW5pb25pZCA9ICc4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9Mdic7XG4gICAgICAgIC8vIHZhciBuaWNrbmFtZSA9IFwi5ZOH5ZOI5ZOIXCI7XG5cblxuICAgICAgICAvL3ZhciBvcGVuaWQgPSBcIkp6SXdNVGN2Tmk4eE5pRGt1SXJsallneE1Nem93T0NjPVwiO1xuICAgICAgICAvL3ZhciBvcGVuaWQgPSBcImd1ZXN0X1wiICsgdGhpcy5nZXRSYW5kb21BY2NvdW50KDgpO1xuICAgICAgICAvL3ZhciB1bmlvbmlkID0gJzhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2JztcbiAgICAgICAgLy92YXIgdW5pb25pZCA9ICdndWVzdF8nICsgdGhpcy5nZXRSYW5kb21BY2NvdW50KDgpO1xuICAgICAgICAvL3ZhciBuaWNrbmFtZSA9IHRoaXMuZ2V0UmFuZG9tQWNjb3VudCg4KTtcblxuXG4gICAgICAgICAvL2lmIChzZWFyY2gpIHtcbiAgICAgICAgIC8vICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoO1xuICAgICAgICAgLy8gICAgdmFyIGxvYyA9IHVybC5zdWJzdHJpbmcodXJsLmxhc3RJbmRleE9mKCc9JykgKyAxLCB1cmwubGVuZ3RoKTtcbiAgICAgICAgIC8vICAgIGlmIChsb2MgPT0gMSkge1xuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdE5pMHhOaUF3T1RvME5UbzFPU2M9JztcbiAgICAgICAgIC8vICAgICAgICB1bmlvbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvMU9TYyc7XG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XG4gICAgICAgICAvLyAgICB9XG4gICAgICAgICAvLyAgICBlbHNlIGlmIChsb2MgPT0gMikge1xuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZzVPak00T2pNekp3PT0nO1xuICAgICAgICAgLy8gICAgICAgIHVuaW9uaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWc1T2pNNE9qTXpKdyc7XG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XG4gICAgICAgICAvLyAgICB9XG4gICAgICAgICAvLyAgICBlbHNlIGlmIChsb2MgPT0gMykge1xuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdE5pMHhOaUF3T1RvME5Ub2M9JztcbiAgICAgICAgIC8vICAgICAgICB1bmlvbmlkID0gJzhkT3RBY0RpYzVTaWNodjNseHRNWFltdW5UTE9Mdic7XG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XG4gICAgICAgICAvLyAgICB9XG4gICAgICAgICAvLyAgICBlbHNlIGlmIChsb2MgPT0gNCkge1xuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdvemxYSXdndl9RSlQweWtkVWloYUFCbXNXcDJBJztcbiAgICAgICAgIC8vICAgICAgICB1bmlvbmlkID0gJ28tMzkxMXFXc1FzVzN3VW9kcUZmVXRic0FlTmsnO1xuICAgICAgICAgLy8gICAgICAgIG5pY2tuYW1lID0gbG9jO1xuICAgICAgICAgLy8gICAgfVxuICAgICAgICAgLy8gICAgZWxzZSBpZiAobG9jID09IDUpIHtcbiAgICAgICAgIC8vICAgICAgICBvcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TURvd016b3dPQ2M9JztcbiAgICAgICAgIC8vICAgICAgICAgdW5pb25pZCA9ICdvLUp6SXdNVGN2Tmk4eE5pRGt1SXJsallneE1Eb3dNJztcbiAgICAgICAgIC8vICAgICAgICBuaWNrbmFtZSA9IGxvYztcbiAgICAgICAgIC8vICAgIH1lbHNlIGlmKGxvYyA9PSA2KXtcbiAgICAgICAgIC8vICAgICAgICBvcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TU16b2M9JztcbiAgICAgICAgIC8vICAgICAgICAgdW5pb25pZCA9ICdvLXpJd01UY3ZOaTh4TmlEa3VJcmwnO1xuICAgICAgICAgLy8gICAgICAgIG5pY2tuYW1lID0gbG9jO1xuICAgICAgICAgLy8gICAgfVxuICAgICAgICAgLy9cbiAgICAgICAgIC8vfVxuICAgICAgICAvLyB2YXIgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwiJytuaWNrbmFtZSsnXCIsXCJ1bmlvbmlkXCI6XCInK3VuaW9uaWQrJ1wiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC84RDhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2VFQ1QUZNNHphcUtFdGhaaWJ2OHhkV2tnak45WWI0QVFud3ZTdXJ6MjdVQjI5eHg4MVhPUnd4NTVYYW54cWN0ZERcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xuXG5cbiAgICAgICAgIC8vaWYgKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgLy8gICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XG4gICAgICAgICAvLyAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAvLyAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5bey5a2Y5pyJ6LSm5Y+3PT09PT0nKTtcbiAgICAgICAgIC8vICAgICAgICAvL3JldHVybjtcbiAgICAgICAgIC8vICAgIH1lbHNlXG4gICAgICAgICAvLyAgICB7XG4gICAgICAgICAvLyAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5paw6LSm5Y+3PT09PT0nKTtcbiAgICAgICAgIC8vICAgICAgICB2YXIgdXNlckluZm8gPSB0aGlzLmdldEd1ZXN0VXNlckluZm8oKTtcbiAgICAgICAgIC8vICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKHVzZXJJbmZvKTtcbiAgICAgICAgIC8vICAgIH1cbiAgICAgICAgIC8vfVxuICAgIH0sXG5cbiAgICBnZXRPbmx5VXNlckluZm9CeUJyb3dzZXI6ZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgdmFyIG9wZW5pZCA9IFwiXCI7XG4gICAgICAgIHZhciB1bmlvbmlkID0gXCJcIjtcbiAgICAgICAgdmFyIG5pY2tuYW1lID0gXCJcIjtcblxuICAgICAgICB2YXIgdGVzdERhdGEgPSBcIlwiO1xuICAgICAgICB2YXIgdXNlckluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XG5cbiAgICAgICAgbGV0IHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG4gICAgICAgIGlmKHVzZXJJbmZvLmxlbmd0aCA+IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIG9wZW5pZCA9IHVzZXJJbmZvLm9wZW5JZDtcbiAgICAgICAgICAgIHVuaW9uaWQgPSB1c2VySW5mby51bmlvbmlkO1xuICAgICAgICAgICAgbmlja25hbWUgPSB1c2VySW5mby5uaWNrbmFtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzZWFyY2gpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoO1xuICAgICAgICAgICAgdmFyIGxvYyA9IHVybC5zdWJzdHJpbmcodXJsLmxhc3RJbmRleE9mKCc9JykgKyAxLCB1cmwubGVuZ3RoKTtcbiAgICAgICAgICAgIGlmIChsb2MgPT0gMSkge1xuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdE5pMHhOaUF3T1RvME5UbzFPU2M9JztcbiAgICAgICAgICAgICAgICB1bmlvbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvMU9TYyc7XG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzFcIjtcbiAgICAgICAgICAgICAgICB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCInK25pY2tuYW1lKydcIixcInVuaW9uaWRcIjpcIicrdW5pb25pZCsnXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsb2MgPT0gMikge1xuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZzVPak00T2pNekp3PT0nO1xuICAgICAgICAgICAgICAgIHVuaW9uaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWc1T2pNNE9qTXpKdyc7XG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzJcIjtcbiAgICAgICAgICAgICAgICB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCInK25pY2tuYW1lKydcIixcInVuaW9uaWRcIjpcIicrdW5pb25pZCsnXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsb2MgPT0gMykge1xuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdE5pMHhOaUF3T1RvME5Ub2M9JztcbiAgICAgICAgICAgICAgICB1bmlvbmlkID0gJzhkT3RBY0RpYzVTaWNodjNseHRNWFltdW5UTE9Mdic7XG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzNcIjtcbiAgICAgICAgICAgICAgICB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCInK25pY2tuYW1lKydcIixcInVuaW9uaWRcIjpcIicrdW5pb25pZCsnXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsb2MgPT0gNCkge1xuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdvemxYSXdndl9RSlQweWtkVWloYUFCbXNXcDJBJztcbiAgICAgICAgICAgICAgICB1bmlvbmlkID0gJ28tMzkxMXFXc1FzVzN3VW9kcUZmVXRic0FlTmsnO1xuICAgICAgICAgICAgICAgIG5pY2tuYW1lID0gXCJndWVzdF80XCI7XG4gICAgICAgICAgICAgICAgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwiJytuaWNrbmFtZSsnXCIsXCJ1bmlvbmlkXCI6XCInK3VuaW9uaWQrJ1wiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC84RDhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2VFQ1QUZNNHphcUtFdGhaaWJ2OHhkV2tnak45WWI0QVFud3ZTdXJ6MjdVQjI5eHg4MVhPUnd4NTVYYW54cWN0ZERcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobG9jID09IDUpIHtcbiAgICAgICAgICAgICAgICBvcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TURvd016b3dPQ2M9JztcbiAgICAgICAgICAgICAgICAgdW5pb25pZCA9ICdvLUp6SXdNVGN2Tmk4eE5pRGt1SXJsallneE1Eb3dNJztcbiAgICAgICAgICAgICAgICBuaWNrbmFtZSA9IFwiZ3Vlc3RfNVwiO1xuICAgICAgICAgICAgICAgIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcbiAgICAgICAgICAgIH1lbHNlIGlmKGxvYyA9PSA2KXtcbiAgICAgICAgICAgICAgICBvcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TU16b2M9JztcbiAgICAgICAgICAgICAgICAgdW5pb25pZCA9ICdvLXpJd01UY3ZOaTh4TmlEa3VJcmwnO1xuICAgICAgICAgICAgICAgIG5pY2tuYW1lID0gXCJndWVzdF82XCI7XG4gICAgICAgICAgICAgICAgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwiJytuaWNrbmFtZSsnXCIsXCJ1bmlvbmlkXCI6XCInK3VuaW9uaWQrJ1wiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC84RDhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2VFQ1QUZNNHphcUtFdGhaaWJ2OHhkV2tnak45WWI0QVFud3ZTdXJ6MjdVQjI5eHg4MVhPUnd4NTVYYW54cWN0ZERcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICBpZih0ZXN0RGF0YSAmJiB0ZXN0RGF0YS5sZW5ndGggPiAwKVxuICAgICAgICAge1xuICAgICAgICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyh0ZXN0RGF0YSk7XG4gICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgIH0sXG4gICAgX3JlZ2lzdGVyU29ja2V0RXZlbnQ6ZnVuY3Rpb24oKXtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUxvZ2luSm9pbiwgdGhpcy5fTG9naW5Kb2luLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVJlY29yZElkLCB0aGlzLl9SZWNlaXZlUmVjb3JkSWQsIHRoaXMpO1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlTm9VaW9uaWQsIHRoaXMuX1JlY2VpdmVOb1Vpb25pZCwgdGhpcyk7XG4gICAgfSwgXG4gICAgX2dldF9IUkVGOmZ1bmN0aW9uKHJvb21JZCl7XG4gICAgICBpZihyb29tSWQgIT0gUk9PTUlEKXtcbiAgICAgICAgUk9PTUlEID0gcm9vbUlkO1xuICAgICAgICByb29tSWQgPSBcIiUzZnJvb21JZCUzZFwiK3Jvb21JZCA7XG4gICAgICAgIFJFRElSRUNUX1VSSSA9IFJFRElSRUNUX1VSSStyb29tSWQ7XG4gICAgICAgIEhSRUYgPSBcImh0dHBzOi8vb3Blbi53ZWl4aW4ucXEuY29tL2Nvbm5lY3Qvb2F1dGgyL2F1dGhvcml6ZT9hcHBpZD1cIitBUFBJRCtcIiZyZWRpcmVjdF91cmk9XCIrUkVESVJFQ1RfVVJJK1wiJnJlc3BvbnNlX3R5cGU9Y29kZSZzY29wZT1zbnNhcGlfdXNlcmluZm8mc3RhdGU9U1RBVEUjd2VjaGF0X3JlZGlyZWN0XCI7XG4gICAgICB9XG4gICAgfSxcbiAgICBfUmVjZWl2ZU5vVWlvbmlkOmZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oXCJcIik7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB2YXIgcm9vbUlkID0gdGhpcy5nZXRRdWVyeVN0cmluZyhcInJvb21JZFwiKTtcbiAgICAgIGlmKHJvb21JZCl7XG4gICAgICAgIC8vcm9vbUlkID0gXCIlM2Zyb29tSWQlM2RcIityb29tSWQgO1xuICAgICAgICAvL1JFRElSRUNUX1VSSSA9IFJFRElSRUNUX1VSSStyb29tSWQ7XG4gICAgICAgIHRoaXMuX2dldF9IUkVGKHJvb21JZCk7XG4gICAgICB9XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIHNlbGYubG9hZGluZ05vZGUucGFyZW50LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBzZWxmLmxvYWRpbmdOb2RlLnN0b3BBbGxBY3Rpb25zKCk7XG4gICAgICB9LDIwMDApXG4gICAgICB0aGlzLl9sb2FkaW5nTGFiZWwoXCLnmbvlvZXlpLHotKXvvIzor7fph43mlrDnmbvlvZVcIik7XG4gICAgfSxcbiAgICBfUmVjZWl2ZVJlY29yZElkOmZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICBpZihkYXRhLnJlY29yZE1zZy5sZW5ndGg+MCl7XG4gICAgICAgICAgdmFyIHJlY29yZCA9IGRhdGEucmVjb3JkTXNnWzBdO1xuICAgICAgICAgIHZhciBwbGF5ZXJzSW5mbyA9IEpTT04ucGFyc2UocmVjb3JkLnBsYXllcnNJbmZvKS5wbGF5ZXJzO1xuICAgICAgICAgIHZhciByZWNvcmROb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy5yZWNvcmRJbmZvKTtcbiAgICAgICAgICBsZXQgdG90YWxHYW1lUmVzdWx0ID0gcmVjb3JkTm9kZS5nZXRDb21wb25lbnQoXCJUb3RhbEdhbWVSZXN1bHRcIik7XG4gICAgICAgICAgcGxheWVyc0luZm8uc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBiLnRvdGFsU2NvcmUtYS50b3RhbFNjb3JlfSk7ICAvLyDmjpLluo9cbiAgICAgICAgICB0b3RhbEdhbWVSZXN1bHQuc2V0UGxheWVySW5mb3MocGxheWVyc0luZm8scmVjb3JkKTtcbiAgICAgICAgICB0b3RhbEdhbWVSZXN1bHQuX2NsaWNrQnRuKCk7XG4gICAgICAgICAgcmVjb3JkTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQocmVjb3JkTm9kZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIF9Mb2dpbkpvaW46IGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgdGhpcy5fbG9hZGluZ0xhYmVsKFwi6L+b5YWl5oi/6Ze077yM5q2j5Zyo5Li65oKo6K+35rGC5pWw5o2uXCIpO1xuICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0KXtcbiAgICAgICAgICAgIGlmKGNjLmZyb20gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNjLmZyb20gPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSByZXNwb25zZS5kYXRhLm1hUGFpO1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYy5qb2luRGVzayA9IHt9O1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgICAgICAgICBsZXQgcmVhc29uSW5mbyA9IHRoaXMuX2pvaW5SZWFzb25NYXAocmVzcG9uc2UuZGF0YS5yZWFzb24pO1xuICAgICAgICAgICAgY2Muam9pbkRlc2sucmVzdWx0ID0gcmVzcG9uc2UucmVzdWx0O1xuICAgICAgICAgICAgY2Muam9pbkRlc2sucmVhc29uID0gcmVhc29uSW5mbztcbiAgICAgICAgfVxuICAgIH0sXG4gICAgX2pvaW5SZWFzb25NYXA6IGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIGxldCByZWFzb25JbmZvID0ge1xuICAgICAgICBub3RFeGlzdDogXCLmiL/pl7TkuI3lrZjlnKghXCIsXG4gICAgICAgIGNhcmROdW1iZXI6IFwi5oKo5oi/5Y2h5LiN6LazIVwiLFxuICAgICAgfTtcbiAgICAgIGxldCBpbmZvID0gcmVhc29uSW5mb1tyZWFzb25dIHx8IFwi5oi/6Ze05bey5ruhIVwiO1xuICAgICAgcmV0dXJuIGluZm87XG4gICAgfSxcblxuICAgIGdldFF1ZXJ5U3RyaW5nOiBmdW5jdGlvbihuYW1lKXtcbiAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoXnwmKVwiICsgbmFtZSArIFwiPShbXiZdKikoJnwkKVwiLCBcImlcIik7IFxuICAgICAgICB2YXIgciA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEpLm1hdGNoKHJlZyk7IFxuICAgICAgICBpZiAociAhPSBudWxsKSByZXR1cm4gdW5lc2NhcGUoclsyXSk7IHJldHVybiBudWxsOyBcbiAgICB9LFxuXG4gICAgYWdyZWVtZW50czogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmFncmVlbWVudE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgLy90aGlzLmFncmVlbWVudExhYmVsLnN0cmluZyA9IGNjLmluZm8xO1xuICAgICAgICB0aGlzLmFncmVlbWVudExhYmVsLm5vZGUueSA9IDA7XG4gICAgfSxcblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5zb2NrZXQucmVjZXZpY2VNZXNzYWdlID0gZnVuY3Rpb24gKCkge307XG4gICAgfSxcblxuICAgIF9sb2FkaW5nTGFiZWw6ZnVuY3Rpb24obGFiZWwpe1xuICAgICAgICB0aGlzLmxhYmVsLnN0cmluZyA9IGxhYmVsO1xuICAgIH0sXG5cbiAgICBzZW5kTG9naW5SZXF1ZXN0OmZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn55m75b2V5LitLi4uJyk7XG4gICAgICAgIHRoaXMubG9hZGluZ05vZGUucGFyZW50LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMubG9hZGluZ05vZGUucnVuQWN0aW9uKGNjLnJlcGVhdEZvcmV2ZXIoY2Mucm90YXRlQnkoMiwgMzYwKSkpO1xuICAgICAgICAvL3JldHVybjtcbiAgICAgICAgdGhpcy5zb2NrZXQuc2VuZE1lc3NhZ2UoJ2xvZ2luJyxkYXRhKTtcbiAgICB9LFxuXG4gICAgbG9naW5BY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIC8vdGhpcy5zaG93V2FpdGluZ01lc3NhZ2UoJ+W3suWtmOaciei0puWPtz09PT09Jyk7XG4gICAgICAgICAgICAgICAgLy9yZXR1cm47XG4gICAgICAgICAgICB9ZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vdGhpcy5zaG93V2FpdGluZ01lc3NhZ2UoJ+aWsOi0puWPtz09PT09Jyk7XG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJbmZvID0gdGhpcy5nZXRHdWVzdFVzZXJJbmZvKCk7XG4gICAgICAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyh1c2VySW5mbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgaW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcbiAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShpbmZvKTtcbiAgICAgICAgICB0aGlzLnNlbmRMb2dpblJlcXVlc3QoZGF0YSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgIC8vIGNjLnN5cy5vcGVuVVJMKEhSRUYpO1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBIUkVGO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eExvZ2luXCIpOy8vSU9TXG4gICAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZFxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4TG9naW5cIiwgXCIoKVZcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH0sXG5cbiAgICBjaGFuZ2VHdWVzdFVzZXJJbmZvOmZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oJycpO1xuICAgICAgICB0aGlzLmxvZ2luQWN0aW9uKCk7XG4gICAgfSxcblxuICAgIGxvZ2luWWtBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vdmFyIGNvbXAgPSB0aGlzLnNlbGVjdE5vZGUuZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcbiAgICAgICAgLy9pZiAoIWNvbXAuc2VsZWN0ZWQpIHtcbiAgICAgICAgLy8gICAgdGhpcy5zaG93TXNnID0gY2MuaW5zdGFudGlhdGUodGhpcy5hbGVydFByZWZhYik7XG4gICAgICAgIC8vICAgIHRoaXMuY2FudmFzTm9kZS5hZGRDaGlsZCh0aGlzLnNob3dNc2cpO1xuICAgICAgICAvLyAgICBsZXQgY29tcCA9IHRoaXMuc2hvd01zZy5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIC8vICAgIGNvbXAuc2V0TWVzc2FnZSgn6K+35ZCM5oSP55So5oi35Y2P6K6uJyk7XG4gICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgLy99XG4gICAgICAgIHZhciB0ZXN0RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHZhciB0aW1lID0gXCInXCIrdGVzdERhdGUudG9Mb2NhbGVTdHJpbmcoKStcIidcIjtcbiAgICAgICAgdmFyIG9wZW5pZCA9IG5ldyBCdWZmZXIodGltZSkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICAgICAgICB2YXIgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwi5ri45a6iXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcL0JWeXo0UjhxNnB1SmliRXYxaHJzYVRtSUtRaGthVFM5Rnl2Y2V2dkM1aGx4Rm5mT3VzcERqaWNHMEd0enlKWE9oTlQ3ZzFXWkRlQ0RRaG5SZEVPZ3ozUU1uUDBGOWlib1FHeVxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZSh0ZXN0RGF0YSk7XG4gICAgICAgIHRoaXMuc2VuZExvZ2luUmVxdWVzdChkYXRhKTtcblxuICAgIH0sXG5cbiAgICBzaG93V2FpdGluZ01lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIGlmICh0aGlzLndhaXRpbmdOb2RlICE9IG51bGwgJiYgY2Muc3lzLmlzTmF0aXZlICYmIGNjLmlzVmFsaWQodGhpcy53YWl0aW5nTm9kZSkpIHtcbiAgICAgICAgICBpZiAobXNnID09IHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmdldE1lc3NhZ2UoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUucmVtb3ZlRnJvbVBhcmVudCgpO1xuICAgICAgICAgICAgdGhpcy53YWl0aW5nTm9kZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53YWl0aW5nTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XG4gICAgICAgIHRoaXMuY2FudmFzTm9kZS5hZGRDaGlsZCh0aGlzLndhaXRpbmdOb2RlKTtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLndhaXRpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjb21wKTtcblxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICBoaWRkZW5XYWl0aW5nTWVzc2FnZTpmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy53YWl0aW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHByb3RvY29sQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICBjYy5sb2coJ3Byb3RvY29sIGFjdGlvbicpO1xuICAgIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbWFQYWlTcHJpdGU6W2NjLlNwcml0ZUZyYW1lXSxcclxuICAgICAgICBzcHJpdGVOb2RlOmNjLlNwcml0ZSxcclxuICAgICAgICBsYWJlbE5vZGU6Y2MuTm9kZVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICBcclxufSk7XHJcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xuICAgIHZlcnNpb246J3YxLjAuMCcsXG5cbiAgICBzZXRVc2VySW5mbzpmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyaW5mbycsIHN0cik7XG4gICAgfSxcblxuICAgIGdldFVzZXJJbmZvOmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJpbmZvJyk7XG4gICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuXG4gICAgc2V0TXVzaWNWYWx1ZTpmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ211c2ljVm9sdW1uJyx2YWx1ZSk7XG4gICAgfSxcblxuICAgIGdldE11c2ljVmFsdWU6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbXVzaWNWb2x1bW4nKTtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBzZXRNdXNpY0VmZmVjdFZhbHVlOmZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbXVzaWNFZmZlY3RWb2x1bW4nLHZhbHVlKTtcbiAgICB9LFxuXG4gICAgZ2V0TXVzaWNFZmZlY3RWYWx1ZTpmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdtdXNpY0VmZmVjdFZvbHVtbicpO1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbn07XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBub2RlczpbY2MuTm9kZV0sXG4gICAgICAgIC8vc2VsZWN0ZWRJbmRleDogMCxcbiAgICAgICAgIF9zZWxlY3RlZDoxLFxuICAgIH0sXG5cbiAgICAvKiMjIyMqL1xuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3NlbGVjdCA9IHRydWU7IFxuICAgICAgICB2YXIgb3ZlclRpbWUgPSAwO1xuICAgICAgICBpZihjYy5zZXQpe1xuICAgICAgICAgICAgb3ZlclRpbWUgPSBjYy5zZXQuc2V0dGluZzY7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RlZCA9IHRoaXMuX3NlbGVjdCA9IG92ZXJUaW1lO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhY3RpdmUgPSB0aGlzLl9zZWxlY3Q7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RlZCA9IHRoaXMuX3NlbGVjdDtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKS5zZXRTZWxlY3RlZChhY3RpdmUpO1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gdGhpcy5ub2Rlc1tpXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcbiAgICAgICAgICAgIGlmKCBzZWxmLl9zZWxlY3QgKXtcbiAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRDb21wID0gdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgdENvbXAuaW5kZXggPSBpO1xuICAgICAgICAgICAgdENvbXAuY2xpY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKCBzZWxmLl9zZWxlY3RlZCA9IHNlbGYuX3NlbGVjdCA9ICFzZWxmLl9zZWxlY3QgKTtcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0aXRsZVwiKTtcbiAgICAgICAgICAgICAgICBpZiggc2VsZi5fc2VsZWN0ICl7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYub25TZWxlY3RDaGFuZ2UodGhpcy5pbmRleCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJvcmRlcnNcIiAmJiBjYy5zZXQpe1xuICAgICAgICAgICAgLy90aGlzLnJlbWVtYmVyX3NldChvdmVyVGltZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHJlbWVtYmVyX3NldDpmdW5jdGlvbihvYmope1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jykuc2V0U2VsZWN0ZWQob2JqKTtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJykuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgaWYoIG9iaiApe1xuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMubm9kZXNbMF0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XG4gICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25TZWxlY3RDaGFuZ2U6IGZ1bmN0aW9uIChzZWxlY3RJbmRleCkge1xuICAgICAgICAvL2NjLmxvZyhzZWxlY3RJbmRleCk7XG4gICAgfSxcbiAgICBcbn0pO1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XHJcbmNvbnN0IEFycmF5RXh0ZW5zaW9uID0gcmVxdWlyZSgnQXJyYXlFeHRlbnNpb24nKTtcclxuY29uc3QgTWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcclxuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XHJcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcclxuY29uc3QgVXNlck1vZGVsSGVscGVyID0gcmVxdWlyZSgnVXNlck1vZGVsSGVscGVyJyk7XHJcbmNvbnN0IFBsYXliYWNrID0gcmVxdWlyZSgnUGxheWJhY2snKTtcclxuY29uc3QgZmVjaGEgPSByZXF1aXJlKCdmZWNoYScpO1xyXG52YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcclxuLyojIyMjIyovXHJcbmNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xyXG4vKiovXHJcbmNvbnN0IFBsYXllciA9IHJlcXVpcmUoJ1BsYXllcicpO1xyXG4vKiovXHJcbi8vY29uc3QgaXNUZVNodVBhaSA9IHJlcXVpcmUoJ2lzVGVTaHVQYWknKTsgXHJcbi8v54m55q6K54mM57G75Z6LXHJcbnZhciBURVNIVVBBSVRZUEUgPSB7XHJcbiAgICBpc1RlU2h1UGFpOmZhbHNlLFxyXG4gICAgaXNMaXVEdWlCYW46ZmFsc2UsXHJcbiAgICBpc1NhblNodW5aaTpmYWxzZSxcclxuICAgIGlzU2FuVGFvSHVhOmZhbHNlLFxyXG5cclxuICAgIGlzUWluZ0xvbmc6ZmFsc2UsXHJcbiAgICBpc1lpVGlhb0xvbmc6ZmFsc2UsXHJcbiAgICBpc1NhblRvbmdIdWFTaHVuOmZhbHNlLFxyXG4gICAgaXNTYW5GZW5UaWFuWGlhOmZhbHNlLFxyXG4gICAgaXNDb3VZaVNlOmZhbHNlLFxyXG4gICAgaXNTaVRhb1NhblRpYW86ZmFsc2UsXHJcbiAgICBpc1d1RHVpU2FuVGlhbzpmYWxzZVxyXG59O1xyXG5cclxubGV0IEdBTUVTVEFUVVMgPSB7XHJcbiAgICBXQUlUX1BFT1BMRTogMCwgICAgLy8g562J5Lq6XHJcbiAgICBXQUlUX1JFQURZOiAxLCAgICAgLy8g562J5b6F5LuW5Lq65YeG5aSHXHJcbiAgICBQTEFZSU5HOiAyLCAgICAgICAgLy8g5q2j5Zyo546p5ri45oiPXHJcbn07XHJcbnZhciBzVGl0bGUgPSAnJztcclxudmFyIHNEZXNjcmlwdGlvbiA9ICcnO1xyXG52YXIgc0lkID0gJyc7XHJcbi8vIOW4g+WxgFxyXG4vLyAgICAgICAgICAyXHJcbi8vICAgMyAgICAgICAgICAgIDFcclxuLy8gICAgIHNlbGYgMFxyXG5sZXQgUGxheSA9IGNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgcGxheWVyTm9kZXM6IFtjYy5Ob2RlXSxcclxuICAgICAgICAvL3BsYXlzQ29pbnM6IFtjYy5Ob2RlXSxcclxuICAgICAgICBjaGF0Tm9kZTogY2MuTm9kZSxcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmVOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIHR5cGVCdXR0b25zTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBwaG9uZTpjYy5MYWJlbCxcclxuICAgICAgICBsYWJlbFJvb21OdW1iZXI6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxhYmVsT3ZlcnZpZXc6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxhYmVsUmVtYWluVGltZTogY2MuTGFiZWwsXHJcbiAgICAgICAgYnRuU2hhcmU6IGNjLkJ1dHRvbixcclxuICAgICAgICBidG5SZWFkeTogY2MuQnV0dG9uLCAgICAgICAgICAgIC8vIOWHhuWkh+aMiemSrlxyXG4gICAgICAgIGJ0blN0YXJ0R2FtZTogY2MuQnV0dG9uLCAgICAgICAgLy8g5byA5aeL5oyJ6ZKuXHJcbiAgICAgICAgYmVpbHY6Y2MuTm9kZSwgICAgICAgICAgICAgICAgICAvLyDpgInmi6nlgI3njofoioLngrlcclxuICAgICAgICBidG5DaGF0Vm9pY2U6IGNjLkJ1dHRvbixcclxuICAgICAgICBidG5DaGF0VGV4dDogY2MuQnV0dG9uLFxyXG4gICAgICAgIGFnYWluQnRuOmNjLk5vZGUsXHJcblxyXG4gICAgICAgIHN0YXJ0Q29tcGFyZUNhcmRzTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBzZXR0aW5nTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBWb2ljZU1zZ0JnOmNjLk5vZGUsXHJcbiAgICAgICAgZXhpdDpjYy5Ob2RlLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDnprvlvIDmiL/pl7ToioLngrlcclxuICAgICAgICBEaXNzb2x2ZTpjYy5Ob2RlLCAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOino+aVo+aIv+mXtOiKgueCuVxyXG4gICAgICAgIHNoYXJlQmc6Y2MuTm9kZSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5YiG5Lqr6IOM5pmvXHJcbiAgICAgICAgdG90YWxHYW1lUmVzdWx0OiBjYy5Ob2RlLCAgICAgICAgICAgICAgICAgICAvLyDnu5PmnpzoioLngrlcclxuICAgICAgICBhbGVydFJlcXVlc3RFeGl0Tm9kZTogY2MuTm9kZSwgICAgICAgICAgICAgIC8vIOeUs+ivt+mAgOWHuiBOb2RlXHJcbiAgICAgICAgZGlzc29sdmVBbHRlcjogY2MuTm9kZSwgICAgICAgICAgICAgICAgICAgICAvLyDnlLPor7fpgIDlh7ogTm9kZVxyXG4gICAgICAgIGFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlOiBjYy5Ob2RlLCAgICAgLy8g55Sz6K+36YCA5Ye65YCS6K6h5pe2IE5vZGVcclxuICAgICAgICBhbGVydEFuc293ZXJFeGl0Tm9kZTogY2MuTm9kZSwgICAgICAgICAgICAgIC8vIOWbnuetlOeUs+ivt+mAgOWHuiAgTm9kZVxyXG4gICAgICAgIGNvbnRlbnRBbnNvd2VyRXhpdE5vZGU6IGNjLk5vZGUsICAgICAgICAgICAgLy8g5Zue562U55Sz6K+36YCA5Ye65aS05YOPICBOb2RlXHJcbiAgICAgICAgYWxlcnRBbnNvd2VyRXhpdFJlc3VsdDogY2MuTm9kZSwgICAgICAgICAgICAvLyDlm57nrZTnlLPor7fpgIDlh7rnu5PmnpwgIE5vZGVcclxuICAgICAgICBhbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZTogY2MuTm9kZSwgICAgIC8vIOWbnuetlOS7peS4iuivt+mAgOWHuueahOWAkuiuoeaXtlxyXG4gICAgICAgIENvdW50ZG93bjpjYy5Ob2RlLCAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5YCS6K6h5pe2XHJcbiAgICAgICAgbGFiZWxUaW1lOmNjLkxhYmVsLFxyXG4gICAgICAgIG5lZWRDYXJkOmNjLkxhYmVsLFxyXG4gICAgICAgIGFsZXJ0OiBjYy5Ob2RlLFxyXG4gICAgICAgIGNvaW5zQ29udGFpbmVyTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBidG5BbGVydFJlcXVlc3RFeGl0Q29uZmlybUJ1dHRvbjogY2MuQnV0dG9uLFxyXG4gICAgICAgIGJ0bkFsZXJ0UmVxdWVzdEV4aXRDYW5jZWxCdXR0b246IGNjLkJ1dHRvbixcclxuXHJcbiAgICAgICAgYXV0b1Rpc2hpOmNjLlByZWZhYixcclxuICAgICAgICB3YWl0aW5nUHJlZmFiOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgY29pbnNQcmVmYWI6IGNjLlByZWZhYixcclxuICAgICAgICBwbGF5ZXJDb21wczogW1BsYXllcl0sXHJcblxyXG4gICAgICAgIGdvbmdYaU5pOmNjLk5vZGUsXHJcbiAgICAgICAgdGVTaHVQYWk6Y2MuTm9kZSxcclxuXHJcbiAgICAgICAgY2FyZFNwcml0ZUF0bGFzOmNjLlNwcml0ZUF0bGFzLFxyXG4gICAgICAgIGRhb1Nwcml0ZUF0bGFzOmNjLlNwcml0ZUF0bGFzLFxyXG5cclxuICAgICAgICBfbGl1RHVpQmFuOmZhbHNlLFxyXG4gICAgICAgIF9zYW5TaHVuWmk6ZmFsc2UsXHJcbiAgICAgICAgX3NhblRvbmdIdWE6ZmFsc2UsXHJcbiAgICAgICAgX3lpVGlhb0xvbmc6ZmFsc2UsXHJcblxyXG4gICAgICAgIF9RaW5nTG9uZzpmYWxzZSxcclxuICAgICAgICBfU2FuVG9uZ0h1YVNodW46ZmFsc2UsXHJcbiAgICAgICAgX1NhbkZlblRpYW5YaWE6ZmFsc2UsXHJcbiAgICAgICAgX0NvdVlpU2U6ZmFsc2UsXHJcbiAgICAgICAgX1NpVGFvU2FuVGlhbzpmYWxzZSxcclxuICAgICAgICBfV3VEdWlTYW5UaWFvOmZhbHNlLFxyXG5cclxuICAgICAgICBfcGxheWVyQ29tcG9uZW50czogbnVsbCxcclxuICAgICAgICBfbXNnQ29udHJvbDogbnVsbCxcclxuICAgICAgICBfbm93VGltZUFnYWluOjAsXHJcblxyXG4gICAgICAgIF9zb2NrZXQ6IG51bGwsXHJcbiAgICAgICAgX3VzZXJJZDogMCxcclxuICAgICAgICBfcGxheWVySW5mb3M6IG51bGwsXHJcbiAgICAgICAgX2Rlc2tJbmZvOiBudWxsLCAgIC8vIGNyZWF0ZVRpbWUg5Yib5bu65pe26Ze0ICBpc0Rpc3NvbHZpbmcg6KGo56S65piv5ZCm5q2j5Zyo6Kej5pWjIGRpc3NvbHZlTGVmdFRpbWUg56a76Kej5pWj5Ymp5L2Z5aSa6ZW/5pe26Ze0IGRpc3NvbHZlQW5zd2VySW5mbyBb5aSE55CG6L+H55qE5Lq655qE5L+h5oGvXVxyXG4gICAgICAgIF9nYW1lU3RhdHVzOiBHQU1FU1RBVFVTLldBSVRfUEVPUExFLFxyXG4gICAgICAgIF9lbnRlclRpbWU6IG51bGwsXHJcbiAgICAgICAgX2JpZ1JlY29yZEluZm86bnVsbCxcclxuICAgICAgICBfcGxheWVyczpudWxsLFxyXG4gICAgICAgIC8qKi9cclxuICAgICAgICBfaXNDb21wYXJpbmdDYXJkc05vdzogZmFsc2UsIC8vIOaYr+WQpuato+WcqOavlOeJjFxyXG4gICAgICAgIF9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHM6IFtdLCAvLyDlt7Lnu4/mkq3mlL7ov4fmr5TniYznmoTlsYDmlbBcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgZmFwYWlOb2RlOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgbGl1ZHVpYmFuOmNjLlByZWZhYixcclxuICAgICAgICBzYW50b25naHVhOmNjLlByZWZhYixcclxuICAgICAgICBzYW5zaHVuemk6Y2MuUHJlZmFiLFxyXG4gICAgICAgIHF1YW5sZWlkYTpjYy5QcmVmYWIsXHJcbiAgICB9LFxyXG4gICAga2V5QmFja0xpc3RlbjpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX0RPV04sZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT0gY2MuS0VZLmJhY2spIHtcclxuICAgICAgICAgICAgICAgIGlmKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKXtcclxuICAgICAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiYmFja1RvRGVza1wiLCBcIigpVlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sdGhpcyk7XHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmtleUJhY2tMaXN0ZW4oKTtcclxuICAgICAgICB0aGlzLmhlYWRDYXJkVGltZSA9IDAuODU7XHJcbiAgICAgICAgdmFyIGJnID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicm9vbV9iZ1wiKTtcclxuICAgICAgICB2YXIgd2luZG93UCA9IGNjLmRpcmVjdG9yLmdldFdpblNpemVJblBpeGVscygpO1xyXG4gICAgICAgIHZhciBzY2FsZVggPSB3aW5kb3dQLndpZHRoL2JnLndpZHRoO1xyXG4gICAgICAgIHZhciBzY2FsZVkgPSB3aW5kb3dQLmhlaWdodC9iZy5oZWlnaHQ7XHJcbiAgICAgICAgdmFyIHNjYWxlID0gTWF0aC5tYXgoc2NhbGVYLHNjYWxlWSk7XHJcbiAgICAgICAgYmcuc2NhbGVYID0gc2NhbGU7XHJcbiAgICAgICAgYmcuc2NhbGVZID0gc2NhbGU7XHJcblxyXG4gICAgICAgIHRoaXMuQnRuQ2xpY2tHb25nWGlOaUNvbWZpcm0gPSB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuZ2V0Q29tcG9uZW50KFwiQ2FyZFR5cGVDb21iaW5lXCIpLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtO1xyXG4gICAgICAgIHRoaXMuX2VudGVyVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMucGxheWVyQ29tcHMuZm9yRWFjaChwbGF5ZXJDb21wID0+IHtcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMgPSB0aGlzLl9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHM7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIC8qQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlEZXNrTXVzaWMoKTsqL1xyXG5cclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2Uuc3RvcEhhbGxNdXNpYygpO1xyXG4gICAgICAgIHZhciBiZ1NvdW5kID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdTb3VuZFwiKTtcclxuICAgICAgICBpZihiZ1NvdW5kID09IDApe1xyXG4gICAgICAgICAgICB2YXIgYXVkaW9NYW5hZ2VyID0gY2MuZmluZCgnQXVkaW9NYW5hZ2VyJyk7XHJcbiAgICAgICAgICAgIGF1ZGlvTWFuYWdlciA9IGF1ZGlvTWFuYWdlci5nZXRDb21wb25lbnQoJ0F1ZGlvTWFuYWdlcicpO1xyXG4gICAgICAgICAgICBhdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bShiZ1NvdW5kKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX2luaXRQbGF5ZXJDb21wb25lbnRzKCk7XHJcbiAgICAgICAgdGhpcy5faW5pdFNlbGVjdENhcmROb2RlKCk7XHJcbiAgICAgICAgdGhpcy5faW5pdE9uZUdhbWVSZXN1bHQoKTtcclxuICAgICAgICB0aGlzLl9yZW1haW5UaW1lU3RhcnRVcGRhdGUoKTtcclxuXHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuX21zZ0NvbnRyb2wgPSB0aGlzLmNoYXROb2RlLmdldENvbXBvbmVudCgnTXNnQ29udHJvbCcpO1xyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcclxuICAgICAgICB0aGlzLmJlaWx2LmdldENvbXBvbmVudChcInNlbGVjdGJlaWx2XCIpLl91c2VyaWQgPSB0aGlzLl91c2VySWQ7XHJcbiAgICAgICAgLy90aGlzLnNldHRpbmdOb2RlLmdldENvbXBvbmVudChcIlNldHRpbmdcIikuaGlkZVN3aXRjaCgpO1xyXG4gICAgICAgIHRoaXMubGFiZWxSb29tTnVtYmVyLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJWb2ljZU5vZGVFdmVudHMoKTtcclxuICAgICAgICB0aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XHJcblxyXG4gICAgICAgIFBsYXkuaW5zdGFuY2VzID0gdGhpcztcclxuICAgICAgICB0aGlzLl9nb25nWGlOaVNob3coZmFsc2UpO1xyXG4gICAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc0NvbnRhaW5QbGF5YmFja0RhdGFzKCkpIHtcclxuICAgICAgICAgICAgUGxheWJhY2suaW5zdGFuY2Uuc3RhcnRQbGF5YmFjaygpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXliYWNrTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmJ0bkNoYXRWb2ljZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL3RoaXMuY2FyZHNGcm9tQXJyYXkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9sb2FkRGVza0luZm8oKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB0aGlzLl9zb2NrZXQgPSBTb2NrZXQuaW5zdGFuY2U7XHJcblxyXG5cclxuICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ2hhbGwnLGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLnByZWxvYWRTY2VuZSgnbG9naW4nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY2MuY2xpY2tPdXQgPSBmYWxzZTtcclxuICAgICAgICAvL3RoaXMudGltZVN0YXJ0KDUpO1xyXG4gICAgfSxcclxuXHJcbiAgICB0aW1lU3RhcnQ6IGZ1bmN0aW9uIChkdXJhdGlvbixhY3Rpb24pIHtcclxuICAgICAgICBjYy5hc3NlcnQoZHVyYXRpb24gPiAwKTtcclxuICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XHJcbiAgICAgICAgdGhpcy5Db3VudGRvd24uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBpZihhY3Rpb24gIT0gXCJyZWFkeVwiKXtcclxuICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInRpbWVzdGFtcFwiKTsgIC8vIOiOt+WPluacrOWcsOWtmOWCqOeahOaXtumXtOaIs1xyXG4gICAgICAgICAgICBpZih0aW1lc3RhbXApeyAgLy8g5aaC5p6c5pyJ5YiZ6K+B5piO546p5a625piv6YeN5paw6L+b5p2l5LqG55qEXHJcbiAgICAgICAgICAgICAgICB2YXIgbm93ID0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTtcclxuICAgICAgICAgICAgICAgIHZhciB0aW1lID0gZHVyYXRpb24qMTAwMDtcclxuICAgICAgICAgICAgICAgIGlmKG5vdyAtIHRpbWVzdGFtcCA+IHRpbWUpeyAvLyDotoXml7ZcclxuICAgICAgICAgICAgICAgICAgICBpZihub3cgLSB0aW1lc3RhbXAgPCAyKnRpbWUpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IDU7ICAvLyDnjqnlrrblj6/og73lh7rkuo7lhbbku5bljp/lm6DpgIDlh7rmuLjmiI/lr7zoh7TotoXml7bvvIzkuLrlhbbmj5Dkvps156eS5pe26Ze05pW055CG54mM5Z6L77yI6L+Z5bey57uP5piv5b6I5LuB5oWI55qE5LqG77yJ44CCXHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRpbWVzdGFtcFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IE1hdGguZmxvb3IoIGR1cmF0aW9uIC0gKG5vdyAtIHRpbWVzdGFtcCkvMTAwMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1lbHNleyAgLy8g5aaC5p6c5rKh5pyJ5pe26Ze05oiz77yM5YiZ5L+d5a2Y77yM5Li6546p5a626YCA5Ye65ri45oiP5L+d55WZ6K+B5o2u77ybXHJcbiAgICAgICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTsgICAgIFxyXG4gICAgICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0aW1lc3RhbXAnLHRpbWVzdGFtcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uID0gZHVyYXRpb247XHJcbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gU3RyaW5nKGR1cmF0aW9uKTtcclxuICAgICAgICB0aGlzLkNvdW50ZG93bi5nZXRDb21wb25lbnQoXCJ0aW1lXCIpLnNldFRpbWUoZHVyYXRpb24gKiAwLjUpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgc2VsZi5fdGltZU1ldGhvZChhY3Rpb24pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5jYWxsYmFjaywgMSwgZHVyYXRpb24pO1xyXG4gICAgfSxcclxuXHJcbiAgICB0aW1lU3RvcDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLmNhbGxiYWNrKTtcclxuICAgICAgICB0aGlzLkNvdW50ZG93bi5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgX3RpbWVNZXRob2Q6IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICB0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gPSB0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gLSAxO1xyXG5cclxuICAgICAgICB2YXIgcmVtYWluID0gTWF0aC5tYXgodGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uLCAwKTtcclxuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSAocmVtYWluIDwgMTAgJiYgcmVtYWluID4gMCkgPyAoJzAnICsgcmVtYWluKSA6IHJlbWFpbjtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA8PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICAgICAgaWYoYWN0aW9uID09IFwicmVhZHlcIil7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jSW5kZXg+MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGlja1JlYWR5KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwidGltZXN0YW1wXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgX2dsb2JhbE1zZzpmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAvL2lmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgIHZhciByb29tSWQgPSBkYXRhLnJvb21JZDtcclxuICAgICAgICB2YXIgd2YgPSBkYXRhLnNldHRpbmczOyAgLy8vW+eWr+eLguWcuizprLzniYws5q+U6Iqx6ImyLOWdkOW6hCzpqazniYxdXHJcbiAgICAgICAgdmFyIHJvb20gPSBcIuaIv+WPt++8mlwiK3Jvb21JZDtcclxuICAgICAgICB2YXIgZmsgPSB3ZlswXT9cIueWr+eLguWcuiBcIjpcIuaZrumAmuWcuiBcIjsgICAgICAgICAvLyDnlq/ni4LlnLpcclxuICAgICAgICB2YXIgZ3AgPSB3ZlsxXT9cIumsvOeJjCBcIjpcIuaXoOmsvCBcIjsgICAgICAgICAgICAgLy8g6ay854mMXHJcbiAgICAgICAgdmFyIGhzID0gd2ZbMl0/XCLmr5ToirHoibIgXCI6XCLkuI3mr5ToirHoibIgXCI7ICAgICAgIC8vIOavlOiKseiJslxyXG4gICAgICAgIHZhciB6aiA9IHdmWzNdP1wi5Z2Q5bqEIFwiOlwi5LiN5Z2Q5bqEIFwiOyAgICAgICAgICAgLy8g5bqE5a62XHJcbiAgICAgICAgdmFyIG1wID0gd2ZbNF0/XCLkubDpqawgXCI6XCLkuI3kubDpqawgXCI7ICAgICAgICAgICAvLyDpqazniYxcclxuICAgICAgICB2YXIgc2YgPSBcIuaIv+i0uTpcIisoZGF0YS5zZXR0aW5nND8oKGRhdGEuc2V0dGluZzQ9PTEpP1wi6LWi6ICF5omjIFwiOlwi5oi/5Li75omjIFwiKTpcIuW5s+aRiiBcIik7ICAvL+aUtui0uVxyXG4gICAgICAgIHZhciBzaGFyZVRpdGxlID0gcm9vbStcIiDmqKHlvI86XCIremorc2Y7XHJcblxyXG4gICAgICAgIHZhciBwaiA9IFtcIjXlsYAgXCIsXCIxMOWxgCBcIixcIjIw5bGAIFwiXTsgIC8v54mM5bGAXHJcbiAgICAgICAgdmFyIGRzID0gW1wiNOS6uuS4jeWKoOiJsiBcIixcIjXkurrliqDkuIDoibIgXCIsXCI25Lq65LqM6ImyIFwiLFwiN+S6uuWKoOS4ieiJsiBcIl07ICAvL+WkmuiJslxyXG4gICAgICAgIHZhciBycyA9IGRzW2RhdGEuc2V0dGluZzJdK1wiXCI7XHJcbiAgICAgICAgdmFyIGpzID0gcGpbZGF0YS5zZXR0aW5nMS0yXTtcclxuICAgICAgICB2YXIgZGVzYyA9ICdb5aSn5LyX5Y2B5LiJ5rC0XSAnK3pqK2ZrK21wK2dwK3NmK3JzK2pzK1wiIOeCueWHu+ebtOaOpei/m+WFpeaIv+mXtFwiO1xyXG5cclxuICAgICAgICBzVGl0bGUgPSBzaGFyZVRpdGxlO1xyXG4gICAgICAgIHNEZXNjcmlwdGlvbiA9IGRlc2M7XHJcbiAgICAgICAgc0lkID0gJ3Jvb21JZD0nK3Jvb21JZDtcclxuXHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdyb29tSWQnLHJvb21JZCk7XHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzaGFyZVRpdGxlJyxzaGFyZVRpdGxlKTtcclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Rlc2MnLGRlc2MpO1xyXG5cclxuICAgICAgICBpZihjYy5zeXMuaXNCcm93c2VyKSB7XHJcbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvVGltZUxpbmUpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvVGltZUxpbmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1Nlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvU2Vzc2lvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vfVxyXG4gICAgfSxcclxuXHJcblxyXG5cclxuICAgIC8qIyMjIyMqL1xyXG4gICAgLyrmmL7npLrpqazniYwqL1xyXG4gICAgX2luaXRNYVBhaTpmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdFBsYXllckNvbXBvbmVudHM6IGZ1bmN0aW9uIChwbGF5ZXJJbmRleCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMgPSB0aGlzLnBsYXllck5vZGVzLm1hcChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRDb21wb25lbnQoJ1BsYXllcicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZighcGxheWVySW5kZXgpIHtcclxuICAgICAgICAgICAgcGxheWVySW5kZXggPSBbMCwxLDIsMyw0LDVdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGEgPSB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLnNwbGljZSgxLDcpO1xyXG5cclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgcGxheWVySW5kZXgubGVuZ3RoIC0gMTsgaSsrKXtcclxuICAgICAgICAgICAgdmFyIGluZGV4MSA9IHBsYXllckluZGV4W2ldO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXgyID0gcGxheWVySW5kZXhbaSArIDFdO1xyXG4gICAgICAgICAgICB2YXIgdG1wID0gbnVsbDtcclxuICAgICAgICAgICAgdG1wID0gYVtpbmRleDFdO1xyXG4gICAgICAgICAgICBhW2luZGV4MV0gPSBhW2luZGV4Ml07XHJcbiAgICAgICAgICAgIGFbaW5kZXgyXSA9IHRtcCA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhLmZvckVhY2goZnVuY3Rpb24obm9kZSl7dGhpcy5fcGxheWVyQ29tcG9uZW50cy5wdXNoKG5vZGUpO30uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIGlmKHRoaXMucGxheXNDb2lucyAmJiB0aGlzLnBsYXlzQ29pbnMubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgIHRoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe1xyXG4gICAgICAgICAgICAgICAgbm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGxheXNDb2lucyA9IFtdO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheXMsaSl7XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gXCJjb2luc1wiICsgaTtcclxuXHJcbiAgICAgICAgICAgIHZhciBub2RlID0gbmV3IGNjLk5vZGUoKTtcclxuXHJcbiAgICAgICAgICAgIG5vZGUubmFtZSA9IG5hbWU7XHJcblxyXG4gICAgICAgICAgICBub2RlLnggPSBwbGF5cy5ub2RlLng7XHJcblxyXG4gICAgICAgICAgICBub2RlLnkgPSBwbGF5cy5ub2RlLnk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQobm9kZSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBsYXlzQ29pbnMucHVzaChub2RlKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9pbml0U2VsZWN0Q2FyZE5vZGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgbGV0IGNhcmRUeXBlQ29tYmluZUNvbXAgPSB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZUNvbWJpbmUnKTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmVDb21wLnNldEZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2soZnVuY3Rpb24gKHNlcnZlckNhcmRzSW5mbykge1xyXG4gICAgICAgICAgICBjYXJkVHlwZUNvbWJpbmVDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kUGxheUNhcmQoc2VsZi5fdXNlcklkLCBzZXJ2ZXJDYXJkc0luZm8pO1xyXG4gICAgICAgICAgICBzZWxmLmNhcmRUeXBlQ29tYmluZU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKi9cclxuICAgIF9pbml0T25lR2FtZVJlc3VsdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIC8vIHRoaXMub25lR2FtZVJlc3VsdC5zZXRDbG9zZUNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vICAgICBpZiAoc2VsZi5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICAvLyAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gfTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub2ZmVGFyZ2V0KHRoaXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0xlYXZlRGVzazpmdW5jdGlvbigpeyAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g54K55Ye756a75byA5qGM5a2QXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7ICAgICAgICAgICAgICAgLy8g6L+Y5rKh5byA5aeL5Y+v5Lul6YCA5Ye65oi/6Ze0XHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHRoaXMuX3VzZXJJZCl7XHJcbiAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBTb2NrZXQuc2VuZExlYXZlRGVzayh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsaWNrRGlzc29sdmVEZXNrIDpmdW5jdGlvbigpeyAgICAgICAgICAgICAgICAgICAgICAvLyDngrnlh7vop6PmlaPmoYzlrZBcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpeyAgICAvLyDlj6rmnInmiL/kuLvmiY3og73op6PmlaPmoYzlrZBcclxuICAgICAgICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q29uZmlybUJ1dHRvbi5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGxldCBhbGVydCA9IHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgICAgICBhbGVydC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgICAgIGFsZXJ0LnNldE1lc3NhZ2UoXCLmmK/lkKbopoHop6PmlaPmiL/pl7RcIik7XHJcbiAgICAgICAgICAgIGFsZXJ0LmFsZXJ0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0V4aXRPdXQ6ZnVuY3Rpb24oKXtcclxuICAgICAgICBTb2NrZXQuc2VuZERpc3NvbHZlRGVzayh0aGlzLl91c2VySWQpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+ino+aVo+mAgOWHuuaIv+mXtFxyXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvICYmIHRoaXMuX2Rlc2tJbmZvLmlzRGVza092ZXIpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93KSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlpoLmnpzmiL/pl7Tlt7Lnu5PmnZ/vvIzlubbkuJTkuI3mmK/mraPlnKjmkq3mlL7miZPniYzliqjnlLssIOWImeebtOaOpeemu+W8gOaIv+mXtFxyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICAgICAgLy9pZiAodGhpcy5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICAvLyAgICB0aGlzLmFsZXJ0Rm9yY2VFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcclxuICAgICAgICAvLyAgICByZXR1cm47XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBhbGVydDEgPSB0aGlzLmRpc3NvbHZlQWx0ZXIuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgICAgICAgICAgYWxlcnQxLmFsZXJ0KCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBTb2NrZXQuc2VuZExlYXZlRGVzayh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDb25maXJtQnV0dG9uLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgYWxlcnQudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIGFsZXJ0LnNldE1lc3NhZ2UoXCLmmK/lkKbop6PmlaPmiL/pl7TvvJ9cIik7XHJcbiAgICAgICAgYWxlcnQuYWxlcnQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0b3AoKTtcclxuICAgIH0sXHJcbiAgICAvL+S4jeino+aVo+mAgOWHuuaIv+mXtFxyXG4gICAgY2xpY2tPdXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDApIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgY2MuY2xpY2tPdXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBTb2NrZXQuc2VuZExlYXZlRGVzayh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tTaGFyZUJnOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgY2MuZmluZChcIkNhbnZhcy9zaGFyZUJnXCIpLmFjdGl2ZSA9IGZhbHNlOyBcclxuICAgICAgICB0aGlzLnNoYXJlQmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgIGd1YW56aHU6ZnVuY3Rpb24oKXtcclxuICAgICAgICAvLyB2YXIgdXJsID0gXCJodHRwOi8vd3d3LmhvbmdnZWZlbmcuY24vZ3poL2luZGV4Lmh0bWxcIjtcclxuICAgICAgICAvLyBjYy5zeXMub3BlblVSTCh1cmwpXHJcbiAgICB9LFxyXG4gICAgcmVjb3JkU2hhcmU6ZnVuY3Rpb24oKXtcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5yZWNvcmRJZCl7XHJcbiAgICAgICAgICAgIHZhciBzaGFyZVRpdGxlID0gXCJb5aSn5LyX5Y2B5LiJ5rC0XeaImOe7qVwiO1xyXG4gICAgICAgICAgICB2YXIgcm9vbUlkID1cIuaIv+mXtOWPt++8mlwiK3RoaXMuX2Rlc2tJbmZvLnJvb21JZDtcclxuICAgICAgICAgICAgdmFyIHBqID0gW1wiNSBcIixcIjEwIFwiLFwiMjAgXCJdOyAgLy/niYzlsYBcclxuICAgICAgICAgICAgdmFyIGpzID0gXCLlsYDmlbDvvJpcIitwalt0aGlzLl9kZXNrSW5mby5zZXR0aW5nMS0yXTtcclxuICAgICAgICAgICAgdmFyIHRpbWUgPSBcIuaXtumXtO+8mlwiK3RoaXMuX2Rlc2tJbmZvLmNyZWF0ZVRpbWUgO1xyXG4gICAgICAgICAgICB2YXIgZGVzYyA9IHJvb21JZCtqcyt0aW1lK1wi54K55Ye75p+l55yL6K+m5oOFXCI7XHJcblxyXG4gICAgICAgICAgICB2YXIgcmVjb3JkSWQgPSB0aGlzLl9kZXNrSW5mby5yZWNvcmRJZDtcclxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwic2hhcmVUaXRsZVwiLHNoYXJlVGl0bGUpO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJkZXNjXCIsZGVzYyk7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInJlY29yZElkXCIscmVjb3JkSWQpO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJyb29tSWRcIiwnJyk7XHJcblxyXG4gICAgICAgICAgICBzVGl0bGUgPSBzaGFyZVRpdGxlO1xyXG4gICAgICAgICAgICBzRGVzY3JpcHRpb24gPSBkZXNjO1xyXG4gICAgICAgICAgICBzSWQgPSAncm9vbUlkPScrcm9vbUlkO1xyXG4gICAgICAgICAgICBpZihyZWNvcmRJZCl7XHJcbiAgICAgICAgICAgICAgICBzSWQgPSAncmVjb3JkSWQ9JytyZWNvcmRJZDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoY2Muc3lzLmlzQnJvd3Nlcil7XHJcbiAgICAgICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNoYXJlVG9UaW1lTGluZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYod2luZG93LnNoYXJlVG9TZXNzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNoYXJlVG9TZXNzaW9uKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy9zaGFyZUJnXCIpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2NyZWVuU2hhcmVGcmllbmRcIiwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxyXG4gICAgICAgICAgICAgICAgS1FOYXRpdmVJbnZva2Uuc2NyZWVuc2hvdFNoYXJlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8g54K55Ye75qGM6Z2i5YiG5LqrXHJcbiAgICBjbGlja0Rlc2tTaGFyZSA6ZnVuY3Rpb24oKXtcclxuICAgICAgICAvL3RoaXMuX2dsb2JhbE1zZyh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgIHZhciBzaGFyZUJnID0gY2MuZmluZChcIkNhbnZhcy9zaGFyZUJnXCIpOyBcclxuICAgICAgICAgICAgc2hhcmVCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL3ZhciB3eEJnID0gdGhpcy5zaGFyZUJnLmdldENoaWxkQnlOYW1lKFwid3hcIik7XHJcbiAgICAgICAgICAgIC8vdmFyIHB5cUJnID0gdGhpcy5zaGFyZUJnLmdldENoaWxkQnlOYW1lKFwiUFlRXCIpO1xyXG4gICAgICAgICAgICAvL3d4QmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy9weXFCZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy90aGlzLnNoYXJlQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGlkPXNJZDtcclxuICAgICAgICB2YXIgdGl0bGUgPSBzVGl0bGU7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gc0Rlc2NyaXB0aW9uO1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUZyaWVuZDpkZXNjcmlwdGlvbjpcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcclxuICAgICAgICAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlRnJpZW5kXCIsc3RyLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+eCueWHu+WIhuS6q+aMiemSrlxyXG4gICAgY2xpY2tTaGFyZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vdGhpcy5fZ2xvYmFsTXNnKHRoaXMuX2Rlc2tJbmZvKTtcclxuICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcclxuICAgICAgICAgICAgdmFyIHd4QmcgPSB0aGlzLnNoYXJlQmcuZ2V0Q2hpbGRCeU5hbWUoXCJ3eFwiKTtcclxuICAgICAgICAgICAgdmFyIHB5cUJnID0gdGhpcy5zaGFyZUJnLmdldENoaWxkQnlOYW1lKFwiUFlRXCIpO1xyXG4gICAgICAgICAgICB3eEJnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHB5cUJnLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLnNoYXJlQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGlkPXNJZDtcclxuICAgICAgICB2YXIgdGl0bGUgPSBzVGl0bGU7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gc0Rlc2NyaXB0aW9uO1xyXG5cclxuICAgICAgICAvLyBsZXQgcm9vbUlkID0gU3RyaW5nKHRoaXMuX2Rlc2tJbmZvLnJvb21JZCk7XHJcbiAgICAgICAgLy8gdmFyIGRlc2NyaXB0aW9uID0gXCLlpKfkvJfljYHkuInmsLQg546p5rOVOlwiXHJcbiAgICAgICAgLy8gZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbiArIFwiIFwiICsgdGhpcy5fZGVza0luZm9OdW1iZXJPZlBlb3BsZSgpO1xyXG4gICAgICAgIC8vIGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gKyBcIixcIiArIHRoaXMuX2Rlc2tJbmZvUGF5SW5mbygpO1xyXG4gICAgICAgIC8vIGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gKyBcIiBcIiArIHRoaXMuX2Rlc2tJbmZvTnVtYmVyT2ZHYW1lKCk7XHJcblxyXG5cclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVGcmllbmQ6ZGVzY3JpcHRpb246XCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLHN0ciwgaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8v5YiG5Lqr5Yiw5pyL5Y+L5ZyIXHJcbiAgICBzaGFyZUhhbGxUaW1lbGluZTpmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICB2YXIgd3hCZyA9IHRoaXMuc2hhcmVCZy5nZXRDaGlsZEJ5TmFtZShcInd4XCIpO1xyXG4gICAgICAgICAgICB2YXIgcHlxQmcgPSB0aGlzLnNoYXJlQmcuZ2V0Q2hpbGRCeU5hbWUoXCJQWVFcIik7XHJcbiAgICAgICAgICAgIHd4QmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHB5cUJnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuc2hhcmVCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB2YXIgaWQ9c0lkO1xyXG4gICAgICAgICAgICB2YXIgdGl0bGUgPSBzVGl0bGU7XHJcbiAgICAgICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IHNEZXNjcmlwdGlvbjtcclxuXHJcbiAgICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVIYWxsVGltZWxpbmVcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxyXG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XHJcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCBzdHIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy/ngrnlh7vlh4blpIfmjInpkq5cclxuICAgIGNsaWNrUmVhZHk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICBTb2NrZXQuc2VuZFJlYWR5KHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8v54K55Ye75byA5aeL5oyJ6ZKuXHJcbiAgICBjbGlja1N0YXJ0R2FtZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBTb2NrZXQuc2VuZFN0YXJ0R2FtZSh0aGlzLl91c2VySWQpO1xyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVSb29tTnVtYmVyOiBmdW5jdGlvbiAocm9vbU51bWJlcikge1xyXG4gICAgICAgIGxldCBnYW1lTnVtYmVyU3RyaW5nID0gXCJcIjtcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uc2V0dGluZzEgIT0gMCAmJiB0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSAhPSAxKSB7XHJcbiAgICAgICAgICAgIGdhbWVOdW1iZXJTdHJpbmcgPSBcIuWxgOaVsCA6IFwiICsgXCJcIiArIHRoaXMuX2Rlc2tJbmZvLmNJbmRleCArIFwiL1wiICsgdGhpcy5fZGVza0luZm8ubU1heDtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxID09IDApIHtcclxuICAgICAgICAgICAgZ2FtZU51bWJlclN0cmluZyA9IFwi5bGA5pWwIDogMTDlsYBcIjtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxID09IDEpIHtcclxuICAgICAgICAgICAgZ2FtZU51bWJlclN0cmluZyA9IFwi5bGA5pWwIDogMjDlsYBcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5sYWJlbFJvb21OdW1iZXIuc3RyaW5nID0gXCLmiL/lj7cgOiBcIiArIFwiXCIgKyByb29tTnVtYmVyICsgXCIgICAgXCIgKyBnYW1lTnVtYmVyU3RyaW5nO1xyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVHYW1lU3RhdHVzOiBmdW5jdGlvbiAoc3RhdHVzID0gR0FNRVNUQVRVUy5XQUlUX1BFT1BMRSkge1xyXG4gICAgICAgIHRoaXMuX2dhbWVTdGF0dXMgPSBzdGF0dXM7XHJcblxyXG4gICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSAoc3RhdHVzID09IEdBTUVTVEFUVVMuV0FJVF9QRU9QTEUpO1xyXG4gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSAoc3RhdHVzID09IEdBTUVTVEFUVVMuV0FJVF9SRUFEWSk7XHJcbiAgICAgICAgdGhpcy5pc1JlYWR5U3RhdHVzKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdhbWVTdGF0dXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZ2FtZVN0YXR1cztcclxuICAgIH0sXHJcbiAgICBpc1JlYWR5U3RhdHVzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYodGhpcy5fcGxheWVySW5mb3MgJiYgdGhpcy5fcGxheWVySW5mb3MubGVuZ3RoPjApIHtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJJbmZvKXtcclxuICAgICAgICAgICAgICAgIHZhciB1c2VySW5mb1NlbGY9Y2MuZmluZCgnQ2FudmFzL3BsYXlTZWxmL3VzZXJJbmZvU2VsZicpO1xyXG4gICAgICAgICAgICAgICAgaWYocGxheWVySW5mby5pZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZighcGxheWVySW5mby5yZWFkeVN0YXR1cyAmJiAhdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyAmJiAhUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpICYmICFQbGF5YmFjay5pbnN0YW5jZS5pc0NvbnRhaW5QbGF5YmFja0RhdGFzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlckluZm9TZWxmLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRSZWFkeU5vZGVWaXNpYmxlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7Ly/kuIDlsYDov5jmsqHlvIDlp4tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5wbGF5ZXJzLmxlbmd0aCA8IHRoaXMuX2Rlc2tJbmZvLm1heE51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMubGVuZ3RoID49IDIgJiYgdGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gdGhpcy5fdXNlcklkKXsvL+aYr+WQpuaYr+aIv+S4u1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCF0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySW5mb1NlbGYuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldFJlYWR5Tm9kZVZpc2libGUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllckNvbXApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllckNvbXAuaGlkZVJlYWR5U3RhdHVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy5faXNDb21wYXJpbmdDYXJkc05vdylcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCLlh4blpIfnirbmgIEtLS0tLS0tLVwiKVxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5faXNDb21wYXJpbmdDYXJkc05vdykgey8vXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllckNvbXApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJDb21wLmhpZGVSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgaXNHYW1lU3RhcnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDApIHsvL+S4gOWxgOi/mOayoeW8gOWni1xyXG4gICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpey8v5piv5ZCm5piv5oi/5Li7XHJcbiAgICAgICAgICAgICAgICBpZighdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyAmJiAhUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpXHJcbiAgICAgICAgICAgICAgICAgICAgJiYgIVBsYXliYWNrLmluc3RhbmNlLmlzQ29udGFpblBsYXliYWNrRGF0YXMoKSAmJiB0aGlzLl9kZXNrSW5mby5wbGF5ZXJzLmxlbmd0aCA+PSAyKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8ucGxheWVycy5sZW5ndGggPCB0aGlzLl9kZXNrSW5mby5tYXhOdW1iZXIpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vLyDmuLjmiI/liqjnlLtcclxuICAgIF9zdGFydEdhbWU6IGZ1bmN0aW9uIChwbGF5TXVzaWMpIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZ2FtZVN0YXR1cygpID09IEdBTUVTVEFUVVMuUExBWUlORykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdGhpcy5fcGxheWVySW5mb3MgPSBwbGF5ZXJzO1xyXG4gICAgICAgIC8vdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vfSk7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTsgIC8vIyMjIyNcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5oaWRlUmVhZHlTdGF0dXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnRlU2h1UGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5c0NvaW5zLmZvckVhY2goZnVuY3Rpb24obm8pe2lmKG5vKSBuby5yZW1vdmVBbGxDaGlsZHJlbigpO30pO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheXMsaSl7XHJcblxyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IFwiY29pbnNcIiArIGk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbm9kZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShuYW1lKTtcclxuXHJcbiAgICAgICAgICAgIGlmKG5vZGUpe1xyXG4gICAgICAgICAgICAgICAgbm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLy8gY2MubG9nKHRoaXMubm9kZSlcclxuICAgICAgICAvLyBjYy5sb2coJy0tLS0tLTcwOScpXHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHRoaXMuX3BsYXllckluZm9zKTtcclxuICAgICAgICB0aGlzLnNob3dDb21wYXJlQ2FyZCgpO1xyXG4gICAgICAgIHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudXBkYXRlR2FtZVN0YXR1cyhHQU1FU1RBVFVTLlBMQVlJTkcpO1xyXG4gICAgICAgIHRoaXMuX3BsYXlGYVBhaUFuaW1hdGlvbihwbGF5TXVzaWMpO1xyXG5cclxuICAgICAgICBsZXQgY2FyZFR5cGVDb21iaW5lID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVDb21iaW5lJyk7XHJcblxyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZXNldCgpO1xyXG5cclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYgKCFVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyh0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCkpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuZmFwYWlBbmltYXRpb24oKTtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2hvd0NhcmRUeXBlQ29tYmluZSgpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIDEuOSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX3BsYXlGYVBhaUFuaW1hdGlvbjogZnVuY3Rpb24gKHBsYXlNdXNpYykge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKXtcclxuICAgICAgICAgICAgcGxheWVyLnBsYXlGYVBhaUFuaW1hdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmKHBsYXlNdXNpYyl7XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5RmFQYWkoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyMqL1xyXG4gICAgLy/mmK/lkKbnibnmrorniYxcclxuICAgIGlzVGVTaHVQYWk6IGZ1bmN0aW9uKGNhcmRzKXtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzVGVTaHVQYWkoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1RlU2h1UGFpID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzVGVTaHVQYWkgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuS4gOadoem+mVxyXG4gICAgaXNZaVRpYW9Mb25nOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNZaVRpYW9Mb25nKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNZaVRpYW9Mb25nID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzWWlUaWFvTG9uZyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5YWt5a+55Y2KXHJcbiAgICBpc0xpdUR1aUJhbjogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzTGl1RHVpQmFuKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNMaXVEdWlCYW4gPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNMaXVEdWlCYW4gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbkuInpobrlrZBcclxuICAgIGlzU2FuU2h1blppOiBmdW5jdGlvbihjYXJkcyl7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1NhblNodW5aaShjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuU2h1blppID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuU2h1blppID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5LiJ5ZCM6IqxXHJcbiAgICBpc1NhblRvbmdIdWE6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1NhblRvbmdIdWEoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblRhb0h1YSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblRhb0h1YSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuS4ieWQjOiKsemhulxyXG4gICAgaXNTYW5Ub25nSHVhU2h1bjogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzU2FuVG9uZ0h1YVNodW4oY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblRvbmdIdWFTaHVuID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuVG9uZ0h1YVNodW4gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmK/muIXpvplcclxuICAgIGlzUWluZ0xvbmc6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1FpbmdMb25nKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNRaW5nTG9uZyA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1FpbmdMb25nID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5pivIOKAnOS4ieWIhuWkqeS4i+KAnVxyXG4gICAgaXNTYW5GZW5UaWFuWGlhOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNTYW5GZW5UaWFuWGlhKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5GZW5UaWFuWGlhID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuRmVuVGlhblhpYSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuaYryDigJzlm5vlpZfkuInmnaHigJ1cclxuICAgIGlzU2lUYW9TYW5UaWFvOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNTaVRhb1NhblRpYW8oY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NpVGFvU2FuVGlhbyA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NpVGFvU2FuVGlhbyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuaYr+S6lOWvueS4ieadoVxyXG4gICAgaXNXdUR1aVNhblRpYW86IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1d1RHVpU2FuVGlhbyhjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzV3VEdWlTYW5UaWFvID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzV3VEdWlTYW5UaWFvID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5piv5YeR5LiA6ImyXHJcbiAgICBpc0NvdVlpU2U6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc0NvdVlpU2UoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc0NvdVlpU2UgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNDb3VZaVNlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8qIyMjIyMqL1xyXG5cclxuICAgIC8q5pi+56S66YWN54mM6aG16Z2iKi9cclxuICAgIF9zaG93Q2FyZFR5cGVDb21iaW5lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc3RhcnRDb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMgPSBudWxsO1xyXG5cclxuICAgICAgICBsZXQgY2FyZFR5cGVDb21iaW5lID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVDb21iaW5lJyk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnJlc2V0KCk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnJlbG9hZENhcmRzKFtdKTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS50aW1lU3RhcnQoNjApO1xyXG4gICAgICAgIHRoaXMudGltZVN0YXJ0KDYwLFwiXCIpO1xyXG4gICAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5zY2FsZSA9IDE7XHJcblxyXG4gICAgICAgIGxldCBjYXJkcyA9IHRoaXMuX2ZpbmRDYXJkc0J5VXNlcklkKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgLy9cIjFfOVwiXCIzXzlcIlwiMl85XCJcclxuICAgICAgICAvLyBcIjJfN1wiXCIxXzdcIlwiM18zXCJcIjJfMTJcIlxyXG4gICAgICAgIC8vXCIxXzFcIlwiMV8zXCJcIjJfNlwiXCIxXzExXCJcIjJfMVwiXCIzXzRcIi8vXHJcbiAgICAgICAgLy8gaWYodGhpcy5fdXNlcklkID09IDIpe1xyXG4gICAgICAgIC8vICAgICBjYXJkcyA9IFt7c3VpdDogXCJkXCIsIG51bWJlcjoyfSx7c3VpdDogXCJkXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6Mn0sLy/pnZLpvplcclxuXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJoXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6Mn0sXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJjXCIsIG51bWJlcjozfSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6M30sIHtzdWl0OiBcImNcIiwgbnVtYmVyOjN9LFxyXG5cclxuICAgICAgICAvLyAgICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjN9LCB7c3VpdDogXCJkXCIsIG51bWJlcjo0fSxcclxuICAgICAgICAvLyAgICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjR9LCB7c3VpdDogXCJkXCIsIG51bWJlcjo0fSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6NH1dO1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvL2lmKHRoaXMuX3VzZXJJZCA9PSAxKXtkXHJcbiAgICAgICAgLy8gICAgY2FyZHMgPSBbe3N1aXQ6IFwiY1wiLCBudW1iZXI6MX0se3N1aXQ6IFwiaFwiLCBudW1iZXI6MX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjF9LC8v6Z2S6b6ZXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICAgICAge3N1aXQ6IFwiaFwiLCBudW1iZXI6OH0sIHtzdWl0OiBcImNcIiwgbnVtYmVyOjJ9LFxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjo4fSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6OH0sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjIwfSxcclxuICAgICAgICAvLyAgICAgICAge3N1aXQ6IFwiaFwiLCBudW1iZXI6OX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjl9LFxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJzXCIsIG51bWJlcjo5fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6OX0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjl9XTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLyBlbHNlIGlmKHRoaXMuX3VzZXJJZCA9PSA2KXtcclxuICAgICAgICAvLyAgICAgY2FyZHMgPSBbe3N1aXQ6IFwiZFwiLCBudW1iZXI6MTF9LHtzdWl0OiBcImRcIiwgbnVtYmVyOjEzfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6MTF9LC8v6Z2S6b6ZXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjoxfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6MX0sXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJoXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6NH0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjl9LFxyXG4gICAgICAgIC8vICAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6N30sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjd9LFxyXG4gICAgICAgIC8vICAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6NX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjV9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo1fSxdO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX3VzZXJJZCA9PSAzKXtcclxuICAgICAgICAvLyAgICBjYXJkcyA9IFt7c3VpdDogXCJkXCIsIG51bWJlcjo0fSx7c3VpdDogXCJkXCIsIG51bWJlcjoxM30sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEzfSwvL+mdkum+mVxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjo2fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6N30sXHJcbiAgICAgICAgLy8gICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjh9LCB7c3VpdDogXCJjXCIsIG51bWJlcjo5fSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6MTB9LFxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJzXCIsIG51bWJlcjoxfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6M30sXHJcbiAgICAgICAgLy8gICAgICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEwfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6OH0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEyfSxdO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIGNjLm1vc2hpID0gMDtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICB2YXIgcyA9IGNhcmRzW2ldLm51bWJlcjtcclxuICAgICAgICAgICAgaWYocyA+PSAyMCl7XHJcbiAgICAgICAgICAgICAgICBjYy5tb3NoaSA9IDE7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgY2FyZE5hbWVzID0gdGhpcy5fY29udmVydENhcmRzVG9DYXJkTmFtZXMoY2FyZHMpO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZWxvYWRDYXJkcyhjYXJkTmFtZXMpO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5hZGRDYXJkTW9kZXMoY2FyZE5hbWVzKTtcclxuXHJcbiAgICAgICAgLy9jYy5mcm9tLm1vc2hpID09IDDpgInmi6nkuobluoTlrrbmqKHlvI9cclxuXHJcbiAgICAgICAgaWYoY2MubW9zaGkgIT0gMSl7XHJcbiAgICAgICAgICAgIHRoaXMuaXNUZVNodVBhaShjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNRaW5nTG9uZyhjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNZaVRpYW9Mb25nKGNhcmRzKTtcclxuICAgICAgICAgICAgdGhpcy5pc0xpdUR1aUJhbihjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNTYW5TaHVuWmkoY2FyZHMpO1xyXG4gICAgICAgICAgICB0aGlzLmlzU2FuVG9uZ0h1YShjYXJkcyk7XHJcbiAgICAgICAgICAgIGlmKFRFU0hVUEFJVFlQRS5pc1RlU2h1UGFpKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5zY2FsZSA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzLmdvbmdYaU5pLmdldENoaWxkQnlOYW1lKFwiYmdcIik7XHJcbiAgICAgICAgICAgICAgICBub2Rlcy5vcGFjaXR5ID0gMjQwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc1NhblRvbmdIdWFTaHVuKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzU2FuRmVuVGlhblhpYShjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc1NpVGFvU2FuVGlhbyhjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc1d1RHVpU2FuVGlhbyhjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc0NvdVlpU2UoY2FyZHMpO1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93R29uZ1hpTmlBbmRCdG5UZVNodVBhaSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUuY2FjbGVBdXRvU2VsZWN0ZWRDYXJkczIoKTtcclxuXHJcbiAgICAgICAgaWYoY2MubW9zaGkgPT0gMSkgY2MudGVTaHVQYWlDYXJkcyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTsgIC8vIyMjIyNcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5oaWRlUmVhZHlTdGF0dXMoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0SXNUZVNodVBhaTogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIHZhciBjYXJkcyA9IHRoaXMuX2ZpbmRDYXJkc0J5VXNlcklkKHVzZXJJZCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNUZVNodVBhaShjYXJkcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyPmo4DmtYvnibnmrorniYznsbvlnovvvIzmmL7npLrnm7jlr7nlupTnmoTmga3llpzkvaDpobXpnaLlkoznibnmrorniYznsr7ngbUqL1xyXG4gICAgX3Nob3dHb25nWGlOaUFuZEJ0blRlU2h1UGFpOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLyrlpoLmnpzmnInnibnmrorniYwqL1xyXG4gICAgICAgIGlmKFRFU0hVUEFJVFlQRS5pc1RlU2h1UGFpKXtcclxuICAgICAgICAgICAgaWYoVEVTSFVQQUlUWVBFLmlzUWluZ0xvbmcpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUsIFwi5ZCM6Iqx5Y2B5LiJ5rC0XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2FuVG9uZ0h1YSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihURVNIVVBBSVRZUEUuaXNZaVRpYW9Mb25nKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlLCBcIuWNgeS4ieawtFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3lpVGlhb0xvbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYoVEVTSFVQQUlUWVBFLmlzTGl1RHVpQmFuKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlLCBcIuWFreWvueWNilwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xpdUR1aUJhbiA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTYW5TaHVuWmkpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUsIFwi5LiJ6aG65a2QXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2FuU2h1blppID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1NhblRhb0h1YSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSwgXCLkuInlkIzoirFcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zYW5Ub25nSHVhID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzU2FuVG9uZ0h1YVNodW4pe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX1NhblRvbmdIdWFTaHVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTYW5GZW5UaWFuWGlhKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9TYW5GZW5UaWFuWGlhID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNDb3VZaVNlKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9Db3VZaVNlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTaVRhb1NhblRpYW8pe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX1NpVGFvU2FuVGlhbyA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzV3VEdWlTYW5UaWFvKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9XdUR1aVNhblRpYW8gPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy90aGlzLl9pbml0VGVTaHVQYWlTcHJpdGUoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjI+aOp+WItueJueauiueJjOeyvueBteeahOaYvuekuiovXHJcbiAgICBfaW5pdFRlU2h1UGFpU3ByaXRlOmZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvKuaKiuaJgOacieeahOeJueauiueJjOeyvueBtemDvemakOiXj+aOiSovXHJcbiAgICAgICAgLy9mb3IodmFyIGk9MDtpPHRoaXMudGVzaHVwYWlfbWluLmxlbmd0aDtpKyspe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuIDmnaHpvpnvvIzlsLHmmL7npLrkuIDmnaHpvpnnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vaWYodGhpcy5feWlUaWFvTG9uZyl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bM10uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFszXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/lha3lr7nljYrlsLHmmL7npLrlha3lr7nljYrnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9saXVEdWlCYW4pe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzBdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbMF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ6aG65a2Q5bCx5pi+56S65LiJ6aG65a2Q55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fc2FuU2h1blppKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pblsxXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX3NhblRvbmdIdWEpe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzJdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbMl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fUWluZ0xvbmcpe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzRdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbNF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31fZ29uZ1hpTmlTaG93XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX1NhblRvbmdIdWFTaHVuKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pbls1XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzVdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX1NhbkZlblRpYW5YaWEpe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzZdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbNl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fQ291WWlTZSl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bN10uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFs3XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9TaVRhb1NhblRpYW8pe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzhdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbOF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fV3VEdWlTYW5UaWFvKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pbls5XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyMqL1xyXG4gICAgLy/mmL7npLpnb25nWGlOaSDpobXpnaLlkox0ZVNodVBhaVxyXG4gICAgY2xpY2tHb25nWGlOaVNob3c6ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5zY2FsZSA9IDE7XHJcbiAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5nb25nWGlOaS5nZXRDaGlsZEJ5TmFtZShcImJnXCIpO1xyXG4gICAgICAgIG5vZGVzLm9wYWNpdHkgPSAwO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZ29uZ1hpTmlTaG93OmZ1bmN0aW9uIChzdGF0dWVzLCB0ZXN0ID0gXCJcIikge1xyXG4gICAgICAgIC8vdmFyIGFsdGVyQ29tID0gdGhpcy5nb25nWGlOaS5nZXRDb21wb25lbnQoXCJhbGVydFwiKTtcclxuICAgICAgICBsZXQgYWx0ZXJDb20gPSB0aGlzLmdvbmdYaU5pLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBhbHRlckNvbS51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgdGVzdCA9IFwi5piv5ZCm5oyJ54m55q6K54mM5Z6LW1wiICsgdGVzdCArIFwiXeWHuueJjO+8n1wiICtcIlxcblwiKyBcIijlj5bmtojlkI7ngrnlh7vlt6bkuIvop5Llj6/lho3miqXpgZMpXCI7XHJcbiAgICAgICAgYWx0ZXJDb20uc2V0TWVzc2FnZSh0ZXN0KTtcclxuICAgICAgICBpZihzdGF0dWVzKXtcclxuICAgICAgICAgICAgYWx0ZXJDb20uYWxlcnQoKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgYWx0ZXJDb20uZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRlU2h1UGFpLmFjdGl2ZSA9IHN0YXR1ZXM7XHJcbiAgICAgICAgdmFyIG5vZGVzID0gdGhpcy50ZVNodVBhaS5nZXRDaGlsZEJ5TmFtZShcImJ0blRlc2h1cGFpXCIpO1xyXG4gICAgICAgIG5vZGVzLmNoaWxkcmVuWzBdLnJ1bkFjdGlvbihjYy5yZXBlYXRGb3JldmVyKGNjLnJvdGF0ZUJ5KDEsIC0zNjApKSk7XHJcbiAgICAgICAgbm9kZXMuY2hpbGRyZW5bMV0ucnVuQWN0aW9uKGNjLnJlcGVhdEZvcmV2ZXIoY2Mucm90YXRlQnkoMSwgMzYwKSkpO1xyXG4gICAgfSxcclxuICAgIC8qIyMjIyMqL1xyXG5cclxuICAgIC8vICDnu5Pmnpznm7jlhbNcclxuICAgIC8vIOaYvuekuuS4gOWxgOe7k+aenFxyXG4gICAgX3Nob3dPbmVHYW1lUmVzdWx0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgPSBmYWxzZTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy51cGRhdGVHYW1lU3RhdHVzKEdBTUVTVEFUVVMuV0FJVF9QRU9QTEUpO1xyXG4gICAgICAgIC8vbGV0IG9uZUdhbWVSZXN1bHQgPSB0aGlzLm9uZUdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdHYW1lUmVzdWx0Jyk7XHJcbiAgICAgICAgLy9vbmVHYW1lUmVzdWx0LnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICAvL29uZUdhbWVSZXN1bHQuc2hvd1Jlc3VsdHModGhpcy5fZGVza0luZm8sIHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlclNjb3JlcygpO1xyXG4gICAgICAgIC8vdGhpcy5fdXBkYXRlQmFua2VyKCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vc2VsZi5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgIC8vICAvL3BsYXllckNvbXAucmVzZXQoKTtcclxuICAgICAgICAgICAgLy8gIC8vcGxheWVyQ29tcC5yZXNldDIoKTsgIC8vIyMjIyNcclxuICAgICAgICAgICAgLy99KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghc2VsZi5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICAgICAgICAgIC8vaWYgKHNlbGYuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7Ly/kuIDlsYDov5jmsqHlvIDlp4tcclxuICAgICAgICAgICAgICAgIC8vICAgIHNlbGYuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5faXNUb3RhbEdhbWVPdmVyKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9zaG93VG90YWxHYW1lUmVzdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCAwLjUpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5faXNSYW5kb21Sb29tKCkgfHwgUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIG9uZUdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgICAgICB9LCAyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmmL7npLrmgLvnu5PmnpxcclxuICAgIF9zaG93VG90YWxHYW1lUmVzdWx0OiBmdW5jdGlvbiAoc2hvd0RlbGF5ID0gMikge1xyXG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICAvL2NjLmZpbmQoXCJDYW52YXMvc2hvd19yZXN1bHRcIikuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY0luZGV4ID09IHRoaXMuX2Rlc2tJbmZvLm1NYXgpe1xyXG4gICAgICAgICAgICB0aGlzLmFnYWluQnRuLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuYWdhaW5CdG4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdG90YWxHYW1lUmVzdWx0Q29tcCA9IHRoaXMudG90YWxHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnVG90YWxHYW1lUmVzdWx0Jyk7XHJcbiAgICAgICAgaWYoIHRvdGFsR2FtZVJlc3VsdENvbXAubm9kZS5hY3RpdmUgKXtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gXHJcblxyXG4gICAgICAgIGlmKHRoaXMuX2JpZ1JlY29yZEluZm8gPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHRoaXMuX2JpZ1JlY29yZEluZm8gPSB0aGlzLl9kZXNrSW5mby5wbGF5ZXJzO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0b3RhbEdhbWVSZXN1bHRDb21wLnNldFBsYXllckluZm9zKHRoaXMuX2JpZ1JlY29yZEluZm8sIHRoaXMuX2Rlc2tJbmZvKTtcclxuXHJcbiAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy50b3RhbEdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy90aGlzLm9uZUdhbWVSZXN1bHQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vYWxlcnQuYWxlcnQoKTtcclxuICAgICAgICAgICAgLyoqL1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMudG90YWxHYW1lUmVzdWx0LmFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQuYWxlcnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvKiovXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCBzaG93RGVsYXkpO1xyXG5cclxuICAgICAgICBhbGVydC5zZXREaXNtaXNzQ2FsbGJhY2soZnVuY3Rpb24gKCl7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kT25jZUFnYWluKCdmYWxzZScsdGhpcy5fdXNlcklkKTtcclxuICAgICAgICAgICAgLy9jYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBjbGlja0FnYWluOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgU29ja2V0LnNlbmRPbmNlQWdhaW4oJ3RydWUnLHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6IFNvY2tldCDnm7jlhbNcclxuICAgIF9sb2FkRGVza0luZm86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBTb2NrZXQuc2VuZEdldERlc2NrSW5mbyh0aGlzLl91c2VySWQpO1xyXG4gICAgfSxcclxuICAgIF9yZWdpc3RlclNvY2tldEV2ZW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZURlc2tJbmZvLCB0aGlzLl9zb2NrZXRSZWNlaXZlRGVza0luZm8sIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVPbmxpbmVTdGF0dXMsIHRoaXMuX3NvY2tldFJlY2l2ZU9ubGluZVN0YXR1cywgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUNoYXRUZXh0LCB0aGlzLl9zb2NrZXRSZWNpdmVDaGF0VGV4dE1lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVDaGF0RW1vamksIHRoaXMuX3NvY2tldFJlY2l2ZUNoYXRFbW9qaU1lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVSZXF1ZXN0RGlzc29sdmUsIHRoaXMuX3NvY2tldFJlY2VpdmVSZXF1ZXN0RXhpdE1lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVSZXF1ZXN0RGlzc29sdmVSZXN1bHQsIHRoaXMuX3NvY2tldFJlY2VpdmVSZXF1ZXN0RXhpdFJlc3VsdE1lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVBdWRpb01lc3NhZ2UsIHRoaXMuX3NvY2tldFJlY2VpdmVBdWRpb01lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVQbGF5Q2FyZCwgdGhpcy5fc29ja2V0UmVjZWl2ZVBsYXlDYXJkLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlR2FtZU92ZXIsIHRoaXMuX3NvY2tldFJlY2VpdmVHYW1lT3ZlciwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUZhUGFpLCB0aGlzLl9zb2NrZXRSZWNpdmVGYVBhaSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVJlYWR5LCB0aGlzLl9zb2NrZXRSZWNpdmVSZWFkeSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZURpc3NvbHZlRGVzaywgdGhpcy5fc29ja2V0UmVjZWl2ZURpc3NvbHZlRGVzaywgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUxlYXZlRGVzaywgdGhpcy5fc29ja2V0TGVhdmVEZXNrLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Tb2NrZXREaXNjb25uZWN0LCB0aGlzLl9yZWNlaXZlU29ja2V0Q29ubmVjdEVycm9yLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0U3VjY2Vzc2VkLCB0aGlzLl9yZWNlaXZlU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVBhdXNlLCB0aGlzLl9zb2NrZXRSZWNlaXZlUGF1c2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVTZWxlY3RCZWlMdiwgdGhpcy5fUmVjZWl2ZVNlbGVjdEJlaUx2LCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlQmVpTHYsIHRoaXMuX1JlY2VpdmVCZWlMdiwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVFpbmdMaSwgdGhpcy5fUmVjZWl2ZVFpbmdMaSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZU9uY2VBZ2FpbiwgdGhpcy5fUmVjZWl2ZU9uY2VBZ2FpbiwgdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9SZWNlaXZlT25jZUFnYWluOmZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlho3mnaXkuIDlsYBcclxuICAgICAgICAgKiDmgLvnu5PmnpzopoHpmpDol4/mjolcclxuICAgICAgICAgKiDmr5TniYzopoHpmpDol4/mjolcclxuICAgICAgICAgKiDlj5HniYzopoHmmL7npLpcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMgPSBbXTtcclxuICAgICAgICB0aGlzLnBsYXllckNvbXBzLmZvckVhY2gocGxheWVyQ29tcCA9PiB7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzID0gdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzO1xyXG4gICAgfSk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIGlmKCFkYXRhLnJlYXNvbil7XHJcbiAgICAgICAgICAgIHRoaXMudG90YWxHYW1lUmVzdWx0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0Q29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJDb21wLnJlc2V0KCk7ICAvLyMjIyMjXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLl9zb2NrZXRSZWNlaXZlRGVza0luZm8ocmVzcG9uc2UpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgaWYobm93IC0gdGhpcy5fbm93VGltZUFnYWluID4gMTUwMCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9ub3dUaW1lQWdhaW4gPSBub3c7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQueSA9IC0xNDM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdFJlc3VsdC5jaGlsZHJlblswXS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9ICfmiL/ljaHkuI3otrMnO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGNjLnNwYXduKGNjLm1vdmVUbygwLjMsIGNjLnAoMCwgMjApKSwgY2MuZmFkZU91dCgwLjMpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdFJlc3VsdC5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2MubW92ZVRvKDEsIGNjLnAoMCwgMCkpLCBhY3Rpb24pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG5cclxuICAgIF9SZWNlaXZlU2VsZWN0QmVpTHY6ZnVuY3Rpb24oKXtcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCAhPSB0aGlzLl91c2VySWQpe1xyXG4gICAgICAgICAgICB0aGlzLmJlaWx2LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHZhciBCMyA9IHRoaXMuYmVpbHYuZ2V0Q2hpbGRCeU5hbWUoJ2JnJykuZ2V0Q2hpbGRCeU5hbWUoJ2J0bjMnKS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzU9PTEpe1xyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiDluoTlrrbpgInmi6nkuKTlgI3nmoTml7blgJkgM+WAjeaMiemSruaYr+S4jeiDveWTjeW6lOeahFxyXG4gICAgICAgICAgICAgICAgICog6YCJ5oup5LiJ5YCN5LiN55So566h77yM5YWo6YOo5pi+56S677yMXHJcbiAgICAgICAgICAgICAgICAgKiDpgInmi6nkuIDlgI3kuZ/kuI3nlKjnrqHvvIznm7TmjqXlj5HniYzvvIxcclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgQjMuaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHNlbGVjdEJsID0gdGhpcy5iZWlsdi5nZXRDb21wb25lbnQoJ3NlbGVjdEJlaWx2Jyk7XHJcbiAgICAgICAgICAgIHNlbGVjdEJsLl91c2VyaWQgPSB0aGlzLl91c2VyaWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfUmVjZWl2ZUJlaUx2OmZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgbGV0IGJsID0gcmVzcG9uc2UuZGF0YS5iZWlsdjtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICBwbGF5ZXIuc2hvd0JlaWx2KHVzZXJJZCxibCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9SZWNlaXZlUWluZ0xpOmZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICB2YXIgbGVhdmVJZCA9IHJlc3BvbnNlLmRhdGEubGVhdmVJZDtcclxuICAgICAgICBpZihsZWF2ZUlkID09IHRoaXMuX3VzZXJJZCl7XHJcbiAgICAgICAgICAgIGlmKGNjLnFpbmdsaSA9PSBudWxsKXtcclxuICAgICAgICAgICAgICAgIHZhciBxbCA9IHJlc3BvbnNlLmFjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNjLnFpbmdsaSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgY2MucWluZ2xpID0gcWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVEZXNrSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgY2MuZXJyb3IoXCLplJnor6/vvJpcIiwgcmVzcG9uc2UpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcclxuXHJcbiAgICAgICAgdGhpcy5faW5pdFBsYXllckNvbXBvbmVudHMoZGF0YS5wbGF5ZXJzSW5kZXhBeXkpO1xyXG4gICAgICAgIC8qIyMjIyPmt7vliqDkupTlkIzmjInpkq4qL1xyXG4gICAgICAgIC8vIGNjLm1vc2hpID0gMDtcclxuXHJcbiAgICAgICAgLy8gaWYoZGF0YS5zZXR0aW5nM1sxXSA9PSB0cnVlKSBjYy5tb3NoaSA9IDE7ICAvLyAg77yf77yf77yfXHJcblxyXG4gICAgICAgIGNjLm1hUGFpID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYoZGF0YS5tYVBhaS5sZW5ndGggPT0gMikgY2MubWFQYWkgPSBkYXRhLm1hUGFpWzBdICsgXCJfXCIgKyBkYXRhLm1hUGFpWzFdO1xyXG5cclxuICAgICAgICBjYy5odWFTZSA9IGRhdGEuc2V0dGluZzNbMl07XHJcblxyXG4gICAgICAgIGNjLmNoYW9TaGlDaHVQYWkgPSBkYXRhLnNldHRpbmc2O1xyXG5cclxuICAgICAgICBjYy5kdW9ZaVNlID0gcmVzcG9uc2UuZGF0YS5zZXR0aW5nMjsgICAvL3NldHRpbmcy5Li6IDR+NyDkurrvvIgwfjPvvIlcclxuXHJcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX2dsb2JhbE1zZyhkYXRhKTtcclxuICAgICAgICB0aGlzLl91cGRhdEdhbWVPdmVydmlldyh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVSb29tTnVtYmVyKGRhdGEucm9vbUlkKTtcclxuICAgICAgICB0aGlzLm5lZWRDYXJkLnN0cmluZyA9ICBkYXRhLm5lZWRDYXJkOyAgICAgICAgIC8vIOW8gOaUvumcgOimgeeahOaIv+WNoVxyXG4gICAgICAgIGxldCBwbGF5ZXJJbmRleHMgPSBkYXRhLnBsYXllcnNJbmRleDsgICAvLyBbMTAwMDQ5XVxyXG4gICAgICAgIHRoaXMuX2luamVjdFVzZXJJZFRvUGxheWVyQ29tcG9uZW50cyhwbGF5ZXJJbmRleHMpO1xyXG5cclxuICAgICAgICBsZXQgcGxheWVycyA9IGRhdGEucGxheWVycztcclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHBsYXllcnMpO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZVVzZXJTY29yZXMoKTtcclxuICAgICAgICB0aGlzLl91cGRhdGVCYW5rZXIoKTtcclxuICAgICAgICB0aGlzLl9tc2dDb250cm9sLmFkZFBsYXllckluZm9zKHRoaXMuX3BsYXllckluZm9zKTtcclxuXHJcbiAgICAgICAgbGV0IGN1cnJlbnRVc2VySW5mbyA9IHBsYXllcnMuZmluZChmdW5jdGlvbiAocGxheWVySW5mbykge1xyXG4gICAgICAgICAgICByZXR1cm4gcGxheWVySW5mby5pZCA9PSB0aGlzLl91c2VySWQ7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgaWYoZGF0YS5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpe1xyXG4gICAgICAgICAgICBpZihkYXRhLmNJbmRleD4wKXsgIC8vIOW8gOWni+a4uOaIj+S6hu+8jOivt+emu+aMiemSruWFqOmDqOmakOiXj1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd1FpbmdsaShmYWxzZSxkYXRhLmNJbmRleCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9ZWxzZXsgICAgICAgICAgICAgIC8vIOa4uOaIj+ayoeW8gOWni++8jOaIv+S4u+eahOivt+emu+aMiemSruS4jeaYvuekulxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihkYXRhLmNyZWF0ZUlkID09IHBsYXllci51c2VySWQgKXsgIC8vIOaIkeaYr+aIv+S4u++8jOS4jeaYvuekuuaIkeeahOivt+emu+aMiemSrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd1FpbmdsaSh0cnVlLGRhdGEuY0luZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLnNob3dRaW5nbGkoZmFsc2UsZGF0YS5jSW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIGlmKGRhdGEuY3JlYXRlSWQgPT0gcGxheWVyLnVzZXJJZCl7Ly/mmL7npLrmiL/kuLtcclxuICAgICAgICAgICAgICAgIHBsYXllci5zaG93RmFuZ1podVN0YXR1cyhkYXRhLmNyZWF0ZUlkLHRydWUpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHBsYXllci5zaG93RmFuZ1podVN0YXR1cyhwbGF5ZXIudXNlcklkLGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5fZGVza0luZm8uY3JlYXRlSWQgIT0gdGhpcy5fdXNlcklkICl7ICAvLyDpnZ7luoTlrrZcclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDAgKXsgICAgICAgICAgICAvLyDlpoLmnpzov5jmsqHlvIDlp4vmuLjmiI/vvIzmmL7npLrpgIDlh7rmjInpkq7vvIzpmpDol4/op6PmlaPmjInpkq5cclxuICAgICAgICAgICAgICAgIHRoaXMuZXhpdC5hY3RpdmUgPSAgdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuRGlzc29sdmUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1lbHNleyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Y+N5LmLXHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4aXQuYWN0aXZlID0gIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5EaXNzb2x2ZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5bqE5a62XHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA+IDAgKXsgICAgICAgICAgICAgLy8g5byA5bGA5LqGIOmakOiXj+mAgOWHuuaMiemSrlxyXG4gICAgICAgICAgICAgICAgdGhpcy5leGl0LmFjdGl2ZSA9ICBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuRGlzc29sdmUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNleyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5rKh5byA5bGAIOS4pOS4qumDveaYvuekulxyXG4gICAgICAgICAgICAgICAgdGhpcy5leGl0LmFjdGl2ZSA9ICB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5EaXNzb2x2ZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2dhbWVTdGF0dXMgPSBHQU1FU1RBVFVTLldBSVRfUkVBRFk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvcih2YXIgaT0wO2k8cGxheWVycy5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgdmFyIHMgPSBwbGF5ZXJzW2ldO1xyXG4gICAgICAgICAgICB2YXIgaXMgPSBzLnJlYWR5U3RhdHVzOy8vdHJ1ZS9mYWxzZVxyXG4gICAgICAgICAgICB2YXIgdXNlcklkID0gcy5pZDtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgIGlmKCF0aGlzLl9kZXNrSW5mby5pc0NCZWdpbikgcGxheWVyLnNob3dSZWFkeVN0YXR1cyh1c2VySWQsaXMpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY3VycmVudFVzZXJJbmZvICYmIGN1cnJlbnRVc2VySW5mby5jYXJkcy5sZW5ndGggPiAwICYmIHRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luKSB7XHJcbiAgICAgICAgICAgIGlmKCFjdXJyZW50VXNlckluZm8uY2FyZEluZm8ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0R2FtZSh0cnVlKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFydEdhbWUoZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKGN1cnJlbnRVc2VySW5mbykgJiYgIXRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NvY2tldFJlY2VpdmVHYW1lT3ZlcihyZXNwb25zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaXNSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVVwZGF0ZURlc2tJbmZvQWJvdXRFeGl0Um9vbSh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgdGhpcy5zaG93Q29tcGFyZUNhcmQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvd0NvbXBhcmVDYXJkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDAgfHwgdGhpcy5fZGVza0luZm8uaXNDQmVnaW4gfHxcclxuICAgICAgICAgICAgIXRoaXMuX2Rlc2tJbmZvLnBsYXllcnMgfHwgdGhpcy5fZGVza0luZm8ucGxheWVycy5sZW5ndGggPD0gMCB8fCB0aGlzLl9kZXNrSW5mby5wbGF5ZXJzWzBdLmNhcmRJbmZvIDw9IDApe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnBsYXlzQ29pbnMuZm9yRWFjaChmdW5jdGlvbihubyl7aWYobm8pIG5vLnJlbW92ZUFsbENoaWxkcmVuKCk7fSk7XHJcblxyXG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG5cclxuICAgICAgICB0aGlzLm5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7cGxheWVyQ29tcC5yZWFkeVRvQ29tcGFyZUNhcmRzKCk7fSk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcblxyXG4gICAgICAgICAgICBpZihwbGF5ZXIubm9kZS5hY3RpdmUpcGxheWVyLnNob3dBbGxDb21wYXJlQ2FyZHModGhpcy5fZGVza0luZm8ucGxheWVycyk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIHRoaXMuc3RhcnRDb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaXNSZWFkeVN0YXR1cygpO1xyXG5cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5faXNUb3RhbEdhbWVPdmVyKCkpIHRoaXMuX3Nob3dUb3RhbEdhbWVSZXN1bHQoKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjUpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2l2ZUZhUGFpOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAvLyAg5Y+R54mM5LqG5byA5aeL5q+U54mM6ZqQ6JeP5o6JXHJcbiAgICAgICAgdGhpcy5zdGFydENvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xyXG4gICAgICAgIHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2dhbWVTdGF0dXMgPSBHQU1FU1RBVFVTLldBSVRfUkVBRFk7XHJcbiAgICAgICAgdGhpcy5fc29ja2V0UmVjZWl2ZURlc2tJbmZvKHJlc3BvbnNlKTtcclxuICAgIH0sXHJcbiAgICBsb2dvdXRBY3Rpb246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnbG9naW4nKTtcclxuICAgICAgICAvL21hbmFnZXIuc2V0VXNlckluZm8oJycpO1xyXG4gICAgICAgIC8vaGFsbC5jYWNoZUltYWdlSW5mbyA9IG51bGw7XHJcbiAgICB9LFxyXG4gICAgX3NvY2tldFJlY2l2ZU9ubGluZVN0YXR1czogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgLy97XCJhY3Rpb25cIjpcInNlbmRPbmxpbmVTdGF0dXNcIixcInJlc3VsdFwiOnRydWUsXCJkYXRhXCI6e1widXNlcklkXCI6MTAwMDQ5LFwic3RhdHVzXCI6MX19XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgY2MuZXJyb3IoXCLplJnor6/vvJpcIiwgcmVzcG9uc2UpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IGRhdGEudXNlcklkO1xyXG4gICAgICAgIGxldCBzdGF0dXMgPSBkYXRhLnN0YXR1cztcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyLnNldFVzZXJPbmxpbmVTdGF0dXModXNlcklkLCBzdGF0dXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjaXZlQ2hhdFRleHRNZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgbGV0IG1lc3NhZ2UgPSByZXNwb25zZS5kYXRhLm1zZztcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyLnNob3dDaGF0VGV4dCh1c2VySWQsIG1lc3NhZ2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLl9tc2dDb250cm9sLmFkZENoYXRUZXh0TWVzc2FnZSh1c2VySWQsIG1lc3NhZ2UpO1xyXG5cclxuICAgICAgICBsZXQgc2V4ID0gdGhpcy5fcGxheWVySW5mb3MuZmluZChmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdXNlci5pZCA9PSB1c2VySWQ7XHJcbiAgICAgICAgfSkuc2V4O1xyXG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5Q2hhdEF1ZGlvKHNleCwgbWVzc2FnZSk7XHJcbiAgICB9LFxyXG4gICAgX3NvY2tldFJlY2l2ZUNoYXRFbW9qaU1lc3NhZ2UgOmZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgbGV0IGVtb2ppID0gcmVzcG9uc2UuZGF0YS5lbW9qaTtcclxuXHJcbiAgICAgICAgLy90aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgIC8vICAgIHBsYXllci5zaG93Q2hhdFRleHQodXNlcklkLCBlbW9qaSk7XHJcbiAgICAgICAgLy99KTtcclxuICAgICAgICAvL3RoaXMuX21zZ0NvbnRyb2wuYWRkQ2hhdEVtb2ppTWVzc2FnZSh1c2VySWQsIGVtb2ppKTtcclxuICAgICAgICB0aGlzLl9tc2dDb250cm9sLl9sb2FkRW1vamlGcmFtZShlbW9qaSxmdW5jdGlvbihmcmFtZSl7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICBpZihwbGF5ZXIudXNlcklkID09IHVzZXJJZCkgcGxheWVyLmNoYXRNZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoJ0NoYXRNZXNzYWdlJykuc2hvd0Vtb2ppKGZyYW1lKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKVxyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjZWl2ZVJlcXVlc3RFeGl0TWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgLy9pZiAocmVzcG9uc2UuZGF0YS51c2VySWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuO1xyXG4gICAgICAgIC8vfVxyXG5cclxuXHJcbiAgICAgICAgdmFyIGFsZXJ0X2JnID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDaGlsZEJ5TmFtZShcImFsZXJ0X2JnXCIpO1xyXG5cclxuICAgICAgICB2YXIgYnRuQWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkFncmVlXCIpO1xyXG5cclxuICAgICAgICB2YXIgYnRuRGlzYWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkRpc2FncmVlXCIpO1xyXG5cclxuICAgICAgICBidG5BZ3JlZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICBidG5EaXNhZ3JlZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICB2YXIgZGF0YUluZm9zID0gcmVzcG9uc2UuZGF0YS5pbmZvO1xyXG5cclxuICAgICAgICBpZighdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5hY3RpdmUpe1xyXG5cclxuICAgICAgICAgICAgbGV0IGFsZXJ0Q29tcCA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG5cclxuICAgICAgICAgICAgYWxlcnRDb21wLmFsZXJ0KCk7XHJcblxyXG4gICAgICAgICAgICBhbGVydENvbXAudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jb250ZW50QW5zb3dlckV4aXROb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oaSl7aS5hY3RpdmUgPSBmYWxzZTt9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckluZm9zLmZvckVhY2goZnVuY3Rpb24ocGxheWVySW5mbyxpbmRleCl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHBsYXkgPSB0aGlzLmNvbnRlbnRBbnNvd2VyRXhpdE5vZGUuY2hpbGRyZW5baW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcIm5pY2tuYW1lXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBiYWNrID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcImZhbnpodVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW1nID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcImF2YXRhcl9iZ1wiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwbGF5LmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgbmFtZS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHBsYXllckluZm8ubmlja25hbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gcGxheWVySW5mby5pZCl7Ly/mmL7npLrmiL/kuLtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYmFjay5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYmFjay5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjYy5sb2FkZXIubG9hZCh7dXJsOnBsYXllckluZm8uYXZhdGFyVXJsLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycikgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUoZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGltZy5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IGZyYW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjb3VudGRvd24gPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJyk7XHJcblxyXG4gICAgICAgICAgICBjb3VudGRvd24uc3RhcnRDb3VudGRvd24oNjAsIGZ1bmN0aW9uKGlzVGltZW91dCkge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpc1RpbWVvdXQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGlja0FncmVlT3RoZXJQbGF5ZXJFeGl0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJJbmZvLGluZGV4KXtcclxuXHJcbiAgICAgICAgICAgIHZhciBkYXRhSW5mbyA9IGRhdGFJbmZvc1tpbmRleF07XHJcblxyXG4gICAgICAgICAgICB2YXIgcGxheSA9IHRoaXMuY29udGVudEFuc293ZXJFeGl0Tm9kZS5jaGlsZHJlbltpbmRleF07XHJcblxyXG4gICAgICAgICAgICB2YXIgc3RyID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcImlkXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGRhdGFJbmZvID0gZGF0YUluZm9zW2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgIGlmKGRhdGFJbmZvID09IDEpe1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuX3VzZXJJZCA9PSBwbGF5ZXJJbmZvLmlkKXsvL+aYvuekuuaIv+S4u1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBidG5BZ3JlZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnRuRGlzYWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgc3RyLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCLlkIzmhI9cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG5cclxuICAgICAgICAgICAgICAgIHN0ci5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlUmVxdWVzdEV4aXRSZXN1bHRNZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLl9oaWRlUmVxZXN0RXhpdE5vZGUoKTtcclxuICAgICAgICBpZiAodGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnJlc3VsdCkge1xyXG4gICAgICAgICAgICAvLyDop6PmlaPmiJDlip9cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgICAgIGxldCBuaWNrbmFtZSA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodXNlcklkKS5uaWNrbmFtZTtcclxuICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0LnkgPSAtMTQzO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0LmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gbmlja25hbWUgKyAn5LiN5ZCM5oSP6YCA5Ye6JztcclxuICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGNjLnNwYXduKGNjLm1vdmVUbyguMywgY2MucCgwLCAyMCkpLCBjYy5mYWRlT3V0KHRoaXMuY2FyZFRpbWUpKTtcclxuICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0LnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMSwgY2MucCgwLCAwKSksIGFjdGlvbikpO1xyXG5cclxuICAgICAgICAgICAgLy90aGlzLnNob3dBbGVydE1lc3NhZ2UoJ+ino+aVo+Wksei0pe+8jOWboOS4uicgKyBuaWNrbmFtZSArICfkuI3lkIzmhI/pgIDlh7onKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlQXVkaW9NZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgdGhpcy5wbGF5U3BlYWtBbmltYXRpb24odXNlcklkKTtcclxuXHJcbiAgICAgICAgaWYgKHVzZXJJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHVybCA9IHJlc3BvbnNlLmRhdGEudXJsO1xyXG4gICAgICAgIHRoaXMucGxheUF1ZGlvVXJsKHVybCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlUGxheUNhcmQ6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIC8vIOacieeUqOaIt+W3sue7j+WHhuWkh+WlveS6hueJjFxyXG4gICAgICAgIHZhciB1c2VySWQgPSByZXNwb25zZS5kYXRhWzBdLnVzZXJJZDtcclxuICAgICAgICB2YXIgY2FyZEluZm8gPSByZXNwb25zZS5kYXRhWzFdLmNhcmQ7XHJcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSByZXNwb25zZS5kYXRhWzJdLnM7XHJcbiAgICAgICAgbGV0IHBsYXllcnMgPSByZXNwb25zZS5kYXRhWzJdLnMucGxheWVycztcclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHBsYXllcnMpO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5wbGF5Q2FyZCh1c2VySWQsY2FyZEluZm8pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAodXNlcklkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIF9nZXRTZWxmUmVhZHlTdGF0dXM6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgcmV0dXJuIHNlbGYucmVhZHlTdGF0dXM7XHJcbiAgICB9LFxyXG4gICAgX3NvY2tldFJlY2l2ZVJlYWR5OiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgaWYoIXRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luKSBwbGF5ZXIuc2hvd1JlYWR5U3RhdHVzKHVzZXJJZCk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/mlLbliLDmuLjmiI/nu5PmnZ9cclxuICAgIF9zb2NrZXRSZWNlaXZlR2FtZU92ZXI6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XHJcblxyXG4gICAgICAgIHRoaXMuX2hpZGVSZXFlc3RFeGl0Tm9kZSgpO1xyXG5cclxuICAgICAgICAvLyDkuIDlsYDmuLjmiI/nu5PmnZ9cclxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICBjYy5lcnJvcihcIumUmeivr++8mlwiLCByZXNwb25zZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIGNvbnN0IGRlc2tJbmZvID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICBpZiAocmVzcG9uc2UuYWN0aW9uID09ICdnYW1lT3ZlcicgJiYgZGVza0luZm8uaXNEZXNrT3Zlcikge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgU29ja2V0LnNlbmREaWRSZWNlaXZlR2FtZU92ZXJBY3Rpb24odGhpcy5fdXNlcklkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMuX2Rlc2tJbmZvID0gcmVzcG9uc2UuZGF0YTtcclxuXHJcbiAgICAgICAgLy8g5aaC5p6c5piv5by65Yi26Kej5pWj5oi/6Ze077yM5YiZ55u05o6l5pi+56S65oC75oiQ57upXHJcbiAgICAgICAgaWYgKHRoaXMuX2lzRGlzc3ZsZWRSb29tKCkgJiYgIVBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93VG90YWxHYW1lUmVzdWx0KDAuMSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHRoaXMuX2VudGVyVGltZSA8IDEwMDAgKiA0KSB7XHJcbiAgICAgICAgICAgIC8vIOWImui/m+adpeeahOivne+8jOS4jeWxleekuuavlOeJjOWKqOeUu1xyXG4gICAgICAgICAgICAvLyAgbGV0IG9uZUdhbWVSZXN1bHQgPSB0aGlzLm9uZUdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdHYW1lUmVzdWx0Jyk7XHJcbiAgICAgICAgICAgIC8vICBvbmVHYW1lUmVzdWx0LnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICAgICAgLy8gIG9uZUdhbWVSZXN1bHQuc2hvd1Jlc3VsdHModGhpcy5fZGVza0luZm8sIHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8qKi9cclxuICAgICAgICAgICAgdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzLnB1c2godGhpcy5fZGVza0luZm8uY0luZGV4KTtcclxuICAgICAgICAgICAgLyoqL1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX2JpZ1JlY29yZEluZm8gPSBkYXRhLmJpZ1JlY29yZEluZm9cclxuICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3MDlcIik7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRHYW1lT3ZlcnZpZXcodGhpcy5fZGVza0luZm8pO1xyXG4gICAgICAgIC8vbGV0IHBsYXllckluZGV4cyA9IGRhdGEucGxheWVyc0luZGV4OyAvLyBbMTAwMDQ5XVxyXG5cclxuICAgICAgICBsZXQgcGxheWVycyA9IGRhdGEucGxheWVycztcclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHBsYXllcnMpO1xyXG4gICAgICAgIC8vdGhpcy5fdXBkYXRlUmVjb3JkSW5mbyhwbGF5ZXJzKTtcclxuXHJcbiAgICAgICAgaWYgKFVzZXJNb2RlbEhlbHBlci5pc1VzZXJSZWFkeSh0aGlzLl9maW5kQ3VycmVudFVzZXJJbmZvKCkpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyQ29tcC5yZXNldCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zdGFydENvbXBhcmVDYXJkcyhyZXNwb25zZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHRoaXMuX2VudGVyVGltZSA8IDEwMDAgKiA0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0NvbXBhcmVDYXJkKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8gX3VwZGF0ZVJlY29yZEluZm86ZnVuY3Rpb24ocGxheWVycyl7XHJcblxyXG4gICAgLy8gICAgIC8vIHRoaXMuX2JpZ1JlY29yZEluZm8ucHVzaCgpO1xyXG4gICAgLy8gfSxcclxuICAgIF9zb2NrZXRSZWNlaXZlRGlzc29sdmVEZXNrOiBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuXHJcbiAgICAgICAgLy8gdGhpcy5hbGVydC5nZXRDb21wb25lbnQoJ2FsZXJ0Jykuc2V0V2lsbERpc21pc3NDYWxsYmFjayhmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAvLyAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIC8vIH0pO1xyXG5cclxuICAgICAgICAvLyBsZXQgbWVzc2FnZSA9IFwi5oi/5Li75bey6Kej5pWj5oi/6Ze0XCI7XHJcbiAgICAgICAgLy8gaWYgKHRoaXMuX2lzUmFuZG9tUm9vbSgpKSB7XHJcbiAgICAgICAgLy8gICBtZXNzYWdlID0gXCLmnInnjqnlrrblt7LlvLrliLbpgIDlh7rmiL/pl7TvvIzmuLjmiI/nu5PmnZ/jgILmnKzlsYDmuLjmiI/kuI3kvJrmiaPpmaTmgqjnmoTpkrvnn7PjgIJcIjtcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIC8vIHRoaXMuc2hvd0FsZXJ0TWVzc2FnZShtZXNzYWdlLCBmYWxzZSk7XHJcbiAgICB9LFxyXG4gICAgLyoqL1xyXG4gICAgX3NvY2tldExlYXZlRGVzazogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmlzRGVza092ZXIpIHtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5oi/6Ze05bey57uT5p2f77yM5Lmf5LiN55So5YaN6Ieq5Yqo6YCA5Zue5Yiw5aSn5Y6F5LqGXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgfSxcclxuICAgIC8qKi9cclxuICAgIC8vIHNvY2tldCDmlLbliLDmnInkurrmiYvmnLrov5vlhaXlkI7lj7Dmtojmga9cclxuICAgIF9zb2NrZXRSZWNlaXZlUGF1c2U6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXIpIHtcclxuICAgICAgICAgICAgaWYgKHBsYXllci51c2VySWQgPT0gdXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXIuc2V0VXNlck9ubGluZVN0YXR1cyh1c2VySWQsIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yZWNlaXZlU29ja2V0Q29ubmVjdEVycm9yOiBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMuc2hvd05ldHdvcmtNZXNzYWdlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yZWNlaXZlU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZDogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLmhpZGRlbk5ldHdvcmtNZXNzYWdlKCk7XHJcblxyXG4gICAgICAgIGlmICghUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWREZXNrSW5mbygpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICAvLyBNQVJLOiDmm7TmlrDmiL/pl7Tkv6Hmga9cclxuICAgIHVwZGF0ZURlc2tJbmZvOiBmdW5jdGlvbiAoZGVza0luZm8pIHtcclxuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IGRlc2tJbmZvO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0R2FtZU92ZXJ2aWV3KHRoaXMuX2Rlc2tJbmZvKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVJvb21OdW1iZXIoZGVza0luZm8ucm9vbUlkKTtcclxuXHJcbiAgICAgICAgbGV0IHBsYXllckluZGV4cyA9IGRlc2tJbmZvLnBsYXllcnNJbmRleDsgLy8gWzEwMDA0OV1cclxuICAgICAgICB0aGlzLl9pbmplY3RVc2VySWRUb1BsYXllckNvbXBvbmVudHMocGxheWVySW5kZXhzKTtcclxuXHJcbiAgICAgICAgbGV0IHBsYXllcnMgPSBkZXNrSW5mby5wbGF5ZXJzO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gcGxheWVycztcclxuICAgICAgICB0aGlzLl91cGRhdGVVc2VySW5mb3MocGxheWVycyk7XHJcbiAgICAgICAgdGhpcy5fbXNnQ29udHJvbC5hZGRQbGF5ZXJJbmZvcyh0aGlzLl9wbGF5ZXJJbmZvcyk7XHJcbiAgICAgICAgaWYgKGRlc2tJbmZvLmNJbmRleCA9PSAwICYmIHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMubGVuZ3RoIDwgdGhpcy5fZGVza0luZm8ubWF4TnVtYmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICBfaW5qZWN0VXNlcklkVG9QbGF5ZXJDb21wb25lbnRzOiBmdW5jdGlvbiAocGxheWVySW5kZXhzKSB7XHJcbiAgICAgICAgbGV0IGN1cnJlbnRVc2VySWRJbmRleCA9IHBsYXllckluZGV4cy5maW5kSW5kZXgoZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdXNlcklkID09IHRoaXMuX3VzZXJJZDtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICBsZXQgZml4ZWRQbGF5ZXJJbmRleHMgPSBwbGF5ZXJJbmRleHMudHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleChjdXJyZW50VXNlcklkSW5kZXgpO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcG9uZW50LCBpbmRleCkge1xyXG4gICAgICAgICAgICBsZXQgdXNlcklkID0gZml4ZWRQbGF5ZXJJbmRleHMubGVuZ3RoID4gaW5kZXggPyBmaXhlZFBsYXllckluZGV4c1tpbmRleF0gOiBudWxsO1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wb25lbnQudXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfdXBkYXRlVXNlckluZm9zOiBmdW5jdGlvbiAodXNlckluZm9zKSB7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcG9uZW50LCBpbmRleCkge1xyXG4gICAgICAgICAgICAvL3BsYXllckNvbXBvbmVudC5zZXREZXNrSW5mbyhzZWxmLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgICAgIC8qKi9cclxuICAgICAgICAgICAgcGxheWVyQ29tcG9uZW50LnVwZGF0ZURlc2tJbmZvKHNlbGYuX2Rlc2tJbmZvKTtcclxuICAgICAgICAgICAgLyoqL1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wb25lbnQudXBkYXRlVXNlckluZm9XaXRoVXNlcnModXNlckluZm9zKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy90aGlzLl9oYW5kbGVUaGVTYW1lT2ZJUEFkcmVzcyh1c2VySW5mb3MpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfdXBkYXRlVXNlclNjb3JlczogZnVuY3Rpb24odXNlckluZm9zKSB7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllcikge1xyXG4gICAgICAgICAgICBwbGF5ZXIudXBkYXRlU2NvcmUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIF91cGRhdGVCYW5rZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyLnVwZGF0ZUJhbmtlcigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDnp4HmnInmlrnms5VcclxuICAgIF9maW5kQ2FyZHNCeVVzZXJJZDogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIGxldCBwbGF5ZXIgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHVzZXJJZCk7XHJcblxyXG4gICAgICAgIHJldHVybiAocGxheWVyICE9IG51bGwpID8gcGxheWVyLmNhcmRzIDogbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQ6IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICBsZXQgcGxheWVyID0gKHRoaXMuX3BsYXllckluZm9zIHx8IFtdKS5maW5kKGZ1bmN0aW9uIChwbGF5ZXJJbmZvKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1c2VySWQgPT0gcGxheWVySW5mby5pZDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHBsYXllcjtcclxuICAgIH0sXHJcblxyXG4gICAgX2ZpbmRQbGF5ZXJJbmRleEJ5VXNlcklkOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgLy9sZXQgaW5kZXggPSB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZpbmRJbmRleChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgIC8vICAgIHJldHVybiBwbGF5ZXJDb21wLnVzZXJJZCA9PSB1c2VySWQ7XHJcbiAgICAgICAgLy99KTtcclxuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLnBsYXllck5vZGVzLmZpbmRJbmRleChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRDb21wb25lbnQoJ1BsYXllcicpLnVzZXJJZCA9PSB1c2VySWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGluZGV4O1xyXG4gICAgfSxcclxuXHJcbiAgICBfZmluZEN1cnJlbnRVc2VySW5mbzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lczogZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICAgICAgLy8gW3tcInN1aXRcIjpcInNcIixcIm51bWJlclwiOjEwfV1cclxuICAgICAgICBsZXQgc3VpdENvbG9yTWFwID0ge1xyXG4gICAgICAgICAgICBzOiA0LFxyXG4gICAgICAgICAgICBoOiAzLFxyXG4gICAgICAgICAgICBjOiAyLFxyXG4gICAgICAgICAgICBkOiAxLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgICAgICB2YXIgY2FyZE51bWJlciA9IGNhcmQubnVtYmVyO1xyXG5cclxuICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Lit55qEIDE0IOaYryBBXHJcbiAgICAgICAgICAgIGlmIChjYXJkLm51bWJlciA9PSAxNCkge1xyXG4gICAgICAgICAgICAgICAgY2FyZE51bWJlciA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGNvbG9yID0gc3VpdENvbG9yTWFwW2NhcmQuc3VpdF07XHJcbiAgICAgICAgICAgIGxldCBudW1iZXIgPSBNYXRoLm1heChNYXRoLm1pbihjYXJkTnVtYmVyLCAyMSksIDEpO1xyXG4gICAgICAgICAgICByZXR1cm4gY29sb3IgKyBcIl9cIiArIG51bWJlcjtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5pu05paw5ri45oiP5oC76KeI5L+h5oGvXHJcbiAgICBfdXBkYXRHYW1lT3ZlcnZpZXc6IGZ1bmN0aW9uIChkZXNrSW5mbykge1xyXG4gICAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5sYWJlbE92ZXJ2aWV3LnN0cmluZyA9IFwi5Zue5pS+XCI7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsT3ZlcnZpZXcuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYmlodWFzZSA9IFwi5LiN5q+U6Iqx6ImyIFwiO1xyXG4gICAgICAgIHZhciB6dW96aHVhbmcgPSBcIuS4jeWdkOW6hCBcIjtcclxuICAgICAgICB2YXIgcHV0b25nICA9IFwi5pmu6YCa5Zy6IFwiO1xyXG4gICAgICAgIHZhciB3dWd1aSA9ICBcIuaXoOmsvCBcIjtcclxuICAgICAgICB2YXIgbWFQYWkgPSAn5LiN5Lmw6amsICc7XHJcbiAgICAgICAgdmFyIHJlbnNodSA9IFwiNOS6uuS4jeWKoOiJsiBcIjtcclxuICAgICAgICB2YXIgY2FyZCA9IFwi5bmz5pGKXCI7XHJcblxyXG4gICAgICAgIC8vW+eWr+eLguWcuizprLzniYws5q+U6Iqx6ImyLOWdkOW6hCzpqazniYxdXHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzNbMl0pe1xyXG4gICAgICAgICAgICBiaWh1YXNlID0gXCLmr5ToirHoibIgIFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nM1szXSl7XHJcbiAgICAgICAgICAgIHp1b3podWFuZyA9IFwi5Z2Q5bqEIFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nM1swXSl7XHJcbiAgICAgICAgICAgIHB1dG9uZyA9IFwi55av54uC5Zy6ICBcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzNbMV0pe1xyXG4gICAgICAgICAgICB3dWd1aSA9IFwi5pyJ6ay8ICBcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzNbNF0pe1xyXG4gICAgICAgICAgICBtYVBhaSA9IFwi5Lmw6amsXCI7XHJcbiAgICAgICAgICAgIHZhciBodWFTZSA9IFwi5pa55Z2XXCI7XHJcbiAgICAgICAgICAgIHZhciBkaWFuU2h1ID0gMVxyXG4gICAgICAgICAgICBzd2l0Y2godGhpcy5fZGVza0luZm8uc2V0dGluZzdbMF0peyAvL3NldHRpbmc3IFsxfjQsMX4xM10g6KGo56S6IFvoirHoibLvvIzngrnmlbBdXHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6IGh1YVNlID0gXCLmlrnlnZdcIjticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMjogaHVhU2UgPSBcIuaiheiKsVwiO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOiBodWFTZSA9IFwi57qi5b+DXCI7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IGh1YVNlID0gXCLpu5HmoYNcIjticmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzd2l0Y2godGhpcy5fZGVza0luZm8uc2V0dGluZzdbMV0pe1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOiBkaWFuU2h1ID0gJ0EnO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOiBkaWFuU2h1ID0gMjticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMzogZGlhblNodSA9IDM7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IGRpYW5TaHUgPSA0O2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBkaWFuU2h1ID0gNTticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNjogZGlhblNodSA9IDY7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IGRpYW5TaHUgPSA3O2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA4OiBkaWFuU2h1ID0gODticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgOTogZGlhblNodSA9IDk7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDEwOiBkaWFuU2h1ID0gMTA7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDExOiBkaWFuU2h1ID0gJ0onO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxMjogZGlhblNodSA9ICdRJzticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMTM6IGRpYW5TaHUgPSAnSyc7YnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbWFQYWkgPSBodWFTZStkaWFuU2h1K21hUGFpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzIgPT0gMSl7XHJcbiAgICAgICAgICAgIHJlbnNodSA9IFwiNeS6uuWKoOS4gOiJsiBcIjtcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nMiA9PSAyKXtcclxuICAgICAgICAgICAgcmVuc2h1ID0gXCI25Lq65Yqg5LqM6ImyIFwiO1xyXG4gICAgICAgIH1lbHNlIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcyID09IDMpe1xyXG4gICAgICAgICAgICByZW5zaHUgPSBcIjfkurrliqDkuInoibIgXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc0ID09IDEpe1xyXG4gICAgICAgICAgICBjYXJkID0gXCLotaLogIXmiaMgXCI7XHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzQgPT0gMil7XHJcbiAgICAgICAgICAgIGNhcmQgPSBcIuaIv+S4u+aJoyBcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubGFiZWxPdmVydmlldy5zdHJpbmcgPSBcIuaooeW8jyA6IFwiK2JpaHVhc2UrenVvemh1YW5nK3B1dG9uZyt3dWd1aSttYVBhaStcIlxcblwiK1wi5YW25LuW77yaXCIrcmVuc2h1K2NhcmQ7XHJcbiAgICAgICAgLy90aGlzLmxhYmVsT3ZlcnZpZXcuc3RyaW5nID0gXCLmqKHlvI8gOiBcIiArIFwiXCIgKyBkZXNrSW5mby5tYXhOdW1iZXIgKyBcIuS6ulwiICtiaWh1YXNlK3p1b3podWFuZytwdXRvbmcrd3VndWkrbWFQYWk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaYr+WQpuaYr+maj+acuuaIv1xyXG4gICAgX2lzUmFuZG9tUm9vbTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mbyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rlc2tJbmZvLmlzUmFuZG9tRGVzaztcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5piv5ZCm5omA5pyJ5bGA5pWw6YO955So5a6M5LqGXHJcbiAgICBfaXNUb3RhbEdhbWVPdmVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmlzRGVza092ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVza0luZm8ubU1heCA8PSB0aGlzLl9kZXNrSW5mby5jSW5kZXg7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaYr+WQpuW3suino+aVo+aIv+mXtFxyXG4gICAgX2lzRGlzc3ZsZWRSb29tOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kZXNrSW5mby5kaXNzb2x2ZVN0YXR1cztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIF9zdGFydENvbXBhcmVDYXJkczogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICB0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9nb25nWGlOaVNob3coZmFsc2UpO1xyXG4gICAgICAgIHRoaXMuX3BsYXllcnMgPSBkYXRhLmRhdGEucGxheWVycztcclxuICAgICAgICBsZXQgdXNlciA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodGhpcy5fdXNlcklkKTtcclxuICAgICAgICBpZighdGhpcy50b3RhbEdhbWVSZXN1bHQuYWN0aXZlKXtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlTdGFydENvbXBhcmUodXNlci5zZXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnN0YXJ0Q29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtwbGF5ZXJDb21wLnJlYWR5VG9Db21wYXJlQ2FyZHMoKTt9KTtcclxuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRDb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93Q29tcGFyZUNhcmREZXRhaWxzKGRhdGEpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSwgMS4wKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3Nob3dDb21wYXJlQ2FyZERldGFpbHM6IGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucmVhZHlUb0NvbXBhcmVDYXJkcygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgY2FyZFR5cGVDb21iaW5lID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVDb21iaW5lJyk7XHJcblxyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZXNldCgpO1xyXG5cclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IGNvbXBhcmVQbGF5ZXJzMSA9IHRoaXMuX3BsYXllckNvbXBvbmVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuXHJcbiAgICAgICAgICAgIGlmKHBsYXllci5ub2RlLmFjdGl2ZSl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXIgPSBwbGF5ZXIuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCF1c2VyLmlzQ29udGFpbkV4dHJhKSByZXR1cm4gcGxheWVyLm5vZGUuYWN0aXZlO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgdGVTaHVQbGF5ZXJzID0gdGhpcy5fcGxheWVyQ29tcG9uZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYXllcikge1xyXG5cclxuICAgICAgICAgICAgaWYocGxheWVyLm5vZGUuYWN0aXZlKXtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHBsYXllci5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXI7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYodXNlci5pc0NvbnRhaW5FeHRyYSkgcmV0dXJuIHBsYXllci5ub2RlLmFjdGl2ZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gdGhpcy5fc2hvd0NvbXBhcmVDYXJkU3RlcCgwLCBjb21wYXJlUGxheWVyczEpO1xyXG5cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7c2VsZi5fc2hvd0NvbXBhcmVDYXJkU3RlcCgwLCBjb21wYXJlUGxheWVyczEpO30sIGR1cmF0aW9uKTtcclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3NlbGYuX3Nob3dDb21wYXJlQ2FyZFN0ZXAoMCwgY29tcGFyZVBsYXllcnMxKTt9LCBkdXJhdGlvbiAqIDIpO1xyXG5cclxuICAgICAgICBpZih0ZVNodVBsYXllcnMubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtzZWxmLl9zaG93Q29tcGFyZUNhcmRTdGVwKDAsIHRlU2h1UGxheWVycywgdHJ1ZSk7fSwgZHVyYXRpb24gKiAzKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uICogMyArIDAuNTtcclxuXHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRlU2h1UGxheWVycy5sZW5ndGg7IGkrKyl7XHJcblxyXG4gICAgICAgICAgICB2YXIgdXNlciA9IHRlU2h1UGxheWVyc1tpXS5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXI7XHJcblxyXG4gICAgICAgICAgICBpZih1c2VyLmlzQ29udGFpbkV4dHJhKWR1cmF0aW9uID0gZHVyYXRpb24gKyAyLjVcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgc2hvb3REdXJhdGlvbiA9IHRoaXMuaGVhZENhcmRUaW1lO1xyXG5cclxuICAgICAgICBsZXQgc2hvb3REYXRhcyA9IHRoaXMuX3Nob290RGF0YXMoKSB8fCBbXTtcclxuXHJcbiAgICAgICAgbGV0IHNob3REYXRhID0gdGhpcy5fc2hvdERhdGEoKSB8fCBbXTtcclxuXHJcbiAgICAgICAgbGV0IGhvbWVSdW5Vc2VySWQgPSB0aGlzLl9ob21lUnVuVXNlcklkKCk7XHJcblxyXG4gICAgICAgIHZhciBzaG90RGF0YVRpbWVzID0gMDtcclxuXHJcbiAgICAgICAgc2hvdERhdGEuZm9yRWFjaChmdW5jdGlvbiAoZGF0YSwgaW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxmLnBsYXlTaG9vdChkYXRhLmZyb21Vc2VySWQsIGRhdGEudG9Vc2VySWQpO1xyXG5cclxuICAgICAgICAgICAgfSwgZHVyYXRpb24gKyBpbmRleCAqIHNob290RHVyYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgc2hvdERhdGFUaW1lcyArPSBzZWxmLmhlYWRDYXJkVGltZTtcclxuXHJcbiAgICAgICAgICAgIGR1cmF0aW9uICs9IHNlbGYuaGVhZENhcmRUaW1lO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYoaG9tZVJ1blVzZXJJZC5sZW5ndGggPj0gMSl7XHJcblxyXG4gICAgICAgICAgICBzaG9vdERhdGFzLmZvckVhY2goZnVuY3Rpb24gKGRhdGEsIGluZGV4KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnBsYXlTaG9vdChkYXRhLmZyb21Vc2VySWQsIGRhdGEudG9Vc2VySWQpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0sIGR1cmF0aW9uICsgKGluZGV4ICsgc2hvdERhdGFUaW1lcykgKiBzaG9vdER1cmF0aW9uKTtcclxuXHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiArPSBzZWxmLmhlYWRDYXJkVGltZTtcclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyBzaG9vdERhdGFzLmxlbmd0aCAqIHNob290RHVyYXRpb24gKyBzaG90RGF0YS5sZW5ndGggKiBzaG9vdER1cmF0aW9uO1xyXG5cclxuICAgICAgICBpZiAoaG9tZVJ1blVzZXJJZCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtzZWxmLnBsYXlIb21lUnVuKGhvbWVSdW5Vc2VySWQpO30sIGR1cmF0aW9uKTtcclxuXHJcbiAgICAgICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhvbWVSdW5Vc2VySWQpIHtcclxuICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbiArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL3RoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHt0aGlzLl9qaW5CaUFjdGlvbigpO30uYmluZCh0aGlzKSwgZHVyYXRpb24pOy8v5pi+56S657uT566X6YeR5biBLy/mmL7npLrnu5PmnpxcclxuICAgICAgICB0aGlzLl9qaW5CaUFjdGlvbihkdXJhdGlvbik7XHJcbiAgICAgICAgLy90aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtwbGF5ZXJDb21wLnNob3dTY29yZVJlc3VsdCgpO30pO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgc2VsZi5fc2hvd0NvbXBhcmVDYXJkRmluaXNoZWQoKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vfS5iaW5kKHRoaXMpLCBkdXJhdGlvbik7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfamluQmlBY3Rpb246IGZ1bmN0aW9uIChkdXJhdGlvbikge1xyXG4gICAgICAgIHZhciBjb21wYXJlUGxheWVyczEgPSB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZpbHRlcihmdW5jdGlvbiAocGxheWVyKSB7cmV0dXJuIHBsYXllci5ub2RlLmFjdGl2ZTt9KTtcclxuXHJcbiAgICAgICAgdmFyIG5leHRUaW1lID0gMDsvL+S4i+S4gOS4quWKqOS9nOW8gOWni+eahOaXtumXtFxyXG5cclxuICAgICAgICB2YXIgelRpbWUgPSAwOy8v5LiL5LiL5LiA5Liq5Yqo5L2c5byA5aeL55qE5pe26Ze0XHJcblxyXG4gICAgICAgIHZhciBzdGFydCA9IDA7XHJcblxyXG4gICAgICAgIHZhciBlbmQgPSAwO1xyXG5cclxuICAgICAgICB2YXIgY29pbnNDb250YWluZXJBeXkgPSBbXTsgLy/miYDmnInnmoTnlKjmiLfnmoTph5HluIEg5LiA5Liq55So5oi35LiA5Liq5pWw57uEXHJcblxyXG4gICAgICAgIHZhciBjb2luc0F5eSA9IFtdOyAvL+aJgOacieeahOmHkeW4ge+8jOS4gOS4quaVsOe7hFxyXG5cclxuICAgICAgICB0aGlzLnBsYXlzQ29pbnMuZm9yRWFjaChmdW5jdGlvbihubyl7aWYobm8pIG5vLnJlbW92ZUFsbENoaWxkcmVuKCk7fSk7XHJcblxyXG4gICAgICAgIGNvbXBhcmVQbGF5ZXJzMS5mb3JFYWNoKGZ1bmN0aW9uKHBsYXlzLCBpbmRleCl7Ly/moLnmja7np6/liIbliJvlu7rph5HluIFcclxuXHJcbiAgICAgICAgICAgIHZhciBjU2NvcmUgPSBwbGF5cy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXIuY1Njb3JlO1xyXG5cclxuICAgICAgICAgICAgaWYoY1Njb3JlIDwgMCl7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIGNTY29yZSAqPSAtMTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IG5ldyBjYy5Ob2RlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgbm9kZS5uYW1lID0gXCJjb2luc0NvbnRhaW5lclwiO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBudW1TY29yZSA9ICBjU2NvcmUgPiAzMCA/IDMwOmNTY29yZTtcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDAgO2kgPCBudW1TY29yZSA7aSsrKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jcmVhdGVKaW5CaVByZWZhYihub2RlLCBub2RlKTsvL+agueaNruenr+WIhuWIm+W7uumHkeW4gVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMucGxheXNDb2luc1tpbmRleF0uYWRkQ2hpbGQobm9kZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29pbnNDb250YWluZXJBeXkucHVzaChub2RlLmNoaWxkcmVuKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5c0NvaW5zLmZvckVhY2goZnVuY3Rpb24obm8pe2lmKG5vKSBuby5hY3RpdmUgPSBmYWxzZTt9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7Ly/mmL7npLrnu5PmnpxcclxuXHJcbiAgICAgICAgICAgIHRoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vKXtpZihubykgbm8uYWN0aXZlID0gdHJ1ZTt9KTtcclxuXHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5jb2luSW5jb21lKCk7XHJcblxyXG4gICAgICAgICAgICBjb2luc0NvbnRhaW5lckF5eS5mb3JFYWNoKGZ1bmN0aW9uKGNvaW5zQXl5cyl7Ly/miorph5HluIHnp7vliqjliLDlrrnlmahcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW5pdFRpbWUgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IDAuMDAyO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvaW5zQXl5cy5mb3JFYWNoKGZ1bmN0aW9uKGNvaW5zKXsvL+aKiumHkeW4geenu+WKqOWIsOWuueWZqFxyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozOCkgKiB5O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozOCkgKiB4O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZEJhY2tXb3JsZFNwYWNlMSA9IHRoaXMubm9kZS5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoeCwgeSkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgdjIgPSBjb2lucy5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UxKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2lucy5ydW5BY3Rpb24oY2MubW92ZUJ5KDAuMiwgdjIpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgaW5pdFRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpbml0VGltZSA9IGluaXRUaW1lICsgaW50ZXJ2YWw7XHJcblxyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBuZXh0VGltZSA9IGluaXRUaW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvaW5zQXl5ID0gY29pbnNBeXkuY29uY2F0KGNvaW5zQXl5cyk7Ly/miorph5HluIHpm4blkIjliLDkuIDkuKrmlbDnu4RcclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgemNTY29yZSA9IDA7XHJcblxyXG4gICAgICAgICAgICBjb21wYXJlUGxheWVyczEuZm9yRWFjaChmdW5jdGlvbihwbGF5cyl7Ly/orqHnrpfph5HluIFcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY1Njb3JlID0gcGxheXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyLmNTY29yZTtcclxuXHJcbiAgICAgICAgICAgICAgICBjU2NvcmUgPSAgY1Njb3JlID4gMzAgPyAzMDpjU2NvcmU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoY1Njb3JlID4gMCkgemNTY29yZSArPSBjU2NvcmUgKiAxO1xyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBjb2luc0F5eTEgPSBjb2luc0F5eS5zcGxpY2UoemNTY29yZSwgY29pbnNBeXkubGVuZ3RoKTtcclxuXHJcbiAgICAgICAgICAgIGNvaW5zQXl5MS5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe25vZGUucGFyZW50LnJlbW92ZUNoaWxkKG5vZGUpO30pO1xyXG5cclxuICAgICAgICAgICAgY29tcGFyZVBsYXllcnMxLmZvckVhY2goZnVuY3Rpb24ocGxheXMpey8v5oqK6YeR5biB5Yiw55So5oi35aS05YOP6ZmE6L+RXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNTY29yZSA9IHBsYXlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlci5jU2NvcmU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoY1Njb3JlID4gMCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IDAuMDAyNTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRUaW1lID0gbmV4dFRpbWUgKyAxO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbnVtU2NvcmUgPSAgY1Njb3JlID4gMzAgPyAzMDpjU2NvcmU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vZW5kICs9IG51bVNjb3JlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb2luc0F5eS5zcGxpY2UoMCwgbnVtU2NvcmUpLmZvckVhY2goZnVuY3Rpb24oY29pbnNOb2RlKXsvL+aKiumHkeW4geWIsOeUqOaIt+WktOWDj+mZhOi/kVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/ojrflj5boioLngrnnmoTkuJbnlYzlnZDmoIdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYXJkQmFja1dvcmxkU3BhY2UxID0gcGxheXMubm9kZS5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoMCwgMCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/ojrflj5bnm7jlr7nniLboioLngrnmiYDlnKjnmoTlnZDmoIdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZXRhaWwgPSBjb2luc05vZGUuY29udmVydFRvTm9kZVNwYWNlQVIoY2FyZEJhY2tXb3JsZFNwYWNlMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vdmVCeSA9IGNjLm1vdmVCeSgwLjI1LCBkZXRhaWwpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0RmFkZUluID0gY2MuZmFkZU91dCgwLjEzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW92ZVNlcSA9Y2Muc2VxdWVuY2UobW92ZUJ5LG5leHRGYWRlSW4pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvaW5zTm9kZS5ydW5BY3Rpb24obW92ZVNlcSkgO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgaW5pdFRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdFRpbWUgPSBpbml0VGltZSArIGludGVydmFsO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL3N0YXJ0ICs9IGNTY29yZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgelRpbWUgPSBpbml0VGltZTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7Ly/mmL7npLrnu5PmnpxcclxuXHJcbiAgICAgICAgICAgICAgICAvL3RoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vKXtpZihubykgbm8uYWN0aXZlID0gZmFsc2U7fSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2hvd0NvbXBhcmVDYXJkRmluaXNoZWQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb21wYXJlUGxheWVyczEuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge3BsYXllckNvbXAuc2hvd1Njb3JlUmVzdWx0KCk7fSk7XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIHpUaW1lKTtcclxuXHJcblxyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHsvL+aYvuekuue7k+aenFxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vKXtpZihubykgbm8ucmVtb3ZlQWxsQ2hpbGRyZW4oKTt9KTtcclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgelRpbWUgKyA1KTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCBkdXJhdGlvbik7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfY3JlYXRlSmluQmlQcmVmYWI6IGZ1bmN0aW9uIChub2RlLHYyTm9kZSkge1xyXG5cclxuICAgICAgICB2YXIgbm9kZXMgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmNvaW5zUHJlZmFiKTtcclxuXHJcbiAgICAgICAgdmFyIHkgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkpID09IDAgPyAtMSA6IDE7XHJcblxyXG4gICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMzgpICogeSArIHYyTm9kZS55O1xyXG5cclxuICAgICAgICB2YXIgeCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcclxuXHJcbiAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozOCkgKiB4ICsgdjJOb2RlLng7XHJcblxyXG4gICAgICAgIG5vZGVzLnggPSB4O1xyXG5cclxuICAgICAgICBub2Rlcy55ID0geTtcclxuXHJcbiAgICAgICAgbm9kZS5hZGRDaGlsZChub2Rlcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zaG93Q29tcGFyZUNhcmRTdGVwOiBmdW5jdGlvbiAoc3RhcnRUaW1lID0gMCwgY29tcGFyZVBsYXllcnMgPSBbXSwgaXNDb250YWluRXh0cmEgPSBmYWxzZSkge1xyXG4gICAgICAgIHZhciBkdXJhdGlvbiA9IHN0YXJ0VGltZTtcclxuICAgICAgICBsZXQgaW50ZXJ2YWwgPSB0aGlzLmhlYWRDYXJkVGltZTtcclxuICAgICAgICBsZXQgdGVzaHVUaW1lID0gMDtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgIGNvbXBhcmVQbGF5ZXJzID0gY29tcGFyZVBsYXllcnMuc29ydChmdW5jdGlvbiAocGxheWVyMSwgcGxheWVyMikge1xyXG4gICAgICAgICAgICByZXR1cm4gcGxheWVyMS5uZXh0Q29tcGFyZVNjb3JlKCkgLSBwbGF5ZXIyLm5leHRDb21wYXJlU2NvcmUoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIGNvPWNvbXBhcmVQbGF5ZXJzO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coY28pXHJcbiAgICAgICAgLy9jb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLeaJp+ihjOS6huWHoOasoScpXHJcblxyXG4gICAgICAgIGNvLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG5cclxuICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLnNob3dOZXh0Q29tcGFyZUNhcmRzKCk7XHJcbiAgICAgICAgICAgIH0sIGR1cmF0aW9uICsgdGVzaHVUaW1lKTtcclxuXHJcbiAgICAgICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyBpbnRlcnZhbDtcclxuICAgICAgICAgICAgdmFyIHVzZXIgPSBwbGF5ZXIuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyO1xyXG4gICAgICAgICAgICBpZih1c2VyLmlzQ29udGFpbkV4dHJhKXtcclxuICAgICAgICAgICAgICAgIGlmKHVzZXIuY2FyZEluZm9bMF0udHlwZSA9PSAxMCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHt0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiYW5pbWF0aW9uXCIpLl9zYW50b25naHVhQW5pbWF0aW9uKCk7fSxkdXJhdGlvbiAtIDEgKyB0ZXNodVRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0ZXNodVRpbWUgKz0gMi41O1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYodXNlci5jYXJkSW5mb1swXS50eXBlID09IDExKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3RoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuX3NhbnNodW56aUFuaW1hdGlvbigpOyB9LCBkdXJhdGlvbiAtIDEgKyB0ZXNodVRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0ZXNodVRpbWUgKz0gMi41O1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYodXNlci5jYXJkSW5mb1swXS50eXBlID09IDEyKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3RoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuX2xpdWR1aWJhbkFuaW1hdGlvbigpO30sIGR1cmF0aW9uIC0gMSArIHRlc2h1VGltZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRlc2h1VGltZSArPSAyLjU7XHJcblxyXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYodXNlci5jYXJkSW5mb1swXS50eXBlID09IDE4KXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3RoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuX3Fpbmdsb25nQW5pYW10aW9uKCdsb25nJyk7fSwgZHVyYXRpb24gLSAxICsgdGVzaHVUaW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGVzaHVUaW1lICs9IDIuNTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKHVzZXIuY2FyZEluZm9bMF0udHlwZSA9PSAxOSl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHt0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiYW5pbWF0aW9uXCIpLl9xaW5nbG9uZ0FuaWFtdGlvbihcInFsXCIpO30sIGR1cmF0aW9uIC0gMSArIHRlc2h1VGltZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRlc2h1VGltZSArPSAyLjU7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmKGlzQ29udGFpbkV4dHJhKXtcclxuXHJcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBjby5sZW5ndGg7IGkrKykgZHVyYXRpb24gPSBkdXJhdGlvbiArIDIuNVxyXG5cclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgIGlmKHBsYXllci5ub2RlLmFjdGl2ZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd05leHRDb21wYXJlU2NvcmUoaXNDb250YWluRXh0cmEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGR1cmF0aW9uIC0gaW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGNvLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBsYXllci5zaG93TmV4dENvbXBhcmVTY29yZSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgZHVyYXRpb24gLSBpbnRlcnZhbCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGR1cmF0aW9uICsgdGVzaHVUaW1lO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaXNHYW1lT3ZlcjogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5q+U54mM5a6M5oiQ5ZCO5Lya6LCD55So55qE5pa55rOVXHJcbiAgICBfc2hvd0NvbXBhcmVDYXJkRmluaXNoZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnRpbWVTdGFydCg1LFwicmVhZHlcIik7XHJcbiAgICAgICAgdGhpcy5fc2hvd09uZUdhbWVSZXN1bHQoKTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzLnB1c2godGhpcy5fZGVza0luZm8uY0luZGV4KTtcclxuICAgICAgICAvKiovXHJcbiAgICB9LFxyXG5cclxuICAgIC8vbmV0d29ya1xyXG4gICAgc2hvd05ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKG1zZyA9IFwi572R57uc6ZO+5o6l5pat5byA77yM6YeN5paw6L+e5o6l5LitLi4uXCIpIHtcclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAmJiB0aGlzLm5ldHdvcmtOb2RlLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVTZWxmQWN0aW9uID0gY2MucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLm5ldHdvcmtOb2RlKTtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYubmV0d29ya05vZGUgPSBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICAgICAgY29tcC5hbGVydCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBoaWRkZW5OZXR3b3JrTWVzc2FnZTpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dBbGVydE1lc3NhZ2U6IGZ1bmN0aW9uKG1zZywgYXV0b0Rpc21pc3MpIHtcclxuICAgICAgICBsZXQgYWxlcnRDb21wID0gdGhpcy5hbGVydC5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmFsZXJ0LmFjdGl2ZSkge1xyXG4gICAgICAgICAgICBhbGVydENvbXAuYWxlcnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGFsZXJ0Q29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICAgICAgYWxlcnRDb21wLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICBpZiAoYXV0b0Rpc21pc3MpIHtcclxuICAgICAgICAgICAgYWxlcnRDb21wLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydENvbXAuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgICAgICB9LCA1KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vY2hlY2tOb2RlXHJcbiAgICBzaG93Q2hlY2tNZXNzYWdlOmZ1bmN0aW9uKG1zZyA9ICfmo4Dmn6XnvZHnu5zkuK0uLi4nKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tOb2RlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIHJlbW92ZVNlbGZBY3Rpb24gPSBjYy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoZWNrTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMuY2hlY2tOb2RlKTtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMuY2hlY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLmNoZWNrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgICBjb21wLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGRlbkNoZWNrTWVzc2FnZTpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5jaGVja05vZGUgIT0gbnVsbCAmJiB0aGlzLmNoZWNrTm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vLy8vICDogYrlpKnor63pn7PpgLvovpFcclxuICAgIC8vIF9yZWdpc3RlclZvaWNlTm9kZUV2ZW50czogZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgIC8vICAgICBsZXQgY2hhdFZvaWNlTm9kZSA9IHRoaXMuYnRuQ2hhdFZvaWNlLm5vZGU7XHJcbiAgICAvLyAgICAgdGhpcy5lbmRSZWNvcmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIC8vICAgICBjaGF0Vm9pY2VOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAvLyAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gc2VsZi5lbmRSZWNvcmRUaW1lID49IDEwMDApIHtcclxuICAgIC8vICAgICAgICAgICAgIHNlbGYubmF0aXZlUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAvLyAgICAgICAgICAgICAvL3NlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgLy8gICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMS4yKTtcclxuICAgIC8vICAgICAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcblxyXG4gICAgLy8gICAgICAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSB0cnVlO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIC8vICAgICAgICAgaWYgKHNlbGYuX2lzUmVjb3JkaW5nKSB7XHJcbiAgICAvLyAgICAgICAgICAgICBzZWxmLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gZmFsc2U7XHJcblxyXG4gICAgLy8gICAgICAgICBzZWxmLm5hdGl2ZUVuZFJlY29yZEFjdGlvbigpO1xyXG4gICAgLy8gICAgICAgICAvL3NlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgIC8vICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMSk7XHJcbiAgICAvLyAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIC8vICAgICAgICAgaWYgKHNlbGYuX2lzUmVjb3JkaW5nKSB7XHJcbiAgICAvLyAgICAgICAgICAgICBzZWxmLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gZmFsc2U7XHJcblxyXG4gICAgLy8gICAgICAgICBzZWxmLm5hdGl2ZUVuZFJlY29yZEFjdGlvbigpO1xyXG4gICAgLy8gICAgICAgICAvL3NlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgIC8vICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMSk7XHJcbiAgICAvLyAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgU29ja2V0Lmluc3RhbmNlLnVwbG9hZEZpbmlzaCA9IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgLy8gICAgICAgICBsZXQgdXNlcklkID0gc2VsZi5fdXNlcklkO1xyXG4gICAgLy8gICAgICAgICBTb2NrZXQuc2VuZEF1ZGlvTWVzc2FnZSh1c2VySWQsIHVybCk7XHJcbiAgICAvLyAgICAgICAgIHNlbGYucGxheVNwZWFrQW5pbWF0aW9uKHNlbGYuX3VzZXJJZCk7XHJcbiAgICAvLyAgICAgfTtcclxuICAgIC8vIH0sXHJcblxyXG4gICAgX3JlZ2lzdGVyVm9pY2VOb2RlRXZlbnRzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGxldCBjaGF0Vm9pY2VOb2RlID0gdGhpcy5idG5DaGF0Vm9pY2Uubm9kZTtcclxuICAgICAgICB0aGlzLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIGNoYXRWb2ljZU5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgLy8gc2VsZi5Wb2ljZU1zZ0JnQW5pbWF0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICAgICAgdmFyIHJ1blRpbWUgPSAwLjNcclxuICAgICAgICAgICAgICAgIHZhciB0aXNoaSA9IGNjLmluc3RhbnRpYXRlKHNlbGYuYXV0b1Rpc2hpKTtcclxuICAgICAgICAgICAgICAgIHNlbGYubm9kZS5hZGRDaGlsZCh0aXNoaSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gY2Muc3Bhd24oIGNjLm1vdmVUbygwLjMsIGNjLnYyKDAsIDApKSxjYy5mYWRlSW4oMC4zKSk7XHJcbiAgICAgICAgICAgICAgICB0aXNoaS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgdGlzaGkucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gY2Muc2VxdWVuY2UoIGNjLnNwYXduKGNjLmZhZGVPdXQocnVuVGltZSksY2MubW92ZVRvKHJ1blRpbWUsY2MudjIoMCwgNTApKSksZmluaXNoZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRpc2hpLnJ1bkFjdGlvbiggYWN0aW9uICk7XHJcbiAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgMS41KTtcclxuICAgICAgICAgICAgICAgIC8vdmFyIHVybCA9IFwid3d3LmJhaWR1LmNvbVwiO1xyXG4gICAgICAgICAgICAgICAgLy9sZXQgdXNlcklkID0gc2VsZi5fdXNlcklkO1xyXG4gICAgICAgICAgICAgICAgLy9Tb2NrZXQuc2VuZEF1ZGlvTWVzc2FnZSh1c2VySWQsIHVybCk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSBzZWxmLmVuZFJlY29yZFRpbWUgPj0gMTAwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuVm9pY2VNc2dCZ0FuaW1hdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubmF0aXZlUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMS4yKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmJ0bkNoYXRWb2ljZS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNoYXRWb2ljZU5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHNlbGYuVm9pY2VNc2dCZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHNlbGYuX2lzUmVjb3JkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBzZWxmLm5hdGl2ZUVuZFJlY29yZEFjdGlvbigpO1xyXG4gICAgICAgICAgICAvL3NlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMSk7XHJcbiAgICAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgc2VsZi5Wb2ljZU1zZ0JnLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5faXNSZWNvcmRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuZW5kUmVjb3JkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHNlbGYubmF0aXZlRW5kUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAgICAgICAgIC8vc2VsZi52b2ljZVJlY29yZEFuaW1hdGlvbk5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBsZXQgYWN0aW9uID0gY2Muc2NhbGVUbygwLjEyLCAxKTtcclxuICAgICAgICAgICAgc2VsZi5idG5DaGF0Vm9pY2Uubm9kZS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBTb2NrZXQuaW5zdGFuY2UudXBsb2FkRmluaXNoID0gZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgICAgIGxldCB1c2VySWQgPSBzZWxmLl91c2VySWQ7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kQXVkaW9NZXNzYWdlKHVzZXJJZCwgdXJsKTtcclxuICAgICAgICAgICAgc2VsZi5wbGF5U3BlYWtBbmltYXRpb24oc2VsZi5fdXNlcklkKTtcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuICAgIFZvaWNlTXNnQmdBbmltYXRpb246ZnVuY3Rpb24oKXtcclxuICAgICAgICB0aGlzLlZvaWNlTXNnQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB2YXIgd2hpbGVMYXlvdXQgPSB0aGlzLlZvaWNlTXNnQmcuZ2V0Q2hpbGRCeU5hbWUoXCJ3aGlsZUxheW91dFwiKTtcclxuICAgICAgICB2YXIgY2hpbGRXaGlsZSA9IHdoaWxlTGF5b3V0LmdldENoaWxkQnlOYW1lKFwiY2hpbGRXaGlsZVwiKTtcclxuICAgICAgICBpZiggdGhpcy53aGlsZUxheW91dEludGVydmFsICl7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy53aGlsZUxheW91dEludGVydmFsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMud2hpbGVMYXlvdXRJbnRlcnZhbCA9ICBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIgbm9kZSA9IGNjLmluc3RhbnRpYXRlKGNoaWxkV2hpbGUpO1xyXG4gICAgICAgICAgICBpZih3aGlsZUxheW91dC5jaGlsZHJlbi5sZW5ndGg+NSl7XHJcbiAgICAgICAgICAgICAgICB3aGlsZUxheW91dC5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHdoaWxlTGF5b3V0LmFkZENoaWxkKG5vZGUpO1xyXG4gICAgICAgIH0sMjAwKVxyXG5cclxuICAgICAgICB2YXIgbGF5b3V0ID0gdGhpcy5Wb2ljZU1zZ0JnLmdldENoaWxkQnlOYW1lKFwibGF5b3V0XCIpO1xyXG4gICAgICAgIHZhciBjV2hpbGUgPSBsYXlvdXQuZ2V0Q2hpbGRCeU5hbWUoXCJ3aGlsZVwiKTtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgaWYoIHRoaXMubGF5b3V0SW50ZXJ2YWwgKXtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmxheW91dEludGVydmFsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubGF5b3V0SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIgbm9kZSA9IGNjLmluc3RhbnRpYXRlKGNXaGlsZSk7XHJcbiAgICAgICAgICAgIGlmKGxheW91dC5jaGlsZHJlbi5sZW5ndGg+Myl7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsYXlvdXQuYWRkQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgfSwzMDApXHJcbiAgICB9LFxyXG4gICAgbmF0aXZlUmVjb3JkQWN0aW9uOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwicmVjb3JkXCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWQgY29tLmxsaW5nLnFpYW5qaWFuZ2x6Z1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwicmVjb3JkXCIsIFwiKClWXCIpO1xyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGF1c2VNdXNpYygpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgbmF0aXZlRW5kUmVjb3JkQWN0aW9uOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwiZW5kUmVjb3JkXCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImVuZFJlY29yZFwiLCBcIigpVlwiKTtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnJlc3VtZU11c2ljKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBwbGF5QXVkaW9Vcmw6ZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTI1NTNcIik7XHJcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJwbGF5VXJsOlwiLHVybCk7XHJcbiAgICAgICAgfSBlbHNlIGlmKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJwbGF5VXJsXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiAg6YCA5Ye65ri45oiP6YC76L6RXHJcbiAgICBfaGFuZGxlVXBkYXRlRGVza0luZm9BYm91dEV4aXRSb29tOiBmdW5jdGlvbihkZXNrSW5mbykge1xyXG4gICAgICAgIGlmICghZGVza0luZm8uaXNEaXNzb2x2aW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGRhdGFJbmZvcyA9IGRlc2tJbmZvLmRpc3NvbHZlQW5zd2VySW5mbztcclxuXHJcbiAgICAgICAgbGV0IGFsZXJ0Q29tcCA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG5cclxuICAgICAgICBhbGVydENvbXAuYWxlcnQoKTtcclxuXHJcbiAgICAgICAgYWxlcnRDb21wLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb250ZW50QW5zb3dlckV4aXROb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oaSl7aS5hY3RpdmUgPSBmYWxzZTt9KTtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJJbmZvLGluZGV4KXtcclxuXHJcbiAgICAgICAgICAgIHZhciBwbGF5ID0gdGhpcy5jb250ZW50QW5zb3dlckV4aXROb2RlLmNoaWxkcmVuW2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcIm5pY2tuYW1lXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGJhY2sgPSBwbGF5LmdldENoaWxkQnlOYW1lKFwiZmFuemh1XCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGltZyA9IHBsYXkuZ2V0Q2hpbGRCeU5hbWUoXCJhdmF0YXJfYmdcIik7XHJcblxyXG4gICAgICAgICAgICB2YXIgc3RyID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcImlkXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGRhdGFJbmZvID0gZGF0YUluZm9zW2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgIHBsYXkuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIG5hbWUuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBwbGF5ZXJJbmZvLm5pY2tuYW1lO1xyXG5cclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gcGxheWVySW5mby5pZCl7Ly/mmL7npLrmiL/kuLtcclxuXHJcbiAgICAgICAgICAgICAgICBiYWNrLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuXHJcbiAgICAgICAgICAgICAgICBiYWNrLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjYy5sb2FkZXIubG9hZCh7dXJsOnBsYXllckluZm8uYXZhdGFyVXJsLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKGRhdGEpO1xyXG5cclxuICAgICAgICAgICAgICAgIGltZy5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IGZyYW1lO1xyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgIGlmKGRhdGFJbmZvID09IDEpe1xyXG5cclxuICAgICAgICAgICAgICAgIHN0ci5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi5ZCM5oSPXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuXHJcbiAgICAgICAgICAgICAgICBzdHIuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIGxldCBkaXNzb2x2ZUxlZnRUaW1lID0gZGVza0luZm8uZGlzc29sdmVMZWZ0VGltZSB8fCA2MDtcclxuXHJcbiAgICAgICAgbGV0IGNvdW50ZG93biA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKTtcclxuXHJcbiAgICAgICAgY291bnRkb3duLnN0YXJ0Q291bnRkb3duKGRpc3NvbHZlTGVmdFRpbWUsIGZ1bmN0aW9uKGlzVGltZW91dCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKGlzVGltZW91dCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGlja0FncmVlT3RoZXJQbGF5ZXJFeGl0KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgbGV0IGRpc3NvbHZlVXNlcklkID0gZGVza0luZm8uZGlzc29sdmVVc2VySWQ7XHJcblxyXG4gICAgICAgIGlmIChkaXNzb2x2ZVVzZXJJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBhbGVydF9iZyA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJhbGVydF9iZ1wiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBidG5BZ3JlZSA9IGFsZXJ0X2JnLmdldENoaWxkQnlOYW1lKFwiYnRuQWdyZWVcIik7XHJcblxyXG4gICAgICAgICAgICB2YXIgYnRuRGlzYWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkRpc2FncmVlXCIpO1xyXG5cclxuICAgICAgICAgICAgYnRuQWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBidG5EaXNhZ3JlZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy90aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q29uZmlybUJ1dHRvbi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL2xldCBhbGVydCA9IHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgICAgICAvL2FsZXJ0LnNldE1lc3NhZ2UoXCLmgqjmraPlnKjnlLPor7fljY/llYbpgIDlh7rvvIznrYnlvoXlhbbku5bnjqnlrrblkIzmhI9cIik7XHJcbiAgICAgICAgICAgIC8vdGhpcy5hbGVydFJlcXVlc3RFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0YXJ0Q291bnRkb3duKGRpc3NvbHZlTGVmdFRpbWUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgLy9sZXQgZGlzc29sdmVBbnN3ZXJJbmZvcyA9IGRlc2tJbmZvLmRpc3NvbHZlQW5zd2VySW5mbztcclxuICAgICAgICAvL2xldCBjdXJyZW50VXNlcklkSW5kZXggPSBkZXNrSW5mby5wbGF5ZXJzSW5kZXguZmluZEluZGV4KGZ1bmN0aW9uKHVzZXJJZCkge1xyXG4gICAgICAgIC8vICAgIHJldHVybiB0aGlzLl91c2VySWQgPT0gdXNlcklkO1xyXG4gICAgICAgIC8vfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vbGV0IGFuc3dlclJlc3VsdCA9IGRpc3NvbHZlQW5zd2VySW5mb3NbY3VycmVudFVzZXJJZEluZGV4XTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vaWYgKGFuc3dlclJlc3VsdCA9PSAtMSkge1xyXG4gICAgICAgIC8vICAgIC8vIC0xIOihqOekuuacquWkhOeQhiAgMCDooajnpLrmi5Lnu50gIDHooajnpLrlkIzmhI9cclxuICAgICAgICAvLyAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICBsZXQgY291bnRkb3duID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgY291bnRkb3duLnN0YXJ0Q291bnRkb3duKGRpc3NvbHZlTGVmdFRpbWUsIGZ1bmN0aW9uKGlzVGltZW91dCkge1xyXG4gICAgICAgIC8vICAgICAgICBpZiAoaXNUaW1lb3V0KSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLmNsaWNrQWdyZWVPdGhlclBsYXllckV4aXQoKTtcclxuICAgICAgICAvLyAgICAgICAgfVxyXG4gICAgICAgIC8vICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL31cclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8vIOehruWumuimgeW8uuWItumAgOWHuua4uOaIj1xyXG4gICAgY2xpY2tDb25maXJtRm9yY2VFeGl0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICBTb2NrZXQuc2VuZEZvcmNlRXhpdFJvb20odGhpcy5fdXNlcklkKTtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g56Gu6K6k6K+35rGC6YCA5Ye65ri45oiPXHJcbiAgICBjbGlja0NvbmZpcm1SZXF1ZXN0RXhpdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENhbmNlbEJ1dHRvbi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENvbmZpcm1CdXR0b24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBsZXQgYWxlcnQgPSB0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jSW5kZXg+MCl7XHJcbiAgICAgICAgICAgIGFsZXJ0LnNldE1lc3NhZ2UoXCLmgqjmraPlnKjnlLPor7fljY/llYbpgIDlh7rvvIznrYnlvoXlhbbku5bnjqnlrrblkIzmhI9cIik7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdGFydENvdW50ZG93big2MCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFNvY2tldC5zZW5kTGVhdmVEZXNrKHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOWQjOaEj+S7luS6uumAgOWHulxyXG4gICAgY2xpY2tBZ3JlZU90aGVyUGxheWVyRXhpdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIC8vdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIC8vdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0b3AoKTtcclxuICAgICAgICB2YXIgYWxlcnRfYmcgPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENoaWxkQnlOYW1lKFwiYWxlcnRfYmdcIik7XHJcbiAgICAgICAgdmFyIGJ0bkFncmVlID0gYWxlcnRfYmcuZ2V0Q2hpbGRCeU5hbWUoXCJidG5BZ3JlZVwiKTtcclxuICAgICAgICB2YXIgYnRuRGlzYWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkRpc2FncmVlXCIpO1xyXG4gICAgICAgIGJ0bkFncmVlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGJ0bkRpc2FncmVlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIFNvY2tldC5zZW5kQW5zd2VyRGlzc29sdmUodGhpcy5fdXNlcklkLCAxKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5LiN5ZCM5oSP5LuW5Lq66YCA5Ye6XHJcbiAgICBjbGlja0Rpc2FncmVlT3RoZXJQbGF5ZXJFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy90aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgLy90aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgLy90aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgICAgIHZhciBhbGVydF9iZyA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJhbGVydF9iZ1wiKTtcclxuICAgICAgICB2YXIgYnRuQWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkFncmVlXCIpO1xyXG4gICAgICAgIHZhciBidG5EaXNhZ3JlZSA9IGFsZXJ0X2JnLmdldENoaWxkQnlOYW1lKFwiYnRuRGlzYWdyZWVcIik7XHJcbiAgICAgICAgYnRuQWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgYnRuRGlzYWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgU29ja2V0LnNlbmRBbnN3ZXJEaXNzb2x2ZSh0aGlzLl91c2VySWQsIDApO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDpmpDol4/or7fmsYLpgIDlh7ogTm9kZVxyXG4gICAgX2hpZGVSZXFlc3RFeGl0Tm9kZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLy8vIOaJk+aeqlxyXG4gICAgcGxheVNob290OiBmdW5jdGlvbiAoZnJvbVVzZXJJZCwgdG9Vc2VySWQpIHtcclxuICAgICAgICBsZXQgdXNlciA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQoZnJvbVVzZXJJZCk7XHJcbiAgICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlIdW1hbkRhUWlhbmcodXNlci5zZXgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHRvVXNlckluZGV4ID0gdGhpcy5fZmluZFBsYXllckluZGV4QnlVc2VySWQodG9Vc2VySWQpO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICBpZih0aGlzLl91c2VySWQgPT0gZnJvbVVzZXJJZCB8fCB0aGlzLl91c2VySWQgPT0gdG9Vc2VySWQpIHBsYXllci5zaG93TmV4dENvbXBhcmVTY29yZSgpO1xyXG4gICAgICAgICAgICBwbGF5ZXIucGxheVNob290QW5pbWF0aW9uKGZyb21Vc2VySWQsIHRvVXNlckluZGV4KTtcclxuICAgICAgICAgICAgcGxheWVyLnBsYXlCdWxsZXRIb2xlQW5pbWF0aW9uKHRvVXNlcklkKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmkq3mlL7lhajlnpLmiZPliqjmlYhcclxuICAgIHBsYXlIb21lUnVuOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgbGV0IHVzZXIgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHVzZXJJZCk7XHJcbiAgICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlIb21lUnVuKHVzZXIuc2V4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcImFuaW1hdGlvblwiKS5fcXVhbmxlaWRhQW5pbWF0aW9uKCdsb25nJyk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcblxyXG4gICAgICAgICAgICBwbGF5ZXIuc2hvd05leHRDb21wYXJlU2NvcmUoKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHBsYXlTcGVha0FuaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5wbGF5U3BlYWtBbmltYXRpb24odXNlcklkKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX3Nob290RGF0YXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgaG9tZVJ1blVzZXJJZCA9IHRoaXMuX2hvbWVSdW5Vc2VySWQoKTsgLy8g5YWo5Z6S5omTXHJcbiAgICAgICAgbGV0IHNob290RGF0YXMgPSB0aGlzLl9kZXNrSW5mby5zaG90RGF0YS5maWx0ZXIoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGEuZnJvbVVzZXJJZCA9PSBob21lUnVuVXNlcklkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBzaG9vdERhdGFzO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc2hvdERhdGE6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgaG9tZVJ1blVzZXJJZCA9IHRoaXMuX2hvbWVSdW5Vc2VySWQoKTsgLy8g5omT5p6qXHJcbiAgICAgICAgbGV0IHNob3REYXRhID0gdGhpcy5fZGVza0luZm8uc2hvdERhdGEuZmlsdGVyKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmZyb21Vc2VySWQgIT0gaG9tZVJ1blVzZXJJZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2hvdERhdGE7XHJcbiAgICB9LFxyXG5cclxuICAgIF9ob21lUnVuVXNlcklkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rlc2tJbmZvLmFsbFNob3REYXRhO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiDmiL/pl7Tkv6Hmga/pg6jliIZcclxuXHJcbiAgICAvLyDojrflj5bmiL/pl7TnmoTnjqnms5VcclxuICAgIF9kZXNrSW5mb0dhbWVXYXk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzM7XHJcbiAgICAgICAgaWYoc2V0dGluZyA9PSBudWxsKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBuYW1lcyA9IFtcIuW6hOWutuaooeW8j1wiLCBcIuaXoOeJueauiueJjFwiLFwi5pmu6YCa5qih5byPXCJdO1xyXG4gICAgICAgIHJldHVybiBuYW1lc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rlc2tJbmZvTnVtYmVyT2ZHYW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgc2V0dGluZyA9IHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxO1xyXG4gICAgICAgIGxldCBpbmZvcyA9IFsnMTDlsYAnLCAnMjDlsYAnLCAnNDDlsYAnLCAnNeWxgCddO1xyXG4gICAgICAgIC8qaWYgKHNldHRpbmcgPD0gMSkge1xyXG4gICAgICAgICByZXR1cm4gJ+adoeaVsO+8micgKyBpbmZvc1tzZXR0aW5nXTtcclxuICAgICAgICAgfSovXHJcbiAgICAgICAgaWYoc2V0dGluZyA9PSAyKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoc2V0dGluZyA9PSAzKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoc2V0dGluZyA9PSA0KXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoc2V0dGluZyA9PSA1KXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAn5bGA5pWw77yaJyArIGluZm9zW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGVza0luZm9OdW1iZXJPZlBlb3BsZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHNldHRpbmcgPSB0aGlzLl9kZXNrSW5mby5zZXR0aW5nMjtcclxuICAgICAgICBsZXQgaW5mb3MgPSBbJzLkuronLCAnM+S6uicsICc05Lq6JywgJzXkuronXTtcclxuICAgICAgICByZXR1cm4gaW5mb3Nbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIF9kZXNrSW5mb1BheUluZm86IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzQ7XHJcbiAgICAgICAgaWYoc2V0dGluZyA9PSBudWxsKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHNldHRpbmcgPT0gMCl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaW5mb3MgPSBbJ+aIv+S4u+mcuOS4u+W6hCcsICfmiL/otLlBQSddO1xyXG4gICAgICAgIHJldHVybiBpbmZvc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rlc2tJbmZvSmlhWWlTZUluZm86IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzcgPT0gMCA/IDEgOiAwO1xyXG4gICAgICAgIGxldCBpbmZvcyA9IFsn5peg5aSa5LiA6ImyJywgJ+WkmuS4gOiJsiddO1xyXG4gICAgICAgIHJldHVybiBpbmZvc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rlc2tJbmZvR3VpUGFpSW5mbzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHNldHRpbmc7XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzggPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc4ID09IDApe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nOCA9PSAxKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpbmZvcyA9IFsn5peg546L54mMJywgJ+S4pOW8oOeOi+eJjCcsICflm5vlvKDnjovniYwnXTtcclxuICAgICAgICByZXR1cm4gaW5mb3Nbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6IOWJqeS9meaXtumXtFxyXG4gICAgX3JlbWFpblRpbWVTdGFydFVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy90aGlzLnNjaGVkdWxlKHRoaXMuX3JlbWFpblRpbWVVcGRhdGUsIDEuMCwgY2MubWFjcm8uUkVQRUFUX0ZPUkVWRVIpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcmVtYWluVGltZVVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzUmFuZG9tUm9vbSgpIHx8IFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaXNUYW9TaHUgPSAodGhpcy5fZGVza0luZm8uc2V0dGluZzEgPT0gMCkgfHwgKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxID09IDEpO1xyXG4gICAgICAgIGlmIChpc1Rhb1NodSkge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuX2Rlc2tJbmZvLmNyZWF0ZVRpbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGxldCBjcmVhdGVUaW1lID0gZmVjaGEucGFyc2UodGhpcy5fZGVza0luZm8uY3JlYXRlVGltZSwgJ1lZWVktTU0tREQgSEg6bW06c3MnKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgbGV0IG9uZUhvdXIgPSA2MCAqIDYwO1xyXG4gICAgICAgIGxldCByZW1haW4gPSAoRGF0ZS5ub3coKSAtIGNyZWF0ZVRpbWUpIC8gMTAwMDtcclxuICAgICAgICByZW1haW4gPSBNYXRoLm1heChvbmVIb3VyIC0gcmVtYWluLCAwKTtcclxuXHJcbiAgICAgICAgbGV0IG1pbnMgPSBNYXRoLmZsb29yKHJlbWFpbiAvIDYwKTtcclxuICAgICAgICBsZXQgc2VjcyA9IE1hdGguZmxvb3IocmVtYWluICUgNjApO1xyXG4gICAgICAgIGlmIChtaW5zID09IDAgJiYgc2VjcyA9PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBtaW5zU3RyaW5nID0gXCJcIiArIG1pbnM7XHJcbiAgICAgICAgaWYgKG1pbnNTdHJpbmcubGVuZ3RoIDwgMikge1xyXG4gICAgICAgICAgICBtaW5zU3RyaW5nID0gXCIwXCIgKyBtaW5zU3RyaW5nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHNlY3NTdHJpbmcgPSBcIlwiICsgc2VjcztcclxuICAgICAgICBpZiAoc2Vjc1N0cmluZy5sZW5ndGggPCAyKSB7XHJcbiAgICAgICAgICAgIHNlY3NTdHJpbmcgPSBcIjBcIiArIHNlY3NTdHJpbmc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgc3RyaW5nID0gXCLliankvZnml7bpl7TvvJowMDpcIiArIG1pbnNTdHJpbmcgKyBcIjpcIiArIHNlY3NTdHJpbmc7XHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUuc3RyaW5nID0gc3RyaW5nO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiDlpITnkIblkIwgSVAg55qE55So5oi3XHJcbiAgICBfaGFuZGxlVGhlU2FtZU9mSVBBZHJlc3M6IGZ1bmN0aW9uKHVzZXJJbmZvcykge1xyXG4gICAgICAgIGlmICghdXNlckluZm9zIHx8IHVzZXJJbmZvcy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaXBVc2VySW5mb3MgPSB1c2VySW5mb3MucmVkdWNlKGZ1bmN0aW9uKGlwcywgdXNlckluZm8pIHtcclxuICAgICAgICAgICAgbGV0IHVzZXJzID0gaXBzW3VzZXJJbmZvLmlwQWRkcmVzc10gfHwgW107XHJcbiAgICAgICAgICAgIHVzZXJzLnB1c2godXNlckluZm8pO1xyXG5cclxuICAgICAgICAgICAgaXBzW3VzZXJJbmZvLmlwQWRkcmVzc10gPSB1c2VycztcclxuICAgICAgICAgICAgcmV0dXJuIGlwcztcclxuICAgICAgICB9LCB7fSk7XHJcblxyXG4gICAgICAgIGxldCBzYW1lSXBVc2VycyA9IG51bGw7XHJcbiAgICAgICAgZm9yIChsZXQgaXAgaW4gaXBVc2VySW5mb3MpIHtcclxuICAgICAgICAgICAgbGV0IHVzZXJzID0gaXBVc2VySW5mb3NbaXBdO1xyXG4gICAgICAgICAgICBpZiAodXNlcnMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgc2FtZUlwVXNlcnMgPSB1c2VycztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc2FtZUlwVXNlcnMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9hbGVydFNhbWVJcFVzZXJJbmZvcyhzYW1lSXBVc2Vycyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9hbGVydFNhbWVJcFVzZXJJbmZvczogZnVuY3Rpb24odXNlcnMpIHtcclxuICAgICAgICBsZXQgbWVzc2FnZSA9IFwiXCI7XHJcbiAgICAgICAgbGV0IHVzZXJJZHMgPSBcIlwiO1xyXG4gICAgICAgIHVzZXJzLmZvckVhY2goZnVuY3Rpb24odXNlciwgaW5kZXgpIHtcclxuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UgKyAoaW5kZXggPiAwID8gJyDlkowgJyA6ICcnKSArIHVzZXIubmlja25hbWU7XHJcbiAgICAgICAgICAgIHVzZXJJZHMgPSB1c2VySWRzICsgdXNlci5pZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICBtZXNzYWdlID0gbWVzc2FnZSArICcg5Zyo5ZCM5LiAIElQIOS4i++8gSc7XHJcblxyXG4gICAgICAgIHRoaXMuX2RpZEFsZXJ0U2FtZUlwTWVzc2FnZSA9IHRoaXMuX2RpZEFsZXJ0U2FtZUlwTWVzc2FnZSB8fCB7fTtcclxuICAgICAgICBpZiAodGhpcy5fZGlkQWxlcnRTYW1lSXBNZXNzYWdlW3VzZXJJZHNdKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd0FsZXJ0TWVzc2FnZShtZXNzYWdlLCB0cnVlKTtcclxuICAgICAgICB0aGlzLl9kaWRBbGVydFNhbWVJcE1lc3NhZ2VbdXNlcklkc10gPSB0cnVlO1xyXG4gICAgfSxcclxuXHJcbn0pO1xyXG5QbGF5LmdvbmdYaU5pU2hvdyA9IGZ1bmN0aW9uICh0eXBlKSB7XHJcbiAgICB0aGlzLmluc3RhbmNlcy5fZ29uZ1hpTmlTaG93KHR5cGUpO1xyXG59O1xyXG5tb2R1bGUuZXhwb3J0cyA9IFBsYXk7XHJcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIHByb2R1Y3RJZDonJyxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuICAgIFxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm9uQ2xpY2tBY3Rpb24odGhpcy5wcm9kdWN0SWQpOyAgICAgICAgXG4gICAgfSxcbiAgICBcbiAgICBvbkNsaWNrQWN0aW9uOmZ1bmN0aW9uKHByb2R1Y3RJZCkge1xuICAgICAgICBcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBtYXRjaGluZ0xhYmVsOmNjLkxhYmVsLFxuICAgICAgICB0aW1lTm9kZTpjYy5Ob2RlLFxuICAgICAgICBtYXRjaGluZ05vZGU6Y2MuTm9kZSxcbiAgICAgICAgd2FpdGluZ1ByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBhbGVydFByZWZhYjogY2MuUHJlZmFiLFxuXG4gICAgICAgIHRpc2hpOmNjLk5vZGUsXG5cbiAgICAgICAgX3VzZXJJZDogbnVsbCxcbiAgICAgICAgX3Jlc3BvbnNlOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3VzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcbiAgICAgIGNjLmlzUm9vbVZpZXdTaG93ID0gdHJ1ZTtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEZXNrSW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZURlc2tJbmZvICx0aGlzKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlNvY2tldERpc2Nvbm5lY3QsIHRoaXMuX3NvY2tldERpc2Nvbm5lY3QsIHRoaXMpO1xuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcy5fc29ja2V0Q29ubmVjdGVkLCB0aGlzKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVJbnRlclJhbmRvbSwgdGhpcy5fc29ja2V0UmVjZWl2ZUludGVyUmFuZG9tLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgX3NvY2tldFJlY2VpdmVEZXNrSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgIH0sXG5cbiAgICBfc29ja2V0UmVjZWl2ZUludGVyUmFuZG9tOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAvL+acjeWKoeWZqOWPkemAgSAgeydhY3Rpb24nOidpbnRlclJhbmRvbScsJ3Jlc3VsdCc6ZmFsc2UsJ2RhdGEnOnsncmVhc29uJzpyZWFzb259fVxuICAgICAgICB0aGlzLl9yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbik7XG4gICAgICAgIC8vIOWkhOeQhumaj+acuuWcuuWMuemFjeS4jeaIkOWKn+eahOaDheWGtVxuICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgcmVhc29uID0gcmVzcG9uc2UuZGF0YS5yZWFzb24gfHwgXCLliqDlhaXpmo/mnLrlnLrlpLHotKVcIjtcbiAgICAgICAgdGhpcy5zaG93QWxlcnRNZXNzYWdlKHJlYXNvbik7XG5cbiAgICAgICAgaWYgKHJlYXNvbiA9PSAn5L2g5bey57uP5Zyo5Yy56YWN6Zif5YiXJykge1xuICAgICAgICAgICAgdGhpcy5fc2hvd01hdGNoaW5nKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlTWF0Y2hpbmcoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfc29ja2V0RGlzY29ubmVjdDogZnVuY3Rpb24oKSB7XG4gICAgICAvLyDov57mjqXlt7Lmlq3lvIBcbiAgICAgIHRoaXMubWF0Y2hpbmdOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5zaG93TmV0d29ya01lc3NhZ2UoJ+e9kee7nOmTvuaOpeaWreW8gO+8jOmHjeaWsOi/nuaOpeS4rS4uLicpO1xuICAgIH0sXG5cbiAgICBfc29ja2V0Q29ubmVjdGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcbiAgICB9LFxuXG5cbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcbiAgICAgIEtRR2xvYmFsRXZlbnQub2ZmVGFyZ2V0KHRoaXMpO1xuICAgIH0sXG5cbiAgICBjbGlja0V4aXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgfSxcblxuICAgIGNsaWNrU3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIFNvY2tldC5zZW5kRW50ZXJSYW5kb20odGhpcy5fdXNlcklkKTtcbiAgICAgIHRoaXMuX3Nob3dNYXRjaGluZygpO1xuXG4gICAgICAvKiMjIyMjYmVnaW4qL1xuICAgICAgLy9yZWFzb27mmK/mnI3liqHlmajlj5HpgIHlm57mnaXnmoRcbiAgICAgIC8qaWYodGhpcy5fcmVzcG9uc2UuZGF0YS5yZWFzb24gPT0gXCLkvaDnmoTpkrvnn7PkuI3otrNcIil7XG4gICAgICAgICAgdGhpcy50aXNoaS5hY3RpdmUgPSB0cnVlO1xuICAgICAgfSovXG4gICAgICAvKiMjIyMjZW5kKi9cblxuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbiwgNSk7XG4gICAgfSxcbiAgICAvKiMjIyMj54K55Ye756m655m95Zyw5pa577yM56CW55+z5LiN6Laz5o+Q56S65raI5aSxKi9cbiAgICAvKm9uQnRuS29uZzpmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMudGlzaGkuYWN0aXZlKXtcbiAgICAgICAgICAgIHRoaXMudGlzaGkuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgLy/ku4DkuYjkuZ/kuI3lgZpcbiAgICAgICAgfVxuICAgIH0sKi9cbiAgICAvKuWPlua2iOWMuemFjSovXG4gICAgY2xpY2tDYW5jZWw6ZnVuY3Rpb24gKCkge1xuICAgICAgU29ja2V0LnNlbmRDYW5jZWxSYW5kb20odGhpcy5fdXNlcklkKTtcblxuICAgICAgdGhpcy5faGlkZU1hdGNoaW5nKCk7XG4gICAgfSxcblxuICAgIF90aW1lb3V0UmFuZG9tQWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5faGlkZU1hdGNoaW5nKCk7XG4gICAgICAgIHRoaXMuc2hvd0FsZXJ0TWVzc2FnZSgn6L+b5YWl5Yy56YWN5aSx6LSlJyk7XG4gICAgfSxcblxuICAgIF9zaG93TWF0Y2hpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMubWF0Y2hpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgICAgICB0aGlzLm1hdGNoaW5nTGFiZWwuc3RyaW5nID0gJ+ato+WcqOWMuemFjeS4re+8jOivt+eojeWQji4uLic7XG4gICAgICAgIGxldCBudW0gPSAwO1xuICAgICAgICB0aGlzLnNjaGVkdWxlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbnVtID0gbnVtICsgMC41O1xuICAgICAgICAgICAgdGhpcy50aW1lTm9kZS5yb3RhdGlvbiA9IG51bTtcbiAgICAgICAgIH0sIDAuMDEpO1xuICAgIH0sXG5cbiAgICBfaGlkZU1hdGNoaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm1hdGNoaW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIGNvbXAuZGlzbWlzc0FjdGlvbigpO1xuICAgIH0sXG5cbiAgICAgc2hvd05ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbik7XG5cbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHJlbW92ZVNlbGZBY3Rpb24gPSBjYy5yZW1vdmVTZWxmKCk7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5uZXR3b3JrTm9kZSk7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5uZXR3b3JrTm9kZSA9IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGhpZGRlbk5ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2hvd0FsZXJ0TWVzc2FnZTogZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIGlmICghbXNnKSB7XG4gICAgICAgICAgICBjYy5lcnJvcihcIuS4jeiDveaYvuekuuS4uuepuueahOS/oeaBr1wiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5hbGVydE1lc3NhZ2VOb2RlKSB7XG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZU5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmFsZXJ0UHJlZmFiKTtcbiAgICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLmFsZXJ0TWVzc2FnZU5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2VOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IFBsYXliYWNrID0gcmVxdWlyZSgnUGxheWJhY2snKTtcbmNvbnN0IHJlY29yZCA9IHJlcXVpcmUoJ3JlY29yZCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB0aW1lTGFiZWw6Y2MuTGFiZWwsICAgLy8g5pe26Ze0XG4gICAgICAgIGp1c2h1TGFiZWw6Y2MuTGFiZWwsICAvLyDlsYDmlbBcbiAgICAgICAgY3JlYXRlVXNlcjpjYy5Ob2RlLCAgIC8vIOaIv+S4u1xuICAgICAgICByb29tSWQ6Y2MuTGFiZWwsICAgICAgLy8g5oi/6Ze05Y+3XG4gICAgICAgIGppZmVuOmNjLkxhYmVsLCAgICAgICAvLyDnp6/liIZcbiAgICAgICAgaWQ6Y2MuTGFiZWwsXG4gICAgICAgIGF2YXRhck5vZGU6Y2MuTm9kZSwgICAvLyDlpLTlg49cbiAgICAgICAgY3JlYXRvckltZzpjYy5Ob2RlLCAgIC8vIOWIm+aIv+WktOWDj1xuICAgICAgICBuaWNrbmFtZUxhYmVsczpjYy5MYWJlbCxcbiAgICAgICAgc2NvcmVMYWJlbHM6W2NjLkxhYmVsXSxcbiAgICAgICAgLy9udW1Ob2RlOmNjLkxhYmVsLFxuICAgICAgICBfcGFyZW50SWQ6IG51bGwsXG4gICAgICAgIC8vcGxheWJhY2tOb2RlOmNjLk5vZGUsLy/lm57mlL7mjInpkq5cbiAgICAgICAgLy93YXRjaE5vZGU6Y2MuTm9kZSwvL+afpeeci+aMiemSrlxuICAgICAgICByZW9yZEluZm86Y2MuTm9kZSxcbiAgICAgICAgX3JlY29yZEl0ZW1JbmZvOiBudWxsLFxuICAgICAgICB0b3RhbEdhbWVSZXN1bHQ6Y2MuTm9kZSxcblxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy50b3RhbEdhbWVSZXN1bHQgPSBjYy5maW5kKFwiQ2FudmFzL3JlY29yZEluZm9cIik7XG4gICAgfSxcblxuICAgIHNldEluZm86IGZ1bmN0aW9uIChyZWNvcmRJbmZvKSB7XG4gICAgICAgIHRoaXMuX3BhcmVudElkID0gcmVjb3JkSW5mby5pZDtcbiAgICAgICAgLy90aGlzLndhdGNoTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAvL3RoaXMucGxheWJhY2tOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBpZiAocmVjb3JkSW5mby5wbGF5ZXJzSW5mby5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHBsYXllcnNJbmZvID0gSlNPTi5wYXJzZShyZWNvcmRJbmZvLnBsYXllcnNJbmZvKTtcbiAgICAgICAgcmVjb3JkSW5mby5zY29yZXMgPSBKU09OLnBhcnNlKCByZWNvcmRJbmZvLnNjb3JlcyApO1xuXG4gICAgICAgIHZhciBmZW4gPSByZWNvcmRJbmZvLnNjb3Jlc1sgdGhpcy5mZW4ocmVjb3JkSW5mby51c2VyaWQscGxheWVyc0luZm8ucGxheWVyc0luZGV4KSBdIDtcbiAgICAgICAgLy9jYy5sb2coZmVuKVxuICAgICAgICAvL2NjLmxvZyhyZWNvcmRJbmZvLnNjb3JlcylcbiAgICAgICAgLy9jYy5sb2codGhpcy5mZW4ocmVjb3JkSW5mby51c2VyaWQscGxheWVyc0luZm8ucGxheWVyc0luZGV4KSlcbiAgICAgICAgLy9jYy5sb2cocmVjb3JkSW5mby51c2VyaWQpXG4gICAgICAgIC8vY2MubG9nKHBsYXllcnNJbmZvLnBsYXllcnNJbmRleClcbiAgICAgICAgLy9jYy5sb2cocmVjb3JkSW5mbylcbiAgICAgICAgLy9jYy5sb2cocGxheWVyc0luZm8pXG4gICAgICAgIC8vY2MubG9nKCctLS0tNDcnKVxuICAgICAgICB0aGlzLmppZmVuLnN0cmluZyA9IChmZW4gPj0gMD9cIitcIitmZW4gOmZlbik7XG5cbiAgICAgICAgdmFyIGhlYWRVcmwgPSBwbGF5ZXJzSW5mby5wbGF5ZXJzWyB0aGlzLmNyZWF0b3IocmVjb3JkSW5mby5jcmVhdGVVc2VySWQscGxheWVyc0luZm8ucGxheWVyc0luZGV4KSBdLmF2YXRhclVybDsgLy8g5aS05YOPVVJMXG4gICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLmF2YXRhck5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6aGVhZFVybCx0eXBlOlwianBnXCJ9LCBmdW5jdGlvbiAoZXJyLCB0ZXgpIHtcbiAgICAgICAgICAgIGlmICghZXJyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKHRleCk7XG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lPWZyYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnJvb21JZC5zdHJpbmcgPSBcIuaIv+WPt++8mlwiKyBwbGF5ZXJzSW5mby5yb29tSWQ7XG4gICAgICAgIHRoaXMudGltZUxhYmVsLnN0cmluZyA9IFwi5pe26Ze077yaXCIgKyBwbGF5ZXJzSW5mby50aW1lLnN1YnN0cig1LDExKTtcbiAgICAgICAgdGhpcy5qdXNodUxhYmVsLnN0cmluZyA9IFwi5bGA5pWw77yaXCIrIHRoaXMuanMocGxheWVyc0luZm8uc2V0dGluZzEtMik7XG5cbiAgICAgICAgIC8vZm9yICh2YXIgaSA9IDA7aSA8IHBsYXllcnNJbmZvLnBsYXllcnMubGVuZ3RoO2krKykge1xuICAgICAgICAgLy8gIHRoaXMubmlja25hbWVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc0luZm8ucGxheWVyc1tpXS5uaWNrbmFtZTtcbiAgICAgICAgIC8vICB0aGlzLnNjb3JlTGFiZWxzW2ldLnN0cmluZyA9IHBsYXllcnNJbmZvLnBsYXllcnNbaV0udG90YWxTY29yZTtcbiAgICAgICAgIC8vfVxuICAgIH0sXG4gICAganM6IGZ1bmN0aW9uKHNldHRpbmcyKXtcbiAgICAgICAgdmFyIGp1c2h1ID0gNTtcbiAgICAgICAgc3dpdGNoKHNldHRpbmcyKXtcbiAgICAgICAgICAgIGNhc2UgMDoganVzaHUgPSA1OyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMToganVzaHUgPSAxMDsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6IGp1c2h1ID0gMjA7IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzOiBqdXNodSA9IDMwOyBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ganVzaHU7XG4gICAgfSxcblxuICAgIGZlbjpmdW5jdGlvbih1c2VyaWQscGxheWVycyl7ICAgICAgICAgLy8g5om+56ev5YiGXG4gICAgICAgIGZvcih2YXIgaSA9MDsgaTxwbGF5ZXJzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgaWYocGxheWVyc1tpXSA9PSB1c2VyaWQpe1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBjcmVhdG9yIDpmdW5jdGlvbihjcmVhdG9yLHBsYXllcnMpeyAgICAvL+WIm+aIv+iAhVxuICAgICAgICBmb3IodmFyIGkgPTA7IGk8cGxheWVycy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGlmKHBsYXllcnNbaV0gPT0gY3JlYXRvcil7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xpY2tBY3Rpb246IGZ1bmN0aW9uKCBldmVudCwgZGF0YSApIHtcbiAgICAgICAgbGV0IHBsYXllcnNJbmZvID0gSlNPTi5wYXJzZShkYXRhLnBsYXllcnNJbmZvKTtcbiAgICAgICAgbGV0IHRvdGFsR2FtZVJlc3VsdENvbXAgPSB0aGlzLnRvdGFsR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ1RvdGFsR2FtZVJlc3VsdCcpO1xuICAgICAgICB0b3RhbEdhbWVSZXN1bHRDb21wLnNldFBsYXllckluZm9zKHBsYXllcnNJbmZvLnBsYXllcnMsIGRhdGEpO1xuICAgICAgICB0b3RhbEdhbWVSZXN1bHRDb21wLl9jbGlja0J0bigpO1xuICAgICAgICB0aGlzLnRvdGFsR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcblxuICAgICAgICAvL2lmICh0aGlzLl9yZWNvcmRJdGVtSW5mbykge1xuICAgICAgICAvLyAgdGhpcy5fc3RhcnRQbGF5YmFjayh0aGlzLl9yZWNvcmRJdGVtSW5mby5faW5mbzhBcnJheSk7XG4gICAgICAgIC8vICByZXR1cm47XG4gICAgICAgIC8vfVxuICAgICAgICAvLy8vU29ja2V0LnNlbmRHZXRJdGVtUmVjb3JkKFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZCx0aGlzLl9wYXJlbnRJZCk7XG4gICAgICAgIC8vU29ja2V0LnNlbmRHZXRJdGVtUmVjb3JkKFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZCwtLWluZGV4KTtcbiAgICB9LFxuXG4gICAgX3N0YXJ0UGxheWJhY2s6IGZ1bmN0aW9uIChwbGF5QmFja0luZm8pIHtcbiAgICAgICAgLy9QbGF5YmFjay5pbnN0YW5jZS5zZXRQbGF5YmFja0RhdGFzKHBsYXlCYWNrSW5mbyk7XG4gICAgICAgIC8vY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgfSxcblxuICAgIGRldGFpbEFjdGlvbjogZnVuY3Rpb24ocmVjb3JkSXRlbUluZm8sIGluZGV4KSB7XG4gICAgICAgIC8vdGhpcy5fcmVjb3JkSXRlbUluZm8gPSByZWNvcmRJdGVtSW5mbztcbiAgICAgICAgLy8vL3RoaXMucGxheWJhY2tOb2RlLmFjdGl2ZSA9IHRydWVcbiAgICAgICAgLy8vL2NvbnNvbGUubG9nKCk7XG4gICAgICAgIC8vLy90aGlzLm51bU5vZGUuc3RyaW5nID0gXCLnrKxcIiArIChpbmRleCArIDEpICsgXCLlsYBcIjtcbiAgICAgICAgLy90aGlzLnRpbWVMYWJlbC5zdHJpbmcgPSByZWNvcmRJdGVtSW5mby5jcmVhdEF0LnN1YnN0cig1LDExKTtcbiAgICAgICAgLy9sZXQgb2JqQXJyYXkgPSBKU09OLnBhcnNlKHJlY29yZEl0ZW1JbmZvLmluZm84KTtcbiAgICAgICAgLy90aGlzLl9yZWNvcmRJdGVtSW5mby5faW5mbzhBcnJheSA9IG9iakFycmF5O1xuICAgICAgICAvL2xldCBwbGF5ZXJzQXJyYXkgPSBvYmpBcnJheS5tYXAoZnVuY3Rpb24oc3RyKXtcbiAgICAgICAgLy8gIHJldHVybiBKU09OLnBhcnNlKHN0cik7XG4gICAgICAgIC8vfSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vdmFyIHBsYXllcnMgPSBwbGF5ZXJzQXJyYXlbcGxheWVyc0FycmF5Lmxlbmd0aC0xXS5kYXRhLnBsYXllcnM7XG4gICAgICAgIC8vZm9yICh2YXIgaSA9IDA7aSA8IHBsYXllcnMubGVuZ3RoO2krKykge1xuICAgICAgICAvLyAgICB0aGlzLm5pY2tuYW1lTGFiZWxzW2ldLnN0cmluZyA9IHBsYXllcnNbaV0ubmlja25hbWU7XG4gICAgICAgIC8vICAgIHRoaXMuc2NvcmVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc1tpXS5jU2NvcmU7XG4gICAgICAgIC8vfVxuICAgIH0sXG4gICAgcmVjb3JkczpmdW5jdGlvbigpe1xuXG4gICAgfSxcblxuXG59KTsiLCJjb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBzY3JvbGxWaWV3OmNjLk5vZGUsXG4gICAgICAgIHJlY29yZEl0ZW06Y2MuUHJlZmFiLFxuICAgICAgICAvL3N1YlNjcm9sbFZpZXc6Y2MuTm9kZSxcbiAgICAgICAgLy9zdWJSZWNvcmRJdGVtOmNjLk5vZGUsXG4gICAgICAgIC8vc3BsYXNoOmNjLlByZWZhYixcbiAgICAgICAgLy9yZW9yZEluZm86Y2MuTm9kZSxcbiAgICAgICAgLy9cbiAgICAgICAgLy9qaWZlbjpjYy5MYWJlbCxcbiAgICAgICAgLy9oZWFkOmNjLk5vZGUsXG4gICAgICAgIC8vaWQ6Y2MuTGFiZWwsXG4gICAgICAgIC8vbmlja25hbWU6Y2MuTGFiZWwsXG4gICAgICAgIC8vY3JlYXQ6Y2MuTGFiZWwsICAgICAgICAvLyDliJvmiL/kurpcbiAgICAgICAgLy9jcmVhdGVVc2VyOmNjLk5vZGUsICAgICAvLyAg5aS05YOPXG4gICAgICAgIC8vXG4gICAgICAgIC8vdGltZUxhYmVsOmNjLkxhYmVsLCAgIC8vIOaXtumXtFxuICAgICAgICAvL2p1c2h1TGFiZWw6Y2MuTGFiZWwsICAvLyDlsYDmlbBcbiAgICAgICAgLy8vL2NyZWF0ZVVzZXI6Y2MuTm9kZSwgICAvLyDmiL/kuLtcbiAgICAgICAgLy9yb29tSWQ6Y2MuTGFiZWwsICAgICAgLy8g5oi/6Ze05Y+3XG4gICAgICAgIC8vX3JlY29yZHM6bnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhpcy5pc1N1YlBhZ2UgPSBmYWxzZTtcbiAgICAgICAgLy90aGlzLnN1YlNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIC8vXG4gICAgICAgIC8vdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudCA9IHRoaXMuc3ViU2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcbiAgICAgICAgLy9jb25zb2xlLmxvZyggdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudCApO1xuICAgICAgICAvL3RoaXMucmVjb3JkSW5mbyA9IHRoaXMuc3ViU2Nyb2xsVmlld0NvbnRlbnQuY2hpbGRyZW5bMF07XG4gICAgICAgIC8vdGhpcy5yZW9yZHMgPSB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50LmNoaWxkcmVuWzBdLmNoaWxkcmVuWzNdO1xuICAgICAgICB0aGlzLnNjcm9sbFZpZXdDb250ZW50ID0gdGhpcy5zY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xuICAgICAgICB0aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XG4gICAgfSxcblxuICAgIF9yZWdpc3RlclNvY2tldEV2ZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5HZXRSZWNvcmQsIHRoaXMuX1JlY2VpdmVSZWNvcmRJbmZvLCB0aGlzKTtcbiAgICAgIC8vS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuR2V0SXRlbVJlY29yZCwgdGhpcy5fUmVjZWl2ZVJlY29yZEl0ZW0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBfUmVjZWl2ZVJlY29yZEluZm86ZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgLy9jYy5sb2cocmVzcG9uc2UpXG4gICAgICAgIC8vY2MubG9nKCctLS0tLS03OCcpXG4gICAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAvL3RoaXMuX3JlY29yZHMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAvL3RoaXMuaXNTdWJQYWdlID0gZmFsc2U7XG4gICAgICAgIC8vdGhpcy5zdWJTY3JvbGxWaWV3LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAvL3RoaXMuc2Nyb2xsVmlldy5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMuc2Nyb2xsVmlld0NvbnRlbnQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgICAgcmVzcG9uc2UuZGF0YS5maWx0ZXIoIGZ1bmN0aW9uIChyZWNvcmQpIHtyZXR1cm4gcmVjb3JkLnBsYXllcnNJbmZvLmxlbmd0aCA+IDA7fSkuZm9yRWFjaChmdW5jdGlvbiAocmVjb3JkSW5mbykge1xuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIHZhciBpdGVtID0gY2MuaW5zdGFudGlhdGUodGhpcy5yZWNvcmRJdGVtKTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVmlld0NvbnRlbnQuYWRkQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgICB2YXIgY29tcCA9IGl0ZW0uZ2V0Q29tcG9uZW50KCdyZWNvcmRJbmZvJyk7XG4gICAgICAgICAgICBjb21wLnNldEluZm8ocmVjb3JkSW5mbyk7XG4gICAgICAgICAgICB2YXIgcmVjb3JkQnRuID0gaXRlbS5jaGlsZHJlbls3XS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcbiAgICAgICAgICAgIHJlY29yZEJ0bi5jbGlja0V2ZW50c1swXS5jdXN0b21FdmVudERhdGEgPSByZWNvcmRJbmZvO1xuICAgICAgICAgICAgLy8gdmFyIGV2ZW50SGFuZGxlciA9IG5ldyBjYy5Db21wb25lbnQuRXZlbnRIYW5kbGVyKCk7XG4gICAgICAgICAgICAvLyBldmVudEhhbmRsZXIudGFyZ2V0ID0gY29tcC5ub2RlLmNoaWxkcmVuWzddO1xuICAgICAgICAgICAgLy8gZXZlbnRIYW5kbGVyLmNvbXBvbmVudCA9IFwiYnRuXCI7XG4gICAgICAgICAgICAvLyBldmVudEhhbmRsZXIuaGFuZGxlciA9IFwiY2xpY2tBY3Rpb25cIjtcbiAgICAgICAgICAgIC8vZXZlbnRIYW5kbGVyLmN1c3RvbUV2ZW50RGF0YSA9IFwibXkgZGF0YVwiO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhjb21wLm5vZGUuY2hpbGRyZW5bN10pO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBjbG9zZUFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNTdWJQYWdlKSB7XG4gICAgICAgICAgICB0aGlzLmlzU3ViUGFnZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxWaWV3LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAvKiBjbGlja0FjdGlvbjpmdW5jdGlvbiggaW5kZXggKXtcbiAgICAgICAgLy9fUmVjZWl2ZVJlY29yZEl0ZW0oKVxuICAgIH0sXG4gICAgX1JlY2VpdmVSZWNvcmRJdGVtOmZ1bmN0aW9uKFJlY29yZEl0ZW1JbmZvKSB7XG4gICAgICAgIGNjLmxvZyhSZWNvcmRJdGVtSW5mbylcbiAgICAgICAgY2MubG9nKCctLS0tLS03OCcpXG4gICAgICAgIC8vY29uc29sZS5sb2coUmVjb3JkSXRlbUluZm8pO3JldHVybjtcbiAgICAgICAgdmFyIGluZGV4ID0gUmVjb3JkSXRlbUluZm8uZGF0YVxuICAgICAgICB2YXIgcGxheWVyc0luZm8gPSBKU09OLnBhcnNlKHRoaXMuX3JlY29yZHNbaW5kZXhdLnBsYXllcnNJbmZvKTtcbiAgICAgICAgXG4gICAgICAgIHZhciBwbGF5ZXJzID0gcGxheWVyc0luZm8ucGxheWVyczsgICAgICAgICAgICAgICAgICAvLyDnjqnlrrbkv6Hmga9cbiAgICAgICAgdmFyIHBsYXllcnNJbmRleCA9IHBsYXllcnNJbmZvLnBsYXllcnNJbmRleDsgICAgICAgIC8vIOeOqeWutueahOS9jee9rlxuICAgICAgICB2YXIgY3JlYXRlVXNlcklkID0gdGhpcy5fcmVjb3Jkc1tpbmRleF0uY3JlYXRlVXNlcklkOyAgIC8vIOWIm+aIv0lEXG4gICAgICAgIHZhciBzZW5kVXNlcklkID0gdGhpcy5fcmVjb3Jkc1tpbmRleF0udXNlcmlkOyAgICAgICAgICAgLy8g5Y+R6YCB5Lq6SURcblxuICAgICAgICB0aGlzLmlzU3ViUGFnZSA9IHRydWU7XG4gICAgICAgIHRoaXMuc3ViU2Nyb2xsVmlldy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy50aW1lTGFiZWwuc3RyaW5nID0gKHRoaXMuX3JlY29yZHNbaW5kZXhdLmNyZWF0ZUF0KS5zdWJzdHIoNSwxMSk7ICAgICAgICAgICAgICAgLy8g5pe26Ze0XG4gICAgICAgIHRoaXMuanVzaHVMYWJlbC5zdHJpbmcgPSB0aGlzLmpzKEpTT04ucGFyc2UodGhpcy5fcmVjb3Jkc1tpbmRleF0uc2V0dGluZzIpKTsgICAgICAgIC8vIOWxgOaVsFxuICAgICAgICB0aGlzLnJvb21JZC5zdHJpbmcgPSB0aGlzLl9yZWNvcmRzW2luZGV4XS5yb29tSWQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmiL/pl7Tlj7dcbiAgICAgICAgdGhpcy5jcmVhdC5zdHJpbmcgPSB0aGlzLmZpbmRDcmVhdG9yKHRoaXMuX3JlY29yZHNbaW5kZXhdLmNyZWF0ZVVzZXJJZCxwbGF5ZXJzKTsgICAgLy8g5oi/5Li7XG5cbiAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudCA9IHRoaXMuc3ViU2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcbiAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudC5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwbGF5ZXJzLmxlbmd0aDsgaSsrICl7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuc3BsYXNoKTtcbiAgICAgICAgICAgIHRoaXMuc3ViU2Nyb2xsVmlld0NvbnRlbnQuYWRkQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgICB2YXIgY29tcCA9IGl0ZW0uZ2V0Q29tcG9uZW50KCdyZWNvcmRJbmZvJyk7XG4gICAgICAgICAgICB2YXIgY3JlYXRvciA9IDA7ICAgICAgIFxuICAgICAgICAgICAgdmFyIHNlbGYgPSAwOyAgICAgICAvLyDooajnpLroh6rlt7HvvIzopoHlr7noh6rlt7HnmoTmr5TniYzorrDlvZXog4zmma/lgZrlpITnkIZcbiAgICAgICAgICAgIGlmKGNyZWF0ZVVzZXJJZCA9PSBwbGF5ZXJzW2ldLmlkKXtcbiAgICAgICAgICAgICAgICBjcmVhdG9yID0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoIHNlbmRVc2VySWQgPT0gcGxheWVyc1tpXS5pZCl7XG4gICAgICAgICAgICAgICAgc2VsZiA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlY29yZHMoY29tcCxpLGNyZWF0b3Isc2VsZixpbmRleCk7XG4gICAgICAgIH1cblxuICAgIH0sXG4gICAgcmVjb3JkczpmdW5jdGlvbihpbmZvLGksY3JlYXRvcixzZWxmLGluZGV4KXtcbiAgICAgICAgaWYoc2VsZil7XG4gICAgICAgICAgICBpbmZvLm5vZGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTI1LCAxMjYsIDIwMCk7XG4gICAgICAgIH1cbiAgICAgICAgY2MubG9nKGluZm8pXG4gICAgICAgIGNjLmxvZygnLS0tLTExOScpXG4gICAgICAgIHZhciBwbGF5ZXJzID0gSlNPTi5wYXJzZSh0aGlzLl9yZWNvcmRzW2luZGV4XS5wbGF5ZXJzSW5mbykucGxheWVycztcbiAgICAgICAgdmFyIHNjb3JlcyA9IHRoaXMuX3JlY29yZHNbaW5kZXhdLnNjb3JlcyA7XG4gICAgICAgIGluZm8ubmlja25hbWVMYWJlbHMuc3RyaW5nID0gcGxheWVyc1tpXS5uaWNrbmFtZTtcbiAgICAgICAgaW5mby5pZC5zdHJpbmcgPSBwbGF5ZXJzW2ldLmlkO1xuICAgICAgICBpbmZvLmppZmVuLnN0cmluZyA9IHNjb3Jlc1tpXTtcblxuICAgICAgICB2YXIgaGVhZFVybCA9IHBsYXllcnNbaV0uYXZhdGFyVXJsOyAgIC8v5aS05YOP6L+e5o6lXG4gICAgICAgIHZhciBzcHJpdGUgPSBpbmZvLmF2YXRhck5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgIGNjLmxvYWRlci5sb2FkKGhlYWRVcmwrXCIuanBnXCIsIGZ1bmN0aW9uIChlcnIsIHRleCkge1xuICAgICAgICAgIGlmICghZXJyKSB7XG4gICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xuICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWU9ZnJhbWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaW5mby5jcmVhdG9ySW1nLmFjdGl2ZSA9IGNyZWF0b3I7XG4gICAgfSxcbiAgICBmaW5kQ3JlYXRvcjpmdW5jdGlvbihjcmVhdGVJZCxwbGF5ZXJzKXsgLy/mib7miL/kuLtcbiAgICAgICAgZm9yKHZhciBpPTA7IGk8cGxheWVycy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGlmKGNyZWF0ZUlkID09IHBsYXllcnNbaV0uaWQpe1xuICAgICAgICAgICAgICAgIHJldHVybiBwbGF5ZXJzW2ldLm5pY2tuYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBqczpmdW5jdGlvbihudW0pe1xuICAgICAgICB2YXIgSiA9IDU7XG4gICAgICAgIHN3aXRjaChudW0pe1xuICAgICAgICAgICAgY2FzZSAwOiBKID0gNTticmVhaztcbiAgICAgICAgICAgIGNhc2UgMTogSiA9IDEwO2JyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOiBKID0gMjA7YnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6IEogPSAzMDticmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gSjtcbiAgICB9LCovXG5cbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XG4gICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGNvbnRlbnQ6Y2MuTm9kZVxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdmlzaWJsZVNpemUgPSBjYy5kaXJlY3Rvci5nZXRWaXNpYmxlU2l6ZSgpO1xyXG4gICAgICAgIHZhciBjb250ZW50U2l6ZSA9IHt9O1xyXG4gICAgICAgIGNvbnRlbnRTaXplLndpZHRoID0gdGhpcy5ub2RlLndpZHRoO1xyXG4gICAgICAgIGNvbnRlbnRTaXplLmhlaWdodCA9IHRoaXMubm9kZS5oZWlnaHQ7XHJcbiAgICAgICAgdmFyIHNjYWxlWCA9IHZpc2libGVTaXplLndpZHRoL2NvbnRlbnRTaXplLndpZHRoO1xyXG4gICAgICAgIHZhciBzY2FsZVkgPSB2aXNpYmxlU2l6ZS5oZWlnaHQvY29udGVudFNpemUuaGVpZ2h0O1xyXG4gICAgICAgIHZhciBzY2FsZSA9IE1hdGgubWluKHNjYWxlWCxzY2FsZVkpLnRvRml4ZWQoMik7XHJcbiAgICAgICAgdGhpcy5ub2RlLnNjYWxlWCA9IHNjYWxlO1xyXG4gICAgICAgIHRoaXMubm9kZS5zY2FsZVkgPSBzY2FsZTtcclxuICAgIH1cclxufSk7XHJcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG5vZGVzOltjYy5Ob2RlXSxcbiAgICAgICAgc2VsZWN0ZWRJbmRleDogMCxcbiAgICAgICAgX3NlbGVjdDpbXSxcbiAgICAgICAgX3NlbGVjdGVkOjAsXG4gICAgICAgIGJlaWx2OmNjLk5vZGUsICAvLyDlgI3njodcbiAgICAgICAgX2JsU2hvdzowLCAgICAgIC8vIOWAjeeOh+eahOaYvuekuueKtuaAgVxuICAgIH0sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5iZWlsdi5hY3RpdmUgPSB0aGlzLl9ibFNob3c7XG4gICAgICAgIHRoaXMuX3NlbGVjdCA9IFsxLDEsMSwwLDBdOyBcbiAgICAgICAgaWYoY2Muc2V0KXsgIC8vIOiusOW9leS4iuS4gOWPpeeahOaIv+mXtOaDheWGtVxuICAgICAgICAgICAgdGhpcy5fc2VsZWN0ID0gY2Muc2V0WydzZXR0aW5nMyddO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWN0aXZlID0gdGhpcy5fc2VsZWN0W2ldO1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKGFjdGl2ZSk7XG4gICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGVzW2ldLmdldENoaWxkQnlOYW1lKCd0aXRsZScpO1xuICAgICAgICAgICAgaWYodGhpcy5fc2VsZWN0W2ldKXtcbiAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGk9PTMpe1xuICAgICAgICAgICAgICAgIHRoaXMuYmVpbHYuYWN0aXZlID0gKHRoaXMuX2JsU2hvdyA9IHRoaXMuX3NlbGVjdFszXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0Q29tcCA9IHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcbiAgICAgICAgICAgIHRDb21wLmluZGV4ID0gaTtcbiAgICAgICAgICAgIHRDb21wLmNsaWNrQWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXAgPSBzZWxmLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQoIHNlbGYuX3NlbGVjdFtpbmRleF0gPSAhc2VsZi5fc2VsZWN0W2luZGV4XSApO1xuICAgICAgICAgICAgICAgIGlmKCB0aGlzLmluZGV4ID09IDMgKXsgICAgICAgICAgICAgICAgICAgICAgLy8g56ys5LiJ5Liq5piv5bqE5a625qih5byP77yM5bqE5a625qih5byP5pi+56S65YCN546HXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYmVpbHYuYWN0aXZlID0gKHRoaXMuX2JsU2hvdyA9IHNlbGYuX3NlbGVjdFszXSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2VsZi5fc2VsZWN0W2luZGV4XSA9IHNlbGYuX3NlbGVjdFtpbmRleF07XG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgc2VsZi5vblNlbGVjdENoYW5nZShpbmRleCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGUuY2hpbGRyZW5bMF07XG4gICAgICAgICAgICAgICAgaWYoIHNlbGYuX3NlbGVjdFtpbmRleF0gKXsgICAgICAgICAgICAgLy8g5aaC5p6c5b2T5YmN6YCJ6aG55Li6VFJVRSDliJnmmL7npLrpnZLoibJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICAgICAgfWVsc2V7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlj43kuYsg55m96ImyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBvblNlbGVjdENoYW5nZTogZnVuY3Rpb24gKHNlbGVjdEluZGV4KSB7XG4gICAgICAgIC8vY2MubG9nKHNlbGVjdEluZGV4KTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLl9zZWxlY3QpO1xuICAgIH0sXG5cblxuXG59KTtcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBwYWk6Y2MuTm9kZSxcclxuICAgICAgICBtYXBhaTp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6W10sXHJcbiAgICAgICAgICAgIHR5cGU6Y2MuU3ByaXRlRnJhbWUsXHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdE1hID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChcInNlbGVjdF9tYVwiKTtcclxuICAgICAgICB0aGlzLnNlbGVjdE1hLm9uTG9hZCgpO1xyXG4gICAgICAgIHRoaXMuY29tID0gdGhpcy5wYWkuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBjbGlja0J0bkNvbWZpcm06ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5jb20uc3ByaXRlRnJhbWUgPSB0aGlzLm1hcGFpW2NjLmZyb20ubWFdO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy5jb20uc3ByaXRlRnJhbWUpO1xyXG4gICAgfSxcclxuICAgIFxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICByaWdodEljb246W2NjLk5vZGVdLFxuICAgICAgICBtYXBhaVJpZ2h0OmNjLk5vZGVcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKGNjLmZyb20gPT0gbnVsbCl7XG4gICAgICAgICAgICBjYy5mcm9tID0ge307XG4gICAgICAgIH1cbiAgICAgICAgLy/lpoLmnpzkuI3luKbpqazvvIzliJnpqazniYzkuLrnqbpcbiAgICAgICAgaWYodGhpcy5tYXBhaVJpZ2h0LmFjdGl2ZSA9PSBmYWxzZSl7XG4gICAgICAgICAgICBjYy5mcm9tLmlzVXNlTWEgPSBmYWxzZTtcbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSBudWxsO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIGNjLmZyb20uaXNVc2VNYSA9IHRydWU7XG4gICAgICAgICAgICAvL+WQpuWImemprOeJjOm7mOiupOS4uuesrDDkuKrvvIzljbPpu5HmoYM1XG4gICAgICAgICAgICBjYy5mcm9tLm1hID0gMDtcbiAgICAgICAgfVxuICAgICAgICBmb3IodmFyIGk9MDtpPHRoaXMucmlnaHRJY29uLmxlbmd0aDtpKyspIHtcbiAgICAgICAgICAgIGlmKGk9PTApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0SWNvbltpXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNjLmZyb20ubWEgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5yaWdodEljb25baV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0SWNvbltpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9LFxuICAgIG9uTWFQYWlDbGljazpmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciB0YXJnZXROYW1lID0gZS50YXJnZXQubmFtZTtcbiAgICAgICAgLy9jYy5sb2codGFyZ2V0TmFtZSlcbiAgICAgICAgaWYodGFyZ2V0TmFtZSAhPSB0aGlzLnNlbGVjdC5wYXJlbnQubmFtZSkge1xuICAgICAgICAgICAgaWYodGFyZ2V0TmFtZSA9PSBcInNlbGVjdF9rdWFuZzFcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5yaWdodEljb25bMl07XG4gICAgICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRhcmdldE5hbWUgPT0gXCJzZWxlY3Rfa3VhbmcyXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMucmlnaHRJY29uWzFdO1xuICAgICAgICAgICAgICAgIGNjLmZyb20ubWEgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZih0YXJnZXROYW1lID09IFwic2VsZWN0X2t1YW5nM1wiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QgPSB0aGlzLnJpZ2h0SWNvblswXTtcbiAgICAgICAgICAgICAgICBjYy5mcm9tLm1hID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5yaWdodEljb24ubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodEljb25baV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlbGVjdC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIC8vY29uc29sZS5sb2coY2MuZnJvbS5tYSk7XG4gICAgfVxuXG5cbn0pO1xuIiwiY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcclxuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgX3VzZXJpZCA6IDAsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuICAgIGNsaWNrQmVpTHY6ZnVuY3Rpb24oZXZlbnQsbnVtKXtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgU29ja2V0LnNlbmRCZWlMdihudW0sdGhpcy5fdXNlcmlkKTtcclxuICAgIH0sXHJcbiAgIFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgYmdOb2RlOmNjLk5vZGUsICAgLy/pgInmi6nmoYZcbiAgICAgICAgc2VsZWN0ZWROb2RlOmNjLk5vZGUsICAvL+WvueWPt1xuICAgICAgICBwYWk6Y2MuTm9kZSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy5ub2RlKTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgIC8vY29uc29sZS5sb2coY2Muc2V0KTtcbiAgICB9LFxuICAgIFxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gIXRoaXMuc2VsZWN0ZWQ7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRoaXMuc2VsZWN0ZWQ7XG4gICAgICBcbiAgICB9LFxuICAgIFxuICAgIHNldFNlbGVjdGVkOmZ1bmN0aW9uKHNlbGVjdGVkKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBzZWxlY3RlZDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUuYWN0aXZlID0gdGhpcy5zZWxlY3RlZDtcbiAgICB9LFxuICAgIC8qIyMjIyMqL1xuICAgIGNsaWNrU2VsZWN0S3Vhbmc6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhdGhpcy5zZWxlY3RlZDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUuYWN0aXZlID0gdGhpcy5zZWxlY3RlZDtcbiAgICAgICAgY2MuZnJvbS5pc1VzZU1hID0gdGhpcy5zZWxlY3RlZDtcbiAgICAgICAgdmFyIG1hcGFpQ29tID0gdGhpcy5wYWkuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XG4gICAgICAgIGlmKHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9PT0gZmFsc2Upe1xuICAgICAgICAgICAgbWFwYWlDb20uaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgbWFwYWlDb20uaW50ZXJhY3RhYmxlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG5vZGVzOltjYy5Ob2RlXSxcbiAgICAgICAgc2VsZWN0ZWRJbmRleDogMCxcbiAgICB9LFxuXG4gICAgLyojIyMjKi9cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgcnMgPSAwO1xuICAgICAgICB2YXIganMgPSAwO1xuICAgICAgICB2YXIgc2YgPSAwO1xuICAgICAgICB2YXIgYmwgPSAwO1xuICAgICAgICBpZihjYy5zZXQpe1xuICAgICAgICAgICAganMgPSBjYy5zZXQuc2V0dGluZzE7XG4gICAgICAgICAgICBycyA9IGNjLnNldC5zZXR0aW5nMjtcbiAgICAgICAgICAgIHNmID0gY2Muc2V0LnNldHRpbmc0O1xuICAgICAgICAgICAgYmwgPSBjYy5zZXQuc2V0dGluZzU7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgaXNTZWxlY3RlZCA9ICh0aGlzLnNlbGVjdGVkSW5kZXggPT0gaSk7XG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jykuc2V0U2VsZWN0ZWQoaXNTZWxlY3RlZCk7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgICAgICAgdmFyIHNlbGVjdEluZGV4ID0gdGhpcy5zZWxlY3RlZEluZGV4IDtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJykuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgaWYoIHNlbGVjdEluZGV4ID09IGkpe1xuICAgICAgICAgICAgICAgIHRoaXMubm9kZXNbc2VsZWN0SW5kZXhdLmdldENoaWxkQnlOYW1lKFwidGl0bGVcIikuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdENvbXAgPSB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICB0Q29tcC5pbmRleCA9IGk7XG5cbiAgICAgICAgICAgIHRDb21wLmNsaWNrQWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wID0gc2VsZi5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgICAgICBjb21wLnNldFNlbGVjdGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIFBlZXJzID0gdGhpcy5ub2RlLnBhcmVudC5jaGlsZHJlbjsgIC8vIOWQjOi+iOiKgueCuVxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBhPTA7IGE8UGVlcnMubGVuZ3RoOyBhKyspe1xuICAgICAgICAgICAgICAgICAgICBpZiggUGVlcnNbYV0uY2hpbGRyZW4ubGVuZ3RoPjAgKXsgICAgICAgICAgICAvLyDlpoLmnpzlkIzovojmnInlrZDoioLngrkg5aSE55CG5a2Q6IqC54K55paH5a2X55qE6aKc6ImyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBQZWVyc1thXS5nZXRDaGlsZEJ5TmFtZShcInRpdGxlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgICAgICAvL3RoaXMubm9kZS5jaGlsZHJlbltpbmRleF0uY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkSW5kZXggPSB0aGlzLmluZGV4O1xuICAgICAgICAgICAgICAgIHNlbGYub25TZWxlY3RDaGFuZ2UodGhpcy5pbmRleCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJyZW5zaHVcIiAmJiBjYy5zZXQgKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJzKTtcbiAgICAgICAgICAgIHRoaXMucmVtZW1iZXJfc2V0KHJzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiggdGhpcy5ub2RlLl9uYW1lID09IFwianVzaHVcIiAmJiBjYy5zZXQgKXtcbiAgICAgICAgICAgIHRoaXMucmVtZW1iZXJfc2V0KGpzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiggdGhpcy5ub2RlLl9uYW1lID09IFwiY2FyZHNcIiAmJiBjYy5zZXQgKXtcbiAgICAgICAgICAgIHRoaXMucmVtZW1iZXJfc2V0KHNmKTtcbiAgICAgICAgfVxuICAgICAgICBpZiggdGhpcy5ub2RlLl9uYW1lID09IFwiYmVpTHZcIiAmJiBjYy5zZXQgKXtcbiAgICAgICAgICAgIHRoaXMucmVtZW1iZXJfc2V0KGJsKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgcmVtZW1iZXJfc2V0OmZ1bmN0aW9uKG51bSl7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IG51bTtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgbGV0IGlzU2VsZWN0ZWQgPSAobnVtID09IGkpO1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKGlzU2VsZWN0ZWQpO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJykuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgaWYoIG51bSA9PSBpKXtcbiAgICAgICAgICAgICAgICAvLyBpZiggdGhpcy5ub2Rlc1tudW1dLmNoaWxkcmVuWzBdLm5hbWUgPT0gXCJ0aXRsZVwiICl7XG4gICAgICAgICAgICAgICAgLy8gICAgIGluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICAvLyB9ZWxzZSBpZih0aGlzLm5vZGVzW251bV0uY2hpbGRyZW5bMV0ubmFtZSA9PSBcInRpdGxlXCIpe1xuICAgICAgICAgICAgICAgIC8vICAgICBpbmRleCA9MTtcbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgdGhpcy5ub2Rlc1tudW1dLmdldENoaWxkQnlOYW1lKCd0aXRsZScpLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25TZWxlY3RDaGFuZ2U6IGZ1bmN0aW9uIChzZWxlY3RJbmRleCkge1xuXG5cbiAgICB9LFxuICAgIFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBpbmRpY2F0b3JOb2RlOmNjLk5vZGUsXG4gICAgICAgIGJhY2tncm91bmROb2RlOmNjLk5vZGUsXG4gICAgICAgIHNlbGVjdGVkTm9kZTpjYy5Ob2RlLFxuXG4gICAgICAgIHZhbHVlOjAsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuaW5kaWNhdG9yTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCxmdW5jdGlvbihldmVudCkge1xuXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRSxmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIHB0ID0gc2VsZi5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZShjYy52MihldmVudC5nZXRMb2NhdGlvblgoKSxldmVudC5nZXRMb2NhdGlvblkoKSkpO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTbGlkZXIocHQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCxmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIHB0ID0gc2VsZi5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZShjYy52MihldmVudC5nZXRMb2NhdGlvblgoKSxldmVudC5nZXRMb2NhdGlvblkoKSkpO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTbGlkZXIocHQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCxmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIHB0ID0gc2VsZi5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZShjYy52MihldmVudC5nZXRMb2NhdGlvblgoKSxldmVudC5nZXRMb2NhdGlvblkoKSkpO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTbGlkZXIocHQpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL3RoaXMubWF4V2lkdGggPSB0aGlzLm5vZGUud2lkdGggLSA0MDtcbiAgICAgICAgdGhpcy5tYXhXaWR0aCA9IHRoaXMubm9kZS53aWR0aC0yODtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICB9LFxuXG4gICAgdXBkYXRlU2xpZGVyOmZ1bmN0aW9uKHB0KSB7XG4gICAgICAgIHZhciB4ID0gcHQueDtcbiAgICAgICAgaWYgKHggPCAwKSB7XG4gICAgICAgICAgICB4ID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh4ID4gdGhpcy5tYXhXaWR0aCkge1xuICAgICAgICAgICAgeCA9IHRoaXMubWF4V2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh4L3RoaXMubWF4V2lkdGgpO1xuICAgICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UodGhpcy52YWx1ZSk7XG4gICAgfSxcblxuICAgIC8qMCAtIDEqL1xuICAgIHNldFZhbHVlOmZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52YWx1ZSA+IDEpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSAxO1xuICAgICAgICB9XG4gICAgICAgIC8vdGhpcy5tYXhXaWR0aCA9IHRoaXMubm9kZS53aWR0aCAtIDM4O1xuICAgICAgICB0aGlzLm1heFdpZHRoID0gdGhpcy5ub2RlLndpZHRoLTI4O1xuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUueCA9IHRoaXMudmFsdWUgKiB0aGlzLm1heFdpZHRoKzEwO1xuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS53aWR0aCA9IHRoaXMudmFsdWUgKiB0aGlzLm1heFdpZHRoICsgdGhpcy5pbmRpY2F0b3JOb2RlLndpZHRoLzI7XG4gICAgfSxcblxuICAgIG9uVmFsdWVDaGFuZ2U6ZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgY2MubG9nKHZhbHVlKTtcbiAgICB9LFxufSk7XG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5cbmxldCBTb2NrZXRDb25zdGFudCA9IHtcbiAgTWF4UmVjb25uZWN0Q2hlY2tJbnRlcnZhbDogNSwgLy8g6YeN6L+e5qOA5rWL5pe26Ze054mHXG59O1xuXG4vKipcbiAqIOi/meaYr+WvuSBXZWJTb2NrZXQg55qE5LiA5Liq5bCB6KOFXG4gKiBcbiAqIOmHjOmdouWMheWQq+iHquWKqOmHjei/nueahOWKn+iDvVxuICovXG5sZXQgU29ja2V0ID0gY2MuQ2xhc3Moe1xuICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgcHJvcGVydGllczoge1xuICAgIF9sYXN0UmVjZWl2ZU1zZ1RpbWU6IDAsIC8vIOacgOWQjuS4gOasoeaUtuWIsOa2iOaBr+aXtumXtCjmr6vnp5IpXG4gICAgX3RpbWVvdXQ6IDgsIC8vIOi2heaXtuaXtumVvyDvvIjnp5LvvIlcbiAgfSxcblxuICBzdGF0aWNzOiB7XG4gICAgaW5zdGFuY2U6IG51bGwsXG4gICAgLy8gdXJsOlwid3M6Ly8xODIuMTguMjYuMTM6NTA0MVwiLFxuICAgIC8vdXJsOlwid3M6Ly8xMjMuNTYuMjAuMTY0OjUwNDFcIiwvL+S/ruaUueWJjVxuICAgIHVybDpcIndzOi8vMTI3LjAuMC4xOjUwNDFcIixcbiAgICAvLyB1cmw6XCJ3czovLzE5Mi4xNjguMC4xMDg6NTA0MVwiLFxuICAgIC8vdXJsOlwid3M6Ly8xODMuMy4yMDUuMTQ5OjUwMDJcIixcbiAgfSxcblxuICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgU29ja2V0Lmluc3RhbmNlID0gdGhpcztcblxuICAgIHRoaXMubmFtZSA9IFwic29ja2V0XCI7XG5cbiAgICBjYy5nYW1lLmFkZFBlcnNpc3RSb290Tm9kZSh0aGlzLm5vZGUpO1xuICAgIGlmIChjYy5nYW1lLmlzUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSkpIHtcbiAgICAgIGNjLmxvZygn5re75Yqg5YWo5bGA6IqC54K5IFNvY2tldCDmiJDlip8nKTtcbiAgICB9XG5cbiAgICB0aGlzLl9yZWdpc3RlckFwcEFjdGl2ZUNoYW5nZSgpO1xuXG4gICAgdGhpcy5pc0NyZWF0aW5nID0gZmFsc2U7XG4gICAgdGhpcy5jcmVhdGVJbmRleCA9IDA7XG4gICAgdGhpcy5jcmVhdGVTb2NrZXQoKTtcblxuICAgIHRoaXMuc2NoZWR1bGUoZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jaGVja0Nvbm5lY3Rpb24oKTtcbiAgICB9LCA1KTtcblxuICAgIHRoaXMucmVjdlRpbWUgPSBEYXRlLm5vdygpOyAvL+aOpeaUtuWIsOacgOaWsOS4gOadoeacjeWKoeWZqOeahOS/oeaBr+eahOaXtumXtFxuICAgIC8vY2MubG9nKG1hbmFnZXIudmVyc2lvbik7XG5cbiAgICB0aGlzLl9jaGVja1NvY2tldCgpO1xuICB9LFxuXG4gIGNoZWNrQ29ubmVjdGlvbjogZnVuY3Rpb24gKCkge1xuICAgIC8v5a6i5oi356uv5a6a5pe257uZ5pyN5Yqh56uv5Y+R6YCB54K55pWw5o2u77yM6Ziy5q2i6L+e5o6l55Sx5LqO6ZW/5pe26Ze05rKh5pyJ6YCa6K6v6ICM6KKr5p+Q5Lqb6IqC54K555qE6Ziy54Gr5aKZ5YWz6Zet5a+86Ie06L+e5o6l5pat5byA55qE5oOF5Ya144CCXG4gICAgdGhpcy5zZW5kTWVzc2FnZSgnY2hlY2tBY3Rpb24nLCAnJyk7XG4gIH0sXG5cbiAgY3JlYXRlU29ja2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuY3JlYXRlSW5kZXgrKzsgLy/liJvlu7rmrKHmlbDliqAxXG4gICAgaWYgKHRoaXMuY3JlYXRlSW5kZXggPiA1KSB7XG4gICAgICB0aGlzLm5ldHdvcmtFcnJvcigpO1xuICAgICAgS1FOYXRpdmVJbnZva2UuZm9yY2VFeGl0QXBwKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNDcmVhdGluZyA9IHRydWU7XG5cbiAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RpbmcpO1xuICAgIHRoaXMud3MgPSBuZXcgV2ViU29ja2V0KFNvY2tldC51cmwpO1xuICAgIGlmICh0aGlzLndzID09PSBudWxsKSB7XG4gICAgICB0aGlzLm5ldHdvcmtFcnJvcigpO1xuICAgICAgS1FHbG9iYWxFdmVudC5lbWl0KFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0RXJyb3IsIHsnZGF0YSc6ICdTb2NrZXQg5Yib5bu65aSx6LSlJ30pO1xuICAgICAgS1FOYXRpdmVJbnZva2UuZm9yY2VFeGl0QXBwKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc29ja2V0RXJyb3IgPSBmYWxzZTtcblxuICAgIC8vIHNvY2tldCDov57mjqXmiJDlip9cbiAgICB0aGlzLndzLm9ub3BlbiA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgLy9jYy5sb2coXCJXZWJTb2NrZXQg6L+e5o6l5oiQ5Yqf77yaXCIsIGV2ZW50KTtcbiAgICAgIFxuICAgICAgc2VsZi5fbGFzdFJlY2VpdmVNc2dUaW1lID0gY2Muc3lzLm5vdygpO1xuICAgICAgS1FHbG9iYWxFdmVudC5lbWl0KFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0U3VjY2Vzc2VkLCBldmVudCk7XG5cbiAgICAgIHNlbGYuaXNDcmVhdGluZyA9IGZhbHNlO1xuICAgICAgc2VsZi5zb2NrZXRFcnJvciA9IGZhbHNlO1xuICAgICAgc2VsZi5jcmVhdGVJbmRleCA9IDA7XG4gICAgICBzZWxmLmNvbm5lY3Rpb25TdWNjZXNzKCk7XG4gICAgICBzZWxmLnNlbmRSZWNvbm5lY3RJbmZvKCk7XG4gICAgfTtcblxuICAgIC8vIHNvY2tldCDmjqXmlLbliLDmtojmga9cbiAgICB0aGlzLndzLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgc2VsZi5fbGFzdFJlY2VpdmVNc2dUaW1lID0gY2Muc3lzLm5vdygpO1xuICAgICAgS1FHbG9iYWxFdmVudC5lbWl0KFNvY2tldC5FdmVudC5Tb2NrZXRSZWNlaXZlTWVzc2FnZSwgZXZlbnQuZGF0YSk7XG5cbiAgICAgIHNlbGYuaXNDcmVhdGluZyA9IGZhbHNlO1xuICAgICAgc2VsZi5zb2NrZXRFcnJvciA9IGZhbHNlO1xuICAgICAgc2VsZi5yZWNldmljZU1lc3NhZ2UoZXZlbnQuZGF0YSk7XG4gICAgICBzZWxmLl9kaXNwYXRjaFJlc3BvbnNlKGV2ZW50LmRhdGEpO1xuICAgICAgc2VsZi5yZWN2VGltZSA9IERhdGUubm93KCk7IC8v5o6l5pS25pyA5paw5LiA5p2h5L+h5oGv55qE5pe26Ze0XG5cbiAgICAgIC8qKi9cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogc29ja2V0IOWPkeeUn+mUmeivr1xuICAgICAqIFxuICAgICAqIHNvY2tldCDmnKzouqvmnIkgYG9uZXJyb3JgIOWbnuiwg++8jOS9huS6i+WunuivgeaYju+8jOWFtuS4jemdoOiwse+8jFxuICAgICAqIOacieW+iOWkp+eahOacuueOh+acieivr+aKpeeahOihjOS4uu+8jOW4uOW4uOWcqOayoeaciemUmeivr+aXtu+8jOS8mue7memUmeivr+Wbnuiwg+OAglxuICAgICAqIOS4lOS4jeiDveWumuWItui2heaXtuaXtumVv1xuICAgICAqIFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlIFxuICAgICAqL1xuICAgIHRoaXMud3MuX2txX29uZXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgY2MuZXJyb3IoYFdlYlNvY2tldCDov57mjqXplJnor6/vvJoke21lc3NhZ2V9YCk7XG5cbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdEVycm9yLCB7ZGF0YTogbWVzc2FnZX0pO1xuICAgICAgc2VsZi53cy5jbG9zZSgpO1xuICAgICAgaWYgKCFzZWxmLndzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8g6Jm954S26LCD55So5LqGIHdlYnNvY2tldCDnmoQgY2xvc2Ug5pa55rOV77yM5L2G5pivXG4gICAgICAvLyDlroPlubbkvJrnq4vljbPosIPnlKggb25jbG9zZSDlm57osIPvvIzogIzmmK/lnKjmnKrmnaXnmoTmn5BcbiAgICAgIC8vIOS4gOaXtumXtOWGjeWbnuiwgyBvbmNsb3Nl77yb5L2G6L+Z6YeM5piO5pi+5Y+v5Lul55u05o6l5Zue6LCD5LqG44CCXG4gICAgICBsZXQgd3MgPSBzZWxmLndzO1xuXG4gICAgICBzZWxmLndzLm9uY2xvc2UoKTtcbiAgICAgIHdzLm9uY2xvc2UgPSBmdW5jdGlvbigpe307XG4gICAgfTtcblxuICAgIC8vIHNvY2tlIOW3suWFs+mXrVxuICAgIHRoaXMud3Mub25jbG9zZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgLy9jYy5sb2coJ1dlYlNvY2tldCDlt7LlhbPpl60gY2xvc2UgdGltZT0nICsgRGF0ZS5ub3coKSArIFwiIGV2ZW50OiBcIiArIGV2ZW50KTtcblxuXG4gICAgICBzZWxmLmlzQ3JlYXRpbmcgPSBmYWxzZTtcbiAgICAgIHNlbGYuc29ja2V0RXJyb3IgPSB0cnVlO1xuICAgICAgc2VsZi53cyA9IG51bGw7XG4gICAgICBzZWxmLmNvbm5lY3Rpb25EaXNjb25uZWN0KCk7XG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldERpc2Nvbm5lY3QsIGV2ZW50KTtcbiAgICAgIC8vY2MubG9nKCdzb2NrZXQgY2xvc2UnK0pTT04uc3RyaW5naWZ5KGV2ZW50KSk7XG4gICAgfTtcbiAgfSxcblxuICByZWNvbm5lY3Q6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCFzZWxmLmlzQ3JlYXRpbmcgJiYgc2VsZi5zb2NrZXRFcnJvcikge1xuICAgICAgICBzZWxmLmNyZWF0ZVNvY2tldCgpO1xuICAgICAgfVxuICAgIH0sIDIpO1xuICB9LFxuXG4gIHNlbmRSZWNvbm5lY3RJbmZvOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLnVzZXJJbmZvICE9IG51bGwpIHtcbiAgICAgICAgdmFyIHVzZXJJZCA9IHNlbGYudXNlckluZm8udXNlcl9pZCB8fCBzZWxmLnVzZXJJbmZvLmlkO1xuICAgICAgICBzZWxmLnNlbmRNZXNzYWdlKCdyZWNvbm5lY3QnLCB7XG4gICAgICAgICAgJ3VzZXJJZCc6IHVzZXJJZFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LCAxKTtcbiAgfSxcblxuICByZWNldmljZU1lc3NhZ2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gIH0sXG5cbiAgY29ubmVjdGlvbkRpc2Nvbm5lY3Q6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIGNvbm5lY3Rpb25TdWNjZXNzOiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICBuZXR3b3JrRXJyb3I6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIGNoZWNrTmV0d29ya1N0YXJ0OiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICBjaGVja05ldHdvcmtFbmQ6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIF9kaXNwYXRjaFJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2VTdHJpbmcpIHtcbiAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDmjqXmlLbliLDmnI3liqHlmajmtojmga/vvJpcIiwgcmVzcG9uc2VTdHJpbmcpO1xuICAgIGxldCByZXNwb25zZSA9IEpTT04ucGFyc2UocmVzcG9uc2VTdHJpbmcpO1xuICAgIGxldCBhY3Rpb24gPSByZXNwb25zZVtcImFjdGlvblwiXTtcbiAgICBpZiAoYWN0aW9uKSB7XG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoYWN0aW9uLCByZXNwb25zZSk7XG4gICAgfVxuICB9LFxuXG4gIC8vIE1BUks6IOWJjeWQjuWPsOaTjeS9nFxuICBfcmVnaXN0ZXJBcHBBY3RpdmVDaGFuZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDms6jlhozlupTnlKjov5vlhaXliY3jgIHlkI7lj7Dkuovku7ZcIik7XG4gICAgY2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX0hJREUsIHRoaXMuX2FwcEVudGVyQmFja2dyb3VuZCwgdGhpcyk7XG4gICAgY2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX1NIT1csIHRoaXMuX2FwcEJlY29tQWN0aXZlLCB0aGlzKTtcbiAgfSxcblxuICAvKipcbiAgICog6L+b5YWl5ZCO5Y+wXG4gICAqL1xuICBfYXBwRW50ZXJCYWNrZ3JvdW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcbiAgICBpZiAobm93IC0gdGhpcy5fbGFzdEFwcEVudGVyQmFja2dyb3VuZFRpbWUgPCAxMDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5fbGFzdEFwcEVudGVyQmFja2dyb3VuZFRpbWUgPSBub3c7XG4gICAgXG4gICAgLy9jYy5sb2coXCJXZWJTb2NrZXQg5qOA5rWL5Yiw5bqU55So6L+b5YWl5ZCO5Y+w77yaXCIsIG5ldyBEYXRlKCkpO1xuICAgIGxldCBpZCA9IHRoaXMudXNlckluZm8gPyB0aGlzLnVzZXJJbmZvLmlkIDogdW5kZWZpbmVkO1xuICAgIFNvY2tldC5zZW5kQXBwUGF1c2UoaWQpO1xuICAgIHRoaXMuX2NhbmNlbENoZWNrU29ja2V0KCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIOi/m+WFpeWJjeWPsCBcbiAgICovXG4gIF9hcHBCZWNvbUFjdGl2ZTogZnVuY3Rpb24gKCkge1xuICAgIGxldCBub3cgPSBjYy5zeXMubm93KCk7XG4gICAgaWYgKG5vdyAtIHRoaXMuX2xhc3RBcHBCZWNvbUFjdGl2ZVRpbWUgPCAxMDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5fbGFzdEFwcEJlY29tQWN0aXZlVGltZSA9IG5vdztcblxuICAgIC8vY2MubG9nKFwiV2ViU29ja2V0IOajgOa1i+WIsOW6lOeUqOi/m+WFpeWJjeWPsO+8mlwiLCBuZXcgRGF0ZSgpKTtcbiAgICBsZXQgaWQgPSB0aGlzLnVzZXJJbmZvID8gdGhpcy51c2VySW5mby5pZCA6IHVuZGVmaW5lZDtcbiAgICBTb2NrZXQuc2VuZEFwcEFjdGl2ZShpZCk7XG4gICAgdGhpcy5fY2hlY2tTb2NrZXQoKTtcblxuICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fY2hlY2tTb2NrZXRFeGVjdXRlKCk7XG4gICAgfS5iaW5kKHRoaXMpLCAxLjUpO1xuICB9LFxuXG4gIC8v6L+b5YWl5ZCO5Y+w5pON5L2cXG4gIGVudGVyYmFja2dyb3VkQWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5fYXBwRW50ZXJCYWNrZ3JvdW5kKCk7XG4gIH0sXG5cbiAgLy/ov5vlhaXliY3lj7Dmk43kvZxcbiAgcmVzdW1lQWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgLy/mo4Dmn6XnvZHnu5xcbiAgICB0aGlzLl9jaGVja05ldHdvcmsoKTtcbiAgICB0aGlzLl9hcHBCZWNvbUFjdGl2ZSgpO1xuICB9LFxuXG4gIHNlbmRNZXNzYWdlOiBmdW5jdGlvbiAoYWN0aW9uLCBkYXRhKSB7XG4gICAgZGF0YSA9IHRoaXMuX3N0cm9uZ1ZlcmlmeURhdGEoZGF0YSk7XG5cbiAgICBpZiAodGhpcy5zb2NrZXRFcnJvcikge1xuICAgICAgY2MuZXJyb3IoXCJzb2NrZXQg6L+e5o6l6ZSZ6K+v77yaXCIgKyB0aGlzLnNvY2tldEVycm9yKTtcbiAgICAgIHRoaXMucmVjb25uZWN0KCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vY2MubG9nKCdXZWJTb2NrZXQg5Y+R6YCB5raI5oGv77yaJyArIGFjdGlvbiwgZGF0YSk7XG4gICAgaWYgKGNjLnN5cy5pc09iamVjdFZhbGlkKHRoaXMud3MpKSB7XG4gICAgICBpZiAodGhpcy53cy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTikge1xuICAgICAgICB0aGlzLndzLnNlbmQodGhpcy5fY29udmVydFBhcmFtZXRlclRvU3RyaW5nKGFjdGlvbiwgZGF0YSkpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb25EaXNjb25uZWN0KCk7XG4gICAgfVxuICB9LFxuXG4gIF9zdHJvbmdWZXJpZnlEYXRhOiBmdW5jdGlvbihkYXRhID0ge30pIHtcbiAgICBpZiAoKHR5cGVvZiBkYXRhKSA9PSAnc3RyaW5nJykge1xuICAgICAgZGF0YSA9IHtcInN0cmluZ1wiOiBkYXRhfTtcbiAgICB9XG5cbiAgICBpZiAoZGF0YSA9PSBudWxsKSB7XG4gICAgICBkYXRhID0ge307XG4gICAgfVxuXG4gICAgaWYgKCFkYXRhW1widXNlcklkXCJdKSB7XG4gICAgICBpZiAodGhpcy51c2VySW5mbyAmJiAodHlwZW9mIHRoaXMudXNlckluZm8pID09ICdvYmplY3QnICYmIHRoaXMudXNlckluZm8uaWQpIHtcbiAgICAgICAgZGF0YVtcInVzZXJJZFwiXSA9IHRoaXMudXNlckluZm8uaWQ7XG4gICAgICB9XG5cbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG4gIH0sXG5cbiAgX2NvbnZlcnRQYXJhbWV0ZXJUb1N0cmluZzogZnVuY3Rpb24gKGFjdGlvbiwgZGF0YSA9IHt9KSB7XG4gICAgdmFyIG9iaiA9IHt9O1xuICAgIG9iai5hY3Rpb24gPSBhY3Rpb247XG4gICAgb2JqLmRhdGEgPSBkYXRhO1xuICAgIFxuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShvYmopO1xuICB9LFxuXG4gIC8vIOajgOafpee9kee7nFxuICBfY2hlY2tOZXR3b3JrOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuY2hlY2tOZXR3b3JrTm93KSB7XG4gICAgICB0aGlzLmNoZWNrTmV0d29ya05vdygpO1xuICAgIH1cblxuICAgIHRoaXMuc2hvdWxkQ2hlY2sgPSB0cnVlO1xuICAgIGlmICghdGhpcy5zb2NrZXRFcnJvcikge1xuICAgICAgdGhpcy5yZWN2VGltZSA9IDA7XG4gICAgICB0aGlzLnNlbmRNZXNzYWdlKCdjaGVja0FjdGlvbicsICcnKTtcbiAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jaGVja05ldHdvcmtFbmQoKTtcbiAgICAgICAgdGhpcy5zaG91bGRDaGVjayA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5yZWN2VGltZSA9PT0gMCkge1xuICAgICAgICAgIHRoaXMuY29ubmVjdGlvbkRpc2Nvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgICAgfSwgMi41KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jb25uZWN0aW9uRGlzY29ubmVjdCgpO1xuICAgIH1cbiAgfSxcblxuICAvLyBNQVJLOiBzb2NrZXQg5o6J57q/5bC95pep56Gu6K6kXG4gIF9jaGVja1NvY2tldDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc2NoZWR1bGUodGhpcy5fY2hlY2tTb2NrZXRFeGVjdXRlLCBTb2NrZXRDb25zdGFudC5NYXhSZWNvbm5lY3RDaGVja0ludGVydmFsLCBjYy5tYWNyby5SRVBFQVRfRk9SRVZFUik7XG4gIH0sXG5cbiAgX2NhbmNlbENoZWNrU29ja2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuX2NoZWNrU29ja2V0RXhlY3V0ZSk7XG4gIH0sXG5cbiAgX2NoZWNrU29ja2V0RXhlY3V0ZTogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLl9pc1NvY2tldFRpbWVvdXQoKSAmJiB0aGlzLndzKSB7XG4gICAgICB0aGlzLndzLl9rcV9vbmVycm9yKCfov57mjqXotoXml7YnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0sXG5cbiAgLy8gc29ja2V0IOaYr+WQpuW3sui2heaXtlxuICBfaXNTb2NrZXRUaW1lb3V0OiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xhc3RSZWNlaXZlTWVzc2FnZUludGVydmFsKCkgPj0gdGhpcy5fdGltZW91dDtcbiAgfSxcblxuICAvLyDkuIrkuIDmrKHmlLbliLDmtojmga/liLDnjrDlnKjnmoTml7bpl7Tpl7TpmpRcbiAgX2xhc3RSZWNlaXZlTWVzc2FnZUludGVydmFsOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcbiAgICBsZXQgaW50ZXJ2YWwgPSAobm93IC0gdGhpcy5fbGFzdFJlY2VpdmVNc2dUaW1lKSAvIDEwMDA7XG4gICAgLy9jYy5sb2coYFdlYlNvY2tldCDnjrDlnKjot53kuIrkuIDmnaHmlLbliLDmtojmga/nmoTml7bpl7Tpl7TpmpTmmK/vvJoke2ludGVydmFsfSDnp5JgKTtcbiAgICByZXR1cm4gaW50ZXJ2YWw7XG4gIH0sXG5cbn0pO1xuXG4vLyBNQVJLOiBTb2NrZXQg5LqL5Lu25a6a5LmJXG5Tb2NrZXQuRXZlbnQgPSB7XG4gIFNvY2tldENvbm5lY3Rpbmc6IFwiU29ja2V0Q29ubmVjdGluZ1wiLCAgICAgICAgICAgICAvLyBTb2NrZXQg5q2j5Zyo6L+e5o6lXG4gIFNvY2tldENvbm5lY3RTdWNjZXNzZWQ6IFwiU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZFwiLCAvLyDov57mjqXmiJDlip9cbiAgU29ja2V0RGlzY29ubmVjdDogXCJTb2NrZXREaXNjb25uZWN0XCIsICAgICAgICAgLy8gU29ja2V0IOaWreW8gOi/nuaOpVxuICBTb2NrZXRDb25uZWN0RXJyb3I6IFwiU29ja2V0Q29ubmVjdEVycm9yXCIsICAgICAvLyBTb2NrZXQg6L+e5o6l6ZSZ6K+vXG4gIFNvY2tldFJlY2VpdmVNZXNzYWdlOiBcIlNvY2tldFJlY2VpdmVNZXNzYWdlXCIsIC8vIFNvY2tldCDmjqXmlLbliLDmtojmga9cblxuICBMb2dpbkpvaW46XCJsb2dpbkpvaW5cIiwgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBIOS7jueZu+mZhueVjOmdouiOt+WPluaIv+mXtOWPt+i/m+WFpea4uOaIj1xuICBSZWNvcmRJZDpcInJlY29yZElkXCIsICAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBICBcbiAgT25jZUFnYWluOlwib25jZUFnYWluXCIsICAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBICBcbiAgQmVpTHY6IFwiYmVpTHZcIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSAgXG4gIEludml0ZUNvZGU6IFwiaW52aXRlQ29kZVwiLCAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgICDpgoDor7fnoIFcbiAgSm9pbkRlc2s6IFwiam9pbkRlc2tcIiwgICAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxuICBDcmVhdGVEZXNrOiBcImNyZWF0ZURlc2tcIiwgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXG4gIExlYXZlRGVzazogXCJsZWF2ZURlc2tcIiwgICAgICAgICAgICAgICAvLyDnprvlvIDmoYzlrZBcbiAgRGlzc29sdmVEZXNrOiBcImRpc3NvbHZlRGVza1wiLCAgICAgICAgIC8vIOino+aVo+ahjOWtkFxuICBBbnN3ZXJEaXNzb2x2ZTogXCJhbnN3ZXJEaXNzb2x2ZVwiLCAgICAgLy8g5Zue562U6K+35rGC6YCA5Ye65ZG95LukXG4gIEdldERlc2tJbmZvOiBcImdldERlc2tJbmZvXCIsICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcbiAgU2VuZEltYWdlOiBcInNlbmRJbWFnZVwiLCAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxuICBTZW5kVGV4dDogXCJzZW5kVGV4dFwiLCAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXG4gIFNlbmRFbW9qaTogXCJzZW5kRW1vamlcIiwgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcbiAgQ2hhbmdlSW5mbzpcImNoYW5nZUluZm9cIiwgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxuICBTZW5kQXVkaW9NZXNzYWdlOiBcInNlbmRBdWRpb01lc3NhZ2VcIiwgLy8g5a6i5oi356uv5Y+R6YCBICDlj5HpgIHor63pn7Pmtojmga9cbiAgR2V0UmVjb3JkOiBcImdldFJlY29yZFwiLCAgICAgICAgICAgICAgIC8vIOiOt+WPluaImOe7qeS/oeaBr1xuICBHZXRJdGVtUmVjb3JkOiBcImdldEl0ZW1SZWNvcmRcIiwgICAgICAgLy8g6I635Y+W5oiY57up5L+h5oGvXG4gIFBsYXlDYXJkOiBcInBsYXlDYXJkXCIsICAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIHvvIznlKjmiLfmiZPlh7rniYxcbiAgVGltZW91dERpc3NvbHZlOiBcInRpbWVvdXREaXNzb2x2ZVwiLCAgIC8vIOivt+axgumAgOWHuui2heaXtuaXtu+8jOmcgOimgeWPkeWHuueahOa2iOaBr1xuICBGZWVkYmFjazogXCJmZWVkYmFja1wiLCAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSAg5Y+N6aaI5L+h5oGvXG4gIFNoYXJlUG5nOiBcInNoYXJlUG5nXCIsICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBICDliIbkuqvpooblj5bnoJbnn7NcbiAgRW50ZXJSYW5kb206IFwiaW50ZXJSYW5kb21cIiwgICAvLyDlrqLmiLfnq6/lj5HpgIEgIOi/m+WFpemaj+acuuWculxuICBDYW5jZWxSYW5kb206IFwiY2FuY2VsUmFuZG9tXCIsIC8vIOWuouaIt+err+WPkemAgSAg5Y+W5raI6L+b5YWl6ZqP5py65Zy6XG4gIEZvcmNlRXhpdFJhbmRvbTogXCJkaXNzb2x2ZVwiLCAgLy8g5a6i5oi356uv5Y+R6YCBIOW8uuWItumAgOWHuumaj+acuuWculxuICBSZWFkeTogXCJyZWFkeVwiLCAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSDlh4blpIdcbiAgU3RhcnRHYW1lOiBcInN0YXJ0R2FtZVwiLCAvLyDlrqLmiLfnq6/lj5HpgIEg5byA5aeL5ri45oiPXG4gIEdldEhhbGxJbmZvOiBcImdldEhhbGxJbmZvXCIsICAgLy8g5a6i5oi356uv5Y+R6YCBIOiOt+WPluWkp+WOheS/oeaBr1xuICBHZXRVc2VySW5mbzogXCJnZXRVc2VySW5mb1wiLCAgIC8vIOWuouaIt+err+WPkemAgSDojrflj5bnlKjmiLfkv6Hmga9cbiAgQ2hlY2tBY3Rpb246IFwiY2hlY2tBY3Rpb25cIiwgICAvLyDlrqLmiLfnq6/lj5HpgIHvvIznlKjmnaXmo4DmtYvkuI7mnI3liqHlmajnmoTov57pgJrmgKdcbiAgUGF1c2U6IFwicGF1c2VcIiwgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/ov5vlhaXlkI7lj7Dml7bopoHlj5HpgIHnmoTmtojmga9cbiAgQWN0aXZlOiBcImFjdGl2ZVwiLCAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lm57liLDliY3lj7Dml7bopoHlj5HpgIHnmoTmtojmga9cbiAgUWluZ2xpOiBcInFpbmdsaVwiLCAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lm57liLDliY3lj7Dml7bopoHlj5HpgIHnmoTmtojmga9cblxuICBSZWNlaXZlUmVxdWVzdERpc3NvbHZlOiBcInJlcXVlc3REaXNzb2x2ZVwiLCAvLyDor7fmsYLop6PmlaPmoYzlrZAg5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVSZXF1ZXN0RGlzc29sdmVSZXN1bHQ6IFwicmVxdWVzdERpc3NvbHZlUmVzdWx0XCIsIC8vIOivt+axguino+aVo+ahjOWtkOe7k+aenFxuICBSZWNlaXZlQ2hhdFRleHQ6IFwic2VuZFRleHRcIiwgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVDaGF0RW1vamk6IFwic2VuZEVtb2ppXCIsICAvLyDmnI3liqHlmajlj5HpgIFcbiAgUmVjZWl2ZURlc2tJbmZvOiBcImRlc2tJbmZvXCIsICAgIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlR2FtZU92ZXI6IFwiZ2FtZU92ZXJcIiwgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVGYVBhaTogXCJmYXBhaVwiLCAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIFcbiAgUmVjZWl2ZVNoYXJlUG5nOiBcInNoYXJlUG5nc1wiLCAgIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlT25saW5lU3RhdHVzOiBcInNlbmRPbmxpbmVTdGF0dXNcIiwgIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlT25DaGFuZ2VJbmZvOiBcImNoYW5nZUluZm9cIiwgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlQXVkaW9NZXNzYWdlOiBcInNlbmRBdWRpb01lc3NhZ2VcIiwgIC8vIOacjeWKoeWZqOWPkemAge+8jOaOpeaUtuWIsOeUqOaIt+WPkemAgeS6huivremfs+a2iOaBr1xuICBSZWNlaXZlUGxheUNhcmQ6IFwicGxheUNhcmRcIiwgICAgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOacieeUqOaIt+W3sue7j+WHhuWkh+WlveeJjFxuICBSZWNlaXZlQ3JlYXRlRGVzazogXCJjcmVhdGVEZXNrXCIsICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOWIm+W7uuaIv+mXtOeahOWbnuiwg1xuICBSZWNlaXZlUmVhZHk6IFwicmVhZHlcIiwgICAgICAgICAgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOacieeUqOaIt+eCueWHu+S6huWHhuWkh1xuICBSZWNlaXZlSGFsbEluZm86IFwiZ2V0SGFsbEluZm9cIiwgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlR2V0VXNlckluZm86IFwiZ2V0VXNlckluZm9cIiwgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgSDojrflj5bnlKjmiLfkv6Hmga9cbiAgUmVjZWl2ZUNoZWNrQWN0aW9uOiBcImNoZWNrQWN0aW9uXCIsICAgICAgICAvLyDmnI3liqHlmajlj5HpgIEgIOeUqOadpeehruiupCBTb2NrZXQg6L+Y5Zyo6L+e552AXG4gIFJlY2VpdmVGb3JjZUV4aXQ6IFwiZm9yY2VFeGl0XCIsICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBICDnlKjmnaXkvb/lrqLmiLfnq6/lvLrpgIBcbiAgUmVjZWl2ZURpc3NvbHZlRGVzazogXCJkaXNzb2x2ZURlc2tcIiwgICAgICAvLyDmnI3liqHlmajlj5HpgIEgICDlvZPmiL/kuLvpgIDlh7rml7bvvIzop6PmlaPmoYzlrZBcbiAgUmVjZWl2ZUludGVyUmFuZG9tOiBcImludGVyUmFuZG9tXCIsICAgICAgICAvLyDmnI3liqHlmajlj5HpgIEgICDov5vlhaXpmo/mnLrlnLrnmoTlj43ppohcbiAgUmVjZWl2ZVBhdXNlOiBcInBhdXNlXCIsICAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIEgICDlvZPmnInnlKjmiLforr7lpIfov5vlhaXlkI7lj7Dml7bvvIzkvJrmlLbliLDov5nmnaHmtojmga9cbiAgUmVjZWl2ZUludml0ZUNvZGU6ICdpbnZpdGVDb2RlJywgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pS25Yiw6YKA6K+356CB55qE5raI5oGvXG4gIFJlY2VpdmVMZWF2ZURlc2s6ICdsZWF2ZURlc2snLCAgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOaUtuWIsOmcgOimgeemu+W8gOahjOWtkOeahOa2iOaBr1xuICBSZWNlaXZlU2VsZWN0QmVpTHY6ICdzZWxlY3RCZWlMdicsICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDpgInmi6nlgI3njofnmoTmtojmga9cbiAgUmVjZWl2ZUJlaUx2OidiZWlMdicsICAgICAgICAgICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pS25Yiw5YCN546H55qE5raI5oGvXG4gIFJlY2VpdmVRaW5nTGk6J3FpbmdsaScsICAgICAgICAgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOaUtuWIsOivt+emu1xuICBSZWNlaXZlUmVjb3JkSWQ6J3JlY29yZElkJywgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDmiJjnu6nkv6Hmga9cbiAgUmVjZWl2ZUxvZ2luSm9pbjonbG9naW5Kb2luJywgICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pS25Yiw5LuO6aG16Z2i6L+b5YWl5oi/6Ze05L+h5oGvXG4gIFJlY2VpdmVPbmNlQWdhaW46J29uY2VBZ2FpbicsICAgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOaUtuWIsOWGjeadpeS4gOWxgOS/oeaBr1xuICBSZWNlaXZlTm9VaW9uaWQ6J25vVWlvbmlkJywgICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pS25Yiw5rKh5pyJdW5pb25JROS/oeWPt1xufTtcblxuXG4vLyBNQVJLOiBTb2NrZXQg5o+Q5L6b55qE5Y+v5Y+R57uZ5pyN5Yqh5Zmo5raI5oGv55qE5pa55rOVXG5cblNvY2tldC5zZW5kQ2hlY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkNoZWNrQWN0aW9uLCBudWxsKTtcbn07XG4vKiovXG5Tb2NrZXQuc2VuZERpZFJlY2VpdmVHYW1lT3ZlckFjdGlvbiA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY29uc3QgcGFyYW0gPSB1c2VySWQgPyB7XCJ1c2VySWRcIjogdXNlcklkfSA6IG51bGw7XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UoU29ja2V0LkV2ZW50LkRpZFJlY2VpdmVHYW1lT3ZlckFjdGlvbiwgcGFyYW0pO1xufTtcbi8qKi9cblxuXG4vKipcbiAqIOW9kyBBUFAg6L+b5YWl5ZCO5Y+w5pe26KaB5Y+R6YCB55qE5raI5oGvXG4gKi9cblNvY2tldC5zZW5kQXBwUGF1c2UgPSBmdW5jdGlvbih1c2VySWQpIHtcbiAgbGV0IHBhcmFtID0gdXNlcklkID8ge1widXNlcklkXCI6IHVzZXJJZH0gOiBudWxsO1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuUGF1c2UsIHBhcmFtKTtcbn07XG5cbi8qKlxuICog5b2TIEFQUCDov5vlhaXliY3lj7Dml7blj5HpgIHnmoTmtojmga9cbiAqL1xuU29ja2V0LnNlbmRBcHBBY3RpdmUgPSBmdW5jdGlvbih1c2VySWQpIHtcbiAgbGV0IHBhcmFtID0gdXNlcklkID8ge1widXNlcklkXCI6IHVzZXJJZH0gOiBudWxsO1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQWN0aXZlLCBwYXJhbSk7XG59O1xuXG4vLyDlvIDmiL9cblNvY2tldC5zZW5kQ3JlYXRlRGVzayA9IGZ1bmN0aW9uIChjcmVhdGVEZXNjSW5mbywgdXNlcklkKSB7XG4gIGNjLmFzc2VydChjcmVhdGVEZXNjSW5mbyk7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuXG4gIGNyZWF0ZURlc2NJbmZvW1widXNlcklkXCJdID0gdXNlcklkO1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ3JlYXRlRGVzaywgY3JlYXRlRGVzY0luZm8pO1xufTtcblxuU29ja2V0LnNlbmRRaW5nbGkgPSBmdW5jdGlvbihsZWF2ZUlkLHVzZXJJZCl7XG4gbGV0IHBhcmFtID0ge1xuICAgIFwibGVhdmVJZFwiOiBsZWF2ZUlkLFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlFpbmdsaSwgcGFyYW0pO1xufTtcbi8vIOS7jueZu+mZhumhtemdouWKoOWFpeaIv+mXtFxuU29ja2V0LnNlbmRMb2dpbkpvaW4gPSBmdW5jdGlvbiAocm9vbUlkLCB1c2VySWQpIHtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwicm9vbUlkXCI6IHJvb21JZCxcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5Mb2dpbkpvaW4sIHBhcmFtKTtcbn07XG4vLyDlho3mnaXkuIDlsYBcblNvY2tldC5zZW5kT25jZUFnYWluID0gZnVuY3Rpb24gKGFnYWluLHVzZXJJZCkge1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIFwiYWdhaW5cIjphZ2FpbixcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50Lk9uY2VBZ2FpbiwgcGFyYW0pO1xufTtcbi8vIOWKoOWFpeaIv+mXtFxuU29ja2V0LnNlbmRKb2luRGVzayA9IGZ1bmN0aW9uIChyb29tSWQsIHVzZXJJZCkge1xuICBjYy5hc3NlcnQocm9vbUlkKTtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG5cbiAgbGV0IHBhcmFtID0ge1xuICAgIFwicm9vbUlkXCI6IHJvb21JZCxcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5Kb2luRGVzaywgcGFyYW0pO1xufTtcbi8vIOWQkeacjeWKoeerr+WPkemAgeaIkemAieaLqeeahOWAjeeOh1xuU29ja2V0LnNlbmRCZWlMdiA9IGZ1bmN0aW9uKGJlaWx2LHVzZXJJZCl7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcImJlaWx2XCI6IGJlaWx2LFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkJlaUx2LCBwYXJhbSk7XG59O1xuLy8g5Y+R6YCB6YKA6K+356CBXG5Tb2NrZXQuc2VuZEludml0ZUNvZGUgPSBmdW5jdGlvbihpbnZpdGVDb2RlLHVzZXJJZCl7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcImludml0ZUNvZGVcIjogaW52aXRlQ29kZSxcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5JbnZpdGVDb2RlLCBwYXJhbSk7XG59O1xuXG4vLyDojrflj5bmiL/pl7Tkv6Hmga9cblNvY2tldC5zZW5kR2V0RGVzY2tJbmZvID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuR2V0RGVza0luZm8sIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kVGV4dCA9IGZ1bmN0aW9uICh1c2VySWQsIHRleHQpIHtcbiAgLy9jYy5hc3NlcnQodXNlcklkKTtcbiAgLy9jYy5hc3NlcnQodGV4dCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcIm1zZ1wiOiB0ZXh0LFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlNlbmRUZXh0LCBwYXJhbSk7XG59O1xuU29ja2V0LnNlbmRFbW9qaSA9IGZ1bmN0aW9uKHVzZXJJZCxlbW9qaSl7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcImVtb2ppXCI6IGVtb2ppLFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlNlbmRFbW9qaSwgcGFyYW0pO1xufTtcblNvY2tldC5zZW5kQ2hhbmdlSW5mbyA9IGZ1bmN0aW9uKHVzZXJJZCxJbmZvKXtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwiY2hhbmdlSW5mb1wiOiBJbmZvLFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkNoYW5nZUluZm8sIHBhcmFtKTtcbn07XG5Tb2NrZXQuc2VuZEF1ZGlvTWVzc2FnZSA9IGZ1bmN0aW9uICh1c2VySWQsIHVybCA9IFwiXCIpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGNjLmFzc2VydCh1cmwubGVuZ3RoID4gMCk7XG5cbiAgaWYgKHVybC5sZW5ndGggPT0gMCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVybFwiOiB1cmwsXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU2VuZEF1ZGlvTWVzc2FnZSwgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRJbWFnZSA9IGZ1bmN0aW9uICh1c2VySWQsIGltYWdlKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBjYy5hc3NlcnQoaW1hZ2UpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJtc2dcIjogaW1hZ2UsXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU2VuZEltYWdlLCBwYXJhbSk7XG59O1xuXG5Tb2NrZXQuc2VuZEdldFJlY3JvZCA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXRSZWNvcmQsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kR2V0UmVjcm9kRnJvbUlkID0gZnVuY3Rpb24ocmVjb3JkSWQpe1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJyZWNvcmRJZFwiOnJlY29yZElkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuUmVjb3JkSWQscGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmREaXNzb2x2ZURlc2sgPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuRGlzc29sdmVEZXNrLCBwYXJhbSk7XG59O1xuXG5Tb2NrZXQuc2VuZEdldEl0ZW1SZWNvcmQgPSBmdW5jdGlvbiAodXNlcklkLCBwYXJlbnRJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgY2MuYXNzZXJ0KHBhcmVudElkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICBcInBhcmVudElkXCI6IHBhcmVudElkLFxuICB9O1xuXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXRJdGVtUmVjb3JkLCBwYXJhbSk7XG59O1xuXG5Tb2NrZXQuc2VuZExlYXZlRGVzayA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICBjYy5hc3NlcnQodXNlcklkKTtcbiAgICBsZXQgcGFyYW0gPSB7XG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgfTtcblxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5MZWF2ZURlc2ssIHBhcmFtKTtcbn0sXG5cbi8qKlxuICog5Zue562U6YCA5oi/6K+35rGCXG4gKiBcbiAqIEBwYXJhbSAge051bWJlcn0gdXNlcklkIOW9k+WJjeeUqOaItyBpZFxuICogQHBhcmFtICB7TlVtYmVyfSBhbnN3ZXI9MSDlm57nrZTjgIIxIOihqOekuuWQjOaEj++8myAwIOihqOekuuaLkue7ne+8myAtMSDooajnpLrmnKrpgInmi6lcbiAqL1xuU29ja2V0LnNlbmRBbnN3ZXJEaXNzb2x2ZSA9IGZ1bmN0aW9uICh1c2VySWQsIGFuc3dlciA9IDApIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgXCJhbnN3ZXJcIjogYW5zd2VyXG4gIH07XG5cbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkFuc3dlckRpc3NvbHZlLCBwYXJhbSk7XG59LFxuXG4gIFNvY2tldC5zZW5kRm9yY2VFeGl0Um9vbSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICBjYy5hc3NlcnQodXNlcklkKTtcbiAgICBsZXQgcGFyYW0gPSB7XG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgfTtcblxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5EaXNzb2x2ZURlc2ssIHBhcmFtKTtcbiAgfSxcblxuICAvLyDljYHkuInlvKDkuK1cbiAgLy8gY2FyZEluZm8g57G75Ly85LqO77yaXG4gIC8vIFt7XG4gIC8vICAgICAgICAgJ2NhcmRzJzpbeydzdWl0JzpzdWl0LCdudW1iZXInOm51bWJlcn0se31dLC8v54m55q6K54mM5LiN55So5LygXG4gIC8vICAgICAgICAgJ3R5cGUnOjAsXG4gIC8vICAgICAgICAgJ3ZhbHVlJzo0LFxuICAvLyAgICAgICAgICdpc0NvbnRhaW5FeHRyYSc6dHJ1ZSwvLyDnibnmrorniYzmmK/lkKbljIXlkKvnibnmrorniYxcbiAgLy8gICAgIH0sXG4gIC8vICAgICB7XG4gIC8vICAgICAgICAgJ2NhcmRzJzpbeydzdWl0JzpzdWl0LCdudW1iZXInOm51bWJlcn0se31dLFxuICAvLyAgICAgICAgICd0eXBlJzowLFxuICAvLyAgICAgICAgICd2YWx1ZSc6NFxuICAvLyAgICAgfV1cblNvY2tldC5zZW5kUGxheUNhcmQgPSBmdW5jdGlvbiAodXNlcklkLCBjYXJkSW5mbykge1xuICAgIGNjLmFzc2VydCh1c2VySWQpO1xuICAgIGxldCBwYXJhbSA9IHtcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICAgIFwiY2FyZFwiOiBjYXJkSW5mb1xuICAgIH07XG5cbiAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuUGxheUNhcmQsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kVGltZW91dERpc3NvbHZlID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuVGltZW91dERpc3NvbHZlLCBwYXJhbSk7XG59O1xuXG5Tb2NrZXQuc2VuZEZlZWRiYWNrID0gZnVuY3Rpb24gKHVzZXJJZCwgdGV4dCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgY2MuYXNzZXJ0KHRleHQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIFwidGV4dFwiOiB0ZXh0XG4gIH07XG5cbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkZlZWRiYWNrLCBwYXJhbSk7XG59XG5cblNvY2tldC5zZW5kU2hhcmVQbmcgPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU2hhcmVQbmcsIHBhcmFtKTtcbn07XG4vLyDlvIDlp4vljLnphY3pmo/mnLrlnLpcblNvY2tldC5zZW5kRW50ZXJSYW5kb20gPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5FbnRlclJhbmRvbSwgcGFyYW0pO1xufTtcblxuLy8g5Y+W5raI5Yy56YWN6ZqP5py65Zy6XG5Tb2NrZXQuc2VuZENhbmNlbFJhbmRvbSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG5cbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkNhbmNlbFJhbmRvbSwgcGFyYW0pO1xufTtcblxuLy8g5YeG5aSHXG5Tb2NrZXQuc2VuZFJlYWR5ID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgIGNjLmFzc2VydCh1c2VySWQpO1xuICAgIGxldCBwYXJhbSA9IHtcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICB9O1xuXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlJlYWR5LCBwYXJhbSk7XG4gIH0sXG4gICAgU29ja2V0LnNlbmRTdGFydEdhbWUgPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgICBjYy5hc3NlcnQodXNlcklkKTtcbiAgICAgIGxldCBwYXJhbSA9IHtcbiAgICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgICAgfTtcbiAgICAgIGNjLmxvZyh0aGlzLkV2ZW50LlN0YXJ0R2FtZSlcbiAgICAgIGNjLmxvZygpXG4gICAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU3RhcnRHYW1lLCBwYXJhbSk7XG4gICAgfSxcblxuLy8g6I635Y+W5aSn5Y6F5L+h5oGvXG5Tb2NrZXQuc2VuZEdldEhhbGxJbmZvID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgIGxldCBwYXJhbSA9IHtcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICB9O1xuXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkdldEhhbGxJbmZvLCBwYXJhbSk7XG59LFxuXG4vLyDojrflj5bnlKjmiLfkv6Hmga9cblNvY2tldC5zZW5kR2V0VXNlckluZm8gPSBmdW5jdGlvbiAodXNlcklkLCBvcGVuSWQpIHtcbiAgICBsZXQgcGFyYW0gPSB7XG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgICBcIm9wZW5JZFwiOiBvcGVuSWQsXG4gICAgfTtcblxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXRVc2VySW5mbywgcGFyYW0pO1xufSxcblxubW9kdWxlLmV4cG9ydHMgPSBTb2NrZXQ7IiwidGhpcy5fY2hhbmdlQ2FyZFNjb3JzID0gZnVuY3Rpb24oY2FyZE1vZGVsKSB7XHJcblxyXG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge2NhcmQuc2NvcmVzID0gY2FyZC5udW1iZXI7fSk7XHJcblxyXG4gICAgY2FyZE1vZGVsID0gdGhpcy5fY29udmVydE9uZVRvQShjYXJkTW9kZWwpO1xyXG5cclxuICAgIHZhciBpczE0ID0gdHJ1ZTsvL+aYr0EgSyBRIEogMTAgO1xyXG5cclxuICAgIHZhciBpczEgPSB0cnVlOy8v5pivMSAyIDMgNCA1XHJcblxyXG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge2lmIChjYXJkLnNjb3JlcyA8IDEwKSBpczE0ID0gZmFsc2U7fSk7Ly/kuI3mmK9BIEsgUSBKIDEwXHJcblxyXG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge2lmICgoY2FyZC5zY29yZXMgPiA1IHx8IGNhcmQuc2NvcmVzID09IDE0KSAmJiBjYXJkLnNjb3JlcyAhPSAyMClpczEgPSBmYWxzZX0pOy8v5LiN5pivMSAyIDMgNCA1fSk7XHJcblxyXG4gICAgaWYgKGlzMTQpIHsgLy/mmK9BIEsgUSBKIDEwIDtcclxuXHJcbiAgICAgICAgY2FyZE1vZGVsLnNvcnQoZnVuY3Rpb24oYTEsIGEyKSB7cmV0dXJuIGEyLnNjb3JlcyAtIGExLnNjb3Jlczt9KTtcclxuXHJcbiAgICAgICAgdmFyIG51bSA9IDE0LFxyXG4gICAgICAgICAgICBzY29yZXNBeXkgPSBbXTsgLy/kuIDlia/niYznmoTliIbmlbBcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgIHNjb3Jlc0F5eS5wdXNoKG51bSk7XHJcblxyXG4gICAgICAgICAgICBudW0gLT0gMTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNjb3Jlc0F5eS5sZW5ndGg7IGorKykge1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkTW9kZWwubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkgc2NvcmVzQXl5LnNwbGljZShqLCAxKTsgLy/liKDpmaTkuI3mmK/prLzniYznmoTliIZcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHsgaWYgKGNhcmQuc2NvcmVzID49IDIwKSBjYXJkLnNjb3JlcyA9IHNjb3Jlc0F5eS5zcGxpY2UoMCwgMSlbMF07fSk7Ly/mib7lh7rpgInkuK3nmoTniYxcclxuICAgIH1cclxuXHJcbiAgICBlbHNlIGlmIChpczEpIHsgLy/mmK8xIDIgMyA0IDVcclxuXHJcbiAgICAgICAgY2FyZE1vZGVsLnNvcnQoZnVuY3Rpb24oYTEsIGEyKSB7cmV0dXJuIGEyLnNjb3JlcyAtIGExLnNjb3Jlczt9KTtcclxuXHJcbiAgICAgICAgdmFyIG51bSA9IDUsXHJcbiAgICAgICAgICAgIHNjb3Jlc0F5eSA9IFtdOyAvL+S4gOWJr+eJjOeahOWIhuaVsFxyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgc2NvcmVzQXl5LnB1c2gobnVtKTtcclxuXHJcbiAgICAgICAgICAgIG51bSAtPSAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzY29yZXNBeXkubGVuZ3RoOyBqKyspIHtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRTY29yZXMgPSBjYXJkTW9kZWxbaV0uc2NvcmVzO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7aWYgKGNhcmQuc2NvcmVzID49IDIwKSBjYXJkLnNjb3JlcyA9IHNjb3Jlc0F5eS5zcGxpY2UoMCwgMSlbMF07fSk7Ly/mib7lh7rpgInkuK3nmoTniYxcclxuICAgIH1cclxuXHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtyZXR1cm4gYTEuc2NvcmVzIC0gYTIuc2NvcmVzO30pO1xyXG5cclxuICAgICAgICB2YXIgc2NvcmVzQXl5ID0gW107IC8v55So5p2l6KOF6ay854mM5YiG5pWwXHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgcyA9IHBhcnNlSW50KGNhcmRNb2RlbFswXS5zY29yZXMpICsgaTsgLy/mnIDlsI/nmoTniYznmoTliIbmlbBcclxuXHJcbiAgICAgICAgICAgIHNjb3Jlc0F5eS5wdXNoKHMpOy8v5LiA5Ymv54mM55qE5YiG5pWwXHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzY29yZXNBeXkubGVuZ3RoOyBqKyspIHtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRTY29yZXMgPSBjYXJkTW9kZWxbaV0uc2NvcmVzO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtpZiAoY2FyZC5zY29yZXMgPj0gMjApIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLDEpWzBdO30pOyAvL+aUueWPmOeJjOeahOWIhuaVsFxyXG4gICAgfVxyXG5cclxuICAgIGNhcmRNb2RlbCA9IHRoaXMuX2NvbnZlcnRPbmVUb0EoY2FyZE1vZGVsKTtcclxuXHJcbiAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtyZXR1cm4gYTEuc2NvcmVzIC0gYTIuc2NvcmVzO30pO1xyXG4gICAgcmV0dXJuIGNhcmRNb2RlbDtcclxufTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGxlZnROb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIFJpZ3RoTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBfdGltZTpudWxsLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG5cclxuICAgIHNldFRpbWU6IGZ1bmN0aW9uICh0aW1lKSB7XHJcblxyXG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG5cclxuICAgICAgICB0aGlzLl90aW1lID0gdGltZTtcclxuXHJcbiAgICAgICAgdGhpcy5sZWZ0Tm9kZS5yb3RhdGlvbiA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuUmlndGhOb2RlLnJvdGF0aW9uID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5SaWd0aE5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5sZWZ0Tm9kZS5zdG9wQWxsQWN0aW9ucygpO1xyXG5cclxuICAgICAgICB0aGlzLmxlZnROb2RlLnJ1bkFjdGlvbiggY2Mucm90YXRlQnkgKHRoaXMuX3RpbWUsLTE4MCkgKTtcclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgdGhpcy5SaWd0aE5vZGUucnVuQWN0aW9uKCBjYy5yb3RhdGVCeSAodGhpcy5fdGltZSwxODApICk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSwgdGhpcy5fdGltZSk7XHJcblxyXG4gICAgfSxcclxuXHJcblxyXG5cclxufSk7XHJcbiIsImNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBzcHJpdGVBdmF0YXI6IGNjLlNwcml0ZSxcbiAgICAgICAgbGFiZWxOaWNrbmFtZTogY2MuTGFiZWwsXG4gICAgICAgIGxhYmVsU2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBzcHJpdGVPZmZsaW5lOiBjYy5TcHJpdGUsXG4gICAgICAgIHZvaWNlTm9kZTogY2MuTm9kZSxcbiAgICAgICAgaG9tZVJ1bk5vZGU6IGNjLk5vZGUsXG4gICAgICAgIHJlYWR5Tm9kZTogY2MuTm9kZSxcbiAgICAgICAgYmVpbHY6Y2MuTGFiZWwsXG4gICAgICAgIHNob290Tm9kZXM6IFtjYy5Ob2RlXSxcbiAgICAgICAgYmFua2VyTm9kZTogY2MuTm9kZSxcbiAgICAgICAgZmFuZ1podU5vZGU6IGNjLk5vZGUsXG4gICAgICAgIHFpbmdsaTpjYy5Ob2RlLFxuICAgICAgICBpZDpjYy5MYWJlbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnVwZGF0ZVNjb3JlKCk7XG4gICAgfSxcblxuICAgIHNldHFpbmdsaSA6ZnVuY3Rpb24odmlzaWJsZSA9IGZhbHNlKXtcbiAgICAgIHRoaXMucWluZ2xpLmFjdGl2ZSA9ICh2aXNpYmxlICE9IGZhbHNlKTtcbiAgICB9LFxuXG4gICAgc2V0UmVhZHlOb2RlVmlzaWJsZTogZnVuY3Rpb24gKHZpc2libGUgPSBmYWxzZSkge1xuICAgICAgdGhpcy5yZWFkeU5vZGUuYWN0aXZlID0gKHZpc2libGUgIT0gZmFsc2UpO1xuICAgIH0sXG4gICAgc2V0QmVpbHZMYWJlbCA6ZnVuY3Rpb24oYmwpe1xuICAgICAgLy90aGlzLmJlaWx2LmFjdGl2ZSA9IHRydWU7XG4gICAgICB0aGlzLmJlaWx2LnN0cmluZyA9IGJsP2JsK1wi5YCNXCI6Jyc7XG4gICAgfSxcblxuICAgIHNldEZhbmdaaHVOb2RlVmlzaWJsZTogZnVuY3Rpb24gKHZpc2libGUgPSBmYWxzZSkge1xuICAgICAgICB0aGlzLmZhbmdaaHVOb2RlLmFjdGl2ZSA9ICh2aXNpYmxlICE9IGZhbHNlKTtcbiAgICB9LFxuXG4gICAgdXBkYXRlU2NvcmU6IGZ1bmN0aW9uIChzY29yZSA9IDApIHtcbiAgICAgICAgaWYoc2NvcmUgPj0gMCkge1xuICAgICAgICAgICAgdGhpcy5sYWJlbFNjb3JlLnN0cmluZyA9IFwiK1wiICsgc2NvcmU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmxhYmVsU2NvcmUuc3RyaW5nID0gXCJcIitzY29yZTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdXBkYXRlVXNlcklkOmZ1bmN0aW9uKGlkKXtcbiAgICAgIHRoaXMuaWQuc3RyaW5nID0gaWQgPyAoXCJJRDpcIitpZCk6XCJcIjtcbiAgICB9LFxuICAgIHVwZGF0ZU5pY2tuYW1lOiBmdW5jdGlvbihuaWNrbmFtZSA9IFwiXCIpIHtcbiAgICAgIHRoaXMubGFiZWxOaWNrbmFtZS5zdHJpbmcgPSBuaWNrbmFtZTtcbiAgICB9LFxuXG4gICAgdXBkYXRlQXZhdGFyOiBmdW5jdGlvbiAoYXZhdGFyKSB7XG4gICAgICBpZiAoYXZhdGFyLmVuZHNXaXRoKFwicG5nXCIpXG4gICAgICB8fCBhdmF0YXIuZW5kc1dpdGgoXCJqcGdcIilcbiAgICAgIHx8IGF2YXRhci5lbmRzV2l0aChcImdpZlwiKSkge1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvL2F2YXRhciA9IGF2YXRhciArIFwiLnBuZ1wiO1xuICAgICAgfVxuXG4gICAgICBjYy5sb2FkZXIubG9hZCh7dXJsOmF2YXRhcix0eXBlOlwianBnXCJ9LCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUoZGF0YSk7XG4gICAgICAgIHRoaXMuc3ByaXRlQXZhdGFyLnNwcml0ZUZyYW1lID0gZnJhbWU7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBzZXRPZmZsaW5lVmlzaWJsZTogZnVuY3Rpb24gKHZpc2libGUgPSBmYWxzZSkge1xuICAgICAgaWYgKFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xuICAgICAgICAvLyDlpoLmnpzmmK/lpITnkIblm57mlL7nirbmgIHvvIzlsLHkuI3nlKjlho3lpITnkIbnprvnur/mtojmga/kuoZcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNwcml0ZU9mZmxpbmUubm9kZS5hY3RpdmUgPSB2aXNpYmxlO1xuICAgIH0sXG5cbiAgICBzZXRJc0JhbmtlcjogZnVuY3Rpb24oaXNCYW5rZXIgPSBmYWxzZSkge1xuICAgICAgdGhpcy5iYW5rZXJOb2RlLmFjdGl2ZSA9IGlzQmFua2VyO1xuICAgIH0sXG5cbiAgICBwbGF5U2hvb3RBbmltYXRpb246IGZ1bmN0aW9uICh0b0luZGV4ID0gMCkge1xuICAgICAgLy9sZXQgc2hvb3ROb2RlID0gdGhpcy5zaG9vdE5vZGVzW3RvSW5kZXhdO1xuICAgICAgLy9zaG9vdE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgIC8vbGV0IGFuaW0gPSBzaG9vdE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAvL2FuaW0ucGxheSgnc2hvb3QnKS5vbignZmluaXNoZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyAgc2hvb3ROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgLy99LCB0aGlzKTtcblxuICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlEYVFpYW5nKCk7XG4gICAgfSxcblxuICAgIHBsYXlCdWxsZXRIb2xlQW5pbWF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgYnVsbGV0SG9sZU5vZGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ2J1bGxldEhvbGUnKTtcbiAgICAgIGJ1bGxldEhvbGVOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICBsZXQgYW5pbSA9IGJ1bGxldEhvbGVOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgYW5pbS5wbGF5KCdidWxsZXRIb2xlJykub24oJ2ZpbmlzaGVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBidWxsZXRIb2xlTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBwbGF5U3BlYWtBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMudm9pY2VOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudm9pY2VOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfS5iaW5kKHRoaXMpLCA0KTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5YWo5Z6S5omT5Yqo55S7XG4gICAgcGxheUhvbWVSdW5BaW1hdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgLy9sZXQgYWxlcnQgPSB0aGlzLmhvbWVSdW5Ob2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgIC8vYWxlcnQuYWxlcnQoKTtcbiAgICAgIC8vdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgLy8gIHRoaXMuaG9tZVJ1bk5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAvL30uYmluZCh0aGlzKSwgMik7XG4gICAgfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgemh1YW5OdW1MYWJlbDpjYy5MYWJlbCxcbiAgICAgICAganVzaHU6Y2MuTm9kZSxcbiAgICAgICAgQUE6Y2MuTm9kZSxcbiAgICAgICAgX3NlbGVjdGVkUGVvcGxlSW5kZXg6bnVsbCxcbiAgICAgICAgX3NlbGVjdGVkSnVzaHVJbmRleDpudWxsLFxuICAgICAgICBfc2VsZWN0ZWRBQUluZGV4Om51bGxcbiAgICB9LFxuXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2N0cmwoKTtcbiAgICB9LFxuXG4gICAgY2xpY2tQZW9wbGVBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX2N0cmwoKTtcbiAgICB9LFxuXG4gICAgY2xpY2tBQUFjdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jdHJsKCk7XG4gICAgfSxcblxuICAgIGNsaWNrSnVzaHVBY3Rpb246ZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jdHJsKCk7XG4gICAgfSxcblxuICAgICBfY3RybDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwic2luZ2xlU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XG4gICAgICAgIHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9IHRoaXMuanVzaHUuZ2V0Q29tcG9uZW50KFwic2luZ2xlU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XG4gICAgICAgIHRoaXMuX3NlbGVjdGVkQUFJbmRleCA9IHRoaXMuQUEuZ2V0Q29tcG9uZW50KFwiY2hlY2tTZWxlY3RcIikuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgLy/kurrmlbDpgIky5Lq65pe25LiU5rKh6YCJ5LiKQUHliLbmlLbotLlcbiAgICAgICAgIHZhciByZW5TaHUgPSAyO1xuICAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9PSAwKXtcbiAgICAgICAgICAgICByZW5TaHUgPSAyO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDEpe1xuICAgICAgICAgICAgIHJlblNodSA9IDM7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMil7XG4gICAgICAgICAgICAgcmVuU2h1ID0gNDtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9PSAzKXtcbiAgICAgICAgICAgICByZW5TaHUgPSA1O1xuICAgICAgICAgfVxuICAgICAgICAgdmFyIHpodWFuZ1NoaSA9IDIwO1xuICAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IDIwO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgICAgICAgemh1YW5nU2hpID0gNDA7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgICAgICB6aHVhbmdTaGkgPSA4MDtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDMpe1xuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IDEwO1xuICAgICAgICAgfVxuICAgICAgICAgLy9BQVxuICAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRBQUluZGV4ICE9IG51bGwpe1xuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IE1hdGguY2VpbCh6aHVhbmdTaGkgLyByZW5TaHUpO1xuICAgICAgICAgfVxuICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IHpodWFuZ1NoaTtcbiAgICAgICAgLy9pZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDApe1xuICAgICAgICAvLyAgICBpZih0aGlzLl9zZWxlY3RlZEFBSW5kZXggPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxuICAgICAgICAgICAgICAgIC8vaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAgICAgICAgIC8vICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjEwXCI7XG4gICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAgICAgLy8vL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgICAgICAgICAgLy9pZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgICAgICAgICAgLy8gICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMzBcIjtcbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgICAgICAvLy8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgICAgICAgICAvL2lmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgICAgICAgICAvLyAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI4MFwiO1xuICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgLy99XG4gICAgICAgIC8vICAgIGVsc2V7XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiOFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjE1XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjNcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvL1xuICAgICAgICAvL31cbiAgICAgICAgLy/kurrmlbDpgIkz5Lq6XG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAvL+ayoemAieS4ikFB5Yi25pS26LS5XG4gICAgICAgIC8vICAgIGlmKHRoaXMuX3NlbGVjdGVkQUFJbmRleCA9PSBudWxsKXtcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyMVwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjQyXCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiNjBcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvLyAgICAvL+mAieS6hkFB5pS26LS5XG4gICAgICAgIC8vICAgIGVsc2V7XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiN1wiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjE0XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjBcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvL1xuICAgICAgICAvL31cbiAgICAgICAgLy8vL+S6uuaVsOmAiTTkurrkuJTmsqHpgInkuIpBQeWItuaUtui0uVxuICAgICAgICAvL2Vsc2V7XG4gICAgICAgIC8vICAgIGlmKHRoaXMuX3NlbGVjdGVkQUFJbmRleCA9PSBudWxsKXtcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyOFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjU2XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiODRcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvLyAgICAvL0FB5Yi25pS26LS56YCJ5LiK5LqGXG4gICAgICAgIC8vICAgIGVsc2V7XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiN1wiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjE0XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjFcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvL31cbiAgICB9LFxufSk7XG4iXX0=