require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"ArrayExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4fd85NSsFJLd4qHrH0UjHzl', 'ArrayExtension');
// scripts\Extensions\ArrayExtension.js

// 给 Array 添加方法
// arr.find(...)
// arr.findIndex(...)
// arr.includes(e)
// arr.unique(equalFunction, isNewArray)
// Array.from
// Array.equal
// arr.isEqual(otherArray, isStrict)
// Array.sortByNumber
// arr.findSubArrayIndexs([])   用于查找数组内的部分元素的索引
// arr.translationWithStartIndex(startIndex) 将数组内的元素平移
// 如：[1, 2, 3, 4, 5].translationWithStartIndex(3) => [4,5,1,2,3]
// arr.kq_insert(index, e)   插入一个元素
// arr.kq_excludes(array)   // 除了array数组中的元素

module.exports = {};

if (!Array.prototype.find) {
  Array.prototype.find = function (predicate) {
    'use strict';
    if (this == null) {
      throw new TypeError('Array.prototype.find called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return value;
      }
    }
    return undefined;
  };
}

if (!Array.prototype.findIndex) {
  Array.prototype.findIndex = function (predicate) {
    if (this === null) {
      throw new TypeError('Array.prototype.findIndex called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return i;
      }
    }
    return -1;
  };
}

// https://tc39.github.io/ecma262/#sec-array.prototype.includes
if (!Array.prototype.includes) {
  Object.defineProperty(Array.prototype, 'includes', {
    enumerable: false,
    value: function value(searchElement, fromIndex) {

      // 1. Let O be ? ToObject(this value).
      if (this == null) {
        throw new TypeError('"this" is null or not defined');
      }

      var o = Object(this);

      // 2. Let len be ? ToLength(? Get(O, "length")).
      var len = o.length >>> 0;

      // 3. If len is 0, return false.
      if (len === 0) {
        return false;
      }

      // 4. Let n be ? ToInteger(fromIndex).
      //    (If fromIndex is undefined, this step produces the value 0.)
      var n = fromIndex | 0;

      // 5. If n ≥ 0, then
      //  a. Let k be n.
      // 6. Else n < 0,
      //  a. Let k be len + n.
      //  b. If k < 0, let k be 0.
      var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

      // 7. Repeat, while k < len
      while (k < len) {
        // a. Let elementK be the result of ? Get(O, ! ToString(k)).
        // b. If SameValueZero(searchElement, elementK) is true, return true.
        // c. Increase k by 1.
        // NOTE: === provides the correct "SameValueZero" comparison needed here.
        if (o[k] === searchElement) {
          return true;
        }
        k++;
      }

      // 8. Return false
      return false;
    }
  });
}

// unique
if (!Array.prototype.unique) {
  Object.defineProperty(Array.prototype, 'unique', {
    enumerable: false,
    value: function value(equalFunction) {
      var newArray = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

      if (newArray) {
        return this._unqiue_new(equalFunction);
      }

      return this._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue_new', {
    enumerable: false,
    value: function value(equalFunction) {
      var array = Array.from(this);

      return array._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue', {
    enumerable: false,
    value: function value(equalFunction) {
      var len = this.length;
      var i = -1;

      while (i++ < len) {
        var j = i + 1;

        for (; j < this.length; ++j) {
          var isEqual = false;
          if (equalFunction) {
            isEqual = equalFunction(this[i], this[j]);
          } else {
            isEqual = this[i] === this[j];
          }

          if (isEqual) {
            this.splice(j--, 1);
          }
        }
      }
      return this;
    }
  });
}

// Production steps of ECMA-262, Edition 6, 22.1.2.1
// Reference: https://people.mozilla.org/~jorendorff/es6-draft.html#sec-array.from
if (!Array.from) {
  Array.from = (function () {
    var toStr = Object.prototype.toString;
    var isCallable = function isCallable(fn) {
      return typeof fn === 'function' || toStr.call(fn) === '[object Function]';
    };
    var toInteger = function toInteger(value) {
      var number = Number(value);
      if (isNaN(number)) {
        return 0;
      }
      if (number === 0 || !isFinite(number)) {
        return number;
      }
      return (number > 0 ? 1 : -1) * Math.floor(Math.abs(number));
    };
    var maxSafeInteger = Math.pow(2, 53) - 1;
    var toLength = function toLength(value) {
      var len = toInteger(value);
      return Math.min(Math.max(len, 0), maxSafeInteger);
    };

    // The length property of the from method is 1.
    return function from(arrayLike /*, mapFn, thisArg */) {
      // 1. Let C be the this value.
      var C = this;

      // 2. Let items be ToObject(arrayLike).
      var items = Object(arrayLike);

      // 3. ReturnIfAbrupt(items).
      if (arrayLike == null) {
        throw new TypeError("Array.from requires an array-like object - not null or undefined");
      }

      // 4. If mapfn is undefined, then let mapping be false.
      var mapFn = arguments.length > 1 ? arguments[1] : void undefined;
      var T;
      if (typeof mapFn !== 'undefined') {
        // 5. else
        // 5. a If IsCallable(mapfn) is false, throw a TypeError exception.
        if (!isCallable(mapFn)) {
          throw new TypeError('Array.from: when provided, the second argument must be a function');
        }

        // 5. b. If thisArg was supplied, let T be thisArg; else let T be undefined.
        if (arguments.length > 2) {
          T = arguments[2];
        }
      }

      // 10. Let lenValue be Get(items, "length").
      // 11. Let len be ToLength(lenValue).
      var len = toLength(items.length);

      // 13. If IsConstructor(C) is true, then
      // 13. a. Let A be the result of calling the [[Construct]] internal method of C with an argument list containing the single item len.
      // 14. a. Else, Let A be ArrayCreate(len).
      var A = isCallable(C) ? Object(new C(len)) : new Array(len);

      // 16. Let k be 0.
      var k = 0;
      // 17. Repeat, while k < len… (also steps a - h)
      var kValue;
      while (k < len) {
        kValue = items[k];
        if (mapFn) {
          A[k] = typeof T === 'undefined' ? mapFn(kValue, k) : mapFn.call(T, kValue, k);
        } else {
          A[k] = kValue;
        }
        k += 1;
      }
      // 18. Let putStatus be Put(A, "length", len, true).
      A.length = len;
      // 20. Return A.
      return A;
    };
  })();
}

if (!Array.equal) {
  Array.equal = function (arr1, arr2) {
    var strict = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (arr1 === undefined || arr2 === undefined) {
      return false;
    }

    var length = arr1.length;
    if (length !== arr2.length) return false;
    for (var i = 0; i < length; i++) {
      if (strict) {
        if (arr1[i] !== arr2[i]) {
          return false;
        }
      } else {
        var value1 = arr1[i];
        var value2 = arr2[i];
        var result = true;
        if (Array.isArray(value1) && Array.isArray(value2)) {
          result = Array.equal(value1, value2, strict);
        } else {
          result = value1 == value2;
        }
      }
    }

    return true;
  };
}

if (!Array.prototype.isEqual) {
  Object.defineProperty(Array.prototype, 'isEqual', {
    enumerable: false,
    value: function value(otherArray) {
      var strict = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

      return Array.equal(this, otherArray, strict);
    }
  });
}

if (!Array.sortByNumber) {
  Array.sortByNumber = function (n1, n2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    return (n1 - n2) * (asc ? 1 : -1);
  };
}

if (!Array.prototype.findSubArrayIndexs) {
  Object.defineProperty(Array.prototype, 'findSubArrayIndexs', {
    enumerable: false,
    value: function value(subArray, f) {
      var _this = this;

      var indexs = [];

      var _loop = function () {
        var subValue = subArray[i];
        var findFunc = f || function (thisValue) {
          return subValue === thisValue;
        };
        var index = _this.findIndex(findFunc);
        if (index >= 0) {
          indexs.push(index);
        } else {
          indexs = [];
          return 'break';
        }
      };

      for (var i in subArray) {
        var _ret = _loop();

        if (_ret === 'break') break;
      }

      return indexs.length > 0 ? indexs : null;
    }
  });
}

if (!Array.prototype.translationWithStartIndex) {
  Object.defineProperty(Array.prototype, 'translationWithStartIndex', {
    enumerable: false,
    value: function value(startIndex) {
      if (startIndex == 0) {
        return this;
      }

      if (startIndex >= this.length) {
        return this;
      }

      var pre = this.slice(startIndex);
      var last = this.slice(0, startIndex);
      var result = pre.concat(last);

      return result;
    }
  });
}

if (!Array.prototype.kq_insert) {
  Object.defineProperty(Array.prototype, 'kq_insert', {
    enumerable: false,
    value: function value(index, e) {
      if (e == null) {
        return this;
      }

      if (index >= this.length) {
        this.push(e);
        return;
      }

      this.splice(index, 0, e);

      return this;
    }
  });
}

if (!Array.prototype.kq_excludes) {
  Object.defineProperty(Array.prototype, 'kq_excludes', {
    enumerable: false,
    value: function value(otherArray) {
      if (otherArray == null) {
        return this;
      }

      var result = [];
      this.forEach(function (element) {
        if (!otherArray.includes(element)) {
          result.push(element);
        }
      });

      return result;
    }
  });
}

/*
if(!Array.prototype.min){
  Array.prototype.min = function() {
    var min = this[0];
    var len = this.length;
    for (var i = 1; i < len; i++) {
      if (this[i] < min) {
        min = this[i];
      }
    }
    return min;
  }
}*/

cc._RFpop();
},{}],"AudioManager":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd5deKFuSZAC4Ky0zI4+z6O', 'AudioManager');
// scripts\Audio\AudioManager.js

var manager = require('manager');

var AudioManager = cc.Class({
    "extends": cc.Component,

    properties: {
        hall_bgm: {
            "default": null,
            url: cc.AudioClip
        },

        // 打枪
        daQiang: {
            "default": null,
            url: cc.AudioClip
        },

        fapai: {
            "default": null,
            url: cc.AudioClip
        },

        window: {
            "default": null,
            url: cc.AudioClip
        },

        click_weixin_login: {
            "default": null,
            url: cc.AudioClip
        },

        fangPai: {
            "default": null,
            url: cc.AudioClip
        }

    },

    statics: {
        instance: null
    },

    onLoad: function onLoad() {
        AudioManager.instance = this;
        this._registerAppActiveChange();

        this.soundOn = true;
        cc.game.addPersistRootNode(this.node);
        if (cc.game.isPersistRootNode(this.node)) {
            // cc.log('添加全局节点成功');
        }
        this.mValue = manager.getMusicValue();
        this.mEValue = manager.getMusicEffectValue();
        this.bgAudioId = -1;
    },

    stopHallMusic: function stopHallMusic() {
        cc.audioEngine.stop(this.bgAudioId);
    },

    playMusic: function playMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.hall_bgm, true);
        if (this.bgAudioId != -1) {
            //cc.log('play');
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
        //cc.audioEngine.playMusic( url, true )
    },

    playCompareCardsMusic: function playCompareCardsMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.hall_bgm, true);
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
    },

    playDaQiang: function playDaQiang() {
        for (var start = 0; start <= 1.6; start = start + 0.5) {
            this.scheduleOnce((function () {
                this._playSFX(this.daQiang);
            }).bind(this), start);
        }
    },

    // “打枪”
    playHumanDaQiang: function playHumanDaQiang() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = "resources/sounds/man" /* + (sex == 1 ? "man" : "woman")*/;
        path = path + "/daqiang1.mp3";

        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // “中枪”
    playHumanZQiang: function playHumanZQiang() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = "resources/sounds/man" /* + (sex == 1 ? "man" : "woman")*/;
        path = path + "/daqiang3.mp3";

        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playPokerClick: function playPokerClick() {
        var url = cc.url.raw('resources/sounds/public/click_wx_login.mp3');
        this._playSFX(url);
    },

    // 播放全垒打音效
    playHomeRun: function playHomeRun() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "special1.mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放发牌音效
    playFaPai: function playFaPai() {
        var path1 = this._soundsHumanPath(1) + "room_start_compare.mp3";
        var url1 = cc.url.raw(path1);
        this._playSFX(url1);
        //let pokerDeal = this._soundsHumanPath(1) + "poker_deal.mp3";
        //let urlPokerDeal = cc.url.raw(pokerDeal);
        //this._playSFX(urlPokerDeal);
        this._playSFX(this.fapai);
        for (var index = 0; index < 6; index++) {
            this.scheduleOnce((function () {
                this._playSFX(this.fapai);
            }).bind(this), index * 0.1);
        }
    },

    playCardType: function playCardType() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];
        var type = arguments.length <= 1 || arguments[1] === undefined ? -1 : arguments[1];

        // 只播放普通类型的语音
        if (type >= 10 || type < 0) {
            // 10 及以上是特殊牌
            var _path = this._soundsHumanPath(sex) + type + ".mp3";
            var _url = cc.url.raw(_path);
            this._playSFX(_url);
            return;
        }

        var path = this._soundsHumanPath(sex) + "common" + (type + 1) + ".mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放 开始比牌
    playStartCompare: function playStartCompare() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "start_compare.mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playWin: function playWin() {
        var url = cc.url.raw('resources/sounds/openface/win.mp3');
        this._playSFX(url);
    },

    playLose: function playLose() {
        var url = cc.url.raw('resources/sounds/openface/lose.mp3');
        this._playSFX(url);
    },

    coinIncome: function coinIncome() {
        var url = cc.url.raw('resources/sounds/openface/coin_income.mp3');
        this._playSFX(url);
    },

    _soundsHumanPath: function _soundsHumanPath(sex) {
        var path = "resources/sounds/man/" /* + (sex == 1 ? "man" : "woman") + "/"*/;
        return path;
    },

    setBgMusicVolumn: function setBgMusicVolumn(value) {
        this.mValue = value;
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, value);
        }
    },

    setEffectMusicVolum: function setEffectMusicVolum(value) {
        this.mEValue = value;
    },

    /*聊天*/
    playChatAudio: function playChatAudio(sex, str) {
        var index = this.chatTexts().indexOf(str);
        if (index === -1) {
            return;
        }
        var number = "CHAT" + (index + 1);
        var path = "resources/sounds/chat/" + number + ".mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    chatTexts: function chatTexts() {
        return ['还不出牌，我都快去吃锅边糊了', '嗨呀，我家里老人都比你打的快', '嗨呀，打牌打的我都困了', '哎，你快慢慢找，我先去西湖逛一下', '快一点呀，我等你想好我厕所都上一趟了', '你这在干嘛，这么慢', '嗨呀，最近在忙什么，很久没见了', '来来来，三缺一', '来来来，赶紧坐下来打一圈', '跟你们这些高手打我会紧张，让我一点', '蛮晚到天亮，输了可以让你们先欠着'];
    },

    pauseMusic: function pauseMusic() {
        this.soundOn = false;
        cc.audioEngine.pauseMusic();
    },

    resumeMusic: function resumeMusic() {
        this.soundOn = true;
        cc.audioEngine.resumeMusic();
    },

    _playSFX: function _playSFX(clip) {
        if (this.soundOn) {
            var audioId = cc.audioEngine.playEffect(clip, false);
            cc.audioEngine.setVolume(audioId, this.mEValue);
            return audioId;
        }

        return null;
    },

    // MARK: 前后台操作
    _registerAppActiveChange: function _registerAppActiveChange() {
        cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
        cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
    },

    /**
     * 进入后台
     */
    _appEnterBackground: function _appEnterBackground() {
        var now = cc.sys.now();
        if (now - this._lastAppEnterBackgroundTime < 100) {
            return;
        }
        this._lastAppEnterBackgroundTime = now;

        this.pauseMusic();
    },

    /**
     * 进入前台
     */
    _appBecomActive: function _appBecomActive() {
        var now = cc.sys.now();
        if (now - this._lastAppBecomActiveTime < 100) {
            return;
        }
        this._lastAppBecomActiveTime = now;

        this.resumeMusic();
    },

    /*确定按钮音效*/
    playBtnClickSFX: function playBtnClickSFX() {
        this._playSFX(this.click_weixin_login);
    },
    /*公共按钮，按键或者关闭按钮之类的音效*/
    palyBtnPublicSFX: function palyBtnPublicSFX() {
        this._playSFX(this.click_weixin_login);
    },

    /*取消按钮音效*/
    palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyWindowSFX: function palyWindowSFX() {
        this._playSFX(this.window);
    },
    palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyFangPaiSFX: function palyFangPaiSFX() {
        this._playSFX(this.fangPai);
    }

});

module.exports = AudioManager;

cc._RFpop();
},{"manager":"manager"}],"CardPrefab":[function(require,module,exports){
"use strict";
cc._RFpush(module, '94cdbrbPc9KRqx+1sHumWI3', 'CardPrefab');
// scripts\CardPrefab.js

var KQCard = require('KQCard');

cc.Class({
  'extends': cc.Component,

  properties: {
    graySprite: cc.Sprite,

    _cardName: null,
    _kqCardMode: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.graySprite.node.active = false;
  },

  // 通过牌名设置牌
  setCard: function setCard(cardName) {
    this._setCardName(cardName);

    this._loadCardFrame(cardName, (function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }).bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._kqCardMode;
  },

  _setCardName: function _setCardName(cardName) {
    this._cardName = cardName;
    this._kqCardMode = new KQCard(cardName);
  },

  // 设置选择状态
  setSelected: function setSelected() {
    var selected = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.graySprite.node.active = selected;
  },

  isSelected: function isSelected() {
    return this.graySprite.node.active;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"CardTypeCombine":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45c41vwAhFNYYSXDvaKpEP0', 'CardTypeCombine');
// scripts\CardTypeCombine.js

var _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var AudioManager = require('AudioManager');
var play = require('play');
var KQCardScoretsHelper = require('KQCardScoretsHelper');
// 牌类型 component
//
cc.Class({
    'extends': cc.Component,
    statics: {
        instances: null
    },
    properties: {
        cardsLayout: cc.Layout,
        // btnDuiZi: cc.Button,
        // btnLiangDui: cc.Button,
        // btnSanTiao: cc.Button,
        // btnShunZi: cc.Button,
        // btnTongHua: cc.Button,
        // btnHuLu: cc.Button,
        // btnTieZhi: cc.Button,
        // btnTongHuaShun: cc.Button,
        // btnWuTong: cc.Button,
        // typeButtonsNode: cc.Node,
        btnDeleteTouDao: cc.Button, // 头道
        btnDeleteZhongDao: cc.Button, // 中道
        btnDeleteWeiDao: cc.Button, // 尾道
        btnCancelAll: cc.Button, // 全部取消
        btnDone: cc.Button, // 确定出牌
        timeNode: cc.Node,
        labelTime: cc.Label,
        layoutTouDao: cc.Layout,
        layoutZhongDao: cc.Layout,
        layoutWeiDao: cc.Layout,
        cardAllNode: cc.Node,
        cardPrefab: cc.Prefab,
        cardTypePrefab: cc.Prefab,

        touDaoNode: cc.Node,
        zhongDaoNode: cc.Node,
        weiDaoNode: cc.Node,

        autoCardScrollView: cc.ScrollView,
        autoCard: cc.Prefab,
        autoCardLayout: cc.Layout,
        autoCardAnimation: cc.Node,

        LayoutWithEvent: [],

        BtnClickGongXiNiComfirm: false, //用于检查用户是否点击了恭喜你页面的确定按钮
        cardsLayoutSortColor: false,
        /*#####*/

        _cardOffsetY: null,

        _kqCardModes: [],
        _allCardModes: [],
        _findCardTypeObject: null, // 用来记录找到的牌型对象
        _findCardIndex: null, // 用来记录找到的牌型对象

        _finishSelectCardsCallback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.BtnClickGongXiNiComfirm = false;
        this.cardsLayoutSortColor = false;
        this._cardOffsetY = 0;
        this._registerTouchEvents();
        this._registerDaosLayoutClickEvent();
        this.reset();
        this._findCardIndex = {};
        this.cardTime = 0.3;

        this.cardSpriteAtlas = this.node.parent.getComponent('play').cardSpriteAtlas;
        this.daoSpriteAtlas = this.node.parent.getComponent('play').daoSpriteAtlas;
    },

    /*#####点击空白地方将牌收回去*/
    onClickCardTypeCombineNode: function onClickCardTypeCombineNode() {
        this._resetCardsPositionY();
    },

    _hideDeleteButtons: function _hideDeleteButtons() {
        //this.btnDeleteTouDao.node.active = false;
        //this.btnDeleteZhongDao.node.active = false;
        //this.btnDeleteWeiDao.node.active = false;
    },

    // 重置，回到最初始有状态
    reset: function reset() {
        this._hideDeleteButtons();
        this.clearCards();
        this.timeStop();
        //this._typeButtons().forEach(function (button) {
        //    button.interactable = false;
        //});
        this._allCardModes = [];
    },

    cardsLayoutSort: function cardsLayoutSort(e) {
        var nodeAyy = e.target.children;
        if (nodeAyy[0].active == true) {
            //按大小
            this.cardsLayoutSortColor = true;
            nodeAyy[0].active = false;
            nodeAyy[1].active = true;
            this._resetCardsPositionX();
            return;
        } else if (nodeAyy[1].active == true) {
            //按花色
            this.cardsLayoutSortColor = false;
            nodeAyy[0].active = true;
            nodeAyy[1].active = false;
            this._resetCardsPositionX();
        }
        //this.cardsLayoutSortColor = nodeAyy[1].active == false;
        //this.cardsLayoutSortColor == true
    },

    addCards: function addCards(cardNames) {
        cc.assert(cardNames);
        this._resetCardsPositionY();
        //cardNames.sort(function(a1,a2){
        //    return a1.split('_')[0] - a2.split('_')[0];
        //})
        cardNames.forEach((function (card, index) {
            this.addCard(card, false, index);
        }).bind(this));
        //this.cardsLayoutSort();
        this._resetCardsPositionX();
        this._reloadKQCardModesInner();
        this._resetTypeButtonEnablesWithModels(this._kqCardModes);
    },

    addCard: function addCard(cardName) {
        var autoChangePositionX = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var index = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];

        cc.assert(cardName.length > 0);

        var cardPrefab = cc.instantiate(this.cardPrefab);
        cardPrefab.name = cardName;
        // if(cc.maPai){
        //     var cardMaPai = '3_' + cc.maPai;
        //     if(cardName == cardMaPai){
        //         cardPrefab.color = new cc.Color(226, 145, 145);
        //     }
        // }
        cardPrefab.getComponent('CardPrefab').setCard(cardName, index);
        this.cardsLayout.node.addChild(cardPrefab);
        cardPrefab.setPositionY(this._cardOffsetY);

        if (autoChangePositionX) {
            this._resetCardsPositionX();
        }
        //let newCard = new KQCard(cardName,null,index);
        //let originCard = this._allCardModes.find(function(card) {
        //    return card.isEqual(newCard);
        //});
        //if (originCard == null && !autoChangePositionX) {
        //    this._allCardModes.push(newCard);
        //}
    },

    addCardModes: function addCardModes(cardNames) {
        cc.assert(cardNames.length > 0);
        this._allCardModes = [];
        cardNames.forEach((function (cardName, index) {
            var newCard = new KQCard(cardName, null, index);
            this._allCardModes.push(newCard);
        }).bind(this));
    },

    reloadCards: function reloadCards(cardNames) {
        //cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //三度同花
        // cardNames=['2_13', '2_5', '2_7', '3_1', '3_2', '3_4', '3_3', '3_13', '1_12', '1_6', '1_1', '1_4', '1_5'];
        //三同花顺
        //  cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '4_1', '4_2', '4_3'];
        //一条龙
        // cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '1_11', '1_12', '1_13'];
        //三顺子
        //cardNames=['4_1', '3_2', '4_3', '1_7', '4_5', '4_6', '3_9', '4_8', '3_1', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_9', '3_9', '4_8', '3_10', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_5', '3_6', '4_8', '3_6', '1_13', '4_12', '4_11', '2_7'];
        //cardNames=['3_4', '3_4', '4_6', '2_20', '1_20', '1_20', '3_6', '4_8', '3_6', '1_8', '4_12', '4_11', '2_20'];
        //三丰天下
        //cardNames=['1_1', '2_1', '3_1', '1_2', '2_2', '3_2', '4_1', '4_2', '3_3', '2_3', '1_3', '4_3', '1_13'];
        //4丰天下
        // cardNames=['1_1', '2_1', '3_1', '1_4', '2_4', '3_2', '4_2', '1_2', '3_4', '2_3', '1_3', '4_3', '1_2'];
        //六岁半
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //cardNames=['1_9', '2_11', '3_8', '1_12', '2_2', '3_2', '1_13', '2_5', '3_5','1_4', '2_4', '3_4', '3_10'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //   cardNames=['4_2', '2_3', '3_4', '3_5', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //cardNames=['4_1', '2_1', '1_4', '3_4', '1_6', '2_6', '1_8', '3_8', '2_8','2_12', '1_12', '2_13', '3_13'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_8', '2_9', '2_10', '2_11', '2_13','3_13', '3_12', '2_12', '1_12'];
        // cardNames=['4_9', '2_9', '3_4', '3_6', '1_8', '2_1', '2_5', '2_4', '2_3','3_13', '3_12', '2_2', '1_12'];
        //cardNames=['3_2', '4_2', '2_4', '3_5', '1_5', '3_7', '2_7', '3_10', '2_1','2_13', '2_10', '2_12', '2_11'];
        //cardNames=['4_2', '4_3', '4_4', '4_5', '4_5', '4_6', '4_12', '4_13', '2_12','3_12', '2_8', '3_8', '2_11'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '3_5', '2_5', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '2_20', '1_20', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_3', '3_4', '4_6', '4_5', '2_7', '1_20', '1_3', '4_4', '3_6','4_7', '4_8', '2_12', '1_12'];
        cc.log(cardNames);
        this.clearCards();
        this._kqCardModes = [];
        this.addCards(cardNames);
    },

    clearCards: function clearCards() {
        this.cardsLayout.node.removeAllChildren();
        this.layoutTouDao.node.removeAllChildren();
        this.layoutZhongDao.node.removeAllChildren();
        this.layoutWeiDao.node.removeAllChildren();
    },

    removeCard: function removeCard(cardName) {
        if (!cardName.length) {
            return;
        }

        this.cardsLayout.node.getChildByName(cardName).removeFromParent();
    },

    setFinishSelectCardsCallback: function setFinishSelectCardsCallback(callback) {
        this._finishSelectCardsCallback = callback;
        this.node.active = false;
    },

    _reloadKQCardModesInner: function _reloadKQCardModesInner() {
        //this._kqCardModes = this.cardsLayout.node.children.map(function (cardPrefabNode) {
        //    let cardPrefab = cardPrefabNode.getComponent('CardPrefab');
        //    return cardPrefab.cardMode();
        //}).sort(KQCard.sort);
        //this._findCardTypeObject = null;
    },

    _typeButtons: function _typeButtons() {
        //return [
        //    this.btnDuiZi,
        //    this.btnLiangDui,
        //    this.btnSanTiao,
        //    this.btnShunZi,
        //    this.btnTongHua,
        //    this.btnHuLu,
        //    this.btnTieZhi,
        //    this.btnTongHuaShun,
        //    /*#####*/
        //    //this.btnWuTong,
        //    /*#####*/
        //];
    },

    _resetTypeButtonEnablesWithModels: function _resetTypeButtonEnablesWithModels(cardModes) {
        /*cardModes.length == 13*/
        //cardModes = cardModes || this._kqCardModes;
        //
        ///*#####初始化牌*/
        //var ButtonsLayoutChilds = this.typeButtonsNode.children;
        //for(var i=0;i<ButtonsLayoutChilds.length;i++){
        //    ButtonsLayoutChilds[i].interactable = false;
        //}
        //
        //this.btnDuiZi.interactable = KQCard.containDuiZi(cardModes);
        //this.btnLiangDui.interactable = KQCard.containLiaDui(cardModes);
        //this.btnSanTiao.interactable = KQCard.containSanTiao(cardModes);
        //this.btnShunZi.interactable = KQCard.containShunZi(cardModes);
        //this.btnTongHua.interactable = KQCard.containTongHua(cardModes);
        //this.btnHuLu.interactable = KQCard.containHuLu(cardModes);
        //this.btnTieZhi.interactable = KQCard.containTieZhi(cardModes);
        //this.btnTongHuaShun.interactable = KQCard.containTongHuaShun(cardModes);
        ////this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        ////KQCard.isTeShuPai(cardModes)
        ////let typeName = KQCard.cardsTyp-eName(cardModes);
        ////KQCard.isLiuDuiBan(cardModes);
        ////alert(this.btnShunZi.interactable)
        ///*#####如果有多一色，就是设置无同按钮的可交互性*/
        ////if(cc.duoYiSe == 0) {
        ////    this.wuTongNode = this.typeButtonsNode.getChildByName("btnWuTong");
        ////    this.btnWuTong = this.wuTongNode.getComponent(cc.Button);
        ////    this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        ////}
        ///*#####*/
        //
        //this._autoActiveTypeButtons();
        //
        ///*#####设置按钮可交互和不可交互时的透明度*/
        //for(var i=0;i<ButtonsLayoutChilds.length;i++){
        //    if(ButtonsLayoutChilds[i].getComponent(cc.Button).interactable){
        //        ButtonsLayoutChilds[i].opacity = 255;
        //    }else{
        //        ButtonsLayoutChilds[i].opacity = 125;
        //    }
        //}
    },

    // 将找到了牌类型的牌突出出来
    _stickOutFindCardType: function _stickOutFindCardType(title, findMethods) {

        // 先根据牌类型找出所有的索引集合
        //var findedIndexsArray = null;
        //this._findCardTypeObject = this._findCardTypeObject || {};
        //if (this._findCardTypeObject.title != title) {
        //    findedIndexsArray = (findMethods() || []).reverse();
        //
        //    for(var i =0;i<findedIndexsArray.length-1;i++){//删除同类型牌
        //        var index = findedIndexsArray[i];
        //        /*if(title == 'liangDui'){
        //         let jStringspoint = index.map(function(indexs){
        //         return this._kqCardModes[indexs].point;
        //         }.bind(this));
        //         var isBreak = false;
        //         var repNum = jStringspoint.reduce(function(p,n){
        //         if(!p[n]){
        //         p[n] = 1;
        //         }else{
        //         p[n] += 1
        //         }
        //         return p
        //         },{});
        //         for(var y in repNum){
        //         if(repNum[y] >= 3){
        //         isBreak = true;
        //         }
        //         }
        //         if(isBreak){
        //         cc.log(repNum)
        //         cc.log(findedIndexsArray)
        //         cc.log(i)
        //         cc.log('--------291')
        //         findedIndexsArray.splice(i,1);
        //         continue;
        //         }
        //         }*/
        //        var iString = '';
        //        for(var j =i+1;j<findedIndexsArray.length;j++){
        //            var s = findedIndexsArray[j];
        //            var jString = '';
        //
        //            let iStrings = s.map(function(index){
        //                let cardModel = this._kqCardModes[index];
        //                return cardModel.cardName();
        //            }.bind(this));
        //
        //            let jStrings = index.map(function(indexs){
        //                let cardModel = this._kqCardModes[indexs];
        //                return cardModel.cardName();
        //            }.bind(this));
        //
        //
        //            for(var r = 0;r < index.length;r++){
        //                jString = jString + iStrings[r];
        //                iString = iString + jStrings[r];
        //            }
        //
        //            if(jString == iString){
        //                findedIndexsArray.splice(i,1);
        //                break;
        //            }
        //        }
        //    }
        //
        //    this._findCardTypeObject = {
        //        title: title,
        //        indexsArray: findedIndexsArray,
        //        //index: title=="duiZi"?findedIndexsArray.length-1:0
        //        index: 0
        //    };
        //}
        //
        //findedIndexsArray = this._findCardTypeObject.indexsArray;
        //if (!findedIndexsArray || findedIndexsArray.length == 0) {
        //    return;
        //}
        //// 将已有的突出的牌的位置重置回初始位置
        //this._resetCardsPositionY();
        //
        //// 计算出要突出的牌数组
        //var index = this._findCardTypeObject.index;
        //let indexs = findedIndexsArray[index];
        //
        //let selectedCardNames = indexs.map(function(index){
        //    let cardModel = this._kqCardModes[index];
        //    return cardModel.cardName();
        //}.bind(this));
        //
        //let cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {
        //    let cardPrefab = cardNode.getComponent('CardPrefab');
        //    if(selectedCardNames.includes(cardPrefab.cardName())) {
        //        var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());
        //        selectedCardNames.splice(nameIndex,1);
        //        return true;
        //    }
        //    return false;
        //});

        //// 突出计算出来的牌数组
        //this._changeCardPrefabsY(cardNodes);
        //// 保存好，用于再次点击了突出下一组牌
        //index = (index + 1) % findedIndexsArray.length;
        //this._findCardTypeObject.index = index;
    },

    clickDuiZi: function clickDuiZi() {
        this._stickOutFindCardType("duiZi", (function () {
            return KQCard.findDuiZi(this._kqCardModes);
        }).bind(this));
    },

    clickLiangDui: function clickLiangDui() {
        this._stickOutFindCardType("liangDui", (function () {
            return KQCard.findLiaDui(this._kqCardModes);
        }).bind(this));
    },

    clickSanTiao: function clickSanTiao() {
        this._stickOutFindCardType("sanTiao", (function () {
            return KQCard.findSanTiao(this._kqCardModes);
        }).bind(this));
    },

    clickShunZi: function clickShunZi() {
        this._stickOutFindCardType("shunZi", (function () {
            return KQCard.findShunZi(this._kqCardModes);
        }).bind(this));
    },

    clickTongHua: function clickTongHua() {
        this._stickOutFindCardType("tongHua", (function () {
            return KQCard.findTongHua(this._kqCardModes);
        }).bind(this));
    },

    clickHuLu: function clickHuLu() {
        this._stickOutFindCardType("huLu", (function () {
            return KQCard.findHuLu(this._kqCardModes);
        }).bind(this));
    },

    clickTieZhi: function clickTieZhi() {
        this._stickOutFindCardType("tieZhi", (function () {
            return KQCard.findTieZhi(this._kqCardModes);
        }).bind(this));
    },

    /*#####*/
    clickWuTong: function clickWuTong() {
        this._stickOutFindCardType("wuTong", (function () {
            return KQCard.findWuTong(this._kqCardModes);
        }).bind(this));
    },
    /*#####*/

    clickTongHuaShun: function clickTongHuaShun() {
        this._stickOutFindCardType("tongHuaShun", (function () {
            return KQCard.findTongHuaShun(this._kqCardModes);
        }).bind(this));
    },

    clickCancelAll: function clickCancelAll() {
        this.clickDeleteTouDao();
        this.clickDeleteZhongDao();
        this.clickDeleteWeiDao();
    },

    /*点击完成按钮*/
    clickDone: function clickDone() {
        cc.sys.localStorage.removeItem("timestamp");
        this.cardAlls = this.cardAllNode.children.sort(function (a, b) {
            return b.y - a.y;
        }).map(function (i) {
            return i.children[0];
        });

        var touCardModels = this._taoDaoCardModes();
        var zhongCardModes = this._zhongDaoCardModes();
        var weiCardModes = this._weiDaoCardModes();
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    /*点击恭喜你页面的确定按钮*/
    onBtnGongXiNiComfirmClick: function onBtnGongXiNiComfirmClick() {
        //记录玩家点击了确定按钮：
        this.BtnClickGongXiNiComfirm = true;

        var cards = [];

        cc.teShuPaiCards.forEach(function (i) {
            cards = cards.concat(i);
        });

        var teShuPaiCardsServerInfo = this._convertCardsToServerModel2(cards);
        var result = [teShuPaiCardsServerInfo];
        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    _didSelectedCards: function _didSelectedCards(touCards, zhongCards, weiCards) {
        touCards = touCards || [];
        zhongCards = zhongCards || [];
        weiCards = weiCards || [];
        var touServerInfo = this._convertCardsToServerModel(touCards);
        var zhongServerInfo = this._convertCardsToServerModel(zhongCards);
        var weiServerInfo = this._convertCardsToServerModel(weiCards);

        //console.log(touServerInfo);
        //console.log(zhongServerInfo);
        //console.log(weiServerInfo);
        //console.log("---------------------------------512");
        if (!(touServerInfo.value < zhongServerInfo.value && zhongServerInfo.value <= weiServerInfo.value)) {
            this.autoCardAnimation.y = -50;
            this.autoCardAnimation.opacity = 255;
            this.autoCardAnimation.runAction(cc.moveTo(1, cc.p(0, 0)));
            this.scheduleOnce((function () {
                var action = cc.spawn(cc.moveTo(this.cardTime, cc.p(0, 10)), cc.fadeOut(this.cardTime));
                this.autoCardAnimation.runAction(action);
            }).bind(this), 1.5);
            return;
        }
        var result = [touServerInfo, zhongServerInfo, weiServerInfo];
        //return;
        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    clickDeleteTouDao: function clickDeleteTouDao() {
        this._deleteDaoCardsOfLayout(this.layoutTouDao.node);
    },

    clickDeleteZhongDao: function clickDeleteZhongDao() {
        this._deleteDaoCardsOfLayout(this.layoutZhongDao.node);
    },

    clickDeleteWeiDao: function clickDeleteWeiDao() {
        this._deleteDaoCardsOfLayout(this.layoutWeiDao.node);
    },

    // 计时器事件
    timeStart: function timeStart(duration) {
        cc.assert(duration > 0);
        this.timeStop();
        this.timeNode.active = true;
        var timestamp = cc.sys.localStorage.getItem("timestamp"); // 获取本地存储的时间戳
        if (timestamp) {
            // 如果有则证明玩家是重新进来了的
            var now = Date.parse(new Date());
            var time = duration * 1000;
            if (now - timestamp > time) {
                // 超时
                if (now - timestamp < 2 * time) {
                    duration = 5; // 玩家可能出于其他原因退出游戏导致超时，为其提供5秒时间整理牌型（这已经是很仁慈的了）。
                } else {
                        cc.sys.localStorage.removeItem("timestamp");
                    }
            } else {
                duration = Math.floor(duration - (now - timestamp) / 1000);
            }
        } else {
            // 如果没有时间戳，则保存，为玩家退出游戏保留证据；
            var timestamp = Date.parse(new Date());
            cc.sys.localStorage.setItem('timestamp', timestamp);
        }
        this._timeRemainDuration = duration;
        this.labelTime.string = String(duration);
        this.timeNode.getComponent("time").setTime(duration * 0.5);
        this.schedule(this._timeMethod, 1, duration);
    },

    timeStop: function timeStop() {
        this.unschedule(this._timeMethod);
        this.timeNode.active = false;
    },

    _timeMethod: function _timeMethod() {
        this._timeRemainDuration = this._timeRemainDuration - 1;

        var remain = Math.max(this._timeRemainDuration, 0);
        this.labelTime.string = remain < 10 && remain > 0 ? '0' + remain : remain;

        if (this._timeRemainDuration <= 0) {
            this.timeStop();
            if (cc.chaoShiChuPai == true) this._timeOutAutoSelectCards();
            cc.sys.localStorage.removeItem("timestamp");
            return;
        }
    },

    // 超时后，自动选牌
    _timeOutAutoSelectCards: function _timeOutAutoSelectCards() {
        /**
         * 隐藏恭喜你
         */
        play.gongXiNiShow(false);
        if (typeof cc.teShuPaiCards != "undefined" && cc.teShuPaiCards != null) {
            this.onBtnGongXiNiComfirmClick();
            return;
        }

        //let [touCardModels, zhongCardModes, weiCardModes] = this._cacleAutoSelectedCards();

        var _findCardIndex$arr$0 = _slicedToArray(this._findCardIndex.arr[0], 3);

        var touCardModels = _findCardIndex$arr$0[0];
        var zhongCardModes = _findCardIndex$arr$0[1];
        var weiCardModes = _findCardIndex$arr$0[2];

        if (touCardModels == null || zhongCardModes == null || weiCardModes == null) {
            touCardModels = this._allCardModes.slice(-3);
            zhongCardModes = this._allCardModes.slice(5, 10);
            weiCardModes = this._allCardModes.slice(0, 5);
        }

        // cc.log(touCardModels)
        // cc.log(zhongCardModes)
        // cc.log(weiCardModes)
        // cc.log(this._allCardModes)
        // cc.log("自动选牌 touCardModels zhongCardModes weiCardModes：");
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    _cacleAutoSelectedCards: function _cacleAutoSelectedCards() {
        var cards = this._allCardModes.filter(function (i) {
            return i;
        });
        var resultCards = [];
        for (var i = 1; i < 3; i++) {
            var cardss = KQCard.autoSelectCards(cards, 5);
            cards = cards.kq_excludes(cardss);
            resultCards.push(cardss);
        }
        resultCards.push(cards);
        //let touScore = KQCard.scoreOfCards(resultCards[2]);
        //let zhongScore = KQCard.scoreOfCards(resultCards[1]);
        //let weiScore = KQCard.scoreOfCards(resultCards[0]);
        // cc.log(resultCards)
        // cc.log(this._allCardModes)
        // cc.log("牌分数自动选牌：", touScore, zhongScore, weiScore);
        //let weiCardModes = KQCard.autoSelectCards(cards, 5);
        //cards = cards.kq_excludes(weiCardModes);
        //
        //let zhongCardModes = KQCard.autoSelectCards(cards, 5);
        //
        //let touCardModes = cards.kq_excludes(zhongCardModes);
        //if (touCardModes.length == 3 && zhongCardModes.length == 5 && weiCardModes.length == 5) {
        //    return [touCardModes, zhongCardModes, weiCardModes];
        //}
        if (resultCards[2].length == 3 && resultCards[1].length == 5 && resultCards[0].length == 5) {
            return [resultCards[2], resultCards[1], resultCards[0]];
        }

        return [];
    },

    _convertCardsToServerModel: function _convertCardsToServerModel(cards) {
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = KQCard.scoreOfCards(cards);
        cards = KQCard._typeCardsSortByNumberOfPoints1(cards);
        result.cards = KQCard.convertToServerCards(cards);

        return result;
    },

    /*#####*/
    _convertCardsToServerModel2: function _convertCardsToServerModel2(cards) {
        var convertToServerCards = [];

        cc.teShuPaiCards.forEach(function (cardMode) {
            var arr = [];
            cardMode = KQCard._typeCardsSortByNumberOfPoints(KQCard.cardsFromArray(cardMode));
            cardMode.forEach(function (cca) {
                var point = cca.point == 14 ? 1 : cca.point;
                arr.push({ number: point, suit: cca.color });
            });
            convertToServerCards.push(arr);
        });
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = 0;
        result.cards = convertToServerCards;

        if (result.type >= KQCard.TYPE.SanTaoHua && cc.moshi != 1) {
            // 特殊牌
            result.isContainExtra = true;
        }

        return result;
    },
    /*#####*/
    // 特殊牌里是否还含有特殊牌
    // 包含的情况有：
    // 三桃花 可能含有同花顺
    // 三顺子 可能含有同花顺
    // 六对半 可能含有铁支
    _isContainExtraCardsType: function _isContainExtraCardsType(type, cards) {
        if (type == KQCard.TYPE.SanTaoHua) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.SanShunZi) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.LiuDuiBan) {
            return KQCard.containTieZhi(cards);
        }
        return false;
    },

    // 触摸事件
    _registerTouchEvents: function _registerTouchEvents() {
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_START, this._touchCardLayout.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_MOVE, this._touchCardLayout.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_END, this._touchCardLayoutEnd.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_CANCEL, this._touchCardLayoutEnd.bind(this));
    },
    cacleAutoSelectedCardsIndex: function cacleAutoSelectedCardsIndex(cards) {
        //cc.log('------622')
        var testFind = KQCard.testFind(cards) || [];
        //cc.log('------6221')
        var result = [];
        for (var i = 0; i < testFind.length; i++) {
            var s = testFind[i];
            if (s.length >= 1) {
                for (var j = 0; j < s.length; j++) {
                    //result.push(s[0]);//只取一个
                    result.push(s[j]); //
                }
            }
        }
        return result;
    },

    cacleAutoSelectedCardsArray: function cacleAutoSelectedCardsArray(cards) {
        var indexs = this.cacleAutoSelectedCardsIndex(cards);
        if (indexs.length < 1) {
            return false;
        }
        var selectedCard = [];
        for (var i = 0; i < indexs.length; i++) {
            var s = indexs[i];
            var a = s.map(function (index) {
                return cards[index];
            });
            selectedCard.push(a);
        }
        return selectedCard;
    },

    cacleAutoSelectedCards2: function cacleAutoSelectedCards2() {
        var cards = this._allCardModes.slice();
        var cardsArray = this.cacleAutoSelectedCardsArray(cards);
        var resultArray = [];
        for (var i = 0; i < cardsArray.length; i++) {
            var _s = cardsArray[i] || [];
            var qwer = [];
            for (var j = 1; j < cardsArray.length; j++) {
                var d = cardsArray[j] || [];
                var sC = _s.kq_excludes(d);
                if (sC.length == _s.length && _s.length > 0) {
                    //判断牌相同 即没有重复的
                    qwer = [_s, d];
                }
            }
            if (qwer.length > 1) {
                resultArray.push(qwer);
            }
        }

        //补全计划1
        for (var i = 0; i < resultArray.length; i++) {

            var _s2 = resultArray[i];

            var cardss = this._allCardModes.slice();

            cardss = cardss.kq_excludes(_s2[0]);

            cardss = cardss.kq_excludes(_s2[1]);

            if (cardss.length >= 5) {
                _s2[2] = KQCard.autoSelectCards(cardss, 5);
            } else {
                _s2[2] = KQCard.autoSelectCards(cardss, 3);
            }

            resultArray[i].sort(function (a1, a2) {
                return KQCard.scoreOfCards(a1) - KQCard.scoreOfCards(a2);
            });
        }
        //补全计划2
        for (var i = 0; i < resultArray.length; i++) {
            var s = resultArray[i];
            var cardsqe = this._allCardModes.filter(function (ii) {
                //重新赋值cards
                return ii;
            });
            //去重
            var q = s[0].concat(s[1]).concat(s[2]);
            var cardsq = cardsqe.kq_excludes(q);
            s[0] = s[0].kq_excludes(s[1]);
            s[0] = s[0].kq_excludes(s[2]);
            s[1] = s[1].kq_excludes(s[0]);
            s[1] = s[1].kq_excludes(s[2]);
            s[2] = s[2].kq_excludes(s[1]);
            s[2] = s[2].kq_excludes(s[0]);
            //多余删除
            if (s[2].length > 5) {
                //尾道
                var a = s[2].splice(5, s[2].length - 5);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            if (s[1].length > 5) {
                //中道
                var a = s[1].splice(5, s[1].length - 5);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            if (s[0].length > 3) {
                //头道
                var a = s[0].splice(3, s[0].length - 3);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            //cardsq = KQCard._convertOneToA(cardsq);
            cardsq.sort(KQCard.sortByPoint);
            cardsq.forEach(function (card11) {
                if (card11.point == 14) {
                    card11.point = 1;
                }
            });
            //有缺添加
            while (s[2].length < 5) {
                //尾道
                s[2].push(cardsq.pop() || []);
            }
            while (s[1].length < 5) {
                //中道
                s[1].push(cardsq.pop() || []);
            }
            while (s[0].length < 3) {
                //头道
                s[0].push(cardsq.pop() || []);
            }
            /*if(cardsq.length > 0){
                while(s[2].length < 5) {//尾道
                    s[2].push(cardsq.pop());
                }
            }
            if(cardsq.length > 0){
                while(s[1].length < 5) {//中道
                    s[1].push(cardsq.pop());
                }
            }
            if(cardsq.length > 0){
                while(s[0].length < 3) {//头道
                    s[0].push(cardsq.pop());
                }
            }*/
            if (s[2][4] == null || s[1][4] == null || s[0][2] == null || s[2][4] == '' || s[1][4] == '' || s[0][2] == '') {
                resultArray.splice(i, 1);
            }
        }

        var resultCards = [];
        var cardss1 = this._allCardModes.filter(function (i) {
            return i;
        });
        var indexasdf = 2;
        for (var i = 0; i < 3; i++) {
            var _length = indexasdf == 0 ? 3 : 5;
            var cardss = KQCard.autoSelectCards(cardss1, _length) || [];
            cardss1 = cardss1.kq_excludes(cardss);
            resultCards[indexasdf] = cardss;
            indexasdf--;
        }

        for (var i = 0; i < resultCards.length; i++) {
            var _length2 = i == 0 ? 3 : 5;
            if (resultCards[i].length < _length2) {
                cardss1 = cardss1.kq_excludes(resultCards[i]);
                while (resultCards[i].length < _length2) {
                    resultCards[i].push(cardss1.pop());
                }
            }
        }

        resultArray.push(resultCards);

        var cardsTypeNames = [];
        var resultArrays = [];

        for (var i = 0; i < resultArray.length; i++) {
            //删除类型相同的组合
            var _s3 = resultArray[i];
            var typeName0 = KQCard.cardsTypeName(_s3[0]);
            typeName0 += KQCard.cardsTypeName(_s3[1]);
            typeName0 += KQCard.cardsTypeName(_s3[2]);
            if (cardsTypeNames.indexOf(typeName0) == -1) {
                var touScore = KQCard.scoreOfCards(_s3[0]);
                var zhongScore = KQCard.scoreOfCards(_s3[1]);
                var weiScore = KQCard.scoreOfCards(_s3[2]);
                if (zhongScore > touScore && zhongScore < weiScore) {
                    cardsTypeNames.push(typeName0);
                    resultArrays.push(_s3);
                }
            }
        }

        resultArrays.sort(function (a1, a2) {
            var b0 = parseInt(KQCard.cardsType(a2[0])) + "";
            var b1 = parseInt(KQCard.cardsType(a2[1])) + "";
            var b2 = parseInt(KQCard.cardsType(a2[2])) + "";

            var s0 = parseInt(KQCard.cardsType(a1[0])) + "";
            var s1 = parseInt(KQCard.cardsType(a1[1])) + "";
            var s2 = parseInt(KQCard.cardsType(a1[2])) + "";

            var s = parseInt(s2 + s1 + s0);
            var b = parseInt(b2 + b1 + b0);

            return b - s;
        });

        if (resultArrays.length > 7) {
            resultArrays = resultArrays.slice(0, 7);
        }
        //for(var i = 0;i < resultArrays.length;i++){//如果有相公牌则删除
        //    let s = resultArrays[i];
        //    let touScore = KQCard.scoreOfCards(s[0]);
        //    let zhongScore = KQCard.scoreOfCards(s[1]);
        //    let weiScore = KQCard.scoreOfCards(s[2]);
        //    cc.log(touScore,zhongScore,weiScore);
        //    if(weiScore < touScore || weiScore < zhongScore){
        //        resultArrays.splice(i,1);
        //    }
        //}
        //cc.log(resultArrays)
        //cc.log('-------897')

        //if(cc.teShuPaiCards){
        //    var TeShuCards = cc.teShuPaiCards.map(function(ca){
        //       return KQCard._typeCardsSortByNumberOfPoints(KQCard.cardsFromArray(ca));
        //    });
        //    resultArrays.unshift(TeShuCards);
        //
        //}

        if (resultArrays.length <= 0) {

            this._allCardModes.forEach(function (i) {
                if (i.scores == 1) i.scores = 14;
            });

            var card20 = KQCard.contain20(this._allCardModes);

            this._allCardModes = this._allCardModes.kq_excludes(card20);

            this._allCardModes = KQCard._typeCardsSortByNumberOfPoints(this._allCardModes);

            this._allCardModes = card20.concat(this._allCardModes);

            var asdf1 = this._allCardModes.slice(0, 5);

            var asdf2 = this._allCardModes.slice(5, 10);

            var asdf3 = this._allCardModes.slice(10, 13);

            resultArrays.push([asdf3, asdf2, asdf1]);
        }

        this.autoCardLayout.node.removeAllChildren();
        this.autoCardScrollView.scrollToLeft();
        for (var i = 0; i < resultArrays.length; i++) {
            //添加预制体
            var _s4 = resultArrays[i];
            var autoCard = cc.instantiate(this.autoCard);
            autoCard.y = 0;
            _s4[0].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            _s4[1].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            _s4[2].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            var cardsNode = [autoCard.children[1], autoCard.children[3], autoCard.children[2]];

            this._setCardDaoSprite(cardsNode, _s4);

            autoCard.cardArray = _s4;
            var eventHandler = new cc.Component.EventHandler();
            eventHandler.target = this.node;
            eventHandler.component = "CardTypeCombine";
            eventHandler.handler = "clickAutoSelectedCards";
            eventHandler.customEventData = i;
            autoCard.getComponent(cc.Button).clickEvents.push(eventHandler);
            this.autoCardLayout.node.addChild(autoCard);
        }
        this._findCardIndex.arr = resultArrays;

        this.autoSelectedCardsOne();
    },

    //daoCancelAll: function () {
    //    var nodes = [this.layoutTouDao.node,this.layoutZhongDao.node,this.layoutWeiDao.node];
    //    for(var i = 0;i < nodes.length;i++){
    //        nodes[i].removeAllChildren();
    //    }
    //},

    autoSelectedCardsOne: function autoSelectedCardsOne() {
        this.cardsLayout.node.removeAllChildren();

        var indexs = 0;

        for (var i = 0; i < this.autoCardLayout.node.children.length; i++) {

            var nodes = this.autoCardLayout.node.children[i];

            nodes.children[0].active = false;
        }

        this.autoCardLayout.node.children[indexs].children[0].active = true;

        var resultArray = this._findCardIndex.arr[indexs];

        this._findCardIndex.indexs = indexs;

        for (var i = 0; i < resultArray.length; i++) {

            var cardModes = resultArray[i];

            cardModes.sort(KQCard.sort);

            var num = 0;
            if (i == 1) {
                num = 3;
            } else if (i == 2) {
                num = 8;
            }
            //cardModes.forEach(function(i){if (i.point == 14) i.point = 1;})
            cardModes.forEach((function (cardMode, index) {

                var cardName = cardMode.cardName();

                var numBer = num + index;

                var nodds1 = new cc.Node(); //创建一个节点对象

                nodds1.anchorY = 1;

                nodds1.addComponent(cc.Sprite); //添加精灵组件

                this.cardAllNode.children[numBer].addChild(nodds1);

                this.cardAllNode.children[numBer].children[0].cardName = cardName;

                this.cardAllNode.children[numBer].children[0]._cardModel = new KQCard(cardName, null, index);

                var btnSprites = this.cardAllNode.children[numBer].children[0].getComponent(cc.Sprite);

                this.cardAllNode.children[numBer].getComponent(cc.Sprite).spriteFrame = '';

                btnSprites.node.removeAllChildren();

                if (cc.maPai == cardName) {

                    var nodds = new cc.Node(); //创建一个节点对象

                    nodds.addComponent(cc.Sprite); //添加精灵组件

                    cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                        if (err) {
                            cc.error(err.message || err);return;
                        }

                        var btnSprite1 = nodds.getComponent(cc.Sprite);

                        btnSprite1.spriteFrame = spriteFrame;

                        btnSprite1.node.width = 107;

                        btnSprite1.node.height = 155;

                        btnSprite1.node.y = -65.5;
                    }).bind(this));

                    btnSprites.node.addChild(nodds);
                }

                var path = 'public-pic-card-poker-' + cardName;

                this._loadCardFrame(this.cardSpriteAtlas, path, btnSprites, 95, 130);
            }).bind(this));
        }

        this.clickAutoSelectedCards(null);

        //this._setCardDaoSprite();
    },

    clickAutoSelectedCards: function clickAutoSelectedCards(event) {
        var indexs = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];

        for (var i = 0; i < this.autoCardLayout.node.children.length; i++) {

            var nodes = this.autoCardLayout.node.children[i];

            nodes.children[0].active = false;
        }

        this.autoCardLayout.node.children[indexs].children[0].active = true;

        AudioManager.instance.playPokerClick();

        if (event) {
            var resultArray = event.target.cardArray;
        } else {
            var resultArray = this._findCardIndex.arr[indexs];
        }
        var touScore = KQCard.scoreOfCards(resultArray[0]);
        var zhongScore = KQCard.scoreOfCards(resultArray[1]);
        var weiScore = KQCard.scoreOfCards(resultArray[2]);
        //cc.log(touScore);
        //cc.log(zhongScore);
        //cc.log(weiScore);
        //console.log('----------1180')
        resultArray = resultArray.map((function (cardMode) {

            cardMode = KQCard._typeCardsSortByNumberOfPoints(cardMode);

            return cardMode.map((function (cardModes) {

                return cardModes.cardName();
            }).bind(this));
        }).bind(this));
        //console.log(resultArray)

        this.LayoutWithEvent.forEach(function (nodes) {

            nodes.color = new cc.Color(255, 255, 255);

            nodes.children.forEach(function (i) {
                i.color = new cc.Color(255, 255, 255);
            });
        });

        this.LayoutWithEvent = [];

        resultArray = resultArray[0].concat(resultArray[1]).concat(resultArray[2]);

        var cardAllNode = this.cardAllNode.children.map(function (i) {
            return i;
        });

        for (var i = 0; i < resultArray.length; i++) {

            var s = resultArray[i];

            for (var j = 0; j < cardAllNode.length; j++) {

                var d = cardAllNode[j];

                d.getComponent(cc.Button).interactable = false;

                if (d.children[0].cardName == s) {

                    d.stopAllActions();

                    var detail = this.changeNodeSpaceAR[i];

                    var call = cc.callFunc((function () {

                        this.cardAllNode.children.forEach(function (nodes) {
                            nodes.getComponent(cc.Button).interactable = true;
                        });

                        this._setCardDaoSprite();
                    }).bind(this), this);

                    d.runAction(cc.sequence(cc.moveTo(this.cardTime, detail), call));

                    cardAllNode.splice(j, 1);

                    break;
                }
            }
        }
    },

    _loadCardFrame: function _loadCardFrame(SpriteFrame, path, SpritesNode, w, h) {

        var Sprite = SpriteFrame.getSpriteFrame(path);

        SpritesNode.spriteFrame = Sprite;

        if (w) SpritesNode.node.width = w;

        if (h) SpritesNode.node.height = h;
    },

    stickOutFindCardType1: function stickOutFindCardType1(cards) {
        var index = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];
    },

    //// 将已有的突出的牌的位置重置回初始位置
    //this._resetCardsPositionY();
    //let selectedCardNames = cards.map(function(cardModel){
    //    return cardModel.cardName();
    //}.bind(this));
    //
    //let cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {
    //    let cardPrefab = cardNode.getComponent('CardPrefab');
    //    if(selectedCardNames.includes(cardPrefab.cardName())) {
    //        var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());
    //        selectedCardNames.splice(nameIndex,1);
    //        return true;
    //    }
    //    return false;
    //});
    //
    //cc.log('-------696')
    //this._changeCardPrefabsY(cardNodes);
    //if(index == 1){
    //    this._addDaoCardToLayout(this.layoutTouDao.node, 3);
    //}
    //else if(index == 2){
    //    this._addDaoCardToLayout(this.layoutZhongDao.node);
    //}
    //else if(index == 3){
    //    this._addDaoCardToLayout(this.layoutWeiDao.node);
    //}

    _touchCardLayout: function _touchCardLayout(event) {
        //event.bubbles = true;
        //let location = event.getLocation();
        //let cardPrefab = this._cardPrefabInCardLayoutWithLocation(location);
        //if (cardPrefab) {
        //    cardPrefab.getComponent('CardPrefab').setSelected(true);
        //    event.stopPropagation();
        //}
    },

    _touchCardLayoutEnd: function _touchCardLayoutEnd(event) {
        //this._changeSelectedCardPrefabsY();
        //this._diseclectCardPrefabs();
    },

    _cardPrefabInCardLayoutWithLocation: function _cardPrefabInCardLayoutWithLocation(location) {
        //location = this.cardsLayout.node.convertToNodeSpaceAR(location);
        //let cardNodes = this.cardsLayout.node.children.sort(function (cardNode1, cardNode2) {
        //    let rect1 = cardNode1.getBoundingBox();
        //    let rect2 = cardNode2.getBoundingBox();
        //    return rect2.x - rect1.x;
        //});
        //for (let index in cardNodes) {
        //    let cardNode = cardNodes[index];
        //
        //    let rect = cardNode.getBoundingBox();
        //
        //    if (cc.rectContainsPoint(rect, location)) {
        //        return cardNode;
        //    }
        //}
        //
        //return null;
    },

    _changeSelectedCardPrefabsY: function _changeSelectedCardPrefabsY() {
        //let cardNodes = this._selectedCardPrefabs();
        //this._changeCardPrefabsY(cardNodes);
        //
        //AudioManager.instance.playPokerClick();
    },

    _changeCardPrefabsY: function _changeCardPrefabsY(cardNodes) {
        //cardNodes.forEach(function (cardNode) {
        //    let y = cardNode.getPositionY();
        //    if (y == this._cardOffsetY) {
        //        cardNode.setPositionY(this._cardOffsetY + 55);
        //    } else {
        //        cardNode.setPositionY(this._cardOffsetY);
        //    }
        //}.bind(this));
    },

    _selectedCardPrefabs: function _selectedCardPrefabs() {
        var includeStickOut = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];
    },

    //let cardNodes = this.cardsLayout.node.children || [];
    //return cardNodes.filter(function (cardNode) {
    //    let cardPrefab = cardNode.getComponent('CardPrefab');
    //    let isSelected = cardPrefab.isSelected();
    //    if (!isSelected && includeStickOut) {
    //        isSelected = cardNode.getPositionY() > 10;
    //    }
    //
    //    return isSelected;
    //});
    _diseclectCardPrefabs: function _diseclectCardPrefabs() {
        //let cardNodes = this.cardsLayout.node.children;
        //cardNodes.forEach(function (node) {
        //    node.getComponent('CardPrefab').setSelected(false);
        //});
    },

    // 重置 cards 的 X
    _resetCardsPositionX: function _resetCardsPositionX() {
        //let interval = 98;
        //let interval = 78;
        //let cardNodes = this.cardsLayout.node.children || [];
        //let length = cardNodes.length;
        //if (length == 0) {
        //    return;
        //}
        //
        //let middleIndex = length / 2;
        //let cardWidth = 154;
        //
        //
        ////this.cardsLayoutSort();
        //if(this.cardsLayoutSortColor == true){
        //    this.cardsLayout.node.children.sort(function (n1, n2) {
        //        let component1 = n1.getComponent('CardPrefab');
        //        let component2 = n2.getComponent('CardPrefab');
        //        return component2.cardMode().color - component1.cardMode().color;
        //    });
        //}else{
        //    this.cardsLayout.node.children.sort(function (n1, n2) {
        //        let component1 = n1.getComponent('CardPrefab');
        //        let component2 = n2.getComponent('CardPrefab');
        //        return component1.cardMode().sort(component2.cardMode());
        //    });
        //}
        ////cardNodes.sort(function (n1, n2) {
        ////    let component1 = n1.getComponent('CardPrefab');
        ////    let component2 = n2.getComponent('CardPrefab');
        ////
        ////    return component1.cardMode().sort(component2.cardMode());
        ////});
        //
        //cardNodes.forEach(function (cardNode, index) {
        //    cardNode.zIndex = index;
        //    let x = (index - middleIndex) * interval + cardWidth / 3;
        //    cardNode.setPositionX(x);
        //});
    },

    // 重置 cards 的 X为0
    resetCardsPositionX1: function resetCardsPositionX1() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //let length = cardNodes.length;
        //if (length == 0) {
        //    return;
        //}
        //cardNodes.forEach(function (cardNode) {
        //    cardNode.setPositionY(0);
        //});
    },

    _resetCardsPositionY: function _resetCardsPositionY() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //cardNodes.forEach(function (cardNode) {
        //    cardNode.setPositionY(this._cardOffsetY);
        //}.bind(this));
    },

    // 头、中、尾道 layout 的点击事件
    _registerDaosLayoutClickEvent: function _registerDaosLayoutClickEvent() {

        this.changeNodeSpaceAR = []; //记录所有牌的坐标
        this.cardAllNode.children.forEach((function (nodes) {
            //获取节点的世界坐标
            var cardBackWorldSpace1 = nodes.convertToWorldSpaceAR(cc.v2(0, 0));
            //获取相对父节点所在的坐标
            var detail = nodes.parent.convertToNodeSpaceAR(cardBackWorldSpace1);

            this.changeNodeSpaceAR.push(detail);
        }).bind(this));
    },

    clickAllCard: function clickAllCard(event) {
        AudioManager.instance.playPokerClick();
        if (this.LayoutWithEvent.length <= 1) {
            this.LayoutWithEvent.push(event.target);
            event.target.color = new cc.Color(182, 182, 182);
            event.target.children.forEach(function (i) {
                i.color = new cc.Color(182, 182, 182);
            });
        }
        if (this.LayoutWithEvent.length == 2) {

            var arr = [];

            this.LayoutWithEvent.forEach((function (nodes) {
                //获取节点的世界坐标
                var cardBackWorldSpace1 = nodes.convertToWorldSpaceAR(cc.v2(0, 0));
                //获取相对父节点所在的坐标
                var detail = nodes.parent.convertToNodeSpaceAR(cardBackWorldSpace1);

                arr.unshift(detail);
            }).bind(this));

            this.LayoutWithEvent.forEach((function (nodes, index) {

                nodes.color = new cc.Color(255, 255, 255);

                nodes.children.forEach(function (i) {
                    i.color = new cc.Color(255, 255, 255);
                });

                nodes.getComponent(cc.Button).interactable = false;

                this.scheduleOnce((function () {

                    nodes.getComponent(cc.Button).interactable = true;

                    this._setCardDaoSprite();
                }).bind(this), this.cardTime);

                nodes.stopAllActions();

                var detail = arr[index];

                nodes.runAction(cc.moveTo(this.cardTime, detail));
            }).bind(this));

            this.LayoutWithEvent = [];
        }
    },

    _setCardDaoSprite: function _setCardDaoSprite() {
        var nodes = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];
        var cards = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];

        if (!nodes) {

            this.cardAlls = this.cardAllNode.children.sort(function (a, b) {
                return b.y - a.y;
            }).map(function (i) {
                return i.children[0];
            });

            cards = [this._taoDaoCardModes(), this._zhongDaoCardModes(), this._weiDaoCardModes()];

            cards.forEach(function (card) {
                card.forEach(function (i) {
                    if (i.scores == 14) {
                        i.scores = 1;
                    }
                });
            });

            nodes = [this.touDaoNode, this.zhongDaoNode, this.weiDaoNode];
        }

        //头道
        var typeName0 = KQCard.cardsType(cards[0]) + 1;

        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;

        typeName0 = typeName0 == '04' ? '11' : typeName0;

        var path = 'game_poker_type' + typeName0;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[0].getComponent(cc.Sprite));

        //中道
        var typeName1 = KQCard.cardsType(cards[1]) + 1;

        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;

        typeName1 = typeName1 == '07' ? '22' : typeName1;

        path = 'game_poker_type' + typeName1;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[1].getComponent(cc.Sprite));

        //尾道
        var typeName2 = KQCard.cardsType(cards[2]) + 1;

        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        path = 'game_poker_type' + typeName2;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[2].getComponent(cc.Sprite));

        this.cardAllNode.children.forEach(function (n) {
            n.getComponent(cc.Sprite).spriteFrame = "";
        });

        if (cards) {

            if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards, this.cardAllNode.children, this.cardSpriteAtlas);

            if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards, this.cardAllNode.children, this.cardSpriteAtlas);

            if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards, this.cardAllNode.children, this.cardSpriteAtlas);
        }
    },

    _clickTouDaoLayout: function _clickTouDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutTouDao.node, event);
    },

    _clickZhongDaoLayout: function _clickZhongDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutZhongDao.node, event);
    },

    _clickWeiDaoLayout: function _clickWeiDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutWeiDao.node, event);
    },

    _daoCardNodeInLayoutWithEvent: function _daoCardNodeInLayoutWithEvent(node, event) {
        var cardNodes = node.children || [];
        var location = event.getLocation();
        location = node.convertToNodeSpaceAR(location);
        //var cardBackWorldSpace = this.layoutZhongDao.node.convertToWorldSpaceAR(cc.v2(0, 0));
        ////获取节点的世界坐标
        //var detail = this.layoutZhongDao.node.parent.convertToNodeSpaceAR(cardBackWorldSpace);
        ////获取相对父节点所在的坐标
        //this.layoutWeiDao.node.runAction(cc.moveTo(1,detail));
        for (var index in cardNodes) {
            var cardNode = cardNodes[index];
            var rect = cardNode.getBoundingBox();
            if (cc.rectContainsPoint(rect, location)) {
                AudioManager.instance.playPokerClick();
                var arrs = [node, cardNode];
                if (this.LayoutWithEvent.length == 1) {
                    if (this.LayoutWithEvent[0][0].name != node.name) {
                        cardNode.opacity = 200;
                        this.LayoutWithEvent.push(arrs);
                    } else {
                        this.LayoutWithEvent[0][1].opacity = 255;
                        this.LayoutWithEvent = [];
                    }
                } else if (this.LayoutWithEvent.length == 0) {
                    //cc.log(cardNode)
                    this.LayoutWithEvent.push(arrs);
                    cardNode.opacity = 200;
                }
                if (this.LayoutWithEvent.length == 2) {
                    var node1 = this.LayoutWithEvent[0][1];
                    var node2 = this.LayoutWithEvent[1][1];
                    //获取节点的世界坐标
                    var cardBackWorldSpace = node1.convertToWorldSpaceAR(cc.v2(0, 0));
                    //获取相对父节点所在的坐标
                    var detail = node1.parent.convertToNodeSpaceAR(cardBackWorldSpace);
                    node2.runAction(cc.moveTo(1, detail));
                }

                return;
            }
        }

        //return null;
    },

    _addDaoCardToLayout: function _addDaoCardToLayout(node) {
        var maxNumberCard = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];
    },

    //let cardNodes = node.children || [];
    //if (cardNodes.length >= 5) {
    //    return;
    //}
    //let remainCount = maxNumberCard - cardNodes.length;
    //
    //var selectedCards = this._selectedCardPrefabs(true) || [];
    //
    //if (selectedCards.length == 0) {
    //    return;
    //}
    //if (selectedCards.length > remainCount) {
    //    selectedCards = selectedCards.slice(0, remainCount);
    //}
    //
    //let selectedCardNames = selectedCards.map(function (cardPrefab) {
    //    return cardPrefab.getComponent('CardPrefab').cardName();
    //});
    //
    //cardNodes.forEach(function (cardTypeNode) {
    //    selectedCardNames.push(cardTypeNode.getComponent('CardTypeSprite').cardName());
    //});
    //
    //let cardModes = selectedCardNames.map(function (cardName,index) {
    //    return new KQCard(cardName,null,index);
    //}).sort(function (c1, c2) {
    //    return KQCard.sort(c1, c2, false);
    //});

    //let touCardModes = (node == this.layoutTouDao.node) ? cardModes : this._taoDaoCardModes();
    //let zhongCardModes = (node == this.layoutZhongDao.node) ? cardModes : this._zhongDaoCardModes();
    //let weiCardModes = (node == this.layoutWeiDao.node) ? cardModes : this._weiDaoCardModes();
    //if (!this._isValidCardModes(touCardModes, zhongCardModes, weiCardModes)) {
    //    this.cacleAutoSelectedCards1();
    //    cc.log('相公牌：自动选择牌')
    //    return;
    //}
    //
    //node.removeAllChildren();
    //
    //cardModes.forEach(function (cardMode,index) {
    //    let cardName = cardMode.cardName();
    //    let cardTypeSprite = cc.instantiate(this.cardTypePrefab);
    //    cardTypeSprite.names = cardName+'+'+index;
    //    cardTypeSprite.getComponent('CardTypeSprite').setCard(cardName,index);
    //    node.addChild(cardTypeSprite);
    //}.bind(this));
    //
    //
    //selectedCards.forEach(function (node) {
    //    node.removeFromParent();
    //});
    //this._resetCardsPositionY();
    //this._resetCardsPositionX();
    //
    //this._autoActiveDeleteDaoButtons();
    //
    //this._reloadKQCardModesInner();
    //this._resetTypeButtonEnablesWithModels();
    // 删除 头、中或尾道中的某中牌
    _deleteDaoCard: function _deleteDaoCard(cardTypeNode) {
        var reloadTypeButtonEnables = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
    },

    //let cardName = cardTypeNode.getComponent('CardTypeSprite').cardName();
    //this.addCard(cardName, true);
    //
    //this._resetCardsPositionY();
    //
    //cardTypeNode.removeFromParent(true);
    //this._autoActiveDeleteDaoButtons();
    //
    //if (reloadTypeButtonEnables) {
    //    this._reloadKQCardModesInner();
    //    this._resetTypeButtonEnablesWithModels();
    //}
    // 删除 头道或中道或尾道上所有的 牌
    _deleteDaoCardsOfLayout: function _deleteDaoCardsOfLayout(daoLayout) {
        //let cardNodes = Array.from(daoLayout.children);
        //cardNodes.forEach(this._deleteDaoCard.bind(this));
        //
        //this._reloadKQCardModesInner();
        //this._resetTypeButtonEnablesWithModels();
    },

    // 判断能否使用选择中的牌
    // 即：头道要小于中道、中道要小于尾道
    _isValidCardModes: function _isValidCardModes(touCardModes, zhongCardModes, weiCardModes) {
        touCardModes = touCardModes || [];
        zhongCardModes = zhongCardModes || [];
        weiCardModes = weiCardModes || [];
        if (touCardModes.length < 3 || zhongCardModes.length < 5 || weiCardModes.length < 5) {
            return true;
        }

        var touScore = KQCard.scoreOfCards(touCardModes);
        var zhongScore = KQCard.scoreOfCards(zhongCardModes);
        var weiScore = KQCard.scoreOfCards(weiCardModes);
        return touScore < zhongScore && zhongScore <= weiScore;
    },

    // 头道上已有的牌
    _taoDaoCardModes: function _taoDaoCardModes() {
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(0, 3));
    },

    // 中道上已有的牌
    _zhongDaoCardModes: function _zhongDaoCardModes() {
        //return this._cardModesOfCardPrefabs(this.layoutZhongDao.node.children);
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(3, 8));
    },

    // 尾道上已有的牌
    _weiDaoCardModes: function _weiDaoCardModes() {
        //return this._cardModesOfCardPrefabs(this.layoutWeiDao.node.children);
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(8, 13));
    },

    _cardModesOfCardPrefabs: function _cardModesOfCardPrefabs(cardTypeNodes) {
        if (!cardTypeNodes) {
            return [];
        }

        var cardModes = cardTypeNodes.map(function (node) {
            //let component = node.getComponent('CardTypeSprite');
            //return component.cardMode();._cardModel
            return node._cardModel;
        });

        return cardModes || [];
    },

    // 自动设置 头、中、尾道的删除按钮的可见性
    _autoActiveDeleteDaoButtons: function _autoActiveDeleteDaoButtons() {
        //this._autoActiveDeleteDaoButton(this.layoutTouDao.node, this.btnDeleteTouDao.node);
        //this._autoActiveDeleteDaoButton(this.layoutZhongDao.node, this.btnDeleteZhongDao.node);
        //this._autoActiveDeleteDaoButton(this.layoutWeiDao.node, this.btnDeleteWeiDao.node);
    },

    _autoActiveDeleteDaoButton: function _autoActiveDeleteDaoButton(layout, button) {
        //button.active = layout.children.length > 0;
    },

    // 自动设置 “全部取消”、“确定出牌”、“类型选择”按钮的可见性
    _autoActiveTypeButtons: function _autoActiveTypeButtons() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //let hasCardUnSelected = cardNodes.length > 0;
        //this.btnDone.node.active = !hasCardUnSelected;
        //this.btnCancelAll.node.active = this.btnDone.node.active;
        //this.typeButtonsNode.active = hasCardUnSelected;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardScoretsHelper":"KQCardScoretsHelper","play":"play"}],"CardTypeSprite":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e614c0FMndAtrOMcy8/PcZw', 'CardTypeSprite');
// scripts\CardTypeSprite.js

var KQCard = require('KQCard');
cc.Class({
  'extends': cc.Component,

  properties: {
    _cardName: null,
    _cardModel: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setCard: function setCard(cardName, index) {
    var asdf = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    this._cardName = cardName;
    if (asdf) {
      this._cardModel = new KQCard(cardName, null, index);
    }
    this._loadCardFrame(cardName, (function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }).bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._cardModel;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"ChatMessage":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dc8980X2ZVNKrH9BsIsSE4D', 'ChatMessage');
// scripts\Chat\ChatMessage.js

// 用于在游戏过程中，展示用户的聊天消息

var ChatMessage = cc.Class({
    "extends": cc.Component,

    properties: {
        richText: cc.RichText,
        spriteBackground: cc.Sprite,
        emoji: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        ChatMessage.instances = this;
    },

    setString: function setString() {
        var string = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];
        var autoHide = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (string.length == 0) {
            return;
        }

        this.node.active = true;
        this.richText.node.active = true;
        this.spriteBackground.node.active = true;
        this.emoji.active = false;
        var maxWidth = 300;
        var realStr = ChatMessage.parseString(string);

        // 由于 cc.RichText 在指定 maxWidth 后，该结点的 width 会一直
        // 是 maxWidth 值。而在将 maxWidth 指定为0时，其 contentSize.width 会
        // 是内容的真正所需的宽度
        //
        // 所以这里先将 maxWidth 设为 0，获取其实际内容 width 后再调整
        this.richText.maxWidth = 0;
        this.richText.string = realStr;

        var contentWidth = this.richText.node.getContentSize().width;
        if (contentWidth > maxWidth) {
            this.richText.maxWidth = maxWidth;
            this.richText.string = realStr;
            contentWidth = maxWidth;
        }

        this.node.width = contentWidth + 28;
        this.node.height = this.richText.node.getContentSize().height + 20;

        this.spriteBackground.node.width = this.node.width;
        this.spriteBackground.node.height = this.node.height;

        if (autoHide) {
            this._hideNode();
            //this.unscheduleAllCallbacks();
            //this.scheduleOnce(this._hideNode.bind(this), 3);
        }
    },

    showEmoji: function showEmoji(sprite) {
        this._hideNode();
        this.node.active = true;
        this.emoji.active = true;
        this.richText.node.active = false;
        this.spriteBackground.node.active = false;
        var btnSprites = this.emoji.getComponent(cc.Sprite);
        btnSprites.spriteFrame = sprite;
    },

    _hideNode: function _hideNode() {
        this.unscheduleAllCallbacks();
        this.scheduleOnce((function () {
            this.node.active = false;
        }).bind(this), 3);
    }

});
ChatMessage.setEmoji = function (sprite) {
    this.instances._hideNode();
    this.instances.node.active = true;
    this.instances.emoji.active = true;
    this.instances.richText.node.active = false;
    this.instances.spriteBackground.node.active = false;
    var btnSprites = this.instances.emoji.getComponent(cc.Sprite);
    btnSprites.spriteFrame = sprite;
    //console.log(this.emoji);
    //return;
    //
    //this.emoji.Sprite = sprite;
},

// 将 <bq10> 改为： <img src='bg10'/>
ChatMessage.parseString = function (str) {
    var result = str.replace(/<bq\d{1,2}>/g, function (match) {
        var bq = match.replace("<", " <img src='").replace(">", "'/> ");
        return bq;
    });
    return result;
}, module.exports = ChatMessage;

cc._RFpop();
},{}],"ChatTextRecord":[function(require,module,exports){
"use strict";
cc._RFpush(module, '88d10U9tIpHNK1entoUH0Ju', 'ChatTextRecord');
// scripts\Pefabs\ChatTextRecord.js

cc.Class({
    'extends': cc.Component,

    properties: {},

    // use this for initialization
    onLoad: function onLoad() {},

    setString: function setString(str) {
        this._richText().string = str;
    },

    _richText: function _richText() {
        return this.node.getComponent('cc.RichText');
    },

    setEmoji: function setEmoji(spraite) {
        this._spriteFrame().Spraite = spraite;
    },
    _spriteFrame: function _spriteFrame() {
        return this.node.getComponent('cc.Sprite');
    }
});

cc._RFpop();
},{}],"CompareCards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9aa4aH/Ha1JfaEeY5nFj5P1', 'CompareCards');
// scripts\Pefabs\CompareCards.js

var KQCardResHelper = require('KQCardResHelper');
var AudioManager = require('AudioManager');
var KQCard = require('KQCard');

cc.Class({
    'extends': cc.Component,

    properties: {
        touLayout: cc.Layout,
        zhongLayout: cc.Layout,
        weiLayout: cc.Layout,

        touLayoutBack: cc.Layout,
        zhongLayoutBack: cc.Layout,
        weiLayoutBack: cc.Layout,
        baoDao: cc.Node, //报道图,
        playTotalScore: cc.Layout, //所有玩家的总分数

        daoScoreLayouts: [cc.Layout],
        daoTitleNodes: [cc.Node],
        TScoreLayout: cc.Layout,
        TtitleNode: cc.Node,

        pNum: 0, //玩家人数
        teShuTime: 0, //特殊牌出牌顺序
        teShuNum: 0, //特殊牌人数

        _lCScore: null,
        _daoLayouts: null, // 头、中、尾集合
        _daoLayoutBacks: null, // 头、中、尾集合
        _scores: null,
        _user: null, // 用于比牌的数据
        _cardsInfo: null,
        _compareIndex: 0 },

    // 将要比较的 索引  0~2
    // use this for initialization
    onLoad: function onLoad() {

        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        this._daoLayoutBacks = [this.touLayoutBack, this.zhongLayoutBack, this.weiLayoutBack];
        this.reset();

        if (this._scores) {
            this.setScores(this._scores);
        }
    },

    reset: function reset() {
        this._compareIndex = 0;

        this.node.children.forEach(function (node) {
            node.active = false;
        });

        this.baoDao.getComponent(cc.Sprite).spriteFrame = null;

        var nodes = this.touLayoutBack.node.children.concat(this.zhongLayoutBack.node.children).concat(this.weiLayoutBack.node.children);

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        nodes.forEach((function (nod) {

            nod.removeAllChildren();

            var cardSprite = nod.getComponent(cc.Sprite);

            KQCard._loadCardFrame(this.cardSpriteAtlas, "public-pic-card-poker-back", cardSprite);
        }).bind(this));

        this.daoScoreLayouts.forEach((function (nod) {
            nod.node.active = false;
        }).bind(this));

        this.daoTitleNodes.forEach((function (nod) {
            nod.active = false;
        }).bind(this));

        if (this.TScoreLayout) this.TScoreLayout.node.active = false;

        if (this.TtitleNode) this.TtitleNode.active = false;

        this.unscheduleAllCallbacks();

        //console.log('执行了一遍清除定时器--------------------------------')

        if (this.TScoreLayout) this.TScoreLayout.node.stopAllActions();

        if (this.playTotalScore) this.playTotalScore.node.stopAllActions();
    },

    setCompareData: function setCompareData(user) {
        this._user = user;
        this._cardsInfo = user.cardInfo;
        var cardsInfo = user.cardInfo;
        this._lCScore = user.lCScore;
        var cards = cardsInfo.map(function (cardInfoItem) {
            return KQCard.cardsFromArray(cardInfoItem.cards);
        }).reduce(function (array, subCards) {
            return array.concat(subCards);
        }, []);

        var scores = [user.score1 || 0, user.score2 || 0, user.score3 || 0, user.lScore1 || 0, user.lScore2 || 0, user.lScore3 || 0];
        this.setCards(cards);
        this.setScores(scores);
    },

    //显示所有玩家的总分数
    showScoreResult: function showScoreResult() {
        if (!this._user) return;
        var scores = this._user.cScore;
        this.setScores([scores], [this.playTotalScore], true);
        this.playTotalScore.node.active = true;
        this.playTotalScore.node.opacity = 255;
        var x = this.playTotalScore.node.x;
        var y = this.playTotalScore.node.y;
        this.playTotalScore.node.runAction(cc.moveTo(0.8, cc.p(x, y + 30)));
        this.scheduleOnce((function () {
            this.playTotalScore.node.runAction(cc.fadeOut(0.2));
        }).bind(this), 0.6);
        this.scheduleOnce((function () {
            this.playTotalScore.node.y = y;
        }).bind(this), 1);
    },

    //显示三道分数
    showNextCompareScore: function showNextCompareScore(isContainExtra) {
        if (isContainExtra && this.TScoreLayout) {
            var scores1 = this._lCScore.splice(0, 1);
            if (scores1.length <= 0) return;
            this.setScores(scores1, [this.TScoreLayout], true);
            this.TtitleNode.active = true;
            this.TScoreLayout.node.active = true;

            var scaleTo11 = cc.scaleTo(0.3, 1.8);
            var scaleTo21 = cc.scaleTo(0.1, 1.1);
            var scaleTo31 = cc.scaleTo(0.1, 1.3);
            var scaleToSeq1 = cc.sequence(scaleTo11, scaleTo21, scaleTo31);
            this.TScoreLayout.node.runAction(scaleToSeq1);
        }

        if (this.daoScoreLayouts.length <= 0) return;
        if (!this._user.isContainExtra) {
            var index = this._compareIndex == 0 ? 1 : this._compareIndex;
            this.daoScoreLayouts[index - 1].node.active = true;
            this.daoScoreLayouts[index + 2].node.active = true;
            this.daoTitleNodes[index - 1].active = true;
        }

        var scores = this._lCScore.splice(0, 1);
        if (scores.length <= 0 && !this.TScoreLayout) return;
        this.setScores(scores, [this.TScoreLayout], true);
        this.TtitleNode.active = true;
        this.TScoreLayout.node.active = true;

        var scaleTo1 = cc.scaleTo(0.3, 1.8);
        var scaleTo2 = cc.scaleTo(0.1, 1.1);
        var scaleTo3 = cc.scaleTo(0.1, 1.3);
        var scaleToSeq = cc.sequence(scaleTo1, scaleTo2, scaleTo3);
        this.TScoreLayout.node.runAction(scaleToSeq);
    },

    // 下一个要比较的分数
    // 如果没有要比较的了，则返回 0
    nextCompareScore: function nextCompareScore() {
        if (!this._user) return 0;

        var data;
        if (this._user.isContainExtra) {
            data = this._cardsInfo[0];
            if (data) return data.type * 9000000000000000;
        } else {
            data = this._cardsInfo[this._compareIndex];
        }
        if (!data) return 0;
        return data.value;
    },

    setMaPai: function setMaPai(nodes, cardName) {
        if (cc.maPai == cardName) {

            var nodds = new cc.Node(); //创建一个节点对象

            nodds.addComponent(cc.Sprite); //添加精灵组件

            cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                if (err) {
                    cc.error(err.message || err);return;
                }

                var btnSprite1 = nodds.getComponent(cc.Sprite);

                btnSprite1.sizeMode = 0;

                btnSprite1.spriteFrame = spriteFrame;

                btnSprite1.node.width = nodes.width + 10;

                btnSprite1.node.height = nodes.height + 10;
            }).bind(this));

            nodes.addChild(nodds);
        }
    },

    setCards: function setCards(cards) {

        var cardSprites = this._allCardSprites();

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        cards.forEach((function (kqCard, index) {
            if (index >= cardSprites.length) {
                return;
            }
            cardSprites[index].node.removeAllChildren();

            cardSprites[index].node.getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.cardName = kqCard.cardName();

            nodds1.width = cardSprites[index].node.width;

            nodds1.height = cardSprites[index].node.height;

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var path = "public-pic-card-poker-" + kqCard.cardName();

            KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            this.setMaPai(cardSprite.node, kqCard.cardName());

            cardSprites[index].node.addChild(nodds1);
        }).bind(this));

        var cards0 = cards.slice(0, 3);
        var cards1 = cards.slice(3, 8);
        var cards2 = cards.slice(8, 13);

        var cards11 = [cards0, cards1, cards2];
        //头道
        var typeName0 = KQCard.cardsType(cards0) + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        typeName0 = typeName0 == '04' ? '11' : typeName0;

        //中道
        var typeName1 = KQCard.cardsType(cards1) + 1;
        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;
        typeName1 = typeName1 == '07' ? '22' : typeName1;

        //尾道
        var typeName2 = KQCard.cardsType(cards2) + 1;
        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        cardSprites = cardSprites.map(function (i) {
            return i.node;
        });

        if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards11, cardSprites, this.cardSpriteAtlas);
        if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards11, cardSprites, this.cardSpriteAtlas);
        if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards11, cardSprites, this.cardSpriteAtlas);
    },

    setScores: function setScores(scores) {
        var Layouts = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];
        var is_WH = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

        if (!Layouts) {
            Layouts = this.daoScoreLayouts;
            if (Layouts.length <= 0) return;
        }

        scores.forEach((function (string, index) {

            var labels = Layouts[index];

            labels.node.removeAllChildren();

            var path = "play/CardTypeCombine/" + (Number(string) >= 0 ? "addNum" : "delNum");

            this._creatorNodes(labels.node, 10, path, '', is_WH);

            var strings = string > 0 ? string + "" : string * -1 + "";

            var stringAyy = strings.split("");

            for (var i = 0; i < stringAyy.length; i++) {

                var s = stringAyy[i];

                this._creatorNodes(labels.node, Number(s), path, '', is_WH);
            }

            labels.type = 1;
        }).bind(this));
    },

    _creatorNodes: function _creatorNodes(nodes, name, path, paths) {
        var w_h = arguments.length <= 4 || arguments[4] === undefined ? false : arguments[4];

        var node = new cc.Node(); //创建一个节点对象

        node.addComponent(cc.Sprite); //添加精灵组件

        var btnSprite = node.getComponent(cc.Sprite);

        btnSprite.sizeMode = 0;

        btnSprite.node.width = 18;btnSprite.node.height = 23;
        //name = name + "";
        this._loadCardFrame(name, (function (spriteFrame) {

            btnSprite.spriteFrame = spriteFrame;

            if (w_h) {
                btnSprite.node.width = 30;btnSprite.node.height = 40;
            }
        }).bind(this), path, paths);

        nodes.addChild(node);
    },

    _setCardSpriteFrame: function _setCardSpriteFrame(indexs, nodes) {
        var cardsInfo = this._cardsInfo;
        var cards = cardsInfo.map(function (cardInfoItem) {
            return KQCard.cardsFromArray(cardInfoItem.cards);
        })[indexs] || [];

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        // cc.log(this._cardsInfo)
        // cc.log(cards)
        // cc.log('------555')

        cards.forEach((function (kqCard, index) {

            nodes.children[index].removeAllChildren();

            nodes.children[index].getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.cardName = kqCard.cardName();

            nodds1.width = nodes.children[index].width;

            if (nodes.parent.parent.name == "playSelf") {

                nodes.children[index].height = 130;

                nodds1.height = 130;
            } else {

                nodes.children[index].height = 115;

                nodds1.height = 115;

                //console.log(nodes);
                //console.log(nodds1);
            }

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var path = "public-pic-card-poker-" + kqCard.cardName();

            cardSprite.node.removeAllChildren();

            KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            this.setMaPai(cardSprite.node, kqCard.cardName());

            nodes.children[index].addChild(nodds1);
        }).bind(this));

        var typeName = KQCard.cardsType(cards) + 1;

        typeName = typeName >= 10 ? typeName + "" : "0" + typeName;

        //头道
        if (indexs == 0) {
            typeName = typeName == '04' ? '11' : typeName;
        } else if (indexs == 1) {
            typeName = typeName == '07' ? '22' : typeName;
        }

        var cardSprites = nodes.children.map(function (i) {
            return i;
        });

        KQCard._setGuiCards(typeName, cards, cardSprites, this.cardSpriteAtlas);
    },

    showTouCards: function showTouCards() {
        if (this._user.isContainExtra == true) return;
        //console.log('开始执行一次定时动作--------------------------------')

        this.touLayoutBack.node.active = false;
        this._setCardSpriteFrame(0, this.touLayoutBack.node);
        this.scheduleOnce((function () {
            this.touLayout.node.active = false;
            this.touLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.touLayout.node.active = true;
        this.touLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.touLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        var types = this._cardsInfo[this._compareIndex].type == 3 ? 333 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showZhongCards: function showZhongCards() {
        if (this._user.isContainExtra == true) return;

        this.zhongLayoutBack.node.active = false;
        this._setCardSpriteFrame(1, this.zhongLayoutBack.node);
        this.scheduleOnce((function () {
            this.zhongLayout.node.active = false;
            this.zhongLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.zhongLayout.node.active = true;
        this.zhongLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.zhongLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        var types = this._cardsInfo[this._compareIndex].type == 6 ? 555 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showWeiCards: function showWeiCards() {
        //console.log('执行了一次尾道动画---------------')
        if (this._user.isContainExtra == true) return;
        //this._setCardSpriteFrame(1,this.zhongLayoutBack.node);
        this.weiLayoutBack.node.active = false;
        this._setCardSpriteFrame(2, this.weiLayoutBack.node);
        this.scheduleOnce((function () {
            this.weiLayout.node.active = false;
            this.weiLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.weiLayout.node.active = true;
        this.weiLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.weiLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[this._compareIndex].type);
        this._compareIndex += 1;
    },

    showTeShuCards: function showTeShuCards(cards) {
        //let typeName = KQCard.cardsTypeName(cardsNames);
        this._daoLayoutBacks = [this.touLayoutBack, this.zhongLayoutBack, this.weiLayoutBack];

        var touCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[0]);
        var zhongCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[1]);
        var weiCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[2]);
        var cardSprites = touCardSprites.concat(zhongCardSprites).concat(weiCardSprites);
        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;
        this.scheduleOnce((function () {
            cards.forEach((function (kqCard, index) {
                if (index >= cardSprites.length) return;

                var cardSprite = cardSprites[index];

                var path = "public-pic-card-poker-" + kqCard.cardName();

                cardSprite.node.removeAllChildren();

                KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

                this.setMaPai(cardSprite.node, kqCard.cardName());
            }).bind(this));
            this._daoLayoutBacks.forEach((function (nodes) {
                nodes.node.active = true;
            }).bind(this));
            AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[0].type);
        }).bind(this), 0.1);
    },

    showNextCards: function showNextCards() {
        var cardTypeCombine = this.node.parent.parent.getChildByName('CardTypeCombine').getComponent('CardTypeCombine');
        cardTypeCombine.reset();
        cardTypeCombine.node.active = false;

        this.touLayoutBack.node.parent.active = true;
        if (this._user.isContainExtra) {
            var cards = this._cardsInfo[0].cards.map(function (cardInfoItem) {
                return KQCard.cardsFromArray(cardInfoItem);
            }).reduce(function (array, subCards) {
                return array.concat(subCards);
            }, []);
            this.showTeShuCards(cards);
            this.showBaoDao(0, 0);
            this.baoDao.active = true;
            return;
        }
        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        this._daoLayouts.forEach(function (nodes) {
            nodes.node.active = false;
        });
        if (this._compareIndex == 0) {
            this.showBaoDao(0, 140);
            this.showTouCards();
        } else if (this._compareIndex == 1) {
            this.showBaoDao(1, 85);
            this.showZhongCards();
        } else if (this._compareIndex == 2) {
            this.showBaoDao(2, 34);
            this.showWeiCards();
        }

        this.baoDao.active = true;
        this.scheduleOnce((function () {
            this.baoDao.active = false;
        }).bind(this), 0.7);
    },

    showAllCards: function showAllCards() {
        if (!this._user) return;

        if (this._user.isContainExtra) {

            var cards = this._cardsInfo[0].cards.map(function (cardInfoItem) {
                return KQCard.cardsFromArray(cardInfoItem);
            }).reduce(function (array, subCards) {
                return array.concat(subCards);
            }, []);

            this.showTeShuCards(cards);

            //return;
        }

        if (!this._daoLayoutBacks) return;

        this.touLayoutBack.node.parent.active = true;

        this._daoLayoutBacks.forEach((function (nodes, index) {

            nodes.node.active = true;

            nodes.node.children.forEach(function (no) {
                no.active = true;
            });

            this._setCardSpriteFrame(index, nodes.node);

            if (this.TScoreLayout) this.daoTitleNodes[index].active = true;
        }).bind(this));

        if (!this.TScoreLayout) return;

        this.daoScoreLayouts.forEach((function (nodes) {

            nodes.node.active = true;
        }).bind(this));

        this.setScores([this._user.cScore], [this.TScoreLayout], true);

        this.TtitleNode.active = true;

        this.TScoreLayout.node.active = true;
    },

    showBaoDao: function showBaoDao(index, positonY) {
        var cardsInfo = this._cardsInfo;
        var cardType = cardsInfo.map(function (cardInfoItem) {
            return cardInfoItem.type;
        });

        var typeName0 = cardType[index] + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        if (index == 0) typeName0 = typeName0 == '04' ? '11' : typeName0;
        if (index == 1) typeName0 = typeName0 == '07' ? '22' : typeName0;

        if (cardType[index] == 10) typeName0 = '15'; //特殊牌
        if (cardType[index] == 11) typeName0 = '14';
        if (cardType[index] == 12) typeName0 = '16';
        if (cardType[index] == 18) typeName0 = '25';
        if (cardType[index] == 19) typeName0 = '26';

        var path = this._user.isContainExtra ? "game-right_specia" : "game-poker_type";

        this._loadCardFrame(typeName0, (function (spriteFrame) {
            var btnSprites1 = this.baoDao.getComponent(cc.Sprite);
            btnSprites1.spriteFrame = spriteFrame;
        }).bind(this), "play/CardTypeCombine/game_txt", path);
        this.baoDao.y = positonY;
    },

    _loadCardFrame: function _loadCardFrame(cardName, callback) {
        var path = arguments.length <= 2 || arguments[2] === undefined ? "play/CardTypeCombine/pockList" : arguments[2];
        var paths = arguments.length <= 3 || arguments[3] === undefined ? "public-pic-card-poker-" : arguments[3];

        cc.loader.loadRes(path, cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                cc.error(err);
                return;
            }
            cardName = cardName + "";
            cardName = this._cardFullName(cardName, paths);
            var frame = atlas.getSpriteFrame(cardName);
            callback(frame);
        }).bind(this));
    },

    _cardFullName: function _cardFullName(cardShortName, paths) {
        if (!paths) return cardShortName;
        var cardName = cardShortName;
        if (!cardName.startsWith(paths)) {
            cardName = paths + cardName;
        }
        return cardName;
    },

    _clearCards: function _clearCards() {
        this._clearLayoutCards(this.touLayout);
        this._clearLayoutCards(this.zhongLayout);
        this._clearLayoutCards(this.weiLayout);
    },

    _clearLayoutCards: function _clearLayoutCards(layout) {
        this._cardSpritesWithLayout(layout).forEach(function (sprite) {
            sprite.spriteFrame = null;
        });
    },

    _cardSpritesWithLayout: function _cardSpritesWithLayout(layout) {
        var node = layout.node;
        return node.children.map(function (node) {
            return node.getComponent('cc.Sprite');
        });
    },

    _allCardSprites: function _allCardSprites() {
        var touCardSprites = this._cardSpritesWithLayout(this.touLayout);
        var zhongCardSprites = this._cardSpritesWithLayout(this.zhongLayout);
        var weiCardSprites = this._cardSpritesWithLayout(this.weiLayout);
        var result = touCardSprites.concat(zhongCardSprites).concat(weiCardSprites);
        return result;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardResHelper":"KQCardResHelper"}],"Countdown":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6406dyBk8tKVrlJ1+mg7cLt', 'Countdown');
// scripts\Pefabs\Countdown.js

cc.Class({
    "extends": cc.Component,

    properties: {
        labelTime: cc.Label,
        //timeNode: cc.Node,

        _callback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.labelTime.string = "0";
    },

    /**
     * 开始倒计时
     * 
     * @param  {Number} time 时长
     * @param  {Function} callback 倒计时的回调
     */
    startCountdown: function startCountdown(time, callback) {
        this.stop();
        this._callback = callback;

        this.node.active = true;
        this.labelTime.string = "" + time;
        this.schedule(this._countDown, 1, time);
        this.getComponent("time").setTime(time * 0.5);
    },

    stop: function stop() {
        this.unschedule(this._countDown);
        this.node.active = false;

        if (this._callback) {
            var isTimeout = Number(this.labelTime.string) <= 0;
            var callback = this._callback;
            this._callback = null;
            callback(isTimeout);
        }

        this._callback = null;
    },

    _countDown: function _countDown() {
        var time = Number(this.labelTime.string || "0");
        time = time - 1;

        if (time <= 0) {
            this.stop();
        }

        this.labelTime.string = String(time);
    }

});

cc._RFpop();
},{}],1:[function(require,module,exports){
'use strict'

exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function placeHoldersCount (b64) {
  var len = b64.length
  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // the number of equal signs (place holders)
  // if there are two placeholders, than the two characters before it
  // represent one byte
  // if there is only one, then the three characters before it represent 2 bytes
  // this is just a cheap hack to not do indexOf twice
  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0
}

function byteLength (b64) {
  // base64 is 4/3 + up to two characters of the original data
  return b64.length * 3 / 4 - placeHoldersCount(b64)
}

function toByteArray (b64) {
  var i, j, l, tmp, placeHolders, arr
  var len = b64.length
  placeHolders = placeHoldersCount(b64)

  arr = new Arr(len * 3 / 4 - placeHolders)

  // if there are placeholders, only get up to the last complete 4 chars
  l = placeHolders > 0 ? len - 4 : len

  var L = 0

  for (i = 0, j = 0; i < l; i += 4, j += 3) {
    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]
    arr[L++] = (tmp >> 16) & 0xFF
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  if (placeHolders === 2) {
    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[L++] = tmp & 0xFF
  } else if (placeHolders === 1) {
    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var output = ''
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    output += lookup[tmp >> 2]
    output += lookup[(tmp << 4) & 0x3F]
    output += '=='
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])
    output += lookup[tmp >> 10]
    output += lookup[(tmp >> 4) & 0x3F]
    output += lookup[(tmp << 2) & 0x3F]
    output += '='
  }

  parts.push(output)

  return parts.join('')
}

},{}],2:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

'use strict'

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('isarray')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":1,"ieee754":3,"isarray":4}],3:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],4:[function(require,module,exports){
var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};

},{}],"GameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6a3cdd+2shGlZ+jeI3trSsB', 'GameResult');
// scripts\Play\GameResult.js

var KQCard = require('KQCard');
var AudioManager = require('AudioManager');

var ResultStatus = {
  WIN: 2,
  DRAW: 1,
  LOSE: 0
};

var GameResult = cc.Class({
  'extends': cc.Component,

  properties: {
    winNode: cc.Node,
    loseNode: cc.Node,
    drawNode: cc.Node,
    contentNode: cc.Node,

    resultItems: [cc.Node],

    _deskInfo: null,
    _userId: null,
    _closeCallback: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._hideResultItems();
  },

  showResults: function showResults(deskInfo, currentUserId) {
    this._deskInfo = deskInfo;
    this._userId = currentUserId;

    var resultStatus = this._resultStatus();
    this.contentNode.active = true;
    this.winNode.active = resultStatus == ResultStatus.WIN;
    this.drawNode.active = resultStatus == ResultStatus.DRAW;
    this.loseNode.active = resultStatus == ResultStatus.LOSE;

    if (this.winNode.active) {
      AudioManager.instance.playWin();
    } else if (this.loseNode.active) {
      AudioManager.instance.playLose();
    }

    this.node.getComponent('alert').alert();
    this.node.getComponent('alert').setDismissCallback((function () {
      this._closeCallback;
    }).bind(this));

    var playerInfos = deskInfo.players.sort(function (p1, p2) {
      return p2.cScore - p1.cScore;
    });
    var itemComps = this.resultItems.map(function (node) {
      return node.getComponent('ResultItem');
    });
    itemComps.forEach((function (itemComp, index) {
      itemComp.node.active = index < playerInfos.length;
      if (!itemComp.node.active) {
        return;
      }

      var user = playerInfos[index];
      itemComp.updateWithPlayerInfo(user, deskInfo.isRandomDesk);
      var cards = this._cardsFromUser(user);
      itemComp.setCards(cards);
    }).bind(this));
  },

  setCloseCallback: function setCloseCallback(callback) {
    this._closeCallback = callback;
  },

  _cardsFromUser: function _cardsFromUser(user) {
    var cards = user.cardInfo.map(function (cardInfoItem) {
      return KQCard.cardsFromArray(cardInfoItem.cards);
    }).reduce(function (array, subCards) {
      return array.concat(subCards);
    }, []);

    return cards;
  },

  _hideResultItems: function _hideResultItems() {
    this.resultItems.forEach(function (node) {
      node.acitve = false;
    });
  },

  _resultStatus: function _resultStatus() {
    var playerInfos = this._deskInfo.players;
    var user = playerInfos.find((function (user) {
      return user.id == this._userId;
    }).bind(this));

    var score = user.cScore;
    if (this._deskInfo.isRandomDesk) {
      // 如果是随机场的话，应该用钻石来判断输赢
      score = user.diamond;
    }

    if (score > 0) {
      return ResultStatus.WIN;
    } else if (score < 0) {
      return ResultStatus.LOSE;
    }

    return ResultStatus.DRAW;
  }
});

module.exports = GameResult;

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard"}],"GetCardPointsSameCount":[function(require,module,exports){
"use strict";
cc._RFpush(module, '64665arSbVGtqTVZeISv/TD', 'GetCardPointsSameCount');
// scripts\KQCard\GetCardPointsSameCount.js

/*#####*/
//��������һ���������ڵ���ͬ�������Ƶ�����
var GetCardPointsSameCount = function GetCardPointsSameCount(cards) {
    this.cardNumbers = {};
    for (var i in cards) {
        var s;
        if (typeof cards[i].number == 'undefined') {
            s = cards[i].point;
        } else {
            s = cards[i].number;
        }
        if (this.cardNumbers[s]) {
            this.cardNumbers[s]++;
        } else {
            this.cardNumbers[s] = 1;
        }
        //cc.log(this.cardNumbers[cards[i].number])
        //cc.log(cards)
        //cc.log(cards[i].number)
        //cc.log('---7')
    }
    return this.cardNumbers;
};

module.exports = GetCardPointsSameCount;

cc._RFpop();
},{}],"Invit":[function(require,module,exports){
"use strict";
cc._RFpush(module, '37d962bf0NPxaQIYUcZDwR3', 'Invit');
// scripts\Invit.js

var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }
    var isComplete = this._lastEmptyLabel() == null;
    var inviteNumber = this._roomNumber();
    if (inviteNumber.length == 6) {
      this.callbackJoinRoom = inviteNumber;
    }
  },

  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackJoinRoom;
    console.log(inviteNumber, "------------------------");
    if (inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackJoinRoom = ''; //清空邀请码
    }
  },

  clickClear: function clickClear() {
    this.callbackJoinRoom = '';
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"Item":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3d8f2XXRzFKYJSOKlDw8QSM', 'Item');
// scripts\Item.js

var Socket = require('socket');

cc.Class({
    "extends": cc.Component,

    properties: {
        roomidStr: {
            "default": null,
            type: cc.Label
        },
        gametypeStr: {
            "default": null,
            type: cc.Label
        },
        playernumStr: {
            "default": null,
            type: cc.Label
        },
        btn_yaoqing: {
            "default": null,
            type: cc.Button
        },
        btn_jinru: {
            "default": null,
            type: cc.Button
        },
        itemID: 0
    },

    onLoad: function onLoad() {
        //this.node.on('touchend', function () {
        //    console.log("Item " + this.itemID + ' clicked');
        //}, this);
        //
        //this._registerSocketEvent();

    },

    updateItem: function updateItem(eachList) {
        console.log("各个代开房的数据：" + JSON.stringify(eachList));
        this.itemID = eachList.id;
        //this.gametypeStr.string =  eachList.gameType;
        this.gametypeStr.string = "十三水";
        this.roomidStr.string = eachList.roomId;
        //this.playernumStr.string =  eachList.createUserId;
        this.playernumStr.string = 0;
    },

    jinruRoom: function jinruRoom() {
        var userId = Socket.instance.userInfo.id;

        var inviteNumber = parseInt(this.roomidStr.string);
        console.log(inviteNumber, "------------------------");
        console.log(userId, "------------------------");
        if (inviteNumber) {
            /*加入房间请求*/
            //var userId = Socket.instance.userInfo.id;
            Socket.sendJoinDesk(inviteNumber, parseInt(this.playernumStr.string));
        }
    }
});

cc._RFpop();
},{"socket":"socket"}],"KQCardColorsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf1deKQQ4NMMYVV+7xEr9Jf', 'KQCardColorsHelper');
// scripts\KQCard\KQCardColorsHelper.js

// 牌花色帮助类
// 用于计算一个牌数组的花色相同的牌的张数
var KQCardColorsHelper = function KQCardColorsHelper(cards) {
  this.colorNumber = {};

  cards.forEach((function (card) {
    var color = card.color;
    var number = this.colorNumber[color] || 0;
    this.colorNumber[color] = number + 1;
  }).bind(this));
};

// 相同花色的牌的最大数量
KQCardColorsHelper.prototype.maxNumber = function () {
  var result = 0;
  for (var prop in this.colorNumber) {
    var number = this.colorNumber[prop];
    result = Math.max(number, result);
  }

  return result;
};

module.exports = KQCardColorsHelper;

cc._RFpop();
},{}],"KQCardFindTypeExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '54a95JOLVRACIP91XEFodqF', 'KQCardFindTypeExtension');
// scripts\KQCard\KQCardFindTypeExtension.js

var KQCard = require('KQCard');
var ArrayExtension = require('ArrayExtension');
var KQCardPointsHelper = require('KQCardPointsHelper');

module.exports = {};

// 寻找 cardModes 中的 对子
// 这会返回 对子 的索引数组
// 如：[[1, 3], [4, 5]]
KQCard.findDuiZi = function (cardModes) {
  var sDuiZiIndexs = KQCard.findSanTiao(cardModes) || [];
  var result = KQCard._findPointLength(cardModes, 2) || [];
  if (result.length < 2) {
    if (sDuiZiIndexs.length > 0) {
      sDuiZiIndexs.forEach(function (indexs) {
        var s1 = [indexs[0], indexs[1]];
        //var s2 = [indexs[1],indexs[2]];
        //result.push(s2);
        result.push(s1);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 2);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }

  result = KQCard.repeat(result);

  return result.length > 0 ? result : [];
};

KQCard._findPointLength = function (cardModes, length) {
  if (cardModes.length < length) {
    return [];
  }

  var obj = cardModes.reduce(function (obj, card, index) {
    var pointIndexs = obj[card.point] || [];
    obj[card.point] = pointIndexs;
    pointIndexs.push(index);
    return obj;
  }, {});

  var result = [];
  for (var prop in obj) {
    var pointIndexs = obj[prop];
    // if (pointIndexs.length == length) {
    //   pointIndexs.sort(function (n1, n2) {
    //     return n1 - n2;
    //   });
    //   result.push(pointIndexs);
    // }
    while (pointIndexs.length >= length && length != 0) {
      //有多的分割多个数组
      var splices = pointIndexs.splice(0, length);
      if (splices.length >= length) {
        splices.sort(function (n1, n2) {
          return n1 - n2;
        });
        result.push(splices);
      }
    }
  }

  result.sort(function (arr1, arr2) {
    var n1 = arr1[0];
    var n2 = arr2[0];
    return n2 - n1;
  });
  return result.length > 0 ? result : [];
};

// 找 两对 的索引数组
// 如：[[1, 2, 3, 4], [5, 6, 7, 8]]
KQCard.findLiaDui = function (cardModes) {
  var duiZiIndexs = KQCard.findDuiZi(cardModes) || [];
  var duiZiIndex = KQCard.findGuiPai(cardModes, 2) || [];

  if (duiZiIndexs.length < 1 && duiZiIndex.length > 0) {
    duiZiIndex.forEach(function (indexs) {
      duiZiIndexs.unshift(indexs);
    });
  }
  if (duiZiIndexs.length < 2) {
    return [];
  }

  var result = [];
  for (var i = 0; i < duiZiIndexs.length; ++i) {
    for (var j = i + 1; j < duiZiIndexs.length; ++j) {
      if (result.length < 10) {
        var pre = duiZiIndexs[i];
        var next = duiZiIndexs[j];
        var s = pre.concat(next);
        var newS = [];
        for (var q = 0; q < s.length; q++) {
          if (newS.indexOf(s[q]) == -1) {
            newS.push(s[q]);
          } else {
            break;
          }
        }
        if (newS.length == 4) {
          newS.sort(function (n1, n2) {
            return n1 - n2;
          });
          result.unshift(newS);
        }
      } else {
        break;
      }
    }
  }
  result = KQCard.repeat(result);
  if (result.length > 6) {
    result = result.slice(0, 6);
  }
  return result;
};

// 找三条
// 如：[[1, 2, 3]];
KQCard.findSanTiao = function (cardModes) {
  if (cardModes.length < 3) {
    return [];
  }
  var result = KQCard._findPointLength(cardModes, 3) || [];
  //for(var q =0;q<result.length;q++){
  //  var indexs = result[q][0];
  //  if(cardModes[indexs].point >= 20){
  //    result.splice(q,1);
  //  }
  //}
  if (result.length < 2) {
    var tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray.length > 0) {
      tieZhiIndexsArray.forEach(function (indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        var sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 3);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }
  /*if(result.length < 1){
    // 铁支是包含三条的
    let tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray) {
      tieZhiIndexsArray.forEach(function(indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        let sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
  }*/

  //if(result.length > 10){
  //  result = result.slice(0,10);
  //}

  result = KQCard.repeat(result);
  return result.length > 0 ? result : [];
};

// 找同花顺
/*KQCard.findTongHuaShun = function (cardModes, length = 5) {
  if (cardModes.length < length) {
    return [];
  }
  let result = [];
  var sanShunZi = KQCard.sanShunZi1(cardModes,length);
  if(sanShunZi[0] == null){
    return false;
  }
  for(var i=0;i<sanShunZi[0].length;i++) {
    var s = sanShunZi[0][i];
    if (KQCard.isTongHuaShun(s, length)) {
      result.unshift(sanShunZi[1][i]);

    }
  }
  if(result.length > 0){
    return result
  }else{
    return KQCard.findTongHuaShun1(cardModes);
  }
};*/
KQCard.findTongHuaShun = function (cards) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cards.length < length) {
    return [];
  }
  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= 5) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var start = 0; start + 5 <= s.length; ++start) {
      var subCards = s.slice(start, start + 5);
      if (KQCard.isTongHuaShun(subCards)) {
        (function () {
          var indexs = [];
          subCards.forEach(function (ca) {
            for (var q = 0; q < cards.length; q++) {
              var r = cards[q];
              if (r === ca) {
                indexs.push(q);
                break;
              }
            }
          });
          indexs.sort(Array.sortByPoint);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
      cards.forEach(function (adfs) {
        if (adfs.point == 14) {
          adfs.point = 1;
          adfs.scores = 1;
        }
      });
      return KQCard.findTongHuaShun20(cards);
    }
    return KQCard.findTongHuaShun(convertedCards);
  }
  //return result.length > 0 ? result : null;
};
KQCard.findTongHuaShun20 = function (card) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (card.length < length) {
    return false;
  }
  var card20 = KQCard.contain20(card) || [];
  if (card20.length <= 0) {
    return false;
  }
  var cards = card.kq_excludes(card20);

  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= parseInt(5 - card20.length)) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  //cc.log(colorSum)

  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var j = 1; j <= card20.length; ++j) {
      var num = 5 - j;
      for (var start = 0; start + num <= s.length; ++start) {
        var subCards = s.slice(start, start + num);
        var bool = parseInt(subCards[num - 1]['scores']) - parseInt(subCards[0]['scores']) < 5;
        if (bool) {
          var newCard20;

          (function () {
            var indexs = [];
            newCard20 = card20.slice(0, j);

            subCards = subCards.concat(newCard20);
            subCards.forEach(function (ca) {
              for (var q = 0; q < card.length; q++) {
                var r = card[q];
                if (r === ca) {
                  indexs.push(q);
                  break;
                }
              }
            });
            indexs.sort(Array.sortByNumber);

            result.unshift(indexs);
          })();
        }
      }
    }
  }
  //cc.log(result)
  //cc.log('--------357')
  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(card);
    if (card === convertedCards) {
      return [];
    }
    return KQCard.findTongHuaShun20(convertedCards);
  }
  //return result.length > 0 ? result : null;
};

// 找铁支
// 如：[[1,2,3,4]]
KQCard.findTieZhi = function (cardModes) {
  var result = KQCard._findPointLength(cardModes, 4);
  if (result.length > 0) {
    return result;
  }
  result = [];
  // 五同是包含铁支的
  var wuTongIndexsArray = KQCard.findWuTong(cardModes);
  if (wuTongIndexsArray) {
    wuTongIndexsArray.forEach(function (indexs) {
      var tieZhiIndexs0 = [indexs[0], indexs[1], indexs[2], indexs[3]];
      var tieZhiIndexs1 = [indexs[0], indexs[1], indexs[2], indexs[4]];
      var tieZhiIndexs2 = [indexs[0], indexs[1], indexs[3], indexs[4]];
      var tieZhiIndexs3 = [indexs[0], indexs[2], indexs[3], indexs[4]];
      var tieZhiIndexs4 = [indexs[1], indexs[2], indexs[3], indexs[4]];
      result.push(tieZhiIndexs0);
      result.push(tieZhiIndexs1);
      result.push(tieZhiIndexs2);
      result.push(tieZhiIndexs3);
      result.push(tieZhiIndexs4);
    });
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result);
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 4);
};
//找五同
KQCard.findWuTong = function (cardModes) {
  if (cardModes.length < 5) {
    return [];
  }
  var result = this._findPointLength(cardModes, 5) || [];
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 5);
};
// 找顺子
// 如：[[1, 2, 3, 4, 5]]
KQCard.findShunZi = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  if (typeof cardModes[0]['point'] == "undefined") {
    cardModes = KQCard.cardsFromArray(cardModes);
  }
  // 先根据点数去重
  var uniqueCards = cardModes.unique(function (card1, card2) {
    return card1.point == card2.point;
  });
  uniqueCards.sort(KQCard.sortByPoint);

  // 如果有 A，则在最后添加 14
  var cardA = cardModes.find(function (card) {
    return card.point == 1;
  });
  if (cardA) {
    var cardAPlus = new KQCard(cardA);
    cardAPlus.point = 14;
    uniqueCards.push(cardAPlus);
  }

  var result = [];

  // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
  for (var start = 0; start + length <= uniqueCards.length; ++start) {
    var subCards = uniqueCards.slice(start, start + length);
    if (KQCard.isShunZi(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {

            if (card.point == 14) {
              return originCard.point == 1;
            }

            return card === originCard;
          });
          indexs.push(index);
        });

        indexs.sort(Array.sortByNumber);
        result.unshift(indexs);
      })();
    }
  }

  // 处理点数重复的情况
  // 比如 A A K Q J 10 这种
  var repeatIndexsArray = KQCard._findRepeatPointIndexsArray(result, cardModes);
  repeatIndexsArray.forEach(function (indexs) {
    result.unshift(indexs);
  });

  result.sort(function (arr1, arr2) {
    return arr1[0] - arr2[0];
  });

  return result.length > 0 ? result : KQCard.findShunZi20(cardModes);
};
KQCard.findShunZi20 = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes);
  if (card20.length <= 0) {
    return [];
  }
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  var newArr = [];
  var newArrs = [];
  for (var i = 0; i < cards.length; i++) {
    if (newArrs.indexOf(cards[i]['point']) == -1) {
      newArr.push(cards[i]);
      newArrs.push(cards[i].point);
    }
  }

  newArr.sort(function (n1, n2) {
    return n1.point - n2.point;
  });
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = length - j;
    for (var start = 0; start + num <= newArr.length; ++start) {
      var subCards = newArr.slice(start, start + num);
      var bool = parseInt(subCards[num - 1]['point']) - parseInt(subCards[0]['point']) < length;
      if (bool) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cardModes);
    if (cardModes === convertedCards) {
      return false;
    }
    return KQCard.findShunZi20(convertedCards);
  }
};
KQCard._findRepeatPointIndexsArray = function (indexsArray, originCards) {
  var repeatIndexsArray = [];
  indexsArray.forEach(function (indexs) {
    var cards = indexs.map(function (index) {
      return originCards[index];
    });

    cards.forEach(function (card, index) {
      var originIndex = originCards.findIndex(function (originCard) {
        if (typeof card == 'undefined') {
          return;
        }
        if (originCard !== card && originCard.point == card.point) {
          return true;
        }
        return false;
      });

      if (originIndex < 0) {
        return;
      }

      var repeatIndexs = indexs.slice();
      repeatIndexs[index] = originIndex;
      repeatIndexsArray.push(repeatIndexs);
    });
  });

  return repeatIndexsArray;
};

// 找同花
// 如：[[1, 2, 3, 4, 5]]
KQCard.findTongHua = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }

  var cards = Array.from(cardModes);
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var start = 0; start + length <= cards.length; ++start) {
    var subCards = cards.slice(start, start + length);
    if (KQCard.isTongHua(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {
            return card === originCard;
          });
          indexs.push(index);
        });
        //indexs = indexs.length > 5 ? indexs.splice(1,1) : indexs;
        indexs.sort(Array.sortByNumber);
        result.unshift(indexs);
      })();
    }
  }
  return result.length > 0 ? result : KQCard.findTongHua20(cardModes);
};
KQCard.findTongHua20 = function (cardModes) {
  if (cardModes.length < 5) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes);
  if (card20.length <= 0) {
    return [];
  }
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = 5 - j;
    for (var start = 0; start + num <= cards.length; ++start) {
      var subCards = cards.slice(start, start + num);
      if (KQCard.isTongHua(subCards, num)) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  return result.length > 0 ? result : [];
};

KQCard.findHuLu = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }

  var p_3 = KQCard.findSanTiao(cardModes);
  var p_4 = KQCard.findTieZhi(cardModes);
  var p2 = KQCard.findDuiZi(cardModes) || [];
  //var p_3 =  this._findPointLength(cardModes, 3) || [];
  //var p_4 = this._findPointLength(cardModes, 4) || [];
  //var p2 = this._findPointLength(cardModes, 2) || [];
  if (p2.length <= 0) {
    if (p_3) {
      p_3.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        var sanTiaoIndexs3 = [indexs[1], indexs[2]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        p2.push(sanTiaoIndexs3);
      });
    }

    if (p_4) {
      p_4.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[1], indexs[2]];
        //let sanTiaoIndexs4 = [indexs[1], indexs[3]];
        var sanTiaoIndexs6 = [indexs[2], indexs[3]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        //p2.unshift(sanTiaoIndexs2);
        //p2.unshift(sanTiaoIndexs3);
        //p2.unshift(sanTiaoIndexs4);
        p2.push(sanTiaoIndexs6);
      });
    }
  }

  if (p2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.unshift(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : KQCard.findHuLu20(cardModes);
};
KQCard.findHuLu20 = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes) || [];
  if (card20.length <= 0) {
    return [];
  }
  var p_3 = KQCard.findGuiPai(cardModes, 3);
  var p_4 = KQCard.findGuiPai(cardModes, 4);
  var p_2 = KQCard.findGuiPai(cardModes, 2);
  if (p_2 == null) {
    p_2 = [];
  }
  if (p_3) {
    p_3.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs3 = [indexs[1], indexs[2]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs3);
    });
  }

  if (p_4) {
    p_4.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs6 = [indexs[2], indexs[3]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs6);
    });
  }

  if (p_2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p_2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.unshift(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : [];
};

KQCard.findGuiPai = function (cardModes) {
  var numBer = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

  var card20 = KQCard.contain20(cardModes).map(function (card) {
    //得到鬼牌的索引
    for (var q = 0; q < cardModes.length; q++) {
      var r = cardModes[q];
      if (r === card) {
        return q;
      }
    }
  });
  if (card20.length <= 0) {
    return [];
  }
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = numBer - j; //除鬼牌外 我应该找多少张牌匹配
    var indexs = KQCard._findPointLength(cardModes, num) || [];
    for (var t = 0; t < indexs.length; t++) {
      if (numBer == 2) {
        //是对子的时候把鬼牌和单张匹配都循环一遍
        for (var o = 0; o < card20.length; ++o) {
          var s = indexs[t].concat(card20[o]);
          if (s.length == numBer) {
            result.push(s);
          }
        }
      } else {
        var s = indexs[t].concat(card20.slice(0, j)); //依次相加鬼牌第一次加一张 递增
        if (s.length == numBer) {
          result.push(s);
        }
      }
    }
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result); //去重
  return result.length > 0 ? result : [];
};

KQCard.repeat = function (result) {
  for (var i = 0; i < result.length; i++) {
    var index = result[i];

    var newAyy = [];
    for (var o = 0; o < index.length; o++) {
      //有重复干掉你
      if (newAyy.indexOf(index[o]) == -1) {
        newAyy.push(index[o]);
      } else {
        result.splice(i, 1);
        break;
      }
    }

    for (var j = i + 1; j < result.length - 1; j++) {
      var s = result[j];
      var jString = '';
      var iString = '';
      for (var r = 0; r < s.length; r++) {
        jString = jString + s[r];
        iString = iString + index[r];
      }
      if (jString == iString) {
        //有重复干掉你
        result.splice(i, 1);
        break;
      }
    }
  }
  return result;
};

KQCard.testFind = function (cardModes) {
  var WuTong = KQCard.findWuTong(cardModes) || [];
  var TongHuaShun = KQCard.findTongHuaShun(cardModes) || [];
  var TieZhi = KQCard.findTieZhi(cardModes) || [];
  var HuLu = KQCard.findHuLu(cardModes) || [];
  var TongHua = KQCard.findTongHua(cardModes) || [];
  var ShunZi = KQCard.findShunZi(cardModes) || [];
  var SanTiao = KQCard.findSanTiao(cardModes) || [];
  var LiaDui = KQCard.findLiaDui(cardModes) || [];
  var DuiZi = KQCard.findDuiZi(cardModes) || [];
  var result = [WuTong, TongHuaShun, TieZhi, HuLu, TongHua, ShunZi, SanTiao, LiaDui, DuiZi];
  return result;
};

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","KQCard":"KQCard","KQCardPointsHelper":"KQCardPointsHelper"}],"KQCardPointsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '42d3e866XhHdbkspy3Qytap', 'KQCardPointsHelper');
// scripts\KQCard\KQCardPointsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardPointsHelper = function KQCardPointsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.point;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardPointsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardPointsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardResHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'be420vtWaJOHoxQcZwP2xN2', 'KQCardResHelper');
// scripts\KQCard\KQCardResHelper.js

var Helper = {
  loadCardSpriteFrame: function loadCardSpriteFrame(cardName, callback) {
    this._loadCardFrame(cardName, callback);
  },

  setCardSpriteFrame: function setCardSpriteFrame(sprite, cardName) {
    this.loadCardSpriteFrame(cardName, function (spriteFrame) {
      sprite.spriteFrame = spriteFrame;
    });
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        callback(null, err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
};

module.exports = Helper;

cc._RFpop();
},{}],"KQCardScoreExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3f5d8wDA+tMPbPd/k4hBAAR', 'KQCardScoreExtension');
// scripts\KQCard\KQCardScoreExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardScoretsHelper = require('KQCardScoretsHelper');
var GetCardPointsSameCount = require('GetCardPointsSameCount');
var KQCardPointsHelper = require('KQCardPointsHelper');

KQCard.scoreOfCards = function (cards) {
  if (cards == null || cards.length == null) {
    cards = [];
  }

  var isTou = cards.length == 3;
  var typeScore = KQCard._typeScoreOfCards(cards);
  var caleCards = KQCard._convertOneToA(cards.slice());
  caleCards.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  //caleCards = KQCard.Sort(caleCards);
  var card20 = KQCard.contain20(caleCards);
  var pointHelper = new KQCardScoretsHelper(caleCards.kq_excludes(card20));
  var maxNum = pointHelper.maxNumber() /*-card20.length == 0 ? 1: pointHelper.maxNumber()-card20.length*/;

  var maxScore = 0; //获取除鬼牌外最大的的点数
  for (var i in pointHelper.pointNumbers) {
    if (parseInt(i) > maxScore && pointHelper.pointNumbers[i] == maxNum) {
      maxScore = parseInt(i);
    }
  }
  caleCards.forEach(function (card) {
    if (card.scores >= 20) {
      card.scores = maxScore;
    }
  });
  card20.forEach(function (card) {
    card.scores = maxScore;
  });
  //cc.log(maxNum)
  //cc.log(maxScore)
  //cc.log(caleCards.kq_excludes(card20))
  //cc.log('----35')
  caleCards.sort(KQCard.sort);
  if (typeScore == 9000000000000000) {
    //五同
    caleCards.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var totalValue = "";
    //var totalColor = "";
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      //var c = caleCards[i].color;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      //totalColor = c+totalColor;
    }
    //totalValue = totalValue+totalColor;
    //cc.log(totalValue)
    //cc.log(parseInt(totalValue))
    //cc.log(typeScore+parseInt(totalValue))
    return typeScore + parseInt(totalValue);
  } else if (typeScore == 8000000000000000) {
    //同花顺比最大的那张，如果两张相同那就是相同
    if (card20.length > 0) {
      //有鬼牌的时候要改变鬼牌的分数
      caleCards = KQCard._changeCardScors(caleCards);
    }
    var totalValue = "";
    var valueColor = ""; //牌色
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      var c = caleCards[i].color; //牌色
      valueColor = c + valueColor; //牌色
    }
    if (cc.huaSe == 0) return typeScore + parseInt(totalValue);
    return typeScore + parseInt(totalValue + valueColor);
  } else if (typeScore == 7000000000000000) {
    //铁支,找出那四张是什么牌

    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }
    //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
    //var qwe = '';
    //qwe = oneValueColor.substr(0,oneValueColor.length -1);
    //oneValueColor = oneValueColor.substr(oneValueColor.length -1);
    //str = str+oneValue + oneValueColor + valueColor + qwe;
    //return typeScore+parseInt(str);
    return typeScore + parseInt(str + oneValue);
  } else if (typeScore == 6000000000000000) {
    //葫芦
    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }

    if (isTou) {
      oneValue = oneValue + '0000';
      oneValueColor = oneValueColor + '00';
    }
    return typeScore + parseInt(str + oneValue);
    //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
    //str = str+oneValue + valueColor + oneValueColor;
    //return typeScore+parseInt(str);
  } else if (typeScore == 5000000000000000) {
      //同花,有可能需要比5张牌
      var totalScore = "";
      var totalColor = "";
      //var colors = 0;//获取牌的类型颜色
      //for(var i in caleCards) {
      //  if(parseInt(caleCards[i].point) < 20){
      //    colors = parseInt(caleCards[i].color);
      //    break;
      //  }
      //}

      for (var i in caleCards) {
        var paiPoint = parseInt(caleCards[i].point);
        var colors = parseInt(caleCards[i].point) < 20 ? caleCards[i].color : 5;
        totalColor = colors + totalColor;
        totalScore = (paiPoint >= 10 ? paiPoint : "0" + paiPoint) + totalScore;
      }
      return typeScore + parseInt(totalScore);
      //if(cc.huaSe == 0) return typeScore+parseInt(totalScore);
      //return typeScore+parseInt(totalScore+totalColor);
    } else if (typeScore == 4000000000000000) {
        //顺子
        if (card20.length > 0) {
          //有鬼牌的时候要改变鬼牌的分数
          caleCards = KQCard._changeCardScors(caleCards);
        }
        var totalValue = "";
        var valueColor = ""; //牌色
        for (var i in caleCards) {
          var s = caleCards[i].scores;
          totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;

          var c = caleCards[i].color; //牌色
          valueColor = c + valueColor; //牌色
        }
        return typeScore + parseInt(totalValue);
        //if(cc.huaSe == 0) return typeScore+parseInt(totalValue);
        //return typeScore+parseInt(totalValue + valueColor);
      } else if (typeScore == 3000000000000000) {
          //三条，找出是哪张牌有3张
          //caleCards.sort(KQCard.sort);
          var str = "";
          var oneValue = "";
          var valueColor = ""; //牌色
          var oneValueColor = ""; //牌色
          var oneValueColor20 = ""; //牌色
          for (var w in caleCards) {
            if (maxScore == caleCards[w].scores) {
              //三条
              var s = caleCards[w].scores;
              str = (parseInt(s) >= 10 ? s : "0" + s) + str;

              var c = caleCards[w].color; //牌色
              valueColor = c + valueColor; //牌色
            } else {
                var s = caleCards[w].scores;
                oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

                var c = caleCards[w].color; //牌色
                if (parseInt(s) < 20) {
                  oneValueColor = c + oneValueColor; //牌色
                } else {
                    oneValueColor20 = c + oneValueColor20; //牌色
                  }
              }
          }
          if (isTou) {
            oneValue = oneValue + '0000';
            valueColor = valueColor + '00';
          }
          return typeScore + parseInt(str + oneValue);
          //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
          //str = str+oneValue + oneValueColor + valueColor + oneValueColor20;
          //return typeScore+parseInt(str);
        } else if (typeScore == 2000000000000000) {
            //caleCards.sort(KQCard.sort);
            //两对,有可能需要比5张牌
            var str = "";
            var oneValue = '';
            var valueColor = ""; //牌色
            var oneValueColor = ""; //牌色
            for (var i in pointHelper.pointNumbers) {
              if (pointHelper.pointNumbers[i] == 2) {
                //两对
                for (var w in caleCards) {
                  if (i == caleCards[w].scores) {
                    var s = caleCards[w].scores;
                    str = (parseInt(s) >= 10 ? s : "0" + s) + str;
                    var c = caleCards[w].color; //牌色
                    valueColor = c + valueColor; //牌色
                  }
                }
              } else {
                  for (var q in caleCards) {
                    //单张加花色
                    if (i == caleCards[q].scores) {
                      var s = caleCards[q].scores;
                      oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

                      var c = caleCards[q].color; //牌色
                      oneValueColor = oneValueColor + c; //牌色
                    }
                  }
                }
            }
            return typeScore + parseInt(str + oneValue);
            //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
            ////cc.log(str)
            ////cc.log(oneValue)
            //str = str+oneValue +oneValueColor + valueColor;
            //return typeScore+parseInt(str);
          } else if (typeScore == 1000000000000000) {
              //对子
              //caleCards.sort(KQCard.sort);
              var str = "";
              var oneValue = "";
              var oneValueColor = "";
              var valueColor = "";

              if (card20.length > 0) {
                caleCards.sort(function (card1, card2) {
                  return card2.point - card1.point;
                });
                caleCards = caleCards.kq_excludes(card20);
                caleCards.forEach(function (card, index) {
                  var s = card.scores;
                  var c = card.color;
                  str = str + (parseInt(s) >= 10 ? s : "0" + s);
                  if (index == 0) {
                    var s20 = card20[0].scores;
                    str = str + (parseInt(s20) >= 10 ? s20 : "0" + s20);
                    valueColor = valueColor + c;
                    valueColor = valueColor + card20[0].color;
                  } else {
                    oneValueColor = oneValueColor + c;
                  }
                });
                //cc.log(str)
                //cc.log('--------274')
                if (isTou) {
                  str = str + '0000';
                  valueColor = valueColor + '00';
                }
                return typeScore + parseInt(str);
                //if(cc.huaSe == 0) return typeScore+parseInt(str);
                //str = str + oneValueColor + valueColor;
                //return typeScore+parseInt(str);
              }

              for (var i in pointHelper.pointNumbers) {
                if (pointHelper.pointNumbers[i] == maxNum) {
                  //对子
                  for (var w in caleCards) {
                    //对子加花色
                    if (i == caleCards[w].scores) {
                      var s = caleCards[w].scores;
                      valueColor = caleCards[w].color + valueColor;
                      str = (parseInt(s) >= 10 ? s : "0" + s) + str;
                    }
                  }
                } else {
                  for (var q in caleCards) {
                    //单张加花色
                    if (i == caleCards[q].scores) {
                      var s = caleCards[q].scores;
                      oneValueColor = caleCards[q].color + oneValueColor;
                      oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;
                    }
                  }
                }
              }
              if (isTou) {
                oneValue = oneValue + '0000';
                valueColor = valueColor + '00';
              }
              return typeScore + parseInt(str + oneValue);
              //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
              //str = str+oneValue+oneValueColor+valueColor;
              //return typeScore+parseInt(str);
            } else if (typeScore == 0) {
                //乌龙
                var valuePoint = "";
                var valueColor = "";
                for (var q in caleCards) {
                  var s = caleCards[q].scores;
                  var c = caleCards[q].color; //单张加花色
                  valuePoint = (parseInt(s) >= 10 ? s : "0" + s) + valuePoint;
                  valueColor = c + valueColor;
                }
                if (isTou) {
                  valuePoint = valuePoint + '0000';
                  valueColor = valueColor + '00';
                }
                return typeScore + parseInt(valuePoint);
                //if(cc.huaSe == 0) return typeScore+parseInt(valuePoint);
                //valuePoint = valuePoint + valueColor;
                //return typeScore+parseInt(valuePoint);
              }

  var cardsTotalPoint = 0;
  caleCards.forEach(function (card) {
    cardsTotalPoint += card.point;
  });

  var result = typeScore + cardsTotalPoint;
  return result;
};
KQCard._changeCardScors = function (cardModel) {
  cardModel.forEach(function (card) {
    card.scores = card.point;
    if (card.scores == 1) {
      card.scores = 14;
    }
  });

  var is14 = true; //是 k q j 10 A;
  var is1 = true; //是1 2 3 4 5

  cardModel.forEach(function (card) {
    if (card.scores < 10) {
      is14 = false; //不是 k q j 10 A;
    }
  });
  cardModel.forEach(function (card) {
    card.scores = card.point;
    if (card.scores == 14) {
      card.scores = 1;
    }
  });
  cardModel.forEach(function (card) {
    if (card.scores > 5 && card.scores != 20) {
      is1 = false; //不是1 2 3 4 5
    }
  });

  if (is14) {
    //是 k q j 10 A;
    cardModel.forEach(function (card) {
      if (card.scores == 1) {
        card.scores = 14;
      }
    });

    cardModel.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var num = 14;
    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      scoresAyy.push(num);
      num -= 1;
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    //cc.log('----------是 k q j 10 A',scoresAyy)
    cardModel.forEach((function (card) {
      //找出选中的牌
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  } else if (is1) {
    //是1 2 3 4 5
    cardModel.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var num = 5;
    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      scoresAyy.push(num);
      num -= 1;
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    //cc.log('----------是1 2 3 4 5')
    cardModel.forEach((function (card) {
      //找出选中的牌
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  } else {
    cardModel.sort(function (a1, a2) {
      return a1.scores - a2.scores;
    });
    var scoresAyy = []; //用来装鬼牌分数
    for (var i = 0; i < 5; i++) {
      var s = parseInt(cardModel[0].scores) + i; //最小的牌的分数
      scoresAyy.push(s); //一副牌的分数
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    cardModel.forEach((function (card) {
      //改变牌的分数
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  }

  cardModel.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  cardModel.sort(function (a1, a2) {
    return a1.scores - a2.scores;
  });
  return cardModel;
};
/*#####*/

KQCard._typeScoreOfCards = function (cards) {
  var typeScore = 0;
  if (KQCard.containWuTong(cards)) {
    typeScore = 9000000000000000;
  } else if (KQCard.containTongHuaShun(cards)) {
    typeScore = 8000000000000000;
  } else if (KQCard.containTieZhi(cards)) {
    typeScore = 7000000000000000;
  } else if (KQCard.containHuLu(cards)) {
    typeScore = 6000000000000000;
  } else if (KQCard.containTongHua(cards)) {
    typeScore = 5000000000000000;
  } else if (KQCard.containShunZi(cards)) {
    typeScore = 4000000000000000;
  } else if (KQCard.containSanTiao(cards)) {
    typeScore = 3000000000000000;
  } else if (KQCard.containLiaDui(cards)) {
    typeScore = 2000000000000000;
  } else if (KQCard.containDuiZi(cards)) {
    typeScore = 1000000000000000;
  }

  return typeScore;
};
/*
 // 根据牌型进行排序
 KQCard._typeCardsSort = function (cards) {
 if ((cards == null) || (cards.length == 0)) {
 return cards;
 }
 if(KQCard.containWuTong(cards)){
 return KQCard._typeCardsSortWutong(cards);
 } else if (KQCard.containTongHuaShun(cards)) {
 return KQCard._typeCardsSortShunZi(cards);
 } else if (KQCard.containTieZhi(cards)) {
 return KQCard._typeCardsSortTieZhi(cards);
 } else if (KQCard.containHuLu(cards)) {
 return KQCard._typeCardsSortHuLu(cards);
 } else if (KQCard.containTongHua(cards)) {
 return KQCard._typeCardsSortTongHua(cards);
 } else if (KQCard.containShunZi(cards)) {
 return KQCard._typeCardsSortShunZi(cards);
 } else if (KQCard.containSanTiao(cards)) {
 return KQCard._typeCardsSortSanTiao(cards);
 } else if (KQCard.containLiaDui(cards)) {
 return KQCard._typeCardsSortLiangDui(cards);
 } else if (KQCard.containDuiZi(cards)) {
 return KQCard._typeCardsSortDuiZi(cards);
 }

 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortShunZi = function (cards) {
 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortTieZhi = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 /!*#####*!/
 KQCard._typeCardsSortWutong = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };
 /!*#####*!/

 KQCard._typeCardsSortHuLu = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortTongHua = function (cards) {
 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortSanTiao = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortLiangDui = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortDuiZi = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };
 */
KQCard._typeCardsSortByNumberOfPoints = function (cards) {

  cards = KQCard._changeGuiCard(cards);

  cards.forEach(function (i) {
    if (i.scores == 1) i.scores = 14;
  });

  var pointHelper = new KQCardScoretsHelper(cards);
  var newCards = cards.slice().sort(function (card1, card2) {
    var numberOfCard1 = pointHelper.pointNumbers[card1.scores];
    var numberOfCard2 = pointHelper.pointNumbers[card2.scores];

    if (numberOfCard2 != numberOfCard1) {
      return numberOfCard2 - numberOfCard1;
    }
    var scores1 = card1.scores == 1 ? 14 : card1.scores;
    var scores2 = card2.scores == 1 ? 14 : card2.scores;
    return scores2 - scores1;
    //return card2.scores - card1.scores;
  });
  newCards.forEach(function (i) {
    if (i.scores == 14) i.scores = 1;
  });
  return newCards /*.concat(card20)*/;
};

KQCard._typeCardsSortByNumberOfPoints1 = function (cards) {

  cards = KQCard._changeGuiCard(cards);

  cards.forEach(function (i) {
    if (i.scores == 1) i.scores = 14;
  });

  var pointHelper = new KQCardScoretsHelper(cards);
  var newCards = cards.slice().sort(function (card1, card2) {
    var numberOfCard1 = pointHelper.pointNumbers[card1.scores];
    var numberOfCard2 = pointHelper.pointNumbers[card2.scores];

    if (numberOfCard2 != numberOfCard1) {
      return numberOfCard1 - numberOfCard2;
    }
    var scores1 = card1.scores == 1 ? 14 : card1.scores;
    var scores2 = card2.scores == 1 ? 14 : card2.scores;
    return scores1 - scores2;
    //return card1.scores - card2.scores;
  });
  newCards.forEach(function (i) {
    if (i.scores == 14) i.scores = 1;
  });
  return newCards;
};

KQCard._changeGuiCard = function (cards) {

  var card20 = KQCard.contain20(cards);

  var ca = cards.kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var type = KQCard.cardsType(cards) + 1;

  type = type >= 10 ? type : "0" + type;

  if (type == "05" || type == "09") {

    return KQCard._changeCardScors(cards);
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }
    color = ca[0].color;

    so = so == 14 ? 1 : so;

    card20.forEach(function (n) {

      n.scores = so;

      n.colorScores = color;
    });
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    card20.forEach((function (n) {

      n.scores = so;

      n.colorScores = color;
    }).bind(this));
  }

  return card20.concat(ca);
};

KQCard._setGuiCard = function (index, start, end, type, cards, nodes, cardSpriteAtlas) {
  //cc.log(cardSpriteAtlas)
  //cc.log('-----593')
  var card20 = KQCard.contain20(cards[index]);

  var ca = cards[index].kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var node = nodes.slice(start, end).filter(function (n) {

    if (n.childrenCount > 0 && n.children[0].cardName) {

      if (parseInt(n.children[0].cardName.split("_")[1]) == 20) return true;
    }
  });

  if (type == "05" || type == "09") {

    cards[index] = KQCard._changeCardScors(cards[index]);

    so = cards[index].filter(function (i) {
      if (i.point == 20) return true;
    }).map(function (i) {
      return i.scores == 14 ? 1 : i.scores;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = ca[0].color + "_" + so.splice(0, 1)[0];

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    color = ca[0].color;

    so = so == 14 ? 1 : so;

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
};

KQCard._setGuiCards = function (type, cards, nodes, cardSpriteAtlas) {
  //cc.log(cardSpriteAtlas)
  //cc.log('-----593')
  var card20 = KQCard.contain20(cards);

  var ca = cards.kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var node = nodes.slice().filter(function (n) {

    if (n.childrenCount > 0 && n.children[0].cardName) {

      if (parseInt(n.children[0].cardName.split("_")[1]) == 20) return true;
    }
  });

  if (type == "05" || type == "09") {

    cards = KQCard._changeCardScors(cards);

    so = cards.filter(function (i) {
      if (i.point == 20) return true;
    }).map(function (i) {
      return i.scores == 14 ? 1 : i.scores;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = ca[0].color + "_" + so.splice(0, 1)[0];

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    color = ca[0].color;

    so = so == 14 ? 1 : so;

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
};

KQCard._loadCardFrame = function (SpriteFrame, path, SpritesNode, w, h) {
  //cc.log(SpriteFrame)
  //cc.log('---769')
  var Sprite = SpriteFrame.getSpriteFrame(path);

  SpritesNode.spriteFrame = Sprite;

  if (w) SpritesNode.node.width = w;

  if (h) SpritesNode.node.height = h;
};

KQCard.testScore = function () {};

cc._RFpop();
},{"GetCardPointsSameCount":"GetCardPointsSameCount","KQCard":"KQCard","KQCardColorsHelper":"KQCardColorsHelper","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardPointsHelper":"KQCardPointsHelper","KQCardScoretsHelper":"KQCardScoretsHelper"}],"KQCardScoretsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3d3b5YPHXhN44h/B0miZFRE', 'KQCardScoretsHelper');
// scripts\KQCard\KQCardScoretsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardScoretsHelper = function KQCardScoretsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.scores;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardScoretsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardScoretsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardSelectExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '66642YNpFVIzb+JM2CkwEgS', 'KQCardSelectExtension');
// scripts\KQCard\KQCardSelectExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');

// 牌自动选择的扩展

/**
 * 自动选择牌，由大到小
 *
 * @param  {[KQCard]} originCards  被选择的原始牌数组
 *
 * @return {[KQCard]}
 */
KQCard.autoSelectCards = function (originCards, maxLength) {
    if (originCards.length <= maxLength) {
        return originCards;
    }
    originCards.forEach(function (card) {
        if (card.scores == 1) {
            card.scores = 14;
        }
    });
    var cards = originCards.slice().sort(function (a, b) {
        return a.scores - b.scores;
    });

    var findFuncs = [KQCard.findWuTong, KQCard.findTongHuaShun, KQCard.findTieZhi, KQCard.findHuLu, KQCard.findTongHua, KQCard.findShunZi, KQCard.findSanTiao, KQCard.findLiaDui, KQCard.findDuiZi];

    var indexArrays = null;
    for (var i = 0; i < findFuncs.length; ++i) {
        var func = findFuncs[i];
        indexArrays = func.bind(KQCard)(cards);
        if (indexArrays && indexArrays.length > 0) {
            break;
        }
    }

    var indexs = [];
    if (indexArrays && indexArrays.length > 0) {
        // 找出同类型的牌里的分数最大的牌
        var maxScore = 0;
        indexArrays.forEach(function (tempIndexs) {
            var tempCards = tempIndexs.map(function (index) {
                return cards[index];
            });
            var score = KQCard.scoreOfCards(tempCards);
            if (score > maxScore) {
                maxScore = score;
                indexs = tempIndexs;
            }
        });
    }

    var targetCards = indexs.map(function (index) {
        return cards[index];
    });

    /*if (targetCards.length < maxLength) {
     cards = cards.kq_excludes(targetCards);
     while(targetCards.length < maxLength) {
     targetCards.push(cards.pop());
     }
     } else */if (targetCards.length > maxLength) {
        targetCards = targetCards.slice(0, maxLength);
    }

    return targetCards || [];
};

KQCard.testAutoSelect = function (cards) {};

cc._RFpop();
},{"KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension"}],"KQCard":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c548c0gMf5BGIH4309MULw+', 'KQCard');
// scripts\KQCard\KQCard.js

var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardPointsHelper = require('KQCardPointsHelper');
var NumberExtension = require('NumberExtension');
var GetCardPointsSameCount = require('GetCardPointsSameCount');

cc = cc || {};
cc.assert = cc.assert || console.assert || function () {};
cc.log = cc.log || console.log || function () {};
cc.error = cc.error || console.error || function () {};

// 牌 Model 类，封装了花色和点数
// 使用：
// new KQCard(22);
var KQCard = function KQCard(point, color, index) {
    this.color = null;
    this.point = null;
    this.sindex = index;
    this._initWithColorAndPoint = function (color, point) {
        if (color == 's') {
            color = 4;
        }
        if (color == 'h') {
            color = 3;
        }
        if (color == 'c') {
            color = 2;
        }
        if (color == 'd') {
            color = 1;
        }

        this.point = Number(point);
        this.scores = Number(point);
        this.color = Number(color);
        this.colorScores = Number(color);

        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithNumber = function (number) {
        this.point = Math.floor(number / 10);
        this.color = number % 10;
        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithObject = function (object) {
        if (object.point) {
            this._initWithColorAndPoint(object.color, object.point);
        } else if (object.suit) {
            this._initWithColorAndPoint(object.suit, object.number);
        }
    };

    this.description = function () {
        return this.cardName();
    };

    this.cardName = function () {
        return this.color + "_" + this.point;
    };

    this.sort = function (otherCard) {
        var asc = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var AisMax = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

        return KQCard.sort(this, otherCard, asc, AisMax);
    };

    this.isEqual = function (otherCard) {
        if (!otherCard) {
            return false;
        }
        return this.point == otherCard.point && this.color == otherCard.color && this.sindex == otherCard.sindex;
    };

    if (point && color) {
        this._initWithColorAndPoint(color, point);
        return;
    }

    var number = Number(point);
    if (!Number.isNaN(number)) {
        this._initWithNumber(number);
        return;
    }

    if (typeof point == 'string') {
        // 解析 xxxxd_d 形式
        var found = point.match(/(\.)*\d_\d+/);
        if (found instanceof Array && found.length > 0) {
            var result = found[0];
            var numbers = result.split('_');

            var _color = Number(numbers[0]);
            var _point = Number(numbers[1]);

            this._initWithColorAndPoint(_color, _point);
        }

        return;
    }

    if (typeof point == 'object') {
        this._initWithObject(point);
        return;
    }

    cc.error("初始化错误：" + point + " " + color);
};

// 转换成服务器的牌 model
KQCard.prototype.toServerCard = function () {
    return {
        'suit': this.color,
        'number': this.point
    };
};

KQCard.COLOR_SPADE = 4;
KQCard.COLOR_HEART = 3;
KQCard.COLOR_CLUB = 2;
KQCard.COLOR_DIAMOND = 1;

module.exports = KQCard;

KQCard.cardsFromArray = function (cardNames) {
    return cardNames.map(function (cardName, index) {
        return new KQCard(cardName, null, index);
    });
};

// 将多张牌转换成服务器的形式
KQCard.convertToServerCards = function (cards) {
    return cards.map(function (card) {
        return card.toServerCard();
    });
};

KQCard.TYPE = {
    WuLong: 0,
    DuiZi: 1,
    LiangDui: 2,
    SanTiao: 3,
    ShunZi: 4,
    TongHua: 5,
    HuLu: 6,
    TieZhi: 7,
    TongHuaShun: 8,
    /*#####*/
    WuTong: 9,
    /*#####*/
    SanTaoHua: 10, // 特殊牌
    SanShunZi: 11,
    LiuDuiBan: 12,

    WuDuiSanTiao: 13,
    SiTaoSanTiao: 14,

    CouYiSe: 15,
    SanFenTianXia: 16,
    SanTongHuaShun: 17,
    YiTiaoLong: 18,
    QingLong: 19
};

// 牌类型名
KQCard.cardsTypeName = function (cards) {
    var names = ['乌龙', '对子', '两对', '三条', '顺子', '同花', '葫芦', '铁支', '同花顺', '五同', '三同花', '三顺子', '六对半', '五对三条', '四套三条', '凑一色', '三分天下', '三同花顺', '一条龙', '清龙'];
    var type = KQCard.cardsType(cards);
    return names[type];
};

// 找出牌的类型
KQCard.cardsType = function (cards) {
    if (KQCard.isQingLong(cards)) {
        return KQCard.TYPE.QingLong;
    }

    if (KQCard.isYiTiaoLong(cards)) {
        return KQCard.TYPE.YiTiaoLong;
    }

    //if (KQCard.isSanTongHuaShun(cards)) {
    //    return KQCard.TYPE.SanTongHuaShun;
    //}
    //
    //if (KQCard.isSanFenTianXia(cards)) {
    //    return KQCard.TYPE.SanFenTianXia;
    //}

    if (KQCard.isLiuDuiBan(cards)) {
        return KQCard.TYPE.LiuDuiBan;
    }

    if (KQCard.isSanTongHua(cards)) {
        return KQCard.TYPE.SanTaoHua;
    }

    if (KQCard.isSanShunZi(cards)) {
        return KQCard.TYPE.SanShunZi;
    }

    //if (KQCard.isCouYiSe(cards)) {
    //    return KQCard.TYPE.CouYiSe;
    //}
    //
    //if (KQCard.isWuDuiSanTiao(cards)) {
    //    return KQCard.TYPE.WuDuiSanTiao;
    //}
    //
    //if (KQCard.isSiTaoSanTiao(cards)) {
    //    return KQCard.TYPE.SiTaoSanTiao;
    //}

    /*#####*/
    if (KQCard.containWuTong(cards, 5)) {
        return KQCard.TYPE.WuTong;
    }

    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    //
    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    /*#####*/

    if (KQCard.containTongHuaShun(cards, 5)) {
        return KQCard.TYPE.TongHuaShun;
    }

    if (KQCard.containTieZhi(cards)) {
        return KQCard.TYPE.TieZhi;
    }

    if (KQCard.containHuLu(cards)) {
        return KQCard.TYPE.HuLu;
    }

    if (KQCard.containTongHua(cards)) {
        return KQCard.TYPE.TongHua;
    }

    if (KQCard.containShunZi(cards)) {
        return KQCard.TYPE.ShunZi;
    }

    if (KQCard.containSanTiao(cards)) {
        return KQCard.TYPE.SanTiao;
    }

    if (KQCard.containLiaDui(cards)) {
        return KQCard.TYPE.LiangDui;
    }

    if (KQCard.containDuiZi(cards)) {
        return KQCard.TYPE.DuiZi;
    }

    return KQCard.TYPE.WuLong;
};

// 判断是否是同花
KQCard.isTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    var colors = cards.map(function (card) {
        return card.color;
    });

    var color = colors[0];
    for (var index in colors) {
        var e = colors[index];
        if (e != color) {
            return false;
        }
    }
    return true;
};

// 是否包含同花
KQCard.containTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    //if (KQCard.findTongHua(cards).length > 0) {
    //    return true;
    //}
    //return false;
    cards = Array.from(cards);
    cards.sort(KQCard.sortByColor);

    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    minLength = minLength - card20.length;

    for (var start = 0; start + minLength <= cards.length; ++start) {
        var subCards = cards.slice(start, start + minLength);
        if (KQCard.isTongHua(subCards, minLength)) {
            return true;
        }
    }

    //return KQCard.containTongHua20(cards);
};
KQCard.containTongHua20 = function (card) {
    if (card.length < 5) {
        return false;
    }
    var card20 = KQCard.contain20(card);
    var cards = card.kq_excludes(card20);
    cards.sort(KQCard.sortByColor);

    for (var j = 1; j <= card20.length; ++j) {
        var num = 5 - j;
        for (var start = 0; start + num <= cards.length; ++start) {
            var subCards = cards.slice(start, start + num);
            if (KQCard.isTongHua(subCards, num)) {
                return true;
            }
        }
    }
    return false;
};
// 判断是否是顺子
KQCard.isShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    if (KQCard._isShunZiAKQ(cards)) {
        return true;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });

    var point = points[0];
    for (var index in points) {
        var e = points[index];
        if (e != point) {
            return false;
        }

        point = point + 1;
    }

    return true;
};

// 判断是否是 A K Q J 10 这个顺子
KQCard._isShunZiAKQ = function (cards) {
    var length = cards.length;
    if (length.length < 3) {
        return false;
    }

    var point1s = [1];
    var point14s = [14];
    var pointK = 13;

    Number(length - 1).kq_times(function (times) {
        point1s.push(pointK - times);
        point14s.push(pointK - times);
    });

    return KQCard._isCardsContainPoints(cards, point1s) || KQCard._isCardsContainPoints(cards, point14s);
};

// cards 中是否包含 points 这些点数

KQCard._isCardsContainPoints = function (cards, points) {
    var _loop = function (index) {
        var point = points[index];
        var pointCardIndex = cards.findIndex(function (card) {
            return card.point == point;
        });

        if (pointCardIndex < 0) {
            return {
                v: false
            };
        }
    };

    for (var index = 0; index < points.length; ++index) {
        var _ret = _loop(index);

        if (typeof _ret === 'object') return _ret.v;
    }

    return true;
};
KQCard.contain20 = function (cards) {
    if (cards.length <= 0) {
        return [];
    }
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var newCard = cards.filter(function (card) {
        //重新赋值cards
        if (card.point >= 20) {
            return card;
        }
    });
    return newCard || [];
};
// 是否包含顺子
KQCard.containShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findShunZi(cards).length > 0) {
        return true;
    }
    return false;
    //let uniqueCards = cards.unique(function(card1, card2) {
    //    return card1.point == card2.point;
    //});
    //uniqueCards.sort(KQCard.sortByPoint);
    //
    //let minPointCard = uniqueCards[0];
    //if (minPointCard.point == 1) {
    //    let APlusCard = new KQCard(minPointCard);
    //    APlusCard.point = 14;
    //    uniqueCards.push(APlusCard);
    //}
    //
    //for (var start = 0; (start + minLength) <= uniqueCards.length; ++start) {
    //    let subCards = uniqueCards.slice(start, start + minLength);
    //    if (KQCard.isShunZi(subCards, minLength)) {
    //        return true;
    //    }
    //}
    //
    //return KQCard.containShunZi20(cards);
};
/*KQCard.containShunZi20 = function (card) {
 if (card.length < 5) {
 return false;
 }
 var card20 = KQCard.contain20(card);
 var cards = card.kq_excludes(card20);
 // 先根据点数去重
 var newArr = [];
 var newArrs = [];
 for (var i = 0; i < cards.length; i++) {
 if (newArrs.indexOf(cards[i].point) == -1) {
 newArr.push(cards[i]);
 newArrs.push(cards[i].point);
 }
 }
 //newArr.forEach(function(card){
 //    if(card.scores == 14){
 //        card.scores = 1;
 //    }
 //})
 newArr.sort(function (n1, n2) {
 return n1.point - n2.point;
 });
 for(var j = 1;j <= card20.length;++j){
 var num = 5 - j;
 for (var start = 0; (start + num) <= newArr.length; ++start) {
 var subCards = newArr.slice(start, start + num);
 var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
 if(bool){
 return true;
 }
 }
 }
 // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
 let convertedCards = KQCard._convertOneToA1(card);
 if (card === convertedCards) {
 return false;
 }
 return KQCard.containShunZi20(convertedCards);
 };*/
// 是否是同花顺
KQCard.isTongHuaShun = function (cards) {
    return KQCard.isTongHua(cards) && KQCard.isShunZi(cards);
};

// 是否包含有同花顺
KQCard.containTongHuaShun = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findTongHuaShun(cards).length > 0) {
        return true;
    }
    return false;
    //var sanShunZi = KQCard.sanShunZi1(cards,minLength)[0];
    //if(sanShunZi == null){
    //    return false;
    //}
    //var result = false;
    //for(var i=0;i<sanShunZi.length;i++) {
    //    var s = sanShunZi[i];
    //    if (KQCard.isTongHuaShun(s, minLength)) {
    //        return true;
    //    }
    //}
    //return KQCard.containTongHuaShun1(cards);
};
/*KQCard.containTongHuaShun1 = function (cards, minLength = 5) {
 if (cards.length < minLength) {
 return false;
 }
 let tempCards = Array.from(cards).sort(KQCard.sortByColor);
 for (var start = 0; (start + minLength) <= tempCards.length; ++start) {
 let subCards = tempCards.slice(start, start + minLength);
 if (KQCard.isTongHuaShun(subCards, minLength)) {
 return true;
 }
 }

 let convertedCards = KQCard._convertOneToA1(cards);
 if (cards === convertedCards) {
 return KQCard.containTongHuaShun20(cards);
 }
 return KQCard.containTongHuaShun1(convertedCards);
 //return false;
 };
 KQCard.containTongHuaShun20 = function (card, minLength = 5) {
 if (card.length < minLength) {
 return false;
 }
 var card20 = KQCard.contain20(card) || [];
 var cards = card.kq_excludes(card20);

 cards = Array.from(cards);
 var colorS = []; //黑桃
 var colorH = []; //红心
 var colorC = []; //梅花
 var colorD = []; //方块
 var pointS = []; //黑桃
 var pointH = []; //红心
 var pointC = []; //梅花
 var pointD = []; //方块
 for(var i=0;i<cards.length;i++){
 if(cards[i].color == '4'){
 if(pointS.indexOf(cards[i].point) == -1){
 pointS.push(cards[i].point);
 colorS.push(cards[i]);
 }

 }else if(cards[i].color == '3'){
 if(pointH.indexOf(cards[i].point) == -1){
 pointH.push(cards[i].point);
 colorH.push(cards[i]);
 }
 }else if(cards[i].color == '2'){
 if(pointC.indexOf(cards[i].point) == -1){
 pointC.push(cards[i].point);
 colorC.push(cards[i]);
 }
 }else if(cards[i].color == '1'){
 if(pointD.indexOf(cards[i].point) == -1){
 pointD.push(cards[i].point);
 colorD.push(cards[i]);
 }
 }
 }

 var color = [colorS,colorH,colorC,colorD];
 var colorSum = [];    //总共有几种花色 [5,3,0....]
 for(var i=0;i<color.length;i++){
 if(color[i].length >= parseInt(5 - card20.length)){
 //color[i].forEach(function(ca){
 //    if(ca.scores == 14){
 //        ca.scores = 1;
 //    }
 //})
 color[i].sort(function(a1,a2){
 return a1 - a2;
 })
 colorSum.push(color[i]);
 }
 }

 for(var i=0;i<colorSum.length;i++) {
 var s = colorSum[i]
 for(var j = 1;j <= card20.length;++j){
 var num = 5 - j;
 for (var start = 0; (start + num) <= s.length; ++start) {
 var subCards = s.slice(start, start + num);
 var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
 if(bool){
 return true;
 }
 }
 }
 }



 let convertedCards = KQCard._convertOneToA1(card);
 if (card === convertedCards) {
 return false;
 }
 return KQCard.containTongHuaShun20(convertedCards);
 };*/

// 是否是清龙
KQCard.isQingLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    /**
     *
     */
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
        }
    }
    if (colorSum.length == 1) {
        if (colorSum[0] == 13) {

            if (KQCard.isYiTiaoLong(cards)) {

                var teShuCard = cards.filter(function (i) {
                    return i;
                });

                teShuCard = KQCard.cardsFromArray(teShuCard);

                teShuCard.forEach(function (a) {
                    if (a.scores == 1) a.scores = 14;
                });

                teShuCard.sort(function (a, b) {
                    return b.scores - a.scores;
                });

                teShuCard = KQCard.convertToServerCards(teShuCard);

                var a1 = teShuCard.splice(0, 5);

                var a2 = teShuCard.splice(0, 5);

                cc.teShuPaiCards = [teShuCard, a2, a1];

                return true;
            }
        }
    }
    //return KQCard.isTongHuaShun(cards);
    return false;
};

// 是否是一条龙
KQCard.isLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }

    return KQCard.isShunZi(cards);
};

/*#####*/
/*是否一条龙*/
KQCard.isYiTiaoLong = function (cards) {
    //cards:{number:1~13 ,'suit':'h'...}
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].number == 'undefined') {
        cards = KQCard.convertToServerCards(cards);
    }
    var number = cards.map(function (card) {
        return card.number;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });
    for (var i = 0; i < cards.length - 1; i++) {
        if (number[i] != number[i + 1] - 1) {
            return false;
        }
    }

    var teShuCard = cards.filter(function (i) {
        return i;
    });

    teShuCard = KQCard.cardsFromArray(teShuCard);

    teShuCard.forEach(function (a) {
        if (a.scores == 1) a.scores = 14;
    });

    teShuCard.sort(function (a, b) {
        return b.scores - a.scores;
    });

    teShuCard = KQCard.convertToServerCards(teShuCard);

    var a1 = teShuCard.splice(0, 5);

    var a2 = teShuCard.splice(0, 5);

    cc.teShuPaiCards = [teShuCard, a2, a1];
    //cc.log(cc.teShuPaiCards )
    //cc.log('--------728')
    return true;
};
/*#####*/
/*是否三同花*/
KQCard.isSanTongHua = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == "undefined") {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var sanCard = [colorS, colorH, colorC, colorD];
    var teShuCard = [];
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
            teShuCard.push(sanCard[i]);
        }
    }

    //三种花色
    if (colorSum.length == 3) {
        for (var i = 0; i < colorSum.length; i++) {
            if (colorSum[i] != 5 && colorSum[i] != 3) {
                return false;
            }
        }
        teShuCard.sort(function (a, b) {
            return a.length - b.length;
        });
        cc.teShuPaiCards = teShuCard;
        return true;
    }
    return false;
};
/*是否凑一色*/
KQCard.isCouYiSe = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's' || cards[i].suit == 'c') {
            colorS.push(cards[i]); //全黑
        } else if (cards[i].suit == 'h' || cards[i].suit == 'd') {
                colorH.push(cards[i]); //全红
            }
    }

    //如果牌中包含四种花色就不可能是三同花
    if (colorS.length == 13 || colorH.length == 13) {
        return true;
    }
    //else if(colorH.length == 13){
    //    return true;
    //}
    return false;
};
/*#####*/
// 是否是六对半
KQCard.isLiuDuiBan = function (cards) {
    var length = 12;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfYi = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength || value == 3) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value == 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        }
        //else if (value == 6 || value == 7 || value == 5) {
        //    numberOfDuiZi = numberOfDuiZi + 0;
        //}
        else if (value == 1) {
                numberOfYi += 1;
            }
    }

    if (numberOfDuiZi == 6) {

        var teShuCard = cards.filter(function (i) {
            return i;
        });

        teShuCard = KQCard.cardsFromArray(teShuCard);

        teShuCard.forEach(function (a) {
            if (a.scores == 1) a.scores = 14;
        });

        teShuCard.sort(function (a, b) {
            return b.scores - a.scores;
        });

        teShuCard = KQCard.convertToServerCards(teShuCard);

        var a1 = teShuCard.splice(0, 5);

        var a2 = teShuCard.splice(0, 5);

        cc.teShuPaiCards = [teShuCard, a2, a1];

        return true;
    }
    return false;
};

KQCard.isWuDuiSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    var sanTiaoLength = 3;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfSanTiao = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        } else if (value >= 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        }
    }
    return numberOfDuiZi == 5 && numberOfSanTiao == 1;
};

//判断5张或者3张是否顺子
KQCard.isShunZi1 = function (arr) {
    //console.log(arr);
    for (var i = 0; i < arr.length - 1; i++) {
        if (arr[i + 1] - arr[i] != 1) {
            //不是顺子
            //console.log("不是顺子");
            return false;
        }
    }
    return true;
};

KQCard.isSanShunZi = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }

    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }

    //取出牌的点数
    var number = cards.map(function (card) {
        return card.number;
    });
    //排序
    number.sort(function (n1, n2) {
        return n1 - n2;
    });
    if (KQCard.fenZhu(number, 5, 5) == false) {
        var number = cards.map(function (card) {
            return card.number;
        });
        //排序
        number.sort(function (n1, n2) {
            return n1 - n2;
        });
        if (KQCard.fenZhu(number, 5, 3) == false) {
            var number = cards.map(function (card) {
                return card.number;
            });
            //排序
            number.sort(function (n1, n2) {
                return n1 - n2;
            });
            if (KQCard.fenZhu(number, 3, 5) == false) {
                //不是三顺子
                var AIsExist = false; //是否存在A
                for (var i in cards) {
                    if (cards[i].number == 1) {
                        AIsExist = true;
                        //console.log("存在A");
                        break;
                    }
                }
                if (!AIsExist) {
                    //console.log("退出递归");
                    return false;
                }

                for (var i in cards) {
                    if (cards[i].number == 1) {
                        //console.log("A转为14");
                        cards[i].number = 14;
                        break;
                    }
                }
                if (cc.teShuPaiCards && cc.teShuPaiCards.length > 0 && cc.teShuPaiCards[0][0] && typeof cc.teShuPaiCards[0][0] == 'number') {
                    var newCards = cards.filter(function (i) {
                        return i;
                    });
                    var newCards1 = cc.teShuPaiCards.map(function (arr) {
                        var cad = arr.map(function (number) {
                            for (var i = 0; i < newCards.length; i++) {
                                if (newCards[i].number == number) {
                                    return newCards.splice(i, 1)[0];
                                    break;
                                }
                            }
                        });
                        return cad;
                    });
                    cc.teShuPaiCards = newCards1;
                }
                return KQCard.isSanShunZi(cards);
            }
        }
    }
    if (cc.teShuPaiCards && cc.teShuPaiCards.length > 0 && cc.teShuPaiCards[0][0] && typeof cc.teShuPaiCards[0][0] == 'number') {
        var newCards = cards.filter(function (i) {
            return i;
        });
        var newCards1 = cc.teShuPaiCards.map(function (arr) {
            var cad = arr.map(function (number) {
                for (var i = 0; i < newCards.length; i++) {
                    if (newCards[i].number == number) {
                        return newCards.splice(i, 1)[0];
                        break;
                    }
                }
            });
            return cad;
        });
        cc.teShuPaiCards = newCards1;
    }
    return true;
};

//分组553||535||355
KQCard.fenZhu = function (number, num1, num2) {
    var arr1 = [];
    var arr2 = [];
    var arr3 = [];
    for (var i = 0; i < number.length - 1; i++) {
        if (i == 0) {
            arr1.push(number[0]);
        }
        if (number[i + 1] - number[i] == 0) {
            continue;
        }
        arr1.push(number[i + 1]);
        if (arr1.length == num1) {
            //取第一组是顺子
            if (KQCard.isShunZi1(arr1)) {
                //这5个是顺子,从数组中移除
                for (var i = 0; i < arr1.length; i++) {
                    for (var j = 0; j < number.length; j++) {
                        if (number[j] == arr1[i]) {
                            //两个数一样的只删除一个
                            if (number[j] == number[j + 1]) {
                                continue;
                            }
                            number.splice(j, 1); //从number中移除
                        }
                    }
                }
                /*console.log("删除第一组后的number");
                 console.log(number);*/
                //接下来取第二组
                for (var i = 0; i < number.length - 1; i++) {
                    if (i == 0) {
                        arr2.push(number[0]);
                    }
                    if (number[i + 1] - number[i] == 0) {
                        continue;
                    }
                    arr2.push(number[i + 1]);
                    if (arr2.length == num2) {
                        //取第二组是顺子
                        if (KQCard.isShunZi1(arr2)) {
                            for (var i = 0; i < arr2.length; i++) {
                                for (var j = 0; j < number.length; j++) {
                                    if (number[j] == arr2[i]) {
                                        //两个数一样的只删除一个
                                        if (number[j] == number[j + 1]) {
                                            continue;
                                        }
                                        number.splice(j, 1); //从number中移除
                                    }
                                }
                            }
                            /*console.log("删除第二组后的number");
                             console.log(number);*/
                            arr3 = number;
                            //接下来就是剩下的了
                            if (KQCard.isShunZi1(arr3)) {
                                //第三组也是顺子
                                var asdf = [arr1, arr2, arr3];

                                asdf.sort(function (n1, n2) {
                                    return n1.length - n2.length;
                                });

                                if (!cc.teShuPaiCards) cc.teShuPaiCards = asdf;

                                return true;
                            }
                            //第三组不是顺子
                            return false;
                        }
                        //第二组不是顺子
                        return false;
                    }
                }
            }
            //第一组不是顺子
            return false;
        }
    }
    //如果取不到num1个数
    if (arr1.length < num1) {
        return false;
    }
    if (arr2.length < num2) {
        return false;
    }
};

KQCard.isSanShunZi1 = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }

    cards = Array.from(cards);
    cards.sort(KQCard.sortByPoint);
    var wei = [];
    var zhong = [];
    var tou = [];
    var sanShunZi = KQCard.sanShunZi1(cards)[0]; //获取所有组合的头道
    if (!sanShunZi) {
        //你连头道都没有 怎么更我混
        return false;
    }

    var newCard = cards.filter(function (i) {
        //重新赋值cards
        return i;
    });
    var newCards1 = [];
    var newPoint = []; //判断point是否相同
    var duiZi = []; //取出有对子当中的一张牌
    for (var s in cards) {
        if (newPoint.indexOf(cards[s].point) < 0) {
            newCards1.push(cards[s]);
            newPoint.push(cards[s].point);
        } else {
            //取出有对子当中的一张牌
            duiZi.push(cards[s]);
        }
    }

    for (var j = 0; j < sanShunZi.length; ++j) {
        //循环所有头道
        var number3 = sanShunZi[j];
        if (typeof number3 == 'undefined') {
            continue;
        }
        for (var i = 0; i < cards.length; ++i) {
            var newCards = newCards1.filter(function (i) {
                //重新赋值cards
                return i;
            });

            newCards = newCards.kq_excludes(number3); //删除牌里的头道
            if (wei.length != 5) {
                var subCards = newCards.slice(i, i + 5);
                if (subCards.length == 5 || KQCard.isShunZi(subCards)) {
                    //得到尾道 删除牌里的尾道
                    wei = subCards;
                    // cc.log(number3)
                    // cc.log(newCards1)
                    // cc.log(subCards)
                    // cc.log(newCards)
                    // cc.log(i)
                    // cc.log('-----716')
                    newCards = newCards.kq_excludes(subCards);
                }
            }

            if (wei.length == 5) {
                //把剩余的牌和对子的单张合并
                var tasks = duiZi.filter(function (i) {
                    //重新赋值对子
                    return i;
                });
                tasks = tasks.kq_excludes(number3); //判断头道和对子的单张是否有相同 有的话就删除
                newCards = newCards.concat(tasks); //把剩余的牌和对子的单张合并
            }

            if (zhong.length != 5 && newCards.length == 5) {
                if (KQCard.isShunZi(newCards)) {
                    //是三顺子
                    zhong = newCards;
                }
            }
            if (wei.length == 5 && zhong.length == 5) {
                //是三顺子终止循环
                break;
            } else {
                //来吧 继续吧
                zhong = [];wei = [];tou = [];
            }
        }
        if (wei.length == 5 && zhong.length == 5) {
            //是三顺子终止循环
            tou = number3;
            break;
        } else {
            //来吧 继续吧
            zhong = [];wei = [];tou = [];
        }
    }

    cards = newCard;
    if (KQCard._isSanShunZi(tou, zhong, wei)) {
        //是三顺子
        tou = KQCard.convertToServerCards(tou);
        zhong = KQCard.convertToServerCards(zhong);
        wei = KQCard.convertToServerCards(wei);

        if (!cc.teShuPaiCards) cc.teShuPaiCards = [tou, zhong, wei];
        return true;
    }
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
        cards.forEach(function (a) {
            if (a.point == 14) a.point = 1;
        });
        //return false;
        return KQCard.isSanShunZi1(cards);
    }
    return KQCard.isSanShunZi(convertedCards);
};

KQCard.sanShunZi1 = function (cards) {
    var length = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    var shunzi = KQCard.findShunZi(cards, length);
    var cardsT = [];
    var cardsIndex = [];
    if (shunzi == null) {
        return false;
    }
    for (var i = 0; i < shunzi.length; i++) {
        var a = shunzi[i];
        var cardsShunzi = [];
        // var cardsIndex = [];
        for (var j = 0; j < a.length; j++) {
            var index = a[j];
            if (typeof cards[index] == 'undefined') {
                continue;
            }
            cardsShunzi.push(cards[index]);
        }
        cardsIndex.push(a);
        cardsT.push(cardsShunzi);
    }
    return [cardsT, cardsIndex];
};

KQCard._isSanShunZi = function (touCards, zhongCards, weiCards) {
    return KQCard.isShunZi(touCards) && KQCard.isShunZi(zhongCards) && KQCard.isShunZi(weiCards);
};
// 是否是三同花顺
KQCard.isSanTongHuaShun = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorCardsObject = KQCard._colorClassCards(cards);

    var subCards = [];
    for (var prop in colorCardsObject) {
        var _cards = colorCardsObject[prop];
        subCards.push(_cards);
    }

    if (subCards.length != 3) {
        return false;
    }

    subCards = subCards.sort(function (s1, s2) {
        return s1.length > s2.length;
    });

    var touCards = subCards[0];
    var zhongCards = subCards[1];
    var weiCards = subCards[2];

    if (touCards.length != 3 || zhongCards.length != 5 || weiCards.length != 5) {
        return false;
    }

    return KQCard._isSanTongHuaShun(touCards, zhongCards, weiCards);
};

// 将牌根据 color 进行分类
KQCard._colorClassCards = function (cards) {
    var colorCardsObject = {};
    cards.forEach(function (card) {
        var color = card.color;
        var subCards = colorCardsObject[color];
        if (!subCards) {
            subCards = [];
            colorCardsObject[color] = subCards;
        }
        subCards.push(card);
    });

    return colorCardsObject;
};

// 是否是三同花顺
KQCard._isSanTongHuaShun = function (touCards, zhongCards, weiCards) {
    return KQCard.isTongHuaShun(touCards) && KQCard.isTongHuaShun(zhongCards) && KQCard.isTongHuaShun(weiCards);
};

// 是否是 “三分天下”
KQCard.isSanFenTianXia = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var tieZhiLength = 4;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfTieZhi = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == tieZhiLength) {
            numberOfTieZhi = numberOfTieZhi + 1;
        }
    }
    return numberOfTieZhi === 3;
};

// 是否是 “四套三条”
KQCard.isSiTaoSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var sanTiaoLength = 3;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfSanTiao = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        }
    }

    return numberOfSanTiao == 4;
};

// 是否是 “三桃花”
// 头、中、尾道为相同花色的牌
KQCard.isSanTaoHua = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorHelper = new KQCardColorsHelper(cards);
    var colorNumbers = [];
    for (var prop in colorHelper.colorNumber) {
        colorNumbers.push(colorHelper.colorNumber[prop]);
    }

    colorNumbers.sort(function (n1, n2) {
        return n1 - n2;
    });

    if (colorNumbers.length != 3) {
        return false;
    }

    if (colorNumbers[0] == 3 && colorNumbers[1] == 5 && colorNumbers[2] == 5) {
        return true;
    }

    return false;
};

// 判断是否包含铁支
// 四张同样点数的牌
KQCard.containTieZhi = function (cards) {
    var length = 4;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var helper = new KQCardPointsHelper(cards);

    for (var w in helper.pointNumbers) {
        var maxNumber = helper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}
    // else{
    //    return KQCard.containGuiPai(cards,4);
    //}
    //if (KQCard.findTieZhi(cards).length > 0) {
    //    return true;
    //}
    return false;
};

// 判断是否是铁支
KQCard.isTieZhi = function (cards) {
    var length = 4;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};

/*#####是否包含五同*/
//五张同样点数的牌
KQCard.containWuTong = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    //五张牌相同的
    var helper = new KQCardPointsHelper(cards);
    //for(var w in helper.pointNumbers) {
    //    cc.log(w)
    //}
    //cc.log(cards)
    //cc.log(helper)
    //cc.log(card20)
    //cc.log(helper.maxNumber())
    //cc.log('------1307')
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}
    for (var w in helper.pointNumbers) {
        var maxNumber = helper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return helper.maxNumber() >= length;
        }
    }
    return false;
};

/*判断是否五同*/
KQCard.isWuTong = function (cards) {
    var length = 5;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};
/*#####*/

// 是否是 “葫芦”
// 三张相同 + 一对
KQCard.containHuLu = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    if (KQCard.findHuLu(cards).length > 0) {
        return true;
    }
    //let pointHelper = new KQCardPointsHelper(cards);
    //var pointNumbers = [];
    //var index = 0;
    //for (let prop in pointHelper.pointNumbers) {
    //    pointNumbers[index] = pointHelper.pointNumbers[prop];
    //    index = index + 1;
    //}
    //var h=[];
    //var h1=[];
    //for(var i in pointNumbers){
    //    var s=pointNumbers[i];
    //    if(s == 3){
    //        h.push(s)
    //    }
    //    else if(s==4){
    //        h1.push(s)
    //    }
    //
    //}
    //
    //if ((pointNumbers.indexOf(3) != -1) && (pointNumbers.indexOf(2) != -1)
    // || h.length > 1 || h1.length > 1 ||(pointNumbers.indexOf(4) != -1)
    // && (pointNumbers.indexOf(2) != -1)) {
    //    return true;
    //}

    return false;
};

// 判断是否是 葫芦
KQCard.isHuLu = function (cards) {
    if (cards.length != 5) {
        return false;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (p1, p2) {
        return p1 - p2;
    });

    var p1 = points[0];
    var p2 = p1;
    var numberP1 = 0;
    var numberP2 = 0;

    points.forEach(function (point) {
        if (point != p1 && point != p2) {
            p2 = point;
            numberP2 = 0;
        }

        numberP1 = numberP1 + (point == p1 ? 1 : 0);
        numberP2 = numberP2 + (point == p2 ? 1 : 0);
    });

    var maxNumber = Math.max(numberP1);
    var minNumber = Math.min(numberP2);

    return minNumber == 2 && maxNumber == 3;
};

// 是否包含有 “三条”
KQCard.containSanTiao = function (cards) {
    var length = 3;
    if (cards.length < length) {
        return false;
    }
    //if (KQCard.findSanTiao(cards).length > 0) {
    //    return true;
    //}
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var pointHelper = new KQCardPointsHelper(cards);
    for (var w in pointHelper.pointNumbers) {
        var maxNumber = pointHelper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] >= length) {
    //        return true;
    //    }
    //}
    return false;

    //
    //return KQCard.containGuiPai(cards,3);
};

// 是否是 “三条”
KQCard.isSanTiao = function (cards) {
    if (cards.length != 3) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (card.point == point) {
            return point;
        }

        return -1;
    }, cards[0].point);

    return result != -1;
};

// 是否包含有 ：两对
KQCard.containLiaDui = function (cards) {
    if (cards.length < 4) {
        return false;
    }
    if (KQCard.findLiaDui(cards).length > 0) {
        return true;
    }
    //var numberOfDuiZi = 0;
    //let pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] == 2) {
    //        numberOfDuiZi = numberOfDuiZi + 1;
    //        if (numberOfDuiZi == 2) {
    //            return true;
    //        }
    //    }
    //}

    return false;
};

// 是否是 两对
KQCard.isLiaDui = function (cards) {
    if (cards.length != 4) {
        return false;
    }

    var pointHelper = new KQCardPointsHelper(cards);
    for (var prop in pointHelper.pointNumbers) {
        if (pointHelper.pointNumbers[prop] != 2) {
            return false;
        }
    }
    return true;
};

// 是不是对子
KQCard.isDuiZi = function (cards) {
    if (cards.length != 2) {
        return false;
    }

    var card1 = cards[0];
    var card2 = cards[1];

    return card1.point == card2.point;
};

// 是否包含对子
KQCard.containDuiZi = function (cards) {
    var length = 2;
    if (cards.length < length) {
        return false;
    }
    //if (KQCard.findDuiZi(cards).length > 0) {
    //    return true;
    //}
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] >= length) {
    //        return true;
    //    }
    //}
    for (var w in pointHelper.pointNumbers) {
        var maxNumber = pointHelper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    return false;
    //return KQCard.containGuiPai(cards,2);
};

KQCard.containGuiPai = function (cards, length) {
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    var helper = new KQCardPointsHelper(cards);
    var maxNumber = helper.maxNumber() + card20.length;
    return maxNumber >= length;
};
/*#####*/
// 是否是特殊牌
KQCard.isTeShuPai = function (cards) {
    if (cards.length < 13) {
        return false;
    }

    return KQCard.isQingLong(cards) || KQCard.isYiTiaoLong(cards) || KQCard.isLiuDuiBan(cards) || KQCard.isSanShunZi(cards) || KQCard.isSanTongHua(cards)
    /*|| KQCard.isSanTongHuaShun(cards)
     || KQCard.isSanFenTianXia(cards)
     || KQCard.isSiTaoSanTiao(cards)
      || KQCard.isWuDuiSanTiao(cards)
     || KQCard.isCouYiSe(cards)*/;
};

// 将牌中的 1 变化为 A（14)
KQCard._convertOneToA = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var result = cards.map(function (card) {
        if (card.point == 1) {
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

KQCard._convertOneToA1 = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var num = 0;
    var result = cards.map(function (card) {
        if (card.point == 1 && num == 0) {
            num++;
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

// KQCard 的排序方法
KQCard.sortByPoint = function (card1, card2) {
    var result = Number(card1.point) - Number(card2.point);
    return result;
};

KQCard.sortByColor = function (card1, card2) {
    var pointAsc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (card2.color == card1.color) {
        return (card1.point - card2.point) * (pointAsc ? 1 : -1);
    }
    return card2.color - card1.color;
};

KQCard.sort = function (card1, card2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];
    var AisMax = arguments.length <= 3 || arguments[3] === undefined ? true : arguments[3];

    var result = 1;
    if (card1.point == card2.point) {
        result = card1.color - card2.color;
    } else {
        var point1 = card1.point;
        var point2 = card2.point;
        if (AisMax && point1 == 1) {
            point1 = 14;
        }

        if (AisMax && point2 == 1) {
            point2 = 14;
        }

        result = point1 - point2;
    }

    return result * (asc ? 1 : -1);
};

//转为客户端的牌
KQCard._convertCardsToCardNames = function (cards) {
    // [{"suit":"s","number":10}]
    var suitColorMap = ['', 'd', 'c', 'h', 's'];
    return cards.map(function (card) {
        var cardNumber = card.point;
        var color = suitColorMap[card.color];
        var number = Math.max(Math.min(cardNumber, 13), 1);
        return { number: number, suit: color };
    });
};

cc._RFpop();
},{"GetCardPointsSameCount":"GetCardPointsSameCount","KQCardColorsHelper":"KQCardColorsHelper","KQCardPointsHelper":"KQCardPointsHelper","NumberExtension":"NumberExtension"}],"KQGlabolSocketEventHander":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'babea3CWj9G1pWM9AkXao0n', 'KQGlabolSocketEventHander');
// scripts\Socket\KQGlabolSocketEventHander.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var KQGlabolSocketEventHander = {
    start: function start() {
        if (this._didStart) {
            return;
        }
        this._didStart = true;

        KQGlobalEvent.on(Socket.Event.ReceiveForceExit, this._forceExitApp, this);
    },

    _forceExitApp: function _forceExitApp(response) {
        KQNativeInvoke.forceExitApp();
    }
};

module.exports = KQGlabolSocketEventHander;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","socket":"socket"}],"KQGlobalEvent":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd90d6OrggVEXa29ffA+vZY0', 'KQGlobalEvent');
// scripts\Event\KQGlobalEvent.js

var KQGlobalEvent = {
    _handles: {},
    //发送事件
    emit: function emit(eventName) {
        var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

        if (typeof data == 'string') {
            data = { 'data': data };
        }

        var returns = []; //返回值
        data.eventName = eventName; //保存一下事件名字

        for (var findEvenName in this._handles) {
            if (findEvenName == eventName) {
                for (var i = 0; i < this._handles[findEvenName].length; i++) {
                    var returnValue = this._handles[findEvenName][i](data);
                    returns.push(returnValue);
                }
            }
        }

        return returns;
    },
    //添加普通事件
    on: function on(eventName, callback, target) {
        // console.log('收到事件', eventName);
        this._handles[eventName] = this._handles[eventName] || [];

        this._handles[eventName].push(callback.bind(target));
        callback._caller = target;
    },

    //通过事件名移除一个监听器
    off: function off(eventName) {
        for (var i = 0; i < this._handles[eventName].length; i++) {
            this._handles[eventName][i] = null;
        }
    },

    // 移动一个 target 上所有的监听
    offTarget: function offTarget(target) {
        for (var name in this._handles) {
            var eventHandlers = this._handles[name];
            var indexs = eventHandlers.filter(function (callback) {
                return callback._caller = target;
            }).map(function (callback, index) {
                return index;
            });

            var indexOffset = 0;
            indexs.forEach(function (index) {
                eventHandlers.splice(index + indexOffset, 1);
                indexOffset = indexOffset + 1;
            });
        }
    }
};

module.exports = KQGlobalEvent;

cc._RFpop();
},{}],"KQNativeInvoke":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7327dLBqWVNaJ14fJQ4jq6Y', 'KQNativeInvoke');
// scripts\Utils\KQNativeInvoke.js

var KQNativeInvoke = {
  IOSClassName: "AppController",
  ANDRIODClassName: "com/gongpa/ssz/AppActivity",

  isNativeIOS: function isNativeIOS() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.IPHONE || platform == cc.sys.IPAD) {
      return true;
    }
    return false;
  },

  isNativeAndroid: function isNativeAndroid() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.ANDROID) {
      return true;
    }
    return false;
  },

  isNative: function isNative() {
    return cc.sys.isNative == true;
  }
};

// MARK: 可调用的本地方法
/**
 * 微信登录
 */
KQNativeInvoke.wxLogin = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
  } else if (KQNativeInvoke.isNativeAndroid()) {
      //Android
      jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
    }
};

/**
 * 分享大厅信息到微信好友
 * 
 */
KQNativeInvoke.shareHallToWeChatFriend = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallFriend", "()V");
  }
};

/**
 * 分享大厅信息到朋友圈
 * 
 */
KQNativeInvoke.shareHallToWeChatTimeline = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", "()V");
  }
};

/**
 * 强制退出 APP
 * 
 */
KQNativeInvoke.forceExitApp = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
  }
};

/**
 * 下载新版本
 * 
 * @param {String} iosUrl      iOS 版本地址
 * @param {String} androidUrl  安卓版本地址
 */
KQNativeInvoke.downloadNewVersion = function (iosUrl, androidUrl) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", iosUrl);
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", androidUrl);
  }
};

/**
 * 分享房间给微信好友
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatFriend = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V", id, description, title);
  }
};

/**
 * 分享房间到微信朋友圈
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatTimeline = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShare:description:", id, description, title);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShare", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V", id, description, title);
  }
};

/**
 * 分享屏幕截图到微信好友
 */
KQNativeInvoke.shareScreenToWeChatFriend = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShareFriend", "()V");
  }
};

/**
 * 分享屏幕截图到微信朋友圈
 */
KQNativeInvoke.shareScreenToWeChatTimeline = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
  }
};

/**
 * 开始录音
 */
KQNativeInvoke.startRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
  }
};

/**
 * 结束录音
 */
KQNativeInvoke.endRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
  }
};

KQNativeInvoke.screenshotShare = function () {
  var strings = arguments.length <= 0 || arguments[0] === undefined ? 'shareIMG' : arguments[0];

  if (this._isCapturing) {
    return;
  }
  this._isCapturing = true;
  var size = cc.director.getWinSize();
  var fileName = "result_share.jpg";
  var fullPath = jsb.fileUtils.getWritablePath() + fileName;
  if (jsb.fileUtils.isFileExist(fullPath)) {
    jsb.fileUtils.removeFile(fullPath);
  }
  var texture = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height), cc.IMAGE_FORMAT_PNG, gl.DEPTH24_STENCIL8_OES);
  texture.setPosition(cc.p(size.width / 2, size.height / 2));
  texture.begin();
  cc.director.getRunningScene().visit();
  texture.end();
  texture.saveToFile(fileName, cc.IMAGE_FORMAT_PNG);

  var self = this;
  var tryTimes = 0;
  var fn = function fn() {
    if (jsb.fileUtils.isFileExist(fullPath)) {

      if (cc.sys.os == cc.sys.OS_ANDROID) {
        jsb.reflection.callStaticMethod(self.ANDRIODClassName, strings, "(Ljava/lang/String;)V", fullPath);
      }
      self._isCapturing = false;
    } else {
      tryTimes++;
      if (tryTimes > 10) {
        console.log("time out...");
        return;
      }
      setTimeout(fn, 50);
    }
  };
  setTimeout(fn, 50);
};

/**
 * 播放网络语音
 * 
 * @param {String} audioUrl 语音地址
 */
KQNativeInvoke.playAudioWithUrl = function (audioUrl) {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", audioUrl);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", audioUrl);
  }
};

module.exports = KQNativeInvoke;

cc._RFpop();
},{}],"ListViewCtrl":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c0b5azvmzNLQacfqQKNHMNQ', 'ListViewCtrl');
// scripts\ListViewCtrl.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
cc.Class({
    'extends': cc.Component,

    properties: {
        item: { // item template to instantiate other items
            'default': null,
            type: cc.Node
        },
        scrollView: {
            'default': null,
            type: cc.ScrollView
        },
        spawnCount: 0, // how many items we actually spawn
        totalCount: 0, // how many items we need for the whole list
        spacing: 0, // space between each item
        bufferZone: 0, // when item is away from bufferZone, we relocate it
        //btnAddItem: cc.Button,
        //btnRemoveItem: cc.Button,
        //btnJumpToPosition: cc.Button,
        //lblJumpPosition: cc.Label,
        //lblTotalItems: cc.Label,
        daikaiList: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.content = this.scrollView.content;
        this.items = []; // array to store spawned items
        this._registerSocketEvent();
        Socket.sendGetDaiKaiFang(Socket.instance.userInfo.id);
        this.updateTimer = 0;
        this.updateInterval = 0.2;
        this.lastContentPosY = 0; // use this variable to detect if we are scrolling up or down
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveGetDaiKaiDesk, this._getDaikaiRoomSocketCallback, this);
    },

    _getDaikaiRoomSocketCallback: function _getDaikaiRoomSocketCallback(response) {
        console.log("JSON.stringify(response.data.daikaiList)=====" + JSON.stringify(response.data.daikaiList));
        if (response.result) {
            var jslength = 0;

            var daikaiList = response.data.daikaiList;
            this.daikaiList = daikaiList;
            for (var js2 in daikaiList) {
                this.daikaiList.id = jslength;
                jslength++;
            }
            this.totalCount = jslength;
            this.items = [];
            this.content.removeAllChildren(true);
            this.initialize();
        }
    },

    initialize: function initialize() {
        this.content.height = this.totalCount * (this.item.height + this.spacing) + this.spacing; // get total content height
        //for (let i = 0; i < this.spawnCount; ++i) { // spawn items, we only need to do this once
        for (var i = 0; i < this.totalCount; ++i) {
            // spawn items, we only need to do this once
            var item = cc.instantiate(this.item);
            this.content.addChild(item);
            if (this.daikaiList && this.daikaiList.length > 0) {
                item.setPosition(0, -item.height * (0.5 + i) - this.spacing * (i + 1));
                item.getComponent('Item').updateItem(this.daikaiList[i]);
                this.items.push(item);
            }
        }
    },

    getPositionInView: function getPositionInView(item) {
        // get item position in scrollview's node space
        // let worldPos = item.parent.convertToWorldSpaceAR(item.position);
        var worldPos = item.convertToWorldSpaceAR(item.position);
        var viewPos = this.scrollView.node.convertToNodeSpaceAR(worldPos);
        //return item.getPosition();

        return viewPos;
    },

    update: function update(dt) {
        this.updateTimer += dt;
        if (this.updateTimer < this.updateInterval) return; // we don't need to do the math every frame
        this.updateTimer = 0;
        var items = this.items;
        var buffer = this.bufferZone;
        var isDown = this.scrollView.content.y < this.lastContentPosY; // scrolling direction
        var offset = (this.item.height + this.spacing) * items.length;
        for (var i = 0; i < items.length; ++i) {
            var viewPos = this.getPositionInView(items[i]);
            if (isDown) {
                // if away from buffer zone and not reaching top of content
                if (viewPos.y < -buffer && items[i].y + offset < 0) {
                    items[i].setPositionY(items[i].y + offset);
                    var item = items[i].getComponent('Item');
                    var itemId = item.itemID - items.length; // update item id
                    if (this.daikaiList && this.daikaiList.length > 0) {
                        item.updateItem(this.daikaiList[i]);
                    }
                }
            } else {
                // if away from buffer zone and not reaching bottom of content
                if (viewPos.y > buffer && items[i].y - offset > -this.content.height) {
                    items[i].setPositionY(items[i].y - offset);
                    var item = items[i].getComponent('Item');
                    var itemId = item.itemID + items.length;
                    if (this.daikaiList && this.daikaiList.length > 0) {
                        item.updateItem(this.daikaiList[i]);
                    }
                }
            }
        }
        // update lastContentPosY
        this.lastContentPosY = this.scrollView.content.y;
        //this.lblTotalItems.textKey = "Total Items: " + this.totalCount;
        // this.lblScrollEvent.string = "Total Items: " + items.length;
    },

    scrollEvent: function scrollEvent(sender, event) {
        //switch(event) {
        //    case 0:
        //       this.lblScrollEvent.string = "Scroll to Top";
        //       break;
        //    case 1:
        //       this.lblScrollEvent.string = "Scroll to Bottom";
        //       break;
        //    case 2:
        //       this.lblScrollEvent.string = "Scroll to Left";
        //       break;
        //    case 3:
        //       this.lblScrollEvent.string = "Scroll to Right";
        //       break;
        //    case 4:
        //       this.lblScrollEvent.string = "Scrolling";
        //       break;
        //    case 5:
        //       this.lblScrollEvent.string = "Bounce Top";
        //       break;
        //    case 6:
        //       this.lblScrollEvent.string = "Bounce bottom";
        //       break;
        //    case 7:
        //       this.lblScrollEvent.string = "Bounce left";
        //       break;
        //    case 8:
        //       this.lblScrollEvent.string = "Bounce right";
        //       break;
        //    case 9:
        //       this.lblScrollEvent.string = "Auto scroll ended";
        //       break;
        //}
    },

    addItem: function addItem() {
        this.content.height = (this.totalCount + 1) * (this.item.height + this.spacing) + this.spacing; // get total content height
        this.totalCount = this.totalCount + 1;
    },

    removeItem: function removeItem() {
        if (this.totalCount - 1 < 30) {
            cc.error("can't remove item less than 30!");
            return;
        }

        this.content.height = (this.totalCount - 1) * (this.item.height + this.spacing) + this.spacing; // get total content height
        this.totalCount = this.totalCount - 1;
    },

    scrollToFixedPosition: function scrollToFixedPosition() {
        this.scrollView.scrollToOffset(cc.p(0, 500), 2);
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"MsgControl":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd242dsY+hBG5LpL7ZF7Kn6', 'MsgControl');
// scripts\Chat\MsgControl.js

var Socket = require('socket');
var ChatMessage = require('ChatMessage');
var AudioManager = require('AudioManager');

// 用来发送消息的 component
cc.Class({
    'extends': cc.Component,

    properties: {
        //bqNode:cc.Node,
        //bqNode1:cc.Node,
        //btnLanguageNode:cc.Node,
        //btnLanguageNode1:cc.Node,
        //btnChartNode:cc.Node,
        //btnChartNode1:cc.Node,
        textScrollView: cc.Node,
        imageContentNode: cc.Node,

        editBox: cc.EditBox,

        textRecordScrollView: cc.ScrollView,
        textRecordLayout: cc.Layout,

        textPrefab: cc.Prefab,
        chatTextRecordPrefab: cc.Prefab,
        emojiPrefab: cc.Prefab,
        // imagePrefab:cc.Prefab,

        biaoqing: [cc.Node], // [亮的背景, 暗的背景]   快捷语
        kuaijieyu: [cc.Node], // [亮的背景, 暗的背景]   表情
        content: [cc.Node], // [快捷语, 表情]  
        inputNode: cc.Node,
        emoji: [cc.Node],
        _userId: null,

        _playerInfos: null, // 记录用户信息
        _chatTextMessageRecords: null },

    // 聊天文本消息记录
    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        this._playerInfos = [];
        this.textContent = this.textScrollView.getComponent(cc.ScrollView).content;
        // this.imageContent = this.imageScrollView.getComponent(cc.ScrollView).content;
        var self = this;
        var textData = AudioManager.instance.chatTexts();
        for (var i = 0; i < textData.length; i++) {
            var item = cc.instantiate(this.textPrefab);
            item.getComponent('cellText').setText(textData[i]);
            item.getComponent('cellText').onSelectAction = function (text) {
                self.onTextClickAction(text);
            };
            this.textContent.h = 1000;
            this.textContent.addChild(item);
        }
    },

    clickKuaiJieYu: function clickKuaiJieYu() {
        this.kuaijieyu[0].active = true; // 快捷语 背景
        this.kuaijieyu[1].active = false; // 快捷语 按钮
        this.biaoqing[0].active = false; // 背景表情
        this.biaoqing[1].active = true; // 表情按钮
        this.content[0].active = true;
        this.content[1].active = false;
    },
    clickBiaoQing: function clickBiaoQing() {
        this.biaoqing[0].active = true; // 背景表情
        this.biaoqing[1].active = false; // 表情按钮
        this.kuaijieyu[0].active = false; // 快捷语 背景
        this.kuaijieyu[1].active = true; // 快捷语 按钮
        this.content[0].active = false;
        this.content[1].active = true;
    },
    onTextClickAction: function onTextClickAction() {
        var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        this.editBox.string = "";
        this.sendText(text);
    },

    clickEmoji: function clickEmoji(event, emojiName) {
        var string = this.editBox.string;
        this.editBox.string = string + "<" + emojiName + ">";
        this.sendEmoji(emojiName);
    },

    clickSend: function clickSend() {
        var string = this.editBox.string || "";
        if (string.length == 0) {
            return;
        }
        this.editBox.string = "";
        this.sendText(string);
    },

    sendEmoji: function sendEmoji(emojiName) {
        if (emojiName.length == 0) {
            return;
        }
        Socket.sendEmoji(this._userId, emojiName);
        this.dismiss();
    },

    sendText: function sendText() {
        var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        if (text.length == 0) {
            return;
        }
        Socket.sendText(this._userId, text);
        this.dismiss();
    },

    dismiss: function dismiss() {
        this.node.active = false;
    },

    bqAction: function bqAction() {
        this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode1.active = true;
        this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode.active = false;
        this.textScrollView.active = false;
        this.imageContentNode.active = true;
        this.textRecordScrollView.node.active = false;
    },

    textAction: function textAction() {
        this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode.active = false;
        this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode1.active = true;
        this.textScrollView.active = true;
        this.imageContentNode.active = false;
        this.textRecordScrollView.node.active = false;
    },

    chartAction: function chartAction() {
        this.bqNode1.active = this.btnLanguageNode1.active = this.btnChartNode1.active = false;
        this.bqNode.active = this.btnLanguageNode.active = this.btnChartNode.active = true;
        this.textScrollView.active = this.imageContentNode.active = false;
        this.textRecordScrollView.node.active = true;
    },

    addPlayerInfos: function addPlayerInfos(playerInfos) {
        this._playerInfos = this._playerInfos || [];

        playerInfos.forEach((function (userInfo) {
            var haveUserInfo = this._playerInfos.find(function (ownUserInfo) {
                return ownUserInfo.id == userInfo.id;
            });

            if (haveUserInfo == null) {
                this._playerInfos.push(userInfo);
            }
        }).bind(this));
    },

    addChatTextMessage: function addChatTextMessage(userId, text) {
        this._playerInfos = this._playerInfos || [];

        var nickname = "[ID:" + userId + "说]：";
        var userInfo = this._playerInfos.find(function (userInfo) {
            return userInfo.id == userId;
        });

        if (userInfo) {
            nickname = "[" + userInfo.nickname + "说]：";
        }

        var str = nickname + text;
        str = ChatMessage.parseString(str);
        this._addChatTextToRecord(str);
    },

    addChatEmojiMessage: function addChatEmojiMessage(userId, emoji) {
        this._playerInfos = this._playerInfos || [];

        var nickname = "[ID:" + userId + "说]：";
        var userInfo = this._playerInfos.find(function (userInfo) {
            return userInfo.id == userId;
        });
        if (userInfo) {
            nickname = "[" + userInfo.nickname + "说]：";
        };
        var str = nickname + emoji;
        str = ChatMessage.parseString(str);
        this._addChatEmojiToRecord(emoji);
        // cc.log(emoji)
        // cc.log('---190')
    },

    _addChatEmojiToRecord: function _addChatEmojiToRecord(emoji) {
        var self = this;
        this._loadEmojiFrame(emoji, function (frame) {
            //var item  = cc.instantiate(self.emojiPrefab);
            //cc.log(frame)
            //var btnSprites =  item.getComponent(cc.Sprite);
            //btnSprites.spriteFrame = frame;
            //let chatEmojiRecord = item.getComponent('ChatTextRecord');
            //chatEmojiRecord.setEmoji(frame);
            ChatMessage.setEmoji(frame);
        });
    },

    _loadEmojiFrame: function _loadEmojiFrame(Emojiname, callback) {
        cc.loader.loadRes("/textures/chat/bq", cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                //console.log(null, err)
                return;
            }
            var frame = atlas.getSpriteFrame(Emojiname);
            callback(frame);
        }).bind(this));
    },

    _addChatTextToRecord: function _addChatTextToRecord(text) {
        var item = cc.instantiate(this.chatTextRecordPrefab);
        var chatTextRecord = item.getComponent('ChatTextRecord');
        chatTextRecord.setString(text);

        this.textRecordLayout.node.addChild(item);
        this.textRecordScrollView.scrollToBottom();
    }
});

cc._RFpop();
},{"AudioManager":"AudioManager","ChatMessage":"ChatMessage","socket":"socket"}],"NetworkError":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c99d35Sy6hDPbrte9nVczxP', 'NetworkError');
// scripts\NetworkError.js

var manager = require('manager');
var KQNativeInvoke = require('KQNativeInvoke');

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    exitAction: function exitAction() {
        cc.director.end();
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"NumberExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '80e21gZRpNM4pIiCpZ+7s8m', 'NumberExtension');
// scripts\Extensions\NumberExtension.js

// number.kq_times(f)   调用多次

if (!Number.prototype.kq_times) {

    /**
     * 调用一个方法 this 次
     * 
     * @param  {Function} f 要调用的方法
     * @param  {Object}   thisArg   可选； f 的 this值
     */
    Number.prototype.kq_times = function (f, thisArg) {
        if (!f) {
            return;
        }

        for (var i = 0; i < this; ++i) {
            if (thisArg) {
                f.apply(thisArg, i);
            } else {
                f(i);
            }
        }
    };
}

cc._RFpop();
},{}],"Playback":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0d3095dnBVFo5D1hEDDa5KQ', 'Playback');
// scripts\Playback\Playback.js

var Socket = require('socket');

// 用于回放的组件
var Playback = cc.Class({
  'extends': cc.Component,

  properties: {
    _playbackDatas: null, // 用于回放的数据
    _isPlaybacking: false
  },

  statics: {
    instance: null
  },

  onLoad: function onLoad() {
    Playback.instance = this;
    cc.game.addPersistRootNode(this.node);
  },

  // 设置回放数据
  setPlaybackDatas: function setPlaybackDatas(datas) {
    this._playbackDatas = datas;
  },

  // 清空回放数据。同时会清空回放
  removePlaybackDatas: function removePlaybackDatas() {
    this.setPlaybackDatas(null);
    this.stopPlayback();
  },

  // 是否包含回放数据
  isContainPlaybackDatas: function isContainPlaybackDatas() {
    return this._playbackDatas != null;
  },

  // 开始回放
  startPlayback: function startPlayback() {
    // 模拟 socket 接收到了事件即可
    //cc.log("Playback 开始回放");

    this._isPlaybacking = true;

    if (!this._playbackDatas) {
      cc.error("想回放，却没有回放数据");
      this.stopPlayback();
      return;
    }

    this._executePlayback();
  },

  // 停止回放
  stopPlayback: function stopPlayback() {
    this._isPlaybacking = false;
    this.unscheduleAllCallbacks();
  },

  // 是否正在回放
  isPlaybacking: function isPlaybacking() {
    return this._isPlaybacking;
  },

  // 执行真正的回放操作
  _executePlayback: function _executePlayback() {
    var startTime = 1.0;
    var interval = 3.0;
    cc.log(this._playbackDatas);

    // 在某些特殊情况下
    // 回放数据里会包含两套 gameOver action
    // 所以需要过滤掉其中一个
    this._playbackDatas = this._playbackDatas.filter((function (string, index) {
      if (index == this._playbackDatas.length - 1) {
        return true;
      }

      return string.indexOf('"action":"gameOver') == -1;
    }).bind(this));

    this._playbackDatas.forEach((function (data, index) {
      var delay = startTime + index * interval;
      if (index == this._playbackDatas.length - 1) {
        // 如果是最后一个，则应该只间隔一秒
        delay = startTime + (index - 1) * interval + 1;
      }

      this.scheduleOnce(function () {
        cc.log("回放开始模拟 Socket 接收到服务器消息, ", index);
        Socket.instance._dispatchResponse(data);
      }, delay);
    }).bind(this));
  }

});

module.exports = Playback;

cc._RFpop();
},{"socket":"socket"}],"Player":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6ffa0O02PFOp78QADTW5zGf', 'Player');
// scripts\Play\Player.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
var KQCardResHelper = require('KQCardResHelper');
var KQCard = require('KQCard');
var AudioManager = require('AudioManager');

cc.Class({
    'extends': cc.Component,

    properties: {
        foldCardNode: cc.Node, // 牌盖着时的样子
        teShuPaiNode: cc.Node, // 特殊牌盖着时的样子
        cardsBackLayout: cc.Layout, // 13张牌背影，可用来展示发牌动画 含 cardsBack Component
        compareCardsNode: cc.Node, // compareCards   含 CompareCards Component
        userInfoNode: cc.Node, // 包含用户信息 含 userInfo Component
        chatMessageNode: cc.Node, // 聊天消息 包含 ChatMessage Component
        userAvatarNode: cc.Node,
        //userSampleInfoNode: cc.Node,
        bulletHolePrefab: cc.Prefab, //中枪
        bulletHoleNode: cc.Node, //中枪
        shotNode: [cc.Node], //打枪
        userId: 0,
        cardTypePrefab: cc.Prefab,
        // 用户信息
        // 1、 如果 包含：cardInfo:[]，表明用户已经出牌
        //
        _userInfo: null,
        _deskInfo: null,
        /**/
        playedCompareCardsIndexs: {
            visible: false,
            'default': undefined
        }
        /**/
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.userAvatarNode.on(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
        this.reset();
        this.foldCardNodeBack = false; //判断是否点击了拍的背影
        this.cardSpriteAtlas = this.node.parent.getComponent('play').cardSpriteAtlas;
    },

    onDestroy: function onDestroy() {
        this.userAvatarNode.off(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
    },

    click_leave: function click_leave() {
        var userid = Socket.instance.userInfo.id;
        var leaveId = this._userInfo.id;
        Socket.sendQingli(leaveId, userid);
    },

    _showUserInfo: function _showUserInfo() {
        //this.userSampleInfoNode.getComponent('UserSampleInfo').updateWithUser(this._userInfo);
    },

    reset: function reset() {
        this.foldCardNode.active = false;
        this.cardsBackLayout.active = false;
        this.compareCardsNode.active = false;
        this.teShuPaiNode.active = false;
        this.bulletHoleNode.active = false;
        this.bulletHoleNode.removeAllChildren();
        this.bulletHoleNode.children.forEach(function (node) {
            node.active = false;
        });
        if (this.shotNode.length > 0) this.shotNode.forEach(function (node) {
            if (node) node.active = false;
        });
        this.compareCardsNode.getComponent('CompareCards').reset();
        this.compareCardsNode.getComponent('CompareCards').unscheduleAllCallbacks();
    },

    /*####*/
    reset2: function reset2() {
        this.foldCardNode.active = false;
        this.cardsBackLayout.active = false;
        this.teShuPaiNode.active = false;
        this.bulletHoleNode.active = false;
        this.bulletHoleNode.removeAllChildren();
        this.bulletHoleNode.children.forEach(function (node) {
            node.active = false;
        });
        if (this.shotNode.length > 0) this.shotNode.forEach(function (node) {
            if (node) node.active = false;
        });
        //this.compareCardsNode.active = false;
        //this.compareCardsNode.getComponent('CompareCards').reset();
    },
    /*#####*/

    updateUserInfoWithUsers: function updateUserInfoWithUsers(users) {
        var user = users.find((function (e) {
            return this.userId == e.id;
        }).bind(this));

        this.updateUserInfo(user);
    },
    showQingli: function showQingli(creator, index) {
        if (!this.node.active) {
            return;
        }
        if (index > 0) {
            this.userInfoNode.getComponent('userInfo').setqingli(false);
        } else {
            if (creator) {
                this.userInfoNode.getComponent('userInfo').setqingli(false);
            } else {
                this.userInfoNode.getComponent('userInfo').setqingli(true);
            }
        }
    },
    updateUserInfo: function updateUserInfo(user) {
        this._userInfo = user;
        this.node.active = user != null;
        this.userInfoNode.active = this.node.active;
        if (!user) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.updateAvatar(user.avatarUrl);
        userInfo.updateUserId(user.id);
        userInfo.updateNickname(user.nickname);
        userInfo.setOfflineVisible(!user.onlineStatus);

        //if (this._deskInfo && this._deskInfo.cIndex > 0) {
        //  if (UserModelHelper.isPlayedCards(user)) {
        //    this.playCard(user.id);
        //    this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
        //  }
        //}
        /**/
        var cIndex = this._deskInfo.cIndex;
        if (this._deskInfo && cIndex > 0 && this.playedCompareCardsIndexs.indexOf(cIndex) == -1) {
            if (UserModelHelper.isPlayedCards(user)) {
                this.playCard(user.id, user.cardInfo);
                this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
            }
        }
        /**/
    },

    // 更新房主信息
    updateBanker: function updateBanker() {
        var userInfoComp = this.userInfoNode.getComponent('userInfo');
        if (!this._userInfo) {
            userInfoComp.setIsBanker(false);
            return;
        }

        var isBanker = this._userInfo ? this._userInfo.isBanker : false;
        userInfoComp.setIsBanker(isBanker);
    },

    showFangZhuStatus: function showFangZhuStatus(createId) {
        var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (!this.node.active) {
            return;
        }
        if (this._userInfo.id == createId) {
            this.userInfoNode.getComponent('userInfo').setFangZhuNodeVisible(visible);
        }
    },

    /**
     * 更新分数
     *
     * @param {Number} score 用户分数、可选
     */
    updateScore: function updateScore(score) {
        if (!score && this._userInfo) {
            score = this._userInfo.totalScore;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.updateScore(score);
    },

    showReadyStatus: function showReadyStatus(userId) {
        var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (!this.node.active) {
            return;
        }

        if (this._userInfo.id == userId) {
            this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(visible);
        }
    },
    showBeilv: function showBeilv(userId, bl) {
        if (!this.node.active) {
            return;
        }
        if (this._userInfo.id == userId) {
            this.userInfoNode.getComponent('userInfo').setBeilvLabel(bl);
        }
    },
    /*setDeskInfo: function (deskInfo) {
     this._deskInfo = deskInfo;
     },*/
    updateDeskInfo: function updateDeskInfo(deskInfo) {
        this._deskInfo = deskInfo;

        if (deskInfo && !deskInfo.isCBegin) {
            this.reset();
        }
    },
    /**/

    hideReadyStatus: function hideReadyStatus() {
        this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(false);
    },

    playFaPaiAnimation: function playFaPaiAnimation() {
        if (!this.node.active) {
            return;
        }
        if (UserModelHelper.isPlayedCards(this._userInfo)) {
            return;
        }
        var cardsBack = this.cardsBackLayout.getComponent('cardsBack');
        cardsBack.showPlayCardBacks();
    },

    shouldShowFaPaiAnimation: function shouldShowFaPaiAnimation() {
        return UserModelHelper.isPlayedCards(this._userInfo);
    },

    setUserOnlineStatus: function setUserOnlineStatus(userId) {
        var status = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.setOfflineVisible(status != 1);
    },

    showChatText: function showChatText(userId, message) {
        if (userId != this.userId) {
            return;
        }

        var chatMessage = this.chatMessageNode.getComponent('ChatMessage');
        chatMessage.setString(message);
    },

    // 用户已经出牌，处于三堆盖着牌的状态
    playCard: function playCard(userId, cardInfo) {
        if (this.userId != userId) {
            return;
        }

        this.cardsBackLayout.node.active = false;
        this.compareCardsNode.active = false;
        this.foldCardNode.targetOff(this.foldCardNode);
        this.foldCardNode.active = true;
        this.foldCardNode.children.slice(0, 3).forEach((function (node) {
            node.active = true;
            node.children.forEach((function (noe) {
                noe.active = true;

                var cardSprite = noe.getComponent('cc.Sprite');

                var path = 'public-pic-card-poker-back';

                this._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);
            }).bind(this));
        }).bind(this));
        this.foldCardNode.on(cc.Node.EventType.TOUCH_END, (function (event) {
            this._clickFoldCardNode(event);
        }).bind(this), this.foldCardNode);
    },

    _clickFoldCardNode: function _clickFoldCardNode(event) {

        if (this.userId != Socket.instance.userInfo.id) return;

        var cardInfo = this._userInfo.cardInfo.length == 1 ? this._userInfo.cardInfo[0].cards : this._userInfo.cardInfo;

        var cards = cardInfo.map((function (cardInfoItem) {

            if (this._userInfo.cardInfo.length == 1) return KQCard.cardsFromArray(cardInfoItem);

            return KQCard.cardsFromArray(cardInfoItem.cards);
        }).bind(this)).reduce(function (array, subCards) {
            return array.concat(subCards);
        }, []);

        var foldCardNode = this.foldCardNode.children.slice(0, 3);

        var nodes = foldCardNode.map(function (node) {
            return node.children;
        }).reduce(function (array, sub) {
            return array.concat(sub);
        }, []);

        cards.forEach((function (kqCard, index) {

            if (index >= nodes.length) return;

            nodes[index].removeAllChildren();

            nodes[index].getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.width = nodes[0].width;

            nodds1.height = nodes[0].height;

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var cardName = this.foldCardNodeBack == false ? kqCard.cardName() : "back";

            nodds1.cardName = cardName;

            var path = 'public-pic-card-poker-' + cardName;

            this._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            if (cc.maPai == cardName) {

                var nodds = new cc.Node(); //创建一个节点对象

                nodds.addComponent(cc.Sprite); //添加精灵组件

                cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                    if (err) {
                        cc.error(err.message || err);return;
                    }

                    var btnSprite1 = nodds.getComponent(cc.Sprite);

                    btnSprite1.spriteFrame = spriteFrame;

                    btnSprite1.node.width = cardSprite.node.width + 10;

                    btnSprite1.node.height = cardSprite.node.height + 10;
                }).bind(this));

                cardSprite.node.addChild(nodds);
            }

            nodes[index].addChild(nodds1);
        }).bind(this));

        var cards0 = cards.slice(0, 3);
        var cards1 = cards.slice(3, 8);
        var cards2 = cards.slice(8, 13);

        cards = [cards0, cards1, cards2];
        //头道
        var typeName0 = KQCard.cardsType(cards0) + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        typeName0 = typeName0 == '04' ? '11' : typeName0;

        //中道
        var typeName1 = KQCard.cardsType(cards1) + 1;
        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;
        typeName1 = typeName1 == '07' ? '22' : typeName1;

        //尾道
        var typeName2 = KQCard.cardsType(cards2) + 1;
        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards, nodes, this.cardSpriteAtlas);
        if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards, nodes, this.cardSpriteAtlas);
        if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards, nodes, this.cardSpriteAtlas);
        if (this.foldCardNodeBack == false) {
            this.foldCardNodeBack = true;
        } else if (this.foldCardNodeBack == true) {
            this.foldCardNodeBack = false;
        }
    },

    _loadCardFrame: function _loadCardFrame(SpriteFrame, path, SpritesNode, w, h) {

        var Sprite = SpriteFrame.getSpriteFrame(path);

        SpritesNode.spriteFrame = Sprite;

        if (w) SpritesNode.node.width = w;

        if (h) SpritesNode.node.height = h;
    },

    // 准备好开始比牌
    // readyToCompareCards: function () {
    //     this.foldCardNode.targetOff(this.foldCardNode);
    //     this.foldCardNodeBack = true;
    //     this._clickFoldCardNode();
    //     this.cardsBackLayout.node.active = false;
    //     this.compareCardsNode.active = true;
    //     //this.foldCardNode.active = false;
    //     if(this.compareCardsNode.getComponent('CompareCards')._user){
    //         if(this.compareCardsNode.getComponent('CompareCards')._user.isContainExtra){
    //             this.teShuPaiNode.active = true;
    //         }else{
    //             this.teShuPaiNode.active = false;
    //         }
    //     }
    // },
    readyToCompareCards: function readyToCompareCards() {
        this.foldCardNode.targetOff(this.foldCardNode);
        this.foldCardNodeBack = true;
        this._clickFoldCardNode();
        this.cardsBackLayout.node.active = false;
        this.compareCardsNode.active = true;
        this.foldCardNode.active = true;
        if (this.compareCardsNode.getComponent('CompareCards')._user) {
            if (this.compareCardsNode.getComponent('CompareCards')._user.isContainExtra) {
                this.teShuPaiNode.active = true;
            } else {
                this.teShuPaiNode.active = false;
            }
        }
    },

    // 播放打枪动画
    // @param userId   要主动打枪的用户id
    // @param toUserIndex  挨枪的用户的 index
    playShootAnimation: function playShootAnimation(userId, toUserIndex) {
        if (userId != this.userId) {
            return;
        }
        var shotNode = this.shotNode[toUserIndex];
        shotNode.active = true;
        shotNode.children[0].active = true;
        shotNode.children[1].active = true;

        //枪
        var rotateBy = cc.rotateTo(0.1, -15);
        var delay1 = cc.delayTime(0.1);
        var rotateBy1 = cc.rotateTo(0.1, 0);
        var start_func1 = cc.callFunc(function () {
            shotNode.children[0].active = true;
        });
        var end_func1 = cc.callFunc(function () {
            shotNode.children[0].active = false;
        });
        var action = cc.repeat(cc.sequence(start_func1, rotateBy, delay1, rotateBy1, end_func1), 3);

        //烟
        var fadeIn = cc.fadeIn(0);
        var scaleTo1 = cc.scaleTo(0, 0.8);
        var scaleTo2 = cc.scaleTo(0.08, 1);
        var fadeOutAndScaleTo = cc.spawn(cc.fadeOut(0.02), cc.scaleTo(0.02, 0.5));
        var delay2 = cc.delayTime(.2);
        var start_func2 = cc.callFunc(function () {
            shotNode.children[1].active = true;
        });
        var end_func2 = cc.callFunc(function () {
            shotNode.children[1].active = false;
        });
        var action1 = cc.repeat(cc.sequence(start_func2, fadeIn, scaleTo1, scaleTo2, fadeOutAndScaleTo, delay2, end_func2), 3);

        shotNode.children[0].runAction(action);
        shotNode.children[1].runAction(action1);

        //let userInfo = this.userInfoNode.getComponent('userInfo');
        //userInfo.playShootAnimation(toUserIndex);
    },

    // 播放中枪动画
    playBulletHoleAnimation: function playBulletHoleAnimation(userId) {
        if (userId != this.userId) {
            return;
        }

        this.bulletHoleNode.active = true;

        var bulletHoleNode = cc.instantiate(this.bulletHolePrefab);

        bulletHoleNode.children.forEach((function (node) {
            node.active = false;
        }).bind(this));

        bulletHoleNode.children[0].y = 0;

        this.bulletHoleNode.addChild(bulletHoleNode);

        var interval = 0.3;

        var initTime = 0;

        bulletHoleNode.children.forEach((function (node) {

            this.scheduleOnce(function () {

                AudioManager.instance.playHumanZQiang();

                node.active = true;

                var y = Math.round(Math.random()) == 0 ? -1 : 1;

                y = Math.floor(Math.random() * 38) * y;

                var x = Math.round(Math.random()) == 0 ? -1 : 1;

                x = Math.floor(Math.random() * 38) * x;

                node.x = x;

                node.y = y;
            }, initTime);

            initTime = initTime + interval;
        }).bind(this));
    },

    // 播放全垒打动画
    playHomeRunAimation: function playHomeRunAimation(userId) {
        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.playHomeRunAimation();
    },

    playSpeakAnimation: function playSpeakAnimation(userId) {
        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.playSpeakAnimation();
    },

    nextCompareScore: function nextCompareScore() {
        if (!this.node.active) {
            return 0;
        }

        var score = this.compareCardsNode.getComponent('CompareCards').nextCompareScore();
        return score;
    },

    showNextCompareCards: function showNextCompareCards() {
        if (this.nextCompareScore() <= 0) {
            return;
        }
        this.teShuPaiNode.active = false;
        this.compareCardsNode.getComponent('CompareCards').showNextCards();
    },

    showAllCompareCards: function showAllCompareCards(users) {
        var user = users.find((function (e) {
            return this.userId == e.id;
        }).bind(this));
        this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
        this.compareCardsNode.getComponent('CompareCards').showAllCards();

        this.updateScore(this._userInfo.totalScore || 0);
    },

    showNextCompareScore: function showNextCompareScore(isContainExtra) {
        this.compareCardsNode.getComponent('CompareCards').showNextCompareScore(isContainExtra);
    },

    showScoreResult: function showScoreResult() {
        this.compareCardsNode.getComponent('CompareCards').showScoreResult();
    }
});

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","AudioManager":"AudioManager","KQCard":"KQCard","KQCardResHelper":"KQCardResHelper","KQGlobalEvent":"KQGlobalEvent","Playback":"Playback","UserModelHelper":"UserModelHelper","socket":"socket"}],"ResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9b2behcoUlLYL1MIMs+04wI', 'ResultItem');
// scripts\Play\ResultItem.js

var KQCardResHelper = require('KQCardResHelper');
var SpriteHelper = require('SpriteHelper');
var KQCard = require('KQCard');

cc.Class({
  'extends': cc.Component,

  properties: {
    avatarSprite: cc.Sprite,
    labelNickname: cc.Label,
    labelResultNumber: cc.Label,
    layoutTouDao: cc.Layout,
    layoutZhongDao: cc.Layout,
    layoutWeiDao: cc.Layout,
    layoutTeShu: cc.Layout,

    labelTeShuPaiTitle: cc.Label,

    scoreUnitNode: cc.Node, // 积分
    diamondUnitNode: cc.Node },

  // 钻石
  onLoad: function onLoad() {},

  //{"id":100049,"nickname":"imya","openId":"xx","avatarUrl":"xx","sex":1,
  // "cardNumber":3,"onlineStatus":1,"inviteCode":"","ipAddress":"::ffff:222.244.65.201",
  // "lastLoginTime":"2017-04-13 22:09:01","createAt":"2017-04-11 22:39:30",
  // "updateAt":"2017-04-13 22:09:01",
  // "cards":[],"roomId":"598883","readyStatus":true,"totalScore":0,
  // "cScore":0,"isBanker":false}
  updateWithPlayerInfo: function updateWithPlayerInfo(playerInfo) {
    var isRandomRoom = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];

    SpriteHelper.setImageUrl(this.avatarSprite, playerInfo.avatarUrl);
    this.labelNickname.string = playerInfo.nickname;
    //cc.log(this.labelResultNumber.string)
    //cc.log(playerInfo)
    //cc.log(playerInfo.cScore)
    //cc.log('---36')
    this.labelResultNumber.string = playerInfo.cScore;

    this.scoreUnitNode.active = !isRandomRoom;
    this.diamondUnitNode.active = isRandomRoom;
    var Number = playerInfo.cScore;
    if (isRandomRoom) {
      // 如果是随机场的话，则显示钻石数量
      Number = playerInfo.cScore * 5;
    }
    this.labelResultNumber.string = Number;
  },

  setCards: function setCards(cards) {
    cc.assert(cards.length == 13);

    // 不会再有特殊牌了
    /*if (KQCard.isTeShuPai(cards)) {
      this.setTeShuCards(cards);
      return;
      }
    */

    //let touCards = cards.slice(0, 3);
    //let zhongCards = cards.slice(3, 3 + 5);
    //let weiCards = cards.slice(8);
    //this.setTouCards(touCards);
    //this.setZhongCards(zhongCards);
    //this.setWeiCards(weiCards);
  }

});
/*setTouCards: function (cards) {
  this._setCardsToLayout(this.layoutTouDao, cards);
},
 setZhongCards: function (cards) {
  this._setCardsToLayout(this.layoutZhongDao, cards);
},
  setWeiCards: function (cards) {
  this._setCardsToLayout(this.layoutWeiDao, cards);
},*/

//结算  将特殊牌放入Layout
/*setTeShuCards: function (cards) {
  this.layoutTeShu.node.active = true;
  this.layoutTouDao.node.active = false;
  this.layoutZhongDao.node.active = false;
  this.layoutWeiDao.node.active = false;
  this._setCardsToLayout(this.layoutTeShu, cards);
   let typeName = KQCard.cardsTypeName(cards);
  this.labelTeShuPaiTitle.string = typeName;
},*/

//结算将牌放到Layout里面
/*_setCardsToLayout: function (layout, cards) {
  let node = layout.node;
  node.children.forEach(function (spriteNode, index) {
    let sprite = spriteNode.getComponent('cc.Sprite');
    let card = cards[index];
    if (!card) {
      return;
    }
     KQCardResHelper.setCardSpriteFrame(sprite, card.cardName());
  });
},*/

cc._RFpop();
},{"KQCard":"KQCard","KQCardResHelper":"KQCardResHelper","SpriteHelper":"SpriteHelper"}],"Setting":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3ad6mNk4BMBZzipGQDNlr4', 'Setting');
// scripts\Setting\Setting.js

var Manager = require('manager');
var KQNativeInvoke = require('KQNativeInvoke');

cc.Class({
  'extends': cc.Component,

  properties: {
    phone: cc.Label,
    musicSlider: cc.Node,
    effectSlider: cc.Node,
    btnSwitchAccount: cc.Button,
    shareBg: cc.Node,
    wx: cc.Node,
    pyq: cc.Node,
    music: cc.Node,
    sounds: cc.Node,
    _audioManager: null,
    _musicOn: 1,
    _soundsOn: 1,
    _phone: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._audioManager = cc.find('AudioManager') || {};
    this._audioManager = this._audioManager.getComponent('AudioManager');
    this._initSliders();
    this.phone.string = this._phone ? this._phone : "无";
    var bgMusic = cc.sys.localStorage.getItem("bgMusic");
    var bgSound = cc.sys.localStorage.getItem("bgSound");
    //console.log(bgMusic);
    if (bgMusic != '') {
      if (parseInt(bgMusic) == 1) {
        this._musicOn = 1;
        this.music.getChildByName('music_on').active = true;
        this.music.getChildByName('music_off').active = false;
      } else {
        this._musicOn = 0;
        this.music.getChildByName('music_on').active = false;
        this.music.getChildByName('music_off').active = true;
      }
    }
    if (bgSound == 0) {
      // 如果背景音效是关闭的
      if (parseInt(bgSound) == 0) {
        this._soundsOn = 0;
        this.sounds.getChildByName('sounds_on').active = false;
        this.sounds.getChildByName('sounds_off').active = true;
      } else {
        this._soundsOn = 1;
        this.sounds.getChildByName('sounds_on').active = true;
        this.sounds.getChildByName('sounds_off').active = false;
      }
      this._audioManager.setEffectMusicVolum(this._soundsOn);
    }
  },
  clickWx: function clickWx() {
    //点击微信
    if (!cc.sys.isNative) {
      this.shareBg.active = true;
      this.wx.active = true;
    } else {
      var title = cc.sys.localStorage.getItem('shareTitle');
      var description = cc.sys.localStorage.getItem('desc');
      var recordId = cc.sys.localStorage.getItem('recordId');
      var roomId = cc.sys.localStorage.getItem('roomId');
      var id = '';
      if (roomId) {
        id = 'roomId=' + roomId;
      }
      if (recordId) {
        id = 'recordId=' + recordId;
      }
      if (KQNativeInvoke.isNativeIOS()) {
        jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
      } else if (KQNativeInvoke.isNativeAndroid()) {
        //Android
        var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
        jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
      }
    }
  },
  clickPyq: function clickPyq() {
    //点击朋友圈
    if (!cc.sys.isNative) {
      this.shareBg.active = true;
      this.pyq.active = true;
    } else {
      var title = cc.sys.localStorage.getItem('shareTitle');
      var description = cc.sys.localStorage.getItem('desc');
      var recordId = cc.sys.localStorage.getItem('recordId');
      var roomId = cc.sys.localStorage.getItem('roomId');
      var id = '';
      if (roomId) {
        id = 'roomId=' + roomId;
      }
      if (recordId) {
        id = 'recordId=' + recordId;
      }
      if (KQNativeInvoke.isNativeIOS()) {
        jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline:description:", id, description, title);
      } else if (KQNativeInvoke.isNativeAndroid()) {
        //Android
        var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
        jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
      }
    }
  },

  clickshareBg: function clickshareBg() {
    // 点击分享背景图
    this.shareBg.active = false;
    this.wx.active = false;
    this.pyq.active = false;
  },
  clickMusic: function clickMusic() {
    //点击音乐
    this.music.children[1].active = this._musicOn = !this._musicOn;
    this.music.children[2].active = !this._musicOn;
    var volume = 0;
    if (this._musicOn) {
      this._audioManager.setBgMusicVolumn(1);
      this._audioManager.playMusic();
      volume = 1;
    } else {
      this._audioManager.setBgMusicVolumn(0);
      volume = 0;
    }
    cc.sys.localStorage.setItem("bgMusic", volume);
  },

  clickSounds: function clickSounds() {
    //点击了音效
    this.sounds.children[1].active = this._soundsOn = !this._soundsOn;
    this.sounds.children[2].active = !this._soundsOn;
    var volume = 0;
    if (this._soundsOn) {
      this._audioManager.setEffectMusicVolum(1);
      volume = 1;
    } else {
      this._audioManager.setEffectMusicVolum(0);
      volume = 0;
    }
    cc.sys.localStorage.setItem("bgSound", volume);
  },
  clickSetting: function clickSetting() {//点击设置

  },
  _initSliders: function _initSliders() {
    this._initSliderEvents();

    var musicVal = Manager.getMusicValue();
    var effectVal = Manager.getMusicEffectValue();

    this._audioManager.setBgMusicVolumn(musicVal);
    this._audioManager.setEffectMusicVolum(effectVal);

    this.musicSlider.getComponent('slider').setValue(musicVal);
    this.effectSlider.getComponent('slider').setValue(effectVal);
  },

  _initSliderEvents: function _initSliderEvents() {
    var self = this;
    this.musicSlider.getComponent('slider').onValueChange = function (value) {
      Manager.setMusicValue(value);
      self._audioManager.setBgMusicVolumn(value);
    };

    this.effectSlider.getComponent('slider').onValueChange = function (value) {
      Manager.setMusicEffectValue(value);
      self._audioManager.setEffectMusicVolum(value);
    };
  },

  clickSwitch: function clickSwitch() {},

  hideSwitch: function hideSwitch() {
    if (this.btnSwitchAccount) {
      this.btnSwitchAccount.node.active = false;
    }
  }
});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"SpriteHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '936f2uPA8NAuqUZv0R8ZxgP', 'SpriteHelper');
// scripts\Extensions\SpriteHelper.js

var SpriteHelper = {
  setImageUrl: function setImageUrl(sprite, url) {
    if (url.endsWith("png") || url.endsWith("jpg") || url.endsWith("gif")) {} else {
      //url = url + ".png";
    }

    cc.loader.load({ url: url, type: "jpg" }, function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      sprite.spriteFrame = frame;
    });
  }
};

module.exports = SpriteHelper;

cc._RFpop();
},{}],"StringExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7b106eQ/I5F1J85hMxFBIlw', 'StringExtension');
// scripts\Extensions\StringExtension.js

// 给 String 添加功能

// str.startsWith("");
// str.endsWith("");

if (!String.prototype.startsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`
		var defineProperty = (function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		})();
		var toString = ({}).toString;
		var startsWith = function startsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var position = arguments.length > 1 ? arguments[1] : undefined;
			// `ToInteger`
			var pos = position ? Number(position) : 0;
			if (pos != pos) {
				// better `isNaN`
				pos = 0;
			}
			var start = Math.min(Math.max(pos, 0), stringLength);
			// Avoid the `indexOf` call if no match is possible
			if (searchLength + start > stringLength) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'startsWith', {
				'value': startsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.startsWith = startsWith;
		}
	})();
}

// str.endsWith("");
if (!String.prototype.endsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`
		var defineProperty = (function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		})();
		var toString = ({}).toString;
		var endsWith = function endsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var pos = stringLength;
			if (arguments.length > 1) {
				var position = arguments[1];
				if (position !== undefined) {
					// `ToInteger`
					pos = position ? Number(position) : 0;
					if (pos != pos) {
						// better `isNaN`
						pos = 0;
					}
				}
			}
			var end = Math.min(Math.max(pos, 0), stringLength);
			var start = end - searchLength;
			if (start < 0) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'endsWith', {
				'value': endsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.endsWith = endsWith;
		}
	})();
}

cc._RFpop();
},{}],"TotalGameResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1c6f93a1BOnoSiX6kJ0Efn', 'TotalGameResultItem');
// scripts\Play\TotalGameResultItem.js

var SpriteHelper = require('SpriteHelper');
cc.Class({
  "extends": cc.Component,

  properties: {
    avatarSprite: cc.Sprite,
    labelUserId: cc.Label,
    labelScore: cc.Label,
    labelNickname: cc.Label,

    _deskInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setUserInfo: function setUserInfo(user, deskInfo) {
    if (!user) {
      return;
    }

    var totalScore = user.totalScore;
    if (deskInfo && (deskInfo.setting1 == 0 || deskInfo.setting1 == 1)) {
      var baseScore = deskInfo.setting1 == 0 ? 100 : 200;
      totalScore = totalScore - baseScore;
    }

    SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);
    this.labelUserId.string = "" + user.id;
    this.labelScore.string = totalScore > 0 ? "+ " + totalScore : "- " + totalScore * -1;
    if (totalScore == 0) {
      this.labelScore.string = "0";
    }
    this.labelNickname.string = user.nickname;
  }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"TotalGameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f7fb2e7foJFNJzjdtbAtk7O', 'TotalGameResult');
// scripts\Play\TotalGameResult.js

var KQNativeInvoke = require('KQNativeInvoke');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        itemLayout: cc.Layout,
        itemPrefab: cc.Prefab,
        timeLabel: cc.Label, // 时间
        jushuLabel: cc.Label, // 局数
        roomId: cc.Label, // 房间号
        nicknameLabels: cc.Label,
        recordInfo_sview: [cc.Node],

        sharrBg: cc.Node,
        btnWeiXin: cc.Node,
        btnGongXuoHao: cc.Node,
        btnZhuShou: cc.Node,
        btnZongFen: cc.Node,

        suanfen_sview: cc.Node,
        suanFenPrefab: cc.Prefab,
        suanFenBgPrefab: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {},

    onDisable: function onDisable() {
        //if(cc.sys.isBrowser){
        //
        var shareTitle = '开房玩[大众十三水]';
        var desc = '开好房了，就等你们一起来[大众十三水]啦！晚了位置就没了哟~';
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);

        // cc.sys.localStorage.removeItem("shareTitle");
        // cc.sys.localStorage.removeItem("desc");
        cc.sys.localStorage.removeItem("recordId");
        //cc.sys.localStorage.setItem("roomId",'');
        if (window.shareToTimeLine) {
            window.shareToTimeLine();
        }
        if (window.shareToSession) {
            window.shareToSession();
        }
        //}
    },
    js: function js(setting2) {
        var jushu = 5;
        switch (setting2) {
            case 0:
                jushu = 5;break;case 1:
                jushu = 10;break;
            case 2:
                jushu = 20;break;case 3:
                jushu = 30;break;
        }
        return jushu;
    },

    creator: function creator(_creator, players) {
        //创房者
        for (var i = 0; i < players.length; i++) {
            if (players[i].id == _creator) {
                return i;
            }
        }
    },

    _clickBtn: function _clickBtn() {
        this.btnZhuShou.active = true;
        this.btnZongFen.active = false;
    },

    clickZongFen: function clickZongFen() {

        this.btnZhuShou.active = true;

        this.btnZongFen.active = false;

        this.recordInfo_sview.forEach(function (node) {
            node.active = true;
        });

        this.suanfen_sview.active = false;
    },
    _globalMsg: function _globalMsg(recordInfo) {
        //if(cc.sys.isBrowser) {
        var roomId = "房间号：" + recordInfo.roomId;
        var pj = ["5 ", "10 ", "20 "];
        var js = "局数：" + pj[recordInfo.setting1 - 2];
        var time = "时间：" + (recordInfo.createAt ? recordInfo.createAt : recordInfo.createTime);
        var shareTitle = "[大众十三水]战绩";
        var desc = roomId + js + time + " 点击查看详情";
        var recordId = recordInfo.id != undefined ? recordInfo.id : recordInfo.recordId;
        cc.sys.localStorage.setItem("shareTitle", shareTitle);
        cc.sys.localStorage.setItem("desc", desc);
        cc.sys.localStorage.setItem("recordId", recordId);
        cc.sys.localStorage.setItem("roomId", '');

        if (window.shareToTimeLine) {
            window.shareToTimeLine();
        }
        if (window.shareToSession) {
            window.shareToSession();
        }
        //}
    },
    //大局
    setPlayerInfos: function setPlayerInfos(playerInfos, deskInfo) {
        playerInfos.sort(function (a, b) {
            return b.totalScore - a.totalScore;
        }); // 排序
        // cc.log(playerInfos)
        // cc.log(deskInfo)
        // cc.log('--65')

        this._globalMsg(deskInfo);
        this.recordInfo_sview.forEach(function (node) {
            node.active = true;
        });

        this.suanfen_sview.active = false;

        this.btnZhuShou.active = true;

        this.btnZongFen.active = false;

        this._playerInfos = playerInfos;

        this._deskInfo = deskInfo;

        var createId = deskInfo.createUserId ? deskInfo.createUserId : deskInfo.createId;

        var nickname = playerInfos[this.creator(createId, playerInfos)].nickname;

        this.roomId.string = deskInfo.roomId;

        var createAt = deskInfo.createAt ? deskInfo.createAt : deskInfo.createTime;

        this.timeLabel.string = createAt.substr(0, 11);

        this.jushuLabel.string = this.js(deskInfo.setting1 - 2);

        this.nicknameLabels.string = nickname;

        this.itemLayout.node.removeAllChildren();

        playerInfos.forEach((function (user) {

            var item = cc.instantiate(this.itemPrefab);

            item.getComponent('TotalGameResultItem').setUserInfo(user, deskInfo);

            if (deskInfo.createUserId == user.id || deskInfo.createId == user.id) {

                item.children[1].children[0].active = true;
            } else {

                item.children[1].children[0].active = false;
            }

            this.itemLayout.node.addChild(item);
        }).bind(this));
    },

    //算分能手
    clickSuanFen: function clickSuanFen() {

        this.btnZhuShou.active = false;

        this.btnZongFen.active = true;

        this.recordInfo_sview.forEach(function (node) {
            node.active = false;
        });

        this.suanfen_sview.active = true;

        var playersRigth = this._playerInfos.filter(function (player) {
            return player.totalScore > 0;
        });

        var playersLeft = this._playerInfos.filter(function (player) {
            return player.totalScore < 0;
        });

        var playersRigthScore = playersRigth.map(function (player) {
            return player.totalScore;
        });

        var playersLeftScore = playersLeft.map(function (player) {
            return player.totalScore * -1;
        });

        var playersIndex = [],
            arrs = [playersRigthScore.filter(function (i) {
            return i;
        }), playersLeftScore.filter(function (i) {
            return i;
        })],
            indexs = playersLeftScore.length > playersRigthScore.length ? 0 : 1; //1是赢的人 0输的人

        // for(var i = 0;i < arrs[indexs].length; i++){

        //     var score = arrs[indexs][i];

        //     var d = this.getCombBySum(arrs[indexs==1?0:1], score)[0] || [];

        //     if(d.length > 0){

        //         playersIndex.push([score,d]);

        //         d.forEach(function (s) {

        //             var index = arrs[indexs==1?0:1].indexOf(s);

        //             if(index != -1) arrs[indexs==1?0:1].splice(index,1);

        //         });
        //     }
        // }

        // if(playersIndex.length == 0) indexs = 2;
        indexs = 2;
        this.suanfen_sview.children[0].removeAllChildren();

        playersLeft.forEach((function (user, index) {

            var suanFenBgPrefab = cc.instantiate(this.suanFenBgPrefab);

            suanFenBgPrefab.removeAllChildren();

            this._ctarePrefab(1, suanFenBgPrefab, user, user.totalScore, this._deskInfo, -200, 0);

            var x = 0,
                y = 0;

            if (indexs == 1) {
                for (var j = 0; j < playersIndex[index][1].length; j++) {

                    var s = playersIndex[index][1][j];

                    var d = playersRigthScore.indexOf(s);

                    if (d != -1) {

                        var plays = playersRigth.splice(d, 1)[0];

                        playersRigthScore.splice(d, 1);

                        if (plays) {

                            if (suanFenBgPrefab.childrenCount >= 3) y = -90;

                            if (suanFenBgPrefab.childrenCount == 3) x = 0;

                            if (suanFenBgPrefab.childrenCount >= 5) y = -180;

                            if (suanFenBgPrefab.childrenCount == 5) x = 0;

                            this._ctarePrefab(0, suanFenBgPrefab, plays, plays.totalScore, this._deskInfo, x, y);

                            x += 200;
                        }
                    }
                }
            } else if (indexs == 0) {
                var fen = suanFenBgPrefab.children[0].getChildByName("fen").getComponent(cc.Label).string.substr(3) * -1;

                for (var j = 0; j < playersIndex.length; j++) {

                    var s = playersIndex[j];

                    var d = s[1].indexOf(fen);

                    var q = s[0];

                    var w = playersRigthScore.indexOf(q);

                    if (d != -1 && w != -1) {

                        var plays = playersRigth[w];

                        this._ctarePrefab(0, suanFenBgPrefab, plays, plays.totalScore, this._deskInfo, x, y, fen);
                    }
                }
            } else {
                var q = playersLeftScore[index];
                var addScore = 0;
                var arr = [];
                for (var j = 0; j < playersRigthScore.length; j++) {
                    var w = playersRigthScore[j];
                    if (addScore < q) {
                        addScore += w;
                        if (addScore > q) {
                            arr.push(w - (addScore - q));
                        } else {
                            arr.push(w);
                        }
                        if (q - w >= 0) {
                            playersRigthScore[j] = 0;
                        }
                    }
                    if (addScore > q) {
                        playersRigthScore[j] = addScore - q;
                        break;
                    }
                }

                for (var t = 0; t < arr.length; t++) {
                    var r = arr[t];
                    if (r == 0) continue;
                    if (suanFenBgPrefab.childrenCount >= 3) y = -90;

                    if (suanFenBgPrefab.childrenCount == 3) x = 0;

                    if (suanFenBgPrefab.childrenCount >= 5) y = -180;

                    if (suanFenBgPrefab.childrenCount == 5) x = 0;

                    var plays = playersRigth[t];

                    this._ctarePrefab(0, suanFenBgPrefab, plays, r, this._deskInfo, x, y);

                    x += 200;
                }
            }

            this.suanfen_sview.children[0].addChild(suanFenBgPrefab);
        }).bind(this));
    },

    _ctarePrefab: function _ctarePrefab(shu, node, user, totalScore, deskInfo, x, y) {
        var fen = arguments.length <= 7 || arguments[7] === undefined ? null : arguments[7];

        var suanFenPrefab = cc.instantiate(this.suanFenPrefab);

        suanFenPrefab.getChildByName("ID").getComponent(cc.Label).string = "ID:" + user.id;

        if (deskInfo.createUserId == user.id) suanFenPrefab.getChildByName("ID").color = new cc.Color(235, 115, 122);

        suanFenPrefab.getChildByName("shu").getComponent(cc.Label).string = shu == 0 ? "输" : "";

        var str = shu == 0 ? totalScore + "分" : "总分:" + totalScore;

        if (fen) str = fen + "分";

        suanFenPrefab.getChildByName("fen").getComponent(cc.Label).string = str;

        var sprite = suanFenPrefab.getChildByName("haed").getComponent(cc.Sprite);

        var headUrl = user.avatarUrl; // 头像URL

        cc.loader.load({ url: headUrl, type: "jpg" }, function (err, tex) {

            if (!err) {

                var frame = new cc.SpriteFrame(tex);

                sprite.spriteFrame = frame;

                sprite.node.height = 55;

                sprite.node.width = 55;
            }
        });

        suanFenPrefab.x = x;

        suanFenPrefab.y = y;

        node.height = 90 + y * -1;

        node.addChild(suanFenPrefab);
    },

    clickExit: function clickExit() {
        Socket.sendOnceAgain('false', this._userId);
        cc.director.loadScene('hall');
    },

    clickShareWeiChat: function clickShareWeiChat() {
        if (!cc.sys.isNative) {
            this.sharrBg.active = true;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
            } else {
                //Android
                KQNativeInvoke.screenshotShare();
            }
        }
    },
    clickShareBg: function clickShareBg() {
        this.sharrBg.active = false;
    },
    clickSharePengYouQuan: function clickSharePengYouQuan() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
        }
    },

    getCombBySum: function getCombBySum(array, sum, tolerance, targetCount) {
        var util = {
            /*
             get combination from array
             arr: target array
             num: combination item length
             return: one array that contain combination arrays
             */
            getCombination: function getCombination(arr, num) {
                var r = [];
                (function f(t, a, n) {
                    if (n == 0) {
                        return r.push(t);
                    }
                    for (var i = 0, l = a.length; i <= l - n; i++) {
                        f(t.concat(a[i]), a.slice(i + 1), n - 1);
                    }
                })([], arr, num);
                return r;
            },
            //take array index to a array
            getArrayIndex: function getArrayIndex(array) {
                var i = 0,
                    r = [];
                for (i = 0; i < array.length; i++) {
                    r.push(i);
                }

                return r;
            }
        },
            logic = {
            //sort the array,then get what's we need
            init: function init(array, sum) {
                //clone array
                var _array = array.concat(),
                    r = [],
                    i = 0;
                //sort by asc
                _array.sort(function (a, b) {
                    return a - b;
                });
                //get all number when it's less than or equal sum
                for (i = 0; i < _array.length; i++) {
                    if (_array[i] <= sum) {
                        r.push(_array[i]);
                    } else {
                        break;
                    }
                }

                return r;
            },
            //important function
            core: function core(array, sum, arrayIndex, count, r) {
                var i = 0,
                    k = 0,
                    combArray = [],
                    _sum = 0,
                    _cca = [],
                    _cache = [];

                if (count == _returnMark) {
                    return;
                }
                //get current count combination
                combArray = util.getCombination(arrayIndex, count);
                for (i = 0; i < combArray.length; i++) {
                    _cca = combArray[i];
                    _sum = 0;
                    _cache = [];
                    //calculate the sum from combination
                    for (k = 0; k < _cca.length; k++) {
                        _sum += array[_cca[k]];
                        _cache.push(array[_cca[k]]);
                    }
                    if (Math.abs(_sum - sum) <= _tolerance) {
                        r.push(_cache);
                    }
                }

                logic.core(array, sum, arrayIndex, count - 1, r);
            }

        },
            r = [],
            _array = [],
            _targetCount = 0,
            _tolerance = 0,
            _returnMark = 0;

        //check data
        _targetCount = targetCount || _targetCount;
        _tolerance = tolerance || _tolerance;

        _array = logic.init(array, sum);
        if (_targetCount) {
            _returnMark = _targetCount - 1;
        }

        logic.core(_array, sum, util.getArrayIndex(_array), _targetCount || _array.length, r);

        return r;
    }
});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","socket":"socket"}],"UserModelHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98854aScapF5oQnHKxJsvmF', 'UserModelHelper');
// scripts\ModelUtils\UserModelHelper.js

var UserModelHelper = {
  // 用户是否已出牌
  isPlayedCards: function isPlayedCards(user) {
    cc.assert(user);

    if (user && user.cardInfo && user.cardInfo.length > 0) {
      return true;
    }

    return false;
  },

  // 用户是否已准备
  isUserReady: function isUserReady(user) {
    return user.readyStatus == true;
  }
};

module.exports = UserModelHelper;

cc._RFpop();
},{}],"UserSampleInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3a9f7A0IgRGPrAZvy1p9s4i', 'UserSampleInfo');
// scripts\Play\UserSampleInfo.js

var SpriteHelper = require('SpriteHelper');

cc.Class({
  'extends': cc.Component,

  properties: {
    labelUserId: cc.Label,
    labelUserIP: cc.Label,
    labelNickname: cc.Label,
    avatarSprite: cc.Sprite,
    manSprite: cc.Sprite,
    womenSprite: cc.Sprite,

    _didShowUserInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  updateWithUser: function updateWithUser(user) {
    return;
    if (!user) {
      return;
    }

    if (this._didShowUserInfo == user) {
      this.unscheduleAllCallbacks();
      this._disappearUserInfo();
      return;
    }

    this._didShowUserInfo = user;
    if (!this.node.active) {
      this.node.getComponent('alert').alert();
    }

    this.unscheduleAllCallbacks();
    this.scheduleOnce((function () {
      this._disappearUserInfo();
    }).bind(this), 5);

    this.labelUserId.string = "UID:\n" + user.id;
    this.labelUserIP.string = "用户IP:\n" + user.ipAddress.replace("::ffff:", "");
    this.labelNickname.string = user.nickname;
    this.avatarSprite.spriteFrame = null;
    SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);

    var sex = user.sex; // sex: 1 男  2 女
    this.manSprite.node.active = sex == 1;
    this.womenSprite.node.active = sex != 1;
  },

  _disappearUserInfo: function _disappearUserInfo() {
    this.node.active = false;
    this._didShowUserInfo = null;
  }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"agreement":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8f601dzNnZLtq+KGT0uqDqF', 'agreement');
// scripts\agreement.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');
cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        agreement: {
            'default': null,
            type: cc.Label
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        // cc.log('----61')
        //  cc.log(this.agreement)
    },
    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (!response.result) {
            return;
        }
        var s = cc.find('Canvas/agreement');
        var data = response.data;
        //this._info1 = response.data;
        // cc.log(this.agreement)
        // cc.log(s)
        // cc.log('----61')
        this.agreement.string = data.info1 || "";
    }
});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"alert":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16cd2qs73lByZaHhJkQAEee', 'alert');
// scripts\alert.js

var AudioManager = require('AudioManager');
cc.Class({
  'extends': cc.Component,

  properties: {
    // foo: {
    //    default: null,      // The default value will be used only when the component attaching
    //                           to a node for the first time
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    popNode: cc.Node,
    label: cc.Label,

    _alertCallback: null,
    _willDismissCallback: null,
    _dismissCallback: null,
    _confirmCallback: null, // 点击确定后的回调
    _tishi: null,
    _card_num: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  alert: function alert() {
    this.node.active = true;
    var anim = this.popNode.getComponent(cc.Animation);
    anim.play('pop');

    if (this._alertCallback) {
      this._alertCallback(this.node);
    }
  },
  /*#####弹出结果*/
  alertResult: function alertResult() {
    this.node.active = true;
    cc.find("Canvas/show_result").active = false;
    var anim = this.popNode.getComponent(cc.Animation);
    anim.play('pop');

    if (this._alertCallback) {
      this._alertCallback(this.node);
    }
  },

  /*#####点击确定*/
  playBtnClickSFX: function playBtnClickSFX() {
    AudioManager.instance.playBtnClickSFX();
  },

  /*#####点击取消*/
  palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
    AudioManager.instance.palyBtnCancelClickSFX();
  },

  /*#####点击关闭或者按键之类的按钮，播放音效*/
  palyBtnPublicSFX: function palyBtnPublicSFX() {
    AudioManager.instance.palyBtnPublicSFX();
  },

  /*#####点击创建房间，播放音效*/
  palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
    AudioManager.instance.palyBtnCreateRoomSFX();
  },
  /*#####点击创建房间，播放音效*/
  palyWindowSFX: function palyWindowSFX() {
    AudioManager.instance.palyWindowSFX();
  },

  palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
    AudioManager.instance.palyWeiXinLoginSFX();
  },
  palyFangPaiSFX: function palyFangPaiSFX() {
    AudioManager.instance.palyFangPaiSFX();
  },

  dismissAction: function dismissAction() {
    var willDismissCallback = this._willDismissCallback;
    if (willDismissCallback) {
      var result = willDismissCallback();
      if (result) {
        this.dismissComplete();
        return;
      }
    }

    var anim = this.popNode.getComponent(cc.Animation);
    var dismissAnim = anim.getAnimationState('pop_dismiss');
    dismissAnim.on('finished', this.dismissComplete, this);
    anim.play('pop_dismiss');
  },

  /*#####隐藏结果页面*/
  dismissActionResult: function dismissActionResult() {
    var willDismissCallback = this._willDismissCallback;
    if (willDismissCallback) {
      var result = willDismissCallback();
      if (result) {
        this.dismissComplete();
        return;
      }
    }

    var anim = this.popNode.getComponent(cc.Animation);
    var dismissAnim = anim.getAnimationState('pop_dismiss');
    dismissAnim.on('finished', this.dismissComplete, this);
    anim.play('pop_dismiss');
    cc.find("Canvas/show_result").active = true;
  },

  dismissComplete: function dismissComplete() {
    this.node.active = false;

    if (this.onDismissComplete) {
      this.onDismissComplete();
    }

    if (this._dismissCallback) {
      this._dismissCallback(this.node);
    }
  },
  dismissPlay: function dismissPlay() {
    cc.director.loadScene("hall");
  },

  onDismissComplete: function onDismissComplete() {
    //cc.log("onDismissComplete");
  },

  doneAction: function doneAction() {
    this.dismissAction();
    this.onDoneAction();

    var confirmCallback = this._confirmCallback;
    if (confirmCallback) {
      confirmCallback(this.node);
    }
  },

  onDoneAction: function onDoneAction() {},

  setMessage: function setMessage(msg) {
    this.label.string = msg;
  },

  getMessage: function getMessage() {
    return this.label.string;
  },

  setAlertCallbck: function setAlertCallbck(callback) {
    this._alertCallback = callback;
  },

  setWillDismissCallback: function setWillDismissCallback(callback) {
    this._willDismissCallback = callback;
  },

  setDismissCallback: function setDismissCallback(callback) {
    this._dismissCallback = callback;
  },

  setConfirmCallback: function setConfirmCallback(callback) {
    this._confirmCallback = callback;
  }

});
/*setMessage: function (message) {
  this.label.getComponent('cc.Label').string = message;
},*/

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"AudioManager":"AudioManager"}],"animation":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c9ee9y0ua5NRLSZAxQqDjdw', 'animation');
// scripts\animation.js

/**
 *  房间特殊牌动画
 *
 *
 *
 * 
 */
cc.Class({
    "extends": cc.Component,

    properties: {
        fapaiNode: cc.Prefab, //
        liuduiban: cc.Prefab,
        santonghua: cc.Prefab,
        sanshunzi: cc.Prefab,
        quanleida: cc.Prefab,
        qinglong: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {},
    fapaiAnimation: function fapaiAnimation() {
        var fapai = this.node.getChildByName('fapai');
        fapai = cc.removeSelf();
        var fapaiAnim = cc.instantiate(this.fapaiNode);
        this.node.addChild(fapaiAnim);

        var Lgun = fapaiAnim.getChildByName("left_gang"); // 左边的抢
        var Rgun = fapaiAnim.getChildByName("right_gang"); // 右边的抢
        var mask = fapaiAnim.getChildByName("mask");
        /* -----------start及子节点----------- */
        var start = fapaiAnim.getChildByName("start"),
            quan = start.getChildByName("quan"),
            baodian = start.getChildByName("baodian"),
            ditan = start.getChildByName("ditan"),
            beginIco = start.getChildByName("begin_icon"),
            title = start.getChildByName("title"),
            rWing = start.getChildByName("rWing"),
            lWing = start.getChildByName("lWing");
        /* --------------------------------- */
        var self = this;
        fapaiAnim.active = true;
        mask.runAction(cc.scaleTo(0.2, 10, 10));
        Lgun.runAction(cc.sequence(self.LgunAction()));
        Rgun.runAction(cc.sequence(self.RgunAction()));

        var startFinished = cc.callFunc(function () {
            rWing.active = true;
            lWing.active = true;
            lWing.runAction(cc.sequence(cc.repeat(cc.sequence(cc.skewTo(0.05, 20, -10), cc.skewTo(0.05, 0, 0)), 3), cc.fadeOut(0)));
            rWing.runAction(cc.sequence(cc.repeat(cc.sequence(cc.skewTo(0.05, 20, -10), cc.skewTo(0.05, 0, 0)), 3), cc.fadeOut(0)));
        });
        var wingFinished = cc.callFunc(function () {
            setTimeout(function () {
                start.runAction(cc.scaleTo(0.2, 0, 0));
            }, 500);
        });
        setTimeout(function () {
            start.active = true;
            start.runAction(cc.sequence(cc.scaleTo(0.2, 1.5, 1.5), cc.scaleTo(0.2, 1, 1), startFinished, wingFinished));
            quan.runAction(cc.sequence(cc.scaleTo(0.2, 10, 10), cc.fadeOut(0)));
            baodian.runAction(cc.sequence(cc.scaleTo(0.2, 1.5, 1.5), cc.fadeOut(0)));
        }, 400);
        setTimeout(function () {
            lWing.active = false;
            rWing.active = false;
            start.active = false;
            fapaiAnim.active = false;
            fapaiAnim.removeFromParent(true);
        }, 2000);
    },
    LgunAction: function LgunAction() {
        // 左边的枪
        return [cc.spawn([cc.moveTo(0.2, cc.v2(-430, 152)), cc.scaleTo(0.2, 2, 2)]), cc.spawn([cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(-220, 0)), cc.rotateTo(0.2, 35)]), cc.fadeOut(0)];
    },
    RgunAction: function RgunAction() {
        // 右边的枪
        return [cc.spawn([cc.moveTo(0.2, cc.v2(430, 152)), cc.scaleTo(0.2, -2, 2)]), cc.spawn([cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(220, 0)), cc.rotateTo(0.2, -35)]), cc.fadeOut(0)];
    },
    _bezier1: function _bezier1(index) {
        var bezier = [];
        bezier[0] = [[cc.v2(100, 74), cc.v2(150, 174), cc.v2(200, -174)], cc.v2(100, 74)];
        bezier[1] = [[cc.v2(-72, 284), cc.v2(-122, 384), cc.v2(-222, -150)], cc.v2(-72, 284)];
        bezier[2] = [[cc.v2(-70, 200), cc.v2(-120, 300), cc.v2(-220, -200)], cc.v2(-70, 200)];
        bezier[3] = [[cc.v2(-123, 213), cc.v2(-173, 313), cc.v2(-273, -160)], cc.v2(-123, 213)];
        bezier[4] = [[cc.v2(110, 237), cc.v2(160, 337), cc.v2(260, -177)], cc.v2(210, 237)];
        bezier[5] = [[cc.v2(183, 115), cc.v2(233, 215), cc.v2(333, -155)], cc.v2(183, 115)];
        bezier[6] = [[cc.v2(92, 116), cc.v2(142, 216), cc.v2(242, -146)], cc.v2(92, 116)];
        bezier[7] = [[cc.v2(-26, 124), cc.v2(-76, 224), cc.v2(-176, -164)], cc.v2(-26, 124)];
        bezier[8] = [[cc.v2(-110, 81), cc.v2(-220, 131), cc.v2(-460, -180)], cc.v2(-110, 81)];
        bezier[9] = [[cc.v2(-125, 33), cc.v2(-225, 133), cc.v2(-275, -133)], cc.v2(-125, 33)];
        bezier[10] = [[cc.v2(0, 0), cc.v2(50, 100), cc.v2(150, -150)], cc.v2(0, 0)];
        bezier[11] = [[cc.v2(-235, 5), cc.v2(-275, 105), cc.v2(-375, -186)], cc.v2(-235, 5)];
        bezier[12] = [[cc.v2(-80, 4), cc.v2(-130, 104), cc.v2(-230, -233)], cc.v2(-80, 4)];
        bezier[13] = [[cc.v2(100, -7), cc.v2(150, 107), cc.v2(250, -177)], cc.v2(100, -7)];
        bezier[14] = [[cc.v2(154, 23), cc.v2(204, 113), cc.v2(254, -173)], cc.v2(254, 23)];
        return bezier[index];
    },
    // 青龙动画
    _qinglongAniamtion: function _qinglongAniamtion(type) {
        var qinglong = cc.instantiate(this.qinglong);
        this.node.addChild(qinglong);
        var bg = qinglong.getChildByName('bg');
        var title = '';
        if (type == "ql") {
            title = qinglong.getChildByName('qlongtitle');
        } else {
            title = qinglong.getChildByName('longtitle');
        }

        var yun1 = qinglong.getChildByName('yun1');
        var yun2 = qinglong.getChildByName('yun2');
        var yun3 = qinglong.getChildByName('yun3');
        var yun4 = qinglong.getChildByName('yun4');
        var long = qinglong.getChildByName("long");

        var hua1 = qinglong.getChildByName('hua1');
        var hua2 = qinglong.getChildByName('hua2');
        var hua3 = qinglong.getChildByName('hua3');
        var A = [],
            B = [],
            C = [];
        var hua = [];

        var test = cc.instantiate(hua1);

        var self = this;
        for (var i = 0; i < 5; i++) {
            A[i] = cc.instantiate(hua1);
            A[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(A[i]);
            B[i] = cc.instantiate(hua2);
            B[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(B[i]);
            C[i] = cc.instantiate(hua3);
            C[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(C[i]);
        };
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), cc.scaleTo(0.2, 2, 2), cc.spawn(cc.scaleTo(0.2, 1.5, 1.5), longStart)));
        });
        var longStart = cc.callFunc(function () {
            long.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 0.5)), cc.scaleTo(0.1, 3, 3), cc.spawn(cc.scaleTo(0.1, 1, 1), yunStart)));
        });
        var flowerStart = cc.callFunc(function () {});
        var yunStart = cc.callFunc(function () {
            yun1.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(-334, 234)), cc.moveTo(0.2, cc.v2(-344, 234))), 3)));
            yun2.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(-368, -82)), cc.moveTo(0.2, cc.v2(-358, -82))), 3)));
            yun3.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(408, -4)), cc.moveTo(0.2, cc.v2(398, -4))), 3)));
            yun4.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(406, 181)), cc.moveTo(0.2, cc.v2(416, 181))), 3)));
            for (var i = 1; i < hua.length; i++) {
                hua[i].setPosition(self._bezier(i)[1]);
                qinglong.addChild(hua[i]);
                hua[i].runAction(cc.sequence(cc.spawn(cc.bezierTo(0.3, self._bezier(i)[0]), cc.scaleTo(0.3, 1, 1), cc.fadeTo(0.3, 0))));
            }
            setTimeout(function () {
                qinglong.removeFromParent(true);
            }, 1500);
            //yun1
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.scaleTo(0.2, 2, 2));
    },
    // 三顺子动画
    _sanshunziAnimation: function _sanshunziAnimation() {
        var sanshunzi = cc.instantiate(this.sanshunzi);
        this.node.addChild(sanshunzi);
        var bg = sanshunzi.getChildByName('bg');
        var Ltu = sanshunzi.getChildByName('Ltu');
        var Rtu = sanshunzi.getChildByName('Rtu');
        var title = sanshunzi.getChildByName('title');
        var zushun1 = sanshunzi.getChildByName('zushun1');
        var zushun2 = sanshunzi.getChildByName('zushun2');
        var zushun3 = sanshunzi.getChildByName('zushun3');
        var zushun4 = sanshunzi.getChildByName('zushun4');
        var zushun5 = sanshunzi.getChildByName('zushun5');
        var self = this;
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.2, 2.5, 2.5), titleScale));
            Ltu.runAction(cc.sequence(cc.fadeTo(0.2, 255)));
            Rtu.runAction(cc.sequence(cc.fadeTo(0.2, 255)));
        });
        var titleScale = cc.callFunc(function () {
            // title放大完成后 竹笋2和3同时进行
            title.runAction(cc.scaleTo(0.2, 1.5, 1.5));
            zushun2.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10), ZS1));
            zushun3.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 22, 22)), cc.scaleTo(0.2, 20, 20), ZS4));
            setTimeout(function () {
                zushun5.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10)));
            }, 100);
            setTimeout(function () {
                self.sanshunzi.active = false;
                sanshunzi.removeFromParent(true);
            }, 2000);
        });
        var ZS1 = cc.callFunc(function () {
            zushun1.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10)));
        });
        var ZS4 = cc.callFunc(function () {
            zushun4.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 14, 14)), cc.scaleTo(0.2, 12, 12)));
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.scaleTo(0.2, 2, 2));
    },
    // 全垒打
    _quanleidaAnimation: function _quanleidaAnimation() {
        var quanleida = cc.instantiate(this.quanleida);
        this.node.addChild(quanleida);
        var bg = quanleida.getChildByName('bg');
        var ball = quanleida.getChildByName('ball');
        var bangqiutao = quanleida.getChildByName('bangqiutao');
        var bangqiugun = quanleida.getChildByName('bangqiugun');
        var Lyun = quanleida.getChildByName('Lyun');
        var Ryun = quanleida.getChildByName('Ryun');
        var title = quanleida.getChildByName('title');
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.2, 2.5, 2.5), cc.scaleTo(0.2, 1.5, 1.5), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(0, 20)), cc.moveTo(0.3, cc.v2(0, 0))), 2)));

            Lyun.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 20, 20), cc.moveTo(0.2, cc.v2(-270, 70))), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(-270, 26)), cc.moveTo(0.3, cc.v2(-270, 46))), 2)));

            Ryun.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 20, 20), cc.moveTo(0.2, cc.v2(270, 70))), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(270, 66)), cc.moveTo(0.3, cc.v2(270, 46))), 2)));

            bangqiutao.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.3, 10, 10), cc.moveTo(0.3, cc.v2(250, 50))), bqtFinished));
        });
        var bqtFinished = cc.callFunc(function () {
            bangqiutao.runAction(cc.repeat(cc.sequence(cc.rotateTo(0.2, -10), cc.rotateTo(0.2, 0)), 3));
            ball.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.1, 255), cc.moveTo(0.2, cc.v2(196, 83))), ballFinished));
        });
        var ballFinished = cc.callFunc(function () {
            ball.runAction(cc.spawn(cc.fadeTo(0.2, 0), cc.moveTo(0.2, cc.v2(0, 0)), cc.scaleTo(0.2, 4, 4)));
            bangqiugun.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 2, 2), cc.fadeTo(0.2, 255)), cc.scaleTo(0.3, 1.5, 1.5)));
            setTimeout(function () {
                bg.runAction(cc.fadeTo(0.2, 0));
                ball.runAction(cc.fadeTo(0.2, 0));
                bangqiutao.runAction(cc.fadeTo(0.2, 0));
                bangqiugun.runAction(cc.fadeTo(0.2, 0));
                Lyun.runAction(cc.fadeTo(0.2, 0));
                Ryun.runAction(cc.fadeTo(0.2, 0));
                title.runAction(cc.fadeTo(0.2, 0));

                quanleida.removeFromParent(true);
            }, 2000);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    },

    // 三同花动画
    _santonghuaAnimation: function _santonghuaAnimation() {
        var santonghua = cc.instantiate(this.santonghua);
        this.node.addChild(santonghua);
        var bg = santonghua.getChildByName('bg');
        var hua1 = santonghua.getChildByName('hua1');
        var hua2 = santonghua.getChildByName('hua2');
        var hua3 = santonghua.getChildByName('hua3');
        var Rtaohua = santonghua.getChildByName('Rtaohua');
        var Ltaohua = santonghua.getChildByName('Ltaohua');
        var title = santonghua.getChildByName('title');
        var self = this;
        //var H1 = cc.instantiate(hua1);
        var A = [],
            B = [],
            C = [];
        var hua = [];
        for (var i = 0; i < 5; i++) {
            A[i] = cc.instantiate(hua1);
            A[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(A[i]);
            B[i] = cc.instantiate(hua2);
            B[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(B[i]);
            C[i] = cc.instantiate(hua3);
            C[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(C[i]);
        };
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), cc.scaleTo(0.2, 1, 1), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.1, 1.8, 1.8)));
            Ltaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(-160, -60)))));
            Rtaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(140, -60)))));
            for (var i = 1; i < hua.length; i++) {
                hua[i].setPosition(self._bezier(i)[1]);
                santonghua.addChild(hua[i]);
                hua[i].runAction(cc.sequence(cc.spawn(cc.bezierTo(0.3, self._bezier(i)[0]), cc.scaleTo(0.3, 1, 1), cc.fadeTo(0.3, 0))));
            }
            setTimeout(function () {
                bg.runAction(cc.fadeTo(0.2, 0));
                Rtaohua.runAction(cc.fadeTo(0.2, 0));
                Ltaohua.runAction(cc.fadeTo(0.2, 0));
                title.runAction(cc.fadeTo(0.2, 0));
                santonghua.removeFromParent(true);
            }, 1500);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.3, 255), cc.scaleTo(0.3, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    },
    // 贝塞尔曲线(只能定三个点)
    _bezier: function _bezier(index) {
        var bezier = [];
        bezier[0] = [[cc.v2(200, 74), cc.v2(250, 124), cc.v2(400, -174)], cc.v2(200, 74)];
        bezier[1] = [[cc.v2(-72, 284), cc.v2(-122, 334), cc.v2(-272, -150)], cc.v2(-72, 284)];
        bezier[2] = [[cc.v2(-270, 300), cc.v2(-320, 350), cc.v2(-420, -200)], cc.v2(-270, 300)];
        bezier[3] = [[cc.v2(-223, 213), cc.v2(-273, 263), cc.v2(-373, -160)], cc.v2(-223, 213)];
        bezier[4] = [[cc.v2(210, 237), cc.v2(260, 287), cc.v2(360, -177)], cc.v2(210, 237)];
        bezier[5] = [[cc.v2(183, 115), cc.v2(233, 164), cc.v2(333, -155)], cc.v2(183, 115)];
        bezier[6] = [[cc.v2(92, 116), cc.v2(142, 166), cc.v2(242, -146)], cc.v2(92, 116)];
        bezier[7] = [[cc.v2(-26, 124), cc.v2(-76, 174), cc.v2(-176, -164)], cc.v2(-26, 124)];
        bezier[8] = [[cc.v2(-310, 81), cc.v2(-360, 131), cc.v2(-460, -180)], cc.v2(-310, 81)];
        bezier[9] = [[cc.v2(-125, 33), cc.v2(-175, 83), cc.v2(-275, -133)], cc.v2(-125, 33)];
        bezier[10] = [[cc.v2(0, 0), cc.v2(50, 50), cc.v2(150, -150)], cc.v2(0, 0)];
        bezier[11] = [[cc.v2(-235, 5), cc.v2(-275, 55), cc.v2(-375, -86)], cc.v2(-235, 5)];
        bezier[12] = [[cc.v2(-80, 4), cc.v2(-130, 54), cc.v2(-230, -233)], cc.v2(-80, 4)];
        bezier[13] = [[cc.v2(100, -7), cc.v2(150, 57), cc.v2(250, -177)], cc.v2(100, -7)];
        bezier[14] = [[cc.v2(254, 23), cc.v2(304, 73), cc.v2(404, -173)], cc.v2(254, 23)];
        return bezier[index];
    },

    // 六对半动画
    _liuduibanAnimation: function _liuduibanAnimation() {
        var liuduiban = cc.instantiate(this.liuduiban);
        this.node.addChild(liuduiban);
        var bg = liuduiban.getChildByName('bg');
        var Lqi = liuduiban.getChildByName('Lqi');
        var Rqi = liuduiban.getChildByName('Rqi');
        var Cqi = liuduiban.getChildByName('Cqi');
        var Rtaohua = liuduiban.getChildByName('Rtaohua');
        var Ltaohua = liuduiban.getChildByName('Ltaohua');
        var title = liuduiban.getChildByName('title');

        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.1, 2.5, 2.5), cc.scaleTo(0.1, 1.8, 1.8), Finished));
            Ltaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(-160, -60)))));
            Rtaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(140, -60)))));
        });
        var Finished = cc.callFunc(function () {
            Lqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(-103, 158))), cc.moveTo(0.2, cc.v2(-103, 168)), cc.moveTo(0.2, cc.v2(-103, 158))));
            Rqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(133, 160))), cc.moveTo(0.2, cc.v2(133, 170)), cc.moveTo(0.2, cc.v2(133, 160))));
            setTimeout(function () {
                Cqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(20, 96))), cc.moveTo(0.2, cc.v2(20, 106)), cc.moveTo(0.2, cc.v2(20, 96))));
                Ltaohua.runAction(cc.sequence(cc.repeat(cc.sequence(cc.rotateTo(0.3, 10), cc.rotateTo(0.3, 0)), 2), thFinished));
                Rtaohua.runAction(cc.repeat(cc.sequence(cc.rotateTo(0.3, -10), cc.rotateTo(0.3, 0)), 2));
            }, 500);
        });
        var thFinished = cc.callFunc(function () {
            bg.runAction(cc.fadeTo(0.2, 0));
            Lqi.runAction(cc.fadeTo(0.2, 0));
            Rqi.runAction(cc.fadeTo(0.2, 0));
            Cqi.runAction(cc.fadeTo(0.2, 0));
            Rtaohua.runAction(cc.fadeTo(0.2, 0));
            Ltaohua.runAction(cc.fadeTo(0.2, 0));
            title.runAction(cc.fadeTo(0.2, 0));
            liuduiban.removeFromParent(true);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    }
});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"cardNum":[function(require,module,exports){
"use strict";
cc._RFpush(module, '19329zUw3hCTpBk+7waBT2d', 'cardNum');
// scripts\cardNum.js

cc.Class({
    "extends": cc.Component,

    properties: {

        cards: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.totalCards();
    },
    totalCards: function totalCards() {
        // var create = this.node.children;
        //console.log(this.node);
        var renshu = this.node.getChildByName("renshu");
        var jushu = this.node.getChildByName("jushu");
        var getCard = this.node.getChildByName("cards");
        //var renshu = create[3], jushu = create[4], getCard = create[6];

        var rs = renshu.getComponent("singleSelect").selectedIndex;
        var js = jushu.getComponent("singleSelect").selectedIndex;
        var gc = getCard.getComponent("singleSelect").selectedIndex;

        var R = 1,
            J = 1,
            G = 1;
        switch (rs) {
            case 0:
                R = 1;break;
            case 1:
                R = 2;break;
            case 2:
                R = 3;break;
            case 3:
                R = 4;break;
        }
        switch (js) {
            case 0:
                J = 1;break;
            case 1:
                J = 2;break;
            case 2:
                J = 3;break;
        }
        switch (gc) {
            case 0:
                G = 1;break; // AA制
            default:
                G = 0;break;
        }
        this.cards.string = R + J;
        //this.cards.string = G ? (R+J):(R+J)*(R+3);  // (R+J)表示每个人要出的房卡量；(R+3)表示一共有多少人，  
    }
});

cc._RFpop();
},{}],"cardsBack":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98986IsXIdHiqLGEVIG2CWP', 'cardsBack');
// scripts\cardsBack.js

// 牌背影列表 component
// 可以显示、隐藏牌背影列表
cc.Class({
  "extends": cc.Component,

  properties: {
    cardsBackLayout: cc.Layout,
    cardsBackList: [cc.Sprite]
  },

  // use this for initialization
  onLoad: function onLoad() {},

  // 以动画的方式显示牌背影
  showPlayCardBacks: function showPlayCardBacks() {
    this.hideCardBacks();
    this.cardsBackLayout.node.active = true;

    var interval = 0.05;
    var startTime = 0;
    this.cardsBackList.forEach((function (cardBack) {
      this.scheduleOnce(function () {
        cardBack.node.active = true;
      }, startTime);
      startTime = startTime + interval;
    }).bind(this));
  },

  // 隐藏显示牌背影
  hideCardBacks: function hideCardBacks() {
    this.cardsBackLayout.node.active = false;
    this.cardsBackList.forEach(function (cardBack) {
      cardBack.node.active = false;
    });
  }
});

cc._RFpop();
},{}],"cards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0fcbct/TBxC742saKLuFviQ', 'cards');
// scripts\cards.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        /*牌花色*/
        spadesImages: [cc.SpriteFrame],
        heartsImages: [cc.SpriteFrame],
        clubImages: [cc.SpriteFrame],
        diamondImages: [cc.SpriteFrame]
    },

    // use this for initialization
    onLoad: function onLoad() {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"cellText":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9c9fd3OxWNEp4rijfjJv05t', 'cellText');
// scripts\cellText.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        labelMsg: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setText: function setText(text) {
        this.labelMsg.getComponent(cc.Label).string = text;
    },

    clickAction: function clickAction() {
        var text = this.labelMsg.getComponent(cc.Label).string;
        this.onSelectAction(text);
    },

    onSelectAction: function onSelectAction(msg) {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"changInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cb225d0jXtB0JToI7yXR0hG', 'changInfo');
// scripts\changInfo.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        phoneEditBox: cc.EditBox,
        wxEditBox: cc.EditBox,
        alert: cc.Prefab,
        canvas: cc.Node,
        _userId: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        this._registerSocketEvent();
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveOnChangeInfo, this._ReceiveChangeInfo, this);
    },
    _ReceiveChangeInfo: function _ReceiveChangeInfo(response) {
        var changedRows = response.data;
        var msg = '';
        //console.log(response);
        //console.log(changedRows);
        //console.log("-------------------------------38");
        if (changedRows) {
            msg = "更改成功";
        } else {
            msg = "今天已经更新过了，请明天再更新";
        }
        this.alertMsg(msg);
    },
    clickAction: function clickAction() {
        var wx = this.wxEditBox.string;
        var phone = this.phoneEditBox.string;
        var info = {};
        var msg = '';
        if (!wx && !phone) {
            msg = "请填写微信号和手机号";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (!/(^[1-9]\d*$)/.test(phone)) {
            msg = "您输入的手机号码格式不对，请重新输入";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (phone.length != 11) {
            msg = "您输入的手机号码不够11位，请重新输入";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (!/(^[1-9a-zA-Z]\d*$)/.test(wx)) {
            msg = "您输入的微信号格式不对，请重新输入";
            wx = "";
            this.alertMsg(msg);
            return;
        }
        if (wx.length < 6 || wx.length > 20) {
            msg = "您输入的微信号格式超出范围，请输入6~20位的微信号";
            wx = "";
            this.alertMsg(msg);
            return;
        }
        info.wx = wx;
        info.phone = phone;
        Socket.sendChangeInfo(this._userId, info);
    },

    alertMsg: function alertMsg(msg) {
        var alert = cc.instantiate(this.alert);
        this.canvas.addChild(alert);
        var comp = alert.getComponent('alert');
        comp.setMessage(msg);
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"change_mapai":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'ed8274emaRL471ny4dnQ8cA', 'change_mapai');
// scripts\change_mapai.js

cc.Class({
    "extends": cc.Component,

    properties: {

        mPtitle: cc.Label,
        _cards: [],
        renshuSelect: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        var hs = 3;
        var ds = 5;
        if (cc.set) {
            hs = cc.set.setting7[0];
            ds = cc.set.setting7[1];
        }
        this._cards = [hs, ds];
        this.mp(hs, ds);
    },
    change: function change() {
        var selectedIndex = this.renshuSelect.getComponent('singleSelect').selectedIndex;
        var hs = Math.ceil(Math.random() * 40 / 10); //获取一个1~4的数字，代表花色
        var ds = Math.ceil(Math.random() * 130 / 10); //获取一个1~13的数字，代表点数
        var card = [hs, ds];
        this._cards = card;
        this.mp(hs, ds, selectedIndex);
    },
    mp: function mp(h, d, index) {
        var ma = "单码";
        var hs = ["方块", "梅花", "红桃", "黑桃"];
        var ds = ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"];
        if (index) {
            var defaultMa = 4;
            if (h >= defaultMa - index + 1) {
                ma = "双码";
            }
        }
        this.mPtitle.string = hs[h - 1] + ds[d - 1] + ma;
    }
});

cc._RFpop();
},{}],"checkSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '974a0c6jzZPRI5AeaAb4U0z', 'checkSelect');
// scripts\checkSelect.js

cc.Class({
    "extends": cc.Component,

    properties: {
        selectedIndex: 0,
        selectedNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selected = true;
        this.selectedIndex = 0;
        this.selectedNode.active = true;
    },
    clickAction: function clickAction(e, data) {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        this.selectedIndex = this.selected ? 0 : null;
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"choujiang":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f64e0whLhNLmbOHtPpK94CG', 'choujiang');
// scripts\choujiang.js

var socket = require("socket");
cc.Class({
    "extends": cc.Component,

    properties: {
        option: {
            "default": [],
            type: cc.Node
        }
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickBtnchoujiang: function clickBtnchoujiang() {
        for (var i = 0; i < this.option.length; i++) {
            this.option[i].opacity = 255;
        }
        var index = 0;
        this._tishi = this.node.getChildByName("choujiang_bg").getChildByName("tishi");
        this._card_num = cc.find("Canvas/user/shop_bg/card_num");
        var comp = this._card_num.getComponent(cc.Label);
        this.callback = function () {
            if (index == 0) {
                this.option[index].opacity = 128;
                this.option[this.option.length - 1].opacity = 255;
            } else if (index == 1) {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            } else {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            }
            index++;
            if (index == this.option.length) {
                index = 0;
            }
        };
        if (comp.string < 20) {
            this._tishi.active = true;
        } else {
            //choujiang
            this.schedule(this.callback, 0.05);
            this.schedule(function () {
                this.unschedule(this.callback);
                for (var i = 0; i < this.option.length; i++) {
                    this.option[i].opacity = 255;
                }
                var i = Math.floor(Math.random() * 12);
                this.option[i].opacity = 128;
            }, 3, 0, 1);
        }
    },

    //***
    clickBtnComfirm: function clickBtnComfirm() {
        this._tishi.active = false;
        //this.node.active = false;
    }
});
//****

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"socket":"socket"}],"create_btn_anima":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'df337riLglP3YcI/IJFXecj', 'create_btn_anima');
// scripts\create_btn_anima.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...

    },

    // use this for initialization
    onLoad: function onLoad() {},
    loadCardSpriteFrame: function loadCardSpriteFrame(cardName, callback) {
        this._loadCardFrame(cardName, callback);
    },
    _cardFullName: function _cardFullName(cardShortName) {
        var cardName = cardShortName;
        if (!cardName.startsWith("public-pic-card-poker")) {
            cardName = "public-pic-card-poker-" + cardName;
        }
        return cardName;
    },
    _loadCardFrame: function _loadCardFrame(cardName, callback) {
        cc.assert(callback);
        cc.loader.loadRes("play/hall/public/all_effect_ttw_main", cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                callback(null, err);
                return;
            }
            cardName = this._cardFullName(cardName);
            var frame = atlas.getSpriteFrame(cardName);
            callback(frame);
        }).bind(this));
    },
    test: function test() {}

});

cc._RFpop();
},{}],"daikai":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f6c69jpXLVAEZuQjdkc2pyH', 'daikai');
// scripts\daikai.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        //selectedIndex: 0,
        _selected: 1
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        this._select = true;
        var daikai = 0;
        if (cc.set) {
            daikai = cc.set.setting9;
            this._selected = this._select = daikai;
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select;
            this._selected = this._select;
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (self._select) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                this.setSelected(self._selected = self._select = !self._select);
                var title = this.node.getChildByName("title");
                if (self._select) {
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    title.color = new cc.Color(255, 255, 255);
                }
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "orders" && cc.set) {
            //this.remember_set(overTime);
        }
    },
    remember_set: function remember_set(obj) {
        for (var i = 0; i < this.nodes.length; i++) {
            this.nodes[i].getComponent('select').setSelected(obj);
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (obj) {
                var title = this.nodes[0].getChildByName('title');
                title.color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
    }

});

cc._RFpop();
},{}],"fecha":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e517077l0xMarB9uQsXGzvk', 'fecha');
// scripts\Extensions\fecha.js

(function (main) {
  'use strict';

  /**
   * Parse or format dates
   * @class fecha
   */
  var fecha = {};
  var token = /d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g;
  var twoDigits = /\d\d?/;
  var threeDigits = /\d{3}/;
  var fourDigits = /\d{4}/;
  var word = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;
  var literal = /\[([^]*?)\]/gm;
  var noop = function noop() {};

  function shorten(arr, sLen) {
    var newArr = [];
    for (var i = 0, len = arr.length; i < len; i++) {
      newArr.push(arr[i].substr(0, sLen));
    }
    return newArr;
  }

  function monthUpdate(arrName) {
    return function (d, v, i18n) {
      var index = i18n[arrName].indexOf(v.charAt(0).toUpperCase() + v.substr(1).toLowerCase());
      if (~index) {
        d.month = index;
      }
    };
  }

  function pad(val, len) {
    val = String(val);
    len = len || 2;
    while (val.length < len) {
      val = '0' + val;
    }
    return val;
  }

  var dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
  var monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  var monthNamesShort = shorten(monthNames, 3);
  var dayNamesShort = shorten(dayNames, 3);
  fecha.i18n = {
    dayNamesShort: dayNamesShort,
    dayNames: dayNames,
    monthNamesShort: monthNamesShort,
    monthNames: monthNames,
    amPm: ['am', 'pm'],
    DoFn: function DoFn(D) {
      return D + ['th', 'st', 'nd', 'rd'][D % 10 > 3 ? 0 : (D - D % 10 !== 10) * D % 10];
    }
  };

  var formatFlags = {
    D: function D(dateObj) {
      return dateObj.getDate();
    },
    DD: function DD(dateObj) {
      return pad(dateObj.getDate());
    },
    Do: function Do(dateObj, i18n) {
      return i18n.DoFn(dateObj.getDate());
    },
    d: function d(dateObj) {
      return dateObj.getDay();
    },
    dd: function dd(dateObj) {
      return pad(dateObj.getDay());
    },
    ddd: function ddd(dateObj, i18n) {
      return i18n.dayNamesShort[dateObj.getDay()];
    },
    dddd: function dddd(dateObj, i18n) {
      return i18n.dayNames[dateObj.getDay()];
    },
    M: function M(dateObj) {
      return dateObj.getMonth() + 1;
    },
    MM: function MM(dateObj) {
      return pad(dateObj.getMonth() + 1);
    },
    MMM: function MMM(dateObj, i18n) {
      return i18n.monthNamesShort[dateObj.getMonth()];
    },
    MMMM: function MMMM(dateObj, i18n) {
      return i18n.monthNames[dateObj.getMonth()];
    },
    YY: function YY(dateObj) {
      return String(dateObj.getFullYear()).substr(2);
    },
    YYYY: function YYYY(dateObj) {
      return dateObj.getFullYear();
    },
    h: function h(dateObj) {
      return dateObj.getHours() % 12 || 12;
    },
    hh: function hh(dateObj) {
      return pad(dateObj.getHours() % 12 || 12);
    },
    H: function H(dateObj) {
      return dateObj.getHours();
    },
    HH: function HH(dateObj) {
      return pad(dateObj.getHours());
    },
    m: function m(dateObj) {
      return dateObj.getMinutes();
    },
    mm: function mm(dateObj) {
      return pad(dateObj.getMinutes());
    },
    s: function s(dateObj) {
      return dateObj.getSeconds();
    },
    ss: function ss(dateObj) {
      return pad(dateObj.getSeconds());
    },
    S: function S(dateObj) {
      return Math.round(dateObj.getMilliseconds() / 100);
    },
    SS: function SS(dateObj) {
      return pad(Math.round(dateObj.getMilliseconds() / 10), 2);
    },
    SSS: function SSS(dateObj) {
      return pad(dateObj.getMilliseconds(), 3);
    },
    a: function a(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0] : i18n.amPm[1];
    },
    A: function A(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0].toUpperCase() : i18n.amPm[1].toUpperCase();
    },
    ZZ: function ZZ(dateObj) {
      var o = dateObj.getTimezoneOffset();
      return (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4);
    }
  };

  var parseFlags = {
    D: [twoDigits, function (d, v) {
      d.day = v;
    }],
    Do: [new RegExp(twoDigits.source + word.source), function (d, v) {
      d.day = parseInt(v, 10);
    }],
    M: [twoDigits, function (d, v) {
      d.month = v - 1;
    }],
    YY: [twoDigits, function (d, v) {
      var da = new Date(),
          cent = +('' + da.getFullYear()).substr(0, 2);
      d.year = '' + (v > 68 ? cent - 1 : cent) + v;
    }],
    h: [twoDigits, function (d, v) {
      d.hour = v;
    }],
    m: [twoDigits, function (d, v) {
      d.minute = v;
    }],
    s: [twoDigits, function (d, v) {
      d.second = v;
    }],
    YYYY: [fourDigits, function (d, v) {
      d.year = v;
    }],
    S: [/\d/, function (d, v) {
      d.millisecond = v * 100;
    }],
    SS: [/\d{2}/, function (d, v) {
      d.millisecond = v * 10;
    }],
    SSS: [threeDigits, function (d, v) {
      d.millisecond = v;
    }],
    d: [twoDigits, noop],
    ddd: [word, noop],
    MMM: [word, monthUpdate('monthNamesShort')],
    MMMM: [word, monthUpdate('monthNames')],
    a: [word, function (d, v, i18n) {
      var val = v.toLowerCase();
      if (val === i18n.amPm[0]) {
        d.isPm = false;
      } else if (val === i18n.amPm[1]) {
        d.isPm = true;
      }
    }],
    ZZ: [/([\+\-]\d\d:?\d\d|Z)/, function (d, v) {
      if (v === 'Z') v = '+00:00';
      var parts = (v + '').match(/([\+\-]|\d\d)/gi),
          minutes;

      if (parts) {
        minutes = +(parts[1] * 60) + parseInt(parts[2], 10);
        d.timezoneOffset = parts[0] === '+' ? minutes : -minutes;
      }
    }]
  };
  parseFlags.dd = parseFlags.d;
  parseFlags.dddd = parseFlags.ddd;
  parseFlags.DD = parseFlags.D;
  parseFlags.mm = parseFlags.m;
  parseFlags.hh = parseFlags.H = parseFlags.HH = parseFlags.h;
  parseFlags.MM = parseFlags.M;
  parseFlags.ss = parseFlags.s;
  parseFlags.A = parseFlags.a;

  // Some common format strings
  fecha.masks = {
    'default': 'ddd MMM DD YYYY HH:mm:ss',
    shortDate: 'M/D/YY',
    mediumDate: 'MMM D, YYYY',
    longDate: 'MMMM D, YYYY',
    fullDate: 'dddd, MMMM D, YYYY',
    shortTime: 'HH:mm',
    mediumTime: 'HH:mm:ss',
    longTime: 'HH:mm:ss.SSS'
  };

  /***
   * Format a date
   * @method format
   * @param {Date|number} dateObj
   * @param {string} mask Format of the date, i.e. 'mm-dd-yy' or 'shortDate'
   */
  fecha.format = function (dateObj, mask, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof dateObj === 'number') {
      dateObj = new Date(dateObj);
    }

    if (Object.prototype.toString.call(dateObj) !== '[object Date]' || isNaN(dateObj.getTime())) {
      throw new Error('Invalid Date in fecha.format');
    }

    mask = fecha.masks[mask] || mask || fecha.masks['default'];

    var literals = [];

    // Make literals inactive by replacing them with ??
    mask = mask.replace(literal, function ($0, $1) {
      literals.push($1);
      return '??';
    });
    // Apply formatting rules
    mask = mask.replace(token, function ($0) {
      return $0 in formatFlags ? formatFlags[$0](dateObj, i18n) : $0.slice(1, $0.length - 1);
    });
    // Inline literal values back into the formatted value
    return mask.replace(/\?\?/g, function () {
      return literals.shift();
    });
  };

  /**
   * Parse a date string into an object, changes - into /
   * @method parse
   * @param {string} dateStr Date string
   * @param {string} format Date parse format
   * @returns {Date|boolean}
   */
  fecha.parse = function (dateStr, format, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof format !== 'string') {
      throw new Error('Invalid format in fecha.parse');
    }

    format = fecha.masks[format] || format;

    // Avoid regular expression denial of service, fail early for really long strings
    // https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
    if (dateStr.length > 1000) {
      return false;
    }

    var isValid = true;
    var dateInfo = {};
    format.replace(token, function ($0) {
      if (parseFlags[$0]) {
        var info = parseFlags[$0];
        var index = dateStr.search(info[0]);
        if (! ~index) {
          isValid = false;
        } else {
          dateStr.replace(info[0], function (result) {
            info[1](dateInfo, result, i18n);
            dateStr = dateStr.substr(index + result.length);
            return result;
          });
        }
      }

      return parseFlags[$0] ? '' : $0.slice(1, $0.length - 1);
    });

    if (!isValid) {
      return false;
    }

    var today = new Date();
    if (dateInfo.isPm === true && dateInfo.hour != null && +dateInfo.hour !== 12) {
      dateInfo.hour = +dateInfo.hour + 12;
    } else if (dateInfo.isPm === false && +dateInfo.hour === 12) {
      dateInfo.hour = 0;
    }

    var date;
    if (dateInfo.timezoneOffset != null) {
      dateInfo.minute = +(dateInfo.minute || 0) - +dateInfo.timezoneOffset;
      date = new Date(Date.UTC(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0));
    } else {
      date = new Date(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0);
    }
    return date;
  };

  /* istanbul ignore next */
  if (typeof module !== 'undefined' && module.exports) {
    module.exports = fecha;
  } else if (typeof define === 'function' && define.amd) {
    define(function () {
      return fecha;
    });
  } else {
    main.fecha = fecha;
  }
})(this);

cc._RFpop();
},{}],"game":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45811N61jFFA6UrygQla5+x', 'game');
// scripts\game.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        messageNode: cc.Node,
        playNode: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {},

    showMessageAlert: function showMessageAlert() {
        this.messageNode.active = true;
        var comp = this.messageNode.getComponent(cc.Animation);
        comp.play('pop');
    },

    dismissMessageAlert: function dismissMessageAlert() {
        var self = this;
        this.scheduleOnce(function () {
            self.messageNode.active = false;
        }, 0.3);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"hall_btn_anima":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b8a30Txa91I27+7HOFLyJA6', 'hall_btn_anima');
// scripts\hall_btn_anima.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        create_anima: {
            type: cc.SpriteFrame,
            "default": []
        }
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"hall":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1e6741Q2VFGDLupV88mg60Z', 'hall');
// scripts\hall.js

"use strict";
cc._RFpush(module, '1e6741Q2VFGDLupV88mg60Z', 'hall');
// scripts\hall.js

var manager = require('manager');
var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var Playback = require('Playback');

var hall = cc.Class({
    'extends': cc.Component,

    properties: {

        //productNodes:[cc.Node],
        shopAlertNode: cc.Node,
        createNode: cc.Node,
        joinNode: cc.Node,
        gengxin: cc.Node,
        alertPrefab: cc.Prefab,
        tsSingleSelect: [cc.Node], // 创建房间信息，单选
        tsCheckSeclect: [cc.Node], // 创建房间信息，复选
        selectMoShi: cc.Node, // 创建房间信息，模式（庄家模式和无特殊牌）
        selectGuiPai: cc.Node, // 创建房间信息，模式（庄家模式和无特殊牌）
        overTime: cc.Node, // 超时出牌
        daikai: cc.Node, //代开房
        my_room: cc.Node, //代开窗口
        zhongtujinru: cc.Node, //中途进入
        //labelNotice: cc.Label,      // 公告
        labelBanner: cc.Label, // banner label
        recordNode: cc.Node,
        waitingPrefab: cc.Prefab,
        setting: cc.Node,
        //用户信息
        avatarNode: cc.Node,
        nickNameLabel: cc.Label,
        cardNumberLabel: cc.Label,
        userIdLabel: cc.Label,
        codeLabel: cc.Label,
        //phone:cc.Label,
        // userInfoMsgNode:cc.Node,
        logoutNode: cc.Node,
        //战绩
        recordMsgNode: cc.Node,
        feedbackEditBox: cc.EditBox, //反馈
        feedbackNode: cc.Node,
        wxshare: cc.Node,
        _userId: 0,
        _openId: null,
        _help: null,
        _close: null,
        iosUrl: null,
        aUrl: null

    },

    statics: {
        lastHallInfo: null, // 上一次收到的大厅信息
        cacheImageInfo: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.keyBackListen();
        if (cc.sys.isBrowser) {
            if (window.shareToTimeLine) {
                window.shareToTimeLine();
            }
            if (window.shareToSession) {
                window.shareToSession();
            }
        }
        cc.sys.localStorage.removeItem("timestamp");
        var bg = this.node.getChildByName("room_bg");
        var windowP = cc.director.getWinSizeInPixels();
        var scaleX = windowP.width / bg.width;
        var scaleY = windowP.height / bg.height;
        var scale = Math.max(scaleX, scaleY);
        bg.scaleX = scale;
        bg.scaleY = scale;
        this.clearLocalStorage();
        cc.from = {};
        cc.from.isUseMa = true;
        cc.from.ma = 0;
        cc.isRoomViewShow = false;
        this._btn = this.node.getChildByName("btn");
        this._buttons = this.node.getChildByName("buttons");
        var volume = cc.sys.localStorage.getItem("bgVolume");
        if (volume != null && parseInt(volume)) {
            AudioManager.instance.playMusic();
        }

        var bgSound = cc.sys.localStorage.getItem("bgSound");
        if (bgSound == 0) {
            var audioManager = cc.find('AudioManager');
            audioManager = audioManager.getComponent('AudioManager');
            audioManager.setEffectMusicVolum(bgSound);
        }
        Playback.instance.removePlaybackDatas();

        hall.cacheImageInfo = hall.cacheImageInfo || {};

        this._registerSocketEvent();
        this._startBannerAnimation();
        this._initJoinRoom();

        this._userId = Socket.instance.userInfo.id;
        this._openId = Socket.instance.userInfo.openId;
        this._inviteCode = Socket.instance.userInfo.inviteCode; //邀请码
        var self = this;
        this.socket = cc.find('GameSocket').getComponent('socket');
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
        };

        this.socket.connectionSuccess = function () {
            self.hiddenNetworkMessage();
            self.hiddenCheckMessage();
        };
        this.socket.connectionDisconnect = function () {
            self.showNetworkMessage('网络链接断开，重新连接中...');
        };
        this.socket.checkNetworkNow = function () {
            self.showCheckMessage('检查网络中...');
        };
        this.socket.checkNetworkEnd = function () {
            self.hiddenCheckMessage();
            self.hiddenNetworkMessage();
        };

        //  /*设置用户信息*/
        this.updateUserInfo();
        /*刷新用户信息*/
        Socket.sendGetUserInfo(this._userId, this._openId);
        /*定时刷新用户信息*/
        this.schedule((function () {
            Socket.sendGetUserInfo(this._userId, this._openId);
        }).bind(this), 10); //10s一次
        Socket.sendGetHallInfo(this.socket.userInfo.id);
        if (hall.lastHallInfo) {
            this.updateBanner(hall.lastHallInfo.info);
        }
        cc.onShareWXResp = null;
        cc.director.preloadScene('play', function () {
            cc.director.preloadScene('login');
        });
        if (cc.joinDesk != null) {
            if (!cc.joinDesk.result) {
                var reason = cc.joinDesk.reason;
                this.alertMessage(reason);
            }
            cc.joinDesk = null;
        }
        if (cc.qingli != null) {
            this.alertMessage("您被房主请出房间");
            cc.qingli = null;
        }
        //var creatAnima = this.node.getChildByName("create_room");
    },

    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },

    clickWxShare: function clickWxShare() {
        if (!cc.sys.isNative) {
            console.log("clickWxShare");
            this.wxshare.active = true;
        } else {
            console.log("clickWxShare native");
            var title = cc.sys.localStorage.getItem('shareTitle');
            var description = cc.sys.localStorage.getItem('desc');
            var recordId = cc.sys.localStorage.getItem('recordId');
            var id = '';
            if (recordId) {
                id = 'recordId=' + recordId;
            }

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
            }
        }
    },

    //分享到朋友圈
    shareHallTimeline: function shareHallTimeline() {
        if (!cc.sys.isNative) {
            this.wxshare.active = true;
        } else {
            var title = cc.sys.localStorage.getItem('shareTitle');
            var description = cc.sys.localStorage.getItem('desc');
            var recordId = cc.sys.localStorage.getItem('recordId');
            var id = '';
            if (recordId) {
                id = 'recordId=' + recordId;
            }

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
            }
        }
    },

    shareBg: function shareBg() {
        if (!cc.sys.isNative) {
            this.wxshare.active = false;
        } else {
            // if (KQNativeInvoke.isNativeIOS()) {
            //     jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,"wxShareHallTimeline",id, description,title);
            // }
            // else {//Android
            //     var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            //     jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str,id, description,title);
            // }
        }
    },

    clearLocalStorage: function clearLocalStorage() {
        var shareTitle = '开房玩[大众十三水]';
        var desc = '开好房了，就等你们一起来[大众十三水]啦！晚了位置就没了哟~';
        cc.sys.localStorage.removeItem('roomId');
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
        this.socket.connectionSuccess = function () {};
        this.socket.connectionDisconnect = function () {};
        this.socket.checkNetworkNow = function () {};
        this.socket.checkNetworkEnd = function () {};

        KQGlobalEvent.offTarget(this);
    },

    _registerSocketEvent: function _registerSocketEvent() {
        //KQGlobalEvent.on(Socket.Event.ReceiveGetDaiKaiDesk, this._getDaikaiRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDaiKaiDesk, this._daikaiRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.JoinDesk, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveCreateDesk, this._createRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGetUserInfo, this._socketReceiveUserInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        //KQGlobalEvent.on(Socket.Event.ReceiveInviteCode, this._socketReceiveInviteCode, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        //KQGlobalEvent.on(Socket.Event.ReceiveSharePng, this._socketSharePng, this);
    },

    // 跳转到公众号
    guanzhu: function guanzhu() {
        // var url = "http://www.honggefeng.cn/gzh/index.html";
        // cc.sys.openURL(url)
    },
    _startBannerAnimation: function _startBannerAnimation() {
        var anim = this.labelBanner.getComponent(cc.Animation);
        anim.play('banner');
    },
    downLoad: function downLoad() {
        var url = 'https://fir.im/5tne';
        cc.sys.openURL(url);

        //window.location.href = "http://www.baidu.com";
        //console.log("？？？？？？？？");
    },

    _initJoinRoom: function _initJoinRoom() {
        var self = this;
        var joinRoom = this.joinNode.getComponent('joinRoom');

        joinRoom.callbackJoinRoom = function (number) {
            // self.joinNode.getComponent('alert').dismissAction();
            // self.showWaitingMessage('加入中...');
            // self.scheduleOnce(function() {
            //     self.hiddenWaitingMessage();
            // }, 2.0);

            /*加入房间请求*/
            var userId = Socket.instance.userInfo.id;
            Socket.sendJoinDesk(number, userId);
        };
    },

    _jiinRoomSocketCallback: function _jiinRoomSocketCallback(response) {
        var _this2 = this;

        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            (function () {
                if (cc.from == null) {
                    cc.from = {};
                }
                var joinRoom = _this2.joinNode.getComponent('joinRoom');

                _this2.joinNode.getComponent('alert').setAlertCallbck(function () {
                    joinRoom.clickClear();
                });
                cc.from.ma = response.data.maPai;
                cc.director.loadScene('play');
            })();
        } else {
            var reasonInfo = this._joinReasonMap(response.data.reason);
            this.alertMessage(reasonInfo);
        }
    },

    _daikaiRoomSocketCallback: function _daikaiRoomSocketCallback(response) {
        if (response.result)
            //this.showWaitingMessage(JSON.stringify(response.data.daikai));
            this.alertMessage(JSON.stringify(response.data.daikai));
    },
    //_getDaikaiRoomSocketCallback:function(response){
    //    //console.log("JSON.stringify(response.data.daikaiList)=====");
    //    if (response.result) {
    //        var daikaiList = JSON.stringify(response.data.daikaiList);
    //        cc.log(daikaiList,"接受到代开房数据：-----------------");
    //    }
    //    if(response.result)
    //    //this.showWaitingMessage(JSON.stringify(response.data.daikai));
    //        this.alertMessage(JSON.stringify(response.data));
    //},

    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!response.result) {
            return;
        }
        var data = response.data;
        hall.lastHallInfo = data;
        var isIOS = data.isIOS;
        var isAndroid = data.isA;
        var vIOS = data.vIOS;
        var vA = data.vA;
        this.iosUrl = data.iosUrl;
        this.aUrl = data.aUrl;
        if (cc.sys.isNative) {
            if (KQNativeInvoke.isNativeIOS()) {
                if (isIOS == 1) {
                    if (vIOS != '1.0.3') {
                        this.gengxin.active = true;
                    }
                }
            } else {
                //Android
                if (isAndroid == 1) {
                    if (vA != '1.0.4') {
                        this.gengxin.active = true;
                    }
                }
            }
        }
        var notice = data.broadcast;
        var banner = data.info;
        //this.updateNotice(notice);
        this.updateBanner(banner);
    },
    downloadNewVersion: function downloadNewVersion() {
        if (KQNativeInvoke.isNativeIOS()) {
            cc.sys.openURL(this.iosUrl);
            // jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", this.iosUrl);
        } else {
                //Android
                cc.sys.openURL(this.aUrl);
                // jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", this.aUrl);
            }
    },

    //分享也面
    clickOpenShare: function clickOpenShare() {
        if (!cc.sys.isNative) {
            var shareBg = cc.find("Canvas/shere_bg");
            shareBg.active = true;
            //var wxBg = this.shareBg.getChildByName("wx");
            //var pyqBg = this.shareBg.getChildByName("PYQ");
            //wxBg.active = true;
            //pyqBg.active = false;
            //this.shareBg.active = true;
        }
    },
    //关闭分享页面
    clickCloseShare: function clickCloseShare() {
        if (!cc.sys.isNative) {
            var shareBg = cc.find("Canvas/shere_bg");
            shareBg.active = false;
            //var wxBg = this.shareBg.getChildByName("wx");
            //var pyqBg = this.shareBg.getChildByName("PYQ");
            //wxBg.active = true;
            //pyqBg.active = false;
            //this.shareBg.active = true;
        }
    },
    _createRoomSocketCallback: function _createRoomSocketCallback(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            cc.director.loadScene('play');
        }
        /*如果钻石不足，则提示*/
        else {
                this.alertMessage("您的钻石不足");
            }
    },

    _joinReasonMap: function _joinReasonMap(reason) {
        var reasonInfo = {
            notExist: "房间不存在!",
            cardNumber: "您房卡不足!"
        };

        var info = reasonInfo[reason] || "房间已满!";
        return info;
    },

    /*shop*/
    shopAction: function shopAction() {
        var comp = this.shopAlertNode.getComponent('alert');
        comp.alert();
    },
    /*提示*/
    alertMessage: function alertMessage(msg) {
        var node = cc.instantiate(this.alertPrefab);
        this.node.addChild(node);
        var comp = node.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    //updateNotice: function (notice) {
    //    if(this.labelNotice == null){
    //        return;
    //    }
    //  this.labelNotice.string = notice || "";
    //},

    updateBanner: function updateBanner() {
        var banner = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        if (this.labelBanner == null) {
            return;
        }
        this.labelBanner.string = banner;
    },

    /*#####
     * setting1 局数  (0 | 1 | 2 )
     * setting2 人数  (0 | 1 | 2 | 3)
     * setting3 玩法  (0 | 1 | 2 | 3 | 4)
     * setting4 AA制收取房费  (0 | 1 | 2 )
     * setting5 其他  (0)
     * setting6
     * setting7
     * */
    createDoneAction: function createDoneAction() {
        var info = {};
        var self = this;
        var key = ['setting1', 'setting2', 'setting4', 'setting5'];
        for (var i = 0; i < this.tsSingleSelect.length; i++) {
            var tsIndex = self.tsSingleSelect[i].getComponent('singleSelect').selectedIndex;
            info[key[i]] = tsIndex;
        }

        info['setting3'] = this.selectMoShi.getComponent('selectMoShi')._select;
        info['setting6'] = this.overTime.getComponent('overTime')._selected;
        info['setting9'] = this.daikai.getComponent('daikai')._selected;
        info['setting10'] = this.zhongtujinru.getComponent('zhongtujinru')._selected;
        //console.log( info['setting6'] );
        if (!info['setting3'][3]) {
            // 玩法 [疯狂场,鬼牌,比花色,坐庄,马牌] info['setting3'][3]第三项表示坐庄模式，非坐庄模式的倍率是1倍
            info['setting5'] = 0; // 倍率 (0~1) == (1~3倍)
        }
        info['setting8'] = null;

        info['setting7'] = this.selectMoShi.getComponent('change_mapai')._cards;
        cc.set = info;
        info['userId'] = this.socket.userInfo.id; //用户Id
        this.socket.sendMessage('createDesk', info);

        this.createNode.getComponent('alert').dismissAction();

        //let self = this;
        //this.showWaitingMessage('创建中...');
        this.scheduleOnce(function () {
            self.hiddenWaitingMessage();
        }, 2.0);
    },

    // 随机场
    /*clickRandRoom: function () {
     cc.director.loadScene('randRoom');
     },*/

    clickRecord: function clickRecord() {
        var comp = this.recordNode.getComponent('alert');
        comp.alert();
        Socket.sendGetRecrod(Socket.instance.userInfo.id);
    },

    clickGetDaiKai: function clickGetDaiKai() {
        // Socket.sendGetDaiKaiFang(Socket.instance.userInfo.id);
        Socket.sendGetDaiKaiFang(Socket.instance.userInfo.id);
        this.my_room.active = true;
    },

    clickPlayRule: function clickPlayRule() {
        //cc.director.loadScene('rule');
        this.help = this.node.getChildByName("help");
        var comp = this.help.getComponent('alert');
        comp.alert();
    },

    dismissComplete: function dismissComplete() {
        this.node.getChildByName("my_room").active = false;
    },

    clickPlay: function clickPlay() {
        if (cc.clickOut) cc.director.loadScene('play');
    },

    /*切换账号*/
    clickCancelLation: function clickCancelLation() {
        this.logoutNode.getComponent('alert').alert();
    },

    logoutAction: function logoutAction() {
        //manager.setUserInfo('');
        cc.director.loadScene('login');
        hall.cacheImageInfo = null;
    },

    exitAction: function exitAction() {
        //manager.setUserInfo('');
        if (!cc.sys.isNative) {
            cc.director.loadScene('login');
            hall.cacheImageInfo = null;
            return;
        }

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
        cc.director.end();
    },

    //接收处理用户数据
    _socketReceiveUserInfo: function _socketReceiveUserInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!this.socket.userInfo) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }
        //console.log(response,"----------------------用户信息");
        //this.phone.string = response.data.phone ? response.data.phone : "无";
        this.setting.getComponent('Setting')._phone = response.data.phone ? response.data.phone : null;
        this.setting.getComponent('Setting').phone.string = response.data.phone ? response.data.phone : '无';
        this.nickNameLabel.string = response.data.nickname; // 用户名
        this.userIdLabel.string = 'ID: ' + response.data.id; // ID
        this.cardNumberLabel.string = response.data.cardNumber;
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        cc.loader.load({ url: response.data.avatarUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;
            }
        });
    },

    _socketDisconnect: function _socketDisconnect() {
        this.showNetworkMessage("网络链接断开，重新连接中...");
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    //更新用户信息
    updateUserInfo: function updateUserInfo() {
        var info = this.socket.userInfo;
        if (!info) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }

        this.nickNameLabel.string = info.nickname;
        this.userIdLabel.string = 'ID: ' + info.id;
        this.cardNumberLabel.string = info.cardNumber;

        var avatarUrl = info.avatarUrl + ".jpg";
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        var texture = hall.cacheImageInfo[avatarUrl];
        if (texture) {
            var frame = new cc.SpriteFrame(texture);
            if (frame) {
                //cc.log("从缓存中加载头像");
                sprite.spriteFrame = frame;
                return;
            }
        }

        cc.loader.load({ url: info.avatarUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;

                hall.cacheImageInfo[avatarUrl] = tex;
            }
        });
    },

    /*提交意见*/
    feedbackAcion: function feedbackAcion() {
        var userId = this.socket.userInfo.id;
        var text = this.feedbackEditBox.string;
        if (text.length > 0) {
            this.feedbackNode.getComponent('alert').dismissAction();
            Socket.sendFeedback(userId, text);
            this.feedbackEditBox.string = '';
        }
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.sys.isObjectValid(this.waitingNode)) {
            this.waitingNode.destory();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    //network
    showNetworkMessage: function showNetworkMessage(msg) {
        if (this.networkNode && this.networkNode.active) {
            var _alert = this.networkNode.getComponent('alert');
            if (_alert.getMessage() == msg) {
                return;
            }
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage(msg) {
        if (!(this.checkNode && this.checkNode.active)) {} else {
            var _alert2 = this.checkNode.getComponent('alert');
            if (_alert2.getMessage() == msg) {
                return;
            }
        }

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },
    onBtnClick: function onBtnClick() {
        if (this._buttons.active) {
            this._buttons.active = false;
        } else {
            this._buttons.active = true;
        }
    }

});

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },
module.exports = hall;

cc._RFpop();

cc._RFpop();
},{"AudioManager":"AudioManager","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","manager":"manager","socket":"socket"}],"help":[function(require,module,exports){
"use strict";
cc._RFpush(module, '09981CwNMZOI4DHUg8u9kcj', 'help');
// scripts\help.js

cc.Class({
    "extends": cc.Component,
    properties: {
        /*sprites: {
            default: null,
            type: cc.SpriteAtlas
        },*/
        play_method_before: cc.Node, //玩法介绍
        play_method_content_label: cc.Node, //玩法介绍内容
        introduce_pai_before: cc.Node, //牌型介绍
        details: cc.Node, //牌型介绍内容
        caozuo_before: cc.Node, //操作介绍
        caozuo_content: cc.Node, //操作介绍内容
        _btn: null,
        _content: null,
        _buttonCom: null,
        _play_method_button: null,
        _introduce_pai_button: null,
        _caozuo_button: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        //this._play_method_button = this.play_method_before.getComponent(cc.Button);
        //this._introduce_pai_button = this.introduce_pai_before.getComponent(cc.Button);
        //this._caozuo_button = this.caozuo_before.getComponent(cc.Button);
        //this._btn = [this.play_method_before,this.introduce_pai_before,this.caozuo_before];
        //this._content = [this.play_method_content_label,this.details,this.caozuo_content];
        //this._buttonCom = [this._play_method_button,this._introduce_pai_button,this._caozuo_button];
        ////刚开始牌型介绍的按钮不可用
        //this._buttonCom[1].interactable = false;
    },
    // 点击玩法介绍
    onBtnPlayMethodClick: function onBtnPlayMethodClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[0].interactable = false;
        ////当前点击的对应的内容可见
        this._content[0].active = true;
    },
    //点击牌型介绍
    onBtnIntroducePaiClick: function onBtnIntroducePaiClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[1].interactable = false;
        ////当前点击的对应的内容可见
        //this._content[1].active = true;
    },
    //点击操作介绍
    onBtnCaozuoClick: function onBtnCaozuoClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[2].interactable = false;
        ////当前点击的对应的内容可见
        //this._content[2].active = true;
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"inviteCode":[function(require,module,exports){
"use strict";
cc._RFpush(module, '777f9/eB7RKK4aO7FmNYFgO', 'inviteCode');
// scripts\inviteCode.js

/**
 * 邀请码
 * @authors 黄成(you@example.org)
 * @date    2017-06-16 09:44:10
 * @version $Id$
 */
var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackInviteCode: ''
  },

  onLoad: function onLoad() {
    this.clickClear(); //清除数字
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
      //cc.log(label.string ,"----------------");
    } else {
        return;
      }
    var isComplete = this._lastEmptyLabel() == null;
    //cc.log("isComplete-------------", this.callbackInviteCode);
    var inviteNumber = this._inviteNumber();

    if (inviteNumber.length == 6) {
      //cc.log(inviteNumber,"--------------------38"); //邀请码
      var userId = Socket.instance.userInfo.id;
      //Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = inviteNumber;
    }
  },
  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackInviteCode;
    //cc.log(inviteNumber,"--------------------38")
    if (inviteNumber && inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = ''; //清空邀请码
    }
  },
  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _inviteNumber: function _inviteNumber() {
    return this.labelNumbers.reduce(function (inviteNumber, label) {
      //cc.log(inviteNumber,"-----------------");
      return inviteNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"joinRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd5dcb9CJvpPJpnsCQ/q197x', 'joinRoom');
// scripts\joinRoom.js

cc.Class({
  "extends": cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }

    var isComplete = this._lastEmptyLabel() == null;
    if (isComplete && this.callbackJoinRoom) {
      var roomNumber = this._roomNumber();
      // cc.log("要加入的房间号是：", roomNumber);
      this.callbackJoinRoom(roomNumber);
    }
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{}],"launch":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0efb2ngHglDtK2A+W4dmfzt', 'launch');
// scripts\launch.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.scheduleOnce(function () {
            cc.director.loadScene('login');
        }, 0.5);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"login":[function(require,module,exports){
(function (Buffer){
"use strict";
cc._RFpush(module, '9c72dn88ytPxZWrZRaxt5cr', 'login');
// scripts\login.js

var manager = require('manager');
var KQCard = require('KQCard');
var Socket = require('socket');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');

var APPID = 'wxe8993f468b16fa5d';
var ROOMID = '';
//授权地址
//正式地址
// var REDIRECT_URI = "http%3A%2F%2Fwww.honggefeng.cn%2FsszWeb%2Findex.php";
// 测试地址
var REDIRECT_URI = "http%3a%2f%2fo1o2.cn";

var HREF = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + APPID + "&redirect_uri=" + REDIRECT_URI + "&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";

cc.Class({

    'extends': cc.Component,
    properties: {
        //selectNode:cc.Node,
        alertPrefab: cc.Prefab,
        canvasNode: cc.Node,
        loadingNode: cc.Node,
        //err:cc.Node,
        waitingPrefab: cc.Prefab,
        recordInfo: cc.Prefab,
        label: cc.Label
    },

    goUpdateAction: function goUpdateAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod("AppController", "downloadNewVersion:", this.iosUrl);
        } else {
            //Android
            jsb.reflection.callStaticMethod("com/gongpa/ssz/AppActivity", "downloadNewVersion", "(Ljava/lang/String;)V", this.androidUrl);
        }
    },

    checkVersion: function checkVersion(vData) {
        //var version = vData.version;
        cc.info1 = vData.version;
        this.iosUrl = vData.iosUrl;
        this.androidUrl = vData.androidUrl;
        //if (manager.version != version) {//更新版本
        //    this.versionEnable = false;
        //    this.goUpdateAction();
        //    //this.versionLabel.string = '请到服务器更新到最新版本';
        //}
        //else {
        //this.versionLabel.string = '当前版本 ' + manager.version;
        if (KQNativeInvoke.isNativeIOS()) {
            // if(iosVersion != manager.version) {
            //     this.versionEnable = false;
            //     var updateAlert = cc.find("Canvas/update").getComponent("alert");
            //     updateAlert.alert();
            // }
            // else {
            this.versionEnable = true;
            var self = this;
            var info = manager.getUserInfo();
            if (info.length == 0) {
                this.loginEnable = true;
            }
            this.scheduleOnce(function () {
                if (info.length > 0) {
                    this.loginEnable = true;
                    self.loginAction();
                }
            }, 0.5);
            //}
        } else if (KQNativeInvoke.isNativeAndroid()) {
                // if(androidVersion != manager.version) {
                //     this.versionEnable = false;
                //     var updateAlert = cc.find("Canvas/update").getComponent("alert");
                //     updateAlert.alert();
                // }
                // else {
                this.versionEnable = true;
                var self = this;
                var info = manager.getUserInfo();
                if (info.length == 0) {
                    this.loginEnable = true;
                }
                this.scheduleOnce(function () {
                    if (info.length > 0) {
                        this.loginEnable = true;
                        self.loginAction();
                    }
                }, 0.5);
                //}
            } else {
                    this.versionEnable = true;
                    var self = this;
                    // var info = manager.getUserInfo();
                    // if (info.length == 0) {
                    //     this.loginEnable = true;
                    // }
                    this.scheduleOnce(function () {
                        if (!cc.sys.isNative) {
                            var recordId = self.getQueryString('recordId');
                            if (recordId) {
                                Socket.sendGetRecrodFromId(recordId);
                                return;
                            }
                            var roomId = self.getQueryString("roomId");
                            if (roomId) {
                                var info = manager.getUserInfo();
                                if (info.length > 0) {
                                    var data = JSON.parse(info);
                                    if (!data.errcode) {
                                        self.sendLoginRequest(data);
                                    } else {
                                        manager.setUserInfo("");
                                    }
                                    return;
                                } else {
                                    self._get_HREF(roomId);
                                }
                            }
                        }
                        var info = manager.getUserInfo();
                        if (info.length > 0) {
                            var data = null;
                            try {
                                data = JSON.parse(info);
                            } catch (e) {
                                manager.setUserInfo("");
                                data = null;
                            }
                            if (!data || data.errcode) {
                                manager.setUserInfo("");
                            } else {
                                this.loginEnable = true;
                                self.loginAction();
                            }
                        } else {
                            if (!cc.sys.isNative) {
                                var code = self.getQueryString("code");
                                var roomId = self.getQueryString("roomId");
                                if (roomId) {
                                    var info = manager.getUserInfo();
                                    if (info.length > 0) {
                                        var data = JSON.parse(info);
                                        if (!data.errcode) {
                                            self.sendLoginRequest(data);
                                        } else {
                                            manager.setUserInfo("");
                                        }
                                        return;
                                    } else {
                                        self._get_HREF(roomId);
                                    }
                                }
                                if (code) {
                                    try {
                                        var obj = new XMLHttpRequest(); // XMLHttpRequest对象用于在后台与服务器交换数据
                                        var url = "./get_token.php";
                                        obj.open("POST", url, true);
                                        obj.setRequestHeader("Content-type", "application/x-www-form-urlencoded"); // 添加http头，发送信息至服务器时内容编码类型
                                        obj.onreadystatechange = function () {
                                            if (obj.readyState == 4 && (obj.status == 200 || obj.status == 304)) {
                                                // 304未修改
                                                //alert(obj.responseText);
                                                var data = JSON.parse(obj.responseText);
                                                if (!data.errcode) {
                                                    manager.setUserInfo(obj.responseText);
                                                    self.sendLoginRequest(data);
                                                }
                                            }
                                        };
                                        obj.send("code=" + code);
                                    } catch (e) {
                                        //alert(e);
                                    }
                                }
                            }
                        }
                    }, 0.5);
                }
        //}
    },
    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },
    //随机生成 num 位 的随机数 含大小写字母及数字
    getRandomAccount: function getRandomAccount(num) {
        /**
         * 返回一个字母
         */
        function getCharacter(flag) {
            var character = "";
            if (flag === "lower") {
                character = String.fromCharCode(Math.floor(Math.random() * 26) + "a".charCodeAt(0));
            }
            if (flag === "upper") {
                character = String.fromCharCode(Math.floor(Math.random() * 26) + "A".charCodeAt(0));
            }
            return character;
        }

        var str = "";
        for (var i = 0; i < num; i++) {
            var flag = "lower";
            var random = Math.floor(Math.random() * 3);
            if (random == 0) {
                flag = "upper";
                str += getCharacter(flag);
            } else if (random == 1) {
                str += getCharacter(flag);
            } else {
                str += Math.floor(Math.random() * 10);
            }
        }
        return str;
    },
    getGuestUserInfo: function getGuestUserInfo() {
        var search = window.location.search;
        var openid = "guest_" + this.getRandomAccount(8);
        var unionid = 'guest_' + this.getRandomAccount(8);
        var nickname = this.getRandomAccount(8);
        var testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
        return testData;
    },
    onLoad: function onLoad() {
        this.keyBackListen();
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var canvas = cc.find("Canvas");
            var cvs = canvas.getComponent(cc.Canvas);
        }
        KQGlabolSocketEventHander.start();
        this.socket = cc.find('GameSocket').getComponent('socket');
        var self = this;
        this.loginEnable = false;
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
            //console.log(data)
            if (data.action == 'checkVersion') {
                try {
                    self.checkVersion(data.data);
                } catch (e) {
                    //this.err.string = e;
                }
            } else if (data.action == 'login') {
                    if (data.result) {
                        //成功
                        self.socket.userInfo = data.data; //运行时态信息
                        if (!cc.sys.isNative) {
                            var roomId = self.getQueryString("roomId");
                            //console.log(roomId);
                            if (roomId) {
                                var userId = data.data.id;
                                var exitInRoom = data.data.roomId;
                                if (exitInRoom != "") {
                                    roomId = exitInRoom;
                                }
                                Socket.sendLoginJoin(roomId, userId);
                                return;
                            }
                        }
                        self._loadingLabel("登录中");
                        if (data.data.roomId.length > 0) {
                            cc.director.loadScene('play');
                        } else {
                            cc.director.loadScene('hall');
                        }
                    } else {
                        // self.alertMessage('登录失败!');
                    }
                }
        };
        this._registerSocketEvent();

        this.socket.getWxInfo = function (info) {
            manager.setUserInfo(info); //保存本地
            var data = JSON.parse(info); //str -> json(obj)
            self.scheduleOnce(function () {
                //延迟执行 1s
                self.sendLoginRequest(data); //登录请求
            }, 1);
        };
        this.getOnlyUserInfoByBrowser();
        //cc.sys.localStorage.removeItem("userinfo");
        // let search = window.location.search;
        // var openid = "JzIwMTcvNi8xNiDkuIrljYgxMMzowOCc=";
        // var unionid = '8dOtAcDic5Sichv3lxtMXYJgmunTLOLv';
        // var nickname = "哇哈哈";

        //var openid = "JzIwMTcvNi8xNiDkuIrljYgxMMzowOCc=";
        //var openid = "guest_" + this.getRandomAccount(8);
        //var unionid = '8dOtAcDic5Sichv3lxtMXYJgmunTLOLv';
        //var unionid = 'guest_' + this.getRandomAccount(8);
        //var nickname = this.getRandomAccount(8);

        //if (search) {
        //    var url = window.location.search;
        //    var loc = url.substring(url.lastIndexOf('=') + 1, url.length);
        //    if (loc == 1) {
        //        openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';
        //        unionid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc';
        //        nickname = loc;
        //    }
        //    else if (loc == 2) {
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';
        //        unionid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw';
        //        nickname = loc;
        //    }
        //    else if (loc == 3) {
        //        openid = 'JzIwMTctNi0xNiAwOTo0NToc=';
        //        unionid = '8dOtAcDic5Sichv3lxtMXYmunTLOLv';
        //        nickname = loc;
        //    }
        //    else if (loc == 4) {
        //        openid = 'ozlXIwgv_QJT0ykdUihaABmsWp2A';
        //        unionid = 'o-3911qWsQsW3wUodqFfUtbsAeNk';
        //        nickname = loc;
        //    }
        //    else if (loc == 5) {
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';
        //         unionid = 'o-JzIwMTcvNi8xNiDkuIrljYgxMDowM';
        //        nickname = loc;
        //    }else if(loc == 6){
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYgxMMzoc=';
        //         unionid = 'o-zIwMTcvNi8xNiDkuIrl';
        //        nickname = loc;
        //    }
        //
        //}
        // var testData = '{"openid":"'+openid+'","nickname":"'+nickname+'","unionid":"'+unionid+'","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';

        //if (!cc.sys.isNative){
        //    var info = manager.getUserInfo();
        //    if (info.length > 0) {
        //        //this.showWaitingMessage('已存有账号=====');
        //        //return;
        //    }else
        //    {
        //        //this.showWaitingMessage('新账号=====');
        //        var userInfo = this.getGuestUserInfo();
        //        manager.setUserInfo(userInfo);
        //    }
        //}
    },

    getOnlyUserInfoByBrowser: function getOnlyUserInfoByBrowser() {
        var openid = "";
        var unionid = "";
        var nickname = "";

        var testData = "";
        var userInfo = manager.getUserInfo();

        var search = window.location.search;
        if (userInfo.length > 0) {
            openid = userInfo.openId;
            unionid = userInfo.unionid;
            nickname = userInfo.nickname;
        }

        if (search) {
            var url = window.location.search;
            var loc = url.substring(url.lastIndexOf('=') + 1, url.length);
            if (loc == 1) {
                openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';
                unionid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc';
                nickname = "guest_1";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 2) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';
                unionid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw';
                nickname = "guest_2";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 3) {
                openid = 'JzIwMTctNi0xNiAwOTo0NToc=';
                unionid = '8dOtAcDic5Sichv3lxtMXYmunTLOLv';
                nickname = "guest_3";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 4) {
                openid = 'ozlXIwgv_QJT0ykdUihaABmsWp2A';
                unionid = 'o-3911qWsQsW3wUodqFfUtbsAeNk';
                nickname = "guest_4";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 5) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';
                unionid = 'o-JzIwMTcvNi8xNiDkuIrljYgxMDowM';
                nickname = "guest_5";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 6) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYgxMMzoc=';
                unionid = 'o-zIwMTcvNi8xNiDkuIrl';
                nickname = "guest_6";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            }
        }
        if (testData && testData.length > 0) {
            if (!cc.sys.isNative) {
                manager.setUserInfo(testData);
            }
        }
    },
    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveLoginJoin, this._LoginJoin, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRecordId, this._ReceiveRecordId, this);
        KQGlobalEvent.on(Socket.Event.ReceiveNoUionid, this._ReceiveNoUionid, this);
    },
    _get_HREF: function _get_HREF(roomId) {
        if (roomId != ROOMID) {
            ROOMID = roomId;
            roomId = "%3froomId%3d" + roomId;
            REDIRECT_URI = REDIRECT_URI + roomId;
            HREF = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + APPID + "&redirect_uri=" + REDIRECT_URI + "&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";
        }
    },
    _ReceiveNoUionid: function _ReceiveNoUionid(response) {
        manager.setUserInfo("");
        var self = this;
        var roomId = this.getQueryString("roomId");
        if (roomId) {
            //roomId = "%3froomId%3d"+roomId ;
            //REDIRECT_URI = REDIRECT_URI+roomId;
            this._get_HREF(roomId);
        }
        setTimeout(function () {
            self.loadingNode.parent.active = false;
            self.loadingNode.stopAllActions();
        }, 2000);
        this._loadingLabel("登录失败，请重新登录");
    },
    _ReceiveRecordId: function _ReceiveRecordId(response) {
        var data = response.data;
        if (data.recordMsg.length > 0) {
            var record = data.recordMsg[0];
            var playersInfo = JSON.parse(record.playersInfo).players;
            var recordNode = cc.instantiate(this.recordInfo);
            var totalGameResult = recordNode.getComponent("TotalGameResult");
            playersInfo.sort(function (a, b) {
                return b.totalScore - a.totalScore;
            }); // 排序
            totalGameResult.setPlayerInfos(playersInfo, record);
            totalGameResult._clickBtn();
            recordNode.getComponent('alert').alert();
            this.node.addChild(recordNode);
        }
    },
    _LoginJoin: function _LoginJoin(response) {
        this._loadingLabel("进入房间，正在为您请求数据");
        if (response.result) {
            if (cc.from == null) {
                cc.from = {};
            }
            cc.from.ma = response.data.maPai;
            cc.director.loadScene('play');
        } else {
            cc.joinDesk = {};
            cc.director.loadScene('hall');
            var reasonInfo = this._joinReasonMap(response.data.reason);
            cc.joinDesk.result = response.result;
            cc.joinDesk.reason = reasonInfo;
        }
    },
    _joinReasonMap: function _joinReasonMap(reason) {
        var reasonInfo = {
            notExist: "房间不存在!",
            cardNumber: "您房卡不足!"
        };
        var info = reasonInfo[reason] || "房间已满!";
        return info;
    },

    getQueryString: function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);return null;
    },

    agreements: function agreements() {
        this.agreementNode.active = true;
        //this.agreementLabel.string = cc.info1;
        this.agreementLabel.node.y = 0;
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
    },

    _loadingLabel: function _loadingLabel(label) {
        this.label.string = label;
    },

    sendLoginRequest: function sendLoginRequest(data) {
        //this.showWaitingMessage('登录中...');
        this.loadingNode.parent.active = true;
        this.loadingNode.runAction(cc.repeatForever(cc.rotateBy(2, 360)));
        //return;
        this.socket.sendMessage('login', data);
    },

    loginAction: function loginAction() {
        if (!cc.sys.isNative) {
            var info = manager.getUserInfo();
            if (info.length > 0) {
                //this.showWaitingMessage('已存有账号=====');
                //return;
            } else {
                    //this.showWaitingMessage('新账号=====');
                    var userInfo = this.getGuestUserInfo();
                    manager.setUserInfo(userInfo);
                }
        }

        var info = manager.getUserInfo();
        if (info.length > 0) {
            var data = JSON.parse(info);
            this.sendLoginRequest(data);
            return;
        }
        if (!cc.sys.isNative) {
            // cc.sys.openURL(HREF);
            window.location.href = HREF;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
            } else if (KQNativeInvoke.isNativeAndroid()) {
                    //Android
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
                }
        }
    },

    changeGuestUserInfo: function changeGuestUserInfo() {
        manager.setUserInfo('');
        this.loginAction();
    },

    loginYkAction: function loginYkAction() {
        //var comp = this.selectNode.getComponent('select');
        //if (!comp.selected) {
        //    this.showMsg = cc.instantiate(this.alertPrefab);
        //    this.canvasNode.addChild(this.showMsg);
        //    let comp = this.showMsg.getComponent('alert');
        //    comp.setMessage('请同意用户协议');
        //    return;
        //}
        var testDate = new Date();
        var time = "'" + testDate.toLocaleString() + "'";
        var openid = new Buffer(time).toString('base64');
        var testData = '{"openid":"' + openid + '","nickname":"游客","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/BVyz4R8q6puJibEv1hrsaTmIKQhkaTS9FyvcevvC5hlxFnfOuspDjicG0GtzyJXOhNT7g1WZDeCDQhnRdEOgz3QMnP0F9iboQGy\/0","privilege":[]}';
        var data = JSON.parse(testData);
        this.sendLoginRequest(data);
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.isValid(this.waitingNode)) {
            if (msg == this.waitingNode.getComponent('alert').getMessage()) {
                return;
            }
            this.waitingNode.removeFromParent();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.canvasNode.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        //console.log(comp);

        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    protocolAction: function protocolAction() {
        cc.log('protocol action');
    }
});

cc._RFpop();
}).call(this,require("buffer").Buffer)

},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","buffer":2,"manager":"manager","socket":"socket"}],"maPai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8b896xHkCtE1IzD8BDK4cWL', 'maPai');
// scripts\Play\maPai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        maPaiSprite: [cc.SpriteFrame],
        spriteNode: cc.Sprite,
        labelNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"manager":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4a47fj0J/VHup24OT7njkko', 'manager');
// scripts\manager.js

module.exports = {
    version: 'v1.0.0',

    setUserInfo: function setUserInfo(str) {
        cc.sys.localStorage.setItem('userinfo', str);
    },

    getUserInfo: function getUserInfo() {
        var value = cc.sys.localStorage.getItem('userinfo');
        if (!value) {
            return "";
        }
        return value;
    },

    setMusicValue: function setMusicValue(value) {
        cc.sys.localStorage.setItem('musicVolumn', value);
    },

    getMusicValue: function getMusicValue() {
        var value = cc.sys.localStorage.getItem('musicVolumn');
        if (!value) {
            return 1;
        }
        return value;
    },

    setMusicEffectValue: function setMusicEffectValue(value) {
        cc.sys.localStorage.setItem('musicEffectVolumn', value);
    },

    getMusicEffectValue: function getMusicEffectValue() {
        var value = cc.sys.localStorage.getItem('musicEffectVolumn');
        if (!value) {
            return 1;
        }
        return value;
    }
};

cc._RFpop();
},{}],"overTime":[function(require,module,exports){
"use strict";
cc._RFpush(module, '48748u5hxdOD4WTPWQqSQwN', 'overTime');
// scripts\overTime.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        //selectedIndex: 0,
        _selected: 1
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        this._select = true;
        var overTime = 0;
        if (cc.set) {
            overTime = cc.set.setting6;
            this._selected = this._select = overTime;
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select;
            this._selected = this._select;
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (self._select) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                this.setSelected(self._selected = self._select = !self._select);
                var title = this.node.getChildByName("title");
                if (self._select) {
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    title.color = new cc.Color(255, 255, 255);
                }
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "orders" && cc.set) {
            //this.remember_set(overTime);
        }
    },
    remember_set: function remember_set(obj) {
        for (var i = 0; i < this.nodes.length; i++) {
            this.nodes[i].getComponent('select').setSelected(obj);
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (obj) {
                var title = this.nodes[0].getChildByName('title');
                title.color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
    }

});

cc._RFpop();
},{}],"play":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16c65H2Pw9PBaQSvw69LGLQ', 'play');
// scripts\play.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var Manager = require('manager');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
var fecha = require('fecha');
var manager = require('manager');
/*#####*/
var KQCard = require('KQCard');
/**/
var Player = require('Player');
/**/
//const isTeShuPai = require('isTeShuPai');
//特殊牌类型
var TESHUPAITYPE = {
    isTeShuPai: false,
    isLiuDuiBan: false,
    isSanShunZi: false,
    isSanTaoHua: false,

    isQingLong: false,
    isYiTiaoLong: false,
    isSanTongHuaShun: false,
    isSanFenTianXia: false,
    isCouYiSe: false,
    isSiTaoSanTiao: false,
    isWuDuiSanTiao: false
};

var GAMESTATUS = {
    WAIT_PEOPLE: 0, // 等人
    WAIT_READY: 1, // 等待他人准备
    PLAYING: 2 };
// 正在玩游戏
var sTitle = '';
var sDescription = '';
var sId = '';
// 布局
//          2
//   3            1
//     self 0
var Play = cc.Class({
    'extends': cc.Component,

    properties: {
        playerNodes: [cc.Node],
        //playsCoins: [cc.Node],
        chatNode: cc.Node,
        cardTypeCombineNode: cc.Node,
        typeButtonsNode: cc.Node,
        phone: cc.Label,
        labelRoomNumber: cc.Label,
        labelOverview: cc.Label,
        labelRemainTime: cc.Label,
        btnShare: cc.Button,
        btnReady: cc.Button, // 准备按钮
        btnStartGame: cc.Button, // 开始按钮
        beilv: cc.Node, // 选择倍率节点
        btnChatVoice: cc.Button,
        btnChatText: cc.Button,
        againBtn: cc.Node,

        startCompareCardsNode: cc.Node,
        settingNode: cc.Node,
        VoiceMsgBg: cc.Node,
        exit: cc.Node, // 离开房间节点
        Dissolve: cc.Node, // 解散房间节点
        shareBg: cc.Node, // 分享背景
        totalGameResult: cc.Node, // 结果节点
        alertRequestExitNode: cc.Node, // 申请退出 Node
        dissolveAlter: cc.Node, // 申请退出 Node
        alertRequestExitCountdownNode: cc.Node, // 申请退出倒计时 Node
        alertAnsowerExitNode: cc.Node, // 回答申请退出  Node
        contentAnsowerExitNode: cc.Node, // 回答申请退出头像  Node
        alertAnsowerExitResult: cc.Node, // 回答申请退出结果  Node
        alertAnsowerExitCountdownNode: cc.Node, // 回答以上请退出的倒计时
        Countdown: cc.Node, // 倒计时
        labelTime: cc.Label,
        needCard: cc.Label,
        alert: cc.Node,
        coinsContainerNode: cc.Node,
        btnAlertRequestExitConfirmButton: cc.Button,
        btnAlertRequestExitCancelButton: cc.Button,

        autoTishi: cc.Prefab,
        waitingPrefab: cc.Prefab,
        coinsPrefab: cc.Prefab,
        playerComps: [Player],

        gongXiNi: cc.Node,
        teShuPai: cc.Node,

        cardSpriteAtlas: cc.SpriteAtlas,
        daoSpriteAtlas: cc.SpriteAtlas,

        _liuDuiBan: false,
        _sanShunZi: false,
        _sanTongHua: false,
        _yiTiaoLong: false,

        _QingLong: false,
        _SanTongHuaShun: false,
        _SanFenTianXia: false,
        _CouYiSe: false,
        _SiTaoSanTiao: false,
        _WuDuiSanTiao: false,

        _playerComponents: null,
        _msgControl: null,
        _nowTimeAgain: 0,

        _socket: null,
        _userId: 0,
        _playerInfos: null,
        _deskInfo: null, // createTime 创建时间  isDissolving 表示是否正在解散 dissolveLeftTime 离解散剩余多长时间 dissolveAnswerInfo [处理过的人的信息]
        _gameStatus: GAMESTATUS.WAIT_PEOPLE,
        _enterTime: null,
        _bigRecordInfo: null,
        _players: null,
        /**/
        _isComparingCardsNow: false, // 是否正在比牌
        _playedCompareCardsIndexs: [], // 已经播放过比牌的局数
        /**/
        fapaiNode: cc.Prefab,
        liuduiban: cc.Prefab,
        santonghua: cc.Prefab,
        sanshunzi: cc.Prefab,
        quanleida: cc.Prefab
    },
    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },
    // use this for initialization
    onLoad: function onLoad() {
        var _this2 = this;

        this.keyBackListen();
        this.headCardTime = 0.85;
        var bg = this.node.getChildByName("room_bg");
        var windowP = cc.director.getWinSizeInPixels();
        var scaleX = windowP.width / bg.width;
        var scaleY = windowP.height / bg.height;
        var scale = Math.max(scaleX, scaleY);
        bg.scaleX = scale;
        bg.scaleY = scale;

        this.BtnClickGongXiNiComfirm = this.cardTypeCombineNode.getComponent("CardTypeCombine").BtnClickGongXiNiComfirm;
        this._enterTime = Date.now();
        /**/
        this.playerComps.forEach(function (playerComp) {
            playerComp.playedCompareCardsIndexs = _this2._playedCompareCardsIndexs;
        });
        /**/
        /*AudioManager.instance.playDeskMusic();*/

        AudioManager.instance.stopHallMusic();
        var bgSound = cc.sys.localStorage.getItem("bgSound");
        if (bgSound == 0) {
            var audioManager = cc.find('AudioManager');
            audioManager = audioManager.getComponent('AudioManager');
            audioManager.setEffectMusicVolum(bgSound);
        }

        this._initPlayerComponents();
        this._initSelectCardNode();
        this._initOneGameResult();
        this._remainTimeStartUpdate();

        this._userId = Socket.instance.userInfo.id;
        this._msgControl = this.chatNode.getComponent('MsgControl');
        this._userId = Socket.instance.userInfo.id;
        this.beilv.getComponent("selectbeilv")._userid = this._userId;
        //this.settingNode.getComponent("Setting").hideSwitch();
        this.labelRoomNumber.string = "";
        this.labelRemainTime.node.active = false;

        this._registerVoiceNodeEvents();
        this._registerSocketEvent();

        Play.instances = this;
        this._gongXiNiShow(false);
        if (Playback.instance.isContainPlaybackDatas()) {
            Playback.instance.startPlayback();
            this.playbackNode.active = true;
            this.btnChatVoice.node.active = false;
            //this.cardsFromArray.node.active = false;
        } else {
                this._loadDeskInfo();
            }

        this._socket = Socket.instance;

        cc.director.preloadScene('hall', function () {
            cc.director.preloadScene('login');
        });

        cc.clickOut = false;
        //this.timeStart(5);
    },

    timeStart: function timeStart(duration, action) {
        cc.assert(duration > 0);
        this.timeStop();
        this.Countdown.active = true;
        if (action != "ready") {
            var timestamp = cc.sys.localStorage.getItem("timestamp"); // 获取本地存储的时间戳
            if (timestamp) {
                // 如果有则证明玩家是重新进来了的
                var now = Date.parse(new Date());
                var time = duration * 1000;
                if (now - timestamp > time) {
                    // 超时
                    if (now - timestamp < 2 * time) {
                        duration = 5; // 玩家可能出于其他原因退出游戏导致超时，为其提供5秒时间整理牌型（这已经是很仁慈的了）。
                    } else {
                            cc.sys.localStorage.removeItem("timestamp");
                        }
                } else {
                    duration = Math.floor(duration - (now - timestamp) / 1000);
                }
            } else {
                // 如果没有时间戳，则保存，为玩家退出游戏保留证据；
                var timestamp = Date.parse(new Date());
                cc.sys.localStorage.setItem('timestamp', timestamp);
            }
        }
        this._timeRemainDuration = duration;
        this.labelTime.string = String(duration);
        this.Countdown.getComponent("time").setTime(duration * 0.5);
        var self = this;
        this.callback = function () {
            self._timeMethod(action);
        };
        this.schedule(this.callback, 1, duration);
    },

    timeStop: function timeStop() {
        this.unschedule(this.callback);
        this.Countdown.active = false;
    },

    _timeMethod: function _timeMethod(action) {
        this._timeRemainDuration = this._timeRemainDuration - 1;

        var remain = Math.max(this._timeRemainDuration, 0);
        this.labelTime.string = remain < 10 && remain > 0 ? '0' + remain : remain;

        if (this._timeRemainDuration <= 0) {
            this.timeStop();
            if (action == "ready") {
                if (this._deskInfo.cIndex > 0) {
                    this.clickReady();
                }
            }
            cc.sys.localStorage.removeItem("timestamp");
            return;
        }
    },

    _globalMsg: function _globalMsg(data) {
        //if(!cc.sys.isNative){
        var roomId = data.roomId;
        var wf = data.setting3; ///[疯狂场,鬼牌,比花色,坐庄,马牌]
        var room = "房号：" + roomId;
        var fk = wf[0] ? "疯狂场 " : "普通场 "; // 疯狂场
        var gp = wf[1] ? "鬼牌 " : "无鬼 "; // 鬼牌
        var hs = wf[2] ? "比花色 " : "不比花色 "; // 比花色
        var zj = wf[3] ? "坐庄 " : "不坐庄 "; // 庄家
        var mp = wf[4] ? "买马 " : "不买马 "; // 马牌
        var sf = "房费:" + (data.setting4 ? data.setting4 == 1 ? "赢者扣 " : "房主扣 " : "平摊 "); //收费
        var shareTitle = room + " 模式:" + zj + sf;

        var pj = ["5局 ", "10局 ", "20局 "]; //牌局
        var ds = ["4人不加色 ", "5人加一色 ", "6人二色 ", "7人加三色 "]; //多色
        var rs = ds[data.setting2] + "";
        var js = pj[data.setting1 - 2];
        var desc = '[大众十三水] ' + zj + fk + mp + gp + sf + rs + js + " 点击直接进入房间";

        sTitle = shareTitle;
        sDescription = desc;
        sId = 'roomId=' + roomId;

        cc.sys.localStorage.setItem('roomId', roomId);
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);

        if (cc.sys.isBrowser) {
            if (window.shareToTimeLine) {
                window.shareToTimeLine();
            }
            if (window.shareToSession) {
                window.shareToSession();
            }
        }
        //}
    },

    /*#####*/
    /*显示马牌*/
    _initMaPai: function _initMaPai() {},

    _initPlayerComponents: function _initPlayerComponents(playerIndex) {
        this._playerComponents = this.playerNodes.map(function (node) {
            return node.getComponent('Player');
        });

        if (!playerIndex) {
            playerIndex = [0, 1, 2, 3, 4, 5];
        }

        var a = this._playerComponents.splice(1, 7);

        for (var i = 0; i < playerIndex.length - 1; i++) {
            var index1 = playerIndex[i];
            var index2 = playerIndex[i + 1];
            var tmp = null;
            tmp = a[index1];
            a[index1] = a[index2];
            a[index2] = tmp;
        }

        a.forEach((function (node) {
            this._playerComponents.push(node);
        }).bind(this));

        if (this.playsCoins && this.playsCoins.length > 0) {
            this.playsCoins.forEach((function (node) {
                node.active = false;
            }).bind(this));
        }

        this.playsCoins = [];

        this._playerComponents.forEach((function (plays, i) {
            var name = "coins" + i;

            var node = new cc.Node();

            node.name = name;

            node.x = plays.node.x;

            node.y = plays.node.y;

            this.node.addChild(node);

            this.playsCoins.push(node);
        }).bind(this));
    },

    _initSelectCardNode: function _initSelectCardNode() {
        var self = this;
        var cardTypeCombineComp = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombineComp.setFinishSelectCardsCallback(function (serverCardsInfo) {
            cardTypeCombineComp.reset();
            Socket.sendPlayCard(self._userId, serverCardsInfo);
            self.cardTypeCombineNode.active = false;
        });
    },

    /**/
    _initOneGameResult: function _initOneGameResult() {
        var self = this;
        // this.oneGameResult.setCloseCallback = function () {
        //     if (self._isRandomRoom()) {
        //         cc.director.loadScene('hall');
        //     }
        // };
    },

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickLeaveDesk: function clickLeaveDesk() {
        // 点击离开桌子
        if (this._deskInfo.cIndex == 0) {
            // 还没开始可以退出房间
            if (this._deskInfo.createId == this._userId) {
                cc.director.loadScene('hall');
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
        }
    },
    clickDissolveDesk: function clickDissolveDesk() {
        // 点击解散桌子
        if (this._deskInfo.createId == this._userId) {
            // 只有房主才能解散桌子
            this.btnAlertRequestExitCancelButton.node.active = true;
            this.btnAlertRequestExitConfirmButton.node.active = true;
            var _alert = this.alertRequestExitNode.getComponent('alert');
            _alert.unscheduleAllCallbacks();
            _alert.setMessage("是否要解散房间");
            _alert.alert();
        }
    },

    clickExitOut: function clickExitOut() {
        Socket.sendDissolveDesk(this._userId);
    },

    //解散退出房间
    clickExit: function clickExit() {
        if (Playback.instance.isPlaybacking()) {
            cc.director.loadScene('hall');
            return;
        }
        /**/
        if (this._deskInfo && this._deskInfo.isDeskOver) {
            if (!this._isComparingCardsNow) {
                // 如果房间已结束，并且不是正在播放打牌动画, 则直接离开房间
                cc.director.loadScene('hall');
            }
            return;
        }
        /**/
        //if (this._isRandomRoom()) {
        //    this.alertForceExitNode.getComponent('alert').alert();
        //    return;
        //}
        if (this._deskInfo.cIndex == 0) {
            if (this._deskInfo.createId == this._userId) {
                var alert1 = this.dissolveAlter.getComponent('alert');
                alert1.alert();
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
            return;
        }
        this.btnAlertRequestExitCancelButton.node.active = true;
        this.btnAlertRequestExitConfirmButton.node.active = true;

        var alert = this.alertRequestExitNode.getComponent('alert');
        alert.unscheduleAllCallbacks();
        alert.setMessage("是否解散房间？");
        alert.alert();

        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },
    //不解散退出房间
    clickOut: function clickOut() {
        if (this._deskInfo.cIndex == 0) {
            if (this._deskInfo.createId == this._userId) {
                cc.clickOut = true;
                cc.director.loadScene('hall');
                return;
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
        }
    },

    clickShareBg: function clickShareBg() {
        cc.find("Canvas/shareBg").active = false;
        this.shareBg.active = false;
    },
    guanzhu: function guanzhu() {
        // var url = "http://www.honggefeng.cn/gzh/index.html";
        // cc.sys.openURL(url)
    },
    recordShare: function recordShare() {
        if (this._deskInfo.recordId) {
            var shareTitle = "[大众十三水]战绩";
            var roomId = "房间号：" + this._deskInfo.roomId;
            var pj = ["5 ", "10 ", "20 "]; //牌局
            var js = "局数：" + pj[this._deskInfo.setting1 - 2];
            var time = "时间：" + this._deskInfo.createTime;
            var desc = roomId + js + time + "点击查看详情";

            var recordId = this._deskInfo.recordId;
            cc.sys.localStorage.setItem("shareTitle", shareTitle);
            cc.sys.localStorage.setItem("desc", desc);
            cc.sys.localStorage.setItem("recordId", recordId);
            cc.sys.localStorage.setItem("roomId", '');

            sTitle = shareTitle;
            sDescription = desc;
            sId = 'roomId=' + roomId;
            if (recordId) {
                sId = 'recordId=' + recordId;
            }

            if (cc.sys.isBrowser) {
                if (window.shareToTimeLine) {
                    window.shareToTimeLine();
                }
                if (window.shareToSession) {
                    window.shareToSession();
                }
            }
        };
        if (!cc.sys.isNative) {
            cc.find("Canvas/shareBg").active = true;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
            } else {
                //Android
                KQNativeInvoke.screenshotShare();
            }
        }
    },
    // 点击桌面分享
    clickDeskShare: function clickDeskShare() {
        //this._globalMsg(this._deskInfo);
        if (!cc.sys.isNative) {
            var shareBg = cc.find("Canvas/shareBg");
            shareBg.active = true;
            //var wxBg = this.shareBg.getChildByName("wx");
            //var pyqBg = this.shareBg.getChildByName("PYQ");
            //wxBg.active = true;
            //pyqBg.active = false;
            //this.shareBg.active = true;
        }
        var id = sId;
        var title = sTitle;
        var description = sDescription;
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
        }
    },
    //点击分享按钮
    clickShare: function clickShare() {
        //this._globalMsg(this._deskInfo);
        if (!cc.sys.isNative) {
            var wxBg = this.shareBg.getChildByName("wx");
            var pyqBg = this.shareBg.getChildByName("PYQ");
            wxBg.active = true;
            pyqBg.active = false;
            this.shareBg.active = true;
        }
        var id = sId;
        var title = sTitle;
        var description = sDescription;

        // let roomId = String(this._deskInfo.roomId);
        // var description = "大众十三水 玩法:"
        // description = description + " " + this._deskInfoNumberOfPeople();
        // description = description + "," + this._deskInfoPayInfo();
        // description = description + " " + this._deskInfoNumberOfGame();

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
        }
    },

    //分享到朋友圈
    shareHallTimeline: function shareHallTimeline() {
        if (!cc.sys.isNative) {
            var wxBg = this.shareBg.getChildByName("wx");
            var pyqBg = this.shareBg.getChildByName("PYQ");
            wxBg.active = false;
            pyqBg.active = true;
            this.shareBg.active = true;
        } else {
            var id = sId;
            var title = sTitle;
            var description = sDescription;

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
            }
        }
    },

    //点击准备按钮
    clickReady: function clickReady() {
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.timeStop();
        Socket.sendReady(this._userId);
    },

    //点击开始按钮
    clickStartGame: function clickStartGame() {
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.btnStartGame.node.active = false;
        Socket.sendStartGame(this._userId);
    },

    updateRoomNumber: function updateRoomNumber(roomNumber) {
        var gameNumberString = "";
        if (this._deskInfo.setting1 != 0 && this._deskInfo.setting1 != 1) {
            gameNumberString = "局数 : " + "" + this._deskInfo.cIndex + "/" + this._deskInfo.mMax;
        } else if (this._deskInfo.setting1 == 0) {
            gameNumberString = "局数 : 10局";
        } else if (this._deskInfo.setting1 == 1) {
            gameNumberString = "局数 : 20局";
        }
        this.labelRoomNumber.string = "房号 : " + "" + roomNumber + "    " + gameNumberString;
    },

    updateGameStatus: function updateGameStatus() {
        var status = arguments.length <= 0 || arguments[0] === undefined ? GAMESTATUS.WAIT_PEOPLE : arguments[0];

        this._gameStatus = status;

        this.btnShare.node.active = status == GAMESTATUS.WAIT_PEOPLE;
        this.btnReady.node.active = status == GAMESTATUS.WAIT_READY;
        this.isReadyStatus();
    },

    gameStatus: function gameStatus() {
        return this._gameStatus;
    },
    isReadyStatus: function isReadyStatus() {
        if (this._playerInfos && this._playerInfos.length > 0) {
            this._playerInfos.forEach((function (playerInfo) {
                var userInfoSelf = cc.find('Canvas/playSelf/userInfoSelf');
                if (playerInfo.id == this._userId) {
                    if (!playerInfo.readyStatus && !this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas()) {
                        userInfoSelf.getComponent('userInfo').setReadyNodeVisible(false);
                        if (this._deskInfo.cIndex == 0) {
                            //一局还没开始
                            this.btnReady.node.active = false;
                            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {
                                this.btnShare.node.active = true;
                            } else {
                                this.btnShare.node.active = false;
                            }

                            if (this._deskInfo.players.length >= 2 && this._deskInfo.createId == this._userId) {
                                //是否是房主
                                this.btnStartGame.node.active = true;
                            } else {
                                this.btnStartGame.node.active = false;
                            }
                        } else {
                            this.btnReady.node.active = true;
                            this.btnShare.node.active = false;
                            this.btnStartGame.node.active = false;
                            this.btnStartGame.node.active = false;
                        }
                    } else {
                        this.btnReady.node.active = false;
                        this.btnShare.node.active = false;
                        this.btnStartGame.node.active = false;
                        if (!this._isComparingCardsNow) {
                            userInfoSelf.getComponent('userInfo').setReadyNodeVisible(true);
                        } else {
                            this._playerComponents.forEach(function (playerComp) {
                                playerComp.hideReadyStatus();
                            });
                        }
                    }
                }
                //console.log(this._isComparingCardsNow)
                //console.log("准备状态--------")
                if (this._isComparingCardsNow) {
                    //
                    this._playerComponents.forEach(function (playerComp) {
                        playerComp.hideReadyStatus();
                    });
                }
            }).bind(this));
        }
    },

    isGameStart: function isGameStart() {
        if (this._deskInfo.cIndex == 0) {
            //一局还没开始
            if (this._deskInfo.createId == this._userId) {
                //是否是房主
                if (!this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas() && this._deskInfo.players.length >= 2) {
                    this.btnStartGame.node.active = true;
                    this.btnReady.node.active = false;
                } else {
                    this.btnStartGame.node.active = false;
                }
            } else {
                this.btnStartGame.node.active = false;
            }

            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {
                this.btnShare.node.active = true;
            } else {
                this.btnShare.node.active = false;
            }
        } else {
            this.btnStartGame.node.active = false;
            this.btnShare.node.active = false;
        }
    },

    /// 游戏动画
    _startGame: function _startGame(playMusic) {

        if (this.gameStatus() == GAMESTATUS.PLAYING) {
            return;
        }
        //this._playerInfos = players;
        //this._playerComponents.forEach(function (player) {
        //
        //});
        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset(); //#####
            playerComp.hideReadyStatus();
        });
        this.teShuPai.active = false;

        this.unscheduleAllCallbacks();

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        this._playerComponents.forEach((function (plays, i) {

            var name = "coins" + i;

            var node = this.node.getChildByName(name);

            if (node) {
                node.removeAllChildren();
                this.node.removeChild(node);
            }
        }).bind(this));
        // cc.log(this.node)
        // cc.log('------709')
        this._updateUserInfos(this._playerInfos);
        this.showCompareCard();
        this._isComparingCardsNow = true;
        this.updateGameStatus(GAMESTATUS.PLAYING);
        this._playFaPaiAnimation(playMusic);

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');

        cardTypeCombine.reset();

        cardTypeCombine.node.active = false;

        if (!UserModelHelper.isPlayedCards(this._findPlayerInfoByUserId(this._userId))) {
            this.node.getComponent("animation").fapaiAnimation();
            this.scheduleOnce((function () {
                this._showCardTypeCombine();
            }).bind(this), 1.9);
        }
    },

    _playFaPaiAnimation: function _playFaPaiAnimation(playMusic) {
        this._playerComponents.forEach(function (player) {
            player.playFaPaiAnimation();
        });
        if (playMusic) {
            AudioManager.instance.playFaPai();
        }
    },

    /*#####*/
    //是否特殊牌
    isTeShuPai: function isTeShuPai(cards) {
        var result = KQCard.isTeShuPai(cards);
        if (result) {
            TESHUPAITYPE.isTeShuPai = true;
        } else {
            TESHUPAITYPE.isTeShuPai = false;
        }
        return result;
    },
    //是否一条龙
    isYiTiaoLong: function isYiTiaoLong(cards) {
        var result = KQCard.isYiTiaoLong(cards);
        if (result) {
            TESHUPAITYPE.isYiTiaoLong = true;
        } else {
            TESHUPAITYPE.isYiTiaoLong = false;
        }
        return result;
    },
    //是否六对半
    isLiuDuiBan: function isLiuDuiBan(cards) {
        var result = KQCard.isLiuDuiBan(cards);
        if (result) {
            TESHUPAITYPE.isLiuDuiBan = true;
        } else {
            TESHUPAITYPE.isLiuDuiBan = false;
        }
    },
    //是否三顺子
    isSanShunZi: function isSanShunZi(cards) {
        var result = KQCard.isSanShunZi(cards);
        if (result) {
            TESHUPAITYPE.isSanShunZi = true;
        } else {
            TESHUPAITYPE.isSanShunZi = false;
        }
    },
    //是否三同花
    isSanTongHua: function isSanTongHua(cards) {
        var result = KQCard.isSanTongHua(cards);
        if (result) {
            TESHUPAITYPE.isSanTaoHua = true;
        } else {
            TESHUPAITYPE.isSanTaoHua = false;
        }
    },
    //是否三同花顺
    isSanTongHuaShun: function isSanTongHuaShun(cards) {
        var result = KQCard.isSanTongHuaShun(cards);
        if (result) {
            TESHUPAITYPE.isSanTongHuaShun = true;
        } else {
            TESHUPAITYPE.isSanTongHuaShun = false;
        }
    },
    //是否是清龙
    isQingLong: function isQingLong(cards) {
        var result = KQCard.isQingLong(cards);
        if (result) {
            TESHUPAITYPE.isQingLong = true;
        } else {
            TESHUPAITYPE.isQingLong = false;
        }
    },
    //是否是 “三分天下”
    isSanFenTianXia: function isSanFenTianXia(cards) {
        var result = KQCard.isSanFenTianXia(cards);
        if (result) {
            TESHUPAITYPE.isSanFenTianXia = true;
        } else {
            TESHUPAITYPE.isSanFenTianXia = false;
        }
    },
    //是否是 “四套三条”
    isSiTaoSanTiao: function isSiTaoSanTiao(cards) {
        var result = KQCard.isSiTaoSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isSiTaoSanTiao = true;
        } else {
            TESHUPAITYPE.isSiTaoSanTiao = false;
        }
    },
    //是否是五对三条
    isWuDuiSanTiao: function isWuDuiSanTiao(cards) {
        var result = KQCard.isWuDuiSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isWuDuiSanTiao = true;
        } else {
            TESHUPAITYPE.isWuDuiSanTiao = false;
        }
    },
    //是否是凑一色
    isCouYiSe: function isCouYiSe(cards) {
        var result = KQCard.isCouYiSe(cards);
        if (result) {
            TESHUPAITYPE.isCouYiSe = true;
        } else {
            TESHUPAITYPE.isCouYiSe = false;
        }
    },
    /*#####*/

    /*显示配牌页面*/
    _showCardTypeCombine: function _showCardTypeCombine() {
        if (Playback.instance.isPlaybacking()) {
            return;
        }
        if (this.cardTypeCombineNode.active) {
            return;
        }

        this.startCompareCardsNode.active = false;
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;

        cc.teShuPaiCards = null;

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombine.reset();
        cardTypeCombine.reloadCards([]);
        cardTypeCombine.node.active = true;
        cardTypeCombine.timeStart(60);
        this.timeStart(60, "");
        this.cardTypeCombineNode.scale = 1;

        var cards = this._findCardsByUserId(this._userId);
        //"1_9""3_9""2_9"
        // "2_7""1_7""3_3""2_12"
        //"1_1""1_3""2_6""1_11""2_1""3_4"//
        // if(this._userId == 2){
        //     cards = [{suit: "d", number:2},{suit: "d", number:2}, {suit: "d", number:2},//青龙

        //         {suit: "h", number:2}, {suit: "d", number:2},
        //         {suit: "c", number:3}, {suit: "c", number:3}, {suit: "c", number:3},

        //         {suit: "d", number:3}, {suit: "d", number:4},
        //         {suit: "d", number:4}, {suit: "d", number:4}, {suit: "d", number:4}];
        // }
        //if(this._userId == 1){d
        //    cards = [{suit: "c", number:1},{suit: "h", number:1}, {suit: "s", number:1},//青龙
        //
        //        {suit: "h", number:8}, {suit: "c", number:2},
        //        {suit: "d", number:8}, {suit: "h", number:8}, {suit: "d", number:20},
        //        {suit: "h", number:9}, {suit: "s", number:9},
        //        {suit: "s", number:9}, {suit: "s", number:9}, {suit: "h", number:9}];
        //}
        // else if(this._userId == 6){
        //     cards = [{suit: "d", number:11},{suit: "d", number:13}, {suit: "d", number:11},//青龙
        //         {suit: "d", number:1}, {suit: "d", number:1},
        //         {suit: "h", number:2}, {suit: "h", number:4}, {suit: "h", number:9},
        //         {suit: "s", number:7}, {suit: "s", number:7},
        //         {suit: "s", number:5}, {suit: "s", number:5}, {suit: "s", number:5},];
        // }

        //else if(this._userId == 3){
        //    cards = [{suit: "d", number:4},{suit: "d", number:13}, {suit: "s", number:13},//青龙
        //        {suit: "d", number:6}, {suit: "s", number:7},
        //        {suit: "d", number:8}, {suit: "c", number:9}, {suit: "c", number:10},
        //        {suit: "s", number:1}, {suit: "s", number:3},
        //        {suit: "s", number:10}, {suit: "s", number:8}, {suit: "s", number:12},];
        //}
        cc.moshi = 0;
        for (var i = 0; i < cards.length; i++) {
            var s = cards[i].number;
            if (s >= 20) {
                cc.moshi = 1;
                break;
            }
        }
        var cardNames = this._convertCardsToCardNames(cards);
        cardTypeCombine.reloadCards(cardNames);
        cardTypeCombine.addCardModes(cardNames);

        //cc.from.moshi == 0选择了庄家模式

        if (cc.moshi != 1) {
            this.isTeShuPai(cards);
            this.isQingLong(cards);
            this.isYiTiaoLong(cards);
            this.isLiuDuiBan(cards);
            this.isSanShunZi(cards);
            this.isSanTongHua(cards);
            if (TESHUPAITYPE.isTeShuPai) {
                this.cardTypeCombineNode.scale = 0;
                var nodes = this.gongXiNi.getChildByName("bg");
                nodes.opacity = 240;
            }
            //this.isSanTongHuaShun(cards);
            //this.isSanFenTianXia(cards);
            //this.isSiTaoSanTiao(cards);
            //this.isWuDuiSanTiao(cards);
            //this.isCouYiSe(cards);
            this._showGongXiNiAndBtnTeShuPai();
        }
        cardTypeCombine.cacleAutoSelectedCards2();

        if (cc.moshi == 1) cc.teShuPaiCards = null;
        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset(); //#####
            playerComp.hideReadyStatus();
        });
    },

    getIsTeShuPai: function getIsTeShuPai(userId) {
        var cards = this._findCardsByUserId(userId);
        return this.isTeShuPai(cards);
    },

    /*#####检测特殊牌类型，显示相对应的恭喜你页面和特殊牌精灵*/
    _showGongXiNiAndBtnTeShuPai: function _showGongXiNiAndBtnTeShuPai() {
        /*如果有特殊牌*/
        if (TESHUPAITYPE.isTeShuPai) {
            if (TESHUPAITYPE.isQingLong) {
                this._gongXiNiShow(true, "同花十三水");
                this._sanTongHua = true;
            } else if (TESHUPAITYPE.isYiTiaoLong) {
                this._gongXiNiShow(true, "十三水");
                this._yiTiaoLong = true;
            } else if (TESHUPAITYPE.isLiuDuiBan) {
                this._gongXiNiShow(true, "六对半");
                this._liuDuiBan = true;
            } else if (TESHUPAITYPE.isSanShunZi) {
                this._gongXiNiShow(true, "三顺子");
                this._sanShunZi = true;
            } else if (TESHUPAITYPE.isSanTaoHua) {
                this._gongXiNiShow(true, "三同花");
                this._sanTongHua = true;
            }
            //else if(TESHUPAITYPE.isSanTongHuaShun){
            //    this._gongXiNiShow(true);
            //    this._SanTongHuaShun = true;
            //}
            //else if(TESHUPAITYPE.isSanFenTianXia){
            //    this._gongXiNiShow(true);
            //    this._SanFenTianXia = true;
            //}
            //else if(TESHUPAITYPE.isCouYiSe){
            //    this._gongXiNiShow(true);
            //    this._CouYiSe = true;
            //}
            //else if(TESHUPAITYPE.isSiTaoSanTiao){
            //    this._gongXiNiShow(true);
            //    this._SiTaoSanTiao = true;
            //}
            //else if(TESHUPAITYPE.isWuDuiSanTiao){
            //    this._gongXiNiShow(true);
            //    this._WuDuiSanTiao = true;
            //}
            else {
                    this._gongXiNiShow(false);
                }
        }
        //this._initTeShuPaiSprite();
    },

    /*#####控制特殊牌精灵的显示*/
    _initTeShuPaiSprite: function _initTeShuPaiSprite() {
        /*把所有的特殊牌精灵都隐藏掉*/
        //for(var i=0;i<this.teshupai_min.length;i++){
        //    this.teshupai_min[i].active = false;
        //    this.teshupai_max[i].active = false;
        //}
        ///*如果是一条龙，就显示一条龙的精灵*/
        //if(this._yiTiaoLong){
        //    this.teshupai_min[3].active = true;
        //    this.teshupai_max[3].active = true;
        //}
        ///*如果是六对半就显示六对半的精灵*/
        //else if(this._liuDuiBan){
        //    this.teshupai_min[0].active = true;
        //    this.teshupai_max[0].active = true;
        //}
        ///*如果是三顺子就显示三顺子的精灵*/
        //else if(this._sanShunZi){
        //    this.teshupai_min[1].active = true;
        //    this.teshupai_max[1].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._sanTongHua){
        //    this.teshupai_min[2].active = true;
        //    this.teshupai_max[2].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._QingLong){
        //    this.teshupai_min[4].active = true;
        //    this.teshupai_max[4].active = true;
        //}_gongXiNiShow
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SanTongHuaShun){
        //    this.teshupai_min[5].active = true;
        //    this.teshupai_max[5].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SanFenTianXia){
        //    this.teshupai_min[6].active = true;
        //    this.teshupai_max[6].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._CouYiSe){
        //    this.teshupai_min[7].active = true;
        //    this.teshupai_max[7].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SiTaoSanTiao){
        //    this.teshupai_min[8].active = true;
        //    this.teshupai_max[8].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._WuDuiSanTiao){
        //    this.teshupai_min[9].active = true;
        //    this.teshupai_max[9].active = true;
        //}
    },

    /*#####*/
    //显示gongXiNi 页面和teShuPai
    clickGongXiNiShow: function clickGongXiNiShow() {
        this.cardTypeCombineNode.scale = 1;
        var nodes = this.gongXiNi.getChildByName("bg");
        nodes.opacity = 0;
    },

    _gongXiNiShow: function _gongXiNiShow(statues) {
        var test = arguments.length <= 1 || arguments[1] === undefined ? "" : arguments[1];

        //var alterCom = this.gongXiNi.getComponent("alert");
        var alterCom = this.gongXiNi.getComponent('alert');
        alterCom.unscheduleAllCallbacks();
        test = "是否按特殊牌型[" + test + "]出牌？" + "\n" + "(取消后点击左下角可再报道)";
        alterCom.setMessage(test);
        if (statues) {
            alterCom.alert();
        } else {
            alterCom.dismissAction();
        }
        this.teShuPai.active = statues;
        var nodes = this.teShuPai.getChildByName("btnTeshupai");
        nodes.children[0].runAction(cc.repeatForever(cc.rotateBy(1, -360)));
        nodes.children[1].runAction(cc.repeatForever(cc.rotateBy(1, 360)));
    },
    /*#####*/

    //  结果相关
    // 显示一局结果
    _showOneGameResult: function _showOneGameResult() {
        /**/
        this._isComparingCardsNow = false;
        /**/
        this.updateGameStatus(GAMESTATUS.WAIT_PEOPLE);
        //let oneGameResult = this.oneGameResult.getComponent('GameResult');
        //oneGameResult.unscheduleAllCallbacks();
        //oneGameResult.showResults(this._deskInfo, this._userId);
        this._updateUserScores();
        //this._updateBanker();
        //
        var self = this;
        this.scheduleOnce(function () {
            //self._playerComponents.forEach(function (playerComp) {
            //  //playerComp.reset();
            //  //playerComp.reset2();  //#####
            //});

            if (!self._isRandomRoom()) {
                //if (self._deskInfo.cIndex == 0) {//一局还没开始
                //    self.btnReady.node.active = true;
                //}
                if (self._isTotalGameOver()) {
                    self._showTotalGameResult();
                }
            }
        }, 0.5);

        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.scheduleOnce(function () {
                oneGameResult.getComponent('alert').dismissAction();
                cc.director.loadScene('hall');
            }, 2);
            return true;
        }
    },

    // 显示总结果
    _showTotalGameResult: function _showTotalGameResult() {
        var showDelay = arguments.length <= 0 || arguments[0] === undefined ? 2 : arguments[0];

        this.timeStop();
        //cc.find("Canvas/show_result").active = false;
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.alertAnsowerExitNode.active = false;
        this.alertRequestExitNode.active = false;
        if (this._deskInfo.cIndex == this._deskInfo.mMax) {
            this.againBtn.active = true;
        } else {
            this.againBtn.active = false;
        }

        var totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');
        if (totalGameResultComp.node.active) {
            return;
        }

        if (this._bigRecordInfo == null) {
            this._bigRecordInfo = this._deskInfo.players;
        }
        totalGameResultComp.setPlayerInfos(this._bigRecordInfo, this._deskInfo);

        var alert = this.totalGameResult.getComponent('alert');
        this.scheduleOnce((function () {
            //this.oneGameResult.active = false;
            //alert.alert();
            /**/
            if (!this.totalGameResult.active) {
                alert.alert();
            }
            /**/
        }).bind(this), showDelay);

        alert.setDismissCallback(function () {
            Socket.sendOnceAgain('false', this._userId);
            //cc.director.loadScene('hall');
        });
    },
    clickAgain: function clickAgain() {
        Socket.sendOnceAgain('true', this._userId);
    },

    // MARK: Socket 相关
    _loadDeskInfo: function _loadDeskInfo() {
        Socket.sendGetDesckInfo(this._userId);
    },
    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveOnlineStatus, this._socketReciveOnlineStatus, this);
        KQGlobalEvent.on(Socket.Event.ReceiveChatText, this._socketReciveChatTextMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveChatEmoji, this._socketReciveChatEmojiMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolve, this._socketReceiveRequestExitMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolveResult, this._socketReceiveRequestExitResultMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveAudioMessage, this._socketReceiveAudioMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceivePlayCard, this._socketReceivePlayCard, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGameOver, this._socketReceiveGameOver, this);
        KQGlobalEvent.on(Socket.Event.ReceiveFaPai, this._socketReciveFaPai, this);
        KQGlobalEvent.on(Socket.Event.ReceiveReady, this._socketReciveReady, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDissolveDesk, this._socketReceiveDissolveDesk, this);
        KQGlobalEvent.on(Socket.Event.ReceiveLeaveDesk, this._socketLeaveDesk, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._receiveSocketConnectError, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._receiveSocketConnectSuccessed, this);
        KQGlobalEvent.on(Socket.Event.ReceivePause, this._socketReceivePause, this);
        KQGlobalEvent.on(Socket.Event.ReceiveSelectBeiLv, this._ReceiveSelectBeiLv, this);
        KQGlobalEvent.on(Socket.Event.ReceiveBeiLv, this._ReceiveBeiLv, this);
        KQGlobalEvent.on(Socket.Event.ReceiveQingLi, this._ReceiveQingLi, this);
        KQGlobalEvent.on(Socket.Event.ReceiveOnceAgain, this._ReceiveOnceAgain, this);
    },

    _ReceiveOnceAgain: function _ReceiveOnceAgain(response) {
        var _this3 = this;

        /**
         * 再来一局
         * 总结果要隐藏掉
         * 比牌要隐藏掉
         * 发牌要显示
         */
        this._playedCompareCardsIndexs = [];
        this.playerComps.forEach(function (playerComp) {
            playerComp.playedCompareCardsIndexs = _this3._playedCompareCardsIndexs;
        });
        var data = response.data;
        if (!data.reason) {
            this.totalGameResult.active = false;
            this.startCompareCardsNode.active = false;
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset(); //#####
            });
            this._socketReceiveDeskInfo(response);
        } else {
            var now = Date.now();
            if (now - this._nowTimeAgain > 1500) {
                this._nowTimeAgain = now;
                this.alertAnsowerExitResult.y = -143;
                this.alertAnsowerExitResult.opacity = 255;
                this.alertAnsowerExitResult.children[0].getComponent(cc.Label).string = '房卡不足';
                var action = cc.spawn(cc.moveTo(0.3, cc.p(0, 20)), cc.fadeOut(0.3));
                this.alertAnsowerExitResult.runAction(cc.sequence(cc.moveTo(1, cc.p(0, 0)), action));
            }
        }
    },

    _ReceiveSelectBeiLv: function _ReceiveSelectBeiLv() {
        if (this._deskInfo.createId != this._userId) {
            this.beilv.active = true;
            var B3 = this.beilv.getChildByName('bg').getChildByName('btn3').getComponent(cc.Button);
            if (this._deskInfo.setting5 == 1) {
                /**
                 * 庄家选择两倍的时候 3倍按钮是不能响应的
                 * 选择三倍不用管，全部显示，
                 * 选择一倍也不用管，直接发牌，
                 */
                B3.interactable = false;
            }
            var selectBl = this.beilv.getComponent('selectBeilv');
            selectBl._userid = this._userid;
        }
    },

    _ReceiveBeiLv: function _ReceiveBeiLv(response) {
        var userId = response.data.userId;
        var bl = response.data.beilv;
        this._playerComponents.forEach(function (player) {
            player.showBeilv(userId, bl);
        });
    },

    _ReceiveQingLi: function _ReceiveQingLi(response) {
        var leaveId = response.data.leaveId;
        if (leaveId == this._userId) {
            if (cc.qingli == null) {
                var ql = response.action;
                cc.qingli = '';
                cc.qingli = ql;
            }
            cc.director.loadScene('hall');
        }
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        var data = response.data;

        this._initPlayerComponents(data.playersIndexAyy);
        /*#####添加五同按钮*/
        // cc.moshi = 0;

        // if(data.setting3[1] == true) cc.moshi = 1;  //  ？？？

        cc.maPai = null;

        if (data.maPai.length == 2) cc.maPai = data.maPai[0] + "_" + data.maPai[1];

        cc.huaSe = data.setting3[2];

        cc.chaoShiChuPai = data.setting6;

        cc.duoYiSe = response.data.setting2; //setting2为 4~7 人（0~3）

        this._deskInfo = data;
        this._globalMsg(data);
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(data.roomId);
        this.needCard.string = data.needCard; // 开放需要的房卡
        var playerIndexs = data.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._updateUserScores();
        this._updateBanker();
        this._msgControl.addPlayerInfos(this._playerInfos);

        var currentUserInfo = players.find((function (playerInfo) {
            return playerInfo.id == this._userId;
        }).bind(this));

        if (data.createId == this._userId) {
            if (data.cIndex > 0) {
                // 开始游戏了，请离按钮全部隐藏
                this._playerComponents.forEach(function (player) {
                    player.showQingli(false, data.cIndex);
                });
            } else {
                // 游戏没开始，房主的请离按钮不显示
                this._playerComponents.forEach(function (player) {
                    if (data.createId == player.userId) {
                        // 我是房主，不显示我的请离按钮
                        player.showQingli(true, data.cIndex);
                    } else {
                        player.showQingli(false, data.cIndex);
                    }
                });
            }
        }

        this._playerComponents.forEach(function (player) {
            if (data.createId == player.userId) {
                //显示房主
                player.showFangZhuStatus(data.createId, true);
            } else {
                player.showFangZhuStatus(player.userId, false);
            }
        });

        if (this._deskInfo.createId != this._userId) {
            // 非庄家
            if (this._deskInfo.cIndex == 0) {
                // 如果还没开始游戏，显示退出按钮，隐藏解散按钮
                this.exit.active = true;
                this.Dissolve.active = false;
            } else {
                // 反之
                this.exit.active = false;
                this.Dissolve.active = true;
            }
        } else {
            // 庄家
            if (this._deskInfo.cIndex > 0) {
                // 开局了 隐藏退出按钮
                this.exit.active = false;
                this.Dissolve.active = true;
            } else {
                // 没开局 两个都显示
                this.exit.active = true;
                this.Dissolve.active = true;
            }
        }

        if (!this._deskInfo.isCBegin) {
            this._gameStatus = GAMESTATUS.WAIT_READY;
        }
        for (var i = 0; i < players.length; i++) {
            var s = players[i];
            var is = s.readyStatus; //true/false
            var userId = s.id;
            this._playerComponents.forEach((function (player) {
                if (!this._deskInfo.isCBegin) player.showReadyStatus(userId, is);
            }).bind(this));
        }
        if (currentUserInfo && currentUserInfo.cards.length > 0 && this._deskInfo.isCBegin) {
            if (!currentUserInfo.cardInfo.length) {
                this._startGame(true);
            } else {
                this._startGame(false);
            }
        } else if (UserModelHelper.isPlayedCards(currentUserInfo) && !this._deskInfo.isCBegin) {
            this._socketReceiveGameOver(response);
        }
        this.isReadyStatus();
        this._handleUpdateDeskInfoAboutExitRoom(this._deskInfo);
        this.showCompareCard();
    },

    showCompareCard: function showCompareCard() {
        if (this._deskInfo.cIndex == 0 || this._deskInfo.isCBegin || !this._deskInfo.players || this._deskInfo.players.length <= 0 || this._deskInfo.players[0].cardInfo <= 0) {
            return;
        }

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        this.unscheduleAllCallbacks();

        this.node.stopAllActions();

        this._playerComponents.forEach(function (playerComp) {
            playerComp.readyToCompareCards();
        });

        this._playerComponents.forEach((function (player) {

            if (player.node.active) player.showAllCompareCards(this._deskInfo.players);
        }).bind(this));

        this.startCompareCardsNode.active = false;

        this._isComparingCardsNow = false;

        this.isReadyStatus();

        this.scheduleOnce((function () {

            if (this._isTotalGameOver()) this._showTotalGameResult();
        }).bind(this), 0.5);
    },

    _socketReciveFaPai: function _socketReciveFaPai(response) {
        //  发牌了开始比牌隐藏掉
        this.startCompareCardsNode.active = false;
        this.timeStop();
        this._isComparingCardsNow = true;
        this._gameStatus = GAMESTATUS.WAIT_READY;
        this._socketReceiveDeskInfo(response);
    },
    logoutAction: function logoutAction() {
        cc.director.loadScene('login');
        //manager.setUserInfo('');
        //hall.cacheImageInfo = null;
    },
    _socketReciveOnlineStatus: function _socketReciveOnlineStatus(response) {
        //{"action":"sendOnlineStatus","result":true,"data":{"userId":100049,"status":1}}
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }

        var data = response.data;
        var userId = data.userId;
        var status = data.status;

        this._playerComponents.forEach(function (player) {
            player.setUserOnlineStatus(userId, status);
        });
    },

    _socketReciveChatTextMessage: function _socketReciveChatTextMessage(response) {
        var userId = response.data.userId;
        var message = response.data.msg;

        this._playerComponents.forEach(function (player) {
            player.showChatText(userId, message);
        });

        this._msgControl.addChatTextMessage(userId, message);

        var sex = this._playerInfos.find(function (user) {
            return user.id == userId;
        }).sex;
        AudioManager.instance.playChatAudio(sex, message);
    },
    _socketReciveChatEmojiMessage: function _socketReciveChatEmojiMessage(response) {
        var userId = response.data.userId;
        var emoji = response.data.emoji;

        //this._playerComponents.forEach(function (player) {
        //    player.showChatText(userId, emoji);
        //});
        //this._msgControl.addChatEmojiMessage(userId, emoji);
        this._msgControl._loadEmojiFrame(emoji, (function (frame) {
            this._playerComponents.forEach(function (player) {
                if (player.userId == userId) player.chatMessageNode.getComponent('ChatMessage').showEmoji(frame);
            });
        }).bind(this));
    },

    _socketReceiveRequestExitMessage: function _socketReceiveRequestExitMessage(response) {
        //if (response.data.userId == this._userId) {
        //    return;
        //}

        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");

        var btnAgree = alert_bg.getChildByName("btnAgree");

        var btnDisagree = alert_bg.getChildByName("btnDisagree");

        btnAgree.active = true;

        btnDisagree.active = true;

        var dataInfos = response.data.info;

        if (!this.alertAnsowerExitNode.active) {

            var alertComp = this.alertAnsowerExitNode.getComponent('alert');

            alertComp.alert();

            alertComp.unscheduleAllCallbacks();

            this.contentAnsowerExitNode.children.forEach(function (i) {
                i.active = false;
            });

            this._playerInfos.forEach((function (playerInfo, index) {

                var play = this.contentAnsowerExitNode.children[index];

                var name = play.getChildByName("nickname");

                var back = play.getChildByName("fanzhu");

                var img = play.getChildByName("avatar_bg");

                play.active = true;

                name.getComponent(cc.Label).string = playerInfo.nickname;

                if (this._deskInfo.createId == playerInfo.id) {
                    //显示房主

                    back.active = true;
                } else {

                    back.active = false;
                }

                cc.loader.load({ url: playerInfo.avatarUrl, type: "jpg" }, (function (err, data) {

                    if (err) return;

                    var frame = new cc.SpriteFrame(data);

                    img.getComponent(cc.Sprite).spriteFrame = frame;
                }).bind(this));
            }).bind(this));

            var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');

            countdown.startCountdown(60, (function (isTimeout) {

                if (isTimeout) {

                    this.clickAgreeOtherPlayerExit();

                    return;
                }
            }).bind(this));
        }

        this._playerInfos.forEach((function (playerInfo, index) {

            var dataInfo = dataInfos[index];

            var play = this.contentAnsowerExitNode.children[index];

            var str = play.getChildByName("id");

            var dataInfo = dataInfos[index];

            if (dataInfo == 1) {

                if (this._userId == playerInfo.id) {
                    //显示房主

                    btnAgree.active = false;

                    btnDisagree.active = false;
                }

                str.getComponent(cc.Label).string = "同意";
            } else {

                str.getComponent(cc.Label).string = "";
            }
        }).bind(this));
    },

    _socketReceiveRequestExitResultMessage: function _socketReceiveRequestExitResultMessage(response) {
        this._hideReqestExitNode();
        if (this.alertAnsowerExitNode.active) {
            this.alertAnsowerExitNode.getComponent('alert').dismissAction();
            this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        }

        if (response.data.result) {
            // 解散成功
        } else {
                var userId = response.data.userId;
                var nickname = this._findPlayerInfoByUserId(userId).nickname;
                this.alertAnsowerExitResult.y = -143;
                this.alertAnsowerExitResult.opacity = 255;
                this.alertAnsowerExitResult.children[0].getComponent(cc.Label).string = nickname + '不同意退出';
                var action = cc.spawn(cc.moveTo(.3, cc.p(0, 20)), cc.fadeOut(this.cardTime));
                this.alertAnsowerExitResult.runAction(cc.sequence(cc.moveTo(1, cc.p(0, 0)), action));

                //this.showAlertMessage('解散失败，因为' + nickname + '不同意退出');
            }
    },

    _socketReceiveAudioMessage: function _socketReceiveAudioMessage(response) {
        var userId = response.data.userId;
        this.playSpeakAnimation(userId);

        if (userId == this._userId) {
            return;
        }

        var url = response.data.url;
        this.playAudioUrl(url);
    },

    _socketReceivePlayCard: function _socketReceivePlayCard(response) {
        // 有用户已经准备好了牌
        var userId = response.data[0].userId;
        var cardInfo = response.data[1].card;
        this._deskInfo = response.data[2].s;
        var players = response.data[2].s.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._playerComponents.forEach(function (player) {
            player.playCard(userId, cardInfo);
        });

        if (userId == this._userId) {
            this.cardTypeCombineNode.active = false;
        }
    },
    _getSelfReadyStatus: function _getSelfReadyStatus() {
        var self = this._findPlayerInfoByUserId(this._userId);
        return self.readyStatus;
    },
    _socketReciveReady: function _socketReciveReady(response) {
        var userId = response.data.userId;
        this._playerComponents.forEach((function (player) {
            if (!this._deskInfo.isCBegin) player.showReadyStatus(userId);
        }).bind(this));
    },

    //收到游戏结束
    _socketReceiveGameOver: function _socketReceiveGameOver(response) {
        this.timeStop();
        cc.sys.localStorage.removeItem("timestamp");

        this._hideReqestExitNode();

        // 一局游戏结束
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        /**/
        var deskInfo = response.data;
        if (response.action == 'gameOver' && deskInfo.isDeskOver) {

            Socket.sendDidReceiveGameOverAction(this._userId);
        }
        /**/
        this._deskInfo = response.data;

        // 如果是强制解散房间，则直接显示总成绩
        if (this._isDissvledRoom() && !Playback.instance.isPlaybacking()) {
            this._showTotalGameResult(0.1);
            return;
        }

        if (Date.now() - this._enterTime < 1000 * 4) {
            // 刚进来的话，不展示比牌动画
            //  let oneGameResult = this.oneGameResult.getComponent('GameResult');
            //  oneGameResult.unscheduleAllCallbacks();
            //  oneGameResult.showResults(this._deskInfo, this._userId);
            this.isReadyStatus();
            this.btnShare.node.active = false;
            this.btnReady.node.active = true;
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
            /**/
            this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
            /**/
            return;
        }

        var data = response.data;
        this._deskInfo = data;
        this._bigRecordInfo = data.bigRecordInfo;
        //console.log(data);
        //console.log("-----------------------------------1709");
        this._updatGameOverview(this._deskInfo);
        //let playerIndexs = data.playersIndex; // [100049]

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        //this._updateRecordInfo(players);

        if (UserModelHelper.isUserReady(this._findCurrentUserInfo())) {
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
        } else {
            this._startCompareCards(response);
        }

        if (Date.now() - this._enterTime < 1000 * 4) {
            this.showCompareCard();
            return;
        }
    },
    // _updateRecordInfo:function(players){

    //     // this._bigRecordInfo.push();
    // },
    _socketReceiveDissolveDesk: function _socketReceiveDissolveDesk(response) {
        this.cardTypeCombineNode.active = false;
        cc.director.loadScene('hall');

        // this.alert.getComponent('alert').setWillDismissCallback(function(){

        //   return true;
        // });

        // let message = "房主已解散房间";
        // if (this._isRandomRoom()) {
        //   message = "有玩家已强制退出房间，游戏结束。本局游戏不会扣除您的钻石。";
        // }

        // this.showAlertMessage(message, false);
    },
    /**/
    _socketLeaveDesk: function _socketLeaveDesk(response) {
        if (!response.result) {
            return;
        }

        if (this._deskInfo.isDeskOver) {
            // 如果房间已结束，也不用再自动退回到大厅了
            return;
        }

        cc.director.loadScene('hall');
    },
    /**/
    // socket 收到有人手机进入后台消息
    _socketReceivePause: function _socketReceivePause(response) {
        if (!response.result) {
            return;
        }

        var userId = response.data.userId;
        this._playerComponents.forEach(function (player) {
            if (player.userId == userId) {
                player.setUserOnlineStatus(userId, 0);
            }
        });
    },

    _receiveSocketConnectError: function _receiveSocketConnectError(response) {
        this.showNetworkMessage();
    },

    _receiveSocketConnectSuccessed: function _receiveSocketConnectSuccessed(response) {
        this.hiddenNetworkMessage();

        if (!Playback.instance.isPlaybacking()) {
            this._loadDeskInfo();
        }
    },
    /**/
    // MARK: 更新房间信息
    updateDeskInfo: function updateDeskInfo(deskInfo) {
        this._deskInfo = deskInfo;
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(deskInfo.roomId);

        var playerIndexs = deskInfo.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = deskInfo.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._msgControl.addPlayerInfos(this._playerInfos);
        if (deskInfo.cIndex == 0 && this._deskInfo.players.length < this._deskInfo.maxNumber) {
            this.btnShare.node.active = true;
        }
    },
    /**/
    _injectUserIdToPlayerComponents: function _injectUserIdToPlayerComponents(playerIndexs) {
        var currentUserIdIndex = playerIndexs.findIndex((function (userId) {
            return userId == this._userId;
        }).bind(this));

        var fixedPlayerIndexs = playerIndexs.translationWithStartIndex(currentUserIdIndex);
        this._playerComponents.forEach(function (playerComponent, index) {
            var userId = fixedPlayerIndexs.length > index ? fixedPlayerIndexs[index] : null;
            playerComponent.userId = userId;
        });
    },

    _updateUserInfos: function _updateUserInfos(userInfos) {
        var self = this;
        this._playerComponents.forEach(function (playerComponent, index) {
            //playerComponent.setDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateUserInfoWithUsers(userInfos);
        });

        //this._handleTheSameOfIPAdress(userInfos);
    },

    _updateUserScores: function _updateUserScores(userInfos) {
        this._playerComponents.forEach(function (player) {
            player.updateScore();
        });
    },

    _updateBanker: function _updateBanker() {
        this._playerComponents.forEach(function (player) {
            player.updateBanker();
        });
    },

    // 私有方法
    _findCardsByUserId: function _findCardsByUserId(userId) {
        var player = this._findPlayerInfoByUserId(userId);

        return player != null ? player.cards : null;
    },

    _findPlayerInfoByUserId: function _findPlayerInfoByUserId(userId) {
        var player = (this._playerInfos || []).find(function (playerInfo) {
            return userId == playerInfo.id;
        });

        return player;
    },

    _findPlayerIndexByUserId: function _findPlayerIndexByUserId(userId) {
        //let index = this._playerComponents.findIndex(function (playerComp) {
        //    return playerComp.userId == userId;
        //});
        var index = this.playerNodes.findIndex(function (node) {
            return node.getComponent('Player').userId == userId;
        });
        return index;
    },

    _findCurrentUserInfo: function _findCurrentUserInfo() {
        return this._findPlayerInfoByUserId(this._userId);
    },

    _convertCardsToCardNames: function _convertCardsToCardNames(cards) {
        // [{"suit":"s","number":10}]
        var suitColorMap = {
            s: 4,
            h: 3,
            c: 2,
            d: 1
        };
        return cards.map(function (card) {
            var cardNumber = card.number;

            // 服务器中的 14 是 A
            if (card.number == 14) {
                cardNumber = 1;
            }
            var color = suitColorMap[card.suit];
            var number = Math.max(Math.min(cardNumber, 21), 1);
            return color + "_" + number;
        });
    },

    // 更新游戏总览信息
    _updatGameOverview: function _updatGameOverview(deskInfo) {
        if (Playback.instance.isPlaybacking()) {
            this.labelOverview.string = "回放";
            return;
        }

        if (this._isRandomRoom()) {
            this.labelOverview.string = "";
            return;
        }
        var bihuase = "不比花色 ";
        var zuozhuang = "不坐庄 ";
        var putong = "普通场 ";
        var wugui = "无鬼 ";
        var maPai = '不买马 ';
        var renshu = "4人不加色 ";
        var card = "平摊";

        //[疯狂场,鬼牌,比花色,坐庄,马牌]
        if (this._deskInfo.setting3[2]) {
            bihuase = "比花色  ";
        }
        if (this._deskInfo.setting3[3]) {
            zuozhuang = "坐庄 ";
        }
        if (this._deskInfo.setting3[0]) {
            putong = "疯狂场  ";
        }
        if (this._deskInfo.setting3[1]) {
            wugui = "有鬼  ";
        }
        if (this._deskInfo.setting3[4]) {
            maPai = "买马";
            var huaSe = "方块";
            var dianShu = 1;
            switch (this._deskInfo.setting7[0]) {//setting7 [1~4,1~13] 表示 [花色，点数]
                case 1:
                    huaSe = "方块";break;
                case 2:
                    huaSe = "梅花";break;
                case 3:
                    huaSe = "红心";break;
                case 4:
                    huaSe = "黑桃";break;
            }
            switch (this._deskInfo.setting7[1]) {
                case 1:
                    dianShu = 'A';break;
                case 2:
                    dianShu = 2;break;
                case 3:
                    dianShu = 3;break;
                case 4:
                    dianShu = 4;break;
                case 5:
                    dianShu = 5;break;
                case 6:
                    dianShu = 6;break;
                case 7:
                    dianShu = 7;break;
                case 8:
                    dianShu = 8;break;
                case 9:
                    dianShu = 9;break;
                case 10:
                    dianShu = 10;break;
                case 11:
                    dianShu = 'J';break;
                case 12:
                    dianShu = 'Q';break;
                case 13:
                    dianShu = 'K';break;
            }
            maPai = huaSe + dianShu + maPai;
        }

        if (this._deskInfo.setting2 == 1) {
            renshu = "5人加一色 ";
        } else if (this._deskInfo.setting2 == 2) {
            renshu = "6人加二色 ";
        } else if (this._deskInfo.setting2 == 3) {
            renshu = "7人加三色 ";
        }
        if (this._deskInfo.setting4 == 1) {
            card = "赢者扣 ";
        } else if (this._deskInfo.setting4 == 2) {
            card = "房主扣 ";
        }

        this.labelOverview.string = "模式 : " + bihuase + zuozhuang + putong + wugui + maPai + "\n" + "其他：" + renshu + card;
        //this.labelOverview.string = "模式 : " + "" + deskInfo.maxNumber + "人" +bihuase+zuozhuang+putong+wugui+maPai;
    },

    // 是否是随机房
    _isRandomRoom: function _isRandomRoom() {
        if (this._deskInfo == null) {
            return true;
        }

        return this._deskInfo.isRandomDesk;
    },

    // 是否所有局数都用完了
    _isTotalGameOver: function _isTotalGameOver() {
        if (this._deskInfo == null) {
            return false;
        }

        if (this._deskInfo.isDeskOver) {
            return true;
        }

        return this._deskInfo.mMax <= this._deskInfo.cIndex;
    },

    // 是否已解散房间
    _isDissvledRoom: function _isDissvledRoom() {
        if (this._deskInfo) {
            return this._deskInfo.dissolveStatus;
        }

        return false;
    },

    _startCompareCards: function _startCompareCards(data) {
        this._isComparingCardsNow = true;
        this._gongXiNiShow(false);
        this._players = data.data.players;
        var user = this._findPlayerInfoByUserId(this._userId);
        if (!this.totalGameResult.active) {
            AudioManager.instance.playStartCompare(user.sex);
        }

        this.startCompareCardsNode.getComponent('alert').alert();
        this._playerComponents.forEach(function (playerComp) {
            playerComp.readyToCompareCards();
        });
        this.unscheduleAllCallbacks();
        this.scheduleOnce((function () {
            this.startCompareCardsNode.active = false;
            this._showCompareCardDetails(data);
        }).bind(this), 1.0);
    },

    _showCompareCardDetails: function _showCompareCardDetails(data) {

        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset();
            playerComp.readyToCompareCards();
        });

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');

        cardTypeCombine.reset();

        cardTypeCombine.node.active = false;

        var comparePlayers1 = this._playerComponents.filter(function (player) {

            if (player.node.active) {

                var user = player.compareCardsNode.getComponent('CompareCards')._user;

                if (!user.isContainExtra) return player.node.active;
            }
        });

        var teShuPlayers = this._playerComponents.filter(function (player) {

            if (player.node.active) {

                var user = player.compareCardsNode.getComponent('CompareCards')._user;

                if (user.isContainExtra) return player.node.active;
            }
        });
        var self = this;
        var duration = this._showCompareCardStep(0, comparePlayers1);

        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers1);
        }, duration);

        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers1);
        }, duration * 2);

        if (teShuPlayers.length > 0) {
            this.scheduleOnce(function () {
                self._showCompareCardStep(0, teShuPlayers, true);
            }, duration * 3);
        }

        duration = duration * 3 + 0.5;

        for (var i = 0; i < teShuPlayers.length; i++) {

            var user = teShuPlayers[i].compareCardsNode.getComponent('CompareCards')._user;

            if (user.isContainExtra) duration = duration + 2.5;
        }

        var shootDuration = this.headCardTime;

        var shootDatas = this._shootDatas() || [];

        var shotData = this._shotData() || [];

        var homeRunUserId = this._homeRunUserId();

        var shotDataTimes = 0;

        shotData.forEach(function (data, index) {

            self.scheduleOnce(function () {

                self.playShoot(data.fromUserId, data.toUserId);
            }, duration + index * shootDuration);

            shotDataTimes += self.headCardTime;

            duration += self.headCardTime;
        });

        if (homeRunUserId.length >= 1) {

            shootDatas.forEach(function (data, index) {

                self.scheduleOnce(function () {

                    self.playShoot(data.fromUserId, data.toUserId);
                }, duration + (index + shotDataTimes) * shootDuration);

                duration += self.headCardTime;
            });
        }

        duration = duration + shootDatas.length * shootDuration + shotData.length * shootDuration;

        if (homeRunUserId > 0) {

            self.scheduleOnce(function () {
                self.playHomeRun(homeRunUserId);
            }, duration);

            duration = duration + 1;
        }

        if (homeRunUserId) {
            duration = duration + 1;
        }

        //this.scheduleOnce(function () {this._jinBiAction();}.bind(this), duration);//显示结算金币//显示结果
        this._jinBiAction(duration);
        //this.scheduleOnce(function () {
        //
        //    this._playerComponents.forEach(function (playerComp) {playerComp.showScoreResult();});
        //
        //    self._showCompareCardFinished();
        //
        //}.bind(this), duration);
    },

    _jinBiAction: function _jinBiAction(duration) {
        var comparePlayers1 = this._playerComponents.filter(function (player) {
            return player.node.active;
        });

        var nextTime = 0; //下一个动作开始的时间

        var zTime = 0; //下下一个动作开始的时间

        var start = 0;

        var end = 0;

        var coinsContainerAyy = []; //所有的用户的金币 一个用户一个数组

        var coinsAyy = []; //所有的金币，一个数组

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        comparePlayers1.forEach((function (plays, index) {
            //根据积分创建金币

            var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

            if (cScore < 0) {

                cScore *= -1;

                var node = new cc.Node();

                node.name = "coinsContainer";

                var numScore = cScore > 30 ? 30 : cScore;
                for (var i = 0; i < numScore; i++) {
                    this._createJinBiPrefab(node, node); //根据积分创建金币
                }

                this.playsCoins[index].addChild(node);

                coinsContainerAyy.push(node.children);
            }
        }).bind(this));

        this.playsCoins.forEach(function (no) {
            if (no) no.active = false;
        });

        this.scheduleOnce((function () {
            //显示结果

            this.playsCoins.forEach(function (no) {
                if (no) no.active = true;
            });

            AudioManager.instance.coinIncome();

            coinsContainerAyy.forEach((function (coinsAyys) {
                //把金币移动到容器

                var initTime = 0;

                var interval = 0.002;

                coinsAyys.forEach((function (coins) {
                    //把金币移动到容器

                    var y = Math.round(Math.random()) == 0 ? -1 : 1;

                    y = Math.floor(Math.random() * 38) * y;

                    var x = Math.round(Math.random()) == 0 ? -1 : 1;

                    x = Math.floor(Math.random() * 38) * x;

                    var cardBackWorldSpace1 = this.node.convertToWorldSpaceAR(cc.v2(x, y));

                    var v2 = coins.convertToNodeSpaceAR(cardBackWorldSpace1);

                    this.scheduleOnce(function () {

                        coins.runAction(cc.moveBy(0.2, v2));
                    }, initTime);

                    initTime = initTime + interval;
                }).bind(this));

                nextTime = initTime;

                coinsAyy = coinsAyy.concat(coinsAyys); //把金币集合到一个数组
            }).bind(this));

            var zcScore = 0;

            comparePlayers1.forEach((function (plays) {
                //计算金币

                var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

                cScore = cScore > 30 ? 30 : cScore;

                if (cScore > 0) zcScore += cScore * 1;
            }).bind(this));

            var coinsAyy1 = coinsAyy.splice(zcScore, coinsAyy.length);

            coinsAyy1.forEach(function (node) {
                node.parent.removeChild(node);
            });

            comparePlayers1.forEach((function (plays) {
                //把金币到用户头像附近

                var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

                if (cScore > 0) {

                    var interval = 0.0025;

                    var initTime = nextTime + 1;

                    var numScore = cScore > 30 ? 30 : cScore;

                    //end += numScore;

                    coinsAyy.splice(0, numScore).forEach((function (coinsNode) {
                        //把金币到用户头像附近

                        this.scheduleOnce(function () {

                            //获取节点的世界坐标
                            var cardBackWorldSpace1 = plays.node.convertToWorldSpaceAR(cc.v2(0, 0));
                            //获取相对父节点所在的坐标
                            var detail = coinsNode.convertToNodeSpaceAR(cardBackWorldSpace1);

                            var moveBy = cc.moveBy(0.25, detail);

                            var nextFadeIn = cc.fadeOut(0.13);

                            var moveSeq = cc.sequence(moveBy, nextFadeIn);

                            coinsNode.runAction(moveSeq);
                        }, initTime);

                        initTime = initTime + interval;
                    }).bind(this));

                    //start += cScore;

                    zTime = initTime;
                }
            }).bind(this));

            this.scheduleOnce((function () {
                //显示结果

                //this.playsCoins.forEach(function(no){if(no) no.active = false;});

                this._showCompareCardFinished();

                comparePlayers1.forEach(function (playerComp) {
                    playerComp.showScoreResult();
                });
            }).bind(this), zTime);

            this.scheduleOnce((function () {
                //显示结果

                this.playsCoins.forEach(function (no) {
                    if (no) no.removeAllChildren();
                });
            }).bind(this), zTime + 5);
        }).bind(this), duration);
    },

    _createJinBiPrefab: function _createJinBiPrefab(node, v2Node) {

        var nodes = cc.instantiate(this.coinsPrefab);

        var y = Math.round(Math.random()) == 0 ? -1 : 1;

        y = Math.floor(Math.random() * 38) * y + v2Node.y;

        var x = Math.round(Math.random()) == 0 ? -1 : 1;

        x = Math.floor(Math.random() * 38) * x + v2Node.x;

        nodes.x = x;

        nodes.y = y;

        node.addChild(nodes);
    },

    _showCompareCardStep: function _showCompareCardStep() {
        var startTime = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];
        var comparePlayers = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];
        var isContainExtra = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

        var duration = startTime;
        var interval = this.headCardTime;
        var teshuTime = 0;
        var self = this;

        comparePlayers = comparePlayers.sort(function (player1, player2) {
            return player1.nextCompareScore() - player2.nextCompareScore();
        });

        var co = comparePlayers;
        //console.log(co)
        //console.log('-------------执行了几次')

        co.forEach(function (player) {

            self.scheduleOnce(function () {
                player.showNextCompareCards();
            }, duration + teshuTime);

            duration = duration + interval;
            var user = player.compareCardsNode.getComponent('CompareCards')._user;
            if (user.isContainExtra) {
                if (user.cardInfo[0].type == 10) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._santonghuaAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 11) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._sanshunziAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 12) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._liuduibanAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 18) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._qinglongAniamtion('long');
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 19) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._qinglongAniamtion("ql");
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                }
            }
        });

        if (isContainExtra) {

            for (var i = 0; i < co.length; i++) duration = duration + 2.5;

            this._playerComponents.forEach(function (player) {
                if (player.node.active) {
                    self.scheduleOnce(function () {
                        player.showNextCompareScore(isContainExtra);
                    }, duration - interval);
                }
            });
        } else {
            co.forEach(function (player) {
                self.scheduleOnce(function () {
                    player.showNextCompareScore();
                }, duration - interval);
            });
        }

        return duration + teshuTime;
    },

    _isGameOver: function _isGameOver() {},

    // 比牌完成后会调用的方法
    _showCompareCardFinished: function _showCompareCardFinished() {
        this.timeStart(5, "ready");
        this._showOneGameResult();
        /**/
        this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
        /**/
    },

    //network
    showNetworkMessage: function showNetworkMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? "网络链接断开，重新连接中..." : arguments[0];

        if (this.networkNode && this.networkNode.active) {
            return;
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg, autoDismiss) {
        var alertComp = this.alert.getComponent('alert');
        if (!this.alert.active) {
            alertComp.alert();
        }

        alertComp.setMessage(msg);
        alertComp.unscheduleAllCallbacks();
        if (autoDismiss) {
            alertComp.scheduleOnce(function () {
                alertComp.dismissAction();
            }, 5);
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? '检查网络中...' : arguments[0];

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null && this.checkNode.active) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },

    /////  聊天语音逻辑
    // _registerVoiceNodeEvents: function () {
    //     let self = this;
    //     let chatVoiceNode = this.btnChatVoice.node;
    //     this.endRecordTime = Date.now();
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_START,function(event) {
    //         if (Date.now() - self.endRecordTime >= 1000) {
    //             self.nativeRecordAction();
    //             //self.voiceRecordAnimationNode.active = true;

    //             let action = cc.scaleTo(0.12, 1.2);
    //             self.btnChatVoice.node.runAction(action);

    //             self._isRecording = true;
    //         }
    //     });
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_END,function(event) {
    //         if (self._isRecording) {
    //             self.endRecordTime = Date.now();
    //         }
    //         self._isRecording = false;

    //         self.nativeEndRecordAction();
    //         //self.voiceRecordAnimationNode.active = false;

    //         let action = cc.scaleTo(0.12, 1);
    //         self.btnChatVoice.node.runAction(action);
    //     });
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL,function(event) {
    //         if (self._isRecording) {
    //             self.endRecordTime = Date.now();
    //         }
    //         self._isRecording = false;

    //         self.nativeEndRecordAction();
    //         //self.voiceRecordAnimationNode.active = false;

    //         let action = cc.scaleTo(0.12, 1);
    //         self.btnChatVoice.node.runAction(action);
    //     });
    //     Socket.instance.uploadFinish = function(url) {
    //         let userId = self._userId;
    //         Socket.sendAudioMessage(userId, url);
    //         self.playSpeakAnimation(self._userId);
    //     };
    // },

    _registerVoiceNodeEvents: function _registerVoiceNodeEvents() {
        var self = this;
        var chatVoiceNode = this.btnChatVoice.node;
        this.endRecordTime = Date.now();
        chatVoiceNode.on(cc.Node.EventType.TOUCH_START, function (event) {
            // self.VoiceMsgBgAnimation();
            if (!cc.sys.isNative) {
                var runTime = 0.3;
                var tishi = cc.instantiate(self.autoTishi);
                self.node.addChild(tishi);
                var action = cc.spawn(cc.moveTo(0.3, cc.v2(0, 0)), cc.fadeIn(0.3));
                tishi.runAction(action);
                self.scheduleOnce((function () {
                    var finished = cc.callFunc(function () {
                        tishi.removeFromParent(true);
                    });
                    var action = cc.sequence(cc.spawn(cc.fadeOut(runTime), cc.moveTo(runTime, cc.v2(0, 50))), finished);
                    tishi.runAction(action);
                }).bind(this), 1.5);
                //var url = "www.baidu.com";
                //let userId = self._userId;
                //Socket.sendAudioMessage(userId, url);
            } else {
                    if (Date.now() - self.endRecordTime >= 1000) {
                        self.VoiceMsgBgAnimation();
                        self.nativeRecordAction();
                        var _action = cc.scaleTo(0.12, 1.2);
                        self.btnChatVoice.node.runAction(_action);
                        self._isRecording = true;
                    }
                }
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            self.VoiceMsgBg.active = false;
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            //self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            self.VoiceMsgBg.active = false;
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            //self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        Socket.instance.uploadFinish = function (url) {
            var userId = self._userId;
            Socket.sendAudioMessage(userId, url);
            self.playSpeakAnimation(self._userId);
        };
    },
    VoiceMsgBgAnimation: function VoiceMsgBgAnimation() {
        this.VoiceMsgBg.active = true;
        var whileLayout = this.VoiceMsgBg.getChildByName("whileLayout");
        var childWhile = whileLayout.getChildByName("childWhile");
        if (this.whileLayoutInterval) {
            clearInterval(this.whileLayoutInterval);
        }

        this.whileLayoutInterval = setInterval(function () {
            var node = cc.instantiate(childWhile);
            if (whileLayout.children.length > 5) {
                whileLayout.removeAllChildren();
            }
            whileLayout.addChild(node);
        }, 200);

        var layout = this.VoiceMsgBg.getChildByName("layout");
        var cWhile = layout.getChildByName("while");

        if (this.layoutInterval) {
            clearInterval(this.layoutInterval);
        }

        this.layoutInterval = setInterval(function () {
            var node = cc.instantiate(cWhile);
            if (layout.children.length > 3) {
                layout.removeAllChildren();
            }
            layout.addChild(node);
        }, 300);
    },
    nativeRecordAction: function nativeRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
            AudioManager.instance.pauseMusic();
        }
    },

    nativeEndRecordAction: function nativeEndRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
            AudioManager.instance.resumeMusic();
        }
    },

    playAudioUrl: function playAudioUrl(url) {
        //console.log("---------------------------2553");
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", url);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", url);
        }
    },

    // MARK:  退出游戏逻辑
    _handleUpdateDeskInfoAboutExitRoom: function _handleUpdateDeskInfoAboutExitRoom(deskInfo) {
        if (!deskInfo.isDissolving) {
            return;
        }
        var dataInfos = deskInfo.dissolveAnswerInfo;

        var alertComp = this.alertAnsowerExitNode.getComponent('alert');

        alertComp.alert();

        alertComp.unscheduleAllCallbacks();

        this.contentAnsowerExitNode.children.forEach(function (i) {
            i.active = false;
        });

        this._playerInfos.forEach((function (playerInfo, index) {

            var play = this.contentAnsowerExitNode.children[index];

            var name = play.getChildByName("nickname");

            var back = play.getChildByName("fanzhu");

            var img = play.getChildByName("avatar_bg");

            var str = play.getChildByName("id");

            var dataInfo = dataInfos[index];

            play.active = true;

            name.getComponent(cc.Label).string = playerInfo.nickname;

            if (this._deskInfo.createId == playerInfo.id) {
                //显示房主

                back.active = true;
            } else {

                back.active = false;
            }

            cc.loader.load({ url: playerInfo.avatarUrl, type: "jpg" }, (function (err, data) {

                if (err) return;

                var frame = new cc.SpriteFrame(data);

                img.getComponent(cc.Sprite).spriteFrame = frame;
            }).bind(this));

            if (dataInfo == 1) {

                str.getComponent(cc.Label).string = "同意";
            } else {

                str.getComponent(cc.Label).string = "";
            }
        }).bind(this));

        var dissolveLeftTime = deskInfo.dissolveLeftTime || 60;

        var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');

        countdown.startCountdown(dissolveLeftTime, (function (isTimeout) {

            if (isTimeout) {
                this.clickAgreeOtherPlayerExit();
                return;
            }
        }).bind(this));

        var dissolveUserId = deskInfo.dissolveUserId;

        if (dissolveUserId == this._userId) {

            var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");

            var btnAgree = alert_bg.getChildByName("btnAgree");

            var btnDisagree = alert_bg.getChildByName("btnDisagree");

            btnAgree.active = false;

            btnDisagree.active = false;
            //this.alertRequestExitNode.active = true;
            //this.btnAlertRequestExitCancelButton.node.active = false;
            //this.btnAlertRequestExitConfirmButton.node.active = false;
            //let alert = this.alertRequestExitNode.getComponent('alert');
            //alert.setMessage("您正在申请协商退出，等待其他玩家同意");
            //this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(dissolveLeftTime);
            return;
        }

        //let dissolveAnswerInfos = deskInfo.dissolveAnswerInfo;
        //let currentUserIdIndex = deskInfo.playersIndex.findIndex(function(userId) {
        //    return this._userId == userId;
        //}.bind(this));
        //
        //let answerResult = dissolveAnswerInfos[currentUserIdIndex];
        //
        //if (answerResult == -1) {
        //    // -1 表示未处理  0 表示拒绝  1表示同意
        //    this.alertAnsowerExitNode.active = true;
        //
        //    let countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');
        //
        //    countdown.startCountdown(dissolveLeftTime, function(isTimeout) {
        //        if (isTimeout) {
        //            this.clickAgreeOtherPlayerExit();
        //        }
        //    }.bind(this));
        //
        //}
    },

    // 确定要强制退出游戏
    clickConfirmForceExit: function clickConfirmForceExit() {
        Socket.sendForceExitRoom(this._userId);
        cc.director.loadScene('hall');
    },

    // 确认请求退出游戏
    clickConfirmRequestExit: function clickConfirmRequestExit() {
        this.btnAlertRequestExitCancelButton.node.active = false;
        this.btnAlertRequestExitConfirmButton.node.active = false;
        var alert = this.alertRequestExitNode.getComponent('alert');
        if (this._deskInfo.cIndex > 0) {
            alert.setMessage("您正在申请协商退出，等待其他玩家同意");
            this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(60);
        }
        Socket.sendLeaveDesk(this._userId);
    },

    // 同意他人退出
    clickAgreeOtherPlayerExit: function clickAgreeOtherPlayerExit() {
        //this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        //this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        //this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");
        var btnAgree = alert_bg.getChildByName("btnAgree");
        var btnDisagree = alert_bg.getChildByName("btnDisagree");
        btnAgree.active = false;
        btnDisagree.active = false;
        Socket.sendAnswerDissolve(this._userId, 1);
    },

    // 不同意他人退出
    clickDisagreeOtherPlayerExit: function clickDisagreeOtherPlayerExit() {
        //this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        //this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        //this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");
        var btnAgree = alert_bg.getChildByName("btnAgree");
        var btnDisagree = alert_bg.getChildByName("btnDisagree");
        btnAgree.active = false;
        btnDisagree.active = false;
        Socket.sendAnswerDissolve(this._userId, 0);
    },

    // 隐藏请求退出 Node
    _hideReqestExitNode: function _hideReqestExitNode() {
        if (!this.alertRequestExitNode.active) {
            return;
        }

        this.alertRequestExitNode.active = false;
        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },

    //// 打枪
    playShoot: function playShoot(fromUserId, toUserId) {
        var user = this._findPlayerInfoByUserId(fromUserId);
        if (user) {
            AudioManager.instance.playHumanDaQiang(user.sex);
        }

        var toUserIndex = this._findPlayerIndexByUserId(toUserId);

        this._playerComponents.forEach((function (player) {
            if (this._userId == fromUserId || this._userId == toUserId) player.showNextCompareScore();
            player.playShootAnimation(fromUserId, toUserIndex);
            player.playBulletHoleAnimation(toUserId);
        }).bind(this));
    },

    // 播放全垒打动效
    playHomeRun: function playHomeRun(userId) {
        var user = this._findPlayerInfoByUserId(userId);
        if (user) {
            AudioManager.instance.playHomeRun(user.sex);
        }
        this.node.getComponent("animation")._quanleidaAnimation('long');

        this._playerComponents.forEach((function (player) {

            player.showNextCompareScore();
        }).bind(this));
    },

    playSpeakAnimation: function playSpeakAnimation(userId) {
        this._playerComponents.forEach(function (player) {
            player.playSpeakAnimation(userId);
        });
    },

    _shootDatas: function _shootDatas() {
        var homeRunUserId = this._homeRunUserId(); // 全垒打
        var shootDatas = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId == homeRunUserId;
        });
        return shootDatas;
    },

    _shotData: function _shotData() {
        var homeRunUserId = this._homeRunUserId(); // 打枪
        var shotData = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId != homeRunUserId;
        });
        return shotData;
    },

    _homeRunUserId: function _homeRunUserId() {
        return this._deskInfo.allShotData;
    },

    // MARK: 房间信息部分

    // 获取房间的玩法
    _deskInfoGameWay: function _deskInfoGameWay() {
        var setting = this._deskInfo.setting3;
        if (setting == null) {
            setting = 2;
        }
        var names = ["庄家模式", "无特殊牌", "普通模式"];
        return names[setting];
    },

    _deskInfoNumberOfGame: function _deskInfoNumberOfGame() {
        var setting = this._deskInfo.setting1;
        var infos = ['10局', '20局', '40局', '5局'];
        /*if (setting <= 1) {
         return '条数：' + infos[setting];
         }*/
        if (setting == 2) {
            setting = 0;
        } else if (setting == 3) {
            setting = 1;
        } else if (setting == 4) {
            setting = 2;
        } else if (setting == 5) {
            setting = 3;
        }
        return '局数：' + infos[setting];
    },

    _deskInfoNumberOfPeople: function _deskInfoNumberOfPeople() {
        var setting = this._deskInfo.setting2;
        var infos = ['2人', '3人', '4人', '5人'];
        return infos[setting];
    },

    _deskInfoPayInfo: function _deskInfoPayInfo() {
        var setting = this._deskInfo.setting4;
        if (setting == null) {
            setting = 0;
        }
        if (setting == 0) {
            setting = 1;
        }
        var infos = ['房主霸主庄', '房费AA'];
        return infos[setting];
    },

    _deskInfoJiaYiSeInfo: function _deskInfoJiaYiSeInfo() {
        var setting = this._deskInfo.setting7 == 0 ? 1 : 0;
        var infos = ['无多一色', '多一色'];
        return infos[setting];
    },

    _deskInfoGuiPaiInfo: function _deskInfoGuiPaiInfo() {
        var setting = undefined;
        if (this._deskInfo.setting8 == null) {
            setting = 0;
        } else if (this._deskInfo.setting8 == 0) {
            setting = 1;
        } else if (this._deskInfo.setting8 == 1) {
            setting = 2;
        }
        var infos = ['无王牌', '两张王牌', '四张王牌'];
        return infos[setting];
    },

    // MARK: 剩余时间
    _remainTimeStartUpdate: function _remainTimeStartUpdate() {
        //this.schedule(this._remainTimeUpdate, 1.0, cc.macro.REPEAT_FOREVER);
    },

    _remainTimeUpdate: function _remainTimeUpdate() {
        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        if (this._deskInfo == null) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        var isTaoShu = this._deskInfo.setting1 == 0 || this._deskInfo.setting1 == 1;
        if (isTaoShu) {
            this.labelRemainTime.node.active = false;
            return;
        }

        if (!this._deskInfo.createTime) {
            return;
        }

        this.labelRemainTime.node.active = true;
        var createTime = fecha.parse(this._deskInfo.createTime, 'YYYY-MM-DD HH:mm:ss').getTime();
        var oneHour = 60 * 60;
        var remain = (Date.now() - createTime) / 1000;
        remain = Math.max(oneHour - remain, 0);

        var mins = Math.floor(remain / 60);
        var secs = Math.floor(remain % 60);
        if (mins == 0 && secs == 0) {
            this.labelRemainTime.string = "";
            return;
        }

        var minsString = "" + mins;
        if (minsString.length < 2) {
            minsString = "0" + minsString;
        }

        var secsString = "" + secs;
        if (secsString.length < 2) {
            secsString = "0" + secsString;
        }

        var string = "剩余时间：00:" + minsString + ":" + secsString;
        this.labelRemainTime.string = string;
    },

    // MARK: 处理同 IP 的用户
    _handleTheSameOfIPAdress: function _handleTheSameOfIPAdress(userInfos) {
        if (!userInfos || userInfos.length == 0) {
            return;
        }

        var ipUserInfos = userInfos.reduce(function (ips, userInfo) {
            var users = ips[userInfo.ipAddress] || [];
            users.push(userInfo);

            ips[userInfo.ipAddress] = users;
            return ips;
        }, {});

        var sameIpUsers = null;
        for (var ip in ipUserInfos) {
            var users = ipUserInfos[ip];
            if (users.length > 1) {
                sameIpUsers = users;
                break;
            }
        }

        if (sameIpUsers == null) {
            return;
        }

        this._alertSameIpUserInfos(sameIpUsers);
    },

    _alertSameIpUserInfos: function _alertSameIpUserInfos(users) {
        var message = "";
        var userIds = "";
        users.forEach(function (user, index) {
            message = message + (index > 0 ? ' 和 ' : '') + user.nickname;
            userIds = userIds + user.id;
        });
        message = message + ' 在同一 IP 下！';

        this._didAlertSameIpMessage = this._didAlertSameIpMessage || {};
        if (this._didAlertSameIpMessage[userIds]) {
            return;
        }

        this.showAlertMessage(message, true);
        this._didAlertSameIpMessage[userIds] = true;
    }

});
Play.gongXiNiShow = function (type) {
    this.instances._gongXiNiShow(type);
};
module.exports = Play;

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","AudioManager":"AudioManager","KQCard":"KQCard","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","Player":"Player","UserModelHelper":"UserModelHelper","fecha":"fecha","manager":"manager","socket":"socket"}],"product":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'a9ad2cC2BdEiaFSqV4XCWQV', 'product');
// scripts\product.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        productId: ''
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickAction: function clickAction() {
        this.onClickAction(this.productId);
    },

    onClickAction: function onClickAction(productId) {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"randRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4d298BlaelCHqiV5dTDjhuY', 'randRoom');
// scripts\randRoom.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');

cc.Class({
    'extends': cc.Component,

    properties: {
        matchingLabel: cc.Label,
        timeNode: cc.Node,
        matchingNode: cc.Node,
        waitingPrefab: cc.Prefab,
        alertPrefab: cc.Prefab,

        tishi: cc.Node,

        _userId: null,
        _response: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        cc.isRoomViewShow = true;
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        KQGlobalEvent.on(Socket.Event.ReceiveInterRandom, this._socketReceiveInterRandom, this);
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            return;
        }

        cc.director.loadScene('play');
    },

    _socketReceiveInterRandom: function _socketReceiveInterRandom(response) {
        //服务器发送  {'action':'interRandom','result':false,'data':{'reason':reason}}
        this._response = response;
        this.unschedule(this._timeoutRandomAction);
        // 处理随机场匹配不成功的情况
        if (response.result) {
            return;
        }

        var reason = response.data.reason || "加入随机场失败";
        this.showAlertMessage(reason);

        if (reason == '你已经在匹配队列') {
            this._showMatching();
        } else {
            this._hideMatching();
        }
    },

    _socketDisconnect: function _socketDisconnect() {
        // 连接已断开
        this.matchingNode.active = false;
        this.showNetworkMessage('网络链接断开，重新连接中...');
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    },

    clickStart: function clickStart() {
        Socket.sendEnterRandom(this._userId);
        this._showMatching();

        /*#####begin*/
        //reason是服务器发送回来的
        /*if(this._response.data.reason == "你的钻石不足"){
            this.tishi.active = true;
        }*/
        /*#####end*/

        this.scheduleOnce(this._timeoutRandomAction, 5);
    },
    /*#####点击空白地方，砖石不足提示消失*/
    /*onBtnKong:function () {
        if(this.tishi.active){
            this.tishi.active = false;
        }else{
            //什么也不做
        }
    },*/
    /*取消匹配*/
    clickCancel: function clickCancel() {
        Socket.sendCancelRandom(this._userId);

        this._hideMatching();
    },

    _timeoutRandomAction: function _timeoutRandomAction() {
        this._hideMatching();
        this.showAlertMessage('进入匹配失败');
    },

    _showMatching: function _showMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.alert();
        this.matchingLabel.string = '正在匹配中，请稍后...';
        var num = 0;
        this.schedule(function () {
            num = num + 0.5;
            this.timeNode.rotation = num;
        }, 0.01);
    },

    _hideMatching: function _hideMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.dismissAction();
    },

    showNetworkMessage: function showNetworkMessage(msg) {
        this.unschedule(this._timeoutRandomAction);

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg) {
        if (!msg) {
            cc.error("不能显示为空的信息");
            return;
        }

        if (!this.alertMessageNode) {
            this.alertMessageNode = cc.instantiate(this.alertPrefab);
            this.node.addChild(this.alertMessageNode);
        }

        this.alertMessageNode.getComponent('alert').setMessage(msg);
        this.alertMessageNode.getComponent('alert').alert();
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"recordInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1457gdvd5I5aENjKvCTkCd', 'recordInfo');
// scripts\recordInfo.js

var Socket = require('socket');
var Playback = require('Playback');
var record = require('record');

cc.Class({
    'extends': cc.Component,

    properties: {
        timeLabel: cc.Label, // 时间
        jushuLabel: cc.Label, // 局数
        createUser: cc.Node, // 房主
        roomId: cc.Label, // 房间号
        jifen: cc.Label, // 积分
        id: cc.Label,
        avatarNode: cc.Node, // 头像
        creatorImg: cc.Node, // 创房头像
        nicknameLabels: cc.Label,
        scoreLabels: [cc.Label],
        //numNode:cc.Label,
        _parentId: null,
        //playbackNode:cc.Node,//回放按钮
        //watchNode:cc.Node,//查看按钮
        reordInfo: cc.Node,
        _recordItemInfo: null,
        totalGameResult: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {
        this.totalGameResult = cc.find("Canvas/recordInfo");
    },

    setInfo: function setInfo(recordInfo) {
        this._parentId = recordInfo.id;
        //this.watchNode.active = true;
        //this.playbackNode.active = false;
        if (recordInfo.playersInfo.length == 0) {
            return;
        }

        var playersInfo = JSON.parse(recordInfo.playersInfo);
        recordInfo.scores = JSON.parse(recordInfo.scores);

        var fen = recordInfo.scores[this.fen(recordInfo.userid, playersInfo.playersIndex)];
        //cc.log(fen)
        //cc.log(recordInfo.scores)
        //cc.log(this.fen(recordInfo.userid,playersInfo.playersIndex))
        //cc.log(recordInfo.userid)
        //cc.log(playersInfo.playersIndex)
        //cc.log(recordInfo)
        //cc.log(playersInfo)
        //cc.log('----47')
        this.jifen.string = fen >= 0 ? "+" + fen : fen;

        var headUrl = playersInfo.players[this.creator(recordInfo.createUserId, playersInfo.playersIndex)].avatarUrl; // 头像URL
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        cc.loader.load({ url: headUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;
            }
        });

        this.roomId.string = "房号：" + playersInfo.roomId;
        this.timeLabel.string = "时间：" + playersInfo.time.substr(5, 11);
        this.jushuLabel.string = "局数：" + this.js(playersInfo.setting1 - 2);

        //for (var i = 0;i < playersInfo.players.length;i++) {
        //  this.nicknameLabels[i].string = playersInfo.players[i].nickname;
        //  this.scoreLabels[i].string = playersInfo.players[i].totalScore;
        //}
    },
    js: function js(setting2) {
        var jushu = 5;
        switch (setting2) {
            case 0:
                jushu = 5;break;
            case 1:
                jushu = 10;break;
            case 2:
                jushu = 20;break;
            case 3:
                jushu = 30;break;
        }
        return jushu;
    },

    fen: function fen(userid, players) {
        // 找积分
        for (var i = 0; i < players.length; i++) {
            if (players[i] == userid) {
                return i;
            }
        }
    },
    creator: function creator(_creator, players) {
        //创房者
        for (var i = 0; i < players.length; i++) {
            if (players[i] == _creator) {
                return i;
            }
        }
    },

    clickAction: function clickAction(event, data) {
        var playersInfo = JSON.parse(data.playersInfo);
        var totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');
        totalGameResultComp.setPlayerInfos(playersInfo.players, data);
        totalGameResultComp._clickBtn();
        this.totalGameResult.getComponent('alert').alert();

        //if (this._recordItemInfo) {
        //  this._startPlayback(this._recordItemInfo._info8Array);
        //  return;
        //}
        ////Socket.sendGetItemRecord(Socket.instance.userInfo.id,this._parentId);
        //Socket.sendGetItemRecord(Socket.instance.userInfo.id,--index);
    },

    _startPlayback: function _startPlayback(playBackInfo) {
        //Playback.instance.setPlaybackDatas(playBackInfo);
        //cc.director.loadScene('play');
    },

    detailAction: function detailAction(recordItemInfo, index) {
        //this._recordItemInfo = recordItemInfo;
        ////this.playbackNode.active = true
        ////console.log();
        ////this.numNode.string = "第" + (index + 1) + "局";
        //this.timeLabel.string = recordItemInfo.creatAt.substr(5,11);
        //let objArray = JSON.parse(recordItemInfo.info8);
        //this._recordItemInfo._info8Array = objArray;
        //let playersArray = objArray.map(function(str){
        //  return JSON.parse(str);
        //});
        //
        //var players = playersArray[playersArray.length-1].data.players;
        //for (var i = 0;i < players.length;i++) {
        //    this.nicknameLabels[i].string = players[i].nickname;
        //    this.scoreLabels[i].string = players[i].cScore;
        //}
    },
    records: function records() {}

});

cc._RFpop();
},{"Playback":"Playback","record":"record","socket":"socket"}],"record":[function(require,module,exports){
"use strict";
cc._RFpush(module, '452f4rFUqRLFYlGEJS5kEWs', 'record');
// scripts\record.js

var KQGlobalEvent = require('KQGlobalEvent');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        scrollView: cc.Node,
        recordItem: cc.Prefab
    },

    //subScrollView:cc.Node,
    //subRecordItem:cc.Node,
    //splash:cc.Prefab,
    //reordInfo:cc.Node,
    //
    //jifen:cc.Label,
    //head:cc.Node,
    //id:cc.Label,
    //nickname:cc.Label,
    //creat:cc.Label,        // 创房人
    //createUser:cc.Node,     //  头像
    //
    //timeLabel:cc.Label,   // 时间
    //jushuLabel:cc.Label,  // 局数
    ////createUser:cc.Node,   // 房主
    //roomId:cc.Label,      // 房间号
    //_records:null,
    // use this for initialization
    onLoad: function onLoad() {
        //this.isSubPage = false;
        //this.subScrollView.active = false;
        //
        //this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;
        //console.log( this.subScrollViewContent );
        //this.recordInfo = this.subScrollViewContent.children[0];
        //this.reords = this.subScrollViewContent.children[0].children[3];
        this.scrollViewContent = this.scrollView.getComponent(cc.ScrollView).content;
        this._registerSocketEvent();
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.GetRecord, this._ReceiveRecordInfo, this);
        //KQGlobalEvent.on(Socket.Event.GetItemRecord, this._ReceiveRecordItem, this);
    },

    _ReceiveRecordInfo: function _ReceiveRecordInfo(response) {
        //cc.log(response)
        //cc.log('------78')
        //console.log(response);
        //this._records = response.data;
        //this.isSubPage = false;
        //this.subScrollView.active = false;
        //this.scrollView.active = true;

        this.scrollViewContent.removeAllChildren();
        var index = 0;
        response.data.filter(function (record) {
            return record.playersInfo.length > 0;
        }).forEach((function (recordInfo) {
            index++;
            var item = cc.instantiate(this.recordItem);
            this.scrollViewContent.addChild(item);
            var comp = item.getComponent('recordInfo');
            comp.setInfo(recordInfo);
            var recordBtn = item.children[7].getComponent(cc.Button);
            recordBtn.clickEvents[0].customEventData = recordInfo;
            // var eventHandler = new cc.Component.EventHandler();
            // eventHandler.target = comp.node.children[7];
            // eventHandler.component = "btn";
            // eventHandler.handler = "clickAction";
            //eventHandler.customEventData = "my data";
            //console.log(comp.node.children[7]);
        }).bind(this));
    },

    closeAction: function closeAction() {
        if (this.isSubPage) {
            this.isSubPage = false;
            this.subScrollView.active = false;
            this.scrollView.active = true;
        } else {
            this.node.getComponent('alert').dismissAction();
        }
    }
});
/* clickAction:function( index ){
     //_ReceiveRecordItem()
 },
 _ReceiveRecordItem:function(RecordItemInfo) {
     cc.log(RecordItemInfo)
     cc.log('------78')
     //console.log(RecordItemInfo);return;
     var index = RecordItemInfo.data
     var playersInfo = JSON.parse(this._records[index].playersInfo);
     
     var players = playersInfo.players;                  // 玩家信息
     var playersIndex = playersInfo.playersIndex;        // 玩家的位置
     var createUserId = this._records[index].createUserId;   // 创房ID
     var sendUserId = this._records[index].userid;           // 发送人ID
      this.isSubPage = true;
     this.subScrollView.active = true;
     this.scrollView.active = false;
      this.timeLabel.string = (this._records[index].createAt).substr(5,11);               // 时间
     this.jushuLabel.string = this.js(JSON.parse(this._records[index].setting2));        // 局数
     this.roomId.string = this._records[index].roomId;                                   // 房间号
     this.creat.string = this.findCreator(this._records[index].createUserId,players);    // 房主
      this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;
     this.subScrollViewContent.removeAllChildren();
      for(var i = 0; i < players.length; i++ ){
         var item = cc.instantiate(this.splash);
         this.subScrollViewContent.addChild(item);
         var comp = item.getComponent('recordInfo');
         var creator = 0;       
         var self = 0;       // 表示自己，要对自己的比牌记录背景做处理
         if(createUserId == players[i].id){
             creator =1;
         }
         if( sendUserId == players[i].id){
             self = 1;
         }
         this.records(comp,i,creator,self,index);
     }
  },
 records:function(info,i,creator,self,index){
     if(self){
         info.node.color = new cc.Color(125, 126, 200);
     }
     cc.log(info)
     cc.log('----119')
     var players = JSON.parse(this._records[index].playersInfo).players;
     var scores = this._records[index].scores ;
     info.nicknameLabels.string = players[i].nickname;
     info.id.string = players[i].id;
     info.jifen.string = scores[i];
      var headUrl = players[i].avatarUrl;   //头像连接
     var sprite = info.avatarNode.getComponent(cc.Sprite);
     cc.loader.load(headUrl+".jpg", function (err, tex) {
       if (!err) {
           var frame = new cc.SpriteFrame(tex);
           sprite.spriteFrame=frame;
       }
     });
     info.creatorImg.active = creator;
 },
 findCreator:function(createId,players){ //找房主
     for(var i=0; i<players.length;i++){
         if(createId == players[i].id){
             return players[i].nickname;
         }
     }
 },
 js:function(num){
     var J = 5;
     switch(num){
         case 0: J = 5;break;
         case 1: J = 10;break;
         case 2: J = 20;break;
         case 3: J = 30;break;
     }
     return J;
 },*/

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"rule":[function(require,module,exports){
"use strict";
cc._RFpush(module, '92f6eNs7RdDRJIRLCZnyulJ', 'rule');
// scripts\rule.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    }
});

cc._RFpop();
},{}],"scale":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c1c33tgIe9JvLb/mE+2mRnK', 'scale');
// scripts\scale.js

cc.Class({
    "extends": cc.Component,

    properties: {
        content: cc.Node
    },

    onLoad: function onLoad() {
        var visibleSize = cc.director.getVisibleSize();
        var contentSize = {};
        contentSize.width = this.node.width;
        contentSize.height = this.node.height;
        var scaleX = visibleSize.width / contentSize.width;
        var scaleY = visibleSize.height / contentSize.height;
        var scale = Math.min(scaleX, scaleY).toFixed(2);
        this.node.scaleX = scale;
        this.node.scaleY = scale;
    }
});

cc._RFpop();
},{}],"selectMoShi":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0030eDrh7xEm6AeR3FCg5WU', 'selectMoShi');
// scripts\selectMoShi.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        selectedIndex: 0,
        _select: [],
        _selected: 0,
        beilv: cc.Node, // 倍率
        _blShow: 0 },

    // 倍率的显示状态
    onLoad: function onLoad() {
        this.beilv.active = this._blShow;
        this._select = [1, 1, 1, 0, 0];
        if (cc.set) {
            // 记录上一句的房间情况
            this._select = cc.set['setting3'];
        }
        var self = this;
        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select[i];
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (this._select[i]) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
            if (i == 3) {
                this.beilv.active = this._blShow = this._select[3];
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                var index = this.index;
                for (var i = 0; i < self.nodes.length; i++) {
                    var comp = self.nodes[i].getComponent('select');
                }
                this.setSelected(self._select[index] = !self._select[index]);
                if (this.index == 3) {
                    // 第三个是庄家模式，庄家模式显示倍率
                    self.beilv.active = this._blShow = self._select[3];
                }

                self._select[index] = self._select[index];
                self.selectedIndex = index;
                self.onSelectChange(index);

                var title = this.node.children[0];
                if (self._select[index]) {
                    // 如果当前选项为TRUE 则显示青色
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    // 反之 白色
                    title.color = new cc.Color(255, 255, 255);
                }
            };
        }
    },
    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
        //console.log(this._select);
    }

});

cc._RFpop();
},{}],"select_mapai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8e7e53kJcJK9rwMSxnloqI5', 'select_mapai');
// scripts\select_mapai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        pai: cc.Node,
        mapai: {
            "default": [],
            type: cc.SpriteFrame
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selectMa = this.node.getComponent("select_ma");
        this.selectMa.onLoad();
        this.com = this.pai.getComponent(cc.Sprite);
    },

    clickBtnComfirm: function clickBtnComfirm() {
        this.com.spriteFrame = this.mapai[cc.from.ma];
        //console.log(this.com.spriteFrame);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"select_ma":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4bc0b2bZGRGXoAfdO3Y6Squ', 'select_ma');
// scripts\select_ma.js

cc.Class({
    "extends": cc.Component,

    properties: {
        rightIcon: [cc.Node],
        mapaiRight: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.from == null) {
            cc.from = {};
        }
        //如果不带马，则马牌为空
        if (this.mapaiRight.active == false) {
            cc.from.isUseMa = false;
            cc.from.ma = null;
        } else {
            cc.from.isUseMa = true;
            //否则马牌默认为第0个，即黑桃5
            cc.from.ma = 0;
        }
        for (var i = 0; i < this.rightIcon.length; i++) {
            if (i == 0) {
                this.rightIcon[i].active = true;
                cc.from.ma = 0;
                this.select = this.rightIcon[i];
            } else {
                this.rightIcon[i].active = false;
            }
        }
    },
    onMaPaiClick: function onMaPaiClick(e) {
        var targetName = e.target.name;
        //cc.log(targetName)
        if (targetName != this.select.parent.name) {
            if (targetName == "select_kuang1") {
                this.select = this.rightIcon[2];
                cc.from.ma = 2;
            } else if (targetName == "select_kuang2") {
                this.select = this.rightIcon[1];
                cc.from.ma = 1;
            } else if (targetName == "select_kuang3") {
                this.select = this.rightIcon[0];
                cc.from.ma = 0;
            }
            for (var i = 0; i < this.rightIcon.length; i++) {
                this.rightIcon[i].active = false;
            }
            this.select.active = true;
        }
        //console.log(cc.from.ma);
    }

});

cc._RFpop();
},{}],"selectbeilv":[function(require,module,exports){
"use strict";
cc._RFpush(module, '253cf+Bll9FV5ngl0DW3PxZ', 'selectbeilv');
// scripts\selectbeilv.js

var KQGlobalEvent = require('KQGlobalEvent');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        _userid: 0
    },

    // use this for initialization
    onLoad: function onLoad() {},
    clickBeiLv: function clickBeiLv(event, num) {
        this.node.active = false;
        Socket.sendBeiLv(num, this._userid);
    }

});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"select":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e913aIwAtVEo5jMrf40D5rw', 'select');
// scripts\select.js

cc.Class({
    "extends": cc.Component,

    properties: {
        bgNode: cc.Node, //选择框
        selectedNode: cc.Node, //对号
        pai: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        //console.log(this.node);
        this.selected = true;
        //console.log(cc.set);
    },

    clickAction: function clickAction() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
    },

    setSelected: function setSelected(selected) {
        this.selected = selected;
        this.selectedNode.active = this.selected;
    },
    /*#####*/
    clickSelectKuang: function clickSelectKuang() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        cc.from.isUseMa = this.selected;
        var mapaiCom = this.pai.getComponent(cc.Button);
        if (this.selectedNode.active === false) {
            mapaiCom.interactable = false;
        } else {
            mapaiCom.interactable = true;
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"singleSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '194a8h4vXFO+bXX92yzqbfq', 'singleSelect');
// scripts\singleSelect.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        selectedIndex: 0
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        var rs = 0;
        var js = 0;
        var sf = 0;
        var bl = 0;
        if (cc.set) {
            js = cc.set.setting1;
            rs = cc.set.setting2;
            sf = cc.set.setting4;
            bl = cc.set.setting5;
        }
        for (var i = 0; i < this.nodes.length; i++) {
            var isSelected = this.selectedIndex == i;
            this.nodes[i].getComponent('select').setSelected(isSelected);
            var index = 0;
            var selectIndex = this.selectedIndex;
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (selectIndex == i) {
                this.nodes[selectIndex].getChildByName("title").color = new cc.Color(13, 210, 222);
            }
        }
        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;

            tComp.clickAction = function () {
                for (var i = 0; i < self.nodes.length; i++) {
                    var comp = self.nodes[i].getComponent('select');
                    comp.setSelected(false);
                }
                var Peers = this.node.parent.children; // 同辈节点
                var index = 0;
                for (var a = 0; a < Peers.length; a++) {
                    if (Peers[a].children.length > 0) {
                        // 如果同辈有子节点 处理子节点文字的颜色
                        var title = Peers[a].getChildByName("title");
                        title.color = new cc.Color(255, 255, 255);
                    }
                }
                this.node.getChildByName('title').color = new cc.Color(13, 210, 222);
                //this.node.children[index].color = new cc.Color(13,210,222);
                this.setSelected(true);
                self.selectedIndex = this.index;
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "renshu" && cc.set) {
            console.log(rs);
            this.remember_set(rs);
        }
        if (this.node._name == "jushu" && cc.set) {
            this.remember_set(js);
        }
        if (this.node._name == "cards" && cc.set) {
            this.remember_set(sf);
        }
        if (this.node._name == "beiLv" && cc.set) {
            this.remember_set(bl);
        }
    },
    remember_set: function remember_set(num) {
        this.selectedIndex = num;
        for (var i = 0; i < this.nodes.length; i++) {
            var isSelected = num == i;
            this.nodes[i].getComponent('select').setSelected(isSelected);
            var index = 0;
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (num == i) {
                // if( this.nodes[num].children[0].name == "title" ){
                //     index = 0;
                // }else if(this.nodes[num].children[1].name == "title"){
                //     index =1;
                // }
                this.nodes[num].getChildByName('title').color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {}

});

cc._RFpop();
},{}],"slider":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1c921w7bEFKUIdNwItOX3oG', 'slider');
// scripts\slider.js

cc.Class({
    "extends": cc.Component,

    properties: {
        indicatorNode: cc.Node,
        backgroundNode: cc.Node,
        selectedNode: cc.Node,

        value: 0
    },

    // use this for initialization
    onLoad: function onLoad() {
        var self = this;
        this.indicatorNode.on(cc.Node.EventType.TOUCH_START, function (event) {});
        this.indicatorNode.on(cc.Node.EventType.TOUCH_MOVE, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });

        //this.maxWidth = this.node.width - 40;
        this.maxWidth = this.node.width - 28;
        this.setValue(this.value);
    },

    updateSlider: function updateSlider(pt) {
        var x = pt.x;
        if (x < 0) {
            x = 0;
        }

        if (x > this.maxWidth) {
            x = this.maxWidth;
        }
        this.setValue(x / this.maxWidth);
        this.onValueChange(this.value);
    },

    /*0 - 1*/
    setValue: function setValue(value) {
        this.value = value;
        if (this.value < 0) {
            this.value = 0;
        }
        if (this.value > 1) {
            this.value = 1;
        }
        //this.maxWidth = this.node.width - 38;
        this.maxWidth = this.node.width - 28;
        this.indicatorNode.x = this.value * this.maxWidth + 10;
        this.selectedNode.width = this.value * this.maxWidth + this.indicatorNode.width / 2;
    },

    onValueChange: function onValueChange(value) {
        cc.log(value);
    }
});

cc._RFpop();
},{}],"socket":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf75cLLNo1ETbJFrx/23i/H', 'socket');
// scripts\socket.js

var manager = require('manager');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var SocketConstant = {
  MaxReconnectCheckInterval: 5 };

/**
 * 这是对 WebSocket 的一个封装
 * 
 * 里面包含自动重连的功能
 */
// 重连检测时间片
var Socket = cc.Class({
  'extends': cc.Component,

  properties: {
    _lastReceiveMsgTime: 0, // 最后一次收到消息时间(毫秒)
    _timeout: 8 },

  // 超时时长 （秒）
  statics: {
    instance: null,
    // url:"ws://182.18.26.13:5041",
    //url:"ws://123.56.20.164:5041",//修改前
    url: "ws://127.0.0.1:5041"
  },

  // url:"ws://192.168.0.108:5041",
  //url:"ws://183.3.205.149:5002",
  // use this for initialization
  onLoad: function onLoad() {
    Socket.instance = this;

    this.name = "socket";

    cc.game.addPersistRootNode(this.node);
    if (cc.game.isPersistRootNode(this.node)) {
      cc.log('添加全局节点 Socket 成功');
    }

    this._registerAppActiveChange();

    this.isCreating = false;
    this.createIndex = 0;
    this.createSocket();

    this.schedule(function () {
      this.checkConnection();
    }, 5);

    this.recvTime = Date.now(); //接收到最新一条服务器的信息的时间
    //cc.log(manager.version);

    this._checkSocket();
  },

  checkConnection: function checkConnection() {
    //客户端定时给服务端发送点数据，防止连接由于长时间没有通讯而被某些节点的防火墙关闭导致连接断开的情况。
    this.sendMessage('checkAction', '');
  },

  createSocket: function createSocket() {
    var self = this;
    this.createIndex++; //创建次数加1
    if (this.createIndex > 5) {
      this.networkError();
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.isCreating = true;

    KQGlobalEvent.emit(Socket.Event.SocketConnecting);
    this.ws = new WebSocket(Socket.url);
    if (this.ws === null) {
      this.networkError();
      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { 'data': 'Socket 创建失败' });
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.socketError = false;

    // socket 连接成功
    this.ws.onopen = function (event) {
      //cc.log("WebSocket 连接成功：", event);

      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketConnectSuccessed, event);

      self.isCreating = false;
      self.socketError = false;
      self.createIndex = 0;
      self.connectionSuccess();
      self.sendReconnectInfo();
    };

    // socket 接收到消息
    this.ws.onmessage = function (event) {
      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketReceiveMessage, event.data);

      self.isCreating = false;
      self.socketError = false;
      self.receviceMessage(event.data);
      self._dispatchResponse(event.data);
      self.recvTime = Date.now(); //接收最新一条信息的时间

      /**/
    };

    /**
     * socket 发生错误
     * 
     * socket 本身有 `onerror` 回调，但事实证明，其不靠谱，
     * 有很大的机率有误报的行为，常常在没有错误时，会给错误回调。
     * 且不能定制超时时长
     * 
     * @param {String} message 
     */
    this.ws._kq_onerror = function (message) {
      cc.error('WebSocket 连接错误：' + message);

      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { data: message });
      self.ws.close();
      if (!self.ws) {
        return;
      }

      // 虽然调用了 websocket 的 close 方法，但是
      // 它并会立即调用 onclose 回调，而是在未来的某
      // 一时间再回调 onclose；但这里明显可以直接回调了。
      var ws = self.ws;

      self.ws.onclose();
      ws.onclose = function () {};
    };

    // socke 已关闭
    this.ws.onclose = function (event) {
      //cc.log('WebSocket 已关闭 close time=' + Date.now() + " event: " + event);

      self.isCreating = false;
      self.socketError = true;
      self.ws = null;
      self.connectionDisconnect();
      KQGlobalEvent.emit(Socket.Event.SocketDisconnect, event);
      //cc.log('socket close'+JSON.stringify(event));
    };
  },

  reconnect: function reconnect() {
    var self = this;
    this.scheduleOnce(function () {
      if (!self.isCreating && self.socketError) {
        self.createSocket();
      }
    }, 2);
  },

  sendReconnectInfo: function sendReconnectInfo() {
    var self = this;
    this.scheduleOnce(function () {
      if (this.userInfo != null) {
        var userId = self.userInfo.user_id || self.userInfo.id;
        self.sendMessage('reconnect', {
          'userId': userId
        });
      }
    }, 1);
  },

  receviceMessage: function receviceMessage(response) {},

  connectionDisconnect: function connectionDisconnect() {},

  connectionSuccess: function connectionSuccess() {},

  networkError: function networkError() {},

  checkNetworkStart: function checkNetworkStart() {},

  checkNetworkEnd: function checkNetworkEnd() {},

  _dispatchResponse: function _dispatchResponse(responseString) {
    //cc.log("WebSocket 接收到服务器消息：", responseString);
    var response = JSON.parse(responseString);
    var action = response["action"];
    if (action) {
      KQGlobalEvent.emit(action, response);
    }
  },

  // MARK: 前后台操作
  _registerAppActiveChange: function _registerAppActiveChange() {
    //cc.log("WebSocket 注册应用进入前、后台事件");
    cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
    cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
  },

  /**
   * 进入后台
   */
  _appEnterBackground: function _appEnterBackground() {
    var now = cc.sys.now();
    if (now - this._lastAppEnterBackgroundTime < 100) {
      return;
    }
    this._lastAppEnterBackgroundTime = now;

    //cc.log("WebSocket 检测到应用进入后台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppPause(id);
    this._cancelCheckSocket();
  },

  /**
   * 进入前台 
   */
  _appBecomActive: function _appBecomActive() {
    var now = cc.sys.now();
    if (now - this._lastAppBecomActiveTime < 100) {
      return;
    }
    this._lastAppBecomActiveTime = now;

    //cc.log("WebSocket 检测到应用进入前台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppActive(id);
    this._checkSocket();

    this.scheduleOnce((function () {
      this._checkSocketExecute();
    }).bind(this), 1.5);
  },

  //进入后台操作
  enterbackgroudAction: function enterbackgroudAction() {
    this._appEnterBackground();
  },

  //进入前台操作
  resumeAction: function resumeAction() {
    //检查网络
    this._checkNetwork();
    this._appBecomActive();
  },

  sendMessage: function sendMessage(action, data) {
    data = this._strongVerifyData(data);

    if (this.socketError) {
      cc.error("socket 连接错误：" + this.socketError);
      this.reconnect();
      return;
    }
    //cc.log('WebSocket 发送消息：' + action, data);
    if (cc.sys.isObjectValid(this.ws)) {
      if (this.ws.readyState === WebSocket.OPEN) {
        this.ws.send(this._convertParameterToString(action, data));
      }
    } else {
      this.connectionDisconnect();
    }
  },

  _strongVerifyData: function _strongVerifyData() {
    var data = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

    if (typeof data == 'string') {
      data = { "string": data };
    }

    if (data == null) {
      data = {};
    }

    if (!data["userId"]) {
      if (this.userInfo && typeof this.userInfo == 'object' && this.userInfo.id) {
        data["userId"] = this.userInfo.id;
      }
    }
    return data;
  },

  _convertParameterToString: function _convertParameterToString(action) {
    var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var obj = {};
    obj.action = action;
    obj.data = data;

    return JSON.stringify(obj);
  },

  // 检查网络
  _checkNetwork: function _checkNetwork() {
    if (this.checkNetworkNow) {
      this.checkNetworkNow();
    }

    this.shouldCheck = true;
    if (!this.socketError) {
      this.recvTime = 0;
      this.sendMessage('checkAction', '');
      this.scheduleOnce(function () {
        this.checkNetworkEnd();
        this.shouldCheck = false;
        if (this.recvTime === 0) {
          this.connectionDisconnect();
        }
      }, 2.5);
    } else {
      this.connectionDisconnect();
    }
  },

  // MARK: socket 掉线尽早确认
  _checkSocket: function _checkSocket() {
    this.schedule(this._checkSocketExecute, SocketConstant.MaxReconnectCheckInterval, cc.macro.REPEAT_FOREVER);
  },

  _cancelCheckSocket: function _cancelCheckSocket() {
    this.unschedule(this._checkSocketExecute);
  },

  _checkSocketExecute: function _checkSocketExecute() {
    if (this._isSocketTimeout() && this.ws) {
      this.ws._kq_onerror('连接超时');
      return;
    }
  },

  // socket 是否已超时
  _isSocketTimeout: function _isSocketTimeout() {
    return this._lastReceiveMessageInterval() >= this._timeout;
  },

  // 上一次收到消息到现在的时间间隔
  _lastReceiveMessageInterval: function _lastReceiveMessageInterval() {
    var now = cc.sys.now();
    var interval = (now - this._lastReceiveMsgTime) / 1000;
    //cc.log(`WebSocket 现在距上一条收到消息的时间间隔是：${interval} 秒`);
    return interval;
  }

});

// MARK: Socket 事件定义
Socket.Event = {
  SocketConnecting: "SocketConnecting", // Socket 正在连接
  SocketConnectSuccessed: "SocketConnectSuccessed", // 连接成功
  SocketDisconnect: "SocketDisconnect", // Socket 断开连接
  SocketConnectError: "SocketConnectError", // Socket 连接错误
  SocketReceiveMessage: "SocketReceiveMessage", // Socket 接收到消息

  LoginJoin: "loginJoin", // 客户端发送 从登陆界面获取房间号进入游戏
  RecordId: "recordId", // 客户端发送 
  OnceAgain: "onceAgain", // 客户端发送 
  BeiLv: "beiLv", // 客户端发送 
  InviteCode: "inviteCode", // 客户端发送   邀请码
  JoinDesk: "joinDesk", // 客户端发送
  CreateDesk: "createDesk", // 客户端发送
  GetDaiKaiDesk: "getDaiKaiDesk", //代开房数据获取
  LeaveDesk: "leaveDesk", // 离开桌子
  DissolveDesk: "dissolveDesk", // 解散桌子
  AnswerDissolve: "answerDissolve", // 回答请求退出命令
  GetDeskInfo: "getDeskInfo", // 客户端发送
  SendImage: "sendImage", // 客户端发送
  SendText: "sendText", // 客户端发送
  SendEmoji: "sendEmoji", // 客户端发送
  ChangeInfo: "changeInfo", // 客户端发送
  SendAudioMessage: "sendAudioMessage", // 客户端发送  发送语音消息
  GetRecord: "getRecord", // 获取战绩信息
  GetItemRecord: "getItemRecord", // 获取战绩信息
  PlayCard: "playCard", // 客户端发送，用户打出牌
  TimeoutDissolve: "timeoutDissolve", // 请求退出超时时，需要发出的消息
  Feedback: "feedback", // 客户端发送  反馈信息
  SharePng: "sharePng", // 客户端发送  分享领取砖石
  EnterRandom: "interRandom", // 客户端发送  进入随机场
  CancelRandom: "cancelRandom", // 客户端发送  取消进入随机场
  ForceExitRandom: "dissolve", // 客户端发送 强制退出随机场
  Ready: "ready", // 客户端发送 准备
  StartGame: "startGame", // 客户端发送 开始游戏
  GetHallInfo: "getHallInfo", // 客户端发送 获取大厅信息
  GetUserInfo: "getUserInfo", // 客户端发送 获取用户信息
  CheckAction: "checkAction", // 客户端发送，用来检测与服务器的连通性
  Pause: "pause", // 客户端进入后台时要发送的消息
  Active: "active", // 客户端回到前台时要发送的消息
  Qingli: "qingli", // 客户端回到前台时要发送的消息

  ReceiveRequestDissolve: "requestDissolve", // 请求解散桌子 服务器发送
  ReceiveRequestDissolveResult: "requestDissolveResult", // 请求解散桌子结果
  ReceiveChatText: "sendText", // 服务器发送
  ReceiveChatEmoji: "sendEmoji", // 服务器发送
  ReceiveDeskInfo: "deskInfo", // 服务器发送
  ReceiveGameOver: "gameOver", // 服务器发送
  ReceiveFaPai: "fapai", // 服务器发送
  ReceiveSharePng: "sharePngs", // 服务器发送
  ReceiveOnlineStatus: "sendOnlineStatus", // 服务器发送
  ReceiveOnChangeInfo: "changeInfo", // 服务器发送
  ReceiveAudioMessage: "sendAudioMessage", // 服务器发送，接收到用户发送了语音消息
  ReceivePlayCard: "playCard", // 服务器发送，有用户已经准备好牌
  ReceiveCreateDesk: "createDesk", // 服务器发送，创建房间的回调
  ReceiveGetDaiKaiDesk: "getDaiKaiDesk", // 服务器发送，代开房间 已开房间数据
  ReceiveDaiKaiDesk: "daikaiDesk", // 服务器发送，代开房间的回调
  ReceiveReady: "ready", // 服务器发送，有用户点击了准备
  ReceiveHallInfo: "getHallInfo", // 服务器发送
  ReceiveGetUserInfo: "getUserInfo", // 服务器发送 获取用户信息
  ReceiveCheckAction: "checkAction", // 服务器发送  用来确认 Socket 还在连着
  ReceiveForceExit: "forceExit", // 服务器发送  用来使客户端强退
  ReceiveDissolveDesk: "dissolveDesk", // 服务器发送   当房主退出时，解散桌子
  ReceiveInterRandom: "interRandom", // 服务器发送   进入随机场的反馈
  ReceivePause: "pause", // 服务器发送   当有用户设备进入后台时，会收到这条消息
  ReceiveInviteCode: 'inviteCode', // 服务器发送，收到邀请码的消息
  ReceiveLeaveDesk: 'leaveDesk', // 服务器发送，收到需要离开桌子的消息
  ReceiveSelectBeiLv: 'selectBeiLv', // 服务器发送，收到选择倍率的消息
  ReceiveBeiLv: 'beiLv', // 服务器发送，收到倍率的消息
  ReceiveQingLi: 'qingli', // 服务器发送，收到请离
  ReceiveRecordId: 'recordId', // 服务器发送，收到战绩信息
  ReceiveLoginJoin: 'loginJoin', // 服务器发送，收到从页面进入房间信息
  ReceiveOnceAgain: 'onceAgain', // 服务器发送，收到再来一局信息
  ReceiveNoUionid: 'noUionid' };

// MARK: Socket 提供的可发给服务器消息的方法

// 服务器发送，收到没有unionID信号
Socket.sendCheckAction = function () {
  this.instance.sendMessage(this.Event.CheckAction, null);
};
/**/
Socket.sendDidReceiveGameOverAction = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(Socket.Event.DidReceiveGameOverAction, param);
};
/**/

/**
 * 当 APP 进入后台时要发送的消息
 */
Socket.sendAppPause = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Pause, param);
};

/**
 * 当 APP 进入前台时发送的消息
 */
Socket.sendAppActive = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Active, param);
};

// 开房
Socket.sendCreateDesk = function (createDescInfo, userId) {
  cc.assert(createDescInfo);
  cc.assert(userId);

  createDescInfo["userId"] = userId;
  this.instance.sendMessage(this.Event.CreateDesk, createDescInfo);
};

Socket.sendQingli = function (leaveId, userId) {
  var param = {
    "leaveId": leaveId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.Qingli, param);
};
// 从登陆页面加入房间
Socket.sendLoginJoin = function (roomId, userId) {
  var param = {
    "roomId": roomId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.LoginJoin, param);
};
// 再来一局
Socket.sendOnceAgain = function (again, userId) {
  var param = {
    "userId": userId,
    "again": again
  };
  this.instance.sendMessage(this.Event.OnceAgain, param);
};
// 加入房间
Socket.sendJoinDesk = function (roomId, userId) {
  cc.assert(roomId);
  cc.assert(userId);

  var param = {
    "roomId": roomId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.JoinDesk, param);
};
// 向服务端发送我选择的倍率
Socket.sendBeiLv = function (beilv, userId) {
  var param = {
    "beilv": beilv,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.BeiLv, param);
};
// 发送邀请码
Socket.sendInviteCode = function (inviteCode, userId) {
  var param = {
    "inviteCode": inviteCode,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.InviteCode, param);
};

// 获取房间信息
Socket.sendGetDesckInfo = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetDeskInfo, param);
};

Socket.sendText = function (userId, text) {
  //cc.assert(userId);
  //cc.assert(text);
  var param = {
    "msg": text,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendText, param);
};
Socket.sendEmoji = function (userId, emoji) {
  var param = {
    "emoji": emoji,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendEmoji, param);
};
Socket.sendChangeInfo = function (userId, Info) {
  var param = {
    "changeInfo": Info,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.ChangeInfo, param);
};
Socket.sendAudioMessage = function (userId) {
  var url = arguments.length <= 1 || arguments[1] === undefined ? "" : arguments[1];

  cc.assert(userId);
  cc.assert(url.length > 0);

  if (url.length == 0) {
    return;
  }

  var param = {
    "url": url,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendAudioMessage, param);
};

Socket.sendImage = function (userId, image) {
  cc.assert(userId);
  cc.assert(image);
  var param = {
    "msg": image,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendImage, param);
};

Socket.sendGetRecrod = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.GetRecord, param);
};

Socket.sendGetRecrodFromId = function (recordId) {
  var param = {
    "recordId": recordId
  };
  this.instance.sendMessage(this.Event.RecordId, param);
};

Socket.sendDissolveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.DissolveDesk, param);
};

Socket.sendGetItemRecord = function (userId, parentId) {
  cc.assert(userId);
  cc.assert(parentId);
  var param = {
    "userId": userId,
    "parentId": parentId
  };

  this.instance.sendMessage(this.Event.GetItemRecord, param);
};

//获取代开房记录
Socket.sendGetDaiKaiFang = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetDaiKaiDesk, param);
};

Socket.sendLeaveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.LeaveDesk, param);
},

/**
 * 回答退房请求
 * 
 * @param  {Number} userId 当前用户 id
 * @param  {NUmber} answer=1 回答。1 表示同意； 0 表示拒绝； -1 表示未选择
 */
Socket.sendAnswerDissolve = function (userId) {
  var answer = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];

  cc.assert(userId);
  var param = {
    "userId": userId,
    "answer": answer
  };

  this.instance.sendMessage(this.Event.AnswerDissolve, param);
}, Socket.sendForceExitRoom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.DissolveDesk, param);
},

// 十三张中
// cardInfo 类似于：
// [{
//         'cards':[{'suit':suit,'number':number},{}],//特殊牌不用传
//         'type':0,
//         'value':4,
//         'isContainExtra':true,// 特殊牌是否包含特殊牌
//     },
//     {
//         'cards':[{'suit':suit,'number':number},{}],
//         'type':0,
//         'value':4
//     }]
Socket.sendPlayCard = function (userId, cardInfo) {
  cc.assert(userId);
  var param = {
    "userId": userId,
    "card": cardInfo
  };

  this.instance.sendMessage(this.Event.PlayCard, param);
};

Socket.sendTimeoutDissolve = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.TimeoutDissolve, param);
};

Socket.sendFeedback = function (userId, text) {
  cc.assert(userId);
  cc.assert(text);
  var param = {
    "userId": userId,
    "text": text
  };

  this.instance.sendMessage(this.Event.Feedback, param);
};

Socket.sendSharePng = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SharePng, param);
};
// 开始匹配随机场
Socket.sendEnterRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.EnterRandom, param);
};

// 取消匹配随机场
Socket.sendCancelRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.CancelRandom, param);
};

// 准备
Socket.sendReady = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.Ready, param);
}, Socket.sendStartGame = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  cc.log(this.Event.StartGame);
  cc.log();
  this.instance.sendMessage(this.Event.StartGame, param);
},

// 获取大厅信息
Socket.sendGetHallInfo = function (userId) {
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetHallInfo, param);
},

// 获取用户信息
Socket.sendGetUserInfo = function (userId, openId) {
  var param = {
    "userId": userId,
    "openId": openId
  };

  this.instance.sendMessage(this.Event.GetUserInfo, param);
}, module.exports = Socket;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"test":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3a5ah1deZEh6HfPdghRXyA', 'test');
// scripts\KQCard\test.js

this._changeCardScors = function (cardModel) {

    cardModel.forEach(function (card) {
        card.scores = card.number;
    });

    cardModel = this._convertOneToA(cardModel);

    var is14 = true; //是A K Q J 10 ;

    var is1 = true; //是1 2 3 4 5

    cardModel.forEach(function (card) {
        if (card.scores < 10) is14 = false;
    }); //不是A K Q J 10

    cardModel.forEach(function (card) {
        if ((card.scores > 5 || card.scores == 14) && card.scores != 20) is1 = false;
    }); //不是1 2 3 4 5});

    if (is14) {
        //是A K Q J 10 ;

        cardModel.sort(function (a1, a2) {
            return a2.scores - a1.scores;
        });

        var num = 14,
            scoresAyy = []; //一副牌的分数

        for (var i = 0; i < 5; i++) {

            scoresAyy.push(num);

            num -= 1;
        }

        for (var j = 0; j < scoresAyy.length; j++) {

            for (var i = 0; i < cardModel.length; i++) {

                var cardScores = cardModel[i].scores;

                if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
            }
        }

        cardModel.forEach(function (card) {
            if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
        }); //找出选中的牌
    } else if (is1) {
            //是1 2 3 4 5

            cardModel.sort(function (a1, a2) {
                return a2.scores - a1.scores;
            });

            var num = 5,
                scoresAyy = []; //一副牌的分数

            for (var i = 0; i < 5; i++) {

                scoresAyy.push(num);

                num -= 1;
            }

            for (var j = 0; j < scoresAyy.length; j++) {

                for (var i = 0; i < cardModel.length; i++) {

                    var cardScores = cardModel[i].scores;

                    if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
                }
            }

            cardModel.forEach(function (card) {
                if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
            }); //找出选中的牌
        } else {
                cardModel.sort(function (a1, a2) {
                    return a1.scores - a2.scores;
                });

                var scoresAyy = []; //用来装鬼牌分数

                for (var i = 0; i < 5; i++) {

                    var s = parseInt(cardModel[0].scores) + i; //最小的牌的分数

                    scoresAyy.push(s); //一副牌的分数
                }

                for (var j = 0; j < scoresAyy.length; j++) {

                    for (var i = 0; i < cardModel.length; i++) {

                        var cardScores = cardModel[i].scores;

                        if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
                    }
                }
                cardModel.forEach(function (card) {
                    if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
                }); //改变牌的分数
            }

    cardModel = this._convertOneToA(cardModel);

    cardModel.sort(function (a1, a2) {
        return a1.scores - a2.scores;
    });
    return cardModel;
};

cc._RFpop();
},{}],"time":[function(require,module,exports){
"use strict";
cc._RFpush(module, '458d4VWlwNDT6xQ+pFW8Bby', 'time');
// scripts\time.js

cc.Class({
        "extends": cc.Component,

        properties: {
                leftNode: cc.Node,
                RigthNode: cc.Node,
                _time: null
        },

        // use this for initialization
        onLoad: function onLoad() {},

        setTime: function setTime(time) {

                this.unscheduleAllCallbacks();

                this._time = time;

                this.leftNode.rotation = 0;

                this.RigthNode.rotation = 0;

                this.RigthNode.stopAllActions();

                this.leftNode.stopAllActions();

                this.leftNode.runAction(cc.rotateBy(this._time, -180));

                this.scheduleOnce((function () {

                        this.RigthNode.runAction(cc.rotateBy(this._time, 180));
                }).bind(this), this._time);
        }

});

cc._RFpop();
},{}],"userInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e8d10xRGnJAn42wJsuC6aBi', 'userInfo');
// scripts\userInfo.js

var AudioManager = require('AudioManager');
var Playback = require('Playback');

cc.Class({
  'extends': cc.Component,

  properties: {
    spriteAvatar: cc.Sprite,
    labelNickname: cc.Label,
    labelScore: cc.Label,
    spriteOffline: cc.Sprite,
    voiceNode: cc.Node,
    homeRunNode: cc.Node,
    readyNode: cc.Node,
    beilv: cc.Label,
    shootNodes: [cc.Node],
    bankerNode: cc.Node,
    fangZhuNode: cc.Node,
    qingli: cc.Node,
    id: cc.Label
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.updateScore();
  },

  setqingli: function setqingli() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.qingli.active = visible != false;
  },

  setReadyNodeVisible: function setReadyNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.readyNode.active = visible != false;
  },
  setBeilvLabel: function setBeilvLabel(bl) {
    //this.beilv.active = true;
    this.beilv.string = bl ? bl + "倍" : '';
  },

  setFangZhuNodeVisible: function setFangZhuNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.fangZhuNode.active = visible != false;
  },

  updateScore: function updateScore() {
    var score = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    if (score >= 0) {
      this.labelScore.string = "+" + score;
    } else {
      this.labelScore.string = "" + score;
    }
  },
  updateUserId: function updateUserId(id) {
    this.id.string = id ? "ID:" + id : "";
  },
  updateNickname: function updateNickname() {
    var nickname = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

    this.labelNickname.string = nickname;
  },

  updateAvatar: function updateAvatar(avatar) {
    if (avatar.endsWith("png") || avatar.endsWith("jpg") || avatar.endsWith("gif")) {} else {
      //avatar = avatar + ".png";
    }

    cc.loader.load({ url: avatar, type: "jpg" }, (function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      this.spriteAvatar.spriteFrame = frame;
    }).bind(this));
  },

  setOfflineVisible: function setOfflineVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    if (Playback.instance.isPlaybacking()) {
      // 如果是处理回放状态，就不用再处理离线消息了
      return;
    }

    this.spriteOffline.node.active = visible;
  },

  setIsBanker: function setIsBanker() {
    var isBanker = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.bankerNode.active = isBanker;
  },

  playShootAnimation: function playShootAnimation() {
    var toIndex = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    //let shootNode = this.shootNodes[toIndex];
    //shootNode.active = true;
    //let anim = shootNode.getComponent(cc.Animation);
    //anim.play('shoot').on('finished', function () {
    //  shootNode.active = false;
    //}, this);

    AudioManager.instance.playDaQiang();
  },

  playBulletHoleAnimation: function playBulletHoleAnimation() {
    var bulletHoleNode = this.node.getChildByName('bulletHole');
    bulletHoleNode.active = true;
    var anim = bulletHoleNode.getComponent(cc.Animation);
    anim.play('bulletHole').on('finished', function () {
      bulletHoleNode.active = false;
    }, this);
  },

  playSpeakAnimation: function playSpeakAnimation() {
    this.voiceNode.active = true;
    this.scheduleOnce((function () {
      this.voiceNode.active = false;
    }).bind(this), 4);
  },

  // 播放全垒打动画
  playHomeRunAimation: function playHomeRunAimation() {
    //let alert = this.homeRunNode.getComponent('alert');
    //alert.alert();
    //this.scheduleOnce(function () {
    //  this.homeRunNode.active = false;
    //}.bind(this), 2);
  }
});

cc._RFpop();
},{"AudioManager":"AudioManager","Playback":"Playback"}],"zhongtujinru":[function(require,module,exports){
"use strict";
cc._RFpush(module, '07d38TzM6FODLMnQrtRGl01', 'zhongtujinru');
// scripts\zhongtujinru.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        //selectedIndex: 0,
        _selected: 1
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        this._select = true;
        var zhongtujinru = 0;
        if (cc.set) {
            zhongtujinru = cc.set.setting10;
            this._selected = this._select = zhongtujinru;
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select;
            this._selected = this._select;
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (self._select) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                this.setSelected(self._selected = self._select = !self._select);
                var title = this.node.getChildByName("title");
                if (self._select) {
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    title.color = new cc.Color(255, 255, 255);
                }
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "orders" && cc.set) {
            //this.remember_set(overTime);
        }
    },
    remember_set: function remember_set(obj) {
        for (var i = 0; i < this.nodes.length; i++) {
            this.nodes[i].getComponent('select').setSelected(obj);
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (obj) {
                var title = this.nodes[0].getChildByName('title');
                title.color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
    }

});

cc._RFpop();
},{}],"zhuanNumCtrl":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1b0dfWuicJLYJDmjjT1lmQc', 'zhuanNumCtrl');
// scripts\zhuanNumCtrl.js

cc.Class({
    "extends": cc.Component,

    properties: {
        zhuanNumLabel: cc.Label,
        jushu: cc.Node,
        AA: cc.Node,
        _selectedPeopleIndex: null,
        _selectedJushuIndex: null,
        _selectedAAIndex: null
    },

    onLoad: function onLoad() {
        this._ctrl();
    },

    clickPeopleAction: function clickPeopleAction() {
        this._ctrl();
    },

    clickAAAction: function clickAAAction() {
        this._ctrl();
    },

    clickJushuAction: function clickJushuAction() {
        this._ctrl();
    },

    _ctrl: function _ctrl() {
        this._selectedPeopleIndex = this.node.getComponent("singleSelect").selectedIndex;
        this._selectedJushuIndex = this.jushu.getComponent("singleSelect").selectedIndex;
        this._selectedAAIndex = this.AA.getComponent("checkSelect").selectedIndex;
        //人数选2人时且没选上AA制收费
        var renShu = 2;
        if (this._selectedPeopleIndex == 0) {
            renShu = 2;
        } else if (this._selectedPeopleIndex == 1) {
            renShu = 3;
        } else if (this._selectedPeopleIndex == 2) {
            renShu = 4;
        } else if (this._selectedPeopleIndex == 3) {
            renShu = 5;
        }
        var zhuangShi = 20;
        if (this._selectedJushuIndex == 0) {
            zhuangShi = 20;
        } else if (this._selectedJushuIndex == 1) {
            zhuangShi = 40;
        } else if (this._selectedJushuIndex == 2) {
            zhuangShi = 80;
        } else if (this._selectedJushuIndex == 3) {
            zhuangShi = 10;
        }
        //AA
        if (this._selectedAAIndex != null) {
            zhuangShi = Math.ceil(zhuangShi / renShu);
        }
        this.zhuanNumLabel.string = zhuangShi;
        //if(this._selectedPeopleIndex == 0){
        //    if(this._selectedAAIndex == null){
        //局数选10局时
        //if(this._selectedJushuIndex == 0){
        //    this.zhuanNumLabel.string = "10";
        //}
        ////局数选20局时
        //if(this._selectedJushuIndex == 1){
        //    this.zhuanNumLabel.string = "30";
        //}
        ////局数选30局时
        //if(this._selectedJushuIndex == 2){
        //    this.zhuanNumLabel.string = "80";
        //}
        //}
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "8";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "15";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "23";
        //        }
        //    }
        //
        //}
        //人数选3人
        //else if(this._selectedPeopleIndex == 1){
        //    //没选上AA制收费
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "42";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "60";
        //        }
        //    }
        //    //选了AA收费
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "20";
        //        }
        //    }
        //
        //}
        ////人数选4人且没选上AA制收费
        //else{
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "28";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "56";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "84";
        //        }
        //    }
        //    //AA制收费选上了
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //    }
        //}
    }
});

cc._RFpop();
},{}]},{},["AudioManager","CardPrefab","CardTypeCombine","CardTypeSprite","ChatMessage","MsgControl","KQGlobalEvent","ArrayExtension","NumberExtension","SpriteHelper","StringExtension","fecha","Invit","Item","GetCardPointsSameCount","KQCard","KQCardColorsHelper","KQCardFindTypeExtension","KQCardPointsHelper","KQCardResHelper","KQCardScoreExtension","KQCardScoretsHelper","KQCardSelectExtension","test","ListViewCtrl","UserModelHelper","NetworkError","ChatTextRecord","CompareCards","Countdown","GameResult","Player","ResultItem","TotalGameResult","TotalGameResultItem","UserSampleInfo","maPai","Playback","Setting","KQGlabolSocketEventHander","KQNativeInvoke","agreement","alert","animation","cardNum","cards","cardsBack","cellText","changInfo","change_mapai","checkSelect","choujiang","create_btn_anima","daikai","game","hall","hall_btn_anima","help","inviteCode","joinRoom","launch","login","manager","overTime","play","product","randRoom","record","recordInfo","rule","scale","select","selectMoShi","select_ma","select_mapai","selectbeilv","singleSelect","slider","socket","time","userInfo","zhongtujinru","zhuanNumCtrl"])

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL0NvY29zQ3JlYXRvci9yZXNvdXJjZXMvYXBwLmFzYXIvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvQXJyYXlFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9BdWRpby9BdWRpb01hbmFnZXIuanMiLCJhc3NldHMvc2NyaXB0cy9DYXJkUHJlZmFiLmpzIiwiYXNzZXRzL3NjcmlwdHMvQ2FyZFR5cGVDb21iaW5lLmpzIiwiYXNzZXRzL3NjcmlwdHMvQ2FyZFR5cGVTcHJpdGUuanMiLCJhc3NldHMvc2NyaXB0cy9DaGF0L0NoYXRNZXNzYWdlLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGVmYWJzL0NoYXRUZXh0UmVjb3JkLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGVmYWJzL0NvbXBhcmVDYXJkcy5qcyIsImFzc2V0cy9zY3JpcHRzL1BlZmFicy9Db3VudGRvd24uanMiLCIuLi8uLi8uLi8uLi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9iYXNlNjQtanMvaW5kZXguanMiLCIuLi8uLi8uLi8uLi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9idWZmZXIvaW5kZXguanMiLCIuLi8uLi8uLi8uLi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9pZWVlNzU0L2luZGV4LmpzIiwiLi4vLi4vLi4vLi4vQ29jb3NDcmVhdG9yL3Jlc291cmNlcy9hcHAuYXNhci9ub2RlX21vZHVsZXMvaXNhcnJheS9pbmRleC5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvR2FtZVJlc3VsdC5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9HZXRDYXJkUG9pbnRzU2FtZUNvdW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvSW52aXQuanMiLCJhc3NldHMvc2NyaXB0cy9JdGVtLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZENvbG9yc0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRGaW5kVHlwZUV4dGVuc2lvbi5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRQb2ludHNIZWxwZXIuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkUmVzSGVscGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZFNjb3JlRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZFNjb3JldHNIZWxwZXIuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2VsZWN0RXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZC5qcyIsImFzc2V0cy9zY3JpcHRzL1NvY2tldC9LUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvRXZlbnQvS1FHbG9iYWxFdmVudC5qcyIsImFzc2V0cy9zY3JpcHRzL1V0aWxzL0tRTmF0aXZlSW52b2tlLmpzIiwiYXNzZXRzL3NjcmlwdHMvTGlzdFZpZXdDdHJsLmpzIiwiYXNzZXRzL3NjcmlwdHMvQ2hhdC9Nc2dDb250cm9sLmpzIiwiYXNzZXRzL3NjcmlwdHMvTmV0d29ya0Vycm9yLmpzIiwiYXNzZXRzL3NjcmlwdHMvRXh0ZW5zaW9ucy9OdW1iZXJFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9QbGF5YmFjay9QbGF5YmFjay5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvUGxheWVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9SZXN1bHRJdGVtLmpzIiwiYXNzZXRzL3NjcmlwdHMvU2V0dGluZy9TZXR0aW5nLmpzIiwiYXNzZXRzL3NjcmlwdHMvRXh0ZW5zaW9ucy9TcHJpdGVIZWxwZXIuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL1N0cmluZ0V4dGVuc2lvbi5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvVG90YWxHYW1lUmVzdWx0SXRlbS5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvVG90YWxHYW1lUmVzdWx0LmpzIiwiYXNzZXRzL3NjcmlwdHMvTW9kZWxVdGlscy9Vc2VyTW9kZWxIZWxwZXIuanMiLCJhc3NldHMvc2NyaXB0cy9QbGF5L1VzZXJTYW1wbGVJbmZvLmpzIiwiYXNzZXRzL3NjcmlwdHMvYWdyZWVtZW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvYWxlcnQuanMiLCJhc3NldHMvc2NyaXB0cy9hbmltYXRpb24uanMiLCJhc3NldHMvc2NyaXB0cy9jYXJkTnVtLmpzIiwiYXNzZXRzL3NjcmlwdHMvY2FyZHNCYWNrLmpzIiwiYXNzZXRzL3NjcmlwdHMvY2FyZHMuanMiLCJhc3NldHMvc2NyaXB0cy9jZWxsVGV4dC5qcyIsImFzc2V0cy9zY3JpcHRzL2NoYW5nSW5mby5qcyIsImFzc2V0cy9zY3JpcHRzL2NoYW5nZV9tYXBhaS5qcyIsImFzc2V0cy9zY3JpcHRzL2NoZWNrU2VsZWN0LmpzIiwiYXNzZXRzL3NjcmlwdHMvY2hvdWppYW5nLmpzIiwiYXNzZXRzL3NjcmlwdHMvY3JlYXRlX2J0bl9hbmltYS5qcyIsImFzc2V0cy9zY3JpcHRzL2RhaWthaS5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvZmVjaGEuanMiLCJhc3NldHMvc2NyaXB0cy9nYW1lLmpzIiwiYXNzZXRzL3NjcmlwdHMvaGFsbF9idG5fYW5pbWEuanMiLCJhc3NldHMvc2NyaXB0cy9oYWxsLmpzIiwiYXNzZXRzL3NjcmlwdHMvaGVscC5qcyIsImFzc2V0cy9zY3JpcHRzL2ludml0ZUNvZGUuanMiLCJhc3NldHMvc2NyaXB0cy9qb2luUm9vbS5qcyIsImFzc2V0cy9zY3JpcHRzL2xhdW5jaC5qcyIsImFzc2V0cy9zY3JpcHRzL2xvZ2luLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9tYVBhaS5qcyIsImFzc2V0cy9zY3JpcHRzL21hbmFnZXIuanMiLCJhc3NldHMvc2NyaXB0cy9vdmVyVGltZS5qcyIsImFzc2V0cy9zY3JpcHRzL3BsYXkuanMiLCJhc3NldHMvc2NyaXB0cy9wcm9kdWN0LmpzIiwiYXNzZXRzL3NjcmlwdHMvcmFuZFJvb20uanMiLCJhc3NldHMvc2NyaXB0cy9yZWNvcmRJbmZvLmpzIiwiYXNzZXRzL3NjcmlwdHMvcmVjb3JkLmpzIiwiYXNzZXRzL3NjcmlwdHMvcnVsZS5qcyIsImFzc2V0cy9zY3JpcHRzL3NjYWxlLmpzIiwiYXNzZXRzL3NjcmlwdHMvc2VsZWN0TW9TaGkuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3RfbWFwYWkuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3RfbWEuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3RiZWlsdi5qcyIsImFzc2V0cy9zY3JpcHRzL3NlbGVjdC5qcyIsImFzc2V0cy9zY3JpcHRzL3NpbmdsZVNlbGVjdC5qcyIsImFzc2V0cy9zY3JpcHRzL3NsaWRlci5qcyIsImFzc2V0cy9zY3JpcHRzL3NvY2tldC5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC90ZXN0LmpzIiwiYXNzZXRzL3NjcmlwdHMvdGltZS5qcyIsImFzc2V0cy9zY3JpcHRzL3VzZXJJbmZvLmpzIiwiYXNzZXRzL3NjcmlwdHMvemhvbmd0dWppbnJ1LmpzIiwiYXNzZXRzL3NjcmlwdHMvemh1YW5OdW1DdHJsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7OztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFBUjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQ0E7QUFFQTtBQUNFO0FBQ0U7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFBSjtBQUVJO0FBQ0U7QUFDQTtBQUNFO0FBQVI7QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNFO0FBQ0U7QUFDQTtBQURKO0FBQ0E7QUFHTTtBQUNFO0FBRFI7QUFDQTtBQUdNO0FBRE47QUFDQTtBQUdNO0FBRE47QUFDQTtBQUdNO0FBQ0U7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUdNO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR007QUFETjtBQUNBO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUdRO0FBQ0U7QUFEVjtBQUdRO0FBRFI7QUFDQTtBQUNBO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDRTtBQUNFO0FBQ0E7QUFESjtBQUNBO0FBQ007QUFDRTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ047QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDTjtBQUNNO0FBQ0U7QUFDUjtBQUNRO0FBQ0U7QUFDQTtBQUNFO0FBQ1o7QUFDWTtBQUNaO0FBQ0E7QUFDVTtBQUNFO0FBQ1o7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQ0E7QUFDRTtBQUFSO0FBRU07QUFDRTtBQUFSO0FBRU07QUFBTjtBQUVJO0FBQ0E7QUFDRTtBQUNBO0FBQU47QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUVNO0FBQU47QUFDQTtBQUVNO0FBQU47QUFDQTtBQUVNO0FBQ0U7QUFBUjtBQUNBO0FBQ0E7QUFFTTtBQUNBO0FBQ0E7QUFBTjtBQUNBO0FBRVE7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUVRO0FBQ0U7QUFBVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUVNO0FBQU47QUFDQTtBQUVNO0FBQU47QUFFTTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQVY7QUFFVTtBQUFWO0FBRVE7QUFBUjtBQUNBO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNFO0FBQUY7QUFDQTtBQUFJO0FBQ0U7QUFFTjtBQUNBO0FBQUk7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBRVY7QUFDQTtBQUFRO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFFVjtBQUFVO0FBRVY7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0o7QUFDQTtBQURNO0FBR047QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNFO0FBR0Y7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUNBO0FBSEE7QUFDRTtBQUNFO0FBQ0E7QUFLSjtBQUNBO0FBTE07QUFPTjtBQUNBO0FBTlE7QUFDQTtBQUNFO0FBUVY7QUFOUTtBQUNBO0FBQ0U7QUFRVjtBQU5VO0FBQ0E7QUFRVjtBQUNBO0FBQ0E7QUFwQk07QUFzQk47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpNO0FBY047QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFjUjtBQUNBO0FBWk07QUFDRTtBQWNSO0FBQ0E7QUFaTTtBQUNBO0FBQ0E7QUFjTjtBQVpNO0FBY047QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFjUjtBQUNBO0FBWk07QUFDRTtBQUNBO0FBY1I7QUFDQTtBQVpNO0FBY047QUFaTTtBQWNOO0FBQ0E7QUFDQTtBQUNBO0FBWkE7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBY1I7QUFDQTtBQVpNO0FBQ0E7QUFDRTtBQUNFO0FBY1Y7QUFDQTtBQUNBO0FBWk07QUFjTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFaQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ1k7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNJO0FBQVo7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQ0k7QUFBaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUFRO0FBQ0E7QUFFUjtBQUFRO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUVKO0FBQ0E7QUFGUTtBQUNBO0FBSVI7QUFGUTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUZJO0FBSUo7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQU1SO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBSlE7QUFDQTtBQUNJO0FBQ0k7QUFNaEI7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBUFE7QUFTUjtBQVBZO0FBQ0E7QUFDQTtBQUNBO0FBU1o7QUFDQTtBQVBRO0FBQ0E7QUFDQTtBQVNSO0FBQ0E7QUFDQTtBQVBJO0FBU0o7QUFDQTtBQVRRO0FBQ0E7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBQ0k7QUFXWjtBQUNBO0FBQ0E7QUFUSTtBQUNJO0FBV1I7QUFDQTtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBQ0k7QUFXWjtBQVRRO0FBQ0E7QUFDQTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0k7QUFXUjtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBRFo7QUFDQTtBQUdRO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFHUTtBQURSO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBQ0k7QUFEWjtBQUdRO0FBRFI7QUFHUTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUdJO0FBQ0k7QUFEUjtBQUdJO0FBQ0k7QUFEUjtBQUdJO0FBQ0k7QUFEUjtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pTQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDTTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURNO0FBR047QUFDQTtBQURJO0FBQ0U7QUFHTjtBQUNBO0FBREk7QUFDRTtBQUNBO0FBQ0U7QUFHUjtBQUNBO0FBRE07QUFHTjtBQUNBO0FBREk7QUFDRTtBQUdOO0FBRE07QUFDRTtBQUNFO0FBQ0E7QUFHVjtBQUNBO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9FQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFEQTtBQUNJO0FBQ0E7QUFDSTtBQUdSO0FBREk7QUFDSTtBQUdSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUFRO0FBRVI7QUFBUTtBQUNBO0FBRVI7QUFDQTtBQUFRO0FBRVI7QUFBUTtBQUNBO0FBQ0E7QUFDQTtBQUVSO0FBQVE7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFUjtBQUFRO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBRVI7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBUTtBQUVSO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFFUjtBQURZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQUNBO0FBRFk7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFHSjtBQUNBO0FBQ0E7QUFKUTtBQU1SO0FBSlE7QUFDQTtBQU1SO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQU1SO0FBSlE7QUFDSTtBQU1aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKUTtBQUNBO0FBQ0E7QUFDQTtBQU1SO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQU1aO0FBQ0E7QUFKUTtBQU1SO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFNUjtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQU1aO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQThEO0FBT3RFO0FBUDBHO0FBUzFHO0FBQ0E7QUFSUTtBQUNBO0FBQ0E7QUFDQTtBQVVSO0FBQ0E7QUFDQTtBQVJJO0FBVUo7QUFSUTtBQVVSO0FBUlE7QUFVUjtBQVJRO0FBQXFDO0FBVzdDO0FBQ0E7QUFWUTtBQUNBO0FBQ0E7QUFDSTtBQVlaO0FBQ0E7QUFDQTtBQVZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBWWhCO0FBVlk7QUFZWjtBQVZRO0FBWVI7QUFWUTtBQUNJO0FBWVo7QUFDQTtBQUNBO0FBVkk7QUFDSTtBQVlSO0FBQ0E7QUFWSTtBQUNJO0FBWVI7QUFDQTtBQVZJO0FBQ0k7QUFZUjtBQUNBO0FBQ0E7QUFWSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZUjtBQVhZO0FBQ0E7QUFDQTtBQWFaO0FBWmdCO0FBQ0k7QUFjcEI7QUFab0I7QUFjcEI7QUFDQTtBQVpnQjtBQWNoQjtBQUNBO0FBQ0E7QUFiWTtBQUNBO0FBZVo7QUFiUTtBQUNBO0FBQ0E7QUFDQTtBQWVSO0FBQ0E7QUFiSTtBQUNJO0FBQ0E7QUFlUjtBQUNBO0FBYkk7QUFDSTtBQWVSO0FBYlE7QUFDQTtBQWVSO0FBYlE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQWVaO0FBQ0E7QUFDQTtBQUNBO0FBYkk7QUFlSjtBQUNBO0FBQ0E7QUFiUTtBQUNBO0FBQ0k7QUFDQTtBQWVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJRO0FBQ0k7QUFDQTtBQUNBO0FBbUJaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJRO0FBbUJSO0FBQ0E7QUFqQkk7QUFDSTtBQUNJO0FBbUJaO0FBakJRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFtQlo7QUFqQlE7QUFtQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJRO0FBQ0k7QUFtQlo7QUFDQTtBQWpCUTtBQW1CUjtBQUNBO0FBakJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW1CUjtBQWpCUTtBQW1CUjtBQUNBO0FBQ0E7QUFqQkk7QUFDSTtBQW1CUjtBQWpCUTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFtQmhCO0FBakJZO0FBbUJaO0FBakJRO0FBQ0E7QUFDQTtBQUNBO0FBbUJSO0FBakJRO0FBbUJSO0FBakJZO0FBbUJaO0FBQ0E7QUFqQlE7QUFtQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQkk7QUFDSTtBQUNJO0FBbUJaO0FBakJZO0FBbUJaO0FBakJZO0FBbUJaO0FBakJRO0FBbUJSO0FBQ0E7QUFDQTtBQWpCSTtBQW1CSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJJO0FBbUJKO0FBakJRO0FBbUJSO0FBakJRO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFtQmhCO0FBakJvQjtBQW1CcEI7QUFDQTtBQUNBO0FBakJRO0FBbUJSO0FBQ0E7QUFqQkk7QUFDSTtBQUNBO0FBQ0k7QUFtQlo7QUFqQlE7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQW1CaEI7QUFqQlk7QUFtQlo7QUFqQlE7QUFtQlI7QUFDQTtBQWpCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBbUJoQjtBQWxCb0I7QUFvQnBCO0FBQ0E7QUFsQlk7QUFDSTtBQW9CaEI7QUFDQTtBQUNBO0FBQ0E7QUFsQlE7QUFvQlI7QUFsQlk7QUFvQlo7QUFsQlk7QUFvQlo7QUFsQlk7QUFvQlo7QUFsQlk7QUFvQlo7QUFsQlk7QUFDSTtBQW9CaEI7QUFsQmdCO0FBb0JoQjtBQUNBO0FBbEJZO0FBQ0k7QUFvQmhCO0FBQ0E7QUFDQTtBQWxCUTtBQUNJO0FBQ0E7QUFvQlo7QUFuQmdCO0FBcUJoQjtBQUNBO0FBbkJZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFxQlo7QUFuQlk7QUFxQlo7QUFwQmdCO0FBQ0E7QUFDSTtBQXNCcEI7QUFDQTtBQXBCWTtBQXNCWjtBQXJCZ0I7QUFDQTtBQUNJO0FBdUJwQjtBQUNBO0FBckJZO0FBdUJaO0FBdEJnQjtBQUNBO0FBQ0k7QUF3QnBCO0FBQ0E7QUFDQTtBQXRCWTtBQUNBO0FBQ0k7QUFDSTtBQXdCcEI7QUFDQTtBQUNBO0FBdEJZO0FBd0JaO0FBdkJnQjtBQXlCaEI7QUF2Qlk7QUF5Qlo7QUF4QmdCO0FBMEJoQjtBQXhCWTtBQTBCWjtBQXpCZ0I7QUEyQmhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBekJZO0FBRUk7QUEwQmhCO0FBQ0E7QUFDQTtBQXhCUTtBQUNBO0FBQW9EO0FBMkI1RDtBQTFCUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTRCWjtBQUNBO0FBMUJRO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQTRCcEI7QUFDQTtBQUNBO0FBQ0E7QUExQlE7QUE0QlI7QUExQlE7QUFDQTtBQTRCUjtBQTFCUTtBQTRCUjtBQTNCWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBNkJwQjtBQUNBO0FBQ0E7QUFDQTtBQTNCUTtBQUNJO0FBQ0E7QUFDQTtBQTZCWjtBQTNCWTtBQUNBO0FBQ0E7QUE2Qlo7QUEzQlk7QUFDQTtBQTZCWjtBQTNCWTtBQTZCWjtBQUNBO0FBM0JRO0FBQ0k7QUE2Qlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzQlE7QUE2QlI7QUEzQlk7QUFBdUM7QUE4Qm5EO0FBQ0E7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUFDQTtBQTdCUTtBQUNBO0FBQ0E7QUErQlI7QUE5Qlk7QUFDQTtBQUNBO0FBQ0E7QUFBeUI7QUFpQ3JDO0FBaENZO0FBQXlCO0FBbUNyQztBQWxDWTtBQUF5QjtBQXFDckM7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXNDWjtBQXBDUTtBQXNDUjtBQXBDUTtBQXNDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQ0k7QUFDSTtBQXNDUjtBQXBDUTtBQXNDUjtBQXBDUTtBQXNDUjtBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQUNBO0FBbkNRO0FBcUNSO0FBbkNRO0FBcUNSO0FBbkNRO0FBcUNSO0FBbENRO0FBb0NSO0FBbENZO0FBb0NaO0FBbENZO0FBb0NaO0FBbENZO0FBQ0E7QUFDSTtBQW9DaEI7QUFqQ2dCO0FBbUNoQjtBQUNBO0FBakNZO0FBbUNaO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNvQjtBQW1DcEI7QUFqQ29CO0FBbUNwQjtBQWpDb0I7QUFtQ3BCO0FBakN3QjtBQUFVO0FBb0NsQztBQUNBO0FBbkN3QjtBQXFDeEI7QUFuQ3dCO0FBcUN4QjtBQW5Dd0I7QUFxQ3hCO0FBbkN3QjtBQXFDeEI7QUFuQ3dCO0FBcUN4QjtBQUNBO0FBbENvQjtBQW9DcEI7QUFDQTtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFDQTtBQUNBO0FBaENRO0FBa0NSO0FBQ0E7QUFDQTtBQUNBO0FBL0JJO0FBaUNKO0FBQ0E7QUFoQ1E7QUFrQ1I7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFrQ1o7QUFDQTtBQS9CUTtBQWlDUjtBQS9CUTtBQWlDUjtBQS9CUTtBQUNJO0FBaUNaO0FBOUJZO0FBZ0NaO0FBOUJRO0FBQ0E7QUFDQTtBQWdDUjtBQUNBO0FBQ0E7QUFDQTtBQTlCUTtBQWdDUjtBQTlCWTtBQWdDWjtBQTlCWTtBQWdDWjtBQTlCZ0I7QUFnQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBNUJRO0FBOEJSO0FBNUJZO0FBOEJaO0FBNUJZO0FBQW1DO0FBK0IvQztBQUNBO0FBQ0E7QUE5QlE7QUFnQ1I7QUE5QlE7QUFnQ1I7QUE5QlE7QUFBNEQ7QUFpQ3BFO0FBQ0E7QUFoQ1E7QUFrQ1I7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFrQ1o7QUFoQ2dCO0FBa0NoQjtBQWhDZ0I7QUFrQ2hCO0FBaENnQjtBQWtDaEI7QUFoQ29CO0FBa0NwQjtBQWhDb0I7QUFrQ3BCO0FBaENvQjtBQWtDcEI7QUFoQ3dCO0FBQ0k7QUFrQzVCO0FBQ0E7QUFoQ3dCO0FBa0N4QjtBQUNBO0FBL0JvQjtBQWlDcEI7QUEvQm9CO0FBaUNwQjtBQS9Cb0I7QUFpQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzQkk7QUE2Qko7QUEzQlE7QUE2QlI7QUEzQlE7QUE2QlI7QUEzQlE7QUE2QlI7QUEzQlE7QUE2QlI7QUFDQTtBQTNCSTtBQTZCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJJO0FBOEJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJJO0FBOEJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBN0JJO0FBK0JKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBN0JJO0FBK0JKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUE3QlE7QUFDQTtBQStCUjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQUNBO0FBQ0E7QUE1Qkk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQTBDO0FBK0J0RDtBQUNBO0FBOUJRO0FBZ0NSO0FBOUJZO0FBZ0NaO0FBOUJZO0FBZ0NaO0FBOUJnQjtBQWdDaEI7QUE5QmdCO0FBZ0NoQjtBQTlCZ0I7QUFnQ2hCO0FBQ0E7QUE3Qlk7QUErQlo7QUE3QmdCO0FBK0JoQjtBQTdCZ0I7QUFBbUM7QUFnQ25EO0FBQ0E7QUEvQmdCO0FBaUNoQjtBQS9CZ0I7QUFpQ2hCO0FBL0JvQjtBQWlDcEI7QUEvQm9CO0FBaUNwQjtBQUNBO0FBOUJnQjtBQWdDaEI7QUE5QmdCO0FBZ0NoQjtBQTlCZ0I7QUFnQ2hCO0FBQ0E7QUE3Qlk7QUErQlo7QUFDQTtBQUNBO0FBM0JJO0FBNkJKO0FBQ0E7QUFDQTtBQTdCUTtBQStCUjtBQTdCWTtBQUE4RDtBQWdDMUU7QUFoQzhHO0FBa0M5RztBQUNBO0FBakNZO0FBbUNaO0FBakNZO0FBQTZCO0FBQXlCO0FBQW9CO0FBc0N0RjtBQUNBO0FBQ0E7QUFDQTtBQXZDWTtBQXlDWjtBQUNBO0FBQ0E7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUFDQTtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQUNBO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBQThDO0FBeUN0RDtBQUNBO0FBeENRO0FBMENSO0FBeENZO0FBMENaO0FBeENZO0FBMENaO0FBeENZO0FBMENaO0FBQ0E7QUFDQTtBQXZDSTtBQUNJO0FBeUNSO0FBQ0E7QUF2Q0k7QUFDSTtBQXlDUjtBQUNBO0FBdkNJO0FBQ0k7QUF5Q1I7QUFDQTtBQXZDSTtBQUNJO0FBQ0E7QUFDQTtBQXlDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBeUN4QjtBQXZDd0I7QUFDQTtBQXlDeEI7QUFDQTtBQUNBO0FBdENvQjtBQUNBO0FBd0NwQjtBQXRDZ0I7QUFDSTtBQUNBO0FBd0NwQjtBQXRDb0I7QUF3Q3BCO0FBdENvQjtBQUNBO0FBd0NwQjtBQUNBO0FBckNnQjtBQXVDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBckNJO0FBdUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXRDSTtBQXdDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZDSTtBQXlDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2Q0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBeUNaO0FBQ0E7QUF2Q1E7QUFDQTtBQUNBO0FBQ0E7QUF5Q1I7QUFDQTtBQUNBO0FBdkNJO0FBQ0k7QUF5Q1I7QUFDQTtBQUNBO0FBdkNJO0FBeUNKO0FBdkNRO0FBeUNSO0FBQ0E7QUFDQTtBQXZDSTtBQXlDSjtBQXZDUTtBQXlDUjtBQUNBO0FBdkNJO0FBQ0k7QUFDSTtBQXlDWjtBQUNBO0FBdkNRO0FBeUNSO0FBQ0E7QUF2Q1k7QUF5Q1o7QUFDQTtBQXZDUTtBQXlDUjtBQUNBO0FBQ0E7QUF2Q0k7QUF5Q0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZDSTtBQXlDSjtBQUNBO0FBQ0E7QUFDQTtBQXZDSTtBQXlDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xzREE7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFESjtBQUNBO0FBQ007QUFDQTtBQUNJO0FBQ1Y7QUFDTTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNNO0FBQ0U7QUFDRTtBQUNBO0FBQ1Y7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUZRO0FBQ0k7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRlE7QUFDQTtBQUlSO0FBRlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBSVI7QUFGUTtBQUNBO0FBSVI7QUFGUTtBQUNJO0FBSVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBQ0k7QUFJWjtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0k7QUFDSTtBQUNBO0FBSVI7QUFGSTtBQUlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hHQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFFSTtBQUFKO0FBSUk7QUFDRTtBQUZOO0FBQ0E7QUFJSTtBQUNFO0FBRk47QUFDQTtBQUlJO0FBQ0k7QUFGUjtBQUlJO0FBQ0k7QUFGUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQVI7QUFFUTtBQUE0QztBQUNwRDtBQUNBO0FBQVE7QUFFUjtBQUFRO0FBRVI7QUFBUTtBQUVSO0FBQVE7QUFFUjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ1E7QUFBNkM7QUFFckQ7QUFDQTtBQURRO0FBQTJDO0FBSW5EO0FBQ0E7QUFIUTtBQUtSO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUNBO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBS1o7QUFIWTtBQUtaO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBSVo7QUFGUTtBQUE4QjtBQUt0QztBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVo7QUFKWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQU1aO0FBQ0E7QUFKUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFKUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBS1I7QUFIUTtBQUNBO0FBQ0k7QUFDQTtBQUtaO0FBSFk7QUFLWjtBQUhRO0FBQ0E7QUFLUjtBQUNBO0FBSEk7QUFDSTtBQUtSO0FBSFk7QUFLWjtBQUhZO0FBS1o7QUFIWTtBQUtaO0FBSGdCO0FBQVU7QUFNMUI7QUFDQTtBQUxnQjtBQU9oQjtBQUxnQjtBQU9oQjtBQUxnQjtBQU9oQjtBQUxnQjtBQU9oQjtBQUxnQjtBQU9oQjtBQUNBO0FBSlk7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBSlE7QUFNUjtBQUpRO0FBTVI7QUFKUTtBQUNJO0FBQ0k7QUFNaEI7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBQ0E7QUFIUTtBQUNBO0FBQ0E7QUFLUjtBQUhRO0FBS1I7QUFIUTtBQUNBO0FBQ0E7QUFLUjtBQUNBO0FBSFE7QUFDQTtBQUNBO0FBS1I7QUFDQTtBQUhRO0FBQ0E7QUFLUjtBQUhRO0FBQTBDO0FBTWxEO0FBQ0E7QUFMUTtBQUNBO0FBQ0E7QUFPUjtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBQ0E7QUFOUTtBQUNJO0FBQ0E7QUFRWjtBQUNBO0FBTlE7QUFRUjtBQU5ZO0FBUVo7QUFOWTtBQVFaO0FBTlk7QUFRWjtBQU5ZO0FBUVo7QUFOWTtBQVFaO0FBTlk7QUFRWjtBQU5ZO0FBUVo7QUFOZ0I7QUFRaEI7QUFOZ0I7QUFRaEI7QUFDQTtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFk7QUFPWjtBQUxZO0FBQVE7QUFRcEI7QUFDQTtBQUNBO0FBTlE7QUFRUjtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ1E7QUFPaEI7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBT1I7QUFMWTtBQU9aO0FBTFk7QUFPWjtBQUxZO0FBT1o7QUFMWTtBQU9aO0FBTFk7QUFPWjtBQUxZO0FBT1o7QUFMZ0I7QUFPaEI7QUFMZ0I7QUFPaEI7QUFDQTtBQUpnQjtBQU1oQjtBQUpnQjtBQU1oQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFDQTtBQUhRO0FBS1I7QUFIUTtBQUtSO0FBQ0E7QUFIUTtBQUNJO0FBS1o7QUFGWTtBQUlaO0FBQ0E7QUFGUTtBQUFpRDtBQUt6RDtBQUNBO0FBSlE7QUFNUjtBQUNBO0FBSEk7QUFDSTtBQUtSO0FBQ0E7QUFIUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBS1o7QUFDQTtBQUhRO0FBQ0E7QUFDQTtBQUNJO0FBS1o7QUFDQTtBQUZRO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUNJO0FBSVI7QUFGUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBSVo7QUFDQTtBQUZRO0FBQ0E7QUFDQTtBQUNJO0FBSVo7QUFDQTtBQUZRO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUlKO0FBRlE7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBQ0k7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUlKO0FBRlE7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFJaEI7QUFGZ0I7QUFJaEI7QUFGZ0I7QUFJaEI7QUFGZ0I7QUFJaEI7QUFGZ0I7QUFJaEI7QUFGZ0I7QUFJaEI7QUFEWTtBQUErQztBQUkzRDtBQUhZO0FBS1o7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0E7QUFLUjtBQUhRO0FBQ0E7QUFDSTtBQUNJO0FBS2hCO0FBSGdCO0FBS2hCO0FBSFk7QUFDQTtBQUNBO0FBQ0E7QUFLWjtBQUhRO0FBQ0E7QUFDSTtBQUtaO0FBSFE7QUFDSTtBQUNBO0FBS1o7QUFGWTtBQUNBO0FBSVo7QUFEWTtBQUNBO0FBR1o7QUFDQTtBQURRO0FBQ0E7QUFBOEI7QUFJdEM7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUlSO0FBRlE7QUFJUjtBQUZZO0FBQWtFO0FBSzlFO0FBSm9EO0FBTXBEO0FBQ0E7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFk7QUFPWjtBQUxZO0FBQTJDO0FBUXZEO0FBQ0E7QUFQWTtBQVNaO0FBUFk7QUFTWjtBQUNBO0FBTlE7QUFRUjtBQU5RO0FBUVI7QUFOWTtBQVFaO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQUNJO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFKUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFKUTtBQU1SO0FBSlE7QUFDSTtBQUNBO0FBTVo7QUFKUTtBQU1SO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQU5RO0FBQ0k7QUFDSTtBQUNBO0FBUWhCO0FBTlk7QUFDQTtBQUNBO0FBQ0E7QUFRWjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBUVo7QUFOUTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDQTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBQ0k7QUFRWjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDSTtBQVFaO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzcEJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNEQSxBRDREQTtBQzNEQSxBRDREQTtBQzNEQSxBRDREQTtBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDbEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUM3dkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0Y7QUFDQTtBQUVBO0FBQ0U7QUFBRjtBQUVFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFBSjtBQUVJO0FBQUo7QUFFSTtBQUNBO0FBQ0E7QUFBSjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQUo7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUFKO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBRUk7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDQTtBQUNFO0FBQU47QUFDQTtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFDQTtBQUNFO0FBQVI7QUFDQTtBQUVNO0FBQ0E7QUFDQTtBQUNBO0FBQU47QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUFKO0FBQ0E7QUFFRTtBQUNFO0FBQ0U7QUFBTjtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUVFO0FBQ0U7QUFDRTtBQUFOO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFDQTtBQUVJO0FBQ0E7QUFBSjtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQ0U7QUFBTjtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEhBO0FBQ0E7QUFDQztBQUNHO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNZO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNRO0FBQ1I7QUFDTTtBQUNBO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFBTTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFDRTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNFO0FBQ0E7QUFFRTtBQUNWO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ1Y7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JGQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDWjtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ1E7QUFDUjtBQUNBO0FBQ0s7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFFUTtBQUNJO0FBQVo7QUFFUTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQVI7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUFSO0FBQ0E7QUFFWTtBQUFaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsRUE7QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0o7QUFDQTtBQUNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDRTtBQUNSO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNBO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDRTtBQUNGO0FBQ0U7QUFDRjtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDSjtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUFNO0FBQ0E7QUFDRTtBQUNFO0FBRVY7QUFBUTtBQUVSO0FBQ0E7QUFDQTtBQUNBO0FBQUU7QUFDRTtBQUNBO0FBQ0E7QUFFSjtBQUFFO0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNFO0FBQ0E7QUFFRjtBQUFFO0FBQ0U7QUFDSTtBQUVSO0FBQ0E7QUFBRTtBQUNFO0FBRUo7QUFDQTtBQUFFO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUFRO0FBQ0U7QUFDRTtBQUVaO0FBQVU7QUFFVjtBQUNBO0FBQVE7QUFFUjtBQUNBO0FBQ0E7QUFFRTtBQUNBO0FBQ0U7QUFBSjtBQUVFO0FBQUY7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNFO0FBQ0U7QUFBSjtBQUVFO0FBQUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBQ0E7QUFFUTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0E7QUFDRTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFRTtBQUNBO0FBQUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFBRTtBQUNFO0FBRUo7QUFBRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDRTtBQUNBO0FBRVI7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFDTTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDUjtBQUNNO0FBQ047QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNOO0FBQVE7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFFZDtBQUNBO0FBQ0E7QUFBUTtBQUNBO0FBRVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURFO0FBQ0U7QUFHSjtBQURJO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUdWO0FBQ0E7QUFETTtBQUdOO0FBREk7QUFHSjtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFIRTtBQUNFO0FBS0o7QUFIRTtBQUNBO0FBQ0U7QUFLSjtBQUhFO0FBS0Y7QUFIRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDRTtBQUNBO0FBS1I7QUFDQTtBQUZNO0FBQ0U7QUFDQTtBQUlSO0FBQ0E7QUFGTTtBQUNFO0FBQ0E7QUFJUjtBQUNBO0FBRk07QUFDRTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBQ0E7QUFGRTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFJUjtBQUZNO0FBSU47QUFDQTtBQUNBO0FBQ0E7QUFGRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBQ0E7QUFMVTtBQUNJO0FBT2Q7QUFOVTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQVFoQjtBQUNBO0FBQ0E7QUFMVTtBQU9WO0FBTFU7QUFPVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxFO0FBQ0U7QUFPSjtBQUxJO0FBQ0E7QUFDRTtBQU9OO0FBTEk7QUFPSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQUNFO0FBQ0E7QUFDRTtBQU9KO0FBTEU7QUFPRjtBQUxFO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT047QUFDQTtBQUxFO0FBQ0U7QUFPSjtBQUxFO0FBQ0E7QUFPRjtBQUNBO0FBTEE7QUFDRTtBQUNFO0FBT0o7QUFMRTtBQUNBO0FBT0Y7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBUEU7QUFDRTtBQVNKO0FBUEU7QUFDRTtBQVNKO0FBQ0E7QUFQRTtBQUNFO0FBU0o7QUFQRTtBQVNGO0FBQ0E7QUFQRTtBQUNFO0FBU0o7QUFQRTtBQUNFO0FBQ0E7QUFDQTtBQVNKO0FBQ0E7QUFQRTtBQVNGO0FBQ0E7QUFQRTtBQUNFO0FBQ0E7QUFTSjtBQVJNO0FBQ0E7QUFDRTtBQVVSO0FBUlU7QUFDRTtBQVVaO0FBQ0E7QUFSVTtBQVVWO0FBUlE7QUFVUjtBQUNBO0FBUk07QUFDQTtBQVVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRFO0FBQ0E7QUFDRTtBQVdKO0FBQ0E7QUFURTtBQUNFO0FBV0o7QUFDQTtBQVRFO0FBV0Y7QUFUQTtBQVdBO0FBQ0E7QUFYRTtBQUNFO0FBYUo7QUFYRTtBQUNBO0FBQ0U7QUFhSjtBQVhFO0FBYUY7QUFYRTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFhTjtBQUNBO0FBQ0E7QUFYRTtBQUNFO0FBYUo7QUFYRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQWFOO0FBQ0E7QUFDQTtBQWRRO0FBQ0k7QUFnQlo7QUFmUTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQWlCZDtBQUNBO0FBQ0E7QUFDQTtBQWRRO0FBQ0E7QUFnQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZFO0FBQ0U7QUFpQko7QUFmSTtBQUNBO0FBQ0U7QUFpQk47QUFmSTtBQWlCSjtBQUNBO0FBZkE7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQWlCTjtBQUNBO0FBZkk7QUFDRTtBQUNFO0FBQ0U7QUFpQlY7QUFmUTtBQUNFO0FBaUJWO0FBZlE7QUFpQlI7QUFDQTtBQWZNO0FBQ0U7QUFpQlI7QUFDQTtBQWZNO0FBQ0E7QUFDQTtBQWlCTjtBQUNBO0FBQ0E7QUFmRTtBQWlCRjtBQUNBO0FBQ0E7QUFDQTtBQWZBO0FBaUJBO0FBQ0E7QUFqQkU7QUFDRTtBQW1CSjtBQUNBO0FBakJFO0FBQ0E7QUFtQkY7QUFqQkU7QUFDQTtBQUNFO0FBQ0E7QUFtQko7QUFsQk07QUFDQTtBQUNFO0FBQ0U7QUFvQlY7QUFsQlU7QUFvQlY7QUFDQTtBQWxCTTtBQUNBO0FBb0JOO0FBQ0E7QUFDQTtBQW5CRTtBQXFCRjtBQW5CQTtBQUNFO0FBQ0U7QUFxQko7QUFuQkU7QUFDQTtBQUNFO0FBcUJKO0FBbkJFO0FBcUJGO0FBbkJFO0FBcUJGO0FBbkJFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQXFCTjtBQUNBO0FBQ0E7QUF0QlE7QUFDSTtBQXdCWjtBQXZCUTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQXlCZDtBQUNBO0FBQ0E7QUFDQTtBQXRCUTtBQUNBO0FBd0JSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2QkU7QUF5QkY7QUFDQTtBQXZCQTtBQUNFO0FBQ0E7QUFDRTtBQXlCSjtBQUNBO0FBdEJFO0FBQ0E7QUFDQTtBQXdCRjtBQUNBO0FBQ0E7QUF0QkU7QUFDRTtBQUNFO0FBQ0U7QUF3QlI7QUF0QlE7QUFDQTtBQXdCUjtBQXRCUTtBQXdCUjtBQUNBO0FBQ0E7QUF0Qkk7QUFDRTtBQUNFO0FBd0JSO0FBQ0E7QUFDQTtBQUNBO0FBdEJRO0FBQ0E7QUF3QlI7QUFDQTtBQUNBO0FBQ0E7QUF0QlE7QUF3QlI7QUFDQTtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQXNCSjtBQXBCRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBc0JaO0FBQ0E7QUFwQlE7QUFDRTtBQXNCVjtBQUNBO0FBcEJNO0FBQ0U7QUFzQlI7QUFDQTtBQUNBO0FBcEJFO0FBQ0U7QUFzQko7QUFwQkU7QUFzQkY7QUFwQkE7QUFDRTtBQUNBO0FBQ0U7QUFzQko7QUFwQkU7QUFDQTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFzQko7QUFwQkU7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBc0JOO0FBQ0E7QUFDQTtBQXBCRTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFzQk47QUFDQTtBQUNBO0FBcEJFO0FBQ0U7QUFzQko7QUFwQkU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQXNCWjtBQUNBO0FBcEJRO0FBQ0U7QUFzQlY7QUFDQTtBQXBCTTtBQUNFO0FBc0JSO0FBQ0E7QUFDQTtBQXBCRTtBQUNFO0FBc0JKO0FBcEJFO0FBc0JGO0FBQ0E7QUFwQkE7QUFzQkE7QUFDQTtBQXRCRTtBQXdCRjtBQXZCSTtBQUNFO0FBQ0E7QUFDRTtBQXlCUjtBQUNBO0FBQ0E7QUF2QkU7QUFDRTtBQXlCSjtBQXZCRTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUF5Qk47QUF4QlE7QUFDRTtBQUNBO0FBQ0U7QUEwQlo7QUFDQTtBQUNBO0FBeEJRO0FBQ0E7QUFDRTtBQTBCVjtBQUNBO0FBQ0E7QUFDQTtBQXhCRTtBQUNFO0FBMEJKO0FBeEJFO0FBQ0E7QUEwQkY7QUFDQTtBQXhCQTtBQUNFO0FBQ0U7QUEwQko7QUF4Qkk7QUFDQTtBQTBCSjtBQXpCTTtBQUNFO0FBMkJSO0FBekJRO0FBQ0E7QUEyQlI7QUFDQTtBQUNBO0FBekJJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBMkJWO0FBekJNO0FBMkJOO0FBMUJRO0FBQ0E7QUE0QlI7QUFDQTtBQUNBO0FBekJFO0FBMkJGO0FBQ0E7QUF4QkE7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBZ0JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3Q0QkE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDSjtBQUNVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDSTtBQUNFO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFDTTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRjtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQ047QUFDQTtBQUNFO0FBQ0U7QUFDRTtBQUNOO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDRjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0o7QUFDSTtBQUNFO0FBQ047QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUVJO0FBQUo7QUFDTTtBQUNOO0FBQ0k7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNJO0FBQ0E7QUFDSjtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFBTjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBR0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBRE47QUFFUTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBR0k7QUFDRTtBQUNBO0FBRE47QUFHSTtBQURKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLSTtBQUNBO0FBSEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFITjtBQUtJO0FBSEo7QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUpKO0FBS007QUFITjtBQUtJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFITjtBQUtNO0FBQ0E7QUFITjtBQUtJO0FBSEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1JO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBSk47QUFLUTtBQUNBO0FBSFI7QUFLUTtBQUNBO0FBSFI7QUFLUTtBQUNBO0FBSFI7QUFLUTtBQUNBO0FBQ0U7QUFIVjtBQUtVO0FBSFY7QUFDQTtBQUNBO0FBS0k7QUFDRTtBQUNBO0FBSE47QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9JO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUxOO0FBTVE7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBSlo7QUFDQTtBQUNBO0FBUVE7QUFOUjtBQU9VO0FBQ0U7QUFDQTtBQUxaO0FBT1k7QUFDQTtBQUxaO0FBQ0E7QUFDQTtBQUNBO0FBVUk7QUFSSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0k7QUFDQTtBQUNBO0FBQ0E7QUFUSjtBQVdJO0FBQ0U7QUFDRTtBQVRSO0FBV007QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFUVjtBQVdVO0FBVFY7QUFDQTtBQUNBO0FBQ0E7QUFXTTtBQUNFO0FBQ0E7QUFUUjtBQVdNO0FBVE47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdJO0FBQ0U7QUFUTjtBQVVRO0FBUlI7QUFTVTtBQUNFO0FBQ0E7QUFDQTtBQVBaO0FBQ0E7QUFDQTtBQVVRO0FBUlI7QUFTVTtBQUNFO0FBQ0E7QUFDQTtBQVBaO0FBQ0E7QUFDQTtBQUNBO0FBV0k7QUFDRTtBQUNBO0FBVE47QUFXSTtBQVRKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZSTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQVZOO0FBWUk7QUFDRTtBQUNBO0FBVk47QUFZSTtBQVZKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFhRTtBQUNBO0FBQ0U7QUFYSjtBQUNBO0FBYUU7QUFDQTtBQVhGO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQVhOO0FBQ0E7QUFDQTtBQWFFO0FBQ0E7QUFYRjtBQWFFO0FBQ0U7QUFDRTtBQVhOO0FBQ0E7QUFhRTtBQUNFO0FBQ0E7QUFDRTtBQVhOO0FBQ0E7QUFhRTtBQUNFO0FBQ0U7QUFYTjtBQUNBO0FBQ0E7QUFhRTtBQVhGO0FBWUk7QUFDRTtBQUNFO0FBVlI7QUFDQTtBQUNBO0FBWUk7QUFDRTtBQVZOO0FBWUk7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQVZOO0FBWUk7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQVZWO0FBQ0E7QUFDQTtBQUNBO0FBWUk7QUFWSjtBQVdNO0FBQ0U7QUFUUjtBQUNBO0FBQ0E7QUFDQTtBQVdJO0FBQ0U7QUFUTjtBQVdJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFUTjtBQVdJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFUVjtBQUNBO0FBQ0E7QUFDQTtBQVdJO0FBVEo7QUFVTTtBQUNFO0FBUlI7QUFDQTtBQUNBO0FBV0k7QUFDRTtBQVROO0FBV0k7QUFDQTtBQUNFO0FBQ0E7QUFUTjtBQVdJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFUVjtBQUNBO0FBQ0E7QUFXSTtBQVRKO0FBVU07QUFDRTtBQVJSO0FBQ0E7QUFDQTtBQUNBO0FBVUU7QUFDRTtBQUNFO0FBUk47QUFDQTtBQVVFO0FBQ0U7QUFSSjtBQVVFO0FBUkY7QUFDQTtBQUNBO0FBVUE7QUFDRTtBQUNBO0FBQ0U7QUFSSjtBQVVJO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQVVJO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQVVJO0FBUko7QUFVSTtBQVJKO0FBQ0E7QUFVRTtBQVJGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVUE7QUFSQTtBQVVFO0FBUkY7QUFVRTtBQUEwQjtBQVA1QjtBQUNBO0FBUUU7QUFDQTtBQUNFO0FBQ0E7QUFOSjtBQVFJO0FBQ0U7QUFOTjtBQVFJO0FBQ0E7QUFDQTtBQU5KO0FBQ0E7QUFRRTtBQUE2QjtBQUwvQjtBQU1FO0FBSkY7QUFDQTtBQU1BO0FBSkE7QUFNRTtBQUpGO0FBTUU7QUFBMEI7QUFINUI7QUFDQTtBQUlFO0FBQ0E7QUFDRTtBQUNBO0FBRko7QUFJSTtBQUNFO0FBRk47QUFJSTtBQUNBO0FBQ0E7QUFGSjtBQUNBO0FBSUU7QUFBNkI7QUFEL0I7QUFFRTtBQUFGO0FBQ0E7QUFFQTtBQUFBO0FBRUU7QUFBRjtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUU7QUFBRjtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUU7QUFBRjtBQUVFO0FBQUY7QUFFSTtBQUFKO0FBR0U7QUFERjtBQUdJO0FBREo7QUFHTTtBQUROO0FBR007QUFETjtBQUdNO0FBQTZFO0FBQW5GO0FBQ0E7QUFFSTtBQUFKO0FBRUk7QUFBSjtBQUVJO0FBQUo7QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBSUU7QUFGRjtBQUtJO0FBSEo7QUFLTTtBQUhOO0FBS007QUFITjtBQUtNO0FBQTZFO0FBRm5GO0FBQ0E7QUFDQTtBQUlJO0FBRko7QUFJSTtBQUF1QjtBQUQzQjtBQUNBO0FBRUk7QUFBSjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBQ0E7QUFDQTtBQUlFO0FBRkY7QUFDQTtBQUlBO0FBRkE7QUFDQTtBQUlFO0FBRkY7QUFJRTtBQUZGO0FBSUU7QUFGRjtBQUlFO0FBRkY7QUFJRTtBQUZGO0FBSUU7QUFGRjtBQUlJO0FBRko7QUFJTTtBQUZOO0FBQ0E7QUFDQTtBQUtFO0FBSEY7QUFLSTtBQUhKO0FBS0k7QUFBcUM7QUFGekM7QUFFeUY7QUFBekY7QUFDQTtBQUNJO0FBQ0o7QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ0E7QUFHRTtBQURGO0FBR0k7QUFESjtBQUdNO0FBRE47QUFHTTtBQUROO0FBR007QUFBNkU7QUFBbkY7QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUVJO0FBQUo7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBR0U7QUFERjtBQUlJO0FBRko7QUFJTTtBQUZOO0FBSU07QUFGTjtBQUlNO0FBQTZFO0FBRG5GO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFHSTtBQUF1QjtBQUEzQjtBQUNBO0FBQ0k7QUFDSjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUhBO0FBQ0E7QUFLRTtBQUhGO0FBS0U7QUFIRjtBQUtFO0FBSEY7QUFLRTtBQUhGO0FBS0U7QUFIRjtBQUtFO0FBSEY7QUFLSTtBQUhKO0FBS007QUFITjtBQUNBO0FBQ0E7QUFNRTtBQUpGO0FBTUk7QUFKSjtBQU1JO0FBQThCO0FBSGxDO0FBR2tGO0FBRGxGO0FBQ0E7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBSUU7QUFGRjtBQUlJO0FBRko7QUFJTTtBQUZOO0FBSU07QUFGTjtBQUlNO0FBQTZFO0FBRG5GO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFHSTtBQURKO0FBR0k7QUFESjtBQUdNO0FBRE47QUFHTTtBQUROO0FBR007QUFETjtBQUdNO0FBRE47QUFDQTtBQUlFO0FBRkY7QUFLSTtBQUhKO0FBS007QUFITjtBQUtNO0FBSE47QUFLTTtBQUE2RTtBQUZuRjtBQUNBO0FBQ0E7QUFJSTtBQUZKO0FBSUk7QUFBdUI7QUFEM0I7QUFDQTtBQUVJO0FBQUo7QUFFTTtBQUFOO0FBRU07QUFBTjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFKQTtBQUNBO0FBTUU7QUFKRjtBQU1FO0FBSkY7QUFNRTtBQUpGO0FBTUU7QUFKRjtBQUNBO0FBT0E7QUFMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMTRCQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNKO0FBQ1U7QUFDVjtBQUNBO0FBQ0E7QUFDRTtBQUNGO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBV0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBVFo7QUFDQTtBQUNBO0FBV0k7QUFDQTtBQVRKO0FBV1E7QUFDQTtBQUNJO0FBVFo7QUFDQTtBQVNRO0FBQ0E7QUFDSTtBQUNBO0FBUFo7QUFDQTtBQUNBO0FBQ0E7QUFTSTtBQUNJO0FBUFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVNRO0FBUFI7QUFDQTtBQVNJO0FBUEo7QUFDQTtBQVNBO0FBUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUFvQjtBQUU1QjtBQURRO0FBQW9CO0FBSTVCO0FBSFE7QUFBb0I7QUFNNUI7QUFMUTtBQUFvQjtBQVE1QjtBQUNBO0FBUFE7QUFDQTtBQUNBO0FBQ0E7QUFTUjtBQVBRO0FBQ0E7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBQ0k7QUFTWjtBQVBZO0FBU1o7QUFDQTtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBU0o7QUFDQTtBQUNBO0FBVlE7QUFZUjtBQUNBO0FBVkk7QUFDSTtBQUNJO0FBWVo7QUFWUTtBQVlSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFDQTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFXSjtBQVRRO0FBQ0E7QUFDSTtBQUNBO0FBV1o7QUFUWTtBQUNBO0FBV1o7QUFUWTtBQVdaO0FBQ0E7QUFUUTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFXSjtBQUNBO0FBQ0E7QUFUQTtBQUNJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFDQTtBQVRBO0FBQ0E7QUFDQTtBQUNBO0FBV0E7QUFUQTtBQVdBO0FBVEE7QUFDSTtBQUNJO0FBV1I7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQUNJO0FBQ0k7QUFXUjtBQUNBO0FBQ0E7QUFUQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdKO0FBVEk7QUFXSjtBQVRJO0FBQ0E7QUFDQTtBQVdKO0FBVEk7QUFDQTtBQVdKO0FBVEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdKO0FBQ0E7QUFDQTtBQVRBO0FBQ0k7QUFHQTtBQUNBO0FBU0o7QUFDQTtBQUNBO0FBUEE7QUFDSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBTkk7QUFRSjtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFSSTtBQUNJO0FBVVI7QUFDQTtBQVJJO0FBQ0k7QUFVUjtBQUNBO0FBUkk7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQVVaO0FBQ0E7QUFSSTtBQVVKO0FBQ0E7QUFDQTtBQVJBO0FBVUE7QUFDQTtBQVZJO0FBQ0k7QUFZUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkk7QUFDQTtBQVlKO0FBVkk7QUFDQTtBQUNBO0FBWUo7QUFWSTtBQUNJO0FBQ0E7QUFDSTtBQVlaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQUNJO0FBQ0k7QUFZUjtBQVZJO0FBQ0E7QUFDQTtBQVlKO0FBVkk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBWWhCO0FBQ0E7QUFDQTtBQVZJO0FBWUo7QUFDQTtBQVZBO0FBWUE7QUFDQTtBQVpJO0FBQ0k7QUFjUjtBQUNBO0FBWkk7QUFDSTtBQWNSO0FBQ0E7QUFaSTtBQUNJO0FBY1I7QUFaUTtBQWNSO0FBQ0E7QUFaSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBY1o7QUFDQTtBQVpRO0FBY1I7QUFDQTtBQVpJO0FBY0o7QUFDQTtBQUNBO0FBWkE7QUFDSTtBQUNBO0FBQ0k7QUFjUjtBQUNBO0FBWkk7QUFDQTtBQUNBO0FBY0o7QUFaSTtBQUNJO0FBQ0E7QUFjUjtBQUNBO0FBWkk7QUFjSjtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBY0E7QUFaUTtBQUNBO0FBQ0k7QUFjWjtBQUNBO0FBWlE7QUFDSTtBQWNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF6Qkk7QUEyQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBCSTtBQXNCSjtBQXBCQTtBQUNJO0FBQ0k7QUFzQlI7QUFwQkk7QUFDSTtBQXNCUjtBQXBCSTtBQXNCSjtBQXJCUTtBQUNJO0FBdUJaO0FBQ0E7QUFyQkk7QUF1Qko7QUFDQTtBQXJCQTtBQXVCQTtBQUNBO0FBdkJJO0FBQ0k7QUF5QlI7QUF2Qkk7QUFDSTtBQXlCUjtBQXZCSTtBQXlCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkJBO0FBQ0k7QUF5Qko7QUFDQTtBQUNBO0FBdkJBO0FBeUJBO0FBQ0E7QUF6Qkk7QUFDSTtBQTJCUjtBQXpCSTtBQUNJO0FBMkJSO0FBekJJO0FBMkJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2QkE7QUFDSTtBQUNBO0FBQ0k7QUF5QlI7QUF2Qkk7QUFDQTtBQUNJO0FBeUJSO0FBQ0E7QUFDQTtBQUNBO0FBdkJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBeUJaO0FBdkJZO0FBeUJaO0FBdkJZO0FBeUJaO0FBdkJZO0FBeUJaO0FBQ0E7QUF2Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBeUJaO0FBQ0E7QUF2Qkk7QUFDSTtBQXlCUjtBQXZCWTtBQXlCWjtBQXZCZ0I7QUFBeUM7QUEwQnpEO0FBQ0E7QUF6QmdCO0FBMkJoQjtBQXpCZ0I7QUFDSTtBQTJCcEI7QUFDQTtBQXpCZ0I7QUFDSTtBQTJCcEI7QUFDQTtBQXpCZ0I7QUEyQmhCO0FBekJnQjtBQTJCaEI7QUF6QmdCO0FBMkJoQjtBQXpCZ0I7QUEyQmhCO0FBekJnQjtBQTJCaEI7QUFDQTtBQUNBO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBQ0E7QUF4QkE7QUEwQkE7QUF4Qkk7QUFDQTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0E7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0k7QUEwQlI7QUF4QlE7QUEwQlI7QUF4Qkk7QUFDSTtBQUNJO0FBMEJaO0FBQ0E7QUFDQTtBQXhCSTtBQUF5QztBQTJCN0M7QUFDQTtBQTFCSTtBQTRCSjtBQTFCSTtBQUNJO0FBNEJSO0FBQ0E7QUExQkk7QUFDSTtBQTRCUjtBQUNBO0FBMUJJO0FBNEJKO0FBMUJJO0FBNEJKO0FBMUJJO0FBNEJKO0FBMUJJO0FBNEJKO0FBQ0E7QUExQkk7QUE0Qko7QUFDQTtBQUNBO0FBMUJBO0FBQ0k7QUFDQTtBQUNJO0FBNEJSO0FBMUJJO0FBQ0E7QUFDSTtBQTRCUjtBQTFCSTtBQUNJO0FBNEJSO0FBMUJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBNEJaO0FBMUJZO0FBNEJaO0FBMUJZO0FBNEJaO0FBMUJZO0FBNEJaO0FBQ0E7QUExQkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBNEJaO0FBQ0E7QUFDQTtBQUNBO0FBMUJJO0FBQ0k7QUFDSTtBQUNJO0FBNEJoQjtBQUNBO0FBMUJRO0FBQ0k7QUE0Qlo7QUExQlE7QUFDQTtBQTRCUjtBQTFCSTtBQTRCSjtBQUNBO0FBekJBO0FBQ0k7QUFDQTtBQUNJO0FBMkJSO0FBekJJO0FBQ0E7QUFDSTtBQTJCUjtBQXpCSTtBQUNJO0FBMkJSO0FBekJJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUEyQlo7QUF6Qlk7QUEyQlo7QUFDQTtBQUNBO0FBQ0E7QUF6Qkk7QUFDSTtBQTJCUjtBQUNBO0FBQ0E7QUFDQTtBQXpCSTtBQTJCSjtBQUNBO0FBQ0E7QUF6QkE7QUFDSTtBQUNBO0FBQ0k7QUEyQlI7QUFDQTtBQXpCSTtBQTJCSjtBQXpCSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQTJCWjtBQXhCWTtBQTBCWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBeEJZO0FBMEJaO0FBQ0E7QUFDQTtBQXhCSTtBQTBCSjtBQXhCUTtBQUF5QztBQTJCakQ7QUFDQTtBQTFCUTtBQTRCUjtBQTFCUTtBQUNJO0FBNEJaO0FBQ0E7QUExQlE7QUFDSTtBQTRCWjtBQUNBO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBMUJRO0FBNEJSO0FBMUJJO0FBNEJKO0FBQ0E7QUExQkE7QUFDSTtBQUNBO0FBQ0k7QUE0QlI7QUFDQTtBQTFCSTtBQUNBO0FBNEJKO0FBMUJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBNEJaO0FBekJZO0FBMkJaO0FBeEJZO0FBMEJaO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBMEJBO0FBeEJJO0FBQ0k7QUEwQlI7QUFDQTtBQXhCWTtBQTBCWjtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUF4QkE7QUFDSTtBQUNBO0FBQ0k7QUEwQlI7QUFDQTtBQXhCSTtBQUNJO0FBMEJSO0FBQ0E7QUFDQTtBQXhCSTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBQ0k7QUEwQlo7QUFDQTtBQXhCUTtBQUNJO0FBMEJaO0FBeEJRO0FBQ0k7QUFDSTtBQTBCaEI7QUFDQTtBQXhCWTtBQUNJO0FBMEJoQjtBQXhCWTtBQTBCWjtBQXhCZ0I7QUFDQTtBQUNJO0FBQ0k7QUEwQnhCO0FBeEJ3QjtBQTBCeEI7QUFDQTtBQXhCZ0I7QUEwQmhCO0FBeEJvQjtBQTBCcEI7QUFDQTtBQXhCZ0I7QUFDSTtBQTBCcEI7QUF4QndCO0FBQ0E7QUEwQnhCO0FBQ0E7QUF4QmdCO0FBQ0k7QUFBd0M7QUEyQjVEO0FBMUJvQjtBQUNJO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUE0QnBDO0FBQ0E7QUFDQTtBQTFCd0I7QUE0QnhCO0FBMUJvQjtBQTRCcEI7QUExQmdCO0FBNEJoQjtBQUNBO0FBQ0E7QUExQkk7QUFDSTtBQUF3QztBQTZCaEQ7QUE1QlE7QUFDSTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBOEJ4QjtBQUNBO0FBQ0E7QUE1Qlk7QUE4Qlo7QUE1QlE7QUE4QlI7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBNUJBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBOEJaO0FBNUJRO0FBQ0k7QUE4Qlo7QUE1QlE7QUFDQTtBQThCUjtBQTVCWTtBQThCWjtBQTVCZ0I7QUFDSTtBQUNJO0FBOEJ4QjtBQTVCNEI7QUFDSTtBQThCaEM7QUE1QjRCO0FBOEI1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1QmdCO0FBQ0k7QUFDSTtBQThCeEI7QUE1Qm9CO0FBQ0k7QUE4QnhCO0FBNUJvQjtBQUNBO0FBOEJwQjtBQTVCd0I7QUFDSTtBQUNJO0FBQ0k7QUE4QnBDO0FBNUJ3QztBQUNJO0FBOEI1QztBQTVCd0M7QUE4QnhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1QjRCO0FBOEI1QjtBQTVCNEI7QUE4QjVCO0FBNUJnQztBQThCaEM7QUE1QmdDO0FBQTZCO0FBK0I3RDtBQUNBO0FBOUJnQztBQWdDaEM7QUE5QmdDO0FBZ0NoQztBQUNBO0FBOUI0QjtBQWdDNUI7QUFDQTtBQTlCd0I7QUFnQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBOUJZO0FBZ0NaO0FBQ0E7QUFDQTtBQTlCSTtBQUNJO0FBZ0NSO0FBOUJJO0FBQ0k7QUFnQ1I7QUFDQTtBQUNBO0FBOUJBO0FBQ0k7QUFDQTtBQUNJO0FBZ0NSO0FBOUJJO0FBQ0k7QUFnQ1I7QUE5Qkk7QUFDQTtBQUNJO0FBZ0NSO0FBQ0E7QUE5Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFnQ0o7QUEvQlE7QUFpQ1I7QUFDQTtBQS9CSTtBQWlDSjtBQWhDUTtBQWtDUjtBQWhDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQWtDWjtBQUNBO0FBakNZO0FBbUNaO0FBQ0E7QUFDQTtBQWpDSTtBQW1DSjtBQWxDUTtBQUNBO0FBQ0k7QUFvQ1o7QUFsQ1E7QUFDSTtBQW9DWjtBQW5DZ0I7QUFxQ2hCO0FBQ0E7QUFuQ1k7QUFDQTtBQUNJO0FBQ0E7QUFxQ2hCO0FBcENvQjtBQXNDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcENvQjtBQXNDcEI7QUFDQTtBQUNBO0FBbkNZO0FBcUNaO0FBcENnQjtBQXNDaEI7QUFyQ29CO0FBdUNwQjtBQXJDZ0I7QUFDQTtBQXVDaEI7QUFDQTtBQXJDWTtBQUNJO0FBdUNoQjtBQXRDb0I7QUF3Q3BCO0FBQ0E7QUF0Q1k7QUF3Q1o7QUF2Q2dCO0FBeUNoQjtBQUNBO0FBdkNnQjtBQXlDaEI7QUFDQTtBQXZDUTtBQXlDUjtBQXhDWTtBQUNBO0FBMENaO0FBQ0E7QUF4Q1k7QUEwQ1o7QUFDQTtBQUNBO0FBeENJO0FBQ0E7QUEwQ0o7QUF6Q1E7QUFDQTtBQUNBO0FBMkNSO0FBekNRO0FBQ0E7QUEyQ1I7QUF6Q0k7QUFDQTtBQUNJO0FBQ0k7QUEyQ1o7QUFDQTtBQXpDUTtBQTJDUjtBQXpDSTtBQTJDSjtBQUNBO0FBekNBO0FBMkNBO0FBQ0E7QUEzQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQTZDUjtBQTNDSTtBQUNJO0FBQ0E7QUE2Q1I7QUEzQ1E7QUFDSTtBQUNBO0FBQ0k7QUE2Q2hCO0FBM0NZO0FBNkNaO0FBMUNRO0FBQ0E7QUE0Q1I7QUExQ0k7QUE0Q0o7QUFDQTtBQTFDQTtBQUNJO0FBNENKO0FBQ0E7QUF6Q0E7QUFDSTtBQUNBO0FBQ0k7QUEyQ1I7QUF6Q0k7QUFDQTtBQUNJO0FBMkNSO0FBekNJO0FBMkNKO0FBekNJO0FBQ0E7QUFDSTtBQUNBO0FBMkNSO0FBQ0E7QUF6Q0k7QUFDSTtBQTJDUjtBQUNBO0FBekNJO0FBQ0k7QUEyQ1I7QUFDQTtBQXpDSTtBQUNBO0FBQ0E7QUEyQ0o7QUF6Q0k7QUFDSTtBQTJDUjtBQUNBO0FBekNJO0FBMkNKO0FBQ0E7QUFDQTtBQXpDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBMkNaO0FBekNRO0FBMkNSO0FBQ0E7QUF6Q0k7QUEyQ0o7QUFDQTtBQUNBO0FBekNBO0FBQ0k7QUEyQ0o7QUFDQTtBQUNBO0FBdkNBO0FBQ0k7QUFDQTtBQUNJO0FBeUNSO0FBQ0E7QUF2Q0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUF5Q1o7QUFDQTtBQXZDSTtBQXlDSjtBQUNBO0FBQ0E7QUF0Q0E7QUFDSTtBQUNBO0FBQ0k7QUF3Q1I7QUF0Q0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUF3Q1o7QUFDQTtBQUNBO0FBdENJO0FBd0NKO0FBQ0E7QUFDQTtBQUNBO0FBckNBO0FBQ0k7QUFDQTtBQUNJO0FBdUNSO0FBckNJO0FBQ0E7QUFDSTtBQXVDUjtBQXJDSTtBQUNBO0FBQ0E7QUFDSTtBQXVDUjtBQUNBO0FBckNJO0FBQ0k7QUF1Q1I7QUFDQTtBQXJDSTtBQUNJO0FBdUNSO0FBQ0E7QUFyQ0k7QUFHSTtBQXFDUjtBQUNBO0FBbkNJO0FBcUNKO0FBQ0E7QUFDQTtBQUNBO0FBbENBO0FBQ0k7QUFDQTtBQUNJO0FBb0NSO0FBbENJO0FBQ0E7QUFDQTtBQUNBO0FBb0NKO0FBbENJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFvQ2hCO0FBbENZO0FBb0NaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFsQ0k7QUFvQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDSTtBQUNJO0FBbUNaO0FBakNRO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNBO0FBQ0k7QUFtQ1I7QUFqQ0k7QUFDQTtBQUNBO0FBbUNKO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQW1DaEI7QUFqQ1k7QUFtQ1o7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNBO0FBQ0k7QUFtQ1I7QUFDQTtBQWpDSTtBQUNJO0FBQ0k7QUFtQ1o7QUFqQ1E7QUFtQ1I7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBakNJO0FBQ0k7QUFtQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0k7QUFtQ1I7QUFDQTtBQWpDSTtBQUNJO0FBbUNSO0FBakNRO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDQTtBQUNBO0FBQ0E7QUFtQ0o7QUFqQ0k7QUFDSTtBQUNJO0FBQ0E7QUFtQ1o7QUFDQTtBQWpDUTtBQUNBO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDQTtBQW1DSjtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNBO0FBQ0k7QUFtQ1I7QUFDQTtBQUNBO0FBQ0E7QUFqQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBbUNoQjtBQWpDWTtBQW1DWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDSTtBQUNJO0FBbUNaO0FBQ0E7QUFqQ1E7QUFtQ1I7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBakNJO0FBQ0k7QUFtQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0k7QUFtQ1I7QUFDQTtBQWpDSTtBQUNBO0FBQ0k7QUFDSTtBQW1DWjtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0k7QUFtQ1I7QUFDQTtBQWpDSTtBQUNBO0FBbUNKO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0E7QUFDSTtBQW1DUjtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQUNBO0FBQ0E7QUFDQTtBQW1DSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFtQ2hCO0FBakNZO0FBbUNaO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDSTtBQW1DUjtBQWpDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0k7QUFtQ1I7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJBO0FBQ0k7QUFDUTtBQThCWjtBQTVCUTtBQThCUjtBQTVCSTtBQUNJO0FBQ0k7QUFDQTtBQThCWjtBQTVCUTtBQThCUjtBQUNBO0FBNUJJO0FBOEJKO0FBQ0E7QUE1QkE7QUFDSTtBQUNRO0FBOEJaO0FBNUJRO0FBOEJSO0FBNUJJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQThCWjtBQTVCUTtBQThCUjtBQUNBO0FBNUJJO0FBOEJKO0FBQ0E7QUFDQTtBQTVCQTtBQUNJO0FBQ0E7QUE4Qko7QUFDQTtBQTVCQTtBQThCQTtBQUNBO0FBOUJJO0FBQ0k7QUFnQ1I7QUE5Qkk7QUFnQ0o7QUFDQTtBQTlCQTtBQWdDQTtBQUNBO0FBQ0E7QUFqQ0k7QUFDQTtBQUNJO0FBbUNSO0FBakNRO0FBQ0E7QUFDQTtBQUNJO0FBbUNaO0FBQ0E7QUFqQ1E7QUFDSTtBQW1DWjtBQUNBO0FBakNRO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBbUNBO0FBakNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQW1DUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3p5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ1E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFEUTtBQUNBO0FBR1I7QUFEUTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBR3BCO0FBQ0E7QUFDQTtBQUNBO0FBRFE7QUFHUjtBQUNBO0FBREk7QUFHSjtBQURRO0FBR1I7QUFEUTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBR1Y7QUFEVTtBQUdWO0FBQ0E7QUFEUTtBQUNBO0FBQ0U7QUFDQTtBQUdWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRUE7QUFDRTtBQUNBO0FBQ0Y7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNOO0FBQ0k7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNJO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFBSTtBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQUk7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUVKO0FBQ0E7QUFBRTtBQUNFO0FBRUo7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDRTtBQUNFO0FBRUo7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDRTtBQUNFO0FBRUo7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDRTtBQUNFO0FBR0o7QUFDQTtBQUZJO0FBSUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDRTtBQUNFO0FBSUo7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFDRTtBQUNFO0FBS0o7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDRTtBQUNFO0FBTUo7QUFDQTtBQUpFO0FBQ0U7QUFNSjtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDRTtBQUNFO0FBTUo7QUFDQTtBQUpFO0FBQ0U7QUFNSjtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBTlE7QUFDSTtBQVFaO0FBTlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBUVo7QUFOUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFRUjtBQU5RO0FBQ0E7QUFDQTtBQUNJO0FBUVo7QUFOZ0I7QUFDSTtBQVFwQjtBQU5nQjtBQVFoQjtBQUxnQjtBQUNBO0FBQ0k7QUFDQTtBQU9wQjtBQUxnQjtBQU9oQjtBQUNBO0FBTFE7QUFPUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0U7QUFDRTtBQU1KO0FBQ0E7QUFKRTtBQUNFO0FBTUo7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDalFBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNaO0FBQ1E7QUFDQztBQUNBO0FBQ1Q7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0M7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNaO0FBQ1k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNoQjtBQUNZO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ1E7QUFDUjtBQUFNO0FBQ0E7QUFDTTtBQUVJO0FBQ0E7QUFDQTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUVRO0FBQ0E7QUFBUjtBQUNBO0FBRVE7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUFaO0FBRWdCO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUR4QjtBQUNBO0FBQ0E7QUFDQTtBQUdnQjtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFGeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlRO0FBRlI7QUFDQTtBQUNBO0FBQ0E7QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUNBO0FBSFI7QUFDQTtBQUtJO0FBQ0k7QUFDSTtBQUNBO0FBSFo7QUFDQTtBQUtRO0FBQ0E7QUFIUjtBQUNBO0FBS0k7QUFDSTtBQUhSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ2hCO0FBQ1k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRFI7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBR0k7QUFESjtBQUNBO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRFE7QUFDSTtBQUdaO0FBRFE7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBR1I7QUFEUTtBQUNJO0FBQ0k7QUFHaEI7QUFDQTtBQURZO0FBQ0k7QUFHaEI7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBR1I7QUFEUTtBQUNBO0FBQ0k7QUFHWjtBQUNBO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUdSO0FBRFE7QUFDQTtBQUNJO0FBR1o7QUFEUTtBQUNJO0FBR1o7QUFEUTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNJO0FBRVo7QUFBZ0I7QUFFaEI7QUFBWTtBQUNBO0FBRVo7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25PQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFDQTtBQUdZO0FBRFo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBRVE7QUFDSTtBQUNJO0FBQWhCO0FBRWdCO0FBQWhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNNO0FBQ0U7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDTTtBQUNFO0FBQ0U7QUFDVjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDVTtBQUNWO0FBQ0E7QUFDUTtBQUNFO0FBQ0E7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQW9EO0FBRTVEO0FBRFE7QUFBa0U7QUFJMUU7QUFIUTtBQUNBO0FBS1I7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBb0Q7QUFNNUQ7QUFMUTtBQUFrRTtBQVExRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQSTtBQUNJO0FBQ0k7QUFTWjtBQUNBO0FBUFE7QUFTUjtBQVBJO0FBQ0k7QUFDSTtBQVNaO0FBUFE7QUFDSTtBQVNaO0FBUFk7QUFDSTtBQVNoQjtBQVBnQjtBQVNoQjtBQUNBO0FBQ0E7QUFQSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFTWjtBQUNBO0FBUFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQUTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBU2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFTWjtBQUNBO0FBUFE7QUFDQTtBQVNSO0FBQ0E7QUFQSTtBQVNKO0FBQ0E7QUFUUTtBQUNJO0FBV1o7QUFUUTtBQUNJO0FBV1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRJO0FBQ0k7QUFDSTtBQVdaO0FBQ0E7QUFUUTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBV0o7QUFDQTtBQVhRO0FBQ0k7QUFhWjtBQUNBO0FBWFE7QUFDSTtBQWFaO0FBQ0E7QUFYSTtBQUNJO0FBQ0k7QUFhWjtBQVhRO0FBQ0s7QUFhYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEk7QUFDSTtBQWFSO0FBWFE7QUFDSTtBQWFaO0FBQ0E7QUFDQTtBQUNBO0FBWEk7QUFDSTtBQWFSO0FBQ0E7QUFYSTtBQUNJO0FBQ0k7QUFhWjtBQVhRO0FBQ0k7QUFhWjtBQVhRO0FBQ0E7QUFhUjtBQUNBO0FBWEk7QUFDSTtBQWFSO0FBQ0E7QUFYSTtBQWFKO0FBQ0E7QUFiUTtBQUNJO0FBZVo7QUFDQTtBQWJRO0FBQ0E7QUFlUjtBQUNBO0FBYkk7QUFDSTtBQUNJO0FBZVo7QUFDQTtBQWJRO0FBQ0E7QUFlUjtBQUNBO0FBQ0E7QUFiSTtBQUNJO0FBQ0k7QUFlWjtBQUNBO0FBYlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQUNBO0FBWlE7QUFDSTtBQWNaO0FBQ0E7QUFDQTtBQVZJO0FBWUo7QUFWUTtBQVlSO0FBVlE7QUFZUjtBQVZRO0FBWVI7QUFWWTtBQVlaO0FBVlk7QUFZWjtBQVZ5RDtBQVl6RDtBQUNBO0FBWFE7QUFhUjtBQVhRO0FBQThDO0FBY3REO0FBZDRHO0FBZ0I1RztBQUNBO0FBZlE7QUFpQlI7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZmdCO0FBaUJoQjtBQWZnQjtBQWlCaEI7QUFmZ0I7QUFpQmhCO0FBZm9CO0FBQVU7QUFrQjlCO0FBQ0E7QUFqQm9CO0FBbUJwQjtBQWpCb0I7QUFtQnBCO0FBakJvQjtBQW1CcEI7QUFqQm9CO0FBbUJwQjtBQUNBO0FBaEJnQjtBQWtCaEI7QUFDQTtBQWZZO0FBaUJaO0FBQ0E7QUFmUTtBQUNBO0FBQ0E7QUFpQlI7QUFmUTtBQWlCUjtBQWZRO0FBQ0E7QUFDQTtBQWlCUjtBQUNBO0FBZlE7QUFDQTtBQUNBO0FBaUJSO0FBQ0E7QUFmUTtBQUNBO0FBaUJSO0FBZFE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQWdCWjtBQWJZO0FBZVo7QUFDQTtBQUNBO0FBWkk7QUFjSjtBQVpRO0FBY1I7QUFaUTtBQWNSO0FBWlE7QUFjUjtBQVpRO0FBY1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFjaEI7QUFaZ0I7QUFjaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFaSTtBQUNJO0FBQ0k7QUFjWjtBQVpRO0FBQ0E7QUFDQTtBQUNBO0FBY1I7QUFDQTtBQVpRO0FBQ0E7QUFDQTtBQUNBO0FBQXlDO0FBZWpEO0FBZFE7QUFBdUM7QUFpQi9DO0FBaEJRO0FBa0JSO0FBQ0E7QUFoQlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQXlDO0FBbUJqRDtBQWxCUTtBQUF1QztBQXFCL0M7QUFwQlE7QUFzQlI7QUFwQlE7QUFDQTtBQXNCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFuQkk7QUFDSTtBQUNJO0FBcUJaO0FBQ0E7QUFuQlE7QUFxQlI7QUFuQlE7QUFxQlI7QUFuQlE7QUFBK0M7QUFzQnZEO0FBQ0E7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlk7QUF1Qlo7QUFyQmdCO0FBdUJoQjtBQXJCZ0I7QUF1QmhCO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQXJCZ0I7QUF1QmhCO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQXJCZ0I7QUF1QmhCO0FBQ0E7QUFwQlk7QUFzQlo7QUFDQTtBQUNBO0FBQ0E7QUFsQkk7QUFDSTtBQUNJO0FBb0JaO0FBQ0E7QUFsQlE7QUFDQTtBQW9CUjtBQUNBO0FBbEJJO0FBQ0k7QUFDSTtBQW9CWjtBQUNBO0FBbEJRO0FBQ0E7QUFvQlI7QUFDQTtBQWxCSTtBQUNJO0FBQ0k7QUFvQlo7QUFDQTtBQWxCUTtBQUNBO0FBb0JSO0FBQ0E7QUFsQkk7QUFDSTtBQUNJO0FBb0JaO0FBbEJRO0FBQ0E7QUFvQlI7QUFDQTtBQWxCSTtBQUNJO0FBQ0k7QUFvQlo7QUFsQlE7QUFDQTtBQW9CUjtBQWxCUTtBQW9CUjtBQUNBO0FBbEJJO0FBQ0k7QUFvQlI7QUFDQTtBQWxCSTtBQUNJO0FBb0JSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdmtCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBQ0E7QUFBTTtBQUNBO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFBTTtBQUVOO0FBQU07QUFDQTtBQUNBO0FBQ0E7QUFFTjtBQUFVO0FBRVY7QUFBUTtBQUVSO0FBQ0E7QUFBSTtBQUNFO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1R0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ2hCO0FBRWdCO0FBQ0E7QUFDQTtBQUFoQjtBQUNBO0FBRVE7QUFBUjtBQUNZO0FBQ0k7QUFDQTtBQUNBO0FBQ2hCO0FBRWdCO0FBQ0E7QUFDQTtBQUFoQjtBQUVZO0FBQVo7QUFDQTtBQUVJO0FBQUo7QUFDTTtBQUNFO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDQTtBQUFZO0FBQ0E7QUFFWjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQU07QUFDRTtBQUNBO0FBRVI7QUFBUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUVaO0FBQVE7QUFDSTtBQUVaO0FBQVE7QUFDSTtBQUVaO0FBQ0E7QUFEWTtBQUNBO0FBR1o7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUVKO0FBRE07QUFDQTtBQUNBO0FBR047QUFESTtBQUdKO0FBRk07QUFDQTtBQUNFO0FBQ0Y7QUFDRTtBQUNFO0FBQ0E7QUFJVjtBQUZRO0FBQ0U7QUFJVjtBQUZRO0FBSVI7QUFDQTtBQUZJO0FBSUo7QUFITTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFLUjtBQUhRO0FBQ0E7QUFLUjtBQUhNO0FBS047QUFISTtBQUtKO0FBQ0E7QUFISTtBQUNFO0FBS047QUFITTtBQUNBO0FBS047QUFITTtBQUNBO0FBS047QUFITTtBQUNBO0FBS047QUFDQTtBQUhJO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFLUjtBQUNBO0FBSE07QUFDRTtBQUNBO0FBS1I7QUFDQTtBQUNBO0FBSEk7QUFLSjtBQURJO0FBQ0U7QUFDRTtBQUdSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzTEE7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBR0k7QUFDRTtBQUNFO0FBRFI7QUFDQTtBQUdNO0FBQ0E7QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDSjtBQUNNO0FBQ0U7QUFDQTtBQUNBO0FBQ1I7QUFDTTtBQUNOO0FBQ0k7QUFDQTtBQUNFO0FBQ0U7QUFDUjtBQUNNO0FBQ0E7QUFDRTtBQUNSO0FBQ007QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNNO0FBQ0E7QUFDTjtBQUFRO0FBRVI7QUFBTTtBQUVOO0FBQU07QUFDRTtBQUVSO0FBQU07QUFDQTtBQUNFO0FBQ0U7QUFFVjtBQUNBO0FBQU07QUFFTjtBQUFJO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFFUjtBQUNBO0FBQU07QUFFTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQztBQUNDO0FBQ0E7QUFFRjtBQUFHO0FBQ0M7QUFDQTtBQUNBO0FBRUo7QUFBRztBQUVIO0FBQUU7QUFDQTtBQUNDO0FBQ0M7QUFFSjtBQUFHO0FBQ0E7QUFDQztBQUVKO0FBQUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFFSjtBQUFLO0FBQ0E7QUFFTDtBQURNO0FBR047QUFDQTtBQUNBO0FBREc7QUFDQTtBQUNBO0FBQ0M7QUFHSjtBQURHO0FBQ0E7QUFDQztBQUNDO0FBR0w7QUFDQTtBQURHO0FBR0g7QUFERTtBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBR0o7QUFDQTtBQURHO0FBR0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9IQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0U7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBQ0U7QUFDQTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBRFI7QUFHTTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFESjtBQUNBO0FBR1k7QUFDQTtBQUNBO0FBQ0E7QUFEWjtBQUNBO0FBQ0E7QUFHWTtBQURaO0FBR1k7QUFDSTtBQURoQjtBQUdZO0FBQ0k7QUFEaEI7QUFDQTtBQUNBO0FBSUk7QUFDSTtBQUNBO0FBQ0k7QUFBUTtBQUF5QjtBQUFrQjtBQUMzQztBQUEwQjtBQUFrQjtBQUV4RDtBQUVSO0FBQ0E7QUFBSTtBQUVKO0FBRFE7QUFDSTtBQUNJO0FBR2hCO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBR0o7QUFEUTtBQUdSO0FBRFE7QUFHUjtBQURRO0FBQStDO0FBSXZEO0FBQ0E7QUFIUTtBQUtSO0FBSEk7QUFLSjtBQUhZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLWjtBQUhZO0FBQ0k7QUFLaEI7QUFIWTtBQUNJO0FBS2hCO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUErQjtBQU12QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFDQTtBQUErQztBQVF2RDtBQUNBO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQWTtBQVNaO0FBUFk7QUFTWjtBQVBZO0FBU1o7QUFQZ0I7QUFTaEI7QUFDQTtBQU5nQjtBQVFoQjtBQUNBO0FBTFk7QUFPWjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBS0o7QUFIUTtBQUtSO0FBSFE7QUFLUjtBQUhRO0FBQStDO0FBTXZEO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFBK0Q7QUFRdkU7QUFDQTtBQVBRO0FBQThEO0FBVXRFO0FBQ0E7QUFUUTtBQUE0RDtBQVlwRTtBQUNBO0FBWFE7QUFBMEQ7QUFjbEU7QUFDQTtBQWJRO0FBZVI7QUFieUQ7QUFlekQ7QUFmeUc7QUFpQnpHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZRO0FBQ0E7QUFpQlI7QUFmUTtBQWlCUjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBQ0E7QUFoQlk7QUFDSTtBQWtCaEI7QUFoQm9CO0FBa0JwQjtBQWhCb0I7QUFrQnBCO0FBaEJvQjtBQWtCcEI7QUFoQndCO0FBa0J4QjtBQWhCd0I7QUFrQnhCO0FBaEJ3QjtBQWtCeEI7QUFoQjRCO0FBa0I1QjtBQWhCNEI7QUFrQjVCO0FBaEI0QjtBQWtCNUI7QUFoQjRCO0FBa0I1QjtBQWhCNEI7QUFrQjVCO0FBaEI0QjtBQWtCNUI7QUFDQTtBQUNBO0FBQ0E7QUFkZ0I7QUFnQmhCO0FBZGdCO0FBZ0JoQjtBQWRvQjtBQWdCcEI7QUFkb0I7QUFnQnBCO0FBZG9CO0FBZ0JwQjtBQWRvQjtBQWdCcEI7QUFkb0I7QUFnQnBCO0FBZHdCO0FBZ0J4QjtBQWR3QjtBQWdCeEI7QUFDQTtBQUNBO0FBYmdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQWU1QjtBQWI0QjtBQWU1QjtBQWJ3QjtBQUNJO0FBZTVCO0FBQ0E7QUFib0I7QUFDSTtBQUNBO0FBZXhCO0FBQ0E7QUFDQTtBQWJnQjtBQUNJO0FBQ0E7QUFDQTtBQWVwQjtBQWJvQjtBQWVwQjtBQWJvQjtBQWVwQjtBQWJvQjtBQWVwQjtBQWJvQjtBQWVwQjtBQWJvQjtBQWVwQjtBQWJvQjtBQWVwQjtBQUNBO0FBQ0E7QUFaWTtBQWNaO0FBQ0E7QUFDQTtBQVZJO0FBWUo7QUFDQTtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYWTtBQWFaO0FBWGdCO0FBYWhCO0FBWGdCO0FBYWhCO0FBWGdCO0FBYWhCO0FBWGdCO0FBYWhCO0FBQ0E7QUFDQTtBQVRRO0FBV1I7QUFUUTtBQVdSO0FBVFE7QUFXUjtBQVRRO0FBV1I7QUFDQTtBQVJJO0FBQ0k7QUFDQTtBQVVSO0FBQ0E7QUFSSTtBQUNJO0FBQ0k7QUFVWjtBQVJZO0FBQ0k7QUFVaEI7QUFDQTtBQVJrQjtBQVVsQjtBQUNBO0FBQ0E7QUFSSTtBQUNJO0FBVVI7QUFSSTtBQUNFO0FBQ0k7QUFVVjtBQUNBO0FBUlU7QUFVVjtBQUNBO0FBQ0E7QUFSSTtBQUNJO0FBVVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUmdCO0FBQ0k7QUFDQTtBQUVJO0FBRUk7QUFRNUI7QUFOd0I7QUFFSTtBQU81QjtBQUNBO0FBTG9CO0FBT3BCO0FBQ0E7QUFMZ0I7QUFDSTtBQU9wQjtBQUxvQjtBQUNJO0FBT3hCO0FBQ0E7QUFMb0I7QUFPcEI7QUFDQTtBQUNBO0FBQ0E7QUFOZ0I7QUFRaEI7QUFOb0I7QUFRcEI7QUFDQTtBQUNBO0FBTm9CO0FBQ0k7QUFReEI7QUFDQTtBQU5vQjtBQUNJO0FBQ0k7QUFRNUI7QUFONEI7QUFRNUI7QUFDQTtBQUNBO0FBTm9CO0FBUXBCO0FBQ0E7QUFOZ0I7QUFDSTtBQVFwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOb0I7QUFDSTtBQVF4QjtBQUNBO0FBTm9CO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFReEI7QUFOd0I7QUFDSTtBQUNBO0FBUTVCO0FBTndCO0FBQ0k7QUFRNUI7QUFDQTtBQUNBO0FBTm9CO0FBUXBCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTlE7QUFDQTtBQVFSO0FBTlE7QUFDQTtBQUNJO0FBUVo7QUFDQTtBQU5RO0FBUVI7QUFOUTtBQVFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcmdCQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNFO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNFO0FBQ0E7QUFDQTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNFO0FBRFI7QUFDQTtBQUdNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFETjtBQUdNO0FBQ0E7QUFDQTtBQUROO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlEQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuREE7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0k7QUFDQTtBQUNBO0FBRFI7QUFHUTtBQUNFO0FBRFY7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFDRTtBQURWO0FBQ0E7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFEVjtBQUNBO0FBQ0E7QUFHUTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBRFY7QUFDQTtBQUNBO0FBR1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFHUTtBQUNFO0FBRFY7QUFDQTtBQUdRO0FBQ0U7QUFEVjtBQUNBO0FBR0k7QUFDRTtBQUROO0FBQ0E7QUFHSTtBQURKO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQURSO0FBR1E7QUFDQTtBQUNFO0FBRFY7QUFDQTtBQUNBO0FBR0k7QUFESjtBQUtJO0FBQ0k7QUFIUjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFLSTtBQUNFO0FBSE47QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFLSTtBQUNFO0FBSE47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBR0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFDQTtBQUNBO0FBRFI7QUFHUTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRFI7QUFHUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBRFo7QUFHUTtBQUNJO0FBQ0k7QUFEaEI7QUFDQTtBQUdRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFEWjtBQUdRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURaO0FBQ0E7QUFJSTtBQUZKO0FBR1E7QUFEUjtBQWNJO0FBWko7QUFhUTtBQVhSO0FBd0JJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXRCUjtBQUNBO0FBd0JJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBdEJaO0FBd0JZO0FBdEJaO0FBQ0E7QUF3QlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXRCUjtBQXdCUTtBQUNBO0FBQ0E7QUFDQTtBQXRCUjtBQUNBO0FBc0JRO0FBcEJSO0FBc0JRO0FBcEJSO0FBc0JRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQlo7QUFzQlE7QUFDSTtBQXBCWjtBQXNCUTtBQUNJO0FBcEJaO0FBc0JRO0FBR0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBdEJoQjtBQXdCWTtBQUNJO0FBdEJoQjtBQUNBO0FBQ0E7QUF3QlE7QUFDQTtBQXRCUjtBQUNBO0FBeUJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQXZCWjtBQXlCUTtBQUNJO0FBQ0E7QUFDQTtBQXZCWjtBQXlCUTtBQXZCUjtBQXdCWTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBdEJoQjtBQXdCWTtBQUNJO0FBQ0E7QUF0QmhCO0FBQ0E7QUF5QlE7QUFDSTtBQXZCWjtBQXlCUTtBQUNJO0FBdkJaO0FBeUJRO0FBQ0E7QUF2QlI7QUFDQTtBQTBCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUF4Qlo7QUEwQlE7QUFDSTtBQXhCWjtBQTJCWTtBQXpCWjtBQTRCWTtBQTFCWjtBQTZCWTtBQTNCWjtBQTZCUTtBQUNJO0FBQ0E7QUEzQlo7QUE2QlE7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTNCaEI7QUE2QmdCO0FBM0JoQjtBQUNBO0FBNkJRO0FBQ0E7QUEzQlI7QUFDQTtBQUNBO0FBOEJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1QlI7QUE4QlE7QUE1QlI7QUFDQTtBQTRCUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBMUJaO0FBNEJRO0FBQ0k7QUExQlo7QUE0QlE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQTFCaEI7QUE0Qlk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBMUJoQjtBQUNBO0FBNEJRO0FBQ0E7QUExQlI7QUFDQTtBQTRCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExQlI7QUFDQTtBQUNBO0FBNEJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBMUJSO0FBNEJRO0FBQ0k7QUExQlo7QUE0QlE7QUFDSTtBQUNBO0FBQ0E7QUExQlo7QUE0QlE7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUExQmhCO0FBQ0E7QUE0QlE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBMUJaO0FBNEJRO0FBQ0E7QUExQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pYQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDSTtBQUNKO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFEUTtBQUNJO0FBQVE7QUFBWTtBQUNaO0FBQVk7QUFDWjtBQUFZO0FBQ1o7QUFBWTtBQUV4QjtBQUNJO0FBQVE7QUFBWTtBQUNaO0FBQVk7QUFDWjtBQUFZO0FBRXhCO0FBQ0k7QUFBUTtBQUNSO0FBQVE7QUFBWTtBQUV4QjtBQVlSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1REE7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUROO0FBR007QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQURWO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUNFO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNLO0FBQ0c7QUFDUjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDWjtBQUNZO0FBQ1o7QUFDUTtBQUNSO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDWjtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDWjtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDWjtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDWjtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDWjtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsR0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ1E7QUFDQztBQUNUO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDaEI7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0k7QUFEWjtBQUdRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFEcEI7QUFHb0I7QUFDQTtBQURwQjtBQUdvQjtBQUNBO0FBRHBCO0FBR2dCO0FBQ0E7QUFDSTtBQURwQjtBQUNBO0FBR1E7QUFDSTtBQURaO0FBQ0E7QUFHWTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBRHBCO0FBR2dCO0FBQ0E7QUFEaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFGUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkVBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBS0E7QUFDSTtBQUhSO0FBS0k7QUFDSTtBQUNBO0FBQ0U7QUFIVjtBQUtRO0FBSFI7QUFLSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFIaEI7QUFLWTtBQUNBO0FBQ0E7QUFIWjtBQUNBO0FBS0k7QUFISjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ1I7QUFDUztBQUNUO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ2hCO0FBQ2dCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDcEI7QUFDb0I7QUFDcEI7QUFDZ0I7QUFDaEI7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RFQTtBQUNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRjtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFFSTtBQUFKO0FBQ0E7QUFFRTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQU47QUFFSTtBQUFKO0FBQ0E7QUFFRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFDQTtBQUFOO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBQ007QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFBTTtBQUNFO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUY7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDVjtBQUNVO0FBQ0U7QUFDQTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0E7QUFDRTtBQUNOO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFDTjtBQUVNO0FBQU47QUFHSTtBQURKO0FBQ0E7QUFDQTtBQUdFO0FBQ0U7QUFESjtBQUdJO0FBQ0U7QUFETjtBQUNBO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pWQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0k7QUFDQTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3Q0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNRO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDaEI7QUFDWTtBQUNJO0FBQ2hCO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNaO0FBQ1E7QUFDUjtBQUNRO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ1o7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ1E7QUFDSTtBQUNaO0FBQ1E7QUFDSTtBQUNaO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNRO0FBQ1I7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDSTtBQUNJO0FBQ0E7QUFDaEI7QUFDWTtBQUNaO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ1o7QUFDWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNBO0FBQ1k7QUFDSTtBQUNoQjtBQUNBO0FBQ2dCO0FBQ0E7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ1k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ2hCO0FBQ0E7QUFDWTtBQUNJO0FBQ2hCO0FBQ0E7QUFDZ0I7QUFDQTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNZO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNSO0FBQ1E7QUFDSTtBQUNJO0FBQ0k7QUFDcEI7QUFDZ0I7QUFDaEI7QUFDZ0I7QUFDSTtBQUNwQjtBQUNnQjtBQUNBO0FBQ2hCO0FBQ0E7QUFDWTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ1k7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNRO0FBQ0k7QUFDWjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNJO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ2dCO0FBQ0k7QUFDSTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNBO0FBQ0E7QUFDWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFDQTtBQUFaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQUNJO0FBRFo7QUFHUTtBQURSO0FBR1E7QUFDSTtBQURaO0FBQ0E7QUFDQTtBQUdZO0FBRFo7QUFDQTtBQUNBO0FBSUk7QUFDSTtBQUNJO0FBQ0E7QUFGWjtBQUNBO0FBSVE7QUFDQTtBQUZSO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDQTtBQUZSO0FBQ0E7QUFJSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBRlI7QUFJUTtBQUNJO0FBRlo7QUFJUTtBQUZSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUZaO0FBQ0E7QUFJUTtBQUNBO0FBQ0E7QUFDQTtBQUZSO0FBSVE7QUFGUjtBQUlZO0FBRlo7QUFJUTtBQUZSO0FBSVE7QUFDQTtBQUNBO0FBQ0E7QUFGUjtBQUlRO0FBRlI7QUFDQTtBQUNBO0FBSVE7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0E7QUFDQTtBQUZSO0FBQ0E7QUFJSTtBQUZKO0FBSVE7QUFDQTtBQUZSO0FBQ0E7QUFJSTtBQUZKO0FBSVE7QUFDQTtBQUNBO0FBRlI7QUFDQTtBQUlJO0FBQ0k7QUFGUjtBQUNBO0FBSUk7QUFDSTtBQUZSO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFGUjtBQUNBO0FBSUk7QUFGSjtBQUlRO0FBQ0E7QUFGUjtBQUNBO0FBSUk7QUFGSjtBQUlRO0FBQ0k7QUFDQTtBQUNBO0FBRlo7QUFDQTtBQUlRO0FBQ0k7QUFGWjtBQUNBO0FBSVk7QUFGWjtBQUlRO0FBRlI7QUFDQTtBQUNBO0FBSUk7QUFDSTtBQUNJO0FBRlo7QUFJUTtBQUNJO0FBQ0E7QUFGWjtBQUNBO0FBQ0E7QUFJUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUZoQjtBQUNBO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFGUjtBQUNBO0FBSUk7QUFDSTtBQUZSO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFGWjtBQUNBO0FBSVE7QUFDQTtBQUNBO0FBRlI7QUFJUTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGWjtBQUlnQjtBQUNBO0FBRmhCO0FBQ0E7QUFDQTtBQUlRO0FBQ0k7QUFDSTtBQUNBO0FBRmhCO0FBSWdCO0FBRmhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUZaO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUNBO0FBRlo7QUFJUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRlI7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUNBO0FBSUk7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUZoQjtBQUNBO0FBQ0E7QUFJUTtBQUNJO0FBQ0E7QUFDQTtBQUZaO0FBSVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBRlo7QUFJUTtBQUNBO0FBRlI7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUNBO0FBSUk7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUZoQjtBQUNBO0FBQ0E7QUFJUTtBQUNJO0FBQ0E7QUFDQTtBQUZaO0FBSVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBRlo7QUFJUTtBQUNBO0FBRlI7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFJSTtBQUNJO0FBQ0k7QUFGWjtBQUlZO0FBRlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFGQTtBQUlBO0FBRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy91QkE7QUFDSTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDUTtBQUNSO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ1E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFBTTtBQUNBO0FBRU47QUFBTTtBQUNFO0FBQ0E7QUFFUjtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBQ0U7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0U7QUFDQTtBQUVFO0FBQ1Y7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDVjtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5RkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ007QUFDQTtBQUNFO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ0E7QUFFRTtBQUFWO0FBQ0E7QUFFTTtBQUFOO0FBQ0E7QUFFSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQVY7QUFDQTtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUNFO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUVJO0FBQ0E7QUFBSjtBQUVRO0FBQ0E7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUNBO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDSTtBQUFaO0FBQ0E7QUFFWTtBQUFaO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFFUTtBQUNBO0FBQ0E7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVZO0FBQVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRW9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBeEI7QUFFb0I7QUFDSTtBQUNJO0FBQ0E7QUFBNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHb0I7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUR4QjtBQUdvQjtBQUNJO0FBQ0k7QUFDQTtBQUQ1QjtBQUNBO0FBQ0E7QUFDQTtBQUljO0FBQ0E7QUFGZDtBQUNBO0FBQ0E7QUFDQTtBQUljO0FBQ0k7QUFDSTtBQUNBO0FBQ0U7QUFDQTtBQUZ4QjtBQUlzQjtBQUNBO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUY5QjtBQUk4QjtBQUY5QjtBQUk0QjtBQUY1QjtBQUk0QjtBQUY1QjtBQUNBO0FBQ0E7QUFJa0I7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUZ0QjtBQUtzQjtBQUNBO0FBSHRCO0FBS29CO0FBQ0U7QUFIdEI7QUFLc0I7QUFDQTtBQUh0QjtBQUNBO0FBTW9CO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUpoQztBQU1nQztBQUpoQztBQU04QjtBQUo5QjtBQU04QjtBQUo5QjtBQUNBO0FBTXdCO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFKbEM7QUFDQTtBQUtzQztBQUNBO0FBQ0k7QUFDQTtBQUgxQztBQUNBO0FBQ0E7QUFLZ0M7QUFIaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFIcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtJO0FBSEo7QUFDQTtBQUNBO0FBTVE7QUFDSTtBQUNBO0FBQ0k7QUFKaEI7QUFNWTtBQUNJO0FBSmhCO0FBTVk7QUFKWjtBQUNBO0FBTVE7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQUVJO0FBQ0E7QUFOaEI7QUFTZ0I7QUFQaEI7QUFVZ0I7QUFSaEI7QUFDQTtBQVVRO0FBUlI7QUFVSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJSO0FBVUk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQVJaO0FBVVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBUlo7QUFVWTtBQUNFO0FBQ0U7QUFSaEI7QUFDQTtBQUNBO0FBQ0E7QUFXZTtBQVRmO0FBVW1CO0FBQ0E7QUFDRztBQVJ0QjtBQVVzQjtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBUjFCO0FBVXdCO0FBQ0E7QUFSeEI7QUFDQTtBQVVvQjtBQUNEO0FBQ0s7QUFSeEI7QUFXd0I7QUFUeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWVE7QUFWUjtBQVlRO0FBQ0c7QUFDQTtBQUNBO0FBVlg7QUFXZTtBQVRmO0FBQ0E7QUFXUTtBQVRSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFjSTtBQUVJO0FBQ0E7QUFDQTtBQWJSO0FBZVE7QUFDQTtBQWJSO0FBZVE7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQWRaO0FBQ0E7QUFnQlE7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQWRoQjtBQWlCZ0I7QUFDQTtBQUNBO0FBQ0E7QUFmaEI7QUFrQmdCO0FBQ0E7QUFDQTtBQUNBO0FBaEJoQjtBQW1CZ0I7QUFDQTtBQUNBO0FBQ0E7QUFqQmhCO0FBb0JnQjtBQUNDO0FBQ0Q7QUFDQTtBQWxCaEI7QUFvQmdCO0FBQ0M7QUFDRDtBQUNBO0FBbEJoQjtBQUNBO0FBb0JTO0FBRUk7QUFDSTtBQW5CakI7QUFDQTtBQUNBO0FBcUJJO0FBQ0k7QUFDQTtBQUNBO0FBbkJSO0FBcUJJO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQW5CUjtBQUNBO0FBcUJJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFuQk47QUFDQTtBQXFCUTtBQW5CUjtBQXFCTTtBQUNFO0FBQ0E7QUFuQlI7QUFxQk07QUFuQk47QUFxQkk7QUFDSTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUErQjtBQWxCekM7QUFtQlU7QUFDQTtBQUNBO0FBQ0E7QUFqQlY7QUFDQTtBQW1CSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBakJoQjtBQW1CWTtBQUNBO0FBakJaO0FBbUJZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQlo7QUFDQTtBQW1CSTtBQUNFO0FBQ0U7QUFDQTtBQWpCUjtBQW1CTTtBQUNBO0FBakJOO0FBQ0E7QUFtQkk7QUFDSTtBQUNBO0FBQ0E7QUFqQlI7QUFDQTtBQW1CSTtBQUNJO0FBakJSO0FBbUJRO0FBakJSO0FBQ0E7QUFtQkk7QUFDRTtBQWpCTjtBQUNBO0FBbUJJO0FBQ0k7QUFqQlI7QUFDQTtBQW1CSTtBQWpCSjtBQW1CUTtBQUNBO0FBakJSO0FBbUJRO0FBakJSO0FBQ0E7QUFtQkk7QUFDSTtBQUNJO0FBQ0E7QUFqQlo7QUFDQTtBQUNBO0FBQ0E7QUFvQmdCO0FBQ0E7QUFsQmhCO0FBQ0E7QUFDQTtBQW9CUTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBbEJWO0FBb0JRO0FBbEJSO0FBb0JZO0FBbEJaO0FBb0JVO0FBQ0U7QUFsQlo7QUFDQTtBQW1CWTtBQWpCWjtBQUNBO0FBQ0E7QUFDQTtBQW9CSTtBQUVJO0FBQ0E7QUFuQlI7QUFDQTtBQXFCSTtBQW5CSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcUJRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5CUjtBQUNBO0FBc0JJO0FBQ0k7QUFDRTtBQUNFO0FBcEJaO0FBc0JZO0FBQ0E7QUFwQlo7QUFzQlE7QUFDQTtBQUNBO0FBcEJSO0FBQ0E7QUFzQlE7QUFDQTtBQXBCUjtBQUNBO0FBc0JJO0FBQ0k7QUFDSTtBQXBCWjtBQUNBO0FBQ0E7QUFzQkk7QUFDSTtBQXBCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDamxCQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ1I7QUFDUztBQUNUO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ2hCO0FBQ2dCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDcEI7QUFDb0I7QUFDcEI7QUFDZ0I7QUFDaEI7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSjtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUdSO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBRFE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBR1o7QUFDQTtBQURRO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBR1o7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUFRO0FBRVI7QUFDUTtBQUNJO0FBQ1o7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDWjtBQUFnQjtBQUNBO0FBQ0E7QUFFaEI7QUFEb0I7QUFDSTtBQUd4QjtBQUR3QjtBQUd4QjtBQUNBO0FBRG9CO0FBR3BCO0FBQ0E7QUFDQTtBQUZnQjtBQUNBO0FBSWhCO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFJWjtBQUZTO0FBSVQ7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUNJO0FBSVI7QUFGUTtBQUNBO0FBSVI7QUFGUTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBSXBCO0FBQ0E7QUFGWTtBQUNBO0FBSVo7QUFDQTtBQUNBO0FBRkk7QUFJSjtBQUZRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSVI7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSVI7QUFGUTtBQUNBO0FBQ0E7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUlSO0FBRlE7QUFDSTtBQUNJO0FBSWhCO0FBRlk7QUFDSTtBQUloQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFJO0FBRUo7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBRVE7QUFDSTtBQUFaO0FBQ0E7QUFFUTtBQUFSO0FBRVE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBWjtBQUNBO0FBRVE7QUFBeUI7QUFDakM7QUFDQTtBQUFRO0FBQ0k7QUFDSTtBQUVoQjtBQUNBO0FBQ0E7QUFBUTtBQUVSO0FBQVE7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQVk7QUFFWjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQVo7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUdJO0FBREo7QUFFUTtBQUFSO0FBQ1k7QUFDSTtBQUNoQjtBQUNnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQVE7QUFFUjtBQURZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFHUjtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0k7QUFDQTtBQUdaO0FBQ0E7QUFEUTtBQUNJO0FBR1o7QUFEZ0I7QUFHaEI7QUFEWTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURRO0FBQ0k7QUFDSTtBQUNBO0FBR2hCO0FBRGdCO0FBR2hCO0FBRFk7QUFHWjtBQURRO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFHaEI7QUFEZ0I7QUFHaEI7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFFUjtBQUFLO0FBRUw7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVaO0FBQVk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVaO0FBQVk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUVoQjtBQUNBO0FBQVk7QUFDSTtBQUNJO0FBRXBCO0FBQWdCO0FBQ0k7QUFFcEI7QUFDQTtBQUNBO0FBQVE7QUFDSztBQUViO0FBQVk7QUFDSTtBQUVoQjtBQUNBO0FBQWdCO0FBRWhCO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFFSjtBQUFRO0FBQ0k7QUFDQTtBQUVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFRO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFFWjtBQUNBO0FBRFk7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQURJO0FBR0o7QUFEUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQURRO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVE7QUFDSTtBQUVaO0FBQ0E7QUFEWTtBQUNBO0FBR1o7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdaO0FBRFk7QUFDQTtBQUNBO0FBR1o7QUFEWTtBQUNJO0FBR2hCO0FBQ0E7QUFEZ0I7QUFDQTtBQUdoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0k7QUFHWjtBQURZO0FBR1o7QUFEWTtBQUdaO0FBRFE7QUFHUjtBQUNBO0FBREk7QUFHSjtBQUNBO0FBSFE7QUFLUjtBQUhRO0FBQ0E7QUFDQTtBQUtSO0FBQ0E7QUFISTtBQUNJO0FBS1I7QUFISTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBS3hCO0FBSjRCO0FBQ0E7QUFDSTtBQU1oQztBQUpnQztBQU1oQztBQUNBO0FBSjRCO0FBTTVCO0FBTGdDO0FBT2hDO0FBTGdDO0FBT2hDO0FBQ0E7QUFMNEI7QUFDQTtBQUNBO0FBQ0E7QUFPNUI7QUFDQTtBQUp3QjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBTTVCO0FBSjRCO0FBQ0k7QUFNaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSmdCO0FBTWhCO0FBTG9CO0FBQ0k7QUFPeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQU9SO0FBTlk7QUFRWjtBQVBnQjtBQUVJO0FBQ0E7QUFRcEI7QUFOb0I7QUFRcEI7QUFDQTtBQUxnQjtBQU9oQjtBQUNBO0FBTFk7QUFDSTtBQU9oQjtBQUxnQjtBQU9oQjtBQUNBO0FBTFk7QUFDQTtBQU9aO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFPSjtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFDSTtBQUNBO0FBT1o7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBQXFDO0FBUTdDO0FBQ0E7QUFQUTtBQVNSO0FBUFk7QUFTWjtBQVBZO0FBU1o7QUFQWTtBQUNJO0FBQ0E7QUFTaEI7QUFDQTtBQUNBO0FBQ0E7QUFOUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUVI7QUFOUTtBQVFSO0FBTlE7QUFRUjtBQU5RO0FBUVI7QUFOUTtBQUNJO0FBQ0E7QUFDSTtBQVFoQjtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDSTtBQU9aO0FBTFE7QUFDSTtBQU9aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUxRO0FBT1I7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBTFE7QUFPUjtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDSTtBQU9aO0FBTFE7QUFDSTtBQU9aO0FBQ0E7QUFMUTtBQUNBO0FBQ0E7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9SO0FBTFE7QUFPUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBT2hCO0FBQ0E7QUFMUTtBQUNBO0FBQ0E7QUFPUjtBQUNBO0FBQ0E7QUFMUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBT2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxZO0FBT1o7QUFMUTtBQU9SO0FBTFE7QUFDQTtBQUNJO0FBQ0E7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFPUjtBQUNBO0FBQ0E7QUFMSTtBQU9KO0FBTFE7QUFDSTtBQUNJO0FBQ0E7QUFPaEI7QUFKZ0I7QUFDQTtBQU1oQjtBQUhnQjtBQUNBO0FBS2hCO0FBRmdCO0FBQ0E7QUFJaEI7QUFEZ0I7QUFDQTtBQUdoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURnQjtBQUdoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUhRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUtaO0FBSFk7QUFLWjtBQUhRO0FBQ0E7QUFDQTtBQUNBO0FBS1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBS0o7QUFIUTtBQUtSO0FBSFE7QUFLUjtBQUNBO0FBQ0E7QUFIUTtBQUtSO0FBQ0E7QUFIUTtBQUNBO0FBS1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhZO0FBS1o7QUFDQTtBQUNBO0FBSGdCO0FBQ0k7QUFLcEI7QUFDQTtBQUNBO0FBQ0E7QUFIUTtBQUNJO0FBQ0k7QUFDQTtBQUtoQjtBQUhZO0FBS1o7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFMUTtBQUNBO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFDSTtBQU9aO0FBTFE7QUFPUjtBQUxRO0FBQ0E7QUFPUjtBQUNBO0FBQ0E7QUFMWTtBQUNJO0FBT2hCO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFDSTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFPUjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBT1I7QUFMSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPUjtBQUNBO0FBTEk7QUFPSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUFE7QUFDQTtBQUNJO0FBU1o7QUFQUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFTaEI7QUFQWTtBQVNaO0FBUFk7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVNoQjtBQUNBO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFRWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTmdCO0FBUWhCO0FBTlk7QUFDQTtBQVFaO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFRWjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQVFoQjtBQU5ZO0FBUVo7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNJO0FBQ0E7QUFPWjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT1I7QUFMUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPUjtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFDSTtBQU9aO0FBTmdCO0FBQ0k7QUFRcEI7QUFDQTtBQUNBO0FBUGdCO0FBQ0k7QUFTcEI7QUFSd0I7QUFVeEI7QUFSd0I7QUFVeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJRO0FBQ0k7QUFVWjtBQVRnQjtBQVdoQjtBQVRnQjtBQVdoQjtBQUNBO0FBQ0E7QUFUUTtBQVdSO0FBVlk7QUFZWjtBQVhnQjtBQUNBO0FBYWhCO0FBQ0E7QUFaZ0I7QUFDQTtBQWNoQjtBQUNBO0FBQ0E7QUFaWTtBQWNaO0FBYmdCO0FBQ0E7QUFlaEI7QUFDQTtBQWJnQjtBQUNBO0FBZWhCO0FBQ0E7QUFDQTtBQWJRO0FBQ0k7QUFlWjtBQWJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQWVoQjtBQUNBO0FBYlE7QUFDSTtBQUNJO0FBZWhCO0FBYmdCO0FBZWhCO0FBQ0E7QUFaWTtBQWNaO0FBWlE7QUFDQTtBQUNBO0FBY1I7QUFDQTtBQVpJO0FBQ0k7QUFFSTtBQWFaO0FBQ0E7QUFYUTtBQUFxQztBQWM3QztBQUNBO0FBYlE7QUFlUjtBQWJRO0FBZVI7QUFiUTtBQUFzRDtBQWdCOUQ7QUFDQTtBQWZRO0FBaUJSO0FBZlk7QUFpQlo7QUFDQTtBQWRRO0FBZ0JSO0FBZFE7QUFnQlI7QUFkUTtBQWdCUjtBQWRRO0FBZ0JSO0FBZFk7QUFnQlo7QUFDQTtBQUNBO0FBWkk7QUFjSjtBQVpRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFjUjtBQVpJO0FBQ0k7QUFjUjtBQUNBO0FBQ0E7QUFaSTtBQWNKO0FBWlE7QUFDSTtBQUNBO0FBY1o7QUFDQTtBQVpRO0FBQ0E7QUFDQTtBQWNSO0FBWlE7QUFDSTtBQWNaO0FBQ0E7QUFDQTtBQVpJO0FBQ0k7QUFDQTtBQWNSO0FBWlE7QUFDSTtBQWNaO0FBQ0E7QUFaUTtBQWNSO0FBWlE7QUFDSTtBQWNaO0FBWlE7QUFjUjtBQVpJO0FBQ0k7QUFDQTtBQWNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFaUTtBQUNJO0FBQ0k7QUFjaEI7QUFDQTtBQUNBO0FBQ0E7QUFaSTtBQWNKO0FBQ0E7QUFDQTtBQUNBO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhZO0FBYVo7QUFYWTtBQWFaO0FBWFk7QUFhWjtBQVhZO0FBQXlEO0FBY3JFO0FBQ0E7QUFiWTtBQWVaO0FBYmdCO0FBZWhCO0FBYmdCO0FBZWhCO0FBYmdCO0FBZWhCO0FBYmdCO0FBZWhCO0FBYmdCO0FBZWhCO0FBYmdCO0FBZWhCO0FBYmdCO0FBZWhCO0FBQ0E7QUFkb0I7QUFnQnBCO0FBQ0E7QUFib0I7QUFlcEI7QUFDQTtBQWJnQjtBQWVoQjtBQWJvQjtBQWVwQjtBQWJvQjtBQWVwQjtBQWJvQjtBQWVwQjtBQUNBO0FBQ0E7QUFWWTtBQVlaO0FBVlk7QUFZWjtBQVZnQjtBQVloQjtBQVZvQjtBQVlwQjtBQVZvQjtBQVlwQjtBQUNBO0FBQ0E7QUFDQTtBQVJRO0FBVVI7QUFSWTtBQVVaO0FBUlk7QUFVWjtBQVJZO0FBVVo7QUFSWTtBQVVaO0FBUlk7QUFVWjtBQVJnQjtBQVVoQjtBQUNBO0FBVG9CO0FBV3BCO0FBVG9CO0FBV3BCO0FBQ0E7QUFUZ0I7QUFXaEI7QUFDQTtBQVJnQjtBQVVoQjtBQUNBO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFRWjtBQUNBO0FBTFE7QUFPUjtBQUNBO0FBTFk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBT1I7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0E7QUFPUjtBQUNBO0FBTEk7QUFPSjtBQUxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFDSTtBQU9aO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFPUjtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFPUjtBQUxRO0FBT1I7QUFDQTtBQUxRO0FBQ0k7QUFDQTtBQU9aO0FBQ0E7QUFMUTtBQUNBO0FBT1I7QUFMWTtBQU9aO0FBQ0E7QUFMUTtBQU9SO0FBQ0E7QUFMUTtBQUNJO0FBQ0E7QUFPWjtBQUNBO0FBSlE7QUFNUjtBQUNBO0FBQ0E7QUFDQTtBQUpZO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFNaEI7QUFDQTtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBQ0E7QUFKUTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBSlE7QUFNUjtBQUNBO0FBSlE7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUpRO0FBQ0k7QUFDSTtBQU1oQjtBQUNBO0FBSlk7QUFNWjtBQUNBO0FBSlE7QUFDSTtBQUNBO0FBTVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQU1aO0FBQ0E7QUFKUTtBQU1SO0FBSlk7QUFNWjtBQUNBO0FBSlE7QUFNUjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBSlE7QUFDQTtBQUNJO0FBQ0k7QUFNaEI7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBTVI7QUFDQTtBQUpJO0FBQ0k7QUFNUjtBQUpRO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQUNBO0FBTVI7QUFKUTtBQUNBO0FBTVI7QUFKUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBSlE7QUFDQTtBQUNJO0FBQ0E7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFNUjtBQUNBO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQU1aO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFDSTtBQUtaO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUtSO0FBSFE7QUFLUjtBQUNBO0FBSEk7QUFDSTtBQUNJO0FBS1o7QUFDQTtBQUhRO0FBS1I7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUNBO0FBSFE7QUFDSTtBQUtaO0FBSFE7QUFLUjtBQUNBO0FBSEk7QUFDSTtBQUtSO0FBQ0E7QUFISTtBQUtKO0FBSFE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUtaO0FBSFE7QUFDSTtBQUtaO0FBQ0E7QUFIWTtBQUNJO0FBS2hCO0FBSFk7QUFDQTtBQUNBO0FBS1o7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBQ0k7QUFDQTtBQUtaO0FBQ0E7QUFIUTtBQUNJO0FBQ0E7QUFLWjtBQUhRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS1I7QUFDQTtBQUhRO0FBQ0k7QUFLWjtBQUhRO0FBQ0k7QUFLWjtBQUhRO0FBQ0k7QUFLWjtBQUhRO0FBQ0k7QUFLWjtBQUhRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUFRO0FBQW1CO0FBQ25CO0FBQW1CO0FBQ25CO0FBQW1CO0FBQ25CO0FBQW1CO0FBRS9CO0FBQ0k7QUFBUTtBQUFvQjtBQUNwQjtBQUFrQjtBQUNsQjtBQUFrQjtBQUNsQjtBQUFrQjtBQUNsQjtBQUFrQjtBQUNsQjtBQUFrQjtBQUNsQjtBQUFrQjtBQUNsQjtBQUFrQjtBQUNsQjtBQUFrQjtBQUNqQjtBQUFtQjtBQUNuQjtBQUFvQjtBQUNwQjtBQUFvQjtBQUNwQjtBQUFvQjtBQUVqQztBQXNCWjtBQUNBO0FBcEJRO0FBQ0k7QUFzQlo7QUFwQlk7QUFzQlo7QUFwQlk7QUFzQlo7QUFwQlE7QUFDSTtBQXNCWjtBQXBCWTtBQXNCWjtBQUNBO0FBcEJRO0FBc0JSO0FBQ0E7QUFDQTtBQUNBO0FBcEJJO0FBQ0k7QUFDSTtBQXNCWjtBQUNBO0FBcEJRO0FBc0JSO0FBQ0E7QUFDQTtBQXBCSTtBQUNJO0FBQ0k7QUFzQlo7QUFDQTtBQXBCUTtBQUNJO0FBc0JaO0FBQ0E7QUFwQlE7QUFzQlI7QUFDQTtBQUNBO0FBcEJJO0FBQ0k7QUFDSTtBQXNCWjtBQUNBO0FBcEJRO0FBc0JSO0FBQ0E7QUFuQkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFxQlo7QUFDQTtBQW5CUTtBQUNBO0FBQXNEO0FBc0I5RDtBQXJCUTtBQUNBO0FBQ0k7QUFDQTtBQXVCWjtBQUNBO0FBQ0E7QUFyQkk7QUF1Qko7QUFyQlE7QUFDSTtBQUNBO0FBdUJaO0FBQ0E7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlk7QUF1Qlo7QUFyQmdCO0FBdUJoQjtBQXJCZ0I7QUF1QmhCO0FBQ0E7QUFDQTtBQXBCUTtBQXNCUjtBQXBCWTtBQXNCWjtBQXBCZ0I7QUFzQmhCO0FBcEJnQjtBQXNCaEI7QUFDQTtBQW5CUTtBQUNBO0FBcUJSO0FBbkJRO0FBQStCO0FBc0J2QztBQUNBO0FBckJRO0FBQStCO0FBd0J2QztBQUNBO0FBdkJRO0FBQ0k7QUFBK0I7QUEwQjNDO0FBQ0E7QUFDQTtBQXhCUTtBQTBCUjtBQXhCUTtBQTBCUjtBQXhCWTtBQTBCWjtBQXhCWTtBQTBCWjtBQUNBO0FBdkJRO0FBeUJSO0FBdkJRO0FBeUJSO0FBdkJRO0FBeUJSO0FBdkJRO0FBeUJSO0FBdkJRO0FBeUJSO0FBdkJRO0FBeUJSO0FBdkJZO0FBeUJaO0FBdkJnQjtBQXlCaEI7QUFDQTtBQXRCWTtBQXdCWjtBQXRCWTtBQXdCWjtBQUNBO0FBckJRO0FBdUJSO0FBckJZO0FBdUJaO0FBckJnQjtBQXVCaEI7QUFyQm9CO0FBdUJwQjtBQUNBO0FBcEJnQjtBQXNCaEI7QUFDQTtBQUNBO0FBbEJRO0FBb0JSO0FBbEJRO0FBb0JSO0FBbEJZO0FBQStCO0FBcUIzQztBQUNBO0FBcEJZO0FBc0JaO0FBQ0E7QUFwQlE7QUFDSTtBQXNCWjtBQUNBO0FBQ0E7QUFwQlE7QUFzQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkJJO0FBQ0k7QUFBdUU7QUFzQi9FO0FBQ0E7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlE7QUF1QlI7QUFyQlE7QUFBcUM7QUF3QjdDO0FBQ0E7QUF2QlE7QUF5QlI7QUFDQTtBQXhCWTtBQTBCWjtBQXhCWTtBQTBCWjtBQXZCZ0I7QUF5QmhCO0FBdkJnQjtBQXlCaEI7QUF2QmdCO0FBeUJoQjtBQXZCZ0I7QUFDQTtBQUNJO0FBeUJwQjtBQUNBO0FBdkJnQjtBQXlCaEI7QUF2QmdCO0FBeUJoQjtBQUNBO0FBQ0E7QUFyQlE7QUFBcUM7QUF3QjdDO0FBQ0E7QUF2QlE7QUF5QlI7QUFDQTtBQXhCWTtBQUFxQztBQTJCakQ7QUFDQTtBQTFCWTtBQTRCWjtBQTFCWTtBQTRCWjtBQUNBO0FBM0JnQjtBQTZCaEI7QUEzQmdCO0FBNkJoQjtBQTNCZ0I7QUE2QmhCO0FBQ0E7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUE1Qm9CO0FBOEJwQjtBQTVCd0I7QUE4QnhCO0FBQ0E7QUEzQm9CO0FBNkJwQjtBQUNBO0FBMUJnQjtBQTRCaEI7QUExQmdCO0FBNEJoQjtBQUNBO0FBekJZO0FBMkJaO0FBekJZO0FBMkJaO0FBQ0E7QUExQmdCO0FBNEJoQjtBQTFCZ0I7QUE0QmhCO0FBMUJnQjtBQTRCaEI7QUFDQTtBQXpCWTtBQTJCWjtBQXpCWTtBQUFpQztBQTRCN0M7QUFDQTtBQTNCWTtBQTZCWjtBQUNBO0FBNUJnQjtBQThCaEI7QUE1QmdCO0FBOEJoQjtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUE1Qm9CO0FBOEJwQjtBQUNBO0FBQ0E7QUE1Qm9CO0FBOEJwQjtBQUNBO0FBN0J3QjtBQStCeEI7QUFDQTtBQTdCNEI7QUErQjVCO0FBN0I0QjtBQStCNUI7QUE3QjRCO0FBK0I1QjtBQTdCNEI7QUErQjVCO0FBN0I0QjtBQStCNUI7QUE3QjRCO0FBK0I1QjtBQUNBO0FBNUJ3QjtBQThCeEI7QUFDQTtBQUNBO0FBQ0E7QUEzQm9CO0FBNkJwQjtBQUNBO0FBQ0E7QUF6Qlk7QUEyQlo7QUFDQTtBQUNBO0FBQ0E7QUExQmdCO0FBNEJoQjtBQTFCZ0I7QUFBK0M7QUE2Qi9EO0FBQ0E7QUFDQTtBQTFCWTtBQTRCWjtBQUNBO0FBM0JnQjtBQUFxQztBQThCckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCSTtBQTRCSjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQUNBO0FBMUJJO0FBNEJKO0FBQ0E7QUFDQTtBQUNBO0FBOUJRO0FBQ0E7QUFDQTtBQUNBO0FBZ0NSO0FBOUJRO0FBQ0k7QUFnQ1o7QUFDQTtBQTlCUTtBQWdDUjtBQUNBO0FBQ0E7QUE5QlE7QUFnQ1I7QUE5Qlk7QUFDSTtBQWdDaEI7QUFDQTtBQTlCWTtBQUNBO0FBQ0E7QUFDSTtBQWdDaEI7QUE5Qm9CO0FBQStCO0FBaUNuRDtBQUNBO0FBaENvQjtBQWtDcEI7QUFDQTtBQTlCb0I7QUFBK0I7QUFpQ25EO0FBQ0E7QUFoQ29CO0FBa0NwQjtBQUNBO0FBOUJvQjtBQUErQjtBQWlDbkQ7QUFDQTtBQWhDb0I7QUFrQ3BCO0FBQ0E7QUEvQm9CO0FBQStCO0FBa0NuRDtBQUNBO0FBakNvQjtBQW1DcEI7QUFDQTtBQS9Cb0I7QUFBK0I7QUFrQ25EO0FBQ0E7QUFqQ29CO0FBbUNwQjtBQUNBO0FBQ0E7QUFDQTtBQWhDUTtBQWtDUjtBQWhDWTtBQWtDWjtBQWhDWTtBQUNJO0FBQ0k7QUFDSTtBQWtDeEI7QUFDQTtBQUNBO0FBQ0E7QUEvQlk7QUFDSTtBQUNJO0FBaUNwQjtBQUNBO0FBQ0E7QUFDQTtBQS9CUTtBQWlDUjtBQUNBO0FBL0JJO0FBaUNKO0FBQ0E7QUE3Qkk7QUFDSTtBQUNBO0FBK0JSO0FBN0JRO0FBK0JSO0FBQ0E7QUFDQTtBQUNBO0FBN0JJO0FBK0JKO0FBQ0E7QUEvQlE7QUFDSTtBQWlDWjtBQUNBO0FBL0JRO0FBQ0k7QUFDQTtBQUNBO0FBaUNaO0FBL0JRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQWlDWjtBQS9CUTtBQUNBO0FBaUNSO0FBQ0E7QUEvQkk7QUFDSTtBQUNJO0FBaUNaO0FBQ0E7QUFDQTtBQS9CSTtBQUNJO0FBQ0E7QUFDSTtBQWlDWjtBQUNBO0FBL0JRO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFpQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEvQkk7QUFpQ0o7QUFDQTtBQWpDUTtBQUNJO0FBQ0E7QUFDQTtBQW1DWjtBQWpDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFtQ1o7QUFqQ1E7QUFDQTtBQW1DUjtBQUNBO0FBakNJO0FBQ0k7QUFDSTtBQW1DWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFtQ1I7QUFqQ1k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNLO0FBbUN6QjtBQWpDb0I7QUFDQTtBQW1DcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWhDZ0I7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBa0NwQjtBQUNBO0FBQ0E7QUFoQ1E7QUFDSTtBQUNBO0FBQ0k7QUFrQ2hCO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBQ0E7QUFoQ1k7QUFDQTtBQWtDWjtBQWhDUTtBQUNJO0FBQ0E7QUFDSTtBQWtDaEI7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFrQ1o7QUFDQTtBQWhDWTtBQUNBO0FBa0NaO0FBaENRO0FBQ0k7QUFDQTtBQUNBO0FBa0NaO0FBQ0E7QUFoQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBa0NaO0FBQ0E7QUFoQ1E7QUFDSTtBQUNBO0FBQ0k7QUFrQ2hCO0FBaENZO0FBa0NaO0FBQ0E7QUFoQ1E7QUFDQTtBQWtDUjtBQS9CUTtBQUNJO0FBaUNaO0FBQ0E7QUEvQlE7QUFDSTtBQUNBO0FBQ0k7QUFpQ2hCO0FBL0JZO0FBaUNaO0FBQ0E7QUEvQkk7QUFDSTtBQUNJO0FBaUNaO0FBQ0E7QUFoQ1k7QUFDQTtBQWtDWjtBQUNBO0FBQ0E7QUFoQ0k7QUFDSTtBQUNJO0FBa0NaO0FBQ0E7QUFqQ1k7QUFDQTtBQW1DWjtBQUNBO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFqQ1E7QUFDSTtBQW1DWjtBQUNBO0FBbENZO0FBb0NaO0FBQ0E7QUFDQTtBQUNBO0FBbENJO0FBQ0k7QUFDSTtBQW9DWjtBQWxDUTtBQW9DUjtBQWxDUTtBQW9DUjtBQWxDUTtBQW9DUjtBQWxDUTtBQW9DUjtBQWxDUTtBQUF5RDtBQXFDakU7QUFDQTtBQXBDUTtBQXNDUjtBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQUNBO0FBckNnQjtBQXVDaEI7QUFDQTtBQXBDZ0I7QUFzQ2hCO0FBQ0E7QUFwQ1k7QUFzQ1o7QUFwQ2dCO0FBc0NoQjtBQXBDZ0I7QUFzQ2hCO0FBcENnQjtBQXNDaEI7QUFDQTtBQW5DWTtBQXFDWjtBQW5DZ0I7QUFxQ2hCO0FBQ0E7QUFsQ2dCO0FBb0NoQjtBQUNBO0FBQ0E7QUFqQ1E7QUFtQ1I7QUFqQ1E7QUFtQ1I7QUFqQ1E7QUFtQ1I7QUFqQ1k7QUFDSTtBQUNBO0FBbUNoQjtBQUNBO0FBQ0E7QUFoQ1E7QUFrQ1I7QUFoQ1E7QUFrQ1I7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFrQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBaENZO0FBa0NaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBOUJJO0FBQ0k7QUFDQTtBQWdDUjtBQUNBO0FBQ0E7QUE5Qkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFnQ1o7QUE5QlE7QUFnQ1I7QUFDQTtBQUNBO0FBOUJJO0FBZ0NKO0FBQ0E7QUFDQTtBQTlCUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFnQ1I7QUFDQTtBQUNBO0FBOUJJO0FBZ0NKO0FBQ0E7QUFDQTtBQTlCUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFnQ1I7QUFDQTtBQUNBO0FBOUJJO0FBQ0k7QUFDSTtBQWdDWjtBQUNBO0FBOUJRO0FBQ0E7QUFnQ1I7QUFDQTtBQUNBO0FBOUJJO0FBQ0k7QUFDQTtBQUNJO0FBZ0NaO0FBQ0E7QUE5QlE7QUFnQ1I7QUE5QlE7QUFDSTtBQUNBO0FBQ0E7QUFnQ1o7QUFDQTtBQUNBO0FBQ0E7QUE5Qkk7QUFDSTtBQUNBO0FBQ0k7QUFnQ1o7QUE5QlE7QUFnQ1I7QUE5QlE7QUFnQ1I7QUE5Qlk7QUFnQ1o7QUFDQTtBQUNBO0FBNUJJO0FBQ0k7QUFDSTtBQThCWjtBQUNBO0FBQ0E7QUE1Qkk7QUFDSTtBQUNBO0FBQ0k7QUE4Qlo7QUE1QlE7QUE4QlI7QUFDQTtBQTVCSTtBQUNJO0FBQ0E7QUFDSTtBQThCWjtBQTVCUTtBQThCUjtBQUNBO0FBNUJJO0FBQ0k7QUE4QlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCSTtBQUNJO0FBQ0E7QUFDSTtBQThCWjtBQTVCUTtBQUNBO0FBOEJSO0FBQ0E7QUE1Qkk7QUFDSTtBQUNBO0FBOEJSO0FBQ0E7QUFDQTtBQTVCUTtBQUNJO0FBOEJaO0FBM0JZO0FBNkJaO0FBMUJZO0FBNEJaO0FBekJZO0FBMkJaO0FBekJRO0FBMkJSO0FBQ0E7QUF6Qkk7QUFDSTtBQUNBO0FBQ0E7QUEyQlI7QUFDQTtBQXpCSTtBQUNJO0FBQ0E7QUFDSTtBQTJCWjtBQXpCUTtBQUNJO0FBMkJaO0FBekJRO0FBQ0E7QUEyQlI7QUFDQTtBQXpCSTtBQUNJO0FBQ0E7QUFDQTtBQTJCUjtBQUNBO0FBekJJO0FBQ0k7QUFDQTtBQUNJO0FBMkJaO0FBeEJZO0FBMEJaO0FBdkJZO0FBeUJaO0FBdkJRO0FBQ0E7QUF5QlI7QUFDQTtBQUNBO0FBdkJJO0FBeUJKO0FBQ0E7QUFDQTtBQXZCSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBeUJaO0FBQ0E7QUF2QlE7QUFDSTtBQUNBO0FBQ0E7QUF5Qlo7QUFDQTtBQXZCUTtBQUNBO0FBQ0k7QUFDQTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0k7QUF5Qlo7QUFDQTtBQXZCUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBeUJSO0FBdkJRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUF5Qlo7QUFDQTtBQXZCUTtBQUNBO0FBQ0k7QUF5Qlo7QUFDQTtBQXZCUTtBQUNBO0FBQ0k7QUF5Qlo7QUFDQTtBQXZCUTtBQUNBO0FBeUJSO0FBQ0E7QUFDQTtBQXZCSTtBQUNJO0FBQ0k7QUF5Qlo7QUFDQTtBQXZCUTtBQUNJO0FBQ0E7QUF5Qlo7QUF2Qlk7QUFDQTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQXlCaEI7QUFDQTtBQUNBO0FBdkJRO0FBQ0k7QUF5Qlo7QUFDQTtBQXZCUTtBQXlCUjtBQUNBO0FBdkJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQXlCWjtBQXZCUTtBQXlCUjtBQXZCUTtBQUNBO0FBQ0k7QUF5Qlo7QUFDQTtBQXZCUTtBQUNBO0FBeUJSO0FBQ0E7QUFDQTtBQXZCQTtBQUNJO0FBeUJKO0FBdkJBO0FBeUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvaUdBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ1o7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNNO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFFSTtBQUNFO0FBQU47QUFDQTtBQUVJO0FBQ0k7QUFBUjtBQUNBO0FBRUk7QUFDRTtBQUNBO0FBQU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVNO0FBQU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNFO0FBQU47QUFFTTtBQUFOO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUFaO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBQ0E7QUFFSztBQUNHO0FBQVI7QUFFUTtBQUNJO0FBQ0E7QUFDQTtBQUFaO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQVo7QUFFUTtBQUNBO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDSTtBQUFaO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDSTtBQUNBO0FBQVo7QUFDQTtBQUVRO0FBQ0k7QUFDQTtBQUFaO0FBQ0E7QUFFUTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDUTtBQUNJO0FBQ1o7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDaEI7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFBUTtBQUFpQjtBQUNqQjtBQUFrQjtBQUNsQjtBQUFrQjtBQUNsQjtBQUFrQjtBQUU5QjtBQUtSO0FBQ0E7QUFISTtBQUtKO0FBSlE7QUFDSTtBQUNJO0FBTWhCO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFMUTtBQUNJO0FBQ0k7QUFPaEI7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFPSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFPSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZKQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFBeUM7QUFFakQ7QUFEWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFHWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEtBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDRTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hCQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQVk7QUFFWjtBQUFRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBRWhCO0FBQWdCO0FBRWhCO0FBQVk7QUFDSTtBQUVoQjtBQUNBO0FBQ0E7QUFBUTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUVwQjtBQUFnQjtBQUNBO0FBRWhCO0FBRG9CO0FBR3BCO0FBQ0E7QUFEZ0I7QUFDQTtBQUNBO0FBR2hCO0FBRGdCO0FBQ0E7QUFHaEI7QUFGb0I7QUFJcEI7QUFDQTtBQUhvQjtBQUtwQjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ1k7QUFDWjtBQUNZO0FBQ1o7QUFDUTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ2hCO0FBRWdCO0FBQWhCO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUdRO0FBQ0k7QUFDSTtBQUNBO0FBRGhCO0FBSWdCO0FBQ0E7QUFGaEI7QUFLZ0I7QUFDQTtBQUhoQjtBQUtZO0FBQ0k7QUFIaEI7QUFLWTtBQUhaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFHQTtBQUNJO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUFaO0FBRVk7QUFBWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ2hCO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNZO0FBQ0k7QUFDSTtBQUNBO0FBQ3BCO0FBQ2dCO0FBQ0E7QUFDQTtBQUNJO0FBQ3BCO0FBQXdCO0FBQ0E7QUFFeEI7QUFDQTtBQUFnQjtBQUVoQjtBQUFnQjtBQUNBO0FBQ0E7QUFFaEI7QUFDQTtBQUFRO0FBQ0k7QUFDQTtBQUVaO0FBQVE7QUFDSTtBQUVaO0FBQVE7QUFDSTtBQUVaO0FBQVE7QUFDSTtBQUVaO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFnQjtBQUVoQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoR0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBR0E7QUFDSTtBQUNBO0FBRFo7QUFHUTtBQUNJO0FBQ0E7QUFEWjtBQUdRO0FBQ0k7QUFDQTtBQURaO0FBQ0E7QUFDQTtBQUdRO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBQ0k7QUFEWjtBQUNBO0FBR1E7QUFDSTtBQURaO0FBR1E7QUFDQTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFHUTtBQUNJO0FBRFo7QUFDQTtBQUdRO0FBQ0E7QUFDQTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDRTtBQUNFO0FBQ0E7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDSTtBQUNKO0FBQ0k7QUFDQTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNBO0FBQ0E7QUFDSjtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0U7QUFDRjtBQUNJO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ047QUFDSTtBQUNKO0FBQ0k7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNJO0FBQ0o7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNNO0FBQ0E7QUFDTjtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNNO0FBQ0E7QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNNO0FBQ047QUFDTTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRU07QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFBVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFBRjtBQUlFO0FBRkY7QUFNRTtBQUpGO0FBUUU7QUFORjtBQVVFO0FBUkY7QUFZRTtBQVZGO0FBY0U7QUFaRjtBQWNJO0FBQ0E7QUFDQTtBQUNFO0FBWk47QUFDQTtBQUNBO0FBQ0E7QUFjRTtBQVpGO0FBY0k7QUFDQTtBQVpKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFjRTtBQUNFO0FBQ0E7QUFDRTtBQVpOO0FBY0k7QUFaSjtBQUNBO0FBY0k7QUFDQTtBQUNBO0FBWko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNFO0FBQ0U7QUFDQTtBQUNFO0FBWk47QUFjSTtBQVpKO0FBQ0E7QUFjSTtBQUNBO0FBQ0E7QUFaSjtBQWNJO0FBQ0U7QUFaTjtBQUNBO0FBQ0E7QUFDQTtBQWNFO0FBQ0U7QUFaSjtBQUNBO0FBQ0E7QUFjRTtBQVpGO0FBY0k7QUFDQTtBQVpKO0FBQ0E7QUFjRTtBQUNFO0FBWko7QUFjSTtBQUNFO0FBQ0E7QUFDQTtBQVpOO0FBQ0E7QUFjSTtBQUNFO0FBQ0U7QUFaUjtBQUNBO0FBY007QUFaTjtBQUNBO0FBQ0E7QUFjRTtBQVpGO0FBQ0E7QUFZSTtBQUNFO0FBVk47QUFDQTtBQVlJO0FBQ0U7QUFWTjtBQUNBO0FBWUk7QUFDRTtBQUNFO0FBVlI7QUFDQTtBQWFJO0FBWEo7QUFDQTtBQWFFO0FBWEY7QUFDQTtBQVdJO0FBQ0E7QUFDQTtBQVRKO0FBV0k7QUFUSjtBQUNBO0FBQ0E7QUFXRTtBQUNFO0FBQ0U7QUFUTjtBQUNBO0FBV0k7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBVFY7QUFDQTtBQUNBO0FBV007QUFUTjtBQUNBO0FBQ0E7QUFDQTtBQVdFO0FBQ0U7QUFUSjtBQUNBO0FBV0U7QUFDRTtBQVRKO0FBQ0E7QUFXRTtBQUNFO0FBQ0U7QUFDQTtBQVROO0FBQ0E7QUFDQTtBQUNBO0FBV0U7QUFDRTtBQVRKO0FBQ0E7QUFDQTtBQVdFO0FBQ0U7QUFDQTtBQVRKO0FBV0k7QUFUSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEY7QUFXRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRGO0FBV0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRGO0FBQ0E7QUFDQTtBQUNBO0FBWUE7QUFDRTtBQVZGO0FBQ0E7QUFZQTtBQUNFO0FBQ0E7QUFWRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFhQTtBQUNFO0FBQ0E7QUFYRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYUE7QUFDRTtBQUNBO0FBWEY7QUFDQTtBQUNBO0FBYUE7QUFDRTtBQUNBO0FBWEY7QUFhRTtBQUNBO0FBWEY7QUFDQTtBQWFBO0FBQ0M7QUFDRztBQUNBO0FBWEo7QUFhRTtBQVhGO0FBQ0E7QUFhQTtBQUNFO0FBQ0U7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQUNBO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFDQTtBQWFBO0FBQ0U7QUFDQTtBQVhGO0FBYUU7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBQ0E7QUFhQTtBQUNFO0FBQ0U7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQUNBO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFDQTtBQUNBO0FBYUE7QUFDRTtBQUNBO0FBQ0U7QUFYSjtBQUNBO0FBYUU7QUFYRjtBQUNBO0FBYUE7QUFYQTtBQUNBO0FBYUU7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFhQTtBQUNFO0FBQ0U7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQWFBO0FBWEE7QUFDQTtBQVdFO0FBQ0E7QUFURjtBQVdFO0FBQ0U7QUFUSjtBQUNBO0FBV0U7QUFDRTtBQUNBO0FBVEo7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFUSjtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNFO0FBVEo7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0U7QUFUSjtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNFO0FBVEo7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFUSjtBQUNBO0FBV0U7QUFURjtBQUNBO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBQ0E7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNJO0FBQ0E7QUFDRTtBQVROO0FBQ0E7QUFXSTtBQVRKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQVRBO0FBQ0E7QUFTRTtBQUNBO0FBQ0U7QUFDQTtBQVBKO0FBQ0E7QUFTRTtBQVBGO0FBV0k7QUFDQTtBQUNFO0FBVE47QUFDQTtBQVdJO0FBVEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0E7QUFDSTtBQUNBO0FBQ0U7QUFDQTtBQVROO0FBQ0E7QUFXSTtBQVRKO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBQ0E7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFUSjtBQUNBO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0U7QUFUSjtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNFO0FBVEo7QUFDQTtBQVdFO0FBVEY7QUFDQTtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0U7QUFUSjtBQUNBO0FBV0U7QUFURjtBQUNBO0FBQ0E7QUFXQTtBQUNJO0FBQ0E7QUFDRTtBQVROO0FBQ0E7QUFXSTtBQVRKO0FBWU07QUFDQTtBQUNFO0FBVlI7QUFZTTtBQUNBO0FBQ0E7QUFWTjtBQUNBO0FBQ0E7QUFZQTtBQUNJO0FBQ0U7QUFWTjtBQUNBO0FBWUk7QUFWSjtBQUNBO0FBQ0E7QUFZQTtBQUNJO0FBQ0U7QUFDQTtBQVZOO0FBQ0E7QUFZSTtBQVZKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3p2QkE7QUFDQTtBQUNJO0FBQWtDO0FBRXRDO0FBQ0E7QUFESTtBQUdKO0FBREk7QUFHSjtBQURJO0FBR0o7QUFESTtBQUFrQztBQUl0QztBQUNBO0FBSEk7QUFBa0M7QUFNdEM7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQU5RO0FBQWlDO0FBU3pDO0FBQ0E7QUFSUTtBQVVSO0FBQ0E7QUFSUTtBQVVSO0FBUlk7QUFVWjtBQVJZO0FBVVo7QUFDQTtBQVBRO0FBU1I7QUFQWTtBQVNaO0FBUGdCO0FBU2hCO0FBUGdCO0FBU2hCO0FBQ0E7QUFDQTtBQU5RO0FBQW1DO0FBUzNDO0FBQ0E7QUFDQTtBQUNBO0FBUFE7QUFBaUM7QUFVekM7QUFDQTtBQVRRO0FBV1I7QUFDQTtBQVRRO0FBV1I7QUFUWTtBQVdaO0FBVFk7QUFXWjtBQUNBO0FBVFE7QUFXUjtBQVRZO0FBV1o7QUFUZ0I7QUFXaEI7QUFUZ0I7QUFXaEI7QUFDQTtBQUNBO0FBUlE7QUFBa0M7QUFXMUM7QUFDQTtBQVJRO0FBQWlDO0FBV3pDO0FBQ0E7QUFWUTtBQVlSO0FBVlE7QUFZUjtBQVZZO0FBWVo7QUFWWTtBQVlaO0FBQ0E7QUFUUTtBQVdSO0FBVFk7QUFXWjtBQVRnQjtBQVdoQjtBQVRnQjtBQVdoQjtBQUNBO0FBUlE7QUFBa0M7QUFXMUM7QUFDQTtBQUNBO0FBVkk7QUFZSjtBQVZJO0FBQWlDO0FBYXJDO0FBWkk7QUFjSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SEE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBSUk7QUFGSjtBQUlRO0FBRlI7QUFJUTtBQUZSO0FBSVE7QUFGUjtBQUlRO0FBRlI7QUFJUTtBQUZSO0FBSVE7QUFGUjtBQUlRO0FBRlI7QUFJUTtBQUZSO0FBSVk7QUFGWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRE07QUFHTjtBQUNBO0FBREk7QUFHSjtBQUNBO0FBSE07QUFLTjtBQUhJO0FBS0o7QUFITTtBQUtOO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFMUTtBQU9SO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFQUTtBQUNJO0FBU1o7QUFOWTtBQVFaO0FBQ0E7QUFOSTtBQUNFO0FBUU47QUFOSTtBQVFKO0FBQ0E7QUFSTTtBQVVOO0FBQ0E7QUFSSTtBQUNFO0FBVU47QUFDQTtBQUNBO0FBSk07QUFDRTtBQUNFO0FBTVY7QUFDQTtBQUpRO0FBQ0E7QUFNUjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFOTTtBQVFOO0FBTlE7QUFRUjtBQUNBO0FBTk07QUFRTjtBQUNBO0FBTkk7QUFRSjtBQUNBO0FBUk07QUFVTjtBQUNBO0FBUkk7QUFVSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWTTtBQVlOO0FBQ0E7QUFWSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFZUjtBQUNBO0FBQ0E7QUFWSTtBQUNFO0FBQ0E7QUFDRTtBQVlSO0FBQ0E7QUFDQTtBQUNBO0FBVkk7QUFZSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5SUE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ1M7QUFDVDtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ3BCO0FBQ29CO0FBQ3BCO0FBQ2dCO0FBQ2hCO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSztBQUNHO0FBQ0E7QUFDQTtBQUNSO0FBQ1M7QUFDQTtBQUNJO0FBQ2I7QUFFYTtBQUFiO0FBR2E7QUFEYjtBQUlhO0FBRmI7QUFJUztBQUNBO0FBQ0k7QUFGYjtBQUthO0FBSGI7QUFNYTtBQUpiO0FBT2E7QUFMYjtBQUNBO0FBT1M7QUFDSTtBQUxiO0FBT1M7QUFMVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvLyDnu5kgQXJyYXkg5re75Yqg5pa55rOVXG4vLyBhcnIuZmluZCguLi4pXG4vLyBhcnIuZmluZEluZGV4KC4uLilcbi8vIGFyci5pbmNsdWRlcyhlKVxuLy8gYXJyLnVuaXF1ZShlcXVhbEZ1bmN0aW9uLCBpc05ld0FycmF5KVxuLy8gQXJyYXkuZnJvbVxuLy8gQXJyYXkuZXF1YWxcbi8vIGFyci5pc0VxdWFsKG90aGVyQXJyYXksIGlzU3RyaWN0KVxuLy8gQXJyYXkuc29ydEJ5TnVtYmVyXG4vLyBhcnIuZmluZFN1YkFycmF5SW5kZXhzKFtdKSAgIOeUqOS6juafpeaJvuaVsOe7hOWGheeahOmDqOWIhuWFg+e0oOeahOe0ouW8lVxuLy8gYXJyLnRyYW5zbGF0aW9uV2l0aFN0YXJ0SW5kZXgoc3RhcnRJbmRleCkg5bCG5pWw57uE5YaF55qE5YWD57Sg5bmz56e7XG4vLyDlpoLvvJpbMSwgMiwgMywgNCwgNV0udHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleCgzKSA9PiBbNCw1LDEsMiwzXVxuLy8gYXJyLmtxX2luc2VydChpbmRleCwgZSkgICDmj5LlhaXkuIDkuKrlhYPntKBcbi8vIGFyci5rcV9leGNsdWRlcyhhcnJheSkgICAvLyDpmaTkuoZhcnJheeaVsOe7hOS4reeahOWFg+e0oFxuXG5cbm1vZHVsZS5leHBvcnRzID0ge307XG5cbmlmICghQXJyYXkucHJvdG90eXBlLmZpbmQpIHtcbiAgQXJyYXkucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbihwcmVkaWNhdGUpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgaWYgKHRoaXMgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJyYXkucHJvdG90eXBlLmZpbmQgY2FsbGVkIG9uIG51bGwgb3IgdW5kZWZpbmVkJyk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgcHJlZGljYXRlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdwcmVkaWNhdGUgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgfVxuICAgIHZhciBsaXN0ID0gT2JqZWN0KHRoaXMpO1xuICAgIHZhciBsZW5ndGggPSBsaXN0Lmxlbmd0aCA+Pj4gMDtcbiAgICB2YXIgdGhpc0FyZyA9IGFyZ3VtZW50c1sxXTtcbiAgICB2YXIgdmFsdWU7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YWx1ZSA9IGxpc3RbaV07XG4gICAgICBpZiAocHJlZGljYXRlLmNhbGwodGhpc0FyZywgdmFsdWUsIGksIGxpc3QpKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUuZmluZEluZGV4KSB7XG4gIEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXggPSBmdW5jdGlvbihwcmVkaWNhdGUpIHtcbiAgICBpZiAodGhpcyA9PT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleCBjYWxsZWQgb24gbnVsbCBvciB1bmRlZmluZWQnKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBwcmVkaWNhdGUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ByZWRpY2F0ZSBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG4gICAgdmFyIGxpc3QgPSBPYmplY3QodGhpcyk7XG4gICAgdmFyIGxlbmd0aCA9IGxpc3QubGVuZ3RoID4+PiAwO1xuICAgIHZhciB0aGlzQXJnID0gYXJndW1lbnRzWzFdO1xuICAgIHZhciB2YWx1ZTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhbHVlID0gbGlzdFtpXTtcbiAgICAgIGlmIChwcmVkaWNhdGUuY2FsbCh0aGlzQXJnLCB2YWx1ZSwgaSwgbGlzdCkpIHtcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAtMTtcbiAgfTtcbn1cblxuXG4vLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1hcnJheS5wcm90b3R5cGUuaW5jbHVkZXNcbmlmICghQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpbmNsdWRlcycsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oc2VhcmNoRWxlbWVudCwgZnJvbUluZGV4KSB7XG5cbiAgICAgIC8vIDEuIExldCBPIGJlID8gVG9PYmplY3QodGhpcyB2YWx1ZSkuXG4gICAgICBpZiAodGhpcyA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1widGhpc1wiIGlzIG51bGwgb3Igbm90IGRlZmluZWQnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG8gPSBPYmplY3QodGhpcyk7XG5cbiAgICAgIC8vIDIuIExldCBsZW4gYmUgPyBUb0xlbmd0aCg/IEdldChPLCBcImxlbmd0aFwiKSkuXG4gICAgICB2YXIgbGVuID0gby5sZW5ndGggPj4+IDA7XG5cbiAgICAgIC8vIDMuIElmIGxlbiBpcyAwLCByZXR1cm4gZmFsc2UuXG4gICAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gNC4gTGV0IG4gYmUgPyBUb0ludGVnZXIoZnJvbUluZGV4KS5cbiAgICAgIC8vICAgIChJZiBmcm9tSW5kZXggaXMgdW5kZWZpbmVkLCB0aGlzIHN0ZXAgcHJvZHVjZXMgdGhlIHZhbHVlIDAuKVxuICAgICAgdmFyIG4gPSBmcm9tSW5kZXggfCAwO1xuXG4gICAgICAvLyA1LiBJZiBuIOKJpSAwLCB0aGVuXG4gICAgICAvLyAgYS4gTGV0IGsgYmUgbi5cbiAgICAgIC8vIDYuIEVsc2UgbiA8IDAsXG4gICAgICAvLyAgYS4gTGV0IGsgYmUgbGVuICsgbi5cbiAgICAgIC8vICBiLiBJZiBrIDwgMCwgbGV0IGsgYmUgMC5cbiAgICAgIHZhciBrID0gTWF0aC5tYXgobiA+PSAwID8gbiA6IGxlbiAtIE1hdGguYWJzKG4pLCAwKTtcblxuICAgICAgLy8gNy4gUmVwZWF0LCB3aGlsZSBrIDwgbGVuXG4gICAgICB3aGlsZSAoayA8IGxlbikge1xuICAgICAgICAvLyBhLiBMZXQgZWxlbWVudEsgYmUgdGhlIHJlc3VsdCBvZiA/IEdldChPLCAhIFRvU3RyaW5nKGspKS5cbiAgICAgICAgLy8gYi4gSWYgU2FtZVZhbHVlWmVybyhzZWFyY2hFbGVtZW50LCBlbGVtZW50SykgaXMgdHJ1ZSwgcmV0dXJuIHRydWUuXG4gICAgICAgIC8vIGMuIEluY3JlYXNlIGsgYnkgMS5cbiAgICAgICAgLy8gTk9URTogPT09IHByb3ZpZGVzIHRoZSBjb3JyZWN0IFwiU2FtZVZhbHVlWmVyb1wiIGNvbXBhcmlzb24gbmVlZGVkIGhlcmUuXG4gICAgICAgIGlmIChvW2tdID09PSBzZWFyY2hFbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaysrO1xuICAgICAgfVxuXG4gICAgICAvLyA4LiBSZXR1cm4gZmFsc2VcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0pO1xufVxuXG4vLyB1bmlxdWVcbmlmICghQXJyYXkucHJvdG90eXBlLnVuaXF1ZSkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAndW5pcXVlJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihlcXVhbEZ1bmN0aW9uLCBuZXdBcnJheSA9IHRydWUpIHtcbiAgICAgIGlmIChuZXdBcnJheSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdW5xaXVlX25ldyhlcXVhbEZ1bmN0aW9uKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3VucWl1ZShlcXVhbEZ1bmN0aW9uKTtcbiAgICB9LFxuICB9KTtcblxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnX3VucWl1ZV9uZXcnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKGVxdWFsRnVuY3Rpb24pIHtcbiAgICAgIGxldCBhcnJheSA9IEFycmF5LmZyb20odGhpcyk7XG5cbiAgICAgIHJldHVybiBhcnJheS5fdW5xaXVlKGVxdWFsRnVuY3Rpb24pO1xuICAgIH1cbiAgfSk7XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ191bnFpdWUnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKGVxdWFsRnVuY3Rpb24pIHtcbiAgICAgIHZhciBsZW4gPSB0aGlzLmxlbmd0aDtcbiAgICAgIHZhciBpID0gLTE7XG5cbiAgICAgIHdoaWxlIChpKysgPCBsZW4pIHtcbiAgICAgICAgdmFyIGogPSBpICsgMTtcblxuICAgICAgICBmb3IgKDsgaiA8IHRoaXMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICB2YXIgaXNFcXVhbCA9IGZhbHNlO1xuICAgICAgICAgIGlmIChlcXVhbEZ1bmN0aW9uKSB7XG4gICAgICAgICAgICBpc0VxdWFsID0gZXF1YWxGdW5jdGlvbih0aGlzW2ldLCB0aGlzW2pdKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaXNFcXVhbCA9IHRoaXNbaV0gPT09IHRoaXNbal07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGlzRXF1YWwpIHtcbiAgICAgICAgICAgIHRoaXMuc3BsaWNlKGotLSwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICB9KTtcbn1cblxuXG4vLyBQcm9kdWN0aW9uIHN0ZXBzIG9mIEVDTUEtMjYyLCBFZGl0aW9uIDYsIDIyLjEuMi4xXG4vLyBSZWZlcmVuY2U6IGh0dHBzOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy1hcnJheS5mcm9tXG5pZiAoIUFycmF5LmZyb20pIHtcbiAgQXJyYXkuZnJvbSA9IChmdW5jdGlvbigpIHtcbiAgICB2YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuICAgIHZhciBpc0NhbGxhYmxlID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgIHJldHVybiB0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicgfHwgdG9TdHIuY2FsbChmbikgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG4gICAgfTtcbiAgICB2YXIgdG9JbnRlZ2VyID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBudW1iZXIgPSBOdW1iZXIodmFsdWUpO1xuICAgICAgaWYgKGlzTmFOKG51bWJlcikpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgICBpZiAobnVtYmVyID09PSAwIHx8ICFpc0Zpbml0ZShudW1iZXIpKSB7XG4gICAgICAgIHJldHVybiBudW1iZXI7XG4gICAgICB9XG4gICAgICByZXR1cm4gKG51bWJlciA+IDAgPyAxIDogLTEpICogTWF0aC5mbG9vcihNYXRoLmFicyhudW1iZXIpKTtcbiAgICB9O1xuICAgIHZhciBtYXhTYWZlSW50ZWdlciA9IE1hdGgucG93KDIsIDUzKSAtIDE7XG4gICAgdmFyIHRvTGVuZ3RoID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBsZW4gPSB0b0ludGVnZXIodmFsdWUpO1xuICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KGxlbiwgMCksIG1heFNhZmVJbnRlZ2VyKTtcbiAgICB9O1xuXG4gICAgLy8gVGhlIGxlbmd0aCBwcm9wZXJ0eSBvZiB0aGUgZnJvbSBtZXRob2QgaXMgMS5cbiAgICByZXR1cm4gZnVuY3Rpb24gZnJvbShhcnJheUxpa2UgLyosIG1hcEZuLCB0aGlzQXJnICovICkge1xuICAgICAgLy8gMS4gTGV0IEMgYmUgdGhlIHRoaXMgdmFsdWUuXG4gICAgICB2YXIgQyA9IHRoaXM7XG5cbiAgICAgIC8vIDIuIExldCBpdGVtcyBiZSBUb09iamVjdChhcnJheUxpa2UpLlxuICAgICAgdmFyIGl0ZW1zID0gT2JqZWN0KGFycmF5TGlrZSk7XG5cbiAgICAgIC8vIDMuIFJldHVybklmQWJydXB0KGl0ZW1zKS5cbiAgICAgIGlmIChhcnJheUxpa2UgPT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQXJyYXkuZnJvbSByZXF1aXJlcyBhbiBhcnJheS1saWtlIG9iamVjdCAtIG5vdCBudWxsIG9yIHVuZGVmaW5lZFwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gNC4gSWYgbWFwZm4gaXMgdW5kZWZpbmVkLCB0aGVuIGxldCBtYXBwaW5nIGJlIGZhbHNlLlxuICAgICAgdmFyIG1hcEZuID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB2b2lkIHVuZGVmaW5lZDtcbiAgICAgIHZhciBUO1xuICAgICAgaWYgKHR5cGVvZiBtYXBGbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgLy8gNS4gZWxzZVxuICAgICAgICAvLyA1LiBhIElmIElzQ2FsbGFibGUobWFwZm4pIGlzIGZhbHNlLCB0aHJvdyBhIFR5cGVFcnJvciBleGNlcHRpb24uXG4gICAgICAgIGlmICghaXNDYWxsYWJsZShtYXBGbikpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcnJheS5mcm9tOiB3aGVuIHByb3ZpZGVkLCB0aGUgc2Vjb25kIGFyZ3VtZW50IG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gNS4gYi4gSWYgdGhpc0FyZyB3YXMgc3VwcGxpZWQsIGxldCBUIGJlIHRoaXNBcmc7IGVsc2UgbGV0IFQgYmUgdW5kZWZpbmVkLlxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICBUID0gYXJndW1lbnRzWzJdO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIDEwLiBMZXQgbGVuVmFsdWUgYmUgR2V0KGl0ZW1zLCBcImxlbmd0aFwiKS5cbiAgICAgIC8vIDExLiBMZXQgbGVuIGJlIFRvTGVuZ3RoKGxlblZhbHVlKS5cbiAgICAgIHZhciBsZW4gPSB0b0xlbmd0aChpdGVtcy5sZW5ndGgpO1xuXG4gICAgICAvLyAxMy4gSWYgSXNDb25zdHJ1Y3RvcihDKSBpcyB0cnVlLCB0aGVuXG4gICAgICAvLyAxMy4gYS4gTGV0IEEgYmUgdGhlIHJlc3VsdCBvZiBjYWxsaW5nIHRoZSBbW0NvbnN0cnVjdF1dIGludGVybmFsIG1ldGhvZCBvZiBDIHdpdGggYW4gYXJndW1lbnQgbGlzdCBjb250YWluaW5nIHRoZSBzaW5nbGUgaXRlbSBsZW4uXG4gICAgICAvLyAxNC4gYS4gRWxzZSwgTGV0IEEgYmUgQXJyYXlDcmVhdGUobGVuKS5cbiAgICAgIHZhciBBID0gaXNDYWxsYWJsZShDKSA/IE9iamVjdChuZXcgQyhsZW4pKSA6IG5ldyBBcnJheShsZW4pO1xuXG4gICAgICAvLyAxNi4gTGV0IGsgYmUgMC5cbiAgICAgIHZhciBrID0gMDtcbiAgICAgIC8vIDE3LiBSZXBlYXQsIHdoaWxlIGsgPCBsZW7igKYgKGFsc28gc3RlcHMgYSAtIGgpXG4gICAgICB2YXIga1ZhbHVlO1xuICAgICAgd2hpbGUgKGsgPCBsZW4pIHtcbiAgICAgICAga1ZhbHVlID0gaXRlbXNba107XG4gICAgICAgIGlmIChtYXBGbikge1xuICAgICAgICAgIEFba10gPSB0eXBlb2YgVCA9PT0gJ3VuZGVmaW5lZCcgPyBtYXBGbihrVmFsdWUsIGspIDogbWFwRm4uY2FsbChULCBrVmFsdWUsIGspO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIEFba10gPSBrVmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgayArPSAxO1xuICAgICAgfVxuICAgICAgLy8gMTguIExldCBwdXRTdGF0dXMgYmUgUHV0KEEsIFwibGVuZ3RoXCIsIGxlbiwgdHJ1ZSkuXG4gICAgICBBLmxlbmd0aCA9IGxlbjtcbiAgICAgIC8vIDIwLiBSZXR1cm4gQS5cbiAgICAgIHJldHVybiBBO1xuICAgIH07XG4gIH0oKSk7XG59XG5cbmlmICghQXJyYXkuZXF1YWwpIHtcbiAgQXJyYXkuZXF1YWwgPSBmdW5jdGlvbihhcnIxLCBhcnIyLCBzdHJpY3QgPSB0cnVlKSB7XG4gICAgaWYgKGFycjEgPT09IHVuZGVmaW5lZCB8fCBhcnIyID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgbGVuZ3RoID0gYXJyMS5sZW5ndGhcbiAgICBpZiAobGVuZ3RoICE9PSBhcnIyLmxlbmd0aCkgcmV0dXJuIGZhbHNlXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHN0cmljdCkge1xuICAgICAgICBpZiAoYXJyMVtpXSAhPT0gYXJyMltpXSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgdmFsdWUxID0gYXJyMVtpXTtcbiAgICAgICAgdmFyIHZhbHVlMiA9IGFycjJbaV07XG4gICAgICAgIHZhciByZXN1bHQgPSB0cnVlO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZTEpICYmIEFycmF5LmlzQXJyYXkodmFsdWUyKSkge1xuICAgICAgICAgIHJlc3VsdCA9IEFycmF5LmVxdWFsKHZhbHVlMSwgdmFsdWUyLCBzdHJpY3QpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdCA9ICh2YWx1ZTEgPT0gdmFsdWUyKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWVcbiAgfTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUuaXNFcXVhbCkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnaXNFcXVhbCcsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24ob3RoZXJBcnJheSwgc3RyaWN0ID0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIEFycmF5LmVxdWFsKHRoaXMsIG90aGVyQXJyYXksIHN0cmljdCk7XG4gICAgfSxcbiAgfSk7XG59XG5cbmlmICghQXJyYXkuc29ydEJ5TnVtYmVyKSB7XG4gIEFycmF5LnNvcnRCeU51bWJlciA9IGZ1bmN0aW9uIChuMSwgbjIsIGFzYyA9IHRydWUpIHtcbiAgICByZXR1cm4gKG4xIC0gbjIpICogKGFzYyA/IDEgOiAtMSk7XG4gIH07XG59XG5cbmlmICghQXJyYXkucHJvdG90eXBlLmZpbmRTdWJBcnJheUluZGV4cykge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnZmluZFN1YkFycmF5SW5kZXhzJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoc3ViQXJyYXksIGYpIHtcbiAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgaW4gc3ViQXJyYXkpIHtcbiAgICAgICAgbGV0IHN1YlZhbHVlID0gc3ViQXJyYXlbaV07XG4gICAgICAgIGxldCBmaW5kRnVuYyA9IGYgfHwgZnVuY3Rpb24gKHRoaXNWYWx1ZSkge1xuICAgICAgICAgIHJldHVybiBzdWJWYWx1ZSA9PT0gdGhpc1ZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBpbmRleCA9IHRoaXMuZmluZEluZGV4KGZpbmRGdW5jKTtcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICBpbmRleHMucHVzaChpbmRleCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaW5kZXhzID0gW107XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGluZGV4cy5sZW5ndGggPiAwID8gaW5kZXhzIDogbnVsbDtcbiAgICB9LFxuICB9KTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUudHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleCkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAndHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleCcsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24gKHN0YXJ0SW5kZXgpIHtcbiAgICAgIGlmIChzdGFydEluZGV4ID09IDApIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGlmIChzdGFydEluZGV4ID49IHRoaXMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICBsZXQgcHJlID0gdGhpcy5zbGljZShzdGFydEluZGV4KTtcbiAgICAgIGxldCBsYXN0ID0gdGhpcy5zbGljZSgwLCBzdGFydEluZGV4KTtcbiAgICAgIGxldCByZXN1bHQgPSBwcmUuY29uY2F0KGxhc3QpO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG4gIH0pO1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS5rcV9pbnNlcnQpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2txX2luc2VydCcsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oaW5kZXgsIGUpIHtcbiAgICAgIGlmIChlID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGlmIChpbmRleCA+PSB0aGlzLmxlbmd0aCkge1xuICAgICAgICB0aGlzLnB1c2goZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5zcGxpY2UoaW5kZXgsIDAsIGUpO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICB9KTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUua3FfZXhjbHVkZXMpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2txX2V4Y2x1ZGVzJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihvdGhlckFycmF5KSB7XG4gICAgICBpZiAob3RoZXJBcnJheSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICBsZXQgcmVzdWx0ID0gW107XG4gICAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICBpZiAoIW90aGVyQXJyYXkuaW5jbHVkZXMoZWxlbWVudCkpIHtcbiAgICAgICAgICByZXN1bHQucHVzaChlbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcbiAgfSk7XG59XG5cbi8qXG5pZighQXJyYXkucHJvdG90eXBlLm1pbil7XG4gIEFycmF5LnByb3RvdHlwZS5taW4gPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbWluID0gdGhpc1swXTtcbiAgICB2YXIgbGVuID0gdGhpcy5sZW5ndGg7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgaWYgKHRoaXNbaV0gPCBtaW4pIHtcbiAgICAgICAgbWluID0gdGhpc1tpXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1pbjtcbiAgfVxufSovXG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcblxubGV0IEF1ZGlvTWFuYWdlciA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGhhbGxfYmdtOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcblxuICAgICAgICAvLyDmiZPmnqpcbiAgICAgICAgZGFRaWFuZzoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICAgICAgZmFwYWk6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuXG4gICAgICAgIHdpbmRvdzoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICAgICAgY2xpY2tfd2VpeGluX2xvZ2luOntcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuXG4gICAgICAgIGZhbmdQYWk6e1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICB9LFxuXG4gICAgc3RhdGljczoge1xuICAgICAgICBpbnN0YW5jZTogbnVsbCxcbiAgICB9LFxuXG4gICAgb25Mb2FkOmZ1bmN0aW9uKCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UgPSB0aGlzO1xuICAgICAgICB0aGlzLl9yZWdpc3RlckFwcEFjdGl2ZUNoYW5nZSgpO1xuXG4gICAgICAgIHRoaXMuc291bmRPbiA9IHRydWU7XG4gICAgICAgIGNjLmdhbWUuYWRkUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSk7XG4gICAgICAgIGlmIChjYy5nYW1lLmlzUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSkpIHtcbiAgICAgICAgICAgIC8vIGNjLmxvZygn5re75Yqg5YWo5bGA6IqC54K55oiQ5YqfJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tVmFsdWUgPSBtYW5hZ2VyLmdldE11c2ljVmFsdWUoKTtcbiAgICAgICAgdGhpcy5tRVZhbHVlID0gbWFuYWdlci5nZXRNdXNpY0VmZmVjdFZhbHVlKCk7XG4gICAgICAgIHRoaXMuYmdBdWRpb0lkID0gLTE7XG4gICAgfSxcblxuICAgIHN0b3BIYWxsTXVzaWM6IGZ1bmN0aW9uKCl7XG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnN0b3AodGhpcy5iZ0F1ZGlvSWQpO1xuICAgIH0sXG5cbiAgICBwbGF5TXVzaWM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmJnQXVkaW9JZCA9IGNjLmF1ZGlvRW5naW5lLnBsYXlNdXNpYyggdGhpcy5oYWxsX2JnbSwgdHJ1ZSk7XG4gICAgICAgIGlmICh0aGlzLmJnQXVkaW9JZCAhPSAtMSkge1xuICAgICAgICAgICAgLy9jYy5sb2coJ3BsYXknKTtcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnNldFZvbHVtZSh0aGlzLmJnQXVkaW9JZCx0aGlzLm1WYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9jYy5hdWRpb0VuZ2luZS5wbGF5TXVzaWMoIHVybCwgdHJ1ZSApXG4gICAgfSxcblxuXG4gICAgcGxheUNvbXBhcmVDYXJkc011c2ljOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYmdBdWRpb0lkID0gY2MuYXVkaW9FbmdpbmUucGxheU11c2ljKCB0aGlzLmhhbGxfYmdtLCB0cnVlKTtcbiAgICAgICAgaWYgKHRoaXMuYmdBdWRpb0lkICE9IC0xKSB7XG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUodGhpcy5iZ0F1ZGlvSWQsdGhpcy5tVmFsdWUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHBsYXlEYVFpYW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgc3RhcnQgPD0gMS42OyBzdGFydCA9IHN0YXJ0ICsgMC41KSB7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmRhUWlhbmcpO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCBzdGFydCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8g4oCc5omT5p6q4oCdXG4gICAgcGxheUh1bWFuRGFRaWFuZzogZnVuY3Rpb24gKHNleCA9IDEpIHtcbiAgICAgICAgdmFyIHBhdGggPSBcInJlc291cmNlcy9zb3VuZHMvbWFuXCIvKiArIChzZXggPT0gMSA/IFwibWFuXCIgOiBcIndvbWFuXCIpKi87XG4gICAgICAgIHBhdGggPSBwYXRoICsgXCIvZGFxaWFuZzEubXAzXCI7XG5cbiAgICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcocGF0aCk7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgLy8g4oCc5Lit5p6q4oCdXG4gICAgcGxheUh1bWFuWlFpYW5nOiBmdW5jdGlvbiAoc2V4ID0gMSkge1xuICAgICAgICB2YXIgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9tYW5cIi8qICsgKHNleCA9PSAxID8gXCJtYW5cIiA6IFwid29tYW5cIikqLztcbiAgICAgICAgcGF0aCA9IHBhdGggKyBcIi9kYXFpYW5nMy5tcDNcIjtcblxuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICBwbGF5UG9rZXJDbGljazogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdygncmVzb3VyY2VzL3NvdW5kcy9wdWJsaWMvY2xpY2tfd3hfbG9naW4ubXAzJyk7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5YWo5Z6S5omT6Z+z5pWIXG4gICAgcGxheUhvbWVSdW46IGZ1bmN0aW9uIChzZXggPSAxKSB7XG4gICAgICAgIGxldCBwYXRoID0gdGhpcy5fc291bmRzSHVtYW5QYXRoKHNleCkgKyBcInNwZWNpYWwxLm1wM1wiO1xuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICAvLyDmkq3mlL7lj5HniYzpn7PmlYhcbiAgICBwbGF5RmFQYWk6IGZ1bmN0aW9uKCkge1xuICAgICAgICBsZXQgcGF0aDEgPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoMSkgKyBcInJvb21fc3RhcnRfY29tcGFyZS5tcDNcIjtcbiAgICAgICAgbGV0IHVybDEgPSBjYy51cmwucmF3KHBhdGgxKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwxKTtcbiAgICAgICAgLy9sZXQgcG9rZXJEZWFsID0gdGhpcy5fc291bmRzSHVtYW5QYXRoKDEpICsgXCJwb2tlcl9kZWFsLm1wM1wiO1xuICAgICAgICAvL2xldCB1cmxQb2tlckRlYWwgPSBjYy51cmwucmF3KHBva2VyRGVhbCk7XG4gICAgICAgIC8vdGhpcy5fcGxheVNGWCh1cmxQb2tlckRlYWwpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuZmFwYWkpO1xuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgNjsgaW5kZXgrKykge1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmZhcGFpKTtcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgaW5kZXggKiAwLjEpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHBsYXlDYXJkVHlwZTogZnVuY3Rpb24gKHNleCA9IDEsIHR5cGUgPSAtMSkge1xuICAgICAgICAvLyDlj6rmkq3mlL7mma7pgJrnsbvlnovnmoTor63pn7NcbiAgICAgICAgaWYgKCh0eXBlID49IDEwKSB8fCAodHlwZSA8IDApKSB7XG4gICAgICAgICAgICAvLyAxMCDlj4rku6XkuIrmmK/nibnmrorniYxcbiAgICAgICAgICAgIGxldCBwYXRoID0gdGhpcy5fc291bmRzSHVtYW5QYXRoKHNleCkgKyAodHlwZSkgKyBcIi5tcDNcIjtcbiAgICAgICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHBhdGggPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoc2V4KSArIFwiY29tbW9uXCIgKyAodHlwZSArIDEpICsgXCIubXAzXCI7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIC8vIOaSreaUviDlvIDlp4vmr5TniYxcbiAgICBwbGF5U3RhcnRDb21wYXJlOiBmdW5jdGlvbiAoc2V4ID0gMSkge1xuICAgICAgICBsZXQgcGF0aCA9IHRoaXMuX3NvdW5kc0h1bWFuUGF0aChzZXgpICsgXCJzdGFydF9jb21wYXJlLm1wM1wiO1xuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICBwbGF5V2luOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KCdyZXNvdXJjZXMvc291bmRzL29wZW5mYWNlL3dpbi5tcDMnKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICBwbGF5TG9zZTogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdygncmVzb3VyY2VzL3NvdW5kcy9vcGVuZmFjZS9sb3NlLm1wMycpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIGNvaW5JbmNvbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcoJ3Jlc291cmNlcy9zb3VuZHMvb3BlbmZhY2UvY29pbl9pbmNvbWUubXAzJyk7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgX3NvdW5kc0h1bWFuUGF0aDogZnVuY3Rpb24gKHNleCkge1xuICAgICAgICBsZXQgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9tYW4vXCIvKiArIChzZXggPT0gMSA/IFwibWFuXCIgOiBcIndvbWFuXCIpICsgXCIvXCIqLztcbiAgICAgICAgcmV0dXJuIHBhdGg7XG4gICAgfSxcblxuICAgIHNldEJnTXVzaWNWb2x1bW46IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubVZhbHVlID0gdmFsdWU7XG4gICAgICAgIGlmICh0aGlzLmJnQXVkaW9JZCAhPSAtMSkge1xuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc2V0Vm9sdW1lKHRoaXMuYmdBdWRpb0lkLHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzZXRFZmZlY3RNdXNpY1ZvbHVtOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB0aGlzLm1FVmFsdWUgPSB2YWx1ZTtcbiAgICB9LFxuXG4gICAgLyrogYrlpKkqL1xuICAgIHBsYXlDaGF0QXVkaW86ZnVuY3Rpb24oc2V4LCBzdHIpIHtcbiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5jaGF0VGV4dHMoKS5pbmRleE9mKHN0cik7XG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbnVtYmVyID0gXCJDSEFUXCIrKGluZGV4KzEpO1xuICAgICAgICBsZXQgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9jaGF0L1wiICsgbnVtYmVyICsgXCIubXAzXCI7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIGNoYXRUZXh0czogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgJ+i/mOS4jeWHuueJjO+8jOaIkemDveW/q+WOu+WQg+mUhei+ueeziuS6hicsXG4gICAgICAgICAgICAn5Zeo5ZGA77yM5oiR5a626YeM6ICB5Lq66YO95q+U5L2g5omT55qE5b+rJyxcbiAgICAgICAgICAgICfll6jlkYDvvIzmiZPniYzmiZPnmoTmiJHpg73lm7DkuoYnLFxuICAgICAgICAgICAgJ+WTju+8jOS9oOW/q+aFouaFouaJvu+8jOaIkeWFiOWOu+ilv+a5lumAm+S4gOS4iycsXG4gICAgICAgICAgICAn5b+r5LiA54K55ZGA77yM5oiR562J5L2g5oOz5aW95oiR5Y6V5omA6YO95LiK5LiA6Laf5LqGJyxcbiAgICAgICAgICAgICfkvaDov5nlnKjlubLlmJvvvIzov5nkuYjmhaInLFxuICAgICAgICAgICAgJ+WXqOWRgO+8jOacgOi/keWcqOW/meS7gOS5iO+8jOW+iOS5heayoeingeS6hicsXG4gICAgICAgICAgICAn5p2l5p2l5p2l77yM5LiJ57y65LiAJyxcbiAgICAgICAgICAgICfmnaXmnaXmnaXvvIzotbbntKflnZDkuIvmnaXmiZPkuIDlnIgnLFxuICAgICAgICAgICAgJ+i3n+S9oOS7rOi/meS6m+mrmOaJi+aJk+aIkeS8mue0p+W8oO+8jOiuqeaIkeS4gOeCuScsXG4gICAgICAgICAgICAn6Juu5pma5Yiw5aSp5Lqu77yM6L6T5LqG5Y+v5Lul6K6p5L2g5Lus5YWI5qyg552AJ1xuICAgICAgICBdO1xuICAgIH0sXG5cbiAgICBwYXVzZU11c2ljOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zb3VuZE9uID0gZmFsc2U7XG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnBhdXNlTXVzaWMoKTtcbiAgICB9LFxuXG4gICAgcmVzdW1lTXVzaWM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNvdW5kT24gPSB0cnVlO1xuICAgICAgICBjYy5hdWRpb0VuZ2luZS5yZXN1bWVNdXNpYygpO1xuICAgIH0sXG5cbiAgICBfcGxheVNGWDogZnVuY3Rpb24oY2xpcCkge1xuICAgICAgICBpZiAodGhpcy5zb3VuZE9uKSB7XG4gICAgICAgICAgICB2YXIgYXVkaW9JZCA9IGNjLmF1ZGlvRW5naW5lLnBsYXlFZmZlY3QoIGNsaXAsIGZhbHNlICk7XG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUoYXVkaW9JZCx0aGlzLm1FVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIGF1ZGlvSWQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgLy8gTUFSSzog5YmN5ZCO5Y+w5pON5L2cXG4gICAgX3JlZ2lzdGVyQXBwQWN0aXZlQ2hhbmdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNjLmdhbWUub24oY2MuZ2FtZS5FVkVOVF9ISURFLCB0aGlzLl9hcHBFbnRlckJhY2tncm91bmQsIHRoaXMpO1xuICAgICAgICBjYy5nYW1lLm9uKGNjLmdhbWUuRVZFTlRfU0hPVywgdGhpcy5fYXBwQmVjb21BY3RpdmUsIHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDov5vlhaXlkI7lj7BcbiAgICAgKi9cbiAgICBfYXBwRW50ZXJCYWNrZ3JvdW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCBub3cgPSBjYy5zeXMubm93KCk7XG4gICAgICAgIGlmIChub3cgLSB0aGlzLl9sYXN0QXBwRW50ZXJCYWNrZ3JvdW5kVGltZSA8IDEwMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xhc3RBcHBFbnRlckJhY2tncm91bmRUaW1lID0gbm93O1xuXG4gICAgICAgIHRoaXMucGF1c2VNdXNpYygpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDov5vlhaXliY3lj7BcbiAgICAgKi9cbiAgICBfYXBwQmVjb21BY3RpdmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcbiAgICAgICAgaWYgKG5vdyAtIHRoaXMuX2xhc3RBcHBCZWNvbUFjdGl2ZVRpbWUgPCAxMDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sYXN0QXBwQmVjb21BY3RpdmVUaW1lID0gbm93O1xuXG4gICAgICAgIHRoaXMucmVzdW1lTXVzaWMoKTtcbiAgICB9LFxuXG4gICAgLyrnoa7lrprmjInpkq7pn7PmlYgqL1xuICAgIHBsYXlCdG5DbGlja1NGWDpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX3dlaXhpbl9sb2dpbik7XG4gICAgfSxcbiAgICAvKuWFrOWFseaMiemSru+8jOaMiemUruaIluiAheWFs+mXreaMiemSruS5i+exu+eahOmfs+aViCovXG4gICAgcGFseUJ0blB1YmxpY1NGWDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5jbGlja193ZWl4aW5fbG9naW4pO1xuICAgIH0sXG5cbiAgICAvKuWPlua2iOaMiemSrumfs+aViCovXG4gICAgcGFseUJ0bkNhbmNlbENsaWNrU0ZYOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX3dlaXhpbl9sb2dpbik7XG4gICAgfSxcbiAgICBwYWx5QnRuQ3JlYXRlUm9vbVNGWDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5jbGlja193ZWl4aW5fbG9naW4pO1xuICAgIH0sXG4gICAgcGFseVdpbmRvd1NGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMud2luZG93KTtcbiAgICB9LFxuICAgIHBhbHlXZWlYaW5Mb2dpblNGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuY2xpY2tfd2VpeGluX2xvZ2luKTtcbiAgICB9LFxuICAgIHBhbHlGYW5nUGFpU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5mYW5nUGFpKTtcbiAgICB9LFxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBBdWRpb01hbmFnZXI7XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgZ3JheVNwcml0ZTogY2MuU3ByaXRlLFxuXG4gICAgICAgIF9jYXJkTmFtZTogbnVsbCxcbiAgICAgICAgX2txQ2FyZE1vZGU6IG51bGxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmdyYXlTcHJpdGUubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLy8g6YCa6L+H54mM5ZCN6K6+572u54mMXG4gICAgc2V0Q2FyZDogZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICB0aGlzLl9zZXRDYXJkTmFtZShjYXJkTmFtZSk7XG5cbiAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUoY2FyZE5hbWUsIGZ1bmN0aW9uIChzcHJpdGVGcmFtZSkge1xuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2FyZE5hbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jYXJkTmFtZTtcbiAgICB9LFxuXG4gICAgY2FyZE1vZGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9rcUNhcmRNb2RlO1xuICAgIH0sXG5cbiAgICBfc2V0Q2FyZE5hbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSkge1xuICAgICAgdGhpcy5fY2FyZE5hbWUgPSBjYXJkTmFtZTtcbiAgICAgIHRoaXMuX2txQ2FyZE1vZGUgPSBuZXcgS1FDYXJkKGNhcmROYW1lKTtcbiAgICB9LFxuXG4gICAgLy8g6K6+572u6YCJ5oup54q25oCBXG4gICAgc2V0U2VsZWN0ZWQ6IGZ1bmN0aW9uIChzZWxlY3RlZCA9IGZhbHNlKSB7XG4gICAgICB0aGlzLmdyYXlTcHJpdGUubm9kZS5hY3RpdmUgPSBzZWxlY3RlZDtcbiAgICB9LFxuXG4gICAgaXNTZWxlY3RlZDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ3JheVNwcml0ZS5ub2RlLmFjdGl2ZTtcbiAgICB9LFxuXG4gICAgX2NhcmRGdWxsTmFtZTogZnVuY3Rpb24gKGNhcmRTaG9ydE5hbWUpIHtcbiAgICAgIHZhciBjYXJkTmFtZSA9IGNhcmRTaG9ydE5hbWU7XG4gICAgICBpZiAoIWNhcmROYW1lLnN0YXJ0c1dpdGgoXCJwdWJsaWMtcGljLWNhcmQtcG9rZXJcIikpIHtcbiAgICAgICAgY2FyZE5hbWUgPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY2FyZE5hbWU7XG4gICAgfSxcblxuICAgIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICBjYy5hc3NlcnQoY2FsbGJhY2spO1xuXG4gICAgICBjYy5sb2FkZXIubG9hZFJlcyhcInBsYXkvQ2FyZFR5cGVDb21iaW5lL3BvY2tMaXN0XCIsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY2MuZXJyb3IoZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjYXJkTmFtZSA9IHRoaXMuX2NhcmRGdWxsTmFtZShjYXJkTmFtZSk7XG4gICAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcbiAgICAgICAgY2FsbGJhY2soZnJhbWUpO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY29uc3QgcGxheSA9IHJlcXVpcmUoJ3BsYXknKTtcbmNvbnN0IEtRQ2FyZFNjb3JldHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRTY29yZXRzSGVscGVyJyk7XG4vLyDniYznsbvlnosgY29tcG9uZW50XG4vL1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcbiAgICBzdGF0aWNzOiB7XG4gICAgICAgIGluc3RhbmNlczogbnVsbCxcbiAgICB9LFxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgY2FyZHNMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgLy8gYnRuRHVpWmk6IGNjLkJ1dHRvbixcbiAgICAgICAgLy8gYnRuTGlhbmdEdWk6IGNjLkJ1dHRvbixcbiAgICAgICAgLy8gYnRuU2FuVGlhbzogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5TaHVuWmk6IGNjLkJ1dHRvbixcbiAgICAgICAgLy8gYnRuVG9uZ0h1YTogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5IdUx1OiBjYy5CdXR0b24sXG4gICAgICAgIC8vIGJ0blRpZVpoaTogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5Ub25nSHVhU2h1bjogY2MuQnV0dG9uLFxuICAgICAgICAvLyBidG5XdVRvbmc6IGNjLkJ1dHRvbixcbiAgICAgICAgLy8gdHlwZUJ1dHRvbnNOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBidG5EZWxldGVUb3VEYW86IGNjLkJ1dHRvbiwgICAvLyDlpLTpgZNcbiAgICAgICAgYnRuRGVsZXRlWmhvbmdEYW86IGNjLkJ1dHRvbiwgLy8g5Lit6YGTXG4gICAgICAgIGJ0bkRlbGV0ZVdlaURhbzogY2MuQnV0dG9uLCAgIC8vIOWwvumBk1xuICAgICAgICBidG5DYW5jZWxBbGw6IGNjLkJ1dHRvbiwgICAgICAvLyDlhajpg6jlj5bmtohcbiAgICAgICAgYnRuRG9uZTogY2MuQnV0dG9uLCAgICAgICAgICAgLy8g56Gu5a6a5Ye654mMXG4gICAgICAgIHRpbWVOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBsYWJlbFRpbWU6IGNjLkxhYmVsLFxuICAgICAgICBsYXlvdXRUb3VEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0WmhvbmdEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0V2VpRGFvOiBjYy5MYXlvdXQsXG4gICAgICAgIGNhcmRBbGxOb2RlOmNjLk5vZGUsXG4gICAgICAgIGNhcmRQcmVmYWI6IGNjLlByZWZhYixcbiAgICAgICAgY2FyZFR5cGVQcmVmYWI6IGNjLlByZWZhYixcblxuICAgICAgICB0b3VEYW9Ob2RlOmNjLk5vZGUsXG4gICAgICAgIHpob25nRGFvTm9kZTpjYy5Ob2RlLFxuICAgICAgICB3ZWlEYW9Ob2RlOmNjLk5vZGUsXG5cbiAgICAgICAgYXV0b0NhcmRTY3JvbGxWaWV3OiBjYy5TY3JvbGxWaWV3LFxuICAgICAgICBhdXRvQ2FyZDogY2MuUHJlZmFiLFxuICAgICAgICBhdXRvQ2FyZExheW91dDogY2MuTGF5b3V0LFxuICAgICAgICBhdXRvQ2FyZEFuaW1hdGlvbjpjYy5Ob2RlLFxuXG5cbiAgICAgICAgTGF5b3V0V2l0aEV2ZW50OiBbXSxcblxuICAgICAgICBCdG5DbGlja0dvbmdYaU5pQ29tZmlybTpmYWxzZSwgIC8v55So5LqO5qOA5p+l55So5oi35piv5ZCm54K55Ye75LqG5oGt5Zac5L2g6aG16Z2i55qE56Gu5a6a5oyJ6ZKuXG4gICAgICAgIGNhcmRzTGF5b3V0U29ydENvbG9yOiBmYWxzZSxcbiAgICAgICAgLyojIyMjIyovXG5cbiAgICAgICAgX2NhcmRPZmZzZXRZOiBudWxsLFxuXG4gICAgICAgIF9rcUNhcmRNb2RlczogW10sXG4gICAgICAgIF9hbGxDYXJkTW9kZXM6IFtdLFxuICAgICAgICBfZmluZENhcmRUeXBlT2JqZWN0OiBudWxsLCAgLy8g55So5p2l6K6w5b2V5om+5Yiw55qE54mM5Z6L5a+56LGhXG4gICAgICAgIF9maW5kQ2FyZEluZGV4OiBudWxsLCAgLy8g55So5p2l6K6w5b2V5om+5Yiw55qE54mM5Z6L5a+56LGhXG5cbiAgICAgICAgX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2s6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY2FyZE9mZnNldFkgPSAwO1xuICAgICAgICB0aGlzLl9yZWdpc3RlclRvdWNoRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyRGFvc0xheW91dENsaWNrRXZlbnQoKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICB0aGlzLl9maW5kQ2FyZEluZGV4ID0ge307XG4gICAgICAgIHRoaXMuY2FyZFRpbWUgPSAwLjM7XG5cbiAgICAgICAgdGhpcy5jYXJkU3ByaXRlQXRsYXMgPSB0aGlzLm5vZGUucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcbiAgICAgICAgdGhpcy5kYW9TcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQuZ2V0Q29tcG9uZW50KCdwbGF5JykuZGFvU3ByaXRlQXRsYXM7XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vnqbrnmb3lnLDmlrnlsIbniYzmlLblm57ljrsqL1xuICAgIG9uQ2xpY2tDYXJkVHlwZUNvbWJpbmVOb2RlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcbiAgICB9LFxuXG4gICAgX2hpZGVEZWxldGVCdXR0b25zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhpcy5idG5EZWxldGVUb3VEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgLy90aGlzLmJ0bkRlbGV0ZVpob25nRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIC8vdGhpcy5idG5EZWxldGVXZWlEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLy8g6YeN572u77yM5Zue5Yiw5pyA5Yid5aeL5pyJ54q25oCBXG4gICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5faGlkZURlbGV0ZUJ1dHRvbnMoKTtcbiAgICAgICAgdGhpcy5jbGVhckNhcmRzKCk7XG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcbiAgICAgICAgLy90aGlzLl90eXBlQnV0dG9ucygpLmZvckVhY2goZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgICAvLyAgICBidXR0b24uaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgIC8vfSk7XG4gICAgICAgIHRoaXMuX2FsbENhcmRNb2RlcyA9IFtdO1xuICAgIH0sXG5cbiAgICBjYXJkc0xheW91dFNvcnQ6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBub2RlQXl5ID0gZS50YXJnZXQuY2hpbGRyZW47XG4gICAgICAgIGlmKG5vZGVBeXlbMF0uYWN0aXZlID09IHRydWUpey8v5oyJ5aSn5bCPXG4gICAgICAgICAgICB0aGlzLmNhcmRzTGF5b3V0U29ydENvbG9yID0gdHJ1ZTtcbiAgICAgICAgICAgIG5vZGVBeXlbMF0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBub2RlQXl5WzFdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25YKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihub2RlQXl5WzFdLmFjdGl2ZSA9PSB0cnVlKXsvL+aMieiKseiJslxuICAgICAgICAgICAgdGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9IGZhbHNlO1xuICAgICAgICAgICAgbm9kZUF5eVswXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgbm9kZUF5eVsxXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcbiAgICAgICAgfVxuICAgICAgICAvL3RoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSBub2RlQXl5WzFdLmFjdGl2ZSA9PSBmYWxzZTtcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0U29ydENvbG9yID09IHRydWVcbiAgICB9LFxuXG4gICAgYWRkQ2FyZHM6IGZ1bmN0aW9uIChjYXJkTmFtZXMpIHtcbiAgICAgICAgY2MuYXNzZXJ0KGNhcmROYW1lcyk7XG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcbiAgICAgICAgLy9jYXJkTmFtZXMuc29ydChmdW5jdGlvbihhMSxhMil7XG4gICAgICAgIC8vICAgIHJldHVybiBhMS5zcGxpdCgnXycpWzBdIC0gYTIuc3BsaXQoJ18nKVswXTtcbiAgICAgICAgLy99KVxuICAgICAgICBjYXJkTmFtZXMuZm9yRWFjaChmdW5jdGlvbihjYXJkLGluZGV4KXtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2FyZChjYXJkLGZhbHNlLGluZGV4KVxuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAvL3RoaXMuY2FyZHNMYXlvdXRTb3J0KCk7XG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcbiAgICAgICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICB0aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscyh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgfSxcblxuICAgIGFkZENhcmQ6IGZ1bmN0aW9uIChjYXJkTmFtZSwgYXV0b0NoYW5nZVBvc2l0aW9uWCA9IGZhbHNlLGluZGV4ID0gbnVsbCkge1xuICAgICAgICBjYy5hc3NlcnQoY2FyZE5hbWUubGVuZ3RoID4gMCk7XG5cbiAgICAgICAgbGV0IGNhcmRQcmVmYWIgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmNhcmRQcmVmYWIpO1xuICAgICAgICBjYXJkUHJlZmFiLm5hbWUgPSBjYXJkTmFtZTtcbiAgICAgICAgLy8gaWYoY2MubWFQYWkpe1xuICAgICAgICAvLyAgICAgdmFyIGNhcmRNYVBhaSA9ICczXycgKyBjYy5tYVBhaTtcbiAgICAgICAgLy8gICAgIGlmKGNhcmROYW1lID09IGNhcmRNYVBhaSl7XG4gICAgICAgIC8vICAgICAgICAgY2FyZFByZWZhYi5jb2xvciA9IG5ldyBjYy5Db2xvcigyMjYsIDE0NSwgMTQ1KTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfVxuICAgICAgICBjYXJkUHJlZmFiLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpLnNldENhcmQoY2FyZE5hbWUsaW5kZXgpO1xuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuYWRkQ2hpbGQoY2FyZFByZWZhYik7XG4gICAgICAgIGNhcmRQcmVmYWIuc2V0UG9zaXRpb25ZKHRoaXMuX2NhcmRPZmZzZXRZKTtcblxuICAgICAgICBpZiAoYXV0b0NoYW5nZVBvc2l0aW9uWCkge1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWCgpO1xuICAgICAgICB9XG4gICAgICAgIC8vbGV0IG5ld0NhcmQgPSBuZXcgS1FDYXJkKGNhcmROYW1lLG51bGwsaW5kZXgpO1xuICAgICAgICAvL2xldCBvcmlnaW5DYXJkID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmZpbmQoZnVuY3Rpb24oY2FyZCkge1xuICAgICAgICAvLyAgICByZXR1cm4gY2FyZC5pc0VxdWFsKG5ld0NhcmQpO1xuICAgICAgICAvL30pO1xuICAgICAgICAvL2lmIChvcmlnaW5DYXJkID09IG51bGwgJiYgIWF1dG9DaGFuZ2VQb3NpdGlvblgpIHtcbiAgICAgICAgLy8gICAgdGhpcy5fYWxsQ2FyZE1vZGVzLnB1c2gobmV3Q2FyZCk7XG4gICAgICAgIC8vfVxuICAgIH0sXG5cbiAgICBhZGRDYXJkTW9kZXM6IGZ1bmN0aW9uIChjYXJkTmFtZXMpIHtcbiAgICAgICAgY2MuYXNzZXJ0KGNhcmROYW1lcy5sZW5ndGggPiAwKTtcbiAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzID0gW107XG4gICAgICAgIGNhcmROYW1lcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmROYW1lLGluZGV4KXtcbiAgICAgICAgICAgIGxldCBuZXdDYXJkID0gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICAgICAgICAgIHRoaXMuX2FsbENhcmRNb2Rlcy5wdXNoKG5ld0NhcmQpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICByZWxvYWRDYXJkczogZnVuY3Rpb24gKGNhcmROYW1lcykge1xuICAgICAgICAvL2NhcmROYW1lcz1bJzFfMScsICcyXzEnLCAnM18xMScsICcxXzEyJywgJzJfMicsICczXzInLCAnNF8xMScsICc0XzEyJywgJzNfMTMnLCAnMl81JywgJzFfMTMnLCAnNF8zJywgJzFfMyddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMTEnLCAnMV8xMicsICcyXzInLCAnM18yJywgJzRfMTEnLCAnNF8xMicsICczXzEzJywgJzJfNScsICcxXzEzJywgJzRfMycsICcxXzMnXTtcbiAgICAgICAgLy/kuInluqblkIzoirFcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMl8xMycsICcyXzUnLCAnMl83JywgJzNfMScsICczXzInLCAnM180JywgJzNfMycsICczXzEzJywgJzFfMTInLCAnMV82JywgJzFfMScsICcxXzQnLCAnMV81J107XG4gICAgICAgIC8v5LiJ5ZCM6Iqx6aG6XG4gICAgICAgIC8vICBjYXJkTmFtZXM9WycyXzEnLCAnMl8yJywgJzJfMycsICcyXzQnLCAnMl81JywgJzNfNicsICczXzcnLCAnM184JywgJzNfOScsICczXzEwJywgJzRfMScsICc0XzInLCAnNF8zJ107XG4gICAgICAgIC8v5LiA5p2h6b6ZXG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzJfMScsICcyXzInLCAnMl8zJywgJzJfNCcsICcyXzUnLCAnM182JywgJzNfNycsICczXzgnLCAnM185JywgJzNfMTAnLCAnMV8xMScsICcxXzEyJywgJzFfMTMnXTtcbiAgICAgICAgLy/kuInpobrlrZBcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzEnLCAnM18yJywgJzRfMycsICcxXzcnLCAnNF81JywgJzRfNicsICczXzknLCAnNF84JywgJzNfMScsICcxXzEzJywgJzRfMTInLCAnNF8xMScsICcyXzEwJ107XG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzNfNScsICczXzQnLCAnNF8zJywgJzFfMicsICczXzEnLCAnNF85JywgJzNfOScsICc0XzgnLCAnM18xMCcsICcxXzEzJywgJzRfMTInLCAnNF8xMScsICcyXzEwJ107XG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzNfNScsICczXzQnLCAnNF8zJywgJzFfMicsICczXzEnLCAnNF81JywgJzNfNicsICc0XzgnLCAnM182JywgJzFfMTMnLCAnNF8xMicsICc0XzExJywgJzJfNyddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzNfNCcsICczXzQnLCAnNF82JywgJzJfMjAnLCAnMV8yMCcsICcxXzIwJywgJzNfNicsICc0XzgnLCAnM182JywgJzFfOCcsICc0XzEyJywgJzRfMTEnLCAnMl8yMCddO1xuICAgICAgICAvL+S4ieS4sOWkqeS4i1xuICAgICAgICAvL2NhcmROYW1lcz1bJzFfMScsICcyXzEnLCAnM18xJywgJzFfMicsICcyXzInLCAnM18yJywgJzRfMScsICc0XzInLCAnM18zJywgJzJfMycsICcxXzMnLCAnNF8zJywgJzFfMTMnXTtcbiAgICAgICAgLy805Liw5aSp5LiLXG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzFfMScsICcyXzEnLCAnM18xJywgJzFfNCcsICcyXzQnLCAnM18yJywgJzRfMicsICcxXzInLCAnM180JywgJzJfMycsICcxXzMnLCAnNF8zJywgJzFfMiddO1xuICAgICAgICAvL+WFreWygeWNilxuICAgICAgICAvLyBjYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMTEnLCAnMV8xMicsICcyXzInLCAnM18yJywgJzRfMTEnLCAnNF8xMicsICczXzEzJywgJzJfNScsICcxXzEzJywgJzRfMycsICcxXzMnXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9WycxXzknLCAnMl8xMScsICczXzgnLCAnMV8xMicsICcyXzInLCAnM18yJywgJzFfMTMnLCAnMl81JywgJzNfNScsJzFfNCcsICcyXzQnLCAnM180JywgJzNfMTAnXTtcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnNF85JywgJzJfMycsICczXzQnLCAnM182JywgJzJfMScsICcyXzQnLCAnMl8yJywgJzJfNScsICcyXzEzJywnMl84JywgJzJfMTAnLCAnMl8xMScsICcyXzEyJ107XG4gICAgICAgIC8vICAgY2FyZE5hbWVzPVsnNF8yJywgJzJfMycsICczXzQnLCAnM181JywgJzJfMScsICcyXzQnLCAnMl8yJywgJzJfNScsICcyXzEzJywnMl84JywgJzJfMTAnLCAnMl8xMScsICcyXzEyJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8xJywgJzJfMScsICcxXzQnLCAnM180JywgJzFfNicsICcyXzYnLCAnMV84JywgJzNfOCcsICcyXzgnLCcyXzEyJywgJzFfMTInLCAnMl8xMycsICczXzEzJ107XG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzRfOScsICcyXzMnLCAnM180JywgJzNfNicsICcyXzgnLCAnMl85JywgJzJfMTAnLCAnMl8xMScsICcyXzEzJywnM18xMycsICczXzEyJywgJzJfMTInLCAnMV8xMiddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9Wyc0XzknLCAnMl85JywgJzNfNCcsICczXzYnLCAnMV84JywgJzJfMScsICcyXzUnLCAnMl80JywgJzJfMycsJzNfMTMnLCAnM18xMicsICcyXzInLCAnMV8xMiddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzNfMicsICc0XzInLCAnMl80JywgJzNfNScsICcxXzUnLCAnM183JywgJzJfNycsICczXzEwJywgJzJfMScsJzJfMTMnLCAnMl8xMCcsICcyXzEyJywgJzJfMTEnXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzInLCAnNF8zJywgJzRfNCcsICc0XzUnLCAnNF81JywgJzRfNicsICc0XzEyJywgJzRfMTMnLCAnMl8xMicsJzNfMTInLCAnMl84JywgJzNfOCcsICcyXzExJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8zJywgJzFfMycsICc0XzUnLCAnNF81JywgJzNfNScsICcyXzUnLCAnMV8yMCcsICc0XzExJywgJzNfMTInLCc0XzEyJywgJzRfOCcsICc0XzEnLCAnMV8xMiddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzRfMycsICcxXzMnLCAnNF81JywgJzRfNScsICcyXzIwJywgJzFfMjAnLCAnMV8yMCcsICc0XzExJywgJzNfMTInLCc0XzEyJywgJzRfOCcsICc0XzEnLCAnMV8xMiddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzRfMycsICczXzQnLCAnNF82JywgJzRfNScsICcyXzcnLCAnMV8yMCcsICcxXzMnLCAnNF80JywgJzNfNicsJzRfNycsICc0XzgnLCAnMl8xMicsICcxXzEyJ107XG4gICAgICAgIGNjLmxvZyhjYXJkTmFtZXMpXG4gICAgICAgIHRoaXMuY2xlYXJDYXJkcygpO1xuICAgICAgICB0aGlzLl9rcUNhcmRNb2RlcyA9IFtdO1xuICAgICAgICB0aGlzLmFkZENhcmRzKGNhcmROYW1lcyk7XG4gICAgfSxcblxuICAgIGNsZWFyQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMubGF5b3V0VG91RGFvLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMubGF5b3V0V2VpRGFvLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICB9LFxuXG4gICAgcmVtb3ZlQ2FyZDogZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICAgIGlmICghY2FyZE5hbWUubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoY2FyZE5hbWUpLnJlbW92ZUZyb21QYXJlbnQoKTtcbiAgICB9LFxuXG4gICAgc2V0RmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBfcmVsb2FkS1FDYXJkTW9kZXNJbm5lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3RoaXMuX2txQ2FyZE1vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2FyZFByZWZhYk5vZGUpIHtcbiAgICAgICAgLy8gICAgbGV0IGNhcmRQcmVmYWIgPSBjYXJkUHJlZmFiTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgLy8gICAgcmV0dXJuIGNhcmRQcmVmYWIuY2FyZE1vZGUoKTtcbiAgICAgICAgLy99KS5zb3J0KEtRQ2FyZC5zb3J0KTtcbiAgICAgICAgLy90aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QgPSBudWxsO1xuICAgIH0sXG5cbiAgICBfdHlwZUJ1dHRvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9yZXR1cm4gW1xuICAgICAgICAvLyAgICB0aGlzLmJ0bkR1aVppLFxuICAgICAgICAvLyAgICB0aGlzLmJ0bkxpYW5nRHVpLFxuICAgICAgICAvLyAgICB0aGlzLmJ0blNhblRpYW8sXG4gICAgICAgIC8vICAgIHRoaXMuYnRuU2h1blppLFxuICAgICAgICAvLyAgICB0aGlzLmJ0blRvbmdIdWEsXG4gICAgICAgIC8vICAgIHRoaXMuYnRuSHVMdSxcbiAgICAgICAgLy8gICAgdGhpcy5idG5UaWVaaGksXG4gICAgICAgIC8vICAgIHRoaXMuYnRuVG9uZ0h1YVNodW4sXG4gICAgICAgIC8vICAgIC8qIyMjIyMqL1xuICAgICAgICAvLyAgICAvL3RoaXMuYnRuV3VUb25nLFxuICAgICAgICAvLyAgICAvKiMjIyMjKi9cbiAgICAgICAgLy9dO1xuICAgIH0sXG5cbiAgICBfcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHM6IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgICAgICAgLypjYXJkTW9kZXMubGVuZ3RoID09IDEzKi9cbiAgICAgICAgLy9jYXJkTW9kZXMgPSBjYXJkTW9kZXMgfHwgdGhpcy5fa3FDYXJkTW9kZXM7XG4gICAgICAgIC8vXG4gICAgICAgIC8vLyojIyMjI+WIneWni+WMlueJjCovXG4gICAgICAgIC8vdmFyIEJ1dHRvbnNMYXlvdXRDaGlsZHMgPSB0aGlzLnR5cGVCdXR0b25zTm9kZS5jaGlsZHJlbjtcbiAgICAgICAgLy9mb3IodmFyIGk9MDtpPEJ1dHRvbnNMYXlvdXRDaGlsZHMubGVuZ3RoO2krKyl7XG4gICAgICAgIC8vICAgIEJ1dHRvbnNMYXlvdXRDaGlsZHNbaV0uaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgIC8vfVxuICAgICAgICAvL1xuICAgICAgICAvL3RoaXMuYnRuRHVpWmkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5EdWlaaShjYXJkTW9kZXMpO1xuICAgICAgICAvL3RoaXMuYnRuTGlhbmdEdWkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZE1vZGVzKTtcbiAgICAgICAgLy90aGlzLmJ0blNhblRpYW8uaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5TYW5UaWFvKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vdGhpcy5idG5TaHVuWmkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5TaHVuWmkoY2FyZE1vZGVzKTtcbiAgICAgICAgLy90aGlzLmJ0blRvbmdIdWEuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5Ub25nSHVhKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vdGhpcy5idG5IdUx1LmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluSHVMdShjYXJkTW9kZXMpO1xuICAgICAgICAvL3RoaXMuYnRuVGllWmhpLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vdGhpcy5idG5Ub25nSHVhU2h1bi5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vLy90aGlzLmJ0bld1VG9uZy5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkTW9kZXMpO1xuICAgICAgICAvLy8vS1FDYXJkLmlzVGVTaHVQYWkoY2FyZE1vZGVzKVxuICAgICAgICAvLy8vbGV0IHR5cGVOYW1lID0gS1FDYXJkLmNhcmRzVHlwLWVOYW1lKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vLy9LUUNhcmQuaXNMaXVEdWlCYW4oY2FyZE1vZGVzKTtcbiAgICAgICAgLy8vL2FsZXJ0KHRoaXMuYnRuU2h1blppLmludGVyYWN0YWJsZSlcbiAgICAgICAgLy8vKiMjIyMj5aaC5p6c5pyJ5aSa5LiA6Imy77yM5bCx5piv6K6+572u5peg5ZCM5oyJ6ZKu55qE5Y+v5Lqk5LqS5oCnKi9cbiAgICAgICAgLy8vL2lmKGNjLmR1b1lpU2UgPT0gMCkge1xuICAgICAgICAvLy8vICAgIHRoaXMud3VUb25nTm9kZSA9IHRoaXMudHlwZUJ1dHRvbnNOb2RlLmdldENoaWxkQnlOYW1lKFwiYnRuV3VUb25nXCIpO1xuICAgICAgICAvLy8vICAgIHRoaXMuYnRuV3VUb25nID0gdGhpcy53dVRvbmdOb2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xuICAgICAgICAvLy8vICAgIHRoaXMuYnRuV3VUb25nLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vLy99XG4gICAgICAgIC8vLyojIyMjIyovXG4gICAgICAgIC8vXG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZVR5cGVCdXR0b25zKCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vLyojIyMjI+iuvue9ruaMiemSruWPr+S6pOS6kuWSjOS4jeWPr+S6pOS6kuaXtueahOmAj+aYjuW6piovXG4gICAgICAgIC8vZm9yKHZhciBpPTA7aTxCdXR0b25zTGF5b3V0Q2hpbGRzLmxlbmd0aDtpKyspe1xuICAgICAgICAvLyAgICBpZihCdXR0b25zTGF5b3V0Q2hpbGRzW2ldLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSl7XG4gICAgICAgIC8vICAgICAgICBCdXR0b25zTGF5b3V0Q2hpbGRzW2ldLm9wYWNpdHkgPSAyNTU7XG4gICAgICAgIC8vICAgIH1lbHNle1xuICAgICAgICAvLyAgICAgICAgQnV0dG9uc0xheW91dENoaWxkc1tpXS5vcGFjaXR5ID0gMTI1O1xuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vfVxuICAgIH0sXG5cbiAgICAvLyDlsIbmib7liLDkuobniYznsbvlnovnmoTniYznqoHlh7rlh7rmnaVcbiAgICBfc3RpY2tPdXRGaW5kQ2FyZFR5cGU6IGZ1bmN0aW9uICh0aXRsZSwgZmluZE1ldGhvZHMpIHtcblxuICAgICAgICAvLyDlhYjmoLnmja7niYznsbvlnovmib7lh7rmiYDmnInnmoTntKLlvJXpm4blkIhcbiAgICAgICAgLy92YXIgZmluZGVkSW5kZXhzQXJyYXkgPSBudWxsO1xuICAgICAgICAvL3RoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCA9IHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCB8fCB7fTtcbiAgICAgICAgLy9pZiAodGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LnRpdGxlICE9IHRpdGxlKSB7XG4gICAgICAgIC8vICAgIGZpbmRlZEluZGV4c0FycmF5ID0gKGZpbmRNZXRob2RzKCkgfHwgW10pLnJldmVyc2UoKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgZm9yKHZhciBpID0wO2k8ZmluZGVkSW5kZXhzQXJyYXkubGVuZ3RoLTE7aSsrKXsvL+WIoOmZpOWQjOexu+Wei+eJjFxuICAgICAgICAvLyAgICAgICAgdmFyIGluZGV4ID0gZmluZGVkSW5kZXhzQXJyYXlbaV07XG4gICAgICAgIC8vICAgICAgICAvKmlmKHRpdGxlID09ICdsaWFuZ0R1aScpe1xuICAgICAgICAvLyAgICAgICAgIGxldCBqU3RyaW5nc3BvaW50ID0gaW5kZXgubWFwKGZ1bmN0aW9uKGluZGV4cyl7XG4gICAgICAgIC8vICAgICAgICAgcmV0dXJuIHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4c10ucG9pbnQ7XG4gICAgICAgIC8vICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy8gICAgICAgICB2YXIgaXNCcmVhayA9IGZhbHNlO1xuICAgICAgICAvLyAgICAgICAgIHZhciByZXBOdW0gPSBqU3RyaW5nc3BvaW50LnJlZHVjZShmdW5jdGlvbihwLG4pe1xuICAgICAgICAvLyAgICAgICAgIGlmKCFwW25dKXtcbiAgICAgICAgLy8gICAgICAgICBwW25dID0gMTtcbiAgICAgICAgLy8gICAgICAgICB9ZWxzZXtcbiAgICAgICAgLy8gICAgICAgICBwW25dICs9IDFcbiAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAgcmV0dXJuIHBcbiAgICAgICAgLy8gICAgICAgICB9LHt9KTtcbiAgICAgICAgLy8gICAgICAgICBmb3IodmFyIHkgaW4gcmVwTnVtKXtcbiAgICAgICAgLy8gICAgICAgICBpZihyZXBOdW1beV0gPj0gMyl7XG4gICAgICAgIC8vICAgICAgICAgaXNCcmVhayA9IHRydWU7XG4gICAgICAgIC8vICAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgICBpZihpc0JyZWFrKXtcbiAgICAgICAgLy8gICAgICAgICBjYy5sb2cocmVwTnVtKVxuICAgICAgICAvLyAgICAgICAgIGNjLmxvZyhmaW5kZWRJbmRleHNBcnJheSlcbiAgICAgICAgLy8gICAgICAgICBjYy5sb2coaSlcbiAgICAgICAgLy8gICAgICAgICBjYy5sb2coJy0tLS0tLS0tMjkxJylcbiAgICAgICAgLy8gICAgICAgICBmaW5kZWRJbmRleHNBcnJheS5zcGxpY2UoaSwxKTtcbiAgICAgICAgLy8gICAgICAgICBjb250aW51ZTtcbiAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAgfSovXG4gICAgICAgIC8vICAgICAgICB2YXIgaVN0cmluZyA9ICcnO1xuICAgICAgICAvLyAgICAgICAgZm9yKHZhciBqID1pKzE7ajxmaW5kZWRJbmRleHNBcnJheS5sZW5ndGg7aisrKXtcbiAgICAgICAgLy8gICAgICAgICAgICB2YXIgcyA9IGZpbmRlZEluZGV4c0FycmF5W2pdO1xuICAgICAgICAvLyAgICAgICAgICAgIHZhciBqU3RyaW5nID0gJyc7XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgICAgICAgICAgbGV0IGlTdHJpbmdzID0gcy5tYXAoZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBsZXQgY2FyZE1vZGVsID0gdGhpcy5fa3FDYXJkTW9kZXNbaW5kZXhdO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICByZXR1cm4gY2FyZE1vZGVsLmNhcmROYW1lKCk7XG4gICAgICAgIC8vICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgICAgICAgICBsZXQgalN0cmluZ3MgPSBpbmRleC5tYXAoZnVuY3Rpb24oaW5kZXhzKXtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgbGV0IGNhcmRNb2RlbCA9IHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4c107XG4gICAgICAgIC8vICAgICAgICAgICAgICAgIHJldHVybiBjYXJkTW9kZWwuY2FyZE5hbWUoKTtcbiAgICAgICAgLy8gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAvL1xuICAgICAgICAvL1xuICAgICAgICAvLyAgICAgICAgICAgIGZvcih2YXIgciA9IDA7ciA8IGluZGV4Lmxlbmd0aDtyKyspe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBqU3RyaW5nID0galN0cmluZyArIGlTdHJpbmdzW3JdO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBpU3RyaW5nID0gaVN0cmluZyArIGpTdHJpbmdzW3JdO1xuICAgICAgICAvLyAgICAgICAgICAgIH1cbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgICAgICAgICBpZihqU3RyaW5nID09IGlTdHJpbmcpe1xuICAgICAgICAvLyAgICAgICAgICAgICAgICBmaW5kZWRJbmRleHNBcnJheS5zcGxpY2UoaSwxKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vICAgICAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgIHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCA9IHtcbiAgICAgICAgLy8gICAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgICAgLy8gICAgICAgIGluZGV4c0FycmF5OiBmaW5kZWRJbmRleHNBcnJheSxcbiAgICAgICAgLy8gICAgICAgIC8vaW5kZXg6IHRpdGxlPT1cImR1aVppXCI/ZmluZGVkSW5kZXhzQXJyYXkubGVuZ3RoLTE6MFxuICAgICAgICAvLyAgICAgICAgaW5kZXg6IDBcbiAgICAgICAgLy8gICAgfTtcbiAgICAgICAgLy99XG4gICAgICAgIC8vXG4gICAgICAgIC8vZmluZGVkSW5kZXhzQXJyYXkgPSB0aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QuaW5kZXhzQXJyYXk7XG4gICAgICAgIC8vaWYgKCFmaW5kZWRJbmRleHNBcnJheSB8fCBmaW5kZWRJbmRleHNBcnJheS5sZW5ndGggPT0gMCkge1xuICAgICAgICAvLyAgICByZXR1cm47XG4gICAgICAgIC8vfVxuICAgICAgICAvLy8vIOWwhuW3suacieeahOeqgeWHuueahOeJjOeahOS9jee9rumHjee9ruWbnuWIneWni+S9jee9rlxuICAgICAgICAvL3RoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8vLyDorqHnrpflh7ropoHnqoHlh7rnmoTniYzmlbDnu4RcbiAgICAgICAgLy92YXIgaW5kZXggPSB0aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QuaW5kZXg7XG4gICAgICAgIC8vbGV0IGluZGV4cyA9IGZpbmRlZEluZGV4c0FycmF5W2luZGV4XTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgc2VsZWN0ZWRDYXJkTmFtZXMgPSBpbmRleHMubWFwKGZ1bmN0aW9uKGluZGV4KXtcbiAgICAgICAgLy8gICAgbGV0IGNhcmRNb2RlbCA9IHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4XTtcbiAgICAgICAgLy8gICAgcmV0dXJuIGNhcmRNb2RlbC5jYXJkTmFtZSgpO1xuICAgICAgICAvL30uYmluZCh0aGlzKSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5maWx0ZXIoZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgIC8vICAgIGxldCBjYXJkUHJlZmFiID0gY2FyZE5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vICAgIGlmKHNlbGVjdGVkQ2FyZE5hbWVzLmluY2x1ZGVzKGNhcmRQcmVmYWIuY2FyZE5hbWUoKSkpIHtcbiAgICAgICAgLy8gICAgICAgIHZhciBuYW1lSW5kZXggPSBzZWxlY3RlZENhcmROYW1lcy5pbmRleE9mKGNhcmRQcmVmYWIuY2FyZE5hbWUoKSk7XG4gICAgICAgIC8vICAgICAgICBzZWxlY3RlZENhcmROYW1lcy5zcGxpY2UobmFtZUluZGV4LDEpO1xuICAgICAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy8gICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAvL30pO1xuXG4gICAgICAgIC8vLy8g56qB5Ye66K6h566X5Ye65p2l55qE54mM5pWw57uEXG4gICAgICAgIC8vdGhpcy5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XG4gICAgICAgIC8vLy8g5L+d5a2Y5aW977yM55So5LqO5YaN5qyh54K55Ye75LqG56qB5Ye65LiL5LiA57uE54mMXG4gICAgICAgIC8vaW5kZXggPSAoaW5kZXggKyAxKSAlIGZpbmRlZEluZGV4c0FycmF5Lmxlbmd0aDtcbiAgICAgICAgLy90aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QuaW5kZXggPSBpbmRleDtcbiAgICB9LFxuXG4gICAgY2xpY2tEdWlaaTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcImR1aVppXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZER1aVppKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tMaWFuZ0R1aTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcImxpYW5nRHVpXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZExpYUR1aSh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrU2FuVGlhbzogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcInNhblRpYW9cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kU2FuVGlhbyh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrU2h1blppOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwic2h1blppXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZFNodW5aaSh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrVG9uZ0h1YTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcInRvbmdIdWFcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YSh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrSHVMdTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcImh1THVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kSHVMdSh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrVGllWmhpOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwidGllWmhpXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZFRpZVpoaSh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIC8qIyMjIyMqL1xuICAgIGNsaWNrV3VUb25nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwid3VUb25nXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZFd1VG9uZyh0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcbiAgICAvKiMjIyMjKi9cblxuICAgIGNsaWNrVG9uZ0h1YVNodW46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJ0b25nSHVhU2h1blwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bih0aGlzLl9rcUNhcmRNb2Rlcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrQ2FuY2VsQWxsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2xpY2tEZWxldGVUb3VEYW8oKTtcbiAgICAgICAgdGhpcy5jbGlja0RlbGV0ZVpob25nRGFvKCk7XG4gICAgICAgIHRoaXMuY2xpY2tEZWxldGVXZWlEYW8oKTtcbiAgICB9LFxuXG4gICAgLyrngrnlh7vlrozmiJDmjInpkq4qL1xuICAgIGNsaWNrRG9uZTogZnVuY3Rpb24gKCkge1xuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XG4gICAgICAgIHRoaXMuY2FyZEFsbHMgPSAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbi5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIueSAtIGEueTt9KS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkuY2hpbGRyZW5bMF07fSk7XG5cbiAgICAgICAgbGV0IHRvdUNhcmRNb2RlbHMgPSB0aGlzLl90YW9EYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgbGV0IHpob25nQ2FyZE1vZGVzID0gdGhpcy5femhvbmdEYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgbGV0IHdlaUNhcmRNb2RlcyA9IHRoaXMuX3dlaURhb0NhcmRNb2RlcygpO1xuICAgICAgICB0aGlzLl9kaWRTZWxlY3RlZENhcmRzKHRvdUNhcmRNb2RlbHMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXMpO1xuICAgIH0sXG5cbiAgICAvKueCueWHu+aBreWWnOS9oOmhtemdoueahOehruWumuaMiemSriovXG4gICAgb25CdG5Hb25nWGlOaUNvbWZpcm1DbGljazpmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8v6K6w5b2V546p5a6254K55Ye75LqG56Gu5a6a5oyJ6ZKu77yaXG4gICAgICAgIHRoaXMuQnRuQ2xpY2tHb25nWGlOaUNvbWZpcm0gPSB0cnVlO1xuXG4gICAgICAgIHZhciBjYXJkcyA9IFtdO1xuXG4gICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihpKXtjYXJkcyA9IGNhcmRzLmNvbmNhdChpKTt9KTtcblxuICAgICAgICB2YXIgdGVTaHVQYWlDYXJkc1NlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsMihjYXJkcyk7XG4gICAgICAgIHZhciByZXN1bHQgPSBbdGVTaHVQYWlDYXJkc1NlcnZlckluZm9dO1xuICAgICAgICBpZiAodGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIF9kaWRTZWxlY3RlZENhcmRzOiBmdW5jdGlvbiAodG91Q2FyZHMsIHpob25nQ2FyZHMsIHdlaUNhcmRzKSB7XG4gICAgICAgIHRvdUNhcmRzID0gdG91Q2FyZHMgfHwgW107XG4gICAgICAgIHpob25nQ2FyZHMgPSB6aG9uZ0NhcmRzIHx8IFtdO1xuICAgICAgICB3ZWlDYXJkcyA9IHdlaUNhcmRzIHx8IFtdO1xuICAgICAgICBsZXQgdG91U2VydmVySW5mbyA9IHRoaXMuX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWwodG91Q2FyZHMpO1xuICAgICAgICBsZXQgemhvbmdTZXJ2ZXJJbmZvID0gdGhpcy5fY29udmVydENhcmRzVG9TZXJ2ZXJNb2RlbCh6aG9uZ0NhcmRzKTtcbiAgICAgICAgbGV0IHdlaVNlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsKHdlaUNhcmRzKTtcblxuICAgICAgICAvL2NvbnNvbGUubG9nKHRvdVNlcnZlckluZm8pO1xuICAgICAgICAvL2NvbnNvbGUubG9nKHpob25nU2VydmVySW5mbyk7XG4gICAgICAgIC8vY29uc29sZS5sb2cod2VpU2VydmVySW5mbyk7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS01MTJcIik7XG4gICAgICAgIGlmKCEodG91U2VydmVySW5mby52YWx1ZSA8IHpob25nU2VydmVySW5mby52YWx1ZSAmJiB6aG9uZ1NlcnZlckluZm8udmFsdWUgPD0gd2VpU2VydmVySW5mby52YWx1ZSkpe1xuICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZEFuaW1hdGlvbi55ID0gLTUwO1xuICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZEFuaW1hdGlvbi5vcGFjaXR5ID0gMjU1O1xuICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZEFuaW1hdGlvbi5ydW5BY3Rpb24oY2MubW92ZVRvKDEsIGNjLnAoMCwgMCkpKTtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gY2Muc3Bhd24oY2MubW92ZVRvKHRoaXMuY2FyZFRpbWUsIGNjLnAoMCwgMTApKSwgY2MuZmFkZU91dCh0aGlzLmNhcmRUaW1lKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZEFuaW1hdGlvbi5ydW5BY3Rpb24oYWN0aW9uKTtcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgMS41KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0ID0gW3RvdVNlcnZlckluZm8sIHpob25nU2VydmVySW5mbywgd2VpU2VydmVySW5mb107XG4gICAgICAgIC8vcmV0dXJuO1xuICAgICAgICBpZiAodGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNsaWNrRGVsZXRlVG91RGFvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2RlbGV0ZURhb0NhcmRzT2ZMYXlvdXQodGhpcy5sYXlvdXRUb3VEYW8ubm9kZSk7XG4gICAgfSxcblxuICAgIGNsaWNrRGVsZXRlWmhvbmdEYW86IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGVsZXRlRGFvQ2FyZHNPZkxheW91dCh0aGlzLmxheW91dFpob25nRGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICBjbGlja0RlbGV0ZVdlaURhbzogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkc09mTGF5b3V0KHRoaXMubGF5b3V0V2VpRGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICAvLyDorqHml7blmajkuovku7ZcbiAgICB0aW1lU3RhcnQ6IGZ1bmN0aW9uIChkdXJhdGlvbikge1xuICAgICAgICBjYy5hc3NlcnQoZHVyYXRpb24gPiAwKTtcbiAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xuICAgICAgICB0aGlzLnRpbWVOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciB0aW1lc3RhbXAgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ0aW1lc3RhbXBcIik7ICAvLyDojrflj5bmnKzlnLDlrZjlgqjnmoTml7bpl7TmiLNcbiAgICAgICAgaWYodGltZXN0YW1wKXsgIC8vIOWmguaenOacieWImeivgeaYjueOqeWutuaYr+mHjeaWsOi/m+adpeS6hueahFxuICAgICAgICAgICAgdmFyIG5vdyA9IERhdGUucGFyc2UobmV3IERhdGUoKSk7XG4gICAgICAgICAgICB2YXIgdGltZSA9IGR1cmF0aW9uKjEwMDA7XG4gICAgICAgICAgICBpZihub3cgLSB0aW1lc3RhbXAgPiB0aW1lKXsgLy8g6LaF5pe2XG4gICAgICAgICAgICAgICAgaWYobm93IC0gdGltZXN0YW1wIDwgMip0aW1lKXtcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb24gPSA1OyAgLy8g546p5a625Y+v6IO95Ye65LqO5YW25LuW5Y6f5Zug6YCA5Ye65ri45oiP5a+86Ie06LaF5pe277yM5Li65YW25o+Q5L6bNeenkuaXtumXtOaVtOeQhueJjOWei++8iOi/meW3sue7j+aYr+W+iOS7geaFiOeahOS6hu+8ieOAglxuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSBNYXRoLmZsb29yKCBkdXJhdGlvbiAtIChub3cgLSB0aW1lc3RhbXApLzEwMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ZWxzZXsgIC8vIOWmguaenOayoeacieaXtumXtOaIs++8jOWImeS/neWtmO+8jOS4uueOqeWutumAgOWHuua4uOaIj+S/neeVmeivgeaNru+8m1xuICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IERhdGUucGFyc2UobmV3IERhdGUoKSk7ICAgICBcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGltZXN0YW1wJyx0aW1lc3RhbXApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBTdHJpbmcoZHVyYXRpb24pO1xuICAgICAgICB0aGlzLnRpbWVOb2RlLmdldENvbXBvbmVudChcInRpbWVcIikuc2V0VGltZShkdXJhdGlvbiAqIDAuNSk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5fdGltZU1ldGhvZCwgMSwgZHVyYXRpb24pO1xuICAgIH0sXG5cbiAgICB0aW1lU3RvcDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fdGltZU1ldGhvZCk7XG4gICAgICAgIHRoaXMudGltZU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIF90aW1lTWV0aG9kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA9IHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiAtIDE7XG5cbiAgICAgICAgdmFyIHJlbWFpbiA9IE1hdGgubWF4KHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiwgMCk7XG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IChyZW1haW4gPCAxMCAmJiByZW1haW4gPiAwKSA/ICgnMCcgKyByZW1haW4pIDogcmVtYWluO1xuXG4gICAgICAgIGlmICh0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gPD0gMCkge1xuICAgICAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xuICAgICAgICAgICAgaWYoY2MuY2hhb1NoaUNodVBhaSA9PSB0cnVlKSB0aGlzLl90aW1lT3V0QXV0b1NlbGVjdENhcmRzKCk7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8g6LaF5pe25ZCO77yM6Ieq5Yqo6YCJ54mMXG4gICAgX3RpbWVPdXRBdXRvU2VsZWN0Q2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOmakOiXj+aBreWWnOS9oFxuICAgICAgICAgKi9cbiAgICAgICAgcGxheS5nb25nWGlOaVNob3coZmFsc2UpO1xuICAgICAgICBpZiAodHlwZW9mKGNjLnRlU2h1UGFpQ2FyZHMpICE9IFwidW5kZWZpbmVkXCIgJiYgY2MudGVTaHVQYWlDYXJkcyAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLm9uQnRuR29uZ1hpTmlDb21maXJtQ2xpY2soKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vbGV0IFt0b3VDYXJkTW9kZWxzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzXSA9IHRoaXMuX2NhY2xlQXV0b1NlbGVjdGVkQ2FyZHMoKTtcbiAgICAgICAgbGV0IFt0b3VDYXJkTW9kZWxzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzXSA9IHRoaXMuX2ZpbmRDYXJkSW5kZXguYXJyWzBdO1xuXG5cbiAgICAgICAgaWYgKHRvdUNhcmRNb2RlbHMgPT0gbnVsbCB8fCB6aG9uZ0NhcmRNb2RlcyA9PSBudWxsIHx8IHdlaUNhcmRNb2RlcyA9PSBudWxsKSB7XG4gICAgICAgICAgICB0b3VDYXJkTW9kZWxzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLnNsaWNlKC0zKTtcbiAgICAgICAgICAgIHpob25nQ2FyZE1vZGVzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLnNsaWNlKDUsIDEwKTtcbiAgICAgICAgICAgIHdlaUNhcmRNb2RlcyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSgwLCA1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNjLmxvZyh0b3VDYXJkTW9kZWxzKVxuICAgICAgICAvLyBjYy5sb2coemhvbmdDYXJkTW9kZXMpXG4gICAgICAgIC8vIGNjLmxvZyh3ZWlDYXJkTW9kZXMpXG4gICAgICAgIC8vIGNjLmxvZyh0aGlzLl9hbGxDYXJkTW9kZXMpXG4gICAgICAgIC8vIGNjLmxvZyhcIuiHquWKqOmAieeJjCB0b3VDYXJkTW9kZWxzIHpob25nQ2FyZE1vZGVzIHdlaUNhcmRNb2Rlc++8mlwiKTtcbiAgICAgICAgdGhpcy5fZGlkU2VsZWN0ZWRDYXJkcyh0b3VDYXJkTW9kZWxzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzKTtcbiAgICB9LFxuXG4gICAgX2NhY2xlQXV0b1NlbGVjdGVkQ2FyZHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICBsZXQgY2FyZHMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuZmlsdGVyKGZ1bmN0aW9uKGkpe1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgcmVzdWx0Q2FyZHMgPSBbXTtcbiAgICAgICAgZm9yKHZhciBpID0gMTtpIDwgMzsgaSsrKXtcbiAgICAgICAgICAgIGxldCBjYXJkc3MgPSBLUUNhcmQuYXV0b1NlbGVjdENhcmRzKGNhcmRzLCA1KTtcbiAgICAgICAgICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZHNzKTtcbiAgICAgICAgICAgIHJlc3VsdENhcmRzLnB1c2goY2FyZHNzKTtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHRDYXJkcy5wdXNoKGNhcmRzKTtcbiAgICAgICAgLy9sZXQgdG91U2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHJlc3VsdENhcmRzWzJdKTtcbiAgICAgICAgLy9sZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0Q2FyZHNbMV0pO1xuICAgICAgICAvL2xldCB3ZWlTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0Q2FyZHNbMF0pO1xuICAgICAgICAvLyBjYy5sb2cocmVzdWx0Q2FyZHMpXG4gICAgICAgIC8vIGNjLmxvZyh0aGlzLl9hbGxDYXJkTW9kZXMpXG4gICAgICAgIC8vIGNjLmxvZyhcIueJjOWIhuaVsOiHquWKqOmAieeJjO+8mlwiLCB0b3VTY29yZSwgemhvbmdTY29yZSwgd2VpU2NvcmUpO1xuICAgICAgICAvL2xldCB3ZWlDYXJkTW9kZXMgPSBLUUNhcmQuYXV0b1NlbGVjdENhcmRzKGNhcmRzLCA1KTtcbiAgICAgICAgLy9jYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKHdlaUNhcmRNb2Rlcyk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vbGV0IHpob25nQ2FyZE1vZGVzID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkcywgNSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vbGV0IHRvdUNhcmRNb2RlcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKHpob25nQ2FyZE1vZGVzKTtcbiAgICAgICAgLy9pZiAodG91Q2FyZE1vZGVzLmxlbmd0aCA9PSAzICYmIHpob25nQ2FyZE1vZGVzLmxlbmd0aCA9PSA1ICYmIHdlaUNhcmRNb2Rlcy5sZW5ndGggPT0gNSkge1xuICAgICAgICAvLyAgICByZXR1cm4gW3RvdUNhcmRNb2RlcywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2Rlc107XG4gICAgICAgIC8vfVxuICAgICAgICBpZiAocmVzdWx0Q2FyZHNbMl0ubGVuZ3RoID09IDMgJiYgcmVzdWx0Q2FyZHNbMV0ubGVuZ3RoID09IDUgJiYgcmVzdWx0Q2FyZHNbMF0ubGVuZ3RoID09IDUpIHtcbiAgICAgICAgICAgIHJldHVybiBbcmVzdWx0Q2FyZHNbMl0sIHJlc3VsdENhcmRzWzFdLCByZXN1bHRDYXJkc1swXV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gW107XG4gICAgfSxcblxuICAgIF9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHt9O1xuICAgICAgICByZXN1bHQudHlwZSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMpO1xuICAgICAgICByZXN1bHQudmFsdWUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKGNhcmRzKTtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzMShjYXJkcyk7XG4gICAgICAgIHJlc3VsdC5jYXJkcyA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyhjYXJkcyk7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuXG4gICAgLyojIyMjIyovXG4gICAgX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWwyOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgICAgdmFyIGNvbnZlcnRUb1NlcnZlckNhcmRzID0gW107XG5cbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmRNb2RlKXtcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgICAgIGNhcmRNb2RlID0gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZE1vZGUpKTtcbiAgICAgICAgICAgIGNhcmRNb2RlLmZvckVhY2goZnVuY3Rpb24oY2NhKXtcbiAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBjY2EucG9pbnQgPT0gMTQgPyAxOmNjYS5wb2ludDtcbiAgICAgICAgICAgICAgICBhcnIucHVzaCh7bnVtYmVyOnBvaW50LHN1aXQ6Y2NhLmNvbG9yfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnZlcnRUb1NlcnZlckNhcmRzLnB1c2goYXJyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCByZXN1bHQgPSB7fTtcbiAgICAgICAgcmVzdWx0LnR5cGUgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzKTtcbiAgICAgICAgcmVzdWx0LnZhbHVlID0gMDtcbiAgICAgICAgcmVzdWx0LmNhcmRzID0gY29udmVydFRvU2VydmVyQ2FyZHM7XG5cbiAgICAgICAgaWYgKHJlc3VsdC50eXBlID49IEtRQ2FyZC5UWVBFLlNhblRhb0h1YSAmJiBjYy5tb3NoaSAhPSAxKSB7XG4gICAgICAgICAgICAvLyDnibnmrorniYxcbiAgICAgICAgICAgIHJlc3VsdC5pc0NvbnRhaW5FeHRyYSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG4gICAgLyojIyMjIyovXG4gICAgLy8g54m55q6K54mM6YeM5piv5ZCm6L+Y5ZCr5pyJ54m55q6K54mMXG4gICAgLy8g5YyF5ZCr55qE5oOF5Ya15pyJ77yaXG4gICAgLy8g5LiJ5qGD6IqxIOWPr+iDveWQq+acieWQjOiKsemhulxuICAgIC8vIOS4iemhuuWtkCDlj6/og73lkKvmnInlkIzoirHpobpcbiAgICAvLyDlha3lr7nljYog5Y+v6IO95ZCr5pyJ6ZOB5pSvXG4gICAgX2lzQ29udGFpbkV4dHJhQ2FyZHNUeXBlOiBmdW5jdGlvbiAodHlwZSwgY2FyZHMpIHtcbiAgICAgICAgaWYgKHR5cGUgPT0gS1FDYXJkLlRZUEUuU2FuVGFvSHVhKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bihjYXJkcyk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBLUUNhcmQuVFlQRS5TYW5TaHVuWmkpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRzKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IEtRQ2FyZC5UWVBFLkxpdUR1aUJhbikge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSxcblxuICAgIC8vIOinpuaRuOS6i+S7tlxuICAgIF9yZWdpc3RlclRvdWNoRXZlbnRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dC5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCB0aGlzLl90b3VjaENhcmRMYXlvdXQuYmluZCh0aGlzKSk7XG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dC5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX01PVkUsIHRoaXMuX3RvdWNoQ2FyZExheW91dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCB0aGlzLl90b3VjaENhcmRMYXlvdXRFbmQuYmluZCh0aGlzKSk7XG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dC5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCwgdGhpcy5fdG91Y2hDYXJkTGF5b3V0RW5kLmJpbmQodGhpcykpO1xuICAgIH0sXG4gICAgY2FjbGVBdXRvU2VsZWN0ZWRDYXJkc0luZGV4OiBmdW5jdGlvbihjYXJkcykge1xuICAgICAgICAvL2NjLmxvZygnLS0tLS0tNjIyJylcbiAgICAgICAgbGV0IHRlc3RGaW5kID0gS1FDYXJkLnRlc3RGaW5kKGNhcmRzKSB8fCBbXTtcbiAgICAgICAgLy9jYy5sb2coJy0tLS0tLTYyMjEnKVxuICAgICAgICB2YXIgcmVzdWx0ID0gW11cbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgdGVzdEZpbmQubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgdmFyIHMgPSB0ZXN0RmluZFtpXTtcbiAgICAgICAgICAgIGlmKHMubGVuZ3RoID49IDEpe1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7aiA8IHMubGVuZ3RoOyBqKyspe1xuICAgICAgICAgICAgICAgICAgICAvL3Jlc3VsdC5wdXNoKHNbMF0pOy8v5Y+q5Y+W5LiA5LiqXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHNbal0pOy8vXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxuICAgIGNhY2xlQXV0b1NlbGVjdGVkQ2FyZHNBcnJheTogZnVuY3Rpb24oY2FyZHMpIHtcbiAgICAgICAgdmFyIGluZGV4cyA9IHRoaXMuY2FjbGVBdXRvU2VsZWN0ZWRDYXJkc0luZGV4KGNhcmRzKTtcbiAgICAgICAgaWYoaW5kZXhzLmxlbmd0aCA8IDEpe1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBzZWxlY3RlZENhcmQgPSBbXTtcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgaW5kZXhzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGxldCBzID0gaW5kZXhzW2ldO1xuICAgICAgICAgICAgbGV0IGEgPSBzLm1hcChmdW5jdGlvbihpbmRleCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhcmRzW2luZGV4XTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2VsZWN0ZWRDYXJkLnB1c2goYSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkQ2FyZDtcbiAgICB9LFxuXG4gICAgY2FjbGVBdXRvU2VsZWN0ZWRDYXJkczI6IGZ1bmN0aW9uKCkge1xuICAgICAgICBsZXQgY2FyZHMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoKTtcbiAgICAgICAgdmFyIGNhcmRzQXJyYXkgPSB0aGlzLmNhY2xlQXV0b1NlbGVjdGVkQ2FyZHNBcnJheShjYXJkcyk7XG4gICAgICAgIHZhciByZXN1bHRBcnJheSA9IFtdO1xuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCBjYXJkc0FycmF5Lmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgbGV0IHMgPSBjYXJkc0FycmF5W2ldIHx8IFtdO1xuICAgICAgICAgICAgbGV0IHF3ZXIgPSBbXTtcbiAgICAgICAgICAgIGZvcih2YXIgaiA9IDE7aiA8IGNhcmRzQXJyYXkubGVuZ3RoO2orKyl7XG4gICAgICAgICAgICAgICAgbGV0IGQgPSBjYXJkc0FycmF5W2pdIHx8IFtdO1xuICAgICAgICAgICAgICAgIGxldCBzQyA9IHMua3FfZXhjbHVkZXMoZCk7XG4gICAgICAgICAgICAgICAgaWYoc0MubGVuZ3RoID09IHMubGVuZ3RoICYmIHMubGVuZ3RoID4gMCl7Ly/liKTmlq3niYznm7jlkIwg5Y2z5rKh5pyJ6YeN5aSN55qEXG4gICAgICAgICAgICAgICAgICAgIHF3ZXIgPSBbcyxkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihxd2VyLmxlbmd0aCA+IDEpe1xuICAgICAgICAgICAgICAgIHJlc3VsdEFycmF5LnB1c2gocXdlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL+ihpeWFqOiuoeWIkjFcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXkubGVuZ3RoO2krKyl7XG5cbiAgICAgICAgICAgIGxldCBzID0gcmVzdWx0QXJyYXlbaV07XG5cbiAgICAgICAgICAgIGxldCBjYXJkc3MgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoKTtcblxuICAgICAgICAgICAgY2FyZHNzID0gY2FyZHNzLmtxX2V4Y2x1ZGVzKHNbMF0pO1xuXG4gICAgICAgICAgICBjYXJkc3MgPSBjYXJkc3Mua3FfZXhjbHVkZXMoc1sxXSk7XG5cbiAgICAgICAgICAgIGlmKGNhcmRzcy5sZW5ndGggPj0gNSl7XG4gICAgICAgICAgICAgICAgc1syXSA9IEtRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMoY2FyZHNzLCA1KTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHNbMl0gPSBLUUNhcmQuYXV0b1NlbGVjdENhcmRzKGNhcmRzcywgMyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlc3VsdEFycmF5W2ldLnNvcnQoZnVuY3Rpb24gKGExLGEyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5zY29yZU9mQ2FyZHMoYTEpLUtRQ2FyZC5zY29yZU9mQ2FyZHMoYTIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy/ooaXlhajorqHliJIyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHJlc3VsdEFycmF5Lmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgdmFyIHMgPSByZXN1bHRBcnJheVtpXTtcbiAgICAgICAgICAgIHZhciBjYXJkc3FlID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmZpbHRlcihmdW5jdGlvbihpaSl7Ly/ph43mlrDotYvlgLxjYXJkc1xuICAgICAgICAgICAgICAgIHJldHVybiBpaTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy/ljrvph41cbiAgICAgICAgICAgIHZhciBxID0gc1swXS5jb25jYXQoc1sxXSkuY29uY2F0KHNbMl0pO1xuICAgICAgICAgICAgdmFyIGNhcmRzcSA9IGNhcmRzcWUua3FfZXhjbHVkZXMocSk7XG4gICAgICAgICAgICBzWzBdID0gc1swXS5rcV9leGNsdWRlcyhzWzFdKTtcbiAgICAgICAgICAgIHNbMF0gPSBzWzBdLmtxX2V4Y2x1ZGVzKHNbMl0pO1xuICAgICAgICAgICAgc1sxXSA9IHNbMV0ua3FfZXhjbHVkZXMoc1swXSk7XG4gICAgICAgICAgICBzWzFdID0gc1sxXS5rcV9leGNsdWRlcyhzWzJdKTtcbiAgICAgICAgICAgIHNbMl0gPSBzWzJdLmtxX2V4Y2x1ZGVzKHNbMV0pO1xuICAgICAgICAgICAgc1syXSA9IHNbMl0ua3FfZXhjbHVkZXMoc1swXSk7XG4gICAgICAgICAgICAvL+WkmuS9meWIoOmZpFxuICAgICAgICAgICAgaWYgKHNbMl0ubGVuZ3RoID4gNSkgey8v5bC+6YGTXG4gICAgICAgICAgICAgICAgbGV0IGEgPSBzWzJdLnNwbGljZSg1LCBzWzJdLmxlbmd0aC01KTtcbiAgICAgICAgICAgICAgICBmb3IodmFyIHkgaW4gYSl7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRzcS5wdXNoKGFbeV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzWzFdLmxlbmd0aCA+IDUpIHsvL+S4remBk1xuICAgICAgICAgICAgICAgIGxldCBhID0gc1sxXS5zcGxpY2UoNSwgc1sxXS5sZW5ndGgtNSk7XG4gICAgICAgICAgICAgICAgZm9yKHZhciB5IGluIGEpe1xuICAgICAgICAgICAgICAgICAgICBjYXJkc3EucHVzaChhW3ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc1swXS5sZW5ndGggPiAzKSB7Ly/lpLTpgZNcbiAgICAgICAgICAgICAgICBsZXQgYSA9IHNbMF0uc3BsaWNlKDMsIHNbMF0ubGVuZ3RoLTMpO1xuICAgICAgICAgICAgICAgIGZvcih2YXIgeSBpbiBhKXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZHNxLnB1c2goYVt5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9jYXJkc3EgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0EoY2FyZHNxKTtcbiAgICAgICAgICAgIGNhcmRzcS5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XG4gICAgICAgICAgICBjYXJkc3EuZm9yRWFjaChmdW5jdGlvbihjYXJkMTEpe1xuICAgICAgICAgICAgICAgIGlmKGNhcmQxMS5wb2ludCA9PSAxNCl7XG4gICAgICAgICAgICAgICAgICAgIGNhcmQxMS5wb2ludCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL+aciee8uua3u+WKoFxuICAgICAgICAgICAgd2hpbGUoc1syXS5sZW5ndGggPCA1KSB7Ly/lsL7pgZNcbiAgICAgICAgICAgICAgICBzWzJdLnB1c2goY2FyZHNxLnBvcCgpIHx8IFtdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlKHNbMV0ubGVuZ3RoIDwgNSkgey8v5Lit6YGTXG4gICAgICAgICAgICAgICAgc1sxXS5wdXNoKGNhcmRzcS5wb3AoKSB8fCBbXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aGlsZShzWzBdLmxlbmd0aCA8IDMpIHsvL+WktOmBk1xuICAgICAgICAgICAgICAgIHNbMF0ucHVzaChjYXJkc3EucG9wKCkgfHwgW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyppZihjYXJkc3EubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgd2hpbGUoc1syXS5sZW5ndGggPCA1KSB7Ly/lsL7pgZNcbiAgICAgICAgICAgICAgICAgICAgc1syXS5wdXNoKGNhcmRzcS5wb3AoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoY2FyZHNxLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgIHdoaWxlKHNbMV0ubGVuZ3RoIDwgNSkgey8v5Lit6YGTXG4gICAgICAgICAgICAgICAgICAgIHNbMV0ucHVzaChjYXJkc3EucG9wKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGNhcmRzcS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICB3aGlsZShzWzBdLmxlbmd0aCA8IDMpIHsvL+WktOmBk1xuICAgICAgICAgICAgICAgICAgICBzWzBdLnB1c2goY2FyZHNxLnBvcCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9Ki9cbiAgICAgICAgICAgIGlmKHNbMl1bNF0gPT0gbnVsbCB8fCBzWzFdWzRdID09IG51bGwgfHwgc1swXVsyXSA9PSBudWxsXG4gICAgICAgICAgICAgICAgfHwgc1syXVs0XSA9PSAnJyB8fCBzWzFdWzRdID09ICcnIHx8IHNbMF1bMl0gPT0gJycpe1xuICAgICAgICAgICAgICAgIHJlc3VsdEFycmF5LnNwbGljZShpLDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJlc3VsdENhcmRzID0gW107XG4gICAgICAgIGxldCBjYXJkc3MxID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaTt9KTtcbiAgICAgICAgdmFyIGluZGV4YXNkZiA9IDI7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IDM7IGkrKyl7XG4gICAgICAgICAgICBsZXQgbGVuZ3RoID0gaW5kZXhhc2RmID09IDA/IDM6IDU7XG4gICAgICAgICAgICBsZXQgY2FyZHNzID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkc3MxLCBsZW5ndGgpIHx8IFtdO1xuICAgICAgICAgICAgY2FyZHNzMSA9IGNhcmRzczEua3FfZXhjbHVkZXMoY2FyZHNzKTtcbiAgICAgICAgICAgIHJlc3VsdENhcmRzW2luZGV4YXNkZl0gPSBjYXJkc3M7XG4gICAgICAgICAgICBpbmRleGFzZGYtLTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHJlc3VsdENhcmRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGxldCBsZW5ndGggPSBpID09IDA/IDM6IDU7XG4gICAgICAgICAgICBpZiAocmVzdWx0Q2FyZHNbaV0ubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2FyZHNzMSA9IGNhcmRzczEua3FfZXhjbHVkZXMocmVzdWx0Q2FyZHNbaV0pO1xuICAgICAgICAgICAgICAgIHdoaWxlKHJlc3VsdENhcmRzW2ldLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRDYXJkc1tpXS5wdXNoKGNhcmRzczEucG9wKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJlc3VsdEFycmF5LnB1c2gocmVzdWx0Q2FyZHMpO1xuXG4gICAgICAgIHZhciBjYXJkc1R5cGVOYW1lcyA9IFtdO1xuICAgICAgICB2YXIgcmVzdWx0QXJyYXlzID0gW107XG5cbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXkubGVuZ3RoO2krKyl7Ly/liKDpmaTnsbvlnovnm7jlkIznmoTnu4TlkIhcbiAgICAgICAgICAgIGxldCBzID0gcmVzdWx0QXJyYXlbaV07XG4gICAgICAgICAgICBsZXQgdHlwZU5hbWUwID0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoc1swXSk7XG4gICAgICAgICAgICB0eXBlTmFtZTAgKz0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoc1sxXSk7XG4gICAgICAgICAgICB0eXBlTmFtZTAgKz0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoc1syXSk7XG4gICAgICAgICAgICBpZihjYXJkc1R5cGVOYW1lcy5pbmRleE9mKHR5cGVOYW1lMCkgPT0gLTEpe1xuICAgICAgICAgICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1swXSk7XG4gICAgICAgICAgICAgICAgbGV0IHpob25nU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHNbMV0pO1xuICAgICAgICAgICAgICAgIGxldCB3ZWlTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1syXSk7XG4gICAgICAgICAgICAgICAgaWYoemhvbmdTY29yZSA+IHRvdVNjb3JlICYmIHpob25nU2NvcmUgPCB3ZWlTY29yZSl7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRzVHlwZU5hbWVzLnB1c2godHlwZU5hbWUwKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0QXJyYXlzLnB1c2gocyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmVzdWx0QXJyYXlzLnNvcnQoZnVuY3Rpb24gKGExLGEyKSB7XG4gICAgICAgICAgICB2YXIgYjAgPSBwYXJzZUludChLUUNhcmQuY2FyZHNUeXBlKGEyWzBdKSApICsgXCJcIjtcbiAgICAgICAgICAgIHZhciBiMSA9IHBhcnNlSW50KEtRQ2FyZC5jYXJkc1R5cGUoYTJbMV0pICkgKyBcIlwiO1xuICAgICAgICAgICAgdmFyIGIyID0gcGFyc2VJbnQoS1FDYXJkLmNhcmRzVHlwZShhMlsyXSkgKSArIFwiXCI7XG5cbiAgICAgICAgICAgIHZhciBzMCA9IHBhcnNlSW50KEtRQ2FyZC5jYXJkc1R5cGUoYTFbMF0pICkgKyBcIlwiO1xuICAgICAgICAgICAgdmFyIHMxID0gcGFyc2VJbnQoS1FDYXJkLmNhcmRzVHlwZShhMVsxXSkgKSArIFwiXCI7XG4gICAgICAgICAgICB2YXIgczIgPSBwYXJzZUludChLUUNhcmQuY2FyZHNUeXBlKGExWzJdKSApICsgXCJcIjtcblxuICAgICAgICAgICAgdmFyIHMgPSBwYXJzZUludChzMiArIHMxICsgczApO1xuICAgICAgICAgICAgdmFyIGIgPSBwYXJzZUludChiMiArIGIxICsgYjApO1xuXG4gICAgICAgICAgICByZXR1cm4gYiAtIHM7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmKHJlc3VsdEFycmF5cy5sZW5ndGggPiA3KXtcbiAgICAgICAgICAgIHJlc3VsdEFycmF5cyA9IHJlc3VsdEFycmF5cy5zbGljZSgwLDcpO1xuICAgICAgICB9XG4gICAgICAgIC8vZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXlzLmxlbmd0aDtpKyspey8v5aaC5p6c5pyJ55u45YWs54mM5YiZ5Yig6ZmkXG4gICAgICAgIC8vICAgIGxldCBzID0gcmVzdWx0QXJyYXlzW2ldO1xuICAgICAgICAvLyAgICBsZXQgdG91U2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHNbMF0pO1xuICAgICAgICAvLyAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1sxXSk7XG4gICAgICAgIC8vICAgIGxldCB3ZWlTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1syXSk7XG4gICAgICAgIC8vICAgIGNjLmxvZyh0b3VTY29yZSx6aG9uZ1Njb3JlLHdlaVNjb3JlKTtcbiAgICAgICAgLy8gICAgaWYod2VpU2NvcmUgPCB0b3VTY29yZSB8fCB3ZWlTY29yZSA8IHpob25nU2NvcmUpe1xuICAgICAgICAvLyAgICAgICAgcmVzdWx0QXJyYXlzLnNwbGljZShpLDEpO1xuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vfVxuICAgICAgICAvL2NjLmxvZyhyZXN1bHRBcnJheXMpXG4gICAgICAgIC8vY2MubG9nKCctLS0tLS0tODk3JylcblxuICAgICAgICAvL2lmKGNjLnRlU2h1UGFpQ2FyZHMpe1xuICAgICAgICAvLyAgICB2YXIgVGVTaHVDYXJkcyA9IGNjLnRlU2h1UGFpQ2FyZHMubWFwKGZ1bmN0aW9uKGNhKXtcbiAgICAgICAgLy8gICAgICAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhKSk7XG4gICAgICAgIC8vICAgIH0pO1xuICAgICAgICAvLyAgICByZXN1bHRBcnJheXMudW5zaGlmdChUZVNodUNhcmRzKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy99XG5cbiAgICAgICAgaWYocmVzdWx0QXJyYXlzLmxlbmd0aCA8PSAwKXtcblxuICAgICAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzLmZvckVhY2goZnVuY3Rpb24oaSl7aWYoaS5zY29yZXMgPT0gMSkgaS5zY29yZXMgPSAxNDt9KTtcblxuICAgICAgICAgICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAodGhpcy5fYWxsQ2FyZE1vZGVzKTtcblxuICAgICAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2FsbENhcmRNb2RlcyA9IEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHModGhpcy5fYWxsQ2FyZE1vZGVzKTtcblxuICAgICAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzID0gY2FyZDIwLmNvbmNhdCh0aGlzLl9hbGxDYXJkTW9kZXMpO1xuXG4gICAgICAgICAgICB2YXIgYXNkZjEgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoMCw1KTtcblxuICAgICAgICAgICAgdmFyIGFzZGYyID0gdGhpcy5fYWxsQ2FyZE1vZGVzLnNsaWNlKDUsMTApO1xuXG4gICAgICAgICAgICB2YXIgYXNkZjMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoMTAsMTMpO1xuXG4gICAgICAgICAgICByZXN1bHRBcnJheXMucHVzaChbYXNkZjMsYXNkZjIsYXNkZjFdKVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMuYXV0b0NhcmRTY3JvbGxWaWV3LnNjcm9sbFRvTGVmdCgpO1xuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCByZXN1bHRBcnJheXMubGVuZ3RoO2krKyl7Ly/mt7vliqDpooTliLbkvZNcbiAgICAgICAgICAgIGxldCBzID0gcmVzdWx0QXJyYXlzW2ldO1xuICAgICAgICAgICAgbGV0IGF1dG9DYXJkID0gY2MuaW5zdGFudGlhdGUodGhpcy5hdXRvQ2FyZCk7XG4gICAgICAgICAgICBhdXRvQ2FyZC55ID0gMDtcbiAgICAgICAgICAgIHNbMF0uZm9yRWFjaChmdW5jdGlvbihpKXtpZiAoaS5wb2ludCA9PSAxNCkgaS5wb2ludCA9IDE7fSlcbiAgICAgICAgICAgIHNbMV0uZm9yRWFjaChmdW5jdGlvbihpKXtpZiAoaS5wb2ludCA9PSAxNCkgaS5wb2ludCA9IDE7fSlcbiAgICAgICAgICAgIHNbMl0uZm9yRWFjaChmdW5jdGlvbihpKXtpZiAoaS5wb2ludCA9PSAxNCkgaS5wb2ludCA9IDE7fSlcbiAgICAgICAgICAgIHZhciBjYXJkc05vZGUgPSBbYXV0b0NhcmQuY2hpbGRyZW5bMV0sYXV0b0NhcmQuY2hpbGRyZW5bM10sYXV0b0NhcmQuY2hpbGRyZW5bMl1dO1xuXG4gICAgICAgICAgICB0aGlzLl9zZXRDYXJkRGFvU3ByaXRlKGNhcmRzTm9kZSxzKTtcblxuICAgICAgICAgICAgYXV0b0NhcmQuY2FyZEFycmF5ID0gcztcbiAgICAgICAgICAgIHZhciBldmVudEhhbmRsZXIgPSBuZXcgY2MuQ29tcG9uZW50LkV2ZW50SGFuZGxlcigpO1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVyLnRhcmdldCA9IHRoaXMubm9kZTtcbiAgICAgICAgICAgIGV2ZW50SGFuZGxlci5jb21wb25lbnQgPSBcIkNhcmRUeXBlQ29tYmluZVwiO1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVyLmhhbmRsZXIgPSBcImNsaWNrQXV0b1NlbGVjdGVkQ2FyZHNcIjtcbiAgICAgICAgICAgIGV2ZW50SGFuZGxlci5jdXN0b21FdmVudERhdGEgPSBpO1xuICAgICAgICAgICAgYXV0b0NhcmQuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuY2xpY2tFdmVudHMucHVzaChldmVudEhhbmRsZXIpO1xuICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLmFkZENoaWxkKGF1dG9DYXJkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9maW5kQ2FyZEluZGV4LmFyciA9IHJlc3VsdEFycmF5cztcblxuICAgICAgICB0aGlzLmF1dG9TZWxlY3RlZENhcmRzT25lKCk7XG4gICAgfSxcblxuICAgIC8vZGFvQ2FuY2VsQWxsOiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gICAgdmFyIG5vZGVzID0gW3RoaXMubGF5b3V0VG91RGFvLm5vZGUsdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLHRoaXMubGF5b3V0V2VpRGFvLm5vZGVdO1xuICAgIC8vICAgIGZvcih2YXIgaSA9IDA7aSA8IG5vZGVzLmxlbmd0aDtpKyspe1xuICAgIC8vICAgICAgICBub2Rlc1tpXS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuICAgIC8vICAgIH1cbiAgICAvL30sXG5cbiAgICBhdXRvU2VsZWN0ZWRDYXJkc09uZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuY2FyZHNMYXlvdXQubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgIHZhciBpbmRleHMgPSAwO1xuXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmF1dG9DYXJkTGF5b3V0Lm5vZGUuY2hpbGRyZW4ubGVuZ3RoO2krKyl7XG5cbiAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXMuYXV0b0NhcmRMYXlvdXQubm9kZS5jaGlsZHJlbltpXTtcblxuICAgICAgICAgICAgbm9kZXMuY2hpbGRyZW5bMF0uYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYXV0b0NhcmRMYXlvdXQubm9kZS5jaGlsZHJlbltpbmRleHNdLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgbGV0IHJlc3VsdEFycmF5ID0gdGhpcy5fZmluZENhcmRJbmRleC5hcnJbaW5kZXhzXTtcblxuICAgICAgICB0aGlzLl9maW5kQ2FyZEluZGV4LmluZGV4cyA9IGluZGV4cztcblxuXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHJlc3VsdEFycmF5Lmxlbmd0aDtpKyspe1xuXG4gICAgICAgICAgICB2YXIgY2FyZE1vZGVzID0gcmVzdWx0QXJyYXlbaV07XG5cbiAgICAgICAgICAgIGNhcmRNb2Rlcy5zb3J0KEtRQ2FyZC5zb3J0KTtcblxuICAgICAgICAgICAgdmFyIG51bSA9IDA7XG4gICAgICAgICAgICBpZihpID09IDEpe1xuICAgICAgICAgICAgICAgIG51bSA9IDM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGkgPT0gMil7XG4gICAgICAgICAgICAgICAgbnVtID0gODtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vY2FyZE1vZGVzLmZvckVhY2goZnVuY3Rpb24oaSl7aWYgKGkucG9pbnQgPT0gMTQpIGkucG9pbnQgPSAxO30pXG4gICAgICAgICAgICBjYXJkTW9kZXMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZE1vZGUsaW5kZXgpIHtcblxuICAgICAgICAgICAgICAgIHZhciBjYXJkTmFtZSA9IGNhcmRNb2RlLmNhcmROYW1lKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbnVtQmVyID0gbnVtK2luZGV4O1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGRzMSA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXG5cbiAgICAgICAgICAgICAgICBub2RkczEuYW5jaG9yWSA9IDE7XG5cbiAgICAgICAgICAgICAgICBub2RkczEuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuW251bUJlcl0uYWRkQ2hpbGQobm9kZHMxKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW5bbnVtQmVyXS5jaGlsZHJlblswXS5jYXJkTmFtZSA9IGNhcmROYW1lO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbltudW1CZXJdLmNoaWxkcmVuWzBdLl9jYXJkTW9kZWwgPSBuZXcgS1FDYXJkKGNhcmROYW1lLG51bGwsaW5kZXgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGJ0blNwcml0ZXMgPSAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbltudW1CZXJdLmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbltudW1CZXJdLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gJyc7XG5cbiAgICAgICAgICAgICAgICBidG5TcHJpdGVzLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcblxuICAgICAgICAgICAgICAgIGlmKGNjLm1hUGFpID09IGNhcmROYW1lKXtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZHMgPSBuZXcgY2MuTm9kZSgpOyAvL+WIm+W7uuS4gOS4quiKgueCueWvueixoVxuXG4gICAgICAgICAgICAgICAgICAgIG5vZGRzLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgICAgICAgICAgICAgIGNjLmxvYWRlci5sb2FkUmVzKCdwbGF5L2Rlc2svaW1nX3JlZDVfMScsIGNjLlNwcml0ZUZyYW1lLCBmdW5jdGlvbiAoZXJyLCBzcHJpdGVGcmFtZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7Y2MuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyKTtyZXR1cm47fVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnRuU3ByaXRlMSA9IG5vZGRzLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEubm9kZS53aWR0aCA9IDEwNztcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5ub2RlLmhlaWdodCA9IDE1NTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5ub2RlLnkgPSAtNjUuNTtcblxuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZXMubm9kZS5hZGRDaGlsZChub2Rkcyk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9ICdwdWJsaWMtcGljLWNhcmQtcG9rZXItJysgY2FyZE5hbWU7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxidG5TcHJpdGVzLCA5NSwgMTMwKTtcblxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2xpY2tBdXRvU2VsZWN0ZWRDYXJkcyhudWxsKTtcblxuICAgICAgICAvL3RoaXMuX3NldENhcmREYW9TcHJpdGUoKTtcblxuICAgIH0sXG5cbiAgICBjbGlja0F1dG9TZWxlY3RlZENhcmRzOiBmdW5jdGlvbihldmVudCxpbmRleHMgPSAwKSB7XG5cbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMuYXV0b0NhcmRMYXlvdXQubm9kZS5jaGlsZHJlbi5sZW5ndGg7aSsrKXtcblxuICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLmNoaWxkcmVuW2ldO1xuXG4gICAgICAgICAgICBub2Rlcy5jaGlsZHJlblswXS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLmNoaWxkcmVuW2luZGV4c10uY2hpbGRyZW5bMF0uYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVBva2VyQ2xpY2soKTtcblxuICAgICAgICBpZihldmVudCl7XG4gICAgICAgICAgICB2YXIgcmVzdWx0QXJyYXkgPSBldmVudC50YXJnZXQuY2FyZEFycmF5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICB2YXIgcmVzdWx0QXJyYXkgPSB0aGlzLl9maW5kQ2FyZEluZGV4LmFycltpbmRleHNdO1xuICAgICAgICB9XG4gICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0QXJyYXlbMF0pO1xuICAgICAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0QXJyYXlbMV0pO1xuICAgICAgICBsZXQgd2VpU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHJlc3VsdEFycmF5WzJdKTtcbiAgICAgICAgLy9jYy5sb2codG91U2NvcmUpO1xuICAgICAgICAvL2NjLmxvZyh6aG9uZ1Njb3JlKTtcbiAgICAgICAgLy9jYy5sb2cod2VpU2NvcmUpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCctLS0tLS0tLS0tMTE4MCcpXG4gICAgICAgIHJlc3VsdEFycmF5ID0gcmVzdWx0QXJyYXkubWFwKGZ1bmN0aW9uIChjYXJkTW9kZSl7XG5cbiAgICAgICAgICAgIGNhcmRNb2RlID0gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhjYXJkTW9kZSk7XG5cbiAgICAgICAgICAgIHJldHVybiBjYXJkTW9kZS5tYXAoZnVuY3Rpb24gKGNhcmRNb2Rlcyl7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gY2FyZE1vZGVzLmNhcmROYW1lKCk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXN1bHRBcnJheSlcblxuICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudC5mb3JFYWNoKGZ1bmN0aW9uKG5vZGVzKXtcblxuICAgICAgICAgICAgbm9kZXMuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7XG5cbiAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oaSl7aS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTt9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQgPSBbXTtcblxuICAgICAgICByZXN1bHRBcnJheSA9IHJlc3VsdEFycmF5WzBdLmNvbmNhdChyZXN1bHRBcnJheVsxXSkuY29uY2F0KHJlc3VsdEFycmF5WzJdKTtcblxuICAgICAgICB2YXIgY2FyZEFsbE5vZGUgPSB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaTt9KTtcblxuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCByZXN1bHRBcnJheS5sZW5ndGg7aSsrKXtcblxuICAgICAgICAgICAgdmFyIHMgPSByZXN1bHRBcnJheVtpXTtcblxuICAgICAgICAgICAgZm9yKHZhciBqID0gMDtqIDwgY2FyZEFsbE5vZGUubGVuZ3RoO2orKyl7XG5cbiAgICAgICAgICAgICAgICB2YXIgZCA9IGNhcmRBbGxOb2RlW2pdO1xuXG4gICAgICAgICAgICAgICAgZC5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGlmKGQuY2hpbGRyZW5bMF0uY2FyZE5hbWUgPT0gcyl7XG5cbiAgICAgICAgICAgICAgICAgICAgZC5zdG9wQWxsQWN0aW9ucygpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXRhaWwgPSB0aGlzLmNoYW5nZU5vZGVTcGFjZUFSW2ldO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjYWxsID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24obm9kZXMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0Q2FyZERhb1Nwcml0ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgdGhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZC5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2MubW92ZVRvKHRoaXMuY2FyZFRpbWUsZGV0YWlsKSwgY2FsbCkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhcmRBbGxOb2RlLnNwbGljZShqLDEpXG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICB9LFxuXG4gICAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uKFNwcml0ZUZyYW1lLCBwYXRoLCBTcHJpdGVzTm9kZSwgdywgaCkge1xuXG4gICAgICAgIHZhciBTcHJpdGUgPSBTcHJpdGVGcmFtZS5nZXRTcHJpdGVGcmFtZSggcGF0aCApO1xuXG4gICAgICAgIFNwcml0ZXNOb2RlLnNwcml0ZUZyYW1lID0gU3ByaXRlO1xuXG4gICAgICAgIGlmKHcpIFNwcml0ZXNOb2RlLm5vZGUud2lkdGggPSB3O1xuXG4gICAgICAgIGlmKGgpIFNwcml0ZXNOb2RlLm5vZGUuaGVpZ2h0ID0gaDtcbiAgICB9LFxuXG4gICAgc3RpY2tPdXRGaW5kQ2FyZFR5cGUxOiBmdW5jdGlvbiAoY2FyZHMsaW5kZXggPSAwKSB7XG4gICAgICAgIC8vLy8g5bCG5bey5pyJ55qE56qB5Ye655qE54mM55qE5L2N572u6YeN572u5Zue5Yid5aeL5L2N572uXG4gICAgICAgIC8vdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xuICAgICAgICAvL2xldCBzZWxlY3RlZENhcmROYW1lcyA9IGNhcmRzLm1hcChmdW5jdGlvbihjYXJkTW9kZWwpe1xuICAgICAgICAvLyAgICByZXR1cm4gY2FyZE1vZGVsLmNhcmROYW1lKCk7XG4gICAgICAgIC8vfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLmZpbHRlcihmdW5jdGlvbiAoY2FyZE5vZGUpIHtcbiAgICAgICAgLy8gICAgbGV0IGNhcmRQcmVmYWIgPSBjYXJkTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgLy8gICAgaWYoc2VsZWN0ZWRDYXJkTmFtZXMuaW5jbHVkZXMoY2FyZFByZWZhYi5jYXJkTmFtZSgpKSkge1xuICAgICAgICAvLyAgICAgICAgdmFyIG5hbWVJbmRleCA9IHNlbGVjdGVkQ2FyZE5hbWVzLmluZGV4T2YoY2FyZFByZWZhYi5jYXJkTmFtZSgpKTtcbiAgICAgICAgLy8gICAgICAgIHNlbGVjdGVkQ2FyZE5hbWVzLnNwbGljZShuYW1lSW5kZXgsMSk7XG4gICAgICAgIC8vICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvLyAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIC8vfSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vY2MubG9nKCctLS0tLS0tNjk2JylcbiAgICAgICAgLy90aGlzLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcbiAgICAgICAgLy9pZihpbmRleCA9PSAxKXtcbiAgICAgICAgLy8gICAgdGhpcy5fYWRkRGFvQ2FyZFRvTGF5b3V0KHRoaXMubGF5b3V0VG91RGFvLm5vZGUsIDMpO1xuICAgICAgICAvL31cbiAgICAgICAgLy9lbHNlIGlmKGluZGV4ID09IDIpe1xuICAgICAgICAvLyAgICB0aGlzLl9hZGREYW9DYXJkVG9MYXlvdXQodGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKTtcbiAgICAgICAgLy99XG4gICAgICAgIC8vZWxzZSBpZihpbmRleCA9PSAzKXtcbiAgICAgICAgLy8gICAgdGhpcy5fYWRkRGFvQ2FyZFRvTGF5b3V0KHRoaXMubGF5b3V0V2VpRGFvLm5vZGUpO1xuICAgICAgICAvL31cblxuICAgIH0sXG5cbiAgICBfdG91Y2hDYXJkTGF5b3V0OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy9ldmVudC5idWJibGVzID0gdHJ1ZTtcbiAgICAgICAgLy9sZXQgbG9jYXRpb24gPSBldmVudC5nZXRMb2NhdGlvbigpO1xuICAgICAgICAvL2xldCBjYXJkUHJlZmFiID0gdGhpcy5fY2FyZFByZWZhYkluQ2FyZExheW91dFdpdGhMb2NhdGlvbihsb2NhdGlvbik7XG4gICAgICAgIC8vaWYgKGNhcmRQcmVmYWIpIHtcbiAgICAgICAgLy8gICAgY2FyZFByZWZhYi5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKS5zZXRTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgLy8gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIC8vfVxuICAgIH0sXG5cbiAgICBfdG91Y2hDYXJkTGF5b3V0RW5kOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy90aGlzLl9jaGFuZ2VTZWxlY3RlZENhcmRQcmVmYWJzWSgpO1xuICAgICAgICAvL3RoaXMuX2Rpc2VjbGVjdENhcmRQcmVmYWJzKCk7XG4gICAgfSxcblxuICAgIF9jYXJkUHJlZmFiSW5DYXJkTGF5b3V0V2l0aExvY2F0aW9uOiBmdW5jdGlvbiAobG9jYXRpb24pIHtcbiAgICAgICAgLy9sb2NhdGlvbiA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jb252ZXJ0VG9Ob2RlU3BhY2VBUihsb2NhdGlvbik7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5zb3J0KGZ1bmN0aW9uIChjYXJkTm9kZTEsIGNhcmROb2RlMikge1xuICAgICAgICAvLyAgICBsZXQgcmVjdDEgPSBjYXJkTm9kZTEuZ2V0Qm91bmRpbmdCb3goKTtcbiAgICAgICAgLy8gICAgbGV0IHJlY3QyID0gY2FyZE5vZGUyLmdldEJvdW5kaW5nQm94KCk7XG4gICAgICAgIC8vICAgIHJldHVybiByZWN0Mi54IC0gcmVjdDEueDtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy9mb3IgKGxldCBpbmRleCBpbiBjYXJkTm9kZXMpIHtcbiAgICAgICAgLy8gICAgbGV0IGNhcmROb2RlID0gY2FyZE5vZGVzW2luZGV4XTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgbGV0IHJlY3QgPSBjYXJkTm9kZS5nZXRCb3VuZGluZ0JveCgpO1xuICAgICAgICAvL1xuICAgICAgICAvLyAgICBpZiAoY2MucmVjdENvbnRhaW5zUG9pbnQocmVjdCwgbG9jYXRpb24pKSB7XG4gICAgICAgIC8vICAgICAgICByZXR1cm4gY2FyZE5vZGU7XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy99XG4gICAgICAgIC8vXG4gICAgICAgIC8vcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9jaGFuZ2VTZWxlY3RlZENhcmRQcmVmYWJzWTogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLl9zZWxlY3RlZENhcmRQcmVmYWJzKCk7XG4gICAgICAgIC8vdGhpcy5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlQb2tlckNsaWNrKCk7XG4gICAgfSxcblxuICAgIF9jaGFuZ2VDYXJkUHJlZmFic1k6IGZ1bmN0aW9uIChjYXJkTm9kZXMpIHtcbiAgICAgICAgLy9jYXJkTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZE5vZGUpIHtcbiAgICAgICAgLy8gICAgbGV0IHkgPSBjYXJkTm9kZS5nZXRQb3NpdGlvblkoKTtcbiAgICAgICAgLy8gICAgaWYgKHkgPT0gdGhpcy5fY2FyZE9mZnNldFkpIHtcbiAgICAgICAgLy8gICAgICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSArIDU1KTtcbiAgICAgICAgLy8gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gICAgICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSk7XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy99LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBfc2VsZWN0ZWRDYXJkUHJlZmFiczogZnVuY3Rpb24gKGluY2x1ZGVTdGlja091dCA9IGZhbHNlKSB7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgLy9yZXR1cm4gY2FyZE5vZGVzLmZpbHRlcihmdW5jdGlvbiAoY2FyZE5vZGUpIHtcbiAgICAgICAgLy8gICAgbGV0IGNhcmRQcmVmYWIgPSBjYXJkTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgLy8gICAgbGV0IGlzU2VsZWN0ZWQgPSBjYXJkUHJlZmFiLmlzU2VsZWN0ZWQoKTtcbiAgICAgICAgLy8gICAgaWYgKCFpc1NlbGVjdGVkICYmIGluY2x1ZGVTdGlja091dCkge1xuICAgICAgICAvLyAgICAgICAgaXNTZWxlY3RlZCA9IGNhcmROb2RlLmdldFBvc2l0aW9uWSgpID4gMTA7XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgcmV0dXJuIGlzU2VsZWN0ZWQ7XG4gICAgICAgIC8vfSk7XG4gICAgfSxcblxuICAgIF9kaXNlY2xlY3RDYXJkUHJlZmFiczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW47XG4gICAgICAgIC8vY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgLy8gICAgbm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKS5zZXRTZWxlY3RlZChmYWxzZSk7XG4gICAgICAgIC8vfSk7XG4gICAgfSxcblxuICAgIC8vIOmHjee9riBjYXJkcyDnmoQgWFxuICAgIF9yZXNldENhcmRzUG9zaXRpb25YOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vbGV0IGludGVydmFsID0gOTg7XG4gICAgICAgIC8vbGV0IGludGVydmFsID0gNzg7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgLy9sZXQgbGVuZ3RoID0gY2FyZE5vZGVzLmxlbmd0aDtcbiAgICAgICAgLy9pZiAobGVuZ3RoID09IDApIHtcbiAgICAgICAgLy8gICAgcmV0dXJuO1xuICAgICAgICAvL31cbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgbWlkZGxlSW5kZXggPSBsZW5ndGggLyAyO1xuICAgICAgICAvL2xldCBjYXJkV2lkdGggPSAxNTQ7XG4gICAgICAgIC8vXG4gICAgICAgIC8vXG4gICAgICAgIC8vLy90aGlzLmNhcmRzTGF5b3V0U29ydCgpO1xuICAgICAgICAvL2lmKHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPT0gdHJ1ZSl7XG4gICAgICAgIC8vICAgIHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgLy8gICAgICAgIGxldCBjb21wb25lbnQxID0gbjEuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vICAgICAgICBsZXQgY29tcG9uZW50MiA9IG4yLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAvLyAgICAgICAgcmV0dXJuIGNvbXBvbmVudDIuY2FyZE1vZGUoKS5jb2xvciAtIGNvbXBvbmVudDEuY2FyZE1vZGUoKS5jb2xvcjtcbiAgICAgICAgLy8gICAgfSk7XG4gICAgICAgIC8vfWVsc2V7XG4gICAgICAgIC8vICAgIHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgLy8gICAgICAgIGxldCBjb21wb25lbnQxID0gbjEuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vICAgICAgICBsZXQgY29tcG9uZW50MiA9IG4yLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAvLyAgICAgICAgcmV0dXJuIGNvbXBvbmVudDEuY2FyZE1vZGUoKS5zb3J0KGNvbXBvbmVudDIuY2FyZE1vZGUoKSk7XG4gICAgICAgIC8vICAgIH0pO1xuICAgICAgICAvL31cbiAgICAgICAgLy8vL2NhcmROb2Rlcy5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgLy8vLyAgICBsZXQgY29tcG9uZW50MSA9IG4xLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAvLy8vICAgIGxldCBjb21wb25lbnQyID0gbjIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vLy9cbiAgICAgICAgLy8vLyAgICByZXR1cm4gY29tcG9uZW50MS5jYXJkTW9kZSgpLnNvcnQoY29tcG9uZW50Mi5jYXJkTW9kZSgpKTtcbiAgICAgICAgLy8vL30pO1xuICAgICAgICAvL1xuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSwgaW5kZXgpIHtcbiAgICAgICAgLy8gICAgY2FyZE5vZGUuekluZGV4ID0gaW5kZXg7XG4gICAgICAgIC8vICAgIGxldCB4ID0gKGluZGV4IC0gbWlkZGxlSW5kZXgpICogaW50ZXJ2YWwgKyBjYXJkV2lkdGggLyAzO1xuICAgICAgICAvLyAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblgoeCk7XG4gICAgICAgIC8vfSk7XG4gICAgfSxcblxuICAgIC8vIOmHjee9riBjYXJkcyDnmoQgWOS4ujBcbiAgICByZXNldENhcmRzUG9zaXRpb25YMTogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4gfHwgW107XG4gICAgICAgIC8vbGV0IGxlbmd0aCA9IGNhcmROb2Rlcy5sZW5ndGg7XG4gICAgICAgIC8vaWYgKGxlbmd0aCA9PSAwKSB7XG4gICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgLy99XG4gICAgICAgIC8vY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgIC8vICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSgwKTtcbiAgICAgICAgLy99KTtcbiAgICB9LFxuXG4gICAgX3Jlc2V0Q2FyZHNQb3NpdGlvblk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xuICAgICAgICAvLyAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblkodGhpcy5fY2FyZE9mZnNldFkpO1xuICAgICAgICAvL30uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIC8vIOWktOOAgeS4reOAgeWwvumBkyBsYXlvdXQg55qE54K55Ye75LqL5Lu2XG4gICAgX3JlZ2lzdGVyRGFvc0xheW91dENsaWNrRXZlbnQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB0aGlzLmNoYW5nZU5vZGVTcGFjZUFSID0gW107Ly/orrDlvZXmiYDmnInniYznmoTlnZDmoIdcbiAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG5vZGVzKXtcbiAgICAgICAgICAgIC8v6I635Y+W6IqC54K555qE5LiW55WM5Z2Q5qCHXG4gICAgICAgICAgICB2YXIgY2FyZEJhY2tXb3JsZFNwYWNlMSA9IG5vZGVzLmNvbnZlcnRUb1dvcmxkU3BhY2VBUihjYy52MigwLCAwKSk7XG4gICAgICAgICAgICAvL+iOt+WPluebuOWvueeItuiKgueCueaJgOWcqOeahOWdkOagh1xuICAgICAgICAgICAgdmFyIGRldGFpbCA9IG5vZGVzLnBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UxKTtcblxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VOb2RlU3BhY2VBUi5wdXNoKGRldGFpbCk7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tBbGxDYXJkOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlQb2tlckNsaWNrKCk7XG4gICAgICAgIGlmKHRoaXMuTGF5b3V0V2l0aEV2ZW50Lmxlbmd0aCA8PSAxKXtcbiAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50LnB1c2goZXZlbnQudGFyZ2V0KTtcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC5jb2xvciA9IG5ldyBjYy5Db2xvcigxODIsIDE4MiwgMTgyKTtcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGkpe2kuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTgyLCAxODIsIDE4Mik7fSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYodGhpcy5MYXlvdXRXaXRoRXZlbnQubGVuZ3RoID09IDIpe1xuXG4gICAgICAgICAgICB2YXIgYXJyID0gW107XG5cbiAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50LmZvckVhY2goZnVuY3Rpb24obm9kZXMpe1xuICAgICAgICAgICAgICAgIC8v6I635Y+W6IqC54K555qE5LiW55WM5Z2Q5qCHXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRCYWNrV29ybGRTcGFjZTEgPSBub2Rlcy5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoMCwgMCkpO1xuICAgICAgICAgICAgICAgIC8v6I635Y+W55u45a+554i26IqC54K55omA5Zyo55qE5Z2Q5qCHXG4gICAgICAgICAgICAgICAgdmFyIGRldGFpbCA9IG5vZGVzLnBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UxKTtcblxuICAgICAgICAgICAgICAgIGFyci51bnNoaWZ0KGRldGFpbCk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50LmZvckVhY2goZnVuY3Rpb24obm9kZXMsaW5kZXgpe1xuXG4gICAgICAgICAgICAgICAgbm9kZXMuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7XG5cbiAgICAgICAgICAgICAgICBub2Rlcy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGkpe2kuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7fSk7XG5cbiAgICAgICAgICAgICAgICBub2Rlcy5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICBub2Rlcy5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldENhcmREYW9TcHJpdGUoKTtcblxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgdGhpcy5jYXJkVGltZSk7XG5cbiAgICAgICAgICAgICAgICBub2Rlcy5zdG9wQWxsQWN0aW9ucygpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRldGFpbCA9IGFycltpbmRleF07XG5cbiAgICAgICAgICAgICAgICBub2Rlcy5ydW5BY3Rpb24oY2MubW92ZVRvKHRoaXMuY2FyZFRpbWUsZGV0YWlsKSk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50ID0gW107XG5cbiAgICAgICAgfVxuXG4gICAgfSxcblxuICAgIF9zZXRDYXJkRGFvU3ByaXRlOiBmdW5jdGlvbiAobm9kZXMgPSBudWxsICxjYXJkcyA9IG51bGwpIHtcblxuICAgICAgICBpZighbm9kZXMpe1xuXG4gICAgICAgICAgICB0aGlzLmNhcmRBbGxzID0gIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBiLnkgLSBhLnk7fSkubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBpLmNoaWxkcmVuWzBdO30pO1xuXG4gICAgICAgICAgICBjYXJkcyA9IFt0aGlzLl90YW9EYW9DYXJkTW9kZXMoKSx0aGlzLl96aG9uZ0Rhb0NhcmRNb2RlcygpLHRoaXMuX3dlaURhb0NhcmRNb2RlcygpXTtcblxuICAgICAgICAgICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtjYXJkLmZvckVhY2goZnVuY3Rpb24oaSl7aWYgKGkuc2NvcmVzID09IDE0KXtpLnNjb3JlcyA9IDE7fX0pO30pO1xuXG4gICAgICAgICAgICBub2RlcyA9IFt0aGlzLnRvdURhb05vZGUsdGhpcy56aG9uZ0Rhb05vZGUsdGhpcy53ZWlEYW9Ob2RlXTtcblxuICAgICAgICB9XG5cbiAgICAgICAgLy/lpLTpgZNcbiAgICAgICAgbGV0IHR5cGVOYW1lMCA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHNbMF0pKzE7XG5cbiAgICAgICAgdHlwZU5hbWUwID0gdHlwZU5hbWUwPj0xMCA/IHR5cGVOYW1lMCA6XCIwXCIrdHlwZU5hbWUwO1xuXG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD09JzA0JyA/ICcxMScgOnR5cGVOYW1lMDtcblxuICAgICAgICB2YXIgcGF0aCA9ICdnYW1lX3Bva2VyX3R5cGUnKyB0eXBlTmFtZTA7XG5cbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZSh0aGlzLmRhb1Nwcml0ZUF0bGFzLCBwYXRoICxub2Rlc1swXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKSk7XG5cbiAgICAgICAgLy/kuK3pgZNcbiAgICAgICAgbGV0IHR5cGVOYW1lMSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHNbMV0pKzE7XG5cbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPj0xMCA/IHR5cGVOYW1lMSA6XCIwXCIrdHlwZU5hbWUxO1xuXG4gICAgICAgIHR5cGVOYW1lMSA9IHR5cGVOYW1lMT09JzA3JyA/ICcyMicgOnR5cGVOYW1lMTtcblxuICAgICAgICBwYXRoID0gJ2dhbWVfcG9rZXJfdHlwZScrIHR5cGVOYW1lMTtcblxuICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuZGFvU3ByaXRlQXRsYXMsIHBhdGggLG5vZGVzWzFdLmdldENvbXBvbmVudChjYy5TcHJpdGUpKTtcblxuICAgICAgICAvL+WwvumBk1xuICAgICAgICBsZXQgdHlwZU5hbWUyID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkc1syXSkrMTtcblxuICAgICAgICB0eXBlTmFtZTIgPSB0eXBlTmFtZTI+PTEwID8gdHlwZU5hbWUyIDpcIjBcIit0eXBlTmFtZTI7XG5cbiAgICAgICAgcGF0aCA9ICdnYW1lX3Bva2VyX3R5cGUnKyB0eXBlTmFtZTI7XG5cbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZSh0aGlzLmRhb1Nwcml0ZUF0bGFzLCBwYXRoICxub2Rlc1syXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKSk7XG5cbiAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG4pe24uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBcIlwiO30pO1xuXG4gICAgICAgIGlmKGNhcmRzKXtcblxuICAgICAgICAgICAgaWYodHlwZU5hbWUwKSBLUUNhcmQuX3NldEd1aUNhcmQoMCwgMCwgMywgdHlwZU5hbWUwLCBjYXJkcywgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbiwgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xuXG4gICAgICAgICAgICBpZih0eXBlTmFtZTEpIEtRQ2FyZC5fc2V0R3VpQ2FyZCgxLCAzLCA4LCB0eXBlTmFtZTEsIGNhcmRzLCB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG5cbiAgICAgICAgICAgIGlmKHR5cGVOYW1lMikgS1FDYXJkLl9zZXRHdWlDYXJkKDIsIDgsIDEzLCB0eXBlTmFtZTIsIGNhcmRzLCB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG5cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfY2xpY2tUb3VEYW9MYXlvdXQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLl9kYW9DYXJkTm9kZUluTGF5b3V0V2l0aEV2ZW50KHRoaXMubGF5b3V0VG91RGFvLm5vZGUsIGV2ZW50KTtcbiAgICB9LFxuXG4gICAgX2NsaWNrWmhvbmdEYW9MYXlvdXQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLl9kYW9DYXJkTm9kZUluTGF5b3V0V2l0aEV2ZW50KHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZSwgZXZlbnQpO1xuICAgIH0sXG5cbiAgICBfY2xpY2tXZWlEYW9MYXlvdXQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLl9kYW9DYXJkTm9kZUluTGF5b3V0V2l0aEV2ZW50KHRoaXMubGF5b3V0V2VpRGFvLm5vZGUsIGV2ZW50KTtcbiAgICB9LFxuXG4gICAgX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQ6IGZ1bmN0aW9uIChub2RlLCBldmVudCkge1xuICAgICAgICBsZXQgY2FyZE5vZGVzID0gbm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgdmFyIGxvY2F0aW9uID0gZXZlbnQuZ2V0TG9jYXRpb24oKTtcbiAgICAgICAgbG9jYXRpb24gPSBub2RlLmNvbnZlcnRUb05vZGVTcGFjZUFSKGxvY2F0aW9uKTtcbiAgICAgICAgLy92YXIgY2FyZEJhY2tXb3JsZFNwYWNlID0gdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLmNvbnZlcnRUb1dvcmxkU3BhY2VBUihjYy52MigwLCAwKSk7XG4gICAgICAgIC8vLy/ojrflj5boioLngrnnmoTkuJbnlYzlnZDmoIdcbiAgICAgICAgLy92YXIgZGV0YWlsID0gdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLnBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UpO1xuICAgICAgICAvLy8v6I635Y+W55u45a+554i26IqC54K55omA5Zyo55qE5Z2Q5qCHXG4gICAgICAgIC8vdGhpcy5sYXlvdXRXZWlEYW8ubm9kZS5ydW5BY3Rpb24oY2MubW92ZVRvKDEsZGV0YWlsKSk7XG4gICAgICAgIGZvciAobGV0IGluZGV4IGluIGNhcmROb2Rlcykge1xuICAgICAgICAgICAgbGV0IGNhcmROb2RlID0gY2FyZE5vZGVzW2luZGV4XTtcbiAgICAgICAgICAgIGxldCByZWN0ID0gY2FyZE5vZGUuZ2V0Qm91bmRpbmdCb3goKTtcbiAgICAgICAgICAgIGlmIChjYy5yZWN0Q29udGFpbnNQb2ludChyZWN0LCBsb2NhdGlvbikpIHtcbiAgICAgICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVBva2VyQ2xpY2soKTtcbiAgICAgICAgICAgICAgICBsZXQgYXJycyA9IFtub2RlICxjYXJkTm9kZV07XG4gICAgICAgICAgICAgICAgaWYodGhpcy5MYXlvdXRXaXRoRXZlbnQubGVuZ3RoID09IDEpe1xuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLkxheW91dFdpdGhFdmVudFswXVswXS5uYW1lICE9IG5vZGUubmFtZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkTm9kZS5vcGFjaXR5ID0gMjAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQucHVzaChhcnJzKTtcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudFswXVsxXS5vcGFjaXR5ID0gMjU1O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMuTGF5b3V0V2l0aEV2ZW50Lmxlbmd0aCA9PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgLy9jYy5sb2coY2FyZE5vZGUpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50LnB1c2goYXJycyk7XG4gICAgICAgICAgICAgICAgICAgIGNhcmROb2RlLm9wYWNpdHkgPSAyMDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKHRoaXMuTGF5b3V0V2l0aEV2ZW50Lmxlbmd0aCA9PSAyKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUxID0gdGhpcy5MYXlvdXRXaXRoRXZlbnRbMF1bMV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlMiA9IHRoaXMuTGF5b3V0V2l0aEV2ZW50WzFdWzFdO1xuICAgICAgICAgICAgICAgICAgICAvL+iOt+WPluiKgueCueeahOS4lueVjOWdkOagh1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZEJhY2tXb3JsZFNwYWNlID0gbm9kZTEuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLnYyKDAsIDApKTtcbiAgICAgICAgICAgICAgICAgICAgLy/ojrflj5bnm7jlr7nniLboioLngrnmiYDlnKjnmoTlnZDmoIdcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRldGFpbCA9IG5vZGUxLnBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UpO1xuICAgICAgICAgICAgICAgICAgICBub2RlMi5ydW5BY3Rpb24oY2MubW92ZVRvKDEsZGV0YWlsKSk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9yZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX2FkZERhb0NhcmRUb0xheW91dDogZnVuY3Rpb24gKG5vZGUsIG1heE51bWJlckNhcmQgPSA1KSB7XG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IG5vZGUuY2hpbGRyZW4gfHwgW107XG4gICAgICAgIC8vaWYgKGNhcmROb2Rlcy5sZW5ndGggPj0gNSkge1xuICAgICAgICAvLyAgICByZXR1cm47XG4gICAgICAgIC8vfVxuICAgICAgICAvL2xldCByZW1haW5Db3VudCA9IG1heE51bWJlckNhcmQgLSBjYXJkTm9kZXMubGVuZ3RoO1xuICAgICAgICAvL1xuICAgICAgICAvL3ZhciBzZWxlY3RlZENhcmRzID0gdGhpcy5fc2VsZWN0ZWRDYXJkUHJlZmFicyh0cnVlKSB8fCBbXTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9pZiAoc2VsZWN0ZWRDYXJkcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAvLyAgICByZXR1cm47XG4gICAgICAgIC8vfVxuICAgICAgICAvL2lmIChzZWxlY3RlZENhcmRzLmxlbmd0aCA+IHJlbWFpbkNvdW50KSB7XG4gICAgICAgIC8vICAgIHNlbGVjdGVkQ2FyZHMgPSBzZWxlY3RlZENhcmRzLnNsaWNlKDAsIHJlbWFpbkNvdW50KTtcbiAgICAgICAgLy99XG4gICAgICAgIC8vXG4gICAgICAgIC8vbGV0IHNlbGVjdGVkQ2FyZE5hbWVzID0gc2VsZWN0ZWRDYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmRQcmVmYWIpIHtcbiAgICAgICAgLy8gICAgcmV0dXJuIGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuY2FyZE5hbWUoKTtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9jYXJkTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZFR5cGVOb2RlKSB7XG4gICAgICAgIC8vICAgIHNlbGVjdGVkQ2FyZE5hbWVzLnB1c2goY2FyZFR5cGVOb2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVTcHJpdGUnKS5jYXJkTmFtZSgpKTtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9sZXQgY2FyZE1vZGVzID0gc2VsZWN0ZWRDYXJkTmFtZXMubWFwKGZ1bmN0aW9uIChjYXJkTmFtZSxpbmRleCkge1xuICAgICAgICAvLyAgICByZXR1cm4gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICAgICAgLy99KS5zb3J0KGZ1bmN0aW9uIChjMSwgYzIpIHtcbiAgICAgICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5zb3J0KGMxLCBjMiwgZmFsc2UpO1xuICAgICAgICAvL30pO1xuXG4gICAgICAgIC8vbGV0IHRvdUNhcmRNb2RlcyA9IChub2RlID09IHRoaXMubGF5b3V0VG91RGFvLm5vZGUpID8gY2FyZE1vZGVzIDogdGhpcy5fdGFvRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIC8vbGV0IHpob25nQ2FyZE1vZGVzID0gKG5vZGUgPT0gdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKSA/IGNhcmRNb2RlcyA6IHRoaXMuX3pob25nRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIC8vbGV0IHdlaUNhcmRNb2RlcyA9IChub2RlID09IHRoaXMubGF5b3V0V2VpRGFvLm5vZGUpID8gY2FyZE1vZGVzIDogdGhpcy5fd2VpRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIC8vaWYgKCF0aGlzLl9pc1ZhbGlkQ2FyZE1vZGVzKHRvdUNhcmRNb2RlcywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2RlcykpIHtcbiAgICAgICAgLy8gICAgdGhpcy5jYWNsZUF1dG9TZWxlY3RlZENhcmRzMSgpO1xuICAgICAgICAvLyAgICBjYy5sb2coJ+ebuOWFrOeJjO+8muiHquWKqOmAieaLqeeJjCcpXG4gICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgLy99XG4gICAgICAgIC8vXG4gICAgICAgIC8vbm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuICAgICAgICAvL1xuICAgICAgICAvL2NhcmRNb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTW9kZSxpbmRleCkge1xuICAgICAgICAvLyAgICBsZXQgY2FyZE5hbWUgPSBjYXJkTW9kZS5jYXJkTmFtZSgpO1xuICAgICAgICAvLyAgICBsZXQgY2FyZFR5cGVTcHJpdGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmNhcmRUeXBlUHJlZmFiKTtcbiAgICAgICAgLy8gICAgY2FyZFR5cGVTcHJpdGUubmFtZXMgPSBjYXJkTmFtZSsnKycraW5kZXg7XG4gICAgICAgIC8vICAgIGNhcmRUeXBlU3ByaXRlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVTcHJpdGUnKS5zZXRDYXJkKGNhcmROYW1lLGluZGV4KTtcbiAgICAgICAgLy8gICAgbm9kZS5hZGRDaGlsZChjYXJkVHlwZVNwcml0ZSk7XG4gICAgICAgIC8vfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9cbiAgICAgICAgLy9zZWxlY3RlZENhcmRzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgLy8gICAgbm9kZS5yZW1vdmVGcm9tUGFyZW50KCk7XG4gICAgICAgIC8vfSk7XG4gICAgICAgIC8vdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xuICAgICAgICAvL3RoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy90aGlzLl9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9ucygpO1xuICAgICAgICAvL1xuICAgICAgICAvL3RoaXMuX3JlbG9hZEtRQ2FyZE1vZGVzSW5uZXIoKTtcbiAgICAgICAgLy90aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscygpO1xuICAgIH0sXG5cbiAgICAvLyDliKDpmaQg5aS044CB5Lit5oiW5bC+6YGT5Lit55qE5p+Q5Lit54mMXG4gICAgX2RlbGV0ZURhb0NhcmQ6IGZ1bmN0aW9uIChjYXJkVHlwZU5vZGUsIHJlbG9hZFR5cGVCdXR0b25FbmFibGVzID0gZmFsc2UpIHtcbiAgICAgICAgLy9sZXQgY2FyZE5hbWUgPSBjYXJkVHlwZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLmNhcmROYW1lKCk7XG4gICAgICAgIC8vdGhpcy5hZGRDYXJkKGNhcmROYW1lLCB0cnVlKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy90aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vY2FyZFR5cGVOb2RlLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbnMoKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy9pZiAocmVsb2FkVHlwZUJ1dHRvbkVuYWJsZXMpIHtcbiAgICAgICAgLy8gICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICAvLyAgICB0aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscygpO1xuICAgICAgICAvL31cbiAgICB9LFxuXG4gICAgLy8g5Yig6ZmkIOWktOmBk+aIluS4remBk+aIluWwvumBk+S4iuaJgOacieeahCDniYxcbiAgICBfZGVsZXRlRGFvQ2FyZHNPZkxheW91dDogZnVuY3Rpb24gKGRhb0xheW91dCkge1xuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSBBcnJheS5mcm9tKGRhb0xheW91dC5jaGlsZHJlbik7XG4gICAgICAgIC8vY2FyZE5vZGVzLmZvckVhY2godGhpcy5fZGVsZXRlRGFvQ2FyZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy90aGlzLl9yZWxvYWRLUUNhcmRNb2Rlc0lubmVyKCk7XG4gICAgICAgIC8vdGhpcy5fcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHMoKTtcbiAgICB9LFxuXG4gICAgLy8g5Yik5pat6IO95ZCm5L2/55So6YCJ5oup5Lit55qE54mMXG4gICAgLy8g5Y2z77ya5aS06YGT6KaB5bCP5LqO5Lit6YGT44CB5Lit6YGT6KaB5bCP5LqO5bC+6YGTXG4gICAgX2lzVmFsaWRDYXJkTW9kZXM6IGZ1bmN0aW9uICh0b3VDYXJkTW9kZXMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXMpIHtcbiAgICAgICAgdG91Q2FyZE1vZGVzID0gdG91Q2FyZE1vZGVzIHx8IFtdO1xuICAgICAgICB6aG9uZ0NhcmRNb2RlcyA9IHpob25nQ2FyZE1vZGVzIHx8IFtdO1xuICAgICAgICB3ZWlDYXJkTW9kZXMgPSB3ZWlDYXJkTW9kZXMgfHwgW107XG4gICAgICAgIGlmICh0b3VDYXJkTW9kZXMubGVuZ3RoIDwgMyB8fCB6aG9uZ0NhcmRNb2Rlcy5sZW5ndGggPCA1IHx8IHdlaUNhcmRNb2Rlcy5sZW5ndGggPCA1KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHModG91Q2FyZE1vZGVzKTtcbiAgICAgICAgbGV0IHpob25nU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHpob25nQ2FyZE1vZGVzKTtcbiAgICAgICAgbGV0IHdlaVNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyh3ZWlDYXJkTW9kZXMpO1xuICAgICAgICByZXR1cm4gKHRvdVNjb3JlIDwgemhvbmdTY29yZSkgJiYgKHpob25nU2NvcmUgPD0gd2VpU2NvcmUpO1xuICAgIH0sXG5cbiAgICAvLyDlpLTpgZPkuIrlt7LmnInnmoTniYxcbiAgICBfdGFvRGFvQ2FyZE1vZGVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMuY2FyZEFsbHMuc2xpY2UoMCwzKSk7XG4gICAgfSxcblxuICAgIC8vIOS4remBk+S4iuW3suacieeahOeJjFxuICAgIF96aG9uZ0Rhb0NhcmRNb2RlczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3JldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZS5jaGlsZHJlbik7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMuY2FyZEFsbHMuc2xpY2UoMyw4KSk7XG4gICAgfSxcblxuICAgIC8vIOWwvumBk+S4iuW3suacieeahOeJjFxuICAgIF93ZWlEYW9DYXJkTW9kZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9yZXR1cm4gdGhpcy5fY2FyZE1vZGVzT2ZDYXJkUHJlZmFicyh0aGlzLmxheW91dFdlaURhby5ub2RlLmNoaWxkcmVuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmRNb2Rlc09mQ2FyZFByZWZhYnModGhpcy5jYXJkQWxscy5zbGljZSg4LDEzKSk7XG4gICAgfSxcblxuICAgIF9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzOiBmdW5jdGlvbiAoY2FyZFR5cGVOb2Rlcykge1xuICAgICAgICBpZiAoIWNhcmRUeXBlTm9kZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjYXJkTW9kZXMgPSBjYXJkVHlwZU5vZGVzLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgLy9sZXQgY29tcG9uZW50ID0gbm9kZS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlU3ByaXRlJyk7XG4gICAgICAgICAgICAvL3JldHVybiBjb21wb25lbnQuY2FyZE1vZGUoKTsuX2NhcmRNb2RlbFxuICAgICAgICAgICAgcmV0dXJuIG5vZGUuX2NhcmRNb2RlbDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGNhcmRNb2RlcyB8fCBbXTtcbiAgICB9LFxuXG4gICAgLy8g6Ieq5Yqo6K6+572uIOWktOOAgeS4reOAgeWwvumBk+eahOWIoOmZpOaMiemSrueahOWPr+ingeaAp1xuICAgIF9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3RoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b24odGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgdGhpcy5idG5EZWxldGVUb3VEYW8ubm9kZSk7XG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbih0aGlzLmxheW91dFpob25nRGFvLm5vZGUsIHRoaXMuYnRuRGVsZXRlWmhvbmdEYW8ubm9kZSk7XG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbih0aGlzLmxheW91dFdlaURhby5ub2RlLCB0aGlzLmJ0bkRlbGV0ZVdlaURhby5ub2RlKTtcbiAgICB9LFxuXG4gICAgX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b246IGZ1bmN0aW9uIChsYXlvdXQsIGJ1dHRvbikge1xuICAgICAgICAvL2J1dHRvbi5hY3RpdmUgPSBsYXlvdXQuY2hpbGRyZW4ubGVuZ3RoID4gMDtcbiAgICB9LFxuXG4gICAgLy8g6Ieq5Yqo6K6+572uIOKAnOWFqOmDqOWPlua2iOKAneOAgeKAnOehruWumuWHuueJjOKAneOAgeKAnOexu+Wei+mAieaLqeKAneaMiemSrueahOWPr+ingeaAp1xuICAgIF9hdXRvQWN0aXZlVHlwZUJ1dHRvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICAvL2xldCBoYXNDYXJkVW5TZWxlY3RlZCA9IGNhcmROb2Rlcy5sZW5ndGggPiAwO1xuICAgICAgICAvL3RoaXMuYnRuRG9uZS5ub2RlLmFjdGl2ZSA9ICFoYXNDYXJkVW5TZWxlY3RlZDtcbiAgICAgICAgLy90aGlzLmJ0bkNhbmNlbEFsbC5ub2RlLmFjdGl2ZSA9IHRoaXMuYnRuRG9uZS5ub2RlLmFjdGl2ZTtcbiAgICAgICAgLy90aGlzLnR5cGVCdXR0b25zTm9kZS5hY3RpdmUgPSBoYXNDYXJkVW5TZWxlY3RlZDtcbiAgICB9LFxuXG59KTtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgIF9jYXJkTmFtZTogbnVsbCxcbiAgICAgIF9jYXJkTW9kZWw6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldENhcmQ6IGZ1bmN0aW9uIChjYXJkTmFtZSwgaW5kZXgsIGFzZGYgPSB0cnVlKSB7XG4gICAgICB0aGlzLl9jYXJkTmFtZSA9IGNhcmROYW1lO1xuICAgICAgaWYoYXNkZil7XG4gICAgICAgICAgdGhpcy5fY2FyZE1vZGVsID0gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUoY2FyZE5hbWUsIGZ1bmN0aW9uIChzcHJpdGVGcmFtZSkge1xuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2FyZE5hbWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jYXJkTmFtZTtcbiAgICB9LFxuXG4gICAgY2FyZE1vZGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jYXJkTW9kZWw7XG4gICAgfSxcblxuICAgIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lKSB7XG4gICAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xuICAgICAgaWYgKCFjYXJkTmFtZS5zdGFydHNXaXRoKFwicHVibGljLXBpYy1jYXJkLXBva2VyXCIpKSB7XG4gICAgICAgIGNhcmROYW1lID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNhcmROYW1lO1xuICAgIH0sXG5cbiAgICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaykge1xuICAgICAgY2MuYXNzZXJ0KGNhbGxiYWNrKTtcblxuICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCJwbGF5L0NhcmRUeXBlQ29tYmluZS9wb2NrTGlzdFwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGNjLmVycm9yKGVycik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUpO1xuICAgICAgICB2YXIgZnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShjYXJkTmFtZSk7XG4gICAgICAgIGNhbGxiYWNrKGZyYW1lKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcbn0pO1xuIiwiLy8g55So5LqO5Zyo5ri45oiP6L+H56iL5Lit77yM5bGV56S655So5oi355qE6IGK5aSp5raI5oGvXG5cbmxldCBDaGF0TWVzc2FnZSA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHJpY2hUZXh0OiBjYy5SaWNoVGV4dCxcbiAgICAgICAgc3ByaXRlQmFja2dyb3VuZDogY2MuU3ByaXRlLFxuICAgICAgICBlbW9qaTpjYy5Ob2RlLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQ2hhdE1lc3NhZ2UuaW5zdGFuY2VzID0gdGhpcztcbiAgICB9LFxuXG4gICAgc2V0U3RyaW5nOiBmdW5jdGlvbiAoc3RyaW5nID0gXCJcIiwgYXV0b0hpZGUgPSB0cnVlKSB7XG4gICAgICAgIGlmIChzdHJpbmcubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnJpY2hUZXh0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zcHJpdGVCYWNrZ3JvdW5kLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lbW9qaS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgbGV0IG1heFdpZHRoID0gMzAwO1xuICAgICAgICBsZXQgcmVhbFN0ciA9IENoYXRNZXNzYWdlLnBhcnNlU3RyaW5nKHN0cmluZyk7XG5cbiAgICAgICAgLy8g55Sx5LqOIGNjLlJpY2hUZXh0IOWcqOaMh+WumiBtYXhXaWR0aCDlkI7vvIzor6Xnu5PngrnnmoQgd2lkdGgg5Lya5LiA55u0XG4gICAgICAgIC8vIOaYryBtYXhXaWR0aCDlgLzjgILogIzlnKjlsIYgbWF4V2lkdGgg5oyH5a6a5Li6MOaXtu+8jOWFtiBjb250ZW50U2l6ZS53aWR0aCDkvJpcbiAgICAgICAgLy8g5piv5YaF5a6555qE55yf5q2j5omA6ZyA55qE5a695bqmXG4gICAgICAgIC8vXG4gICAgICAgIC8vIOaJgOS7pei/memHjOWFiOWwhiBtYXhXaWR0aCDorr7kuLogMO+8jOiOt+WPluWFtuWunumZheWGheWuuSB3aWR0aCDlkI7lho3osIPmlbRcbiAgICAgICAgdGhpcy5yaWNoVGV4dC5tYXhXaWR0aCA9IDA7XG4gICAgICAgIHRoaXMucmljaFRleHQuc3RyaW5nID0gcmVhbFN0cjtcblxuICAgICAgICBsZXQgY29udGVudFdpZHRoID0gdGhpcy5yaWNoVGV4dC5ub2RlLmdldENvbnRlbnRTaXplKCkud2lkdGg7XG4gICAgICAgIGlmIChjb250ZW50V2lkdGggPiBtYXhXaWR0aCkge1xuICAgICAgICAgICAgdGhpcy5yaWNoVGV4dC5tYXhXaWR0aCA9IG1heFdpZHRoO1xuICAgICAgICAgICAgdGhpcy5yaWNoVGV4dC5zdHJpbmcgPSByZWFsU3RyO1xuICAgICAgICAgICAgY29udGVudFdpZHRoID0gbWF4V2lkdGg7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm5vZGUud2lkdGggPSBjb250ZW50V2lkdGggKyAyODtcbiAgICAgICAgdGhpcy5ub2RlLmhlaWdodCA9IHRoaXMucmljaFRleHQubm9kZS5nZXRDb250ZW50U2l6ZSgpLmhlaWdodCArIDIwO1xuXG4gICAgICAgIHRoaXMuc3ByaXRlQmFja2dyb3VuZC5ub2RlLndpZHRoID0gdGhpcy5ub2RlLndpZHRoO1xuICAgICAgICB0aGlzLnNwcml0ZUJhY2tncm91bmQubm9kZS5oZWlnaHQgPSB0aGlzLm5vZGUuaGVpZ2h0O1xuXG4gICAgICAgIGlmIChhdXRvSGlkZSkge1xuICAgICAgICAgICAgdGhpcy5faGlkZU5vZGUoKVxuICAgICAgICAgICAgLy90aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICAgICAgICAgIC8vdGhpcy5zY2hlZHVsZU9uY2UodGhpcy5faGlkZU5vZGUuYmluZCh0aGlzKSwgMyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2hvd0Vtb2ppOiBmdW5jdGlvbiAoc3ByaXRlKSB7XG4gICAgICAgIHRoaXMuX2hpZGVOb2RlKCk7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmVtb2ppLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMucmljaFRleHQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zcHJpdGVCYWNrZ3JvdW5kLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHZhciBidG5TcHJpdGVzID0gIHRoaXMuZW1vamkuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgIGJ0blNwcml0ZXMuc3ByaXRlRnJhbWUgPSBzcHJpdGU7XG4gICAgfSxcblxuICAgIF9oaWRlTm9kZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAzKTtcbiAgICB9LFxuXG59KTtcbkNoYXRNZXNzYWdlLnNldEVtb2ppID0gZnVuY3Rpb24oc3ByaXRlKXtcbiAgICB0aGlzLmluc3RhbmNlcy5faGlkZU5vZGUoKTtcbiAgICB0aGlzLmluc3RhbmNlcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgdGhpcy5pbnN0YW5jZXMuZW1vamkuYWN0aXZlID0gdHJ1ZTtcbiAgICB0aGlzLmluc3RhbmNlcy5yaWNoVGV4dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIHRoaXMuaW5zdGFuY2VzLnNwcml0ZUJhY2tncm91bmQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB2YXIgYnRuU3ByaXRlcyA9ICB0aGlzLmluc3RhbmNlcy5lbW9qaS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICBidG5TcHJpdGVzLnNwcml0ZUZyYW1lID0gc3ByaXRlO1xuICAgIC8vY29uc29sZS5sb2codGhpcy5lbW9qaSk7XG4gICAgLy9yZXR1cm47XG4gICAgLy9cbiAgICAvL3RoaXMuZW1vamkuU3ByaXRlID0gc3ByaXRlO1xufSxcblxuLy8g5bCGIDxicTEwPiDmlLnkuLrvvJogPGltZyBzcmM9J2JnMTAnLz5cbkNoYXRNZXNzYWdlLnBhcnNlU3RyaW5nID0gZnVuY3Rpb24gKHN0cikge1xuICAgIGxldCByZXN1bHQgPSBzdHIucmVwbGFjZSgvPGJxXFxkezEsMn0+L2csIGZ1bmN0aW9uKG1hdGNoKXtcbiAgICAgICAgdmFyIGJxID0gbWF0Y2gucmVwbGFjZShcIjxcIiwgXCIgPGltZyBzcmM9J1wiKS5yZXBsYWNlKFwiPlwiLCBcIicvPiBcIik7XG4gICAgICAgIHJldHVybiBicTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufSxcblxubW9kdWxlLmV4cG9ydHMgPSBDaGF0TWVzc2FnZTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldFN0cmluZzogZnVuY3Rpb24gKHN0cikge1xuICAgICAgdGhpcy5fcmljaFRleHQoKS5zdHJpbmcgPSBzdHI7XG4gICAgfSxcblxuICAgIF9yaWNoVGV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2NjLlJpY2hUZXh0Jyk7XG4gICAgfSxcbiAgICBcbiAgICBzZXRFbW9qaTpmdW5jdGlvbihzcHJhaXRlKXtcbiAgICAgICAgdGhpcy5fc3ByaXRlRnJhbWUoKS5TcHJhaXRlID0gc3ByYWl0ZTtcbiAgICB9LFxuICAgIF9zcHJpdGVGcmFtZTpmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gdGhpcy5ub2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XG4gICAgfSxcbn0pO1xuIiwiY29uc3QgS1FDYXJkUmVzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUmVzSGVscGVyJyk7XG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcbmNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB0b3VMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgemhvbmdMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgd2VpTGF5b3V0OiBjYy5MYXlvdXQsXG5cbiAgICAgICAgdG91TGF5b3V0QmFjazogY2MuTGF5b3V0LFxuICAgICAgICB6aG9uZ0xheW91dEJhY2s6IGNjLkxheW91dCxcbiAgICAgICAgd2VpTGF5b3V0QmFjazogY2MuTGF5b3V0LFxuICAgICAgICBiYW9EYW86IGNjLk5vZGUsICAvL+aKpemBk+WbvixcbiAgICAgICAgcGxheVRvdGFsU2NvcmU6IGNjLkxheW91dCwgIC8v5omA5pyJ546p5a6255qE5oC75YiG5pWwXG5cbiAgICAgICAgZGFvU2NvcmVMYXlvdXRzOiBbY2MuTGF5b3V0XSxcbiAgICAgICAgZGFvVGl0bGVOb2RlczogW2NjLk5vZGVdLFxuICAgICAgICBUU2NvcmVMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgVHRpdGxlTm9kZTogY2MuTm9kZSxcblxuICAgICAgICBwTnVtOjAsICAgICAgICAgLy/njqnlrrbkurrmlbBcbiAgICAgICAgdGVTaHVUaW1lOjAsICAgIC8v54m55q6K54mM5Ye654mM6aG65bqPXG4gICAgICAgIHRlU2h1TnVtOjAsICAgICAvL+eJueauiueJjOS6uuaVsFxuXG4gICAgICAgIF9sQ1Njb3JlOm51bGwsXG4gICAgICAgIF9kYW9MYXlvdXRzOiBudWxsLCAvLyDlpLTjgIHkuK3jgIHlsL7pm4blkIhcbiAgICAgICAgX2Rhb0xheW91dEJhY2tzOiBudWxsLCAvLyDlpLTjgIHkuK3jgIHlsL7pm4blkIhcbiAgICAgICAgX3Njb3JlczogbnVsbCxcbiAgICAgICAgX3VzZXI6IG51bGwsICAgICAgIC8vIOeUqOS6juavlOeJjOeahOaVsOaNrlxuICAgICAgICBfY2FyZHNJbmZvOiBudWxsLFxuICAgICAgICBfY29tcGFyZUluZGV4OiAwLCAgLy8g5bCG6KaB5q+U6L6D55qEIOe0ouW8lSAgMH4yXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHRoaXMuX2Rhb0xheW91dHMgPSBbdGhpcy50b3VMYXlvdXQsIHRoaXMuemhvbmdMYXlvdXQsIHRoaXMud2VpTGF5b3V0XTtcbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0QmFja3MgPSBbdGhpcy50b3VMYXlvdXRCYWNrLCB0aGlzLnpob25nTGF5b3V0QmFjaywgdGhpcy53ZWlMYXlvdXRCYWNrXTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgIGlmICh0aGlzLl9zY29yZXMpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U2NvcmVzKHRoaXMuX3Njb3Jlcyk7XG4gICAgICAgIH1cblxuICAgIH0sXG5cbiAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggPSAwO1xuXG4gICAgICAgIHRoaXMubm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7bm9kZS5hY3RpdmUgPSBmYWxzZTt9KTtcblxuICAgICAgICB0aGlzLmJhb0Rhby5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IG51bGw7XG5cbiAgICAgICAgdmFyIG5vZGVzID0gdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUuY2hpbGRyZW4uY29uY2F0KHRoaXMuemhvbmdMYXlvdXRCYWNrLm5vZGUuY2hpbGRyZW4pLmNvbmNhdCh0aGlzLndlaUxheW91dEJhY2subm9kZS5jaGlsZHJlbik7XG5cbiAgICAgICAgdGhpcy5jYXJkU3ByaXRlQXRsYXMgPSB0aGlzLm5vZGUucGFyZW50LnBhcmVudC5nZXRDb21wb25lbnQoJ3BsYXknKS5jYXJkU3ByaXRlQXRsYXM7XG5cbiAgICAgICAgbm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kKSB7XG5cbiAgICAgICAgICAgIG5vZC5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICB2YXIgY2FyZFNwcml0ZSA9IG5vZC5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgICAgICAgS1FDYXJkLl9sb2FkQ2FyZEZyYW1lKHRoaXMuY2FyZFNwcml0ZUF0bGFzLCBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1iYWNrXCIgLGNhcmRTcHJpdGUpO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5kYW9TY29yZUxheW91dHMuZm9yRWFjaChmdW5jdGlvbiAobm9kKSB7bm9kLm5vZGUuYWN0aXZlID0gZmFsc2U7fS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLmRhb1RpdGxlTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kKSB7bm9kLmFjdGl2ZSA9IGZhbHNlO30uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgaWYodGhpcy5UU2NvcmVMYXlvdXQpIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgaWYodGhpcy5UdGl0bGVOb2RlKSB0aGlzLlR0aXRsZU5vZGUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XG5cbiAgICAgICAgLy9jb25zb2xlLmxvZygn5omn6KGM5LqG5LiA6YGN5riF6Zmk5a6a5pe25ZmoLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKVxuXG4gICAgICAgIGlmKHRoaXMuVFNjb3JlTGF5b3V0KSB0aGlzLlRTY29yZUxheW91dC5ub2RlLnN0b3BBbGxBY3Rpb25zKCk7XG5cbiAgICAgICAgaWYodGhpcy5wbGF5VG90YWxTY29yZSkgdGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLnN0b3BBbGxBY3Rpb25zKCk7XG4gICAgfSxcblxuICAgIHNldENvbXBhcmVEYXRhOiBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICB0aGlzLl91c2VyID0gdXNlcjtcbiAgICAgICAgdGhpcy5fY2FyZHNJbmZvID0gdXNlci5jYXJkSW5mbztcbiAgICAgICAgbGV0IGNhcmRzSW5mbyA9IHVzZXIuY2FyZEluZm87XG4gICAgICAgIHRoaXMuX2xDU2NvcmUgPSB1c2VyLmxDU2NvcmU7XG4gICAgICAgIGxldCBjYXJkcyA9IGNhcmRzSW5mby5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0uY2FyZHMpO1xuICAgICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge1xuICAgICAgICAgICAgcmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7XG4gICAgICAgIH0sIFtdKTtcblxuXG4gICAgICAgIGxldCBzY29yZXMgPSBbdXNlci5zY29yZTEgfHwgMCwgdXNlci5zY29yZTIgfHwgMCwgdXNlci5zY29yZTMgfHwgMCx1c2VyLmxTY29yZTEgfHwgMCwgdXNlci5sU2NvcmUyIHx8IDAsIHVzZXIubFNjb3JlMyB8fCAwXTtcbiAgICAgICAgdGhpcy5zZXRDYXJkcyhjYXJkcyk7XG4gICAgICAgIHRoaXMuc2V0U2NvcmVzKHNjb3Jlcyk7XG4gICAgfSxcblxuICAgIC8v5pi+56S65omA5pyJ546p5a6255qE5oC75YiG5pWwXG4gICAgc2hvd1Njb3JlUmVzdWx0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYoIXRoaXMuX3VzZXIpIHJldHVybjtcbiAgICAgICAgdmFyIHNjb3JlcyA9IHRoaXMuX3VzZXIuY1Njb3JlO1xuICAgICAgICB0aGlzLnNldFNjb3Jlcyhbc2NvcmVzXSxbdGhpcy5wbGF5VG90YWxTY29yZV0sdHJ1ZSk7XG4gICAgICAgIHRoaXMucGxheVRvdGFsU2NvcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUub3BhY2l0eSA9IDI1NTtcbiAgICAgICAgdmFyIHggPSB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUueDtcbiAgICAgICAgdmFyIHkgPSB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUueTtcbiAgICAgICAgdGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLnJ1bkFjdGlvbihjYy5tb3ZlVG8oMC44LCBjYy5wKHgsIHkrMzApKSk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLnJ1bkFjdGlvbihjYy5mYWRlT3V0KDAuMikpO1xuICAgICAgICB9LmJpbmQodGhpcyksMC42KTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7dGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLnkgPSB5O30uYmluZCh0aGlzKSwxKTtcbiAgICB9LFxuXG4gICAgLy/mmL7npLrkuInpgZPliIbmlbBcbiAgICBzaG93TmV4dENvbXBhcmVTY29yZTogZnVuY3Rpb24oaXNDb250YWluRXh0cmEpIHtcbiAgICAgICAgaWYoaXNDb250YWluRXh0cmEgJiYgdGhpcy5UU2NvcmVMYXlvdXQpe1xuICAgICAgICAgICAgdmFyIHNjb3JlczEgPSB0aGlzLl9sQ1Njb3JlLnNwbGljZSgwLDEpO1xuICAgICAgICAgICAgaWYoc2NvcmVzMS5sZW5ndGggPD0gMCkgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5zZXRTY29yZXMoc2NvcmVzMSxbdGhpcy5UU2NvcmVMYXlvdXRdLHRydWUpO1xuICAgICAgICAgICAgdGhpcy5UdGl0bGVOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLlRTY29yZUxheW91dC5ub2RlLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAgIHZhciBzY2FsZVRvMTEgPSBjYy5zY2FsZVRvICgwLjMsIDEuOClcbiAgICAgICAgICAgIHZhciBzY2FsZVRvMjEgPSBjYy5zY2FsZVRvICgwLjEsIDEuMSlcbiAgICAgICAgICAgIHZhciBzY2FsZVRvMzEgPSBjYy5zY2FsZVRvICgwLjEsIDEuMylcbiAgICAgICAgICAgIHZhciBzY2FsZVRvU2VxMSA9Y2Muc2VxdWVuY2Uoc2NhbGVUbzExLHNjYWxlVG8yMSxzY2FsZVRvMzEpO1xuICAgICAgICAgICAgdGhpcy5UU2NvcmVMYXlvdXQubm9kZS5ydW5BY3Rpb24oc2NhbGVUb1NlcTEpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYodGhpcy5kYW9TY29yZUxheW91dHMubGVuZ3RoIDw9IDApIHJldHVybjtcbiAgICAgICAgaWYoIXRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEpe1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fY29tcGFyZUluZGV4ID09IDAgPyAxOiB0aGlzLl9jb21wYXJlSW5kZXg7XG4gICAgICAgICAgICB0aGlzLmRhb1Njb3JlTGF5b3V0c1tpbmRleC0xXS5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmRhb1Njb3JlTGF5b3V0c1tpbmRleCsyXS5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmRhb1RpdGxlTm9kZXNbaW5kZXgtMV0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzY29yZXMgPSB0aGlzLl9sQ1Njb3JlLnNwbGljZSgwLDEpO1xuICAgICAgICBpZihzY29yZXMubGVuZ3RoIDw9IDAgICYmICF0aGlzLlRTY29yZUxheW91dCkgcmV0dXJuO1xuICAgICAgICB0aGlzLnNldFNjb3JlcyhzY29yZXMsW3RoaXMuVFNjb3JlTGF5b3V0XSx0cnVlKTtcbiAgICAgICAgdGhpcy5UdGl0bGVOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICB2YXIgc2NhbGVUbzEgPSBjYy5zY2FsZVRvICgwLjMsIDEuOClcbiAgICAgICAgdmFyIHNjYWxlVG8yID0gY2Muc2NhbGVUbyAoMC4xLCAxLjEpXG4gICAgICAgIHZhciBzY2FsZVRvMyA9IGNjLnNjYWxlVG8gKDAuMSwgMS4zKVxuICAgICAgICB2YXIgc2NhbGVUb1NlcSA9Y2Muc2VxdWVuY2Uoc2NhbGVUbzEsc2NhbGVUbzIsc2NhbGVUbzMpO1xuICAgICAgICB0aGlzLlRTY29yZUxheW91dC5ub2RlLnJ1bkFjdGlvbihzY2FsZVRvU2VxKTtcblxuICAgIH0sXG5cbiAgICAvLyDkuIvkuIDkuKropoHmr5TovoPnmoTliIbmlbBcbiAgICAvLyDlpoLmnpzmsqHmnInopoHmr5TovoPnmoTkuobvvIzliJnov5Tlm54gMFxuICAgIG5leHRDb21wYXJlU2NvcmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3VzZXIpIHJldHVybiAwO1xuXG4gICAgICAgIHZhciBkYXRhO1xuICAgICAgICBpZih0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhKXtcbiAgICAgICAgICAgIGRhdGEgPSB0aGlzLl9jYXJkc0luZm9bMF07XG4gICAgICAgICAgICBpZiAoZGF0YSkgcmV0dXJuIGRhdGEudHlwZSAqIDkwMDAwMDAwMDAwMDAwMDA7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgZGF0YSA9IHRoaXMuX2NhcmRzSW5mb1t0aGlzLl9jb21wYXJlSW5kZXhdO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGF0YSkgcmV0dXJuIDA7XG4gICAgICAgIHJldHVybiBkYXRhLnZhbHVlO1xuICAgIH0sXG5cbiAgICBzZXRNYVBhaTogZnVuY3Rpb24gKG5vZGVzICxjYXJkTmFtZSkge1xuICAgICAgICBpZihjYy5tYVBhaSA9PSBjYXJkTmFtZSl7XG5cbiAgICAgICAgICAgIHZhciBub2RkcyA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXG5cbiAgICAgICAgICAgIG5vZGRzLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgICAgICBjYy5sb2FkZXIubG9hZFJlcygncGxheS9kZXNrL2ltZ19yZWQ1XzEnLCBjYy5TcHJpdGVGcmFtZSwgZnVuY3Rpb24gKGVyciwgc3ByaXRlRnJhbWUpIHtcblxuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtjYy5lcnJvcihlcnIubWVzc2FnZSB8fCBlcnIpO3JldHVybjt9XG5cbiAgICAgICAgICAgICAgICB2YXIgYnRuU3ByaXRlMSA9IG5vZGRzLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5zaXplTW9kZSA9IDA7XG5cbiAgICAgICAgICAgICAgICBidG5TcHJpdGUxLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG5cbiAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUud2lkdGggPSBub2Rlcy53aWR0aCArIDEwO1xuXG4gICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5ub2RlLmhlaWdodCA9IG5vZGVzLmhlaWdodCArIDEwO1xuXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICBub2Rlcy5hZGRDaGlsZChub2Rkcyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xuXG4gICAgICAgIGxldCBjYXJkU3ByaXRlcyA9IHRoaXMuX2FsbENhcmRTcHJpdGVzKCk7XG5cbiAgICAgICAgdGhpcy5jYXJkU3ByaXRlQXRsYXMgPSB0aGlzLm5vZGUucGFyZW50LnBhcmVudC5nZXRDb21wb25lbnQoJ3BsYXknKS5jYXJkU3ByaXRlQXRsYXM7XG5cbiAgICAgICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoa3FDYXJkLCBpbmRleCkge1xuICAgICAgICAgICAgaWYgKGluZGV4ID49IGNhcmRTcHJpdGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhcmRTcHJpdGVzW2luZGV4XS5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgICAgIGNhcmRTcHJpdGVzW2luZGV4XS5ub2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gXCJcIjtcblxuICAgICAgICAgICAgdmFyIG5vZGRzMSA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXG5cbiAgICAgICAgICAgIG5vZGRzMS5jYXJkTmFtZSA9IGtxQ2FyZC5jYXJkTmFtZSgpO1xuXG4gICAgICAgICAgICBub2RkczEud2lkdGggPSBjYXJkU3ByaXRlc1tpbmRleF0ubm9kZS53aWR0aDtcblxuICAgICAgICAgICAgbm9kZHMxLmhlaWdodCA9IGNhcmRTcHJpdGVzW2luZGV4XS5ub2RlLmhlaWdodDtcblxuICAgICAgICAgICAgbm9kZHMxLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgICAgICB2YXIgY2FyZFNwcml0ZSA9IG5vZGRzMS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpO1xuXG4gICAgICAgICAgICBjYXJkU3ByaXRlLnNpemVNb2RlID0gMDtcblxuICAgICAgICAgICAgdmFyIHBhdGggPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGtxQ2FyZC5jYXJkTmFtZSgpO1xuXG4gICAgICAgICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGNhcmRTcHJpdGUpO1xuXG4gICAgICAgICAgICB0aGlzLnNldE1hUGFpKGNhcmRTcHJpdGUubm9kZSwga3FDYXJkLmNhcmROYW1lKCkpO1xuXG4gICAgICAgICAgICBjYXJkU3ByaXRlc1tpbmRleF0ubm9kZS5hZGRDaGlsZChub2RkczEpO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdmFyIGNhcmRzMCA9IGNhcmRzLnNsaWNlKDAsMylcbiAgICAgICAgdmFyIGNhcmRzMSA9IGNhcmRzLnNsaWNlKDMsOClcbiAgICAgICAgdmFyIGNhcmRzMiA9IGNhcmRzLnNsaWNlKDgsMTMpXG5cbiAgICAgICAgdmFyIGNhcmRzMTEgPSBbY2FyZHMwLCBjYXJkczEsIGNhcmRzMl1cbiAgICAgICAgLy/lpLTpgZNcbiAgICAgICAgbGV0IHR5cGVOYW1lMCA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMwKSsxO1xuICAgICAgICB0eXBlTmFtZTAgPSB0eXBlTmFtZTA+PTEwID8gdHlwZU5hbWUwIDpcIjBcIit0eXBlTmFtZTA7XG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD09JzA0JyA/ICcxMScgOnR5cGVOYW1lMDtcblxuICAgICAgICAvL+S4remBk1xuICAgICAgICBsZXQgdHlwZU5hbWUxID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkczEpKzE7XG4gICAgICAgIHR5cGVOYW1lMSA9IHR5cGVOYW1lMT49MTAgPyB0eXBlTmFtZTEgOlwiMFwiK3R5cGVOYW1lMTtcbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPT0nMDcnID8gJzIyJyA6dHlwZU5hbWUxO1xuXG4gICAgICAgIC8v5bC+6YGTXG4gICAgICAgIGxldCB0eXBlTmFtZTIgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzMikrMTtcbiAgICAgICAgdHlwZU5hbWUyID0gdHlwZU5hbWUyPj0xMCA/IHR5cGVOYW1lMiA6XCIwXCIrdHlwZU5hbWUyO1xuXG4gICAgICAgIGNhcmRTcHJpdGVzID0gY2FyZFNwcml0ZXMubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBpLm5vZGU7fSk7XG5cbiAgICAgICAgaWYodHlwZU5hbWUwKSBLUUNhcmQuX3NldEd1aUNhcmQoMCwgMCwgMywgdHlwZU5hbWUwLCBjYXJkczExLCBjYXJkU3ByaXRlcywgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xuICAgICAgICBpZih0eXBlTmFtZTEpIEtRQ2FyZC5fc2V0R3VpQ2FyZCgxLCAzLCA4LCB0eXBlTmFtZTEsIGNhcmRzMTEsIGNhcmRTcHJpdGVzLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG4gICAgICAgIGlmKHR5cGVOYW1lMikgS1FDYXJkLl9zZXRHdWlDYXJkKDIsIDgsIDEzLCB0eXBlTmFtZTIsIGNhcmRzMTEsIGNhcmRTcHJpdGVzLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG5cbiAgICB9LFxuXG5cbiAgICBzZXRTY29yZXM6IGZ1bmN0aW9uIChzY29yZXMgLExheW91dHMgPSBudWxsICxpc19XSCA9IGZhbHNlKSB7XG4gICAgICAgIGlmKCFMYXlvdXRzKXtcbiAgICAgICAgICAgIExheW91dHMgPSB0aGlzLmRhb1Njb3JlTGF5b3V0cztcbiAgICAgICAgICAgIGlmKExheW91dHMubGVuZ3RoIDw9IDApIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHNjb3Jlcy5mb3JFYWNoKGZ1bmN0aW9uIChzdHJpbmcsIGluZGV4KSB7XG5cbiAgICAgICAgICAgIGxldCBsYWJlbHMgPSBMYXlvdXRzW2luZGV4XTtcblxuICAgICAgICAgICAgbGFiZWxzLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcblxuICAgICAgICAgICAgdmFyIHBhdGggPSBcInBsYXkvQ2FyZFR5cGVDb21iaW5lL1wiICsgKChOdW1iZXIoc3RyaW5nKSA+PSAwKSA/IFwiYWRkTnVtXCIgOiBcImRlbE51bVwiKTtcblxuICAgICAgICAgICAgdGhpcy5fY3JlYXRvck5vZGVzKGxhYmVscy5ub2RlICwxMCAscGF0aCAsJycgLGlzX1dIKTtcblxuICAgICAgICAgICAgdmFyIHN0cmluZ3MgPSAoc3RyaW5nID4gMCkgPyAoc3RyaW5nKSArIFwiXCI6IChzdHJpbmcgKiAtMSkgKyBcIlwiO1xuXG4gICAgICAgICAgICB2YXIgc3RyaW5nQXl5ID0gc3RyaW5ncy5zcGxpdChcIlwiKTtcblxuICAgICAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgc3RyaW5nQXl5Lmxlbmd0aDtpKyspe1xuXG4gICAgICAgICAgICAgICAgbGV0IHMgPSBzdHJpbmdBeXlbaV07XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9jcmVhdG9yTm9kZXMobGFiZWxzLm5vZGUgLE51bWJlcihzKSAscGF0aCAsJycgLGlzX1dIKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsYWJlbHMudHlwZSA9IDE7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgX2NyZWF0b3JOb2RlczpmdW5jdGlvbihub2RlcyxuYW1lLHBhdGgscGF0aHMsd19oID0gZmFsc2Upe1xuXG4gICAgICAgIHZhciBub2RlID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcblxuICAgICAgICBub2RlLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgIHZhciBidG5TcHJpdGUgPSBub2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuXG4gICAgICAgIGJ0blNwcml0ZS5zaXplTW9kZSA9IDA7XG5cbiAgICAgICAgYnRuU3ByaXRlLm5vZGUud2lkdGggPSAxODtidG5TcHJpdGUubm9kZS5oZWlnaHQgPSAyMztcbiAgICAgICAgLy9uYW1lID0gbmFtZSArIFwiXCI7XG4gICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUobmFtZSwgZnVuY3Rpb24gKHNwcml0ZUZyYW1lKSB7XG5cbiAgICAgICAgICAgIGJ0blNwcml0ZS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuXG4gICAgICAgICAgICBpZih3X2gpe2J0blNwcml0ZS5ub2RlLndpZHRoID0gMzA7YnRuU3ByaXRlLm5vZGUuaGVpZ2h0ID0gNDA7fVxuXG4gICAgICAgIH0uYmluZCh0aGlzKSwgcGF0aCwgcGF0aHMpO1xuXG4gICAgICAgIG5vZGVzLmFkZENoaWxkKG5vZGUpO1xuXG4gICAgfSxcblxuICAgIF9zZXRDYXJkU3ByaXRlRnJhbWU6IGZ1bmN0aW9uIChpbmRleHMsbm9kZXMpIHtcbiAgICAgICAgbGV0IGNhcmRzSW5mbyA9IHRoaXMuX2NhcmRzSW5mbztcbiAgICAgICAgbGV0IGNhcmRzID0gY2FyZHNJbmZvLm1hcChmdW5jdGlvbiAoY2FyZEluZm9JdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0uY2FyZHMpO1xuICAgICAgICAgICAgfSlbaW5kZXhzXSB8fCBbXTtcblxuICAgICAgICB0aGlzLmNhcmRTcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcblxuICAgICAgICAvLyBjYy5sb2codGhpcy5fY2FyZHNJbmZvKVxuICAgICAgICAvLyBjYy5sb2coY2FyZHMpXG4gICAgICAgIC8vIGNjLmxvZygnLS0tLS0tNTU1JylcblxuICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChrcUNhcmQsIGluZGV4KSB7XG5cbiAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICBub2Rlcy5jaGlsZHJlbltpbmRleF0uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBcIlwiXG5cbiAgICAgICAgICAgIHZhciBub2RkczEgPSBuZXcgY2MuTm9kZSgpOyAvL+WIm+W7uuS4gOS4quiKgueCueWvueixoVxuXG4gICAgICAgICAgICBub2RkczEuY2FyZE5hbWUgPSBrcUNhcmQuY2FyZE5hbWUoKTtcblxuICAgICAgICAgICAgbm9kZHMxLndpZHRoID0gbm9kZXMuY2hpbGRyZW5baW5kZXhdLndpZHRoO1xuXG4gICAgICAgICAgICBpZihub2Rlcy5wYXJlbnQucGFyZW50Lm5hbWUgPT0gXCJwbGF5U2VsZlwiKXtcblxuICAgICAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5oZWlnaHQgPSAxMzA7XG5cbiAgICAgICAgICAgICAgICBub2RkczEuaGVpZ2h0ID0gMTMwO1xuXG4gICAgICAgICAgICB9ZWxzZXtcblxuICAgICAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5oZWlnaHQgPSAxMTU7XG5cbiAgICAgICAgICAgICAgICBub2RkczEuaGVpZ2h0ID0gMTE1O1xuXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhub2Rlcyk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhub2RkczEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBub2RkczEuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XG5cbiAgICAgICAgICAgIHZhciBjYXJkU3ByaXRlID0gbm9kZHMxLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XG5cbiAgICAgICAgICAgIGNhcmRTcHJpdGUuc2l6ZU1vZGUgPSAwO1xuXG4gICAgICAgICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsga3FDYXJkLmNhcmROYW1lKCk7XG5cbiAgICAgICAgICAgIGNhcmRTcHJpdGUubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGNhcmRTcHJpdGUpO1xuXG4gICAgICAgICAgICB0aGlzLnNldE1hUGFpKGNhcmRTcHJpdGUubm9kZSwga3FDYXJkLmNhcmROYW1lKCkpO1xuXG4gICAgICAgICAgICBub2Rlcy5jaGlsZHJlbltpbmRleF0uYWRkQ2hpbGQobm9kZHMxKTtcblxuICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgIHZhciB0eXBlTmFtZSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMpKzE7XG5cbiAgICAgICAgdHlwZU5hbWUgPSB0eXBlTmFtZT49MTAgPyB0eXBlTmFtZStcIlwiIDpcIjBcIit0eXBlTmFtZTtcblxuICAgICAgICAvL+WktOmBk1xuICAgICAgICBpZihpbmRleHMgPT0gMCl7XG4gICAgICAgICAgICB0eXBlTmFtZSA9IHR5cGVOYW1lPT0nMDQnID8gJzExJyA6dHlwZU5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihpbmRleHMgPT0gMSl7XG4gICAgICAgICAgICB0eXBlTmFtZSA9IHR5cGVOYW1lPT0nMDcnID8gJzIyJyA6dHlwZU5hbWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY2FyZFNwcml0ZXMgPSBub2Rlcy5jaGlsZHJlbi5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGk7fSk7XG5cbiAgICAgICAgS1FDYXJkLl9zZXRHdWlDYXJkcyh0eXBlTmFtZSwgY2FyZHMsIGNhcmRTcHJpdGVzLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XG5cbiAgICB9LFxuXG4gICAgc2hvd1RvdUNhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEgPT0gdHJ1ZSkgcmV0dXJuO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCflvIDlp4vmiafooYzkuIDmrKHlrprml7bliqjkvZwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpXG5cbiAgICAgICAgdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3NldENhcmRTcHJpdGVGcmFtZSgwLHRoaXMudG91TGF5b3V0QmFjay5ub2RlKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnRvdUxheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjcpO1xuXG4gICAgICAgIHRoaXMudG91TGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50b3VMYXlvdXQubm9kZS5zY2FsZVkgPSAwLjc7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy50b3VMYXlvdXQubm9kZS5zY2FsZVkgPSAxO1xuICAgICAgICB9LmJpbmQodGhpcyksIDAuMDIpO1xuXG5cbiAgICAgICAgdmFyIHR5cGVzID0gdGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF0udHlwZSA9PSAzID8gMzMzOnRoaXMuX2NhcmRzSW5mb1t0aGlzLl9jb21wYXJlSW5kZXhdLnR5cGU7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5Q2FyZFR5cGUodGhpcy5fdXNlci5zZXgsIHR5cGVzKTtcbiAgICAgICAgdGhpcy5fY29tcGFyZUluZGV4ICs9IDE7XG4gICAgfSxcblxuICAgIHNob3daaG9uZ0NhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEgPT0gdHJ1ZSkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuemhvbmdMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3NldENhcmRTcHJpdGVGcmFtZSgxLHRoaXMuemhvbmdMYXlvdXRCYWNrLm5vZGUpO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuemhvbmdMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuemhvbmdMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjcpO1xuXG4gICAgICAgIHRoaXMuemhvbmdMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnpob25nTGF5b3V0Lm5vZGUuc2NhbGVZID0gMC43O1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuemhvbmdMYXlvdXQubm9kZS5zY2FsZVkgPSAxO1xuICAgICAgICB9LmJpbmQodGhpcyksIDAuMDIpO1xuXG4gICAgICAgIHZhciB0eXBlcyA9IHRoaXMuX2NhcmRzSW5mb1t0aGlzLl9jb21wYXJlSW5kZXhdLnR5cGUgPT0gNiA/IDU1NTp0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlO1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0eXBlcyk7XG4gICAgICAgIHRoaXMuX2NvbXBhcmVJbmRleCArPSAxO1xuICAgIH0sXG5cbiAgICBzaG93V2VpQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZygn5omn6KGM5LqG5LiA5qyh5bC+6YGT5Yqo55S7LS0tLS0tLS0tLS0tLS0tJylcbiAgICAgICAgaWYodGhpcy5fdXNlci5pc0NvbnRhaW5FeHRyYSA9PSB0cnVlKSByZXR1cm47XG4gICAgICAgIC8vdGhpcy5fc2V0Q2FyZFNwcml0ZUZyYW1lKDEsdGhpcy56aG9uZ0xheW91dEJhY2subm9kZSk7XG4gICAgICAgIHRoaXMud2VpTGF5b3V0QmFjay5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9zZXRDYXJkU3ByaXRlRnJhbWUoMix0aGlzLndlaUxheW91dEJhY2subm9kZSk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy53ZWlMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMud2VpTGF5b3V0QmFjay5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH0uYmluZCh0aGlzKSwgMC43KTtcblxuICAgICAgICB0aGlzLndlaUxheW91dC5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMud2VpTGF5b3V0Lm5vZGUuc2NhbGVZID0gMC43O1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMud2VpTGF5b3V0Lm5vZGUuc2NhbGVZID0gMTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjAyKTtcblxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlKTtcbiAgICAgICAgdGhpcy5fY29tcGFyZUluZGV4ICs9IDE7XG4gICAgfSxcblxuICAgIHNob3dUZVNodUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgICAgLy9sZXQgdHlwZU5hbWUgPSBLUUNhcmQuY2FyZHNUeXBlTmFtZShjYXJkc05hbWVzKTtcbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0QmFja3MgPSBbdGhpcy50b3VMYXlvdXRCYWNrLCB0aGlzLnpob25nTGF5b3V0QmFjaywgdGhpcy53ZWlMYXlvdXRCYWNrXTtcblxuICAgICAgICBsZXQgdG91Q2FyZFNwcml0ZXMgPSB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQodGhpcy5fZGFvTGF5b3V0QmFja3NbMF0pO1xuICAgICAgICBsZXQgemhvbmdDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLl9kYW9MYXlvdXRCYWNrc1sxXSk7XG4gICAgICAgIGxldCB3ZWlDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLl9kYW9MYXlvdXRCYWNrc1syXSk7XG4gICAgICAgIGxldCBjYXJkU3ByaXRlcyA9IHRvdUNhcmRTcHJpdGVzLmNvbmNhdCh6aG9uZ0NhcmRTcHJpdGVzKS5jb25jYXQod2VpQ2FyZFNwcml0ZXMpO1xuICAgICAgICB0aGlzLmNhcmRTcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChrcUNhcmQsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IGNhcmRTcHJpdGVzLmxlbmd0aCkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgbGV0IGNhcmRTcHJpdGUgPSBjYXJkU3ByaXRlc1tpbmRleF07XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsga3FDYXJkLmNhcmROYW1lKCk7XG5cbiAgICAgICAgICAgICAgICBjYXJkU3ByaXRlLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcblxuICAgICAgICAgICAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZSh0aGlzLmNhcmRTcHJpdGVBdGxhcywgcGF0aCAsY2FyZFNwcml0ZSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNldE1hUGFpKGNhcmRTcHJpdGUubm9kZSwga3FDYXJkLmNhcmROYW1lKCkpO1xuXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgdGhpcy5fZGFvTGF5b3V0QmFja3MuZm9yRWFjaChmdW5jdGlvbiAobm9kZXMpIHtub2Rlcy5ub2RlLmFjdGl2ZSA9IHRydWU7fS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5Q2FyZFR5cGUodGhpcy5fdXNlci5zZXgsIHRoaXMuX2NhcmRzSW5mb1swXS50eXBlKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLDAuMSk7XG4gICAgfSxcblxuICAgIHNob3dOZXh0Q2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNhcmRUeXBlQ29tYmluZSA9IHRoaXMubm9kZS5wYXJlbnQucGFyZW50LmdldENoaWxkQnlOYW1lKCdDYXJkVHlwZUNvbWJpbmUnKS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlQ29tYmluZScpO1xuICAgICAgICBjYXJkVHlwZUNvbWJpbmUucmVzZXQoKTtcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLm5vZGUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUucGFyZW50LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhKSB7XG4gICAgICAgICAgICB2YXIgY2FyZHMgPSB0aGlzLl9jYXJkc0luZm9bMF0uY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkSW5mb0l0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRJbmZvSXRlbSk7XG4gICAgICAgICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcnJheS5jb25jYXQoc3ViQ2FyZHMpO1xuICAgICAgICAgICAgfSwgW10pO1xuICAgICAgICAgICAgdGhpcy5zaG93VGVTaHVDYXJkcyhjYXJkcyk7XG4gICAgICAgICAgICB0aGlzLnNob3dCYW9EYW8oMCwwKTtcbiAgICAgICAgICAgIHRoaXMuYmFvRGFvLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0cyA9IFt0aGlzLnRvdUxheW91dCwgdGhpcy56aG9uZ0xheW91dCwgdGhpcy53ZWlMYXlvdXRdO1xuICAgICAgICB0aGlzLl9kYW9MYXlvdXRzLmZvckVhY2goZnVuY3Rpb24gKG5vZGVzKSB7XG4gICAgICAgICAgICBub2Rlcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuX2NvbXBhcmVJbmRleCA9PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dCYW9EYW8oMCwxNDApO1xuICAgICAgICAgICAgdGhpcy5zaG93VG91Q2FyZHMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9jb21wYXJlSW5kZXggPT0gMSkge1xuICAgICAgICAgICAgdGhpcy5zaG93QmFvRGFvKDEsODUpO1xuICAgICAgICAgICAgdGhpcy5zaG93WmhvbmdDYXJkcygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX2NvbXBhcmVJbmRleCA9PSAyKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dCYW9EYW8oMiwzNCk7XG4gICAgICAgICAgICB0aGlzLnNob3dXZWlDYXJkcygpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5iYW9EYW8uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7dGhpcy5iYW9EYW8uYWN0aXZlID0gZmFsc2U7fS5iaW5kKHRoaXMpLCAwLjcpO1xuXG4gICAgfSxcblxuICAgIHNob3dBbGxDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZighdGhpcy5fdXNlcikgcmV0dXJuO1xuXG4gICAgICAgIGlmICh0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhKSB7XG5cbiAgICAgICAgICAgIHZhciBjYXJkcyA9IHRoaXMuX2NhcmRzSW5mb1swXS5jYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge3JldHVybiBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZEluZm9JdGVtKTt9KVxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge3JldHVybiBhcnJheS5jb25jYXQoc3ViQ2FyZHMpO30sIFtdKTtcblxuICAgICAgICAgICAgdGhpcy5zaG93VGVTaHVDYXJkcyhjYXJkcyk7XG5cbiAgICAgICAgICAgIC8vcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYoIXRoaXMuX2Rhb0xheW91dEJhY2tzKSByZXR1cm47XG5cbiAgICAgICAgdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUucGFyZW50LmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0QmFja3MuZm9yRWFjaChmdW5jdGlvbiAobm9kZXMsaW5kZXgpIHtcblxuICAgICAgICAgICAgbm9kZXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgICAgICBub2Rlcy5ub2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKG5vKSB7bm8uYWN0aXZlID0gdHJ1ZTt9KTtcblxuICAgICAgICAgICAgdGhpcy5fc2V0Q2FyZFNwcml0ZUZyYW1lKGluZGV4LG5vZGVzLm5vZGUpO1xuXG4gICAgICAgICAgICBpZih0aGlzLlRTY29yZUxheW91dCkgdGhpcy5kYW9UaXRsZU5vZGVzW2luZGV4XS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgaWYoIXRoaXMuVFNjb3JlTGF5b3V0KSByZXR1cm47XG5cbiAgICAgICAgdGhpcy5kYW9TY29yZUxheW91dHMuZm9yRWFjaChmdW5jdGlvbiAobm9kZXMpIHtcblxuICAgICAgICAgICAgbm9kZXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5zZXRTY29yZXMoW3RoaXMuX3VzZXIuY1Njb3JlXSxbdGhpcy5UU2NvcmVMYXlvdXRdLHRydWUpO1xuXG4gICAgICAgIHRoaXMuVHRpdGxlTm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcblxuICAgIH0sXG5cbiAgICBzaG93QmFvRGFvOiBmdW5jdGlvbiAoaW5kZXgscG9zaXRvblkpIHtcbiAgICAgICAgbGV0IGNhcmRzSW5mbyA9IHRoaXMuX2NhcmRzSW5mbztcbiAgICAgICAgbGV0IGNhcmRUeXBlID0gY2FyZHNJbmZvLm1hcChmdW5jdGlvbiAoY2FyZEluZm9JdGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FyZEluZm9JdGVtLnR5cGVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IHR5cGVOYW1lMCA9IGNhcmRUeXBlW2luZGV4XSsxO1xuICAgICAgICB0eXBlTmFtZTAgPSB0eXBlTmFtZTA+PTEwID8gdHlwZU5hbWUwIDpcIjBcIit0eXBlTmFtZTA7XG4gICAgICAgIGlmKGluZGV4ID09IDApIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD09JzA0JyA/ICcxMScgOnR5cGVOYW1lMDtcbiAgICAgICAgaWYoaW5kZXggPT0gMSkgdHlwZU5hbWUwID0gdHlwZU5hbWUwPT0nMDcnID8gJzIyJyA6dHlwZU5hbWUwO1xuXG4gICAgICAgIGlmKGNhcmRUeXBlW2luZGV4XSA9PSAxMCkgdHlwZU5hbWUwID0gJzE1JzsvL+eJueauiueJjFxuICAgICAgICBpZihjYXJkVHlwZVtpbmRleF0gPT0gMTEpIHR5cGVOYW1lMCA9ICcxNCc7XG4gICAgICAgIGlmKGNhcmRUeXBlW2luZGV4XSA9PSAxMikgdHlwZU5hbWUwID0gJzE2JztcbiAgICAgICAgaWYoY2FyZFR5cGVbaW5kZXhdID09IDE4KSB0eXBlTmFtZTAgPSAnMjUnO1xuICAgICAgICBpZihjYXJkVHlwZVtpbmRleF0gPT0gMTkpIHR5cGVOYW1lMCA9ICcyNic7XG5cbiAgICAgICAgdmFyIHBhdGggPSB0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhP1wiZ2FtZS1yaWdodF9zcGVjaWFcIjpcImdhbWUtcG9rZXJfdHlwZVwiO1xuXG4gICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUodHlwZU5hbWUwLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcbiAgICAgICAgICAgIHZhciBidG5TcHJpdGVzMSA9ICB0aGlzLmJhb0Rhby5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgICAgIGJ0blNwcml0ZXMxLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG4gICAgICAgIH0uYmluZCh0aGlzKSwgXCJwbGF5L0NhcmRUeXBlQ29tYmluZS9nYW1lX3R4dFwiLHBhdGgpO1xuICAgICAgICB0aGlzLmJhb0Rhby55ID0gcG9zaXRvblk7XG4gICAgfSxcblxuICAgIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrLCBwYXRoID0gXCJwbGF5L0NhcmRUeXBlQ29tYmluZS9wb2NrTGlzdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aHMgPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIikge1xuICAgICAgICBjYy5sb2FkZXIubG9hZFJlcyhwYXRoLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICBjYy5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhcmROYW1lID0gY2FyZE5hbWUgKyBcIlwiO1xuICAgICAgICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUscGF0aHMpO1xuICAgICAgICAgICAgdmFyIGZyYW1lID0gYXRsYXMuZ2V0U3ByaXRlRnJhbWUoY2FyZE5hbWUpO1xuICAgICAgICAgICAgY2FsbGJhY2soZnJhbWUpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBfY2FyZEZ1bGxOYW1lOiBmdW5jdGlvbiAoY2FyZFNob3J0TmFtZSxwYXRocykge1xuICAgICAgICBpZighcGF0aHMpIHJldHVybiBjYXJkU2hvcnROYW1lO1xuICAgICAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xuICAgICAgICBpZiAoIWNhcmROYW1lLnN0YXJ0c1dpdGgocGF0aHMpKSB7XG4gICAgICAgICAgICBjYXJkTmFtZSA9IHBhdGhzICsgY2FyZE5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhcmROYW1lO1xuICAgIH0sXG5cbiAgICBfY2xlYXJDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jbGVhckxheW91dENhcmRzKHRoaXMudG91TGF5b3V0KTtcbiAgICAgICAgdGhpcy5fY2xlYXJMYXlvdXRDYXJkcyh0aGlzLnpob25nTGF5b3V0KTtcbiAgICAgICAgdGhpcy5fY2xlYXJMYXlvdXRDYXJkcyh0aGlzLndlaUxheW91dCk7XG4gICAgfSxcblxuICAgIF9jbGVhckxheW91dENhcmRzOiBmdW5jdGlvbiAobGF5b3V0KSB7XG4gICAgICAgIHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dChsYXlvdXQpLmZvckVhY2goZnVuY3Rpb24gKHNwcml0ZSkge1xuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gbnVsbDtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9jYXJkU3ByaXRlc1dpdGhMYXlvdXQ6IGZ1bmN0aW9uIChsYXlvdXQpIHtcbiAgICAgICAgbGV0IG5vZGUgPSBsYXlvdXQubm9kZTtcbiAgICAgICAgcmV0dXJuIG5vZGUuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgX2FsbENhcmRTcHJpdGVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB0b3VDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLnRvdUxheW91dCk7XG4gICAgICAgIGxldCB6aG9uZ0NhcmRTcHJpdGVzID0gdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KHRoaXMuemhvbmdMYXlvdXQpO1xuICAgICAgICBsZXQgd2VpQ2FyZFNwcml0ZXMgPSB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQodGhpcy53ZWlMYXlvdXQpO1xuICAgICAgICBsZXQgcmVzdWx0ID0gdG91Q2FyZFNwcml0ZXMuY29uY2F0KHpob25nQ2FyZFNwcml0ZXMpLmNvbmNhdCh3ZWlDYXJkU3ByaXRlcyk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYWJlbFRpbWU6IGNjLkxhYmVsLFxuICAgICAgICAvL3RpbWVOb2RlOiBjYy5Ob2RlLFxuXG4gICAgICAgIF9jYWxsYmFjazogbnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IFwiMFwiO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDlvIDlp4vlgJLorqHml7ZcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gIHtOdW1iZXJ9IHRpbWUg5pe26ZW/XG4gICAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIOWAkuiuoeaXtueahOWbnuiwg1xuICAgICAqL1xuICAgIHN0YXJ0Q291bnRkb3duOiBmdW5jdGlvbih0aW1lLCBjYWxsYmFjaykge1xuICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcblxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gXCJcIiArIHRpbWU7XG4gICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5fY291bnREb3duLCAxLCB0aW1lKTtcbiAgICAgICAgdGhpcy5nZXRDb21wb25lbnQoXCJ0aW1lXCIpLnNldFRpbWUodGltZSAqIDAuNSlcbiAgICB9LFxuXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLl9jb3VudERvd24pO1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHRoaXMuX2NhbGxiYWNrKSB7XG4gICAgICAgICAgICBsZXQgaXNUaW1lb3V0ID0gTnVtYmVyKHRoaXMubGFiZWxUaW1lLnN0cmluZykgPD0gMDtcbiAgICAgICAgICAgIGxldCBjYWxsYmFjayA9IHRoaXMuX2NhbGxiYWNrO1xuICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBudWxsO1xuICAgICAgICAgICAgY2FsbGJhY2soaXNUaW1lb3V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gbnVsbDtcbiAgICB9LFxuXG4gICAgX2NvdW50RG93bjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0aW1lID0gTnVtYmVyKHRoaXMubGFiZWxUaW1lLnN0cmluZyB8fCBcIjBcIik7XG4gICAgICAgIHRpbWUgPSB0aW1lIC0gMTtcblxuICAgICAgICBpZiAodGltZSA8PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IFN0cmluZyh0aW1lKTtcbiAgICB9LFxuXG5cbn0pO1xuIiwiJ3VzZSBzdHJpY3QnXG5cbmV4cG9ydHMuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGhcbmV4cG9ydHMudG9CeXRlQXJyYXkgPSB0b0J5dGVBcnJheVxuZXhwb3J0cy5mcm9tQnl0ZUFycmF5ID0gZnJvbUJ5dGVBcnJheVxuXG52YXIgbG9va3VwID0gW11cbnZhciByZXZMb29rdXAgPSBbXVxudmFyIEFyciA9IHR5cGVvZiBVaW50OEFycmF5ICE9PSAndW5kZWZpbmVkJyA/IFVpbnQ4QXJyYXkgOiBBcnJheVxuXG52YXIgY29kZSA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJ1xuZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNvZGUubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgbG9va3VwW2ldID0gY29kZVtpXVxuICByZXZMb29rdXBbY29kZS5jaGFyQ29kZUF0KGkpXSA9IGlcbn1cblxucmV2TG9va3VwWyctJy5jaGFyQ29kZUF0KDApXSA9IDYyXG5yZXZMb29rdXBbJ18nLmNoYXJDb2RlQXQoMCldID0gNjNcblxuZnVuY3Rpb24gcGxhY2VIb2xkZXJzQ291bnQgKGI2NCkge1xuICB2YXIgbGVuID0gYjY0Lmxlbmd0aFxuICBpZiAobGVuICUgNCA+IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgc3RyaW5nLiBMZW5ndGggbXVzdCBiZSBhIG11bHRpcGxlIG9mIDQnKVxuICB9XG5cbiAgLy8gdGhlIG51bWJlciBvZiBlcXVhbCBzaWducyAocGxhY2UgaG9sZGVycylcbiAgLy8gaWYgdGhlcmUgYXJlIHR3byBwbGFjZWhvbGRlcnMsIHRoYW4gdGhlIHR3byBjaGFyYWN0ZXJzIGJlZm9yZSBpdFxuICAvLyByZXByZXNlbnQgb25lIGJ5dGVcbiAgLy8gaWYgdGhlcmUgaXMgb25seSBvbmUsIHRoZW4gdGhlIHRocmVlIGNoYXJhY3RlcnMgYmVmb3JlIGl0IHJlcHJlc2VudCAyIGJ5dGVzXG4gIC8vIHRoaXMgaXMganVzdCBhIGNoZWFwIGhhY2sgdG8gbm90IGRvIGluZGV4T2YgdHdpY2VcbiAgcmV0dXJuIGI2NFtsZW4gLSAyXSA9PT0gJz0nID8gMiA6IGI2NFtsZW4gLSAxXSA9PT0gJz0nID8gMSA6IDBcbn1cblxuZnVuY3Rpb24gYnl0ZUxlbmd0aCAoYjY0KSB7XG4gIC8vIGJhc2U2NCBpcyA0LzMgKyB1cCB0byB0d28gY2hhcmFjdGVycyBvZiB0aGUgb3JpZ2luYWwgZGF0YVxuICByZXR1cm4gYjY0Lmxlbmd0aCAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KVxufVxuXG5mdW5jdGlvbiB0b0J5dGVBcnJheSAoYjY0KSB7XG4gIHZhciBpLCBqLCBsLCB0bXAsIHBsYWNlSG9sZGVycywgYXJyXG4gIHZhciBsZW4gPSBiNjQubGVuZ3RoXG4gIHBsYWNlSG9sZGVycyA9IHBsYWNlSG9sZGVyc0NvdW50KGI2NClcblxuICBhcnIgPSBuZXcgQXJyKGxlbiAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzKVxuXG4gIC8vIGlmIHRoZXJlIGFyZSBwbGFjZWhvbGRlcnMsIG9ubHkgZ2V0IHVwIHRvIHRoZSBsYXN0IGNvbXBsZXRlIDQgY2hhcnNcbiAgbCA9IHBsYWNlSG9sZGVycyA+IDAgPyBsZW4gLSA0IDogbGVuXG5cbiAgdmFyIEwgPSAwXG5cbiAgZm9yIChpID0gMCwgaiA9IDA7IGkgPCBsOyBpICs9IDQsIGogKz0gMykge1xuICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDE4KSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA8PCAxMikgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAyKV0gPDwgNikgfCByZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDMpXVxuICAgIGFycltMKytdID0gKHRtcCA+PiAxNikgJiAweEZGXG4gICAgYXJyW0wrK10gPSAodG1wID4+IDgpICYgMHhGRlxuICAgIGFycltMKytdID0gdG1wICYgMHhGRlxuICB9XG5cbiAgaWYgKHBsYWNlSG9sZGVycyA9PT0gMikge1xuICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDIpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldID4+IDQpXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH0gZWxzZSBpZiAocGxhY2VIb2xkZXJzID09PSAxKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTApIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDQpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildID4+IDIpXG4gICAgYXJyW0wrK10gPSAodG1wID4+IDgpICYgMHhGRlxuICAgIGFycltMKytdID0gdG1wICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIGFyclxufVxuXG5mdW5jdGlvbiB0cmlwbGV0VG9CYXNlNjQgKG51bSkge1xuICByZXR1cm4gbG9va3VwW251bSA+PiAxOCAmIDB4M0ZdICsgbG9va3VwW251bSA+PiAxMiAmIDB4M0ZdICsgbG9va3VwW251bSA+PiA2ICYgMHgzRl0gKyBsb29rdXBbbnVtICYgMHgzRl1cbn1cblxuZnVuY3Rpb24gZW5jb2RlQ2h1bmsgKHVpbnQ4LCBzdGFydCwgZW5kKSB7XG4gIHZhciB0bXBcbiAgdmFyIG91dHB1dCA9IFtdXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSArPSAzKSB7XG4gICAgdG1wID0gKHVpbnQ4W2ldIDw8IDE2KSArICh1aW50OFtpICsgMV0gPDwgOCkgKyAodWludDhbaSArIDJdKVxuICAgIG91dHB1dC5wdXNoKHRyaXBsZXRUb0Jhc2U2NCh0bXApKVxuICB9XG4gIHJldHVybiBvdXRwdXQuam9pbignJylcbn1cblxuZnVuY3Rpb24gZnJvbUJ5dGVBcnJheSAodWludDgpIHtcbiAgdmFyIHRtcFxuICB2YXIgbGVuID0gdWludDgubGVuZ3RoXG4gIHZhciBleHRyYUJ5dGVzID0gbGVuICUgMyAvLyBpZiB3ZSBoYXZlIDEgYnl0ZSBsZWZ0LCBwYWQgMiBieXRlc1xuICB2YXIgb3V0cHV0ID0gJydcbiAgdmFyIHBhcnRzID0gW11cbiAgdmFyIG1heENodW5rTGVuZ3RoID0gMTYzODMgLy8gbXVzdCBiZSBtdWx0aXBsZSBvZiAzXG5cbiAgLy8gZ28gdGhyb3VnaCB0aGUgYXJyYXkgZXZlcnkgdGhyZWUgYnl0ZXMsIHdlJ2xsIGRlYWwgd2l0aCB0cmFpbGluZyBzdHVmZiBsYXRlclxuICBmb3IgKHZhciBpID0gMCwgbGVuMiA9IGxlbiAtIGV4dHJhQnl0ZXM7IGkgPCBsZW4yOyBpICs9IG1heENodW5rTGVuZ3RoKSB7XG4gICAgcGFydHMucHVzaChlbmNvZGVDaHVuayh1aW50OCwgaSwgKGkgKyBtYXhDaHVua0xlbmd0aCkgPiBsZW4yID8gbGVuMiA6IChpICsgbWF4Q2h1bmtMZW5ndGgpKSlcbiAgfVxuXG4gIC8vIHBhZCB0aGUgZW5kIHdpdGggemVyb3MsIGJ1dCBtYWtlIHN1cmUgdG8gbm90IGZvcmdldCB0aGUgZXh0cmEgYnl0ZXNcbiAgaWYgKGV4dHJhQnl0ZXMgPT09IDEpIHtcbiAgICB0bXAgPSB1aW50OFtsZW4gLSAxXVxuICAgIG91dHB1dCArPSBsb29rdXBbdG1wID4+IDJdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wIDw8IDQpICYgMHgzRl1cbiAgICBvdXRwdXQgKz0gJz09J1xuICB9IGVsc2UgaWYgKGV4dHJhQnl0ZXMgPT09IDIpIHtcbiAgICB0bXAgPSAodWludDhbbGVuIC0gMl0gPDwgOCkgKyAodWludDhbbGVuIC0gMV0pXG4gICAgb3V0cHV0ICs9IGxvb2t1cFt0bXAgPj4gMTBdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wID4+IDQpICYgMHgzRl1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPDwgMikgJiAweDNGXVxuICAgIG91dHB1dCArPSAnPSdcbiAgfVxuXG4gIHBhcnRzLnB1c2gob3V0cHV0KVxuXG4gIHJldHVybiBwYXJ0cy5qb2luKCcnKVxufVxuIiwiLyohXG4gKiBUaGUgYnVmZmVyIG1vZHVsZSBmcm9tIG5vZGUuanMsIGZvciB0aGUgYnJvd3Nlci5cbiAqXG4gKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz5cbiAqIEBsaWNlbnNlICBNSVRcbiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi9cblxuJ3VzZSBzdHJpY3QnXG5cbnZhciBiYXNlNjQgPSByZXF1aXJlKCdiYXNlNjQtanMnKVxudmFyIGllZWU3NTQgPSByZXF1aXJlKCdpZWVlNzU0JylcbnZhciBpc0FycmF5ID0gcmVxdWlyZSgnaXNhcnJheScpXG5cbmV4cG9ydHMuQnVmZmVyID0gQnVmZmVyXG5leHBvcnRzLlNsb3dCdWZmZXIgPSBTbG93QnVmZmVyXG5leHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTID0gNTBcblxuLyoqXG4gKiBJZiBgQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRgOlxuICogICA9PT0gdHJ1ZSAgICBVc2UgVWludDhBcnJheSBpbXBsZW1lbnRhdGlvbiAoZmFzdGVzdClcbiAqICAgPT09IGZhbHNlICAgVXNlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiAobW9zdCBjb21wYXRpYmxlLCBldmVuIElFNilcbiAqXG4gKiBCcm93c2VycyB0aGF0IHN1cHBvcnQgdHlwZWQgYXJyYXlzIGFyZSBJRSAxMCssIEZpcmVmb3ggNCssIENocm9tZSA3KywgU2FmYXJpIDUuMSssXG4gKiBPcGVyYSAxMS42KywgaU9TIDQuMisuXG4gKlxuICogRHVlIHRvIHZhcmlvdXMgYnJvd3NlciBidWdzLCBzb21ldGltZXMgdGhlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiB3aWxsIGJlIHVzZWQgZXZlblxuICogd2hlbiB0aGUgYnJvd3NlciBzdXBwb3J0cyB0eXBlZCBhcnJheXMuXG4gKlxuICogTm90ZTpcbiAqXG4gKiAgIC0gRmlyZWZveCA0LTI5IGxhY2tzIHN1cHBvcnQgZm9yIGFkZGluZyBuZXcgcHJvcGVydGllcyB0byBgVWludDhBcnJheWAgaW5zdGFuY2VzLFxuICogICAgIFNlZTogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9Njk1NDM4LlxuICpcbiAqICAgLSBDaHJvbWUgOS0xMCBpcyBtaXNzaW5nIHRoZSBgVHlwZWRBcnJheS5wcm90b3R5cGUuc3ViYXJyYXlgIGZ1bmN0aW9uLlxuICpcbiAqICAgLSBJRTEwIGhhcyBhIGJyb2tlbiBgVHlwZWRBcnJheS5wcm90b3R5cGUuc3ViYXJyYXlgIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYXJyYXlzIG9mXG4gKiAgICAgaW5jb3JyZWN0IGxlbmd0aCBpbiBzb21lIHNpdHVhdGlvbnMuXG5cbiAqIFdlIGRldGVjdCB0aGVzZSBidWdneSBicm93c2VycyBhbmQgc2V0IGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGAgdG8gYGZhbHNlYCBzbyB0aGV5XG4gKiBnZXQgdGhlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiwgd2hpY2ggaXMgc2xvd2VyIGJ1dCBiZWhhdmVzIGNvcnJlY3RseS5cbiAqL1xuQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgPSBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVCAhPT0gdW5kZWZpbmVkXG4gID8gZ2xvYmFsLlRZUEVEX0FSUkFZX1NVUFBPUlRcbiAgOiB0eXBlZEFycmF5U3VwcG9ydCgpXG5cbi8qXG4gKiBFeHBvcnQga01heExlbmd0aCBhZnRlciB0eXBlZCBhcnJheSBzdXBwb3J0IGlzIGRldGVybWluZWQuXG4gKi9cbmV4cG9ydHMua01heExlbmd0aCA9IGtNYXhMZW5ndGgoKVxuXG5mdW5jdGlvbiB0eXBlZEFycmF5U3VwcG9ydCAoKSB7XG4gIHRyeSB7XG4gICAgdmFyIGFyciA9IG5ldyBVaW50OEFycmF5KDEpXG4gICAgYXJyLl9fcHJvdG9fXyA9IHtfX3Byb3RvX186IFVpbnQ4QXJyYXkucHJvdG90eXBlLCBmb286IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDQyIH19XG4gICAgcmV0dXJuIGFyci5mb28oKSA9PT0gNDIgJiYgLy8gdHlwZWQgYXJyYXkgaW5zdGFuY2VzIGNhbiBiZSBhdWdtZW50ZWRcbiAgICAgICAgdHlwZW9mIGFyci5zdWJhcnJheSA9PT0gJ2Z1bmN0aW9uJyAmJiAvLyBjaHJvbWUgOS0xMCBsYWNrIGBzdWJhcnJheWBcbiAgICAgICAgYXJyLnN1YmFycmF5KDEsIDEpLmJ5dGVMZW5ndGggPT09IDAgLy8gaWUxMCBoYXMgYnJva2VuIGBzdWJhcnJheWBcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbmZ1bmN0aW9uIGtNYXhMZW5ndGggKCkge1xuICByZXR1cm4gQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRcbiAgICA/IDB4N2ZmZmZmZmZcbiAgICA6IDB4M2ZmZmZmZmZcbn1cblxuZnVuY3Rpb24gY3JlYXRlQnVmZmVyICh0aGF0LCBsZW5ndGgpIHtcbiAgaWYgKGtNYXhMZW5ndGgoKSA8IGxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHR5cGVkIGFycmF5IGxlbmd0aCcpXG4gIH1cbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlXG4gICAgdGhhdCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aClcbiAgICB0aGF0Ll9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzXG4gICAgaWYgKHRoYXQgPT09IG51bGwpIHtcbiAgICAgIHRoYXQgPSBuZXcgQnVmZmVyKGxlbmd0aClcbiAgICB9XG4gICAgdGhhdC5sZW5ndGggPSBsZW5ndGhcbiAgfVxuXG4gIHJldHVybiB0aGF0XG59XG5cbi8qKlxuICogVGhlIEJ1ZmZlciBjb25zdHJ1Y3RvciByZXR1cm5zIGluc3RhbmNlcyBvZiBgVWludDhBcnJheWAgdGhhdCBoYXZlIHRoZWlyXG4gKiBwcm90b3R5cGUgY2hhbmdlZCB0byBgQnVmZmVyLnByb3RvdHlwZWAuIEZ1cnRoZXJtb3JlLCBgQnVmZmVyYCBpcyBhIHN1YmNsYXNzIG9mXG4gKiBgVWludDhBcnJheWAsIHNvIHRoZSByZXR1cm5lZCBpbnN0YW5jZXMgd2lsbCBoYXZlIGFsbCB0aGUgbm9kZSBgQnVmZmVyYCBtZXRob2RzXG4gKiBhbmQgdGhlIGBVaW50OEFycmF5YCBtZXRob2RzLiBTcXVhcmUgYnJhY2tldCBub3RhdGlvbiB3b3JrcyBhcyBleHBlY3RlZCAtLSBpdFxuICogcmV0dXJucyBhIHNpbmdsZSBvY3RldC5cbiAqXG4gKiBUaGUgYFVpbnQ4QXJyYXlgIHByb3RvdHlwZSByZW1haW5zIHVubW9kaWZpZWQuXG4gKi9cblxuZnVuY3Rpb24gQnVmZmVyIChhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmICEodGhpcyBpbnN0YW5jZW9mIEJ1ZmZlcikpIHtcbiAgICByZXR1cm4gbmV3IEJ1ZmZlcihhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aClcbiAgfVxuXG4gIC8vIENvbW1vbiBjYXNlLlxuICBpZiAodHlwZW9mIGFyZyA9PT0gJ251bWJlcicpIHtcbiAgICBpZiAodHlwZW9mIGVuY29kaW5nT3JPZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICdJZiBlbmNvZGluZyBpcyBzcGVjaWZpZWQgdGhlbiB0aGUgZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZydcbiAgICAgIClcbiAgICB9XG4gICAgcmV0dXJuIGFsbG9jVW5zYWZlKHRoaXMsIGFyZylcbiAgfVxuICByZXR1cm4gZnJvbSh0aGlzLCBhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aClcbn1cblxuQnVmZmVyLnBvb2xTaXplID0gODE5MiAvLyBub3QgdXNlZCBieSB0aGlzIGltcGxlbWVudGF0aW9uXG5cbi8vIFRPRE86IExlZ2FjeSwgbm90IG5lZWRlZCBhbnltb3JlLiBSZW1vdmUgaW4gbmV4dCBtYWpvciB2ZXJzaW9uLlxuQnVmZmVyLl9hdWdtZW50ID0gZnVuY3Rpb24gKGFycikge1xuICBhcnIuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICByZXR1cm4gYXJyXG59XG5cbmZ1bmN0aW9uIGZyb20gKHRoYXQsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInZhbHVlXCIgYXJndW1lbnQgbXVzdCBub3QgYmUgYSBudW1iZXInKVxuICB9XG5cbiAgaWYgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgIHJldHVybiBmcm9tQXJyYXlCdWZmZXIodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aClcbiAgfVxuXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGZyb21TdHJpbmcodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQpXG4gIH1cblxuICByZXR1cm4gZnJvbU9iamVjdCh0aGF0LCB2YWx1ZSlcbn1cblxuLyoqXG4gKiBGdW5jdGlvbmFsbHkgZXF1aXZhbGVudCB0byBCdWZmZXIoYXJnLCBlbmNvZGluZykgYnV0IHRocm93cyBhIFR5cGVFcnJvclxuICogaWYgdmFsdWUgaXMgYSBudW1iZXIuXG4gKiBCdWZmZXIuZnJvbShzdHJbLCBlbmNvZGluZ10pXG4gKiBCdWZmZXIuZnJvbShhcnJheSlcbiAqIEJ1ZmZlci5mcm9tKGJ1ZmZlcilcbiAqIEJ1ZmZlci5mcm9tKGFycmF5QnVmZmVyWywgYnl0ZU9mZnNldFssIGxlbmd0aF1dKVxuICoqL1xuQnVmZmVyLmZyb20gPSBmdW5jdGlvbiAodmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gZnJvbShudWxsLCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxufVxuXG5pZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgQnVmZmVyLnByb3RvdHlwZS5fX3Byb3RvX18gPSBVaW50OEFycmF5LnByb3RvdHlwZVxuICBCdWZmZXIuX19wcm90b19fID0gVWludDhBcnJheVxuICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnNwZWNpZXMgJiZcbiAgICAgIEJ1ZmZlcltTeW1ib2wuc3BlY2llc10gPT09IEJ1ZmZlcikge1xuICAgIC8vIEZpeCBzdWJhcnJheSgpIGluIEVTMjAxNi4gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZmVyb3NzL2J1ZmZlci9wdWxsLzk3XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1ZmZlciwgU3ltYm9sLnNwZWNpZXMsIHtcbiAgICAgIHZhbHVlOiBudWxsLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSlcbiAgfVxufVxuXG5mdW5jdGlvbiBhc3NlcnRTaXplIChzaXplKSB7XG4gIGlmICh0eXBlb2Ygc2l6ZSAhPT0gJ251bWJlcicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInNpemVcIiBhcmd1bWVudCBtdXN0IGJlIGEgbnVtYmVyJylcbiAgfSBlbHNlIGlmIChzaXplIDwgMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInNpemVcIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBuZWdhdGl2ZScpXG4gIH1cbn1cblxuZnVuY3Rpb24gYWxsb2MgKHRoYXQsIHNpemUsIGZpbGwsIGVuY29kaW5nKSB7XG4gIGFzc2VydFNpemUoc2l6ZSlcbiAgaWYgKHNpemUgPD0gMCkge1xuICAgIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSlcbiAgfVxuICBpZiAoZmlsbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gT25seSBwYXkgYXR0ZW50aW9uIHRvIGVuY29kaW5nIGlmIGl0J3MgYSBzdHJpbmcuIFRoaXNcbiAgICAvLyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgc2VuZGluZyBpbiBhIG51bWJlciB0aGF0IHdvdWxkXG4gICAgLy8gYmUgaW50ZXJwcmV0dGVkIGFzIGEgc3RhcnQgb2Zmc2V0LlxuICAgIHJldHVybiB0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnXG4gICAgICA/IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKS5maWxsKGZpbGwsIGVuY29kaW5nKVxuICAgICAgOiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkuZmlsbChmaWxsKVxuICB9XG4gIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSlcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuXG4gKiBhbGxvYyhzaXplWywgZmlsbFssIGVuY29kaW5nXV0pXG4gKiovXG5CdWZmZXIuYWxsb2MgPSBmdW5jdGlvbiAoc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGFsbG9jKG51bGwsIHNpemUsIGZpbGwsIGVuY29kaW5nKVxufVxuXG5mdW5jdGlvbiBhbGxvY1Vuc2FmZSAodGhhdCwgc2l6ZSkge1xuICBhc3NlcnRTaXplKHNpemUpXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSA8IDAgPyAwIDogY2hlY2tlZChzaXplKSB8IDApXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7ICsraSkge1xuICAgICAgdGhhdFtpXSA9IDBcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuLyoqXG4gKiBFcXVpdmFsZW50IHRvIEJ1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICogKi9cbkJ1ZmZlci5hbGxvY1Vuc2FmZSA9IGZ1bmN0aW9uIChzaXplKSB7XG4gIHJldHVybiBhbGxvY1Vuc2FmZShudWxsLCBzaXplKVxufVxuLyoqXG4gKiBFcXVpdmFsZW50IHRvIFNsb3dCdWZmZXIobnVtKSwgYnkgZGVmYXVsdCBjcmVhdGVzIGEgbm9uLXplcm8tZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS5cbiAqL1xuQnVmZmVyLmFsbG9jVW5zYWZlU2xvdyA9IGZ1bmN0aW9uIChzaXplKSB7XG4gIHJldHVybiBhbGxvY1Vuc2FmZShudWxsLCBzaXplKVxufVxuXG5mdW5jdGlvbiBmcm9tU3RyaW5nICh0aGF0LCBzdHJpbmcsIGVuY29kaW5nKSB7XG4gIGlmICh0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnIHx8IGVuY29kaW5nID09PSAnJykge1xuICAgIGVuY29kaW5nID0gJ3V0ZjgnXG4gIH1cblxuICBpZiAoIUJ1ZmZlci5pc0VuY29kaW5nKGVuY29kaW5nKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiZW5jb2RpbmdcIiBtdXN0IGJlIGEgdmFsaWQgc3RyaW5nIGVuY29kaW5nJylcbiAgfVxuXG4gIHZhciBsZW5ndGggPSBieXRlTGVuZ3RoKHN0cmluZywgZW5jb2RpbmcpIHwgMFxuICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbmd0aClcblxuICB2YXIgYWN0dWFsID0gdGhhdC53cml0ZShzdHJpbmcsIGVuY29kaW5nKVxuXG4gIGlmIChhY3R1YWwgIT09IGxlbmd0aCkge1xuICAgIC8vIFdyaXRpbmcgYSBoZXggc3RyaW5nLCBmb3IgZXhhbXBsZSwgdGhhdCBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMgd2lsbFxuICAgIC8vIGNhdXNlIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGZpcnN0IGludmFsaWQgY2hhcmFjdGVyIHRvIGJlIGlnbm9yZWQuIChlLmcuXG4gICAgLy8gJ2FieHhjZCcgd2lsbCBiZSB0cmVhdGVkIGFzICdhYicpXG4gICAgdGhhdCA9IHRoYXQuc2xpY2UoMCwgYWN0dWFsKVxuICB9XG5cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5TGlrZSAodGhhdCwgYXJyYXkpIHtcbiAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCA8IDAgPyAwIDogY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMFxuICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbmd0aClcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgIHRoYXRbaV0gPSBhcnJheVtpXSAmIDI1NVxuICB9XG4gIHJldHVybiB0aGF0XG59XG5cbmZ1bmN0aW9uIGZyb21BcnJheUJ1ZmZlciAodGhhdCwgYXJyYXksIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICBhcnJheS5ieXRlTGVuZ3RoIC8vIHRoaXMgdGhyb3dzIGlmIGBhcnJheWAgaXMgbm90IGEgdmFsaWQgQXJyYXlCdWZmZXJcblxuICBpZiAoYnl0ZU9mZnNldCA8IDAgfHwgYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXFwnb2Zmc2V0XFwnIGlzIG91dCBvZiBib3VuZHMnKVxuICB9XG5cbiAgaWYgKGFycmF5LmJ5dGVMZW5ndGggPCBieXRlT2Zmc2V0ICsgKGxlbmd0aCB8fCAwKSkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcXCdsZW5ndGhcXCcgaXMgb3V0IG9mIGJvdW5kcycpXG4gIH1cblxuICBpZiAoYnl0ZU9mZnNldCA9PT0gdW5kZWZpbmVkICYmIGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSlcbiAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXksIGJ5dGVPZmZzZXQpXG4gIH0gZWxzZSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlXG4gICAgdGhhdCA9IGFycmF5XG4gICAgdGhhdC5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIH0gZWxzZSB7XG4gICAgLy8gRmFsbGJhY2s6IFJldHVybiBhbiBvYmplY3QgaW5zdGFuY2Ugb2YgdGhlIEJ1ZmZlciBjbGFzc1xuICAgIHRoYXQgPSBmcm9tQXJyYXlMaWtlKHRoYXQsIGFycmF5KVxuICB9XG4gIHJldHVybiB0aGF0XG59XG5cbmZ1bmN0aW9uIGZyb21PYmplY3QgKHRoYXQsIG9iaikge1xuICBpZiAoQnVmZmVyLmlzQnVmZmVyKG9iaikpIHtcbiAgICB2YXIgbGVuID0gY2hlY2tlZChvYmoubGVuZ3RoKSB8IDBcbiAgICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbilcblxuICAgIGlmICh0aGF0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRoYXRcbiAgICB9XG5cbiAgICBvYmouY29weSh0aGF0LCAwLCAwLCBsZW4pXG4gICAgcmV0dXJuIHRoYXRcbiAgfVxuXG4gIGlmIChvYmopIHtcbiAgICBpZiAoKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgb2JqLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB8fCAnbGVuZ3RoJyBpbiBvYmopIHtcbiAgICAgIGlmICh0eXBlb2Ygb2JqLmxlbmd0aCAhPT0gJ251bWJlcicgfHwgaXNuYW4ob2JqLmxlbmd0aCkpIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCAwKVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqKVxuICAgIH1cblxuICAgIGlmIChvYmoudHlwZSA9PT0gJ0J1ZmZlcicgJiYgaXNBcnJheShvYmouZGF0YSkpIHtcbiAgICAgIHJldHVybiBmcm9tQXJyYXlMaWtlKHRoYXQsIG9iai5kYXRhKVxuICAgIH1cbiAgfVxuXG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgQXJyYXlCdWZmZXIsIEFycmF5LCBvciBhcnJheS1saWtlIG9iamVjdC4nKVxufVxuXG5mdW5jdGlvbiBjaGVja2VkIChsZW5ndGgpIHtcbiAgLy8gTm90ZTogY2Fubm90IHVzZSBgbGVuZ3RoIDwga01heExlbmd0aCgpYCBoZXJlIGJlY2F1c2UgdGhhdCBmYWlscyB3aGVuXG4gIC8vIGxlbmd0aCBpcyBOYU4gKHdoaWNoIGlzIG90aGVyd2lzZSBjb2VyY2VkIHRvIHplcm8uKVxuICBpZiAobGVuZ3RoID49IGtNYXhMZW5ndGgoKSkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICdzaXplOiAweCcgKyBrTWF4TGVuZ3RoKCkudG9TdHJpbmcoMTYpICsgJyBieXRlcycpXG4gIH1cbiAgcmV0dXJuIGxlbmd0aCB8IDBcbn1cblxuZnVuY3Rpb24gU2xvd0J1ZmZlciAobGVuZ3RoKSB7XG4gIGlmICgrbGVuZ3RoICE9IGxlbmd0aCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGVxZXFlcVxuICAgIGxlbmd0aCA9IDBcbiAgfVxuICByZXR1cm4gQnVmZmVyLmFsbG9jKCtsZW5ndGgpXG59XG5cbkJ1ZmZlci5pc0J1ZmZlciA9IGZ1bmN0aW9uIGlzQnVmZmVyIChiKSB7XG4gIHJldHVybiAhIShiICE9IG51bGwgJiYgYi5faXNCdWZmZXIpXG59XG5cbkJ1ZmZlci5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAoYSwgYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihhKSB8fCAhQnVmZmVyLmlzQnVmZmVyKGIpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnRzIG11c3QgYmUgQnVmZmVycycpXG4gIH1cblxuICBpZiAoYSA9PT0gYikgcmV0dXJuIDBcblxuICB2YXIgeCA9IGEubGVuZ3RoXG4gIHZhciB5ID0gYi5sZW5ndGhcblxuICBmb3IgKHZhciBpID0gMCwgbGVuID0gTWF0aC5taW4oeCwgeSk7IGkgPCBsZW47ICsraSkge1xuICAgIGlmIChhW2ldICE9PSBiW2ldKSB7XG4gICAgICB4ID0gYVtpXVxuICAgICAgeSA9IGJbaV1cbiAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgaWYgKHggPCB5KSByZXR1cm4gLTFcbiAgaWYgKHkgPCB4KSByZXR1cm4gMVxuICByZXR1cm4gMFxufVxuXG5CdWZmZXIuaXNFbmNvZGluZyA9IGZ1bmN0aW9uIGlzRW5jb2RpbmcgKGVuY29kaW5nKSB7XG4gIHN3aXRjaCAoU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSAnaGV4JzpcbiAgICBjYXNlICd1dGY4JzpcbiAgICBjYXNlICd1dGYtOCc6XG4gICAgY2FzZSAnYXNjaWknOlxuICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgY2FzZSAnYmluYXJ5JzpcbiAgICBjYXNlICdiYXNlNjQnOlxuICAgIGNhc2UgJ3VjczInOlxuICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICBjYXNlICd1dGYxNmxlJzpcbiAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuXG5CdWZmZXIuY29uY2F0ID0gZnVuY3Rpb24gY29uY2F0IChsaXN0LCBsZW5ndGgpIHtcbiAgaWYgKCFpc0FycmF5KGxpc3QpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0XCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJylcbiAgfVxuXG4gIGlmIChsaXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBCdWZmZXIuYWxsb2MoMClcbiAgfVxuXG4gIHZhciBpXG4gIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgIGxlbmd0aCA9IDBcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7ICsraSkge1xuICAgICAgbGVuZ3RoICs9IGxpc3RbaV0ubGVuZ3RoXG4gICAgfVxuICB9XG5cbiAgdmFyIGJ1ZmZlciA9IEJ1ZmZlci5hbGxvY1Vuc2FmZShsZW5ndGgpXG4gIHZhciBwb3MgPSAwXG4gIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGJ1ZiA9IGxpc3RbaV1cbiAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImxpc3RcIiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKVxuICAgIH1cbiAgICBidWYuY29weShidWZmZXIsIHBvcylcbiAgICBwb3MgKz0gYnVmLmxlbmd0aFxuICB9XG4gIHJldHVybiBidWZmZXJcbn1cblxuZnVuY3Rpb24gYnl0ZUxlbmd0aCAoc3RyaW5nLCBlbmNvZGluZykge1xuICBpZiAoQnVmZmVyLmlzQnVmZmVyKHN0cmluZykpIHtcbiAgICByZXR1cm4gc3RyaW5nLmxlbmd0aFxuICB9XG4gIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBBcnJheUJ1ZmZlci5pc1ZpZXcgPT09ICdmdW5jdGlvbicgJiZcbiAgICAgIChBcnJheUJ1ZmZlci5pc1ZpZXcoc3RyaW5nKSB8fCBzdHJpbmcgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikpIHtcbiAgICByZXR1cm4gc3RyaW5nLmJ5dGVMZW5ndGhcbiAgfVxuICBpZiAodHlwZW9mIHN0cmluZyAhPT0gJ3N0cmluZycpIHtcbiAgICBzdHJpbmcgPSAnJyArIHN0cmluZ1xuICB9XG5cbiAgdmFyIGxlbiA9IHN0cmluZy5sZW5ndGhcbiAgaWYgKGxlbiA9PT0gMCkgcmV0dXJuIDBcblxuICAvLyBVc2UgYSBmb3IgbG9vcCB0byBhdm9pZCByZWN1cnNpb25cbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcbiAgZm9yICg7Oykge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICByZXR1cm4gbGVuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgIGNhc2UgdW5kZWZpbmVkOlxuICAgICAgICByZXR1cm4gdXRmOFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGhcbiAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgIHJldHVybiBsZW4gKiAyXG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gbGVuID4+PiAxXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICByZXR1cm4gYmFzZTY0VG9CeXRlcyhzdHJpbmcpLmxlbmd0aFxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSByZXR1cm4gdXRmOFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGggLy8gYXNzdW1lIHV0ZjhcbiAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cbkJ1ZmZlci5ieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aFxuXG5mdW5jdGlvbiBzbG93VG9TdHJpbmcgKGVuY29kaW5nLCBzdGFydCwgZW5kKSB7XG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG5cbiAgLy8gTm8gbmVlZCB0byB2ZXJpZnkgdGhhdCBcInRoaXMubGVuZ3RoIDw9IE1BWF9VSU5UMzJcIiBzaW5jZSBpdCdzIGEgcmVhZC1vbmx5XG4gIC8vIHByb3BlcnR5IG9mIGEgdHlwZWQgYXJyYXkuXG5cbiAgLy8gVGhpcyBiZWhhdmVzIG5laXRoZXIgbGlrZSBTdHJpbmcgbm9yIFVpbnQ4QXJyYXkgaW4gdGhhdCB3ZSBzZXQgc3RhcnQvZW5kXG4gIC8vIHRvIHRoZWlyIHVwcGVyL2xvd2VyIGJvdW5kcyBpZiB0aGUgdmFsdWUgcGFzc2VkIGlzIG91dCBvZiByYW5nZS5cbiAgLy8gdW5kZWZpbmVkIGlzIGhhbmRsZWQgc3BlY2lhbGx5IGFzIHBlciBFQ01BLTI2MiA2dGggRWRpdGlvbixcbiAgLy8gU2VjdGlvbiAxMy4zLjMuNyBSdW50aW1lIFNlbWFudGljczogS2V5ZWRCaW5kaW5nSW5pdGlhbGl6YXRpb24uXG4gIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkIHx8IHN0YXJ0IDwgMCkge1xuICAgIHN0YXJ0ID0gMFxuICB9XG4gIC8vIFJldHVybiBlYXJseSBpZiBzdGFydCA+IHRoaXMubGVuZ3RoLiBEb25lIGhlcmUgdG8gcHJldmVudCBwb3RlbnRpYWwgdWludDMyXG4gIC8vIGNvZXJjaW9uIGZhaWwgYmVsb3cuXG4gIGlmIChzdGFydCA+IHRoaXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuICcnXG4gIH1cblxuICBpZiAoZW5kID09PSB1bmRlZmluZWQgfHwgZW5kID4gdGhpcy5sZW5ndGgpIHtcbiAgICBlbmQgPSB0aGlzLmxlbmd0aFxuICB9XG5cbiAgaWYgKGVuZCA8PSAwKSB7XG4gICAgcmV0dXJuICcnXG4gIH1cblxuICAvLyBGb3JjZSBjb2Vyc2lvbiB0byB1aW50MzIuIFRoaXMgd2lsbCBhbHNvIGNvZXJjZSBmYWxzZXkvTmFOIHZhbHVlcyB0byAwLlxuICBlbmQgPj4+PSAwXG4gIHN0YXJ0ID4+Pj0gMFxuXG4gIGlmIChlbmQgPD0gc3RhcnQpIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG5cbiAgd2hpbGUgKHRydWUpIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gaGV4U2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAndXRmOCc6XG4gICAgICBjYXNlICd1dGYtOCc6XG4gICAgICAgIHJldHVybiB1dGY4U2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICByZXR1cm4gYXNjaWlTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICdsYXRpbjEnOlxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGxhdGluMVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9IChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG4vLyBUaGUgcHJvcGVydHkgaXMgdXNlZCBieSBgQnVmZmVyLmlzQnVmZmVyYCBhbmQgYGlzLWJ1ZmZlcmAgKGluIFNhZmFyaSA1LTcpIHRvIGRldGVjdFxuLy8gQnVmZmVyIGluc3RhbmNlcy5cbkJ1ZmZlci5wcm90b3R5cGUuX2lzQnVmZmVyID0gdHJ1ZVxuXG5mdW5jdGlvbiBzd2FwIChiLCBuLCBtKSB7XG4gIHZhciBpID0gYltuXVxuICBiW25dID0gYlttXVxuICBiW21dID0gaVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnN3YXAxNiA9IGZ1bmN0aW9uIHN3YXAxNiAoKSB7XG4gIHZhciBsZW4gPSB0aGlzLmxlbmd0aFxuICBpZiAobGVuICUgMiAhPT0gMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMTYtYml0cycpXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikge1xuICAgIHN3YXAodGhpcywgaSwgaSArIDEpXG4gIH1cbiAgcmV0dXJuIHRoaXNcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5zd2FwMzIgPSBmdW5jdGlvbiBzd2FwMzIgKCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgaWYgKGxlbiAlIDQgIT09IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDMyLWJpdHMnKVxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpIHtcbiAgICBzd2FwKHRoaXMsIGksIGkgKyAzKVxuICAgIHN3YXAodGhpcywgaSArIDEsIGkgKyAyKVxuICB9XG4gIHJldHVybiB0aGlzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDY0ID0gZnVuY3Rpb24gc3dhcDY0ICgpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIGlmIChsZW4gJSA4ICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA2NC1iaXRzJylcbiAgfVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSA4KSB7XG4gICAgc3dhcCh0aGlzLCBpLCBpICsgNylcbiAgICBzd2FwKHRoaXMsIGkgKyAxLCBpICsgNilcbiAgICBzd2FwKHRoaXMsIGkgKyAyLCBpICsgNSlcbiAgICBzd2FwKHRoaXMsIGkgKyAzLCBpICsgNClcbiAgfVxuICByZXR1cm4gdGhpc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkge1xuICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGggfCAwXG4gIGlmIChsZW5ndGggPT09IDApIHJldHVybiAnJ1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCAwLCBsZW5ndGgpXG4gIHJldHVybiBzbG93VG9TdHJpbmcuYXBwbHkodGhpcywgYXJndW1lbnRzKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIGVxdWFscyAoYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIGlmICh0aGlzID09PSBiKSByZXR1cm4gdHJ1ZVxuICByZXR1cm4gQnVmZmVyLmNvbXBhcmUodGhpcywgYikgPT09IDBcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbnNwZWN0ID0gZnVuY3Rpb24gaW5zcGVjdCAoKSB7XG4gIHZhciBzdHIgPSAnJ1xuICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFU1xuICBpZiAodGhpcy5sZW5ndGggPiAwKSB7XG4gICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJylcbiAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpIHN0ciArPSAnIC4uLiAnXG4gIH1cbiAgcmV0dXJuICc8QnVmZmVyICcgKyBzdHIgKyAnPidcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAodGFyZ2V0LCBzdGFydCwgZW5kLCB0aGlzU3RhcnQsIHRoaXNFbmQpIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIodGFyZ2V0KSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKVxuICB9XG5cbiAgaWYgKHN0YXJ0ID09PSB1bmRlZmluZWQpIHtcbiAgICBzdGFydCA9IDBcbiAgfVxuICBpZiAoZW5kID09PSB1bmRlZmluZWQpIHtcbiAgICBlbmQgPSB0YXJnZXQgPyB0YXJnZXQubGVuZ3RoIDogMFxuICB9XG4gIGlmICh0aGlzU3RhcnQgPT09IHVuZGVmaW5lZCkge1xuICAgIHRoaXNTdGFydCA9IDBcbiAgfVxuICBpZiAodGhpc0VuZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpc0VuZCA9IHRoaXMubGVuZ3RoXG4gIH1cblxuICBpZiAoc3RhcnQgPCAwIHx8IGVuZCA+IHRhcmdldC5sZW5ndGggfHwgdGhpc1N0YXJ0IDwgMCB8fCB0aGlzRW5kID4gdGhpcy5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignb3V0IG9mIHJhbmdlIGluZGV4JylcbiAgfVxuXG4gIGlmICh0aGlzU3RhcnQgPj0gdGhpc0VuZCAmJiBzdGFydCA+PSBlbmQpIHtcbiAgICByZXR1cm4gMFxuICB9XG4gIGlmICh0aGlzU3RhcnQgPj0gdGhpc0VuZCkge1xuICAgIHJldHVybiAtMVxuICB9XG4gIGlmIChzdGFydCA+PSBlbmQpIHtcbiAgICByZXR1cm4gMVxuICB9XG5cbiAgc3RhcnQgPj4+PSAwXG4gIGVuZCA+Pj49IDBcbiAgdGhpc1N0YXJ0ID4+Pj0gMFxuICB0aGlzRW5kID4+Pj0gMFxuXG4gIGlmICh0aGlzID09PSB0YXJnZXQpIHJldHVybiAwXG5cbiAgdmFyIHggPSB0aGlzRW5kIC0gdGhpc1N0YXJ0XG4gIHZhciB5ID0gZW5kIC0gc3RhcnRcbiAgdmFyIGxlbiA9IE1hdGgubWluKHgsIHkpXG5cbiAgdmFyIHRoaXNDb3B5ID0gdGhpcy5zbGljZSh0aGlzU3RhcnQsIHRoaXNFbmQpXG4gIHZhciB0YXJnZXRDb3B5ID0gdGFyZ2V0LnNsaWNlKHN0YXJ0LCBlbmQpXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgIGlmICh0aGlzQ29weVtpXSAhPT0gdGFyZ2V0Q29weVtpXSkge1xuICAgICAgeCA9IHRoaXNDb3B5W2ldXG4gICAgICB5ID0gdGFyZ2V0Q29weVtpXVxuICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbi8vIEZpbmRzIGVpdGhlciB0aGUgZmlyc3QgaW5kZXggb2YgYHZhbGAgaW4gYGJ1ZmZlcmAgYXQgb2Zmc2V0ID49IGBieXRlT2Zmc2V0YCxcbi8vIE9SIHRoZSBsYXN0IGluZGV4IG9mIGB2YWxgIGluIGBidWZmZXJgIGF0IG9mZnNldCA8PSBgYnl0ZU9mZnNldGAuXG4vL1xuLy8gQXJndW1lbnRzOlxuLy8gLSBidWZmZXIgLSBhIEJ1ZmZlciB0byBzZWFyY2hcbi8vIC0gdmFsIC0gYSBzdHJpbmcsIEJ1ZmZlciwgb3IgbnVtYmVyXG4vLyAtIGJ5dGVPZmZzZXQgLSBhbiBpbmRleCBpbnRvIGBidWZmZXJgOyB3aWxsIGJlIGNsYW1wZWQgdG8gYW4gaW50MzJcbi8vIC0gZW5jb2RpbmcgLSBhbiBvcHRpb25hbCBlbmNvZGluZywgcmVsZXZhbnQgaXMgdmFsIGlzIGEgc3RyaW5nXG4vLyAtIGRpciAtIHRydWUgZm9yIGluZGV4T2YsIGZhbHNlIGZvciBsYXN0SW5kZXhPZlxuZnVuY3Rpb24gYmlkaXJlY3Rpb25hbEluZGV4T2YgKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKSB7XG4gIC8vIEVtcHR5IGJ1ZmZlciBtZWFucyBubyBtYXRjaFxuICBpZiAoYnVmZmVyLmxlbmd0aCA9PT0gMCkgcmV0dXJuIC0xXG5cbiAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXRcbiAgaWYgKHR5cGVvZiBieXRlT2Zmc2V0ID09PSAnc3RyaW5nJykge1xuICAgIGVuY29kaW5nID0gYnl0ZU9mZnNldFxuICAgIGJ5dGVPZmZzZXQgPSAwXG4gIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA+IDB4N2ZmZmZmZmYpIHtcbiAgICBieXRlT2Zmc2V0ID0gMHg3ZmZmZmZmZlxuICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAtMHg4MDAwMDAwMCkge1xuICAgIGJ5dGVPZmZzZXQgPSAtMHg4MDAwMDAwMFxuICB9XG4gIGJ5dGVPZmZzZXQgPSArYnl0ZU9mZnNldCAgLy8gQ29lcmNlIHRvIE51bWJlci5cbiAgaWYgKGlzTmFOKGJ5dGVPZmZzZXQpKSB7XG4gICAgLy8gYnl0ZU9mZnNldDogaXQgaXQncyB1bmRlZmluZWQsIG51bGwsIE5hTiwgXCJmb29cIiwgZXRjLCBzZWFyY2ggd2hvbGUgYnVmZmVyXG4gICAgYnl0ZU9mZnNldCA9IGRpciA/IDAgOiAoYnVmZmVyLmxlbmd0aCAtIDEpXG4gIH1cblxuICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldDogbmVnYXRpdmUgb2Zmc2V0cyBzdGFydCBmcm9tIHRoZSBlbmQgb2YgdGhlIGJ1ZmZlclxuICBpZiAoYnl0ZU9mZnNldCA8IDApIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoICsgYnl0ZU9mZnNldFxuICBpZiAoYnl0ZU9mZnNldCA+PSBidWZmZXIubGVuZ3RoKSB7XG4gICAgaWYgKGRpcikgcmV0dXJuIC0xXG4gICAgZWxzZSBieXRlT2Zmc2V0ID0gYnVmZmVyLmxlbmd0aCAtIDFcbiAgfSBlbHNlIGlmIChieXRlT2Zmc2V0IDwgMCkge1xuICAgIGlmIChkaXIpIGJ5dGVPZmZzZXQgPSAwXG4gICAgZWxzZSByZXR1cm4gLTFcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSB2YWxcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XG4gICAgdmFsID0gQnVmZmVyLmZyb20odmFsLCBlbmNvZGluZylcbiAgfVxuXG4gIC8vIEZpbmFsbHksIHNlYXJjaCBlaXRoZXIgaW5kZXhPZiAoaWYgZGlyIGlzIHRydWUpIG9yIGxhc3RJbmRleE9mXG4gIGlmIChCdWZmZXIuaXNCdWZmZXIodmFsKSkge1xuICAgIC8vIFNwZWNpYWwgY2FzZTogbG9va2luZyBmb3IgZW1wdHkgc3RyaW5nL2J1ZmZlciBhbHdheXMgZmFpbHNcbiAgICBpZiAodmFsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIC0xXG4gICAgfVxuICAgIHJldHVybiBhcnJheUluZGV4T2YoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpXG4gIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICB2YWwgPSB2YWwgJiAweEZGIC8vIFNlYXJjaCBmb3IgYSBieXRlIHZhbHVlIFswLTI1NV1cbiAgICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgJiZcbiAgICAgICAgdHlwZW9mIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGlmIChkaXIpIHtcbiAgICAgICAgcmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5sYXN0SW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXlJbmRleE9mKGJ1ZmZlciwgWyB2YWwgXSwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcilcbiAgfVxuXG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIHN0cmluZywgbnVtYmVyIG9yIEJ1ZmZlcicpXG59XG5cbmZ1bmN0aW9uIGFycmF5SW5kZXhPZiAoYXJyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHtcbiAgdmFyIGluZGV4U2l6ZSA9IDFcbiAgdmFyIGFyckxlbmd0aCA9IGFyci5sZW5ndGhcbiAgdmFyIHZhbExlbmd0aCA9IHZhbC5sZW5ndGhcblxuICBpZiAoZW5jb2RpbmcgIT09IHVuZGVmaW5lZCkge1xuICAgIGVuY29kaW5nID0gU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgaWYgKGVuY29kaW5nID09PSAndWNzMicgfHwgZW5jb2RpbmcgPT09ICd1Y3MtMicgfHxcbiAgICAgICAgZW5jb2RpbmcgPT09ICd1dGYxNmxlJyB8fCBlbmNvZGluZyA9PT0gJ3V0Zi0xNmxlJykge1xuICAgICAgaWYgKGFyci5sZW5ndGggPCAyIHx8IHZhbC5sZW5ndGggPCAyKSB7XG4gICAgICAgIHJldHVybiAtMVxuICAgICAgfVxuICAgICAgaW5kZXhTaXplID0gMlxuICAgICAgYXJyTGVuZ3RoIC89IDJcbiAgICAgIHZhbExlbmd0aCAvPSAyXG4gICAgICBieXRlT2Zmc2V0IC89IDJcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByZWFkIChidWYsIGkpIHtcbiAgICBpZiAoaW5kZXhTaXplID09PSAxKSB7XG4gICAgICByZXR1cm4gYnVmW2ldXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBidWYucmVhZFVJbnQxNkJFKGkgKiBpbmRleFNpemUpXG4gICAgfVxuICB9XG5cbiAgdmFyIGlcbiAgaWYgKGRpcikge1xuICAgIHZhciBmb3VuZEluZGV4ID0gLTFcbiAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpIDwgYXJyTGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChyZWFkKGFyciwgaSkgPT09IHJlYWQodmFsLCBmb3VuZEluZGV4ID09PSAtMSA/IDAgOiBpIC0gZm91bmRJbmRleCkpIHtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggPT09IC0xKSBmb3VuZEluZGV4ID0gaVxuICAgICAgICBpZiAoaSAtIGZvdW5kSW5kZXggKyAxID09PSB2YWxMZW5ndGgpIHJldHVybiBmb3VuZEluZGV4ICogaW5kZXhTaXplXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZm91bmRJbmRleCAhPT0gLTEpIGkgLT0gaSAtIGZvdW5kSW5kZXhcbiAgICAgICAgZm91bmRJbmRleCA9IC0xXG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmIChieXRlT2Zmc2V0ICsgdmFsTGVuZ3RoID4gYXJyTGVuZ3RoKSBieXRlT2Zmc2V0ID0gYXJyTGVuZ3RoIC0gdmFsTGVuZ3RoXG4gICAgZm9yIChpID0gYnl0ZU9mZnNldDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIHZhciBmb3VuZCA9IHRydWVcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdmFsTGVuZ3RoOyBqKyspIHtcbiAgICAgICAgaWYgKHJlYWQoYXJyLCBpICsgaikgIT09IHJlYWQodmFsLCBqKSkge1xuICAgICAgICAgIGZvdW5kID0gZmFsc2VcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZm91bmQpIHJldHVybiBpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIC0xXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuaW5jbHVkZXMgPSBmdW5jdGlvbiBpbmNsdWRlcyAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICByZXR1cm4gdGhpcy5pbmRleE9mKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpICE9PSAtMVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiBpbmRleE9mICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7XG4gIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCB0cnVlKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmxhc3RJbmRleE9mID0gZnVuY3Rpb24gbGFzdEluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGZhbHNlKVxufVxuXG5mdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDBcbiAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXRcbiAgaWYgKCFsZW5ndGgpIHtcbiAgICBsZW5ndGggPSByZW1haW5pbmdcbiAgfSBlbHNlIHtcbiAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKVxuICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHtcbiAgICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICAgIH1cbiAgfVxuXG4gIC8vIG11c3QgYmUgYW4gZXZlbiBudW1iZXIgb2YgZGlnaXRzXG4gIHZhciBzdHJMZW4gPSBzdHJpbmcubGVuZ3RoXG4gIGlmIChzdHJMZW4gJSAyICE9PSAwKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGhleCBzdHJpbmcnKVxuXG4gIGlmIChsZW5ndGggPiBzdHJMZW4gLyAyKSB7XG4gICAgbGVuZ3RoID0gc3RyTGVuIC8gMlxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgcGFyc2VkID0gcGFyc2VJbnQoc3RyaW5nLnN1YnN0cihpICogMiwgMiksIDE2KVxuICAgIGlmIChpc05hTihwYXJzZWQpKSByZXR1cm4gaVxuICAgIGJ1ZltvZmZzZXQgKyBpXSA9IHBhcnNlZFxuICB9XG4gIHJldHVybiBpXG59XG5cbmZ1bmN0aW9uIHV0ZjhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKHV0ZjhUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIGFzY2lpV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcihhc2NpaVRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gbGF0aW4xV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYXNjaWlXcml0ZShidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIGJhc2U2NFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIoYmFzZTY0VG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiB1Y3MyV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcih1dGYxNmxlVG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gd3JpdGUgKHN0cmluZywgb2Zmc2V0LCBsZW5ndGgsIGVuY29kaW5nKSB7XG4gIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcpXG4gIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgIGVuY29kaW5nID0gJ3V0ZjgnXG4gICAgbGVuZ3RoID0gdGhpcy5sZW5ndGhcbiAgICBvZmZzZXQgPSAwXG4gIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIGVuY29kaW5nKVxuICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiBvZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgZW5jb2RpbmcgPSBvZmZzZXRcbiAgICBsZW5ndGggPSB0aGlzLmxlbmd0aFxuICAgIG9mZnNldCA9IDBcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgb2Zmc2V0WywgbGVuZ3RoXVssIGVuY29kaW5nXSlcbiAgfSBlbHNlIGlmIChpc0Zpbml0ZShvZmZzZXQpKSB7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICAgIGlmIChpc0Zpbml0ZShsZW5ndGgpKSB7XG4gICAgICBsZW5ndGggPSBsZW5ndGggfCAwXG4gICAgICBpZiAoZW5jb2RpbmcgPT09IHVuZGVmaW5lZCkgZW5jb2RpbmcgPSAndXRmOCdcbiAgICB9IGVsc2Uge1xuICAgICAgZW5jb2RpbmcgPSBsZW5ndGhcbiAgICAgIGxlbmd0aCA9IHVuZGVmaW5lZFxuICAgIH1cbiAgLy8gbGVnYWN5IHdyaXRlKHN0cmluZywgZW5jb2RpbmcsIG9mZnNldCwgbGVuZ3RoKSAtIHJlbW92ZSBpbiB2MC4xM1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICdCdWZmZXIud3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0WywgbGVuZ3RoXSkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCdcbiAgICApXG4gIH1cblxuICB2YXIgcmVtYWluaW5nID0gdGhpcy5sZW5ndGggLSBvZmZzZXRcbiAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkIHx8IGxlbmd0aCA+IHJlbWFpbmluZykgbGVuZ3RoID0gcmVtYWluaW5nXG5cbiAgaWYgKChzdHJpbmcubGVuZ3RoID4gMCAmJiAobGVuZ3RoIDwgMCB8fCBvZmZzZXQgPCAwKSkgfHwgb2Zmc2V0ID4gdGhpcy5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQXR0ZW1wdCB0byB3cml0ZSBvdXRzaWRlIGJ1ZmZlciBib3VuZHMnKVxuICB9XG5cbiAgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSAndXRmOCdcblxuICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZVxuICBmb3IgKDs7KSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGhleFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgICByZXR1cm4gdXRmOFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgICAgcmV0dXJuIGFzY2lpV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBsYXRpbjFXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICAvLyBXYXJuaW5nOiBtYXhMZW5ndGggbm90IHRha2VuIGludG8gYWNjb3VudCBpbiBiYXNlNjRXcml0ZVxuICAgICAgICByZXR1cm4gYmFzZTY0V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIHVjczJXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04gKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdCdWZmZXInLFxuICAgIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKVxuICB9XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKHN0YXJ0ID09PSAwICYmIGVuZCA9PT0gYnVmLmxlbmd0aCkge1xuICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1Zi5zbGljZShzdGFydCwgZW5kKSlcbiAgfVxufVxuXG5mdW5jdGlvbiB1dGY4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG4gIHZhciByZXMgPSBbXVxuXG4gIHZhciBpID0gc3RhcnRcbiAgd2hpbGUgKGkgPCBlbmQpIHtcbiAgICB2YXIgZmlyc3RCeXRlID0gYnVmW2ldXG4gICAgdmFyIGNvZGVQb2ludCA9IG51bGxcbiAgICB2YXIgYnl0ZXNQZXJTZXF1ZW5jZSA9IChmaXJzdEJ5dGUgPiAweEVGKSA/IDRcbiAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4REYpID8gM1xuICAgICAgOiAoZmlyc3RCeXRlID4gMHhCRikgPyAyXG4gICAgICA6IDFcblxuICAgIGlmIChpICsgYnl0ZXNQZXJTZXF1ZW5jZSA8PSBlbmQpIHtcbiAgICAgIHZhciBzZWNvbmRCeXRlLCB0aGlyZEJ5dGUsIGZvdXJ0aEJ5dGUsIHRlbXBDb2RlUG9pbnRcblxuICAgICAgc3dpdGNoIChieXRlc1BlclNlcXVlbmNlKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBpZiAoZmlyc3RCeXRlIDwgMHg4MCkge1xuICAgICAgICAgICAgY29kZVBvaW50ID0gZmlyc3RCeXRlXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4MUYpIDw8IDB4NiB8IChzZWNvbmRCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3Rikge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweEMgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4NiB8ICh0aGlyZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGRiAmJiAodGVtcENvZGVQb2ludCA8IDB4RDgwMCB8fCB0ZW1wQ29kZVBvaW50ID4gMHhERkZGKSkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBmb3VydGhCeXRlID0gYnVmW2kgKyAzXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAoZm91cnRoQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHgxMiB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHhDIHwgKHRoaXJkQnl0ZSAmIDB4M0YpIDw8IDB4NiB8IChmb3VydGhCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHhGRkZGICYmIHRlbXBDb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjb2RlUG9pbnQgPT09IG51bGwpIHtcbiAgICAgIC8vIHdlIGRpZCBub3QgZ2VuZXJhdGUgYSB2YWxpZCBjb2RlUG9pbnQgc28gaW5zZXJ0IGFcbiAgICAgIC8vIHJlcGxhY2VtZW50IGNoYXIgKFUrRkZGRCkgYW5kIGFkdmFuY2Ugb25seSAxIGJ5dGVcbiAgICAgIGNvZGVQb2ludCA9IDB4RkZGRFxuICAgICAgYnl0ZXNQZXJTZXF1ZW5jZSA9IDFcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA+IDB4RkZGRikge1xuICAgICAgLy8gZW5jb2RlIHRvIHV0ZjE2IChzdXJyb2dhdGUgcGFpciBkYW5jZSlcbiAgICAgIGNvZGVQb2ludCAtPSAweDEwMDAwXG4gICAgICByZXMucHVzaChjb2RlUG9pbnQgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApXG4gICAgICBjb2RlUG9pbnQgPSAweERDMDAgfCBjb2RlUG9pbnQgJiAweDNGRlxuICAgIH1cblxuICAgIHJlcy5wdXNoKGNvZGVQb2ludClcbiAgICBpICs9IGJ5dGVzUGVyU2VxdWVuY2VcbiAgfVxuXG4gIHJldHVybiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkocmVzKVxufVxuXG4vLyBCYXNlZCBvbiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMjc0NzI3Mi82ODA3NDIsIHRoZSBicm93c2VyIHdpdGhcbi8vIHRoZSBsb3dlc3QgbGltaXQgaXMgQ2hyb21lLCB3aXRoIDB4MTAwMDAgYXJncy5cbi8vIFdlIGdvIDEgbWFnbml0dWRlIGxlc3MsIGZvciBzYWZldHlcbnZhciBNQVhfQVJHVU1FTlRTX0xFTkdUSCA9IDB4MTAwMFxuXG5mdW5jdGlvbiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkgKGNvZGVQb2ludHMpIHtcbiAgdmFyIGxlbiA9IGNvZGVQb2ludHMubGVuZ3RoXG4gIGlmIChsZW4gPD0gTUFYX0FSR1VNRU5UU19MRU5HVEgpIHtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGNvZGVQb2ludHMpIC8vIGF2b2lkIGV4dHJhIHNsaWNlKClcbiAgfVxuXG4gIC8vIERlY29kZSBpbiBjaHVua3MgdG8gYXZvaWQgXCJjYWxsIHN0YWNrIHNpemUgZXhjZWVkZWRcIi5cbiAgdmFyIHJlcyA9ICcnXG4gIHZhciBpID0gMFxuICB3aGlsZSAoaSA8IGxlbikge1xuICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFxuICAgICAgU3RyaW5nLFxuICAgICAgY29kZVBvaW50cy5zbGljZShpLCBpICs9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKVxuICAgIClcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbmZ1bmN0aW9uIGFzY2lpU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldICYgMHg3RilcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGxhdGluMVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHJldCA9ICcnXG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcblxuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSlcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGhleFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IGJ1Zi5sZW5ndGhcblxuICBpZiAoIXN0YXJ0IHx8IHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIGlmICghZW5kIHx8IGVuZCA8IDAgfHwgZW5kID4gbGVuKSBlbmQgPSBsZW5cblxuICB2YXIgb3V0ID0gJydcbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICBvdXQgKz0gdG9IZXgoYnVmW2ldKVxuICB9XG4gIHJldHVybiBvdXRcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGJ5dGVzID0gYnVmLnNsaWNlKHN0YXJ0LCBlbmQpXG4gIHZhciByZXMgPSAnJ1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0gKyBieXRlc1tpICsgMV0gKiAyNTYpXG4gIH1cbiAgcmV0dXJuIHJlc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnNsaWNlID0gZnVuY3Rpb24gc2xpY2UgKHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIHN0YXJ0ID0gfn5zdGFydFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IGxlbiA6IH5+ZW5kXG5cbiAgaWYgKHN0YXJ0IDwgMCkge1xuICAgIHN0YXJ0ICs9IGxlblxuICAgIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMFxuICB9IGVsc2UgaWYgKHN0YXJ0ID4gbGVuKSB7XG4gICAgc3RhcnQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCAwKSB7XG4gICAgZW5kICs9IGxlblxuICAgIGlmIChlbmQgPCAwKSBlbmQgPSAwXG4gIH0gZWxzZSBpZiAoZW5kID4gbGVuKSB7XG4gICAgZW5kID0gbGVuXG4gIH1cblxuICBpZiAoZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgdmFyIG5ld0J1ZlxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBuZXdCdWYgPSB0aGlzLnN1YmFycmF5KHN0YXJ0LCBlbmQpXG4gICAgbmV3QnVmLl9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICB2YXIgc2xpY2VMZW4gPSBlbmQgLSBzdGFydFxuICAgIG5ld0J1ZiA9IG5ldyBCdWZmZXIoc2xpY2VMZW4sIHVuZGVmaW5lZClcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWNlTGVuOyArK2kpIHtcbiAgICAgIG5ld0J1ZltpXSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXdCdWZcbn1cblxuLypcbiAqIE5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgYnVmZmVyIGlzbid0IHRyeWluZyB0byB3cml0ZSBvdXQgb2YgYm91bmRzLlxuICovXG5mdW5jdGlvbiBjaGVja09mZnNldCAob2Zmc2V0LCBleHQsIGxlbmd0aCkge1xuICBpZiAoKG9mZnNldCAlIDEpICE9PSAwIHx8IG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdvZmZzZXQgaXMgbm90IHVpbnQnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gbGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aCcpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRMRSA9IGZ1bmN0aW9uIHJlYWRVSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRCRSA9IGZ1bmN0aW9uIHJlYWRVSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG4gIH1cblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWJ5dGVMZW5ndGhdXG4gIHZhciBtdWwgPSAxXG4gIHdoaWxlIChieXRlTGVuZ3RoID4gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDggKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIHRoaXNbb2Zmc2V0XVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2QkUgPSBmdW5jdGlvbiByZWFkVUludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgOCkgfCB0aGlzW29mZnNldCArIDFdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICgodGhpc1tvZmZzZXRdKSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikpICtcbiAgICAgICh0aGlzW29mZnNldCArIDNdICogMHgxMDAwMDAwKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdICogMHgxMDAwMDAwKSArXG4gICAgKCh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfFxuICAgIHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludExFID0gZnVuY3Rpb24gcmVhZEludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XVxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyBpXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludEJFID0gZnVuY3Rpb24gcmVhZEludEJFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoXG4gIHZhciBtdWwgPSAxXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0taV1cbiAgd2hpbGUgKGkgPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1pXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDggPSBmdW5jdGlvbiByZWFkSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICBpZiAoISh0aGlzW29mZnNldF0gJiAweDgwKSkgcmV0dXJuICh0aGlzW29mZnNldF0pXG4gIHJldHVybiAoKDB4ZmYgLSB0aGlzW29mZnNldF0gKyAxKSAqIC0xKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFID0gZnVuY3Rpb24gcmVhZEludDE2TEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRJbnQxNkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIDFdIHwgKHRoaXNbb2Zmc2V0XSA8PCA4KVxuICByZXR1cm4gKHZhbCAmIDB4ODAwMCkgPyB2YWwgfCAweEZGRkYwMDAwIDogdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyTEUgPSBmdW5jdGlvbiByZWFkSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdKSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10gPDwgMjQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiByZWFkSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDI0KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0TEUgPSBmdW5jdGlvbiByZWFkRmxvYXRMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0QkUgPSBmdW5jdGlvbiByZWFkRmxvYXRCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgZmFsc2UsIDIzLCA0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVMRSA9IGZ1bmN0aW9uIHJlYWREb3VibGVMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgNTIsIDgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUJFID0gZnVuY3Rpb24gcmVhZERvdWJsZUJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpXG59XG5cbmZ1bmN0aW9uIGNoZWNrSW50IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJidWZmZXJcIiBhcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyIGluc3RhbmNlJylcbiAgaWYgKHZhbHVlID4gbWF4IHx8IHZhbHVlIDwgbWluKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCJ2YWx1ZVwiIGFyZ3VtZW50IGlzIG91dCBvZiBib3VuZHMnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBtYXhCeXRlcyA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSAtIDFcbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBtYXhCeXRlcywgMClcbiAgfVxuXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB0aGlzW29mZnNldCArIGldID0gKHZhbHVlIC8gbXVsKSAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnRCRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBtYXhCeXRlcyA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSAtIDFcbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBtYXhCeXRlcywgMClcbiAgfVxuXG4gIHZhciBpID0gYnl0ZUxlbmd0aCAtIDFcbiAgdmFyIG11bCA9IDFcbiAgdGhpc1tvZmZzZXQgKyBpXSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoLS1pID49IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB0aGlzW29mZnNldCArIGldID0gKHZhbHVlIC8gbXVsKSAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50OCA9IGZ1bmN0aW9uIHdyaXRlVUludDggKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMSwgMHhmZiwgMClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKVxuICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICByZXR1cm4gb2Zmc2V0ICsgMVxufVxuXG5mdW5jdGlvbiBvYmplY3RXcml0ZVVJbnQxNiAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4pIHtcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmYgKyB2YWx1ZSArIDFcbiAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCAyKTsgaSA8IGo7ICsraSkge1xuICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSAmICgweGZmIDw8ICg4ICogKGxpdHRsZUVuZGlhbiA/IGkgOiAxIC0gaSkpKSkgPj4+XG4gICAgICAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSAqIDhcbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDJcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5mdW5jdGlvbiBvYmplY3RXcml0ZVVJbnQzMiAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4pIHtcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxXG4gIGZvciAodmFyIGkgPSAwLCBqID0gTWF0aC5taW4oYnVmLmxlbmd0aCAtIG9mZnNldCwgNCk7IGkgPCBqOyArK2kpIHtcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSAodmFsdWUgPj4+IChsaXR0bGVFbmRpYW4gPyBpIDogMyAtIGkpICogOCkgJiAweGZmXG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQzMkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50TEUgPSBmdW5jdGlvbiB3cml0ZUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICB2YXIgbGltaXQgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCAtIDEpXG5cbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdClcbiAgfVxuXG4gIHZhciBpID0gMFxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gMFxuICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICBpZiAodmFsdWUgPCAwICYmIHN1YiA9PT0gMCAmJiB0aGlzW29mZnNldCArIGkgLSAxXSAhPT0gMCkge1xuICAgICAgc3ViID0gMVxuICAgIH1cbiAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50QkUgPSBmdW5jdGlvbiB3cml0ZUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICB2YXIgbGltaXQgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCAtIDEpXG5cbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdClcbiAgfVxuXG4gIHZhciBpID0gYnl0ZUxlbmd0aCAtIDFcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHN1YiA9IDBcbiAgdGhpc1tvZmZzZXQgKyBpXSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoLS1pID49IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICBpZiAodmFsdWUgPCAwICYmIHN1YiA9PT0gMCAmJiB0aGlzW29mZnNldCArIGkgKyAxXSAhPT0gMCkge1xuICAgICAgc3ViID0gMVxuICAgIH1cbiAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweDdmLCAtMHg4MClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKVxuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmYgKyB2YWx1ZSArIDFcbiAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgcmV0dXJuIG9mZnNldCArIDFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHg3ZmZmLCAtMHg4MDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHg3ZmZmZmZmZiwgLTB4ODAwMDAwMDApXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuZnVuY3Rpb24gY2hlY2tJRUVFNzU0IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKVxuICBpZiAob2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG59XG5cbmZ1bmN0aW9uIHdyaXRlRmxvYXQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgNCwgMy40MDI4MjM0NjYzODUyODg2ZSszOCwgLTMuNDAyODIzNDY2Mzg1Mjg4NmUrMzgpXG4gIH1cbiAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgMjMsIDQpXG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdExFID0gZnVuY3Rpb24gd3JpdGVGbG9hdExFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVGbG9hdCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0QkUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydClcbn1cblxuZnVuY3Rpb24gd3JpdGVEb3VibGUgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgOCwgMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgsIC0xLjc5NzY5MzEzNDg2MjMxNTdFKzMwOClcbiAgfVxuICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCA1MiwgOClcbiAgcmV0dXJuIG9mZnNldCArIDhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUxFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUsIG5vQXNzZXJ0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlQkUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KVxufVxuXG4vLyBjb3B5KHRhcmdldEJ1ZmZlciwgdGFyZ2V0U3RhcnQ9MCwgc291cmNlU3RhcnQ9MCwgc291cmNlRW5kPWJ1ZmZlci5sZW5ndGgpXG5CdWZmZXIucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiBjb3B5ICh0YXJnZXQsIHRhcmdldFN0YXJ0LCBzdGFydCwgZW5kKSB7XG4gIGlmICghc3RhcnQpIHN0YXJ0ID0gMFxuICBpZiAoIWVuZCAmJiBlbmQgIT09IDApIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmICh0YXJnZXRTdGFydCA+PSB0YXJnZXQubGVuZ3RoKSB0YXJnZXRTdGFydCA9IHRhcmdldC5sZW5ndGhcbiAgaWYgKCF0YXJnZXRTdGFydCkgdGFyZ2V0U3RhcnQgPSAwXG4gIGlmIChlbmQgPiAwICYmIGVuZCA8IHN0YXJ0KSBlbmQgPSBzdGFydFxuXG4gIC8vIENvcHkgMCBieXRlczsgd2UncmUgZG9uZVxuICBpZiAoZW5kID09PSBzdGFydCkgcmV0dXJuIDBcbiAgaWYgKHRhcmdldC5sZW5ndGggPT09IDAgfHwgdGhpcy5sZW5ndGggPT09IDApIHJldHVybiAwXG5cbiAgLy8gRmF0YWwgZXJyb3IgY29uZGl0aW9uc1xuICBpZiAodGFyZ2V0U3RhcnQgPCAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3RhcmdldFN0YXJ0IG91dCBvZiBib3VuZHMnKVxuICB9XG4gIGlmIChzdGFydCA8IDAgfHwgc3RhcnQgPj0gdGhpcy5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdzb3VyY2VTdGFydCBvdXQgb2YgYm91bmRzJylcbiAgaWYgKGVuZCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdzb3VyY2VFbmQgb3V0IG9mIGJvdW5kcycpXG5cbiAgLy8gQXJlIHdlIG9vYj9cbiAgaWYgKGVuZCA+IHRoaXMubGVuZ3RoKSBlbmQgPSB0aGlzLmxlbmd0aFxuICBpZiAodGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0IDwgZW5kIC0gc3RhcnQpIHtcbiAgICBlbmQgPSB0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgKyBzdGFydFxuICB9XG5cbiAgdmFyIGxlbiA9IGVuZCAtIHN0YXJ0XG4gIHZhciBpXG5cbiAgaWYgKHRoaXMgPT09IHRhcmdldCAmJiBzdGFydCA8IHRhcmdldFN0YXJ0ICYmIHRhcmdldFN0YXJ0IDwgZW5kKSB7XG4gICAgLy8gZGVzY2VuZGluZyBjb3B5IGZyb20gZW5kXG4gICAgZm9yIChpID0gbGVuIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9IGVsc2UgaWYgKGxlbiA8IDEwMDAgfHwgIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gYXNjZW5kaW5nIGNvcHkgZnJvbSBzdGFydFxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgVWludDhBcnJheS5wcm90b3R5cGUuc2V0LmNhbGwoXG4gICAgICB0YXJnZXQsXG4gICAgICB0aGlzLnN1YmFycmF5KHN0YXJ0LCBzdGFydCArIGxlbiksXG4gICAgICB0YXJnZXRTdGFydFxuICAgIClcbiAgfVxuXG4gIHJldHVybiBsZW5cbn1cblxuLy8gVXNhZ2U6XG4vLyAgICBidWZmZXIuZmlsbChudW1iZXJbLCBvZmZzZXRbLCBlbmRdXSlcbi8vICAgIGJ1ZmZlci5maWxsKGJ1ZmZlclssIG9mZnNldFssIGVuZF1dKVxuLy8gICAgYnVmZmVyLmZpbGwoc3RyaW5nWywgb2Zmc2V0WywgZW5kXV1bLCBlbmNvZGluZ10pXG5CdWZmZXIucHJvdG90eXBlLmZpbGwgPSBmdW5jdGlvbiBmaWxsICh2YWwsIHN0YXJ0LCBlbmQsIGVuY29kaW5nKSB7XG4gIC8vIEhhbmRsZSBzdHJpbmcgY2FzZXM6XG4gIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgIGlmICh0eXBlb2Ygc3RhcnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBlbmNvZGluZyA9IHN0YXJ0XG4gICAgICBzdGFydCA9IDBcbiAgICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZW5kID09PSAnc3RyaW5nJykge1xuICAgICAgZW5jb2RpbmcgPSBlbmRcbiAgICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gICAgfVxuICAgIGlmICh2YWwubGVuZ3RoID09PSAxKSB7XG4gICAgICB2YXIgY29kZSA9IHZhbC5jaGFyQ29kZUF0KDApXG4gICAgICBpZiAoY29kZSA8IDI1Nikge1xuICAgICAgICB2YWwgPSBjb2RlXG4gICAgICB9XG4gICAgfVxuICAgIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2VuY29kaW5nIG11c3QgYmUgYSBzdHJpbmcnKVxuICAgIH1cbiAgICBpZiAodHlwZW9mIGVuY29kaW5nID09PSAnc3RyaW5nJyAmJiAhQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpXG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgdmFsID0gdmFsICYgMjU1XG4gIH1cblxuICAvLyBJbnZhbGlkIHJhbmdlcyBhcmUgbm90IHNldCB0byBhIGRlZmF1bHQsIHNvIGNhbiByYW5nZSBjaGVjayBlYXJseS5cbiAgaWYgKHN0YXJ0IDwgMCB8fCB0aGlzLmxlbmd0aCA8IHN0YXJ0IHx8IHRoaXMubGVuZ3RoIDwgZW5kKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ091dCBvZiByYW5nZSBpbmRleCcpXG4gIH1cblxuICBpZiAoZW5kIDw9IHN0YXJ0KSB7XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIHN0YXJ0ID0gc3RhcnQgPj4+IDBcbiAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgPyB0aGlzLmxlbmd0aCA6IGVuZCA+Pj4gMFxuXG4gIGlmICghdmFsKSB2YWwgPSAwXG5cbiAgdmFyIGlcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgZm9yIChpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgICAgdGhpc1tpXSA9IHZhbFxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB2YXIgYnl0ZXMgPSBCdWZmZXIuaXNCdWZmZXIodmFsKVxuICAgICAgPyB2YWxcbiAgICAgIDogdXRmOFRvQnl0ZXMobmV3IEJ1ZmZlcih2YWwsIGVuY29kaW5nKS50b1N0cmluZygpKVxuICAgIHZhciBsZW4gPSBieXRlcy5sZW5ndGhcbiAgICBmb3IgKGkgPSAwOyBpIDwgZW5kIC0gc3RhcnQ7ICsraSkge1xuICAgICAgdGhpc1tpICsgc3RhcnRdID0gYnl0ZXNbaSAlIGxlbl1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpc1xufVxuXG4vLyBIRUxQRVIgRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09XG5cbnZhciBJTlZBTElEX0JBU0U2NF9SRSA9IC9bXitcXC8wLTlBLVphLXotX10vZ1xuXG5mdW5jdGlvbiBiYXNlNjRjbGVhbiAoc3RyKSB7XG4gIC8vIE5vZGUgc3RyaXBzIG91dCBpbnZhbGlkIGNoYXJhY3RlcnMgbGlrZSBcXG4gYW5kIFxcdCBmcm9tIHRoZSBzdHJpbmcsIGJhc2U2NC1qcyBkb2VzIG5vdFxuICBzdHIgPSBzdHJpbmd0cmltKHN0cikucmVwbGFjZShJTlZBTElEX0JBU0U2NF9SRSwgJycpXG4gIC8vIE5vZGUgY29udmVydHMgc3RyaW5ncyB3aXRoIGxlbmd0aCA8IDIgdG8gJydcbiAgaWYgKHN0ci5sZW5ndGggPCAyKSByZXR1cm4gJydcbiAgLy8gTm9kZSBhbGxvd3MgZm9yIG5vbi1wYWRkZWQgYmFzZTY0IHN0cmluZ3MgKG1pc3NpbmcgdHJhaWxpbmcgPT09KSwgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHdoaWxlIChzdHIubGVuZ3RoICUgNCAhPT0gMCkge1xuICAgIHN0ciA9IHN0ciArICc9J1xuICB9XG4gIHJldHVybiBzdHJcbn1cblxuZnVuY3Rpb24gc3RyaW5ndHJpbSAoc3RyKSB7XG4gIGlmIChzdHIudHJpbSkgcmV0dXJuIHN0ci50cmltKClcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJylcbn1cblxuZnVuY3Rpb24gdG9IZXggKG4pIHtcbiAgaWYgKG4gPCAxNikgcmV0dXJuICcwJyArIG4udG9TdHJpbmcoMTYpXG4gIHJldHVybiBuLnRvU3RyaW5nKDE2KVxufVxuXG5mdW5jdGlvbiB1dGY4VG9CeXRlcyAoc3RyaW5nLCB1bml0cykge1xuICB1bml0cyA9IHVuaXRzIHx8IEluZmluaXR5XG4gIHZhciBjb2RlUG9pbnRcbiAgdmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGhcbiAgdmFyIGxlYWRTdXJyb2dhdGUgPSBudWxsXG4gIHZhciBieXRlcyA9IFtdXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIGNvZGVQb2ludCA9IHN0cmluZy5jaGFyQ29kZUF0KGkpXG5cbiAgICAvLyBpcyBzdXJyb2dhdGUgY29tcG9uZW50XG4gICAgaWYgKGNvZGVQb2ludCA+IDB4RDdGRiAmJiBjb2RlUG9pbnQgPCAweEUwMDApIHtcbiAgICAgIC8vIGxhc3QgY2hhciB3YXMgYSBsZWFkXG4gICAgICBpZiAoIWxlYWRTdXJyb2dhdGUpIHtcbiAgICAgICAgLy8gbm8gbGVhZCB5ZXRcbiAgICAgICAgaWYgKGNvZGVQb2ludCA+IDB4REJGRikge1xuICAgICAgICAgIC8vIHVuZXhwZWN0ZWQgdHJhaWxcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9IGVsc2UgaWYgKGkgKyAxID09PSBsZW5ndGgpIHtcbiAgICAgICAgICAvLyB1bnBhaXJlZCBsZWFkXG4gICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHZhbGlkIGxlYWRcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuXG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIC8vIDIgbGVhZHMgaW4gYSByb3dcbiAgICAgIGlmIChjb2RlUG9pbnQgPCAweERDMDApIHtcbiAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnRcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gdmFsaWQgc3Vycm9nYXRlIHBhaXJcbiAgICAgIGNvZGVQb2ludCA9IChsZWFkU3Vycm9nYXRlIC0gMHhEODAwIDw8IDEwIHwgY29kZVBvaW50IC0gMHhEQzAwKSArIDB4MTAwMDBcbiAgICB9IGVsc2UgaWYgKGxlYWRTdXJyb2dhdGUpIHtcbiAgICAgIC8vIHZhbGlkIGJtcCBjaGFyLCBidXQgbGFzdCBjaGFyIHdhcyBhIGxlYWRcbiAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgIH1cblxuICAgIGxlYWRTdXJyb2dhdGUgPSBudWxsXG5cbiAgICAvLyBlbmNvZGUgdXRmOFxuICAgIGlmIChjb2RlUG9pbnQgPCAweDgwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDEpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goY29kZVBvaW50KVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHg4MDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiB8IDB4QzAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDEwMDAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDMpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweEMgfCAweEUwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSA0KSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHgxMiB8IDB4RjAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweEMgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MFxuICAgICAgKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29kZSBwb2ludCcpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJ5dGVzXG59XG5cbmZ1bmN0aW9uIGFzY2lpVG9CeXRlcyAoc3RyKSB7XG4gIHZhciBieXRlQXJyYXkgPSBbXVxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkge1xuICAgIC8vIE5vZGUncyBjb2RlIHNlZW1zIHRvIGJlIGRvaW5nIHRoaXMgYW5kIG5vdCAmIDB4N0YuLlxuICAgIGJ5dGVBcnJheS5wdXNoKHN0ci5jaGFyQ29kZUF0KGkpICYgMHhGRilcbiAgfVxuICByZXR1cm4gYnl0ZUFycmF5XG59XG5cbmZ1bmN0aW9uIHV0ZjE2bGVUb0J5dGVzIChzdHIsIHVuaXRzKSB7XG4gIHZhciBjLCBoaSwgbG9cbiAgdmFyIGJ5dGVBcnJheSA9IFtdXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrXG5cbiAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSlcbiAgICBoaSA9IGMgPj4gOFxuICAgIGxvID0gYyAlIDI1NlxuICAgIGJ5dGVBcnJheS5wdXNoKGxvKVxuICAgIGJ5dGVBcnJheS5wdXNoKGhpKVxuICB9XG5cbiAgcmV0dXJuIGJ5dGVBcnJheVxufVxuXG5mdW5jdGlvbiBiYXNlNjRUb0J5dGVzIChzdHIpIHtcbiAgcmV0dXJuIGJhc2U2NC50b0J5dGVBcnJheShiYXNlNjRjbGVhbihzdHIpKVxufVxuXG5mdW5jdGlvbiBibGl0QnVmZmVyIChzcmMsIGRzdCwgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIGlmICgoaSArIG9mZnNldCA+PSBkc3QubGVuZ3RoKSB8fCAoaSA+PSBzcmMubGVuZ3RoKSkgYnJlYWtcbiAgICBkc3RbaSArIG9mZnNldF0gPSBzcmNbaV1cbiAgfVxuICByZXR1cm4gaVxufVxuXG5mdW5jdGlvbiBpc25hbiAodmFsKSB7XG4gIHJldHVybiB2YWwgIT09IHZhbCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXNlbGYtY29tcGFyZVxufVxuIiwiZXhwb3J0cy5yZWFkID0gZnVuY3Rpb24gKGJ1ZmZlciwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHtcbiAgdmFyIGUsIG1cbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBuQml0cyA9IC03XG4gIHZhciBpID0gaXNMRSA/IChuQnl0ZXMgLSAxKSA6IDBcbiAgdmFyIGQgPSBpc0xFID8gLTEgOiAxXG4gIHZhciBzID0gYnVmZmVyW29mZnNldCArIGldXG5cbiAgaSArPSBkXG5cbiAgZSA9IHMgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgcyA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gZUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBlID0gZSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fVxuXG4gIG0gPSBlICYgKCgxIDw8ICgtbkJpdHMpKSAtIDEpXG4gIGUgPj49ICgtbkJpdHMpXG4gIG5CaXRzICs9IG1MZW5cbiAgZm9yICg7IG5CaXRzID4gMDsgbSA9IG0gKiAyNTYgKyBidWZmZXJbb2Zmc2V0ICsgaV0sIGkgKz0gZCwgbkJpdHMgLT0gOCkge31cblxuICBpZiAoZSA9PT0gMCkge1xuICAgIGUgPSAxIC0gZUJpYXNcbiAgfSBlbHNlIGlmIChlID09PSBlTWF4KSB7XG4gICAgcmV0dXJuIG0gPyBOYU4gOiAoKHMgPyAtMSA6IDEpICogSW5maW5pdHkpXG4gIH0gZWxzZSB7XG4gICAgbSA9IG0gKyBNYXRoLnBvdygyLCBtTGVuKVxuICAgIGUgPSBlIC0gZUJpYXNcbiAgfVxuICByZXR1cm4gKHMgPyAtMSA6IDEpICogbSAqIE1hdGgucG93KDIsIGUgLSBtTGVuKVxufVxuXG5leHBvcnRzLndyaXRlID0gZnVuY3Rpb24gKGJ1ZmZlciwgdmFsdWUsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7XG4gIHZhciBlLCBtLCBjXG4gIHZhciBlTGVuID0gbkJ5dGVzICogOCAtIG1MZW4gLSAxXG4gIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxXG4gIHZhciBlQmlhcyA9IGVNYXggPj4gMVxuICB2YXIgcnQgPSAobUxlbiA9PT0gMjMgPyBNYXRoLnBvdygyLCAtMjQpIC0gTWF0aC5wb3coMiwgLTc3KSA6IDApXG4gIHZhciBpID0gaXNMRSA/IDAgOiAobkJ5dGVzIC0gMSlcbiAgdmFyIGQgPSBpc0xFID8gMSA6IC0xXG4gIHZhciBzID0gdmFsdWUgPCAwIHx8ICh2YWx1ZSA9PT0gMCAmJiAxIC8gdmFsdWUgPCAwKSA/IDEgOiAwXG5cbiAgdmFsdWUgPSBNYXRoLmFicyh2YWx1ZSlcblxuICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlID09PSBJbmZpbml0eSkge1xuICAgIG0gPSBpc05hTih2YWx1ZSkgPyAxIDogMFxuICAgIGUgPSBlTWF4XG4gIH0gZWxzZSB7XG4gICAgZSA9IE1hdGguZmxvb3IoTWF0aC5sb2codmFsdWUpIC8gTWF0aC5MTjIpXG4gICAgaWYgKHZhbHVlICogKGMgPSBNYXRoLnBvdygyLCAtZSkpIDwgMSkge1xuICAgICAgZS0tXG4gICAgICBjICo9IDJcbiAgICB9XG4gICAgaWYgKGUgKyBlQmlhcyA+PSAxKSB7XG4gICAgICB2YWx1ZSArPSBydCAvIGNcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUgKz0gcnQgKiBNYXRoLnBvdygyLCAxIC0gZUJpYXMpXG4gICAgfVxuICAgIGlmICh2YWx1ZSAqIGMgPj0gMikge1xuICAgICAgZSsrXG4gICAgICBjIC89IDJcbiAgICB9XG5cbiAgICBpZiAoZSArIGVCaWFzID49IGVNYXgpIHtcbiAgICAgIG0gPSAwXG4gICAgICBlID0gZU1heFxuICAgIH0gZWxzZSBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIG0gPSAodmFsdWUgKiBjIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IGUgKyBlQmlhc1xuICAgIH0gZWxzZSB7XG4gICAgICBtID0gdmFsdWUgKiBNYXRoLnBvdygyLCBlQmlhcyAtIDEpICogTWF0aC5wb3coMiwgbUxlbilcbiAgICAgIGUgPSAwXG4gICAgfVxuICB9XG5cbiAgZm9yICg7IG1MZW4gPj0gODsgYnVmZmVyW29mZnNldCArIGldID0gbSAmIDB4ZmYsIGkgKz0gZCwgbSAvPSAyNTYsIG1MZW4gLT0gOCkge31cblxuICBlID0gKGUgPDwgbUxlbikgfCBtXG4gIGVMZW4gKz0gbUxlblxuICBmb3IgKDsgZUxlbiA+IDA7IGJ1ZmZlcltvZmZzZXQgKyBpXSA9IGUgJiAweGZmLCBpICs9IGQsIGUgLz0gMjU2LCBlTGVuIC09IDgpIHt9XG5cbiAgYnVmZmVyW29mZnNldCArIGkgLSBkXSB8PSBzICogMTI4XG59XG4iLCJ2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcblxubW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChhcnIpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwoYXJyKSA9PSAnW29iamVjdCBBcnJheV0nO1xufTtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5cbmxldCBSZXN1bHRTdGF0dXMgPSB7XG4gIFdJTjogMixcbiAgRFJBVzogMSxcbiAgTE9TRTogMCxcbn07XG5cblxubGV0IEdhbWVSZXN1bHQgPSBjYy5DbGFzcyh7XG4gIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICBwcm9wZXJ0aWVzOiB7XG4gICAgd2luTm9kZTogY2MuTm9kZSxcbiAgICBsb3NlTm9kZTogY2MuTm9kZSxcbiAgICBkcmF3Tm9kZTogY2MuTm9kZSxcbiAgICBjb250ZW50Tm9kZTogY2MuTm9kZSxcblxuICAgIHJlc3VsdEl0ZW1zOiBbY2MuTm9kZV0sXG5cbiAgICBfZGVza0luZm86IG51bGwsXG4gICAgX3VzZXJJZDogbnVsbCxcbiAgICBfY2xvc2VDYWxsYmFjazogbnVsbCxcbiAgfSxcblxuICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5faGlkZVJlc3VsdEl0ZW1zKCk7XG4gIH0sXG5cbiAgc2hvd1Jlc3VsdHM6IGZ1bmN0aW9uIChkZXNrSW5mbywgY3VycmVudFVzZXJJZCkge1xuICAgIHRoaXMuX2Rlc2tJbmZvID0gZGVza0luZm87XG4gICAgdGhpcy5fdXNlcklkID0gY3VycmVudFVzZXJJZDtcblxuICAgIGxldCByZXN1bHRTdGF0dXMgPSB0aGlzLl9yZXN1bHRTdGF0dXMoKTtcbiAgICB0aGlzLmNvbnRlbnROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgdGhpcy53aW5Ob2RlLmFjdGl2ZSA9ICAocmVzdWx0U3RhdHVzID09IFJlc3VsdFN0YXR1cy5XSU4pO1xuICAgIHRoaXMuZHJhd05vZGUuYWN0aXZlID0gKHJlc3VsdFN0YXR1cyA9PSBSZXN1bHRTdGF0dXMuRFJBVyk7XG4gICAgdGhpcy5sb3NlTm9kZS5hY3RpdmUgPSAocmVzdWx0U3RhdHVzID09IFJlc3VsdFN0YXR1cy5MT1NFKTtcblxuICAgIGlmICh0aGlzLndpbk5vZGUuYWN0aXZlKSB7XG4gICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVdpbigpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5sb3NlTm9kZS5hY3RpdmUpIHtcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5TG9zZSgpO1xuICAgIH1cblxuICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnNldERpc21pc3NDYWxsYmFjayhmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9jbG9zZUNhbGxiYWNrXG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIGxldCBwbGF5ZXJJbmZvcyA9IGRlc2tJbmZvLnBsYXllcnMuc29ydChmdW5jdGlvbiAocDEsIHAyKSB7XG4gICAgICByZXR1cm4gcDIuY1Njb3JlIC0gcDEuY1Njb3JlO1xuICAgIH0pO1xuICAgIGxldCBpdGVtQ29tcHMgPSB0aGlzLnJlc3VsdEl0ZW1zLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgcmV0dXJuIG5vZGUuZ2V0Q29tcG9uZW50KCdSZXN1bHRJdGVtJyk7XG4gICAgfSk7XG4gICAgaXRlbUNvbXBzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW1Db21wLCBpbmRleCkge1xuICAgICAgaXRlbUNvbXAubm9kZS5hY3RpdmUgPSBpbmRleCA8IHBsYXllckluZm9zLmxlbmd0aDtcbiAgICAgIGlmICghaXRlbUNvbXAubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlciA9IHBsYXllckluZm9zW2luZGV4XTtcbiAgICAgIGl0ZW1Db21wLnVwZGF0ZVdpdGhQbGF5ZXJJbmZvKHVzZXIsIGRlc2tJbmZvLmlzUmFuZG9tRGVzayk7XG4gICAgICBsZXQgY2FyZHMgPSB0aGlzLl9jYXJkc0Zyb21Vc2VyKHVzZXIpO1xuICAgICAgaXRlbUNvbXAuc2V0Q2FyZHMoY2FyZHMpO1xuICAgIH0uYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgc2V0Q2xvc2VDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5fY2xvc2VDYWxsYmFjayA9IGNhbGxiYWNrO1xuICB9LFxuXG4gIF9jYXJkc0Zyb21Vc2VyOiBmdW5jdGlvbiAodXNlcikge1xuICAgIGxldCBjYXJkcyA9IHVzZXIuY2FyZEluZm8ubWFwKGZ1bmN0aW9uIChjYXJkSW5mb0l0ZW0pIHtcbiAgICAgIHJldHVybiBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZEluZm9JdGVtLmNhcmRzKTtcbiAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge1xuICAgICAgcmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7XG4gICAgfSwgW10pO1xuXG4gICAgcmV0dXJuIGNhcmRzO1xuICB9LFxuXG4gIF9oaWRlUmVzdWx0SXRlbXM6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnJlc3VsdEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIG5vZGUuYWNpdHZlID0gZmFsc2U7XG4gICAgfSk7XG4gIH0sXG5cbiAgX3Jlc3VsdFN0YXR1czogZnVuY3Rpb24oKSB7XG4gICAgbGV0IHBsYXllckluZm9zID0gdGhpcy5fZGVza0luZm8ucGxheWVycztcbiAgICBsZXQgdXNlciA9IHBsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgIHJldHVybiB1c2VyLmlkID09IHRoaXMuX3VzZXJJZDtcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgbGV0IHNjb3JlID0gdXNlci5jU2NvcmU7XG4gICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmlzUmFuZG9tRGVzaykge1xuICAgICAgLy8g5aaC5p6c5piv6ZqP5py65Zy655qE6K+d77yM5bqU6K+l55So6ZK755+z5p2l5Yik5pat6L6T6LWiXG4gICAgICBzY29yZSA9IHVzZXIuZGlhbW9uZDtcbiAgICB9XG5cbiAgICBpZiAoc2NvcmUgPiAwKSB7XG4gICAgICByZXR1cm4gUmVzdWx0U3RhdHVzLldJTjtcbiAgICB9IGVsc2UgaWYgKHNjb3JlIDwgMCkge1xuICAgICAgcmV0dXJuIFJlc3VsdFN0YXR1cy5MT1NFO1xuICAgIH1cblxuICAgIHJldHVybiBSZXN1bHRTdGF0dXMuRFJBVztcbiAgfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVSZXN1bHQ7XG4iLCIvKiMjIyMjKi9cclxuLy/vv73vv73vv73vv73vv73vv73vv73vv73Su++/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/vdq177+977+977+9zazvv73vv73vv73vv73vv73vv73vv73Gte+/ve+/ve+/ve+/ve+/vVxyXG4gdmFyIEdldENhcmRQb2ludHNTYW1lQ291bnQgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIHRoaXMuY2FyZE51bWJlcnMgPSB7fTtcclxuICAgIGZvcih2YXIgaSBpbiBjYXJkcyl7XHJcbiAgICAgICAgdmFyIHM7XHJcbiAgICAgICAgaWYodHlwZW9mKGNhcmRzW2ldLm51bWJlcikgPT0gJ3VuZGVmaW5lZCcpe1xyXG4gICAgICAgICAgICBzID0gY2FyZHNbaV0ucG9pbnQ7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHMgPSBjYXJkc1tpXS5udW1iZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuY2FyZE51bWJlcnNbc10pe1xyXG4gICAgICAgICAgICB0aGlzLmNhcmROdW1iZXJzW3NdICsrO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLmNhcmROdW1iZXJzW3NdID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy9jYy5sb2codGhpcy5jYXJkTnVtYmVyc1tjYXJkc1tpXS5udW1iZXJdKVxyXG4gICAgICAgIC8vY2MubG9nKGNhcmRzKVxyXG4gICAgICAgIC8vY2MubG9nKGNhcmRzW2ldLm51bWJlcilcclxuICAgICAgICAvL2NjLmxvZygnLS0tNycpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5jYXJkTnVtYmVycztcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR2V0Q2FyZFBvaW50c1NhbWVDb3VudDtcclxuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYWJlbE51bWJlcnM6IFtjYy5MYWJlbF0sXG4gICAgICAgIGNhbGxiYWNrSm9pblJvb206IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jbGlja0NsZWFyKCk7XG4gICAgfSxcblxuICAgIGNsaWNrTnVtYmVyOiBmdW5jdGlvbiAoZXZlbnQsIG51bWJlcikge1xuICAgICAgdmFyIGxhYmVsID0gdGhpcy5fbGFzdEVtcHR5TGFiZWwoKTtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBudW1iZXI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBsZXQgaXNDb21wbGV0ZSA9ICh0aGlzLl9sYXN0RW1wdHlMYWJlbCgpID09IG51bGwpO1xuICAgICAgbGV0IGludml0ZU51bWJlciA9IHRoaXMuX3Jvb21OdW1iZXIoKTtcbiAgICAgIGlmIChpbnZpdGVOdW1iZXIubGVuZ3RoID09IDYpIHtcbiAgICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tID0gaW52aXRlTnVtYmVyO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBzZW5kQ29kZSA6ZnVuY3Rpb24oKXsgIC8v5Y+R6YCB6YKA6K+356CBXG4gICAgICBsZXQgdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgbGV0IGludml0ZU51bWJlciA9IHRoaXMuY2FsbGJhY2tKb2luUm9vbTtcbiAgICAgIGNvbnNvbGUubG9nKGludml0ZU51bWJlciAsXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cIik7XG4gICAgICBpZiggaW52aXRlTnVtYmVyLmxlbmd0aD09Nil7ICBcbiAgICAgICAgU29ja2V0LnNlbmRJbnZpdGVDb2RlKGludml0ZU51bWJlciwgdXNlcklkKTtcbiAgICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tID0gJyc7ICAgLy/muIXnqbrpgoDor7fnoIFcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xpY2tDbGVhcjogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tID0gJyc7XG4gICAgICB0aGlzLmxhYmVsTnVtYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGNsaWNrRGVsZXRlT25lOiBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgbGFiZWwgPSB0aGlzLl9sYXN0TnVtYmVyTGFiZWwoKTtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBfbGFzdEVtcHR5TGFiZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGluZGV4IGluIHRoaXMubGFiZWxOdW1iZXJzKSB7XG4gICAgICAgIHZhciBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyA9PSBudWxsXG4gICAgICAgIHx8IGxhYmVsLnN0cmluZy5sZW5ndGggPD0gMCkge1xuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9sYXN0TnVtYmVyTGFiZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGluZGV4ID0gdGhpcy5sYWJlbE51bWJlcnMubGVuZ3RoIC0gMTsgaW5kZXggPj0gMDsgLS1pbmRleCkge1xuICAgICAgICBsZXQgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgJiYgbGFiZWwuc3RyaW5nLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9yb29tTnVtYmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5sYWJlbE51bWJlcnMucmVkdWNlKGZ1bmN0aW9uIChyb29tTnVtYmVyLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gcm9vbU51bWJlciArIChsYWJlbC5zdHJpbmcgfHwgXCJcIik7XG4gICAgICB9LCBcIlwiKTtcbiAgICB9LFxufSk7XG4iLCJ2YXIgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHJvb21pZFN0cjoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2FtZXR5cGVTdHI6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHBsYXllcm51bVN0cjoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYnRuX3lhb3Fpbmc6e1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5CdXR0b25cclxuICAgICAgICB9LFxyXG4gICAgICAgIGJ0bl9qaW5ydTp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkJ1dHRvblxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaXRlbUlEOiAwXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgIC8vdGhpcy5ub2RlLm9uKCd0b3VjaGVuZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgLy8gICAgY29uc29sZS5sb2coXCJJdGVtIFwiICsgdGhpcy5pdGVtSUQgKyAnIGNsaWNrZWQnKTtcclxuICAgICAgICAgLy99LCB0aGlzKTtcclxuICAgICAgICAgLy9cclxuICAgICAgICAgLy90aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XHJcblxyXG4gICAgIH0sXHJcblxyXG5cclxuICAgIHVwZGF0ZUl0ZW06IGZ1bmN0aW9uKGVhY2hMaXN0KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCLlkITkuKrku6PlvIDmiL/nmoTmlbDmja7vvJpcIiArIEpTT04uc3RyaW5naWZ5KGVhY2hMaXN0KSk7XHJcbiAgICAgICAgdGhpcy5pdGVtSUQgPSBlYWNoTGlzdC5pZDtcclxuICAgICAgICAvL3RoaXMuZ2FtZXR5cGVTdHIuc3RyaW5nID0gIGVhY2hMaXN0LmdhbWVUeXBlO1xyXG4gICAgICAgIHRoaXMuZ2FtZXR5cGVTdHIuc3RyaW5nID1cIuWNgeS4ieawtFwiO1xyXG4gICAgICAgICAgICB0aGlzLnJvb21pZFN0ci5zdHJpbmcgPSAgZWFjaExpc3Qucm9vbUlkO1xyXG4gICAgICAgIC8vdGhpcy5wbGF5ZXJudW1TdHIuc3RyaW5nID0gIGVhY2hMaXN0LmNyZWF0ZVVzZXJJZDtcclxuICAgICAgICB0aGlzLnBsYXllcm51bVN0ci5zdHJpbmcgPSAgMDtcclxuICAgIH0sXHJcblxyXG4gICAgamlucnVSb29tOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcclxuXHJcbiAgICAgICAgdmFyIGludml0ZU51bWJlciA9IHBhcnNlSW50KHRoaXMucm9vbWlkU3RyLnN0cmluZyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coaW52aXRlTnVtYmVyLCBcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVwiKTtcclxuICAgICAgICBjb25zb2xlLmxvZyh1c2VySWQsIFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXCIpO1xyXG4gICAgICAgIGlmIChpbnZpdGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLyrliqDlhaXmiL/pl7Tor7fmsYIqL1xyXG4gICAgICAgICAgICAvL3ZhciB1c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kSm9pbkRlc2soaW52aXRlTnVtYmVyLCBwYXJzZUludCh0aGlzLnBsYXllcm51bVN0ci5zdHJpbmcpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xyXG4iLCIvLyDniYzoirHoibLluK7liqnnsbtcbi8vIOeUqOS6juiuoeeul+S4gOS4queJjOaVsOe7hOeahOiKseiJsuebuOWQjOeahOeJjOeahOW8oOaVsFxudmFyIEtRQ2FyZENvbG9yc0hlbHBlciA9IGZ1bmN0aW9uIChjYXJkcykge1xuICB0aGlzLmNvbG9yTnVtYmVyID0ge307XG5cbiAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xuICAgIGxldCBjb2xvciA9IGNhcmQuY29sb3I7XG4gICAgdmFyIG51bWJlciA9IHRoaXMuY29sb3JOdW1iZXJbY29sb3JdIHx8IDA7XG4gICAgdGhpcy5jb2xvck51bWJlcltjb2xvcl0gPSBudW1iZXIgKyAxO1xuICB9LmJpbmQodGhpcykpO1xufTtcblxuLy8g55u45ZCM6Iqx6Imy55qE54mM55qE5pyA5aSn5pWw6YePXG5LUUNhcmRDb2xvcnNIZWxwZXIucHJvdG90eXBlLm1heE51bWJlciA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHJlc3VsdCA9IDA7XG4gIGZvciAobGV0IHByb3AgaW4gdGhpcy5jb2xvck51bWJlcikge1xuICAgIGxldCBudW1iZXIgPSB0aGlzLmNvbG9yTnVtYmVyW3Byb3BdO1xuICAgIHJlc3VsdCA9IE1hdGgubWF4KG51bWJlciwgcmVzdWx0KTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEtRQ2FyZENvbG9yc0hlbHBlcjtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY29uc3QgQXJyYXlFeHRlbnNpb24gPSByZXF1aXJlKCdBcnJheUV4dGVuc2lvbicpO1xuY29uc3QgS1FDYXJkUG9pbnRzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUG9pbnRzSGVscGVyJyk7XG5cbm1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIOWvu+aJviBjYXJkTW9kZXMg5Lit55qEIOWvueWtkFxuLy8g6L+Z5Lya6L+U5ZueIOWvueWtkCDnmoTntKLlvJXmlbDnu4Rcbi8vIOWmgu+8mltbMSwgM10sIFs0LCA1XV1cbktRQ2FyZC5maW5kRHVpWmkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGxldCBzRHVpWmlJbmRleHMgPSBLUUNhcmQuZmluZFNhblRpYW8oY2FyZE1vZGVzKSB8fCBbXTtcbiAgbGV0IHJlc3VsdCA9IEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgMikgfHwgW107XG4gIGlmKHJlc3VsdC5sZW5ndGggPCAyICl7XG4gICAgaWYoc0R1aVppSW5kZXhzLmxlbmd0aCA+IDApe1xuICAgICAgc0R1aVppSW5kZXhzLmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XG4gICAgICAgIHZhciBzMSA9IFtpbmRleHNbMF0saW5kZXhzWzFdXTtcbiAgICAgICAgLy92YXIgczIgPSBbaW5kZXhzWzFdLGluZGV4c1syXV07XG4gICAgICAgIC8vcmVzdWx0LnB1c2goczIpO1xuICAgICAgICByZXN1bHQucHVzaChzMSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdmFyIHRyZXN1bHQgPSBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMik7XG4gICAgZm9yKHZhciBpID0gMDtpIDwgdHJlc3VsdC5sZW5ndGg7aSsrKXtcbiAgICAgIHJlc3VsdC5wdXNoKHRyZXN1bHRbaV0pO1xuICAgIH1cbiAgfVxuXG4gIHJlc3VsdCA9IEtRQ2FyZC5yZXBlYXQocmVzdWx0KTtcblxuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBbXTtcbn07XG5cbktRQ2FyZC5fZmluZFBvaW50TGVuZ3RoID0gZnVuY3Rpb24gKGNhcmRNb2RlcywgbGVuZ3RoKSB7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgbGV0IG9iaiA9IGNhcmRNb2Rlcy5yZWR1Y2UoZnVuY3Rpb24ob2JqLCBjYXJkLCBpbmRleCkge1xuICAgIGxldCBwb2ludEluZGV4cyA9IG9ialtjYXJkLnBvaW50XSB8fCBbXTtcbiAgICBvYmpbY2FyZC5wb2ludF0gPSBwb2ludEluZGV4cztcbiAgICBwb2ludEluZGV4cy5wdXNoKGluZGV4KTtcbiAgICByZXR1cm4gb2JqO1xuICB9LCB7fSk7XG5cbiAgbGV0IHJlc3VsdCA9IFtdO1xuICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgIGxldCBwb2ludEluZGV4cyA9IG9ialtwcm9wXTtcbiAgICAvLyBpZiAocG9pbnRJbmRleHMubGVuZ3RoID09IGxlbmd0aCkge1xuICAgIC8vICAgcG9pbnRJbmRleHMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgLy8gICAgIHJldHVybiBuMSAtIG4yO1xuICAgIC8vICAgfSk7XG4gICAgLy8gICByZXN1bHQucHVzaChwb2ludEluZGV4cyk7XG4gICAgLy8gfVxuICAgIHdoaWxlKHBvaW50SW5kZXhzLmxlbmd0aCA+PSBsZW5ndGggJiYgbGVuZ3RoICE9IDApey8v5pyJ5aSa55qE5YiG5Ymy5aSa5Liq5pWw57uEXG4gICAgICB2YXIgc3BsaWNlcyA9IHBvaW50SW5kZXhzLnNwbGljZSgwLGxlbmd0aCk7XG4gICAgICBpZiAoc3BsaWNlcy5sZW5ndGggPj0gbGVuZ3RoKXtcbiAgICAgICAgc3BsaWNlcy5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgfSk7XG4gICAgICAgIHJlc3VsdC5wdXNoKHNwbGljZXMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJlc3VsdC5zb3J0KGZ1bmN0aW9uIChhcnIxLCBhcnIyKSB7XG4gICAgbGV0IG4xID0gYXJyMVswXTtcbiAgICBsZXQgbjIgPSBhcnIyWzBdO1xuICAgIHJldHVybiBuMiAtIG4xO1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XG59O1xuXG4vLyDmib4g5Lik5a+5IOeahOe0ouW8leaVsOe7hFxuLy8g5aaC77yaW1sxLCAyLCAzLCA0XSwgWzUsIDYsIDcsIDhdXVxuS1FDYXJkLmZpbmRMaWFEdWkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGxldCBkdWlaaUluZGV4cyA9IEtRQ2FyZC5maW5kRHVpWmkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgbGV0IGR1aVppSW5kZXggPSBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMikgfHwgW107XG5cbiAgaWYoZHVpWmlJbmRleHMubGVuZ3RoIDwgMSAmJiBkdWlaaUluZGV4Lmxlbmd0aCA+IDApe1xuICAgIGR1aVppSW5kZXguZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgZHVpWmlJbmRleHMudW5zaGlmdChpbmRleHMpO1xuICAgIH0pO1xuICB9XG4gIGlmIChkdWlaaUluZGV4cy5sZW5ndGggPCAyKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgbGV0IHJlc3VsdCA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGR1aVppSW5kZXhzLmxlbmd0aDsgKytpKSB7XG4gICAgZm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgZHVpWmlJbmRleHMubGVuZ3RoOyArK2opIHtcbiAgICAgIGlmKHJlc3VsdC5sZW5ndGggPCAxMCl7XG4gICAgICAgIGxldCBwcmUgPSBkdWlaaUluZGV4c1tpXTtcbiAgICAgICAgbGV0IG5leHQgPSBkdWlaaUluZGV4c1tqXTtcbiAgICAgICAgdmFyIHMgPSBwcmUuY29uY2F0KG5leHQpO1xuICAgICAgICB2YXIgbmV3UyA9IFtdO1xuICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBzLmxlbmd0aCA7cSsrKXtcbiAgICAgICAgICBpZihuZXdTLmluZGV4T2Yoc1txXSkgPT0gLTEpe1xuICAgICAgICAgICAgbmV3Uy5wdXNoKHNbcV0pO1xuICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKG5ld1MubGVuZ3RoID09IDQpe1xuICAgICAgICAgIG5ld1Muc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXN1bHQudW5zaGlmdChuZXdTKTtcbiAgICAgICAgfVxuICAgICAgfWVsc2V7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG5cbiAgICB9XG4gIH1cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpO1xuICBpZihyZXN1bHQubGVuZ3RoID4gNil7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsNik7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8vIOaJvuS4ieadoVxuLy8g5aaC77yaW1sxLCAyLCAzXV07XG5LUUNhcmQuZmluZFNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGlmKGNhcmRNb2Rlcy5sZW5ndGggPCAzKXtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgbGV0IHJlc3VsdCA9IEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgMykgfHwgW107XG4gIC8vZm9yKHZhciBxID0wO3E8cmVzdWx0Lmxlbmd0aDtxKyspe1xuICAvLyAgdmFyIGluZGV4cyA9IHJlc3VsdFtxXVswXTtcbiAgLy8gIGlmKGNhcmRNb2Rlc1tpbmRleHNdLnBvaW50ID49IDIwKXtcbiAgLy8gICAgcmVzdWx0LnNwbGljZShxLDEpO1xuICAvLyAgfVxuICAvL31cbiAgaWYocmVzdWx0Lmxlbmd0aCA8IDIgKXtcbiAgICBsZXQgdGllWmhpSW5kZXhzQXJyYXkgPSBLUUNhcmQuZmluZFRpZVpoaShjYXJkTW9kZXMpO1xuICAgIGlmKHRpZVpoaUluZGV4c0FycmF5Lmxlbmd0aCA+IDApe1xuICAgICAgdGllWmhpSW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czEgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbM11dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMF0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgICByZXN1bHQucHVzaChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMyKTtcbiAgICAgICAgLy9yZXN1bHQudW5zaGlmdChzYW5UaWFvSW5kZXhzMyk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdmFyIHRyZXN1bHQgPSBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMyk7XG4gICAgZm9yKHZhciBpID0gMDtpIDwgdHJlc3VsdC5sZW5ndGg7aSsrKXtcbiAgICAgIHJlc3VsdC5wdXNoKHRyZXN1bHRbaV0pO1xuICAgIH1cbiAgfVxuICAvKmlmKHJlc3VsdC5sZW5ndGggPCAxKXtcbiAgICAvLyDpk4HmlK/mmK/ljIXlkKvkuInmnaHnmoRcbiAgICBsZXQgdGllWmhpSW5kZXhzQXJyYXkgPSBLUUNhcmQuZmluZFRpZVpoaShjYXJkTW9kZXMpO1xuICAgIGlmICh0aWVaaGlJbmRleHNBcnJheSkge1xuICAgICAgdGllWmhpSW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czEgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbM11dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMF0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgICByZXN1bHQucHVzaChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMyKTtcbiAgICAgICAgLy9yZXN1bHQudW5zaGlmdChzYW5UaWFvSW5kZXhzMyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0qL1xuXG4gIC8vaWYocmVzdWx0Lmxlbmd0aCA+IDEwKXtcbiAgLy8gIHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLDEwKTtcbiAgLy99XG5cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpO1xuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBbXTtcbn07XG5cbi8vIOaJvuWQjOiKsemhulxuLypLUUNhcmQuZmluZFRvbmdIdWFTaHVuID0gZnVuY3Rpb24gKGNhcmRNb2RlcywgbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBsZXQgcmVzdWx0ID0gW107XG4gIHZhciBzYW5TaHVuWmkgPSBLUUNhcmQuc2FuU2h1blppMShjYXJkTW9kZXMsbGVuZ3RoKTtcbiAgaWYoc2FuU2h1blppWzBdID09IG51bGwpe1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBmb3IodmFyIGk9MDtpPHNhblNodW5aaVswXS5sZW5ndGg7aSsrKSB7XG4gICAgdmFyIHMgPSBzYW5TaHVuWmlbMF1baV07XG4gICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHMsIGxlbmd0aCkpIHtcbiAgICAgIHJlc3VsdC51bnNoaWZ0KHNhblNodW5aaVsxXVtpXSk7XG5cbiAgICB9XG4gIH1cbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xuICAgIHJldHVybiByZXN1bHRcbiAgfWVsc2V7XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4xKGNhcmRNb2Rlcyk7XG4gIH1cbn07Ki9cbktRQ2FyZC5maW5kVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAoY2FyZHMsIGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xuICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgdmFyIGNvbG9yQyA9IFtdOyAvL+aiheiKsVxuICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gIHZhciBwb2ludFMgPSBbXTsgLy/pu5HmoYNcbiAgdmFyIHBvaW50SCA9IFtdOyAvL+e6ouW/g1xuICB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXG4gIHZhciBwb2ludEQgPSBbXTsgLy/mlrnlnZdcbiAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICBpZihjYXJkc1tpXS5jb2xvciA9PSAnNCcpe1xuICAgICAgaWYocG9pbnRTLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRTLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG5cbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMycpe1xuICAgICAgaWYocG9pbnRILmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRILnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzInKXtcbiAgICAgIGlmKHBvaW50Qy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50Qy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcxJyl7XG4gICAgICBpZihwb2ludEQuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludEQucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgY29sb3IgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcbiAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgaWYoY29sb3JbaV0ubGVuZ3RoID49IDUpe1xuICAgICAgY29sb3JbaV0uc29ydChmdW5jdGlvbihhMSxhMil7XG4gICAgICAgIHJldHVybiBhMS5wb2ludCAtIGEyLnBvaW50O1xuICAgICAgfSlcbiAgICAgIGNvbG9yU3VtLnB1c2goY29sb3JbaV0pO1xuICAgIH1cbiAgfVxuICB2YXIgcmVzdWx0ID0gW107XG4gIGZvcih2YXIgaT0wO2k8Y29sb3JTdW0ubGVuZ3RoO2krKykge1xuICAgIHZhciBzID0gY29sb3JTdW1baV1cbiAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIDUpIDw9IHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICB2YXIgc3ViQ2FyZHMgPSBzLnNsaWNlKHN0YXJ0LCBzdGFydCArIDUpO1xuICAgICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHN1YkNhcmRzKSkge1xuICAgICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2EpIHtcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkcy5sZW5ndGg7IHErKyl7XG4gICAgICAgICAgICB2YXIgciA9IGNhcmRzW3FdO1xuICAgICAgICAgICAgaWYociA9PT0gY2Epe1xuICAgICAgICAgICAgICBpbmRleHMucHVzaChxKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaW5kZXhzLnNvcnQoQXJyYXkuc29ydEJ5UG9pbnQpO1xuICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmKHJlc3VsdC5sZW5ndGggPiAwKXtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9ZWxzZXtcbiAgICBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRzKTtcbiAgICBpZiAoY2FyZHMgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGFkZnMpe1xuICAgICAgICBpZihhZGZzLnBvaW50ID09IDE0KXtcbiAgICAgICAgICBhZGZzLnBvaW50ID0gMTtcbiAgICAgICAgICBhZGZzLnNjb3JlcyA9IDE7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bjIwKGNhcmRzKTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4oY29udmVydGVkQ2FyZHMpO1xuICB9XG4gIC8vcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogbnVsbDtcbn07XG5LUUNhcmQuZmluZFRvbmdIdWFTaHVuMjAgPSBmdW5jdGlvbiAoY2FyZCwgbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZC5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZCkgfHwgW107XG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHZhciBjYXJkcyA9IGNhcmQua3FfZXhjbHVkZXMoY2FyZDIwKTtcblxuICBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xuICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgdmFyIGNvbG9yQyA9IFtdOyAvL+aiheiKsVxuICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gIHZhciBwb2ludFMgPSBbXTsgLy/pu5HmoYNcbiAgdmFyIHBvaW50SCA9IFtdOyAvL+e6ouW/g1xuICB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXG4gIHZhciBwb2ludEQgPSBbXTsgLy/mlrnlnZdcbiAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICBpZihjYXJkc1tpXS5jb2xvciA9PSAnNCcpe1xuICAgICAgaWYocG9pbnRTLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRTLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG5cbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMycpe1xuICAgICAgaWYocG9pbnRILmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRILnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzInKXtcbiAgICAgIGlmKHBvaW50Qy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50Qy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcxJyl7XG4gICAgICBpZihwb2ludEQuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludEQucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgY29sb3IgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcbiAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgaWYoY29sb3JbaV0ubGVuZ3RoID49IHBhcnNlSW50KDUgLSBjYXJkMjAubGVuZ3RoKSl7XG4gICAgICBjb2xvcltpXS5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiAgICAgICAgcmV0dXJuIGExLnBvaW50IC0gYTIucG9pbnQ7XG4gICAgICB9KVxuICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgfVxuICB9XG4gIC8vY2MubG9nKGNvbG9yU3VtKVxuXG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBpPTA7aTxjb2xvclN1bS5sZW5ndGg7aSsrKSB7XG4gICAgdmFyIHMgPSBjb2xvclN1bVtpXVxuICAgIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gICAgICB2YXIgbnVtID0gNSAtIGo7XG4gICAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgICAgdmFyIHN1YkNhcmRzID0gcy5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuICAgICAgICB2YXIgYm9vbCA9IHBhcnNlSW50KHN1YkNhcmRzW251bS0xXVsnc2NvcmVzJ10pIC0gcGFyc2VJbnQoc3ViQ2FyZHNbMF1bJ3Njb3JlcyddKSA8IDU7XG4gICAgICAgIGlmKGJvb2wpe1xuICAgICAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgICAgICB2YXIgbmV3Q2FyZDIwID0gY2FyZDIwLnNsaWNlKDAsaik7XG4gICAgICAgICAgc3ViQ2FyZHMgPSBzdWJDYXJkcy5jb25jYXQobmV3Q2FyZDIwKTtcbiAgICAgICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhKSB7XG4gICAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkLmxlbmd0aDsgcSsrKXtcbiAgICAgICAgICAgICAgdmFyIHIgPSBjYXJkW3FdO1xuICAgICAgICAgICAgICBpZihyID09PSBjYSl7XG4gICAgICAgICAgICAgICAgaW5kZXhzLnB1c2gocSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGluZGV4cy5zb3J0KEFycmF5LnNvcnRCeU51bWJlcik7XG5cbiAgICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy9jYy5sb2cocmVzdWx0KVxuICAvL2NjLmxvZygnLS0tLS0tLS0zNTcnKVxuICBpZihyZXN1bHQubGVuZ3RoID4gMCl7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfWVsc2V7XG4gICAgbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkKTtcbiAgICBpZiAoY2FyZCA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4yMChjb252ZXJ0ZWRDYXJkcyk7XG4gIH1cbiAgLy9yZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBudWxsO1xufTtcblxuLy8g5om+6ZOB5pSvXG4vLyDlpoLvvJpbWzEsMiwzLDRdXVxuS1FDYXJkLmZpbmRUaWVaaGkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIHZhciByZXN1bHQgPSAgS1FDYXJkLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCA0KTtcbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgcmVzdWx0ID0gW107XG4gIC8vIOS6lOWQjOaYr+WMheWQq+mTgeaUr+eahFxuICBsZXQgd3VUb25nSW5kZXhzQXJyYXkgPSBLUUNhcmQuZmluZFd1VG9uZyhjYXJkTW9kZXMpO1xuICBpZiAod3VUb25nSW5kZXhzQXJyYXkpIHtcbiAgICB3dVRvbmdJbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgbGV0IHRpZVpoaUluZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgIGxldCB0aWVaaGlJbmRleHMxID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1s0XV07XG4gICAgICBsZXQgdGllWmhpSW5kZXhzMiA9IFtpbmRleHNbMF0sIGluZGV4c1sxXSwgaW5kZXhzWzNdLCBpbmRleHNbNF1dO1xuICAgICAgbGV0IHRpZVpoaUluZGV4czMgPSBbaW5kZXhzWzBdLCBpbmRleHNbMl0sIGluZGV4c1szXSwgaW5kZXhzWzRdXTtcbiAgICAgIGxldCB0aWVaaGlJbmRleHM0ID0gW2luZGV4c1sxXSwgaW5kZXhzWzJdLCBpbmRleHNbM10sIGluZGV4c1s0XV07XG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHMwKTtcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czEpO1xuICAgICAgcmVzdWx0LnB1c2godGllWmhpSW5kZXhzMik7XG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHMzKTtcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czQpO1xuICAgIH0pO1xuICB9XG4gIGlmKHJlc3VsdC5sZW5ndGggPiAxMCl7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsMTApO1xuICB9XG4gIHJlc3VsdCA9IEtRQ2FyZC5yZXBlYXQocmVzdWx0KTtcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogS1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDQpO1xufTtcbi8v5om+5LqU5ZCMXG5LUUNhcmQuZmluZFd1VG9uZyA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgaWYoY2FyZE1vZGVzLmxlbmd0aCA8IDUpe1xuICAgIHJldHVybiBbXTtcbiAgfVxuICB2YXIgcmVzdWx0ID0gdGhpcy5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgNSkgfHwgW107XG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IEtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2Rlcyw1KTtcbn07XG4vLyDmib7pobrlrZBcbi8vIOWmgu+8mltbMSwgMiwgMywgNCwgNV1dXG5LUUNhcmQuZmluZFNodW5aaSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBpZih0eXBlb2YoY2FyZE1vZGVzWzBdWydwb2ludCddKT09XCJ1bmRlZmluZWRcIil7XG4gICAgY2FyZE1vZGVzID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRNb2Rlcyk7XG4gIH1cbiAgLy8g5YWI5qC55o2u54K55pWw5Y676YeNXG4gIGxldCB1bmlxdWVDYXJkcyA9IGNhcmRNb2Rlcy51bmlxdWUoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XG4gICAgcmV0dXJuIGNhcmQxLnBvaW50ID09IGNhcmQyLnBvaW50O1xuICB9KTtcbiAgdW5pcXVlQ2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpO1xuXG4gIC8vIOWmguaenOaciSBB77yM5YiZ5Zyo5pyA5ZCO5re75YqgIDE0XG4gIGxldCBjYXJkQSA9IGNhcmRNb2Rlcy5maW5kKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gMTtcbiAgfSk7XG4gIGlmIChjYXJkQSkge1xuICAgIGxldCBjYXJkQVBsdXMgPSBuZXcgS1FDYXJkKGNhcmRBKTtcbiAgICBjYXJkQVBsdXMucG9pbnQgPSAxNDtcbiAgICB1bmlxdWVDYXJkcy5wdXNoKGNhcmRBUGx1cyk7XG4gIH1cblxuICBsZXQgcmVzdWx0ID0gW107XG5cbiAgLy8g55Sx5LqO54K55pWw5piv5ZSv5LiA5LiU5Y2H5bqP77yM5Y+q6ZyA6KaB5L6d5qyh6YGN5Y6G5Yik5pat5piv5ZCm5piv6aG65a2Q5Y2z5Y+vXG4gIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbGVuZ3RoKSA8PSB1bmlxdWVDYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICBsZXQgc3ViQ2FyZHMgPSB1bmlxdWVDYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBsZW5ndGgpO1xuICAgIGlmIChLUUNhcmQuaXNTaHVuWmkoc3ViQ2FyZHMsIGxlbmd0aCkpIHtcbiAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgICAgICBsZXQgaW5kZXggPSBjYXJkTW9kZXMuZmluZEluZGV4KGZ1bmN0aW9uIChvcmlnaW5DYXJkKSB7XG5cbiAgICAgICAgICBpZiAoY2FyZC5wb2ludCA9PSAxNCkge1xuICAgICAgICAgICAgcmV0dXJuIG9yaWdpbkNhcmQucG9pbnQgPT0gMTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gY2FyZCA9PT0gb3JpZ2luQ2FyZDtcbiAgICAgICAgfSk7XG4gICAgICAgIGluZGV4cy5wdXNoKGluZGV4KTtcbiAgICAgIH0pO1xuXG4gICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgcmVzdWx0LnVuc2hpZnQoaW5kZXhzKTtcbiAgICB9XG4gIH1cblxuICAvLyDlpITnkIbngrnmlbDph43lpI3nmoTmg4XlhrVcbiAgLy8g5q+U5aaCIEEgQSBLIFEgSiAxMCDov5nnp40gXG4gIGxldCByZXBlYXRJbmRleHNBcnJheSA9IEtRQ2FyZC5fZmluZFJlcGVhdFBvaW50SW5kZXhzQXJyYXkocmVzdWx0LCBjYXJkTW9kZXMpO1xuICByZXBlYXRJbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XG4gIH0pO1xuXG4gIHJlc3VsdC5zb3J0KGZ1bmN0aW9uIChhcnIxLCBhcnIyKSB7XG4gICAgcmV0dXJuIGFycjFbMF0gLSBhcnIyWzBdO1xuICB9KTtcblxuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBLUUNhcmQuZmluZFNodW5aaTIwKGNhcmRNb2Rlcyk7XG59O1xuS1FDYXJkLmZpbmRTaHVuWmkyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMgLGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZE1vZGVzKTtcbiAgaWYoY2FyZDIwLmxlbmd0aCA8PSAwKXtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIGNhcmRzID0gY2FyZE1vZGVzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gIC8vIOWFiOagueaNrueCueaVsOWOu+mHjVxuICB2YXIgbmV3QXJyID0gW107XG4gIHZhciBuZXdBcnJzID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAobmV3QXJycy5pbmRleE9mKGNhcmRzW2ldWydwb2ludCddKSA9PSAtMSkge1xuICAgICAgbmV3QXJyLnB1c2goY2FyZHNbaV0pO1xuICAgICAgbmV3QXJycy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICB9XG4gIH1cblxuICBuZXdBcnIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgcmV0dXJuIG4xLnBvaW50IC0gbjIucG9pbnQ7XG4gIH0pO1xuICB2YXIgcmVzdWx0ID0gW107XG4gIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gICAgdmFyIG51bSA9IGxlbmd0aCAtIGo7XG4gICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IG5ld0Fyci5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgIHZhciBzdWJDYXJkcyA9IG5ld0Fyci5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuICAgICAgdmFyIGJvb2wgPSBwYXJzZUludChzdWJDYXJkc1tudW0tMV1bJ3BvaW50J10pIC0gcGFyc2VJbnQoc3ViQ2FyZHNbMF1bJ3BvaW50J10pIDwgbGVuZ3RoO1xuICAgICAgaWYoYm9vbCl7XG4gICAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgICAgdmFyIG5ld0NhcmQyMCA9IGNhcmQyMC5zbGljZSgwLGopO1xuICAgICAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLmNvbmNhdChuZXdDYXJkMjApO1xuICAgICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkTW9kZXMubGVuZ3RoOyBxKyspe1xuICAgICAgICAgICAgdmFyIHIgPSBjYXJkTW9kZXNbcV07XG4gICAgICAgICAgICBpZihyID09PSBjYXJkKXtcbiAgICAgICAgICAgICAgaW5kZXhzLnB1c2gocSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmKHJlc3VsdC5sZW5ndGggPiAwKXtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9ZWxzZXtcbiAgICBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRNb2Rlcyk7XG4gICAgaWYgKGNhcmRNb2RlcyA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kU2h1blppMjAoY29udmVydGVkQ2FyZHMpO1xuICB9XG59O1xuS1FDYXJkLl9maW5kUmVwZWF0UG9pbnRJbmRleHNBcnJheSA9IGZ1bmN0aW9uKGluZGV4c0FycmF5LCBvcmlnaW5DYXJkcykge1xuICBsZXQgcmVwZWF0SW5kZXhzQXJyYXkgPSBbXTtcbiAgaW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICBsZXQgY2FyZHMgPSBpbmRleHMubWFwKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICByZXR1cm4gb3JpZ2luQ2FyZHNbaW5kZXhdO1xuICAgIH0pO1xuXG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkLCBpbmRleCkge1xuICAgICAgbGV0IG9yaWdpbkluZGV4ID0gb3JpZ2luQ2FyZHMuZmluZEluZGV4KGZ1bmN0aW9uKG9yaWdpbkNhcmQpIHtcbiAgICAgICAgaWYodHlwZW9mKGNhcmQpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9yaWdpbkNhcmQgIT09IGNhcmQgJiYgb3JpZ2luQ2FyZC5wb2ludCA9PSBjYXJkLnBvaW50KSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChvcmlnaW5JbmRleCA8IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgcmVwZWF0SW5kZXhzID0gaW5kZXhzLnNsaWNlKCk7XG4gICAgICByZXBlYXRJbmRleHNbaW5kZXhdID0gb3JpZ2luSW5kZXg7XG4gICAgICByZXBlYXRJbmRleHNBcnJheS5wdXNoKHJlcGVhdEluZGV4cyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHJldHVybiByZXBlYXRJbmRleHNBcnJheTtcbn07XG5cbi8vIOaJvuWQjOiKsVxuLy8g5aaC77yaW1sxLCAyLCAzLCA0LCA1XV1cbktRQ2FyZC5maW5kVG9uZ0h1YSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsIGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBsZXQgY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRNb2Rlcyk7XG4gIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcblxuICBsZXQgcmVzdWx0ID0gW107XG4gIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbGVuZ3RoKSA8PSBjYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICBsZXQgc3ViQ2FyZHMgPSBjYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBsZW5ndGgpO1xuICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBsZW5ndGgpKSB7XG4gICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgbGV0IGluZGV4ID0gY2FyZE1vZGVzLmZpbmRJbmRleChmdW5jdGlvbiAob3JpZ2luQ2FyZCkge1xuICAgICAgICAgIHJldHVybiBjYXJkID09PSBvcmlnaW5DYXJkO1xuICAgICAgICB9KTtcbiAgICAgICAgICBpbmRleHMucHVzaChpbmRleCk7XG4gICAgICB9KTtcbiAgICAgIC8vaW5kZXhzID0gaW5kZXhzLmxlbmd0aCA+IDUgPyBpbmRleHMuc3BsaWNlKDEsMSkgOiBpbmRleHM7XG4gICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgcmVzdWx0LnVuc2hpZnQoaW5kZXhzKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogS1FDYXJkLmZpbmRUb25nSHVhMjAoY2FyZE1vZGVzKTtcbn07XG5LUUNhcmQuZmluZFRvbmdIdWEyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCA1KSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRNb2Rlcyk7XG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciBjYXJkcyA9IGNhcmRNb2Rlcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAvLyDlhYjmoLnmja7ngrnmlbDljrvph41cbiAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuXG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICB2YXIgbnVtID0gNSAtIGo7XG4gICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IGNhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuICAgICAgdmFyIHN1YkNhcmRzID0gY2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcbiAgICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBudW0pKSB7XG4gICAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgICAgdmFyIG5ld0NhcmQyMCA9IGNhcmQyMC5zbGljZSgwLGopO1xuICAgICAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLmNvbmNhdChuZXdDYXJkMjApO1xuICAgICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkTW9kZXMubGVuZ3RoOyBxKyspe1xuICAgICAgICAgICAgdmFyIHIgPSBjYXJkTW9kZXNbcV07XG4gICAgICAgICAgICBpZihyID09PSBjYXJkKXtcbiAgICAgICAgICAgICAgaW5kZXhzLnB1c2gocSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IFtdO1xufTtcblxuS1FDYXJkLmZpbmRIdUx1ID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICBsZXQgbGVuZ3RoID0gNTtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuXG4gIHZhciBwXzM9S1FDYXJkLmZpbmRTYW5UaWFvKGNhcmRNb2Rlcyk7XG4gIHZhciBwXzQ9S1FDYXJkLmZpbmRUaWVaaGkoY2FyZE1vZGVzKTtcbiAgdmFyIHAyPUtRQ2FyZC5maW5kRHVpWmkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgLy92YXIgcF8zID0gIHRoaXMuX2ZpbmRQb2ludExlbmd0aChjYXJkTW9kZXMsIDMpIHx8IFtdO1xuICAvL3ZhciBwXzQgPSB0aGlzLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCA0KSB8fCBbXTtcbiAgLy92YXIgcDIgPSB0aGlzLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCAyKSB8fCBbXTtcbiAgaWYocDIubGVuZ3RoIDw9IDApe1xuICAgIGlmIChwXzMpIHtcbiAgICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV1dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMF0sIGluZGV4c1syXV07XG4gICAgICAgIGxldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMV0sIGluZGV4c1syXV07XG4gICAgICAgIHAyLnB1c2goc2FuVGlhb0luZGV4czApO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICBwMi5wdXNoKHNhblRpYW9JbmRleHMzKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChwXzQpIHtcbiAgICAgIHBfNC5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV1dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMF0sIGluZGV4c1syXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czMgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzNCA9IFtpbmRleHNbMV0sIGluZGV4c1szXV07XG4gICAgICAgIGxldCBzYW5UaWFvSW5kZXhzNiA9IFtpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICAgIHAyLnB1c2goc2FuVGlhb0luZGV4czApO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czIpO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czMpO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czQpO1xuICAgICAgICBwMi5wdXNoKHNhblRpYW9JbmRleHM2KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG5cblxuICBpZiAoKHAyID09IG51bGwpIHx8IChwXzMgPT0gbnVsbCkpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIHRyZXN1bHQ9W11cbiAgcDIuZm9yRWFjaChmdW5jdGlvbiAoaV8zKSB7XG4gICAgdmFyIHM9aV8zO1xuICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uIChpXzIpIHtcbiAgICAgIHMgPSBpXzMuY29uY2F0KGlfMik7XG4gICAgICBmb3IodmFyIGkgPTA7aTxzLmxlbmd0aC0xO2krKyl7XG4gICAgICAgIHZhciBpbmRleCA9IHNbaV07XG4gICAgICAgIGZvcih2YXIgaiA9aSsxO2o8cy5sZW5ndGg7aisrKXtcbiAgICAgICAgICBpZihpbmRleCA9PSBzW2pdKSB7XG4gICAgICAgICAgICBzID0gbnVsbDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZihzID09IG51bGwpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYocyAhPT0gbnVsbCl7XG4gICAgICAgIHRyZXN1bHQudW5zaGlmdChzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIGlmKHRyZXN1bHQubGVuZ3RoID4gMTApe1xuICAgIHRyZXN1bHQgPSB0cmVzdWx0LnNsaWNlKDAsMTApO1xuICB9XG4gIHJldHVybiB0cmVzdWx0Lmxlbmd0aCA+IDAgPyB0cmVzdWx0IDogS1FDYXJkLmZpbmRIdUx1MjAoY2FyZE1vZGVzKTtcbn07XG5LUUNhcmQuZmluZEh1THUyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgbGV0IGxlbmd0aCA9IDU7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRNb2RlcykgfHwgW107XG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciBwXzM9S1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDMpO1xuICB2YXIgcF80PUtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2Rlcyw0KTtcbiAgdmFyIHBfMj1LUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMik7XG4gIGlmKHBfMj09bnVsbCl7XG4gICAgcF8yPVtdO1xuICB9XG4gIGlmIChwXzMpIHtcbiAgICBwXzMuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgIGxldCBzYW5UaWFvSW5kZXhzMCA9IFtpbmRleHNbMF0sIGluZGV4c1sxXV07XG4gICAgICBsZXQgc2FuVGlhb0luZGV4czMgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgcF8yLnVuc2hpZnQoc2FuVGlhb0luZGV4czApO1xuICAgICAgcF8yLnVuc2hpZnQoc2FuVGlhb0luZGV4czMpO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKHBfNCkge1xuICAgIHBfNC5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdXTtcbiAgICAgIGxldCBzYW5UaWFvSW5kZXhzNiA9IFtpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICBwXzIudW5zaGlmdChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICBwXzIudW5zaGlmdChzYW5UaWFvSW5kZXhzNik7XG4gICAgfSk7XG4gIH1cblxuICBpZiAoKHBfMiA9PSBudWxsKSB8fCAocF8zID09IG51bGwpKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciB0cmVzdWx0PVtdXG4gIHBfMi5mb3JFYWNoKGZ1bmN0aW9uIChpXzMpIHtcbiAgICB2YXIgcz1pXzM7XG4gICAgcF8zLmZvckVhY2goZnVuY3Rpb24gKGlfMikge1xuICAgICAgcyA9IGlfMy5jb25jYXQoaV8yKTtcbiAgICAgIGZvcih2YXIgaSA9MDtpPHMubGVuZ3RoLTE7aSsrKXtcbiAgICAgICAgdmFyIGluZGV4ID0gc1tpXTtcbiAgICAgICAgZm9yKHZhciBqID1pKzE7ajxzLmxlbmd0aDtqKyspe1xuICAgICAgICAgIGlmKGluZGV4ID09IHNbal0pIHtcbiAgICAgICAgICAgIHMgPSBudWxsO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKHMgPT0gbnVsbCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZihzICE9PSBudWxsKXtcbiAgICAgICAgdHJlc3VsdC51bnNoaWZ0KHMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiAgaWYodHJlc3VsdC5sZW5ndGggPiAxMCl7XG4gICAgdHJlc3VsdCA9IHRyZXN1bHQuc2xpY2UoMCwxMCk7XG4gIH1cbiAgcmV0dXJuIHRyZXN1bHQubGVuZ3RoID4gMCA/IHRyZXN1bHQgOiBbXTtcbn07XG5cbktRQ2FyZC5maW5kR3VpUGFpID0gZnVuY3Rpb24gKGNhcmRNb2RlcyxudW1CZXIgPSAxKSB7XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRNb2RlcykubWFwKGZ1bmN0aW9uKGNhcmQpey8v5b6X5Yiw6ay854mM55qE57Si5byVXG4gICAgZm9yKHZhciBxID0gMDtxIDwgY2FyZE1vZGVzLmxlbmd0aDsgcSsrKXtcbiAgICAgIHZhciByID0gY2FyZE1vZGVzW3FdO1xuICAgICAgaWYociA9PT0gY2FyZCl7XG4gICAgICAgIHJldHVybiBxO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICB2YXIgbnVtID0gbnVtQmVyLWo7Ly/pmaTprLzniYzlpJYg5oiR5bqU6K+l5om+5aSa5bCR5byg54mM5Yy56YWNXG4gICAgdmFyIGluZGV4cyA9IEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgbnVtKSB8fCBbXTtcbiAgICBmb3IodmFyIHQgPSAwO3QgPCBpbmRleHMubGVuZ3RoOyB0KyspIHtcbiAgICAgIGlmKG51bUJlciA9PSAyKXsvL+aYr+WvueWtkOeahOaXtuWAmeaKiumsvOeJjOWSjOWNleW8oOWMuemFjemDveW+queOr+S4gOmBjVxuICAgICAgICBmb3IodmFyIG8gPSAwO28gPCBjYXJkMjAubGVuZ3RoOysrbyl7XG4gICAgICAgICAgdmFyIHMgPSBpbmRleHNbdF0uY29uY2F0KGNhcmQyMFtvXSk7XG4gICAgICAgICAgaWYocy5sZW5ndGggPT0gbnVtQmVyKXtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfWVsc2V7XG4gICAgICAgIHZhciBzID0gaW5kZXhzW3RdLmNvbmNhdChjYXJkMjAuc2xpY2UoMCxqKSk7Ly/kvp3mrKHnm7jliqDprLzniYznrKzkuIDmrKHliqDkuIDlvKAg6YCS5aKeXG4gICAgICAgIGlmKHMubGVuZ3RoID09IG51bUJlcil7XG4gICAgICAgICAgcmVzdWx0LnB1c2gocyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDEwKXtcbiAgICByZXN1bHQgPSByZXN1bHQuc2xpY2UoMCwxMCk7XG4gIH1cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpOy8v5Y676YeNXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IFtdO1xufTtcblxuS1FDYXJkLnJlcGVhdCA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgZm9yKHZhciBpID0wO2k8cmVzdWx0Lmxlbmd0aDtpKyspe1xuICAgIHZhciBpbmRleCA9IHJlc3VsdFtpXTtcblxuICAgIHZhciBuZXdBeXkgPSBbXTtcbiAgICBmb3IodmFyIG8gPSAwO28gPCBpbmRleC5sZW5ndGg7bysrKXsvL+aciemHjeWkjeW5suaOieS9oFxuICAgICAgaWYobmV3QXl5LmluZGV4T2YoaW5kZXhbb10pID09IC0xKXtcbiAgICAgICAgbmV3QXl5LnB1c2goaW5kZXhbb10pO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHJlc3VsdC5zcGxpY2UoaSwxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yKHZhciBqID1pKzE7ajxyZXN1bHQubGVuZ3RoLTE7aisrKXtcbiAgICAgIHZhciBzID0gcmVzdWx0W2pdO1xuICAgICAgdmFyIGpTdHJpbmcgPSAnJztcbiAgICAgIHZhciBpU3RyaW5nID0gJyc7XG4gICAgICBmb3IodmFyIHIgPSAwO3IgPCBzLmxlbmd0aDtyKyspe1xuICAgICAgICAgIGpTdHJpbmcgPSBqU3RyaW5nICsgc1tyXTtcbiAgICAgICAgICBpU3RyaW5nID0gaVN0cmluZyArIGluZGV4W3JdO1xuICAgICAgfVxuICAgICAgaWYoalN0cmluZyA9PSBpU3RyaW5nKXsvL+aciemHjeWkjeW5suaOieS9oFxuICAgICAgICByZXN1bHQuc3BsaWNlKGksMSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5cbktRQ2FyZC50ZXN0RmluZCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgdmFyIFd1VG9uZyA9IEtRQ2FyZC5maW5kV3VUb25nKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBUb25nSHVhU2h1biA9IEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4oY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIFRpZVpoaSA9IEtRQ2FyZC5maW5kVGllWmhpKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBIdUx1ID0gS1FDYXJkLmZpbmRIdUx1KGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBUb25nSHVhID0gS1FDYXJkLmZpbmRUb25nSHVhKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBTaHVuWmkgPSBLUUNhcmQuZmluZFNodW5aaShjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgU2FuVGlhbyA9IEtRQ2FyZC5maW5kU2FuVGlhbyhjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgTGlhRHVpID0gS1FDYXJkLmZpbmRMaWFEdWkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIER1aVppID0gS1FDYXJkLmZpbmREdWlaaShjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgcmVzdWx0ID0gW1xuICAgIFd1VG9uZyxcbiAgICBUb25nSHVhU2h1bixcbiAgICBUaWVaaGksXG4gICAgSHVMdSxcbiAgICBUb25nSHVhLFxuICAgIFNodW5aaSxcbiAgICBTYW5UaWFvLFxuICAgIExpYUR1aSxcbiAgICBEdWlaaSxcbiAgXVxuICByZXR1cm4gcmVzdWx0O1xufTtcbiIsIi8vIOeJjOeCueaVsOW4ruWKqeexu1xuLy8g55So5p2l6K6h566X5LiA5Liq54mM5pWw57uE5YaF55qE55u45ZCM54K55pWw55qE54mM55qE5byg5pWwXG52YXIgS1FDYXJkUG9pbnRzSGVscGVyID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdGhpcy5wb2ludE51bWJlcnMgPSB7fTtcbiAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIGxldCBwb2ludCA9IGNhcmQucG9pbnQ7XG4gICAgICAgIHZhciBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twb2ludF0gfHwgMDtcbiAgICAgICAgdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdID0gbnVtYmVyICsgMTtcbiAgICB9LmJpbmQodGhpcykpO1xufTtcblxuLy8g55u45ZCM54K55pWw54mM55qE5pyA5aSn5pWw6YePXG5LUUNhcmRQb2ludHNIZWxwZXIucHJvdG90eXBlLm1heE51bWJlciA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHJlc3VsdCA9IDA7XG4gIGZvciAobGV0IHByb3AgaW4gdGhpcy5wb2ludE51bWJlcnMpIHtcbiAgICBsZXQgbnVtYmVyID0gdGhpcy5wb2ludE51bWJlcnNbcHJvcF07XG4gICAgICAvL2lmKG51bWJlciA8IDIwKXtcbiAgICAgICAgICByZXN1bHQgPSBNYXRoLm1heChudW1iZXIsIHJlc3VsdCk7XG4gICAgICAvL31cbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBLUUNhcmRQb2ludHNIZWxwZXI7XG5cbi8qdmFyIGNhcmRzID0gW1xuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoyfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjR9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo0fSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjZ9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo4fSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEwfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMn0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEyfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTR9XG5dO1xudmFyIHRlc3QgPSBuZXcgS1FDYXJkUG9pbnRzU2FtZShjYXJkcyk7XG5jb25zb2xlLmxvZyh0ZXN0KTsqL1xuIiwibGV0IEhlbHBlciA9IHtcbiAgbG9hZENhcmRTcHJpdGVGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaykge1xuICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUoY2FyZE5hbWUsIGNhbGxiYWNrKTtcbiAgfSxcblxuICBzZXRDYXJkU3ByaXRlRnJhbWU6IGZ1bmN0aW9uIChzcHJpdGUsIGNhcmROYW1lKSB7XG4gICAgdGhpcy5sb2FkQ2FyZFNwcml0ZUZyYW1lKGNhcmROYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcbiAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuICAgIH0pO1xuICB9LFxuXG4gIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lKSB7XG4gICAgdmFyIGNhcmROYW1lID0gY2FyZFNob3J0TmFtZTtcbiAgICBpZiAoIWNhcmROYW1lLnN0YXJ0c1dpdGgoXCJwdWJsaWMtcGljLWNhcmQtcG9rZXJcIikpIHtcbiAgICAgIGNhcmROYW1lID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2FyZE5hbWU7XG4gIH0sXG5cbiAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2spIHtcbiAgICBjYy5hc3NlcnQoY2FsbGJhY2spO1xuXG4gICAgY2MubG9hZGVyLmxvYWRSZXMoXCJwbGF5L0NhcmRUeXBlQ29tYmluZS9wb2NrTGlzdFwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgZXJyKVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNhcmROYW1lID0gdGhpcy5fY2FyZEZ1bGxOYW1lKGNhcmROYW1lKTtcbiAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcbiAgICAgIGNhbGxiYWNrKGZyYW1lKTtcbiAgICB9LmJpbmQodGhpcykpO1xuICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBIZWxwZXI7XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcbmNvbnN0IEtRQ2FyZENvbG9yc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZENvbG9yc0hlbHBlcicpO1xuY29uc3QgS1FDYXJkU2NvcmV0c0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFNjb3JldHNIZWxwZXInKTtcbmNvbnN0IEdldENhcmRQb2ludHNTYW1lQ291bnQgPSByZXF1aXJlKCdHZXRDYXJkUG9pbnRzU2FtZUNvdW50Jyk7XG5jb25zdCBLUUNhcmRQb2ludHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRQb2ludHNIZWxwZXInKTtcblxuS1FDYXJkLnNjb3JlT2ZDYXJkcyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICBpZihjYXJkcyA9PSBudWxsIHx8IGNhcmRzLmxlbmd0aCA9PSBudWxsKSB7XG4gICAgY2FyZHMgPSBbXTtcbiAgfVxuXG4gIHZhciBpc1RvdSA9IGNhcmRzLmxlbmd0aCA9PSAzO1xuICBsZXQgdHlwZVNjb3JlID0gS1FDYXJkLl90eXBlU2NvcmVPZkNhcmRzKGNhcmRzKTtcbiAgdmFyIGNhbGVDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQShjYXJkcy5zbGljZSgpKTtcbiAgY2FsZUNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XG4gICAgaWYoY2FyZC5zY29yZXMgPT0gMSl7XG4gICAgICBjYXJkLnNjb3JlcyA9IDE0O1xuICAgIH1cbiAgfSlcbiAgLy9jYWxlQ2FyZHMgPSBLUUNhcmQuU29ydChjYWxlQ2FyZHMpO1xuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYWxlQ2FyZHMpO1xuICB2YXIgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkU2NvcmV0c0hlbHBlcihjYWxlQ2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKSk7XG4gIHZhciBtYXhOdW0gPSBwb2ludEhlbHBlci5tYXhOdW1iZXIoKS8qLWNhcmQyMC5sZW5ndGggPT0gMCA/IDE6IHBvaW50SGVscGVyLm1heE51bWJlcigpLWNhcmQyMC5sZW5ndGgqLztcblxuICB2YXIgbWF4U2NvcmUgPSAwOy8v6I635Y+W6Zmk6ay854mM5aSW5pyA5aSn55qE55qE54K55pWwXG4gIGZvcih2YXIgaSBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICBpZiAocGFyc2VJbnQoaSkgPiBtYXhTY29yZSAmJiBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbaV0gPT0gbWF4TnVtKSB7XG4gICAgICBtYXhTY29yZSA9IHBhcnNlSW50KGkpO1xuICAgIH1cbiAgfVxuICBjYWxlQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcbiAgICBpZihjYXJkLnNjb3JlcyA+PSAyMCl7XG4gICAgICBjYXJkLnNjb3JlcyA9IG1heFNjb3JlO1xuICAgIH1cbiAgfSlcbiAgY2FyZDIwLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XG4gICAgY2FyZC5zY29yZXMgPSBtYXhTY29yZTtcbiAgfSlcbiAgLy9jYy5sb2cobWF4TnVtKVxuICAvL2NjLmxvZyhtYXhTY29yZSlcbiAgLy9jYy5sb2coY2FsZUNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCkpXG4gIC8vY2MubG9nKCctLS0tMzUnKVxuICBjYWxlQ2FyZHMuc29ydChLUUNhcmQuc29ydCk7XG4gIGlmKHR5cGVTY29yZSA9PSA5MDAwMDAwMDAwMDAwMDAwKXtcbiAgICAvL+S6lOWQjFxuICAgIGNhbGVDYXJkcy5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiAgICAgIHJldHVybiBhMi5zY29yZXMgLSBhMS5zY29yZXM7XG4gICAgfSk7XG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xuICAgIC8vdmFyIHRvdGFsQ29sb3IgPSBcIlwiO1xuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcbiAgICAgIC8vdmFyIGMgPSBjYWxlQ2FyZHNbaV0uY29sb3I7XG4gICAgICB0b3RhbFZhbHVlID0gKHBhcnNlSW50KHMpID49IDEwID8gcyA6IFwiMFwiK3MpK3RvdGFsVmFsdWU7XG4gICAgICAvL3RvdGFsQ29sb3IgPSBjK3RvdGFsQ29sb3I7XG4gICAgfVxuICAgIC8vdG90YWxWYWx1ZSA9IHRvdGFsVmFsdWUrdG90YWxDb2xvcjtcbiAgICAvL2NjLmxvZyh0b3RhbFZhbHVlKVxuICAgIC8vY2MubG9nKHBhcnNlSW50KHRvdGFsVmFsdWUpKVxuICAgIC8vY2MubG9nKHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlKSlcbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDgwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+WQjOiKsemhuuavlOacgOWkp+eahOmCo+W8oO+8jOWmguaenOS4pOW8oOebuOWQjOmCo+WwseaYr+ebuOWQjFxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKXsvL+aciemsvOeJjOeahOaXtuWAmeimgeaUueWPmOmsvOeJjOeahOWIhuaVsFxuICAgICAgY2FsZUNhcmRzID0gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FsZUNhcmRzKTtcbiAgICB9XG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcbiAgICAgIHRvdGFsVmFsdWUgPSAocGFyc2VJbnQocykgPj0gMTAgPyBzIDogXCIwXCIrcykrdG90YWxWYWx1ZTtcbiAgICAgIHZhciBjID0gY2FsZUNhcmRzW2ldLmNvbG9yOy8v54mM6ImyXG4gICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcbiAgICB9XG4gICAgaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlKTtcbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUgKyB2YWx1ZUNvbG9yKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA3MDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/pk4HmlK8s5om+5Ye66YKj5Zub5byg5piv5LuA5LmI54mMXG5cbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIGlmKG1heFNjb3JlID09IGNhbGVDYXJkc1t3XS5zY29yZXMpey8v5LiJ5p2hXG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuICAgICAgfWVsc2V7XG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcblxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxuICAgICAgICBvbmVWYWx1ZUNvbG9yID0gYyArIG9uZVZhbHVlQ29sb3I7Ly/niYzoibJcblxuICAgICAgfVxuICAgIH1cbiAgICAvL2lmKGNjLmh1YVNlID09IDApIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcbiAgICAvL3ZhciBxd2UgPSAnJztcbiAgICAvL3F3ZSA9IG9uZVZhbHVlQ29sb3Iuc3Vic3RyKDAsb25lVmFsdWVDb2xvci5sZW5ndGggLTEpO1xuICAgIC8vb25lVmFsdWVDb2xvciA9IG9uZVZhbHVlQ29sb3Iuc3Vic3RyKG9uZVZhbHVlQ29sb3IubGVuZ3RoIC0xKTtcbiAgICAvL3N0ciA9IHN0citvbmVWYWx1ZSArIG9uZVZhbHVlQ29sb3IgKyB2YWx1ZUNvbG9yICsgcXdlO1xuICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA2MDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/okavoiqZcbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIGlmKG1heFNjb3JlID09IGNhbGVDYXJkc1t3XS5zY29yZXMpey8v5LiJ5p2hXG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuICAgICAgfWVsc2V7XG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcblxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxuICAgICAgICBvbmVWYWx1ZUNvbG9yID0gYyArIG9uZVZhbHVlQ29sb3I7Ly/niYzoibJcblxuICAgICAgfVxuICAgIH1cblxuICAgIGlmKGlzVG91KXtcbiAgICAgIG9uZVZhbHVlID0gb25lVmFsdWUrJzAwMDAnO1xuICAgICAgb25lVmFsdWVDb2xvciA9IG9uZVZhbHVlQ29sb3IrJzAwJztcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vc3RyID0gc3RyK29uZVZhbHVlICsgdmFsdWVDb2xvciArIG9uZVZhbHVlQ29sb3I7XG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XG5cbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA1MDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/lkIzoirEs5pyJ5Y+v6IO96ZyA6KaB5q+UNeW8oOeJjFxuICAgIHZhciB0b3RhbFNjb3JlID0gXCJcIjtcbiAgICB2YXIgdG90YWxDb2xvciA9IFwiXCI7XG4gICAgLy92YXIgY29sb3JzID0gMDsvL+iOt+WPlueJjOeahOexu+Wei+minOiJslxuICAgIC8vZm9yKHZhciBpIGluIGNhbGVDYXJkcykge1xuICAgIC8vICBpZihwYXJzZUludChjYWxlQ2FyZHNbaV0ucG9pbnQpIDwgMjApe1xuICAgIC8vICAgIGNvbG9ycyA9IHBhcnNlSW50KGNhbGVDYXJkc1tpXS5jb2xvcik7XG4gICAgLy8gICAgYnJlYWs7XG4gICAgLy8gIH1cbiAgICAvL31cblxuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBwYWlQb2ludCA9IHBhcnNlSW50KGNhbGVDYXJkc1tpXS5wb2ludCk7XG4gICAgICB2YXIgY29sb3JzID0gcGFyc2VJbnQoY2FsZUNhcmRzW2ldLnBvaW50KSA8IDIwID8gY2FsZUNhcmRzW2ldLmNvbG9yOiA1O1xuICAgICAgdG90YWxDb2xvciA9IGNvbG9ycyArIHRvdGFsQ29sb3I7XG4gICAgICB0b3RhbFNjb3JlID0gKHBhaVBvaW50Pj0xMCA/IHBhaVBvaW50IDogXCIwXCIrcGFpUG9pbnQpK3RvdGFsU2NvcmU7XG4gICAgfVxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxTY29yZSk7XG4gICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsU2NvcmUpO1xuICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFNjb3JlK3RvdGFsQ29sb3IpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDQwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+mhuuWtkFxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKXsvL+aciemsvOeJjOeahOaXtuWAmeimgeaUueWPmOmsvOeJjOeahOWIhuaVsFxuICAgICAgY2FsZUNhcmRzID0gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FsZUNhcmRzKTtcbiAgICB9XG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcbiAgICAgIHRvdGFsVmFsdWUgPSAocGFyc2VJbnQocykgPj0gMTAgPyBzIDogXCIwXCIrcykrdG90YWxWYWx1ZTtcblxuICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbaV0uY29sb3I7Ly/niYzoibJcbiAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuICAgIH1cbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpO1xuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlKTtcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxWYWx1ZSArIHZhbHVlQ29sb3IpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDMwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+S4ieadoe+8jOaJvuWHuuaYr+WTquW8oOeJjOaciTPlvKBcbiAgICAvL2NhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIHZhciBvbmVWYWx1ZUNvbG9yMjAgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciB3IGluIGNhbGVDYXJkcykge1xuICAgICAgaWYobWF4U2NvcmUgPT0gY2FsZUNhcmRzW3ddLnNjb3Jlcyl7Ly/kuInmnaFcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XG5cbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yOy8v54mM6ImyXG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIGlmKHBhcnNlSW50KHMpIDwgMjApe1xuICAgICAgICAgIG9uZVZhbHVlQ29sb3IgPSBjICsgb25lVmFsdWVDb2xvcjsvL+eJjOiJslxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICBvbmVWYWx1ZUNvbG9yMjAgPSBjICsgb25lVmFsdWVDb2xvcjIwOy8v54mM6ImyXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYoaXNUb3Upe1xuICAgICAgb25lVmFsdWUgPSBvbmVWYWx1ZSsnMDAwMCc7XG4gICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcisnMDAnO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0citvbmVWYWx1ZSk7XG4gICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0citvbmVWYWx1ZSk7XG4gICAgLy9zdHIgPSBzdHIrb25lVmFsdWUgKyBvbmVWYWx1ZUNvbG9yICsgdmFsdWVDb2xvciArIG9uZVZhbHVlQ29sb3IyMDtcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcblxuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDIwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL2NhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcbiAgICAvL+S4pOWvuSzmnInlj6/og73pnIDopoHmr5Q15byg54mMXG4gICAgdmFyIHN0ciA9IFwiXCI7XG4gICAgdmFyIG9uZVZhbHVlID0gJyc7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciBpIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgaWYocG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW2ldID09IDIpIHsvL+S4pOWvuVxuICAgICAgICBmb3IodmFyIHcgaW4gY2FsZUNhcmRzKSB7XG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbd10uc2NvcmVzKXtcbiAgICAgICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgICAgIHN0ciA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIHN0cjtcbiAgICAgICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGZvcih2YXIgcSBpbiBjYWxlQ2FyZHMpIHsvL+WNleW8oOWKoOiKseiJslxuICAgICAgICAgIGlmKGkgPT0gY2FsZUNhcmRzW3FdLnNjb3Jlcyl7XG4gICAgICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1txXS5zY29yZXM7XG4gICAgICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xuXG4gICAgICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1txXS5jb2xvcjsvL+eJjOiJslxuICAgICAgICAgICAgb25lVmFsdWVDb2xvciA9IG9uZVZhbHVlQ29sb3IgKyBjOy8v54mM6ImyXG5cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgfVxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcbiAgICAvL2lmKGNjLmh1YVNlID09IDApIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcbiAgICAvLy8vY2MubG9nKHN0cilcbiAgICAvLy8vY2MubG9nKG9uZVZhbHVlKVxuICAgIC8vc3RyID0gc3RyK29uZVZhbHVlICtvbmVWYWx1ZUNvbG9yICsgdmFsdWVDb2xvcjtcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSAxMDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/lr7nlrZBcbiAgICAvL2NhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjtcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7XG5cbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCl7XG4gICAgICBjYWxlQ2FyZHMuc29ydChmdW5jdGlvbihjYXJkMSxjYXJkMikge1xuICAgICAgICByZXR1cm4gY2FyZDIucG9pbnQtY2FyZDEucG9pbnQ7XG4gICAgICB9KTtcbiAgICAgIGNhbGVDYXJkcyA9IGNhbGVDYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAgICAgY2FsZUNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCxpbmRleCkge1xuICAgICAgICB2YXIgcyA9IGNhcmQuc2NvcmVzO1xuICAgICAgICB2YXIgYyA9IGNhcmQuY29sb3I7XG4gICAgICAgIHN0ciA9IHN0cisocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcyk7XG4gICAgICAgIGlmKGluZGV4ID09IDApe1xuICAgICAgICAgIHZhciBzMjAgPSBjYXJkMjBbMF0uc2NvcmVzO1xuICAgICAgICAgIHN0ciA9IHN0cisocGFyc2VJbnQoczIwKT49MTAgPyBzMjAgOlwiMFwiK3MyMCk7XG4gICAgICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrYztcbiAgICAgICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcitjYXJkMjBbMF0uY29sb3I7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIG9uZVZhbHVlQ29sb3IgPSBvbmVWYWx1ZUNvbG9yK2M7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy9jYy5sb2coc3RyKVxuICAgICAgLy9jYy5sb2coJy0tLS0tLS0tMjc0JylcbiAgICAgIGlmKGlzVG91KXtcbiAgICAgICAgc3RyID0gc3RyKycwMDAwJztcbiAgICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrJzAwJztcbiAgICAgIH1cbiAgICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcbiAgICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICAgICAgLy9zdHIgPSBzdHIgKyBvbmVWYWx1ZUNvbG9yICsgdmFsdWVDb2xvcjtcbiAgICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICAgIH1cblxuICAgIGZvcih2YXIgaSBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgIGlmKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tpXSA9PSBtYXhOdW0pIHsvL+WvueWtkFxuICAgICAgICBmb3IodmFyIHcgaW4gY2FsZUNhcmRzKSB7Ly/lr7nlrZDliqDoirHoibJcbiAgICAgICAgICBpZihpID09IGNhbGVDYXJkc1t3XS5zY29yZXMpe1xuICAgICAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICAgICAgdmFsdWVDb2xvciA9IGNhbGVDYXJkc1t3XS5jb2xvciArIHZhbHVlQ29sb3I7XG4gICAgICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgZm9yKHZhciBxIGluIGNhbGVDYXJkcykgey8v5Y2V5byg5Yqg6Iqx6ImyXG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbcV0uc2NvcmVzKXtcbiAgICAgICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3FdLnNjb3JlcztcbiAgICAgICAgICAgIG9uZVZhbHVlQ29sb3IgPSBjYWxlQ2FyZHNbcV0uY29sb3IgKyBvbmVWYWx1ZUNvbG9yO1xuICAgICAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgfVxuICAgIGlmKGlzVG91KXtcbiAgICAgIG9uZVZhbHVlID0gb25lVmFsdWUrJzAwMDAnO1xuICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrJzAwJztcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xuICAgIC8vc3RyID0gc3RyK29uZVZhbHVlK29uZVZhbHVlQ29sb3IrdmFsdWVDb2xvcjtcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSAwKSB7XG4gICAgLy/kuYzpvplcbiAgICB2YXIgdmFsdWVQb2ludCA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiO1xuICAgIGZvcih2YXIgcSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW3FdLnNjb3JlcztcbiAgICAgIHZhciBjID0gY2FsZUNhcmRzW3FdLmNvbG9yOy8v5Y2V5byg5Yqg6Iqx6ImyXG4gICAgICB2YWx1ZVBvaW50ID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgdmFsdWVQb2ludDtcbiAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjtcbiAgICB9XG4gICAgaWYoaXNUb3Upe1xuICAgICAgdmFsdWVQb2ludCA9IHZhbHVlUG9pbnQrJzAwMDAnO1xuICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrJzAwJztcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh2YWx1ZVBvaW50KTtcbiAgICAvL2lmKGNjLmh1YVNlID09IDApIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodmFsdWVQb2ludCk7XG4gICAgLy92YWx1ZVBvaW50ID0gdmFsdWVQb2ludCArIHZhbHVlQ29sb3I7XG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHZhbHVlUG9pbnQpO1xuICB9XG5cblxuICB2YXIgY2FyZHNUb3RhbFBvaW50PTA7XG4gIGNhbGVDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICBjYXJkc1RvdGFsUG9pbnQgKz0gY2FyZC5wb2ludDtcbiAgfSk7XG5cbiAgbGV0IHJlc3VsdCA9IHR5cGVTY29yZSArIGNhcmRzVG90YWxQb2ludDtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5LUUNhcmQuX2NoYW5nZUNhcmRTY29ycyA9IGZ1bmN0aW9uKGNhcmRNb2RlbCkge1xuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgY2FyZC5zY29yZXMgPSBjYXJkLnBvaW50O1xuICAgIGlmIChjYXJkLnNjb3JlcyA9PSAxKSB7XG4gICAgICBjYXJkLnNjb3JlcyA9IDE0O1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIGlzMTQgPSB0cnVlOy8v5pivIGsgcSBqIDEwIEE7XG4gIHZhciBpczEgPSB0cnVlOy8v5pivMSAyIDMgNCA1XG5cbiAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgIGlmIChjYXJkLnNjb3JlcyA8IDEwKSB7XG4gICAgICBpczE0ID0gZmFsc2U7IC8v5LiN5pivIGsgcSBqIDEwIEE7XG4gICAgfVxuICB9KTtcbiAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgIGNhcmQuc2NvcmVzID0gY2FyZC5wb2ludDtcbiAgICBpZiAoY2FyZC5zY29yZXMgPT0gMTQpIHtcbiAgICAgIGNhcmQuc2NvcmVzID0gMTtcbiAgICB9XG4gIH0pO1xuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgaWYgKGNhcmQuc2NvcmVzID4gNSAmJiBjYXJkLnNjb3JlcyAhPSAyMCkge1xuICAgICAgaXMxID0gZmFsc2U7Ly/kuI3mmK8xIDIgMyA0IDVcbiAgICB9XG4gIH0pO1xuXG4gIGlmIChpczE0KSB7IC8v5pivIGsgcSBqIDEwIEE7XG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgICAgaWYgKGNhcmQuc2NvcmVzID09IDEpIHtcbiAgICAgICAgY2FyZC5zY29yZXMgPSAxNDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge1xuICAgICAgcmV0dXJuIGEyLnNjb3JlcyAtIGExLnNjb3JlcztcbiAgICB9KTtcbiAgICB2YXIgbnVtID0gMTQ7XG4gICAgdmFyIHNjb3Jlc0F5eSA9IFtdOyAvL+S4gOWJr+eJjOeahOWIhuaVsFxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICBzY29yZXNBeXkucHVzaChudW0pO1xuICAgICAgbnVtIC09IDE7XG4gICAgfVxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRNb2RlbC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XG4gICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHtcbiAgICAgICAgICBzY29yZXNBeXkuc3BsaWNlKGosIDEpOyAvL+WIoOmZpOS4jeaYr+msvOeJjOeahOWIhlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC8vY2MubG9nKCctLS0tLS0tLS0t5pivIGsgcSBqIDEwIEEnLHNjb3Jlc0F5eSlcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7IC8v5om+5Ye66YCJ5Lit55qE54mMXG4gICAgICBpZiAoY2FyZC5wb2ludCA+PSAyMCkge1xuICAgICAgICBjYXJkLnNjb3JlcyA9IHNjb3Jlc0F5eS5zcGxpY2UoMCwgMSlbMF07XG4gICAgICB9XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfVxuICBlbHNlIGlmIChpczEpIHsgLy/mmK8xIDIgMyA0IDVcbiAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtcbiAgICAgIHJldHVybiBhMi5zY29yZXMgLSBhMS5zY29yZXM7XG4gICAgfSk7XG4gICAgdmFyIG51bSA9IDU7XG4gICAgdmFyIHNjb3Jlc0F5eSA9IFtdOyAvL+S4gOWJr+eJjOeahOWIhuaVsFxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICBzY29yZXNBeXkucHVzaChudW0pO1xuICAgICAgbnVtIC09IDE7XG4gICAgfVxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRNb2RlbC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XG4gICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHtcbiAgICAgICAgICBzY29yZXNBeXkuc3BsaWNlKGosIDEpOyAvL+WIoOmZpOS4jeaYr+msvOeJjOeahOWIhlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC8vY2MubG9nKCctLS0tLS0tLS0t5pivMSAyIDMgNCA1JylcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7IC8v5om+5Ye66YCJ5Lit55qE54mMXG4gICAgICBpZiAoY2FyZC5wb2ludCA+PSAyMCkge1xuICAgICAgICBjYXJkLnNjb3JlcyA9IHNjb3Jlc0F5eS5zcGxpY2UoMCwgMSlbMF07XG4gICAgICB9XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfVxuICBlbHNlIHtcbiAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtcbiAgICAgIHJldHVybiBhMS5zY29yZXMgLSBhMi5zY29yZXM7XG4gICAgfSk7XG4gICAgdmFyIHNjb3Jlc0F5eSA9IFtdOyAvL+eUqOadpeijhemsvOeJjOWIhuaVsFxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICB2YXIgcyA9IHBhcnNlSW50KGNhcmRNb2RlbFswXS5zY29yZXMpICsgaTsgLy/mnIDlsI/nmoTniYznmoTliIbmlbBcbiAgICAgIHNjb3Jlc0F5eS5wdXNoKHMpOy8v5LiA5Ymv54mM55qE5YiG5pWwXG4gICAgfVxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRNb2RlbC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XG4gICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHtcbiAgICAgICAgICBzY29yZXNBeXkuc3BsaWNlKGosIDEpOyAvL+WIoOmZpOS4jeaYr+msvOeJjOeahOWIhlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHsgLy/mlLnlj5jniYznmoTliIbmlbBcbiAgICAgIGlmIChjYXJkLnBvaW50ID49IDIwKSB7XG4gICAgICAgIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLDEpWzBdO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSk7XG4gIH1cblxuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgaWYgKGNhcmQuc2NvcmVzID09IDEpIHtcbiAgICAgIGNhcmQuc2NvcmVzID0gMTQ7XG4gICAgfVxuICB9KTtcbiAgY2FyZE1vZGVsLnNvcnQoZnVuY3Rpb24oYTEsIGEyKSB7XG4gICAgcmV0dXJuIGExLnNjb3JlcyAtIGEyLnNjb3JlcztcbiAgfSk7XG4gIHJldHVybiBjYXJkTW9kZWw7XG59O1xuLyojIyMjIyovXG5cbktRQ2FyZC5fdHlwZVNjb3JlT2ZDYXJkcyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICB2YXIgdHlwZVNjb3JlID0gMDtcbiAgaWYoS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZHMpKXtcbiAgICB0eXBlU2NvcmUgPSA5MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gODAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblRpZVpoaShjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSA3MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluSHVMdShjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSA2MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YShjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSA1MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2h1blppKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDQwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5TYW5UaWFvKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDMwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gMjAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkR1aVppKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDEwMDAwMDAwMDAwMDAwMDA7XG4gIH1cblxuICByZXR1cm4gdHlwZVNjb3JlO1xufTtcbi8qXG4gLy8g5qC55o2u54mM5Z6L6L+b6KGM5o6S5bqPXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0ID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gaWYgKChjYXJkcyA9PSBudWxsKSB8fCAoY2FyZHMubGVuZ3RoID09IDApKSB7XG4gcmV0dXJuIGNhcmRzO1xuIH1cbiBpZihLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcykpe1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRXdXRvbmcoY2FyZHMpO1xuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bihjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2h1blppKGNhcmRzKTtcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKSkge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRUaWVaaGkoY2FyZHMpO1xuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5IdUx1KGNhcmRzKSkge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRIdUx1KGNhcmRzKTtcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YShjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0VG9uZ0h1YShjYXJkcyk7XG4gfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblNodW5aaShjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2h1blppKGNhcmRzKTtcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2FuVGlhbyhjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2FuVGlhbyhjYXJkcyk7XG4gfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkxpYUR1aShjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0TGlhbmdEdWkoY2FyZHMpO1xuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5EdWlaaShjYXJkcykpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0RHVpWmkoY2FyZHMpO1xuIH1cblxuIHJldHVybiBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCkucmV2ZXJzZSgpO1xuIH07XG5cbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRTaHVuWmkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiByZXR1cm4gY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpLnJldmVyc2UoKTtcbiB9O1xuXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0VGllWmhpID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xuIH07XG5cbiAvISojIyMjIyohL1xuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFd1dG9uZyA9IGZ1bmN0aW9uIChjYXJkcykge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcbiB9O1xuIC8hKiMjIyMjKiEvXG5cbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRIdUx1ID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xuIH07XG5cbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRUb25nSHVhID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gcmV0dXJuIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KS5yZXZlcnNlKCk7XG4gfTtcblxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhjYXJkcyk7XG4gfTtcblxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydExpYW5nRHVpID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xuIH07XG5cbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnREdWlaaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcbiB9O1xuICovXG5LUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzID0gZnVuY3Rpb24oY2FyZHMpIHtcblxuICBjYXJkcyA9IEtRQ2FyZC5fY2hhbmdlR3VpQ2FyZChjYXJkcyk7XG5cbiAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihpKXtpZihpLnNjb3JlcyA9PSAxKSBpLnNjb3JlcyA9IDE0O30pXG5cbiAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFNjb3JldHNIZWxwZXIoY2FyZHMpO1xuICBsZXQgbmV3Q2FyZHMgPSBjYXJkcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XG4gICAgbGV0IG51bWJlck9mQ2FyZDEgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbY2FyZDEuc2NvcmVzXTtcbiAgICBsZXQgbnVtYmVyT2ZDYXJkMiA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tjYXJkMi5zY29yZXNdO1xuXG4gICAgaWYgKG51bWJlck9mQ2FyZDIgIT0gbnVtYmVyT2ZDYXJkMSkge1xuICAgICAgcmV0dXJuIG51bWJlck9mQ2FyZDIgLSBudW1iZXJPZkNhcmQxO1xuICAgIH1cbiAgICB2YXIgc2NvcmVzMSA9IGNhcmQxLnNjb3JlcyA9PSAxPyAxNDpjYXJkMS5zY29yZXM7XG4gICAgdmFyIHNjb3JlczIgPSBjYXJkMi5zY29yZXMgPT0gMT8gMTQ6Y2FyZDIuc2NvcmVzO1xuICAgIHJldHVybiBzY29yZXMyIC0gc2NvcmVzMTtcbiAgICAvL3JldHVybiBjYXJkMi5zY29yZXMgLSBjYXJkMS5zY29yZXM7XG4gIH0pO1xuICBuZXdDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmKGkuc2NvcmVzID09IDE0KSBpLnNjb3JlcyA9IDE7fSlcbiAgcmV0dXJuIG5ld0NhcmRzLyouY29uY2F0KGNhcmQyMCkqLztcbn07XG5cbktRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMxID0gZnVuY3Rpb24oY2FyZHMpIHtcblxuICBjYXJkcyA9IEtRQ2FyZC5fY2hhbmdlR3VpQ2FyZChjYXJkcyk7XG5cbiAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihpKXtpZihpLnNjb3JlcyA9PSAxKSBpLnNjb3JlcyA9IDE0O30pXG5cbiAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFNjb3JldHNIZWxwZXIoY2FyZHMpO1xuICBsZXQgbmV3Q2FyZHMgPSBjYXJkcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XG4gICAgbGV0IG51bWJlck9mQ2FyZDEgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbY2FyZDEuc2NvcmVzXTtcbiAgICBsZXQgbnVtYmVyT2ZDYXJkMiA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tjYXJkMi5zY29yZXNdO1xuXG4gICAgaWYgKG51bWJlck9mQ2FyZDIgIT0gbnVtYmVyT2ZDYXJkMSkge1xuICAgICAgcmV0dXJuIG51bWJlck9mQ2FyZDEgLSBudW1iZXJPZkNhcmQyO1xuICAgIH1cbiAgICB2YXIgc2NvcmVzMSA9IGNhcmQxLnNjb3JlcyA9PSAxPyAxNDpjYXJkMS5zY29yZXM7XG4gICAgdmFyIHNjb3JlczIgPSBjYXJkMi5zY29yZXMgPT0gMT8gMTQ6Y2FyZDIuc2NvcmVzO1xuICAgIHJldHVybiBzY29yZXMxIC0gc2NvcmVzMjtcbiAgICAvL3JldHVybiBjYXJkMS5zY29yZXMgLSBjYXJkMi5zY29yZXM7XG4gIH0pO1xuICBuZXdDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmKGkuc2NvcmVzID09IDE0KSBpLnNjb3JlcyA9IDE7fSlcbiAgcmV0dXJuIG5ld0NhcmRzO1xufTtcblxuS1FDYXJkLl9jaGFuZ2VHdWlDYXJkID0gZnVuY3Rpb24gKGNhcmRzKSB7XG5cbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuXG4gIHZhciBjYSA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG5cbiAgdmFyIGhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2EpO1xuXG4gIHZhciBzbyA9IDA7XG5cbiAgdmFyIGNvbG9yID0gMTtcblxuICB2YXIgdHlwZSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMpICsgMTtcblxuICB0eXBlID0gdHlwZSA+PSAxMCA/IHR5cGUgOiBcIjBcIiArIHR5cGU7XG5cbiAgaWYodHlwZSA9PSBcIjA1XCIgfHwgdHlwZSA9PSBcIjA5XCIpe1xuXG4gICAgcmV0dXJuIEtRQ2FyZC5fY2hhbmdlQ2FyZFNjb3JzKGNhcmRzKTtcblxuICB9XG4gIGlmKHR5cGUgPT0gXCIwNlwiKXtcblxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XG5cbiAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xuXG4gICAgICBpZih3ID09IDEpIHcgPSAxNDtcblxuICAgICAgaWYobWF4TnVtYmVyID49IGhlbHBlci5tYXhOdW1iZXIoKSAmJiBzbyA8IHBhcnNlSW50KHcpICYmIHBhcnNlSW50KHcpICE9IDIwKXtzbyA9IHBhcnNlSW50KHcpO31cblxuICAgIH1cbiAgICBjb2xvciA9IGNhWzBdLmNvbG9yO1xuXG4gICAgc28gPSBzbyA9PSAxND8gMTogc287XG5cbiAgICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihuKXtcblxuICAgICAgbi5zY29yZXMgPSBzbztcblxuICAgICAgbi5jb2xvclNjb3JlcyA9IGNvbG9yO1xuXG4gICAgfSk7XG5cbiAgfVxuICBpZih0eXBlID09IFwiMDdcIiB8fCB0eXBlID09IFwiMjJcIiB8fCB0eXBlID09IFwiMDhcIiB8fCB0eXBlID09IFwiMTBcIlxuICAgICAgfHwgdHlwZSA9PSBcIjA0XCIgfHwgdHlwZSA9PSBcIjExXCIgfHwgdHlwZSA9PSBcIjAyXCIpe1xuXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcblxuICAgICAgdmFyIG1heE51bWJlciA9IGhlbHBlci5wb2ludE51bWJlcnNbd107XG5cbiAgICAgIGlmKHcgPT0gMSkgdyA9IDE0O1xuXG4gICAgICBpZihtYXhOdW1iZXIgPj0gaGVscGVyLm1heE51bWJlcigpICYmIHNvIDwgcGFyc2VJbnQodykgJiYgcGFyc2VJbnQodykgIT0gMjApe3NvID0gcGFyc2VJbnQodyk7fVxuXG4gICAgfVxuXG4gICAgc28gPSBzbyA9PSAxNCA/IDE6IHNvXG5cbiAgICBjYS5mb3JFYWNoKGZ1bmN0aW9uKG4pe2lmKHNvID09IG4ucG9pbnQgJiYgY29sb3IgPCBuLmNvbG9yKSBjb2xvciA9IG4uY29sb3I7fSk7XG5cbiAgICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihuKXtcblxuICAgICAgbi5zY29yZXMgPSBzbztcblxuICAgICAgbi5jb2xvclNjb3JlcyA9IGNvbG9yO1xuXG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICB9XG5cbiAgcmV0dXJuIGNhcmQyMC5jb25jYXQoY2EpO1xufTtcblxuS1FDYXJkLl9zZXRHdWlDYXJkID0gZnVuY3Rpb24gKGluZGV4LCBzdGFydCwgZW5kLCB0eXBlLCBjYXJkcyAsbm9kZXMsIGNhcmRTcHJpdGVBdGxhcykge1xuICAvL2NjLmxvZyhjYXJkU3ByaXRlQXRsYXMpXG4gIC8vY2MubG9nKCctLS0tLTU5MycpXG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzW2luZGV4XSk7XG5cbiAgdmFyIGNhID0gY2FyZHNbaW5kZXhdLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG5cbiAgdmFyIGhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2EpO1xuXG4gIHZhciBzbyA9IDA7XG5cbiAgdmFyIGNvbG9yID0gMTtcblxuICB2YXIgbm9kZSA9IG5vZGVzLnNsaWNlKHN0YXJ0LCBlbmQpLmZpbHRlcihmdW5jdGlvbihuKXtcblxuICAgIGlmKG4uY2hpbGRyZW5Db3VudCA+IDAgJiYgbi5jaGlsZHJlblswXS5jYXJkTmFtZSl7XG5cbiAgICAgIGlmKHBhcnNlSW50KG4uY2hpbGRyZW5bMF0uY2FyZE5hbWUuc3BsaXQoXCJfXCIpWzFdKSA9PSAyMCkgcmV0dXJuIHRydWU7XG5cbiAgICB9XG4gIH0pO1xuXG4gIGlmKHR5cGUgPT0gXCIwNVwiIHx8IHR5cGUgPT0gXCIwOVwiKXtcblxuICAgIGNhcmRzW2luZGV4XSA9IEtRQ2FyZC5fY2hhbmdlQ2FyZFNjb3JzKGNhcmRzW2luZGV4XSk7XG5cbiAgICBzbyA9IGNhcmRzW2luZGV4XS5maWx0ZXIoZnVuY3Rpb24oaSl7aWYoaS5wb2ludCA9PSAyMClyZXR1cm4gdHJ1ZTt9KS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkuc2NvcmVzID09IDE0PyAxOmkuc2NvcmVzO30pO1xuXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgdmFyIGNhcmROYW1lID0gY2FbMF0uY29sb3IgKyBcIl9cIiArIHNvLnNwbGljZSgwLDEpWzBdO1xuXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG5cbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuXG4gIH1cbiAgaWYodHlwZSA9PSBcIjA2XCIpe1xuXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcblxuICAgICAgdmFyIG1heE51bWJlciA9IGhlbHBlci5wb2ludE51bWJlcnNbd107XG5cbiAgICAgIGlmKHcgPT0gMSkgdyA9IDE0O1xuXG4gICAgICBpZihtYXhOdW1iZXIgPj0gaGVscGVyLm1heE51bWJlcigpICYmIHNvIDwgcGFyc2VJbnQodykgJiYgcGFyc2VJbnQodykgIT0gMjApe3NvID0gcGFyc2VJbnQodyk7fVxuXG4gICAgfVxuXG4gICAgY29sb3IgPSBjYVswXS5jb2xvcjtcblxuICAgIHNvID0gc28gPT0gMTQ/IDE6IHNvO1xuXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgdmFyIGNhcmROYW1lID0gY29sb3IgKyBcIl9cIiArIHNvO1xuXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG5cbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuICB9XG4gIGlmKHR5cGUgPT0gXCIwN1wiIHx8IHR5cGUgPT0gXCIyMlwiIHx8IHR5cGUgPT0gXCIwOFwiIHx8IHR5cGUgPT0gXCIxMFwiXG4gICAgICB8fCB0eXBlID09IFwiMDRcIiB8fCB0eXBlID09IFwiMTFcIiB8fCB0eXBlID09IFwiMDJcIil7XG5cbiAgICBmb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xuXG4gICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcblxuICAgICAgaWYodyA9PSAxKSB3ID0gMTQ7XG5cbiAgICAgIGlmKG1heE51bWJlciA+PSBoZWxwZXIubWF4TnVtYmVyKCkgJiYgc28gPCBwYXJzZUludCh3KSAmJiBwYXJzZUludCh3KSAhPSAyMCl7c28gPSBwYXJzZUludCh3KTt9XG5cbiAgICB9XG5cbiAgICBzbyA9IHNvID09IDE0ID8gMTogc29cblxuICAgIGNhLmZvckVhY2goZnVuY3Rpb24obil7aWYoc28gPT0gbi5wb2ludCAmJiBjb2xvciA8IG4uY29sb3IpIGNvbG9yID0gbi5jb2xvcjt9KTtcblxuICAgIG5vZGUuZm9yRWFjaChmdW5jdGlvbihuKXtcblxuICAgICAgdmFyIGJ0blNwcml0ZSA9IG4uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgIHZhciBjYXJkTmFtZSA9IGNvbG9yICsgXCJfXCIgKyBzbztcblxuICAgICAgdmFyIHBhdGggPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xuXG4gICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUoY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxidG5TcHJpdGUpO1xuXG4gICAgfS5iaW5kKHRoaXMpKTtcblxuXG4gIH1cblxufTtcblxuS1FDYXJkLl9zZXRHdWlDYXJkcyA9IGZ1bmN0aW9uICh0eXBlLCBjYXJkcyAsbm9kZXMsIGNhcmRTcHJpdGVBdGxhcykge1xuICAvL2NjLmxvZyhjYXJkU3ByaXRlQXRsYXMpXG4gIC8vY2MubG9nKCctLS0tLTU5MycpXG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcblxuICB2YXIgY2EgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuXG4gIHZhciBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhKTtcblxuICB2YXIgc28gPSAwO1xuXG4gIHZhciBjb2xvciA9IDE7XG5cbiAgdmFyIG5vZGUgPSBub2Rlcy5zbGljZSgpLmZpbHRlcihmdW5jdGlvbihuKXtcblxuICAgIGlmKG4uY2hpbGRyZW5Db3VudCA+IDAgJiYgbi5jaGlsZHJlblswXS5jYXJkTmFtZSl7XG5cbiAgICAgIGlmKHBhcnNlSW50KG4uY2hpbGRyZW5bMF0uY2FyZE5hbWUuc3BsaXQoXCJfXCIpWzFdKSA9PSAyMCkgcmV0dXJuIHRydWU7XG5cbiAgICB9XG4gIH0pO1xuXG4gIGlmKHR5cGUgPT0gXCIwNVwiIHx8IHR5cGUgPT0gXCIwOVwiKXtcblxuICAgIGNhcmRzID0gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FyZHMpO1xuXG4gICAgc28gPSBjYXJkcy5maWx0ZXIoZnVuY3Rpb24oaSl7aWYoaS5wb2ludCA9PSAyMClyZXR1cm4gdHJ1ZTt9KS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkuc2NvcmVzID09IDE0PyAxOmkuc2NvcmVzO30pO1xuXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgdmFyIGNhcmROYW1lID0gY2FbMF0uY29sb3IgKyBcIl9cIiArIHNvLnNwbGljZSgwLDEpWzBdO1xuXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG5cbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuXG4gIH1cbiAgaWYodHlwZSA9PSBcIjA2XCIpe1xuXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcblxuICAgICAgdmFyIG1heE51bWJlciA9IGhlbHBlci5wb2ludE51bWJlcnNbd107XG5cbiAgICAgIGlmKHcgPT0gMSkgdyA9IDE0O1xuXG4gICAgICBpZihtYXhOdW1iZXIgPj0gaGVscGVyLm1heE51bWJlcigpICYmIHNvIDwgcGFyc2VJbnQodykgJiYgcGFyc2VJbnQodykgIT0gMjApe3NvID0gcGFyc2VJbnQodyk7fVxuXG4gICAgfVxuXG4gICAgY29sb3IgPSBjYVswXS5jb2xvcjtcblxuICAgIHNvID0gc28gPT0gMTQ/IDE6IHNvO1xuXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xuXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcblxuICAgICAgdmFyIGNhcmROYW1lID0gY29sb3IgKyBcIl9cIiArIHNvO1xuXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG5cbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XG5cbiAgICB9LmJpbmQodGhpcykpO1xuICB9XG4gIGlmKHR5cGUgPT0gXCIwN1wiIHx8IHR5cGUgPT0gXCIyMlwiIHx8IHR5cGUgPT0gXCIwOFwiIHx8IHR5cGUgPT0gXCIxMFwiXG4gICAgICB8fCB0eXBlID09IFwiMDRcIiB8fCB0eXBlID09IFwiMTFcIiB8fCB0eXBlID09IFwiMDJcIil7XG5cbiAgICBmb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xuXG4gICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcblxuICAgICAgaWYodyA9PSAxKSB3ID0gMTQ7XG5cbiAgICAgIGlmKG1heE51bWJlciA+PSBoZWxwZXIubWF4TnVtYmVyKCkgJiYgc28gPCBwYXJzZUludCh3KSAmJiBwYXJzZUludCh3KSAhPSAyMCl7c28gPSBwYXJzZUludCh3KTt9XG5cbiAgICB9XG5cbiAgICBzbyA9IHNvID09IDE0ID8gMTogc29cblxuICAgIGNhLmZvckVhY2goZnVuY3Rpb24obil7aWYoc28gPT0gbi5wb2ludCAmJiBjb2xvciA8IG4uY29sb3IpIGNvbG9yID0gbi5jb2xvcjt9KTtcblxuICAgIG5vZGUuZm9yRWFjaChmdW5jdGlvbihuKXtcblxuICAgICAgdmFyIGJ0blNwcml0ZSA9IG4uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgIHZhciBjYXJkTmFtZSA9IGNvbG9yICsgXCJfXCIgKyBzbztcblxuICAgICAgdmFyIHBhdGggPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xuXG4gICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUoY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxidG5TcHJpdGUpO1xuXG4gICAgfS5iaW5kKHRoaXMpKTtcblxuXG4gIH1cblxufTtcblxuS1FDYXJkLl9sb2FkQ2FyZEZyYW1lID0gZnVuY3Rpb24oU3ByaXRlRnJhbWUsIHBhdGgsIFNwcml0ZXNOb2RlLCB3LCBoKSB7XG4gIC8vY2MubG9nKFNwcml0ZUZyYW1lKVxuICAvL2NjLmxvZygnLS0tNzY5JylcbiAgdmFyIFNwcml0ZSA9IFNwcml0ZUZyYW1lLmdldFNwcml0ZUZyYW1lKCBwYXRoICk7XG5cbiAgU3ByaXRlc05vZGUuc3ByaXRlRnJhbWUgPSBTcHJpdGU7XG5cbiAgaWYodykgU3ByaXRlc05vZGUubm9kZS53aWR0aCA9IHc7XG5cbiAgaWYoaCkgU3ByaXRlc05vZGUubm9kZS5oZWlnaHQgPSBoO1xufTtcblxuXG5LUUNhcmQudGVzdFNjb3JlID0gZnVuY3Rpb24oKSB7XG5cbn07IiwiLy8g54mM54K55pWw5biu5Yqp57G7XHJcbi8vIOeUqOadpeiuoeeul+S4gOS4queJjOaVsOe7hOWGheeahOebuOWQjOeCueaVsOeahOeJjOeahOW8oOaVsFxyXG52YXIgS1FDYXJkU2NvcmV0c0hlbHBlciA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdGhpcy5wb2ludE51bWJlcnMgPSB7fTtcclxuICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICBsZXQgcG9pbnQgPSBjYXJkLnNjb3JlcztcclxuICAgICAgICB2YXIgbnVtYmVyID0gdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdIHx8IDA7XHJcbiAgICAgICAgdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdID0gbnVtYmVyICsgMTtcclxuICAgIH0uYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vLyDnm7jlkIzngrnmlbDniYznmoTmnIDlpKfmlbDph49cclxuS1FDYXJkU2NvcmV0c0hlbHBlci5wcm90b3R5cGUubWF4TnVtYmVyID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciByZXN1bHQgPSAwO1xyXG4gIGZvciAobGV0IHByb3AgaW4gdGhpcy5wb2ludE51bWJlcnMpIHtcclxuICAgIGxldCBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twcm9wXTtcclxuICAgICAgLy9pZihudW1iZXIgPCAyMCl7XHJcbiAgICAgICAgICByZXN1bHQgPSBNYXRoLm1heChudW1iZXIsIHJlc3VsdCk7XHJcbiAgICAgIC8vfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufTtcclxuXHJcblxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBLUUNhcmRTY29yZXRzSGVscGVyO1xyXG5cclxuLyp2YXIgY2FyZHMgPSBbXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEwfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTJ9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjE0fVxyXG5dO1xyXG52YXIgdGVzdCA9IG5ldyBLUUNhcmRQb2ludHNTYW1lKGNhcmRzKTtcclxuY29uc29sZS5sb2codGVzdCk7Ki9cclxuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jb25zdCBLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uJyk7XG5cbi8vIOeJjOiHquWKqOmAieaLqeeahOaJqeWxlVxuXG4vKipcbiAqIOiHquWKqOmAieaLqeeJjO+8jOeUseWkp+WIsOWwj1xuICpcbiAqIEBwYXJhbSAge1tLUUNhcmRdfSBvcmlnaW5DYXJkcyAg6KKr6YCJ5oup55qE5Y6f5aeL54mM5pWw57uEXG4gKlxuICogQHJldHVybiB7W0tRQ2FyZF19XG4gKi9cbktRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMgPSBmdW5jdGlvbihvcmlnaW5DYXJkcywgbWF4TGVuZ3RoKSB7XG4gICAgaWYgKG9yaWdpbkNhcmRzLmxlbmd0aCA8PSBtYXhMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG9yaWdpbkNhcmRzO1xuICAgIH1cbiAgICBvcmlnaW5DYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe1xuICAgICAgICBpZihjYXJkLnNjb3JlcyA9PSAxKXtcbiAgICAgICAgICAgIGNhcmQuc2NvcmVzID0gMTQ7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBsZXQgY2FyZHMgPSBvcmlnaW5DYXJkcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24oYSxiKXtcbiAgICAgICAgcmV0dXJuIGEuc2NvcmVzIC0gYi5zY29yZXM7XG4gICAgfSk7XG5cbiAgICBsZXQgZmluZEZ1bmNzID0gW1xuICAgICAgICBLUUNhcmQuZmluZFd1VG9uZyxcbiAgICAgICAgS1FDYXJkLmZpbmRUb25nSHVhU2h1bixcbiAgICAgICAgS1FDYXJkLmZpbmRUaWVaaGksXG4gICAgICAgIEtRQ2FyZC5maW5kSHVMdSxcbiAgICAgICAgS1FDYXJkLmZpbmRUb25nSHVhLFxuICAgICAgICBLUUNhcmQuZmluZFNodW5aaSxcbiAgICAgICAgS1FDYXJkLmZpbmRTYW5UaWFvLFxuICAgICAgICBLUUNhcmQuZmluZExpYUR1aSxcbiAgICAgICAgS1FDYXJkLmZpbmREdWlaaVxuICAgIF07XG5cbiAgICBsZXQgaW5kZXhBcnJheXMgPSBudWxsO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmluZEZ1bmNzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGxldCBmdW5jID0gZmluZEZ1bmNzW2ldO1xuICAgICAgICBpbmRleEFycmF5cyA9IChmdW5jLmJpbmQoS1FDYXJkKSkoY2FyZHMpO1xuICAgICAgICBpZiAoaW5kZXhBcnJheXMgJiYgaW5kZXhBcnJheXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgaW5kZXhzID0gW107XG4gICAgaWYgKGluZGV4QXJyYXlzICYmIGluZGV4QXJyYXlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8g5om+5Ye65ZCM57G75Z6L55qE54mM6YeM55qE5YiG5pWw5pyA5aSn55qE54mMXG4gICAgICAgIHZhciBtYXhTY29yZSA9IDA7XG4gICAgICAgIGluZGV4QXJyYXlzLmZvckVhY2godGVtcEluZGV4cyA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ZW1wQ2FyZHMgPSB0ZW1wSW5kZXhzLm1hcChpbmRleCA9PiBjYXJkc1tpbmRleF0pO1xuICAgICAgICBjb25zdCBzY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHModGVtcENhcmRzKTtcbiAgICAgICAgaWYgKHNjb3JlID4gbWF4U2NvcmUpIHtcbiAgICAgICAgICAgIG1heFNjb3JlID0gc2NvcmU7XG4gICAgICAgICAgICBpbmRleHMgPSB0ZW1wSW5kZXhzO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgfVxuXG4gICAgbGV0IHRhcmdldENhcmRzID0gaW5kZXhzLm1hcChmdW5jdGlvbihpbmRleCkge1xuICAgICAgICByZXR1cm4gY2FyZHNbaW5kZXhdO1xuICAgIH0pO1xuXG4gICAgLyppZiAodGFyZ2V0Q2FyZHMubGVuZ3RoIDwgbWF4TGVuZ3RoKSB7XG4gICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXModGFyZ2V0Q2FyZHMpO1xuICAgICB3aGlsZSh0YXJnZXRDYXJkcy5sZW5ndGggPCBtYXhMZW5ndGgpIHtcbiAgICAgdGFyZ2V0Q2FyZHMucHVzaChjYXJkcy5wb3AoKSk7XG4gICAgIH1cbiAgICAgfSBlbHNlICovaWYgKHRhcmdldENhcmRzLmxlbmd0aCA+IG1heExlbmd0aCkge1xuICAgICAgICB0YXJnZXRDYXJkcyA9IHRhcmdldENhcmRzLnNsaWNlKDAsIG1heExlbmd0aCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRhcmdldENhcmRzIHx8IFtdO1xufTtcblxuS1FDYXJkLnRlc3RBdXRvU2VsZWN0ID0gZnVuY3Rpb24oY2FyZHMpIHtcblxufTsiLCJjb25zdCBLUUNhcmRDb2xvcnNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRDb2xvcnNIZWxwZXInKTtcbmNvbnN0IEtRQ2FyZFBvaW50c0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFBvaW50c0hlbHBlcicpO1xuY29uc3QgTnVtYmVyRXh0ZW5zaW9uID0gcmVxdWlyZSgnTnVtYmVyRXh0ZW5zaW9uJyk7XG5jb25zdCBHZXRDYXJkUG9pbnRzU2FtZUNvdW50ID0gcmVxdWlyZSgnR2V0Q2FyZFBvaW50c1NhbWVDb3VudCcpO1xuXG5jYyA9IGNjIHx8IHt9O1xuY2MuYXNzZXJ0ID0gY2MuYXNzZXJ0IHx8IGNvbnNvbGUuYXNzZXJ0IHx8IGZ1bmN0aW9uICgpIHt9O1xuY2MubG9nID0gY2MubG9nIHx8IGNvbnNvbGUubG9nIHx8IGZ1bmN0aW9uICgpIHt9O1xuY2MuZXJyb3IgPSBjYy5lcnJvciB8fCBjb25zb2xlLmVycm9yIHx8IGZ1bmN0aW9uICgpIHt9O1xuXG4vLyDniYwgTW9kZWwg57G777yM5bCB6KOF5LqG6Iqx6Imy5ZKM54K55pWwXG4vLyDkvb/nlKjvvJpcbi8vIG5ldyBLUUNhcmQoMjIpO1xudmFyIEtRQ2FyZCA9IGZ1bmN0aW9uIChwb2ludCwgY29sb3IgLGluZGV4KSB7XG4gICAgdGhpcy5jb2xvciA9IG51bGw7XG4gICAgdGhpcy5wb2ludCA9IG51bGw7XG4gICAgdGhpcy5zaW5kZXggPSBpbmRleDtcbiAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQgPSBmdW5jdGlvbiAoY29sb3IsIHBvaW50KSB7XG4gICAgICAgIGlmIChjb2xvciA9PSAncycpIHsgY29sb3IgPSA0O31cbiAgICAgICAgaWYgKGNvbG9yID09ICdoJykgeyBjb2xvciA9IDM7fVxuICAgICAgICBpZiAoY29sb3IgPT0gJ2MnKSB7IGNvbG9yID0gMjt9XG4gICAgICAgIGlmIChjb2xvciA9PSAnZCcpIHsgY29sb3IgPSAxO31cblxuICAgICAgICB0aGlzLnBvaW50ID0gTnVtYmVyKHBvaW50KTtcbiAgICAgICAgdGhpcy5zY29yZXMgPSBOdW1iZXIocG9pbnQpO1xuICAgICAgICB0aGlzLmNvbG9yID0gTnVtYmVyKGNvbG9yKTtcbiAgICAgICAgdGhpcy5jb2xvclNjb3JlcyA9IE51bWJlcihjb2xvcik7XG5cbiAgICAgICAgY2MuYXNzZXJ0KHRoaXMucG9pbnQgPiAwKTtcbiAgICAgICAgY2MuYXNzZXJ0KHRoaXMuY29sb3IgPiAwKTtcbiAgICB9O1xuXG4gICAgdGhpcy5faW5pdFdpdGhOdW1iZXIgPSBmdW5jdGlvbiAobnVtYmVyKSB7XG4gICAgICAgIHRoaXMucG9pbnQgPSBNYXRoLmZsb29yKG51bWJlciAvIDEwKTtcbiAgICAgICAgdGhpcy5jb2xvciA9IG51bWJlciAlIDEwO1xuICAgICAgICBjYy5hc3NlcnQodGhpcy5wb2ludCA+IDApO1xuICAgICAgICBjYy5hc3NlcnQodGhpcy5jb2xvciA+IDApO1xuICAgIH07XG5cbiAgICB0aGlzLl9pbml0V2l0aE9iamVjdCA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgICAgaWYgKG9iamVjdC5wb2ludCkge1xuICAgICAgICAgICAgdGhpcy5faW5pdFdpdGhDb2xvckFuZFBvaW50KG9iamVjdC5jb2xvciwgb2JqZWN0LnBvaW50KTtcbiAgICAgICAgfSBlbHNlIGlmIChvYmplY3Quc3VpdCkge1xuICAgICAgICAgICAgdGhpcy5faW5pdFdpdGhDb2xvckFuZFBvaW50KG9iamVjdC5zdWl0LCBvYmplY3QubnVtYmVyKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jYXJkTmFtZSgpO1xuICAgIH07XG5cbiAgICB0aGlzLmNhcmROYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb2xvciArIFwiX1wiICsgdGhpcy5wb2ludDtcbiAgICB9O1xuXG4gICAgdGhpcy5zb3J0ID0gZnVuY3Rpb24gKG90aGVyQ2FyZCwgYXNjID0gZmFsc2UsIEFpc01heCA9IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5zb3J0KHRoaXMsIG90aGVyQ2FyZCwgYXNjLCBBaXNNYXgpO1xuICAgIH07XG5cbiAgICB0aGlzLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXJDYXJkKSB7XG4gICAgICAgIGlmICghb3RoZXJDYXJkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICh0aGlzLnBvaW50ID09IG90aGVyQ2FyZC5wb2ludCkgJiYgKHRoaXMuY29sb3IgPT0gb3RoZXJDYXJkLmNvbG9yKVxuICAgICAgICAgICAgJiYgKHRoaXMuc2luZGV4ID09IG90aGVyQ2FyZC5zaW5kZXgpO1xuICAgIH07XG5cbiAgICBpZiAocG9pbnQgJiYgY29sb3IpIHtcbiAgICAgICAgdGhpcy5faW5pdFdpdGhDb2xvckFuZFBvaW50KGNvbG9yLCBwb2ludCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgbnVtYmVyID0gTnVtYmVyKHBvaW50KTtcbiAgICBpZiAoIU51bWJlci5pc05hTihudW1iZXIpKSB7XG4gICAgICAgIHRoaXMuX2luaXRXaXRoTnVtYmVyKG51bWJlcik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mKHBvaW50KSA9PSAnc3RyaW5nJykge1xuICAgICAgICAvLyDop6PmnpAgeHh4eGRfZCDlvaLlvI9cbiAgICAgICAgbGV0IGZvdW5kID0gcG9pbnQubWF0Y2goLyhcXC4pKlxcZF9cXGQrLyk7XG4gICAgICAgIGlmICgoZm91bmQgaW5zdGFuY2VvZiBBcnJheSkgJiYgZm91bmQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGZvdW5kWzBdO1xuICAgICAgICAgICAgbGV0IG51bWJlcnMgPSByZXN1bHQuc3BsaXQoJ18nKTtcblxuICAgICAgICAgICAgbGV0IGNvbG9yID0gTnVtYmVyKG51bWJlcnNbMF0pO1xuICAgICAgICAgICAgbGV0IHBvaW50ID0gTnVtYmVyKG51bWJlcnNbMV0pO1xuXG4gICAgICAgICAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQoY29sb3IsIHBvaW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mKHBvaW50KSA9PSAnb2JqZWN0Jykge1xuICAgICAgICB0aGlzLl9pbml0V2l0aE9iamVjdChwb2ludCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYy5lcnJvcihcIuWIneWni+WMlumUmeivr++8mlwiICsgcG9pbnQgKyBcIiBcIiArIGNvbG9yKTtcbn07XG5cbi8vIOi9rOaNouaIkOacjeWKoeWZqOeahOeJjCBtb2RlbFxuS1FDYXJkLnByb3RvdHlwZS50b1NlcnZlckNhcmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgJ3N1aXQnOiB0aGlzLmNvbG9yLFxuICAgICAgICAnbnVtYmVyJzogdGhpcy5wb2ludCxcbiAgICB9O1xufTtcblxuS1FDYXJkLkNPTE9SX1NQQURFICAgPSA0O1xuS1FDYXJkLkNPTE9SX0hFQVJUICAgPSAzO1xuS1FDYXJkLkNPTE9SX0NMVUIgICAgPSAyO1xuS1FDYXJkLkNPTE9SX0RJQU1PTkQgPSAxO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEtRQ2FyZDtcblxuS1FDYXJkLmNhcmRzRnJvbUFycmF5ID0gZnVuY3Rpb24gKGNhcmROYW1lcykge1xuICAgIHJldHVybiBjYXJkTmFtZXMubWFwKGZ1bmN0aW9uIChjYXJkTmFtZSxpbmRleCkge1xuICAgICAgICByZXR1cm4gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICB9KTtcbn07XG5cbi8vIOWwhuWkmuW8oOeJjOi9rOaNouaIkOacjeWKoeWZqOeahOW9ouW8j1xuS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgcmV0dXJuIGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC50b1NlcnZlckNhcmQoKTtcbiAgICB9KTtcbn07XG5cbktRQ2FyZC5UWVBFID0ge1xuICAgIFd1TG9uZzogMCxcbiAgICBEdWlaaTogMSxcbiAgICBMaWFuZ0R1aTogMixcbiAgICBTYW5UaWFvOiAzLFxuICAgIFNodW5aaTogNCxcbiAgICBUb25nSHVhOiA1LFxuICAgIEh1THU6IDYsXG4gICAgVGllWmhpOiA3LFxuICAgIFRvbmdIdWFTaHVuOiA4LFxuICAgIC8qIyMjIyMqL1xuICAgIFd1VG9uZzo5LFxuICAgIC8qIyMjIyMqL1xuICAgIFNhblRhb0h1YTogMTAsICAvLyDnibnmrorniYxcbiAgICBTYW5TaHVuWmk6IDExLFxuICAgIExpdUR1aUJhbjogMTIsXG5cbiAgICBXdUR1aVNhblRpYW86MTMsXG4gICAgU2lUYW9TYW5UaWFvOiAxNCxcblxuICAgIENvdVlpU2U6IDE1LFxuICAgIFNhbkZlblRpYW5YaWE6IDE2LFxuICAgIFNhblRvbmdIdWFTaHVuOiAxNyxcbiAgICBZaVRpYW9Mb25nOiAxOCxcbiAgICBRaW5nTG9uZzogMTksXG59O1xuXG4vLyDniYznsbvlnovlkI1cbktRQ2FyZC5jYXJkc1R5cGVOYW1lID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IG5hbWVzID0gWyfkuYzpvpknLCAn5a+55a2QJywgJ+S4pOWvuScsICfkuInmnaEnLCAn6aG65a2QJywgJ+WQjOiKsScsICfokavoiqYnLCAn6ZOB5pSvJywgJ+WQjOiKsemhuicsICfkupTlkIwnLFxuICAgICAgICAn5LiJ5ZCM6IqxJywgJ+S4iemhuuWtkCcsJ+WFreWvueWNiicsICfkupTlr7nkuInmnaEnLCAn5Zub5aWX5LiJ5p2hJyxcbiAgICAgICAgJ+WHkeS4gOiJsicsJ+S4ieWIhuWkqeS4iycsICfkuInlkIzoirHpobonLCAn5LiA5p2h6b6ZJywgJ+a4hem+mSddO1xuICAgIGxldCB0eXBlID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkcyk7XG4gICAgcmV0dXJuIG5hbWVzW3R5cGVdO1xufTtcblxuLy8g5om+5Ye654mM55qE57G75Z6LXG5LUUNhcmQuY2FyZHNUeXBlID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKEtRQ2FyZC5pc1FpbmdMb25nKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuUWluZ0xvbmc7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1lpVGlhb0xvbmcoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5ZaVRpYW9Mb25nO1xuICAgIH1cblxuICAgIC8vaWYgKEtRQ2FyZC5pc1NhblRvbmdIdWFTaHVuKGNhcmRzKSkge1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5Ub25nSHVhU2h1bjtcbiAgICAvL31cbiAgICAvL1xuICAgIC8vaWYgKEtRQ2FyZC5pc1NhbkZlblRpYW5YaWEoY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNhbkZlblRpYW5YaWE7XG4gICAgLy99XG5cbiAgICBpZiAoS1FDYXJkLmlzTGl1RHVpQmFuKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuTGl1RHVpQmFuO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuaXNTYW5Ub25nSHVhKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuVGFvSHVhO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuaXNTYW5TaHVuWmkoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5TaHVuWmk7XG4gICAgfVxuXG5cbiAgICAvL2lmIChLUUNhcmQuaXNDb3VZaVNlKGNhcmRzKSkge1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5Db3VZaVNlO1xuICAgIC8vfVxuICAgIC8vXG4gICAgLy9pZiAoS1FDYXJkLmlzV3VEdWlTYW5UaWFvKGNhcmRzKSkge1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5XdUR1aVNhblRpYW87XG4gICAgLy99XG4gICAgLy9cbiAgICAvL2lmIChLUUNhcmQuaXNTaVRhb1NhblRpYW8oY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNpVGFvU2FuVGlhbztcbiAgICAvL31cblxuICAgIC8qIyMjIyMqL1xuICAgIGlmIChLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcywgNSkpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1VG9uZztcbiAgICB9XG5cbiAgICAvL2lmIChLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcykpIHtcbiAgICAvLyAgICByZXR1cm4gS1FDYXJkLlRZUEUuV3VUb25nO1xuICAgIC8vfVxuICAgIC8vXG4gICAgLy9pZiAoS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1VG9uZztcbiAgICAvL31cbiAgICAvKiMjIyMjKi9cblxuICAgIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRzLCA1KSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuVG9uZ0h1YVNodW47XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuVGllWmhpO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpbkh1THUoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5IdUx1O1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWEoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5Ub25nSHVhO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpblNodW5aaShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNodW5aaTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5TYW5UaWFvKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuVGlhbztcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5MaWFuZ0R1aTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5EdWlaaShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLkR1aVppO1xuICAgIH1cblxuICAgIHJldHVybiBLUUNhcmQuVFlQRS5XdUxvbmc7XG59O1xuXG4vLyDliKTmlq3mmK/lkKbmmK/lkIzoirFcbktRQ2FyZC5pc1RvbmdIdWEgPSBmdW5jdGlvbihjYXJkcywgbWluTGVuZ3RoID0gMykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBjb2xvcnMgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgcmV0dXJuIGNhcmQuY29sb3I7XG4gICAgfSk7XG5cbiAgICBsZXQgY29sb3IgPSBjb2xvcnNbMF07XG4gICAgZm9yIChsZXQgaW5kZXggaW4gY29sb3JzKSB7XG4gICAgICAgIGxldCBlID0gY29sb3JzW2luZGV4XTtcbiAgICAgICAgaWYgKGUgIT0gY29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbi8vIOaYr+WQpuWMheWQq+WQjOiKsVxuS1FDYXJkLmNvbnRhaW5Ub25nSHVhID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vaWYgKEtRQ2FyZC5maW5kVG9uZ0h1YShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIC8vcmV0dXJuIGZhbHNlO1xuICAgIGNhcmRzID0gQXJyYXkuZnJvbShjYXJkcyk7XG4gICAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuXG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgICBtaW5MZW5ndGggPSBtaW5MZW5ndGgtY2FyZDIwLmxlbmd0aDtcblxuICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbWluTGVuZ3RoKSA8PSBjYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgICAgbGV0IHN1YkNhcmRzID0gY2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbWluTGVuZ3RoKTtcbiAgICAgICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWEoc3ViQ2FyZHMsIG1pbkxlbmd0aCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy9yZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhMjAoY2FyZHMpO1xufTtcbktRQ2FyZC5jb250YWluVG9uZ0h1YTIwID0gZnVuY3Rpb24gKGNhcmQpIHtcbiAgICBpZiAoY2FyZC5sZW5ndGggPCA1KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZCk7XG4gICAgdmFyIGNhcmRzID0gY2FyZC5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAgIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcblxuICAgIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gICAgICAgIHZhciBudW0gPSA1IC0gajtcbiAgICAgICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IGNhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuICAgICAgICAgICAgdmFyIHN1YkNhcmRzID0gY2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcbiAgICAgICAgICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBudW0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcbi8vIOWIpOaWreaYr+WQpuaYr+mhuuWtkFxuS1FDYXJkLmlzU2h1blppID0gZnVuY3Rpb24oY2FyZHMsIG1pbkxlbmd0aCA9IDMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLl9pc1NodW5aaUFLUShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgbGV0IHBvaW50cyA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC5wb2ludDtcbiAgICB9KS5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgcmV0dXJuIG4xIC0gbjI7XG4gICAgfSk7XG5cbiAgICB2YXIgcG9pbnQgPSBwb2ludHNbMF07XG4gICAgZm9yICh2YXIgaW5kZXggaW4gcG9pbnRzKSB7XG4gICAgICAgIHZhciBlID0gcG9pbnRzW2luZGV4XTtcbiAgICAgICAgaWYgKGUgIT0gcG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHBvaW50ID0gcG9pbnQgKyAxO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufTtcblxuLy8g5Yik5pat5piv5ZCm5pivIEEgSyBRIEogMTAg6L+Z5Liq6aG65a2QXG5LUUNhcmQuX2lzU2h1blppQUtRID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IGNhcmRzLmxlbmd0aDtcbiAgICBpZiAobGVuZ3RoLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBwb2ludDFzID0gWzFdO1xuICAgIGxldCBwb2ludDE0cyA9IFsxNF07XG4gICAgbGV0IHBvaW50SyA9IDEzO1xuXG4gICAgTnVtYmVyKGxlbmd0aCAtIDEpLmtxX3RpbWVzKGZ1bmN0aW9uKHRpbWVzKSB7XG4gICAgICAgIHBvaW50MXMucHVzaChwb2ludEsgLSB0aW1lcyk7XG4gICAgICAgIHBvaW50MTRzLnB1c2gocG9pbnRLIC0gdGltZXMpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIEtRQ2FyZC5faXNDYXJkc0NvbnRhaW5Qb2ludHMoY2FyZHMsIHBvaW50MXMpIHx8IEtRQ2FyZC5faXNDYXJkc0NvbnRhaW5Qb2ludHMoY2FyZHMsIHBvaW50MTRzKTtcbn07XG5cbi8vIGNhcmRzIOS4reaYr+WQpuWMheWQqyBwb2ludHMg6L+Z5Lqb54K55pWwXG5cbktRQ2FyZC5faXNDYXJkc0NvbnRhaW5Qb2ludHMgPSBmdW5jdGlvbihjYXJkcywgcG9pbnRzKSB7XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHBvaW50cy5sZW5ndGg7ICsraW5kZXgpIHtcbiAgICAgICAgbGV0IHBvaW50ID0gcG9pbnRzW2luZGV4XTtcbiAgICAgICAgbGV0IHBvaW50Q2FyZEluZGV4ID0gY2FyZHMuZmluZEluZGV4KGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgICAgIHJldHVybiBjYXJkLnBvaW50ID09IHBvaW50O1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocG9pbnRDYXJkSW5kZXggPCAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5LUUNhcmQuY29udGFpbjIwID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYoY2FyZHMubGVuZ3RoIDw9IDApe1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5wb2ludCkgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICBjYXJkcyA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkcyk7XG4gICAgfVxuICAgIHZhciBuZXdDYXJkID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGNhcmQpey8v6YeN5paw6LWL5YC8Y2FyZHNcbiAgICAgICAgaWYoY2FyZC5wb2ludCA+PSAyMCl7XG4gICAgICAgICAgICByZXR1cm4gY2FyZDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBuZXdDYXJkIHx8IFtdO1xufTtcbi8vIOaYr+WQpuWMheWQq+mhuuWtkFxuS1FDYXJkLmNvbnRhaW5TaHVuWmkgPSBmdW5jdGlvbiAoY2FyZHMsIG1pbkxlbmd0aCA9IDUpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKEtRQ2FyZC5maW5kU2h1blppKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gICAgLy9sZXQgdW5pcXVlQ2FyZHMgPSBjYXJkcy51bmlxdWUoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XG4gICAgLy8gICAgcmV0dXJuIGNhcmQxLnBvaW50ID09IGNhcmQyLnBvaW50O1xuICAgIC8vfSk7XG4gICAgLy91bmlxdWVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XG4gICAgLy9cbiAgICAvL2xldCBtaW5Qb2ludENhcmQgPSB1bmlxdWVDYXJkc1swXTtcbiAgICAvL2lmIChtaW5Qb2ludENhcmQucG9pbnQgPT0gMSkge1xuICAgIC8vICAgIGxldCBBUGx1c0NhcmQgPSBuZXcgS1FDYXJkKG1pblBvaW50Q2FyZCk7XG4gICAgLy8gICAgQVBsdXNDYXJkLnBvaW50ID0gMTQ7XG4gICAgLy8gICAgdW5pcXVlQ2FyZHMucHVzaChBUGx1c0NhcmQpO1xuICAgIC8vfVxuICAgIC8vXG4gICAgLy9mb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG1pbkxlbmd0aCkgPD0gdW5pcXVlQ2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgLy8gICAgbGV0IHN1YkNhcmRzID0gdW5pcXVlQ2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbWluTGVuZ3RoKTtcbiAgICAvLyAgICBpZiAoS1FDYXJkLmlzU2h1blppKHN1YkNhcmRzLCBtaW5MZW5ndGgpKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICAvL1xuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluU2h1blppMjAoY2FyZHMpO1xufTtcbi8qS1FDYXJkLmNvbnRhaW5TaHVuWmkyMCA9IGZ1bmN0aW9uIChjYXJkKSB7XG4gaWYgKGNhcmQubGVuZ3RoIDwgNSkge1xuIHJldHVybiBmYWxzZTtcbiB9XG4gdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZCk7XG4gdmFyIGNhcmRzID0gY2FyZC5rcV9leGNsdWRlcyhjYXJkMjApO1xuIC8vIOWFiOagueaNrueCueaVsOWOu+mHjVxuIHZhciBuZXdBcnIgPSBbXTtcbiB2YXIgbmV3QXJycyA9IFtdO1xuIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspIHtcbiBpZiAobmV3QXJycy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSkge1xuIG5ld0Fyci5wdXNoKGNhcmRzW2ldKTtcbiBuZXdBcnJzLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuIH1cbiB9XG4gLy9uZXdBcnIuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcbiAvLyAgICBpZihjYXJkLnNjb3JlcyA9PSAxNCl7XG4gLy8gICAgICAgIGNhcmQuc2NvcmVzID0gMTtcbiAvLyAgICB9XG4gLy99KVxuIG5ld0Fyci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiByZXR1cm4gbjEucG9pbnQgLSBuMi5wb2ludDtcbiB9KTtcbiBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xuIHZhciBudW0gPSA1IC0gajtcbiBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gbmV3QXJyLmxlbmd0aDsgKytzdGFydCkge1xuIHZhciBzdWJDYXJkcyA9IG5ld0Fyci5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuIHZhciBib29sID0gcGFyc2VJbnQoc3ViQ2FyZHNbbnVtLTFdWydzY29yZXMnXSkgLSBwYXJzZUludChzdWJDYXJkc1swXVsnc2NvcmVzJ10pIDwgNTtcbiBpZihib29sKXtcbiByZXR1cm4gdHJ1ZTtcbiB9XG4gfVxuIH1cbiAvLyDnlLHkuo7ngrnmlbDmmK/llK/kuIDkuJTljYfluo/vvIzlj6rpnIDopoHkvp3mrKHpgY3ljobliKTmlq3mmK/lkKbmmK/pobrlrZDljbPlj69cbiBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmQpO1xuIGlmIChjYXJkID09PSBjb252ZXJ0ZWRDYXJkcykge1xuIHJldHVybiBmYWxzZTtcbiB9XG4gcmV0dXJuIEtRQ2FyZC5jb250YWluU2h1blppMjAoY29udmVydGVkQ2FyZHMpO1xuIH07Ki9cbi8vIOaYr+WQpuaYr+WQjOiKsemhulxuS1FDYXJkLmlzVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICByZXR1cm4gS1FDYXJkLmlzVG9uZ0h1YShjYXJkcykgJiYgS1FDYXJkLmlzU2h1blppKGNhcmRzKTtcbn07XG5cbi8vIOaYr+WQpuWMheWQq+acieWQjOiKsemhulxuS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkcywgbWluTGVuZ3RoID0gNSkge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoS1FDYXJkLmZpbmRUb25nSHVhU2h1bihjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICAgIC8vdmFyIHNhblNodW5aaSA9IEtRQ2FyZC5zYW5TaHVuWmkxKGNhcmRzLG1pbkxlbmd0aClbMF07XG4gICAgLy9pZihzYW5TaHVuWmkgPT0gbnVsbCl7XG4gICAgLy8gICAgcmV0dXJuIGZhbHNlO1xuICAgIC8vfVxuICAgIC8vdmFyIHJlc3VsdCA9IGZhbHNlO1xuICAgIC8vZm9yKHZhciBpPTA7aTxzYW5TaHVuWmkubGVuZ3RoO2krKykge1xuICAgIC8vICAgIHZhciBzID0gc2FuU2h1blppW2ldO1xuICAgIC8vICAgIGlmIChLUUNhcmQuaXNUb25nSHVhU2h1bihzLCBtaW5MZW5ndGgpKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMShjYXJkcyk7XG5cbn07XG4vKktRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4xID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XG4gaWYgKGNhcmRzLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuIHJldHVybiBmYWxzZTtcbiB9XG4gbGV0IHRlbXBDYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcbiBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG1pbkxlbmd0aCkgPD0gdGVtcENhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuIGxldCBzdWJDYXJkcyA9IHRlbXBDYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBtaW5MZW5ndGgpO1xuIGlmIChLUUNhcmQuaXNUb25nSHVhU2h1bihzdWJDYXJkcywgbWluTGVuZ3RoKSkge1xuIHJldHVybiB0cnVlO1xuIH1cbiB9XG5cbiBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRzKTtcbiBpZiAoY2FyZHMgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4yMChjYXJkcyk7XG4gfVxuIHJldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMShjb252ZXJ0ZWRDYXJkcyk7XG4gLy9yZXR1cm4gZmFsc2U7XG4gfTtcbiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMjAgPSBmdW5jdGlvbiAoY2FyZCwgbWluTGVuZ3RoID0gNSkge1xuIGlmIChjYXJkLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuIHJldHVybiBmYWxzZTtcbiB9XG4gdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZCkgfHwgW107XG4gdmFyIGNhcmRzID0gY2FyZC5rcV9leGNsdWRlcyhjYXJkMjApO1xuXG4gY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRzKTtcbiB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gdmFyIGNvbG9ySCA9IFtdOyAvL+e6ouW/g1xuIHZhciBjb2xvckMgPSBbXTsgLy/mooXoirFcbiB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gdmFyIHBvaW50UyA9IFtdOyAvL+m7keahg1xuIHZhciBwb2ludEggPSBbXTsgLy/nuqLlv4NcbiB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXG4gdmFyIHBvaW50RCA9IFtdOyAvL+aWueWdl1xuIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XG4gaWYoY2FyZHNbaV0uY29sb3IgPT0gJzQnKXtcbiBpZihwb2ludFMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuIHBvaW50Uy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiBjb2xvclMucHVzaChjYXJkc1tpXSk7XG4gfVxuXG4gfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzMnKXtcbiBpZihwb2ludEguaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuIHBvaW50SC5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gfVxuIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcyJyl7XG4gaWYocG9pbnRDLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiBwb2ludEMucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuIH1cbiB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMScpe1xuIGlmKHBvaW50RC5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gcG9pbnRELnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiB9XG4gfVxuIH1cblxuIHZhciBjb2xvciA9IFtjb2xvclMsY29sb3JILGNvbG9yQyxjb2xvckRdO1xuIHZhciBjb2xvclN1bSA9IFtdOyAgICAvL+aAu+WFseacieWHoOenjeiKseiJsiBbNSwzLDAuLi4uXVxuIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gaWYoY29sb3JbaV0ubGVuZ3RoID49IHBhcnNlSW50KDUgLSBjYXJkMjAubGVuZ3RoKSl7XG4gLy9jb2xvcltpXS5mb3JFYWNoKGZ1bmN0aW9uKGNhKXtcbiAvLyAgICBpZihjYS5zY29yZXMgPT0gMTQpe1xuIC8vICAgICAgICBjYS5zY29yZXMgPSAxO1xuIC8vICAgIH1cbiAvL30pXG4gY29sb3JbaV0uc29ydChmdW5jdGlvbihhMSxhMil7XG4gcmV0dXJuIGExIC0gYTI7XG4gfSlcbiBjb2xvclN1bS5wdXNoKGNvbG9yW2ldKTtcbiB9XG4gfVxuXG4gZm9yKHZhciBpPTA7aTxjb2xvclN1bS5sZW5ndGg7aSsrKSB7XG4gdmFyIHMgPSBjb2xvclN1bVtpXVxuIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gdmFyIG51bSA9IDUgLSBqO1xuIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbnVtKSA8PSBzLmxlbmd0aDsgKytzdGFydCkge1xuIHZhciBzdWJDYXJkcyA9IHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcbiB2YXIgYm9vbCA9IHBhcnNlSW50KHN1YkNhcmRzW251bS0xXVsnc2NvcmVzJ10pIC0gcGFyc2VJbnQoc3ViQ2FyZHNbMF1bJ3Njb3JlcyddKSA8IDU7XG4gaWYoYm9vbCl7XG4gcmV0dXJuIHRydWU7XG4gfVxuIH1cbiB9XG4gfVxuXG5cblxuIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZCk7XG4gaWYgKGNhcmQgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gcmV0dXJuIGZhbHNlO1xuIH1cbiByZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bjIwKGNvbnZlcnRlZENhcmRzKTtcbiB9OyovXG5cblxuLy8g5piv5ZCm5piv5riF6b6ZXG5LUUNhcmQuaXNRaW5nTG9uZyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSAxMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgdmFyIGNvbG9yUyA9IFtdOyAvL+m7keahg1xuICAgIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgICB2YXIgY29sb3JDID0gW107IC8v5qKF6IqxXG4gICAgdmFyIGNvbG9yRCA9IFtdOyAvL+aWueWdl1xuICAgIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ3MnKXtcbiAgICAgICAgICAgIGNvbG9yUy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnaCcpe1xuICAgICAgICAgICAgY29sb3JILnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5zdWl0ID09ICdjJyl7XG4gICAgICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2QnKXtcbiAgICAgICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgbHMgPSBjb2xvclMubGVuZ3RoOyAgLy/pu5HmoYPkuKrmlbBcbiAgICB2YXIgbGggPSBjb2xvckgubGVuZ3RoOyAgLy/nuqLmoYPkuKrmlbBcbiAgICB2YXIgbGMgPSBjb2xvckMubGVuZ3RoOyAgLy/mooXoirHkuKrmlbBcbiAgICB2YXIgbGQgPSBjb2xvckQubGVuZ3RoOyAgLy/mlrnlnZfkuKrmlbBcbiAgICB2YXIgY29sb3IgPSBbbHMsbGgsbGMsbGRdO1xuICAgIHZhciBjb2xvclN1bSA9IFtdOyAgICAvL+aAu+WFseacieWHoOenjeiKseiJsiBbNSwzLDAuLi4uXVxuICAgIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKGNvbG9yW2ldICE9IDApe1xuICAgICAgICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYoY29sb3JTdW0ubGVuZ3RoID09IDEpe1xuICAgICAgICBpZihjb2xvclN1bVswXSA9PSAxMyl7XG5cbiAgICAgICAgICAgIGlmKEtRQ2FyZC5pc1lpVGlhb0xvbmcoY2FyZHMpKXtcblxuICAgICAgICAgICAgICAgIHZhciB0ZVNodUNhcmQgPSBjYXJkcy5maWx0ZXIoZnVuY3Rpb24oaSl7cmV0dXJuIGl9KTtcblxuICAgICAgICAgICAgICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheSh0ZVNodUNhcmQpO1xuXG4gICAgICAgICAgICAgICAgdGVTaHVDYXJkLmZvckVhY2goZnVuY3Rpb24oYSl7XG4gICAgICAgICAgICAgICAgICAgIGlmKGEuc2NvcmVzID09IDEpIGEuc2NvcmVzID0gMTQ7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0ZVNodUNhcmQuc29ydChmdW5jdGlvbihhLGIpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYi5zY29yZXMgLSBhLnNjb3JlcztcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyh0ZVNodUNhcmQpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGExID0gdGVTaHVDYXJkLnNwbGljZSgwLDUpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGEyID0gdGVTaHVDYXJkLnNwbGljZSgwLDUpO1xuXG4gICAgICAgICAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9IFt0ZVNodUNhcmQsIGEyLCBhMV07XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuICAgIC8vcmV0dXJuIEtRQ2FyZC5pc1RvbmdIdWFTaHVuKGNhcmRzKTtcbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG4vLyDmmK/lkKbmmK/kuIDmnaHpvplcbktRQ2FyZC5pc0xvbmcgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiBLUUNhcmQuaXNTaHVuWmkoY2FyZHMpO1xufTtcblxuLyojIyMjIyovXG4vKuaYr+WQpuS4gOadoem+mSovXG5LUUNhcmQuaXNZaVRpYW9Mb25nID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgLy9jYXJkczp7bnVtYmVyOjF+MTMgLCdzdWl0JzonaCcuLi59XG4gICAgdmFyIGxlbmd0aCA9IDEzO1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZih0eXBlb2YoY2FyZHNbMF0ubnVtYmVyKSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKGNhcmRzKTtcbiAgICB9XG4gICAgdmFyIG51bWJlciA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC5udW1iZXI7XG4gICAgfSkuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgIH0pO1xuICAgIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoLTE7aSsrKSB7XG4gICAgICAgIGlmKG51bWJlcltpXSAhPSBudW1iZXJbaSsxXSAtIDEpe1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHRlU2h1Q2FyZCA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaX0pO1xuXG4gICAgdGVTaHVDYXJkID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KHRlU2h1Q2FyZCk7XG5cbiAgICB0ZVNodUNhcmQuZm9yRWFjaChmdW5jdGlvbihhKXtcbiAgICAgICAgaWYoYS5zY29yZXMgPT0gMSkgYS5zY29yZXMgPSAxNDtcbiAgICB9KTtcblxuICAgIHRlU2h1Q2FyZC5zb3J0KGZ1bmN0aW9uKGEsYil7XG4gICAgICAgIHJldHVybiBiLnNjb3JlcyAtIGEuc2NvcmVzO1xuICAgIH0pO1xuXG4gICAgdGVTaHVDYXJkID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKHRlU2h1Q2FyZCk7XG5cbiAgICB2YXIgYTEgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XG5cbiAgICB2YXIgYTIgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XG5cbiAgICBjYy50ZVNodVBhaUNhcmRzID0gW3RlU2h1Q2FyZCwgYTIsIGExXTtcbiAgICAvL2NjLmxvZyhjYy50ZVNodVBhaUNhcmRzIClcbiAgICAvL2NjLmxvZygnLS0tLS0tLS03MjgnKVxuICAgIHJldHVybiB0cnVlO1xufTtcbi8qIyMjIyMqL1xuLyrmmK/lkKbkuInlkIzoirEqL1xuS1FDYXJkLmlzU2FuVG9uZ0h1YSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZihjYXJkc1swXS5zdWl0KSA9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XG4gICAgfVxuICAgIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcbiAgICB2YXIgY29sb3JIID0gW107IC8v57qi5b+DXG4gICAgdmFyIGNvbG9yQyA9IFtdOyAvL+aiheiKsVxuICAgIHZhciBjb2xvckQgPSBbXTsgLy/mlrnlnZdcbiAgICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihjYXJkc1tpXS5zdWl0ID09ICdzJyl7XG4gICAgICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2gnKXtcbiAgICAgICAgICAgIGNvbG9ySC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnYycpe1xuICAgICAgICAgICAgY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5zdWl0ID09ICdkJyl7XG4gICAgICAgICAgICBjb2xvckQucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIGxzID0gY29sb3JTLmxlbmd0aDsgIC8v6buR5qGD5Liq5pWwXG4gICAgdmFyIGxoID0gY29sb3JILmxlbmd0aDsgIC8v57qi5qGD5Liq5pWwXG4gICAgdmFyIGxjID0gY29sb3JDLmxlbmd0aDsgIC8v5qKF6Iqx5Liq5pWwXG4gICAgdmFyIGxkID0gY29sb3JELmxlbmd0aDsgIC8v5pa55Z2X5Liq5pWwXG4gICAgdmFyIHNhbkNhcmQgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcbiAgICB2YXIgdGVTaHVDYXJkID0gW107XG4gICAgdmFyIGNvbG9yID0gW2xzLGxoLGxjLGxkXTtcbiAgICB2YXIgY29sb3JTdW0gPSBbXTsgICAgLy/mgLvlhbHmnInlh6Dnp43oirHoibIgWzUsMywwLi4uLl1cbiAgICBmb3IodmFyIGk9MDtpPGNvbG9yLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihjb2xvcltpXSAhPSAwKXtcbiAgICAgICAgICAgIGNvbG9yU3VtLnB1c2goY29sb3JbaV0pO1xuICAgICAgICAgICAgdGVTaHVDYXJkLnB1c2goc2FuQ2FyZFtpXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL+S4ieenjeiKseiJslxuICAgIGlmKGNvbG9yU3VtLmxlbmd0aCA9PSAzKXtcbiAgICAgICAgZm9yKHZhciBpPTA7aTxjb2xvclN1bS5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAgICBpZiAoY29sb3JTdW1baV0gIT0gNSAmJiBjb2xvclN1bVtpXSAhPSAzKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGVTaHVDYXJkLnNvcnQoZnVuY3Rpb24oYSxiKXtcbiAgICAgICAgICAgIHJldHVybiBhLmxlbmd0aCAtIGIubGVuZ3RoO1xuICAgICAgICB9KTtcbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9IHRlU2h1Q2FyZDtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcblxufTtcbi8q5piv5ZCm5YeR5LiA6ImyKi9cbktRQ2FyZC5pc0NvdVlpU2UgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gMTM7XG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5zdWl0KSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XG4gICAgfVxuICAgIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcbiAgICB2YXIgY29sb3JIID0gW107IC8v57qi5b+DXG4gICAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY2FyZHNbaV0uc3VpdCA9PSAncycgfHwgY2FyZHNbaV0uc3VpdCA9PSAnYycpe1xuICAgICAgICAgICAgY29sb3JTLnB1c2goY2FyZHNbaV0pOy8v5YWo6buRXG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2gnIHx8IGNhcmRzW2ldLnN1aXQgPT0gJ2QnKXtcbiAgICAgICAgICAgIGNvbG9ySC5wdXNoKGNhcmRzW2ldKTsvL+WFqOe6olxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy/lpoLmnpzniYzkuK3ljIXlkKvlm5vnp43oirHoibLlsLHkuI3lj6/og73mmK/kuInlkIzoirFcbiAgICBpZihjb2xvclMubGVuZ3RoID09IDEzIHx8IGNvbG9ySC5sZW5ndGggPT0gMTMpe1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy9lbHNlIGlmKGNvbG9ySC5sZW5ndGggPT0gMTMpe1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG4vKiMjIyMjKi9cbi8vIOaYr+WQpuaYr+WFreWvueWNilxuS1FDYXJkLmlzTGl1RHVpQmFuID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEyO1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBkdWlaaUxlbmd0aCA9IDI7XG4gICAgLy/orqHnrpfkuIDkuKrniYzmlbDnu4TlhoXnmoTnm7jlkIzngrnmlbDnmoTniYznmoTlvKDmlbBcbiAgICBsZXQgY2FyZE51bWJlcnMgPSBuZXcgR2V0Q2FyZFBvaW50c1NhbWVDb3VudChjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mRHVpWmkgPSAwO1xuICAgIGxldCBudW1iZXJPZllpID0gMDtcbiAgICBmb3IgKGxldCBwcm9wIGluIGNhcmROdW1iZXJzKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IGNhcmROdW1iZXJzW3Byb3BdO1xuICAgICAgICBpZiAodmFsdWUgPT0gZHVpWmlMZW5ndGggfHwgdmFsdWUgPT0gMykge1xuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IDQpIHtcbiAgICAgICAgICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMjtcbiAgICAgICAgfVxuICAgICAgICAvL2Vsc2UgaWYgKHZhbHVlID09IDYgfHwgdmFsdWUgPT0gNyB8fCB2YWx1ZSA9PSA1KSB7XG4gICAgICAgIC8vICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMDtcbiAgICAgICAgLy99XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IDEpIHtcbiAgICAgICAgICAgIG51bWJlck9mWWkgKz0gMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmKG51bWJlck9mRHVpWmkgPT0gNil7XG5cbiAgICAgICAgdmFyIHRlU2h1Q2FyZCA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaX0pO1xuXG4gICAgICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheSh0ZVNodUNhcmQpO1xuXG4gICAgICAgIHRlU2h1Q2FyZC5mb3JFYWNoKGZ1bmN0aW9uKGEpe1xuICAgICAgICAgICAgaWYoYS5zY29yZXMgPT0gMSkgYS5zY29yZXMgPSAxNDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVTaHVDYXJkLnNvcnQoZnVuY3Rpb24oYSxiKXtcbiAgICAgICAgICAgIHJldHVybiBiLnNjb3JlcyAtIGEuc2NvcmVzO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZVNodUNhcmQgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHModGVTaHVDYXJkKTtcblxuICAgICAgICB2YXIgYTEgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XG5cbiAgICAgICAgdmFyIGEyID0gdGVTaHVDYXJkLnNwbGljZSgwLDUpO1xuXG4gICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMgPSBbdGVTaHVDYXJkLCBhMiwgYTFdO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5LUUNhcmQuaXNXdUR1aVNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGR1aVppTGVuZ3RoID0gMjtcbiAgICBsZXQgc2FuVGlhb0xlbmd0aCA9IDM7XG4gICAgLy/orqHnrpfkuIDkuKrniYzmlbDnu4TlhoXnmoTnm7jlkIzngrnmlbDnmoTniYznmoTlvKDmlbBcbiAgICBsZXQgY2FyZE51bWJlcnMgPSBuZXcgR2V0Q2FyZFBvaW50c1NhbWVDb3VudChjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mRHVpWmkgPSAwO1xuICAgIGxldCBudW1iZXJPZlNhblRpYW8gPSAwO1xuICAgIGZvciAobGV0IHByb3AgaW4gY2FyZE51bWJlcnMpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gY2FyZE51bWJlcnNbcHJvcF07XG4gICAgICAgIGlmICh2YWx1ZSA9PSBkdWlaaUxlbmd0aCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IHNhblRpYW9MZW5ndGgpIHtcbiAgICAgICAgICAgIG51bWJlck9mU2FuVGlhbyA9IG51bWJlck9mU2FuVGlhbyArIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPj0gNCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAyO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudW1iZXJPZkR1aVppID09IDUgJiYgbnVtYmVyT2ZTYW5UaWFvID09IDE7XG59O1xuXG4vL+WIpOaWrTXlvKDmiJbogIUz5byg5piv5ZCm6aG65a2QXG5LUUNhcmQuaXNTaHVuWmkxID0gZnVuY3Rpb24oYXJyKXtcbiAgICAvL2NvbnNvbGUubG9nKGFycik7XG4gICAgZm9yKHZhciBpPTA7aTxhcnIubGVuZ3RoLTE7aSsrKXtcbiAgICAgICAgaWYoYXJyW2krMV0gLSBhcnJbaV0gIT0gMSl7XG4gICAgICAgICAgICAvL+S4jeaYr+mhuuWtkFxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIuS4jeaYr+mhuuWtkFwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbktRQ2FyZC5pc1NhblNodW5aaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZih0eXBlb2YoY2FyZHNbMF0uc3VpdCkgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICBjYXJkcyA9IEtRQ2FyZC5fY29udmVydENhcmRzVG9DYXJkTmFtZXMoY2FyZHMpO1xuICAgIH1cblxuICAgIC8v5Y+W5Ye654mM55qE54K55pWwXG4gICAgdmFyIG51bWJlciA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC5udW1iZXI7XG4gICAgfSk7XG4gICAgLy/mjpLluo9cbiAgICBudW1iZXIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgIH0pO1xuICAgIGlmKEtRQ2FyZC5mZW5aaHUobnVtYmVyLDUsNSkgPT0gZmFsc2Upe1xuICAgICAgICB2YXIgbnVtYmVyID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FyZC5udW1iZXI7XG4gICAgICAgIH0pO1xuICAgICAgICAvL+aOkuW6j1xuICAgICAgICBudW1iZXIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmKEtRQ2FyZC5mZW5aaHUobnVtYmVyLDUsMykgPT0gZmFsc2Upe1xuICAgICAgICAgICAgdmFyIG51bWJlciA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYXJkLm51bWJlcjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy/mjpLluo9cbiAgICAgICAgICAgIG51bWJlci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYoS1FDYXJkLmZlblpodShudW1iZXIsMyw1KSA9PSBmYWxzZSl7XG4gICAgICAgICAgICAgICAgLy/kuI3mmK/kuInpobrlrZBcbiAgICAgICAgICAgICAgICB2YXIgQUlzRXhpc3QgPSBmYWxzZTsgIC8v5piv5ZCm5a2Y5ZyoQVxuICAgICAgICAgICAgICAgIGZvcih2YXIgaSBpbiBjYXJkcykge1xuICAgICAgICAgICAgICAgICAgICBpZihjYXJkc1tpXS5udW1iZXIgPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQUlzRXhpc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIuWtmOWcqEFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZighQUlzRXhpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIumAgOWHuumAkuW9klwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvcih2YXIgaSBpbiBjYXJkcykge1xuICAgICAgICAgICAgICAgICAgICBpZihjYXJkc1tpXS5udW1iZXIgPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkHovazkuLoxNFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRzW2ldLm51bWJlciA9IDE0O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoY2MudGVTaHVQYWlDYXJkcyAmJiBjYy50ZVNodVBhaUNhcmRzLmxlbmd0aCA+IDAgJiYgY2MudGVTaHVQYWlDYXJkc1swXVswXSAgJiYgdHlwZW9mKGNjLnRlU2h1UGFpQ2FyZHNbMF1bMF0pID09ICdudW1iZXInKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0NhcmRzID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpO30pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q2FyZHMxID0gY2MudGVTaHVQYWlDYXJkcy5tYXAoZnVuY3Rpb24oYXJyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWQgPSBhcnIubWFwKGZ1bmN0aW9uKG51bWJlcil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IG5ld0NhcmRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobmV3Q2FyZHNbaV0ubnVtYmVyID09IG51bWJlcil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3Q2FyZHMuc3BsaWNlKGksMSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhZDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMgPSBuZXdDYXJkczE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBLUUNhcmQuaXNTYW5TaHVuWmkoY2FyZHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmKGNjLnRlU2h1UGFpQ2FyZHMgJiYgY2MudGVTaHVQYWlDYXJkcy5sZW5ndGggPiAwICYmIGNjLnRlU2h1UGFpQ2FyZHNbMF1bMF0gICYmIHR5cGVvZihjYy50ZVNodVBhaUNhcmRzWzBdWzBdKSA9PSAnbnVtYmVyJyl7XG4gICAgICAgIHZhciBuZXdDYXJkcyA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaTt9KTtcbiAgICAgICAgdmFyIG5ld0NhcmRzMSA9IGNjLnRlU2h1UGFpQ2FyZHMubWFwKGZ1bmN0aW9uKGFycil7XG4gICAgICAgICAgICB2YXIgY2FkID0gYXJyLm1hcChmdW5jdGlvbihudW1iZXIpe1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBuZXdDYXJkcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgIGlmKG5ld0NhcmRzW2ldLm51bWJlciA9PSBudW1iZXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld0NhcmRzLnNwbGljZShpLDEpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjYWQ7XG4gICAgICAgIH0pO1xuICAgICAgICBjYy50ZVNodVBhaUNhcmRzID0gbmV3Q2FyZHMxO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbi8v5YiG57uENTUzfHw1MzV8fDM1NVxuS1FDYXJkLmZlblpodSA9IGZ1bmN0aW9uIChudW1iZXIsbnVtMSxudW0yKSAge1xuICAgIHZhciBhcnIxID0gW107XG4gICAgdmFyIGFycjIgPSBbXTtcbiAgICB2YXIgYXJyMyA9IFtdO1xuICAgIGZvcih2YXIgaT0wO2k8bnVtYmVyLmxlbmd0aC0xO2krKyl7XG4gICAgICAgIGlmKGkgPT0gMCl7XG4gICAgICAgICAgICBhcnIxLnB1c2gobnVtYmVyWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBpZihudW1iZXJbaSsxXSAtIG51bWJlcltpXSA9PSAwKXtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGFycjEucHVzaChudW1iZXJbaSsxXSk7XG4gICAgICAgIGlmKGFycjEubGVuZ3RoID09IG51bTEpe1xuICAgICAgICAgICAgLy/lj5bnrKzkuIDnu4TmmK/pobrlrZBcbiAgICAgICAgICAgIGlmKEtRQ2FyZC5pc1NodW5aaTEoYXJyMSkpe1xuICAgICAgICAgICAgICAgIC8v6L+ZNeS4quaYr+mhuuWtkCzku47mlbDnu4TkuK3np7vpmaRcbiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDtpPGFycjEubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaj0wO2o8bnVtYmVyLmxlbmd0aDtqKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IGFycjFbaV0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Lik5Liq5pWw5LiA5qC355qE5Y+q5Yig6Zmk5LiA5LiqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IG51bWJlcltqKzFdKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlci5zcGxpY2UoaiwxKTsgICAgLy/ku45udW1iZXLkuK3np7vpmaRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKmNvbnNvbGUubG9nKFwi5Yig6Zmk56ys5LiA57uE5ZCO55qEbnVtYmVyXCIpO1xuICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhudW1iZXIpOyovXG4gICAgICAgICAgICAgICAgLy/mjqXkuIvmnaXlj5bnrKzkuoznu4RcbiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDtpPG51bWJlci5sZW5ndGgtMTtpKyspe1xuICAgICAgICAgICAgICAgICAgICBpZihpID09IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJyMi5wdXNoKG51bWJlclswXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2krMV0gLSBudW1iZXJbaV0gPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhcnIyLnB1c2gobnVtYmVyW2krMV0pO1xuICAgICAgICAgICAgICAgICAgICBpZihhcnIyLmxlbmd0aCA9PSBudW0yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL+WPluesrOS6jOe7hOaYr+mhuuWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEtRQ2FyZC5pc1NodW5aaTEoYXJyMikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDtpPGFycjIubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaj0wO2o8bnVtYmVyLmxlbmd0aDtqKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IGFycjJbaV0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Lik5Liq5pWw5LiA5qC355qE5Y+q5Yig6Zmk5LiA5LiqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IG51bWJlcltqKzFdKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlci5zcGxpY2UoaiwxKTsgICAgLy/ku45udW1iZXLkuK3np7vpmaRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKmNvbnNvbGUubG9nKFwi5Yig6Zmk56ys5LqM57uE5ZCO55qEbnVtYmVyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhudW1iZXIpOyovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyMyA9IG51bWJlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+aOpeS4i+adpeWwseaYr+WJqeS4i+eahOS6hlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKEtRQ2FyZC5pc1NodW5aaTEoYXJyMykpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+esrOS4iee7hOS5n+aYr+mhuuWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNkZiA9IFthcnIxLGFycjIsYXJyM107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNkZi5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtyZXR1cm4gbjEubGVuZ3RoIC0gbjIubGVuZ3RoO30pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFjYy50ZVNodVBhaUNhcmRzKSBjYy50ZVNodVBhaUNhcmRzID0gYXNkZjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/nrKzkuInnu4TkuI3mmK/pobrlrZBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL+esrOS6jOe7hOS4jeaYr+mhuuWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy/nrKzkuIDnu4TkuI3mmK/pobrlrZBcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvL+WmguaenOWPluS4jeWIsG51bTHkuKrmlbBcbiAgICBpZihhcnIxLmxlbmd0aCA8IG51bTEpe1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmKGFycjIubGVuZ3RoIDwgbnVtMil7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59O1xuXG5LUUNhcmQuaXNTYW5TaHVuWmkxID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdmFyIGxlbmd0aCA9IDEzO1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZih0eXBlb2YoY2FyZHNbMF0ucG9pbnQpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZHMpO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNhcmRzID0gQXJyYXkuZnJvbShjYXJkcyk7XG4gICAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpO1xuICAgIHZhciB3ZWkgPSBbXTtcbiAgICB2YXIgemhvbmcgPSBbXTtcbiAgICB2YXIgdG91ID0gW107XG4gICAgdmFyIHNhblNodW5aaSA9IEtRQ2FyZC5zYW5TaHVuWmkxKGNhcmRzKVswXTsvL+iOt+WPluaJgOaciee7hOWQiOeahOWktOmBk1xuICAgIGlmKCFzYW5TaHVuWmkpeyAvL+S9oOi/nuWktOmBk+mDveayoeaciSDmgI7kuYjmm7TmiJHmt7dcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHZhciBuZXdDYXJkID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpey8v6YeN5paw6LWL5YC8Y2FyZHNcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgfSk7XG4gICAgdmFyIG5ld0NhcmRzMSA9IFtdO1xuICAgIHZhciBuZXdQb2ludCA9IFtdOy8v5Yik5patcG9pbnTmmK/lkKbnm7jlkIxcbiAgICB2YXIgZHVpWmkgPSBbXTsvL+WPluWHuuacieWvueWtkOW9k+S4reeahOS4gOW8oOeJjFxuICAgIGZvcih2YXIgcyBpbiBjYXJkcyl7XG4gICAgICAgIGlmKG5ld1BvaW50LmluZGV4T2YoY2FyZHNbc10ucG9pbnQpPDApe1xuICAgICAgICAgICAgbmV3Q2FyZHMxLnB1c2goY2FyZHNbc10pO1xuICAgICAgICAgICAgbmV3UG9pbnQucHVzaChjYXJkc1tzXS5wb2ludCk7XG4gICAgICAgIH1lbHNley8v5Y+W5Ye65pyJ5a+55a2Q5b2T5Lit55qE5LiA5byg54mMXG4gICAgICAgICAgICBkdWlaaS5wdXNoKGNhcmRzW3NdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2FuU2h1blppLmxlbmd0aDsgKytqKSB7Ly/lvqrnjq/miYDmnInlpLTpgZNcbiAgICAgICAgdmFyIG51bWJlcjMgPSBzYW5TaHVuWmlbal07XG4gICAgICAgIGlmKHR5cGVvZihudW1iZXIzKSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgKGkpIDwgY2FyZHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBuZXdDYXJkcyA9IG5ld0NhcmRzMS5maWx0ZXIoZnVuY3Rpb24oaSl7Ly/ph43mlrDotYvlgLxjYXJkc1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG5ld0NhcmRzID0gbmV3Q2FyZHMua3FfZXhjbHVkZXMobnVtYmVyMyk7Ly/liKDpmaTniYzph4znmoTlpLTpgZNcbiAgICAgICAgICAgIGlmICh3ZWkubGVuZ3RoICE9IDUpIHtcbiAgICAgICAgICAgICAgICBsZXQgc3ViQ2FyZHMgPSBuZXdDYXJkcy5zbGljZShpLCBpICsgNSk7XG4gICAgICAgICAgICAgICAgaWYgKHN1YkNhcmRzLmxlbmd0aCA9PSA1IHx8IEtRQ2FyZC5pc1NodW5aaShzdWJDYXJkcykpIHsvL+W+l+WIsOWwvumBkyDliKDpmaTniYzph4znmoTlsL7pgZNcbiAgICAgICAgICAgICAgICAgICAgd2VpID0gc3ViQ2FyZHM7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhudW1iZXIzKVxuICAgICAgICAgICAgICAgICAgICAvLyBjYy5sb2cobmV3Q2FyZHMxKVxuICAgICAgICAgICAgICAgICAgICAvLyBjYy5sb2coc3ViQ2FyZHMpXG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhuZXdDYXJkcylcbiAgICAgICAgICAgICAgICAgICAgLy8gY2MubG9nKGkpXG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZygnLS0tLS03MTYnKVxuICAgICAgICAgICAgICAgICAgICBuZXdDYXJkcyA9IG5ld0NhcmRzLmtxX2V4Y2x1ZGVzKHN1YkNhcmRzKTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYod2VpLmxlbmd0aCA9PSA1KXsvL+aKiuWJqeS9meeahOeJjOWSjOWvueWtkOeahOWNleW8oOWQiOW5tlxuICAgICAgICAgICAgICAgIGxldCB0YXNrcyA9IGR1aVppLmZpbHRlcihmdW5jdGlvbihpKXsvL+mHjeaWsOi1i+WAvOWvueWtkFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0YXNrcyA9IHRhc2tzLmtxX2V4Y2x1ZGVzKG51bWJlcjMpOy8v5Yik5pat5aS06YGT5ZKM5a+55a2Q55qE5Y2V5byg5piv5ZCm5pyJ55u45ZCMIOacieeahOivneWwseWIoOmZpFxuICAgICAgICAgICAgICAgIG5ld0NhcmRzID0gbmV3Q2FyZHMuY29uY2F0KHRhc2tzKTsvL+aKiuWJqeS9meeahOeJjOWSjOWvueWtkOeahOWNleW8oOWQiOW5tlxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoemhvbmcubGVuZ3RoICE9IDUgJiYgbmV3Q2FyZHMubGVuZ3RoID09IDUpIHtcbiAgICAgICAgICAgICAgICBpZiAoS1FDYXJkLmlzU2h1blppKG5ld0NhcmRzKSkgey8v5piv5LiJ6aG65a2QXG4gICAgICAgICAgICAgICAgICAgIHpob25nID0gbmV3Q2FyZHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYod2VpLmxlbmd0aCA9PSA1ICYmIHpob25nLmxlbmd0aCA9PSA1ICl7Ly/mmK/kuInpobrlrZDnu4jmraLlvqrnjq9cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7Ly/mnaXlkKcg57un57ut5ZCnXG4gICAgICAgICAgICAgICAgemhvbmcgPSBbXTt3ZWkgPSBbXTt0b3UgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZih3ZWkubGVuZ3RoID09IDUgJiYgemhvbmcubGVuZ3RoID09IDUgKXsvL+aYr+S4iemhuuWtkOe7iOatouW+queOr1xuICAgICAgICAgICAgdG91ID0gbnVtYmVyMztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7Ly/mnaXlkKcg57un57ut5ZCnXG4gICAgICAgICAgICB6aG9uZyA9IFtdO3dlaSA9IFtdO3RvdSA9IFtdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2FyZHMgPSBuZXdDYXJkO1xuICAgIGlmIChLUUNhcmQuX2lzU2FuU2h1blppKHRvdSx6aG9uZyx3ZWkpKSB7Ly/mmK/kuInpobrlrZBcbiAgICAgICAgdG91ID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKHRvdSk7XG4gICAgICAgIHpob25nID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKHpob25nKTtcbiAgICAgICAgd2VpID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKHdlaSk7XG5cbiAgICAgICAgaWYoIWNjLnRlU2h1UGFpQ2FyZHMpIGNjLnRlU2h1UGFpQ2FyZHMgPSBbdG91LHpob25nLHdlaV07XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRzKTtcbiAgICBpZiAoY2FyZHMgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gICAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24oYSl7XG4gICAgICAgICAgICBpZihhLnBvaW50ID09IDE0KSBhLnBvaW50ID0gMTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gS1FDYXJkLmlzU2FuU2h1blppMShjYXJkcyk7XG4gICAgfVxuICAgIHJldHVybiBLUUNhcmQuaXNTYW5TaHVuWmkoY29udmVydGVkQ2FyZHMpO1xufTtcblxuS1FDYXJkLnNhblNodW5aaTEgPSBmdW5jdGlvbiAoY2FyZHMsbGVuZ3RoID0gMykge1xuICAgIHZhciBzaHVuemkgPSBLUUNhcmQuZmluZFNodW5aaShjYXJkcyxsZW5ndGgpO1xuICAgIHZhciBjYXJkc1QgPSBbXTtcbiAgICB2YXIgY2FyZHNJbmRleCA9IFtdO1xuICAgIGlmKHNodW56aSA9PSBudWxsKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgc2h1bnppLmxlbmd0aDtpKyspe1xuICAgICAgICB2YXIgYSA9IHNodW56aVtpXTtcbiAgICAgICAgdmFyIGNhcmRzU2h1bnppID0gW107XG4gICAgICAgIC8vIHZhciBjYXJkc0luZGV4ID0gW107XG4gICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCBhLmxlbmd0aDtqKyspe1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gYVtqXTtcbiAgICAgICAgICAgIGlmKHR5cGVvZihjYXJkc1tpbmRleF0pID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhcmRzU2h1bnppLnB1c2goY2FyZHNbaW5kZXhdKTtcblxuICAgICAgICB9XG4gICAgICAgIGNhcmRzSW5kZXgucHVzaChhKTtcbiAgICAgICAgY2FyZHNULnB1c2goY2FyZHNTaHVuemkpO1xuICAgIH1cbiAgICByZXR1cm4gW2NhcmRzVCxjYXJkc0luZGV4XTtcbn07XG5cbktRQ2FyZC5faXNTYW5TaHVuWmkgPSBmdW5jdGlvbiAodG91Q2FyZHMsIHpob25nQ2FyZHMsIHdlaUNhcmRzKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5pc1NodW5aaSh0b3VDYXJkcykgJiYgS1FDYXJkLmlzU2h1blppKHpob25nQ2FyZHMpXG4gICAgICAgICYmIEtRQ2FyZC5pc1NodW5aaSh3ZWlDYXJkcyk7XG59O1xuLy8g5piv5ZCm5piv5LiJ5ZCM6Iqx6aG6XG5LUUNhcmQuaXNTYW5Ub25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGV0IGNvbG9yQ2FyZHNPYmplY3QgPSBLUUNhcmQuX2NvbG9yQ2xhc3NDYXJkcyhjYXJkcyk7XG5cbiAgICB2YXIgc3ViQ2FyZHMgPSBbXTtcbiAgICBmb3IgKGxldCBwcm9wIGluIGNvbG9yQ2FyZHNPYmplY3QpIHtcbiAgICAgICAgbGV0IGNhcmRzID0gY29sb3JDYXJkc09iamVjdFtwcm9wXTtcbiAgICAgICAgc3ViQ2FyZHMucHVzaChjYXJkcyk7XG4gICAgfVxuXG4gICAgaWYgKHN1YkNhcmRzLmxlbmd0aCAhPSAzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLnNvcnQoZnVuY3Rpb24gKHMxLCBzMikge1xuICAgICAgICByZXR1cm4gczEubGVuZ3RoID4gczIubGVuZ3RoO1xuICAgIH0pO1xuXG4gICAgbGV0IHRvdUNhcmRzID0gc3ViQ2FyZHNbMF07XG4gICAgbGV0IHpob25nQ2FyZHMgPSBzdWJDYXJkc1sxXTtcbiAgICBsZXQgd2VpQ2FyZHMgPSBzdWJDYXJkc1syXTtcblxuICAgIGlmICgodG91Q2FyZHMubGVuZ3RoICE9IDMpIHx8ICh6aG9uZ0NhcmRzLmxlbmd0aCAhPSA1KSB8fCAod2VpQ2FyZHMubGVuZ3RoICE9IDUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gS1FDYXJkLl9pc1NhblRvbmdIdWFTaHVuKHRvdUNhcmRzLCB6aG9uZ0NhcmRzLCB3ZWlDYXJkcyk7XG59O1xuXG4vLyDlsIbniYzmoLnmja4gY29sb3Ig6L+b6KGM5YiG57G7XG5LUUNhcmQuX2NvbG9yQ2xhc3NDYXJkcyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBjb2xvckNhcmRzT2JqZWN0ID0ge307XG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICBsZXQgY29sb3IgPSBjYXJkLmNvbG9yO1xuICAgICAgICB2YXIgc3ViQ2FyZHMgPSBjb2xvckNhcmRzT2JqZWN0W2NvbG9yXTtcbiAgICAgICAgaWYgKCFzdWJDYXJkcykge1xuICAgICAgICAgICAgc3ViQ2FyZHMgPSBbXTtcbiAgICAgICAgICAgIGNvbG9yQ2FyZHNPYmplY3RbY29sb3JdID0gc3ViQ2FyZHM7XG4gICAgICAgIH1cbiAgICAgICAgc3ViQ2FyZHMucHVzaChjYXJkKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBjb2xvckNhcmRzT2JqZWN0O1xufTtcblxuLy8g5piv5ZCm5piv5LiJ5ZCM6Iqx6aG6XG5LUUNhcmQuX2lzU2FuVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAodG91Q2FyZHMsIHpob25nQ2FyZHMsIHdlaUNhcmRzKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHRvdUNhcmRzKSAmJiBLUUNhcmQuaXNUb25nSHVhU2h1bih6aG9uZ0NhcmRzKVxuICAgICAgICAmJiBLUUNhcmQuaXNUb25nSHVhU2h1bih3ZWlDYXJkcyk7XG59O1xuXG5cbi8vIOaYr+WQpuaYryDigJzkuInliIblpKnkuIvigJ1cbktRQ2FyZC5pc1NhbkZlblRpYW5YaWEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHRpZVpoaUxlbmd0aCA9IDQ7XG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mVGllWmhpID0gMDtcbiAgICBmb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgICBsZXQgdmFsdWUgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF07XG4gICAgICAgIGlmICh2YWx1ZSA9PSB0aWVaaGlMZW5ndGgpIHtcbiAgICAgICAgICAgIG51bWJlck9mVGllWmhpID0gbnVtYmVyT2ZUaWVaaGkgKyAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudW1iZXJPZlRpZVpoaSA9PT0gMztcbn07XG5cblxuLy8g5piv5ZCm5pivIOKAnOWbm+Wll+S4ieadoeKAnVxuS1FDYXJkLmlzU2lUYW9TYW5UaWFvID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEzO1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBsZXQgc2FuVGlhb0xlbmd0aCA9IDM7XG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mU2FuVGlhbyA9IDA7XG4gICAgZm9yIChsZXQgcHJvcCBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3Byb3BdO1xuICAgICAgICBpZiAodmFsdWUgPT0gc2FuVGlhb0xlbmd0aCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZTYW5UaWFvID0gbnVtYmVyT2ZTYW5UaWFvICsgMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudW1iZXJPZlNhblRpYW8gPT0gNDtcbn07XG5cblxuLy8g5piv5ZCm5pivIOKAnOS4ieahg+iKseKAnVxuLy8g5aS044CB5Lit44CB5bC+6YGT5Li655u45ZCM6Iqx6Imy55qE54mMXG5LUUNhcmQuaXNTYW5UYW9IdWEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGxldCBjb2xvckhlbHBlciA9IG5ldyBLUUNhcmRDb2xvcnNIZWxwZXIoY2FyZHMpO1xuICAgIHZhciBjb2xvck51bWJlcnMgPSBbXTtcbiAgICBmb3IgKGxldCBwcm9wIGluIGNvbG9ySGVscGVyLmNvbG9yTnVtYmVyKSB7XG4gICAgICAgIGNvbG9yTnVtYmVycy5wdXNoKGNvbG9ySGVscGVyLmNvbG9yTnVtYmVyW3Byb3BdKTtcbiAgICB9XG5cbiAgICBjb2xvck51bWJlcnMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgIH0pO1xuXG4gICAgaWYgKGNvbG9yTnVtYmVycy5sZW5ndGggIT0gMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKGNvbG9yTnVtYmVyc1swXSA9PSAzXG4gICAgICAgICYmIChjb2xvck51bWJlcnNbMV0gPT0gNSlcbiAgICAgICAgJiYgKGNvbG9yTnVtYmVyc1syXSA9PSA1KSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5cbi8vIOWIpOaWreaYr+WQpuWMheWQq+mTgeaUr1xuLy8g5Zub5byg5ZCM5qC354K55pWw55qE54mMXG5LUUNhcmQuY29udGFpblRpZVpoaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSA0O1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAgIGxlbmd0aCA9IGxlbmd0aC1jYXJkMjAubGVuZ3RoO1xuICAgIGxldCBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcblxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xuICAgICAgICBpZihtYXhOdW1iZXIgPj0gbGVuZ3RoKXtcbiAgICAgICAgICAgIGNhcmQyMC5mb3JFYWNoKGZ1bmN0aW9uKGNhKXtcbiAgICAgICAgICAgICAgICBjYS5zY29yZXMgPSBwYXJzZUludCh3KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy9pZihoZWxwZXIubWF4TnVtYmVyKCkgPj0gbGVuZ3RoKXtcbiAgICAvLyAgICByZXR1cm4gaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aDtcbiAgICAvL31cbiAgICAvLyBlbHNle1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuY29udGFpbkd1aVBhaShjYXJkcyw0KTtcbiAgICAvL31cbiAgICAvL2lmIChLUUNhcmQuZmluZFRpZVpoaShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cblxuLy8g5Yik5pat5piv5ZCm5piv6ZOB5pSvXG5LUUNhcmQuaXNUaWVaaGkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gNDtcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLnJlZHVjZShmdW5jdGlvbiAocG9pbnQsIGNhcmQpIHtcbiAgICAgICAgaWYgKHBvaW50ID09IGNhcmQucG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2ludDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfSwgY2FyZHNbMF0ucG9pbnQpO1xuXG4gICAgcmV0dXJuIHJlc3VsdCAhPSAtMTtcbn07XG5cbi8qIyMjIyPmmK/lkKbljIXlkKvkupTlkIwqL1xuLy/kupTlvKDlkIzmoLfngrnmlbDnmoTniYxcbktRQ2FyZC5jb250YWluV3VUb25nID0gZnVuY3Rpb24oY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gNTtcbiAgICBpZihjYXJkcy5sZW5ndGggPCBsZW5ndGgpe1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgbGVuZ3RoID0gbGVuZ3RoLWNhcmQyMC5sZW5ndGg7XG4gICAgLy/kupTlvKDniYznm7jlkIznmoRcbiAgICBsZXQgaGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgLy9mb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIC8vICAgIGNjLmxvZyh3KVxuICAgIC8vfVxuICAgIC8vY2MubG9nKGNhcmRzKVxuICAgIC8vY2MubG9nKGhlbHBlcilcbiAgICAvL2NjLmxvZyhjYXJkMjApXG4gICAgLy9jYy5sb2coaGVscGVyLm1heE51bWJlcigpKVxuICAgIC8vY2MubG9nKCctLS0tLS0xMzA3JylcbiAgICAvL2lmKGhlbHBlci5tYXhOdW1iZXIoKSA+PSBsZW5ndGgpe1xuICAgIC8vICAgIHJldHVybiBoZWxwZXIubWF4TnVtYmVyKCkgPj0gbGVuZ3RoO1xuICAgIC8vfVxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xuICAgICAgICBpZihtYXhOdW1iZXIgPj0gbGVuZ3RoKXtcbiAgICAgICAgICAgIGNhcmQyMC5mb3JFYWNoKGZ1bmN0aW9uKGNhKXtcbiAgICAgICAgICAgICAgICBjYS5zY29yZXMgPSBwYXJzZUludCh3KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGhlbHBlci5tYXhOdW1iZXIoKSA+PSBsZW5ndGg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuLyrliKTmlq3mmK/lkKbkupTlkIwqL1xuS1FDYXJkLmlzV3VUb25nID0gZnVuY3Rpb24oY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gNTtcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMucmVkdWNlKGZ1bmN0aW9uIChwb2ludCwgY2FyZCkge1xuICAgICAgICBpZiAocG9pbnQgPT0gY2FyZC5wb2ludCkge1xuICAgICAgICAgICAgcmV0dXJuIHBvaW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9LCBjYXJkc1swXS5wb2ludCk7XG5cbiAgICByZXR1cm4gcmVzdWx0ICE9IC0xO1xufTtcbi8qIyMjIyMqL1xuXG4vLyDmmK/lkKbmmK8g4oCc6JGr6Iqm4oCdXG4vLyDkuInlvKDnm7jlkIwgKyDkuIDlr7lcbktRQ2FyZC5jb250YWluSHVMdSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSA1O1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoS1FDYXJkLmZpbmRIdUx1KGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvL2xldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIC8vdmFyIHBvaW50TnVtYmVycyA9IFtdO1xuICAgIC8vdmFyIGluZGV4ID0gMDtcbiAgICAvL2ZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgcG9pbnROdW1iZXJzW2luZGV4XSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXTtcbiAgICAvLyAgICBpbmRleCA9IGluZGV4ICsgMTtcbiAgICAvL31cbiAgICAvL3ZhciBoPVtdO1xuICAgIC8vdmFyIGgxPVtdO1xuICAgIC8vZm9yKHZhciBpIGluIHBvaW50TnVtYmVycyl7XG4gICAgLy8gICAgdmFyIHM9cG9pbnROdW1iZXJzW2ldO1xuICAgIC8vICAgIGlmKHMgPT0gMyl7XG4gICAgLy8gICAgICAgIGgucHVzaChzKVxuICAgIC8vICAgIH1cbiAgICAvLyAgICBlbHNlIGlmKHM9PTQpe1xuICAgIC8vICAgICAgICBoMS5wdXNoKHMpXG4gICAgLy8gICAgfVxuICAgIC8vXG4gICAgLy99XG4gICAgLy9cbiAgICAvL2lmICgocG9pbnROdW1iZXJzLmluZGV4T2YoMykgIT0gLTEpICYmIChwb2ludE51bWJlcnMuaW5kZXhPZigyKSAhPSAtMSlcbiAgICAvLyB8fCBoLmxlbmd0aCA+IDEgfHwgaDEubGVuZ3RoID4gMSB8fChwb2ludE51bWJlcnMuaW5kZXhPZig0KSAhPSAtMSlcbiAgICAvLyAmJiAocG9pbnROdW1iZXJzLmluZGV4T2YoMikgIT0gLTEpKSB7XG4gICAgLy8gICAgcmV0dXJuIHRydWU7XG4gICAgLy99XG5cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG4vLyDliKTmlq3mmK/lkKbmmK8g6JGr6IqmXG5LUUNhcmQuaXNIdUx1ID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCAhPSA1KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcG9pbnRzID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLnBvaW50O1xuICAgIH0pLnNvcnQoZnVuY3Rpb24gKHAxLCBwMikge1xuICAgICAgICByZXR1cm4gcDEgLSBwMjtcbiAgICB9KTtcblxuICAgIHZhciBwMSA9IHBvaW50c1swXTtcbiAgICB2YXIgcDIgPSBwMTtcbiAgICB2YXIgbnVtYmVyUDEgPSAwO1xuICAgIHZhciBudW1iZXJQMiA9IDA7XG5cbiAgICBwb2ludHMuZm9yRWFjaChmdW5jdGlvbiAocG9pbnQpIHtcbiAgICAgICAgaWYgKHBvaW50ICE9IHAxICYmIHBvaW50ICE9IHAyKSB7XG4gICAgICAgICAgICBwMiA9IHBvaW50O1xuICAgICAgICAgICAgbnVtYmVyUDIgPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgbnVtYmVyUDEgPSBudW1iZXJQMSArICgocG9pbnQgPT0gcDEpID8gMSA6IDApO1xuICAgICAgICBudW1iZXJQMiA9IG51bWJlclAyICsgKChwb2ludCA9PSBwMikgPyAxIDogMCk7XG4gICAgfSk7XG5cbiAgICBsZXQgbWF4TnVtYmVyID0gTWF0aC5tYXgobnVtYmVyUDEpO1xuICAgIGxldCBtaW5OdW1iZXIgPSBNYXRoLm1pbihudW1iZXJQMik7XG5cbiAgICByZXR1cm4gKG1pbk51bWJlciA9PSAyKSAmJiAobWF4TnVtYmVyID09IDMpO1xufTtcblxuLy8g5piv5ZCm5YyF5ZCr5pyJIOKAnOS4ieadoeKAnVxuS1FDYXJkLmNvbnRhaW5TYW5UaWFvID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdmFyIGxlbmd0aCA9IDM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vaWYgKEtRQ2FyZC5maW5kU2FuVGlhbyhjYXJkcykubGVuZ3RoID4gMCkge1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgbGVuZ3RoID0gbGVuZ3RoLWNhcmQyMC5sZW5ndGg7XG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgZm9yKHZhciB3IGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgICB2YXIgbWF4TnVtYmVyID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3ddO1xuICAgICAgICBpZihtYXhOdW1iZXIgPj0gbGVuZ3RoKXtcbiAgICAgICAgICAgIGNhcmQyMC5mb3JFYWNoKGZ1bmN0aW9uKGNhKXtcbiAgICAgICAgICAgICAgICBjYS5zY29yZXMgPSBwYXJzZUludCh3KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy9mb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIC8vICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gPj0gbGVuZ3RoKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAvL1xuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluR3VpUGFpKGNhcmRzLDMpO1xufTtcblxuLy8g5piv5ZCm5pivIOKAnOS4ieadoeKAnVxuS1FDYXJkLmlzU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLnJlZHVjZShmdW5jdGlvbiAocG9pbnQsIGNhcmQpIHtcbiAgICAgICAgaWYgKGNhcmQucG9pbnQgPT0gcG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2ludDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9LCBjYXJkc1swXS5wb2ludCk7XG5cbiAgICByZXR1cm4gcmVzdWx0ICE9IC0xO1xufTtcblxuLy8g5piv5ZCm5YyF5ZCr5pyJIO+8muS4pOWvuVxuS1FDYXJkLmNvbnRhaW5MaWFEdWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgNCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChLUUNhcmQuZmluZExpYUR1aShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy92YXIgbnVtYmVyT2ZEdWlaaSA9IDA7XG4gICAgLy9sZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICAvL2ZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgaWYgKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXSA9PSAyKSB7XG4gICAgLy8gICAgICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMTtcbiAgICAvLyAgICAgICAgaWYgKG51bWJlck9mRHVpWmkgPT0gMikge1xuICAgIC8vICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgICAgIH1cbiAgICAvLyAgICB9XG4gICAgLy99XG5cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG4vLyDmmK/lkKbmmK8g5Lik5a+5XG5LUUNhcmQuaXNMaWFEdWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IDQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIGZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gIT0gMikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcblxuLy8g5piv5LiN5piv5a+55a2QXG5LUUNhcmQuaXNEdWlaaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gMikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGNhcmQxID0gY2FyZHNbMF07XG4gICAgbGV0IGNhcmQyID0gY2FyZHNbMV07XG5cbiAgICByZXR1cm4gY2FyZDEucG9pbnQgPT0gY2FyZDIucG9pbnQ7XG59O1xuXG4vLyDmmK/lkKbljIXlkKvlr7nlrZBcbktRQ2FyZC5jb250YWluRHVpWmkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gMjtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy9pZiAoS1FDYXJkLmZpbmREdWlaaShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgbGVuZ3RoID0gbGVuZ3RoLWNhcmQyMC5sZW5ndGg7XG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgLy9mb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIC8vICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gPj0gbGVuZ3RoKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICBmb3IodmFyIHcgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIHZhciBtYXhOdW1iZXIgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbd107XG4gICAgICAgIGlmKG1heE51bWJlciA+PSBsZW5ndGgpe1xuICAgICAgICAgICAgY2FyZDIwLmZvckVhY2goZnVuY3Rpb24oY2Epe1xuICAgICAgICAgICAgICAgIGNhLnNjb3JlcyA9IHBhcnNlSW50KHcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gICAgLy9yZXR1cm4gS1FDYXJkLmNvbnRhaW5HdWlQYWkoY2FyZHMsMik7XG59O1xuXG5LUUNhcmQuY29udGFpbkd1aVBhaSA9IGZ1bmN0aW9uIChjYXJkcyAsIGxlbmd0aCkge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAgIGxldCBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICB2YXIgbWF4TnVtYmVyID0gKGhlbHBlci5tYXhOdW1iZXIoKSArIGNhcmQyMC5sZW5ndGgpO1xuICAgIHJldHVybiBtYXhOdW1iZXIgPj0gbGVuZ3RoO1xufTtcbi8qIyMjIyMqL1xuLy8g5piv5ZCm5piv54m55q6K54mMXG5LUUNhcmQuaXNUZVNodVBhaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCAxMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIEtRQ2FyZC5pc1FpbmdMb25nKGNhcmRzKVxuICAgICAgICB8fCBLUUNhcmQuaXNZaVRpYW9Mb25nKGNhcmRzKVxuICAgICAgICB8fCBLUUNhcmQuaXNMaXVEdWlCYW4oY2FyZHMpXG4gICAgICAgIHx8IEtRQ2FyZC5pc1NhblNodW5aaShjYXJkcylcbiAgICAgICAgfHwgS1FDYXJkLmlzU2FuVG9uZ0h1YShjYXJkcylcbiAgICAgICAgLyp8fCBLUUNhcmQuaXNTYW5Ub25nSHVhU2h1bihjYXJkcylcbiAgICAgICAgIHx8IEtRQ2FyZC5pc1NhbkZlblRpYW5YaWEoY2FyZHMpXG4gICAgICAgICB8fCBLUUNhcmQuaXNTaVRhb1NhblRpYW8oY2FyZHMpXG5cbiAgICAgICAgIHx8IEtRQ2FyZC5pc1d1RHVpU2FuVGlhbyhjYXJkcylcbiAgICAgICAgIHx8IEtRQ2FyZC5pc0NvdVlpU2UoY2FyZHMpKi87XG59O1xuXG4vLyDlsIbniYzkuK3nmoQgMSDlj5jljJbkuLogQe+8iDE0KVxuS1FDYXJkLl9jb252ZXJ0T25lVG9BID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmZpbmQoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgICAgIHJldHVybiBjYXJkLnBvaW50ID09IDE7XG4gICAgICAgIH0pID09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gY2FyZHM7XG4gICAgfVxuICAgIGxldCByZXN1bHQgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgaWYgKGNhcmQucG9pbnQgPT0gMSkge1xuICAgICAgICAgICAgbGV0IG5ld0NhcmQgPSBuZXcgS1FDYXJkKDE0LCBjYXJkLmNvbG9yKTtcbiAgICAgICAgICAgIHJldHVybiBuZXdDYXJkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYXJkO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbktRQ2FyZC5fY29udmVydE9uZVRvQTEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMuZmluZChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gMTtcbiAgICAgICAgfSkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBjYXJkcztcbiAgICB9XG4gICAgdmFyIG51bSA9IDA7XG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICBpZiAoY2FyZC5wb2ludCA9PSAxICYmIG51bSA9PSAwKSB7XG4gICAgICAgICAgICBudW0rKztcbiAgICAgICAgICAgIGxldCBuZXdDYXJkID0gbmV3IEtRQ2FyZCgxNCwgY2FyZC5jb2xvcik7XG4gICAgICAgICAgICByZXR1cm4gbmV3Q2FyZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FyZDtcbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG4vLyBLUUNhcmQg55qE5o6S5bqP5pa55rOVXG5LUUNhcmQuc29ydEJ5UG9pbnQgPSBmdW5jdGlvbiAoY2FyZDEsIGNhcmQyKSB7XG4gICAgbGV0IHJlc3VsdCA9IE51bWJlcihjYXJkMS5wb2ludCkgLSBOdW1iZXIoY2FyZDIucG9pbnQpXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbktRQ2FyZC5zb3J0QnlDb2xvciA9IGZ1bmN0aW9uIChjYXJkMSwgY2FyZDIsIHBvaW50QXNjID0gdHJ1ZSkge1xuICAgIGlmIChjYXJkMi5jb2xvciA9PSBjYXJkMS5jb2xvcikge1xuICAgICAgICByZXR1cm4gKGNhcmQxLnBvaW50IC0gY2FyZDIucG9pbnQpICogKHBvaW50QXNjID8gMSA6IC0xKTtcbiAgICB9XG4gICAgcmV0dXJuIGNhcmQyLmNvbG9yIC0gY2FyZDEuY29sb3I7XG59XG5cbktRQ2FyZC5zb3J0ID0gZnVuY3Rpb24gKGNhcmQxLCBjYXJkMiwgYXNjID0gdHJ1ZSwgQWlzTWF4ID0gdHJ1ZSkge1xuICAgIGxldCByZXN1bHQgPSAxO1xuICAgIGlmIChjYXJkMS5wb2ludCA9PSBjYXJkMi5wb2ludCkge1xuICAgICAgICByZXN1bHQgPSBjYXJkMS5jb2xvciAtIGNhcmQyLmNvbG9yO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBwb2ludDEgPSBjYXJkMS5wb2ludDtcbiAgICAgICAgdmFyIHBvaW50MiA9IGNhcmQyLnBvaW50O1xuICAgICAgICBpZiAoQWlzTWF4ICYmIHBvaW50MSA9PSAxKSB7XG4gICAgICAgICAgICBwb2ludDEgPSAxNDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChBaXNNYXggJiYgcG9pbnQyID09IDEpIHtcbiAgICAgICAgICAgIHBvaW50MiA9IDE0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzdWx0ID0gcG9pbnQxIC0gcG9pbnQyO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQgKiAoYXNjID8gMSA6IC0xKTtcbn07XG5cbi8v6L2s5Li65a6i5oi356uv55qE54mMXG5LUUNhcmQuX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgLy8gW3tcInN1aXRcIjpcInNcIixcIm51bWJlclwiOjEwfV1cbiAgICBsZXQgc3VpdENvbG9yTWFwID1bJycsJ2QnLCdjJywnaCcsJ3MnXTtcbiAgICByZXR1cm4gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHZhciBjYXJkTnVtYmVyID0gY2FyZC5wb2ludDtcbiAgICAgICAgbGV0IGNvbG9yID0gc3VpdENvbG9yTWFwW2NhcmQuY29sb3JdO1xuICAgICAgICBsZXQgbnVtYmVyID0gTWF0aC5tYXgoTWF0aC5taW4oY2FyZE51bWJlciwgMTMpLCAxKTtcbiAgICAgICAgcmV0dXJuIHtudW1iZXI6bnVtYmVyLHN1aXQ6Y29sb3J9O1xuICAgIH0pO1xufTsiLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5cbmxldCBLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyID0ge1xuICAgIHN0YXJ0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2RpZFN0YXJ0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZGlkU3RhcnQgPSB0cnVlO1xuXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVGb3JjZUV4aXQsIHRoaXMuX2ZvcmNlRXhpdEFwcCwgdGhpcyk7XG4gICAgfSxcblxuICAgIF9mb3JjZUV4aXRBcHA6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIEtRTmF0aXZlSW52b2tlLmZvcmNlRXhpdEFwcCgpO1xuICAgIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEtRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXI7IiwibGV0IEtRR2xvYmFsRXZlbnQgPSB7XG4gICAgX2hhbmRsZXM6IHt9LFxuICAgIC8v5Y+R6YCB5LqL5Lu2XG4gICAgZW1pdDogZnVuY3Rpb24gKGV2ZW50TmFtZSwgZGF0YSA9IHt9KSB7XG4gICAgICAgIGlmICh0eXBlb2YgZGF0YSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgZGF0YSA9IHsnZGF0YSc6IGRhdGF9O1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJldHVybnMgPSBbXSAvL+i/lOWbnuWAvFxuICAgICAgICBkYXRhLmV2ZW50TmFtZSA9IGV2ZW50TmFtZS8v5L+d5a2Y5LiA5LiL5LqL5Lu25ZCN5a2XXG5cbiAgICAgICAgZm9yICggdmFyIGZpbmRFdmVuTmFtZSBpbiB0aGlzLl9oYW5kbGVzKXtcbiAgICAgICAgICAgIGlmIChmaW5kRXZlbk5hbWUgPT0gZXZlbnROYW1lKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9oYW5kbGVzW2ZpbmRFdmVuTmFtZV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJldHVyblZhbHVlID0gdGhpcy5faGFuZGxlc1tmaW5kRXZlbk5hbWVdW2ldKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybnMucHVzaChyZXR1cm5WYWx1ZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmV0dXJuc1xuICAgIH0sXG4gICAgLy/mt7vliqDmma7pgJrkuovku7ZcbiAgICBvbjogZnVuY3Rpb24gKGV2ZW50TmFtZSwgY2FsbGJhY2ssIHRhcmdldCkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygn5pS25Yiw5LqL5Lu2JywgZXZlbnROYW1lKTtcbiAgICAgICAgdGhpcy5faGFuZGxlc1tldmVudE5hbWVdID0gdGhpcy5faGFuZGxlc1tldmVudE5hbWVdIHx8IFtdXG5cbiAgICAgICAgdGhpcy5faGFuZGxlc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2suYmluZCh0YXJnZXQpKVxuICAgICAgICBjYWxsYmFjay5fY2FsbGVyID0gdGFyZ2V0O1xuICAgIH0sXG5cbiAgICAvL+mAmui/h+S6i+S7tuWQjeenu+mZpOS4gOS4quebkeWQrOWZqFxuICAgIG9mZjogZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2hhbmRsZXNbZXZlbnROYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlc1tldmVudE5hbWVdW2ldID0gbnVsbFxuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIOenu+WKqOS4gOS4qiB0YXJnZXQg5LiK5omA5pyJ55qE55uR5ZCsXG4gICAgb2ZmVGFyZ2V0OiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICBmb3IgKHZhciBuYW1lIGluIHRoaXMuX2hhbmRsZXMpIHtcbiAgICAgICAgdmFyIGV2ZW50SGFuZGxlcnMgPSB0aGlzLl9oYW5kbGVzW25hbWVdO1xuICAgICAgICB2YXIgaW5kZXhzID0gZXZlbnRIYW5kbGVycy5maWx0ZXIoZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrLl9jYWxsZXIgPSB0YXJnZXQ7XG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoY2FsbGJhY2ssIGluZGV4KSB7XG4gICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgaW5kZXhPZmZzZXQgPSAwO1xuICAgICAgICBpbmRleHMuZm9yRWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICBldmVudEhhbmRsZXJzLnNwbGljZShpbmRleCArIGluZGV4T2Zmc2V0LCAxKTtcbiAgICAgICAgICBpbmRleE9mZnNldCA9IGluZGV4T2Zmc2V0ICsgMTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gS1FHbG9iYWxFdmVudDtcbiIsImxldCBLUU5hdGl2ZUludm9rZSA9IHtcbiAgSU9TQ2xhc3NOYW1lOiBcIkFwcENvbnRyb2xsZXJcIixcbiAgQU5EUklPRENsYXNzTmFtZTogXCJjb20vZ29uZ3BhL3Nzei9BcHBBY3Rpdml0eVwiLFxuXG4gIGlzTmF0aXZlSU9TOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHBsYXRmb3JtID0gY2Muc3lzLnBsYXRmb3JtO1xuICAgIGlmICgocGxhdGZvcm0gPT0gY2Muc3lzLklQSE9ORSkgfHwgKHBsYXRmb3JtID09IGNjLnN5cy5JUEFEKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcblxuICBpc05hdGl2ZUFuZHJvaWQ6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgcGxhdGZvcm0gPSBjYy5zeXMucGxhdGZvcm07XG4gICAgaWYgKHBsYXRmb3JtID09IGNjLnN5cy5BTkRST0lEKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIGlzTmF0aXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNjLnN5cy5pc05hdGl2ZSA9PSB0cnVlO1xuICB9XG59O1xuXG4vLyBNQVJLOiDlj6/osIPnlKjnmoTmnKzlnLDmlrnms5Vcbi8qKlxuICog5b6u5L+h55m75b2VXG4gKi9cbktRTmF0aXZlSW52b2tlLnd4TG9naW4gPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hMb2dpblwiKTsgLy9JT1NcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hMb2dpblwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIOWIhuS6q+Wkp+WOheS/oeaBr+WIsOW+ruS/oeWlveWPi1xuICogXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlSGFsbFRvV2VDaGF0RnJpZW5kID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2hhcmVIYWxsRnJpZW5kXCIsICk7XG4gIH0gZWxzZSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbEZyaWVuZFwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIOWIhuS6q+Wkp+WOheS/oeaBr+WIsOaci+WPi+WciFxuICogXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlSGFsbFRvV2VDaGF0VGltZWxpbmUgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCApO1xuICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuLyoqXG4gKiDlvLrliLbpgIDlh7ogQVBQXG4gKiBcbiAqL1xuS1FOYXRpdmVJbnZva2UuZm9yY2VFeGl0QXBwID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcImV4aXRBcHBcIiwgKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImV4aXRBcHBcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cblxuLyoqXG4gKiDkuIvovb3mlrDniYjmnKxcbiAqIFxuICogQHBhcmFtIHtTdHJpbmd9IGlvc1VybCAgICAgIGlPUyDniYjmnKzlnLDlnYBcbiAqIEBwYXJhbSB7U3RyaW5nfSBhbmRyb2lkVXJsICDlronljZPniYjmnKzlnLDlnYBcbiAqL1xuS1FOYXRpdmVJbnZva2UuZG93bmxvYWROZXdWZXJzaW9uID0gZnVuY3Rpb24gKGlvc1VybCwgYW5kcm9pZFVybCkge1xuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcImRvd25sb2FkTmV3VmVyc2lvbjpcIiwgaW9zVXJsKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImRvd25sb2FkTmV3VmVyc2lvblwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCBhbmRyb2lkVXJsKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIOWIhuS6q+aIv+mXtOe7meW+ruS/oeWlveWPi1xuICogXG4gKiBAcGFyYW0ge1N0cmluZ30gcm9vbUlkICAgICAgICAg5oi/6Ze0IGlkIOS/oeaBr1xuICogQHBhcmFtIHtTdHJpbmd9IGRlc2NyaXB0aW9uICAgIOaWh+acrOaPj+i/sFxuICovXG5LUU5hdGl2ZUludm9rZS5zaGFyZVJvb21Ub1dlQ2hhdEZyaWVuZCA9IGZ1bmN0aW9uIChyb29tSWQsIGRlc2NyaXB0aW9uKSB7XG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZDpkZXNjcmlwdGlvbjpcIiwgaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLCBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICB9XG59O1xuXG4vKipcbiAqIOWIhuS6q+aIv+mXtOWIsOW+ruS/oeaci+WPi+WciFxuICogXG4gKiBAcGFyYW0ge1N0cmluZ30gcm9vbUlkICAgICAgICAg5oi/6Ze0IGlkIOS/oeaBr1xuICogQHBhcmFtIHtTdHJpbmd9IGRlc2NyaXB0aW9uICAgIOaWh+acrOaPj+i/sFxuICovXG5LUU5hdGl2ZUludm9rZS5zaGFyZVJvb21Ub1dlQ2hhdFRpbWVsaW5lID0gZnVuY3Rpb24gKHJvb21JZCwgZGVzY3JpcHRpb24pIHtcbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNoYXJlOmRlc2NyaXB0aW9uOlwiLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XG4gIH1cbn07XG5cbi8qKlxuICog5YiG5Lqr5bGP5bmV5oiq5Zu+5Yiw5b6u5L+h5aW95Y+LXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlU2NyZWVuVG9XZUNoYXRGcmllbmQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZUZyaWVuZFwiLCApO1xuICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZUZyaWVuZFwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuLyoqXG4gKiDliIbkuqvlsY/luZXmiKrlm77liLDlvq7kv6HmnIvlj4vlnIhcbiAqL1xuS1FOYXRpdmVJbnZva2Uuc2hhcmVTY3JlZW5Ub1dlQ2hhdFRpbWVsaW5lID0gZnVuY3Rpb24gKCkge1xuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVcIiwgKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cbi8qKlxuICog5byA5aeL5b2V6Z+zXG4gKi9cbktRTmF0aXZlSW52b2tlLnN0YXJ0UmVjb3JkID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInJlY29yZFwiKTtcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJyZWNvcmRcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cbi8qKlxuICog57uT5p2f5b2V6Z+zXG4gKi9cbktRTmF0aXZlSW52b2tlLmVuZFJlY29yZCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJlbmRSZWNvcmRcIik7XG4gIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZW5kUmVjb3JkXCIsIFwiKClWXCIpO1xuICB9XG59O1xuXG5LUU5hdGl2ZUludm9rZS5zY3JlZW5zaG90U2hhcmUgPSBmdW5jdGlvbihzdHJpbmdzID0gJ3NoYXJlSU1HJykge1xuICAgICAgICBpZih0aGlzLl9pc0NhcHR1cmluZyl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faXNDYXB0dXJpbmcgPSB0cnVlO1xuICAgICAgICB2YXIgc2l6ZSA9IGNjLmRpcmVjdG9yLmdldFdpblNpemUoKTtcbiAgICAgICAgdmFyIGZpbGVOYW1lID0gXCJyZXN1bHRfc2hhcmUuanBnXCI7XG4gICAgICAgIHZhciBmdWxsUGF0aCA9IGpzYi5maWxlVXRpbHMuZ2V0V3JpdGFibGVQYXRoKCkgKyBmaWxlTmFtZTtcbiAgICAgICAgaWYoanNiLmZpbGVVdGlscy5pc0ZpbGVFeGlzdChmdWxsUGF0aCkpe1xuICAgICAgICAgICAganNiLmZpbGVVdGlscy5yZW1vdmVGaWxlKGZ1bGxQYXRoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGV4dHVyZSA9IG5ldyBjYy5SZW5kZXJUZXh0dXJlKE1hdGguZmxvb3Ioc2l6ZS53aWR0aCksIE1hdGguZmxvb3Ioc2l6ZS5oZWlnaHQpLGNjLklNQUdFX0ZPUk1BVF9QTkcsZ2wuREVQVEgyNF9TVEVOQ0lMOF9PRVMpO1xuICAgICAgICB0ZXh0dXJlLnNldFBvc2l0aW9uKGNjLnAoc2l6ZS53aWR0aC8yLCBzaXplLmhlaWdodC8yKSk7XG4gICAgICAgIHRleHR1cmUuYmVnaW4oKTtcbiAgICAgICAgY2MuZGlyZWN0b3IuZ2V0UnVubmluZ1NjZW5lKCkudmlzaXQoKTtcbiAgICAgICAgdGV4dHVyZS5lbmQoKTtcbiAgICAgICAgdGV4dHVyZS5zYXZlVG9GaWxlKGZpbGVOYW1lLCBjYy5JTUFHRV9GT1JNQVRfUE5HKTtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciB0cnlUaW1lcyA9IDA7XG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBpZihqc2IuZmlsZVV0aWxzLmlzRmlsZUV4aXN0KGZ1bGxQYXRoKSl7XG5cbiAgICAgICAgICAgICAgICBpZihjYy5zeXMub3MgPT0gY2Muc3lzLk9TX0FORFJPSUQpe1xuICAgICAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKHNlbGYuQU5EUklPRENsYXNzTmFtZSwgc3RyaW5ncywgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIixmdWxsUGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYuX2lzQ2FwdHVyaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHRyeVRpbWVzKys7XG4gICAgICAgICAgICAgICAgaWYodHJ5VGltZXMgPiAxMCl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidGltZSBvdXQuLi5cIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmbiw1MCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2V0VGltZW91dChmbiw1MCk7XG59XG5cblxuLyoqXG4gKiDmkq3mlL7nvZHnu5zor63pn7NcbiAqIFxuICogQHBhcmFtIHtTdHJpbmd9IGF1ZGlvVXJsIOivremfs+WcsOWdgFxuICovXG5LUU5hdGl2ZUludm9rZS5wbGF5QXVkaW9XaXRoVXJsID0gZnVuY3Rpb24gKGF1ZGlvVXJsKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwicGxheVVybDpcIiwgYXVkaW9VcmwpO1xuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJwbGF5VXJsXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGF1ZGlvVXJsKTtcbiAgfVxufTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gS1FOYXRpdmVJbnZva2U7IiwidmFyIFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG52YXIgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBpdGVtOiB7IC8vIGl0ZW0gdGVtcGxhdGUgdG8gaW5zdGFudGlhdGUgb3RoZXIgaXRlbXNcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2Nyb2xsVmlldzoge1xyXG4gICAgICAgIFx0ZGVmYXVsdDogbnVsbCxcclxuICAgICAgICBcdHR5cGU6IGNjLlNjcm9sbFZpZXdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNwYXduQ291bnQ6IDAsIC8vIGhvdyBtYW55IGl0ZW1zIHdlIGFjdHVhbGx5IHNwYXduXHJcbiAgICAgICAgdG90YWxDb3VudDogMCwgLy8gaG93IG1hbnkgaXRlbXMgd2UgbmVlZCBmb3IgdGhlIHdob2xlIGxpc3RcclxuICAgICAgICBzcGFjaW5nOiAwLCAvLyBzcGFjZSBiZXR3ZWVuIGVhY2ggaXRlbVxyXG4gICAgICAgIGJ1ZmZlclpvbmU6IDAsIC8vIHdoZW4gaXRlbSBpcyBhd2F5IGZyb20gYnVmZmVyWm9uZSwgd2UgcmVsb2NhdGUgaXRcclxuICAgICAgICAvL2J0bkFkZEl0ZW06IGNjLkJ1dHRvbixcclxuICAgICAgICAvL2J0blJlbW92ZUl0ZW06IGNjLkJ1dHRvbixcclxuICAgICAgICAvL2J0bkp1bXBUb1Bvc2l0aW9uOiBjYy5CdXR0b24sXHJcbiAgICAgICAgLy9sYmxKdW1wUG9zaXRpb246IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vbGJsVG90YWxJdGVtczogY2MuTGFiZWwsXHJcbiAgICAgICAgZGFpa2FpTGlzdDpudWxsLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgXHR0aGlzLmNvbnRlbnQgPSB0aGlzLnNjcm9sbFZpZXcuY29udGVudDtcclxuICAgICAgICB0aGlzLml0ZW1zID0gW107IC8vIGFycmF5IHRvIHN0b3JlIHNwYXduZWQgaXRlbXNcclxuICAgICAgICB0aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XHJcbiAgICAgICAgU29ja2V0LnNlbmRHZXREYWlLYWlGYW5nKFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVUaW1lciA9IDA7XHJcbiAgICAgICAgdGhpcy51cGRhdGVJbnRlcnZhbCA9IDAuMjtcclxuICAgICAgICB0aGlzLmxhc3RDb250ZW50UG9zWSA9IDA7IC8vIHVzZSB0aGlzIHZhcmlhYmxlIHRvIGRldGVjdCBpZiB3ZSBhcmUgc2Nyb2xsaW5nIHVwIG9yIGRvd25cclxuICAgIH0sXHJcblxyXG4gICAgX3JlZ2lzdGVyU29ja2V0RXZlbnQ6IGZ1bmN0aW9uIF9yZWdpc3RlclNvY2tldEV2ZW50KCkge1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVHZXREYWlLYWlEZXNrLCB0aGlzLl9nZXREYWlrYWlSb29tU29ja2V0Q2FsbGJhY2ssIHRoaXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZ2V0RGFpa2FpUm9vbVNvY2tldENhbGxiYWNrOmZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkpTT04uc3RyaW5naWZ5KHJlc3BvbnNlLmRhdGEuZGFpa2FpTGlzdCk9PT09PVwiICsgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YS5kYWlrYWlMaXN0KSk7XHJcbiAgICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICB2YXIganNsZW5ndGg9MDtcclxuXHJcbiAgICAgICAgICAgIHZhciBkYWlrYWlMaXN0ID0gcmVzcG9uc2UuZGF0YS5kYWlrYWlMaXN0O1xyXG4gICAgICAgICAgICB0aGlzLmRhaWthaUxpc3QgPSBkYWlrYWlMaXN0O1xyXG4gICAgICAgICAgICBmb3IodmFyIGpzMiBpbiBkYWlrYWlMaXN0KXtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGFpa2FpTGlzdC5pZCA9IGpzbGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAganNsZW5ndGgrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnRvdGFsQ291bnQgPSBqc2xlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQucmVtb3ZlQWxsQ2hpbGRyZW4odHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY29udGVudC5oZWlnaHQgPSB0aGlzLnRvdGFsQ291bnQgKiAodGhpcy5pdGVtLmhlaWdodCArIHRoaXMuc3BhY2luZykgKyB0aGlzLnNwYWNpbmc7IC8vIGdldCB0b3RhbCBjb250ZW50IGhlaWdodFxyXG4gICAgXHQvL2ZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zcGF3bkNvdW50OyArK2kpIHsgLy8gc3Bhd24gaXRlbXMsIHdlIG9ubHkgbmVlZCB0byBkbyB0aGlzIG9uY2VcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudG90YWxDb3VudDsgKytpKSB7IC8vIHNwYXduIGl0ZW1zLCB3ZSBvbmx5IG5lZWQgdG8gZG8gdGhpcyBvbmNlXHJcbiAgICBcdFx0bGV0IGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLml0ZW0pO1xyXG4gICAgXHRcdHRoaXMuY29udGVudC5hZGRDaGlsZChpdGVtKTtcclxuICAgICAgICAgICAgaWYodGhpcy5kYWlrYWlMaXN0ICYmIHRoaXMuZGFpa2FpTGlzdC5sZW5ndGggPiAwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnNldFBvc2l0aW9uKDAsIC1pdGVtLmhlaWdodCAqICgwLjUgKyBpKSAtIHRoaXMuc3BhY2luZyAqIChpICsgMSkpO1xyXG4gICAgICAgICAgICAgICAgaXRlbS5nZXRDb21wb25lbnQoJ0l0ZW0nKS51cGRhdGVJdGVtKHRoaXMuZGFpa2FpTGlzdFtpXSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgXHR9XHJcbiAgICB9LFxyXG5cclxuICAgIGdldFBvc2l0aW9uSW5WaWV3OiBmdW5jdGlvbiAoaXRlbSkgeyAvLyBnZXQgaXRlbSBwb3NpdGlvbiBpbiBzY3JvbGx2aWV3J3Mgbm9kZSBzcGFjZVxyXG4gICAgICAgLy8gbGV0IHdvcmxkUG9zID0gaXRlbS5wYXJlbnQuY29udmVydFRvV29ybGRTcGFjZUFSKGl0ZW0ucG9zaXRpb24pO1xyXG4gICAgICAgIGxldCB3b3JsZFBvcyA9IGl0ZW0uY29udmVydFRvV29ybGRTcGFjZUFSKGl0ZW0ucG9zaXRpb24pO1xyXG4gICAgICAgIGxldCB2aWV3UG9zID0gdGhpcy5zY3JvbGxWaWV3Lm5vZGUuY29udmVydFRvTm9kZVNwYWNlQVIod29ybGRQb3MpO1xyXG4gICAgICAgIC8vcmV0dXJuIGl0ZW0uZ2V0UG9zaXRpb24oKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHZpZXdQb3M7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZHQpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZVRpbWVyICs9IGR0O1xyXG4gICAgICAgIGlmICh0aGlzLnVwZGF0ZVRpbWVyIDwgdGhpcy51cGRhdGVJbnRlcnZhbCkgcmV0dXJuOyAvLyB3ZSBkb24ndCBuZWVkIHRvIGRvIHRoZSBtYXRoIGV2ZXJ5IGZyYW1lXHJcbiAgICAgICAgdGhpcy51cGRhdGVUaW1lciA9IDA7XHJcbiAgICAgICAgbGV0IGl0ZW1zID0gdGhpcy5pdGVtcztcclxuICAgICAgICBsZXQgYnVmZmVyID0gdGhpcy5idWZmZXJab25lO1xyXG4gICAgICAgIGxldCBpc0Rvd24gPSB0aGlzLnNjcm9sbFZpZXcuY29udGVudC55IDwgdGhpcy5sYXN0Q29udGVudFBvc1k7IC8vIHNjcm9sbGluZyBkaXJlY3Rpb25cclxuICAgICAgICBsZXQgb2Zmc2V0ID0gKHRoaXMuaXRlbS5oZWlnaHQgKyB0aGlzLnNwYWNpbmcpICogaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgbGV0IHZpZXdQb3MgPSB0aGlzLmdldFBvc2l0aW9uSW5WaWV3KGl0ZW1zW2ldKTtcclxuICAgICAgICAgICAgaWYgKGlzRG93bikge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgYXdheSBmcm9tIGJ1ZmZlciB6b25lIGFuZCBub3QgcmVhY2hpbmcgdG9wIG9mIGNvbnRlbnRcclxuICAgICAgICAgICAgICAgIGlmICh2aWV3UG9zLnkgPCAtYnVmZmVyICYmIGl0ZW1zW2ldLnkgKyBvZmZzZXQgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbXNbaV0uc2V0UG9zaXRpb25ZKGl0ZW1zW2ldLnkgKyBvZmZzZXQgKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IGl0ZW1zW2ldLmdldENvbXBvbmVudCgnSXRlbScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpdGVtSWQgPSBpdGVtLml0ZW1JRCAtIGl0ZW1zLmxlbmd0aDsgLy8gdXBkYXRlIGl0ZW0gaWRcclxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmRhaWthaUxpc3QgJiYgdGhpcy5kYWlrYWlMaXN0Lmxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnVwZGF0ZUl0ZW0odGhpcy5kYWlrYWlMaXN0W2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiBhd2F5IGZyb20gYnVmZmVyIHpvbmUgYW5kIG5vdCByZWFjaGluZyBib3R0b20gb2YgY29udGVudFxyXG4gICAgICAgICAgICAgICAgaWYgKHZpZXdQb3MueSA+IGJ1ZmZlciAmJiBpdGVtc1tpXS55IC0gb2Zmc2V0ID4gLXRoaXMuY29udGVudC5oZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtc1tpXS5zZXRQb3NpdGlvblkoaXRlbXNbaV0ueSAtIG9mZnNldCApO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpdGVtID0gaXRlbXNbaV0uZ2V0Q29tcG9uZW50KCdJdGVtJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGl0ZW1JZCA9IGl0ZW0uaXRlbUlEICsgaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZGFpa2FpTGlzdCAmJiB0aGlzLmRhaWthaUxpc3QubGVuZ3RoID4gMClcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0udXBkYXRlSXRlbSh0aGlzLmRhaWthaUxpc3RbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB1cGRhdGUgbGFzdENvbnRlbnRQb3NZXHJcbiAgICAgICAgdGhpcy5sYXN0Q29udGVudFBvc1kgPSB0aGlzLnNjcm9sbFZpZXcuY29udGVudC55O1xyXG4gICAgICAgIC8vdGhpcy5sYmxUb3RhbEl0ZW1zLnRleHRLZXkgPSBcIlRvdGFsIEl0ZW1zOiBcIiArIHRoaXMudG90YWxDb3VudDtcclxuICAgICAgICAvLyB0aGlzLmxibFNjcm9sbEV2ZW50LnN0cmluZyA9IFwiVG90YWwgSXRlbXM6IFwiICsgaXRlbXMubGVuZ3RoO1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgc2Nyb2xsRXZlbnQ6IGZ1bmN0aW9uKHNlbmRlciwgZXZlbnQpIHtcclxuICAgICAgICAvL3N3aXRjaChldmVudCkge1xyXG4gICAgICAgIC8vICAgIGNhc2UgMDpcclxuICAgICAgICAvLyAgICAgICB0aGlzLmxibFNjcm9sbEV2ZW50LnN0cmluZyA9IFwiU2Nyb2xsIHRvIFRvcFwiO1xyXG4gICAgICAgIC8vICAgICAgIGJyZWFrO1xyXG4gICAgICAgIC8vICAgIGNhc2UgMTpcclxuICAgICAgICAvLyAgICAgICB0aGlzLmxibFNjcm9sbEV2ZW50LnN0cmluZyA9IFwiU2Nyb2xsIHRvIEJvdHRvbVwiO1xyXG4gICAgICAgIC8vICAgICAgIGJyZWFrO1xyXG4gICAgICAgIC8vICAgIGNhc2UgMjpcclxuICAgICAgICAvLyAgICAgICB0aGlzLmxibFNjcm9sbEV2ZW50LnN0cmluZyA9IFwiU2Nyb2xsIHRvIExlZnRcIjtcclxuICAgICAgICAvLyAgICAgICBicmVhaztcclxuICAgICAgICAvLyAgICBjYXNlIDM6XHJcbiAgICAgICAgLy8gICAgICAgdGhpcy5sYmxTY3JvbGxFdmVudC5zdHJpbmcgPSBcIlNjcm9sbCB0byBSaWdodFwiO1xyXG4gICAgICAgIC8vICAgICAgIGJyZWFrO1xyXG4gICAgICAgIC8vICAgIGNhc2UgNDpcclxuICAgICAgICAvLyAgICAgICB0aGlzLmxibFNjcm9sbEV2ZW50LnN0cmluZyA9IFwiU2Nyb2xsaW5nXCI7XHJcbiAgICAgICAgLy8gICAgICAgYnJlYWs7XHJcbiAgICAgICAgLy8gICAgY2FzZSA1OlxyXG4gICAgICAgIC8vICAgICAgIHRoaXMubGJsU2Nyb2xsRXZlbnQuc3RyaW5nID0gXCJCb3VuY2UgVG9wXCI7XHJcbiAgICAgICAgLy8gICAgICAgYnJlYWs7XHJcbiAgICAgICAgLy8gICAgY2FzZSA2OlxyXG4gICAgICAgIC8vICAgICAgIHRoaXMubGJsU2Nyb2xsRXZlbnQuc3RyaW5nID0gXCJCb3VuY2UgYm90dG9tXCI7XHJcbiAgICAgICAgLy8gICAgICAgYnJlYWs7XHJcbiAgICAgICAgLy8gICAgY2FzZSA3OlxyXG4gICAgICAgIC8vICAgICAgIHRoaXMubGJsU2Nyb2xsRXZlbnQuc3RyaW5nID0gXCJCb3VuY2UgbGVmdFwiO1xyXG4gICAgICAgIC8vICAgICAgIGJyZWFrO1xyXG4gICAgICAgIC8vICAgIGNhc2UgODpcclxuICAgICAgICAvLyAgICAgICB0aGlzLmxibFNjcm9sbEV2ZW50LnN0cmluZyA9IFwiQm91bmNlIHJpZ2h0XCI7XHJcbiAgICAgICAgLy8gICAgICAgYnJlYWs7XHJcbiAgICAgICAgLy8gICAgY2FzZSA5OlxyXG4gICAgICAgIC8vICAgICAgIHRoaXMubGJsU2Nyb2xsRXZlbnQuc3RyaW5nID0gXCJBdXRvIHNjcm9sbCBlbmRlZFwiO1xyXG4gICAgICAgIC8vICAgICAgIGJyZWFrO1xyXG4gICAgICAgIC8vfVxyXG4gICAgfSxcclxuXHJcbiAgICBhZGRJdGVtOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmNvbnRlbnQuaGVpZ2h0ID0gKHRoaXMudG90YWxDb3VudCArIDEpICogKHRoaXMuaXRlbS5oZWlnaHQgKyB0aGlzLnNwYWNpbmcpICsgdGhpcy5zcGFjaW5nOyAvLyBnZXQgdG90YWwgY29udGVudCBoZWlnaHRcclxuICAgICAgICB0aGlzLnRvdGFsQ291bnQgPSB0aGlzLnRvdGFsQ291bnQgKyAxO1xyXG4gICAgfSxcclxuXHJcbiAgICByZW1vdmVJdGVtOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy50b3RhbENvdW50IC0gMSA8IDMwKSB7XHJcbiAgICAgICAgICAgIGNjLmVycm9yKFwiY2FuJ3QgcmVtb3ZlIGl0ZW0gbGVzcyB0aGFuIDMwIVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jb250ZW50LmhlaWdodCA9ICh0aGlzLnRvdGFsQ291bnQgLSAxKSAqICh0aGlzLml0ZW0uaGVpZ2h0ICsgdGhpcy5zcGFjaW5nKSArIHRoaXMuc3BhY2luZzsgLy8gZ2V0IHRvdGFsIGNvbnRlbnQgaGVpZ2h0XHJcbiAgICAgICAgdGhpcy50b3RhbENvdW50ID0gdGhpcy50b3RhbENvdW50IC0gMTtcclxuICAgIH0sXHJcblxyXG4gICAgc2Nyb2xsVG9GaXhlZFBvc2l0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zY3JvbGxWaWV3LnNjcm9sbFRvT2Zmc2V0KGNjLnAoMCwgNTAwKSwgMik7XHJcbiAgICB9XHJcbn0pO1xyXG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IENoYXRNZXNzYWdlID0gcmVxdWlyZSgnQ2hhdE1lc3NhZ2UnKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuXG4vLyDnlKjmnaXlj5HpgIHmtojmga/nmoQgY29tcG9uZW50XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvL2JxTm9kZTpjYy5Ob2RlLFxuICAgICAgICAvL2JxTm9kZTE6Y2MuTm9kZSxcbiAgICAgICAgLy9idG5MYW5ndWFnZU5vZGU6Y2MuTm9kZSxcbiAgICAgICAgLy9idG5MYW5ndWFnZU5vZGUxOmNjLk5vZGUsXG4gICAgICAgIC8vYnRuQ2hhcnROb2RlOmNjLk5vZGUsXG4gICAgICAgIC8vYnRuQ2hhcnROb2RlMTpjYy5Ob2RlLFxuICAgICAgICB0ZXh0U2Nyb2xsVmlldzpjYy5Ob2RlLFxuICAgICAgICBpbWFnZUNvbnRlbnROb2RlOmNjLk5vZGUsXG5cbiAgICAgICAgZWRpdEJveDogY2MuRWRpdEJveCxcblxuICAgICAgICB0ZXh0UmVjb3JkU2Nyb2xsVmlldzogY2MuU2Nyb2xsVmlldyxcbiAgICAgICAgdGV4dFJlY29yZExheW91dDogY2MuTGF5b3V0LFxuXG4gICAgICAgIHRleHRQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICBjaGF0VGV4dFJlY29yZFByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBlbW9qaVByZWZhYjpjYy5QcmVmYWIsXG4gICAgICAgIC8vIGltYWdlUHJlZmFiOmNjLlByZWZhYixcblxuICAgICAgICBiaWFvcWluZzogW2NjLk5vZGVdLCAgICAvLyBb5Lqu55qE6IOM5pmvLCDmmpfnmoTog4zmma9dICAg5b+r5o236K+tXG4gICAgICAgIGt1YWlqaWV5dTogW2NjLk5vZGVdLCAgIC8vIFvkuq7nmoTog4zmma8sIOaal+eahOiDjOaZr10gICDooajmg4VcbiAgICAgICAgY29udGVudDpbY2MuTm9kZV0sICAgICAgLy8gW+W/q+aNt+ivrSwg6KGo5oOFXSAgIFxuICAgICAgICBpbnB1dE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgZW1vamk6W2NjLk5vZGVdLFxuICAgICAgICBfdXNlcklkOiBudWxsLFxuXG4gICAgICAgIF9wbGF5ZXJJbmZvczogbnVsbCwgICAgICAgIC8vIOiusOW9leeUqOaIt+S/oeaBr1xuICAgICAgICBfY2hhdFRleHRNZXNzYWdlUmVjb3JkczogbnVsbCwgLy8g6IGK5aSp5paH5pys5raI5oGv6K6w5b2VXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl91c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gW107XG4gICAgICAgIHRoaXMudGV4dENvbnRlbnQgPSB0aGlzLnRleHRTY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xuICAgICAgICAvLyB0aGlzLmltYWdlQ29udGVudCA9IHRoaXMuaW1hZ2VTY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciB0ZXh0RGF0YSA9IEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5jaGF0VGV4dHMoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0RGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnRleHRQcmVmYWIpO1xuICAgICAgICAgICAgaXRlbS5nZXRDb21wb25lbnQoJ2NlbGxUZXh0Jykuc2V0VGV4dCh0ZXh0RGF0YVtpXSk7XG4gICAgICAgICAgICBpdGVtLmdldENvbXBvbmVudCgnY2VsbFRleHQnKS5vblNlbGVjdEFjdGlvbiA9IGZ1bmN0aW9uKHRleHQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm9uVGV4dENsaWNrQWN0aW9uKHRleHQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudGV4dENvbnRlbnQuaCA9IDEwMDA7XG4gICAgICAgICAgICB0aGlzLnRleHRDb250ZW50LmFkZENoaWxkKGl0ZW0pO1xuICAgICAgICB9XG5cbiAgICB9LFxuXG5cbiAgICBjbGlja0t1YWlKaWVZdSA6ZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5rdWFpamlleXVbMF0uYWN0aXZlID0gdHJ1ZTsgICAgLy8g5b+r5o236K+tIOiDjOaZr1xuICAgICAgICB0aGlzLmt1YWlqaWV5dVsxXS5hY3RpdmUgPSBmYWxzZTsgICAvLyDlv6vmjbfor60g5oyJ6ZKuXG4gICAgICAgIHRoaXMuYmlhb3FpbmdbMF0uYWN0aXZlID0gZmFsc2U7ICAgIC8vIOiDjOaZr+ihqOaDhVxuICAgICAgICB0aGlzLmJpYW9xaW5nWzFdLmFjdGl2ZSA9IHRydWU7ICAgICAvLyDooajmg4XmjInpkq5cbiAgICAgICAgdGhpcy5jb250ZW50WzBdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuY29udGVudFsxXS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuICAgIGNsaWNrQmlhb1FpbmcgOmZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuYmlhb3FpbmdbMF0uYWN0aXZlID0gdHJ1ZTsgICAgIC8vIOiDjOaZr+ihqOaDhVxuICAgICAgICB0aGlzLmJpYW9xaW5nWzFdLmFjdGl2ZSA9IGZhbHNlOyAgICAvLyDooajmg4XmjInpkq5cbiAgICAgICAgdGhpcy5rdWFpamlleXVbMF0uYWN0aXZlID0gZmFsc2U7ICAgLy8g5b+r5o236K+tIOiDjOaZr1xuICAgICAgICB0aGlzLmt1YWlqaWV5dVsxXS5hY3RpdmUgPSB0cnVlIDsgICAvLyDlv6vmjbfor60g5oyJ6ZKuXG4gICAgICAgIHRoaXMuY29udGVudFswXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb250ZW50WzFdLmFjdGl2ZSA9IHRydWU7XG4gICAgfSxcbiAgICBvblRleHRDbGlja0FjdGlvbjpmdW5jdGlvbih0ZXh0ID0gXCJcIikge1xuICAgICAgICB0aGlzLmVkaXRCb3guc3RyaW5nID0gXCJcIjtcbiAgICAgICAgdGhpcy5zZW5kVGV4dCh0ZXh0KTtcbiAgICB9LFxuXG4gICAgY2xpY2tFbW9qaTogZnVuY3Rpb24gKGV2ZW50LCBlbW9qaU5hbWUpIHtcbiAgICAgICAgbGV0IHN0cmluZyA9IHRoaXMuZWRpdEJveC5zdHJpbmc7XG4gICAgICAgIHRoaXMuZWRpdEJveC5zdHJpbmcgPSBzdHJpbmcgKyBcIjxcIiArIGVtb2ppTmFtZSArIFwiPlwiO1xuICAgICAgICB0aGlzLnNlbmRFbW9qaShlbW9qaU5hbWUpO1xuICAgIH0sXG5cbiAgICBjbGlja1NlbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IHN0cmluZyA9IHRoaXMuZWRpdEJveC5zdHJpbmcgfHwgXCJcIjtcbiAgICAgICAgaWYgKHN0cmluZy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZWRpdEJveC5zdHJpbmcgPSBcIlwiO1xuICAgICAgICB0aGlzLnNlbmRUZXh0KHN0cmluZyk7XG4gICAgfSxcblxuICAgIHNlbmRFbW9qaSA6ZnVuY3Rpb24oZW1vamlOYW1lKXtcbiAgICAgICAgaWYoZW1vamlOYW1lLmxlbmd0aCA9PTApe1xuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgU29ja2V0LnNlbmRFbW9qaSh0aGlzLl91c2VySWQsIGVtb2ppTmFtZSk7XG4gICAgICAgIHRoaXMuZGlzbWlzcygpO1xuICAgIH0sXG5cbiAgICBzZW5kVGV4dDogZnVuY3Rpb24gKHRleHQgPSBcIlwiKSB7XG4gICAgICAgIGlmICh0ZXh0Lmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgU29ja2V0LnNlbmRUZXh0KHRoaXMuX3VzZXJJZCwgdGV4dCk7XG4gICAgICAgIHRoaXMuZGlzbWlzcygpO1xuICAgIH0sXG5cbiAgICBkaXNtaXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgYnFBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYnFOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZTEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5icU5vZGUuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRleHRTY3JvbGxWaWV3LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmltYWdlQ29udGVudE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkU2Nyb2xsVmlldy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICB0ZXh0QWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmJxTm9kZTEuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnFOb2RlLmFjdGl2ZSA9IHRoaXMuYnRuTGFuZ3VhZ2VOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZTEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50ZXh0U2Nyb2xsVmlldy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmltYWdlQ29udGVudE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGV4dFJlY29yZFNjcm9sbFZpZXcubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgY2hhcnRBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYnFOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZTEuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUxLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJxTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnRleHRTY3JvbGxWaWV3LmFjdGl2ZSA9IHRoaXMuaW1hZ2VDb250ZW50Tm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkU2Nyb2xsVmlldy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgfSxcblxuICAgIGFkZFBsYXllckluZm9zOiBmdW5jdGlvbiAocGxheWVySW5mb3MpIHtcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSB0aGlzLl9wbGF5ZXJJbmZvcyB8fCBbXTtcblxuICAgICAgICBwbGF5ZXJJbmZvcy5mb3JFYWNoKGZ1bmN0aW9uICh1c2VySW5mbykge1xuICAgICAgICAgICAgbGV0IGhhdmVVc2VySW5mbyA9IHRoaXMuX3BsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKG93blVzZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG93blVzZXJJbmZvLmlkID09IHVzZXJJbmZvLmlkO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChoYXZlVXNlckluZm8gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BsYXllckluZm9zLnB1c2godXNlckluZm8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBhZGRDaGF0VGV4dE1lc3NhZ2U6IGZ1bmN0aW9uICh1c2VySWQsIHRleHQpIHtcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSB0aGlzLl9wbGF5ZXJJbmZvcyB8fCBbXTtcblxuICAgICAgICB2YXIgbmlja25hbWUgPSBcIltJRDpcIiArIHVzZXJJZCArIFwi6K+0Xe+8mlwiO1xuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLl9wbGF5ZXJJbmZvcy5maW5kKGZ1bmN0aW9uICh1c2VySW5mbykge1xuICAgICAgICAgICAgcmV0dXJuIHVzZXJJbmZvLmlkID09IHVzZXJJZDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHVzZXJJbmZvKSB7XG4gICAgICAgICAgICBuaWNrbmFtZSA9IFwiW1wiICsgdXNlckluZm8ubmlja25hbWUgKyBcIuivtF3vvJpcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzdHIgPSBuaWNrbmFtZSArIHRleHQ7XG4gICAgICAgIHN0ciA9IENoYXRNZXNzYWdlLnBhcnNlU3RyaW5nKHN0cik7XG4gICAgICAgIHRoaXMuX2FkZENoYXRUZXh0VG9SZWNvcmQoc3RyKTtcbiAgICB9LFxuXG4gICAgYWRkQ2hhdEVtb2ppTWVzc2FnZTpmdW5jdGlvbih1c2VySWQsZW1vamkpe1xuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHRoaXMuX3BsYXllckluZm9zIHx8IFtdO1xuXG4gICAgICAgIHZhciBuaWNrbmFtZSA9IFwiW0lEOlwiICsgdXNlcklkICsgXCLor7Rd77yaXCI7XG4gICAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMuX3BsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKHVzZXJJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gdXNlckluZm8uaWQgPT0gdXNlcklkO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHVzZXJJbmZvKSB7XG4gICAgICAgICAgICBuaWNrbmFtZSA9IFwiW1wiICsgdXNlckluZm8ubmlja25hbWUgKyBcIuivtF3vvJpcIjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHN0ciA9IG5pY2tuYW1lICsgZW1vamk7XG4gICAgICAgIHN0ciA9IENoYXRNZXNzYWdlLnBhcnNlU3RyaW5nKHN0cik7XG4gICAgICAgIHRoaXMuX2FkZENoYXRFbW9qaVRvUmVjb3JkKGVtb2ppKTtcbiAgICAgICAgLy8gY2MubG9nKGVtb2ppKVxuICAgICAgICAvLyBjYy5sb2coJy0tLTE5MCcpXG4gICAgfSxcblxuICAgIF9hZGRDaGF0RW1vamlUb1JlY29yZDpmdW5jdGlvbihlbW9qaSl7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5fbG9hZEVtb2ppRnJhbWUoZW1vamksZnVuY3Rpb24oZnJhbWUpe1xuICAgICAgICAgICAgLy92YXIgaXRlbSAgPSBjYy5pbnN0YW50aWF0ZShzZWxmLmVtb2ppUHJlZmFiKTtcbiAgICAgICAgICAgIC8vY2MubG9nKGZyYW1lKVxuICAgICAgICAgICAgLy92YXIgYnRuU3ByaXRlcyA9ICBpdGVtLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgLy9idG5TcHJpdGVzLnNwcml0ZUZyYW1lID0gZnJhbWU7XG4gICAgICAgICAgICAvL2xldCBjaGF0RW1vamlSZWNvcmQgPSBpdGVtLmdldENvbXBvbmVudCgnQ2hhdFRleHRSZWNvcmQnKTtcbiAgICAgICAgICAgIC8vY2hhdEVtb2ppUmVjb3JkLnNldEVtb2ppKGZyYW1lKTtcbiAgICAgICAgICAgIENoYXRNZXNzYWdlLnNldEVtb2ppKGZyYW1lKTtcblxuICAgICAgICB9KVxuICAgIH0sXG5cbiAgICBfbG9hZEVtb2ppRnJhbWUgOmZ1bmN0aW9uKEVtb2ppbmFtZSAsY2FsbGJhY2spe1xuICAgICAgICBjYy5sb2FkZXIubG9hZFJlcyhcIi90ZXh0dXJlcy9jaGF0L2JxXCIsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xuICAgICAgICAgICAgaWYoZXJyKXtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG51bGwsIGVycilcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShFbW9qaW5hbWUpO1xuICAgICAgICAgICAgY2FsbGJhY2soZnJhbWUpO1xuICAgICAgICB9LmJpbmQodGhpcykpXG5cbiAgICB9LFxuXG4gICAgX2FkZENoYXRUZXh0VG9SZWNvcmQ6IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgIHZhciBpdGVtID0gY2MuaW5zdGFudGlhdGUodGhpcy5jaGF0VGV4dFJlY29yZFByZWZhYik7XG4gICAgICAgIGxldCBjaGF0VGV4dFJlY29yZCA9IGl0ZW0uZ2V0Q29tcG9uZW50KCdDaGF0VGV4dFJlY29yZCcpO1xuICAgICAgICBjaGF0VGV4dFJlY29yZC5zZXRTdHJpbmcodGV4dCk7XG5cbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkTGF5b3V0Lm5vZGUuYWRkQ2hpbGQoaXRlbSk7XG4gICAgICAgIHRoaXMudGV4dFJlY29yZFNjcm9sbFZpZXcuc2Nyb2xsVG9Cb3R0b20oKTtcbiAgICB9LFxufSk7XG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgZXhpdEFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgY2MuZGlyZWN0b3IuZW5kKCk7XG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcImV4aXRBcHBcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZXhpdEFwcFwiLCBcIigpVlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCIvLyBudW1iZXIua3FfdGltZXMoZikgICDosIPnlKjlpJrmrKFcblxuXG5pZiAoIU51bWJlci5wcm90b3R5cGUua3FfdGltZXMpIHtcbiAgICBcbiAgICAvKipcbiAgICAgKiDosIPnlKjkuIDkuKrmlrnms5UgdGhpcyDmrKFcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gZiDopoHosIPnlKjnmoTmlrnms5VcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICAgdGhpc0FyZyAgIOWPr+mAie+8myBmIOeahCB0aGlz5YC8XG4gICAgICovXG4gICAgTnVtYmVyLnByb3RvdHlwZS5rcV90aW1lcyA9IGZ1bmN0aW9uKGYsIHRoaXNBcmcpIHtcbiAgICAgICAgaWYgKCFmKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXM7ICsraSkge1xuICAgICAgICAgICAgaWYgKHRoaXNBcmcpIHtcbiAgICAgICAgICAgICAgICBmLmFwcGx5KHRoaXNBcmcsIGkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuXG4vLyDnlKjkuo7lm57mlL7nmoTnu4Tku7ZcbmNvbnN0IFBsYXliYWNrID0gY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgIF9wbGF5YmFja0RhdGFzOiBudWxsLCAgIC8vIOeUqOS6juWbnuaUvueahOaVsOaNrlxuICAgICAgX2lzUGxheWJhY2tpbmc6IGZhbHNlLFxuICAgIH0sXG5cbiAgICBzdGF0aWNzOiB7XG4gICAgICBpbnN0YW5jZTogbnVsbCxcbiAgICB9LFxuXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICBQbGF5YmFjay5pbnN0YW5jZSA9IHRoaXM7XG4gICAgICBjYy5nYW1lLmFkZFBlcnNpc3RSb290Tm9kZSh0aGlzLm5vZGUpO1xuICAgIH0sXG5cbiAgICAvLyDorr7nva7lm57mlL7mlbDmja5cbiAgICBzZXRQbGF5YmFja0RhdGFzOiBmdW5jdGlvbiAoZGF0YXMpIHtcbiAgICAgIHRoaXMuX3BsYXliYWNrRGF0YXMgPSBkYXRhcztcbiAgICB9LFxuXG4gICAgLy8g5riF56m65Zue5pS+5pWw5o2u44CC5ZCM5pe25Lya5riF56m65Zue5pS+XG4gICAgcmVtb3ZlUGxheWJhY2tEYXRhczogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5zZXRQbGF5YmFja0RhdGFzKG51bGwpO1xuICAgICAgdGhpcy5zdG9wUGxheWJhY2soKTtcbiAgICB9LFxuXG4gICAgLy8g5piv5ZCm5YyF5ZCr5Zue5pS+5pWw5o2uXG4gICAgaXNDb250YWluUGxheWJhY2tEYXRhczogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3BsYXliYWNrRGF0YXMgIT0gbnVsbDtcbiAgICB9LFxuXG4gICAgLy8g5byA5aeL5Zue5pS+XG4gICAgc3RhcnRQbGF5YmFjazogZnVuY3Rpb24gKCkge1xuICAgICAgLy8g5qih5oufIHNvY2tldCDmjqXmlLbliLDkuobkuovku7bljbPlj69cbiAgICAgIC8vY2MubG9nKFwiUGxheWJhY2sg5byA5aeL5Zue5pS+XCIpO1xuXG4gICAgICB0aGlzLl9pc1BsYXliYWNraW5nID0gdHJ1ZTtcblxuICAgICAgaWYgKCF0aGlzLl9wbGF5YmFja0RhdGFzKSB7XG4gICAgICAgIGNjLmVycm9yKFwi5oOz5Zue5pS+77yM5Y205rKh5pyJ5Zue5pS+5pWw5o2uXCIpO1xuICAgICAgICB0aGlzLnN0b3BQbGF5YmFjaygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2V4ZWN1dGVQbGF5YmFjaygpO1xuICAgIH0sXG5cbiAgICAvLyDlgZzmraLlm57mlL5cbiAgICBzdG9wUGxheWJhY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2lzUGxheWJhY2tpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xuICAgIH0sXG5cbiAgICAvLyDmmK/lkKbmraPlnKjlm57mlL5cbiAgICBpc1BsYXliYWNraW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5faXNQbGF5YmFja2luZztcbiAgICB9LFxuXG4gICAgLy8g5omn6KGM55yf5q2j55qE5Zue5pS+5pON5L2cXG4gICAgX2V4ZWN1dGVQbGF5YmFjazogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHN0YXJ0VGltZSA9IDEuMDtcbiAgICAgIGxldCBpbnRlcnZhbCA9IDMuMDtcbiAgICAgIGNjLmxvZyh0aGlzLl9wbGF5YmFja0RhdGFzKTtcblxuICAgICAgLy8g5Zyo5p+Q5Lqb54m55q6K5oOF5Ya15LiLXG4gICAgICAvLyDlm57mlL7mlbDmja7ph4zkvJrljIXlkKvkuKTlpZcgZ2FtZU92ZXIgYWN0aW9uXG4gICAgICAvLyDmiYDku6XpnIDopoHov4fmu6TmjonlhbbkuK3kuIDkuKpcbiAgICAgIHRoaXMuX3BsYXliYWNrRGF0YXMgPSB0aGlzLl9wbGF5YmFja0RhdGFzLmZpbHRlcihmdW5jdGlvbihzdHJpbmcsIGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA9PSB0aGlzLl9wbGF5YmFja0RhdGFzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoc3RyaW5nLmluZGV4T2YoJ1wiYWN0aW9uXCI6XCJnYW1lT3ZlcicpID09IC0xKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgIHRoaXMuX3BsYXliYWNrRGF0YXMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIGRlbGF5ID0gc3RhcnRUaW1lICsgaW5kZXggKiBpbnRlcnZhbDtcbiAgICAgICAgaWYgKGluZGV4ID09IHRoaXMuX3BsYXliYWNrRGF0YXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIC8vIOWmguaenOaYr+acgOWQjuS4gOS4qu+8jOWImeW6lOivpeWPqumXtOmalOS4gOenklxuICAgICAgICAgIGRlbGF5ID0gc3RhcnRUaW1lICsgKGluZGV4IC0gMSkgKiBpbnRlcnZhbCArIDE7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgY2MubG9nKFwi5Zue5pS+5byA5aeL5qih5oufIFNvY2tldCDmjqXmlLbliLDmnI3liqHlmajmtojmga8sIFwiLCBpbmRleCk7XG4gICAgICAgICAgU29ja2V0Lmluc3RhbmNlLl9kaXNwYXRjaFJlc3BvbnNlKGRhdGEpO1xuICAgICAgICB9LCBkZWxheSk7XG5cbiAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICB9LFxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBQbGF5YmFjaztcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IEFycmF5RXh0ZW5zaW9uID0gcmVxdWlyZSgnQXJyYXlFeHRlbnNpb24nKTtcbmNvbnN0IFVzZXJNb2RlbEhlbHBlciA9IHJlcXVpcmUoJ1VzZXJNb2RlbEhlbHBlcicpO1xuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xuY29uc3QgS1FDYXJkUmVzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUmVzSGVscGVyJyk7XG5jb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBmb2xkQ2FyZE5vZGU6IGNjLk5vZGUsICAgICAgLy8g54mM55uW552A5pe255qE5qC35a2QXG4gICAgICAgIHRlU2h1UGFpTm9kZTogY2MuTm9kZSwgICAgICAvLyDnibnmrorniYznm5bnnYDml7bnmoTmoLflrZBcbiAgICAgICAgY2FyZHNCYWNrTGF5b3V0OiBjYy5MYXlvdXQsIC8vIDEz5byg54mM6IOM5b2x77yM5Y+v55So5p2l5bGV56S65Y+R54mM5Yqo55S7IOWQqyBjYXJkc0JhY2sgQ29tcG9uZW50XG4gICAgICAgIGNvbXBhcmVDYXJkc05vZGU6IGNjLk5vZGUsICAvLyBjb21wYXJlQ2FyZHMgICDlkKsgQ29tcGFyZUNhcmRzIENvbXBvbmVudFxuICAgICAgICB1c2VySW5mb05vZGU6IGNjLk5vZGUsICAgICAgICAgIC8vIOWMheWQq+eUqOaIt+S/oeaBryDlkKsgdXNlckluZm8gQ29tcG9uZW50XG4gICAgICAgIGNoYXRNZXNzYWdlTm9kZTogY2MuTm9kZSwgICAgICAgLy8g6IGK5aSp5raI5oGvIOWMheWQqyBDaGF0TWVzc2FnZSBDb21wb25lbnRcbiAgICAgICAgdXNlckF2YXRhck5vZGU6IGNjLk5vZGUsXG4gICAgICAgIC8vdXNlclNhbXBsZUluZm9Ob2RlOiBjYy5Ob2RlLFxuICAgICAgICBidWxsZXRIb2xlUHJlZmFiOiBjYy5QcmVmYWIsLy/kuK3mnqpcbiAgICAgICAgYnVsbGV0SG9sZU5vZGU6IGNjLk5vZGUsLy/kuK3mnqpcbiAgICAgICAgc2hvdE5vZGU6IFtjYy5Ob2RlXSwvL+aJk+aeqlxuICAgICAgICB1c2VySWQ6IDAsXG4gICAgICAgIGNhcmRUeXBlUHJlZmFiOiBjYy5QcmVmYWIsXG4gICAgICAgIC8vIOeUqOaIt+S/oeaBr1xuICAgICAgICAvLyAx44CBIOWmguaenCDljIXlkKvvvJpjYXJkSW5mbzpbXe+8jOihqOaYjueUqOaIt+W3sue7j+WHuueJjFxuICAgICAgICAvL1xuICAgICAgICBfdXNlckluZm86IG51bGwsXG4gICAgICAgIF9kZXNrSW5mbzogbnVsbCxcbiAgICAgICAgLyoqL1xuICAgICAgICBwbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHM6IHtcbiAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgZGVmYXVsdDogdW5kZWZpbmVkLFxuICAgICAgICB9XG4gICAgICAgIC8qKi9cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudXNlckF2YXRhck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIHRoaXMuX3Nob3dVc2VySW5mbywgdGhpcyk7XG4gICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID0gZmFsc2U7Ly/liKTmlq3mmK/lkKbngrnlh7vkuobmi43nmoTog4zlvbFcbiAgICAgICAgdGhpcy5jYXJkU3ByaXRlQXRsYXMgPSB0aGlzLm5vZGUucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcbiAgICB9LFxuXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudXNlckF2YXRhck5vZGUub2ZmKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCB0aGlzLl9zaG93VXNlckluZm8sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBjbGlja19sZWF2ZTpmdW5jdGlvbigpe1xuICAgICAgICB2YXIgdXNlcmlkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgICB2YXIgbGVhdmVJZCA9IHRoaXMuX3VzZXJJbmZvLmlkO1xuICAgICAgICBTb2NrZXQuc2VuZFFpbmdsaShsZWF2ZUlkLHVzZXJpZCk7XG4gICAgfSxcbiAgICBcbiAgICBfc2hvd1VzZXJJbmZvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhpcy51c2VyU2FtcGxlSW5mb05vZGUuZ2V0Q29tcG9uZW50KCdVc2VyU2FtcGxlSW5mbycpLnVwZGF0ZVdpdGhVc2VyKHRoaXMuX3VzZXJJbmZvKTtcbiAgICB9LFxuXG4gICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGVTaHVQYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJ1bGxldEhvbGVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJ1bGxldEhvbGVOb2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2RlKXtub2RlLmFjdGl2ZSA9IGZhbHNlO30pO1xuICAgICAgICBpZih0aGlzLnNob3ROb2RlLmxlbmd0aCA+IDApIHRoaXMuc2hvdE5vZGUuZm9yRWFjaChmdW5jdGlvbihub2RlKXtpZihub2RlKSBub2RlLmFjdGl2ZSA9IGZhbHNlO30pO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5yZXNldCgpO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XG4gICAgfSxcblxuICAgIC8qIyMjIyovXG4gICAgcmVzZXQyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50ZVNodVBhaU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe25vZGUuYWN0aXZlID0gZmFsc2U7fSk7XG4gICAgICAgIGlmKHRoaXMuc2hvdE5vZGUubGVuZ3RoID4gMCkgdGhpcy5zaG90Tm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe2lmKG5vZGUpIG5vZGUuYWN0aXZlID0gZmFsc2U7fSk7XG4gICAgICAgIC8vdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAvL3RoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnJlc2V0KCk7XG4gICAgfSxcbiAgICAvKiMjIyMjKi9cblxuICAgIHVwZGF0ZVVzZXJJbmZvV2l0aFVzZXJzOiBmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgbGV0IHVzZXIgPSB1c2Vycy5maW5kKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy51c2VySWQgPT0gZS5pZDtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZVVzZXJJbmZvKHVzZXIpO1xuICAgIH0sXG4gICAgc2hvd1FpbmdsaTpmdW5jdGlvbihjcmVhdG9yLCBpbmRleCl7XG4gICAgICAgIGlmKCF0aGlzLm5vZGUuYWN0aXZlKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZihpbmRleD4wKXtcbiAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRxaW5nbGkoZmFsc2UpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIGlmKGNyZWF0b3Ipe1xuICAgICAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRxaW5nbGkoZmFsc2UpO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldHFpbmdsaSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgdXBkYXRlVXNlckluZm86IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIHRoaXMuX3VzZXJJbmZvID0gdXNlcjtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9ICh1c2VyICE9IG51bGwpO1xuICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5hY3RpdmUgPSB0aGlzLm5vZGUuYWN0aXZlO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcbiAgICAgICAgdXNlckluZm8udXBkYXRlQXZhdGFyKHVzZXIuYXZhdGFyVXJsKTtcbiAgICAgICAgdXNlckluZm8udXBkYXRlVXNlcklkKHVzZXIuaWQpO1xuICAgICAgICB1c2VySW5mby51cGRhdGVOaWNrbmFtZSh1c2VyLm5pY2tuYW1lKTtcbiAgICAgICAgdXNlckluZm8uc2V0T2ZmbGluZVZpc2libGUoIXVzZXIub25saW5lU3RhdHVzKTtcblxuICAgICAgICAvL2lmICh0aGlzLl9kZXNrSW5mbyAmJiB0aGlzLl9kZXNrSW5mby5jSW5kZXggPiAwKSB7XG4gICAgICAgIC8vICBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModXNlcikpIHtcbiAgICAgICAgLy8gICAgdGhpcy5wbGF5Q2FyZCh1c2VyLmlkKTtcbiAgICAgICAgLy8gICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuc2V0Q29tcGFyZURhdGEodXNlcik7XG4gICAgICAgIC8vICB9XG4gICAgICAgIC8vfVxuICAgICAgICAvKiovXG4gICAgICAgIGNvbnN0IGNJbmRleCA9IHRoaXMuX2Rlc2tJbmZvLmNJbmRleDtcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvICYmIGNJbmRleCA+IDAgJiYgKHRoaXMucGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzLmluZGV4T2YoY0luZGV4KSA9PSAtMSkpIHtcbiAgICAgICAgICAgIGlmIChVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyh1c2VyKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGxheUNhcmQodXNlci5pZCx1c2VyLmNhcmRJbmZvKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zZXRDb21wYXJlRGF0YSh1c2VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiovXG4gICAgfSxcblxuICAgIC8vIOabtOaWsOaIv+S4u+S/oeaBr1xuICAgIHVwZGF0ZUJhbmtlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCB1c2VySW5mb0NvbXAgPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICAgIGlmICghdGhpcy5fdXNlckluZm8pIHtcbiAgICAgICAgICAgIHVzZXJJbmZvQ29tcC5zZXRJc0JhbmtlcihmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaXNCYW5rZXIgPSB0aGlzLl91c2VySW5mbyA/IHRoaXMuX3VzZXJJbmZvLmlzQmFua2VyIDogZmFsc2U7XG4gICAgICAgIHVzZXJJbmZvQ29tcC5zZXRJc0Jhbmtlcihpc0Jhbmtlcik7XG4gICAgfSxcblxuICAgIHNob3dGYW5nWmh1U3RhdHVzOiBmdW5jdGlvbiAoY3JlYXRlSWQsIHZpc2libGUgPSB0cnVlKSB7XG4gICAgICAgIGlmICghdGhpcy5ub2RlLmFjdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl91c2VySW5mby5pZCA9PSBjcmVhdGVJZCkge1xuICAgICAgICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldEZhbmdaaHVOb2RlVmlzaWJsZSh2aXNpYmxlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDmm7TmlrDliIbmlbBcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzY29yZSDnlKjmiLfliIbmlbDjgIHlj6/pgIlcbiAgICAgKi9cbiAgICB1cGRhdGVTY29yZTogZnVuY3Rpb24oc2NvcmUpIHtcbiAgICAgICAgaWYgKCFzY29yZSAmJiB0aGlzLl91c2VySW5mbykge1xuICAgICAgICAgICAgc2NvcmUgPSB0aGlzLl91c2VySW5mby50b3RhbFNjb3JlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xuICAgICAgICB1c2VySW5mby51cGRhdGVTY29yZShzY29yZSk7XG4gICAgfSxcblxuICAgIHNob3dSZWFkeVN0YXR1czogZnVuY3Rpb24gKHVzZXJJZCwgdmlzaWJsZSA9IHRydWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fdXNlckluZm8uaWQgPT0gdXNlcklkKSB7XG4gICAgICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZSh2aXNpYmxlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgc2hvd0JlaWx2OmZ1bmN0aW9uKHVzZXJJZCxibCl7XG4gICAgICAgIGlmKCF0aGlzLm5vZGUuYWN0aXZlKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiggdGhpcy5fdXNlckluZm8uaWQgPT0gdXNlcklkICl7XG4gICAgICAgICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldEJlaWx2TGFiZWwoYmwpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvKnNldERlc2tJbmZvOiBmdW5jdGlvbiAoZGVza0luZm8pIHtcbiAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcbiAgICAgfSwqL1xuICAgIHVwZGF0ZURlc2tJbmZvOiBmdW5jdGlvbiAoZGVza0luZm8pIHtcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcblxuICAgICAgICBpZiAoZGVza0luZm8gJiYgIWRlc2tJbmZvLmlzQ0JlZ2luKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8qKi9cblxuICAgIGhpZGVSZWFkeVN0YXR1czogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZShmYWxzZSk7XG4gICAgfSxcblxuICAgIHBsYXlGYVBhaUFuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModGhpcy5fdXNlckluZm8pKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGNhcmRzQmFjayA9IHRoaXMuY2FyZHNCYWNrTGF5b3V0LmdldENvbXBvbmVudCgnY2FyZHNCYWNrJyk7XG4gICAgICAgIGNhcmRzQmFjay5zaG93UGxheUNhcmRCYWNrcygpO1xuICAgIH0sXG5cbiAgICBzaG91bGRTaG93RmFQYWlBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKHRoaXMuX3VzZXJJbmZvKTtcbiAgICB9LFxuXG4gICAgc2V0VXNlck9ubGluZVN0YXR1czogZnVuY3Rpb24gKHVzZXJJZCwgc3RhdHVzID0gMSkge1xuICAgICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICAgIHVzZXJJbmZvLnNldE9mZmxpbmVWaXNpYmxlKHN0YXR1cyAhPSAxKTtcbiAgICB9LFxuXG4gICAgc2hvd0NoYXRUZXh0OiBmdW5jdGlvbiAodXNlcklkLCBtZXNzYWdlKSB7XG4gICAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjaGF0TWVzc2FnZSA9IHRoaXMuY2hhdE1lc3NhZ2VOb2RlLmdldENvbXBvbmVudCgnQ2hhdE1lc3NhZ2UnKTtcbiAgICAgICAgY2hhdE1lc3NhZ2Uuc2V0U3RyaW5nKG1lc3NhZ2UpO1xuICAgIH0sXG5cbiAgICAvLyDnlKjmiLflt7Lnu4/lh7rniYzvvIzlpITkuo7kuInloIbnm5bnnYDniYznmoTnirbmgIFcbiAgICBwbGF5Q2FyZDogZnVuY3Rpb24gKHVzZXJJZCxjYXJkSW5mbykge1xuICAgICAgICBpZiAodGhpcy51c2VySWQgIT0gdXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLnRhcmdldE9mZih0aGlzLmZvbGRDYXJkTm9kZSk7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmNoaWxkcmVuLnNsaWNlKDAsMykuZm9yRWFjaChmdW5jdGlvbihub2RlKXtcbiAgICAgICAgICAgIG5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2Upe1xuICAgICAgICAgICAgICAgIG5vZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRTcHJpdGUgPSBub2UuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gJ3B1YmxpYy1waWMtY2FyZC1wb2tlci1iYWNrJztcblxuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGNhcmRTcHJpdGUpO1xuXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdGhpcy5fY2xpY2tGb2xkQ2FyZE5vZGUoZXZlbnQpO1xuICAgICAgICB9LmJpbmQodGhpcyksdGhpcy5mb2xkQ2FyZE5vZGUpO1xuXG5cbiAgICB9LFxuXG4gICAgX2NsaWNrRm9sZENhcmROb2RlOiBmdW5jdGlvbiAoZXZlbnQpIHtcblxuICAgICAgICBpZiAodGhpcy51c2VySWQgIT0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkKSByZXR1cm47XG5cbiAgICAgICAgdmFyIGNhcmRJbmZvID0gdGhpcy5fdXNlckluZm8uY2FyZEluZm8ubGVuZ3RoID09IDE/IHRoaXMuX3VzZXJJbmZvLmNhcmRJbmZvWzBdLmNhcmRzOiB0aGlzLl91c2VySW5mby5jYXJkSW5mbztcblxuICAgICAgICB2YXIgY2FyZHMgPSBjYXJkSW5mby5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xuXG4gICAgICAgICAgICBpZih0aGlzLl91c2VySW5mby5jYXJkSW5mby5sZW5ndGggPT0gMSkgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0pO1xuXG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRJbmZvSXRlbS5jYXJkcyk7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge3JldHVybiBhcnJheS5jb25jYXQoc3ViQ2FyZHMpO30sIFtdKTtcblxuICAgICAgICB2YXIgZm9sZENhcmROb2RlID0gdGhpcy5mb2xkQ2FyZE5vZGUuY2hpbGRyZW4uc2xpY2UoMCwzKTtcblxuICAgICAgICB2YXIgbm9kZXMgPSBmb2xkQ2FyZE5vZGUubWFwKGZ1bmN0aW9uIChub2RlKSB7cmV0dXJuIG5vZGUuY2hpbGRyZW47fSkucmVkdWNlKGZ1bmN0aW9uIChhcnJheSwgc3ViKSB7cmV0dXJuIGFycmF5LmNvbmNhdChzdWIpO30sIFtdKTtcblxuICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChrcUNhcmQsIGluZGV4KSB7XG5cbiAgICAgICAgICAgIGlmIChpbmRleCA+PSBub2Rlcy5sZW5ndGgpIHJldHVybjtcblxuICAgICAgICAgICAgbm9kZXNbaW5kZXhdLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgICAgIG5vZGVzW2luZGV4XS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IFwiXCI7XG5cbiAgICAgICAgICAgIHZhciBub2RkczEgPSBuZXcgY2MuTm9kZSgpOyAvL+WIm+W7uuS4gOS4quiKgueCueWvueixoVxuXG4gICAgICAgICAgICBub2RkczEud2lkdGggPSBub2Rlc1swXS53aWR0aDtcblxuICAgICAgICAgICAgbm9kZHMxLmhlaWdodCA9IG5vZGVzWzBdLmhlaWdodDtcblxuICAgICAgICAgICAgbm9kZHMxLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxuXG4gICAgICAgICAgICB2YXIgY2FyZFNwcml0ZSA9IG5vZGRzMS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpO1xuXG4gICAgICAgICAgICBjYXJkU3ByaXRlLnNpemVNb2RlID0gMDtcblxuICAgICAgICAgICAgdmFyIGNhcmROYW1lID0gdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID09IGZhbHNlPyBrcUNhcmQuY2FyZE5hbWUoKTogXCJiYWNrXCI7XG5cbiAgICAgICAgICAgIG5vZGRzMS5jYXJkTmFtZSA9IGNhcmROYW1lO1xuXG4gICAgICAgICAgICB2YXIgcGF0aCA9ICdwdWJsaWMtcGljLWNhcmQtcG9rZXItJysgY2FyZE5hbWU7XG5cbiAgICAgICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGNhcmRTcHJpdGUpO1xuXG4gICAgICAgICAgICBpZihjYy5tYVBhaSA9PSBjYXJkTmFtZSl7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZHMgPSBuZXcgY2MuTm9kZSgpOyAvL+WIm+W7uuS4gOS4quiKgueCueWvueixoVxuXG4gICAgICAgICAgICAgICAgbm9kZHMuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XG5cbiAgICAgICAgICAgICAgICBjYy5sb2FkZXIubG9hZFJlcygncGxheS9kZXNrL2ltZ19yZWQ1XzEnLCBjYy5TcHJpdGVGcmFtZSwgZnVuY3Rpb24gKGVyciwgc3ByaXRlRnJhbWUpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7Y2MuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyKTtyZXR1cm47fVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBidG5TcHJpdGUxID0gbm9kZHMuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEubm9kZS53aWR0aCA9IGNhcmRTcHJpdGUubm9kZS53aWR0aCArIDEwO1xuXG4gICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEubm9kZS5oZWlnaHQgPSBjYXJkU3ByaXRlLm5vZGUuaGVpZ2h0ICsgMTA7XG5cbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgY2FyZFNwcml0ZS5ub2RlLmFkZENoaWxkKG5vZGRzKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBub2Rlc1tpbmRleF0uYWRkQ2hpbGQobm9kZHMxKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB2YXIgY2FyZHMwID0gY2FyZHMuc2xpY2UoMCwzKVxuICAgICAgICB2YXIgY2FyZHMxID0gY2FyZHMuc2xpY2UoMyw4KVxuICAgICAgICB2YXIgY2FyZHMyID0gY2FyZHMuc2xpY2UoOCwxMylcblxuICAgICAgICBjYXJkcyA9IFtjYXJkczAsIGNhcmRzMSwgY2FyZHMyXVxuICAgICAgICAvL+WktOmBk1xuICAgICAgICBsZXQgdHlwZU5hbWUwID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkczApKzE7XG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD49MTAgPyB0eXBlTmFtZTAgOlwiMFwiK3R5cGVOYW1lMDtcbiAgICAgICAgdHlwZU5hbWUwID0gdHlwZU5hbWUwPT0nMDQnID8gJzExJyA6dHlwZU5hbWUwO1xuXG4gICAgICAgIC8v5Lit6YGTXG4gICAgICAgIGxldCB0eXBlTmFtZTEgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzMSkrMTtcbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPj0xMCA/IHR5cGVOYW1lMSA6XCIwXCIrdHlwZU5hbWUxO1xuICAgICAgICB0eXBlTmFtZTEgPSB0eXBlTmFtZTE9PScwNycgPyAnMjInIDp0eXBlTmFtZTE7XG5cbiAgICAgICAgLy/lsL7pgZNcbiAgICAgICAgbGV0IHR5cGVOYW1lMiA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMyKSsxO1xuICAgICAgICB0eXBlTmFtZTIgPSB0eXBlTmFtZTI+PTEwID8gdHlwZU5hbWUyIDpcIjBcIit0eXBlTmFtZTI7XG5cblxuICAgICAgICBpZih0eXBlTmFtZTApIEtRQ2FyZC5fc2V0R3VpQ2FyZCgwLCAwLCAzLCB0eXBlTmFtZTAsIGNhcmRzLCBub2RlcywgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xuICAgICAgICBpZih0eXBlTmFtZTEpIEtRQ2FyZC5fc2V0R3VpQ2FyZCgxLCAzLCA4LCB0eXBlTmFtZTEsIGNhcmRzLCBub2RlcywgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xuICAgICAgICBpZih0eXBlTmFtZTIpIEtRQ2FyZC5fc2V0R3VpQ2FyZCgyLCA4LCAxMywgdHlwZU5hbWUyLCBjYXJkcywgbm9kZXMsIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcbiAgICAgICAgaWYodGhpcy5mb2xkQ2FyZE5vZGVCYWNrID09IGZhbHNlKXtcbiAgICAgICAgICAgIHRoaXMuZm9sZENhcmROb2RlQmFjayA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZih0aGlzLmZvbGRDYXJkTm9kZUJhY2sgPT0gdHJ1ZSl7XG4gICAgICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZUJhY2sgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgfSxcblxuICAgIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbihTcHJpdGVGcmFtZSwgcGF0aCwgU3ByaXRlc05vZGUsIHcsIGgpIHtcblxuICAgICAgICB2YXIgU3ByaXRlID0gU3ByaXRlRnJhbWUuZ2V0U3ByaXRlRnJhbWUoIHBhdGggKTtcblxuICAgICAgICBTcHJpdGVzTm9kZS5zcHJpdGVGcmFtZSA9IFNwcml0ZTtcblxuICAgICAgICBpZih3KSBTcHJpdGVzTm9kZS5ub2RlLndpZHRoID0gdztcblxuICAgICAgICBpZihoKSBTcHJpdGVzTm9kZS5ub2RlLmhlaWdodCA9IGg7XG4gICAgfSxcblxuICAgIC8vIOWHhuWkh+WlveW8gOWni+avlOeJjFxuICAgIC8vIHJlYWR5VG9Db21wYXJlQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyAgICAgdGhpcy5mb2xkQ2FyZE5vZGUudGFyZ2V0T2ZmKHRoaXMuZm9sZENhcmROb2RlKTtcbiAgICAvLyAgICAgdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID0gdHJ1ZTtcbiAgICAvLyAgICAgdGhpcy5fY2xpY2tGb2xkQ2FyZE5vZGUoKTtcbiAgICAvLyAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAvLyAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgLy8gICAgIC8vdGhpcy5mb2xkQ2FyZE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgLy8gICAgIGlmKHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyKXtcbiAgICAvLyAgICAgICAgIGlmKHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyLmlzQ29udGFpbkV4dHJhKXtcbiAgICAvLyAgICAgICAgICAgICB0aGlzLnRlU2h1UGFpTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgIC8vICAgICAgICAgfWVsc2V7XG4gICAgLy8gICAgICAgICAgICAgdGhpcy50ZVNodVBhaU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgIH1cbiAgICAvLyB9LFxuICAgIHJlYWR5VG9Db21wYXJlQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUudGFyZ2V0T2ZmKHRoaXMuZm9sZENhcmROb2RlKTtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fY2xpY2tGb2xkQ2FyZE5vZGUoKTtcbiAgICAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGlmKHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyKXtcbiAgICAgICAgICAgIGlmKHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyLmlzQ29udGFpbkV4dHJhKXtcbiAgICAgICAgICAgICAgICB0aGlzLnRlU2h1UGFpTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdGhpcy50ZVNodVBhaU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5omT5p6q5Yqo55S7XG4gICAgLy8gQHBhcmFtIHVzZXJJZCAgIOimgeS4u+WKqOaJk+aequeahOeUqOaIt2lkXG4gICAgLy8gQHBhcmFtIHRvVXNlckluZGV4ICDmjKjmnqrnmoTnlKjmiLfnmoQgaW5kZXhcbiAgICBwbGF5U2hvb3RBbmltYXRpb246IGZ1bmN0aW9uICh1c2VySWQsIHRvVXNlckluZGV4KSB7XG4gICAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2hvdE5vZGUgPSB0aGlzLnNob3ROb2RlW3RvVXNlckluZGV4XTtcbiAgICAgICAgc2hvdE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgc2hvdE5vZGUuY2hpbGRyZW5bMF0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgc2hvdE5vZGUuY2hpbGRyZW5bMV0uYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICAvL+aeqlxuICAgICAgICB2YXIgcm90YXRlQnkgPSBjYy5yb3RhdGVUbygwLjEsLTE1KTtcbiAgICAgICAgdmFyIGRlbGF5MSA9IGNjLmRlbGF5VGltZSgwLjEpO1xuICAgICAgICB2YXIgcm90YXRlQnkxID0gY2Mucm90YXRlVG8oMC4xLDApO1xuICAgICAgICB2YXIgc3RhcnRfZnVuYzEgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe3Nob3ROb2RlLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IHRydWU7fSk7XG4gICAgICAgIHZhciBlbmRfZnVuYzEgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe3Nob3ROb2RlLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IGZhbHNlO30pO1xuICAgICAgICB2YXIgYWN0aW9uID0gY2MucmVwZWF0KGNjLnNlcXVlbmNlKHN0YXJ0X2Z1bmMxICxyb3RhdGVCeSwgZGVsYXkxLCByb3RhdGVCeTEsIGVuZF9mdW5jMSksMyk7XG5cbiAgICAgICAgLy/ng59cbiAgICAgICAgdmFyIGZhZGVJbiA9IGNjLmZhZGVJbiAoMCk7XG4gICAgICAgIHZhciBzY2FsZVRvMSA9IGNjLnNjYWxlVG8gKDAsIDAuOCk7XG4gICAgICAgIHZhciBzY2FsZVRvMiA9IGNjLnNjYWxlVG8gKDAuMDgsIDEpO1xuICAgICAgICB2YXIgZmFkZU91dEFuZFNjYWxlVG8gPSBjYy5zcGF3bihjYy5mYWRlT3V0KDAuMDIpLCBjYy5zY2FsZVRvKDAuMDIsIDAuNSkpO1xuICAgICAgICB2YXIgZGVsYXkyID0gY2MuZGVsYXlUaW1lKC4yKTtcbiAgICAgICAgdmFyIHN0YXJ0X2Z1bmMyID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtzaG90Tm9kZS5jaGlsZHJlblsxXS5hY3RpdmUgPSB0cnVlO30pO1xuICAgICAgICB2YXIgZW5kX2Z1bmMyID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtzaG90Tm9kZS5jaGlsZHJlblsxXS5hY3RpdmUgPSBmYWxzZTt9KTtcbiAgICAgICAgdmFyIGFjdGlvbjEgPSAgY2MucmVwZWF0KGNjLnNlcXVlbmNlKHN0YXJ0X2Z1bmMyLCBmYWRlSW4sIHNjYWxlVG8xLCBzY2FsZVRvMiwgZmFkZU91dEFuZFNjYWxlVG8sIGRlbGF5MiwgZW5kX2Z1bmMyKSwzKTtcblxuICAgICAgICBzaG90Tm9kZS5jaGlsZHJlblswXS5ydW5BY3Rpb24oYWN0aW9uKTtcbiAgICAgICAgc2hvdE5vZGUuY2hpbGRyZW5bMV0ucnVuQWN0aW9uKGFjdGlvbjEpO1xuXG5cbiAgICAgICAgLy9sZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICAgIC8vdXNlckluZm8ucGxheVNob290QW5pbWF0aW9uKHRvVXNlckluZGV4KTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5Lit5p6q5Yqo55S7XG4gICAgcGxheUJ1bGxldEhvbGVBbmltYXRpb246IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICAgICAgaWYgKHVzZXJJZCAhPSB0aGlzLnVzZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIGxldCBidWxsZXRIb2xlTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYnVsbGV0SG9sZVByZWZhYik7XG5cbiAgICAgICAgYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2RlKXtub2RlLmFjdGl2ZSA9IGZhbHNlO30uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW5bMF0ueSA9IDA7XG5cbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5hZGRDaGlsZChidWxsZXRIb2xlTm9kZSk7XG5cbiAgICAgICAgdmFyIGludGVydmFsID0gMC4zO1xuXG4gICAgICAgIHZhciBpbml0VGltZSA9IDA7XG5cbiAgICAgICAgYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2RlKXtcblxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUh1bWFuWlFpYW5nKCk7XG5cbiAgICAgICAgICAgICAgICBub2RlLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgeSA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcblxuICAgICAgICAgICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMzgpICogeTtcblxuICAgICAgICAgICAgICAgIHZhciB4ID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSA9PSAwID8gLTEgOiAxO1xuXG4gICAgICAgICAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozOCkgKiB4O1xuXG4gICAgICAgICAgICAgICAgbm9kZS54ID0geDtcblxuICAgICAgICAgICAgICAgIG5vZGUueSA9IHk7XG5cbiAgICAgICAgICAgIH0sIGluaXRUaW1lKTtcblxuICAgICAgICAgICAgaW5pdFRpbWUgPSBpbml0VGltZSArIGludGVydmFsO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5YWo5Z6S5omT5Yqo55S7XG4gICAgcGxheUhvbWVSdW5BaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICAgIHVzZXJJbmZvLnBsYXlIb21lUnVuQWltYXRpb24oKTtcbiAgICB9LFxuXG4gICAgcGxheVNwZWFrQW5pbWF0aW9uOiBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcbiAgICAgICAgdXNlckluZm8ucGxheVNwZWFrQW5pbWF0aW9uKCk7XG4gICAgfSxcblxuICAgIG5leHRDb21wYXJlU2NvcmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBzY29yZSA9IHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLm5leHRDb21wYXJlU2NvcmUoKTtcbiAgICAgICAgcmV0dXJuIHNjb3JlO1xuICAgIH0sXG5cbiAgICBzaG93TmV4dENvbXBhcmVDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5uZXh0Q29tcGFyZVNjb3JlKCkgPD0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudGVTaHVQYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zaG93TmV4dENhcmRzKCk7XG4gICAgfSxcblxuICAgIHNob3dBbGxDb21wYXJlQ2FyZHM6IGZ1bmN0aW9uICh1c2Vycykge1xuICAgICAgICBsZXQgdXNlciA9IHVzZXJzLmZpbmQoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnVzZXJJZCA9PSBlLmlkO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zZXRDb21wYXJlRGF0YSh1c2VyKTtcbiAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuc2hvd0FsbENhcmRzKCk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVTY29yZSh0aGlzLl91c2VySW5mby50b3RhbFNjb3JlIHx8IDApO1xuICAgIH0sXG5cbiAgICBzaG93TmV4dENvbXBhcmVTY29yZTogZnVuY3Rpb24gKGlzQ29udGFpbkV4dHJhKSB7XG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNob3dOZXh0Q29tcGFyZVNjb3JlKGlzQ29udGFpbkV4dHJhKTtcbiAgICB9LFxuXG4gICAgc2hvd1Njb3JlUmVzdWx0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNob3dTY29yZVJlc3VsdCgpO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IEtRQ2FyZFJlc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFJlc0hlbHBlcicpO1xuY29uc3QgU3ByaXRlSGVscGVyID0gcmVxdWlyZSgnU3ByaXRlSGVscGVyJyk7XG5jb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgYXZhdGFyU3ByaXRlOiBjYy5TcHJpdGUsXG4gICAgICAgIGxhYmVsTmlja25hbWU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFJlc3VsdE51bWJlcjogY2MuTGFiZWwsXG4gICAgICAgIGxheW91dFRvdURhbzogY2MuTGF5b3V0LFxuICAgICAgICBsYXlvdXRaaG9uZ0RhbzogY2MuTGF5b3V0LFxuICAgICAgICBsYXlvdXRXZWlEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0VGVTaHU6IGNjLkxheW91dCxcblxuICAgICAgICBsYWJlbFRlU2h1UGFpVGl0bGU6IGNjLkxhYmVsLFxuXG4gICAgICAgIHNjb3JlVW5pdE5vZGU6IGNjLk5vZGUsICAgICAgLy8g56ev5YiGXG4gICAgICAgIGRpYW1vbmRVbml0Tm9kZTogY2MuTm9kZSwgICAgLy8g6ZK755+zXG4gICAgfSxcblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIH0sXG5cbiAgICAvL3tcImlkXCI6MTAwMDQ5LFwibmlja25hbWVcIjpcImlteWFcIixcIm9wZW5JZFwiOlwieHhcIixcImF2YXRhclVybFwiOlwieHhcIixcInNleFwiOjEsXG4gICAgLy8gXCJjYXJkTnVtYmVyXCI6MyxcIm9ubGluZVN0YXR1c1wiOjEsXCJpbnZpdGVDb2RlXCI6XCJcIixcImlwQWRkcmVzc1wiOlwiOjpmZmZmOjIyMi4yNDQuNjUuMjAxXCIsXG4gICAgLy8gXCJsYXN0TG9naW5UaW1lXCI6XCIyMDE3LTA0LTEzIDIyOjA5OjAxXCIsXCJjcmVhdGVBdFwiOlwiMjAxNy0wNC0xMSAyMjozOTozMFwiLFxuICAgIC8vIFwidXBkYXRlQXRcIjpcIjIwMTctMDQtMTMgMjI6MDk6MDFcIixcbiAgICAvLyBcImNhcmRzXCI6W10sXCJyb29tSWRcIjpcIjU5ODg4M1wiLFwicmVhZHlTdGF0dXNcIjp0cnVlLFwidG90YWxTY29yZVwiOjAsXG4gICAgLy8gXCJjU2NvcmVcIjowLFwiaXNCYW5rZXJcIjpmYWxzZX1cbiAgICB1cGRhdGVXaXRoUGxheWVySW5mbzogZnVuY3Rpb24gKHBsYXllckluZm8sIGlzUmFuZG9tUm9vbSA9IGZhbHNlKSB7XG4gICAgICBTcHJpdGVIZWxwZXIuc2V0SW1hZ2VVcmwodGhpcy5hdmF0YXJTcHJpdGUsIHBsYXllckluZm8uYXZhdGFyVXJsKTtcbiAgICAgIHRoaXMubGFiZWxOaWNrbmFtZS5zdHJpbmcgPSBwbGF5ZXJJbmZvLm5pY2tuYW1lO1xuICAgICAgICAvL2NjLmxvZyh0aGlzLmxhYmVsUmVzdWx0TnVtYmVyLnN0cmluZylcbiAgICAgICAgLy9jYy5sb2cocGxheWVySW5mbylcbiAgICAgICAgLy9jYy5sb2cocGxheWVySW5mby5jU2NvcmUpXG4gICAgICAgIC8vY2MubG9nKCctLS0zNicpXG4gICAgICB0aGlzLmxhYmVsUmVzdWx0TnVtYmVyLnN0cmluZyA9IHBsYXllckluZm8uY1Njb3JlO1xuXG4gICAgICB0aGlzLnNjb3JlVW5pdE5vZGUuYWN0aXZlID0gIWlzUmFuZG9tUm9vbTtcbiAgICAgIHRoaXMuZGlhbW9uZFVuaXROb2RlLmFjdGl2ZSA9IGlzUmFuZG9tUm9vbTtcbiAgICAgIHZhciBOdW1iZXIgPSBwbGF5ZXJJbmZvLmNTY29yZTtcbiAgICAgIGlmIChpc1JhbmRvbVJvb20pIHtcbiAgICAgICAgLy8g5aaC5p6c5piv6ZqP5py65Zy655qE6K+d77yM5YiZ5pi+56S66ZK755+z5pWw6YePXG4gICAgICAgICAgTnVtYmVyID0gcGxheWVySW5mby5jU2NvcmUgKiA1O1xuICAgICAgfVxuICAgICAgICB0aGlzLmxhYmVsUmVzdWx0TnVtYmVyLnN0cmluZyA9IE51bWJlcjtcbiAgICB9LFxuXG4gICAgc2V0Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xuICAgICAgY2MuYXNzZXJ0KGNhcmRzLmxlbmd0aCA9PSAxMyk7XG5cbiAgICAgIC8vIOS4jeS8muWGjeacieeJueauiueJjOS6hlxuICAgICAgIC8qaWYgKEtRQ2FyZC5pc1RlU2h1UGFpKGNhcmRzKSkge1xuICAgICAgICAgdGhpcy5zZXRUZVNodUNhcmRzKGNhcmRzKTtcbiAgICAgICAgIHJldHVybjtcbiAgICAgICAgIH1cbiAgICAgICovXG5cbiAgICAgIC8vbGV0IHRvdUNhcmRzID0gY2FyZHMuc2xpY2UoMCwgMyk7XG4gICAgICAvL2xldCB6aG9uZ0NhcmRzID0gY2FyZHMuc2xpY2UoMywgMyArIDUpO1xuICAgICAgLy9sZXQgd2VpQ2FyZHMgPSBjYXJkcy5zbGljZSg4KTtcbiAgICAgIC8vdGhpcy5zZXRUb3VDYXJkcyh0b3VDYXJkcyk7XG4gICAgICAvL3RoaXMuc2V0WmhvbmdDYXJkcyh6aG9uZ0NhcmRzKTtcbiAgICAgIC8vdGhpcy5zZXRXZWlDYXJkcyh3ZWlDYXJkcyk7XG4gICAgfSxcblxuICAgIC8qc2V0VG91Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xuICAgICAgdGhpcy5fc2V0Q2FyZHNUb0xheW91dCh0aGlzLmxheW91dFRvdURhbywgY2FyZHMpO1xuICAgIH0sXG5cbiAgICBzZXRaaG9uZ0NhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy5sYXlvdXRaaG9uZ0RhbywgY2FyZHMpO1xuICAgIH0sXG5cblxuICAgIHNldFdlaUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy5sYXlvdXRXZWlEYW8sIGNhcmRzKTtcbiAgICB9LCovXG5cbiAgICAvL+e7k+eulyAg5bCG54m55q6K54mM5pS+5YWlTGF5b3V0XG4gICAgLypzZXRUZVNodUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMubGF5b3V0VGVTaHUubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgdGhpcy5sYXlvdXRUb3VEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMubGF5b3V0V2VpRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLl9zZXRDYXJkc1RvTGF5b3V0KHRoaXMubGF5b3V0VGVTaHUsIGNhcmRzKTtcblxuICAgICAgbGV0IHR5cGVOYW1lID0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoY2FyZHMpO1xuICAgICAgdGhpcy5sYWJlbFRlU2h1UGFpVGl0bGUuc3RyaW5nID0gdHlwZU5hbWU7XG4gICAgfSwqL1xuXG4gICAvL+e7k+eul+WwhueJjOaUvuWIsExheW91dOmHjOmdolxuICAgIC8qX3NldENhcmRzVG9MYXlvdXQ6IGZ1bmN0aW9uIChsYXlvdXQsIGNhcmRzKSB7XG4gICAgICBsZXQgbm9kZSA9IGxheW91dC5ub2RlO1xuICAgICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChzcHJpdGVOb2RlLCBpbmRleCkge1xuICAgICAgICBsZXQgc3ByaXRlID0gc3ByaXRlTm9kZS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpO1xuICAgICAgICBsZXQgY2FyZCA9IGNhcmRzW2luZGV4XTtcbiAgICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgS1FDYXJkUmVzSGVscGVyLnNldENhcmRTcHJpdGVGcmFtZShzcHJpdGUsIGNhcmQuY2FyZE5hbWUoKSk7XG4gICAgICB9KTtcbiAgICB9LCovXG59KTtcbiIsImNvbnN0IE1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICBwaG9uZTpjYy5MYWJlbCxcbiAgICAgIG11c2ljU2xpZGVyOmNjLk5vZGUsXG4gICAgICBlZmZlY3RTbGlkZXI6Y2MuTm9kZSxcbiAgICAgIGJ0blN3aXRjaEFjY291bnQ6IGNjLkJ1dHRvbixcbiAgICAgIHNoYXJlQmc6Y2MuTm9kZSxcbiAgICAgIHd4OmNjLk5vZGUsXG4gICAgICBweXE6Y2MuTm9kZSxcbiAgICAgIG11c2ljOmNjLk5vZGUsXG4gICAgICBzb3VuZHM6Y2MuTm9kZSxcbiAgICAgIF9hdWRpb01hbmFnZXI6IG51bGwsXG4gICAgICBfbXVzaWNPbiA6IDEsXG4gICAgICBfc291bmRzT24gOiAxLFxuICAgICAgX3Bob25lOm51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyID0gY2MuZmluZCgnQXVkaW9NYW5hZ2VyJykgfHwge307XG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIgPSB0aGlzLl9hdWRpb01hbmFnZXIuZ2V0Q29tcG9uZW50KCdBdWRpb01hbmFnZXInKTtcbiAgICAgIHRoaXMuX2luaXRTbGlkZXJzKCk7XG4gICAgICB0aGlzLnBob25lLnN0cmluZyA9IHRoaXMuX3Bob25lP3RoaXMuX3Bob25lOlwi5pegXCI7XG4gICAgICAgIHZhciBiZ011c2ljID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdNdXNpY1wiKTtcbiAgICAgICAgdmFyIGJnU291bmQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJiZ1NvdW5kXCIpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKGJnTXVzaWMpO1xuICAgICAgICBpZihiZ011c2ljICE9ICcnKSB7XG4gICAgICAgICAgICBpZiAocGFyc2VJbnQoYmdNdXNpYykgPT0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX211c2ljT24gPSAxO1xuICAgICAgICAgICAgICAgIHRoaXMubXVzaWMuZ2V0Q2hpbGRCeU5hbWUoJ211c2ljX29uJykuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLm11c2ljLmdldENoaWxkQnlOYW1lKCdtdXNpY19vZmYnKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX211c2ljT24gPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMubXVzaWMuZ2V0Q2hpbGRCeU5hbWUoJ211c2ljX29uJykuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5tdXNpYy5nZXRDaGlsZEJ5TmFtZSgnbXVzaWNfb2ZmJykuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZihiZ1NvdW5kID09IDApeyAvLyDlpoLmnpzog4zmma/pn7PmlYjmmK/lhbPpl63nmoRcbiAgICAgICAgICAgIGlmIChwYXJzZUludChiZ1NvdW5kKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc291bmRzT24gPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuc291bmRzLmdldENoaWxkQnlOYW1lKCdzb3VuZHNfb24nKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnNvdW5kcy5nZXRDaGlsZEJ5TmFtZSgnc291bmRzX29mZicpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zb3VuZHNPbiA9IDE7XG4gICAgICAgICAgICAgICAgdGhpcy5zb3VuZHMuZ2V0Q2hpbGRCeU5hbWUoJ3NvdW5kc19vbicpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5zb3VuZHMuZ2V0Q2hpbGRCeU5hbWUoJ3NvdW5kc19vZmYnKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKHRoaXMuX3NvdW5kc09uKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgY2xpY2tXeDogZnVuY3Rpb24oKXsgIC8v54K55Ye75b6u5L+hXG4gICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgdGhpcy5zaGFyZUJnLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMud3guYWN0aXZlID0gdHJ1ZTtcbiAgICAgIH1lbHNle1xuICAgICAgICB2YXIgdGl0bGUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3NoYXJlVGl0bGUnKTtcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkZXNjJyk7XG4gICAgICAgIHZhciByZWNvcmRJZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVjb3JkSWQnKTtcbiAgICAgICAgdmFyIHJvb21JZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncm9vbUlkJyk7XG4gICAgICAgIHZhciBpZD0gJyc7XG4gICAgICAgIGlmKHJvb21JZCl7XG4gICAgICAgICAgICBpZCA9ICdyb29tSWQ9Jytyb29tSWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYocmVjb3JkSWQpe1xuICAgICAgICAgICAgaWQgPSAncmVjb3JkSWQ9JytyZWNvcmRJZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNoYXJlRnJpZW5kOmRlc2NyaXB0aW9uOlwiLGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVGcmllbmRcIixzdHIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgIH0sXG4gICAgY2xpY2tQeXE6IGZ1bmN0aW9uKCl7IC8v54K55Ye75pyL5Y+L5ZyIXG4gICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgdGhpcy5zaGFyZUJnLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMucHlxLmFjdGl2ZSA9IHRydWU7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHRpdGxlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzaGFyZVRpdGxlJyk7XG4gICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGVzYycpO1xuICAgICAgICB2YXIgcmVjb3JkSWQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JlY29yZElkJyk7XG4gICAgICAgIHZhciByb29tSWQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Jvb21JZCcpO1xuICAgICAgICB2YXIgaWQ9ICcnO1xuICAgICAgICBpZihyb29tSWQpe1xuICAgICAgICAgICAgaWQgPSAncm9vbUlkPScrcm9vbUlkO1xuICAgICAgICB9XG4gICAgICAgIGlmKHJlY29yZElkKXtcbiAgICAgICAgICAgIGlkID0gJ3JlY29yZElkPScrcmVjb3JkSWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUhhbGxUaW1lbGluZTpkZXNjcmlwdGlvbjpcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICB2YXIgc3RyID0gXCIoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVZcIjtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsc3RyLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICB9LFxuXG4gICAgY2xpY2tzaGFyZUJnOiBmdW5jdGlvbigpeyAgLy8g54K55Ye75YiG5Lqr6IOM5pmv5Zu+XG4gICAgICB0aGlzLnNoYXJlQmcuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLnd4LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5weXEuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcbiAgICBjbGlja011c2ljIDpmdW5jdGlvbigpeyAgIC8v54K55Ye76Z+z5LmQXG4gICAgICB0aGlzLm11c2ljLmNoaWxkcmVuWzFdLmFjdGl2ZSA9ICh0aGlzLl9tdXNpY09uID0gIXRoaXMuX211c2ljT24pOyAgIFxuICAgICAgdGhpcy5tdXNpYy5jaGlsZHJlblsyXS5hY3RpdmUgPSAhdGhpcy5fbXVzaWNPbjtcbiAgICAgICAgdmFyIHZvbHVtZSA9IDA7XG4gICAgICBpZih0aGlzLl9tdXNpY09uKXtcbiAgICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnNldEJnTXVzaWNWb2x1bW4oMSk7XG4gICAgICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnBsYXlNdXNpYygpO1xuICAgICAgICAgIHZvbHVtZSA9IDE7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnNldEJnTXVzaWNWb2x1bW4oMCk7XG4gICAgICAgICAgdm9sdW1lID0gMDtcbiAgICAgIH1cbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYmdNdXNpY1wiLHZvbHVtZSk7XG4gICAgfSxcblxuICAgIGNsaWNrU291bmRzIDpmdW5jdGlvbigpeyAgLy/ngrnlh7vkuobpn7PmlYhcbiAgICAgIHRoaXMuc291bmRzLmNoaWxkcmVuWzFdLmFjdGl2ZSA9ICh0aGlzLl9zb3VuZHNPbiA9ICF0aGlzLl9zb3VuZHNPbik7XG4gICAgICB0aGlzLnNvdW5kcy5jaGlsZHJlblsyXS5hY3RpdmUgPSAhdGhpcy5fc291bmRzT247XG4gICAgICB2YXIgdm9sdW1lPTA7XG4gICAgICBpZih0aGlzLl9zb3VuZHNPbil7XG4gICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKDEpO1xuICAgICAgICB2b2x1bWUgPSAxO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKDApO1xuICAgICAgICB2b2x1bWUgPSAwO1xuICAgICAgfVxuICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYmdTb3VuZFwiLHZvbHVtZSk7XG4gICAgfSxcbiAgICBjbGlja1NldHRpbmc6ZnVuY3Rpb24oKXsgIC8v54K55Ye76K6+572uXG4gICAgICAgIFxuICAgIH0sXG4gICAgX2luaXRTbGlkZXJzOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9pbml0U2xpZGVyRXZlbnRzKCk7XG5cbiAgICAgIGxldCBtdXNpY1ZhbCA9IE1hbmFnZXIuZ2V0TXVzaWNWYWx1ZSgpO1xuICAgICAgbGV0IGVmZmVjdFZhbCA9IE1hbmFnZXIuZ2V0TXVzaWNFZmZlY3RWYWx1ZSgpO1xuXG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0QmdNdXNpY1ZvbHVtbihtdXNpY1ZhbCk7XG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bShlZmZlY3RWYWwpO1xuXG4gICAgICB0aGlzLm11c2ljU2xpZGVyLmdldENvbXBvbmVudCgnc2xpZGVyJykuc2V0VmFsdWUobXVzaWNWYWwpO1xuICAgICAgdGhpcy5lZmZlY3RTbGlkZXIuZ2V0Q29tcG9uZW50KCdzbGlkZXInKS5zZXRWYWx1ZShlZmZlY3RWYWwpO1xuICAgIH0sXG5cbiAgICBfaW5pdFNsaWRlckV2ZW50czogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5tdXNpY1NsaWRlci5nZXRDb21wb25lbnQoJ3NsaWRlcicpLm9uVmFsdWVDaGFuZ2UgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBNYW5hZ2VyLnNldE11c2ljVmFsdWUodmFsdWUpO1xuICAgICAgICBzZWxmLl9hdWRpb01hbmFnZXIuc2V0QmdNdXNpY1ZvbHVtbih2YWx1ZSk7XG4gICAgICB9O1xuXG4gICAgICB0aGlzLmVmZmVjdFNsaWRlci5nZXRDb21wb25lbnQoJ3NsaWRlcicpLm9uVmFsdWVDaGFuZ2UgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBNYW5hZ2VyLnNldE11c2ljRWZmZWN0VmFsdWUodmFsdWUpO1xuICAgICAgICBzZWxmLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bSh2YWx1ZSk7XG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBjbGlja1N3aXRjaDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIGhpZGVTd2l0Y2g6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuYnRuU3dpdGNoQWNjb3VudCkge1xuICAgICAgICB0aGlzLmJ0blN3aXRjaEFjY291bnQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9LFxufSk7XG4iLCJsZXQgU3ByaXRlSGVscGVyID0ge1xuICBzZXRJbWFnZVVybDogZnVuY3Rpb24gKHNwcml0ZSwgdXJsKSB7XG4gICAgaWYgKHVybC5lbmRzV2l0aChcInBuZ1wiKSB8fCB1cmwuZW5kc1dpdGgoXCJqcGdcIikgfHwgdXJsLmVuZHNXaXRoKFwiZ2lmXCIpKSB7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgLy91cmwgPSB1cmwgKyBcIi5wbmdcIjtcbiAgICB9XG5cbiAgICBjYy5sb2FkZXIubG9hZCh7dXJsOnVybCx0eXBlOlwianBnXCJ9LCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKGRhdGEpO1xuICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gZnJhbWU7XG4gICAgfSk7XG4gIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNwcml0ZUhlbHBlcjtcbiIsIi8vIOe7mSBTdHJpbmcg5re75Yqg5Yqf6IO9XG5cbi8vIHN0ci5zdGFydHNXaXRoKFwiXCIpO1xuLy8gc3RyLmVuZHNXaXRoKFwiXCIpO1xuXG5pZiAoIVN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aCkge1xuICAoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnOyAvLyBuZWVkZWQgdG8gc3VwcG9ydCBgYXBwbHlgL2BjYWxsYCB3aXRoIGB1bmRlZmluZWRgL2BudWxsYFxuICAgIHZhciBkZWZpbmVQcm9wZXJ0eSA9IChmdW5jdGlvbigpIHtcbiAgICAgIC8vIElFIDggb25seSBzdXBwb3J0cyBgT2JqZWN0LmRlZmluZVByb3BlcnR5YCBvbiBET00gZWxlbWVudHNcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciBvYmplY3QgPSB7fTtcbiAgICAgICAgdmFyICRkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbiAgICAgICAgdmFyIHJlc3VsdCA9ICRkZWZpbmVQcm9wZXJ0eShvYmplY3QsIG9iamVjdCwgb2JqZWN0KSAmJiAkZGVmaW5lUHJvcGVydHk7XG4gICAgICB9IGNhdGNoKGVycm9yKSB7fVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KCkpO1xuICAgIHZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuICAgIHZhciBzdGFydHNXaXRoID0gZnVuY3Rpb24oc2VhcmNoKSB7XG4gICAgICBpZiAodGhpcyA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IFR5cGVFcnJvcigpO1xuICAgICAgfVxuICAgICAgdmFyIHN0cmluZyA9IFN0cmluZyh0aGlzKTtcbiAgICAgIGlmIChzZWFyY2ggJiYgdG9TdHJpbmcuY2FsbChzZWFyY2gpID09ICdbb2JqZWN0IFJlZ0V4cF0nKSB7XG4gICAgICAgIHRocm93IFR5cGVFcnJvcigpO1xuICAgICAgfVxuICAgICAgdmFyIHN0cmluZ0xlbmd0aCA9IHN0cmluZy5sZW5ndGg7XG4gICAgICB2YXIgc2VhcmNoU3RyaW5nID0gU3RyaW5nKHNlYXJjaCk7XG4gICAgICB2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyaW5nLmxlbmd0aDtcbiAgICAgIHZhciBwb3NpdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkO1xuICAgICAgLy8gYFRvSW50ZWdlcmBcbiAgICAgIHZhciBwb3MgPSBwb3NpdGlvbiA/IE51bWJlcihwb3NpdGlvbikgOiAwO1xuICAgICAgaWYgKHBvcyAhPSBwb3MpIHsgLy8gYmV0dGVyIGBpc05hTmBcbiAgICAgICAgcG9zID0gMDtcbiAgICAgIH1cbiAgICAgIHZhciBzdGFydCA9IE1hdGgubWluKE1hdGgubWF4KHBvcywgMCksIHN0cmluZ0xlbmd0aCk7XG4gICAgICAvLyBBdm9pZCB0aGUgYGluZGV4T2ZgIGNhbGwgaWYgbm8gbWF0Y2ggaXMgcG9zc2libGVcbiAgICAgIGlmIChzZWFyY2hMZW5ndGggKyBzdGFydCA+IHN0cmluZ0xlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgaW5kZXggPSAtMTtcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgc2VhcmNoTGVuZ3RoKSB7XG4gICAgICAgIGlmIChzdHJpbmcuY2hhckNvZGVBdChzdGFydCArIGluZGV4KSAhPSBzZWFyY2hTdHJpbmcuY2hhckNvZGVBdChpbmRleCkpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgaWYgKGRlZmluZVByb3BlcnR5KSB7XG4gICAgICBkZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAnc3RhcnRzV2l0aCcsIHtcbiAgICAgICAgJ3ZhbHVlJzogc3RhcnRzV2l0aCxcbiAgICAgICAgJ2NvbmZpZ3VyYWJsZSc6IHRydWUsXG4gICAgICAgICd3cml0YWJsZSc6IHRydWVcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGggPSBzdGFydHNXaXRoO1xuICAgIH1cbiAgfSgpKTtcbn1cblxuLy8gc3RyLmVuZHNXaXRoKFwiXCIpO1xuaWYgKCFTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoKSB7XG5cdChmdW5jdGlvbigpIHtcblx0XHQndXNlIHN0cmljdCc7IC8vIG5lZWRlZCB0byBzdXBwb3J0IGBhcHBseWAvYGNhbGxgIHdpdGggYHVuZGVmaW5lZGAvYG51bGxgXG5cdFx0dmFyIGRlZmluZVByb3BlcnR5ID0gKGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gSUUgOCBvbmx5IHN1cHBvcnRzIGBPYmplY3QuZGVmaW5lUHJvcGVydHlgIG9uIERPTSBlbGVtZW50c1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dmFyIG9iamVjdCA9IHt9O1xuXHRcdFx0XHR2YXIgJGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXHRcdFx0XHR2YXIgcmVzdWx0ID0gJGRlZmluZVByb3BlcnR5KG9iamVjdCwgb2JqZWN0LCBvYmplY3QpICYmICRkZWZpbmVQcm9wZXJ0eTtcblx0XHRcdH0gY2F0Y2goZXJyb3IpIHt9XG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH0oKSk7XG5cdFx0dmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7XG5cdFx0dmFyIGVuZHNXaXRoID0gZnVuY3Rpb24oc2VhcmNoKSB7XG5cdFx0XHRpZiAodGhpcyA9PSBudWxsKSB7XG5cdFx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xuXHRcdFx0fVxuXHRcdFx0dmFyIHN0cmluZyA9IFN0cmluZyh0aGlzKTtcblx0XHRcdGlmIChzZWFyY2ggJiYgdG9TdHJpbmcuY2FsbChzZWFyY2gpID09ICdbb2JqZWN0IFJlZ0V4cF0nKSB7XG5cdFx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xuXHRcdFx0fVxuXHRcdFx0dmFyIHN0cmluZ0xlbmd0aCA9IHN0cmluZy5sZW5ndGg7XG5cdFx0XHR2YXIgc2VhcmNoU3RyaW5nID0gU3RyaW5nKHNlYXJjaCk7XG5cdFx0XHR2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyaW5nLmxlbmd0aDtcblx0XHRcdHZhciBwb3MgPSBzdHJpbmdMZW5ndGg7XG5cdFx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcblx0XHRcdFx0dmFyIHBvc2l0aW9uID0gYXJndW1lbnRzWzFdO1xuXHRcdFx0XHRpZiAocG9zaXRpb24gIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdC8vIGBUb0ludGVnZXJgXG5cdFx0XHRcdFx0cG9zID0gcG9zaXRpb24gPyBOdW1iZXIocG9zaXRpb24pIDogMDtcblx0XHRcdFx0XHRpZiAocG9zICE9IHBvcykgeyAvLyBiZXR0ZXIgYGlzTmFOYFxuXHRcdFx0XHRcdFx0cG9zID0gMDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHZhciBlbmQgPSBNYXRoLm1pbihNYXRoLm1heChwb3MsIDApLCBzdHJpbmdMZW5ndGgpO1xuXHRcdFx0dmFyIHN0YXJ0ID0gZW5kIC0gc2VhcmNoTGVuZ3RoO1xuXHRcdFx0aWYgKHN0YXJ0IDwgMCkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR2YXIgaW5kZXggPSAtMTtcblx0XHRcdHdoaWxlICgrK2luZGV4IDwgc2VhcmNoTGVuZ3RoKSB7XG5cdFx0XHRcdGlmIChzdHJpbmcuY2hhckNvZGVBdChzdGFydCArIGluZGV4KSAhPSBzZWFyY2hTdHJpbmcuY2hhckNvZGVBdChpbmRleCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH07XG5cdFx0aWYgKGRlZmluZVByb3BlcnR5KSB7XG5cdFx0XHRkZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAnZW5kc1dpdGgnLCB7XG5cdFx0XHRcdCd2YWx1ZSc6IGVuZHNXaXRoLFxuXHRcdFx0XHQnY29uZmlndXJhYmxlJzogdHJ1ZSxcblx0XHRcdFx0J3dyaXRhYmxlJzogdHJ1ZVxuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdFN0cmluZy5wcm90b3R5cGUuZW5kc1dpdGggPSBlbmRzV2l0aDtcblx0XHR9XG5cdH0oKSk7XG59XG4iLCJjb25zdCBTcHJpdGVIZWxwZXIgPSByZXF1aXJlKCdTcHJpdGVIZWxwZXInKTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGF2YXRhclNwcml0ZTogY2MuU3ByaXRlLFxuICAgICAgICBsYWJlbFVzZXJJZDogY2MuTGFiZWwsXG4gICAgICAgIGxhYmVsU2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcblxuICAgICAgICBfZGVza0luZm86IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldFVzZXJJbmZvOiBmdW5jdGlvbiAodXNlciwgZGVza0luZm8pIHtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciB0b3RhbFNjb3JlID0gdXNlci50b3RhbFNjb3JlO1xuICAgICAgaWYgKGRlc2tJbmZvICYmICgoZGVza0luZm8uc2V0dGluZzEgPT0gMCkgfHwgKGRlc2tJbmZvLnNldHRpbmcxID09IDEpKSkge1xuICAgICAgICBsZXQgYmFzZVNjb3JlID0gKGRlc2tJbmZvLnNldHRpbmcxID09IDApID8gMTAwIDogMjAwO1xuICAgICAgICB0b3RhbFNjb3JlID0gdG90YWxTY29yZSAtIGJhc2VTY29yZTtcbiAgICAgIH1cblxuICAgICAgU3ByaXRlSGVscGVyLnNldEltYWdlVXJsKHRoaXMuYXZhdGFyU3ByaXRlLCB1c2VyLmF2YXRhclVybCk7XG4gICAgICB0aGlzLmxhYmVsVXNlcklkLnN0cmluZyA9IFwiXCIgKyB1c2VyLmlkO1xuICAgICAgdGhpcy5sYWJlbFNjb3JlLnN0cmluZyA9ICh0b3RhbFNjb3JlID4gMCkgPyAoXCIrIFwiICsgdG90YWxTY29yZSkgOiAoXCItIFwiICsgdG90YWxTY29yZSAqIC0xKTtcbiAgICAgIGlmICh0b3RhbFNjb3JlID09IDApIHtcbiAgICAgICAgdGhpcy5sYWJlbFNjb3JlLnN0cmluZyA9IFwiMFwiO1xuICAgICAgfVxuICAgICAgdGhpcy5sYWJlbE5pY2tuYW1lLnN0cmluZyA9IHVzZXIubmlja25hbWU7XG4gICAgfSxcbn0pO1xuIiwiY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBpdGVtTGF5b3V0OiBjYy5MYXlvdXQsXG4gICAgICAgIGl0ZW1QcmVmYWI6IGNjLlByZWZhYixcbiAgICAgICAgdGltZUxhYmVsOmNjLkxhYmVsLCAgIC8vIOaXtumXtFxuICAgICAgICBqdXNodUxhYmVsOmNjLkxhYmVsLCAgLy8g5bGA5pWwXG4gICAgICAgIHJvb21JZDpjYy5MYWJlbCwgICAgICAvLyDmiL/pl7Tlj7dcbiAgICAgICAgbmlja25hbWVMYWJlbHM6Y2MuTGFiZWwsXG4gICAgICAgIHJlY29yZEluZm9fc3ZpZXc6W2NjLk5vZGVdLFxuXG4gICAgICAgIHNoYXJyQmc6Y2MuTm9kZSxcbiAgICAgICAgYnRuV2VpWGluOmNjLk5vZGUsXG4gICAgICAgIGJ0bkdvbmdYdW9IYW86Y2MuTm9kZSxcbiAgICAgICAgYnRuWmh1U2hvdTpjYy5Ob2RlLFxuICAgICAgICBidG5ab25nRmVuOmNjLk5vZGUsXG5cbiAgICAgICAgc3VhbmZlbl9zdmlldzpjYy5Ob2RlLFxuICAgICAgICBzdWFuRmVuUHJlZmFiOiBjYy5QcmVmYWIsXG4gICAgICAgIHN1YW5GZW5CZ1ByZWZhYjogY2MuUHJlZmFiLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBvbkRpc2FibGU6ZnVuY3Rpb24oKXtcbiAgICAgICAgLy9pZihjYy5zeXMuaXNCcm93c2VyKXtcbiAgICAgICAgLy9cbiAgICAgICAgICAgIHZhciBzaGFyZVRpdGxlID0gJ+W8gOaIv+eOqVvlpKfkvJfljYHkuInmsLRdJztcbiAgICAgICAgICAgIHZhciBkZXNjID0gJ+W8gOWlveaIv+S6hu+8jOWwseetieS9oOS7rOS4gOi1t+adpVvlpKfkvJfljYHkuInmsLRd5ZWm77yB5pma5LqG5L2N572u5bCx5rKh5LqG5ZOffic7IFxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzaGFyZVRpdGxlJyxzaGFyZVRpdGxlKTtcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGVzYycsZGVzYyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInNoYXJlVGl0bGVcIik7XG4gICAgICAgICAgICAvLyBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJkZXNjXCIpO1xuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwicmVjb3JkSWRcIik7XG4gICAgICAgICAgICAvL2NjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInJvb21JZFwiLCcnKTtcbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvVGltZUxpbmUpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1Nlc3Npb24pIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1Nlc3Npb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgLy99XG5cbiAgICB9LFxuICAgIGpzOiBmdW5jdGlvbihzZXR0aW5nMil7XG4gICAgICAgIHZhciBqdXNodSA9IDU7XG4gICAgICAgIHN3aXRjaChzZXR0aW5nMil7XG4gICAgICAgICAgICBjYXNlIDA6IGp1c2h1ID0gNTsgYnJlYWs7Y2FzZSAxOiBqdXNodSA9IDEwOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjoganVzaHUgPSAyMDsgYnJlYWs7Y2FzZSAzOiBqdXNodSA9IDMwOyBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ganVzaHU7XG4gICAgfSxcblxuICAgIGNyZWF0b3IgOmZ1bmN0aW9uKGNyZWF0b3IscGxheWVycyl7ICAgIC8v5Yib5oi/6ICFXG4gICAgICAgIGZvcih2YXIgaSA9MDsgaTxwbGF5ZXJzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgaWYocGxheWVyc1tpXS5pZCA9PSBjcmVhdG9yKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfY2xpY2tCdG4gOmZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuYnRuWmh1U2hvdS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmJ0blpvbmdGZW4uYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGNsaWNrWm9uZ0ZlbiA6ZnVuY3Rpb24oKXtcblxuICAgICAgICB0aGlzLmJ0blpodVNob3UuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLmJ0blpvbmdGZW4uYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5yZWNvcmRJbmZvX3N2aWV3LmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtub2RlLmFjdGl2ZSA9IHRydWU7fSk7XG5cbiAgICAgICAgdGhpcy5zdWFuZmVuX3N2aWV3LmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG4gICAgX2dsb2JhbE1zZzpmdW5jdGlvbihyZWNvcmRJbmZvKXtcbiAgICAgICAgLy9pZihjYy5zeXMuaXNCcm93c2VyKSB7XG4gICAgICAgICAgICB2YXIgcm9vbUlkID1cIuaIv+mXtOWPt++8mlwiK3JlY29yZEluZm8ucm9vbUlkO1xuICAgICAgICAgICAgdmFyIHBqID0gW1wiNSBcIixcIjEwIFwiLFwiMjAgXCJdOyAgXG4gICAgICAgICAgICB2YXIganMgPSBcIuWxgOaVsO+8mlwiK3BqW3JlY29yZEluZm8uc2V0dGluZzEtMl07XG4gICAgICAgICAgICB2YXIgdGltZSA9IFwi5pe26Ze077yaXCIrKHJlY29yZEluZm8uY3JlYXRlQXQ/cmVjb3JkSW5mby5jcmVhdGVBdDpyZWNvcmRJbmZvLmNyZWF0ZVRpbWUpO1xuICAgICAgICAgICAgdmFyIHNoYXJlVGl0bGUgPSBcIlvlpKfkvJfljYHkuInmsLRd5oiY57upXCI7XG4gICAgICAgICAgICB2YXIgZGVzYyA9IHJvb21JZCtqcyt0aW1lK1wiIOeCueWHu+afpeeci+ivpuaDhVwiO1xuICAgICAgICAgICAgdmFyIHJlY29yZElkID0gKHJlY29yZEluZm8uaWQhPXVuZGVmaW5lZCk/cmVjb3JkSW5mby5pZDpyZWNvcmRJbmZvLnJlY29yZElkOyAgXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJzaGFyZVRpdGxlXCIsc2hhcmVUaXRsZSk7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJkZXNjXCIsZGVzYyk7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJyZWNvcmRJZFwiLHJlY29yZElkKTtcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInJvb21JZFwiLCcnKTtcblxuICAgICAgICAgICAgaWYod2luZG93LnNoYXJlVG9UaW1lTGluZSkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvVGltZUxpbmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvU2Vzc2lvbikge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvU2Vzc2lvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAvL31cbiAgICB9LFxuICAgIC8v5aSn5bGAXG4gICAgc2V0UGxheWVySW5mb3M6IGZ1bmN0aW9uIChwbGF5ZXJJbmZvcywgZGVza0luZm8pe1xuICAgICAgICBwbGF5ZXJJbmZvcy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIudG90YWxTY29yZS1hLnRvdGFsU2NvcmV9KTsgLy8g5o6S5bqPXG4gICAgICAgIC8vIGNjLmxvZyhwbGF5ZXJJbmZvcylcbiAgICAgICAgLy8gY2MubG9nKGRlc2tJbmZvKVxuICAgICAgICAvLyBjYy5sb2coJy0tNjUnKVxuICAgICAgICAgXG4gICAgICAgIHRoaXMuX2dsb2JhbE1zZyhkZXNrSW5mbyk7XG4gICAgICAgIHRoaXMucmVjb3JkSW5mb19zdmlldy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7bm9kZS5hY3RpdmUgPSB0cnVlO30pO1xuXG4gICAgICAgIHRoaXMuc3VhbmZlbl9zdmlldy5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLmJ0blpodVNob3UuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLmJ0blpvbmdGZW4uYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSBwbGF5ZXJJbmZvcztcblxuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IGRlc2tJbmZvO1xuXG4gICAgICAgIHZhciBjcmVhdGVJZCA9IGRlc2tJbmZvLmNyZWF0ZVVzZXJJZD8gZGVza0luZm8uY3JlYXRlVXNlcklkOiBkZXNrSW5mby5jcmVhdGVJZDtcblxuICAgICAgICB2YXIgbmlja25hbWUgPSBwbGF5ZXJJbmZvc1sgdGhpcy5jcmVhdG9yKGNyZWF0ZUlkLCBwbGF5ZXJJbmZvcykgXS5uaWNrbmFtZTtcblxuICAgICAgICB0aGlzLnJvb21JZC5zdHJpbmcgPSBkZXNrSW5mby5yb29tSWQ7XG5cbiAgICAgICAgdmFyIGNyZWF0ZUF0ID0gZGVza0luZm8uY3JlYXRlQXQ/IGRlc2tJbmZvLmNyZWF0ZUF0OiBkZXNrSW5mby5jcmVhdGVUaW1lO1xuXG4gICAgICAgIHRoaXMudGltZUxhYmVsLnN0cmluZyA9IGNyZWF0ZUF0LnN1YnN0cigwLDExKTtcblxuICAgICAgICB0aGlzLmp1c2h1TGFiZWwuc3RyaW5nID0gdGhpcy5qcyhkZXNrSW5mby5zZXR0aW5nMS0yKTtcblxuICAgICAgICB0aGlzLm5pY2tuYW1lTGFiZWxzLnN0cmluZyA9IG5pY2tuYW1lO1xuXG4gICAgICAgIHRoaXMuaXRlbUxheW91dC5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbiAodXNlcikge1xuXG4gICAgICAgICAgICBsZXQgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuaXRlbVByZWZhYik7XG5cbiAgICAgICAgICAgIGl0ZW0uZ2V0Q29tcG9uZW50KCdUb3RhbEdhbWVSZXN1bHRJdGVtJykuc2V0VXNlckluZm8odXNlciwgZGVza0luZm8pO1xuXG4gICAgICAgICAgICBpZihkZXNrSW5mby5jcmVhdGVVc2VySWQgPT0gdXNlci5pZCB8fCBkZXNrSW5mby5jcmVhdGVJZCA9PSB1c2VyLmlkKXtcblxuICAgICAgICAgICAgICAgIGl0ZW0uY2hpbGRyZW5bMV0uY2hpbGRyZW5bMF0uYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICAgICAgfWVsc2V7XG5cbiAgICAgICAgICAgICAgICBpdGVtLmNoaWxkcmVuWzFdLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuaXRlbUxheW91dC5ub2RlLmFkZENoaWxkKGl0ZW0pO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICB9LFxuXG4gICAgLy/nrpfliIbog73miYtcbiAgICBjbGlja1N1YW5GZW46IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB0aGlzLmJ0blpodVNob3UuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5idG5ab25nRmVuLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5yZWNvcmRJbmZvX3N2aWV3LmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtub2RlLmFjdGl2ZSA9IGZhbHNlO30pO1xuXG4gICAgICAgIHRoaXMuc3VhbmZlbl9zdmlldy5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHZhciBwbGF5ZXJzUmlndGggPSB0aGlzLl9wbGF5ZXJJbmZvcy5maWx0ZXIoZnVuY3Rpb24gKHBsYXllcikge3JldHVybiBwbGF5ZXIudG90YWxTY29yZSA+IDA7fSk7XG5cbiAgICAgICAgdmFyIHBsYXllcnNMZWZ0ID0gdGhpcy5fcGxheWVySW5mb3MuZmlsdGVyKGZ1bmN0aW9uIChwbGF5ZXIpIHtyZXR1cm4gcGxheWVyLnRvdGFsU2NvcmUgPCAwO30pO1xuXG4gICAgICAgIHZhciBwbGF5ZXJzUmlndGhTY29yZSA9IHBsYXllcnNSaWd0aC5tYXAoZnVuY3Rpb24gKHBsYXllcikge3JldHVybiBwbGF5ZXIudG90YWxTY29yZTt9KTtcblxuICAgICAgICB2YXIgcGxheWVyc0xlZnRTY29yZSA9IHBsYXllcnNMZWZ0Lm1hcChmdW5jdGlvbiAocGxheWVyKSB7cmV0dXJuIHBsYXllci50b3RhbFNjb3JlICogLTE7fSk7XG5cbiAgICAgICAgdmFyIHBsYXllcnNJbmRleCA9IFtdLFxuXG4gICAgICAgICAgICBhcnJzID0gW3BsYXllcnNSaWd0aFNjb3JlLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaTt9KSxwbGF5ZXJzTGVmdFNjb3JlLmZpbHRlcihmdW5jdGlvbihpKXtyZXR1cm4gaTt9KV0sXG5cbiAgICAgICAgICAgIGluZGV4cyA9IHBsYXllcnNMZWZ0U2NvcmUubGVuZ3RoID4gcGxheWVyc1JpZ3RoU2NvcmUubGVuZ3RoPyAwOiAxOy8vMeaYr+i1oueahOS6uiAw6L6T55qE5Lq6XG5cbiAgICAgICAgLy8gZm9yKHZhciBpID0gMDtpIDwgYXJyc1tpbmRleHNdLmxlbmd0aDsgaSsrKXtcblxuICAgICAgICAvLyAgICAgdmFyIHNjb3JlID0gYXJyc1tpbmRleHNdW2ldO1xuXG4gICAgICAgIC8vICAgICB2YXIgZCA9IHRoaXMuZ2V0Q29tYkJ5U3VtKGFycnNbaW5kZXhzPT0xPzA6MV0sIHNjb3JlKVswXSB8fCBbXTtcblxuICAgICAgICAvLyAgICAgaWYoZC5sZW5ndGggPiAwKXtcblxuICAgICAgICAvLyAgICAgICAgIHBsYXllcnNJbmRleC5wdXNoKFtzY29yZSxkXSk7XG5cbiAgICAgICAgLy8gICAgICAgICBkLmZvckVhY2goZnVuY3Rpb24gKHMpIHtcblxuICAgICAgICAvLyAgICAgICAgICAgICB2YXIgaW5kZXggPSBhcnJzW2luZGV4cz09MT8wOjFdLmluZGV4T2Yocyk7XG5cbiAgICAgICAgLy8gICAgICAgICAgICAgaWYoaW5kZXggIT0gLTEpIGFycnNbaW5kZXhzPT0xPzA6MV0uc3BsaWNlKGluZGV4LDEpO1xuXG4gICAgICAgIC8vICAgICAgICAgfSk7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH1cblxuICAgICAgICAvLyBpZihwbGF5ZXJzSW5kZXgubGVuZ3RoID09IDApIGluZGV4cyA9IDI7XG4gICAgICAgIGluZGV4cyA9IDJcbiAgICAgICAgdGhpcy5zdWFuZmVuX3N2aWV3LmNoaWxkcmVuWzBdLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgcGxheWVyc0xlZnQuZm9yRWFjaChmdW5jdGlvbiAodXNlciwgaW5kZXgpIHtcblxuICAgICAgICAgICAgdmFyIHN1YW5GZW5CZ1ByZWZhYiA9IGNjLmluc3RhbnRpYXRlKHRoaXMuc3VhbkZlbkJnUHJlZmFiKTtcblxuICAgICAgICAgICAgc3VhbkZlbkJnUHJlZmFiLnJlbW92ZUFsbENoaWxkcmVuKCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2N0YXJlUHJlZmFiKDEgLHN1YW5GZW5CZ1ByZWZhYiwgdXNlciwgdXNlci50b3RhbFNjb3JlLCB0aGlzLl9kZXNrSW5mbyAsLTIwMCAsMCk7XG5cbiAgICAgICAgICAgIHZhciB4ID0gMCwgeSA9IDA7XG5cbiAgICAgICAgICAgIGlmKGluZGV4cyA9PSAxKXtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgcGxheWVyc0luZGV4W2luZGV4XVsxXS5sZW5ndGg7IGorKyl7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBwbGF5ZXJzSW5kZXhbaW5kZXhdWzFdW2pdO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gcGxheWVyc1JpZ3RoU2NvcmUuaW5kZXhPZihzKTtcblxuICAgICAgICAgICAgICAgICAgICBpZihkICE9IC0xKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXlzID0gcGxheWVyc1JpZ3RoLnNwbGljZShkLDEpWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJzUmlndGhTY29yZS5zcGxpY2UoZCwxKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYocGxheXMpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPj0gMykgeSA9IC05MDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID09IDMpIHggPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPj0gNSkgeSA9IC0xODA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdWFuRmVuQmdQcmVmYWIuY2hpbGRyZW5Db3VudCA9PSA1KSB4ID0gMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2N0YXJlUHJlZmFiKDAsIHN1YW5GZW5CZ1ByZWZhYiwgcGxheXMsIHBsYXlzLnRvdGFsU2NvcmUsIHRoaXMuX2Rlc2tJbmZvLCB4ICx5KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggKz0gMjAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGluZGV4cyA9PSAwKXtcbiAgICAgICAgICAgICAgICB2YXIgZmVuID0gc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuWzBdLmdldENoaWxkQnlOYW1lKFwiZmVuXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nLnN1YnN0cigzKSAqIC0xO1xuXG4gICAgICAgICAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IHBsYXllcnNJbmRleC5sZW5ndGg7IGorKyl7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBwbGF5ZXJzSW5kZXhbal07XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBzWzFdLmluZGV4T2YoZmVuKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcSA9IHNbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHcgPSBwbGF5ZXJzUmlndGhTY29yZS5pbmRleE9mKHEpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKGQgIT0gLTEgJiYgdyAhPSAtMSl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbGF5cyA9IHBsYXllcnNSaWd0aFt3XTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3RhcmVQcmVmYWIoMCwgc3VhbkZlbkJnUHJlZmFiLCBwbGF5cywgcGxheXMudG90YWxTY29yZSwgdGhpcy5fZGVza0luZm8sIHgsIHksIGZlbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcSA9IHBsYXllcnNMZWZ0U2NvcmVbaW5kZXhdO1xuICAgICAgICAgICAgICAgIHZhciBhZGRTY29yZSA9IDA7XG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IFtdO1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCBwbGF5ZXJzUmlndGhTY29yZS5sZW5ndGg7IGorKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB3ID0gcGxheWVyc1JpZ3RoU2NvcmVbal07XG4gICAgICAgICAgICAgICAgICAgIGlmKGFkZFNjb3JlIDwgcSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRTY29yZSArPSB3O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYWRkU2NvcmUgPiBxKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnIucHVzaCh3IC0gKGFkZFNjb3JlIC0gcSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2godyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihxIC0gdyA+PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJzUmlndGhTY29yZVtqXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYoYWRkU2NvcmUgPiBxKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllcnNSaWd0aFNjb3JlW2pdID0gYWRkU2NvcmUgLSBxO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IodmFyIHQgPSAwOyB0IDwgYXJyLmxlbmd0aDsgdCsrKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBhcnJbdF07XG4gICAgICAgICAgICAgICAgICAgIGlmKHIgPT0gMCkgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID49IDMpIHkgPSAtOTA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPT0gMykgeCA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPj0gNSkgeSA9IC0xODA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPT0gNSkgeCA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXlzID0gcGxheWVyc1JpZ3RoW3RdO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N0YXJlUHJlZmFiKDAsIHN1YW5GZW5CZ1ByZWZhYiwgcGxheXMsIHIsIHRoaXMuX2Rlc2tJbmZvLCB4LCB5KTtcblxuICAgICAgICAgICAgICAgICAgICB4ICs9IDIwMDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zdWFuZmVuX3N2aWV3LmNoaWxkcmVuWzBdLmFkZENoaWxkKHN1YW5GZW5CZ1ByZWZhYik7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIH0sXG5cbiAgICBfY3RhcmVQcmVmYWI6IGZ1bmN0aW9uIChzaHUsIG5vZGUsIHVzZXIsIHRvdGFsU2NvcmUsIGRlc2tJbmZvLCB4LCB5LCBmZW4gPSBudWxsKSB7XG5cbiAgICAgICAgdmFyIHN1YW5GZW5QcmVmYWIgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnN1YW5GZW5QcmVmYWIpO1xuXG4gICAgICAgIHN1YW5GZW5QcmVmYWIuZ2V0Q2hpbGRCeU5hbWUoXCJJRFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwiSUQ6XCIrdXNlci5pZDtcblxuICAgICAgICBpZihkZXNrSW5mby5jcmVhdGVVc2VySWQgPT0gdXNlci5pZClzdWFuRmVuUHJlZmFiLmdldENoaWxkQnlOYW1lKFwiSURcIikuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjM1LCAxMTUsIDEyMik7XG5cbiAgICAgICAgc3VhbkZlblByZWZhYi5nZXRDaGlsZEJ5TmFtZShcInNodVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHNodSA9PSAwPyBcIui+k1wiOiBcIlwiO1xuXG4gICAgICAgIHZhciBzdHIgPSBzaHUgPT0gMD8gdG90YWxTY29yZStcIuWIhlwiOiBcIuaAu+WIhjpcIit0b3RhbFNjb3JlO1xuXG4gICAgICAgIGlmKGZlbikgc3RyID0gZmVuK1wi5YiGXCI7XG5cbiAgICAgICAgc3VhbkZlblByZWZhYi5nZXRDaGlsZEJ5TmFtZShcImZlblwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHN0cjtcblxuICAgICAgICB2YXIgc3ByaXRlID0gc3VhbkZlblByZWZhYi5nZXRDaGlsZEJ5TmFtZShcImhhZWRcIikuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG5cbiAgICAgICAgdmFyIGhlYWRVcmwgPSB1c2VyLmF2YXRhclVybDsgLy8g5aS05YOPVVJMXG5cbiAgICAgICAgY2MubG9hZGVyLmxvYWQoe3VybDpoZWFkVXJsLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIHRleCkge1xuXG4gICAgICAgICAgICBpZiAoIWVycikge1xuXG4gICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKHRleCk7XG5cbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBmcmFtZTtcblxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmhlaWdodCA9IDU1O1xuXG4gICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUud2lkdGggPSA1NTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHN1YW5GZW5QcmVmYWIueCA9IHg7XG5cbiAgICAgICAgc3VhbkZlblByZWZhYi55ID0geTtcblxuICAgICAgICBub2RlLmhlaWdodCA9IDkwICsgeSAqIC0xO1xuXG4gICAgICAgIG5vZGUuYWRkQ2hpbGQoc3VhbkZlblByZWZhYik7XG5cbiAgICB9LFxuXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFNvY2tldC5zZW5kT25jZUFnYWluKCdmYWxzZScsdGhpcy5fdXNlcklkKTtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgfSxcblxuICAgIGNsaWNrU2hhcmVXZWlDaGF0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgdGhpcy5zaGFyckJnLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2NyZWVuU2hhcmVGcmllbmRcIiwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAgICAgICAgS1FOYXRpdmVJbnZva2Uuc2NyZWVuc2hvdFNoYXJlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgfVxuICAgIH0sXG4gICAgY2xpY2tTaGFyZUJnIDpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2hhcnJCZy5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuICAgIGNsaWNrU2hhcmVQZW5nWW91UXVhbjogZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2NyZWVuU2hhcmVcIiwpO1xuICAgICAgfVxuICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVcIiwgXCIoKVZcIik7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGdldENvbWJCeVN1bTogZnVuY3Rpb24gKGFycmF5LHN1bSx0b2xlcmFuY2UsdGFyZ2V0Q291bnQpIHtcbiAgICAgICAgdmFyIHV0aWwgPSB7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgZ2V0IGNvbWJpbmF0aW9uIGZyb20gYXJyYXlcbiAgICAgICAgICAgICAgICAgYXJyOiB0YXJnZXQgYXJyYXlcbiAgICAgICAgICAgICAgICAgbnVtOiBjb21iaW5hdGlvbiBpdGVtIGxlbmd0aFxuICAgICAgICAgICAgICAgICByZXR1cm46IG9uZSBhcnJheSB0aGF0IGNvbnRhaW4gY29tYmluYXRpb24gYXJyYXlzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZ2V0Q29tYmluYXRpb246IGZ1bmN0aW9uKGFyciwgbnVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByPVtdO1xuICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gZih0LGEsbilcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG49PTApXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIucHVzaCh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MCxsPWEubGVuZ3RoOyBpPD1sLW47IGkrKylcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmKHQuY29uY2F0KGFbaV0pLCBhLnNsaWNlKGkrMSksIG4tMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pKFtdLGFycixudW0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vdGFrZSBhcnJheSBpbmRleCB0byBhIGFycmF5XG4gICAgICAgICAgICAgICAgZ2V0QXJyYXlJbmRleDogZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgciA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7aTxhcnJheS5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHIucHVzaChpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sbG9naWMgPSB7XG4gICAgICAgICAgICAgICAgLy9zb3J0IHRoZSBhcnJheSx0aGVuIGdldCB3aGF0J3Mgd2UgbmVlZFxuICAgICAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uKGFycmF5LHN1bSkge1xuICAgICAgICAgICAgICAgICAgICAvL2Nsb25lIGFycmF5XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYXJyYXkgPSBhcnJheS5jb25jYXQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAwO1xuICAgICAgICAgICAgICAgICAgICAvL3NvcnQgYnkgYXNjXG4gICAgICAgICAgICAgICAgICAgIF9hcnJheS5zb3J0KGZ1bmN0aW9uKGEsYil7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSAtIGI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvL2dldCBhbGwgbnVtYmVyIHdoZW4gaXQncyBsZXNzIHRoYW4gb3IgZXF1YWwgc3VtXG4gICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDtpPF9hcnJheS5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKF9hcnJheVtpXTw9c3VtKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnB1c2goX2FycmF5W2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAvL2ltcG9ydGFudCBmdW5jdGlvblxuICAgICAgICAgICAgICAgIGNvcmU6IGZ1bmN0aW9uKGFycmF5LHN1bSxhcnJheUluZGV4LGNvdW50LHIpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBrID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbWJBcnJheSA9IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgX3N1bSA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2NhID0gW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2FjaGUgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICBpZihjb3VudCA9PSBfcmV0dXJuTWFyayl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgY3VycmVudCBjb3VudCBjb21iaW5hdGlvblxuICAgICAgICAgICAgICAgICAgICBjb21iQXJyYXkgPSB1dGlsLmdldENvbWJpbmF0aW9uKGFycmF5SW5kZXgsY291bnQpO1xuICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7aTxjb21iQXJyYXkubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2NhID0gY29tYkFycmF5W2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3N1bSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2FjaGUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRlIHRoZSBzdW0gZnJvbSBjb21iaW5hdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGsgPSAwO2s8X2NjYS5sZW5ndGg7aysrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3VtICs9IGFycmF5W19jY2Fba11dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jYWNoZS5wdXNoKGFycmF5W19jY2Fba11dKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKE1hdGguYWJzKF9zdW0tc3VtKSA8PSBfdG9sZXJhbmNlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnB1c2goX2NhY2hlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGxvZ2ljLmNvcmUoYXJyYXksc3VtLGFycmF5SW5kZXgsY291bnQtMSxyKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByID0gW10sXG4gICAgICAgICAgICBfYXJyYXkgPSBbXSxcbiAgICAgICAgICAgIF90YXJnZXRDb3VudCA9IDAsXG4gICAgICAgICAgICBfdG9sZXJhbmNlID0gMCxcbiAgICAgICAgICAgIF9yZXR1cm5NYXJrID0gMDtcblxuICAgICAgICAvL2NoZWNrIGRhdGFcbiAgICAgICAgX3RhcmdldENvdW50ID0gdGFyZ2V0Q291bnQgfHwgX3RhcmdldENvdW50O1xuICAgICAgICBfdG9sZXJhbmNlID0gdG9sZXJhbmNlIHx8IF90b2xlcmFuY2U7XG5cbiAgICAgICAgX2FycmF5ID0gbG9naWMuaW5pdChhcnJheSxzdW0pO1xuICAgICAgICBpZihfdGFyZ2V0Q291bnQpe1xuICAgICAgICAgICAgX3JldHVybk1hcmsgPSBfdGFyZ2V0Q291bnQtMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvZ2ljLmNvcmUoX2FycmF5LHN1bSx1dGlsLmdldEFycmF5SW5kZXgoX2FycmF5KSwoX3RhcmdldENvdW50IHx8IF9hcnJheS5sZW5ndGgpLHIpO1xuXG4gICAgICAgIHJldHVybiByO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IFVzZXJNb2RlbEhlbHBlciA9IHtcbiAgLy8g55So5oi35piv5ZCm5bey5Ye654mMXG4gIGlzUGxheWVkQ2FyZHM6IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgY2MuYXNzZXJ0KHVzZXIpO1xuXG4gICAgaWYgKHVzZXIgJiYgdXNlci5jYXJkSW5mbyAmJiB1c2VyLmNhcmRJbmZvLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcblxuICAvLyDnlKjmiLfmmK/lkKblt7Llh4blpIdcbiAgaXNVc2VyUmVhZHk6IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgcmV0dXJuIHVzZXIucmVhZHlTdGF0dXMgPT0gdHJ1ZTtcbiAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVXNlck1vZGVsSGVscGVyO1xuIiwiY29uc3QgU3ByaXRlSGVscGVyID0gcmVxdWlyZSgnU3ByaXRlSGVscGVyJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGxhYmVsVXNlcklkOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxVc2VySVA6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcbiAgICAgICAgYXZhdGFyU3ByaXRlOiBjYy5TcHJpdGUsXG4gICAgICAgIG1hblNwcml0ZTogY2MuU3ByaXRlLFxuICAgICAgICB3b21lblNwcml0ZTogY2MuU3ByaXRlLFxuXG4gICAgICAgIF9kaWRTaG93VXNlckluZm86IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHVwZGF0ZVdpdGhVc2VyOiBmdW5jdGlvbiAodXNlcikge1xuICAgICAgcmV0dXJuO1xuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2RpZFNob3dVc2VySW5mbyA9PSB1c2VyKSB7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xuICAgICAgICB0aGlzLl9kaXNhcHBlYXJVc2VySW5mbygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2RpZFNob3dVc2VySW5mbyA9IHVzZXI7XG4gICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGlzYXBwZWFyVXNlckluZm8oKTtcbiAgICAgIH0uYmluZCh0aGlzKSwgNSk7XG5cbiAgICAgIHRoaXMubGFiZWxVc2VySWQuc3RyaW5nID1cIlVJRDpcXG5cIit1c2VyLmlkO1xuICAgICAgdGhpcy5sYWJlbFVzZXJJUC5zdHJpbmcgPVwi55So5oi3SVA6XFxuXCIrdXNlci5pcEFkZHJlc3MucmVwbGFjZShcIjo6ZmZmZjpcIiwgXCJcIik7XG4gICAgICB0aGlzLmxhYmVsTmlja25hbWUuc3RyaW5nID0gdXNlci5uaWNrbmFtZTtcbiAgICAgIHRoaXMuYXZhdGFyU3ByaXRlLnNwcml0ZUZyYW1lID0gbnVsbDtcbiAgICAgIFNwcml0ZUhlbHBlci5zZXRJbWFnZVVybCh0aGlzLmF2YXRhclNwcml0ZSwgdXNlci5hdmF0YXJVcmwpO1xuXG4gICAgICBsZXQgc2V4ID0gdXNlci5zZXg7ICAvLyBzZXg6IDEg55S3ICAyIOWls1xuICAgICAgdGhpcy5tYW5TcHJpdGUubm9kZS5hY3RpdmUgPSAoc2V4ID09IDEpO1xuICAgICAgdGhpcy53b21lblNwcml0ZS5ub2RlLmFjdGl2ZSA9IChzZXggIT0gMSk7XG4gICAgfSxcblxuICAgIF9kaXNhcHBlYXJVc2VySW5mbzogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5fZGlkU2hvd1VzZXJJbmZvID0gbnVsbDtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcclxuY29uc3QgS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlciA9IHJlcXVpcmUoJ0tRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXInKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIGFncmVlbWVudDoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUhhbGxJbmZvLCB0aGlzLl9zb2NrZXRSZWNlaXZlSGFsbEluZm8sIHRoaXMpO1xyXG4gICAgICAgIC8vIGNjLmxvZygnLS0tLTYxJylcclxuICAgICAgICAvLyAgY2MubG9nKHRoaXMuYWdyZWVtZW50KVxyXG4gICAgfSxcclxuICAgIF9zb2NrZXRSZWNlaXZlSGFsbEluZm86IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHMgPSBjYy5maW5kKCdDYW52YXMvYWdyZWVtZW50Jyk7XHJcbiAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIC8vdGhpcy5faW5mbzEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIC8vIGNjLmxvZyh0aGlzLmFncmVlbWVudClcclxuICAgICAgICAvLyBjYy5sb2cocylcclxuICAgICAgICAvLyBjYy5sb2coJy0tLS02MScpXHJcbiAgICAgICAgdGhpcy5hZ3JlZW1lbnQuc3RyaW5nID0gZGF0YS5pbmZvMSB8fCBcIlwiO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJ2YXIgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBwb3BOb2RlOmNjLk5vZGUsXG4gICAgICAgIGxhYmVsOmNjLkxhYmVsLFxuXG4gICAgICAgIF9hbGVydENhbGxiYWNrOiBudWxsLFxuICAgICAgICBfd2lsbERpc21pc3NDYWxsYmFjazogbnVsbCxcbiAgICAgICAgX2Rpc21pc3NDYWxsYmFjazogbnVsbCxcbiAgICAgICAgX2NvbmZpcm1DYWxsYmFjazogbnVsbCwgICAvLyDngrnlh7vnoa7lrprlkI7nmoTlm57osINcbiAgICAgICAgX3Rpc2hpOm51bGwsXG4gICAgICAgIF9jYXJkX251bTpudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIFxuICAgIH0sXG5cbiAgICBhbGVydDpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciBhbmltID0gdGhpcy5wb3BOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICBhbmltLnBsYXkoJ3BvcCcpO1xuXG4gICAgICAgIGlmICh0aGlzLl9hbGVydENhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy5fYWxlcnRDYWxsYmFjayh0aGlzLm5vZGUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvKiMjIyMj5by55Ye657uT5p6cKi9cbiAgICBhbGVydFJlc3VsdDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgY2MuZmluZChcIkNhbnZhcy9zaG93X3Jlc3VsdFwiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBvcE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgIGFuaW0ucGxheSgncG9wJyk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2FsZXJ0Q2FsbGJhY2spIHtcbiAgICAgICAgICB0aGlzLl9hbGVydENhbGxiYWNrKHRoaXMubm9kZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyojIyMjI+eCueWHu+ehruWumiovXG4gICAgcGxheUJ0bkNsaWNrU0ZYOmZ1bmN0aW9uKCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUJ0bkNsaWNrU0ZYKCk7XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vlj5bmtogqL1xuICAgIHBhbHlCdG5DYW5jZWxDbGlja1NGWDpmdW5jdGlvbigpe1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseUJ0bkNhbmNlbENsaWNrU0ZYKCk7XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vlhbPpl63miJbogIXmjInplK7kuYvnsbvnmoTmjInpkq7vvIzmkq3mlL7pn7PmlYgqL1xuICAgIHBhbHlCdG5QdWJsaWNTRlg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlCdG5QdWJsaWNTRlgoKTtcbiAgICB9LFxuXG4gICAgLyojIyMjI+eCueWHu+WIm+W7uuaIv+mXtO+8jOaSreaUvumfs+aViCovXG4gICAgcGFseUJ0bkNyZWF0ZVJvb21TRlg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlCdG5DcmVhdGVSb29tU0ZYKCk7XG4gICAgfSxcbiAgICAvKiMjIyMj54K55Ye75Yib5bu65oi/6Ze077yM5pKt5pS+6Z+z5pWIKi9cbiAgICBwYWx5V2luZG93U0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5V2luZG93U0ZYKCk7XG4gICAgfSxcblxuICAgIHBhbHlXZWlYaW5Mb2dpblNGWDpmdW5jdGlvbigpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlXZWlYaW5Mb2dpblNGWCgpO1xuICAgIH0sXG4gICAgcGFseUZhbmdQYWlTRlg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlGYW5nUGFpU0ZYKCk7XG4gICAgfSxcblxuICAgIGRpc21pc3NBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICBsZXQgd2lsbERpc21pc3NDYWxsYmFjayA9IHRoaXMuX3dpbGxEaXNtaXNzQ2FsbGJhY2s7XG4gICAgICBpZiAod2lsbERpc21pc3NDYWxsYmFjaykge1xuICAgICAgICBsZXQgcmVzdWx0ID0gd2lsbERpc21pc3NDYWxsYmFjaygpO1xuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgdGhpcy5kaXNtaXNzQ29tcGxldGUoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgICB2YXIgYW5pbSA9IHRoaXMucG9wTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgdmFyIGRpc21pc3NBbmltID0gYW5pbS5nZXRBbmltYXRpb25TdGF0ZSgncG9wX2Rpc21pc3MnKTtcbiAgICAgICAgZGlzbWlzc0FuaW0ub24oJ2ZpbmlzaGVkJyx0aGlzLmRpc21pc3NDb21wbGV0ZSx0aGlzKTtcbiAgICAgICAgYW5pbS5wbGF5KCdwb3BfZGlzbWlzcycpO1xuICAgIH0sXG5cbiAgICAvKiMjIyMj6ZqQ6JeP57uT5p6c6aG16Z2iKi9cbiAgICBkaXNtaXNzQWN0aW9uUmVzdWx0OmZ1bmN0aW9uKCkge1xuICAgICAgbGV0IHdpbGxEaXNtaXNzQ2FsbGJhY2sgPSB0aGlzLl93aWxsRGlzbWlzc0NhbGxiYWNrO1xuICAgICAgaWYgKHdpbGxEaXNtaXNzQ2FsbGJhY2spIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHdpbGxEaXNtaXNzQ2FsbGJhY2soKTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgIHRoaXMuZGlzbWlzc0NvbXBsZXRlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBvcE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgIHZhciBkaXNtaXNzQW5pbSA9IGFuaW0uZ2V0QW5pbWF0aW9uU3RhdGUoJ3BvcF9kaXNtaXNzJyk7XG4gICAgICAgIGRpc21pc3NBbmltLm9uKCdmaW5pc2hlZCcsdGhpcy5kaXNtaXNzQ29tcGxldGUsdGhpcyk7XG4gICAgICAgIGFuaW0ucGxheSgncG9wX2Rpc21pc3MnKTtcbiAgICAgICAgY2MuZmluZChcIkNhbnZhcy9zaG93X3Jlc3VsdFwiKS5hY3RpdmUgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBkaXNtaXNzQ29tcGxldGU6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICBpZiAodGhpcy5vbkRpc21pc3NDb21wbGV0ZSkge1xuICAgICAgICAgIHRoaXMub25EaXNtaXNzQ29tcGxldGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9kaXNtaXNzQ2FsbGJhY2spIHtcbiAgICAgICAgICB0aGlzLl9kaXNtaXNzQ2FsbGJhY2sodGhpcy5ub2RlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgZGlzbWlzc1BsYXk6ZnVuY3Rpb24oKSB7XG4gICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJoYWxsXCIpOyAgXG4gICAgfSxcblxuICAgIG9uRGlzbWlzc0NvbXBsZXRlOmZ1bmN0aW9uKCkge1xuICAgICAgLy9jYy5sb2coXCJvbkRpc21pc3NDb21wbGV0ZVwiKTtcbiAgICB9LFxuXG4gICAgZG9uZUFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIHRoaXMub25Eb25lQWN0aW9uKCk7XG5cbiAgICAgICAgbGV0IGNvbmZpcm1DYWxsYmFjayA9IHRoaXMuX2NvbmZpcm1DYWxsYmFjaztcbiAgICAgICAgaWYgKGNvbmZpcm1DYWxsYmFjaykge1xuICAgICAgICAgIGNvbmZpcm1DYWxsYmFjayh0aGlzLm5vZGUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uRG9uZUFjdGlvbjpmdW5jdGlvbigpIHtcblxuICAgIH0sXG5cbiAgICBzZXRNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgICB0aGlzLmxhYmVsLnN0cmluZyA9IG1zZztcbiAgICB9LFxuXG4gICAgZ2V0TWVzc2FnZTogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubGFiZWwuc3RyaW5nO1xuICAgIH0sXG5cbiAgICBzZXRBbGVydENhbGxiY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgdGhpcy5fYWxlcnRDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH0sXG5cbiAgICBzZXRXaWxsRGlzbWlzc0NhbGxiYWNrOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX3dpbGxEaXNtaXNzQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9LFxuXG4gICAgc2V0RGlzbWlzc0NhbGxiYWNrOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX2Rpc21pc3NDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH0sXG5cbiAgICBzZXRDb25maXJtQ2FsbGJhY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgdGhpcy5fY29uZmlybUNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfSxcblxuICAgIC8qc2V0TWVzc2FnZTogZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgIHRoaXMubGFiZWwuZ2V0Q29tcG9uZW50KCdjYy5MYWJlbCcpLnN0cmluZyA9IG1lc3NhZ2U7XG4gICAgfSwqL1xuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiLyoqXHJcbiAqICDmiL/pl7TnibnmrorniYzliqjnlLtcclxuICpcclxuICpcclxuICpcclxuICogXHJcbiAqL1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGZhcGFpTm9kZTogY2MuUHJlZmFiLCAgLy9cclxuICAgICAgICBsaXVkdWliYW46Y2MuUHJlZmFiLFxyXG4gICAgICAgIHNhbnRvbmdodWE6Y2MuUHJlZmFiLFxyXG4gICAgICAgIHNhbnNodW56aTpjYy5QcmVmYWIsXHJcbiAgICAgICAgcXVhbmxlaWRhOmNjLlByZWZhYixcclxuICAgICAgICBxaW5nbG9uZzpjYy5QcmVmYWIsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuICAgIGZhcGFpQW5pbWF0aW9uOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGZhcGFpID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKCdmYXBhaScpO1xyXG4gICAgICAgIGZhcGFpID0gY2MucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgIHZhciBmYXBhaUFuaW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmZhcGFpTm9kZSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKGZhcGFpQW5pbSk7XHJcblxyXG4gICAgICAgIHZhciBMZ3VuID0gZmFwYWlBbmltLmdldENoaWxkQnlOYW1lKFwibGVmdF9nYW5nXCIpOyAgIC8vIOW3pui+ueeahOaKolxyXG4gICAgICAgIHZhciBSZ3VuID0gIGZhcGFpQW5pbS5nZXRDaGlsZEJ5TmFtZShcInJpZ2h0X2dhbmdcIik7IC8vIOWPs+i+ueeahOaKolxyXG4gICAgICAgIHZhciBtYXNrID0gZmFwYWlBbmltLmdldENoaWxkQnlOYW1lKFwibWFza1wiKTtcclxuICAgICAgICAvKiAtLS0tLS0tLS0tLXN0YXJ05Y+K5a2Q6IqC54K5LS0tLS0tLS0tLS0gKi9cclxuICAgICAgICB2YXIgc3RhcnQgPSBmYXBhaUFuaW0uZ2V0Q2hpbGRCeU5hbWUoXCJzdGFydFwiKSxcclxuICAgICAgICAgICAgcXVhbiA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwicXVhblwiKSxcclxuICAgICAgICAgICAgYmFvZGlhbiA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwiYmFvZGlhblwiKSxcclxuICAgICAgICAgICAgZGl0YW4gPSBzdGFydC5nZXRDaGlsZEJ5TmFtZShcImRpdGFuXCIpLFxyXG4gICAgICAgICAgICBiZWdpbkljbyA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwiYmVnaW5faWNvblwiKSxcclxuICAgICAgICAgICAgdGl0bGUgPSBzdGFydC5nZXRDaGlsZEJ5TmFtZShcInRpdGxlXCIpLFxyXG4gICAgICAgICAgICByV2luZyA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwicldpbmdcIiksXHJcbiAgICAgICAgICAgIGxXaW5nID0gc3RhcnQuZ2V0Q2hpbGRCeU5hbWUoXCJsV2luZ1wiKTtcclxuICAgICAgICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgZmFwYWlBbmltLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgbWFzay5ydW5BY3Rpb24oIGNjLnNjYWxlVG8oMC4yLDEwLDEwKSApO1xyXG4gICAgICAgIExndW4ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShzZWxmLkxndW5BY3Rpb24oKSkgKTtcclxuICAgICAgICBSZ3VuLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2Uoc2VsZi5SZ3VuQWN0aW9uKCkpICk7XHJcblxyXG4gICAgICAgIHZhciBzdGFydEZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgcldpbmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgbFdpbmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgbFdpbmcucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZSggY2MucmVwZWF0KCBjYy5zZXF1ZW5jZSggY2Muc2tld1RvKDAuMDUsMjAsLTEwKSxjYy5za2V3VG8oMC4wNSwwLDApICksMyksY2MuZmFkZU91dCgwKSkgKTtcclxuICAgICAgICAgICAgcldpbmcucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZSggY2MucmVwZWF0KCBjYy5zZXF1ZW5jZSggY2Muc2tld1RvKDAuMDUsMjAsLTEwKSxjYy5za2V3VG8oMC4wNSwwLDApICksMyksY2MuZmFkZU91dCgwKSkgKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgd2luZ0ZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgc3RhcnQucnVuQWN0aW9uKGNjLnNjYWxlVG8oMC4yLDAsMCkpO1xyXG4gICAgICAgICAgICB9LDUwMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzdGFydC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBzdGFydC5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4yLDEuNSwxLjUpLGNjLnNjYWxlVG8oMC4yLDEsMSksc3RhcnRGaW5pc2hlZCx3aW5nRmluaXNoZWQpICk7XHJcbiAgICAgICAgICAgIHF1YW4ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zY2FsZVRvKDAuMiwxMCwxMCksY2MuZmFkZU91dCgwKSkpO1xyXG4gICAgICAgICAgICBiYW9kaWFuLnJ1bkFjdGlvbiggIGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4yLDEuNSwxLjUpLGNjLmZhZGVPdXQoMCkpICk7XHJcbiAgICAgICAgfSw0MDApO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgbFdpbmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJXaW5nLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzdGFydC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgZmFwYWlBbmltLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmYXBhaUFuaW0ucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcclxuICAgICAgICB9LDIwMDApXHJcblxyXG4gICAgfSxcclxuICAgIExndW5BY3Rpb246ZnVuY3Rpb24oKXsgLy8g5bem6L6555qE5p6qXHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgY2Muc3Bhd24oW1xyXG4gICAgICAgICAgICAgICAgY2MubW92ZVRvKCAwLjIsIGNjLnYyKC00MzAsIDE1MikgKSxcclxuICAgICAgICAgICAgICAgIGNjLnNjYWxlVG8oMC4yLDIsMilcclxuICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgIGNjLnNwYXduKFtcclxuICAgICAgICAgICAgICAgIGNjLmZhZGVUbygwLjIsIDI1NSksXHJcbiAgICAgICAgICAgICAgICBjYy5tb3ZlVG8oIDAuMiwgY2MudjIoLTIyMCwgMCkgKSxcclxuICAgICAgICAgICAgICAgIGNjLnJvdGF0ZVRvKDAuMiwzNSlcclxuICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgIGNjLmZhZGVPdXQoMCksXHJcbiAgICAgICAgXTtcclxuICAgIH0sXHJcbiAgICBSZ3VuQWN0aW9uOmZ1bmN0aW9uKCl7IC8vIOWPs+i+ueeahOaeqlxyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIGNjLnNwYXduKFtcclxuICAgICAgICAgICAgICAgIGNjLm1vdmVUbyggMC4yLCBjYy52Mig0MzAsIDE1MikgKSxcclxuICAgICAgICAgICAgICAgIGNjLnNjYWxlVG8oMC4yLC0yLDIpXHJcbiAgICAgICAgICAgIF0pLFxyXG4gICAgICAgICAgICBjYy5zcGF3bihbXHJcbiAgICAgICAgICAgICAgICBjYy5mYWRlVG8oMC4yLCAyNTUpLFxyXG4gICAgICAgICAgICAgICAgY2MubW92ZVRvKCAwLjIsIGNjLnYyKDIyMCwgMCkgKSxcclxuICAgICAgICAgICAgICAgIGNjLnJvdGF0ZVRvKDAuMiwtMzUpXHJcbiAgICAgICAgICAgIF0pLFxyXG4gICAgICAgICAgICBjYy5mYWRlT3V0KDApXHJcbiAgICAgICAgXTtcclxuICAgIH0sXHJcbiAgICBfYmV6aWVyMTpmdW5jdGlvbihpbmRleCl7XHJcbiAgICAgICAgdmFyIGJlemllciA9IFtdO1xyXG4gICAgICAgIGJlemllclswXSA9IFsgW2NjLnYyKDEwMCwgNzQpLGNjLnYyKDE1MCwxNzQpLGNjLnYyKDIwMCwgLTE3NCldLCBjYy52MigxMDAsIDc0KSBdO1xyXG4gICAgICAgIGJlemllclsxXSA9IFsgW2NjLnYyKC03MiwgMjg0KSxjYy52MigtMTIyLDM4NCksY2MudjIoLTIyMiwgLTE1MCldLCBjYy52MigtNzIsIDI4NCkgXTtcclxuICAgICAgICBiZXppZXJbMl0gPSBbIFtjYy52MigtNzAsIDIwMCksY2MudjIoLTEyMCwzMDApLGNjLnYyKC0yMjAsIC0yMDApXSwgY2MudjIoLTcwLCAyMDApIF07XHJcbiAgICAgICAgYmV6aWVyWzNdID0gWyBbY2MudjIoLTEyMywgMjEzKSxjYy52MigtMTczLDMxMyksY2MudjIoLTI3MywgLTE2MCldLCBjYy52MigtMTIzLCAyMTMpIF07XHJcbiAgICAgICAgYmV6aWVyWzRdID0gWyBbY2MudjIoMTEwLCAyMzcpLGNjLnYyKDE2MCwzMzcpLGNjLnYyKDI2MCwgLTE3NyldLCBjYy52MigyMTAsIDIzNykgXTtcclxuICAgICAgICBiZXppZXJbNV0gPSBbIFtjYy52MigxODMsIDExNSksY2MudjIoMjMzLDIxNSksY2MudjIoMzMzLCAtMTU1KV0sIGNjLnYyKDE4MywgMTE1KSBdO1xyXG4gICAgICAgIGJlemllcls2XSA9IFsgW2NjLnYyKDkyLCAxMTYpLGNjLnYyKDE0MiwyMTYpLGNjLnYyKDI0MiwgLTE0NildLCBjYy52Mig5MiwgMTE2KSBdO1xyXG4gICAgICAgIGJlemllcls3XSA9IFsgW2NjLnYyKC0yNiwgMTI0KSxjYy52MigtNzYsMjI0KSxjYy52MigtMTc2LCAtMTY0KV0sIGNjLnYyKC0yNiwgMTI0KSBdO1xyXG4gICAgICAgIGJlemllcls4XSA9IFsgW2NjLnYyKC0xMTAsIDgxKSxjYy52MigtMjIwLDEzMSksY2MudjIoLTQ2MCwgLTE4MCldLCBjYy52MigtMTEwLCA4MSkgXTtcclxuICAgICAgICBiZXppZXJbOV0gPSBbIFtjYy52MigtMTI1LCAzMyksY2MudjIoLTIyNSwxMzMpLGNjLnYyKC0yNzUsIC0xMzMpXSwgY2MudjIoLTEyNSwgMzMpIF07XHJcbiAgICAgICAgYmV6aWVyWzEwXSA9IFsgW2NjLnYyKDAsIDApLGNjLnYyKDUwLDEwMCksY2MudjIoMTUwLCAtMTUwKV0sIGNjLnYyKDAsIDApIF07XHJcbiAgICAgICAgYmV6aWVyWzExXSA9IFsgW2NjLnYyKC0yMzUsIDUpLGNjLnYyKC0yNzUsMTA1KSxjYy52MigtMzc1LCAtMTg2KV0sIGNjLnYyKC0yMzUsIDUpIF07XHJcbiAgICAgICAgYmV6aWVyWzEyXSA9IFsgW2NjLnYyKC04MCwgNCksY2MudjIoLTEzMCwxMDQpLGNjLnYyKC0yMzAsIC0yMzMpXSwgY2MudjIoLTgwLCA0KSBdO1xyXG4gICAgICAgIGJlemllclsxM10gPSBbIFtjYy52MigxMDAsIC03KSxjYy52MigxNTAsMTA3KSxjYy52MigyNTAsIC0xNzcpXSwgY2MudjIoMTAwLCAtNykgXTtcclxuICAgICAgICBiZXppZXJbMTRdID0gWyBbY2MudjIoMTU0LCAyMyksY2MudjIoMjA0LDExMyksY2MudjIoMjU0LCAtMTczKV0sIGNjLnYyKDI1NCwgMjMpIF07XHJcbiAgICAgICAgcmV0dXJuIGJlemllcltpbmRleF07XHJcbiAgICB9LFxyXG4gICAgLy8g6Z2S6b6Z5Yqo55S7XHJcbiAgICBfcWluZ2xvbmdBbmlhbXRpb246ZnVuY3Rpb24odHlwZSl7XHJcbiAgICAgICAgdmFyIHFpbmdsb25nID0gY2MuaW5zdGFudGlhdGUodGhpcy5xaW5nbG9uZyk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHFpbmdsb25nKTtcclxuICAgICAgICB2YXIgYmcgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgnYmcnKTtcclxuICAgICAgICB2YXIgdGl0bGUgPSAnJztcclxuICAgICAgICBpZih0eXBlID09IFwicWxcIil7XHJcbiAgICAgICAgICAgIHRpdGxlID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ3Fsb25ndGl0bGUnKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGl0bGUgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgnbG9uZ3RpdGxlJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgeXVuMSA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCd5dW4xJyk7XHJcbiAgICAgICAgdmFyIHl1bjIgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgneXVuMicpO1xyXG4gICAgICAgIHZhciB5dW4zID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ3l1bjMnKTtcclxuICAgICAgICB2YXIgeXVuNCA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCd5dW40Jyk7XHJcbiAgICAgICAgdmFyIGxvbmcgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZShcImxvbmdcIik7XHJcblxyXG4gICAgICAgIHZhciBodWExID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ2h1YTEnKTtcclxuICAgICAgICB2YXIgaHVhMiA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCdodWEyJyk7XHJcbiAgICAgICAgdmFyIGh1YTMgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgnaHVhMycpO1xyXG4gICAgICAgIHZhciBBID0gW10gLCBCID0gW10gLCBDID0gW107XHJcbiAgICAgICAgdmFyIGh1YSA9IFtdO1xyXG5cclxuICAgICAgICB2YXIgdGVzdCA9IGNjLmluc3RhbnRpYXRlKGh1YTEpO1xyXG5cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgZm9yICh2YXIgaT0wO2k8NTtpKyspe1xyXG4gICAgICAgICAgICBBW2ldID0gY2MuaW5zdGFudGlhdGUoaHVhMSk7XHJcbiAgICAgICAgICAgIEFbaV0ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjEsMjU1KSk7XHJcbiAgICAgICAgICAgIGh1YS5wdXNoKCBBW2ldICk7XHJcbiAgICAgICAgICAgIEJbaV0gPSBjYy5pbnN0YW50aWF0ZShodWEyKTtcclxuICAgICAgICAgICAgQltpXS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMSwyNTUpKTtcclxuICAgICAgICAgICAgaHVhLnB1c2goIEJbaV0gKTtcclxuICAgICAgICAgICAgQ1tpXSA9IGNjLmluc3RhbnRpYXRlKGh1YTMpO1xyXG4gICAgICAgICAgICBDW2ldLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4xLDI1NSkpO1xyXG4gICAgICAgICAgICBodWEucHVzaCggQ1tpXSApO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJnRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2Muc2NhbGVUbygwLjIsMSwxKSxjYy5mYWRlVG8oMC4yLDI1NSkpLGNjLnNjYWxlVG8oMC4yLDIsMiksY2Muc3Bhd24oY2Muc2NhbGVUbygwLjIsMS41LDEuNSksbG9uZ1N0YXJ0KSApICk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGxvbmdTdGFydCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGxvbmcucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwwLjUpKSxjYy5zY2FsZVRvKDAuMSwzLDMpLGNjLnNwYXduKGNjLnNjYWxlVG8oMC4xLDEsMSkseXVuU3RhcnQpICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBmbG93ZXJTdGFydCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIH0pOyBcclxuICAgICAgICB2YXIgeXVuU3RhcnQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB5dW4xLnJ1bkFjdGlvbihjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnJlcGVhdChjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4yLGNjLnYyKC0zMzQsMjM0KSksY2MubW92ZVRvKDAuMixjYy52MigtMzQ0LDIzNCkpKSwzKSApKTtcclxuICAgICAgICAgICAgeXVuMi5ydW5BY3Rpb24oY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMixjYy52MigtMzY4LC04MikpLGNjLm1vdmVUbygwLjIsY2MudjIoLTM1OCwtODIpKSksMykgKSk7XHJcbiAgICAgICAgICAgIHl1bjMucnVuQWN0aW9uKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLm1vdmVUbygwLjIsY2MudjIoNDA4LC00KSksY2MubW92ZVRvKDAuMixjYy52MigzOTgsLTQpKSksMykpKTtcclxuICAgICAgICAgICAgeXVuNC5ydW5BY3Rpb24oY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMixjYy52Mig0MDYsMTgxKSksY2MubW92ZVRvKDAuMixjYy52Mig0MTYsMTgxKSkpLDMpICkpO1xyXG4gICAgICAgICAgICBmb3IodmFyIGk9MTtpPGh1YS5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgIGh1YVtpXS5zZXRQb3NpdGlvbihzZWxmLl9iZXppZXIoaSlbMV0pO1xyXG4gICAgICAgICAgICAgICAgcWluZ2xvbmcuYWRkQ2hpbGQoaHVhW2ldKTtcclxuICAgICAgICAgICAgICAgIGh1YVtpXS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5iZXppZXJUbygwLjMsc2VsZi5fYmV6aWVyKGkpWzBdKSxjYy5zY2FsZVRvKDAuMywxLDEpLGNjLmZhZGVUbygwLjMsMCkgKSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHFpbmdsb25nLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0sMTUwMCk7XHJcbiAgICAgICAgICAgIC8veXVuMVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgYmcucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjQsMjU1KSxjYy5zY2FsZVRvKDAuNCwzMCwzMCkpLGJnRmluaXNoZWQgKSk7XHJcbiAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNjYWxlVG8oMC4yLDIsMikpO1xyXG5cclxuICAgIH0sXHJcbiAgICAvLyDkuInpobrlrZDliqjnlLtcclxuICAgIF9zYW5zaHVuemlBbmltYXRpb246ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgc2Fuc2h1bnppID0gY2MuaW5zdGFudGlhdGUodGhpcy5zYW5zaHVuemkpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChzYW5zaHVuemkpO1xyXG4gICAgICAgIHZhciBiZyA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnYmcnKTtcclxuICAgICAgICB2YXIgTHR1ID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCdMdHUnKTtcclxuICAgICAgICB2YXIgUnR1ID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCdSdHUnKTtcclxuICAgICAgICB2YXIgdGl0bGUgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XHJcbiAgICAgICAgdmFyIHp1c2h1bjEgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ3p1c2h1bjEnKTtcclxuICAgICAgICB2YXIgenVzaHVuMiA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnenVzaHVuMicpO1xyXG4gICAgICAgIHZhciB6dXNodW4zID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCd6dXNodW4zJyk7XHJcbiAgICAgICAgdmFyIHp1c2h1bjQgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ3p1c2h1bjQnKTtcclxuICAgICAgICB2YXIgenVzaHVuNSA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnenVzaHVuNScpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgYmdGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2Muc2NhbGVUbygwLjIsMSwxKSxjYy5mYWRlVG8oMC4yLDI1NSkpLHRpdGxlRmluaXNoZWQgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHRpdGxlRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKCBjYy5zY2FsZVRvKDAuMiwyLjUsMi41KSx0aXRsZVNjYWxlKSk7XHJcbiAgICAgICAgICAgIEx0dS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLmZhZGVUbygwLjIsMjU1KSApKTtcclxuICAgICAgICAgICAgUnR1LnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2MuZmFkZVRvKDAuMiwyNTUpKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHRpdGxlU2NhbGUgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpeyAgICAvLyB0aXRsZeaUvuWkp+WujOaIkOWQjiDnq7nnrIsy5ZKMM+WQjOaXtui/m+ihjFxyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNjYWxlVG8oMC4yLDEuNSwxLjUpICk7XHJcbiAgICAgICAgICAgIHp1c2h1bjIucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDEyLDEyKSksY2Muc2NhbGVUbygwLjIsMTAsMTApLFpTMSApKTtcclxuICAgICAgICAgICAgenVzaHVuMy5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMjIsMjIpKSxjYy5zY2FsZVRvKDAuMiwyMCwyMCksWlM0ICkpO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICB6dXNodW41LnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwxMiwxMikpLGNjLnNjYWxlVG8oMC4yLDEwLDEwKSkgKTtcclxuICAgICAgICAgICAgfSwxMDApXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2Fuc2h1bnppLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgc2Fuc2h1bnppLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0sMjAwMClcclxuXHJcbiAgICAgICAgfSlcclxuICAgICAgICB2YXIgWlMxID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgenVzaHVuMS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMTIsMTIpKSxjYy5zY2FsZVRvKDAuMiwxMCwxMCkpICk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICB2YXIgWlM0ID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgenVzaHVuNC5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMTQsMTQpKSxjYy5zY2FsZVRvKDAuMiwxMiwxMikpICk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICBiZy5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuNCwyNTUpLGNjLnNjYWxlVG8oMC40LDMwLDMwKSksYmdGaW5pc2hlZCApKTtcclxuICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2NhbGVUbygwLjIsMiwyKSk7XHJcblxyXG4gICAgfSxcclxuICAgIC8vIOWFqOWekuaJk1xyXG4gICAgX3F1YW5sZWlkYUFuaW1hdGlvbjpmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBxdWFubGVpZGEgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnF1YW5sZWlkYSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHF1YW5sZWlkYSk7XHJcbiAgICAgICAgdmFyIGJnID0gcXVhbmxlaWRhLmdldENoaWxkQnlOYW1lKCdiZycpO1xyXG4gICAgICAgIHZhciBiYWxsID0gcXVhbmxlaWRhLmdldENoaWxkQnlOYW1lKCdiYWxsJyk7XHJcbiAgICAgICAgdmFyIGJhbmdxaXV0YW8gPSBxdWFubGVpZGEuZ2V0Q2hpbGRCeU5hbWUoJ2JhbmdxaXV0YW8nKTtcclxuICAgICAgICB2YXIgYmFuZ3FpdWd1biA9IHF1YW5sZWlkYS5nZXRDaGlsZEJ5TmFtZSgnYmFuZ3FpdWd1bicpO1xyXG4gICAgICAgIHZhciBMeXVuID0gcXVhbmxlaWRhLmdldENoaWxkQnlOYW1lKCdMeXVuJyk7XHJcbiAgICAgICAgdmFyIFJ5dW4gPSBxdWFubGVpZGEuZ2V0Q2hpbGRCeU5hbWUoJ1J5dW4nKTtcclxuICAgICAgICB2YXIgdGl0bGUgPSBxdWFubGVpZGEuZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XHJcbiAgICAgICAgdmFyIGJnRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLnNjYWxlVG8oMC4yLDEsMSksY2MuZmFkZVRvKDAuMiwyNTUpKSx0aXRsZUZpbmlzaGVkICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aXRsZUZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZSggY2Muc2NhbGVUbygwLjIsMi41LDIuNSksY2Muc2NhbGVUbygwLjIsMS41LDEuNSksXHJcbiAgICAgICAgICAgICAgICBjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMyxjYy52MigwLDIwKSksY2MubW92ZVRvKDAuMyxjYy52MigwLDApKSksMikgKSk7XHJcblxyXG4gICAgICAgICAgICBMeXVuLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDIwLDIwKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0yNzAsNzApKSApLFxyXG4gICAgICAgICAgICAgICAgY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLm1vdmVUbygwLjMsY2MudjIoLTI3MCwyNikpLGNjLm1vdmVUbygwLjMsY2MudjIoLTI3MCw0NikpKSwyKSApKTtcclxuXHJcbiAgICAgICAgICAgIFJ5dW4ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMjAsMjApLGNjLm1vdmVUbygwLjIsY2MudjIoMjcwLDcwKSkgKSxcclxuICAgICAgICAgICAgICAgIGNjLnJlcGVhdChjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4zLGNjLnYyKDI3MCw2NikpLGNjLm1vdmVUbygwLjMsY2MudjIoMjcwLDQ2KSkpLDIpICkpO1xyXG5cclxuICAgICAgICAgICAgYmFuZ3FpdXRhby5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoIGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMywxMCwxMCksY2MubW92ZVRvKDAuMyxjYy52MigyNTAsNTApKSksYnF0RmluaXNoZWQgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGJxdEZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgYmFuZ3FpdXRhby5ydW5BY3Rpb24oY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLnJvdGF0ZVRvKDAuMiwtMTApLGNjLnJvdGF0ZVRvKDAuMiwwKSksMykpO1xyXG4gICAgICAgICAgICBiYWxsLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMSwyNTUpLGNjLm1vdmVUbygwLjIsY2MudjIoMTk2LDgzKSkpLGJhbGxGaW5pc2hlZCApKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgYmFsbEZpbmlzaGVkID0gY2MuIGNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGJhbGwucnVuQWN0aW9uKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMCksY2MubW92ZVRvKDAuMixjYy52MigwLDApKSxjYy5zY2FsZVRvKDAuMiw0LDQpICkpO1xyXG4gICAgICAgICAgICBiYW5ncWl1Z3VuLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoIGNjLnNwYXduKGNjLnNjYWxlVG8oMC4yLDIsMiksY2MuZmFkZVRvKDAuMiwyNTUpKSxjYy5zY2FsZVRvKDAuMywxLjUsMS41KSApKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgYmcucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgYmFsbC5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBiYW5ncWl1dGFvLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIGJhbmdxaXVndW4ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgTHl1bi5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBSeXVuLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuXHJcbiAgICAgICAgICAgICAgICBxdWFubGVpZGEucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcclxuICAgICAgICAgICAgfSwyMDAwKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBiZy5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuNCwyNTUpLGNjLnNjYWxlVG8oMC40LDMwLDMwKSksYmdGaW5pc2hlZCApKTtcclxuICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc2NhbGVUbygwLjIsMiwyKSkpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5LiJ5ZCM6Iqx5Yqo55S7XHJcbiAgICBfc2FudG9uZ2h1YUFuaW1hdGlvbjpmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBzYW50b25naHVhID0gY2MuaW5zdGFudGlhdGUodGhpcy5zYW50b25naHVhKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQoc2FudG9uZ2h1YSk7XHJcbiAgICAgICAgdmFyIGJnID0gc2FudG9uZ2h1YS5nZXRDaGlsZEJ5TmFtZSgnYmcnKTtcclxuICAgICAgICB2YXIgaHVhMSA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ2h1YTEnKTtcclxuICAgICAgICB2YXIgaHVhMiA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ2h1YTInKTtcclxuICAgICAgICB2YXIgaHVhMyA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ2h1YTMnKTtcclxuICAgICAgICB2YXIgUnRhb2h1YSA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ1J0YW9odWEnKTtcclxuICAgICAgICB2YXIgTHRhb2h1YSA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ0x0YW9odWEnKTtcclxuICAgICAgICB2YXIgdGl0bGUgPSBzYW50b25naHVhLmdldENoaWxkQnlOYW1lKCd0aXRsZScpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAvL3ZhciBIMSA9IGNjLmluc3RhbnRpYXRlKGh1YTEpO1xyXG4gICAgICAgIHZhciBBID0gW10gLCBCID0gW10gLCBDID0gW107XHJcbiAgICAgICAgdmFyIGh1YSA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGk9MDtpPDU7aSsrKXtcclxuICAgICAgICAgICAgQVtpXSA9IGNjLmluc3RhbnRpYXRlKGh1YTEpO1xyXG4gICAgICAgICAgICBBW2ldLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4xLDI1NSkpO1xyXG4gICAgICAgICAgICBodWEucHVzaCggQVtpXSApO1xyXG4gICAgICAgICAgICBCW2ldID0gY2MuaW5zdGFudGlhdGUoaHVhMik7XHJcbiAgICAgICAgICAgIEJbaV0ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjEsMjU1KSk7XHJcbiAgICAgICAgICAgIGh1YS5wdXNoKCBCW2ldICk7XHJcbiAgICAgICAgICAgIENbaV0gPSBjYy5pbnN0YW50aWF0ZShodWEzKTtcclxuICAgICAgICAgICAgQ1tpXS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMSwyNTUpKTtcclxuICAgICAgICAgICAgaHVhLnB1c2goIENbaV0gKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBiZ0ZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5zY2FsZVRvKDAuMiwxLDEpLGNjLmZhZGVUbygwLjIsMjU1KSksY2Muc2NhbGVUbygwLjIsMSwxKSx0aXRsZUZpbmlzaGVkICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aXRsZUZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4xLDEuOCwxLjgpICkpO1xyXG4gICAgICAgICAgICBMdGFvaHVhLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMywzKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0xNjAsLTYwKSkgKSApKTtcclxuICAgICAgICAgICAgUnRhb2h1YS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDMsMyksY2MubW92ZVRvKDAuMixjYy52MigxNDAsLTYwKSkgKSApKTtcclxuICAgICAgICAgICAgZm9yKHZhciBpPTE7aTxodWEubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICBodWFbaV0uc2V0UG9zaXRpb24oc2VsZi5fYmV6aWVyKGkpWzFdKTtcclxuICAgICAgICAgICAgICAgIHNhbnRvbmdodWEuYWRkQ2hpbGQoaHVhW2ldKTtcclxuICAgICAgICAgICAgICAgIGh1YVtpXS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5iZXppZXJUbygwLjMsc2VsZi5fYmV6aWVyKGkpWzBdKSxjYy5zY2FsZVRvKDAuMywxLDEpLGNjLmZhZGVUbygwLjMsMCkgKSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGJnLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIFJ0YW9odWEucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgTHRhb2h1YS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBzYW50b25naHVhLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0sMTUwMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYmcucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjMsMjU1KSxjYy5zY2FsZVRvKDAuMywzMCwzMCkpLGJnRmluaXNoZWQgKSk7XHJcbiAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4yLDIsMikpKTtcclxuICAgIH0sXHJcbiAgICAvLyDotJ3loZ7lsJTmm7Lnur8o5Y+q6IO95a6a5LiJ5Liq54K5KVxyXG4gICAgX2JlemllcjpmdW5jdGlvbihpbmRleCl7XHJcbiAgICAgICAgdmFyIGJlemllciA9IFtdO1xyXG4gICAgICAgIGJlemllclswXSA9IFsgW2NjLnYyKDIwMCwgNzQpLGNjLnYyKDI1MCwxMjQpLGNjLnYyKDQwMCwgLTE3NCldLCBjYy52MigyMDAsIDc0KSBdO1xyXG4gICAgICAgIGJlemllclsxXSA9IFsgW2NjLnYyKC03MiwgMjg0KSxjYy52MigtMTIyLDMzNCksY2MudjIoLTI3MiwgLTE1MCldLCBjYy52MigtNzIsIDI4NCkgXTtcclxuICAgICAgICBiZXppZXJbMl0gPSBbIFtjYy52MigtMjcwLCAzMDApLGNjLnYyKC0zMjAsMzUwKSxjYy52MigtNDIwLCAtMjAwKV0sIGNjLnYyKC0yNzAsIDMwMCkgXTtcclxuICAgICAgICBiZXppZXJbM10gPSBbIFtjYy52MigtMjIzLCAyMTMpLGNjLnYyKC0yNzMsMjYzKSxjYy52MigtMzczLCAtMTYwKV0sIGNjLnYyKC0yMjMsIDIxMykgXTtcclxuICAgICAgICBiZXppZXJbNF0gPSBbIFtjYy52MigyMTAsIDIzNyksY2MudjIoMjYwLDI4NyksY2MudjIoMzYwLCAtMTc3KV0sIGNjLnYyKDIxMCwgMjM3KSBdO1xyXG4gICAgICAgIGJlemllcls1XSA9IFsgW2NjLnYyKDE4MywgMTE1KSxjYy52MigyMzMsMTY0KSxjYy52MigzMzMsIC0xNTUpXSwgY2MudjIoMTgzLCAxMTUpIF07XHJcbiAgICAgICAgYmV6aWVyWzZdID0gWyBbY2MudjIoOTIsIDExNiksY2MudjIoMTQyLDE2NiksY2MudjIoMjQyLCAtMTQ2KV0sIGNjLnYyKDkyLCAxMTYpIF07XHJcbiAgICAgICAgYmV6aWVyWzddID0gWyBbY2MudjIoLTI2LCAxMjQpLGNjLnYyKC03NiwxNzQpLGNjLnYyKC0xNzYsIC0xNjQpXSwgY2MudjIoLTI2LCAxMjQpIF07XHJcbiAgICAgICAgYmV6aWVyWzhdID0gWyBbY2MudjIoLTMxMCwgODEpLGNjLnYyKC0zNjAsMTMxKSxjYy52MigtNDYwLCAtMTgwKV0sIGNjLnYyKC0zMTAsIDgxKSBdO1xyXG4gICAgICAgIGJlemllcls5XSA9IFsgW2NjLnYyKC0xMjUsIDMzKSxjYy52MigtMTc1LDgzKSxjYy52MigtMjc1LCAtMTMzKV0sIGNjLnYyKC0xMjUsIDMzKSBdO1xyXG4gICAgICAgIGJlemllclsxMF0gPSBbIFtjYy52MigwLCAwKSxjYy52Mig1MCw1MCksY2MudjIoMTUwLCAtMTUwKV0sIGNjLnYyKDAsIDApIF07XHJcbiAgICAgICAgYmV6aWVyWzExXSA9IFsgW2NjLnYyKC0yMzUsIDUpLGNjLnYyKC0yNzUsNTUpLGNjLnYyKC0zNzUsIC04NildLCBjYy52MigtMjM1LCA1KSBdO1xyXG4gICAgICAgIGJlemllclsxMl0gPSBbIFtjYy52MigtODAsIDQpLGNjLnYyKC0xMzAsNTQpLGNjLnYyKC0yMzAsIC0yMzMpXSwgY2MudjIoLTgwLCA0KSBdO1xyXG4gICAgICAgIGJlemllclsxM10gPSBbIFtjYy52MigxMDAsIC03KSxjYy52MigxNTAsNTcpLGNjLnYyKDI1MCwgLTE3NyldLCBjYy52MigxMDAsIC03KSBdO1xyXG4gICAgICAgIGJlemllclsxNF0gPSBbIFtjYy52MigyNTQsIDIzKSxjYy52MigzMDQsNzMpLGNjLnYyKDQwNCwgLTE3MyldLCBjYy52MigyNTQsIDIzKSBdO1xyXG4gICAgICAgIHJldHVybiBiZXppZXJbaW5kZXhdO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDlha3lr7nljYrliqjnlLtcclxuICAgIF9saXVkdWliYW5BbmltYXRpb246IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGxpdWR1aWJhbiA9IGNjLmluc3RhbnRpYXRlKHRoaXMubGl1ZHVpYmFuKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQobGl1ZHVpYmFuKTtcclxuICAgICAgICB2YXIgYmcgPSBsaXVkdWliYW4uZ2V0Q2hpbGRCeU5hbWUoJ2JnJyk7XHJcbiAgICAgICAgdmFyIExxaSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgnTHFpJyk7XHJcbiAgICAgICAgdmFyIFJxaSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgnUnFpJyk7XHJcbiAgICAgICAgdmFyIENxaSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgnQ3FpJyk7XHJcbiAgICAgICAgdmFyIFJ0YW9odWEgPSBsaXVkdWliYW4uZ2V0Q2hpbGRCeU5hbWUoJ1J0YW9odWEnKTtcclxuICAgICAgICB2YXIgTHRhb2h1YSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgnTHRhb2h1YScpO1xyXG4gICAgICAgIHZhciB0aXRsZSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcclxuXHJcbiAgICAgICAgdmFyIGJnRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLnNjYWxlVG8oMC4yLDEsMSksY2MuZmFkZVRvKDAuMiwyNTUpKSx0aXRsZUZpbmlzaGVkICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aXRsZUZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKCBjYy5zY2FsZVRvKDAuMSwyLjUsMi41KSxjYy5zY2FsZVRvKDAuMSwxLjgsMS44KSxGaW5pc2hlZCApKTtcclxuICAgICAgICAgICAgTHRhb2h1YS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDMsMyksY2MubW92ZVRvKDAuMixjYy52MigtMTYwLC02MCkpICkgKSk7XHJcbiAgICAgICAgICAgIFJ0YW9odWEucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwzLDMpLGNjLm1vdmVUbygwLjIsY2MudjIoMTQwLC02MCkpICkgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIEZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgTHFpLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2MubW92ZVRvKDAuMixjYy52MigtMTAzLDE1OCkpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0xMDMsMTY4KSksY2MubW92ZVRvKDAuMixjYy52MigtMTAzLDE1OCkpICkpO1xyXG4gICAgICAgICAgICBScWkucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDEzMywxNjApKSksY2MubW92ZVRvKDAuMixjYy52MigxMzMsMTcwKSksY2MubW92ZVRvKDAuMixjYy52MigxMzMsMTYwKSkgKSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIENxaS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLm1vdmVUbygwLjIsY2MudjIoMjAsOTYpKSksY2MubW92ZVRvKDAuMixjYy52MigyMCwxMDYpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDIwLDk2KSkgKSk7XHJcbiAgICAgICAgICAgICAgICBMdGFvaHVhLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2MucmVwZWF0KCBjYy5zZXF1ZW5jZShjYy5yb3RhdGVUbygwLjMsMTApLGNjLnJvdGF0ZVRvKDAuMywwKSksMiApLHRoRmluaXNoZWQpKTtcclxuICAgICAgICAgICAgICAgIFJ0YW9odWEucnVuQWN0aW9uKCBjYy5yZXBlYXQoIGNjLnNlcXVlbmNlKGNjLnJvdGF0ZVRvKDAuMywtMTApLGNjLnJvdGF0ZVRvKDAuMywwKSksMiApKTtcclxuICAgICAgICAgICAgfSw1MDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aEZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgYmcucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICBMcWkucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICBScWkucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICBDcWkucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICBSdGFvaHVhLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgTHRhb2h1YS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgbGl1ZHVpYmFuLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYmcucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjQsMjU1KSxjYy5zY2FsZVRvKDAuNCwzMCwzMCkpLGJnRmluaXNoZWQgKSk7XHJcbiAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4yLDIsMikpKTtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuXHJcbiAgICAgICAgY2FyZHMgOiBjYy5MYWJlbCxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnRvdGFsQ2FyZHMoKTtcclxuICAgIH0sXHJcbiAgICB0b3RhbENhcmRzIDpmdW5jdGlvbigpe1xyXG4gICAgICAgIC8vIHZhciBjcmVhdGUgPSB0aGlzLm5vZGUuY2hpbGRyZW47XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLm5vZGUpO1xyXG4gICAgICAgIHZhciByZW5zaHUgPSAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicmVuc2h1XCIpO1xyXG4gICAgICAgIHZhciBqdXNodSA9ICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJqdXNodVwiKTtcclxuICAgICAgICB2YXIgZ2V0Q2FyZCA9ICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjYXJkc1wiKTtcclxuICAgICAgICAvL3ZhciByZW5zaHUgPSBjcmVhdGVbM10sIGp1c2h1ID0gY3JlYXRlWzRdLCBnZXRDYXJkID0gY3JlYXRlWzZdO1xyXG5cclxuICAgICAgICB2YXIgcnMgPSByZW5zaHUuZ2V0Q29tcG9uZW50KFwic2luZ2xlU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XHJcbiAgICAgICAgdmFyIGpzID0ganVzaHUuZ2V0Q29tcG9uZW50KFwic2luZ2xlU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XHJcbiAgICAgICAgdmFyIGdjID0gZ2V0Q2FyZC5nZXRDb21wb25lbnQoXCJzaW5nbGVTZWxlY3RcIikuc2VsZWN0ZWRJbmRleDtcclxuXHJcbiAgICAgICAgdmFyIFIgPSAxLCBKID0gMSwgRyA9IDE7XHJcbiAgICAgICAgc3dpdGNoKHJzKXtcclxuICAgICAgICAgICAgY2FzZSAwOiBSID0gMTticmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiBSID0gMjticmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOiBSID0gMzticmVhaztcclxuICAgICAgICAgICAgY2FzZSAzOiBSID0gNDticmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgc3dpdGNoKGpzKXtcclxuICAgICAgICAgICAgY2FzZSAwOiBKID0gMTticmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiBKID0gMjticmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOiBKID0gMzticmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgc3dpdGNoKGdjKXtcclxuICAgICAgICAgICAgY2FzZSAwOiBHID0gMTticmVhazsgLy8gQUHliLZcclxuICAgICAgICAgICAgZGVmYXVsdDpHID0gMDticmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYXJkcy5zdHJpbmcgPSBSK0o7XHJcbiAgICAgICAgLy90aGlzLmNhcmRzLnN0cmluZyA9IEcgPyAoUitKKTooUitKKSooUiszKTsgIC8vIChSK0op6KGo56S65q+P5Liq5Lq66KaB5Ye655qE5oi/5Y2h6YeP77ybKFIrMynooajnpLrkuIDlhbHmnInlpJrlsJHkurrvvIwgICAgXHJcbiAgICB9XHJcbn0pO1xyXG4iLCIvLyDniYzog4zlvbHliJfooaggY29tcG9uZW50XG4vLyDlj6/ku6XmmL7npLrjgIHpmpDol4/niYzog4zlvbHliJfooahcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGNhcmRzQmFja0xheW91dDogY2MuTGF5b3V0LFxuICAgICAgICBjYXJkc0JhY2tMaXN0OiBbY2MuU3ByaXRlXSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgLy8g5Lul5Yqo55S755qE5pa55byP5pi+56S654mM6IOM5b2xXG4gICAgc2hvd1BsYXlDYXJkQmFja3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuaGlkZUNhcmRCYWNrcygpO1xuICAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICBsZXQgaW50ZXJ2YWwgPSAwLjA1O1xuICAgICAgdmFyIHN0YXJ0VGltZSA9IDA7XG4gICAgICB0aGlzLmNhcmRzQmFja0xpc3QuZm9yRWFjaChmdW5jdGlvbihjYXJkQmFjayl7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNhcmRCYWNrLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfSwgc3RhcnRUaW1lKTtcbiAgICAgICAgc3RhcnRUaW1lID0gc3RhcnRUaW1lICsgaW50ZXJ2YWw7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICAvLyDpmpDol4/mmL7npLrniYzog4zlvbFcbiAgICBoaWRlQ2FyZEJhY2tzOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5jYXJkc0JhY2tMaXN0LmZvckVhY2goZnVuY3Rpb24oY2FyZEJhY2spe1xuICAgICAgICBjYXJkQmFjay5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgLyrniYzoirHoibIqL1xuICAgICAgICBzcGFkZXNJbWFnZXM6W2NjLlNwcml0ZUZyYW1lXSxcbiAgICAgICAgaGVhcnRzSW1hZ2VzOltjYy5TcHJpdGVGcmFtZV0sXG4gICAgICAgIGNsdWJJbWFnZXM6W2NjLlNwcml0ZUZyYW1lXSxcbiAgICAgICAgZGlhbW9uZEltYWdlczpbY2MuU3ByaXRlRnJhbWVdLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBsYWJlbE1zZzpjYy5MYWJlbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2V0VGV4dDpmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgIHRoaXMubGFiZWxNc2cuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0ZXh0O1xuICAgIH0sXG5cbiAgICBjbGlja0FjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0ZXh0ID0gdGhpcy5sYWJlbE1zZy5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZztcbiAgICAgICAgdGhpcy5vblNlbGVjdEFjdGlvbih0ZXh0KTtcbiAgICB9LFxuXG4gICAgb25TZWxlY3RBY3Rpb246ZnVuY3Rpb24obXNnKSB7XG5cbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgcGhvbmVFZGl0Qm94OmNjLkVkaXRCb3gsXHJcbiAgICAgICAgd3hFZGl0Qm94OmNjLkVkaXRCb3gsXHJcbiAgICAgICAgYWxlcnQ6Y2MuUHJlZmFiLFxyXG4gICAgICAgIGNhbnZhczpjYy5Ob2RlLFxyXG4gICAgICAgIF91c2VySWQ6bnVsbCxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJTb2NrZXRFdmVudCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAgX3JlZ2lzdGVyU29ja2V0RXZlbnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlT25DaGFuZ2VJbmZvLCB0aGlzLl9SZWNlaXZlQ2hhbmdlSW5mbywgdGhpcyk7XHJcbiAgICB9LFxyXG4gICAgX1JlY2VpdmVDaGFuZ2VJbmZvIDpmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgdmFyIGNoYW5nZWRSb3dzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICB2YXIgbXNnID0gJyc7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjaGFuZ2VkUm93cyk7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0zOFwiKTtcclxuICAgICAgICBpZihjaGFuZ2VkUm93cyl7XHJcbiAgICAgICAgICAgIG1zZyA9IFwi5pu05pS55oiQ5YqfXCI7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIG1zZyA9IFwi5LuK5aSp5bey57uP5pu05paw6L+H5LqG77yM6K+35piO5aSp5YaN5pu05pawXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgIH0sXHJcbiAgICBjbGlja0FjdGlvbiA6ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgd3ggPSB0aGlzLnd4RWRpdEJveC5zdHJpbmc7XHJcbiAgICAgICAgdmFyIHBob25lID0gdGhpcy5waG9uZUVkaXRCb3guc3RyaW5nO1xyXG4gICAgICAgIHZhciBpbmZvID0ge307XHJcbiAgICAgICAgdmFyIG1zZyA9ICcnO1xyXG4gICAgICAgIGlmKCF3eCAmJiAhcGhvbmUpe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuivt+Whq+WGmeW+ruS/oeWPt+WSjOaJi+acuuWPt1wiO1xyXG4gICAgICAgICAgICBwaG9uZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiggISgvKF5bMS05XVxcZCokKS8udGVzdChwaG9uZSkpICl7XHJcbiAgICAgICAgICAgIG1zZyA9IFwi5oKo6L6T5YWl55qE5omL5py65Y+356CB5qC85byP5LiN5a+577yM6K+36YeN5paw6L6T5YWlXCI7XHJcbiAgICAgICAgICAgIHBob25lID0gXCJcIjtcclxuICAgICAgICAgICAgdGhpcy5hbGVydE1zZyhtc2cpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCBwaG9uZS5sZW5ndGggIT0xMSApe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuaCqOi+k+WFpeeahOaJi+acuuWPt+eggeS4jeWknzEx5L2N77yM6K+36YeN5paw6L6T5YWlXCI7XHJcbiAgICAgICAgICAgIHBob25lID0gXCJcIjtcclxuICAgICAgICAgICAgdGhpcy5hbGVydE1zZyhtc2cpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCEoLyheWzEtOWEtekEtWl1cXGQqJCkvLnRlc3Qod3gpKSApe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuaCqOi+k+WFpeeahOW+ruS/oeWPt+agvOW8j+S4jeWvue+8jOivt+mHjeaWsOi+k+WFpVwiO1xyXG4gICAgICAgICAgICB3eCA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiggd3gubGVuZ3RoPDYgfHwgd3gubGVuZ3RoPjIwICl7XHJcbiAgICAgICAgICAgIG1zZyA9IFwi5oKo6L6T5YWl55qE5b6u5L+h5Y+35qC85byP6LaF5Ye66IyD5Zu077yM6K+36L6T5YWlNn4yMOS9jeeahOW+ruS/oeWPt1wiO1xyXG4gICAgICAgICAgICB3eCA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpbmZvLnd4ID0gd3g7XHJcbiAgICAgICAgaW5mby5waG9uZSA9IHBob25lO1xyXG4gICAgICAgIFNvY2tldC5zZW5kQ2hhbmdlSW5mbyh0aGlzLl91c2VySWQsaW5mbyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGFsZXJ0TXNnOiBmdW5jdGlvbihtc2cpe1xyXG4gICAgICAgIHZhciBhbGVydCA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYWxlcnQpO1xyXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZENoaWxkKGFsZXJ0KTtcclxuICAgICAgICBsZXQgY29tcCA9IGFsZXJ0LmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgIH0sXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIFxyXG4gICAgICAgIG1QdGl0bGU6Y2MuTGFiZWwsXHJcbiAgICAgICAgX2NhcmRzOltdLFxyXG4gICAgICAgIHJlbnNodVNlbGVjdDpjYy5Ob2RlLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBocyA9IDM7XHJcbiAgICAgICAgdmFyIGRzID0gNTtcclxuICAgICAgICBpZihjYy5zZXQpe1xyXG4gICAgICAgICAgICBocyA9IGNjLnNldC5zZXR0aW5nN1swXTtcclxuICAgICAgICAgICAgZHMgPSBjYy5zZXQuc2V0dGluZzdbMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2NhcmRzID0gW2hzLGRzXTtcclxuICAgICAgICAgdGhpcy5tcChocyxkcyk7XHJcbiAgICB9LFxyXG4gICAgY2hhbmdlOiBmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gdGhpcy5yZW5zaHVTZWxlY3QuZ2V0Q29tcG9uZW50KCdzaW5nbGVTZWxlY3QnKS5zZWxlY3RlZEluZGV4O1xyXG4gICAgICAgIHZhciBocyA9IE1hdGguY2VpbCggKE1hdGgucmFuZG9tKCkqNDApLzEwICk7ICAgIC8v6I635Y+W5LiA5LiqMX4055qE5pWw5a2X77yM5Luj6KGo6Iqx6ImyXHJcbiAgICAgICAgdmFyIGRzID0gTWF0aC5jZWlsKCAoTWF0aC5yYW5kb20oKSoxMzApLzEwICk7ICAgLy/ojrflj5bkuIDkuKoxfjEz55qE5pWw5a2X77yM5Luj6KGo54K55pWwXHJcbiAgICAgICAgdmFyIGNhcmQgPSBbaHMsZHNdO1xyXG4gICAgICAgIHRoaXMuX2NhcmRzID0gY2FyZDtcclxuICAgICAgICB0aGlzLm1wKGhzLGRzLHNlbGVjdGVkSW5kZXgpXHJcbiAgICB9LFxyXG4gICAgbXA6IGZ1bmN0aW9uKGgsZCxpbmRleCl7XHJcbiAgICAgICAgdmFyIG1hID0gXCLljZXnoIFcIjtcclxuICAgICAgICB2YXIgaHMgPSBbIFwi5pa55Z2XXCIsXCLmooXoirFcIixcIue6ouahg1wiLFwi6buR5qGDXCJdO1xyXG4gICAgICAgIHZhciBkcyA9IFsgXCIxXCIsXCIyXCIsXCIzXCIsXCI0XCIsXCI1XCIsXCI2XCIsXCI3XCIsXCI4XCIsXCI5XCIsXCIxMFwiLFwiSlwiLFwiUVwiLFwiS1wiIF07XHJcbiAgICAgICAgaWYoaW5kZXgpeyAgXHJcbiAgICAgICAgICAgIHZhciBkZWZhdWx0TWEgPSA0O1xyXG4gICAgICAgICAgICBpZihoID49IChkZWZhdWx0TWEtaW5kZXgrMSkgKXtcclxuICAgICAgICAgICAgICAgIG1hID0gXCLlj4znoIFcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm1QdGl0bGUuc3RyaW5nID0gaHNbaC0xXStkc1tkLTFdK21hO1xyXG4gICB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBzZWxlY3RlZEluZGV4IDogMCxcclxuICAgICAgICBzZWxlY3RlZE5vZGUgOiBjYy5Ob2RlICBcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAwO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgY2xpY2tBY3Rpb246ZnVuY3Rpb24oZSxkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9ICF0aGlzLnNlbGVjdGVkO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRoaXMuc2VsZWN0ZWQ7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gdGhpcy5zZWxlY3RlZD8wOm51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsInZhciBzb2NrZXQgPSByZXF1aXJlKFwic29ja2V0XCIpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIG9wdGlvbjp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6W10sXHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgY2xpY2tCdG5jaG91amlhbmc6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLm9wdGlvbi5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgdGhpcy5vcHRpb25baV0ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLl90aXNoaSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImNob3VqaWFuZ19iZ1wiKS5nZXRDaGlsZEJ5TmFtZShcInRpc2hpXCIpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRfbnVtID0gY2MuZmluZChcIkNhbnZhcy91c2VyL3Nob3BfYmcvY2FyZF9udW1cIik7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLl9jYXJkX251bS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgaWYoaW5kZXggPT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXhdLm9wYWNpdHkgPSAxMjg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25bdGhpcy5vcHRpb24ubGVuZ3RoLTFdLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZihpbmRleCA9PSAxKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleF0ub3BhY2l0eSA9IDEyODtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleCAtIDFdLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleF0ub3BhY2l0eSA9IDEyODtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleC0xXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaW5kZXggKys7XHJcbiAgICAgICAgICAgICAgICBpZihpbmRleCA9PSB0aGlzLm9wdGlvbi5sZW5ndGgpe1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICBpZihjb21wLnN0cmluZyA8IDIwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Rpc2hpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIC8vY2hvdWppYW5nXHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5jYWxsYmFjaywwLjA1KTtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuY2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLm9wdGlvbi5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpXS5vcGFjaXR5ID0gMTI4O1xyXG4gICAgICAgICAgICB9LDMsMCwxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyoqKlxyXG4gICAgY2xpY2tCdG5Db21maXJtOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3Rpc2hpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8vKioqKlxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgIFxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuICAgIGxvYWRDYXJkU3ByaXRlRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKGNhcmROYW1lLCBjYWxsYmFjayk7XHJcbiAgICB9LFxyXG4gICAgX2NhcmRGdWxsTmFtZTogZnVuY3Rpb24gKGNhcmRTaG9ydE5hbWUpIHtcclxuICAgICAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xyXG4gICAgICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChcInB1YmxpYy1waWMtY2FyZC1wb2tlclwiKSkge1xyXG4gICAgICAgICAgY2FyZE5hbWUgPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2FyZE5hbWU7XHJcbiAgICB9LFxyXG4gICAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICBjYy5hc3NlcnQoY2FsbGJhY2spO1xyXG4gICAgICAgIGNjLmxvYWRlci5sb2FkUmVzKFwicGxheS9oYWxsL3B1YmxpYy9hbGxfZWZmZWN0X3R0d19tYWluXCIsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xyXG4gICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCBlcnIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUpO1xyXG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShjYXJkTmFtZSk7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGZyYW1lKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICB9LFxyXG4gICAgdGVzdDpmdW5jdGlvbigpe1xyXG5cclxuICAgICBcclxuICAgIH0sXHJcbiAgICBcclxufSk7XHJcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG5vZGVzOltjYy5Ob2RlXSxcbiAgICAgICAgLy9zZWxlY3RlZEluZGV4OiAwLFxuICAgICAgICAgX3NlbGVjdGVkOjEsXG4gICAgfSxcblxuICAgIC8qIyMjIyovXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5fc2VsZWN0ID0gdHJ1ZTsgXG4gICAgICAgIHZhciBkYWlrYWkgPSAwO1xuICAgICAgICBpZihjYy5zZXQpe1xuICAgICAgICAgICAgZGFpa2FpID0gY2Muc2V0LnNldHRpbmc5O1xuICAgICAgICAgICAgdGhpcy5fc2VsZWN0ZWQgPSB0aGlzLl9zZWxlY3QgPSBkYWlrYWk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFjdGl2ZSA9IHRoaXMuX3NlbGVjdDtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdGVkID0gdGhpcy5fc2VsZWN0O1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKGFjdGl2ZSk7XG4gICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGVzW2ldLmdldENoaWxkQnlOYW1lKCd0aXRsZScpO1xuICAgICAgICAgICAgaWYoIHNlbGYuX3NlbGVjdCApe1xuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdENvbXAgPSB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICB0Q29tcC5pbmRleCA9IGk7XG4gICAgICAgICAgICB0Q29tcC5jbGlja0FjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQoIHNlbGYuX3NlbGVjdGVkID0gc2VsZi5fc2VsZWN0ID0gIXNlbGYuX3NlbGVjdCApO1xuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInRpdGxlXCIpO1xuICAgICAgICAgICAgICAgIGlmKCBzZWxmLl9zZWxlY3QgKXtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VsZi5vblNlbGVjdENoYW5nZSh0aGlzLmluZGV4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYoIHRoaXMubm9kZS5fbmFtZSA9PSBcIm9yZGVyc1wiICYmIGNjLnNldCl7XG4gICAgICAgICAgICAvL3RoaXMucmVtZW1iZXJfc2V0KG92ZXJUaW1lKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgcmVtZW1iZXJfc2V0OmZ1bmN0aW9uKG9iail7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKS5zZXRTZWxlY3RlZChvYmopO1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XG4gICAgICAgICAgICBpZiggb2JqICl7XG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gdGhpcy5ub2Rlc1swXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcbiAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvblNlbGVjdENoYW5nZTogZnVuY3Rpb24gKHNlbGVjdEluZGV4KSB7XG4gICAgICAgIC8vY2MubG9nKHNlbGVjdEluZGV4KTtcbiAgICB9LFxuICAgIFxufSk7XG4iLCIoZnVuY3Rpb24gKG1haW4pIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qKlxuICAgKiBQYXJzZSBvciBmb3JtYXQgZGF0ZXNcbiAgICogQGNsYXNzIGZlY2hhXG4gICAqL1xuICB2YXIgZmVjaGEgPSB7fTtcbiAgdmFyIHRva2VuID0gL2R7MSw0fXxNezEsNH18WVkoPzpZWSk/fFN7MSwzfXxEb3xaWnwoW0hoTXNEbV0pXFwxP3xbYUFdfFwiW15cIl0qXCJ8J1teJ10qJy9nO1xuICB2YXIgdHdvRGlnaXRzID0gL1xcZFxcZD8vO1xuICB2YXIgdGhyZWVEaWdpdHMgPSAvXFxkezN9LztcbiAgdmFyIGZvdXJEaWdpdHMgPSAvXFxkezR9LztcbiAgdmFyIHdvcmQgPSAvWzAtOV0qWydhLXpcXHUwMEEwLVxcdTA1RkZcXHUwNzAwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdK3xbXFx1MDYwMC1cXHUwNkZGXFwvXSsoXFxzKj9bXFx1MDYwMC1cXHUwNkZGXSspezEsMn0vaTtcbiAgdmFyIGxpdGVyYWwgPSAvXFxbKFteXSo/KVxcXS9nbTtcbiAgdmFyIG5vb3AgPSBmdW5jdGlvbiAoKSB7XG4gIH07XG5cbiAgZnVuY3Rpb24gc2hvcnRlbihhcnIsIHNMZW4pIHtcbiAgICB2YXIgbmV3QXJyID0gW107XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFyci5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgbmV3QXJyLnB1c2goYXJyW2ldLnN1YnN0cigwLCBzTGVuKSk7XG4gICAgfVxuICAgIHJldHVybiBuZXdBcnI7XG4gIH1cblxuICBmdW5jdGlvbiBtb250aFVwZGF0ZShhcnJOYW1lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCB2LCBpMThuKSB7XG4gICAgICB2YXIgaW5kZXggPSBpMThuW2Fyck5hbWVdLmluZGV4T2Yodi5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHYuc3Vic3RyKDEpLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgaWYgKH5pbmRleCkge1xuICAgICAgICBkLm1vbnRoID0gaW5kZXg7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhZCh2YWwsIGxlbikge1xuICAgIHZhbCA9IFN0cmluZyh2YWwpO1xuICAgIGxlbiA9IGxlbiB8fCAyO1xuICAgIHdoaWxlICh2YWwubGVuZ3RoIDwgbGVuKSB7XG4gICAgICB2YWwgPSAnMCcgKyB2YWw7XG4gICAgfVxuICAgIHJldHVybiB2YWw7XG4gIH1cblxuICB2YXIgZGF5TmFtZXMgPSBbJ1N1bmRheScsICdNb25kYXknLCAnVHVlc2RheScsICdXZWRuZXNkYXknLCAnVGh1cnNkYXknLCAnRnJpZGF5JywgJ1NhdHVyZGF5J107XG4gIHZhciBtb250aE5hbWVzID0gWydKYW51YXJ5JywgJ0ZlYnJ1YXJ5JywgJ01hcmNoJywgJ0FwcmlsJywgJ01heScsICdKdW5lJywgJ0p1bHknLCAnQXVndXN0JywgJ1NlcHRlbWJlcicsICdPY3RvYmVyJywgJ05vdmVtYmVyJywgJ0RlY2VtYmVyJ107XG4gIHZhciBtb250aE5hbWVzU2hvcnQgPSBzaG9ydGVuKG1vbnRoTmFtZXMsIDMpO1xuICB2YXIgZGF5TmFtZXNTaG9ydCA9IHNob3J0ZW4oZGF5TmFtZXMsIDMpO1xuICBmZWNoYS5pMThuID0ge1xuICAgIGRheU5hbWVzU2hvcnQ6IGRheU5hbWVzU2hvcnQsXG4gICAgZGF5TmFtZXM6IGRheU5hbWVzLFxuICAgIG1vbnRoTmFtZXNTaG9ydDogbW9udGhOYW1lc1Nob3J0LFxuICAgIG1vbnRoTmFtZXM6IG1vbnRoTmFtZXMsXG4gICAgYW1QbTogWydhbScsICdwbSddLFxuICAgIERvRm46IGZ1bmN0aW9uIERvRm4oRCkge1xuICAgICAgcmV0dXJuIEQgKyBbJ3RoJywgJ3N0JywgJ25kJywgJ3JkJ11bRCAlIDEwID4gMyA/IDAgOiAoRCAtIEQgJSAxMCAhPT0gMTApICogRCAlIDEwXTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGZvcm1hdEZsYWdzID0ge1xuICAgIEQ6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldERhdGUoKTtcbiAgICB9LFxuICAgIEREOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0RGF0ZSgpKTtcbiAgICB9LFxuICAgIERvOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gaTE4bi5Eb0ZuKGRhdGVPYmouZ2V0RGF0ZSgpKTtcbiAgICB9LFxuICAgIGQ6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldERheSgpO1xuICAgIH0sXG4gICAgZGQ6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXREYXkoKSk7XG4gICAgfSxcbiAgICBkZGQ6IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcbiAgICAgIHJldHVybiBpMThuLmRheU5hbWVzU2hvcnRbZGF0ZU9iai5nZXREYXkoKV07XG4gICAgfSxcbiAgICBkZGRkOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gaTE4bi5kYXlOYW1lc1tkYXRlT2JqLmdldERheSgpXTtcbiAgICB9LFxuICAgIE06IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldE1vbnRoKCkgKyAxO1xuICAgIH0sXG4gICAgTU06IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRNb250aCgpICsgMSk7XG4gICAgfSxcbiAgICBNTU06IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcbiAgICAgIHJldHVybiBpMThuLm1vbnRoTmFtZXNTaG9ydFtkYXRlT2JqLmdldE1vbnRoKCldO1xuICAgIH0sXG4gICAgTU1NTTogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGkxOG4ubW9udGhOYW1lc1tkYXRlT2JqLmdldE1vbnRoKCldO1xuICAgIH0sXG4gICAgWVk6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBTdHJpbmcoZGF0ZU9iai5nZXRGdWxsWWVhcigpKS5zdWJzdHIoMik7XG4gICAgfSxcbiAgICBZWVlZOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRGdWxsWWVhcigpO1xuICAgIH0sXG4gICAgaDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0SG91cnMoKSAlIDEyIHx8IDEyO1xuICAgIH0sXG4gICAgaGg6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRIb3VycygpICUgMTIgfHwgMTIpO1xuICAgIH0sXG4gICAgSDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0SG91cnMoKTtcbiAgICB9LFxuICAgIEhIOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0SG91cnMoKSk7XG4gICAgfSxcbiAgICBtOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRNaW51dGVzKCk7XG4gICAgfSxcbiAgICBtbTogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldE1pbnV0ZXMoKSk7XG4gICAgfSxcbiAgICBzOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRTZWNvbmRzKCk7XG4gICAgfSxcbiAgICBzczogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldFNlY29uZHMoKSk7XG4gICAgfSxcbiAgICBTOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gTWF0aC5yb3VuZChkYXRlT2JqLmdldE1pbGxpc2Vjb25kcygpIC8gMTAwKTtcbiAgICB9LFxuICAgIFNTOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKE1hdGgucm91bmQoZGF0ZU9iai5nZXRNaWxsaXNlY29uZHMoKSAvIDEwKSwgMik7XG4gICAgfSxcbiAgICBTU1M6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRNaWxsaXNlY29uZHMoKSwgMyk7XG4gICAgfSxcbiAgICBhOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRIb3VycygpIDwgMTIgPyBpMThuLmFtUG1bMF0gOiBpMThuLmFtUG1bMV07XG4gICAgfSxcbiAgICBBOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRIb3VycygpIDwgMTIgPyBpMThuLmFtUG1bMF0udG9VcHBlckNhc2UoKSA6IGkxOG4uYW1QbVsxXS50b1VwcGVyQ2FzZSgpO1xuICAgIH0sXG4gICAgWlo6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHZhciBvID0gZGF0ZU9iai5nZXRUaW1lem9uZU9mZnNldCgpO1xuICAgICAgcmV0dXJuIChvID4gMCA/ICctJyA6ICcrJykgKyBwYWQoTWF0aC5mbG9vcihNYXRoLmFicyhvKSAvIDYwKSAqIDEwMCArIE1hdGguYWJzKG8pICUgNjAsIDQpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgcGFyc2VGbGFncyA9IHtcbiAgICBEOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5kYXkgPSB2O1xuICAgIH1dLFxuICAgIERvOiBbbmV3IFJlZ0V4cCh0d29EaWdpdHMuc291cmNlICsgd29yZC5zb3VyY2UpLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5kYXkgPSBwYXJzZUludCh2LCAxMCk7XG4gICAgfV0sXG4gICAgTTogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQubW9udGggPSB2IC0gMTtcbiAgICB9XSxcbiAgICBZWTogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIHZhciBkYSA9IG5ldyBEYXRlKCksIGNlbnQgPSArKCcnICsgZGEuZ2V0RnVsbFllYXIoKSkuc3Vic3RyKDAsIDIpO1xuICAgICAgZC55ZWFyID0gJycgKyAodiA+IDY4ID8gY2VudCAtIDEgOiBjZW50KSArIHY7XG4gICAgfV0sXG4gICAgaDogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQuaG91ciA9IHY7XG4gICAgfV0sXG4gICAgbTogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQubWludXRlID0gdjtcbiAgICB9XSxcbiAgICBzOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5zZWNvbmQgPSB2O1xuICAgIH1dLFxuICAgIFlZWVk6IFtmb3VyRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC55ZWFyID0gdjtcbiAgICB9XSxcbiAgICBTOiBbL1xcZC8sIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLm1pbGxpc2Vjb25kID0gdiAqIDEwMDtcbiAgICB9XSxcbiAgICBTUzogWy9cXGR7Mn0vLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5taWxsaXNlY29uZCA9IHYgKiAxMDtcbiAgICB9XSxcbiAgICBTU1M6IFt0aHJlZURpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQubWlsbGlzZWNvbmQgPSB2O1xuICAgIH1dLFxuICAgIGQ6IFt0d29EaWdpdHMsIG5vb3BdLFxuICAgIGRkZDogW3dvcmQsIG5vb3BdLFxuICAgIE1NTTogW3dvcmQsIG1vbnRoVXBkYXRlKCdtb250aE5hbWVzU2hvcnQnKV0sXG4gICAgTU1NTTogW3dvcmQsIG1vbnRoVXBkYXRlKCdtb250aE5hbWVzJyldLFxuICAgIGE6IFt3b3JkLCBmdW5jdGlvbiAoZCwgdiwgaTE4bikge1xuICAgICAgdmFyIHZhbCA9IHYudG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmICh2YWwgPT09IGkxOG4uYW1QbVswXSkge1xuICAgICAgICBkLmlzUG0gPSBmYWxzZTtcbiAgICAgIH0gZWxzZSBpZiAodmFsID09PSBpMThuLmFtUG1bMV0pIHtcbiAgICAgICAgZC5pc1BtID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XSxcbiAgICBaWjogWy8oW1xcK1xcLV1cXGRcXGQ6P1xcZFxcZHxaKS8sIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBpZiAodiA9PT0gJ1onKSB2ID0gJyswMDowMCc7XG4gICAgICB2YXIgcGFydHMgPSAodiArICcnKS5tYXRjaCgvKFtcXCtcXC1dfFxcZFxcZCkvZ2kpLCBtaW51dGVzO1xuXG4gICAgICBpZiAocGFydHMpIHtcbiAgICAgICAgbWludXRlcyA9ICsocGFydHNbMV0gKiA2MCkgKyBwYXJzZUludChwYXJ0c1syXSwgMTApO1xuICAgICAgICBkLnRpbWV6b25lT2Zmc2V0ID0gcGFydHNbMF0gPT09ICcrJyA/IG1pbnV0ZXMgOiAtbWludXRlcztcbiAgICAgIH1cbiAgICB9XVxuICB9O1xuICBwYXJzZUZsYWdzLmRkID0gcGFyc2VGbGFncy5kO1xuICBwYXJzZUZsYWdzLmRkZGQgPSBwYXJzZUZsYWdzLmRkZDtcbiAgcGFyc2VGbGFncy5ERCA9IHBhcnNlRmxhZ3MuRDtcbiAgcGFyc2VGbGFncy5tbSA9IHBhcnNlRmxhZ3MubTtcbiAgcGFyc2VGbGFncy5oaCA9IHBhcnNlRmxhZ3MuSCA9IHBhcnNlRmxhZ3MuSEggPSBwYXJzZUZsYWdzLmg7XG4gIHBhcnNlRmxhZ3MuTU0gPSBwYXJzZUZsYWdzLk07XG4gIHBhcnNlRmxhZ3Muc3MgPSBwYXJzZUZsYWdzLnM7XG4gIHBhcnNlRmxhZ3MuQSA9IHBhcnNlRmxhZ3MuYTtcblxuXG4gIC8vIFNvbWUgY29tbW9uIGZvcm1hdCBzdHJpbmdzXG4gIGZlY2hhLm1hc2tzID0ge1xuICAgIGRlZmF1bHQ6ICdkZGQgTU1NIEREIFlZWVkgSEg6bW06c3MnLFxuICAgIHNob3J0RGF0ZTogJ00vRC9ZWScsXG4gICAgbWVkaXVtRGF0ZTogJ01NTSBELCBZWVlZJyxcbiAgICBsb25nRGF0ZTogJ01NTU0gRCwgWVlZWScsXG4gICAgZnVsbERhdGU6ICdkZGRkLCBNTU1NIEQsIFlZWVknLFxuICAgIHNob3J0VGltZTogJ0hIOm1tJyxcbiAgICBtZWRpdW1UaW1lOiAnSEg6bW06c3MnLFxuICAgIGxvbmdUaW1lOiAnSEg6bW06c3MuU1NTJ1xuICB9O1xuXG4gIC8qKipcbiAgICogRm9ybWF0IGEgZGF0ZVxuICAgKiBAbWV0aG9kIGZvcm1hdFxuICAgKiBAcGFyYW0ge0RhdGV8bnVtYmVyfSBkYXRlT2JqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtYXNrIEZvcm1hdCBvZiB0aGUgZGF0ZSwgaS5lLiAnbW0tZGQteXknIG9yICdzaG9ydERhdGUnXG4gICAqL1xuICBmZWNoYS5mb3JtYXQgPSBmdW5jdGlvbiAoZGF0ZU9iaiwgbWFzaywgaTE4blNldHRpbmdzKSB7XG4gICAgdmFyIGkxOG4gPSBpMThuU2V0dGluZ3MgfHwgZmVjaGEuaTE4bjtcblxuICAgIGlmICh0eXBlb2YgZGF0ZU9iaiA9PT0gJ251bWJlcicpIHtcbiAgICAgIGRhdGVPYmogPSBuZXcgRGF0ZShkYXRlT2JqKTtcbiAgICB9XG5cbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGRhdGVPYmopICE9PSAnW29iamVjdCBEYXRlXScgfHwgaXNOYU4oZGF0ZU9iai5nZXRUaW1lKCkpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgRGF0ZSBpbiBmZWNoYS5mb3JtYXQnKTtcbiAgICB9XG5cbiAgICBtYXNrID0gZmVjaGEubWFza3NbbWFza10gfHwgbWFzayB8fCBmZWNoYS5tYXNrc1snZGVmYXVsdCddO1xuXG4gICAgdmFyIGxpdGVyYWxzID0gW107XG5cbiAgICAvLyBNYWtlIGxpdGVyYWxzIGluYWN0aXZlIGJ5IHJlcGxhY2luZyB0aGVtIHdpdGggPz9cbiAgICBtYXNrID0gbWFzay5yZXBsYWNlKGxpdGVyYWwsIGZ1bmN0aW9uKCQwLCAkMSkge1xuICAgICAgbGl0ZXJhbHMucHVzaCgkMSk7XG4gICAgICByZXR1cm4gJz8/JztcbiAgICB9KTtcbiAgICAvLyBBcHBseSBmb3JtYXR0aW5nIHJ1bGVzXG4gICAgbWFzayA9IG1hc2sucmVwbGFjZSh0b2tlbiwgZnVuY3Rpb24gKCQwKSB7XG4gICAgICByZXR1cm4gJDAgaW4gZm9ybWF0RmxhZ3MgPyBmb3JtYXRGbGFnc1skMF0oZGF0ZU9iaiwgaTE4bikgOiAkMC5zbGljZSgxLCAkMC5sZW5ndGggLSAxKTtcbiAgICB9KTtcbiAgICAvLyBJbmxpbmUgbGl0ZXJhbCB2YWx1ZXMgYmFjayBpbnRvIHRoZSBmb3JtYXR0ZWQgdmFsdWVcbiAgICByZXR1cm4gbWFzay5yZXBsYWNlKC9cXD9cXD8vZywgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbGl0ZXJhbHMuc2hpZnQoKTtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogUGFyc2UgYSBkYXRlIHN0cmluZyBpbnRvIGFuIG9iamVjdCwgY2hhbmdlcyAtIGludG8gL1xuICAgKiBAbWV0aG9kIHBhcnNlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBkYXRlU3RyIERhdGUgc3RyaW5nXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBmb3JtYXQgRGF0ZSBwYXJzZSBmb3JtYXRcbiAgICogQHJldHVybnMge0RhdGV8Ym9vbGVhbn1cbiAgICovXG4gIGZlY2hhLnBhcnNlID0gZnVuY3Rpb24gKGRhdGVTdHIsIGZvcm1hdCwgaTE4blNldHRpbmdzKSB7XG4gICAgdmFyIGkxOG4gPSBpMThuU2V0dGluZ3MgfHwgZmVjaGEuaTE4bjtcblxuICAgIGlmICh0eXBlb2YgZm9ybWF0ICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGZvcm1hdCBpbiBmZWNoYS5wYXJzZScpO1xuICAgIH1cblxuICAgIGZvcm1hdCA9IGZlY2hhLm1hc2tzW2Zvcm1hdF0gfHwgZm9ybWF0O1xuXG4gICAgLy8gQXZvaWQgcmVndWxhciBleHByZXNzaW9uIGRlbmlhbCBvZiBzZXJ2aWNlLCBmYWlsIGVhcmx5IGZvciByZWFsbHkgbG9uZyBzdHJpbmdzXG4gICAgLy8gaHR0cHM6Ly93d3cub3dhc3Aub3JnL2luZGV4LnBocC9SZWd1bGFyX2V4cHJlc3Npb25fRGVuaWFsX29mX1NlcnZpY2VfLV9SZURvU1xuICAgIGlmIChkYXRlU3RyLmxlbmd0aCA+IDEwMDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgaXNWYWxpZCA9IHRydWU7XG4gICAgdmFyIGRhdGVJbmZvID0ge307XG4gICAgZm9ybWF0LnJlcGxhY2UodG9rZW4sIGZ1bmN0aW9uICgkMCkge1xuICAgICAgaWYgKHBhcnNlRmxhZ3NbJDBdKSB7XG4gICAgICAgIHZhciBpbmZvID0gcGFyc2VGbGFnc1skMF07XG4gICAgICAgIHZhciBpbmRleCA9IGRhdGVTdHIuc2VhcmNoKGluZm9bMF0pO1xuICAgICAgICBpZiAoIX5pbmRleCkge1xuICAgICAgICAgIGlzVmFsaWQgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkYXRlU3RyLnJlcGxhY2UoaW5mb1swXSwgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgaW5mb1sxXShkYXRlSW5mbywgcmVzdWx0LCBpMThuKTtcbiAgICAgICAgICAgIGRhdGVTdHIgPSBkYXRlU3RyLnN1YnN0cihpbmRleCArIHJlc3VsdC5sZW5ndGgpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gcGFyc2VGbGFnc1skMF0gPyAnJyA6ICQwLnNsaWNlKDEsICQwLmxlbmd0aCAtIDEpO1xuICAgIH0pO1xuXG4gICAgaWYgKCFpc1ZhbGlkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICBpZiAoZGF0ZUluZm8uaXNQbSA9PT0gdHJ1ZSAmJiBkYXRlSW5mby5ob3VyICE9IG51bGwgJiYgK2RhdGVJbmZvLmhvdXIgIT09IDEyKSB7XG4gICAgICBkYXRlSW5mby5ob3VyID0gK2RhdGVJbmZvLmhvdXIgKyAxMjtcbiAgICB9IGVsc2UgaWYgKGRhdGVJbmZvLmlzUG0gPT09IGZhbHNlICYmICtkYXRlSW5mby5ob3VyID09PSAxMikge1xuICAgICAgZGF0ZUluZm8uaG91ciA9IDA7XG4gICAgfVxuXG4gICAgdmFyIGRhdGU7XG4gICAgaWYgKGRhdGVJbmZvLnRpbWV6b25lT2Zmc2V0ICE9IG51bGwpIHtcbiAgICAgIGRhdGVJbmZvLm1pbnV0ZSA9ICsoZGF0ZUluZm8ubWludXRlIHx8IDApIC0gK2RhdGVJbmZvLnRpbWV6b25lT2Zmc2V0O1xuICAgICAgZGF0ZSA9IG5ldyBEYXRlKERhdGUuVVRDKGRhdGVJbmZvLnllYXIgfHwgdG9kYXkuZ2V0RnVsbFllYXIoKSwgZGF0ZUluZm8ubW9udGggfHwgMCwgZGF0ZUluZm8uZGF5IHx8IDEsXG4gICAgICAgIGRhdGVJbmZvLmhvdXIgfHwgMCwgZGF0ZUluZm8ubWludXRlIHx8IDAsIGRhdGVJbmZvLnNlY29uZCB8fCAwLCBkYXRlSW5mby5taWxsaXNlY29uZCB8fCAwKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRhdGUgPSBuZXcgRGF0ZShkYXRlSW5mby55ZWFyIHx8IHRvZGF5LmdldEZ1bGxZZWFyKCksIGRhdGVJbmZvLm1vbnRoIHx8IDAsIGRhdGVJbmZvLmRheSB8fCAxLFxuICAgICAgICBkYXRlSW5mby5ob3VyIHx8IDAsIGRhdGVJbmZvLm1pbnV0ZSB8fCAwLCBkYXRlSW5mby5zZWNvbmQgfHwgMCwgZGF0ZUluZm8ubWlsbGlzZWNvbmQgfHwgMCk7XG4gICAgfVxuICAgIHJldHVybiBkYXRlO1xuICB9O1xuXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmVjaGE7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBmZWNoYTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBtYWluLmZlY2hhID0gZmVjaGE7XG4gIH1cbn0pKHRoaXMpO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgbWVzc2FnZU5vZGU6Y2MuTm9kZSxcbiAgICAgICAgcGxheU5vZGU6Y2MuTm9kZSxcblxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBzaG93TWVzc2FnZUFsZXJ0OmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1lc3NhZ2VOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5tZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgY29tcC5wbGF5KCdwb3AnKTtcbiAgICB9LFxuXG4gICAgZGlzbWlzc01lc3NhZ2VBbGVydDpmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgc2VsZi5tZXNzYWdlTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfSwwLjMpO1xuICAgIH0sXG5cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBjcmVhdGVfYW5pbWE6e1xyXG4gICAgICAgICAgICB0eXBlOmNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgICAgICBkZWZhdWx0OltdLFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuIFxyXG4gICAgXHJcbn0pO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuY2MuX1JGcHVzaChtb2R1bGUsICcxZTY3NDFRMlZGR0RMdXBWODhtZzYwWicsICdoYWxsJyk7XHJcbi8vIHNjcmlwdHNcXGhhbGwuanNcclxuXHJcbnZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xyXG52YXIgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbnZhciBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xyXG52YXIgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XHJcbnZhciBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XHJcbnZhciBQbGF5YmFjayA9IHJlcXVpcmUoJ1BsYXliYWNrJyk7XHJcblxyXG52YXIgaGFsbCA9IGNjLkNsYXNzKHtcclxuICAgICdleHRlbmRzJzogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuXHJcbiAgICAgICAgLy9wcm9kdWN0Tm9kZXM6W2NjLk5vZGVdLFxyXG4gICAgICAgIHNob3BBbGVydE5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgY3JlYXRlTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBqb2luTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBnZW5neGluOiBjYy5Ob2RlLFxyXG4gICAgICAgIGFsZXJ0UHJlZmFiOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgdHNTaW5nbGVTZWxlY3Q6IFtjYy5Ob2RlXSwgLy8g5Yib5bu65oi/6Ze05L+h5oGv77yM5Y2V6YCJXHJcbiAgICAgICAgdHNDaGVja1NlY2xlY3Q6IFtjYy5Ob2RlXSwgLy8g5Yib5bu65oi/6Ze05L+h5oGv77yM5aSN6YCJXHJcbiAgICAgICAgc2VsZWN0TW9TaGk6IGNjLk5vZGUsIC8vIOWIm+W7uuaIv+mXtOS/oeaBr++8jOaooeW8j++8iOW6hOWutuaooeW8j+WSjOaXoOeJueauiueJjO+8iVxyXG4gICAgICAgIHNlbGVjdEd1aVBhaTogY2MuTm9kZSwgLy8g5Yib5bu65oi/6Ze05L+h5oGv77yM5qih5byP77yI5bqE5a625qih5byP5ZKM5peg54m55q6K54mM77yJXHJcbiAgICAgICAgb3ZlclRpbWU6IGNjLk5vZGUsIC8vIOi2heaXtuWHuueJjFxyXG4gICAgICAgIGRhaWthaTogY2MuTm9kZSwgLy/ku6PlvIDmiL9cclxuICAgICAgICBteV9yb29tOmNjLk5vZGUsLy/ku6PlvIDnqpflj6NcclxuICAgICAgICB6aG9uZ3R1amlucnU6Y2MuTm9kZSwgLy/kuK3pgJTov5vlhaVcclxuICAgICAgICAvL2xhYmVsTm90aWNlOiBjYy5MYWJlbCwgICAgICAvL8Kg5YWs5ZGKXHJcbiAgICAgICAgbGFiZWxCYW5uZXI6IGNjLkxhYmVsLCAvLyBiYW5uZXIgbGFiZWxcclxuICAgICAgICByZWNvcmROb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIHdhaXRpbmdQcmVmYWI6IGNjLlByZWZhYixcclxuICAgICAgICBzZXR0aW5nOiBjYy5Ob2RlLFxyXG4gICAgICAgIC8v55So5oi35L+h5oGvXHJcbiAgICAgICAgYXZhdGFyTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBuaWNrTmFtZUxhYmVsOiBjYy5MYWJlbCxcclxuICAgICAgICBjYXJkTnVtYmVyTGFiZWw6IGNjLkxhYmVsLFxyXG4gICAgICAgIHVzZXJJZExhYmVsOiBjYy5MYWJlbCxcclxuICAgICAgICBjb2RlTGFiZWw6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vcGhvbmU6Y2MuTGFiZWwsXHJcbiAgICAgICAgLy8gdXNlckluZm9Nc2dOb2RlOmNjLk5vZGUsXHJcbiAgICAgICAgbG9nb3V0Tm9kZTogY2MuTm9kZSxcclxuICAgICAgICAvL+aImOe7qVxyXG4gICAgICAgIHJlY29yZE1zZ05vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgZmVlZGJhY2tFZGl0Qm94OiBjYy5FZGl0Qm94LCAvL+WPjemmiFxyXG4gICAgICAgIGZlZWRiYWNrTm9kZTogY2MuTm9kZSxcclxuICAgICAgICB3eHNoYXJlOiBjYy5Ob2RlLFxyXG4gICAgICAgIF91c2VySWQ6IDAsXHJcbiAgICAgICAgX29wZW5JZDogbnVsbCxcclxuICAgICAgICBfaGVscDogbnVsbCxcclxuICAgICAgICBfY2xvc2U6IG51bGwsXHJcbiAgICAgICAgaW9zVXJsOiBudWxsLFxyXG4gICAgICAgIGFVcmw6IG51bGxcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHN0YXRpY3M6IHtcclxuICAgICAgICBsYXN0SGFsbEluZm86IG51bGwsIC8vIOS4iuS4gOasoeaUtuWIsOeahOWkp+WOheS/oeaBr1xyXG4gICAgICAgIGNhY2hlSW1hZ2VJbmZvOiBudWxsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5rZXlCYWNrTGlzdGVuKCk7XHJcbiAgICAgICAgaWYgKGNjLnN5cy5pc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgaWYgKHdpbmRvdy5zaGFyZVRvVGltZUxpbmUpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvVGltZUxpbmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAod2luZG93LnNoYXJlVG9TZXNzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1Nlc3Npb24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XHJcbiAgICAgICAgdmFyIGJnID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicm9vbV9iZ1wiKTtcclxuICAgICAgICB2YXIgd2luZG93UCA9IGNjLmRpcmVjdG9yLmdldFdpblNpemVJblBpeGVscygpO1xyXG4gICAgICAgIHZhciBzY2FsZVggPSB3aW5kb3dQLndpZHRoIC8gYmcud2lkdGg7XHJcbiAgICAgICAgdmFyIHNjYWxlWSA9IHdpbmRvd1AuaGVpZ2h0IC8gYmcuaGVpZ2h0O1xyXG4gICAgICAgIHZhciBzY2FsZSA9IE1hdGgubWF4KHNjYWxlWCwgc2NhbGVZKTtcclxuICAgICAgICBiZy5zY2FsZVggPSBzY2FsZTtcclxuICAgICAgICBiZy5zY2FsZVkgPSBzY2FsZTtcclxuICAgICAgICB0aGlzLmNsZWFyTG9jYWxTdG9yYWdlKCk7XHJcbiAgICAgICAgY2MuZnJvbSA9IHt9O1xyXG4gICAgICAgIGNjLmZyb20uaXNVc2VNYSA9IHRydWU7XHJcbiAgICAgICAgY2MuZnJvbS5tYSA9IDA7XHJcbiAgICAgICAgY2MuaXNSb29tVmlld1Nob3cgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9idG4gPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5cIik7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9ucyA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ1dHRvbnNcIik7XHJcbiAgICAgICAgdmFyIHZvbHVtZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImJnVm9sdW1lXCIpO1xyXG4gICAgICAgIGlmICh2b2x1bWUgIT0gbnVsbCAmJiBwYXJzZUludCh2b2x1bWUpKSB7XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5TXVzaWMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBiZ1NvdW5kID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdTb3VuZFwiKTtcclxuICAgICAgICBpZiAoYmdTb3VuZCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHZhciBhdWRpb01hbmFnZXIgPSBjYy5maW5kKCdBdWRpb01hbmFnZXInKTtcclxuICAgICAgICAgICAgYXVkaW9NYW5hZ2VyID0gYXVkaW9NYW5hZ2VyLmdldENvbXBvbmVudCgnQXVkaW9NYW5hZ2VyJyk7XHJcbiAgICAgICAgICAgIGF1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKGJnU291bmQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBQbGF5YmFjay5pbnN0YW5jZS5yZW1vdmVQbGF5YmFja0RhdGFzKCk7XHJcblxyXG4gICAgICAgIGhhbGwuY2FjaGVJbWFnZUluZm8gPSBoYWxsLmNhY2hlSW1hZ2VJbmZvIHx8IHt9O1xyXG5cclxuICAgICAgICB0aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XHJcbiAgICAgICAgdGhpcy5fc3RhcnRCYW5uZXJBbmltYXRpb24oKTtcclxuICAgICAgICB0aGlzLl9pbml0Sm9pblJvb20oKTtcclxuXHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuX29wZW5JZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5vcGVuSWQ7XHJcbiAgICAgICAgdGhpcy5faW52aXRlQ29kZSA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pbnZpdGVDb2RlOyAvL+mCgOivt+eggVxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLnNvY2tldCA9IGNjLmZpbmQoJ0dhbWVTb2NrZXQnKS5nZXRDb21wb25lbnQoJ3NvY2tldCcpO1xyXG4gICAgICAgIHRoaXMuc29ja2V0LnJlY2V2aWNlTWVzc2FnZSA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2UpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25TdWNjZXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLmhpZGRlbk5ldHdvcmtNZXNzYWdlKCk7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuQ2hlY2tNZXNzYWdlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNvY2tldC5jb25uZWN0aW9uRGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc2VsZi5zaG93TmV0d29ya01lc3NhZ2UoJ+e9kee7nOmTvuaOpeaWreW8gO+8jOmHjeaWsOi/nuaOpeS4rS4uLicpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zb2NrZXQuY2hlY2tOZXR3b3JrTm93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLnNob3dDaGVja01lc3NhZ2UoJ+ajgOafpee9kee7nOS4rS4uLicpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zb2NrZXQuY2hlY2tOZXR3b3JrRW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLmhpZGRlbkNoZWNrTWVzc2FnZSgpO1xyXG4gICAgICAgICAgICBzZWxmLmhpZGRlbk5ldHdvcmtNZXNzYWdlKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gIC8q6K6+572u55So5oi35L+h5oGvKi9cclxuICAgICAgICB0aGlzLnVwZGF0ZVVzZXJJbmZvKCk7XHJcbiAgICAgICAgLyrliLfmlrDnlKjmiLfkv6Hmga8qL1xyXG4gICAgICAgIFNvY2tldC5zZW5kR2V0VXNlckluZm8odGhpcy5fdXNlcklkLCB0aGlzLl9vcGVuSWQpO1xyXG4gICAgICAgIC8q5a6a5pe25Yi35paw55So5oi35L+h5oGvKi9cclxuICAgICAgICB0aGlzLnNjaGVkdWxlKChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kR2V0VXNlckluZm8odGhpcy5fdXNlcklkLCB0aGlzLl9vcGVuSWQpO1xyXG4gICAgICAgIH0pLmJpbmQodGhpcyksIDEwKTsgLy8xMHPkuIDmrKFcclxuICAgICAgICBTb2NrZXQuc2VuZEdldEhhbGxJbmZvKHRoaXMuc29ja2V0LnVzZXJJbmZvLmlkKTtcclxuICAgICAgICBpZiAoaGFsbC5sYXN0SGFsbEluZm8pIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVCYW5uZXIoaGFsbC5sYXN0SGFsbEluZm8uaW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLm9uU2hhcmVXWFJlc3AgPSBudWxsO1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLnByZWxvYWRTY2VuZSgncGxheScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IucHJlbG9hZFNjZW5lKCdsb2dpbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChjYy5qb2luRGVzayAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmICghY2Muam9pbkRlc2sucmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVhc29uID0gY2Muam9pbkRlc2sucmVhc29uO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UocmVhc29uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYy5qb2luRGVzayA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjYy5xaW5nbGkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZShcIuaCqOiiq+aIv+S4u+ivt+WHuuaIv+mXtFwiKTtcclxuICAgICAgICAgICAgY2MucWluZ2xpID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy92YXIgY3JlYXRBbmltYSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImNyZWF0ZV9yb29tXCIpO1xyXG4gICAgfSxcclxuXHJcbiAgICBrZXlCYWNrTGlzdGVuOiBmdW5jdGlvbiBrZXlCYWNrTGlzdGVuKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgY2Muc3lzdGVtRXZlbnQub24oY2MuU3lzdGVtRXZlbnQuRXZlbnRUeXBlLktFWV9ET1dOLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IGNjLktFWS5iYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiYmFja1RvRGVza1wiLCBcIigpVlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja1d4U2hhcmU6IGZ1bmN0aW9uIGNsaWNrV3hTaGFyZSgpIHtcclxuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNsaWNrV3hTaGFyZVwiKTtcclxuICAgICAgICAgICAgdGhpcy53eHNoYXJlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJjbGlja1d4U2hhcmUgbmF0aXZlXCIpO1xyXG4gICAgICAgICAgICB2YXIgdGl0bGUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3NoYXJlVGl0bGUnKTtcclxuICAgICAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkZXNjJyk7XHJcbiAgICAgICAgICAgIHZhciByZWNvcmRJZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVjb3JkSWQnKTtcclxuICAgICAgICAgICAgdmFyIGlkID0gJyc7XHJcbiAgICAgICAgICAgIGlmIChyZWNvcmRJZCkge1xyXG4gICAgICAgICAgICAgICAgaWQgPSAncmVjb3JkSWQ9JyArIHJlY29yZElkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLCBpZCwgZGVzY3JpcHRpb24sIHRpdGxlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vQW5kcm9pZFxyXG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XHJcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLCBzdHIsIGlkLCBkZXNjcmlwdGlvbiwgdGl0bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvL+WIhuS6q+WIsOaci+WPi+WciFxyXG4gICAgc2hhcmVIYWxsVGltZWxpbmU6IGZ1bmN0aW9uIHNoYXJlSGFsbFRpbWVsaW5lKCkge1xyXG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMud3hzaGFyZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2hhcmVUaXRsZScpO1xyXG4gICAgICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Rlc2MnKTtcclxuICAgICAgICAgICAgdmFyIHJlY29yZElkID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyZWNvcmRJZCcpO1xyXG4gICAgICAgICAgICB2YXIgaWQgPSAnJztcclxuICAgICAgICAgICAgaWYgKHJlY29yZElkKSB7XHJcbiAgICAgICAgICAgICAgICBpZCA9ICdyZWNvcmRJZD0nICsgcmVjb3JkSWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsIGlkLCBkZXNjcmlwdGlvbiwgdGl0bGUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy9BbmRyb2lkXHJcbiAgICAgICAgICAgICAgICB2YXIgc3RyID0gXCIoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVZcIjtcclxuICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsIHN0ciwgaWQsIGRlc2NyaXB0aW9uLCB0aXRsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHNoYXJlQmc6IGZ1bmN0aW9uIHNoYXJlQmcoKSB7XHJcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgdGhpcy53eHNoYXJlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVIYWxsVGltZWxpbmVcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIC8vIGVsc2Ugey8vQW5kcm9pZFxyXG4gICAgICAgICAgICAvLyAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XHJcbiAgICAgICAgICAgIC8vICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCBzdHIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgY2xlYXJMb2NhbFN0b3JhZ2U6IGZ1bmN0aW9uIGNsZWFyTG9jYWxTdG9yYWdlKCkge1xyXG4gICAgICAgIHZhciBzaGFyZVRpdGxlID0gJ+W8gOaIv+eOqVvlpKfkvJfljYHkuInmsLRdJztcclxuICAgICAgICB2YXIgZGVzYyA9ICflvIDlpb3miL/kuobvvIzlsLHnrYnkvaDku6zkuIDotbfmnaVb5aSn5LyX5Y2B5LiJ5rC0XeWVpu+8geaZmuS6huS9jee9ruWwseayoeS6huWTn34nO1xyXG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgncm9vbUlkJyk7XHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzaGFyZVRpdGxlJywgc2hhcmVUaXRsZSk7XHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdkZXNjJywgZGVzYyk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gb25EZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMuc29ja2V0LnJlY2V2aWNlTWVzc2FnZSA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25TdWNjZXNzID0gZnVuY3Rpb24gKCkge307XHJcbiAgICAgICAgdGhpcy5zb2NrZXQuY29ubmVjdGlvbkRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgICAgICB0aGlzLnNvY2tldC5jaGVja05ldHdvcmtOb3cgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgICAgICB0aGlzLnNvY2tldC5jaGVja05ldHdvcmtFbmQgPSBmdW5jdGlvbiAoKSB7fTtcclxuXHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vZmZUYXJnZXQodGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yZWdpc3RlclNvY2tldEV2ZW50OiBmdW5jdGlvbiBfcmVnaXN0ZXJTb2NrZXRFdmVudCgpIHtcclxuICAgICAgICAvL0tRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVHZXREYWlLYWlEZXNrLCB0aGlzLl9nZXREYWlrYWlSb29tU29ja2V0Q2FsbGJhY2ssIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEYWlLYWlEZXNrLCB0aGlzLl9kYWlrYWlSb29tU29ja2V0Q2FsbGJhY2ssIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LkpvaW5EZXNrLCB0aGlzLl9qaWluUm9vbVNvY2tldENhbGxiYWNrLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlRGVza0luZm8sIHRoaXMuX2ppaW5Sb29tU29ja2V0Q2FsbGJhY2ssIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVDcmVhdGVEZXNrLCB0aGlzLl9jcmVhdGVSb29tU29ja2V0Q2FsbGJhY2ssIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVIYWxsSW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZUhhbGxJbmZvLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlR2V0VXNlckluZm8sIHRoaXMuX3NvY2tldFJlY2VpdmVVc2VySW5mbywgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0RGlzY29ubmVjdCwgdGhpcy5fc29ja2V0RGlzY29ubmVjdCwgdGhpcyk7XHJcbiAgICAgICAgLy9LUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlSW52aXRlQ29kZSwgdGhpcy5fc29ja2V0UmVjZWl2ZUludml0ZUNvZGUsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RTdWNjZXNzZWQsIHRoaXMuX3NvY2tldENvbm5lY3RlZCwgdGhpcyk7XHJcbiAgICAgICAgLy9LUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlU2hhcmVQbmcsIHRoaXMuX3NvY2tldFNoYXJlUG5nLCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g6Lez6L2s5Yiw5YWs5LyX5Y+3XHJcbiAgICBndWFuemh1OiBmdW5jdGlvbiBndWFuemh1KCkge1xyXG4gICAgICAgIC8vIHZhciB1cmwgPSBcImh0dHA6Ly93d3cuaG9uZ2dlZmVuZy5jbi9nemgvaW5kZXguaHRtbFwiO1xyXG4gICAgICAgIC8vIGNjLnN5cy5vcGVuVVJMKHVybClcclxuICAgIH0sXHJcbiAgICBfc3RhcnRCYW5uZXJBbmltYXRpb246IGZ1bmN0aW9uIF9zdGFydEJhbm5lckFuaW1hdGlvbigpIHtcclxuICAgICAgICB2YXIgYW5pbSA9IHRoaXMubGFiZWxCYW5uZXIuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgYW5pbS5wbGF5KCdiYW5uZXInKTtcclxuICAgIH0sXHJcbiAgICBkb3duTG9hZDogZnVuY3Rpb24gZG93bkxvYWQoKSB7XHJcbiAgICAgICAgdmFyIHVybCA9ICdodHRwczovL2Zpci5pbS81dG5lJztcclxuICAgICAgICBjYy5zeXMub3BlblVSTCh1cmwpO1xyXG5cclxuICAgICAgICAvL3dpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCJodHRwOi8vd3d3LmJhaWR1LmNvbVwiO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCLvvJ/vvJ/vvJ/vvJ/vvJ/vvJ/vvJ/vvJ9cIik7XHJcbiAgICB9LFxyXG5cclxuICAgIF9pbml0Sm9pblJvb206IGZ1bmN0aW9uIF9pbml0Sm9pblJvb20oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBqb2luUm9vbSA9IHRoaXMuam9pbk5vZGUuZ2V0Q29tcG9uZW50KCdqb2luUm9vbScpO1xyXG5cclxuICAgICAgICBqb2luUm9vbS5jYWxsYmFja0pvaW5Sb29tID0gZnVuY3Rpb24gKG51bWJlcikge1xyXG4gICAgICAgICAgICAvLyBzZWxmLmpvaW5Ob2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgICAgIC8vIHNlbGYuc2hvd1dhaXRpbmdNZXNzYWdlKCfliqDlhaXkuK0uLi4nKTtcclxuICAgICAgICAgICAgLy8gc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBzZWxmLmhpZGRlbldhaXRpbmdNZXNzYWdlKCk7XHJcbiAgICAgICAgICAgIC8vIH0sIDIuMCk7XHJcblxyXG4gICAgICAgICAgICAvKuWKoOWFpeaIv+mXtOivt+axgiovXHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kSm9pbkRlc2sobnVtYmVyLCB1c2VySWQpO1xyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG5cclxuICAgIF9qaWluUm9vbVNvY2tldENhbGxiYWNrOiBmdW5jdGlvbiBfamlpblJvb21Tb2NrZXRDYWxsYmFjayhyZXNwb25zZSkge1xyXG4gICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xyXG5cclxuICAgICAgICBpZiAoY2MuaXNSb29tVmlld1Nob3cpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmhpZGRlbldhaXRpbmdNZXNzYWdlKCk7XHJcblxyXG4gICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYy5mcm9tID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYy5mcm9tID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgam9pblJvb20gPSBfdGhpczIuam9pbk5vZGUuZ2V0Q29tcG9uZW50KCdqb2luUm9vbScpO1xyXG5cclxuICAgICAgICAgICAgICAgIF90aGlzMi5qb2luTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jykuc2V0QWxlcnRDYWxsYmNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBqb2luUm9vbS5jbGlja0NsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNjLmZyb20ubWEgPSByZXNwb25zZS5kYXRhLm1hUGFpO1xyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XHJcbiAgICAgICAgICAgIH0pKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHJlYXNvbkluZm8gPSB0aGlzLl9qb2luUmVhc29uTWFwKHJlc3BvbnNlLmRhdGEucmVhc29uKTtcclxuICAgICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UocmVhc29uSW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfZGFpa2FpUm9vbVNvY2tldENhbGxiYWNrOmZ1bmN0aW9uIF9kYWlrYWlSb29tU29ja2V0Q2FsbGJhY2socmVzcG9uc2Upe1xyXG4gICAgICAgIGlmKHJlc3BvbnNlLnJlc3VsdClcclxuICAgICAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZShKU09OLnN0cmluZ2lmeShyZXNwb25zZS5kYXRhLmRhaWthaSkpO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZShKU09OLnN0cmluZ2lmeShyZXNwb25zZS5kYXRhLmRhaWthaSkpO1xyXG4gICAgfSxcclxuICAgIC8vX2dldERhaWthaVJvb21Tb2NrZXRDYWxsYmFjazpmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAvLyAgICAvL2NvbnNvbGUubG9nKFwiSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YS5kYWlrYWlMaXN0KT09PT09XCIpO1xyXG4gICAgLy8gICAgaWYgKHJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgLy8gICAgICAgIHZhciBkYWlrYWlMaXN0ID0gSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YS5kYWlrYWlMaXN0KTtcclxuICAgIC8vICAgICAgICBjYy5sb2coZGFpa2FpTGlzdCxcIuaOpeWPl+WIsOS7o+W8gOaIv+aVsOaNru+8mi0tLS0tLS0tLS0tLS0tLS0tXCIpO1xyXG4gICAgLy8gICAgfVxyXG4gICAgLy8gICAgaWYocmVzcG9uc2UucmVzdWx0KVxyXG4gICAgLy8gICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZShKU09OLnN0cmluZ2lmeShyZXNwb25zZS5kYXRhLmRhaWthaSkpO1xyXG4gICAgLy8gICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlKEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlLmRhdGEpKTtcclxuICAgIC8vfSxcclxuXHJcbiAgICBfc29ja2V0UmVjZWl2ZUhhbGxJbmZvOiBmdW5jdGlvbiBfc29ja2V0UmVjZWl2ZUhhbGxJbmZvKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYgKGNjLmlzUm9vbVZpZXdTaG93KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgaGFsbC5sYXN0SGFsbEluZm8gPSBkYXRhO1xyXG4gICAgICAgIHZhciBpc0lPUyA9IGRhdGEuaXNJT1M7XHJcbiAgICAgICAgdmFyIGlzQW5kcm9pZCA9IGRhdGEuaXNBO1xyXG4gICAgICAgIHZhciB2SU9TID0gZGF0YS52SU9TO1xyXG4gICAgICAgIHZhciB2QSA9IGRhdGEudkE7XHJcbiAgICAgICAgdGhpcy5pb3NVcmwgPSBkYXRhLmlvc1VybDtcclxuICAgICAgICB0aGlzLmFVcmwgPSBkYXRhLmFVcmw7XHJcbiAgICAgICAgaWYgKGNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzSU9TID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodklPUyAhPSAnMS4wLjMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VuZ3hpbi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vQW5kcm9pZFxyXG4gICAgICAgICAgICAgICAgaWYgKGlzQW5kcm9pZCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZBICE9ICcxLjAuNCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZW5neGluLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBub3RpY2UgPSBkYXRhLmJyb2FkY2FzdDtcclxuICAgICAgICB2YXIgYmFubmVyID0gZGF0YS5pbmZvO1xyXG4gICAgICAgIC8vdGhpcy51cGRhdGVOb3RpY2Uobm90aWNlKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUJhbm5lcihiYW5uZXIpO1xyXG4gICAgfSxcclxuICAgIGRvd25sb2FkTmV3VmVyc2lvbjogZnVuY3Rpb24gZG93bmxvYWROZXdWZXJzaW9uKCkge1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGNjLnN5cy5vcGVuVVJMKHRoaXMuaW9zVXJsKTtcclxuICAgICAgICAgICAgLy8ganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwiZG93bmxvYWROZXdWZXJzaW9uOlwiLCB0aGlzLmlvc1VybCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy9BbmRyb2lkXHJcbiAgICAgICAgICAgIGNjLnN5cy5vcGVuVVJMKHRoaXMuYVVybCk7XHJcbiAgICAgICAgICAgIC8vIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJkb3dubG9hZE5ld1ZlcnNpb25cIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgdGhpcy5hVXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8v5YiG5Lqr5Lmf6Z2iXHJcbiAgICBjbGlja09wZW5TaGFyZTpmdW5jdGlvbiBjbGlja09wZW5TaGFyZSgpe1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICB2YXIgc2hhcmVCZyA9IGNjLmZpbmQoXCJDYW52YXMvc2hlcmVfYmdcIik7XHJcbiAgICAgICAgICAgIHNoYXJlQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy92YXIgd3hCZyA9IHRoaXMuc2hhcmVCZy5nZXRDaGlsZEJ5TmFtZShcInd4XCIpO1xyXG4gICAgICAgICAgICAvL3ZhciBweXFCZyA9IHRoaXMuc2hhcmVCZy5nZXRDaGlsZEJ5TmFtZShcIlBZUVwiKTtcclxuICAgICAgICAgICAgLy93eEJnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vcHlxQmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5zaGFyZUJnLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+WFs+mXreWIhuS6q+mhtemdolxyXG4gICAgY2xpY2tDbG9zZVNoYXJlOmZ1bmN0aW9uIGNsaWNrQ2xvc2VTaGFyZSgpe1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICB2YXIgc2hhcmVCZyA9IGNjLmZpbmQoXCJDYW52YXMvc2hlcmVfYmdcIik7XHJcbiAgICAgICAgICAgIHNoYXJlQmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdmFyIHd4QmcgPSB0aGlzLnNoYXJlQmcuZ2V0Q2hpbGRCeU5hbWUoXCJ3eFwiKTtcclxuICAgICAgICAgICAgLy92YXIgcHlxQmcgPSB0aGlzLnNoYXJlQmcuZ2V0Q2hpbGRCeU5hbWUoXCJQWVFcIik7XHJcbiAgICAgICAgICAgIC8vd3hCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL3B5cUJnLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL3RoaXMuc2hhcmVCZy5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgX2NyZWF0ZVJvb21Tb2NrZXRDYWxsYmFjazogZnVuY3Rpb24gX2NyZWF0ZVJvb21Tb2NrZXRDYWxsYmFjayhyZXNwb25zZSkge1xyXG4gICAgICAgIGlmIChjYy5pc1Jvb21WaWV3U2hvdykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGlkZGVuV2FpdGluZ01lc3NhZ2UoKTtcclxuXHJcbiAgICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3BsYXknKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyrlpoLmnpzpkrvnn7PkuI3otrPvvIzliJnmj5DnpLoqL1xyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZShcIuaCqOeahOmSu+efs+S4jei2s1wiKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBfam9pblJlYXNvbk1hcDogZnVuY3Rpb24gX2pvaW5SZWFzb25NYXAocmVhc29uKSB7XHJcbiAgICAgICAgdmFyIHJlYXNvbkluZm8gPSB7XHJcbiAgICAgICAgICAgIG5vdEV4aXN0OiBcIuaIv+mXtOS4jeWtmOWcqCFcIixcclxuICAgICAgICAgICAgY2FyZE51bWJlcjogXCLmgqjmiL/ljaHkuI3otrMhXCJcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaW5mbyA9IHJlYXNvbkluZm9bcmVhc29uXSB8fCBcIuaIv+mXtOW3sua7oSFcIjtcclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgIH0sXHJcblxyXG4gICAgLypzaG9wKi9cclxuICAgIHNob3BBY3Rpb246IGZ1bmN0aW9uIHNob3BBY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLnNob3BBbGVydE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIGNvbXAuYWxlcnQoKTtcclxuICAgIH0sXHJcbiAgICAvKuaPkOekuiovXHJcbiAgICBhbGVydE1lc3NhZ2U6IGZ1bmN0aW9uIGFsZXJ0TWVzc2FnZShtc2cpIHtcclxuICAgICAgICB2YXIgbm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYWxlcnRQcmVmYWIpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChub2RlKTtcclxuICAgICAgICB2YXIgY29tcCA9IG5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgIGNvbXAuYWxlcnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy91cGRhdGVOb3RpY2U6IGZ1bmN0aW9uIChub3RpY2UpIHtcclxuICAgIC8vICAgIGlmKHRoaXMubGFiZWxOb3RpY2UgPT0gbnVsbCl7XHJcbiAgICAvLyAgICAgICAgcmV0dXJuO1xyXG4gICAgLy8gICAgfVxyXG4gICAgLy8gIHRoaXMubGFiZWxOb3RpY2Uuc3RyaW5nID0gbm90aWNlIHx8IFwiXCI7XHJcbiAgICAvL30sXHJcblxyXG4gICAgdXBkYXRlQmFubmVyOiBmdW5jdGlvbiB1cGRhdGVCYW5uZXIoKSB7XHJcbiAgICAgICAgdmFyIGJhbm5lciA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IFwiXCIgOiBhcmd1bWVudHNbMF07XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmxhYmVsQmFubmVyID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxhYmVsQmFubmVyLnN0cmluZyA9IGJhbm5lcjtcclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjI1xyXG4gICAgICogc2V0dGluZzEg5bGA5pWwICAoMCB8IDEgfCAyIClcclxuICAgICAqIHNldHRpbmcyIOS6uuaVsCAgKDAgfCAxIHwgMiB8IDMpXHJcbiAgICAgKiBzZXR0aW5nMyDnjqnms5UgICgwIHwgMSB8IDIgfCAzIHwgNClcclxuICAgICAqIHNldHRpbmc0IEFB5Yi25pS25Y+W5oi/6LS5ICAoMCB8IDEgfCAyIClcclxuICAgICAqIHNldHRpbmc1IOWFtuS7liAgKDApXHJcbiAgICAgKiBzZXR0aW5nNlxyXG4gICAgICogc2V0dGluZzdcclxuICAgICAqICovXHJcbiAgICBjcmVhdGVEb25lQWN0aW9uOiBmdW5jdGlvbiBjcmVhdGVEb25lQWN0aW9uKCkge1xyXG4gICAgICAgIHZhciBpbmZvID0ge307XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBrZXkgPSBbJ3NldHRpbmcxJywgJ3NldHRpbmcyJywgJ3NldHRpbmc0JywgJ3NldHRpbmc1J107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRzU2luZ2xlU2VsZWN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0c0luZGV4ID0gc2VsZi50c1NpbmdsZVNlbGVjdFtpXS5nZXRDb21wb25lbnQoJ3NpbmdsZVNlbGVjdCcpLnNlbGVjdGVkSW5kZXg7XHJcbiAgICAgICAgICAgIGluZm9ba2V5W2ldXSA9IHRzSW5kZXg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpbmZvWydzZXR0aW5nMyddID0gdGhpcy5zZWxlY3RNb1NoaS5nZXRDb21wb25lbnQoJ3NlbGVjdE1vU2hpJykuX3NlbGVjdDtcclxuICAgICAgICBpbmZvWydzZXR0aW5nNiddID0gdGhpcy5vdmVyVGltZS5nZXRDb21wb25lbnQoJ292ZXJUaW1lJykuX3NlbGVjdGVkO1xyXG4gICAgICAgIGluZm9bJ3NldHRpbmc5J10gPSB0aGlzLmRhaWthaS5nZXRDb21wb25lbnQoJ2RhaWthaScpLl9zZWxlY3RlZDtcclxuICAgICAgICBpbmZvWydzZXR0aW5nMTAnXSA9IHRoaXMuemhvbmd0dWppbnJ1LmdldENvbXBvbmVudCgnemhvbmd0dWppbnJ1JykuX3NlbGVjdGVkO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coIGluZm9bJ3NldHRpbmc2J10gKTtcclxuICAgICAgICBpZiAoIWluZm9bJ3NldHRpbmczJ11bM10pIHtcclxuICAgICAgICAgICAgLy8g546p5rOVIFvnlq/ni4LlnLos6ay854mMLOavlOiKseiJsizlnZDluoQs6ams54mMXSBpbmZvWydzZXR0aW5nMyddWzNd56ys5LiJ6aG56KGo56S65Z2Q5bqE5qih5byP77yM6Z2e5Z2Q5bqE5qih5byP55qE5YCN546H5pivMeWAjVxyXG4gICAgICAgICAgICBpbmZvWydzZXR0aW5nNSddID0gMDsgLy8g5YCN546HICgwfjEpID09ICgxfjPlgI0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGluZm9bJ3NldHRpbmc4J10gPSBudWxsO1xyXG5cclxuICAgICAgICBpbmZvWydzZXR0aW5nNyddID0gdGhpcy5zZWxlY3RNb1NoaS5nZXRDb21wb25lbnQoJ2NoYW5nZV9tYXBhaScpLl9jYXJkcztcclxuICAgICAgICBjYy5zZXQgPSBpbmZvO1xyXG4gICAgICAgIGluZm9bJ3VzZXJJZCddID0gdGhpcy5zb2NrZXQudXNlckluZm8uaWQ7IC8v55So5oi3SWRcclxuICAgICAgICB0aGlzLnNvY2tldC5zZW5kTWVzc2FnZSgnY3JlYXRlRGVzaycsIGluZm8pO1xyXG5cclxuICAgICAgICB0aGlzLmNyZWF0ZU5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuXHJcbiAgICAgICAgLy9sZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5Yib5bu65LitLi4uJyk7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLmhpZGRlbldhaXRpbmdNZXNzYWdlKCk7XHJcbiAgICAgICAgfSwgMi4wKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g6ZqP5py65Zy6XHJcbiAgICAvKmNsaWNrUmFuZFJvb206IGZ1bmN0aW9uICgpIHtcclxuICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3JhbmRSb29tJyk7XHJcbiAgICAgfSwqL1xyXG5cclxuICAgIGNsaWNrUmVjb3JkOiBmdW5jdGlvbiBjbGlja1JlY29yZCgpIHtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMucmVjb3JkTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgY29tcC5hbGVydCgpO1xyXG4gICAgICAgIFNvY2tldC5zZW5kR2V0UmVjcm9kKFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrR2V0RGFpS2FpOmZ1bmN0aW9uIGNsaWNrR2V0RGFpS2FpKCl7XHJcbiAgICAgICAvLyBTb2NrZXQuc2VuZEdldERhaUthaUZhbmcoU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkKTtcclxuICAgICAgICBTb2NrZXQuc2VuZEdldERhaUthaUZhbmcoU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkKTtcclxuICAgICAgICB0aGlzLm15X3Jvb20uYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tQbGF5UnVsZTogZnVuY3Rpb24gY2xpY2tQbGF5UnVsZSgpIHtcclxuICAgICAgICAvL2NjLmRpcmVjdG9yLmxvYWRTY2VuZSgncnVsZScpO1xyXG4gICAgICAgIHRoaXMuaGVscCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImhlbHBcIik7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLmhlbHAuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIGNvbXAuYWxlcnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgZGlzbWlzc0NvbXBsZXRlOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcIm15X3Jvb21cIikuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrUGxheTogZnVuY3Rpb24gY2xpY2tQbGF5KCkge1xyXG4gICAgICAgIGlmIChjYy5jbGlja091dCkgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8q5YiH5o2i6LSm5Y+3Ki9cclxuICAgIGNsaWNrQ2FuY2VsTGF0aW9uOiBmdW5jdGlvbiBjbGlja0NhbmNlbExhdGlvbigpIHtcclxuICAgICAgICB0aGlzLmxvZ291dE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGxvZ291dEFjdGlvbjogZnVuY3Rpb24gbG9nb3V0QWN0aW9uKCkge1xyXG4gICAgICAgIC8vbWFuYWdlci5zZXRVc2VySW5mbygnJyk7XHJcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdsb2dpbicpO1xyXG4gICAgICAgIGhhbGwuY2FjaGVJbWFnZUluZm8gPSBudWxsO1xyXG4gICAgfSxcclxuXHJcbiAgICBleGl0QWN0aW9uOiBmdW5jdGlvbiBleGl0QWN0aW9uKCkge1xyXG4gICAgICAgIC8vbWFuYWdlci5zZXRVc2VySW5mbygnJyk7XHJcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdsb2dpbicpO1xyXG4gICAgICAgICAgICBoYWxsLmNhY2hlSW1hZ2VJbmZvID0gbnVsbDtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwiZXhpdEFwcFwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7XHJcbiAgICAgICAgICAgIC8vQW5kcm9pZCBjb20ubGxpbmcucWlhbmppYW5nbHpnXHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJleGl0QXBwXCIsIFwiKClWXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy5kaXJlY3Rvci5lbmQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/mjqXmlLblpITnkIbnlKjmiLfmlbDmja5cclxuICAgIF9zb2NrZXRSZWNlaXZlVXNlckluZm86IGZ1bmN0aW9uIF9zb2NrZXRSZWNlaXZlVXNlckluZm8ocmVzcG9uc2UpIHtcclxuICAgICAgICBpZiAoY2MuaXNSb29tVmlld1Nob3cpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuc29ja2V0LnVzZXJJbmZvKSB7XHJcbiAgICAgICAgICAgIGNjLmVycm9yKFwidGhpcy5zb2NrZXQudXNlckluZm8g5Li656m6ISEhXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UsXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0t55So5oi35L+h5oGvXCIpO1xyXG4gICAgICAgIC8vdGhpcy5waG9uZS5zdHJpbmcgPSByZXNwb25zZS5kYXRhLnBob25lID8gcmVzcG9uc2UuZGF0YS5waG9uZSA6IFwi5pegXCI7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5nLmdldENvbXBvbmVudCgnU2V0dGluZycpLl9waG9uZSA9IHJlc3BvbnNlLmRhdGEucGhvbmUgPyByZXNwb25zZS5kYXRhLnBob25lIDogbnVsbDtcclxuICAgICAgICB0aGlzLnNldHRpbmcuZ2V0Q29tcG9uZW50KCdTZXR0aW5nJykucGhvbmUuc3RyaW5nID0gcmVzcG9uc2UuZGF0YS5waG9uZSA/IHJlc3BvbnNlLmRhdGEucGhvbmUgOiAn5pegJztcclxuICAgICAgICB0aGlzLm5pY2tOYW1lTGFiZWwuc3RyaW5nID0gcmVzcG9uc2UuZGF0YS5uaWNrbmFtZTsgLy8g55So5oi35ZCNXHJcbiAgICAgICAgdGhpcy51c2VySWRMYWJlbC5zdHJpbmcgPSAnSUQ6ICcgKyByZXNwb25zZS5kYXRhLmlkOyAvLyBJRFxyXG4gICAgICAgIHRoaXMuY2FyZE51bWJlckxhYmVsLnN0cmluZyA9IHJlc3BvbnNlLmRhdGEuY2FyZE51bWJlcjtcclxuICAgICAgICB2YXIgc3ByaXRlID0gdGhpcy5hdmF0YXJOb2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgIGNjLmxvYWRlci5sb2FkKHsgdXJsOiByZXNwb25zZS5kYXRhLmF2YXRhclVybCwgdHlwZTogXCJqcGdcIiB9LCBmdW5jdGlvbiAoZXJyLCB0ZXgpIHtcclxuICAgICAgICAgICAgaWYgKCFlcnIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gZnJhbWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldERpc2Nvbm5lY3Q6IGZ1bmN0aW9uIF9zb2NrZXREaXNjb25uZWN0KCkge1xyXG4gICAgICAgIHRoaXMuc2hvd05ldHdvcmtNZXNzYWdlKFwi572R57uc6ZO+5o6l5pat5byA77yM6YeN5paw6L+e5o6l5LitLi4uXCIpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0Q29ubmVjdGVkOiBmdW5jdGlvbiBfc29ja2V0Q29ubmVjdGVkKCkge1xyXG4gICAgICAgIHRoaXMuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/mm7TmlrDnlKjmiLfkv6Hmga9cclxuICAgIHVwZGF0ZVVzZXJJbmZvOiBmdW5jdGlvbiB1cGRhdGVVc2VySW5mbygpIHtcclxuICAgICAgICB2YXIgaW5mbyA9IHRoaXMuc29ja2V0LnVzZXJJbmZvO1xyXG4gICAgICAgIGlmICghaW5mbykge1xyXG4gICAgICAgICAgICBjYy5lcnJvcihcInRoaXMuc29ja2V0LnVzZXJJbmZvIOS4uuepuiEhIVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5uaWNrTmFtZUxhYmVsLnN0cmluZyA9IGluZm8ubmlja25hbWU7XHJcbiAgICAgICAgdGhpcy51c2VySWRMYWJlbC5zdHJpbmcgPSAnSUQ6ICcgKyBpbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuY2FyZE51bWJlckxhYmVsLnN0cmluZyA9IGluZm8uY2FyZE51bWJlcjtcclxuXHJcbiAgICAgICAgdmFyIGF2YXRhclVybCA9IGluZm8uYXZhdGFyVXJsICsgXCIuanBnXCI7XHJcbiAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuYXZhdGFyTm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICB2YXIgdGV4dHVyZSA9IGhhbGwuY2FjaGVJbWFnZUluZm9bYXZhdGFyVXJsXTtcclxuICAgICAgICBpZiAodGV4dHVyZSkge1xyXG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4dHVyZSk7XHJcbiAgICAgICAgICAgIGlmIChmcmFtZSkge1xyXG4gICAgICAgICAgICAgICAgLy9jYy5sb2coXCLku47nvJPlrZjkuK3liqDovb3lpLTlg49cIik7XHJcbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBmcmFtZTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2MubG9hZGVyLmxvYWQoeyB1cmw6IGluZm8uYXZhdGFyVXJsLCB0eXBlOiBcImpwZ1wiIH0sIGZ1bmN0aW9uIChlcnIsIHRleCkge1xyXG4gICAgICAgICAgICBpZiAoIWVycikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKHRleCk7XHJcbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBmcmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICBoYWxsLmNhY2hlSW1hZ2VJbmZvW2F2YXRhclVybF0gPSB0ZXg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLyrmj5DkuqTmhI/op4EqL1xyXG4gICAgZmVlZGJhY2tBY2lvbjogZnVuY3Rpb24gZmVlZGJhY2tBY2lvbigpIHtcclxuICAgICAgICB2YXIgdXNlcklkID0gdGhpcy5zb2NrZXQudXNlckluZm8uaWQ7XHJcbiAgICAgICAgdmFyIHRleHQgPSB0aGlzLmZlZWRiYWNrRWRpdEJveC5zdHJpbmc7XHJcbiAgICAgICAgaWYgKHRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmZlZWRiYWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgICAgICBTb2NrZXQuc2VuZEZlZWRiYWNrKHVzZXJJZCwgdGV4dCk7XHJcbiAgICAgICAgICAgIHRoaXMuZmVlZGJhY2tFZGl0Qm94LnN0cmluZyA9ICcnO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc2hvd1dhaXRpbmdNZXNzYWdlOiBmdW5jdGlvbiBzaG93V2FpdGluZ01lc3NhZ2UobXNnKSB7XHJcbiAgICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCAmJiBjYy5zeXMuaXNOYXRpdmUgJiYgY2Muc3lzLmlzT2JqZWN0VmFsaWQodGhpcy53YWl0aW5nTm9kZSkpIHtcclxuICAgICAgICAgICAgdGhpcy53YWl0aW5nTm9kZS5kZXN0b3J5KCk7XHJcbiAgICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLndhaXRpbmdOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy53YWl0aW5nTm9kZSk7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLndhaXRpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgICBjb21wLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGRlbldhaXRpbmdNZXNzYWdlOiBmdW5jdGlvbiBoaWRkZW5XYWl0aW5nTWVzc2FnZSgpIHtcclxuICAgICAgICBpZiAodGhpcy53YWl0aW5nTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vbmV0d29ya1xyXG4gICAgc2hvd05ldHdvcmtNZXNzYWdlOiBmdW5jdGlvbiBzaG93TmV0d29ya01lc3NhZ2UobXNnKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgJiYgdGhpcy5uZXR3b3JrTm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgdmFyIF9hbGVydCA9IHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgICAgICBpZiAoX2FsZXJ0LmdldE1lc3NhZ2UoKSA9PSBtc2cpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZS5ydW5BY3Rpb24ocmVtb3ZlU2VsZkFjdGlvbik7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5ldHdvcmtOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5uZXR3b3JrTm9kZSk7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc2VsZi5uZXR3b3JrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgICBjb21wLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGRlbk5ldHdvcmtNZXNzYWdlOiBmdW5jdGlvbiBoaWRkZW5OZXR3b3JrTWVzc2FnZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vY2hlY2tOb2RlXHJcbiAgICBzaG93Q2hlY2tNZXNzYWdlOiBmdW5jdGlvbiBzaG93Q2hlY2tNZXNzYWdlKG1zZykge1xyXG4gICAgICAgIGlmICghKHRoaXMuY2hlY2tOb2RlICYmIHRoaXMuY2hlY2tOb2RlLmFjdGl2ZSkpIHt9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgX2FsZXJ0MiA9IHRoaXMuY2hlY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICAgICAgaWYgKF9hbGVydDIuZ2V0TWVzc2FnZSgpID09IG1zZykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5jaGVja05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUucnVuQWN0aW9uKHJlbW92ZVNlbGZBY3Rpb24pO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hlY2tOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5jaGVja05vZGUpO1xyXG4gICAgICAgIHZhciBjb21wID0gdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLmNoZWNrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgICBjb21wLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGRlbkNoZWNrTWVzc2FnZTogZnVuY3Rpb24gaGlkZGVuQ2hlY2tNZXNzYWdlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uQnRuQ2xpY2s6IGZ1bmN0aW9uIG9uQnRuQ2xpY2soKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2J1dHRvbnMuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbnMuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9ucy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pO1xyXG5cclxuLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbi8vIH0sXHJcbm1vZHVsZS5leHBvcnRzID0gaGFsbDtcclxuXHJcbmNjLl9SRnBvcCgpOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvKnNwcml0ZXM6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlQXRsYXNcclxuICAgICAgICB9LCovXHJcbiAgICAgICAgcGxheV9tZXRob2RfYmVmb3JlOmNjLk5vZGUsICAvL+eOqeazleS7i+e7jVxyXG4gICAgICAgIHBsYXlfbWV0aG9kX2NvbnRlbnRfbGFiZWw6Y2MuTm9kZSwgIC8v546p5rOV5LuL57uN5YaF5a65XHJcbiAgICAgICAgaW50cm9kdWNlX3BhaV9iZWZvcmU6Y2MuTm9kZSwvL+eJjOWei+S7i+e7jVxyXG4gICAgICAgIGRldGFpbHM6Y2MuTm9kZSwgICAvL+eJjOWei+S7i+e7jeWGheWuuVxyXG4gICAgICAgIGNhb3p1b19iZWZvcmU6Y2MuTm9kZSwgICAgIC8v5pON5L2c5LuL57uNXHJcbiAgICAgICAgY2FvenVvX2NvbnRlbnQ6Y2MuTm9kZSwgIC8v5pON5L2c5LuL57uN5YaF5a65XHJcbiAgICAgICAgX2J0bjpudWxsLFxyXG4gICAgICAgIF9jb250ZW50Om51bGwsXHJcbiAgICAgICAgX2J1dHRvbkNvbTpudWxsLFxyXG4gICAgICAgIF9wbGF5X21ldGhvZF9idXR0b246bnVsbCxcclxuICAgICAgICBfaW50cm9kdWNlX3BhaV9idXR0b246bnVsbCxcclxuICAgICAgICBfY2FvenVvX2J1dHRvbjpudWxsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy90aGlzLl9wbGF5X21ldGhvZF9idXR0b24gPSB0aGlzLnBsYXlfbWV0aG9kX2JlZm9yZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICAvL3RoaXMuX2ludHJvZHVjZV9wYWlfYnV0dG9uID0gdGhpcy5pbnRyb2R1Y2VfcGFpX2JlZm9yZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICAvL3RoaXMuX2Nhb3p1b19idXR0b24gPSB0aGlzLmNhb3p1b19iZWZvcmUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XHJcbiAgICAgICAgLy90aGlzLl9idG4gPSBbdGhpcy5wbGF5X21ldGhvZF9iZWZvcmUsdGhpcy5pbnRyb2R1Y2VfcGFpX2JlZm9yZSx0aGlzLmNhb3p1b19iZWZvcmVdO1xyXG4gICAgICAgIC8vdGhpcy5fY29udGVudCA9IFt0aGlzLnBsYXlfbWV0aG9kX2NvbnRlbnRfbGFiZWwsdGhpcy5kZXRhaWxzLHRoaXMuY2FvenVvX2NvbnRlbnRdO1xyXG4gICAgICAgIC8vdGhpcy5fYnV0dG9uQ29tID0gW3RoaXMuX3BsYXlfbWV0aG9kX2J1dHRvbix0aGlzLl9pbnRyb2R1Y2VfcGFpX2J1dHRvbix0aGlzLl9jYW96dW9fYnV0dG9uXTtcclxuICAgICAgICAvLy8v5Yia5byA5aeL54mM5Z6L5LuL57uN55qE5oyJ6ZKu5LiN5Y+v55SoXHJcbiAgICAgICAgLy90aGlzLl9idXR0b25Db21bMV0uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgLy8g54K55Ye7546p5rOV5LuL57uNXHJcbiAgICBvbkJ0blBsYXlNZXRob2RDbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy9mb3IodmFyIGk9MDtpPDM7aSsrKXtcclxuICAgICAgICAvLyAgICAvL+aJgOacieaMiemSruiuvue9ruS4uuWPr+eUqFxyXG4gICAgICAgIC8vICAgIHRoaXMuX2J1dHRvbkNvbVtpXS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIC8v5omA5pyJ55qE5YaF5a656YO96ZqQ6JeP5o6JXHJcbiAgICAgICAgLy8gICAgdGhpcy5fY29udGVudFtpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8v5b2T5YmN54K55Ye755qE6K6+572u5Li65LiN5Y+v55SoXHJcbiAgICAgICAgLy90aGlzLl9idXR0b25Db21bMF0uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgLy8vL+W9k+WJjeeCueWHu+eahOWvueW6lOeahOWGheWuueWPr+ingVxyXG4gICAgICAgIHRoaXMuX2NvbnRlbnRbMF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICAvL+eCueWHu+eJjOWei+S7i+e7jVxyXG4gICAgb25CdG5JbnRyb2R1Y2VQYWlDbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy9mb3IodmFyIGk9MDtpPDM7aSsrKXtcclxuICAgICAgICAvLyAgICAvL+aJgOacieaMiemSruiuvue9ruS4uuWPr+eUqFxyXG4gICAgICAgIC8vICAgIHRoaXMuX2J1dHRvbkNvbVtpXS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIC8v5omA5pyJ55qE5YaF5a656YO96ZqQ6JeP5o6JXHJcbiAgICAgICAgLy8gICAgdGhpcy5fY29udGVudFtpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8v5b2T5YmN54K55Ye755qE6K6+572u5Li65LiN5Y+v55SoXHJcbiAgICAgICAgLy90aGlzLl9idXR0b25Db21bMV0uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgLy8vL+W9k+WJjeeCueWHu+eahOWvueW6lOeahOWGheWuueWPr+ingVxyXG4gICAgICAgIC8vdGhpcy5fY29udGVudFsxXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIC8v54K55Ye75pON5L2c5LuL57uNXHJcbiAgICBvbkJ0bkNhb3p1b0NsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL2Zvcih2YXIgaT0wO2k8MztpKyspe1xyXG4gICAgICAgIC8vICAgIC8v5omA5pyJ5oyJ6ZKu6K6+572u5Li65Y+v55SoXHJcbiAgICAgICAgLy8gICAgdGhpcy5fYnV0dG9uQ29tW2ldLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgLy/miYDmnInnmoTlhoXlrrnpg73pmpDol4/mjolcclxuICAgICAgICAvLyAgICB0aGlzLl9jb250ZW50W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLy/lvZPliY3ngrnlh7vnmoTorr7nva7kuLrkuI3lj6/nlKhcclxuICAgICAgICAvL3RoaXMuX2J1dHRvbkNvbVsyXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAvLy8v5b2T5YmN54K55Ye755qE5a+55bqU55qE5YaF5a655Y+v6KeBXHJcbiAgICAgICAgLy90aGlzLl9jb250ZW50WzJdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwiLyoqXHJcbiAqIOmCgOivt+eggVxyXG4gKiBAYXV0aG9ycyDpu4TmiJAoeW91QGV4YW1wbGUub3JnKVxyXG4gKiBAZGF0ZSAgICAyMDE3LTA2LTE2IDA5OjQ0OjEwXHJcbiAqIEB2ZXJzaW9uICRJZCRcclxuICovXHJcbmNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGxhYmVsTnVtYmVyczogW2NjLkxhYmVsXSxcclxuICAgICAgICBjYWxsYmFja0ludml0ZUNvZGU6ICcnLFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5jbGlja0NsZWFyKCk7IC8v5riF6Zmk5pWw5a2XXHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrQ2xlYXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5sYWJlbE51bWJlcnMuZm9yRWFjaChmdW5jdGlvbiAobGFiZWwpIHtcclxuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tOdW1iZXI6IGZ1bmN0aW9uIChldmVudCwgbnVtYmVyKSB7XHJcbiAgICAgIHZhciBsYWJlbCA9IHRoaXMuX2xhc3RFbXB0eUxhYmVsKCk7XHJcbiAgICAgIGlmIChsYWJlbCkge1xyXG4gICAgICAgIGxhYmVsLnN0cmluZyA9IG51bWJlcjtcclxuICAgICAgIFx0Ly9jYy5sb2cobGFiZWwuc3RyaW5nICxcIi0tLS0tLS0tLS0tLS0tLS1cIik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGxldCBpc0NvbXBsZXRlID0gKHRoaXMuX2xhc3RFbXB0eUxhYmVsKCkgPT0gbnVsbCk7XHJcbiAgICAgIC8vY2MubG9nKFwiaXNDb21wbGV0ZS0tLS0tLS0tLS0tLS1cIiwgdGhpcy5jYWxsYmFja0ludml0ZUNvZGUpO1xyXG4gICAgICBsZXQgaW52aXRlTnVtYmVyID0gdGhpcy5faW52aXRlTnVtYmVyKCk7XHJcblxyXG4gICAgICBpZiAoIGludml0ZU51bWJlci5sZW5ndGggPT0gNiApe1xyXG4gICAgICAgIC8vY2MubG9nKGludml0ZU51bWJlcixcIi0tLS0tLS0tLS0tLS0tLS0tLS0tMzhcIik7IC8v6YKA6K+356CBXHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcclxuICAgICAgICAvL1NvY2tldC5zZW5kSW52aXRlQ29kZShpbnZpdGVOdW1iZXIsIHVzZXJJZCk7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja0ludml0ZUNvZGUgPSBpbnZpdGVOdW1iZXI7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzZW5kQ29kZSA6ZnVuY3Rpb24oKXsgIC8v5Y+R6YCB6YKA6K+356CBXHJcbiAgICAgIGxldCB1c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XHJcbiAgICAgIGxldCBpbnZpdGVOdW1iZXIgPSB0aGlzLmNhbGxiYWNrSW52aXRlQ29kZTtcclxuICAgICAgLy9jYy5sb2coaW52aXRlTnVtYmVyLFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0zOFwiKVxyXG4gICAgICBpZiggaW52aXRlTnVtYmVyICYmIGludml0ZU51bWJlci5sZW5ndGg9PTYpeyAgXHJcbiAgICAgICAgU29ja2V0LnNlbmRJbnZpdGVDb2RlKGludml0ZU51bWJlciwgdXNlcklkKTtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrSW52aXRlQ29kZSA9ICcnOyAgIC8v5riF56m66YKA6K+356CBXHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjbGlja0RlbGV0ZU9uZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgbGFiZWwgPSB0aGlzLl9sYXN0TnVtYmVyTGFiZWwoKTtcclxuICAgICAgaWYgKGxhYmVsKSB7XHJcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gXCJcIjtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfbGFzdEVtcHR5TGFiZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgZm9yICh2YXIgaW5kZXggaW4gdGhpcy5sYWJlbE51bWJlcnMpIHtcclxuICAgICAgICB2YXIgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XHJcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyA9PSBudWxsXHJcbiAgICAgICAgfHwgbGFiZWwuc3RyaW5nLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfSxcclxuXHJcbiAgICBfbGFzdE51bWJlckxhYmVsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGZvciAodmFyIGluZGV4ID0gdGhpcy5sYWJlbE51bWJlcnMubGVuZ3RoIC0gMTsgaW5kZXggPj0gMDsgLS1pbmRleCkge1xyXG4gICAgICAgIGxldCBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcclxuICAgICAgICBpZiAobGFiZWwuc3RyaW5nICYmIGxhYmVsLnN0cmluZy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgX2ludml0ZU51bWJlcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5sYWJlbE51bWJlcnMucmVkdWNlKGZ1bmN0aW9uIChpbnZpdGVOdW1iZXIsIGxhYmVsKSB7XHJcbiAgICAgICAgLy9jYy5sb2coaW52aXRlTnVtYmVyLFwiLS0tLS0tLS0tLS0tLS0tLS1cIik7XHJcbiAgICAgICAgcmV0dXJuIGludml0ZU51bWJlciArIChsYWJlbC5zdHJpbmcgfHwgXCJcIik7XHJcbiAgICAgIH0sIFwiXCIpO1xyXG4gICAgfSxcclxufSkiLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYWJlbE51bWJlcnM6IFtjYy5MYWJlbF0sXG4gICAgICAgIGNhbGxiYWNrSm9pblJvb206IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jbGlja0NsZWFyKCk7XG4gICAgfSxcblxuICAgIGNsaWNrTnVtYmVyOiBmdW5jdGlvbiAoZXZlbnQsIG51bWJlcikge1xuICAgICAgdmFyIGxhYmVsID0gdGhpcy5fbGFzdEVtcHR5TGFiZWwoKTtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBudW1iZXI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBpc0NvbXBsZXRlID0gKHRoaXMuX2xhc3RFbXB0eUxhYmVsKCkgPT0gbnVsbCk7XG4gICAgICBpZiAoaXNDb21wbGV0ZSAmJiB0aGlzLmNhbGxiYWNrSm9pblJvb20pIHtcbiAgICAgICAgbGV0IHJvb21OdW1iZXIgPSB0aGlzLl9yb29tTnVtYmVyKCk7XG4gICAgICAgIC8vIGNjLmxvZyhcIuimgeWKoOWFpeeahOaIv+mXtOWPt+aYr++8mlwiLCByb29tTnVtYmVyKTtcbiAgICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tKHJvb21OdW1iZXIpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBjbGlja0NsZWFyOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmxhYmVsTnVtYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGNsaWNrRGVsZXRlT25lOiBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgbGFiZWwgPSB0aGlzLl9sYXN0TnVtYmVyTGFiZWwoKTtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBfbGFzdEVtcHR5TGFiZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGluZGV4IGluIHRoaXMubGFiZWxOdW1iZXJzKSB7XG4gICAgICAgIHZhciBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyA9PSBudWxsXG4gICAgICAgIHx8IGxhYmVsLnN0cmluZy5sZW5ndGggPD0gMCkge1xuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9sYXN0TnVtYmVyTGFiZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGluZGV4ID0gdGhpcy5sYWJlbE51bWJlcnMubGVuZ3RoIC0gMTsgaW5kZXggPj0gMDsgLS1pbmRleCkge1xuICAgICAgICBsZXQgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgJiYgbGFiZWwuc3RyaW5nLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9yb29tTnVtYmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5sYWJlbE51bWJlcnMucmVkdWNlKGZ1bmN0aW9uIChyb29tTnVtYmVyLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gcm9vbU51bWJlciArIChsYWJlbC5zdHJpbmcgfHwgXCJcIik7XG4gICAgICB9LCBcIlwiKTtcbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnbG9naW4nKTtcbiAgICAgICAgfSwgMC41KTtcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwidmFyIG1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XG5jb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgS1FDYXJkRmluZFR5cGVFeHRlbnNpb24gPSByZXF1aXJlKCdLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbicpO1xuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xuY29uc3QgS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlciA9IHJlcXVpcmUoJ0tRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXInKTtcblxudmFyIEFQUElEID0gJ3d4ZTg5OTNmNDY4YjE2ZmE1ZCc7XG52YXIgUk9PTUlEID0gJyc7XG4vL+aOiOadg+WcsOWdgFxuLy/mraPlvI/lnLDlnYBcbi8vIHZhciBSRURJUkVDVF9VUkkgPSBcImh0dHAlM0ElMkYlMkZ3d3cuaG9uZ2dlZmVuZy5jbiUyRnNzeldlYiUyRmluZGV4LnBocFwiO1xuLy8g5rWL6K+V5Zyw5Z2AXG52YXIgUkVESVJFQ1RfVVJJID0gXCJodHRwJTNhJTJmJTJmbzFvMi5jblwiO1xuXG5sZXQgSFJFRiA9IFwiaHR0cHM6Ly9vcGVuLndlaXhpbi5xcS5jb20vY29ubmVjdC9vYXV0aDIvYXV0aG9yaXplP2FwcGlkPVwiK0FQUElEK1wiJnJlZGlyZWN0X3VyaT1cIitSRURJUkVDVF9VUkkrXCImcmVzcG9uc2VfdHlwZT1jb2RlJnNjb3BlPXNuc2FwaV91c2VyaW5mbyZzdGF0ZT1TVEFURSN3ZWNoYXRfcmVkaXJlY3RcIjtcblxuXG5jYy5DbGFzcyh7XG5cbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvL3NlbGVjdE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgYWxlcnRQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICBjYW52YXNOb2RlOmNjLk5vZGUsXG4gICAgICAgIGxvYWRpbmdOb2RlOmNjLk5vZGUsXG4gICAgICAgIC8vZXJyOmNjLk5vZGUsXG4gICAgICAgIHdhaXRpbmdQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICByZWNvcmRJbmZvOmNjLlByZWZhYixcbiAgICAgICAgbGFiZWw6Y2MuTGFiZWwsXG4gICAgfSxcblxuICAgIGdvVXBkYXRlQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcIkFwcENvbnRyb2xsZXJcIixcImRvd25sb2FkTmV3VmVyc2lvbjpcIix0aGlzLmlvc1VybCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL2dvbmdwYS9zc3ovQXBwQWN0aXZpdHlcIiwgXCJkb3dubG9hZE5ld1ZlcnNpb25cIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgdGhpcy5hbmRyb2lkVXJsKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBjaGVja1ZlcnNpb246ZnVuY3Rpb24odkRhdGEpIHtcbiAgICAgICAgLy92YXIgdmVyc2lvbiA9IHZEYXRhLnZlcnNpb247XG4gICAgICAgIGNjLmluZm8xID0gdkRhdGEudmVyc2lvbjtcbiAgICAgICAgdGhpcy5pb3NVcmwgPSB2RGF0YS5pb3NVcmw7XG4gICAgICAgIHRoaXMuYW5kcm9pZFVybCA9IHZEYXRhLmFuZHJvaWRVcmw7XG4gICAgICAgIC8vaWYgKG1hbmFnZXIudmVyc2lvbiAhPSB2ZXJzaW9uKSB7Ly/mm7TmlrDniYjmnKxcbiAgICAgICAgLy8gICAgdGhpcy52ZXJzaW9uRW5hYmxlID0gZmFsc2U7XG4gICAgICAgIC8vICAgIHRoaXMuZ29VcGRhdGVBY3Rpb24oKTtcbiAgICAgICAgLy8gICAgLy90aGlzLnZlcnNpb25MYWJlbC5zdHJpbmcgPSAn6K+35Yiw5pyN5Yqh5Zmo5pu05paw5Yiw5pyA5paw54mI5pysJztcbiAgICAgICAgLy99XG4gICAgICAgIC8vZWxzZSB7XG4gICAgICAgICAgICAvL3RoaXMudmVyc2lvbkxhYmVsLnN0cmluZyA9ICflvZPliY3niYjmnKwgJyArIG1hbmFnZXIudmVyc2lvbjtcbiAgICAgICAgICAgIGlmKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgICAgICAvLyBpZihpb3NWZXJzaW9uICE9IG1hbmFnZXIudmVyc2lvbikge1xuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLnZlcnNpb25FbmFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvLyAgICAgdmFyIHVwZGF0ZUFsZXJ0ID0gY2MuZmluZChcIkNhbnZhcy91cGRhdGVcIikuZ2V0Q29tcG9uZW50KFwiYWxlcnRcIik7XG4gICAgICAgICAgICAgICAgLy8gICAgIHVwZGF0ZUFsZXJ0LmFsZXJ0KCk7XG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIC8vIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZlcnNpb25FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2luRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2luQWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sMC41KTtcbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHtcbiAgICAgICAgICAgICAgICAvLyBpZihhbmRyb2lkVmVyc2lvbiAhPSBtYW5hZ2VyLnZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy52ZXJzaW9uRW5hYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgLy8gICAgIHZhciB1cGRhdGVBbGVydCA9IGNjLmZpbmQoXCJDYW52YXMvdXBkYXRlXCIpLmdldENvbXBvbmVudChcImFsZXJ0XCIpO1xuICAgICAgICAgICAgICAgIC8vICAgICB1cGRhdGVBbGVydC5hbGVydCgpO1xuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICAvLyBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52ZXJzaW9uRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9naW5FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2dpbkFjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LDAuNSk7XG4gICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICB0aGlzLnZlcnNpb25FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgIC8vIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgICAvLyBpZiAoaW5mby5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAvLyAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgICAgICAgICAgIHZhciByZWNvcmRJZCA9IHNlbGYuZ2V0UXVlcnlTdHJpbmcoJ3JlY29yZElkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgaWYocmVjb3JkSWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgU29ja2V0LnNlbmRHZXRSZWNyb2RGcm9tSWQocmVjb3JkSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB2YXIgcm9vbUlkID0gc2VsZi5nZXRRdWVyeVN0cmluZyhcInJvb21JZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICBpZihyb29tSWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighZGF0YS5lcnJjb2RlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VuZExvZ2luUmVxdWVzdChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZ2V0X0hSRUYocm9vbUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoaW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpe1xuICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYoIWRhdGEgfHwgZGF0YS5lcnJjb2RlKXtcbiAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2luRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2luQWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBzZWxmLmdldFF1ZXJ5U3RyaW5nKFwiY29kZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByb29tSWQgPSBzZWxmLmdldFF1ZXJ5U3RyaW5nKFwicm9vbUlkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHJvb21JZCApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFkYXRhLmVycmNvZGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbmRMb2dpblJlcXVlc3QoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyhcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2dldF9IUkVGKHJvb21JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGNvZGUgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsgIC8vIFhNTEh0dHBSZXF1ZXN05a+56LGh55So5LqO5Zyo5ZCO5Y+w5LiO5pyN5Yqh5Zmo5Lqk5o2i5pWw5o2uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBcIi4vZ2V0X3Rva2VuLnBocFwiOyAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLm9wZW4oXCJQT1NUXCIsIHVybCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC10eXBlXCIsIFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIpOyAgLy8g5re75YqgaHR0cOWktO+8jOWPkemAgeS/oeaBr+iHs+acjeWKoeWZqOaXtuWGheWuuee8lueggeexu+Wei1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5yZWFkeVN0YXRlID09IDQgJiYgKG9iai5zdGF0dXMgPT0gMjAwIHx8IG9iai5zdGF0dXMgPT0gMzA0KSkgeyAgLy8gMzA05pyq5L+u5pS5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQob2JqLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZSggb2JqLnJlc3BvbnNlVGV4dCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighZGF0YS5lcnJjb2RlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oIG9iai5yZXNwb25zZVRleHQgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VuZExvZ2luUmVxdWVzdCggZGF0YSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmouc2VuZChcImNvZGU9XCIrY29kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfWNhdGNoKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LDAuNSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIC8vfVxuICAgIH0sXG4gICAga2V5QmFja0xpc3RlbjpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGNjLnN5c3RlbUV2ZW50Lm9uKGNjLlN5c3RlbUV2ZW50LkV2ZW50VHlwZS5LRVlfRE9XTixmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT0gY2MuS0VZLmJhY2spIHtcbiAgICAgICAgICAgICAgICBpZighS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSl7XG4gICAgICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJiYWNrVG9EZXNrXCIsIFwiKClWXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSx0aGlzKTtcbiAgICB9LFxuICAgIC8v6ZqP5py655Sf5oiQIG51bSDkvY0g55qE6ZqP5py65pWwIOWQq+Wkp+Wwj+WGmeWtl+avjeWPiuaVsOWtl1xuICAgIGdldFJhbmRvbUFjY291bnQ6ZnVuY3Rpb24obnVtKVxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOi/lOWbnuS4gOS4quWtl+avjVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q2hhcmFjdGVyKGZsYWcpe1xuICAgICAgICAgICAgdmFyIGNoYXJhY3RlciA9IFwiXCI7XG4gICAgICAgICAgICBpZihmbGFnID09PSBcImxvd2VyXCIpe1xuICAgICAgICAgICAgICAgIGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoTWF0aC5mbG9vciggTWF0aC5yYW5kb20oKSAqIDI2KSArIFwiYVwiLmNoYXJDb2RlQXQoMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoZmxhZyA9PT0gXCJ1cHBlclwiKXtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKE1hdGguZmxvb3IoIE1hdGgucmFuZG9tKCkgKiAyNikgKyBcIkFcIi5jaGFyQ29kZUF0KDApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjaGFyYWN0ZXI7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3RyID0gXCJcIjtcbiAgICAgICAgZm9yKHZhciBpPTA7aTxudW07aSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgZmxhZyA9IFwibG93ZXJcIiA7XG4gICAgICAgICAgICB2YXIgcmFuZG9tID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyk7XG4gICAgICAgICAgICBpZihyYW5kb20gPT0gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmbGFnID0gXCJ1cHBlclwiIDtcbiAgICAgICAgICAgICAgICBzdHIgKz0gZ2V0Q2hhcmFjdGVyKGZsYWcpO1xuICAgICAgICAgICAgfWVsc2UgaWYocmFuZG9tID09IDEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RyICs9IGdldENoYXJhY3RlcihmbGFnKTtcbiAgICAgICAgICAgIH1lbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RyICs9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH0sXG4gICAgZ2V0R3Vlc3RVc2VySW5mbzpmdW5jdGlvbigpe1xuICAgICAgICBsZXQgc2VhcmNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcbiAgICAgICAgdmFyIG9wZW5pZCA9IFwiZ3Vlc3RfXCIgKyB0aGlzLmdldFJhbmRvbUFjY291bnQoOCk7XG4gICAgICAgIHZhciB1bmlvbmlkID0gJ2d1ZXN0XycgKyB0aGlzLmdldFJhbmRvbUFjY291bnQoOCk7XG4gICAgICAgIHZhciBuaWNrbmFtZSA9IHRoaXMuZ2V0UmFuZG9tQWNjb3VudCg4KTtcbiAgICAgICAgdmFyIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcbiAgICAgICAgcmV0dXJuIHRlc3REYXRhO1xuICAgIH0sXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMua2V5QmFja0xpc3RlbigpO1xuICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlICYmIGNjLnN5cy5pc01vYmlsZSl7XG4gICAgICAgICAgICB2YXIgY2FudmFzID0gY2MuZmluZChcIkNhbnZhc1wiKTtcbiAgICAgICAgICAgIHZhciBjdnMgPSBjYW52YXMuZ2V0Q29tcG9uZW50KGNjLkNhbnZhcyk7XG4gICAgICAgIH1cbiAgICAgICAgS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlci5zdGFydCgpO1xuICAgICAgICB0aGlzLnNvY2tldCA9IGNjLmZpbmQoJ0dhbWVTb2NrZXQnKS5nZXRDb21wb25lbnQoJ3NvY2tldCcpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMubG9naW5FbmFibGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zb2NrZXQucmVjZXZpY2VNZXNzYWdlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpXG4gICAgICAgICAgICBpZiAoZGF0YS5hY3Rpb24gPT0gJ2NoZWNrVmVyc2lvbicpIHtcbiAgICAgICAgICAgICAgdHJ5e1xuICAgICAgICAgICAgICAgIHNlbGYuY2hlY2tWZXJzaW9uKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgIH1jYXRjaChlKXtcbiAgICAgICAgICAgICAgICAvL3RoaXMuZXJyLnN0cmluZyA9IGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGEuYWN0aW9uID09ICdsb2dpbicpIHtcbiAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3VsdCkgey8v5oiQ5YqfXG4gICAgICAgICAgICAgICAgICAgc2VsZi5zb2NrZXQudXNlckluZm8gPSBkYXRhLmRhdGE7Ly/ov5DooYzml7bmgIHkv6Hmga9cbiAgICAgICAgICAgICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgcm9vbUlkID0gc2VsZi5nZXRRdWVyeVN0cmluZyhcInJvb21JZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHJvb21JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgaWYocm9vbUlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhLmRhdGEuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhpdEluUm9vbSA9IGRhdGEuZGF0YS5yb29tSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihleGl0SW5Sb29tICE9IFwiXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICByb29tSWQgPSBleGl0SW5Sb29tO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgU29ja2V0LnNlbmRMb2dpbkpvaW4ocm9vbUlkLCB1c2VySWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9sb2FkaW5nTGFiZWwoXCLnmbvlvZXkuK1cIik7XG4gICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZGF0YS5yb29tSWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAvLyBzZWxmLmFsZXJ0TWVzc2FnZSgn55m75b2V5aSx6LSlIScpO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyU29ja2V0RXZlbnQoKTtcblxuICAgICAgICB0aGlzLnNvY2tldC5nZXRXeEluZm8gPSBmdW5jdGlvbihpbmZvKSB7XG4gICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oaW5mbyk7Ly/kv53lrZjmnKzlnLBcbiAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pOy8vc3RyIC0+IGpzb24ob2JqKVxuICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbigpey8v5bu26L+f5omn6KGMIDFzXG4gICAgICAgICAgICAgICBzZWxmLnNlbmRMb2dpblJlcXVlc3QoZGF0YSk7Ly/nmbvlvZXor7fmsYJcbiAgICAgICAgICAgfSwxKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5nZXRPbmx5VXNlckluZm9CeUJyb3dzZXIoKTtcbiAgICAgICAgLy9jYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ1c2VyaW5mb1wiKTtcbiAgICAgICAgLy8gbGV0IHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG4gICAgICAgIC8vIHZhciBvcGVuaWQgPSBcIkp6SXdNVGN2Tmk4eE5pRGt1SXJsallneE1Nem93T0NjPVwiO1xuICAgICAgICAvLyB2YXIgdW5pb25pZCA9ICc4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9Mdic7XG4gICAgICAgIC8vIHZhciBuaWNrbmFtZSA9IFwi5ZOH5ZOI5ZOIXCI7XG5cblxuICAgICAgICAvL3ZhciBvcGVuaWQgPSBcIkp6SXdNVGN2Tmk4eE5pRGt1SXJsallneE1Nem93T0NjPVwiO1xuICAgICAgICAvL3ZhciBvcGVuaWQgPSBcImd1ZXN0X1wiICsgdGhpcy5nZXRSYW5kb21BY2NvdW50KDgpO1xuICAgICAgICAvL3ZhciB1bmlvbmlkID0gJzhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2JztcbiAgICAgICAgLy92YXIgdW5pb25pZCA9ICdndWVzdF8nICsgdGhpcy5nZXRSYW5kb21BY2NvdW50KDgpO1xuICAgICAgICAvL3ZhciBuaWNrbmFtZSA9IHRoaXMuZ2V0UmFuZG9tQWNjb3VudCg4KTtcblxuXG4gICAgICAgICAvL2lmIChzZWFyY2gpIHtcbiAgICAgICAgIC8vICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoO1xuICAgICAgICAgLy8gICAgdmFyIGxvYyA9IHVybC5zdWJzdHJpbmcodXJsLmxhc3RJbmRleE9mKCc9JykgKyAxLCB1cmwubGVuZ3RoKTtcbiAgICAgICAgIC8vICAgIGlmIChsb2MgPT0gMSkge1xuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdE5pMHhOaUF3T1RvME5UbzFPU2M9JztcbiAgICAgICAgIC8vICAgICAgICB1bmlvbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvMU9TYyc7XG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XG4gICAgICAgICAvLyAgICB9XG4gICAgICAgICAvLyAgICBlbHNlIGlmIChsb2MgPT0gMikge1xuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZzVPak00T2pNekp3PT0nO1xuICAgICAgICAgLy8gICAgICAgIHVuaW9uaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWc1T2pNNE9qTXpKdyc7XG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XG4gICAgICAgICAvLyAgICB9XG4gICAgICAgICAvLyAgICBlbHNlIGlmIChsb2MgPT0gMykge1xuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdE5pMHhOaUF3T1RvME5Ub2M9JztcbiAgICAgICAgIC8vICAgICAgICB1bmlvbmlkID0gJzhkT3RBY0RpYzVTaWNodjNseHRNWFltdW5UTE9Mdic7XG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XG4gICAgICAgICAvLyAgICB9XG4gICAgICAgICAvLyAgICBlbHNlIGlmIChsb2MgPT0gNCkge1xuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdvemxYSXdndl9RSlQweWtkVWloYUFCbXNXcDJBJztcbiAgICAgICAgIC8vICAgICAgICB1bmlvbmlkID0gJ28tMzkxMXFXc1FzVzN3VW9kcUZmVXRic0FlTmsnO1xuICAgICAgICAgLy8gICAgICAgIG5pY2tuYW1lID0gbG9jO1xuICAgICAgICAgLy8gICAgfVxuICAgICAgICAgLy8gICAgZWxzZSBpZiAobG9jID09IDUpIHtcbiAgICAgICAgIC8vICAgICAgICBvcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TURvd016b3dPQ2M9JztcbiAgICAgICAgIC8vICAgICAgICAgdW5pb25pZCA9ICdvLUp6SXdNVGN2Tmk4eE5pRGt1SXJsallneE1Eb3dNJztcbiAgICAgICAgIC8vICAgICAgICBuaWNrbmFtZSA9IGxvYztcbiAgICAgICAgIC8vICAgIH1lbHNlIGlmKGxvYyA9PSA2KXtcbiAgICAgICAgIC8vICAgICAgICBvcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TU16b2M9JztcbiAgICAgICAgIC8vICAgICAgICAgdW5pb25pZCA9ICdvLXpJd01UY3ZOaTh4TmlEa3VJcmwnO1xuICAgICAgICAgLy8gICAgICAgIG5pY2tuYW1lID0gbG9jO1xuICAgICAgICAgLy8gICAgfVxuICAgICAgICAgLy9cbiAgICAgICAgIC8vfVxuICAgICAgICAvLyB2YXIgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwiJytuaWNrbmFtZSsnXCIsXCJ1bmlvbmlkXCI6XCInK3VuaW9uaWQrJ1wiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC84RDhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2VFQ1QUZNNHphcUtFdGhaaWJ2OHhkV2tnak45WWI0QVFud3ZTdXJ6MjdVQjI5eHg4MVhPUnd4NTVYYW54cWN0ZERcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xuXG5cbiAgICAgICAgIC8vaWYgKCFjYy5zeXMuaXNOYXRpdmUpe1xuICAgICAgICAgLy8gICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XG4gICAgICAgICAvLyAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAvLyAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5bey5a2Y5pyJ6LSm5Y+3PT09PT0nKTtcbiAgICAgICAgIC8vICAgICAgICAvL3JldHVybjtcbiAgICAgICAgIC8vICAgIH1lbHNlXG4gICAgICAgICAvLyAgICB7XG4gICAgICAgICAvLyAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5paw6LSm5Y+3PT09PT0nKTtcbiAgICAgICAgIC8vICAgICAgICB2YXIgdXNlckluZm8gPSB0aGlzLmdldEd1ZXN0VXNlckluZm8oKTtcbiAgICAgICAgIC8vICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKHVzZXJJbmZvKTtcbiAgICAgICAgIC8vICAgIH1cbiAgICAgICAgIC8vfVxuICAgIH0sXG5cbiAgICBnZXRPbmx5VXNlckluZm9CeUJyb3dzZXI6ZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgdmFyIG9wZW5pZCA9IFwiXCI7XG4gICAgICAgIHZhciB1bmlvbmlkID0gXCJcIjtcbiAgICAgICAgdmFyIG5pY2tuYW1lID0gXCJcIjtcblxuICAgICAgICB2YXIgdGVzdERhdGEgPSBcIlwiO1xuICAgICAgICB2YXIgdXNlckluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XG5cbiAgICAgICAgbGV0IHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG4gICAgICAgIGlmKHVzZXJJbmZvLmxlbmd0aCA+IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIG9wZW5pZCA9IHVzZXJJbmZvLm9wZW5JZDtcbiAgICAgICAgICAgIHVuaW9uaWQgPSB1c2VySW5mby51bmlvbmlkO1xuICAgICAgICAgICAgbmlja25hbWUgPSB1c2VySW5mby5uaWNrbmFtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzZWFyY2gpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoO1xuICAgICAgICAgICAgdmFyIGxvYyA9IHVybC5zdWJzdHJpbmcodXJsLmxhc3RJbmRleE9mKCc9JykgKyAxLCB1cmwubGVuZ3RoKTtcbiAgICAgICAgICAgIGlmIChsb2MgPT0gMSkge1xuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdE5pMHhOaUF3T1RvME5UbzFPU2M9JztcbiAgICAgICAgICAgICAgICB1bmlvbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvMU9TYyc7XG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzFcIjtcbiAgICAgICAgICAgICAgICB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCInK25pY2tuYW1lKydcIixcInVuaW9uaWRcIjpcIicrdW5pb25pZCsnXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsb2MgPT0gMikge1xuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZzVPak00T2pNekp3PT0nO1xuICAgICAgICAgICAgICAgIHVuaW9uaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWc1T2pNNE9qTXpKdyc7XG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzJcIjtcbiAgICAgICAgICAgICAgICB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCInK25pY2tuYW1lKydcIixcInVuaW9uaWRcIjpcIicrdW5pb25pZCsnXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsb2MgPT0gMykge1xuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdE5pMHhOaUF3T1RvME5Ub2M9JztcbiAgICAgICAgICAgICAgICB1bmlvbmlkID0gJzhkT3RBY0RpYzVTaWNodjNseHRNWFltdW5UTE9Mdic7XG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzNcIjtcbiAgICAgICAgICAgICAgICB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCInK25pY2tuYW1lKydcIixcInVuaW9uaWRcIjpcIicrdW5pb25pZCsnXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsb2MgPT0gNCkge1xuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdvemxYSXdndl9RSlQweWtkVWloYUFCbXNXcDJBJztcbiAgICAgICAgICAgICAgICB1bmlvbmlkID0gJ28tMzkxMXFXc1FzVzN3VW9kcUZmVXRic0FlTmsnO1xuICAgICAgICAgICAgICAgIG5pY2tuYW1lID0gXCJndWVzdF80XCI7XG4gICAgICAgICAgICAgICAgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwiJytuaWNrbmFtZSsnXCIsXCJ1bmlvbmlkXCI6XCInK3VuaW9uaWQrJ1wiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC84RDhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2VFQ1QUZNNHphcUtFdGhaaWJ2OHhkV2tnak45WWI0QVFud3ZTdXJ6MjdVQjI5eHg4MVhPUnd4NTVYYW54cWN0ZERcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobG9jID09IDUpIHtcbiAgICAgICAgICAgICAgICBvcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TURvd016b3dPQ2M9JztcbiAgICAgICAgICAgICAgICAgdW5pb25pZCA9ICdvLUp6SXdNVGN2Tmk4eE5pRGt1SXJsallneE1Eb3dNJztcbiAgICAgICAgICAgICAgICBuaWNrbmFtZSA9IFwiZ3Vlc3RfNVwiO1xuICAgICAgICAgICAgICAgIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcbiAgICAgICAgICAgIH1lbHNlIGlmKGxvYyA9PSA2KXtcbiAgICAgICAgICAgICAgICBvcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TU16b2M9JztcbiAgICAgICAgICAgICAgICAgdW5pb25pZCA9ICdvLXpJd01UY3ZOaTh4TmlEa3VJcmwnO1xuICAgICAgICAgICAgICAgIG5pY2tuYW1lID0gXCJndWVzdF82XCI7XG4gICAgICAgICAgICAgICAgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwiJytuaWNrbmFtZSsnXCIsXCJ1bmlvbmlkXCI6XCInK3VuaW9uaWQrJ1wiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC84RDhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2VFQ1QUZNNHphcUtFdGhaaWJ2OHhkV2tnak45WWI0QVFud3ZTdXJ6MjdVQjI5eHg4MVhPUnd4NTVYYW54cWN0ZERcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICBpZih0ZXN0RGF0YSAmJiB0ZXN0RGF0YS5sZW5ndGggPiAwKVxuICAgICAgICAge1xuICAgICAgICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyh0ZXN0RGF0YSk7XG4gICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgIH0sXG4gICAgX3JlZ2lzdGVyU29ja2V0RXZlbnQ6ZnVuY3Rpb24oKXtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUxvZ2luSm9pbiwgdGhpcy5fTG9naW5Kb2luLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVJlY29yZElkLCB0aGlzLl9SZWNlaXZlUmVjb3JkSWQsIHRoaXMpO1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlTm9VaW9uaWQsIHRoaXMuX1JlY2VpdmVOb1Vpb25pZCwgdGhpcyk7XG4gICAgfSwgXG4gICAgX2dldF9IUkVGOmZ1bmN0aW9uKHJvb21JZCl7XG4gICAgICBpZihyb29tSWQgIT0gUk9PTUlEKXtcbiAgICAgICAgUk9PTUlEID0gcm9vbUlkO1xuICAgICAgICByb29tSWQgPSBcIiUzZnJvb21JZCUzZFwiK3Jvb21JZCA7XG4gICAgICAgIFJFRElSRUNUX1VSSSA9IFJFRElSRUNUX1VSSStyb29tSWQ7XG4gICAgICAgIEhSRUYgPSBcImh0dHBzOi8vb3Blbi53ZWl4aW4ucXEuY29tL2Nvbm5lY3Qvb2F1dGgyL2F1dGhvcml6ZT9hcHBpZD1cIitBUFBJRCtcIiZyZWRpcmVjdF91cmk9XCIrUkVESVJFQ1RfVVJJK1wiJnJlc3BvbnNlX3R5cGU9Y29kZSZzY29wZT1zbnNhcGlfdXNlcmluZm8mc3RhdGU9U1RBVEUjd2VjaGF0X3JlZGlyZWN0XCI7XG4gICAgICB9XG4gICAgfSxcbiAgICBfUmVjZWl2ZU5vVWlvbmlkOmZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oXCJcIik7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB2YXIgcm9vbUlkID0gdGhpcy5nZXRRdWVyeVN0cmluZyhcInJvb21JZFwiKTtcbiAgICAgIGlmKHJvb21JZCl7XG4gICAgICAgIC8vcm9vbUlkID0gXCIlM2Zyb29tSWQlM2RcIityb29tSWQgO1xuICAgICAgICAvL1JFRElSRUNUX1VSSSA9IFJFRElSRUNUX1VSSStyb29tSWQ7XG4gICAgICAgIHRoaXMuX2dldF9IUkVGKHJvb21JZCk7XG4gICAgICB9XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIHNlbGYubG9hZGluZ05vZGUucGFyZW50LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBzZWxmLmxvYWRpbmdOb2RlLnN0b3BBbGxBY3Rpb25zKCk7XG4gICAgICB9LDIwMDApXG4gICAgICB0aGlzLl9sb2FkaW5nTGFiZWwoXCLnmbvlvZXlpLHotKXvvIzor7fph43mlrDnmbvlvZVcIik7XG4gICAgfSxcbiAgICBfUmVjZWl2ZVJlY29yZElkOmZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICBpZihkYXRhLnJlY29yZE1zZy5sZW5ndGg+MCl7XG4gICAgICAgICAgdmFyIHJlY29yZCA9IGRhdGEucmVjb3JkTXNnWzBdO1xuICAgICAgICAgIHZhciBwbGF5ZXJzSW5mbyA9IEpTT04ucGFyc2UocmVjb3JkLnBsYXllcnNJbmZvKS5wbGF5ZXJzO1xuICAgICAgICAgIHZhciByZWNvcmROb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy5yZWNvcmRJbmZvKTtcbiAgICAgICAgICBsZXQgdG90YWxHYW1lUmVzdWx0ID0gcmVjb3JkTm9kZS5nZXRDb21wb25lbnQoXCJUb3RhbEdhbWVSZXN1bHRcIik7XG4gICAgICAgICAgcGxheWVyc0luZm8uc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBiLnRvdGFsU2NvcmUtYS50b3RhbFNjb3JlfSk7ICAvLyDmjpLluo9cbiAgICAgICAgICB0b3RhbEdhbWVSZXN1bHQuc2V0UGxheWVySW5mb3MocGxheWVyc0luZm8scmVjb3JkKTtcbiAgICAgICAgICB0b3RhbEdhbWVSZXN1bHQuX2NsaWNrQnRuKCk7XG4gICAgICAgICAgcmVjb3JkTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQocmVjb3JkTm9kZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIF9Mb2dpbkpvaW46IGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgdGhpcy5fbG9hZGluZ0xhYmVsKFwi6L+b5YWl5oi/6Ze077yM5q2j5Zyo5Li65oKo6K+35rGC5pWw5o2uXCIpO1xuICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0KXtcbiAgICAgICAgICAgIGlmKGNjLmZyb20gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNjLmZyb20gPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSByZXNwb25zZS5kYXRhLm1hUGFpO1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYy5qb2luRGVzayA9IHt9O1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgICAgICAgICBsZXQgcmVhc29uSW5mbyA9IHRoaXMuX2pvaW5SZWFzb25NYXAocmVzcG9uc2UuZGF0YS5yZWFzb24pO1xuICAgICAgICAgICAgY2Muam9pbkRlc2sucmVzdWx0ID0gcmVzcG9uc2UucmVzdWx0O1xuICAgICAgICAgICAgY2Muam9pbkRlc2sucmVhc29uID0gcmVhc29uSW5mbztcbiAgICAgICAgfVxuICAgIH0sXG4gICAgX2pvaW5SZWFzb25NYXA6IGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIGxldCByZWFzb25JbmZvID0ge1xuICAgICAgICBub3RFeGlzdDogXCLmiL/pl7TkuI3lrZjlnKghXCIsXG4gICAgICAgIGNhcmROdW1iZXI6IFwi5oKo5oi/5Y2h5LiN6LazIVwiLFxuICAgICAgfTtcbiAgICAgIGxldCBpbmZvID0gcmVhc29uSW5mb1tyZWFzb25dIHx8IFwi5oi/6Ze05bey5ruhIVwiO1xuICAgICAgcmV0dXJuIGluZm87XG4gICAgfSxcblxuICAgIGdldFF1ZXJ5U3RyaW5nOiBmdW5jdGlvbihuYW1lKXtcbiAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoXnwmKVwiICsgbmFtZSArIFwiPShbXiZdKikoJnwkKVwiLCBcImlcIik7IFxuICAgICAgICB2YXIgciA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEpLm1hdGNoKHJlZyk7IFxuICAgICAgICBpZiAociAhPSBudWxsKSByZXR1cm4gdW5lc2NhcGUoclsyXSk7IHJldHVybiBudWxsOyBcbiAgICB9LFxuXG4gICAgYWdyZWVtZW50czogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmFncmVlbWVudE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgLy90aGlzLmFncmVlbWVudExhYmVsLnN0cmluZyA9IGNjLmluZm8xO1xuICAgICAgICB0aGlzLmFncmVlbWVudExhYmVsLm5vZGUueSA9IDA7XG4gICAgfSxcblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5zb2NrZXQucmVjZXZpY2VNZXNzYWdlID0gZnVuY3Rpb24gKCkge307XG4gICAgfSxcblxuICAgIF9sb2FkaW5nTGFiZWw6ZnVuY3Rpb24obGFiZWwpe1xuICAgICAgICB0aGlzLmxhYmVsLnN0cmluZyA9IGxhYmVsO1xuICAgIH0sXG5cbiAgICBzZW5kTG9naW5SZXF1ZXN0OmZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn55m75b2V5LitLi4uJyk7XG4gICAgICAgIHRoaXMubG9hZGluZ05vZGUucGFyZW50LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMubG9hZGluZ05vZGUucnVuQWN0aW9uKGNjLnJlcGVhdEZvcmV2ZXIoY2Mucm90YXRlQnkoMiwgMzYwKSkpO1xuICAgICAgICAvL3JldHVybjtcbiAgICAgICAgdGhpcy5zb2NrZXQuc2VuZE1lc3NhZ2UoJ2xvZ2luJyxkYXRhKTtcbiAgICB9LFxuXG4gICAgbG9naW5BY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIC8vdGhpcy5zaG93V2FpdGluZ01lc3NhZ2UoJ+W3suWtmOaciei0puWPtz09PT09Jyk7XG4gICAgICAgICAgICAgICAgLy9yZXR1cm47XG4gICAgICAgICAgICB9ZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vdGhpcy5zaG93V2FpdGluZ01lc3NhZ2UoJ+aWsOi0puWPtz09PT09Jyk7XG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJbmZvID0gdGhpcy5nZXRHdWVzdFVzZXJJbmZvKCk7XG4gICAgICAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyh1c2VySW5mbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgaW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcbiAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShpbmZvKTtcbiAgICAgICAgICB0aGlzLnNlbmRMb2dpblJlcXVlc3QoZGF0YSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICAgIC8vIGNjLnN5cy5vcGVuVVJMKEhSRUYpO1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBIUkVGO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eExvZ2luXCIpOy8vSU9TXG4gICAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZFxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4TG9naW5cIiwgXCIoKVZcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH0sXG5cbiAgICBjaGFuZ2VHdWVzdFVzZXJJbmZvOmZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oJycpO1xuICAgICAgICB0aGlzLmxvZ2luQWN0aW9uKCk7XG4gICAgfSxcblxuICAgIGxvZ2luWWtBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vdmFyIGNvbXAgPSB0aGlzLnNlbGVjdE5vZGUuZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcbiAgICAgICAgLy9pZiAoIWNvbXAuc2VsZWN0ZWQpIHtcbiAgICAgICAgLy8gICAgdGhpcy5zaG93TXNnID0gY2MuaW5zdGFudGlhdGUodGhpcy5hbGVydFByZWZhYik7XG4gICAgICAgIC8vICAgIHRoaXMuY2FudmFzTm9kZS5hZGRDaGlsZCh0aGlzLnNob3dNc2cpO1xuICAgICAgICAvLyAgICBsZXQgY29tcCA9IHRoaXMuc2hvd01zZy5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIC8vICAgIGNvbXAuc2V0TWVzc2FnZSgn6K+35ZCM5oSP55So5oi35Y2P6K6uJyk7XG4gICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgLy99XG4gICAgICAgIHZhciB0ZXN0RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHZhciB0aW1lID0gXCInXCIrdGVzdERhdGUudG9Mb2NhbGVTdHJpbmcoKStcIidcIjtcbiAgICAgICAgdmFyIG9wZW5pZCA9IG5ldyBCdWZmZXIodGltZSkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICAgICAgICB2YXIgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwi5ri45a6iXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcL0JWeXo0UjhxNnB1SmliRXYxaHJzYVRtSUtRaGthVFM5Rnl2Y2V2dkM1aGx4Rm5mT3VzcERqaWNHMEd0enlKWE9oTlQ3ZzFXWkRlQ0RRaG5SZEVPZ3ozUU1uUDBGOWlib1FHeVxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZSh0ZXN0RGF0YSk7XG4gICAgICAgIHRoaXMuc2VuZExvZ2luUmVxdWVzdChkYXRhKTtcblxuICAgIH0sXG5cbiAgICBzaG93V2FpdGluZ01lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIGlmICh0aGlzLndhaXRpbmdOb2RlICE9IG51bGwgJiYgY2Muc3lzLmlzTmF0aXZlICYmIGNjLmlzVmFsaWQodGhpcy53YWl0aW5nTm9kZSkpIHtcbiAgICAgICAgICBpZiAobXNnID09IHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmdldE1lc3NhZ2UoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUucmVtb3ZlRnJvbVBhcmVudCgpO1xuICAgICAgICAgICAgdGhpcy53YWl0aW5nTm9kZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53YWl0aW5nTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XG4gICAgICAgIHRoaXMuY2FudmFzTm9kZS5hZGRDaGlsZCh0aGlzLndhaXRpbmdOb2RlKTtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLndhaXRpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjb21wKTtcblxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICBoaWRkZW5XYWl0aW5nTWVzc2FnZTpmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy53YWl0aW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHByb3RvY29sQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICBjYy5sb2coJ3Byb3RvY29sIGFjdGlvbicpO1xuICAgIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbWFQYWlTcHJpdGU6W2NjLlNwcml0ZUZyYW1lXSxcclxuICAgICAgICBzcHJpdGVOb2RlOmNjLlNwcml0ZSxcclxuICAgICAgICBsYWJlbE5vZGU6Y2MuTm9kZVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICBcclxufSk7XHJcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xuICAgIHZlcnNpb246J3YxLjAuMCcsXG5cbiAgICBzZXRVc2VySW5mbzpmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyaW5mbycsIHN0cik7XG4gICAgfSxcblxuICAgIGdldFVzZXJJbmZvOmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJpbmZvJyk7XG4gICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuXG4gICAgc2V0TXVzaWNWYWx1ZTpmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ211c2ljVm9sdW1uJyx2YWx1ZSk7XG4gICAgfSxcblxuICAgIGdldE11c2ljVmFsdWU6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbXVzaWNWb2x1bW4nKTtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBzZXRNdXNpY0VmZmVjdFZhbHVlOmZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbXVzaWNFZmZlY3RWb2x1bW4nLHZhbHVlKTtcbiAgICB9LFxuXG4gICAgZ2V0TXVzaWNFZmZlY3RWYWx1ZTpmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdtdXNpY0VmZmVjdFZvbHVtbicpO1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbn07XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBub2RlczpbY2MuTm9kZV0sXG4gICAgICAgIC8vc2VsZWN0ZWRJbmRleDogMCxcbiAgICAgICAgIF9zZWxlY3RlZDoxLFxuICAgIH0sXG5cbiAgICAvKiMjIyMqL1xuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3NlbGVjdCA9IHRydWU7IFxuICAgICAgICB2YXIgb3ZlclRpbWUgPSAwO1xuICAgICAgICBpZihjYy5zZXQpe1xuICAgICAgICAgICAgb3ZlclRpbWUgPSBjYy5zZXQuc2V0dGluZzY7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RlZCA9IHRoaXMuX3NlbGVjdCA9IG92ZXJUaW1lO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhY3RpdmUgPSB0aGlzLl9zZWxlY3Q7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RlZCA9IHRoaXMuX3NlbGVjdDtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKS5zZXRTZWxlY3RlZChhY3RpdmUpO1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gdGhpcy5ub2Rlc1tpXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcbiAgICAgICAgICAgIGlmKCBzZWxmLl9zZWxlY3QgKXtcbiAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRDb21wID0gdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgdENvbXAuaW5kZXggPSBpO1xuICAgICAgICAgICAgdENvbXAuY2xpY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKCBzZWxmLl9zZWxlY3RlZCA9IHNlbGYuX3NlbGVjdCA9ICFzZWxmLl9zZWxlY3QgKTtcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0aXRsZVwiKTtcbiAgICAgICAgICAgICAgICBpZiggc2VsZi5fc2VsZWN0ICl7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYub25TZWxlY3RDaGFuZ2UodGhpcy5pbmRleCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJvcmRlcnNcIiAmJiBjYy5zZXQpe1xuICAgICAgICAgICAgLy90aGlzLnJlbWVtYmVyX3NldChvdmVyVGltZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHJlbWVtYmVyX3NldDpmdW5jdGlvbihvYmope1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jykuc2V0U2VsZWN0ZWQob2JqKTtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJykuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgaWYoIG9iaiApe1xuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMubm9kZXNbMF0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XG4gICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25TZWxlY3RDaGFuZ2U6IGZ1bmN0aW9uIChzZWxlY3RJbmRleCkge1xuICAgICAgICAvL2NjLmxvZyhzZWxlY3RJbmRleCk7XG4gICAgfSxcbiAgICBcbn0pO1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XHJcbmNvbnN0IEFycmF5RXh0ZW5zaW9uID0gcmVxdWlyZSgnQXJyYXlFeHRlbnNpb24nKTtcclxuY29uc3QgTWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcclxuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XHJcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcclxuY29uc3QgVXNlck1vZGVsSGVscGVyID0gcmVxdWlyZSgnVXNlck1vZGVsSGVscGVyJyk7XHJcbmNvbnN0IFBsYXliYWNrID0gcmVxdWlyZSgnUGxheWJhY2snKTtcclxuY29uc3QgZmVjaGEgPSByZXF1aXJlKCdmZWNoYScpO1xyXG52YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcclxuLyojIyMjIyovXHJcbmNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xyXG4vKiovXHJcbmNvbnN0IFBsYXllciA9IHJlcXVpcmUoJ1BsYXllcicpO1xyXG4vKiovXHJcbi8vY29uc3QgaXNUZVNodVBhaSA9IHJlcXVpcmUoJ2lzVGVTaHVQYWknKTsgXHJcbi8v54m55q6K54mM57G75Z6LXHJcbnZhciBURVNIVVBBSVRZUEUgPSB7XHJcbiAgICBpc1RlU2h1UGFpOmZhbHNlLFxyXG4gICAgaXNMaXVEdWlCYW46ZmFsc2UsXHJcbiAgICBpc1NhblNodW5aaTpmYWxzZSxcclxuICAgIGlzU2FuVGFvSHVhOmZhbHNlLFxyXG5cclxuICAgIGlzUWluZ0xvbmc6ZmFsc2UsXHJcbiAgICBpc1lpVGlhb0xvbmc6ZmFsc2UsXHJcbiAgICBpc1NhblRvbmdIdWFTaHVuOmZhbHNlLFxyXG4gICAgaXNTYW5GZW5UaWFuWGlhOmZhbHNlLFxyXG4gICAgaXNDb3VZaVNlOmZhbHNlLFxyXG4gICAgaXNTaVRhb1NhblRpYW86ZmFsc2UsXHJcbiAgICBpc1d1RHVpU2FuVGlhbzpmYWxzZVxyXG59O1xyXG5cclxubGV0IEdBTUVTVEFUVVMgPSB7XHJcbiAgICBXQUlUX1BFT1BMRTogMCwgICAgLy8g562J5Lq6XHJcbiAgICBXQUlUX1JFQURZOiAxLCAgICAgLy8g562J5b6F5LuW5Lq65YeG5aSHXHJcbiAgICBQTEFZSU5HOiAyLCAgICAgICAgLy8g5q2j5Zyo546p5ri45oiPXHJcbn07XHJcbnZhciBzVGl0bGUgPSAnJztcclxudmFyIHNEZXNjcmlwdGlvbiA9ICcnO1xyXG52YXIgc0lkID0gJyc7XHJcbi8vIOW4g+WxgFxyXG4vLyAgICAgICAgICAyXHJcbi8vICAgMyAgICAgICAgICAgIDFcclxuLy8gICAgIHNlbGYgMFxyXG5sZXQgUGxheSA9IGNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgcGxheWVyTm9kZXM6IFtjYy5Ob2RlXSxcclxuICAgICAgICAvL3BsYXlzQ29pbnM6IFtjYy5Ob2RlXSxcclxuICAgICAgICBjaGF0Tm9kZTogY2MuTm9kZSxcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmVOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIHR5cGVCdXR0b25zTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBwaG9uZTpjYy5MYWJlbCxcclxuICAgICAgICBsYWJlbFJvb21OdW1iZXI6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxhYmVsT3ZlcnZpZXc6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxhYmVsUmVtYWluVGltZTogY2MuTGFiZWwsXHJcbiAgICAgICAgYnRuU2hhcmU6IGNjLkJ1dHRvbixcclxuICAgICAgICBidG5SZWFkeTogY2MuQnV0dG9uLCAgICAgICAgICAgIC8vIOWHhuWkh+aMiemSrlxyXG4gICAgICAgIGJ0blN0YXJ0R2FtZTogY2MuQnV0dG9uLCAgICAgICAgLy8g5byA5aeL5oyJ6ZKuXHJcbiAgICAgICAgYmVpbHY6Y2MuTm9kZSwgICAgICAgICAgICAgICAgICAvLyDpgInmi6nlgI3njofoioLngrlcclxuICAgICAgICBidG5DaGF0Vm9pY2U6IGNjLkJ1dHRvbixcclxuICAgICAgICBidG5DaGF0VGV4dDogY2MuQnV0dG9uLFxyXG4gICAgICAgIGFnYWluQnRuOmNjLk5vZGUsXHJcblxyXG4gICAgICAgIHN0YXJ0Q29tcGFyZUNhcmRzTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBzZXR0aW5nTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBWb2ljZU1zZ0JnOmNjLk5vZGUsXHJcbiAgICAgICAgZXhpdDpjYy5Ob2RlLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDnprvlvIDmiL/pl7ToioLngrlcclxuICAgICAgICBEaXNzb2x2ZTpjYy5Ob2RlLCAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOino+aVo+aIv+mXtOiKgueCuVxyXG4gICAgICAgIHNoYXJlQmc6Y2MuTm9kZSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5YiG5Lqr6IOM5pmvXHJcbiAgICAgICAgdG90YWxHYW1lUmVzdWx0OiBjYy5Ob2RlLCAgICAgICAgICAgICAgICAgICAvLyDnu5PmnpzoioLngrlcclxuICAgICAgICBhbGVydFJlcXVlc3RFeGl0Tm9kZTogY2MuTm9kZSwgICAgICAgICAgICAgIC8vIOeUs+ivt+mAgOWHuiBOb2RlXHJcbiAgICAgICAgZGlzc29sdmVBbHRlcjogY2MuTm9kZSwgICAgICAgICAgICAgICAgICAgICAvLyDnlLPor7fpgIDlh7ogTm9kZVxyXG4gICAgICAgIGFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlOiBjYy5Ob2RlLCAgICAgLy8g55Sz6K+36YCA5Ye65YCS6K6h5pe2IE5vZGVcclxuICAgICAgICBhbGVydEFuc293ZXJFeGl0Tm9kZTogY2MuTm9kZSwgICAgICAgICAgICAgIC8vIOWbnuetlOeUs+ivt+mAgOWHuiAgTm9kZVxyXG4gICAgICAgIGNvbnRlbnRBbnNvd2VyRXhpdE5vZGU6IGNjLk5vZGUsICAgICAgICAgICAgLy8g5Zue562U55Sz6K+36YCA5Ye65aS05YOPICBOb2RlXHJcbiAgICAgICAgYWxlcnRBbnNvd2VyRXhpdFJlc3VsdDogY2MuTm9kZSwgICAgICAgICAgICAvLyDlm57nrZTnlLPor7fpgIDlh7rnu5PmnpwgIE5vZGVcclxuICAgICAgICBhbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZTogY2MuTm9kZSwgICAgIC8vIOWbnuetlOS7peS4iuivt+mAgOWHuueahOWAkuiuoeaXtlxyXG4gICAgICAgIENvdW50ZG93bjpjYy5Ob2RlLCAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5YCS6K6h5pe2XHJcbiAgICAgICAgbGFiZWxUaW1lOmNjLkxhYmVsLFxyXG4gICAgICAgIG5lZWRDYXJkOmNjLkxhYmVsLFxyXG4gICAgICAgIGFsZXJ0OiBjYy5Ob2RlLFxyXG4gICAgICAgIGNvaW5zQ29udGFpbmVyTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBidG5BbGVydFJlcXVlc3RFeGl0Q29uZmlybUJ1dHRvbjogY2MuQnV0dG9uLFxyXG4gICAgICAgIGJ0bkFsZXJ0UmVxdWVzdEV4aXRDYW5jZWxCdXR0b246IGNjLkJ1dHRvbixcclxuXHJcbiAgICAgICAgYXV0b1Rpc2hpOmNjLlByZWZhYixcclxuICAgICAgICB3YWl0aW5nUHJlZmFiOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgY29pbnNQcmVmYWI6IGNjLlByZWZhYixcclxuICAgICAgICBwbGF5ZXJDb21wczogW1BsYXllcl0sXHJcblxyXG4gICAgICAgIGdvbmdYaU5pOmNjLk5vZGUsXHJcbiAgICAgICAgdGVTaHVQYWk6Y2MuTm9kZSxcclxuXHJcbiAgICAgICAgY2FyZFNwcml0ZUF0bGFzOmNjLlNwcml0ZUF0bGFzLFxyXG4gICAgICAgIGRhb1Nwcml0ZUF0bGFzOmNjLlNwcml0ZUF0bGFzLFxyXG5cclxuICAgICAgICBfbGl1RHVpQmFuOmZhbHNlLFxyXG4gICAgICAgIF9zYW5TaHVuWmk6ZmFsc2UsXHJcbiAgICAgICAgX3NhblRvbmdIdWE6ZmFsc2UsXHJcbiAgICAgICAgX3lpVGlhb0xvbmc6ZmFsc2UsXHJcblxyXG4gICAgICAgIF9RaW5nTG9uZzpmYWxzZSxcclxuICAgICAgICBfU2FuVG9uZ0h1YVNodW46ZmFsc2UsXHJcbiAgICAgICAgX1NhbkZlblRpYW5YaWE6ZmFsc2UsXHJcbiAgICAgICAgX0NvdVlpU2U6ZmFsc2UsXHJcbiAgICAgICAgX1NpVGFvU2FuVGlhbzpmYWxzZSxcclxuICAgICAgICBfV3VEdWlTYW5UaWFvOmZhbHNlLFxyXG5cclxuICAgICAgICBfcGxheWVyQ29tcG9uZW50czogbnVsbCxcclxuICAgICAgICBfbXNnQ29udHJvbDogbnVsbCxcclxuICAgICAgICBfbm93VGltZUFnYWluOjAsXHJcblxyXG4gICAgICAgIF9zb2NrZXQ6IG51bGwsXHJcbiAgICAgICAgX3VzZXJJZDogMCxcclxuICAgICAgICBfcGxheWVySW5mb3M6IG51bGwsXHJcbiAgICAgICAgX2Rlc2tJbmZvOiBudWxsLCAgIC8vIGNyZWF0ZVRpbWUg5Yib5bu65pe26Ze0ICBpc0Rpc3NvbHZpbmcg6KGo56S65piv5ZCm5q2j5Zyo6Kej5pWjIGRpc3NvbHZlTGVmdFRpbWUg56a76Kej5pWj5Ymp5L2Z5aSa6ZW/5pe26Ze0IGRpc3NvbHZlQW5zd2VySW5mbyBb5aSE55CG6L+H55qE5Lq655qE5L+h5oGvXVxyXG4gICAgICAgIF9nYW1lU3RhdHVzOiBHQU1FU1RBVFVTLldBSVRfUEVPUExFLFxyXG4gICAgICAgIF9lbnRlclRpbWU6IG51bGwsXHJcbiAgICAgICAgX2JpZ1JlY29yZEluZm86bnVsbCxcclxuICAgICAgICBfcGxheWVyczpudWxsLFxyXG4gICAgICAgIC8qKi9cclxuICAgICAgICBfaXNDb21wYXJpbmdDYXJkc05vdzogZmFsc2UsIC8vIOaYr+WQpuato+WcqOavlOeJjFxyXG4gICAgICAgIF9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHM6IFtdLCAvLyDlt7Lnu4/mkq3mlL7ov4fmr5TniYznmoTlsYDmlbBcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgZmFwYWlOb2RlOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgbGl1ZHVpYmFuOmNjLlByZWZhYixcclxuICAgICAgICBzYW50b25naHVhOmNjLlByZWZhYixcclxuICAgICAgICBzYW5zaHVuemk6Y2MuUHJlZmFiLFxyXG4gICAgICAgIHF1YW5sZWlkYTpjYy5QcmVmYWIsXHJcbiAgICB9LFxyXG4gICAga2V5QmFja0xpc3RlbjpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX0RPV04sZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT0gY2MuS0VZLmJhY2spIHtcclxuICAgICAgICAgICAgICAgIGlmKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKXtcclxuICAgICAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiYmFja1RvRGVza1wiLCBcIigpVlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sdGhpcyk7XHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmtleUJhY2tMaXN0ZW4oKTtcclxuICAgICAgICB0aGlzLmhlYWRDYXJkVGltZSA9IDAuODU7XHJcbiAgICAgICAgdmFyIGJnID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicm9vbV9iZ1wiKTtcclxuICAgICAgICB2YXIgd2luZG93UCA9IGNjLmRpcmVjdG9yLmdldFdpblNpemVJblBpeGVscygpO1xyXG4gICAgICAgIHZhciBzY2FsZVggPSB3aW5kb3dQLndpZHRoL2JnLndpZHRoO1xyXG4gICAgICAgIHZhciBzY2FsZVkgPSB3aW5kb3dQLmhlaWdodC9iZy5oZWlnaHQ7XHJcbiAgICAgICAgdmFyIHNjYWxlID0gTWF0aC5tYXgoc2NhbGVYLHNjYWxlWSk7XHJcbiAgICAgICAgYmcuc2NhbGVYID0gc2NhbGU7XHJcbiAgICAgICAgYmcuc2NhbGVZID0gc2NhbGU7XHJcblxyXG4gICAgICAgIHRoaXMuQnRuQ2xpY2tHb25nWGlOaUNvbWZpcm0gPSB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuZ2V0Q29tcG9uZW50KFwiQ2FyZFR5cGVDb21iaW5lXCIpLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtO1xyXG4gICAgICAgIHRoaXMuX2VudGVyVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMucGxheWVyQ29tcHMuZm9yRWFjaChwbGF5ZXJDb21wID0+IHtcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMgPSB0aGlzLl9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHM7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIC8qQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlEZXNrTXVzaWMoKTsqL1xyXG5cclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2Uuc3RvcEhhbGxNdXNpYygpO1xyXG4gICAgICAgIHZhciBiZ1NvdW5kID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdTb3VuZFwiKTtcclxuICAgICAgICBpZihiZ1NvdW5kID09IDApe1xyXG4gICAgICAgICAgICB2YXIgYXVkaW9NYW5hZ2VyID0gY2MuZmluZCgnQXVkaW9NYW5hZ2VyJyk7XHJcbiAgICAgICAgICAgIGF1ZGlvTWFuYWdlciA9IGF1ZGlvTWFuYWdlci5nZXRDb21wb25lbnQoJ0F1ZGlvTWFuYWdlcicpO1xyXG4gICAgICAgICAgICBhdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bShiZ1NvdW5kKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX2luaXRQbGF5ZXJDb21wb25lbnRzKCk7XHJcbiAgICAgICAgdGhpcy5faW5pdFNlbGVjdENhcmROb2RlKCk7XHJcbiAgICAgICAgdGhpcy5faW5pdE9uZUdhbWVSZXN1bHQoKTtcclxuICAgICAgICB0aGlzLl9yZW1haW5UaW1lU3RhcnRVcGRhdGUoKTtcclxuXHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuX21zZ0NvbnRyb2wgPSB0aGlzLmNoYXROb2RlLmdldENvbXBvbmVudCgnTXNnQ29udHJvbCcpO1xyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcclxuICAgICAgICB0aGlzLmJlaWx2LmdldENvbXBvbmVudChcInNlbGVjdGJlaWx2XCIpLl91c2VyaWQgPSB0aGlzLl91c2VySWQ7XHJcbiAgICAgICAgLy90aGlzLnNldHRpbmdOb2RlLmdldENvbXBvbmVudChcIlNldHRpbmdcIikuaGlkZVN3aXRjaCgpO1xyXG4gICAgICAgIHRoaXMubGFiZWxSb29tTnVtYmVyLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJWb2ljZU5vZGVFdmVudHMoKTtcclxuICAgICAgICB0aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XHJcblxyXG4gICAgICAgIFBsYXkuaW5zdGFuY2VzID0gdGhpcztcclxuICAgICAgICB0aGlzLl9nb25nWGlOaVNob3coZmFsc2UpO1xyXG4gICAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc0NvbnRhaW5QbGF5YmFja0RhdGFzKCkpIHtcclxuICAgICAgICAgICAgUGxheWJhY2suaW5zdGFuY2Uuc3RhcnRQbGF5YmFjaygpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXliYWNrTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmJ0bkNoYXRWb2ljZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL3RoaXMuY2FyZHNGcm9tQXJyYXkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9sb2FkRGVza0luZm8oKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB0aGlzLl9zb2NrZXQgPSBTb2NrZXQuaW5zdGFuY2U7XHJcblxyXG5cclxuICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ2hhbGwnLGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLnByZWxvYWRTY2VuZSgnbG9naW4nKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY2MuY2xpY2tPdXQgPSBmYWxzZTtcclxuICAgICAgICAvL3RoaXMudGltZVN0YXJ0KDUpO1xyXG4gICAgfSxcclxuXHJcbiAgICB0aW1lU3RhcnQ6IGZ1bmN0aW9uIChkdXJhdGlvbixhY3Rpb24pIHtcclxuICAgICAgICBjYy5hc3NlcnQoZHVyYXRpb24gPiAwKTtcclxuICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XHJcbiAgICAgICAgdGhpcy5Db3VudGRvd24uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBpZihhY3Rpb24gIT0gXCJyZWFkeVwiKXtcclxuICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInRpbWVzdGFtcFwiKTsgIC8vIOiOt+WPluacrOWcsOWtmOWCqOeahOaXtumXtOaIs1xyXG4gICAgICAgICAgICBpZih0aW1lc3RhbXApeyAgLy8g5aaC5p6c5pyJ5YiZ6K+B5piO546p5a625piv6YeN5paw6L+b5p2l5LqG55qEXHJcbiAgICAgICAgICAgICAgICB2YXIgbm93ID0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTtcclxuICAgICAgICAgICAgICAgIHZhciB0aW1lID0gZHVyYXRpb24qMTAwMDtcclxuICAgICAgICAgICAgICAgIGlmKG5vdyAtIHRpbWVzdGFtcCA+IHRpbWUpeyAvLyDotoXml7ZcclxuICAgICAgICAgICAgICAgICAgICBpZihub3cgLSB0aW1lc3RhbXAgPCAyKnRpbWUpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IDU7ICAvLyDnjqnlrrblj6/og73lh7rkuo7lhbbku5bljp/lm6DpgIDlh7rmuLjmiI/lr7zoh7TotoXml7bvvIzkuLrlhbbmj5Dkvps156eS5pe26Ze05pW055CG54mM5Z6L77yI6L+Z5bey57uP5piv5b6I5LuB5oWI55qE5LqG77yJ44CCXHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRpbWVzdGFtcFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IE1hdGguZmxvb3IoIGR1cmF0aW9uIC0gKG5vdyAtIHRpbWVzdGFtcCkvMTAwMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1lbHNleyAgLy8g5aaC5p6c5rKh5pyJ5pe26Ze05oiz77yM5YiZ5L+d5a2Y77yM5Li6546p5a626YCA5Ye65ri45oiP5L+d55WZ6K+B5o2u77ybXHJcbiAgICAgICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTsgICAgIFxyXG4gICAgICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0aW1lc3RhbXAnLHRpbWVzdGFtcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uID0gZHVyYXRpb247XHJcbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gU3RyaW5nKGR1cmF0aW9uKTtcclxuICAgICAgICB0aGlzLkNvdW50ZG93bi5nZXRDb21wb25lbnQoXCJ0aW1lXCIpLnNldFRpbWUoZHVyYXRpb24gKiAwLjUpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgc2VsZi5fdGltZU1ldGhvZChhY3Rpb24pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5jYWxsYmFjaywgMSwgZHVyYXRpb24pO1xyXG4gICAgfSxcclxuXHJcbiAgICB0aW1lU3RvcDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLmNhbGxiYWNrKTtcclxuICAgICAgICB0aGlzLkNvdW50ZG93bi5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgX3RpbWVNZXRob2Q6IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICB0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gPSB0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gLSAxO1xyXG5cclxuICAgICAgICB2YXIgcmVtYWluID0gTWF0aC5tYXgodGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uLCAwKTtcclxuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSAocmVtYWluIDwgMTAgJiYgcmVtYWluID4gMCkgPyAoJzAnICsgcmVtYWluKSA6IHJlbWFpbjtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA8PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICAgICAgaWYoYWN0aW9uID09IFwicmVhZHlcIil7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jSW5kZXg+MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGlja1JlYWR5KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwidGltZXN0YW1wXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgX2dsb2JhbE1zZzpmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAvL2lmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgIHZhciByb29tSWQgPSBkYXRhLnJvb21JZDtcclxuICAgICAgICB2YXIgd2YgPSBkYXRhLnNldHRpbmczOyAgLy8vW+eWr+eLguWcuizprLzniYws5q+U6Iqx6ImyLOWdkOW6hCzpqazniYxdXHJcbiAgICAgICAgdmFyIHJvb20gPSBcIuaIv+WPt++8mlwiK3Jvb21JZDtcclxuICAgICAgICB2YXIgZmsgPSB3ZlswXT9cIueWr+eLguWcuiBcIjpcIuaZrumAmuWcuiBcIjsgICAgICAgICAvLyDnlq/ni4LlnLpcclxuICAgICAgICB2YXIgZ3AgPSB3ZlsxXT9cIumsvOeJjCBcIjpcIuaXoOmsvCBcIjsgICAgICAgICAgICAgLy8g6ay854mMXHJcbiAgICAgICAgdmFyIGhzID0gd2ZbMl0/XCLmr5ToirHoibIgXCI6XCLkuI3mr5ToirHoibIgXCI7ICAgICAgIC8vIOavlOiKseiJslxyXG4gICAgICAgIHZhciB6aiA9IHdmWzNdP1wi5Z2Q5bqEIFwiOlwi5LiN5Z2Q5bqEIFwiOyAgICAgICAgICAgLy8g5bqE5a62XHJcbiAgICAgICAgdmFyIG1wID0gd2ZbNF0/XCLkubDpqawgXCI6XCLkuI3kubDpqawgXCI7ICAgICAgICAgICAvLyDpqazniYxcclxuICAgICAgICB2YXIgc2YgPSBcIuaIv+i0uTpcIisoZGF0YS5zZXR0aW5nND8oKGRhdGEuc2V0dGluZzQ9PTEpP1wi6LWi6ICF5omjIFwiOlwi5oi/5Li75omjIFwiKTpcIuW5s+aRiiBcIik7ICAvL+aUtui0uVxyXG4gICAgICAgIHZhciBzaGFyZVRpdGxlID0gcm9vbStcIiDmqKHlvI86XCIremorc2Y7XHJcblxyXG4gICAgICAgIHZhciBwaiA9IFtcIjXlsYAgXCIsXCIxMOWxgCBcIixcIjIw5bGAIFwiXTsgIC8v54mM5bGAXHJcbiAgICAgICAgdmFyIGRzID0gW1wiNOS6uuS4jeWKoOiJsiBcIixcIjXkurrliqDkuIDoibIgXCIsXCI25Lq65LqM6ImyIFwiLFwiN+S6uuWKoOS4ieiJsiBcIl07ICAvL+WkmuiJslxyXG4gICAgICAgIHZhciBycyA9IGRzW2RhdGEuc2V0dGluZzJdK1wiXCI7XHJcbiAgICAgICAgdmFyIGpzID0gcGpbZGF0YS5zZXR0aW5nMS0yXTtcclxuICAgICAgICB2YXIgZGVzYyA9ICdb5aSn5LyX5Y2B5LiJ5rC0XSAnK3pqK2ZrK21wK2dwK3NmK3JzK2pzK1wiIOeCueWHu+ebtOaOpei/m+WFpeaIv+mXtFwiO1xyXG5cclxuICAgICAgICBzVGl0bGUgPSBzaGFyZVRpdGxlO1xyXG4gICAgICAgIHNEZXNjcmlwdGlvbiA9IGRlc2M7XHJcbiAgICAgICAgc0lkID0gJ3Jvb21JZD0nK3Jvb21JZDtcclxuXHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdyb29tSWQnLHJvb21JZCk7XHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzaGFyZVRpdGxlJyxzaGFyZVRpdGxlKTtcclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Rlc2MnLGRlc2MpO1xyXG5cclxuICAgICAgICBpZihjYy5zeXMuaXNCcm93c2VyKSB7XHJcbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvVGltZUxpbmUpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvVGltZUxpbmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1Nlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvU2Vzc2lvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vfVxyXG4gICAgfSxcclxuXHJcblxyXG5cclxuICAgIC8qIyMjIyMqL1xyXG4gICAgLyrmmL7npLrpqazniYwqL1xyXG4gICAgX2luaXRNYVBhaTpmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdFBsYXllckNvbXBvbmVudHM6IGZ1bmN0aW9uIChwbGF5ZXJJbmRleCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMgPSB0aGlzLnBsYXllck5vZGVzLm1hcChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRDb21wb25lbnQoJ1BsYXllcicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZighcGxheWVySW5kZXgpIHtcclxuICAgICAgICAgICAgcGxheWVySW5kZXggPSBbMCwxLDIsMyw0LDVdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGEgPSB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLnNwbGljZSgxLDcpO1xyXG5cclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgcGxheWVySW5kZXgubGVuZ3RoIC0gMTsgaSsrKXtcclxuICAgICAgICAgICAgdmFyIGluZGV4MSA9IHBsYXllckluZGV4W2ldO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXgyID0gcGxheWVySW5kZXhbaSArIDFdO1xyXG4gICAgICAgICAgICB2YXIgdG1wID0gbnVsbDtcclxuICAgICAgICAgICAgdG1wID0gYVtpbmRleDFdO1xyXG4gICAgICAgICAgICBhW2luZGV4MV0gPSBhW2luZGV4Ml07XHJcbiAgICAgICAgICAgIGFbaW5kZXgyXSA9IHRtcCA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhLmZvckVhY2goZnVuY3Rpb24obm9kZSl7dGhpcy5fcGxheWVyQ29tcG9uZW50cy5wdXNoKG5vZGUpO30uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIGlmKHRoaXMucGxheXNDb2lucyAmJiB0aGlzLnBsYXlzQ29pbnMubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgIHRoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe1xyXG4gICAgICAgICAgICAgICAgbm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGxheXNDb2lucyA9IFtdO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheXMsaSl7XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gXCJjb2luc1wiICsgaTtcclxuXHJcbiAgICAgICAgICAgIHZhciBub2RlID0gbmV3IGNjLk5vZGUoKTtcclxuXHJcbiAgICAgICAgICAgIG5vZGUubmFtZSA9IG5hbWU7XHJcblxyXG4gICAgICAgICAgICBub2RlLnggPSBwbGF5cy5ub2RlLng7XHJcblxyXG4gICAgICAgICAgICBub2RlLnkgPSBwbGF5cy5ub2RlLnk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQobm9kZSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBsYXlzQ29pbnMucHVzaChub2RlKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9pbml0U2VsZWN0Q2FyZE5vZGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgbGV0IGNhcmRUeXBlQ29tYmluZUNvbXAgPSB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZUNvbWJpbmUnKTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmVDb21wLnNldEZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2soZnVuY3Rpb24gKHNlcnZlckNhcmRzSW5mbykge1xyXG4gICAgICAgICAgICBjYXJkVHlwZUNvbWJpbmVDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kUGxheUNhcmQoc2VsZi5fdXNlcklkLCBzZXJ2ZXJDYXJkc0luZm8pO1xyXG4gICAgICAgICAgICBzZWxmLmNhcmRUeXBlQ29tYmluZU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKi9cclxuICAgIF9pbml0T25lR2FtZVJlc3VsdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIC8vIHRoaXMub25lR2FtZVJlc3VsdC5zZXRDbG9zZUNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vICAgICBpZiAoc2VsZi5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICAvLyAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gfTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub2ZmVGFyZ2V0KHRoaXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0xlYXZlRGVzazpmdW5jdGlvbigpeyAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g54K55Ye756a75byA5qGM5a2QXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7ICAgICAgICAgICAgICAgLy8g6L+Y5rKh5byA5aeL5Y+v5Lul6YCA5Ye65oi/6Ze0XHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHRoaXMuX3VzZXJJZCl7XHJcbiAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBTb2NrZXQuc2VuZExlYXZlRGVzayh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsaWNrRGlzc29sdmVEZXNrIDpmdW5jdGlvbigpeyAgICAgICAgICAgICAgICAgICAgICAvLyDngrnlh7vop6PmlaPmoYzlrZBcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpeyAgICAvLyDlj6rmnInmiL/kuLvmiY3og73op6PmlaPmoYzlrZBcclxuICAgICAgICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q29uZmlybUJ1dHRvbi5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGxldCBhbGVydCA9IHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgICAgICBhbGVydC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgICAgIGFsZXJ0LnNldE1lc3NhZ2UoXCLmmK/lkKbopoHop6PmlaPmiL/pl7RcIik7XHJcbiAgICAgICAgICAgIGFsZXJ0LmFsZXJ0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0V4aXRPdXQ6ZnVuY3Rpb24oKXtcclxuICAgICAgICBTb2NrZXQuc2VuZERpc3NvbHZlRGVzayh0aGlzLl91c2VySWQpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+ino+aVo+mAgOWHuuaIv+mXtFxyXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvICYmIHRoaXMuX2Rlc2tJbmZvLmlzRGVza092ZXIpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93KSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlpoLmnpzmiL/pl7Tlt7Lnu5PmnZ/vvIzlubbkuJTkuI3mmK/mraPlnKjmkq3mlL7miZPniYzliqjnlLssIOWImeebtOaOpeemu+W8gOaIv+mXtFxyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICAgICAgLy9pZiAodGhpcy5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICAvLyAgICB0aGlzLmFsZXJ0Rm9yY2VFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcclxuICAgICAgICAvLyAgICByZXR1cm47XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBhbGVydDEgPSB0aGlzLmRpc3NvbHZlQWx0ZXIuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgICAgICAgICAgYWxlcnQxLmFsZXJ0KCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBTb2NrZXQuc2VuZExlYXZlRGVzayh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDb25maXJtQnV0dG9uLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgYWxlcnQudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIGFsZXJ0LnNldE1lc3NhZ2UoXCLmmK/lkKbop6PmlaPmiL/pl7TvvJ9cIik7XHJcbiAgICAgICAgYWxlcnQuYWxlcnQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0b3AoKTtcclxuICAgIH0sXHJcbiAgICAvL+S4jeino+aVo+mAgOWHuuaIv+mXtFxyXG4gICAgY2xpY2tPdXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDApIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgY2MuY2xpY2tPdXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBTb2NrZXQuc2VuZExlYXZlRGVzayh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tTaGFyZUJnOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgY2MuZmluZChcIkNhbnZhcy9zaGFyZUJnXCIpLmFjdGl2ZSA9IGZhbHNlOyBcclxuICAgICAgICB0aGlzLnNoYXJlQmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgIGd1YW56aHU6ZnVuY3Rpb24oKXtcclxuICAgICAgICAvLyB2YXIgdXJsID0gXCJodHRwOi8vd3d3LmhvbmdnZWZlbmcuY24vZ3poL2luZGV4Lmh0bWxcIjtcclxuICAgICAgICAvLyBjYy5zeXMub3BlblVSTCh1cmwpXHJcbiAgICB9LFxyXG4gICAgcmVjb3JkU2hhcmU6ZnVuY3Rpb24oKXtcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5yZWNvcmRJZCl7XHJcbiAgICAgICAgICAgIHZhciBzaGFyZVRpdGxlID0gXCJb5aSn5LyX5Y2B5LiJ5rC0XeaImOe7qVwiO1xyXG4gICAgICAgICAgICB2YXIgcm9vbUlkID1cIuaIv+mXtOWPt++8mlwiK3RoaXMuX2Rlc2tJbmZvLnJvb21JZDtcclxuICAgICAgICAgICAgdmFyIHBqID0gW1wiNSBcIixcIjEwIFwiLFwiMjAgXCJdOyAgLy/niYzlsYBcclxuICAgICAgICAgICAgdmFyIGpzID0gXCLlsYDmlbDvvJpcIitwalt0aGlzLl9kZXNrSW5mby5zZXR0aW5nMS0yXTtcclxuICAgICAgICAgICAgdmFyIHRpbWUgPSBcIuaXtumXtO+8mlwiK3RoaXMuX2Rlc2tJbmZvLmNyZWF0ZVRpbWUgO1xyXG4gICAgICAgICAgICB2YXIgZGVzYyA9IHJvb21JZCtqcyt0aW1lK1wi54K55Ye75p+l55yL6K+m5oOFXCI7XHJcblxyXG4gICAgICAgICAgICB2YXIgcmVjb3JkSWQgPSB0aGlzLl9kZXNrSW5mby5yZWNvcmRJZDtcclxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwic2hhcmVUaXRsZVwiLHNoYXJlVGl0bGUpO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJkZXNjXCIsZGVzYyk7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInJlY29yZElkXCIscmVjb3JkSWQpO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJyb29tSWRcIiwnJyk7XHJcblxyXG4gICAgICAgICAgICBzVGl0bGUgPSBzaGFyZVRpdGxlO1xyXG4gICAgICAgICAgICBzRGVzY3JpcHRpb24gPSBkZXNjO1xyXG4gICAgICAgICAgICBzSWQgPSAncm9vbUlkPScrcm9vbUlkO1xyXG4gICAgICAgICAgICBpZihyZWNvcmRJZCl7XHJcbiAgICAgICAgICAgICAgICBzSWQgPSAncmVjb3JkSWQ9JytyZWNvcmRJZDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoY2Muc3lzLmlzQnJvd3Nlcil7XHJcbiAgICAgICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNoYXJlVG9UaW1lTGluZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYod2luZG93LnNoYXJlVG9TZXNzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNoYXJlVG9TZXNzaW9uKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy9zaGFyZUJnXCIpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2NyZWVuU2hhcmVGcmllbmRcIiwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxyXG4gICAgICAgICAgICAgICAgS1FOYXRpdmVJbnZva2Uuc2NyZWVuc2hvdFNoYXJlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8g54K55Ye75qGM6Z2i5YiG5LqrXHJcbiAgICBjbGlja0Rlc2tTaGFyZSA6ZnVuY3Rpb24oKXtcclxuICAgICAgICAvL3RoaXMuX2dsb2JhbE1zZyh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgIHZhciBzaGFyZUJnID0gY2MuZmluZChcIkNhbnZhcy9zaGFyZUJnXCIpOyBcclxuICAgICAgICAgICAgc2hhcmVCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL3ZhciB3eEJnID0gdGhpcy5zaGFyZUJnLmdldENoaWxkQnlOYW1lKFwid3hcIik7XHJcbiAgICAgICAgICAgIC8vdmFyIHB5cUJnID0gdGhpcy5zaGFyZUJnLmdldENoaWxkQnlOYW1lKFwiUFlRXCIpO1xyXG4gICAgICAgICAgICAvL3d4QmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy9weXFCZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy90aGlzLnNoYXJlQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGlkPXNJZDtcclxuICAgICAgICB2YXIgdGl0bGUgPSBzVGl0bGU7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gc0Rlc2NyaXB0aW9uO1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUZyaWVuZDpkZXNjcmlwdGlvbjpcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcclxuICAgICAgICAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlRnJpZW5kXCIsc3RyLCBpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+eCueWHu+WIhuS6q+aMiemSrlxyXG4gICAgY2xpY2tTaGFyZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vdGhpcy5fZ2xvYmFsTXNnKHRoaXMuX2Rlc2tJbmZvKTtcclxuICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcclxuICAgICAgICAgICAgdmFyIHd4QmcgPSB0aGlzLnNoYXJlQmcuZ2V0Q2hpbGRCeU5hbWUoXCJ3eFwiKTtcclxuICAgICAgICAgICAgdmFyIHB5cUJnID0gdGhpcy5zaGFyZUJnLmdldENoaWxkQnlOYW1lKFwiUFlRXCIpO1xyXG4gICAgICAgICAgICB3eEJnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHB5cUJnLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLnNoYXJlQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGlkPXNJZDtcclxuICAgICAgICB2YXIgdGl0bGUgPSBzVGl0bGU7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gc0Rlc2NyaXB0aW9uO1xyXG5cclxuICAgICAgICAvLyBsZXQgcm9vbUlkID0gU3RyaW5nKHRoaXMuX2Rlc2tJbmZvLnJvb21JZCk7XHJcbiAgICAgICAgLy8gdmFyIGRlc2NyaXB0aW9uID0gXCLlpKfkvJfljYHkuInmsLQg546p5rOVOlwiXHJcbiAgICAgICAgLy8gZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbiArIFwiIFwiICsgdGhpcy5fZGVza0luZm9OdW1iZXJPZlBlb3BsZSgpO1xyXG4gICAgICAgIC8vIGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gKyBcIixcIiArIHRoaXMuX2Rlc2tJbmZvUGF5SW5mbygpO1xyXG4gICAgICAgIC8vIGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gKyBcIiBcIiArIHRoaXMuX2Rlc2tJbmZvTnVtYmVyT2ZHYW1lKCk7XHJcblxyXG5cclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVGcmllbmQ6ZGVzY3JpcHRpb246XCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLHN0ciwgaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8v5YiG5Lqr5Yiw5pyL5Y+L5ZyIXHJcbiAgICBzaGFyZUhhbGxUaW1lbGluZTpmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICB2YXIgd3hCZyA9IHRoaXMuc2hhcmVCZy5nZXRDaGlsZEJ5TmFtZShcInd4XCIpO1xyXG4gICAgICAgICAgICB2YXIgcHlxQmcgPSB0aGlzLnNoYXJlQmcuZ2V0Q2hpbGRCeU5hbWUoXCJQWVFcIik7XHJcbiAgICAgICAgICAgIHd4QmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHB5cUJnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuc2hhcmVCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB2YXIgaWQ9c0lkO1xyXG4gICAgICAgICAgICB2YXIgdGl0bGUgPSBzVGl0bGU7XHJcbiAgICAgICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IHNEZXNjcmlwdGlvbjtcclxuXHJcbiAgICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVIYWxsVGltZWxpbmVcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxyXG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XHJcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCBzdHIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy/ngrnlh7vlh4blpIfmjInpkq5cclxuICAgIGNsaWNrUmVhZHk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICBTb2NrZXQuc2VuZFJlYWR5KHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8v54K55Ye75byA5aeL5oyJ6ZKuXHJcbiAgICBjbGlja1N0YXJ0R2FtZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBTb2NrZXQuc2VuZFN0YXJ0R2FtZSh0aGlzLl91c2VySWQpO1xyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVSb29tTnVtYmVyOiBmdW5jdGlvbiAocm9vbU51bWJlcikge1xyXG4gICAgICAgIGxldCBnYW1lTnVtYmVyU3RyaW5nID0gXCJcIjtcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uc2V0dGluZzEgIT0gMCAmJiB0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSAhPSAxKSB7XHJcbiAgICAgICAgICAgIGdhbWVOdW1iZXJTdHJpbmcgPSBcIuWxgOaVsCA6IFwiICsgXCJcIiArIHRoaXMuX2Rlc2tJbmZvLmNJbmRleCArIFwiL1wiICsgdGhpcy5fZGVza0luZm8ubU1heDtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxID09IDApIHtcclxuICAgICAgICAgICAgZ2FtZU51bWJlclN0cmluZyA9IFwi5bGA5pWwIDogMTDlsYBcIjtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxID09IDEpIHtcclxuICAgICAgICAgICAgZ2FtZU51bWJlclN0cmluZyA9IFwi5bGA5pWwIDogMjDlsYBcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5sYWJlbFJvb21OdW1iZXIuc3RyaW5nID0gXCLmiL/lj7cgOiBcIiArIFwiXCIgKyByb29tTnVtYmVyICsgXCIgICAgXCIgKyBnYW1lTnVtYmVyU3RyaW5nO1xyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVHYW1lU3RhdHVzOiBmdW5jdGlvbiAoc3RhdHVzID0gR0FNRVNUQVRVUy5XQUlUX1BFT1BMRSkge1xyXG4gICAgICAgIHRoaXMuX2dhbWVTdGF0dXMgPSBzdGF0dXM7XHJcblxyXG4gICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSAoc3RhdHVzID09IEdBTUVTVEFUVVMuV0FJVF9QRU9QTEUpO1xyXG4gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSAoc3RhdHVzID09IEdBTUVTVEFUVVMuV0FJVF9SRUFEWSk7XHJcbiAgICAgICAgdGhpcy5pc1JlYWR5U3RhdHVzKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdhbWVTdGF0dXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZ2FtZVN0YXR1cztcclxuICAgIH0sXHJcbiAgICBpc1JlYWR5U3RhdHVzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYodGhpcy5fcGxheWVySW5mb3MgJiYgdGhpcy5fcGxheWVySW5mb3MubGVuZ3RoPjApIHtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJJbmZvKXtcclxuICAgICAgICAgICAgICAgIHZhciB1c2VySW5mb1NlbGY9Y2MuZmluZCgnQ2FudmFzL3BsYXlTZWxmL3VzZXJJbmZvU2VsZicpO1xyXG4gICAgICAgICAgICAgICAgaWYocGxheWVySW5mby5pZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZighcGxheWVySW5mby5yZWFkeVN0YXR1cyAmJiAhdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyAmJiAhUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpICYmICFQbGF5YmFjay5pbnN0YW5jZS5pc0NvbnRhaW5QbGF5YmFja0RhdGFzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlckluZm9TZWxmLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRSZWFkeU5vZGVWaXNpYmxlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7Ly/kuIDlsYDov5jmsqHlvIDlp4tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5wbGF5ZXJzLmxlbmd0aCA8IHRoaXMuX2Rlc2tJbmZvLm1heE51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMubGVuZ3RoID49IDIgJiYgdGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gdGhpcy5fdXNlcklkKXsvL+aYr+WQpuaYr+aIv+S4u1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCF0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySW5mb1NlbGYuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldFJlYWR5Tm9kZVZpc2libGUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllckNvbXApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllckNvbXAuaGlkZVJlYWR5U3RhdHVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy5faXNDb21wYXJpbmdDYXJkc05vdylcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCLlh4blpIfnirbmgIEtLS0tLS0tLVwiKVxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5faXNDb21wYXJpbmdDYXJkc05vdykgey8vXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllckNvbXApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJDb21wLmhpZGVSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgaXNHYW1lU3RhcnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDApIHsvL+S4gOWxgOi/mOayoeW8gOWni1xyXG4gICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpey8v5piv5ZCm5piv5oi/5Li7XHJcbiAgICAgICAgICAgICAgICBpZighdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyAmJiAhUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpXHJcbiAgICAgICAgICAgICAgICAgICAgJiYgIVBsYXliYWNrLmluc3RhbmNlLmlzQ29udGFpblBsYXliYWNrRGF0YXMoKSAmJiB0aGlzLl9kZXNrSW5mby5wbGF5ZXJzLmxlbmd0aCA+PSAyKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8ucGxheWVycy5sZW5ndGggPCB0aGlzLl9kZXNrSW5mby5tYXhOdW1iZXIpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vLyDmuLjmiI/liqjnlLtcclxuICAgIF9zdGFydEdhbWU6IGZ1bmN0aW9uIChwbGF5TXVzaWMpIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZ2FtZVN0YXR1cygpID09IEdBTUVTVEFUVVMuUExBWUlORykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdGhpcy5fcGxheWVySW5mb3MgPSBwbGF5ZXJzO1xyXG4gICAgICAgIC8vdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vfSk7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTsgIC8vIyMjIyNcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5oaWRlUmVhZHlTdGF0dXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnRlU2h1UGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5c0NvaW5zLmZvckVhY2goZnVuY3Rpb24obm8pe2lmKG5vKSBuby5yZW1vdmVBbGxDaGlsZHJlbigpO30pO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheXMsaSl7XHJcblxyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IFwiY29pbnNcIiArIGk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbm9kZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShuYW1lKTtcclxuXHJcbiAgICAgICAgICAgIGlmKG5vZGUpe1xyXG4gICAgICAgICAgICAgICAgbm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLy8gY2MubG9nKHRoaXMubm9kZSlcclxuICAgICAgICAvLyBjYy5sb2coJy0tLS0tLTcwOScpXHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHRoaXMuX3BsYXllckluZm9zKTtcclxuICAgICAgICB0aGlzLnNob3dDb21wYXJlQ2FyZCgpO1xyXG4gICAgICAgIHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudXBkYXRlR2FtZVN0YXR1cyhHQU1FU1RBVFVTLlBMQVlJTkcpO1xyXG4gICAgICAgIHRoaXMuX3BsYXlGYVBhaUFuaW1hdGlvbihwbGF5TXVzaWMpO1xyXG5cclxuICAgICAgICBsZXQgY2FyZFR5cGVDb21iaW5lID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVDb21iaW5lJyk7XHJcblxyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZXNldCgpO1xyXG5cclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYgKCFVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyh0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCkpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuZmFwYWlBbmltYXRpb24oKTtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2hvd0NhcmRUeXBlQ29tYmluZSgpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIDEuOSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX3BsYXlGYVBhaUFuaW1hdGlvbjogZnVuY3Rpb24gKHBsYXlNdXNpYykge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKXtcclxuICAgICAgICAgICAgcGxheWVyLnBsYXlGYVBhaUFuaW1hdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmKHBsYXlNdXNpYyl7XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5RmFQYWkoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyMqL1xyXG4gICAgLy/mmK/lkKbnibnmrorniYxcclxuICAgIGlzVGVTaHVQYWk6IGZ1bmN0aW9uKGNhcmRzKXtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzVGVTaHVQYWkoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1RlU2h1UGFpID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzVGVTaHVQYWkgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuS4gOadoem+mVxyXG4gICAgaXNZaVRpYW9Mb25nOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNZaVRpYW9Mb25nKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNZaVRpYW9Mb25nID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzWWlUaWFvTG9uZyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5YWt5a+55Y2KXHJcbiAgICBpc0xpdUR1aUJhbjogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzTGl1RHVpQmFuKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNMaXVEdWlCYW4gPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNMaXVEdWlCYW4gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbkuInpobrlrZBcclxuICAgIGlzU2FuU2h1blppOiBmdW5jdGlvbihjYXJkcyl7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1NhblNodW5aaShjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuU2h1blppID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuU2h1blppID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5LiJ5ZCM6IqxXHJcbiAgICBpc1NhblRvbmdIdWE6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1NhblRvbmdIdWEoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblRhb0h1YSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblRhb0h1YSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuS4ieWQjOiKsemhulxyXG4gICAgaXNTYW5Ub25nSHVhU2h1bjogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzU2FuVG9uZ0h1YVNodW4oY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblRvbmdIdWFTaHVuID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuVG9uZ0h1YVNodW4gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmK/muIXpvplcclxuICAgIGlzUWluZ0xvbmc6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1FpbmdMb25nKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNRaW5nTG9uZyA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1FpbmdMb25nID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5pivIOKAnOS4ieWIhuWkqeS4i+KAnVxyXG4gICAgaXNTYW5GZW5UaWFuWGlhOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNTYW5GZW5UaWFuWGlhKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5GZW5UaWFuWGlhID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuRmVuVGlhblhpYSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuaYryDigJzlm5vlpZfkuInmnaHigJ1cclxuICAgIGlzU2lUYW9TYW5UaWFvOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNTaVRhb1NhblRpYW8oY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NpVGFvU2FuVGlhbyA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NpVGFvU2FuVGlhbyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuaYr+S6lOWvueS4ieadoVxyXG4gICAgaXNXdUR1aVNhblRpYW86IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1d1RHVpU2FuVGlhbyhjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzV3VEdWlTYW5UaWFvID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzV3VEdWlTYW5UaWFvID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5piv5YeR5LiA6ImyXHJcbiAgICBpc0NvdVlpU2U6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc0NvdVlpU2UoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc0NvdVlpU2UgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNDb3VZaVNlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8qIyMjIyMqL1xyXG5cclxuICAgIC8q5pi+56S66YWN54mM6aG16Z2iKi9cclxuICAgIF9zaG93Q2FyZFR5cGVDb21iaW5lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc3RhcnRDb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMgPSBudWxsO1xyXG5cclxuICAgICAgICBsZXQgY2FyZFR5cGVDb21iaW5lID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVDb21iaW5lJyk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnJlc2V0KCk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnJlbG9hZENhcmRzKFtdKTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS50aW1lU3RhcnQoNjApO1xyXG4gICAgICAgIHRoaXMudGltZVN0YXJ0KDYwLFwiXCIpO1xyXG4gICAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5zY2FsZSA9IDE7XHJcblxyXG4gICAgICAgIGxldCBjYXJkcyA9IHRoaXMuX2ZpbmRDYXJkc0J5VXNlcklkKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgLy9cIjFfOVwiXCIzXzlcIlwiMl85XCJcclxuICAgICAgICAvLyBcIjJfN1wiXCIxXzdcIlwiM18zXCJcIjJfMTJcIlxyXG4gICAgICAgIC8vXCIxXzFcIlwiMV8zXCJcIjJfNlwiXCIxXzExXCJcIjJfMVwiXCIzXzRcIi8vXHJcbiAgICAgICAgLy8gaWYodGhpcy5fdXNlcklkID09IDIpe1xyXG4gICAgICAgIC8vICAgICBjYXJkcyA9IFt7c3VpdDogXCJkXCIsIG51bWJlcjoyfSx7c3VpdDogXCJkXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6Mn0sLy/pnZLpvplcclxuXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJoXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6Mn0sXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJjXCIsIG51bWJlcjozfSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6M30sIHtzdWl0OiBcImNcIiwgbnVtYmVyOjN9LFxyXG5cclxuICAgICAgICAvLyAgICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjN9LCB7c3VpdDogXCJkXCIsIG51bWJlcjo0fSxcclxuICAgICAgICAvLyAgICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjR9LCB7c3VpdDogXCJkXCIsIG51bWJlcjo0fSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6NH1dO1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvL2lmKHRoaXMuX3VzZXJJZCA9PSAxKXtkXHJcbiAgICAgICAgLy8gICAgY2FyZHMgPSBbe3N1aXQ6IFwiY1wiLCBudW1iZXI6MX0se3N1aXQ6IFwiaFwiLCBudW1iZXI6MX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjF9LC8v6Z2S6b6ZXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICAgICAge3N1aXQ6IFwiaFwiLCBudW1iZXI6OH0sIHtzdWl0OiBcImNcIiwgbnVtYmVyOjJ9LFxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjo4fSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6OH0sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjIwfSxcclxuICAgICAgICAvLyAgICAgICAge3N1aXQ6IFwiaFwiLCBudW1iZXI6OX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjl9LFxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJzXCIsIG51bWJlcjo5fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6OX0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjl9XTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLyBlbHNlIGlmKHRoaXMuX3VzZXJJZCA9PSA2KXtcclxuICAgICAgICAvLyAgICAgY2FyZHMgPSBbe3N1aXQ6IFwiZFwiLCBudW1iZXI6MTF9LHtzdWl0OiBcImRcIiwgbnVtYmVyOjEzfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6MTF9LC8v6Z2S6b6ZXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjoxfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6MX0sXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJoXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6NH0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjl9LFxyXG4gICAgICAgIC8vICAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6N30sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjd9LFxyXG4gICAgICAgIC8vICAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6NX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjV9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo1fSxdO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX3VzZXJJZCA9PSAzKXtcclxuICAgICAgICAvLyAgICBjYXJkcyA9IFt7c3VpdDogXCJkXCIsIG51bWJlcjo0fSx7c3VpdDogXCJkXCIsIG51bWJlcjoxM30sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEzfSwvL+mdkum+mVxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjo2fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6N30sXHJcbiAgICAgICAgLy8gICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjh9LCB7c3VpdDogXCJjXCIsIG51bWJlcjo5fSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6MTB9LFxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJzXCIsIG51bWJlcjoxfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6M30sXHJcbiAgICAgICAgLy8gICAgICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEwfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6OH0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEyfSxdO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIGNjLm1vc2hpID0gMDtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICB2YXIgcyA9IGNhcmRzW2ldLm51bWJlcjtcclxuICAgICAgICAgICAgaWYocyA+PSAyMCl7XHJcbiAgICAgICAgICAgICAgICBjYy5tb3NoaSA9IDE7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgY2FyZE5hbWVzID0gdGhpcy5fY29udmVydENhcmRzVG9DYXJkTmFtZXMoY2FyZHMpO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZWxvYWRDYXJkcyhjYXJkTmFtZXMpO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5hZGRDYXJkTW9kZXMoY2FyZE5hbWVzKTtcclxuXHJcbiAgICAgICAgLy9jYy5mcm9tLm1vc2hpID09IDDpgInmi6nkuobluoTlrrbmqKHlvI9cclxuXHJcbiAgICAgICAgaWYoY2MubW9zaGkgIT0gMSl7XHJcbiAgICAgICAgICAgIHRoaXMuaXNUZVNodVBhaShjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNRaW5nTG9uZyhjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNZaVRpYW9Mb25nKGNhcmRzKTtcclxuICAgICAgICAgICAgdGhpcy5pc0xpdUR1aUJhbihjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNTYW5TaHVuWmkoY2FyZHMpO1xyXG4gICAgICAgICAgICB0aGlzLmlzU2FuVG9uZ0h1YShjYXJkcyk7XHJcbiAgICAgICAgICAgIGlmKFRFU0hVUEFJVFlQRS5pc1RlU2h1UGFpKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5zY2FsZSA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzLmdvbmdYaU5pLmdldENoaWxkQnlOYW1lKFwiYmdcIik7XHJcbiAgICAgICAgICAgICAgICBub2Rlcy5vcGFjaXR5ID0gMjQwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc1NhblRvbmdIdWFTaHVuKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzU2FuRmVuVGlhblhpYShjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc1NpVGFvU2FuVGlhbyhjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc1d1RHVpU2FuVGlhbyhjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc0NvdVlpU2UoY2FyZHMpO1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93R29uZ1hpTmlBbmRCdG5UZVNodVBhaSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUuY2FjbGVBdXRvU2VsZWN0ZWRDYXJkczIoKTtcclxuXHJcbiAgICAgICAgaWYoY2MubW9zaGkgPT0gMSkgY2MudGVTaHVQYWlDYXJkcyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTsgIC8vIyMjIyNcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5oaWRlUmVhZHlTdGF0dXMoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0SXNUZVNodVBhaTogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIHZhciBjYXJkcyA9IHRoaXMuX2ZpbmRDYXJkc0J5VXNlcklkKHVzZXJJZCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNUZVNodVBhaShjYXJkcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyPmo4DmtYvnibnmrorniYznsbvlnovvvIzmmL7npLrnm7jlr7nlupTnmoTmga3llpzkvaDpobXpnaLlkoznibnmrorniYznsr7ngbUqL1xyXG4gICAgX3Nob3dHb25nWGlOaUFuZEJ0blRlU2h1UGFpOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLyrlpoLmnpzmnInnibnmrorniYwqL1xyXG4gICAgICAgIGlmKFRFU0hVUEFJVFlQRS5pc1RlU2h1UGFpKXtcclxuICAgICAgICAgICAgaWYoVEVTSFVQQUlUWVBFLmlzUWluZ0xvbmcpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUsIFwi5ZCM6Iqx5Y2B5LiJ5rC0XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2FuVG9uZ0h1YSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihURVNIVVBBSVRZUEUuaXNZaVRpYW9Mb25nKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlLCBcIuWNgeS4ieawtFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3lpVGlhb0xvbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYoVEVTSFVQQUlUWVBFLmlzTGl1RHVpQmFuKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlLCBcIuWFreWvueWNilwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xpdUR1aUJhbiA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTYW5TaHVuWmkpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUsIFwi5LiJ6aG65a2QXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2FuU2h1blppID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1NhblRhb0h1YSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSwgXCLkuInlkIzoirFcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zYW5Ub25nSHVhID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzU2FuVG9uZ0h1YVNodW4pe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX1NhblRvbmdIdWFTaHVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTYW5GZW5UaWFuWGlhKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9TYW5GZW5UaWFuWGlhID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNDb3VZaVNlKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9Db3VZaVNlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTaVRhb1NhblRpYW8pe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX1NpVGFvU2FuVGlhbyA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzV3VEdWlTYW5UaWFvKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9XdUR1aVNhblRpYW8gPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy90aGlzLl9pbml0VGVTaHVQYWlTcHJpdGUoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjI+aOp+WItueJueauiueJjOeyvueBteeahOaYvuekuiovXHJcbiAgICBfaW5pdFRlU2h1UGFpU3ByaXRlOmZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvKuaKiuaJgOacieeahOeJueauiueJjOeyvueBtemDvemakOiXj+aOiSovXHJcbiAgICAgICAgLy9mb3IodmFyIGk9MDtpPHRoaXMudGVzaHVwYWlfbWluLmxlbmd0aDtpKyspe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuIDmnaHpvpnvvIzlsLHmmL7npLrkuIDmnaHpvpnnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vaWYodGhpcy5feWlUaWFvTG9uZyl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bM10uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFszXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/lha3lr7nljYrlsLHmmL7npLrlha3lr7nljYrnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9saXVEdWlCYW4pe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzBdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbMF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ6aG65a2Q5bCx5pi+56S65LiJ6aG65a2Q55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fc2FuU2h1blppKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pblsxXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX3NhblRvbmdIdWEpe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzJdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbMl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fUWluZ0xvbmcpe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzRdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbNF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31fZ29uZ1hpTmlTaG93XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX1NhblRvbmdIdWFTaHVuKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pbls1XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzVdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX1NhbkZlblRpYW5YaWEpe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzZdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbNl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fQ291WWlTZSl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bN10uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFs3XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9TaVRhb1NhblRpYW8pe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzhdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbOF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fV3VEdWlTYW5UaWFvKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pbls5XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyMqL1xyXG4gICAgLy/mmL7npLpnb25nWGlOaSDpobXpnaLlkox0ZVNodVBhaVxyXG4gICAgY2xpY2tHb25nWGlOaVNob3c6ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5zY2FsZSA9IDE7XHJcbiAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5nb25nWGlOaS5nZXRDaGlsZEJ5TmFtZShcImJnXCIpO1xyXG4gICAgICAgIG5vZGVzLm9wYWNpdHkgPSAwO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZ29uZ1hpTmlTaG93OmZ1bmN0aW9uIChzdGF0dWVzLCB0ZXN0ID0gXCJcIikge1xyXG4gICAgICAgIC8vdmFyIGFsdGVyQ29tID0gdGhpcy5nb25nWGlOaS5nZXRDb21wb25lbnQoXCJhbGVydFwiKTtcclxuICAgICAgICBsZXQgYWx0ZXJDb20gPSB0aGlzLmdvbmdYaU5pLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBhbHRlckNvbS51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgdGVzdCA9IFwi5piv5ZCm5oyJ54m55q6K54mM5Z6LW1wiICsgdGVzdCArIFwiXeWHuueJjO+8n1wiICtcIlxcblwiKyBcIijlj5bmtojlkI7ngrnlh7vlt6bkuIvop5Llj6/lho3miqXpgZMpXCI7XHJcbiAgICAgICAgYWx0ZXJDb20uc2V0TWVzc2FnZSh0ZXN0KTtcclxuICAgICAgICBpZihzdGF0dWVzKXtcclxuICAgICAgICAgICAgYWx0ZXJDb20uYWxlcnQoKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgYWx0ZXJDb20uZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRlU2h1UGFpLmFjdGl2ZSA9IHN0YXR1ZXM7XHJcbiAgICAgICAgdmFyIG5vZGVzID0gdGhpcy50ZVNodVBhaS5nZXRDaGlsZEJ5TmFtZShcImJ0blRlc2h1cGFpXCIpO1xyXG4gICAgICAgIG5vZGVzLmNoaWxkcmVuWzBdLnJ1bkFjdGlvbihjYy5yZXBlYXRGb3JldmVyKGNjLnJvdGF0ZUJ5KDEsIC0zNjApKSk7XHJcbiAgICAgICAgbm9kZXMuY2hpbGRyZW5bMV0ucnVuQWN0aW9uKGNjLnJlcGVhdEZvcmV2ZXIoY2Mucm90YXRlQnkoMSwgMzYwKSkpO1xyXG4gICAgfSxcclxuICAgIC8qIyMjIyMqL1xyXG5cclxuICAgIC8vICDnu5Pmnpznm7jlhbNcclxuICAgIC8vIOaYvuekuuS4gOWxgOe7k+aenFxyXG4gICAgX3Nob3dPbmVHYW1lUmVzdWx0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgPSBmYWxzZTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy51cGRhdGVHYW1lU3RhdHVzKEdBTUVTVEFUVVMuV0FJVF9QRU9QTEUpO1xyXG4gICAgICAgIC8vbGV0IG9uZUdhbWVSZXN1bHQgPSB0aGlzLm9uZUdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdHYW1lUmVzdWx0Jyk7XHJcbiAgICAgICAgLy9vbmVHYW1lUmVzdWx0LnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICAvL29uZUdhbWVSZXN1bHQuc2hvd1Jlc3VsdHModGhpcy5fZGVza0luZm8sIHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlclNjb3JlcygpO1xyXG4gICAgICAgIC8vdGhpcy5fdXBkYXRlQmFua2VyKCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vc2VsZi5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgIC8vICAvL3BsYXllckNvbXAucmVzZXQoKTtcclxuICAgICAgICAgICAgLy8gIC8vcGxheWVyQ29tcC5yZXNldDIoKTsgIC8vIyMjIyNcclxuICAgICAgICAgICAgLy99KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghc2VsZi5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICAgICAgICAgIC8vaWYgKHNlbGYuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7Ly/kuIDlsYDov5jmsqHlvIDlp4tcclxuICAgICAgICAgICAgICAgIC8vICAgIHNlbGYuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5faXNUb3RhbEdhbWVPdmVyKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9zaG93VG90YWxHYW1lUmVzdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCAwLjUpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5faXNSYW5kb21Sb29tKCkgfHwgUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIG9uZUdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgICAgICB9LCAyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmmL7npLrmgLvnu5PmnpxcclxuICAgIF9zaG93VG90YWxHYW1lUmVzdWx0OiBmdW5jdGlvbiAoc2hvd0RlbGF5ID0gMikge1xyXG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICAvL2NjLmZpbmQoXCJDYW52YXMvc2hvd19yZXN1bHRcIikuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY0luZGV4ID09IHRoaXMuX2Rlc2tJbmZvLm1NYXgpe1xyXG4gICAgICAgICAgICB0aGlzLmFnYWluQnRuLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuYWdhaW5CdG4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdG90YWxHYW1lUmVzdWx0Q29tcCA9IHRoaXMudG90YWxHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnVG90YWxHYW1lUmVzdWx0Jyk7XHJcbiAgICAgICAgaWYoIHRvdGFsR2FtZVJlc3VsdENvbXAubm9kZS5hY3RpdmUgKXtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gXHJcblxyXG4gICAgICAgIGlmKHRoaXMuX2JpZ1JlY29yZEluZm8gPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHRoaXMuX2JpZ1JlY29yZEluZm8gPSB0aGlzLl9kZXNrSW5mby5wbGF5ZXJzO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0b3RhbEdhbWVSZXN1bHRDb21wLnNldFBsYXllckluZm9zKHRoaXMuX2JpZ1JlY29yZEluZm8sIHRoaXMuX2Rlc2tJbmZvKTtcclxuXHJcbiAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy50b3RhbEdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy90aGlzLm9uZUdhbWVSZXN1bHQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vYWxlcnQuYWxlcnQoKTtcclxuICAgICAgICAgICAgLyoqL1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMudG90YWxHYW1lUmVzdWx0LmFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQuYWxlcnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvKiovXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCBzaG93RGVsYXkpO1xyXG5cclxuICAgICAgICBhbGVydC5zZXREaXNtaXNzQ2FsbGJhY2soZnVuY3Rpb24gKCl7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kT25jZUFnYWluKCdmYWxzZScsdGhpcy5fdXNlcklkKTtcclxuICAgICAgICAgICAgLy9jYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBjbGlja0FnYWluOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgU29ja2V0LnNlbmRPbmNlQWdhaW4oJ3RydWUnLHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6IFNvY2tldCDnm7jlhbNcclxuICAgIF9sb2FkRGVza0luZm86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBTb2NrZXQuc2VuZEdldERlc2NrSW5mbyh0aGlzLl91c2VySWQpO1xyXG4gICAgfSxcclxuICAgIF9yZWdpc3RlclNvY2tldEV2ZW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZURlc2tJbmZvLCB0aGlzLl9zb2NrZXRSZWNlaXZlRGVza0luZm8sIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVPbmxpbmVTdGF0dXMsIHRoaXMuX3NvY2tldFJlY2l2ZU9ubGluZVN0YXR1cywgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUNoYXRUZXh0LCB0aGlzLl9zb2NrZXRSZWNpdmVDaGF0VGV4dE1lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVDaGF0RW1vamksIHRoaXMuX3NvY2tldFJlY2l2ZUNoYXRFbW9qaU1lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVSZXF1ZXN0RGlzc29sdmUsIHRoaXMuX3NvY2tldFJlY2VpdmVSZXF1ZXN0RXhpdE1lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVSZXF1ZXN0RGlzc29sdmVSZXN1bHQsIHRoaXMuX3NvY2tldFJlY2VpdmVSZXF1ZXN0RXhpdFJlc3VsdE1lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVBdWRpb01lc3NhZ2UsIHRoaXMuX3NvY2tldFJlY2VpdmVBdWRpb01lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVQbGF5Q2FyZCwgdGhpcy5fc29ja2V0UmVjZWl2ZVBsYXlDYXJkLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlR2FtZU92ZXIsIHRoaXMuX3NvY2tldFJlY2VpdmVHYW1lT3ZlciwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUZhUGFpLCB0aGlzLl9zb2NrZXRSZWNpdmVGYVBhaSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVJlYWR5LCB0aGlzLl9zb2NrZXRSZWNpdmVSZWFkeSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZURpc3NvbHZlRGVzaywgdGhpcy5fc29ja2V0UmVjZWl2ZURpc3NvbHZlRGVzaywgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUxlYXZlRGVzaywgdGhpcy5fc29ja2V0TGVhdmVEZXNrLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Tb2NrZXREaXNjb25uZWN0LCB0aGlzLl9yZWNlaXZlU29ja2V0Q29ubmVjdEVycm9yLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0U3VjY2Vzc2VkLCB0aGlzLl9yZWNlaXZlU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVBhdXNlLCB0aGlzLl9zb2NrZXRSZWNlaXZlUGF1c2UsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVTZWxlY3RCZWlMdiwgdGhpcy5fUmVjZWl2ZVNlbGVjdEJlaUx2LCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlQmVpTHYsIHRoaXMuX1JlY2VpdmVCZWlMdiwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVFpbmdMaSwgdGhpcy5fUmVjZWl2ZVFpbmdMaSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZU9uY2VBZ2FpbiwgdGhpcy5fUmVjZWl2ZU9uY2VBZ2FpbiwgdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9SZWNlaXZlT25jZUFnYWluOmZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlho3mnaXkuIDlsYBcclxuICAgICAgICAgKiDmgLvnu5PmnpzopoHpmpDol4/mjolcclxuICAgICAgICAgKiDmr5TniYzopoHpmpDol4/mjolcclxuICAgICAgICAgKiDlj5HniYzopoHmmL7npLpcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMgPSBbXTtcclxuICAgICAgICB0aGlzLnBsYXllckNvbXBzLmZvckVhY2gocGxheWVyQ29tcCA9PiB7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzID0gdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzO1xyXG4gICAgfSk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIGlmKCFkYXRhLnJlYXNvbil7XHJcbiAgICAgICAgICAgIHRoaXMudG90YWxHYW1lUmVzdWx0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0Q29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJDb21wLnJlc2V0KCk7ICAvLyMjIyMjXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLl9zb2NrZXRSZWNlaXZlRGVza0luZm8ocmVzcG9uc2UpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgaWYobm93IC0gdGhpcy5fbm93VGltZUFnYWluID4gMTUwMCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9ub3dUaW1lQWdhaW4gPSBub3c7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQueSA9IC0xNDM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdFJlc3VsdC5jaGlsZHJlblswXS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9ICfmiL/ljaHkuI3otrMnO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGNjLnNwYXduKGNjLm1vdmVUbygwLjMsIGNjLnAoMCwgMjApKSwgY2MuZmFkZU91dCgwLjMpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdFJlc3VsdC5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2MubW92ZVRvKDEsIGNjLnAoMCwgMCkpLCBhY3Rpb24pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG5cclxuICAgIF9SZWNlaXZlU2VsZWN0QmVpTHY6ZnVuY3Rpb24oKXtcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCAhPSB0aGlzLl91c2VySWQpe1xyXG4gICAgICAgICAgICB0aGlzLmJlaWx2LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHZhciBCMyA9IHRoaXMuYmVpbHYuZ2V0Q2hpbGRCeU5hbWUoJ2JnJykuZ2V0Q2hpbGRCeU5hbWUoJ2J0bjMnKS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzU9PTEpe1xyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiDluoTlrrbpgInmi6nkuKTlgI3nmoTml7blgJkgM+WAjeaMiemSruaYr+S4jeiDveWTjeW6lOeahFxyXG4gICAgICAgICAgICAgICAgICog6YCJ5oup5LiJ5YCN5LiN55So566h77yM5YWo6YOo5pi+56S677yMXHJcbiAgICAgICAgICAgICAgICAgKiDpgInmi6nkuIDlgI3kuZ/kuI3nlKjnrqHvvIznm7TmjqXlj5HniYzvvIxcclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgQjMuaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHNlbGVjdEJsID0gdGhpcy5iZWlsdi5nZXRDb21wb25lbnQoJ3NlbGVjdEJlaWx2Jyk7XHJcbiAgICAgICAgICAgIHNlbGVjdEJsLl91c2VyaWQgPSB0aGlzLl91c2VyaWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfUmVjZWl2ZUJlaUx2OmZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgbGV0IGJsID0gcmVzcG9uc2UuZGF0YS5iZWlsdjtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICBwbGF5ZXIuc2hvd0JlaWx2KHVzZXJJZCxibCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9SZWNlaXZlUWluZ0xpOmZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICB2YXIgbGVhdmVJZCA9IHJlc3BvbnNlLmRhdGEubGVhdmVJZDtcclxuICAgICAgICBpZihsZWF2ZUlkID09IHRoaXMuX3VzZXJJZCl7XHJcbiAgICAgICAgICAgIGlmKGNjLnFpbmdsaSA9PSBudWxsKXtcclxuICAgICAgICAgICAgICAgIHZhciBxbCA9IHJlc3BvbnNlLmFjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNjLnFpbmdsaSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgY2MucWluZ2xpID0gcWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVEZXNrSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgY2MuZXJyb3IoXCLplJnor6/vvJpcIiwgcmVzcG9uc2UpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcclxuXHJcbiAgICAgICAgdGhpcy5faW5pdFBsYXllckNvbXBvbmVudHMoZGF0YS5wbGF5ZXJzSW5kZXhBeXkpO1xyXG4gICAgICAgIC8qIyMjIyPmt7vliqDkupTlkIzmjInpkq4qL1xyXG4gICAgICAgIC8vIGNjLm1vc2hpID0gMDtcclxuXHJcbiAgICAgICAgLy8gaWYoZGF0YS5zZXR0aW5nM1sxXSA9PSB0cnVlKSBjYy5tb3NoaSA9IDE7ICAvLyAg77yf77yf77yfXHJcblxyXG4gICAgICAgIGNjLm1hUGFpID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYoZGF0YS5tYVBhaS5sZW5ndGggPT0gMikgY2MubWFQYWkgPSBkYXRhLm1hUGFpWzBdICsgXCJfXCIgKyBkYXRhLm1hUGFpWzFdO1xyXG5cclxuICAgICAgICBjYy5odWFTZSA9IGRhdGEuc2V0dGluZzNbMl07XHJcblxyXG4gICAgICAgIGNjLmNoYW9TaGlDaHVQYWkgPSBkYXRhLnNldHRpbmc2O1xyXG5cclxuICAgICAgICBjYy5kdW9ZaVNlID0gcmVzcG9uc2UuZGF0YS5zZXR0aW5nMjsgICAvL3NldHRpbmcy5Li6IDR+NyDkurrvvIgwfjPvvIlcclxuXHJcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX2dsb2JhbE1zZyhkYXRhKTtcclxuICAgICAgICB0aGlzLl91cGRhdEdhbWVPdmVydmlldyh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVSb29tTnVtYmVyKGRhdGEucm9vbUlkKTtcclxuICAgICAgICB0aGlzLm5lZWRDYXJkLnN0cmluZyA9ICBkYXRhLm5lZWRDYXJkOyAgICAgICAgIC8vIOW8gOaUvumcgOimgeeahOaIv+WNoVxyXG4gICAgICAgIGxldCBwbGF5ZXJJbmRleHMgPSBkYXRhLnBsYXllcnNJbmRleDsgICAvLyBbMTAwMDQ5XVxyXG4gICAgICAgIHRoaXMuX2luamVjdFVzZXJJZFRvUGxheWVyQ29tcG9uZW50cyhwbGF5ZXJJbmRleHMpO1xyXG5cclxuICAgICAgICBsZXQgcGxheWVycyA9IGRhdGEucGxheWVycztcclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHBsYXllcnMpO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZVVzZXJTY29yZXMoKTtcclxuICAgICAgICB0aGlzLl91cGRhdGVCYW5rZXIoKTtcclxuICAgICAgICB0aGlzLl9tc2dDb250cm9sLmFkZFBsYXllckluZm9zKHRoaXMuX3BsYXllckluZm9zKTtcclxuXHJcbiAgICAgICAgbGV0IGN1cnJlbnRVc2VySW5mbyA9IHBsYXllcnMuZmluZChmdW5jdGlvbiAocGxheWVySW5mbykge1xyXG4gICAgICAgICAgICByZXR1cm4gcGxheWVySW5mby5pZCA9PSB0aGlzLl91c2VySWQ7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgaWYoZGF0YS5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpe1xyXG4gICAgICAgICAgICBpZihkYXRhLmNJbmRleD4wKXsgIC8vIOW8gOWni+a4uOaIj+S6hu+8jOivt+emu+aMiemSruWFqOmDqOmakOiXj1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd1FpbmdsaShmYWxzZSxkYXRhLmNJbmRleCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9ZWxzZXsgICAgICAgICAgICAgIC8vIOa4uOaIj+ayoeW8gOWni++8jOaIv+S4u+eahOivt+emu+aMiemSruS4jeaYvuekulxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihkYXRhLmNyZWF0ZUlkID09IHBsYXllci51c2VySWQgKXsgIC8vIOaIkeaYr+aIv+S4u++8jOS4jeaYvuekuuaIkeeahOivt+emu+aMiemSrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd1FpbmdsaSh0cnVlLGRhdGEuY0luZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLnNob3dRaW5nbGkoZmFsc2UsZGF0YS5jSW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIGlmKGRhdGEuY3JlYXRlSWQgPT0gcGxheWVyLnVzZXJJZCl7Ly/mmL7npLrmiL/kuLtcclxuICAgICAgICAgICAgICAgIHBsYXllci5zaG93RmFuZ1podVN0YXR1cyhkYXRhLmNyZWF0ZUlkLHRydWUpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHBsYXllci5zaG93RmFuZ1podVN0YXR1cyhwbGF5ZXIudXNlcklkLGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5fZGVza0luZm8uY3JlYXRlSWQgIT0gdGhpcy5fdXNlcklkICl7ICAvLyDpnZ7luoTlrrZcclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDAgKXsgICAgICAgICAgICAvLyDlpoLmnpzov5jmsqHlvIDlp4vmuLjmiI/vvIzmmL7npLrpgIDlh7rmjInpkq7vvIzpmpDol4/op6PmlaPmjInpkq5cclxuICAgICAgICAgICAgICAgIHRoaXMuZXhpdC5hY3RpdmUgPSAgdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuRGlzc29sdmUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1lbHNleyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Y+N5LmLXHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4aXQuYWN0aXZlID0gIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5EaXNzb2x2ZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5bqE5a62XHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA+IDAgKXsgICAgICAgICAgICAgLy8g5byA5bGA5LqGIOmakOiXj+mAgOWHuuaMiemSrlxyXG4gICAgICAgICAgICAgICAgdGhpcy5leGl0LmFjdGl2ZSA9ICBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuRGlzc29sdmUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNleyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5rKh5byA5bGAIOS4pOS4qumDveaYvuekulxyXG4gICAgICAgICAgICAgICAgdGhpcy5leGl0LmFjdGl2ZSA9ICB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5EaXNzb2x2ZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2dhbWVTdGF0dXMgPSBHQU1FU1RBVFVTLldBSVRfUkVBRFk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvcih2YXIgaT0wO2k8cGxheWVycy5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgdmFyIHMgPSBwbGF5ZXJzW2ldO1xyXG4gICAgICAgICAgICB2YXIgaXMgPSBzLnJlYWR5U3RhdHVzOy8vdHJ1ZS9mYWxzZVxyXG4gICAgICAgICAgICB2YXIgdXNlcklkID0gcy5pZDtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgIGlmKCF0aGlzLl9kZXNrSW5mby5pc0NCZWdpbikgcGxheWVyLnNob3dSZWFkeVN0YXR1cyh1c2VySWQsaXMpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY3VycmVudFVzZXJJbmZvICYmIGN1cnJlbnRVc2VySW5mby5jYXJkcy5sZW5ndGggPiAwICYmIHRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luKSB7XHJcbiAgICAgICAgICAgIGlmKCFjdXJyZW50VXNlckluZm8uY2FyZEluZm8ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0R2FtZSh0cnVlKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFydEdhbWUoZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKGN1cnJlbnRVc2VySW5mbykgJiYgIXRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NvY2tldFJlY2VpdmVHYW1lT3ZlcihyZXNwb25zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaXNSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVVwZGF0ZURlc2tJbmZvQWJvdXRFeGl0Um9vbSh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgdGhpcy5zaG93Q29tcGFyZUNhcmQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvd0NvbXBhcmVDYXJkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDAgfHwgdGhpcy5fZGVza0luZm8uaXNDQmVnaW4gfHxcclxuICAgICAgICAgICAgIXRoaXMuX2Rlc2tJbmZvLnBsYXllcnMgfHwgdGhpcy5fZGVza0luZm8ucGxheWVycy5sZW5ndGggPD0gMCB8fCB0aGlzLl9kZXNrSW5mby5wbGF5ZXJzWzBdLmNhcmRJbmZvIDw9IDApe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnBsYXlzQ29pbnMuZm9yRWFjaChmdW5jdGlvbihubyl7aWYobm8pIG5vLnJlbW92ZUFsbENoaWxkcmVuKCk7fSk7XHJcblxyXG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG5cclxuICAgICAgICB0aGlzLm5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7cGxheWVyQ29tcC5yZWFkeVRvQ29tcGFyZUNhcmRzKCk7fSk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcblxyXG4gICAgICAgICAgICBpZihwbGF5ZXIubm9kZS5hY3RpdmUpcGxheWVyLnNob3dBbGxDb21wYXJlQ2FyZHModGhpcy5fZGVza0luZm8ucGxheWVycyk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIHRoaXMuc3RhcnRDb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaXNSZWFkeVN0YXR1cygpO1xyXG5cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5faXNUb3RhbEdhbWVPdmVyKCkpIHRoaXMuX3Nob3dUb3RhbEdhbWVSZXN1bHQoKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjUpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2l2ZUZhUGFpOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAvLyAg5Y+R54mM5LqG5byA5aeL5q+U54mM6ZqQ6JeP5o6JXHJcbiAgICAgICAgdGhpcy5zdGFydENvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xyXG4gICAgICAgIHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2dhbWVTdGF0dXMgPSBHQU1FU1RBVFVTLldBSVRfUkVBRFk7XHJcbiAgICAgICAgdGhpcy5fc29ja2V0UmVjZWl2ZURlc2tJbmZvKHJlc3BvbnNlKTtcclxuICAgIH0sXHJcbiAgICBsb2dvdXRBY3Rpb246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnbG9naW4nKTtcclxuICAgICAgICAvL21hbmFnZXIuc2V0VXNlckluZm8oJycpO1xyXG4gICAgICAgIC8vaGFsbC5jYWNoZUltYWdlSW5mbyA9IG51bGw7XHJcbiAgICB9LFxyXG4gICAgX3NvY2tldFJlY2l2ZU9ubGluZVN0YXR1czogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgLy97XCJhY3Rpb25cIjpcInNlbmRPbmxpbmVTdGF0dXNcIixcInJlc3VsdFwiOnRydWUsXCJkYXRhXCI6e1widXNlcklkXCI6MTAwMDQ5LFwic3RhdHVzXCI6MX19XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgY2MuZXJyb3IoXCLplJnor6/vvJpcIiwgcmVzcG9uc2UpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IGRhdGEudXNlcklkO1xyXG4gICAgICAgIGxldCBzdGF0dXMgPSBkYXRhLnN0YXR1cztcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyLnNldFVzZXJPbmxpbmVTdGF0dXModXNlcklkLCBzdGF0dXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjaXZlQ2hhdFRleHRNZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgbGV0IG1lc3NhZ2UgPSByZXNwb25zZS5kYXRhLm1zZztcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyLnNob3dDaGF0VGV4dCh1c2VySWQsIG1lc3NhZ2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLl9tc2dDb250cm9sLmFkZENoYXRUZXh0TWVzc2FnZSh1c2VySWQsIG1lc3NhZ2UpO1xyXG5cclxuICAgICAgICBsZXQgc2V4ID0gdGhpcy5fcGxheWVySW5mb3MuZmluZChmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdXNlci5pZCA9PSB1c2VySWQ7XHJcbiAgICAgICAgfSkuc2V4O1xyXG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5Q2hhdEF1ZGlvKHNleCwgbWVzc2FnZSk7XHJcbiAgICB9LFxyXG4gICAgX3NvY2tldFJlY2l2ZUNoYXRFbW9qaU1lc3NhZ2UgOmZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgbGV0IGVtb2ppID0gcmVzcG9uc2UuZGF0YS5lbW9qaTtcclxuXHJcbiAgICAgICAgLy90aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgIC8vICAgIHBsYXllci5zaG93Q2hhdFRleHQodXNlcklkLCBlbW9qaSk7XHJcbiAgICAgICAgLy99KTtcclxuICAgICAgICAvL3RoaXMuX21zZ0NvbnRyb2wuYWRkQ2hhdEVtb2ppTWVzc2FnZSh1c2VySWQsIGVtb2ppKTtcclxuICAgICAgICB0aGlzLl9tc2dDb250cm9sLl9sb2FkRW1vamlGcmFtZShlbW9qaSxmdW5jdGlvbihmcmFtZSl7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICBpZihwbGF5ZXIudXNlcklkID09IHVzZXJJZCkgcGxheWVyLmNoYXRNZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoJ0NoYXRNZXNzYWdlJykuc2hvd0Vtb2ppKGZyYW1lKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKVxyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjZWl2ZVJlcXVlc3RFeGl0TWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgLy9pZiAocmVzcG9uc2UuZGF0YS51c2VySWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuO1xyXG4gICAgICAgIC8vfVxyXG5cclxuXHJcbiAgICAgICAgdmFyIGFsZXJ0X2JnID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDaGlsZEJ5TmFtZShcImFsZXJ0X2JnXCIpO1xyXG5cclxuICAgICAgICB2YXIgYnRuQWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkFncmVlXCIpO1xyXG5cclxuICAgICAgICB2YXIgYnRuRGlzYWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkRpc2FncmVlXCIpO1xyXG5cclxuICAgICAgICBidG5BZ3JlZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICBidG5EaXNhZ3JlZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICB2YXIgZGF0YUluZm9zID0gcmVzcG9uc2UuZGF0YS5pbmZvO1xyXG5cclxuICAgICAgICBpZighdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5hY3RpdmUpe1xyXG5cclxuICAgICAgICAgICAgbGV0IGFsZXJ0Q29tcCA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG5cclxuICAgICAgICAgICAgYWxlcnRDb21wLmFsZXJ0KCk7XHJcblxyXG4gICAgICAgICAgICBhbGVydENvbXAudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jb250ZW50QW5zb3dlckV4aXROb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oaSl7aS5hY3RpdmUgPSBmYWxzZTt9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckluZm9zLmZvckVhY2goZnVuY3Rpb24ocGxheWVySW5mbyxpbmRleCl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHBsYXkgPSB0aGlzLmNvbnRlbnRBbnNvd2VyRXhpdE5vZGUuY2hpbGRyZW5baW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcIm5pY2tuYW1lXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBiYWNrID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcImZhbnpodVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW1nID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcImF2YXRhcl9iZ1wiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwbGF5LmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgbmFtZS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHBsYXllckluZm8ubmlja25hbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gcGxheWVySW5mby5pZCl7Ly/mmL7npLrmiL/kuLtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYmFjay5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYmFjay5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjYy5sb2FkZXIubG9hZCh7dXJsOnBsYXllckluZm8uYXZhdGFyVXJsLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycikgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUoZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGltZy5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IGZyYW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjb3VudGRvd24gPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJyk7XHJcblxyXG4gICAgICAgICAgICBjb3VudGRvd24uc3RhcnRDb3VudGRvd24oNjAsIGZ1bmN0aW9uKGlzVGltZW91dCkge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpc1RpbWVvdXQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGlja0FncmVlT3RoZXJQbGF5ZXJFeGl0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJJbmZvLGluZGV4KXtcclxuXHJcbiAgICAgICAgICAgIHZhciBkYXRhSW5mbyA9IGRhdGFJbmZvc1tpbmRleF07XHJcblxyXG4gICAgICAgICAgICB2YXIgcGxheSA9IHRoaXMuY29udGVudEFuc293ZXJFeGl0Tm9kZS5jaGlsZHJlbltpbmRleF07XHJcblxyXG4gICAgICAgICAgICB2YXIgc3RyID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcImlkXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGRhdGFJbmZvID0gZGF0YUluZm9zW2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgIGlmKGRhdGFJbmZvID09IDEpe1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuX3VzZXJJZCA9PSBwbGF5ZXJJbmZvLmlkKXsvL+aYvuekuuaIv+S4u1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBidG5BZ3JlZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnRuRGlzYWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgc3RyLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCLlkIzmhI9cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG5cclxuICAgICAgICAgICAgICAgIHN0ci5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlUmVxdWVzdEV4aXRSZXN1bHRNZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLl9oaWRlUmVxZXN0RXhpdE5vZGUoKTtcclxuICAgICAgICBpZiAodGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnJlc3VsdCkge1xyXG4gICAgICAgICAgICAvLyDop6PmlaPmiJDlip9cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgICAgIGxldCBuaWNrbmFtZSA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodXNlcklkKS5uaWNrbmFtZTtcclxuICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0LnkgPSAtMTQzO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0LmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gbmlja25hbWUgKyAn5LiN5ZCM5oSP6YCA5Ye6JztcclxuICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGNjLnNwYXduKGNjLm1vdmVUbyguMywgY2MucCgwLCAyMCkpLCBjYy5mYWRlT3V0KHRoaXMuY2FyZFRpbWUpKTtcclxuICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0LnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMSwgY2MucCgwLCAwKSksIGFjdGlvbikpO1xyXG5cclxuICAgICAgICAgICAgLy90aGlzLnNob3dBbGVydE1lc3NhZ2UoJ+ino+aVo+Wksei0pe+8jOWboOS4uicgKyBuaWNrbmFtZSArICfkuI3lkIzmhI/pgIDlh7onKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlQXVkaW9NZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgdGhpcy5wbGF5U3BlYWtBbmltYXRpb24odXNlcklkKTtcclxuXHJcbiAgICAgICAgaWYgKHVzZXJJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHVybCA9IHJlc3BvbnNlLmRhdGEudXJsO1xyXG4gICAgICAgIHRoaXMucGxheUF1ZGlvVXJsKHVybCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlUGxheUNhcmQ6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIC8vIOacieeUqOaIt+W3sue7j+WHhuWkh+WlveS6hueJjFxyXG4gICAgICAgIHZhciB1c2VySWQgPSByZXNwb25zZS5kYXRhWzBdLnVzZXJJZDtcclxuICAgICAgICB2YXIgY2FyZEluZm8gPSByZXNwb25zZS5kYXRhWzFdLmNhcmQ7XHJcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSByZXNwb25zZS5kYXRhWzJdLnM7XHJcbiAgICAgICAgbGV0IHBsYXllcnMgPSByZXNwb25zZS5kYXRhWzJdLnMucGxheWVycztcclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHBsYXllcnMpO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5wbGF5Q2FyZCh1c2VySWQsY2FyZEluZm8pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAodXNlcklkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIF9nZXRTZWxmUmVhZHlTdGF0dXM6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgcmV0dXJuIHNlbGYucmVhZHlTdGF0dXM7XHJcbiAgICB9LFxyXG4gICAgX3NvY2tldFJlY2l2ZVJlYWR5OiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgaWYoIXRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luKSBwbGF5ZXIuc2hvd1JlYWR5U3RhdHVzKHVzZXJJZCk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/mlLbliLDmuLjmiI/nu5PmnZ9cclxuICAgIF9zb2NrZXRSZWNlaXZlR2FtZU92ZXI6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XHJcblxyXG4gICAgICAgIHRoaXMuX2hpZGVSZXFlc3RFeGl0Tm9kZSgpO1xyXG5cclxuICAgICAgICAvLyDkuIDlsYDmuLjmiI/nu5PmnZ9cclxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICBjYy5lcnJvcihcIumUmeivr++8mlwiLCByZXNwb25zZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIGNvbnN0IGRlc2tJbmZvID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICBpZiAocmVzcG9uc2UuYWN0aW9uID09ICdnYW1lT3ZlcicgJiYgZGVza0luZm8uaXNEZXNrT3Zlcikge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgU29ja2V0LnNlbmREaWRSZWNlaXZlR2FtZU92ZXJBY3Rpb24odGhpcy5fdXNlcklkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMuX2Rlc2tJbmZvID0gcmVzcG9uc2UuZGF0YTtcclxuXHJcbiAgICAgICAgLy8g5aaC5p6c5piv5by65Yi26Kej5pWj5oi/6Ze077yM5YiZ55u05o6l5pi+56S65oC75oiQ57upXHJcbiAgICAgICAgaWYgKHRoaXMuX2lzRGlzc3ZsZWRSb29tKCkgJiYgIVBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93VG90YWxHYW1lUmVzdWx0KDAuMSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHRoaXMuX2VudGVyVGltZSA8IDEwMDAgKiA0KSB7XHJcbiAgICAgICAgICAgIC8vIOWImui/m+adpeeahOivne+8jOS4jeWxleekuuavlOeJjOWKqOeUu1xyXG4gICAgICAgICAgICAvLyAgbGV0IG9uZUdhbWVSZXN1bHQgPSB0aGlzLm9uZUdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdHYW1lUmVzdWx0Jyk7XHJcbiAgICAgICAgICAgIC8vICBvbmVHYW1lUmVzdWx0LnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICAgICAgLy8gIG9uZUdhbWVSZXN1bHQuc2hvd1Jlc3VsdHModGhpcy5fZGVza0luZm8sIHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8qKi9cclxuICAgICAgICAgICAgdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzLnB1c2godGhpcy5fZGVza0luZm8uY0luZGV4KTtcclxuICAgICAgICAgICAgLyoqL1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX2JpZ1JlY29yZEluZm8gPSBkYXRhLmJpZ1JlY29yZEluZm9cclxuICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3MDlcIik7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRHYW1lT3ZlcnZpZXcodGhpcy5fZGVza0luZm8pO1xyXG4gICAgICAgIC8vbGV0IHBsYXllckluZGV4cyA9IGRhdGEucGxheWVyc0luZGV4OyAvLyBbMTAwMDQ5XVxyXG5cclxuICAgICAgICBsZXQgcGxheWVycyA9IGRhdGEucGxheWVycztcclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHBsYXllcnMpO1xyXG4gICAgICAgIC8vdGhpcy5fdXBkYXRlUmVjb3JkSW5mbyhwbGF5ZXJzKTtcclxuXHJcbiAgICAgICAgaWYgKFVzZXJNb2RlbEhlbHBlci5pc1VzZXJSZWFkeSh0aGlzLl9maW5kQ3VycmVudFVzZXJJbmZvKCkpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyQ29tcC5yZXNldCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zdGFydENvbXBhcmVDYXJkcyhyZXNwb25zZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHRoaXMuX2VudGVyVGltZSA8IDEwMDAgKiA0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0NvbXBhcmVDYXJkKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8gX3VwZGF0ZVJlY29yZEluZm86ZnVuY3Rpb24ocGxheWVycyl7XHJcblxyXG4gICAgLy8gICAgIC8vIHRoaXMuX2JpZ1JlY29yZEluZm8ucHVzaCgpO1xyXG4gICAgLy8gfSxcclxuICAgIF9zb2NrZXRSZWNlaXZlRGlzc29sdmVEZXNrOiBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuXHJcbiAgICAgICAgLy8gdGhpcy5hbGVydC5nZXRDb21wb25lbnQoJ2FsZXJ0Jykuc2V0V2lsbERpc21pc3NDYWxsYmFjayhmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAvLyAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIC8vIH0pO1xyXG5cclxuICAgICAgICAvLyBsZXQgbWVzc2FnZSA9IFwi5oi/5Li75bey6Kej5pWj5oi/6Ze0XCI7XHJcbiAgICAgICAgLy8gaWYgKHRoaXMuX2lzUmFuZG9tUm9vbSgpKSB7XHJcbiAgICAgICAgLy8gICBtZXNzYWdlID0gXCLmnInnjqnlrrblt7LlvLrliLbpgIDlh7rmiL/pl7TvvIzmuLjmiI/nu5PmnZ/jgILmnKzlsYDmuLjmiI/kuI3kvJrmiaPpmaTmgqjnmoTpkrvnn7PjgIJcIjtcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIC8vIHRoaXMuc2hvd0FsZXJ0TWVzc2FnZShtZXNzYWdlLCBmYWxzZSk7XHJcbiAgICB9LFxyXG4gICAgLyoqL1xyXG4gICAgX3NvY2tldExlYXZlRGVzazogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmlzRGVza092ZXIpIHtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5oi/6Ze05bey57uT5p2f77yM5Lmf5LiN55So5YaN6Ieq5Yqo6YCA5Zue5Yiw5aSn5Y6F5LqGXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgfSxcclxuICAgIC8qKi9cclxuICAgIC8vIHNvY2tldCDmlLbliLDmnInkurrmiYvmnLrov5vlhaXlkI7lj7Dmtojmga9cclxuICAgIF9zb2NrZXRSZWNlaXZlUGF1c2U6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXIpIHtcclxuICAgICAgICAgICAgaWYgKHBsYXllci51c2VySWQgPT0gdXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXIuc2V0VXNlck9ubGluZVN0YXR1cyh1c2VySWQsIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yZWNlaXZlU29ja2V0Q29ubmVjdEVycm9yOiBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMuc2hvd05ldHdvcmtNZXNzYWdlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yZWNlaXZlU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZDogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLmhpZGRlbk5ldHdvcmtNZXNzYWdlKCk7XHJcblxyXG4gICAgICAgIGlmICghUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWREZXNrSW5mbygpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICAvLyBNQVJLOiDmm7TmlrDmiL/pl7Tkv6Hmga9cclxuICAgIHVwZGF0ZURlc2tJbmZvOiBmdW5jdGlvbiAoZGVza0luZm8pIHtcclxuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IGRlc2tJbmZvO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0R2FtZU92ZXJ2aWV3KHRoaXMuX2Rlc2tJbmZvKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVJvb21OdW1iZXIoZGVza0luZm8ucm9vbUlkKTtcclxuXHJcbiAgICAgICAgbGV0IHBsYXllckluZGV4cyA9IGRlc2tJbmZvLnBsYXllcnNJbmRleDsgLy8gWzEwMDA0OV1cclxuICAgICAgICB0aGlzLl9pbmplY3RVc2VySWRUb1BsYXllckNvbXBvbmVudHMocGxheWVySW5kZXhzKTtcclxuXHJcbiAgICAgICAgbGV0IHBsYXllcnMgPSBkZXNrSW5mby5wbGF5ZXJzO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gcGxheWVycztcclxuICAgICAgICB0aGlzLl91cGRhdGVVc2VySW5mb3MocGxheWVycyk7XHJcbiAgICAgICAgdGhpcy5fbXNnQ29udHJvbC5hZGRQbGF5ZXJJbmZvcyh0aGlzLl9wbGF5ZXJJbmZvcyk7XHJcbiAgICAgICAgaWYgKGRlc2tJbmZvLmNJbmRleCA9PSAwICYmIHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMubGVuZ3RoIDwgdGhpcy5fZGVza0luZm8ubWF4TnVtYmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICBfaW5qZWN0VXNlcklkVG9QbGF5ZXJDb21wb25lbnRzOiBmdW5jdGlvbiAocGxheWVySW5kZXhzKSB7XHJcbiAgICAgICAgbGV0IGN1cnJlbnRVc2VySWRJbmRleCA9IHBsYXllckluZGV4cy5maW5kSW5kZXgoZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdXNlcklkID09IHRoaXMuX3VzZXJJZDtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICBsZXQgZml4ZWRQbGF5ZXJJbmRleHMgPSBwbGF5ZXJJbmRleHMudHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleChjdXJyZW50VXNlcklkSW5kZXgpO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcG9uZW50LCBpbmRleCkge1xyXG4gICAgICAgICAgICBsZXQgdXNlcklkID0gZml4ZWRQbGF5ZXJJbmRleHMubGVuZ3RoID4gaW5kZXggPyBmaXhlZFBsYXllckluZGV4c1tpbmRleF0gOiBudWxsO1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wb25lbnQudXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfdXBkYXRlVXNlckluZm9zOiBmdW5jdGlvbiAodXNlckluZm9zKSB7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcG9uZW50LCBpbmRleCkge1xyXG4gICAgICAgICAgICAvL3BsYXllckNvbXBvbmVudC5zZXREZXNrSW5mbyhzZWxmLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgICAgIC8qKi9cclxuICAgICAgICAgICAgcGxheWVyQ29tcG9uZW50LnVwZGF0ZURlc2tJbmZvKHNlbGYuX2Rlc2tJbmZvKTtcclxuICAgICAgICAgICAgLyoqL1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wb25lbnQudXBkYXRlVXNlckluZm9XaXRoVXNlcnModXNlckluZm9zKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy90aGlzLl9oYW5kbGVUaGVTYW1lT2ZJUEFkcmVzcyh1c2VySW5mb3MpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfdXBkYXRlVXNlclNjb3JlczogZnVuY3Rpb24odXNlckluZm9zKSB7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllcikge1xyXG4gICAgICAgICAgICBwbGF5ZXIudXBkYXRlU2NvcmUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIF91cGRhdGVCYW5rZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyLnVwZGF0ZUJhbmtlcigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDnp4HmnInmlrnms5VcclxuICAgIF9maW5kQ2FyZHNCeVVzZXJJZDogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIGxldCBwbGF5ZXIgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHVzZXJJZCk7XHJcblxyXG4gICAgICAgIHJldHVybiAocGxheWVyICE9IG51bGwpID8gcGxheWVyLmNhcmRzIDogbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQ6IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICBsZXQgcGxheWVyID0gKHRoaXMuX3BsYXllckluZm9zIHx8IFtdKS5maW5kKGZ1bmN0aW9uIChwbGF5ZXJJbmZvKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1c2VySWQgPT0gcGxheWVySW5mby5pZDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHBsYXllcjtcclxuICAgIH0sXHJcblxyXG4gICAgX2ZpbmRQbGF5ZXJJbmRleEJ5VXNlcklkOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgLy9sZXQgaW5kZXggPSB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZpbmRJbmRleChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgIC8vICAgIHJldHVybiBwbGF5ZXJDb21wLnVzZXJJZCA9PSB1c2VySWQ7XHJcbiAgICAgICAgLy99KTtcclxuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLnBsYXllck5vZGVzLmZpbmRJbmRleChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRDb21wb25lbnQoJ1BsYXllcicpLnVzZXJJZCA9PSB1c2VySWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGluZGV4O1xyXG4gICAgfSxcclxuXHJcbiAgICBfZmluZEN1cnJlbnRVc2VySW5mbzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lczogZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICAgICAgLy8gW3tcInN1aXRcIjpcInNcIixcIm51bWJlclwiOjEwfV1cclxuICAgICAgICBsZXQgc3VpdENvbG9yTWFwID0ge1xyXG4gICAgICAgICAgICBzOiA0LFxyXG4gICAgICAgICAgICBoOiAzLFxyXG4gICAgICAgICAgICBjOiAyLFxyXG4gICAgICAgICAgICBkOiAxLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgICAgICB2YXIgY2FyZE51bWJlciA9IGNhcmQubnVtYmVyO1xyXG5cclxuICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Lit55qEIDE0IOaYryBBXHJcbiAgICAgICAgICAgIGlmIChjYXJkLm51bWJlciA9PSAxNCkge1xyXG4gICAgICAgICAgICAgICAgY2FyZE51bWJlciA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGNvbG9yID0gc3VpdENvbG9yTWFwW2NhcmQuc3VpdF07XHJcbiAgICAgICAgICAgIGxldCBudW1iZXIgPSBNYXRoLm1heChNYXRoLm1pbihjYXJkTnVtYmVyLCAyMSksIDEpO1xyXG4gICAgICAgICAgICByZXR1cm4gY29sb3IgKyBcIl9cIiArIG51bWJlcjtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5pu05paw5ri45oiP5oC76KeI5L+h5oGvXHJcbiAgICBfdXBkYXRHYW1lT3ZlcnZpZXc6IGZ1bmN0aW9uIChkZXNrSW5mbykge1xyXG4gICAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5sYWJlbE92ZXJ2aWV3LnN0cmluZyA9IFwi5Zue5pS+XCI7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsT3ZlcnZpZXcuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYmlodWFzZSA9IFwi5LiN5q+U6Iqx6ImyIFwiO1xyXG4gICAgICAgIHZhciB6dW96aHVhbmcgPSBcIuS4jeWdkOW6hCBcIjtcclxuICAgICAgICB2YXIgcHV0b25nICA9IFwi5pmu6YCa5Zy6IFwiO1xyXG4gICAgICAgIHZhciB3dWd1aSA9ICBcIuaXoOmsvCBcIjtcclxuICAgICAgICB2YXIgbWFQYWkgPSAn5LiN5Lmw6amsICc7XHJcbiAgICAgICAgdmFyIHJlbnNodSA9IFwiNOS6uuS4jeWKoOiJsiBcIjtcclxuICAgICAgICB2YXIgY2FyZCA9IFwi5bmz5pGKXCI7XHJcblxyXG4gICAgICAgIC8vW+eWr+eLguWcuizprLzniYws5q+U6Iqx6ImyLOWdkOW6hCzpqazniYxdXHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzNbMl0pe1xyXG4gICAgICAgICAgICBiaWh1YXNlID0gXCLmr5ToirHoibIgIFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nM1szXSl7XHJcbiAgICAgICAgICAgIHp1b3podWFuZyA9IFwi5Z2Q5bqEIFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nM1swXSl7XHJcbiAgICAgICAgICAgIHB1dG9uZyA9IFwi55av54uC5Zy6ICBcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzNbMV0pe1xyXG4gICAgICAgICAgICB3dWd1aSA9IFwi5pyJ6ay8ICBcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzNbNF0pe1xyXG4gICAgICAgICAgICBtYVBhaSA9IFwi5Lmw6amsXCI7XHJcbiAgICAgICAgICAgIHZhciBodWFTZSA9IFwi5pa55Z2XXCI7XHJcbiAgICAgICAgICAgIHZhciBkaWFuU2h1ID0gMVxyXG4gICAgICAgICAgICBzd2l0Y2godGhpcy5fZGVza0luZm8uc2V0dGluZzdbMF0peyAvL3NldHRpbmc3IFsxfjQsMX4xM10g6KGo56S6IFvoirHoibLvvIzngrnmlbBdXHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6IGh1YVNlID0gXCLmlrnlnZdcIjticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMjogaHVhU2UgPSBcIuaiheiKsVwiO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOiBodWFTZSA9IFwi57qi5b+DXCI7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IGh1YVNlID0gXCLpu5HmoYNcIjticmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzd2l0Y2godGhpcy5fZGVza0luZm8uc2V0dGluZzdbMV0pe1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOiBkaWFuU2h1ID0gJ0EnO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOiBkaWFuU2h1ID0gMjticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMzogZGlhblNodSA9IDM7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IGRpYW5TaHUgPSA0O2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBkaWFuU2h1ID0gNTticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNjogZGlhblNodSA9IDY7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IGRpYW5TaHUgPSA3O2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA4OiBkaWFuU2h1ID0gODticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgOTogZGlhblNodSA9IDk7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDEwOiBkaWFuU2h1ID0gMTA7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDExOiBkaWFuU2h1ID0gJ0onO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxMjogZGlhblNodSA9ICdRJzticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMTM6IGRpYW5TaHUgPSAnSyc7YnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbWFQYWkgPSBodWFTZStkaWFuU2h1K21hUGFpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzIgPT0gMSl7XHJcbiAgICAgICAgICAgIHJlbnNodSA9IFwiNeS6uuWKoOS4gOiJsiBcIjtcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nMiA9PSAyKXtcclxuICAgICAgICAgICAgcmVuc2h1ID0gXCI25Lq65Yqg5LqM6ImyIFwiO1xyXG4gICAgICAgIH1lbHNlIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcyID09IDMpe1xyXG4gICAgICAgICAgICByZW5zaHUgPSBcIjfkurrliqDkuInoibIgXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc0ID09IDEpe1xyXG4gICAgICAgICAgICBjYXJkID0gXCLotaLogIXmiaMgXCI7XHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzQgPT0gMil7XHJcbiAgICAgICAgICAgIGNhcmQgPSBcIuaIv+S4u+aJoyBcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubGFiZWxPdmVydmlldy5zdHJpbmcgPSBcIuaooeW8jyA6IFwiK2JpaHVhc2UrenVvemh1YW5nK3B1dG9uZyt3dWd1aSttYVBhaStcIlxcblwiK1wi5YW25LuW77yaXCIrcmVuc2h1K2NhcmQ7XHJcbiAgICAgICAgLy90aGlzLmxhYmVsT3ZlcnZpZXcuc3RyaW5nID0gXCLmqKHlvI8gOiBcIiArIFwiXCIgKyBkZXNrSW5mby5tYXhOdW1iZXIgKyBcIuS6ulwiICtiaWh1YXNlK3p1b3podWFuZytwdXRvbmcrd3VndWkrbWFQYWk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaYr+WQpuaYr+maj+acuuaIv1xyXG4gICAgX2lzUmFuZG9tUm9vbTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mbyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rlc2tJbmZvLmlzUmFuZG9tRGVzaztcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5piv5ZCm5omA5pyJ5bGA5pWw6YO955So5a6M5LqGXHJcbiAgICBfaXNUb3RhbEdhbWVPdmVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmlzRGVza092ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVza0luZm8ubU1heCA8PSB0aGlzLl9kZXNrSW5mby5jSW5kZXg7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaYr+WQpuW3suino+aVo+aIv+mXtFxyXG4gICAgX2lzRGlzc3ZsZWRSb29tOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kZXNrSW5mby5kaXNzb2x2ZVN0YXR1cztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIF9zdGFydENvbXBhcmVDYXJkczogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICB0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9nb25nWGlOaVNob3coZmFsc2UpO1xyXG4gICAgICAgIHRoaXMuX3BsYXllcnMgPSBkYXRhLmRhdGEucGxheWVycztcclxuICAgICAgICBsZXQgdXNlciA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodGhpcy5fdXNlcklkKTtcclxuICAgICAgICBpZighdGhpcy50b3RhbEdhbWVSZXN1bHQuYWN0aXZlKXtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlTdGFydENvbXBhcmUodXNlci5zZXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnN0YXJ0Q29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtwbGF5ZXJDb21wLnJlYWR5VG9Db21wYXJlQ2FyZHMoKTt9KTtcclxuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRDb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93Q29tcGFyZUNhcmREZXRhaWxzKGRhdGEpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSwgMS4wKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3Nob3dDb21wYXJlQ2FyZERldGFpbHM6IGZ1bmN0aW9uIChkYXRhKSB7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucmVhZHlUb0NvbXBhcmVDYXJkcygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgY2FyZFR5cGVDb21iaW5lID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVDb21iaW5lJyk7XHJcblxyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZXNldCgpO1xyXG5cclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IGNvbXBhcmVQbGF5ZXJzMSA9IHRoaXMuX3BsYXllckNvbXBvbmVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuXHJcbiAgICAgICAgICAgIGlmKHBsYXllci5ub2RlLmFjdGl2ZSl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXIgPSBwbGF5ZXIuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCF1c2VyLmlzQ29udGFpbkV4dHJhKSByZXR1cm4gcGxheWVyLm5vZGUuYWN0aXZlO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgdGVTaHVQbGF5ZXJzID0gdGhpcy5fcGxheWVyQ29tcG9uZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYXllcikge1xyXG5cclxuICAgICAgICAgICAgaWYocGxheWVyLm5vZGUuYWN0aXZlKXtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHBsYXllci5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXI7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYodXNlci5pc0NvbnRhaW5FeHRyYSkgcmV0dXJuIHBsYXllci5ub2RlLmFjdGl2ZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gdGhpcy5fc2hvd0NvbXBhcmVDYXJkU3RlcCgwLCBjb21wYXJlUGxheWVyczEpO1xyXG5cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7c2VsZi5fc2hvd0NvbXBhcmVDYXJkU3RlcCgwLCBjb21wYXJlUGxheWVyczEpO30sIGR1cmF0aW9uKTtcclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3NlbGYuX3Nob3dDb21wYXJlQ2FyZFN0ZXAoMCwgY29tcGFyZVBsYXllcnMxKTt9LCBkdXJhdGlvbiAqIDIpO1xyXG5cclxuICAgICAgICBpZih0ZVNodVBsYXllcnMubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtzZWxmLl9zaG93Q29tcGFyZUNhcmRTdGVwKDAsIHRlU2h1UGxheWVycywgdHJ1ZSk7fSwgZHVyYXRpb24gKiAzKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uICogMyArIDAuNTtcclxuXHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRlU2h1UGxheWVycy5sZW5ndGg7IGkrKyl7XHJcblxyXG4gICAgICAgICAgICB2YXIgdXNlciA9IHRlU2h1UGxheWVyc1tpXS5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXI7XHJcblxyXG4gICAgICAgICAgICBpZih1c2VyLmlzQ29udGFpbkV4dHJhKWR1cmF0aW9uID0gZHVyYXRpb24gKyAyLjVcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgc2hvb3REdXJhdGlvbiA9IHRoaXMuaGVhZENhcmRUaW1lO1xyXG5cclxuICAgICAgICBsZXQgc2hvb3REYXRhcyA9IHRoaXMuX3Nob290RGF0YXMoKSB8fCBbXTtcclxuXHJcbiAgICAgICAgbGV0IHNob3REYXRhID0gdGhpcy5fc2hvdERhdGEoKSB8fCBbXTtcclxuXHJcbiAgICAgICAgbGV0IGhvbWVSdW5Vc2VySWQgPSB0aGlzLl9ob21lUnVuVXNlcklkKCk7XHJcblxyXG4gICAgICAgIHZhciBzaG90RGF0YVRpbWVzID0gMDtcclxuXHJcbiAgICAgICAgc2hvdERhdGEuZm9yRWFjaChmdW5jdGlvbiAoZGF0YSwgaW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxmLnBsYXlTaG9vdChkYXRhLmZyb21Vc2VySWQsIGRhdGEudG9Vc2VySWQpO1xyXG5cclxuICAgICAgICAgICAgfSwgZHVyYXRpb24gKyBpbmRleCAqIHNob290RHVyYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgc2hvdERhdGFUaW1lcyArPSBzZWxmLmhlYWRDYXJkVGltZTtcclxuXHJcbiAgICAgICAgICAgIGR1cmF0aW9uICs9IHNlbGYuaGVhZENhcmRUaW1lO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYoaG9tZVJ1blVzZXJJZC5sZW5ndGggPj0gMSl7XHJcblxyXG4gICAgICAgICAgICBzaG9vdERhdGFzLmZvckVhY2goZnVuY3Rpb24gKGRhdGEsIGluZGV4KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnBsYXlTaG9vdChkYXRhLmZyb21Vc2VySWQsIGRhdGEudG9Vc2VySWQpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0sIGR1cmF0aW9uICsgKGluZGV4ICsgc2hvdERhdGFUaW1lcykgKiBzaG9vdER1cmF0aW9uKTtcclxuXHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiArPSBzZWxmLmhlYWRDYXJkVGltZTtcclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyBzaG9vdERhdGFzLmxlbmd0aCAqIHNob290RHVyYXRpb24gKyBzaG90RGF0YS5sZW5ndGggKiBzaG9vdER1cmF0aW9uO1xyXG5cclxuICAgICAgICBpZiAoaG9tZVJ1blVzZXJJZCA+IDApIHtcclxuXHJcbiAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtzZWxmLnBsYXlIb21lUnVuKGhvbWVSdW5Vc2VySWQpO30sIGR1cmF0aW9uKTtcclxuXHJcbiAgICAgICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhvbWVSdW5Vc2VySWQpIHtcclxuICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbiArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL3RoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHt0aGlzLl9qaW5CaUFjdGlvbigpO30uYmluZCh0aGlzKSwgZHVyYXRpb24pOy8v5pi+56S657uT566X6YeR5biBLy/mmL7npLrnu5PmnpxcclxuICAgICAgICB0aGlzLl9qaW5CaUFjdGlvbihkdXJhdGlvbik7XHJcbiAgICAgICAgLy90aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtwbGF5ZXJDb21wLnNob3dTY29yZVJlc3VsdCgpO30pO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgc2VsZi5fc2hvd0NvbXBhcmVDYXJkRmluaXNoZWQoKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vfS5iaW5kKHRoaXMpLCBkdXJhdGlvbik7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfamluQmlBY3Rpb246IGZ1bmN0aW9uIChkdXJhdGlvbikge1xyXG4gICAgICAgIHZhciBjb21wYXJlUGxheWVyczEgPSB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZpbHRlcihmdW5jdGlvbiAocGxheWVyKSB7cmV0dXJuIHBsYXllci5ub2RlLmFjdGl2ZTt9KTtcclxuXHJcbiAgICAgICAgdmFyIG5leHRUaW1lID0gMDsvL+S4i+S4gOS4quWKqOS9nOW8gOWni+eahOaXtumXtFxyXG5cclxuICAgICAgICB2YXIgelRpbWUgPSAwOy8v5LiL5LiL5LiA5Liq5Yqo5L2c5byA5aeL55qE5pe26Ze0XHJcblxyXG4gICAgICAgIHZhciBzdGFydCA9IDA7XHJcblxyXG4gICAgICAgIHZhciBlbmQgPSAwO1xyXG5cclxuICAgICAgICB2YXIgY29pbnNDb250YWluZXJBeXkgPSBbXTsgLy/miYDmnInnmoTnlKjmiLfnmoTph5HluIEg5LiA5Liq55So5oi35LiA5Liq5pWw57uEXHJcblxyXG4gICAgICAgIHZhciBjb2luc0F5eSA9IFtdOyAvL+aJgOacieeahOmHkeW4ge+8jOS4gOS4quaVsOe7hFxyXG5cclxuICAgICAgICB0aGlzLnBsYXlzQ29pbnMuZm9yRWFjaChmdW5jdGlvbihubyl7aWYobm8pIG5vLnJlbW92ZUFsbENoaWxkcmVuKCk7fSk7XHJcblxyXG4gICAgICAgIGNvbXBhcmVQbGF5ZXJzMS5mb3JFYWNoKGZ1bmN0aW9uKHBsYXlzLCBpbmRleCl7Ly/moLnmja7np6/liIbliJvlu7rph5HluIFcclxuXHJcbiAgICAgICAgICAgIHZhciBjU2NvcmUgPSBwbGF5cy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXIuY1Njb3JlO1xyXG5cclxuICAgICAgICAgICAgaWYoY1Njb3JlIDwgMCl7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIGNTY29yZSAqPSAtMTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IG5ldyBjYy5Ob2RlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgbm9kZS5uYW1lID0gXCJjb2luc0NvbnRhaW5lclwiO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBudW1TY29yZSA9ICBjU2NvcmUgPiAzMCA/IDMwOmNTY29yZTtcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDAgO2kgPCBudW1TY29yZSA7aSsrKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jcmVhdGVKaW5CaVByZWZhYihub2RlLCBub2RlKTsvL+agueaNruenr+WIhuWIm+W7uumHkeW4gVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMucGxheXNDb2luc1tpbmRleF0uYWRkQ2hpbGQobm9kZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29pbnNDb250YWluZXJBeXkucHVzaChub2RlLmNoaWxkcmVuKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5c0NvaW5zLmZvckVhY2goZnVuY3Rpb24obm8pe2lmKG5vKSBuby5hY3RpdmUgPSBmYWxzZTt9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7Ly/mmL7npLrnu5PmnpxcclxuXHJcbiAgICAgICAgICAgIHRoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vKXtpZihubykgbm8uYWN0aXZlID0gdHJ1ZTt9KTtcclxuXHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5jb2luSW5jb21lKCk7XHJcblxyXG4gICAgICAgICAgICBjb2luc0NvbnRhaW5lckF5eS5mb3JFYWNoKGZ1bmN0aW9uKGNvaW5zQXl5cyl7Ly/miorph5HluIHnp7vliqjliLDlrrnlmahcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW5pdFRpbWUgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IDAuMDAyO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvaW5zQXl5cy5mb3JFYWNoKGZ1bmN0aW9uKGNvaW5zKXsvL+aKiumHkeW4geenu+WKqOWIsOWuueWZqFxyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozOCkgKiB5O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozOCkgKiB4O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZEJhY2tXb3JsZFNwYWNlMSA9IHRoaXMubm9kZS5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoeCwgeSkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgdjIgPSBjb2lucy5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UxKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2lucy5ydW5BY3Rpb24oY2MubW92ZUJ5KDAuMiwgdjIpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgaW5pdFRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpbml0VGltZSA9IGluaXRUaW1lICsgaW50ZXJ2YWw7XHJcblxyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBuZXh0VGltZSA9IGluaXRUaW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvaW5zQXl5ID0gY29pbnNBeXkuY29uY2F0KGNvaW5zQXl5cyk7Ly/miorph5HluIHpm4blkIjliLDkuIDkuKrmlbDnu4RcclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgemNTY29yZSA9IDA7XHJcblxyXG4gICAgICAgICAgICBjb21wYXJlUGxheWVyczEuZm9yRWFjaChmdW5jdGlvbihwbGF5cyl7Ly/orqHnrpfph5HluIFcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY1Njb3JlID0gcGxheXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyLmNTY29yZTtcclxuXHJcbiAgICAgICAgICAgICAgICBjU2NvcmUgPSAgY1Njb3JlID4gMzAgPyAzMDpjU2NvcmU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoY1Njb3JlID4gMCkgemNTY29yZSArPSBjU2NvcmUgKiAxO1xyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBjb2luc0F5eTEgPSBjb2luc0F5eS5zcGxpY2UoemNTY29yZSwgY29pbnNBeXkubGVuZ3RoKTtcclxuXHJcbiAgICAgICAgICAgIGNvaW5zQXl5MS5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe25vZGUucGFyZW50LnJlbW92ZUNoaWxkKG5vZGUpO30pO1xyXG5cclxuICAgICAgICAgICAgY29tcGFyZVBsYXllcnMxLmZvckVhY2goZnVuY3Rpb24ocGxheXMpey8v5oqK6YeR5biB5Yiw55So5oi35aS05YOP6ZmE6L+RXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNTY29yZSA9IHBsYXlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlci5jU2NvcmU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoY1Njb3JlID4gMCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IDAuMDAyNTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRUaW1lID0gbmV4dFRpbWUgKyAxO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbnVtU2NvcmUgPSAgY1Njb3JlID4gMzAgPyAzMDpjU2NvcmU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vZW5kICs9IG51bVNjb3JlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb2luc0F5eS5zcGxpY2UoMCwgbnVtU2NvcmUpLmZvckVhY2goZnVuY3Rpb24oY29pbnNOb2RlKXsvL+aKiumHkeW4geWIsOeUqOaIt+WktOWDj+mZhOi/kVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/ojrflj5boioLngrnnmoTkuJbnlYzlnZDmoIdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYXJkQmFja1dvcmxkU3BhY2UxID0gcGxheXMubm9kZS5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoMCwgMCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/ojrflj5bnm7jlr7nniLboioLngrnmiYDlnKjnmoTlnZDmoIdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZXRhaWwgPSBjb2luc05vZGUuY29udmVydFRvTm9kZVNwYWNlQVIoY2FyZEJhY2tXb3JsZFNwYWNlMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vdmVCeSA9IGNjLm1vdmVCeSgwLjI1LCBkZXRhaWwpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0RmFkZUluID0gY2MuZmFkZU91dCgwLjEzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW92ZVNlcSA9Y2Muc2VxdWVuY2UobW92ZUJ5LG5leHRGYWRlSW4pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvaW5zTm9kZS5ydW5BY3Rpb24obW92ZVNlcSkgO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgaW5pdFRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdFRpbWUgPSBpbml0VGltZSArIGludGVydmFsO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL3N0YXJ0ICs9IGNTY29yZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgelRpbWUgPSBpbml0VGltZTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7Ly/mmL7npLrnu5PmnpxcclxuXHJcbiAgICAgICAgICAgICAgICAvL3RoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vKXtpZihubykgbm8uYWN0aXZlID0gZmFsc2U7fSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2hvd0NvbXBhcmVDYXJkRmluaXNoZWQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb21wYXJlUGxheWVyczEuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge3BsYXllckNvbXAuc2hvd1Njb3JlUmVzdWx0KCk7fSk7XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIHpUaW1lKTtcclxuXHJcblxyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHsvL+aYvuekuue7k+aenFxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vKXtpZihubykgbm8ucmVtb3ZlQWxsQ2hpbGRyZW4oKTt9KTtcclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgelRpbWUgKyA1KTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCBkdXJhdGlvbik7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfY3JlYXRlSmluQmlQcmVmYWI6IGZ1bmN0aW9uIChub2RlLHYyTm9kZSkge1xyXG5cclxuICAgICAgICB2YXIgbm9kZXMgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmNvaW5zUHJlZmFiKTtcclxuXHJcbiAgICAgICAgdmFyIHkgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkpID09IDAgPyAtMSA6IDE7XHJcblxyXG4gICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMzgpICogeSArIHYyTm9kZS55O1xyXG5cclxuICAgICAgICB2YXIgeCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcclxuXHJcbiAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozOCkgKiB4ICsgdjJOb2RlLng7XHJcblxyXG4gICAgICAgIG5vZGVzLnggPSB4O1xyXG5cclxuICAgICAgICBub2Rlcy55ID0geTtcclxuXHJcbiAgICAgICAgbm9kZS5hZGRDaGlsZChub2Rlcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zaG93Q29tcGFyZUNhcmRTdGVwOiBmdW5jdGlvbiAoc3RhcnRUaW1lID0gMCwgY29tcGFyZVBsYXllcnMgPSBbXSwgaXNDb250YWluRXh0cmEgPSBmYWxzZSkge1xyXG4gICAgICAgIHZhciBkdXJhdGlvbiA9IHN0YXJ0VGltZTtcclxuICAgICAgICBsZXQgaW50ZXJ2YWwgPSB0aGlzLmhlYWRDYXJkVGltZTtcclxuICAgICAgICBsZXQgdGVzaHVUaW1lID0gMDtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgIGNvbXBhcmVQbGF5ZXJzID0gY29tcGFyZVBsYXllcnMuc29ydChmdW5jdGlvbiAocGxheWVyMSwgcGxheWVyMikge1xyXG4gICAgICAgICAgICByZXR1cm4gcGxheWVyMS5uZXh0Q29tcGFyZVNjb3JlKCkgLSBwbGF5ZXIyLm5leHRDb21wYXJlU2NvcmUoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIGNvPWNvbXBhcmVQbGF5ZXJzO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coY28pXHJcbiAgICAgICAgLy9jb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLeaJp+ihjOS6huWHoOasoScpXHJcblxyXG4gICAgICAgIGNvLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG5cclxuICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLnNob3dOZXh0Q29tcGFyZUNhcmRzKCk7XHJcbiAgICAgICAgICAgIH0sIGR1cmF0aW9uICsgdGVzaHVUaW1lKTtcclxuXHJcbiAgICAgICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyBpbnRlcnZhbDtcclxuICAgICAgICAgICAgdmFyIHVzZXIgPSBwbGF5ZXIuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyO1xyXG4gICAgICAgICAgICBpZih1c2VyLmlzQ29udGFpbkV4dHJhKXtcclxuICAgICAgICAgICAgICAgIGlmKHVzZXIuY2FyZEluZm9bMF0udHlwZSA9PSAxMCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHt0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiYW5pbWF0aW9uXCIpLl9zYW50b25naHVhQW5pbWF0aW9uKCk7fSxkdXJhdGlvbiAtIDEgKyB0ZXNodVRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0ZXNodVRpbWUgKz0gMi41O1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYodXNlci5jYXJkSW5mb1swXS50eXBlID09IDExKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3RoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuX3NhbnNodW56aUFuaW1hdGlvbigpOyB9LCBkdXJhdGlvbiAtIDEgKyB0ZXNodVRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0ZXNodVRpbWUgKz0gMi41O1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYodXNlci5jYXJkSW5mb1swXS50eXBlID09IDEyKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3RoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuX2xpdWR1aWJhbkFuaW1hdGlvbigpO30sIGR1cmF0aW9uIC0gMSArIHRlc2h1VGltZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRlc2h1VGltZSArPSAyLjU7XHJcblxyXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYodXNlci5jYXJkSW5mb1swXS50eXBlID09IDE4KXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3RoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuX3Fpbmdsb25nQW5pYW10aW9uKCdsb25nJyk7fSwgZHVyYXRpb24gLSAxICsgdGVzaHVUaW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGVzaHVUaW1lICs9IDIuNTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKHVzZXIuY2FyZEluZm9bMF0udHlwZSA9PSAxOSl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHt0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiYW5pbWF0aW9uXCIpLl9xaW5nbG9uZ0FuaWFtdGlvbihcInFsXCIpO30sIGR1cmF0aW9uIC0gMSArIHRlc2h1VGltZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRlc2h1VGltZSArPSAyLjU7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmKGlzQ29udGFpbkV4dHJhKXtcclxuXHJcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBjby5sZW5ndGg7IGkrKykgZHVyYXRpb24gPSBkdXJhdGlvbiArIDIuNVxyXG5cclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgIGlmKHBsYXllci5ub2RlLmFjdGl2ZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd05leHRDb21wYXJlU2NvcmUoaXNDb250YWluRXh0cmEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGR1cmF0aW9uIC0gaW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGNvLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBsYXllci5zaG93TmV4dENvbXBhcmVTY29yZSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgZHVyYXRpb24gLSBpbnRlcnZhbCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGR1cmF0aW9uICsgdGVzaHVUaW1lO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaXNHYW1lT3ZlcjogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5q+U54mM5a6M5oiQ5ZCO5Lya6LCD55So55qE5pa55rOVXHJcbiAgICBfc2hvd0NvbXBhcmVDYXJkRmluaXNoZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnRpbWVTdGFydCg1LFwicmVhZHlcIik7XHJcbiAgICAgICAgdGhpcy5fc2hvd09uZUdhbWVSZXN1bHQoKTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzLnB1c2godGhpcy5fZGVza0luZm8uY0luZGV4KTtcclxuICAgICAgICAvKiovXHJcbiAgICB9LFxyXG5cclxuICAgIC8vbmV0d29ya1xyXG4gICAgc2hvd05ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKG1zZyA9IFwi572R57uc6ZO+5o6l5pat5byA77yM6YeN5paw6L+e5o6l5LitLi4uXCIpIHtcclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAmJiB0aGlzLm5ldHdvcmtOb2RlLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVTZWxmQWN0aW9uID0gY2MucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLm5ldHdvcmtOb2RlKTtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYubmV0d29ya05vZGUgPSBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICAgICAgY29tcC5hbGVydCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBoaWRkZW5OZXR3b3JrTWVzc2FnZTpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dBbGVydE1lc3NhZ2U6IGZ1bmN0aW9uKG1zZywgYXV0b0Rpc21pc3MpIHtcclxuICAgICAgICBsZXQgYWxlcnRDb21wID0gdGhpcy5hbGVydC5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmFsZXJ0LmFjdGl2ZSkge1xyXG4gICAgICAgICAgICBhbGVydENvbXAuYWxlcnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGFsZXJ0Q29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICAgICAgYWxlcnRDb21wLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICBpZiAoYXV0b0Rpc21pc3MpIHtcclxuICAgICAgICAgICAgYWxlcnRDb21wLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydENvbXAuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgICAgICB9LCA1KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vY2hlY2tOb2RlXHJcbiAgICBzaG93Q2hlY2tNZXNzYWdlOmZ1bmN0aW9uKG1zZyA9ICfmo4Dmn6XnvZHnu5zkuK0uLi4nKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tOb2RlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIHJlbW92ZVNlbGZBY3Rpb24gPSBjYy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoZWNrTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMuY2hlY2tOb2RlKTtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMuY2hlY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLmNoZWNrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgICBjb21wLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGRlbkNoZWNrTWVzc2FnZTpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5jaGVja05vZGUgIT0gbnVsbCAmJiB0aGlzLmNoZWNrTm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vLy8vICDogYrlpKnor63pn7PpgLvovpFcclxuICAgIC8vIF9yZWdpc3RlclZvaWNlTm9kZUV2ZW50czogZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgIC8vICAgICBsZXQgY2hhdFZvaWNlTm9kZSA9IHRoaXMuYnRuQ2hhdFZvaWNlLm5vZGU7XHJcbiAgICAvLyAgICAgdGhpcy5lbmRSZWNvcmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIC8vICAgICBjaGF0Vm9pY2VOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAvLyAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gc2VsZi5lbmRSZWNvcmRUaW1lID49IDEwMDApIHtcclxuICAgIC8vICAgICAgICAgICAgIHNlbGYubmF0aXZlUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAvLyAgICAgICAgICAgICAvL3NlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgLy8gICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMS4yKTtcclxuICAgIC8vICAgICAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcblxyXG4gICAgLy8gICAgICAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSB0cnVlO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIC8vICAgICAgICAgaWYgKHNlbGYuX2lzUmVjb3JkaW5nKSB7XHJcbiAgICAvLyAgICAgICAgICAgICBzZWxmLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gZmFsc2U7XHJcblxyXG4gICAgLy8gICAgICAgICBzZWxmLm5hdGl2ZUVuZFJlY29yZEFjdGlvbigpO1xyXG4gICAgLy8gICAgICAgICAvL3NlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgIC8vICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMSk7XHJcbiAgICAvLyAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIC8vICAgICAgICAgaWYgKHNlbGYuX2lzUmVjb3JkaW5nKSB7XHJcbiAgICAvLyAgICAgICAgICAgICBzZWxmLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gZmFsc2U7XHJcblxyXG4gICAgLy8gICAgICAgICBzZWxmLm5hdGl2ZUVuZFJlY29yZEFjdGlvbigpO1xyXG4gICAgLy8gICAgICAgICAvL3NlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgIC8vICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMSk7XHJcbiAgICAvLyAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgU29ja2V0Lmluc3RhbmNlLnVwbG9hZEZpbmlzaCA9IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgLy8gICAgICAgICBsZXQgdXNlcklkID0gc2VsZi5fdXNlcklkO1xyXG4gICAgLy8gICAgICAgICBTb2NrZXQuc2VuZEF1ZGlvTWVzc2FnZSh1c2VySWQsIHVybCk7XHJcbiAgICAvLyAgICAgICAgIHNlbGYucGxheVNwZWFrQW5pbWF0aW9uKHNlbGYuX3VzZXJJZCk7XHJcbiAgICAvLyAgICAgfTtcclxuICAgIC8vIH0sXHJcblxyXG4gICAgX3JlZ2lzdGVyVm9pY2VOb2RlRXZlbnRzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGxldCBjaGF0Vm9pY2VOb2RlID0gdGhpcy5idG5DaGF0Vm9pY2Uubm9kZTtcclxuICAgICAgICB0aGlzLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIGNoYXRWb2ljZU5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgLy8gc2VsZi5Wb2ljZU1zZ0JnQW5pbWF0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICAgICAgdmFyIHJ1blRpbWUgPSAwLjNcclxuICAgICAgICAgICAgICAgIHZhciB0aXNoaSA9IGNjLmluc3RhbnRpYXRlKHNlbGYuYXV0b1Rpc2hpKTtcclxuICAgICAgICAgICAgICAgIHNlbGYubm9kZS5hZGRDaGlsZCh0aXNoaSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gY2Muc3Bhd24oIGNjLm1vdmVUbygwLjMsIGNjLnYyKDAsIDApKSxjYy5mYWRlSW4oMC4zKSk7XHJcbiAgICAgICAgICAgICAgICB0aXNoaS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgdGlzaGkucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gY2Muc2VxdWVuY2UoIGNjLnNwYXduKGNjLmZhZGVPdXQocnVuVGltZSksY2MubW92ZVRvKHJ1blRpbWUsY2MudjIoMCwgNTApKSksZmluaXNoZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRpc2hpLnJ1bkFjdGlvbiggYWN0aW9uICk7XHJcbiAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgMS41KTtcclxuICAgICAgICAgICAgICAgIC8vdmFyIHVybCA9IFwid3d3LmJhaWR1LmNvbVwiO1xyXG4gICAgICAgICAgICAgICAgLy9sZXQgdXNlcklkID0gc2VsZi5fdXNlcklkO1xyXG4gICAgICAgICAgICAgICAgLy9Tb2NrZXQuc2VuZEF1ZGlvTWVzc2FnZSh1c2VySWQsIHVybCk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSBzZWxmLmVuZFJlY29yZFRpbWUgPj0gMTAwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuVm9pY2VNc2dCZ0FuaW1hdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubmF0aXZlUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMS4yKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmJ0bkNoYXRWb2ljZS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNoYXRWb2ljZU5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHNlbGYuVm9pY2VNc2dCZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHNlbGYuX2lzUmVjb3JkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBzZWxmLm5hdGl2ZUVuZFJlY29yZEFjdGlvbigpO1xyXG4gICAgICAgICAgICAvL3NlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMSk7XHJcbiAgICAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgc2VsZi5Wb2ljZU1zZ0JnLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5faXNSZWNvcmRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuZW5kUmVjb3JkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHNlbGYubmF0aXZlRW5kUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAgICAgICAgIC8vc2VsZi52b2ljZVJlY29yZEFuaW1hdGlvbk5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBsZXQgYWN0aW9uID0gY2Muc2NhbGVUbygwLjEyLCAxKTtcclxuICAgICAgICAgICAgc2VsZi5idG5DaGF0Vm9pY2Uubm9kZS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBTb2NrZXQuaW5zdGFuY2UudXBsb2FkRmluaXNoID0gZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgICAgIGxldCB1c2VySWQgPSBzZWxmLl91c2VySWQ7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kQXVkaW9NZXNzYWdlKHVzZXJJZCwgdXJsKTtcclxuICAgICAgICAgICAgc2VsZi5wbGF5U3BlYWtBbmltYXRpb24oc2VsZi5fdXNlcklkKTtcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuICAgIFZvaWNlTXNnQmdBbmltYXRpb246ZnVuY3Rpb24oKXtcclxuICAgICAgICB0aGlzLlZvaWNlTXNnQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB2YXIgd2hpbGVMYXlvdXQgPSB0aGlzLlZvaWNlTXNnQmcuZ2V0Q2hpbGRCeU5hbWUoXCJ3aGlsZUxheW91dFwiKTtcclxuICAgICAgICB2YXIgY2hpbGRXaGlsZSA9IHdoaWxlTGF5b3V0LmdldENoaWxkQnlOYW1lKFwiY2hpbGRXaGlsZVwiKTtcclxuICAgICAgICBpZiggdGhpcy53aGlsZUxheW91dEludGVydmFsICl7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy53aGlsZUxheW91dEludGVydmFsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMud2hpbGVMYXlvdXRJbnRlcnZhbCA9ICBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIgbm9kZSA9IGNjLmluc3RhbnRpYXRlKGNoaWxkV2hpbGUpO1xyXG4gICAgICAgICAgICBpZih3aGlsZUxheW91dC5jaGlsZHJlbi5sZW5ndGg+NSl7XHJcbiAgICAgICAgICAgICAgICB3aGlsZUxheW91dC5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHdoaWxlTGF5b3V0LmFkZENoaWxkKG5vZGUpO1xyXG4gICAgICAgIH0sMjAwKVxyXG5cclxuICAgICAgICB2YXIgbGF5b3V0ID0gdGhpcy5Wb2ljZU1zZ0JnLmdldENoaWxkQnlOYW1lKFwibGF5b3V0XCIpO1xyXG4gICAgICAgIHZhciBjV2hpbGUgPSBsYXlvdXQuZ2V0Q2hpbGRCeU5hbWUoXCJ3aGlsZVwiKTtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgaWYoIHRoaXMubGF5b3V0SW50ZXJ2YWwgKXtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmxheW91dEludGVydmFsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubGF5b3V0SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIgbm9kZSA9IGNjLmluc3RhbnRpYXRlKGNXaGlsZSk7XHJcbiAgICAgICAgICAgIGlmKGxheW91dC5jaGlsZHJlbi5sZW5ndGg+Myl7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsYXlvdXQuYWRkQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgfSwzMDApXHJcbiAgICB9LFxyXG4gICAgbmF0aXZlUmVjb3JkQWN0aW9uOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwicmVjb3JkXCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWQgY29tLmxsaW5nLnFpYW5qaWFuZ2x6Z1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwicmVjb3JkXCIsIFwiKClWXCIpO1xyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGF1c2VNdXNpYygpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgbmF0aXZlRW5kUmVjb3JkQWN0aW9uOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwiZW5kUmVjb3JkXCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImVuZFJlY29yZFwiLCBcIigpVlwiKTtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnJlc3VtZU11c2ljKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBwbGF5QXVkaW9Vcmw6ZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTI1NTNcIik7XHJcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJwbGF5VXJsOlwiLHVybCk7XHJcbiAgICAgICAgfSBlbHNlIGlmKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJwbGF5VXJsXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiAg6YCA5Ye65ri45oiP6YC76L6RXHJcbiAgICBfaGFuZGxlVXBkYXRlRGVza0luZm9BYm91dEV4aXRSb29tOiBmdW5jdGlvbihkZXNrSW5mbykge1xyXG4gICAgICAgIGlmICghZGVza0luZm8uaXNEaXNzb2x2aW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGRhdGFJbmZvcyA9IGRlc2tJbmZvLmRpc3NvbHZlQW5zd2VySW5mbztcclxuXHJcbiAgICAgICAgbGV0IGFsZXJ0Q29tcCA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG5cclxuICAgICAgICBhbGVydENvbXAuYWxlcnQoKTtcclxuXHJcbiAgICAgICAgYWxlcnRDb21wLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb250ZW50QW5zb3dlckV4aXROb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oaSl7aS5hY3RpdmUgPSBmYWxzZTt9KTtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJJbmZvLGluZGV4KXtcclxuXHJcbiAgICAgICAgICAgIHZhciBwbGF5ID0gdGhpcy5jb250ZW50QW5zb3dlckV4aXROb2RlLmNoaWxkcmVuW2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcIm5pY2tuYW1lXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGJhY2sgPSBwbGF5LmdldENoaWxkQnlOYW1lKFwiZmFuemh1XCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGltZyA9IHBsYXkuZ2V0Q2hpbGRCeU5hbWUoXCJhdmF0YXJfYmdcIik7XHJcblxyXG4gICAgICAgICAgICB2YXIgc3RyID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcImlkXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGRhdGFJbmZvID0gZGF0YUluZm9zW2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgIHBsYXkuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIG5hbWUuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBwbGF5ZXJJbmZvLm5pY2tuYW1lO1xyXG5cclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gcGxheWVySW5mby5pZCl7Ly/mmL7npLrmiL/kuLtcclxuXHJcbiAgICAgICAgICAgICAgICBiYWNrLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuXHJcbiAgICAgICAgICAgICAgICBiYWNrLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjYy5sb2FkZXIubG9hZCh7dXJsOnBsYXllckluZm8uYXZhdGFyVXJsLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKGRhdGEpO1xyXG5cclxuICAgICAgICAgICAgICAgIGltZy5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IGZyYW1lO1xyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgIGlmKGRhdGFJbmZvID09IDEpe1xyXG5cclxuICAgICAgICAgICAgICAgIHN0ci5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi5ZCM5oSPXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuXHJcbiAgICAgICAgICAgICAgICBzdHIuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIGxldCBkaXNzb2x2ZUxlZnRUaW1lID0gZGVza0luZm8uZGlzc29sdmVMZWZ0VGltZSB8fCA2MDtcclxuXHJcbiAgICAgICAgbGV0IGNvdW50ZG93biA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKTtcclxuXHJcbiAgICAgICAgY291bnRkb3duLnN0YXJ0Q291bnRkb3duKGRpc3NvbHZlTGVmdFRpbWUsIGZ1bmN0aW9uKGlzVGltZW91dCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKGlzVGltZW91dCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGlja0FncmVlT3RoZXJQbGF5ZXJFeGl0KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgbGV0IGRpc3NvbHZlVXNlcklkID0gZGVza0luZm8uZGlzc29sdmVVc2VySWQ7XHJcblxyXG4gICAgICAgIGlmIChkaXNzb2x2ZVVzZXJJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBhbGVydF9iZyA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJhbGVydF9iZ1wiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBidG5BZ3JlZSA9IGFsZXJ0X2JnLmdldENoaWxkQnlOYW1lKFwiYnRuQWdyZWVcIik7XHJcblxyXG4gICAgICAgICAgICB2YXIgYnRuRGlzYWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkRpc2FncmVlXCIpO1xyXG5cclxuICAgICAgICAgICAgYnRuQWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBidG5EaXNhZ3JlZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy90aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q29uZmlybUJ1dHRvbi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL2xldCBhbGVydCA9IHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgICAgICAvL2FsZXJ0LnNldE1lc3NhZ2UoXCLmgqjmraPlnKjnlLPor7fljY/llYbpgIDlh7rvvIznrYnlvoXlhbbku5bnjqnlrrblkIzmhI9cIik7XHJcbiAgICAgICAgICAgIC8vdGhpcy5hbGVydFJlcXVlc3RFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0YXJ0Q291bnRkb3duKGRpc3NvbHZlTGVmdFRpbWUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgLy9sZXQgZGlzc29sdmVBbnN3ZXJJbmZvcyA9IGRlc2tJbmZvLmRpc3NvbHZlQW5zd2VySW5mbztcclxuICAgICAgICAvL2xldCBjdXJyZW50VXNlcklkSW5kZXggPSBkZXNrSW5mby5wbGF5ZXJzSW5kZXguZmluZEluZGV4KGZ1bmN0aW9uKHVzZXJJZCkge1xyXG4gICAgICAgIC8vICAgIHJldHVybiB0aGlzLl91c2VySWQgPT0gdXNlcklkO1xyXG4gICAgICAgIC8vfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vbGV0IGFuc3dlclJlc3VsdCA9IGRpc3NvbHZlQW5zd2VySW5mb3NbY3VycmVudFVzZXJJZEluZGV4XTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vaWYgKGFuc3dlclJlc3VsdCA9PSAtMSkge1xyXG4gICAgICAgIC8vICAgIC8vIC0xIOihqOekuuacquWkhOeQhiAgMCDooajnpLrmi5Lnu50gIDHooajnpLrlkIzmhI9cclxuICAgICAgICAvLyAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICBsZXQgY291bnRkb3duID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgY291bnRkb3duLnN0YXJ0Q291bnRkb3duKGRpc3NvbHZlTGVmdFRpbWUsIGZ1bmN0aW9uKGlzVGltZW91dCkge1xyXG4gICAgICAgIC8vICAgICAgICBpZiAoaXNUaW1lb3V0KSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLmNsaWNrQWdyZWVPdGhlclBsYXllckV4aXQoKTtcclxuICAgICAgICAvLyAgICAgICAgfVxyXG4gICAgICAgIC8vICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL31cclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8vIOehruWumuimgeW8uuWItumAgOWHuua4uOaIj1xyXG4gICAgY2xpY2tDb25maXJtRm9yY2VFeGl0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICBTb2NrZXQuc2VuZEZvcmNlRXhpdFJvb20odGhpcy5fdXNlcklkKTtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g56Gu6K6k6K+35rGC6YCA5Ye65ri45oiPXHJcbiAgICBjbGlja0NvbmZpcm1SZXF1ZXN0RXhpdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENhbmNlbEJ1dHRvbi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENvbmZpcm1CdXR0b24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBsZXQgYWxlcnQgPSB0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jSW5kZXg+MCl7XHJcbiAgICAgICAgICAgIGFsZXJ0LnNldE1lc3NhZ2UoXCLmgqjmraPlnKjnlLPor7fljY/llYbpgIDlh7rvvIznrYnlvoXlhbbku5bnjqnlrrblkIzmhI9cIik7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdGFydENvdW50ZG93big2MCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFNvY2tldC5zZW5kTGVhdmVEZXNrKHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOWQjOaEj+S7luS6uumAgOWHulxyXG4gICAgY2xpY2tBZ3JlZU90aGVyUGxheWVyRXhpdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIC8vdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIC8vdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0b3AoKTtcclxuICAgICAgICB2YXIgYWxlcnRfYmcgPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENoaWxkQnlOYW1lKFwiYWxlcnRfYmdcIik7XHJcbiAgICAgICAgdmFyIGJ0bkFncmVlID0gYWxlcnRfYmcuZ2V0Q2hpbGRCeU5hbWUoXCJidG5BZ3JlZVwiKTtcclxuICAgICAgICB2YXIgYnRuRGlzYWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkRpc2FncmVlXCIpO1xyXG4gICAgICAgIGJ0bkFncmVlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGJ0bkRpc2FncmVlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIFNvY2tldC5zZW5kQW5zd2VyRGlzc29sdmUodGhpcy5fdXNlcklkLCAxKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5LiN5ZCM5oSP5LuW5Lq66YCA5Ye6XHJcbiAgICBjbGlja0Rpc2FncmVlT3RoZXJQbGF5ZXJFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy90aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgLy90aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgLy90aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgICAgIHZhciBhbGVydF9iZyA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJhbGVydF9iZ1wiKTtcclxuICAgICAgICB2YXIgYnRuQWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkFncmVlXCIpO1xyXG4gICAgICAgIHZhciBidG5EaXNhZ3JlZSA9IGFsZXJ0X2JnLmdldENoaWxkQnlOYW1lKFwiYnRuRGlzYWdyZWVcIik7XHJcbiAgICAgICAgYnRuQWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgYnRuRGlzYWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgU29ja2V0LnNlbmRBbnN3ZXJEaXNzb2x2ZSh0aGlzLl91c2VySWQsIDApO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDpmpDol4/or7fmsYLpgIDlh7ogTm9kZVxyXG4gICAgX2hpZGVSZXFlc3RFeGl0Tm9kZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLy8vIOaJk+aeqlxyXG4gICAgcGxheVNob290OiBmdW5jdGlvbiAoZnJvbVVzZXJJZCwgdG9Vc2VySWQpIHtcclxuICAgICAgICBsZXQgdXNlciA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQoZnJvbVVzZXJJZCk7XHJcbiAgICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlIdW1hbkRhUWlhbmcodXNlci5zZXgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHRvVXNlckluZGV4ID0gdGhpcy5fZmluZFBsYXllckluZGV4QnlVc2VySWQodG9Vc2VySWQpO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICBpZih0aGlzLl91c2VySWQgPT0gZnJvbVVzZXJJZCB8fCB0aGlzLl91c2VySWQgPT0gdG9Vc2VySWQpIHBsYXllci5zaG93TmV4dENvbXBhcmVTY29yZSgpO1xyXG4gICAgICAgICAgICBwbGF5ZXIucGxheVNob290QW5pbWF0aW9uKGZyb21Vc2VySWQsIHRvVXNlckluZGV4KTtcclxuICAgICAgICAgICAgcGxheWVyLnBsYXlCdWxsZXRIb2xlQW5pbWF0aW9uKHRvVXNlcklkKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmkq3mlL7lhajlnpLmiZPliqjmlYhcclxuICAgIHBsYXlIb21lUnVuOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgbGV0IHVzZXIgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHVzZXJJZCk7XHJcbiAgICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlIb21lUnVuKHVzZXIuc2V4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudChcImFuaW1hdGlvblwiKS5fcXVhbmxlaWRhQW5pbWF0aW9uKCdsb25nJyk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcblxyXG4gICAgICAgICAgICBwbGF5ZXIuc2hvd05leHRDb21wYXJlU2NvcmUoKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHBsYXlTcGVha0FuaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5wbGF5U3BlYWtBbmltYXRpb24odXNlcklkKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX3Nob290RGF0YXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgaG9tZVJ1blVzZXJJZCA9IHRoaXMuX2hvbWVSdW5Vc2VySWQoKTsgLy8g5YWo5Z6S5omTXHJcbiAgICAgICAgbGV0IHNob290RGF0YXMgPSB0aGlzLl9kZXNrSW5mby5zaG90RGF0YS5maWx0ZXIoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGEuZnJvbVVzZXJJZCA9PSBob21lUnVuVXNlcklkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBzaG9vdERhdGFzO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc2hvdERhdGE6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgaG9tZVJ1blVzZXJJZCA9IHRoaXMuX2hvbWVSdW5Vc2VySWQoKTsgLy8g5omT5p6qXHJcbiAgICAgICAgbGV0IHNob3REYXRhID0gdGhpcy5fZGVza0luZm8uc2hvdERhdGEuZmlsdGVyKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmZyb21Vc2VySWQgIT0gaG9tZVJ1blVzZXJJZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2hvdERhdGE7XHJcbiAgICB9LFxyXG5cclxuICAgIF9ob21lUnVuVXNlcklkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rlc2tJbmZvLmFsbFNob3REYXRhO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiDmiL/pl7Tkv6Hmga/pg6jliIZcclxuXHJcbiAgICAvLyDojrflj5bmiL/pl7TnmoTnjqnms5VcclxuICAgIF9kZXNrSW5mb0dhbWVXYXk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzM7XHJcbiAgICAgICAgaWYoc2V0dGluZyA9PSBudWxsKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBuYW1lcyA9IFtcIuW6hOWutuaooeW8j1wiLCBcIuaXoOeJueauiueJjFwiLFwi5pmu6YCa5qih5byPXCJdO1xyXG4gICAgICAgIHJldHVybiBuYW1lc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rlc2tJbmZvTnVtYmVyT2ZHYW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgc2V0dGluZyA9IHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxO1xyXG4gICAgICAgIGxldCBpbmZvcyA9IFsnMTDlsYAnLCAnMjDlsYAnLCAnNDDlsYAnLCAnNeWxgCddO1xyXG4gICAgICAgIC8qaWYgKHNldHRpbmcgPD0gMSkge1xyXG4gICAgICAgICByZXR1cm4gJ+adoeaVsO+8micgKyBpbmZvc1tzZXR0aW5nXTtcclxuICAgICAgICAgfSovXHJcbiAgICAgICAgaWYoc2V0dGluZyA9PSAyKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoc2V0dGluZyA9PSAzKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoc2V0dGluZyA9PSA0KXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoc2V0dGluZyA9PSA1KXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAn5bGA5pWw77yaJyArIGluZm9zW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGVza0luZm9OdW1iZXJPZlBlb3BsZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHNldHRpbmcgPSB0aGlzLl9kZXNrSW5mby5zZXR0aW5nMjtcclxuICAgICAgICBsZXQgaW5mb3MgPSBbJzLkuronLCAnM+S6uicsICc05Lq6JywgJzXkuronXTtcclxuICAgICAgICByZXR1cm4gaW5mb3Nbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIF9kZXNrSW5mb1BheUluZm86IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzQ7XHJcbiAgICAgICAgaWYoc2V0dGluZyA9PSBudWxsKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHNldHRpbmcgPT0gMCl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaW5mb3MgPSBbJ+aIv+S4u+mcuOS4u+W6hCcsICfmiL/otLlBQSddO1xyXG4gICAgICAgIHJldHVybiBpbmZvc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rlc2tJbmZvSmlhWWlTZUluZm86IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzcgPT0gMCA/IDEgOiAwO1xyXG4gICAgICAgIGxldCBpbmZvcyA9IFsn5peg5aSa5LiA6ImyJywgJ+WkmuS4gOiJsiddO1xyXG4gICAgICAgIHJldHVybiBpbmZvc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rlc2tJbmZvR3VpUGFpSW5mbzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHNldHRpbmc7XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzggPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc4ID09IDApe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nOCA9PSAxKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpbmZvcyA9IFsn5peg546L54mMJywgJ+S4pOW8oOeOi+eJjCcsICflm5vlvKDnjovniYwnXTtcclxuICAgICAgICByZXR1cm4gaW5mb3Nbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6IOWJqeS9meaXtumXtFxyXG4gICAgX3JlbWFpblRpbWVTdGFydFVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy90aGlzLnNjaGVkdWxlKHRoaXMuX3JlbWFpblRpbWVVcGRhdGUsIDEuMCwgY2MubWFjcm8uUkVQRUFUX0ZPUkVWRVIpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcmVtYWluVGltZVVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzUmFuZG9tUm9vbSgpIHx8IFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaXNUYW9TaHUgPSAodGhpcy5fZGVza0luZm8uc2V0dGluZzEgPT0gMCkgfHwgKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxID09IDEpO1xyXG4gICAgICAgIGlmIChpc1Rhb1NodSkge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuX2Rlc2tJbmZvLmNyZWF0ZVRpbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGxldCBjcmVhdGVUaW1lID0gZmVjaGEucGFyc2UodGhpcy5fZGVza0luZm8uY3JlYXRlVGltZSwgJ1lZWVktTU0tREQgSEg6bW06c3MnKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgbGV0IG9uZUhvdXIgPSA2MCAqIDYwO1xyXG4gICAgICAgIGxldCByZW1haW4gPSAoRGF0ZS5ub3coKSAtIGNyZWF0ZVRpbWUpIC8gMTAwMDtcclxuICAgICAgICByZW1haW4gPSBNYXRoLm1heChvbmVIb3VyIC0gcmVtYWluLCAwKTtcclxuXHJcbiAgICAgICAgbGV0IG1pbnMgPSBNYXRoLmZsb29yKHJlbWFpbiAvIDYwKTtcclxuICAgICAgICBsZXQgc2VjcyA9IE1hdGguZmxvb3IocmVtYWluICUgNjApO1xyXG4gICAgICAgIGlmIChtaW5zID09IDAgJiYgc2VjcyA9PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBtaW5zU3RyaW5nID0gXCJcIiArIG1pbnM7XHJcbiAgICAgICAgaWYgKG1pbnNTdHJpbmcubGVuZ3RoIDwgMikge1xyXG4gICAgICAgICAgICBtaW5zU3RyaW5nID0gXCIwXCIgKyBtaW5zU3RyaW5nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHNlY3NTdHJpbmcgPSBcIlwiICsgc2VjcztcclxuICAgICAgICBpZiAoc2Vjc1N0cmluZy5sZW5ndGggPCAyKSB7XHJcbiAgICAgICAgICAgIHNlY3NTdHJpbmcgPSBcIjBcIiArIHNlY3NTdHJpbmc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgc3RyaW5nID0gXCLliankvZnml7bpl7TvvJowMDpcIiArIG1pbnNTdHJpbmcgKyBcIjpcIiArIHNlY3NTdHJpbmc7XHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUuc3RyaW5nID0gc3RyaW5nO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiDlpITnkIblkIwgSVAg55qE55So5oi3XHJcbiAgICBfaGFuZGxlVGhlU2FtZU9mSVBBZHJlc3M6IGZ1bmN0aW9uKHVzZXJJbmZvcykge1xyXG4gICAgICAgIGlmICghdXNlckluZm9zIHx8IHVzZXJJbmZvcy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaXBVc2VySW5mb3MgPSB1c2VySW5mb3MucmVkdWNlKGZ1bmN0aW9uKGlwcywgdXNlckluZm8pIHtcclxuICAgICAgICAgICAgbGV0IHVzZXJzID0gaXBzW3VzZXJJbmZvLmlwQWRkcmVzc10gfHwgW107XHJcbiAgICAgICAgICAgIHVzZXJzLnB1c2godXNlckluZm8pO1xyXG5cclxuICAgICAgICAgICAgaXBzW3VzZXJJbmZvLmlwQWRkcmVzc10gPSB1c2VycztcclxuICAgICAgICAgICAgcmV0dXJuIGlwcztcclxuICAgICAgICB9LCB7fSk7XHJcblxyXG4gICAgICAgIGxldCBzYW1lSXBVc2VycyA9IG51bGw7XHJcbiAgICAgICAgZm9yIChsZXQgaXAgaW4gaXBVc2VySW5mb3MpIHtcclxuICAgICAgICAgICAgbGV0IHVzZXJzID0gaXBVc2VySW5mb3NbaXBdO1xyXG4gICAgICAgICAgICBpZiAodXNlcnMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgc2FtZUlwVXNlcnMgPSB1c2VycztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc2FtZUlwVXNlcnMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9hbGVydFNhbWVJcFVzZXJJbmZvcyhzYW1lSXBVc2Vycyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9hbGVydFNhbWVJcFVzZXJJbmZvczogZnVuY3Rpb24odXNlcnMpIHtcclxuICAgICAgICBsZXQgbWVzc2FnZSA9IFwiXCI7XHJcbiAgICAgICAgbGV0IHVzZXJJZHMgPSBcIlwiO1xyXG4gICAgICAgIHVzZXJzLmZvckVhY2goZnVuY3Rpb24odXNlciwgaW5kZXgpIHtcclxuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UgKyAoaW5kZXggPiAwID8gJyDlkowgJyA6ICcnKSArIHVzZXIubmlja25hbWU7XHJcbiAgICAgICAgICAgIHVzZXJJZHMgPSB1c2VySWRzICsgdXNlci5pZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICBtZXNzYWdlID0gbWVzc2FnZSArICcg5Zyo5ZCM5LiAIElQIOS4i++8gSc7XHJcblxyXG4gICAgICAgIHRoaXMuX2RpZEFsZXJ0U2FtZUlwTWVzc2FnZSA9IHRoaXMuX2RpZEFsZXJ0U2FtZUlwTWVzc2FnZSB8fCB7fTtcclxuICAgICAgICBpZiAodGhpcy5fZGlkQWxlcnRTYW1lSXBNZXNzYWdlW3VzZXJJZHNdKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd0FsZXJ0TWVzc2FnZShtZXNzYWdlLCB0cnVlKTtcclxuICAgICAgICB0aGlzLl9kaWRBbGVydFNhbWVJcE1lc3NhZ2VbdXNlcklkc10gPSB0cnVlO1xyXG4gICAgfSxcclxuXHJcbn0pO1xyXG5QbGF5LmdvbmdYaU5pU2hvdyA9IGZ1bmN0aW9uICh0eXBlKSB7XHJcbiAgICB0aGlzLmluc3RhbmNlcy5fZ29uZ1hpTmlTaG93KHR5cGUpO1xyXG59O1xyXG5tb2R1bGUuZXhwb3J0cyA9IFBsYXk7XHJcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIHByb2R1Y3RJZDonJyxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuICAgIFxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm9uQ2xpY2tBY3Rpb24odGhpcy5wcm9kdWN0SWQpOyAgICAgICAgXG4gICAgfSxcbiAgICBcbiAgICBvbkNsaWNrQWN0aW9uOmZ1bmN0aW9uKHByb2R1Y3RJZCkge1xuICAgICAgICBcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBtYXRjaGluZ0xhYmVsOmNjLkxhYmVsLFxuICAgICAgICB0aW1lTm9kZTpjYy5Ob2RlLFxuICAgICAgICBtYXRjaGluZ05vZGU6Y2MuTm9kZSxcbiAgICAgICAgd2FpdGluZ1ByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBhbGVydFByZWZhYjogY2MuUHJlZmFiLFxuXG4gICAgICAgIHRpc2hpOmNjLk5vZGUsXG5cbiAgICAgICAgX3VzZXJJZDogbnVsbCxcbiAgICAgICAgX3Jlc3BvbnNlOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3VzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcbiAgICAgIGNjLmlzUm9vbVZpZXdTaG93ID0gdHJ1ZTtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEZXNrSW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZURlc2tJbmZvICx0aGlzKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlNvY2tldERpc2Nvbm5lY3QsIHRoaXMuX3NvY2tldERpc2Nvbm5lY3QsIHRoaXMpO1xuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcy5fc29ja2V0Q29ubmVjdGVkLCB0aGlzKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVJbnRlclJhbmRvbSwgdGhpcy5fc29ja2V0UmVjZWl2ZUludGVyUmFuZG9tLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgX3NvY2tldFJlY2VpdmVEZXNrSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgIH0sXG5cbiAgICBfc29ja2V0UmVjZWl2ZUludGVyUmFuZG9tOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAvL+acjeWKoeWZqOWPkemAgSAgeydhY3Rpb24nOidpbnRlclJhbmRvbScsJ3Jlc3VsdCc6ZmFsc2UsJ2RhdGEnOnsncmVhc29uJzpyZWFzb259fVxuICAgICAgICB0aGlzLl9yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbik7XG4gICAgICAgIC8vIOWkhOeQhumaj+acuuWcuuWMuemFjeS4jeaIkOWKn+eahOaDheWGtVxuICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgcmVhc29uID0gcmVzcG9uc2UuZGF0YS5yZWFzb24gfHwgXCLliqDlhaXpmo/mnLrlnLrlpLHotKVcIjtcbiAgICAgICAgdGhpcy5zaG93QWxlcnRNZXNzYWdlKHJlYXNvbik7XG5cbiAgICAgICAgaWYgKHJlYXNvbiA9PSAn5L2g5bey57uP5Zyo5Yy56YWN6Zif5YiXJykge1xuICAgICAgICAgICAgdGhpcy5fc2hvd01hdGNoaW5nKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlTWF0Y2hpbmcoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfc29ja2V0RGlzY29ubmVjdDogZnVuY3Rpb24oKSB7XG4gICAgICAvLyDov57mjqXlt7Lmlq3lvIBcbiAgICAgIHRoaXMubWF0Y2hpbmdOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5zaG93TmV0d29ya01lc3NhZ2UoJ+e9kee7nOmTvuaOpeaWreW8gO+8jOmHjeaWsOi/nuaOpeS4rS4uLicpO1xuICAgIH0sXG5cbiAgICBfc29ja2V0Q29ubmVjdGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcbiAgICB9LFxuXG5cbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcbiAgICAgIEtRR2xvYmFsRXZlbnQub2ZmVGFyZ2V0KHRoaXMpO1xuICAgIH0sXG5cbiAgICBjbGlja0V4aXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgfSxcblxuICAgIGNsaWNrU3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIFNvY2tldC5zZW5kRW50ZXJSYW5kb20odGhpcy5fdXNlcklkKTtcbiAgICAgIHRoaXMuX3Nob3dNYXRjaGluZygpO1xuXG4gICAgICAvKiMjIyMjYmVnaW4qL1xuICAgICAgLy9yZWFzb27mmK/mnI3liqHlmajlj5HpgIHlm57mnaXnmoRcbiAgICAgIC8qaWYodGhpcy5fcmVzcG9uc2UuZGF0YS5yZWFzb24gPT0gXCLkvaDnmoTpkrvnn7PkuI3otrNcIil7XG4gICAgICAgICAgdGhpcy50aXNoaS5hY3RpdmUgPSB0cnVlO1xuICAgICAgfSovXG4gICAgICAvKiMjIyMjZW5kKi9cblxuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbiwgNSk7XG4gICAgfSxcbiAgICAvKiMjIyMj54K55Ye756m655m95Zyw5pa577yM56CW55+z5LiN6Laz5o+Q56S65raI5aSxKi9cbiAgICAvKm9uQnRuS29uZzpmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMudGlzaGkuYWN0aXZlKXtcbiAgICAgICAgICAgIHRoaXMudGlzaGkuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgLy/ku4DkuYjkuZ/kuI3lgZpcbiAgICAgICAgfVxuICAgIH0sKi9cbiAgICAvKuWPlua2iOWMuemFjSovXG4gICAgY2xpY2tDYW5jZWw6ZnVuY3Rpb24gKCkge1xuICAgICAgU29ja2V0LnNlbmRDYW5jZWxSYW5kb20odGhpcy5fdXNlcklkKTtcblxuICAgICAgdGhpcy5faGlkZU1hdGNoaW5nKCk7XG4gICAgfSxcblxuICAgIF90aW1lb3V0UmFuZG9tQWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5faGlkZU1hdGNoaW5nKCk7XG4gICAgICAgIHRoaXMuc2hvd0FsZXJ0TWVzc2FnZSgn6L+b5YWl5Yy56YWN5aSx6LSlJyk7XG4gICAgfSxcblxuICAgIF9zaG93TWF0Y2hpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMubWF0Y2hpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgICAgICB0aGlzLm1hdGNoaW5nTGFiZWwuc3RyaW5nID0gJ+ato+WcqOWMuemFjeS4re+8jOivt+eojeWQji4uLic7XG4gICAgICAgIGxldCBudW0gPSAwO1xuICAgICAgICB0aGlzLnNjaGVkdWxlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbnVtID0gbnVtICsgMC41O1xuICAgICAgICAgICAgdGhpcy50aW1lTm9kZS5yb3RhdGlvbiA9IG51bTtcbiAgICAgICAgIH0sIDAuMDEpO1xuICAgIH0sXG5cbiAgICBfaGlkZU1hdGNoaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm1hdGNoaW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIGNvbXAuZGlzbWlzc0FjdGlvbigpO1xuICAgIH0sXG5cbiAgICAgc2hvd05ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbik7XG5cbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHJlbW92ZVNlbGZBY3Rpb24gPSBjYy5yZW1vdmVTZWxmKCk7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5uZXR3b3JrTm9kZSk7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5uZXR3b3JrTm9kZSA9IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGhpZGRlbk5ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2hvd0FsZXJ0TWVzc2FnZTogZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIGlmICghbXNnKSB7XG4gICAgICAgICAgICBjYy5lcnJvcihcIuS4jeiDveaYvuekuuS4uuepuueahOS/oeaBr1wiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5hbGVydE1lc3NhZ2VOb2RlKSB7XG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZU5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmFsZXJ0UHJlZmFiKTtcbiAgICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLmFsZXJ0TWVzc2FnZU5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2VOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IFBsYXliYWNrID0gcmVxdWlyZSgnUGxheWJhY2snKTtcbmNvbnN0IHJlY29yZCA9IHJlcXVpcmUoJ3JlY29yZCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB0aW1lTGFiZWw6Y2MuTGFiZWwsICAgLy8g5pe26Ze0XG4gICAgICAgIGp1c2h1TGFiZWw6Y2MuTGFiZWwsICAvLyDlsYDmlbBcbiAgICAgICAgY3JlYXRlVXNlcjpjYy5Ob2RlLCAgIC8vIOaIv+S4u1xuICAgICAgICByb29tSWQ6Y2MuTGFiZWwsICAgICAgLy8g5oi/6Ze05Y+3XG4gICAgICAgIGppZmVuOmNjLkxhYmVsLCAgICAgICAvLyDnp6/liIZcbiAgICAgICAgaWQ6Y2MuTGFiZWwsXG4gICAgICAgIGF2YXRhck5vZGU6Y2MuTm9kZSwgICAvLyDlpLTlg49cbiAgICAgICAgY3JlYXRvckltZzpjYy5Ob2RlLCAgIC8vIOWIm+aIv+WktOWDj1xuICAgICAgICBuaWNrbmFtZUxhYmVsczpjYy5MYWJlbCxcbiAgICAgICAgc2NvcmVMYWJlbHM6W2NjLkxhYmVsXSxcbiAgICAgICAgLy9udW1Ob2RlOmNjLkxhYmVsLFxuICAgICAgICBfcGFyZW50SWQ6IG51bGwsXG4gICAgICAgIC8vcGxheWJhY2tOb2RlOmNjLk5vZGUsLy/lm57mlL7mjInpkq5cbiAgICAgICAgLy93YXRjaE5vZGU6Y2MuTm9kZSwvL+afpeeci+aMiemSrlxuICAgICAgICByZW9yZEluZm86Y2MuTm9kZSxcbiAgICAgICAgX3JlY29yZEl0ZW1JbmZvOiBudWxsLFxuICAgICAgICB0b3RhbEdhbWVSZXN1bHQ6Y2MuTm9kZSxcblxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy50b3RhbEdhbWVSZXN1bHQgPSBjYy5maW5kKFwiQ2FudmFzL3JlY29yZEluZm9cIik7XG4gICAgfSxcblxuICAgIHNldEluZm86IGZ1bmN0aW9uIChyZWNvcmRJbmZvKSB7XG4gICAgICAgIHRoaXMuX3BhcmVudElkID0gcmVjb3JkSW5mby5pZDtcbiAgICAgICAgLy90aGlzLndhdGNoTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAvL3RoaXMucGxheWJhY2tOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBpZiAocmVjb3JkSW5mby5wbGF5ZXJzSW5mby5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHBsYXllcnNJbmZvID0gSlNPTi5wYXJzZShyZWNvcmRJbmZvLnBsYXllcnNJbmZvKTtcbiAgICAgICAgcmVjb3JkSW5mby5zY29yZXMgPSBKU09OLnBhcnNlKCByZWNvcmRJbmZvLnNjb3JlcyApO1xuXG4gICAgICAgIHZhciBmZW4gPSByZWNvcmRJbmZvLnNjb3Jlc1sgdGhpcy5mZW4ocmVjb3JkSW5mby51c2VyaWQscGxheWVyc0luZm8ucGxheWVyc0luZGV4KSBdIDtcbiAgICAgICAgLy9jYy5sb2coZmVuKVxuICAgICAgICAvL2NjLmxvZyhyZWNvcmRJbmZvLnNjb3JlcylcbiAgICAgICAgLy9jYy5sb2codGhpcy5mZW4ocmVjb3JkSW5mby51c2VyaWQscGxheWVyc0luZm8ucGxheWVyc0luZGV4KSlcbiAgICAgICAgLy9jYy5sb2cocmVjb3JkSW5mby51c2VyaWQpXG4gICAgICAgIC8vY2MubG9nKHBsYXllcnNJbmZvLnBsYXllcnNJbmRleClcbiAgICAgICAgLy9jYy5sb2cocmVjb3JkSW5mbylcbiAgICAgICAgLy9jYy5sb2cocGxheWVyc0luZm8pXG4gICAgICAgIC8vY2MubG9nKCctLS0tNDcnKVxuICAgICAgICB0aGlzLmppZmVuLnN0cmluZyA9IChmZW4gPj0gMD9cIitcIitmZW4gOmZlbik7XG5cbiAgICAgICAgdmFyIGhlYWRVcmwgPSBwbGF5ZXJzSW5mby5wbGF5ZXJzWyB0aGlzLmNyZWF0b3IocmVjb3JkSW5mby5jcmVhdGVVc2VySWQscGxheWVyc0luZm8ucGxheWVyc0luZGV4KSBdLmF2YXRhclVybDsgLy8g5aS05YOPVVJMXG4gICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLmF2YXRhck5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6aGVhZFVybCx0eXBlOlwianBnXCJ9LCBmdW5jdGlvbiAoZXJyLCB0ZXgpIHtcbiAgICAgICAgICAgIGlmICghZXJyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKHRleCk7XG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lPWZyYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnJvb21JZC5zdHJpbmcgPSBcIuaIv+WPt++8mlwiKyBwbGF5ZXJzSW5mby5yb29tSWQ7XG4gICAgICAgIHRoaXMudGltZUxhYmVsLnN0cmluZyA9IFwi5pe26Ze077yaXCIgKyBwbGF5ZXJzSW5mby50aW1lLnN1YnN0cig1LDExKTtcbiAgICAgICAgdGhpcy5qdXNodUxhYmVsLnN0cmluZyA9IFwi5bGA5pWw77yaXCIrIHRoaXMuanMocGxheWVyc0luZm8uc2V0dGluZzEtMik7XG5cbiAgICAgICAgIC8vZm9yICh2YXIgaSA9IDA7aSA8IHBsYXllcnNJbmZvLnBsYXllcnMubGVuZ3RoO2krKykge1xuICAgICAgICAgLy8gIHRoaXMubmlja25hbWVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc0luZm8ucGxheWVyc1tpXS5uaWNrbmFtZTtcbiAgICAgICAgIC8vICB0aGlzLnNjb3JlTGFiZWxzW2ldLnN0cmluZyA9IHBsYXllcnNJbmZvLnBsYXllcnNbaV0udG90YWxTY29yZTtcbiAgICAgICAgIC8vfVxuICAgIH0sXG4gICAganM6IGZ1bmN0aW9uKHNldHRpbmcyKXtcbiAgICAgICAgdmFyIGp1c2h1ID0gNTtcbiAgICAgICAgc3dpdGNoKHNldHRpbmcyKXtcbiAgICAgICAgICAgIGNhc2UgMDoganVzaHUgPSA1OyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMToganVzaHUgPSAxMDsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6IGp1c2h1ID0gMjA7IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzOiBqdXNodSA9IDMwOyBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ganVzaHU7XG4gICAgfSxcblxuICAgIGZlbjpmdW5jdGlvbih1c2VyaWQscGxheWVycyl7ICAgICAgICAgLy8g5om+56ev5YiGXG4gICAgICAgIGZvcih2YXIgaSA9MDsgaTxwbGF5ZXJzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgaWYocGxheWVyc1tpXSA9PSB1c2VyaWQpe1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBjcmVhdG9yIDpmdW5jdGlvbihjcmVhdG9yLHBsYXllcnMpeyAgICAvL+WIm+aIv+iAhVxuICAgICAgICBmb3IodmFyIGkgPTA7IGk8cGxheWVycy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGlmKHBsYXllcnNbaV0gPT0gY3JlYXRvcil7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xpY2tBY3Rpb246IGZ1bmN0aW9uKCBldmVudCwgZGF0YSApIHtcbiAgICAgICAgbGV0IHBsYXllcnNJbmZvID0gSlNPTi5wYXJzZShkYXRhLnBsYXllcnNJbmZvKTtcbiAgICAgICAgbGV0IHRvdGFsR2FtZVJlc3VsdENvbXAgPSB0aGlzLnRvdGFsR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ1RvdGFsR2FtZVJlc3VsdCcpO1xuICAgICAgICB0b3RhbEdhbWVSZXN1bHRDb21wLnNldFBsYXllckluZm9zKHBsYXllcnNJbmZvLnBsYXllcnMsIGRhdGEpO1xuICAgICAgICB0b3RhbEdhbWVSZXN1bHRDb21wLl9jbGlja0J0bigpO1xuICAgICAgICB0aGlzLnRvdGFsR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcblxuICAgICAgICAvL2lmICh0aGlzLl9yZWNvcmRJdGVtSW5mbykge1xuICAgICAgICAvLyAgdGhpcy5fc3RhcnRQbGF5YmFjayh0aGlzLl9yZWNvcmRJdGVtSW5mby5faW5mbzhBcnJheSk7XG4gICAgICAgIC8vICByZXR1cm47XG4gICAgICAgIC8vfVxuICAgICAgICAvLy8vU29ja2V0LnNlbmRHZXRJdGVtUmVjb3JkKFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZCx0aGlzLl9wYXJlbnRJZCk7XG4gICAgICAgIC8vU29ja2V0LnNlbmRHZXRJdGVtUmVjb3JkKFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZCwtLWluZGV4KTtcbiAgICB9LFxuXG4gICAgX3N0YXJ0UGxheWJhY2s6IGZ1bmN0aW9uIChwbGF5QmFja0luZm8pIHtcbiAgICAgICAgLy9QbGF5YmFjay5pbnN0YW5jZS5zZXRQbGF5YmFja0RhdGFzKHBsYXlCYWNrSW5mbyk7XG4gICAgICAgIC8vY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgfSxcblxuICAgIGRldGFpbEFjdGlvbjogZnVuY3Rpb24ocmVjb3JkSXRlbUluZm8sIGluZGV4KSB7XG4gICAgICAgIC8vdGhpcy5fcmVjb3JkSXRlbUluZm8gPSByZWNvcmRJdGVtSW5mbztcbiAgICAgICAgLy8vL3RoaXMucGxheWJhY2tOb2RlLmFjdGl2ZSA9IHRydWVcbiAgICAgICAgLy8vL2NvbnNvbGUubG9nKCk7XG4gICAgICAgIC8vLy90aGlzLm51bU5vZGUuc3RyaW5nID0gXCLnrKxcIiArIChpbmRleCArIDEpICsgXCLlsYBcIjtcbiAgICAgICAgLy90aGlzLnRpbWVMYWJlbC5zdHJpbmcgPSByZWNvcmRJdGVtSW5mby5jcmVhdEF0LnN1YnN0cig1LDExKTtcbiAgICAgICAgLy9sZXQgb2JqQXJyYXkgPSBKU09OLnBhcnNlKHJlY29yZEl0ZW1JbmZvLmluZm84KTtcbiAgICAgICAgLy90aGlzLl9yZWNvcmRJdGVtSW5mby5faW5mbzhBcnJheSA9IG9iakFycmF5O1xuICAgICAgICAvL2xldCBwbGF5ZXJzQXJyYXkgPSBvYmpBcnJheS5tYXAoZnVuY3Rpb24oc3RyKXtcbiAgICAgICAgLy8gIHJldHVybiBKU09OLnBhcnNlKHN0cik7XG4gICAgICAgIC8vfSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vdmFyIHBsYXllcnMgPSBwbGF5ZXJzQXJyYXlbcGxheWVyc0FycmF5Lmxlbmd0aC0xXS5kYXRhLnBsYXllcnM7XG4gICAgICAgIC8vZm9yICh2YXIgaSA9IDA7aSA8IHBsYXllcnMubGVuZ3RoO2krKykge1xuICAgICAgICAvLyAgICB0aGlzLm5pY2tuYW1lTGFiZWxzW2ldLnN0cmluZyA9IHBsYXllcnNbaV0ubmlja25hbWU7XG4gICAgICAgIC8vICAgIHRoaXMuc2NvcmVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc1tpXS5jU2NvcmU7XG4gICAgICAgIC8vfVxuICAgIH0sXG4gICAgcmVjb3JkczpmdW5jdGlvbigpe1xuXG4gICAgfSxcblxuXG59KTsiLCJjb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBzY3JvbGxWaWV3OmNjLk5vZGUsXG4gICAgICAgIHJlY29yZEl0ZW06Y2MuUHJlZmFiLFxuICAgICAgICAvL3N1YlNjcm9sbFZpZXc6Y2MuTm9kZSxcbiAgICAgICAgLy9zdWJSZWNvcmRJdGVtOmNjLk5vZGUsXG4gICAgICAgIC8vc3BsYXNoOmNjLlByZWZhYixcbiAgICAgICAgLy9yZW9yZEluZm86Y2MuTm9kZSxcbiAgICAgICAgLy9cbiAgICAgICAgLy9qaWZlbjpjYy5MYWJlbCxcbiAgICAgICAgLy9oZWFkOmNjLk5vZGUsXG4gICAgICAgIC8vaWQ6Y2MuTGFiZWwsXG4gICAgICAgIC8vbmlja25hbWU6Y2MuTGFiZWwsXG4gICAgICAgIC8vY3JlYXQ6Y2MuTGFiZWwsICAgICAgICAvLyDliJvmiL/kurpcbiAgICAgICAgLy9jcmVhdGVVc2VyOmNjLk5vZGUsICAgICAvLyAg5aS05YOPXG4gICAgICAgIC8vXG4gICAgICAgIC8vdGltZUxhYmVsOmNjLkxhYmVsLCAgIC8vIOaXtumXtFxuICAgICAgICAvL2p1c2h1TGFiZWw6Y2MuTGFiZWwsICAvLyDlsYDmlbBcbiAgICAgICAgLy8vL2NyZWF0ZVVzZXI6Y2MuTm9kZSwgICAvLyDmiL/kuLtcbiAgICAgICAgLy9yb29tSWQ6Y2MuTGFiZWwsICAgICAgLy8g5oi/6Ze05Y+3XG4gICAgICAgIC8vX3JlY29yZHM6bnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhpcy5pc1N1YlBhZ2UgPSBmYWxzZTtcbiAgICAgICAgLy90aGlzLnN1YlNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIC8vXG4gICAgICAgIC8vdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudCA9IHRoaXMuc3ViU2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcbiAgICAgICAgLy9jb25zb2xlLmxvZyggdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudCApO1xuICAgICAgICAvL3RoaXMucmVjb3JkSW5mbyA9IHRoaXMuc3ViU2Nyb2xsVmlld0NvbnRlbnQuY2hpbGRyZW5bMF07XG4gICAgICAgIC8vdGhpcy5yZW9yZHMgPSB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50LmNoaWxkcmVuWzBdLmNoaWxkcmVuWzNdO1xuICAgICAgICB0aGlzLnNjcm9sbFZpZXdDb250ZW50ID0gdGhpcy5zY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xuICAgICAgICB0aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XG4gICAgfSxcblxuICAgIF9yZWdpc3RlclNvY2tldEV2ZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5HZXRSZWNvcmQsIHRoaXMuX1JlY2VpdmVSZWNvcmRJbmZvLCB0aGlzKTtcbiAgICAgIC8vS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuR2V0SXRlbVJlY29yZCwgdGhpcy5fUmVjZWl2ZVJlY29yZEl0ZW0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBfUmVjZWl2ZVJlY29yZEluZm86ZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgLy9jYy5sb2cocmVzcG9uc2UpXG4gICAgICAgIC8vY2MubG9nKCctLS0tLS03OCcpXG4gICAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAvL3RoaXMuX3JlY29yZHMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAvL3RoaXMuaXNTdWJQYWdlID0gZmFsc2U7XG4gICAgICAgIC8vdGhpcy5zdWJTY3JvbGxWaWV3LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAvL3RoaXMuc2Nyb2xsVmlldy5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMuc2Nyb2xsVmlld0NvbnRlbnQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgICAgcmVzcG9uc2UuZGF0YS5maWx0ZXIoIGZ1bmN0aW9uIChyZWNvcmQpIHtyZXR1cm4gcmVjb3JkLnBsYXllcnNJbmZvLmxlbmd0aCA+IDA7fSkuZm9yRWFjaChmdW5jdGlvbiAocmVjb3JkSW5mbykge1xuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIHZhciBpdGVtID0gY2MuaW5zdGFudGlhdGUodGhpcy5yZWNvcmRJdGVtKTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVmlld0NvbnRlbnQuYWRkQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgICB2YXIgY29tcCA9IGl0ZW0uZ2V0Q29tcG9uZW50KCdyZWNvcmRJbmZvJyk7XG4gICAgICAgICAgICBjb21wLnNldEluZm8ocmVjb3JkSW5mbyk7XG4gICAgICAgICAgICB2YXIgcmVjb3JkQnRuID0gaXRlbS5jaGlsZHJlbls3XS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcbiAgICAgICAgICAgIHJlY29yZEJ0bi5jbGlja0V2ZW50c1swXS5jdXN0b21FdmVudERhdGEgPSByZWNvcmRJbmZvO1xuICAgICAgICAgICAgLy8gdmFyIGV2ZW50SGFuZGxlciA9IG5ldyBjYy5Db21wb25lbnQuRXZlbnRIYW5kbGVyKCk7XG4gICAgICAgICAgICAvLyBldmVudEhhbmRsZXIudGFyZ2V0ID0gY29tcC5ub2RlLmNoaWxkcmVuWzddO1xuICAgICAgICAgICAgLy8gZXZlbnRIYW5kbGVyLmNvbXBvbmVudCA9IFwiYnRuXCI7XG4gICAgICAgICAgICAvLyBldmVudEhhbmRsZXIuaGFuZGxlciA9IFwiY2xpY2tBY3Rpb25cIjtcbiAgICAgICAgICAgIC8vZXZlbnRIYW5kbGVyLmN1c3RvbUV2ZW50RGF0YSA9IFwibXkgZGF0YVwiO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhjb21wLm5vZGUuY2hpbGRyZW5bN10pO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBjbG9zZUFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNTdWJQYWdlKSB7XG4gICAgICAgICAgICB0aGlzLmlzU3ViUGFnZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxWaWV3LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAvKiBjbGlja0FjdGlvbjpmdW5jdGlvbiggaW5kZXggKXtcbiAgICAgICAgLy9fUmVjZWl2ZVJlY29yZEl0ZW0oKVxuICAgIH0sXG4gICAgX1JlY2VpdmVSZWNvcmRJdGVtOmZ1bmN0aW9uKFJlY29yZEl0ZW1JbmZvKSB7XG4gICAgICAgIGNjLmxvZyhSZWNvcmRJdGVtSW5mbylcbiAgICAgICAgY2MubG9nKCctLS0tLS03OCcpXG4gICAgICAgIC8vY29uc29sZS5sb2coUmVjb3JkSXRlbUluZm8pO3JldHVybjtcbiAgICAgICAgdmFyIGluZGV4ID0gUmVjb3JkSXRlbUluZm8uZGF0YVxuICAgICAgICB2YXIgcGxheWVyc0luZm8gPSBKU09OLnBhcnNlKHRoaXMuX3JlY29yZHNbaW5kZXhdLnBsYXllcnNJbmZvKTtcbiAgICAgICAgXG4gICAgICAgIHZhciBwbGF5ZXJzID0gcGxheWVyc0luZm8ucGxheWVyczsgICAgICAgICAgICAgICAgICAvLyDnjqnlrrbkv6Hmga9cbiAgICAgICAgdmFyIHBsYXllcnNJbmRleCA9IHBsYXllcnNJbmZvLnBsYXllcnNJbmRleDsgICAgICAgIC8vIOeOqeWutueahOS9jee9rlxuICAgICAgICB2YXIgY3JlYXRlVXNlcklkID0gdGhpcy5fcmVjb3Jkc1tpbmRleF0uY3JlYXRlVXNlcklkOyAgIC8vIOWIm+aIv0lEXG4gICAgICAgIHZhciBzZW5kVXNlcklkID0gdGhpcy5fcmVjb3Jkc1tpbmRleF0udXNlcmlkOyAgICAgICAgICAgLy8g5Y+R6YCB5Lq6SURcblxuICAgICAgICB0aGlzLmlzU3ViUGFnZSA9IHRydWU7XG4gICAgICAgIHRoaXMuc3ViU2Nyb2xsVmlldy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy50aW1lTGFiZWwuc3RyaW5nID0gKHRoaXMuX3JlY29yZHNbaW5kZXhdLmNyZWF0ZUF0KS5zdWJzdHIoNSwxMSk7ICAgICAgICAgICAgICAgLy8g5pe26Ze0XG4gICAgICAgIHRoaXMuanVzaHVMYWJlbC5zdHJpbmcgPSB0aGlzLmpzKEpTT04ucGFyc2UodGhpcy5fcmVjb3Jkc1tpbmRleF0uc2V0dGluZzIpKTsgICAgICAgIC8vIOWxgOaVsFxuICAgICAgICB0aGlzLnJvb21JZC5zdHJpbmcgPSB0aGlzLl9yZWNvcmRzW2luZGV4XS5yb29tSWQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmiL/pl7Tlj7dcbiAgICAgICAgdGhpcy5jcmVhdC5zdHJpbmcgPSB0aGlzLmZpbmRDcmVhdG9yKHRoaXMuX3JlY29yZHNbaW5kZXhdLmNyZWF0ZVVzZXJJZCxwbGF5ZXJzKTsgICAgLy8g5oi/5Li7XG5cbiAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudCA9IHRoaXMuc3ViU2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcbiAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudC5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwbGF5ZXJzLmxlbmd0aDsgaSsrICl7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuc3BsYXNoKTtcbiAgICAgICAgICAgIHRoaXMuc3ViU2Nyb2xsVmlld0NvbnRlbnQuYWRkQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgICB2YXIgY29tcCA9IGl0ZW0uZ2V0Q29tcG9uZW50KCdyZWNvcmRJbmZvJyk7XG4gICAgICAgICAgICB2YXIgY3JlYXRvciA9IDA7ICAgICAgIFxuICAgICAgICAgICAgdmFyIHNlbGYgPSAwOyAgICAgICAvLyDooajnpLroh6rlt7HvvIzopoHlr7noh6rlt7HnmoTmr5TniYzorrDlvZXog4zmma/lgZrlpITnkIZcbiAgICAgICAgICAgIGlmKGNyZWF0ZVVzZXJJZCA9PSBwbGF5ZXJzW2ldLmlkKXtcbiAgICAgICAgICAgICAgICBjcmVhdG9yID0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoIHNlbmRVc2VySWQgPT0gcGxheWVyc1tpXS5pZCl7XG4gICAgICAgICAgICAgICAgc2VsZiA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlY29yZHMoY29tcCxpLGNyZWF0b3Isc2VsZixpbmRleCk7XG4gICAgICAgIH1cblxuICAgIH0sXG4gICAgcmVjb3JkczpmdW5jdGlvbihpbmZvLGksY3JlYXRvcixzZWxmLGluZGV4KXtcbiAgICAgICAgaWYoc2VsZil7XG4gICAgICAgICAgICBpbmZvLm5vZGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTI1LCAxMjYsIDIwMCk7XG4gICAgICAgIH1cbiAgICAgICAgY2MubG9nKGluZm8pXG4gICAgICAgIGNjLmxvZygnLS0tLTExOScpXG4gICAgICAgIHZhciBwbGF5ZXJzID0gSlNPTi5wYXJzZSh0aGlzLl9yZWNvcmRzW2luZGV4XS5wbGF5ZXJzSW5mbykucGxheWVycztcbiAgICAgICAgdmFyIHNjb3JlcyA9IHRoaXMuX3JlY29yZHNbaW5kZXhdLnNjb3JlcyA7XG4gICAgICAgIGluZm8ubmlja25hbWVMYWJlbHMuc3RyaW5nID0gcGxheWVyc1tpXS5uaWNrbmFtZTtcbiAgICAgICAgaW5mby5pZC5zdHJpbmcgPSBwbGF5ZXJzW2ldLmlkO1xuICAgICAgICBpbmZvLmppZmVuLnN0cmluZyA9IHNjb3Jlc1tpXTtcblxuICAgICAgICB2YXIgaGVhZFVybCA9IHBsYXllcnNbaV0uYXZhdGFyVXJsOyAgIC8v5aS05YOP6L+e5o6lXG4gICAgICAgIHZhciBzcHJpdGUgPSBpbmZvLmF2YXRhck5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgIGNjLmxvYWRlci5sb2FkKGhlYWRVcmwrXCIuanBnXCIsIGZ1bmN0aW9uIChlcnIsIHRleCkge1xuICAgICAgICAgIGlmICghZXJyKSB7XG4gICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xuICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWU9ZnJhbWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaW5mby5jcmVhdG9ySW1nLmFjdGl2ZSA9IGNyZWF0b3I7XG4gICAgfSxcbiAgICBmaW5kQ3JlYXRvcjpmdW5jdGlvbihjcmVhdGVJZCxwbGF5ZXJzKXsgLy/mib7miL/kuLtcbiAgICAgICAgZm9yKHZhciBpPTA7IGk8cGxheWVycy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGlmKGNyZWF0ZUlkID09IHBsYXllcnNbaV0uaWQpe1xuICAgICAgICAgICAgICAgIHJldHVybiBwbGF5ZXJzW2ldLm5pY2tuYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBqczpmdW5jdGlvbihudW0pe1xuICAgICAgICB2YXIgSiA9IDU7XG4gICAgICAgIHN3aXRjaChudW0pe1xuICAgICAgICAgICAgY2FzZSAwOiBKID0gNTticmVhaztcbiAgICAgICAgICAgIGNhc2UgMTogSiA9IDEwO2JyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOiBKID0gMjA7YnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6IEogPSAzMDticmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gSjtcbiAgICB9LCovXG5cbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XG4gICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGNvbnRlbnQ6Y2MuTm9kZVxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdmlzaWJsZVNpemUgPSBjYy5kaXJlY3Rvci5nZXRWaXNpYmxlU2l6ZSgpO1xyXG4gICAgICAgIHZhciBjb250ZW50U2l6ZSA9IHt9O1xyXG4gICAgICAgIGNvbnRlbnRTaXplLndpZHRoID0gdGhpcy5ub2RlLndpZHRoO1xyXG4gICAgICAgIGNvbnRlbnRTaXplLmhlaWdodCA9IHRoaXMubm9kZS5oZWlnaHQ7XHJcbiAgICAgICAgdmFyIHNjYWxlWCA9IHZpc2libGVTaXplLndpZHRoL2NvbnRlbnRTaXplLndpZHRoO1xyXG4gICAgICAgIHZhciBzY2FsZVkgPSB2aXNpYmxlU2l6ZS5oZWlnaHQvY29udGVudFNpemUuaGVpZ2h0O1xyXG4gICAgICAgIHZhciBzY2FsZSA9IE1hdGgubWluKHNjYWxlWCxzY2FsZVkpLnRvRml4ZWQoMik7XHJcbiAgICAgICAgdGhpcy5ub2RlLnNjYWxlWCA9IHNjYWxlO1xyXG4gICAgICAgIHRoaXMubm9kZS5zY2FsZVkgPSBzY2FsZTtcclxuICAgIH1cclxufSk7XHJcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG5vZGVzOltjYy5Ob2RlXSxcbiAgICAgICAgc2VsZWN0ZWRJbmRleDogMCxcbiAgICAgICAgX3NlbGVjdDpbXSxcbiAgICAgICAgX3NlbGVjdGVkOjAsXG4gICAgICAgIGJlaWx2OmNjLk5vZGUsICAvLyDlgI3njodcbiAgICAgICAgX2JsU2hvdzowLCAgICAgIC8vIOWAjeeOh+eahOaYvuekuueKtuaAgVxuICAgIH0sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5iZWlsdi5hY3RpdmUgPSB0aGlzLl9ibFNob3c7XG4gICAgICAgIHRoaXMuX3NlbGVjdCA9IFsxLDEsMSwwLDBdOyBcbiAgICAgICAgaWYoY2Muc2V0KXsgIC8vIOiusOW9leS4iuS4gOWPpeeahOaIv+mXtOaDheWGtVxuICAgICAgICAgICAgdGhpcy5fc2VsZWN0ID0gY2Muc2V0WydzZXR0aW5nMyddO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWN0aXZlID0gdGhpcy5fc2VsZWN0W2ldO1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKGFjdGl2ZSk7XG4gICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGVzW2ldLmdldENoaWxkQnlOYW1lKCd0aXRsZScpO1xuICAgICAgICAgICAgaWYodGhpcy5fc2VsZWN0W2ldKXtcbiAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGk9PTMpe1xuICAgICAgICAgICAgICAgIHRoaXMuYmVpbHYuYWN0aXZlID0gKHRoaXMuX2JsU2hvdyA9IHRoaXMuX3NlbGVjdFszXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0Q29tcCA9IHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcbiAgICAgICAgICAgIHRDb21wLmluZGV4ID0gaTtcbiAgICAgICAgICAgIHRDb21wLmNsaWNrQWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXAgPSBzZWxmLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQoIHNlbGYuX3NlbGVjdFtpbmRleF0gPSAhc2VsZi5fc2VsZWN0W2luZGV4XSApO1xuICAgICAgICAgICAgICAgIGlmKCB0aGlzLmluZGV4ID09IDMgKXsgICAgICAgICAgICAgICAgICAgICAgLy8g56ys5LiJ5Liq5piv5bqE5a625qih5byP77yM5bqE5a625qih5byP5pi+56S65YCN546HXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYmVpbHYuYWN0aXZlID0gKHRoaXMuX2JsU2hvdyA9IHNlbGYuX3NlbGVjdFszXSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2VsZi5fc2VsZWN0W2luZGV4XSA9IHNlbGYuX3NlbGVjdFtpbmRleF07XG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgc2VsZi5vblNlbGVjdENoYW5nZShpbmRleCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGUuY2hpbGRyZW5bMF07XG4gICAgICAgICAgICAgICAgaWYoIHNlbGYuX3NlbGVjdFtpbmRleF0gKXsgICAgICAgICAgICAgLy8g5aaC5p6c5b2T5YmN6YCJ6aG55Li6VFJVRSDliJnmmL7npLrpnZLoibJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICAgICAgfWVsc2V7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlj43kuYsg55m96ImyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBvblNlbGVjdENoYW5nZTogZnVuY3Rpb24gKHNlbGVjdEluZGV4KSB7XG4gICAgICAgIC8vY2MubG9nKHNlbGVjdEluZGV4KTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLl9zZWxlY3QpO1xuICAgIH0sXG5cblxuXG59KTtcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBwYWk6Y2MuTm9kZSxcclxuICAgICAgICBtYXBhaTp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6W10sXHJcbiAgICAgICAgICAgIHR5cGU6Y2MuU3ByaXRlRnJhbWUsXHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdE1hID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChcInNlbGVjdF9tYVwiKTtcclxuICAgICAgICB0aGlzLnNlbGVjdE1hLm9uTG9hZCgpO1xyXG4gICAgICAgIHRoaXMuY29tID0gdGhpcy5wYWkuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBjbGlja0J0bkNvbWZpcm06ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5jb20uc3ByaXRlRnJhbWUgPSB0aGlzLm1hcGFpW2NjLmZyb20ubWFdO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy5jb20uc3ByaXRlRnJhbWUpO1xyXG4gICAgfSxcclxuICAgIFxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICByaWdodEljb246W2NjLk5vZGVdLFxuICAgICAgICBtYXBhaVJpZ2h0OmNjLk5vZGVcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKGNjLmZyb20gPT0gbnVsbCl7XG4gICAgICAgICAgICBjYy5mcm9tID0ge307XG4gICAgICAgIH1cbiAgICAgICAgLy/lpoLmnpzkuI3luKbpqazvvIzliJnpqazniYzkuLrnqbpcbiAgICAgICAgaWYodGhpcy5tYXBhaVJpZ2h0LmFjdGl2ZSA9PSBmYWxzZSl7XG4gICAgICAgICAgICBjYy5mcm9tLmlzVXNlTWEgPSBmYWxzZTtcbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSBudWxsO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIGNjLmZyb20uaXNVc2VNYSA9IHRydWU7XG4gICAgICAgICAgICAvL+WQpuWImemprOeJjOm7mOiupOS4uuesrDDkuKrvvIzljbPpu5HmoYM1XG4gICAgICAgICAgICBjYy5mcm9tLm1hID0gMDtcbiAgICAgICAgfVxuICAgICAgICBmb3IodmFyIGk9MDtpPHRoaXMucmlnaHRJY29uLmxlbmd0aDtpKyspIHtcbiAgICAgICAgICAgIGlmKGk9PTApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0SWNvbltpXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNjLmZyb20ubWEgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5yaWdodEljb25baV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0SWNvbltpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9LFxuICAgIG9uTWFQYWlDbGljazpmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciB0YXJnZXROYW1lID0gZS50YXJnZXQubmFtZTtcbiAgICAgICAgLy9jYy5sb2codGFyZ2V0TmFtZSlcbiAgICAgICAgaWYodGFyZ2V0TmFtZSAhPSB0aGlzLnNlbGVjdC5wYXJlbnQubmFtZSkge1xuICAgICAgICAgICAgaWYodGFyZ2V0TmFtZSA9PSBcInNlbGVjdF9rdWFuZzFcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5yaWdodEljb25bMl07XG4gICAgICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRhcmdldE5hbWUgPT0gXCJzZWxlY3Rfa3VhbmcyXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMucmlnaHRJY29uWzFdO1xuICAgICAgICAgICAgICAgIGNjLmZyb20ubWEgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZih0YXJnZXROYW1lID09IFwic2VsZWN0X2t1YW5nM1wiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QgPSB0aGlzLnJpZ2h0SWNvblswXTtcbiAgICAgICAgICAgICAgICBjYy5mcm9tLm1hID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5yaWdodEljb24ubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodEljb25baV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlbGVjdC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIC8vY29uc29sZS5sb2coY2MuZnJvbS5tYSk7XG4gICAgfVxuXG5cbn0pO1xuIiwiY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcclxuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgX3VzZXJpZCA6IDAsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuICAgIGNsaWNrQmVpTHY6ZnVuY3Rpb24oZXZlbnQsbnVtKXtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgU29ja2V0LnNlbmRCZWlMdihudW0sdGhpcy5fdXNlcmlkKTtcclxuICAgIH0sXHJcbiAgIFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgYmdOb2RlOmNjLk5vZGUsICAgLy/pgInmi6nmoYZcbiAgICAgICAgc2VsZWN0ZWROb2RlOmNjLk5vZGUsICAvL+WvueWPt1xuICAgICAgICBwYWk6Y2MuTm9kZSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy5ub2RlKTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgIC8vY29uc29sZS5sb2coY2Muc2V0KTtcbiAgICB9LFxuICAgIFxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gIXRoaXMuc2VsZWN0ZWQ7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRoaXMuc2VsZWN0ZWQ7XG4gICAgICBcbiAgICB9LFxuICAgIFxuICAgIHNldFNlbGVjdGVkOmZ1bmN0aW9uKHNlbGVjdGVkKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBzZWxlY3RlZDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUuYWN0aXZlID0gdGhpcy5zZWxlY3RlZDtcbiAgICB9LFxuICAgIC8qIyMjIyMqL1xuICAgIGNsaWNrU2VsZWN0S3Vhbmc6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhdGhpcy5zZWxlY3RlZDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUuYWN0aXZlID0gdGhpcy5zZWxlY3RlZDtcbiAgICAgICAgY2MuZnJvbS5pc1VzZU1hID0gdGhpcy5zZWxlY3RlZDtcbiAgICAgICAgdmFyIG1hcGFpQ29tID0gdGhpcy5wYWkuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XG4gICAgICAgIGlmKHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9PT0gZmFsc2Upe1xuICAgICAgICAgICAgbWFwYWlDb20uaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgbWFwYWlDb20uaW50ZXJhY3RhYmxlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG5vZGVzOltjYy5Ob2RlXSxcbiAgICAgICAgc2VsZWN0ZWRJbmRleDogMCxcbiAgICB9LFxuXG4gICAgLyojIyMjKi9cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgcnMgPSAwO1xuICAgICAgICB2YXIganMgPSAwO1xuICAgICAgICB2YXIgc2YgPSAwO1xuICAgICAgICB2YXIgYmwgPSAwO1xuICAgICAgICBpZihjYy5zZXQpe1xuICAgICAgICAgICAganMgPSBjYy5zZXQuc2V0dGluZzE7XG4gICAgICAgICAgICBycyA9IGNjLnNldC5zZXR0aW5nMjtcbiAgICAgICAgICAgIHNmID0gY2Muc2V0LnNldHRpbmc0O1xuICAgICAgICAgICAgYmwgPSBjYy5zZXQuc2V0dGluZzU7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgaXNTZWxlY3RlZCA9ICh0aGlzLnNlbGVjdGVkSW5kZXggPT0gaSk7XG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jykuc2V0U2VsZWN0ZWQoaXNTZWxlY3RlZCk7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgICAgICAgdmFyIHNlbGVjdEluZGV4ID0gdGhpcy5zZWxlY3RlZEluZGV4IDtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJykuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgaWYoIHNlbGVjdEluZGV4ID09IGkpe1xuICAgICAgICAgICAgICAgIHRoaXMubm9kZXNbc2VsZWN0SW5kZXhdLmdldENoaWxkQnlOYW1lKFwidGl0bGVcIikuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdENvbXAgPSB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICB0Q29tcC5pbmRleCA9IGk7XG5cbiAgICAgICAgICAgIHRDb21wLmNsaWNrQWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wID0gc2VsZi5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgICAgICBjb21wLnNldFNlbGVjdGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIFBlZXJzID0gdGhpcy5ub2RlLnBhcmVudC5jaGlsZHJlbjsgIC8vIOWQjOi+iOiKgueCuVxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBhPTA7IGE8UGVlcnMubGVuZ3RoOyBhKyspe1xuICAgICAgICAgICAgICAgICAgICBpZiggUGVlcnNbYV0uY2hpbGRyZW4ubGVuZ3RoPjAgKXsgICAgICAgICAgICAvLyDlpoLmnpzlkIzovojmnInlrZDoioLngrkg5aSE55CG5a2Q6IqC54K55paH5a2X55qE6aKc6ImyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBQZWVyc1thXS5nZXRDaGlsZEJ5TmFtZShcInRpdGxlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgICAgICAvL3RoaXMubm9kZS5jaGlsZHJlbltpbmRleF0uY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkSW5kZXggPSB0aGlzLmluZGV4O1xuICAgICAgICAgICAgICAgIHNlbGYub25TZWxlY3RDaGFuZ2UodGhpcy5pbmRleCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJyZW5zaHVcIiAmJiBjYy5zZXQgKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJzKTtcbiAgICAgICAgICAgIHRoaXMucmVtZW1iZXJfc2V0KHJzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiggdGhpcy5ub2RlLl9uYW1lID09IFwianVzaHVcIiAmJiBjYy5zZXQgKXtcbiAgICAgICAgICAgIHRoaXMucmVtZW1iZXJfc2V0KGpzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiggdGhpcy5ub2RlLl9uYW1lID09IFwiY2FyZHNcIiAmJiBjYy5zZXQgKXtcbiAgICAgICAgICAgIHRoaXMucmVtZW1iZXJfc2V0KHNmKTtcbiAgICAgICAgfVxuICAgICAgICBpZiggdGhpcy5ub2RlLl9uYW1lID09IFwiYmVpTHZcIiAmJiBjYy5zZXQgKXtcbiAgICAgICAgICAgIHRoaXMucmVtZW1iZXJfc2V0KGJsKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgcmVtZW1iZXJfc2V0OmZ1bmN0aW9uKG51bSl7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IG51bTtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgbGV0IGlzU2VsZWN0ZWQgPSAobnVtID09IGkpO1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKGlzU2VsZWN0ZWQpO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJykuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgaWYoIG51bSA9PSBpKXtcbiAgICAgICAgICAgICAgICAvLyBpZiggdGhpcy5ub2Rlc1tudW1dLmNoaWxkcmVuWzBdLm5hbWUgPT0gXCJ0aXRsZVwiICl7XG4gICAgICAgICAgICAgICAgLy8gICAgIGluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICAvLyB9ZWxzZSBpZih0aGlzLm5vZGVzW251bV0uY2hpbGRyZW5bMV0ubmFtZSA9PSBcInRpdGxlXCIpe1xuICAgICAgICAgICAgICAgIC8vICAgICBpbmRleCA9MTtcbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgdGhpcy5ub2Rlc1tudW1dLmdldENoaWxkQnlOYW1lKCd0aXRsZScpLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25TZWxlY3RDaGFuZ2U6IGZ1bmN0aW9uIChzZWxlY3RJbmRleCkge1xuXG5cbiAgICB9LFxuICAgIFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBpbmRpY2F0b3JOb2RlOmNjLk5vZGUsXG4gICAgICAgIGJhY2tncm91bmROb2RlOmNjLk5vZGUsXG4gICAgICAgIHNlbGVjdGVkTm9kZTpjYy5Ob2RlLFxuXG4gICAgICAgIHZhbHVlOjAsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuaW5kaWNhdG9yTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCxmdW5jdGlvbihldmVudCkge1xuXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRSxmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIHB0ID0gc2VsZi5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZShjYy52MihldmVudC5nZXRMb2NhdGlvblgoKSxldmVudC5nZXRMb2NhdGlvblkoKSkpO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTbGlkZXIocHQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCxmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIHB0ID0gc2VsZi5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZShjYy52MihldmVudC5nZXRMb2NhdGlvblgoKSxldmVudC5nZXRMb2NhdGlvblkoKSkpO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTbGlkZXIocHQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCxmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIHB0ID0gc2VsZi5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZShjYy52MihldmVudC5nZXRMb2NhdGlvblgoKSxldmVudC5nZXRMb2NhdGlvblkoKSkpO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTbGlkZXIocHQpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL3RoaXMubWF4V2lkdGggPSB0aGlzLm5vZGUud2lkdGggLSA0MDtcbiAgICAgICAgdGhpcy5tYXhXaWR0aCA9IHRoaXMubm9kZS53aWR0aC0yODtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICB9LFxuXG4gICAgdXBkYXRlU2xpZGVyOmZ1bmN0aW9uKHB0KSB7XG4gICAgICAgIHZhciB4ID0gcHQueDtcbiAgICAgICAgaWYgKHggPCAwKSB7XG4gICAgICAgICAgICB4ID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh4ID4gdGhpcy5tYXhXaWR0aCkge1xuICAgICAgICAgICAgeCA9IHRoaXMubWF4V2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh4L3RoaXMubWF4V2lkdGgpO1xuICAgICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UodGhpcy52YWx1ZSk7XG4gICAgfSxcblxuICAgIC8qMCAtIDEqL1xuICAgIHNldFZhbHVlOmZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52YWx1ZSA+IDEpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSAxO1xuICAgICAgICB9XG4gICAgICAgIC8vdGhpcy5tYXhXaWR0aCA9IHRoaXMubm9kZS53aWR0aCAtIDM4O1xuICAgICAgICB0aGlzLm1heFdpZHRoID0gdGhpcy5ub2RlLndpZHRoLTI4O1xuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUueCA9IHRoaXMudmFsdWUgKiB0aGlzLm1heFdpZHRoKzEwO1xuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS53aWR0aCA9IHRoaXMudmFsdWUgKiB0aGlzLm1heFdpZHRoICsgdGhpcy5pbmRpY2F0b3JOb2RlLndpZHRoLzI7XG4gICAgfSxcblxuICAgIG9uVmFsdWVDaGFuZ2U6ZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgY2MubG9nKHZhbHVlKTtcbiAgICB9LFxufSk7XG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcclxuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcclxuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xyXG5cclxubGV0IFNvY2tldENvbnN0YW50ID0ge1xyXG4gIE1heFJlY29ubmVjdENoZWNrSW50ZXJ2YWw6IDUsIC8vIOmHjei/nuajgOa1i+aXtumXtOeJh1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIOi/meaYr+WvuSBXZWJTb2NrZXQg55qE5LiA5Liq5bCB6KOFXHJcbiAqIFxyXG4gKiDph4zpnaLljIXlkKvoh6rliqjph43ov57nmoTlip/og71cclxuICovXHJcbmxldCBTb2NrZXQgPSBjYy5DbGFzcyh7XHJcbiAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICBwcm9wZXJ0aWVzOiB7XHJcbiAgICBfbGFzdFJlY2VpdmVNc2dUaW1lOiAwLCAvLyDmnIDlkI7kuIDmrKHmlLbliLDmtojmga/ml7bpl7Qo5q+r56eSKVxyXG4gICAgX3RpbWVvdXQ6IDgsIC8vIOi2heaXtuaXtumVvyDvvIjnp5LvvIlcclxuICB9LFxyXG5cclxuICBzdGF0aWNzOiB7XHJcbiAgICBpbnN0YW5jZTogbnVsbCxcclxuICAgIC8vIHVybDpcIndzOi8vMTgyLjE4LjI2LjEzOjUwNDFcIixcclxuICAgIC8vdXJsOlwid3M6Ly8xMjMuNTYuMjAuMTY0OjUwNDFcIiwvL+S/ruaUueWJjVxyXG4gICAgdXJsOlwid3M6Ly8xMjcuMC4wLjE6NTA0MVwiLFxyXG4gICAgLy8gdXJsOlwid3M6Ly8xOTIuMTY4LjAuMTA4OjUwNDFcIixcclxuICAgIC8vdXJsOlwid3M6Ly8xODMuMy4yMDUuMTQ5OjUwMDJcIixcclxuICB9LFxyXG5cclxuICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIFNvY2tldC5pbnN0YW5jZSA9IHRoaXM7XHJcblxyXG4gICAgdGhpcy5uYW1lID0gXCJzb2NrZXRcIjtcclxuXHJcbiAgICBjYy5nYW1lLmFkZFBlcnNpc3RSb290Tm9kZSh0aGlzLm5vZGUpO1xyXG4gICAgaWYgKGNjLmdhbWUuaXNQZXJzaXN0Um9vdE5vZGUodGhpcy5ub2RlKSkge1xyXG4gICAgICBjYy5sb2coJ+a3u+WKoOWFqOWxgOiKgueCuSBTb2NrZXQg5oiQ5YqfJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fcmVnaXN0ZXJBcHBBY3RpdmVDaGFuZ2UoKTtcclxuXHJcbiAgICB0aGlzLmlzQ3JlYXRpbmcgPSBmYWxzZTtcclxuICAgIHRoaXMuY3JlYXRlSW5kZXggPSAwO1xyXG4gICAgdGhpcy5jcmVhdGVTb2NrZXQoKTtcclxuXHJcbiAgICB0aGlzLnNjaGVkdWxlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5jaGVja0Nvbm5lY3Rpb24oKTtcclxuICAgIH0sIDUpO1xyXG5cclxuICAgIHRoaXMucmVjdlRpbWUgPSBEYXRlLm5vdygpOyAvL+aOpeaUtuWIsOacgOaWsOS4gOadoeacjeWKoeWZqOeahOS/oeaBr+eahOaXtumXtFxyXG4gICAgLy9jYy5sb2cobWFuYWdlci52ZXJzaW9uKTtcclxuXHJcbiAgICB0aGlzLl9jaGVja1NvY2tldCgpO1xyXG4gIH0sXHJcblxyXG4gIGNoZWNrQ29ubmVjdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgLy/lrqLmiLfnq6/lrprml7bnu5nmnI3liqHnq6/lj5HpgIHngrnmlbDmja7vvIzpmLLmraLov57mjqXnlLHkuo7plb/ml7bpl7TmsqHmnInpgJrorq/ogIzooqvmn5DkupvoioLngrnnmoTpmLLngavlopnlhbPpl63lr7zoh7Tov57mjqXmlq3lvIDnmoTmg4XlhrXjgIJcclxuICAgIHRoaXMuc2VuZE1lc3NhZ2UoJ2NoZWNrQWN0aW9uJywgJycpO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZVNvY2tldDogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5jcmVhdGVJbmRleCsrOyAvL+WIm+W7uuasoeaVsOWKoDFcclxuICAgIGlmICh0aGlzLmNyZWF0ZUluZGV4ID4gNSkge1xyXG4gICAgICB0aGlzLm5ldHdvcmtFcnJvcigpO1xyXG4gICAgICBLUU5hdGl2ZUludm9rZS5mb3JjZUV4aXRBcHAoKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5pc0NyZWF0aW5nID0gdHJ1ZTtcclxuXHJcbiAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RpbmcpO1xyXG4gICAgdGhpcy53cyA9IG5ldyBXZWJTb2NrZXQoU29ja2V0LnVybCk7XHJcbiAgICBpZiAodGhpcy53cyA9PT0gbnVsbCkge1xyXG4gICAgICB0aGlzLm5ldHdvcmtFcnJvcigpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RFcnJvciwgeydkYXRhJzogJ1NvY2tldCDliJvlu7rlpLHotKUnfSk7XHJcbiAgICAgIEtRTmF0aXZlSW52b2tlLmZvcmNlRXhpdEFwcCgpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnNvY2tldEVycm9yID0gZmFsc2U7XHJcblxyXG4gICAgLy8gc29ja2V0IOi/nuaOpeaIkOWKn1xyXG4gICAgdGhpcy53cy5vbm9wZW4gPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgLy9jYy5sb2coXCJXZWJTb2NrZXQg6L+e5o6l5oiQ5Yqf77yaXCIsIGV2ZW50KTtcclxuICAgICAgXHJcbiAgICAgIHNlbGYuX2xhc3RSZWNlaXZlTXNnVGltZSA9IGNjLnN5cy5ub3coKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5lbWl0KFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0U3VjY2Vzc2VkLCBldmVudCk7XHJcblxyXG4gICAgICBzZWxmLmlzQ3JlYXRpbmcgPSBmYWxzZTtcclxuICAgICAgc2VsZi5zb2NrZXRFcnJvciA9IGZhbHNlO1xyXG4gICAgICBzZWxmLmNyZWF0ZUluZGV4ID0gMDtcclxuICAgICAgc2VsZi5jb25uZWN0aW9uU3VjY2VzcygpO1xyXG4gICAgICBzZWxmLnNlbmRSZWNvbm5lY3RJbmZvKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIHNvY2tldCDmjqXmlLbliLDmtojmga9cclxuICAgIHRoaXMud3Mub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgIHNlbGYuX2xhc3RSZWNlaXZlTXNnVGltZSA9IGNjLnN5cy5ub3coKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5lbWl0KFNvY2tldC5FdmVudC5Tb2NrZXRSZWNlaXZlTWVzc2FnZSwgZXZlbnQuZGF0YSk7XHJcblxyXG4gICAgICBzZWxmLmlzQ3JlYXRpbmcgPSBmYWxzZTtcclxuICAgICAgc2VsZi5zb2NrZXRFcnJvciA9IGZhbHNlO1xyXG4gICAgICBzZWxmLnJlY2V2aWNlTWVzc2FnZShldmVudC5kYXRhKTtcclxuICAgICAgc2VsZi5fZGlzcGF0Y2hSZXNwb25zZShldmVudC5kYXRhKTtcclxuICAgICAgc2VsZi5yZWN2VGltZSA9IERhdGUubm93KCk7IC8v5o6l5pS25pyA5paw5LiA5p2h5L+h5oGv55qE5pe26Ze0XHJcblxyXG4gICAgICAvKiovXHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogc29ja2V0IOWPkeeUn+mUmeivr1xyXG4gICAgICogXHJcbiAgICAgKiBzb2NrZXQg5pys6Lqr5pyJIGBvbmVycm9yYCDlm57osIPvvIzkvYbkuovlrp7or4HmmI7vvIzlhbbkuI3pnaDosLHvvIxcclxuICAgICAqIOacieW+iOWkp+eahOacuueOh+acieivr+aKpeeahOihjOS4uu+8jOW4uOW4uOWcqOayoeaciemUmeivr+aXtu+8jOS8mue7memUmeivr+Wbnuiwg+OAglxyXG4gICAgICog5LiU5LiN6IO95a6a5Yi26LaF5pe25pe26ZW/XHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlIFxyXG4gICAgICovXHJcbiAgICB0aGlzLndzLl9rcV9vbmVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcclxuICAgICAgY2MuZXJyb3IoYFdlYlNvY2tldCDov57mjqXplJnor6/vvJoke21lc3NhZ2V9YCk7XHJcblxyXG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RFcnJvciwge2RhdGE6IG1lc3NhZ2V9KTtcclxuICAgICAgc2VsZi53cy5jbG9zZSgpO1xyXG4gICAgICBpZiAoIXNlbGYud3MpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIOiZveeEtuiwg+eUqOS6hiB3ZWJzb2NrZXQg55qEIGNsb3NlIOaWueazle+8jOS9huaYr1xyXG4gICAgICAvLyDlroPlubbkvJrnq4vljbPosIPnlKggb25jbG9zZSDlm57osIPvvIzogIzmmK/lnKjmnKrmnaXnmoTmn5BcclxuICAgICAgLy8g5LiA5pe26Ze05YaN5Zue6LCDIG9uY2xvc2XvvJvkvYbov5nph4zmmI7mmL7lj6/ku6Xnm7TmjqXlm57osIPkuobjgIJcclxuICAgICAgbGV0IHdzID0gc2VsZi53cztcclxuXHJcbiAgICAgIHNlbGYud3Mub25jbG9zZSgpO1xyXG4gICAgICB3cy5vbmNsb3NlID0gZnVuY3Rpb24oKXt9O1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBzb2NrZSDlt7LlhbPpl61cclxuICAgIHRoaXMud3Mub25jbG9zZSA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAvL2NjLmxvZygnV2ViU29ja2V0IOW3suWFs+mXrSBjbG9zZSB0aW1lPScgKyBEYXRlLm5vdygpICsgXCIgZXZlbnQ6IFwiICsgZXZlbnQpO1xyXG5cclxuXHJcbiAgICAgIHNlbGYuaXNDcmVhdGluZyA9IGZhbHNlO1xyXG4gICAgICBzZWxmLnNvY2tldEVycm9yID0gdHJ1ZTtcclxuICAgICAgc2VsZi53cyA9IG51bGw7XHJcbiAgICAgIHNlbGYuY29ubmVjdGlvbkRpc2Nvbm5lY3QoKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5lbWl0KFNvY2tldC5FdmVudC5Tb2NrZXREaXNjb25uZWN0LCBldmVudCk7XHJcbiAgICAgIC8vY2MubG9nKCdzb2NrZXQgY2xvc2UnK0pTT04uc3RyaW5naWZ5KGV2ZW50KSk7XHJcbiAgICB9O1xyXG4gIH0sXHJcblxyXG4gIHJlY29ubmVjdDogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAoIXNlbGYuaXNDcmVhdGluZyAmJiBzZWxmLnNvY2tldEVycm9yKSB7XHJcbiAgICAgICAgc2VsZi5jcmVhdGVTb2NrZXQoKTtcclxuICAgICAgfVxyXG4gICAgfSwgMik7XHJcbiAgfSxcclxuXHJcbiAgc2VuZFJlY29ubmVjdEluZm86IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgaWYgKHRoaXMudXNlckluZm8gIT0gbnVsbCkge1xyXG4gICAgICAgIHZhciB1c2VySWQgPSBzZWxmLnVzZXJJbmZvLnVzZXJfaWQgfHwgc2VsZi51c2VySW5mby5pZDtcclxuICAgICAgICBzZWxmLnNlbmRNZXNzYWdlKCdyZWNvbm5lY3QnLCB7XHJcbiAgICAgICAgICAndXNlcklkJzogdXNlcklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0sIDEpO1xyXG4gIH0sXHJcblxyXG4gIHJlY2V2aWNlTWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIGNvbm5lY3Rpb25EaXNjb25uZWN0OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIGNvbm5lY3Rpb25TdWNjZXNzOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIG5ldHdvcmtFcnJvcjogZnVuY3Rpb24gKCkge1xyXG5cclxuICB9LFxyXG5cclxuICBjaGVja05ldHdvcmtTdGFydDogZnVuY3Rpb24gKCkge1xyXG5cclxuICB9LFxyXG5cclxuICBjaGVja05ldHdvcmtFbmQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgfSxcclxuXHJcbiAgX2Rpc3BhdGNoUmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZVN0cmluZykge1xyXG4gICAgLy9jYy5sb2coXCJXZWJTb2NrZXQg5o6l5pS25Yiw5pyN5Yqh5Zmo5raI5oGv77yaXCIsIHJlc3BvbnNlU3RyaW5nKTtcclxuICAgIGxldCByZXNwb25zZSA9IEpTT04ucGFyc2UocmVzcG9uc2VTdHJpbmcpO1xyXG4gICAgbGV0IGFjdGlvbiA9IHJlc3BvbnNlW1wiYWN0aW9uXCJdO1xyXG4gICAgaWYgKGFjdGlvbikge1xyXG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoYWN0aW9uLCByZXNwb25zZSk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgLy8gTUFSSzog5YmN5ZCO5Y+w5pON5L2cXHJcbiAgX3JlZ2lzdGVyQXBwQWN0aXZlQ2hhbmdlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDms6jlhozlupTnlKjov5vlhaXliY3jgIHlkI7lj7Dkuovku7ZcIik7XHJcbiAgICBjYy5nYW1lLm9uKGNjLmdhbWUuRVZFTlRfSElERSwgdGhpcy5fYXBwRW50ZXJCYWNrZ3JvdW5kLCB0aGlzKTtcclxuICAgIGNjLmdhbWUub24oY2MuZ2FtZS5FVkVOVF9TSE9XLCB0aGlzLl9hcHBCZWNvbUFjdGl2ZSwgdGhpcyk7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICog6L+b5YWl5ZCO5Y+wXHJcbiAgICovXHJcbiAgX2FwcEVudGVyQmFja2dyb3VuZDogZnVuY3Rpb24gKCkge1xyXG4gICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcclxuICAgIGlmIChub3cgLSB0aGlzLl9sYXN0QXBwRW50ZXJCYWNrZ3JvdW5kVGltZSA8IDEwMCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLl9sYXN0QXBwRW50ZXJCYWNrZ3JvdW5kVGltZSA9IG5vdztcclxuICAgIFxyXG4gICAgLy9jYy5sb2coXCJXZWJTb2NrZXQg5qOA5rWL5Yiw5bqU55So6L+b5YWl5ZCO5Y+w77yaXCIsIG5ldyBEYXRlKCkpO1xyXG4gICAgbGV0IGlkID0gdGhpcy51c2VySW5mbyA/IHRoaXMudXNlckluZm8uaWQgOiB1bmRlZmluZWQ7XHJcbiAgICBTb2NrZXQuc2VuZEFwcFBhdXNlKGlkKTtcclxuICAgIHRoaXMuX2NhbmNlbENoZWNrU29ja2V0KCk7XHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICog6L+b5YWl5YmN5Y+wIFxyXG4gICAqL1xyXG4gIF9hcHBCZWNvbUFjdGl2ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcclxuICAgIGlmIChub3cgLSB0aGlzLl9sYXN0QXBwQmVjb21BY3RpdmVUaW1lIDwgMTAwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuX2xhc3RBcHBCZWNvbUFjdGl2ZVRpbWUgPSBub3c7XHJcblxyXG4gICAgLy9jYy5sb2coXCJXZWJTb2NrZXQg5qOA5rWL5Yiw5bqU55So6L+b5YWl5YmN5Y+w77yaXCIsIG5ldyBEYXRlKCkpO1xyXG4gICAgbGV0IGlkID0gdGhpcy51c2VySW5mbyA/IHRoaXMudXNlckluZm8uaWQgOiB1bmRlZmluZWQ7XHJcbiAgICBTb2NrZXQuc2VuZEFwcEFjdGl2ZShpZCk7XHJcbiAgICB0aGlzLl9jaGVja1NvY2tldCgpO1xyXG5cclxuICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICB0aGlzLl9jaGVja1NvY2tldEV4ZWN1dGUoKTtcclxuICAgIH0uYmluZCh0aGlzKSwgMS41KTtcclxuICB9LFxyXG5cclxuICAvL+i/m+WFpeWQjuWPsOaTjeS9nFxyXG4gIGVudGVyYmFja2dyb3VkQWN0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLl9hcHBFbnRlckJhY2tncm91bmQoKTtcclxuICB9LFxyXG5cclxuICAvL+i/m+WFpeWJjeWPsOaTjeS9nFxyXG4gIHJlc3VtZUFjdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgLy/mo4Dmn6XnvZHnu5xcclxuICAgIHRoaXMuX2NoZWNrTmV0d29yaygpO1xyXG4gICAgdGhpcy5fYXBwQmVjb21BY3RpdmUoKTtcclxuICB9LFxyXG5cclxuICBzZW5kTWVzc2FnZTogZnVuY3Rpb24gKGFjdGlvbiwgZGF0YSkge1xyXG4gICAgZGF0YSA9IHRoaXMuX3N0cm9uZ1ZlcmlmeURhdGEoZGF0YSk7XHJcblxyXG4gICAgaWYgKHRoaXMuc29ja2V0RXJyb3IpIHtcclxuICAgICAgY2MuZXJyb3IoXCJzb2NrZXQg6L+e5o6l6ZSZ6K+v77yaXCIgKyB0aGlzLnNvY2tldEVycm9yKTtcclxuICAgICAgdGhpcy5yZWNvbm5lY3QoKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgLy9jYy5sb2coJ1dlYlNvY2tldCDlj5HpgIHmtojmga/vvJonICsgYWN0aW9uLCBkYXRhKTtcclxuICAgIGlmIChjYy5zeXMuaXNPYmplY3RWYWxpZCh0aGlzLndzKSkge1xyXG4gICAgICBpZiAodGhpcy53cy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTikge1xyXG4gICAgICAgIHRoaXMud3Muc2VuZCh0aGlzLl9jb252ZXJ0UGFyYW1ldGVyVG9TdHJpbmcoYWN0aW9uLCBkYXRhKSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuY29ubmVjdGlvbkRpc2Nvbm5lY3QoKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBfc3Ryb25nVmVyaWZ5RGF0YTogZnVuY3Rpb24oZGF0YSA9IHt9KSB7XHJcbiAgICBpZiAoKHR5cGVvZiBkYXRhKSA9PSAnc3RyaW5nJykge1xyXG4gICAgICBkYXRhID0ge1wic3RyaW5nXCI6IGRhdGF9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChkYXRhID09IG51bGwpIHtcclxuICAgICAgZGF0YSA9IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghZGF0YVtcInVzZXJJZFwiXSkge1xyXG4gICAgICBpZiAodGhpcy51c2VySW5mbyAmJiAodHlwZW9mIHRoaXMudXNlckluZm8pID09ICdvYmplY3QnICYmIHRoaXMudXNlckluZm8uaWQpIHtcclxuICAgICAgICBkYXRhW1widXNlcklkXCJdID0gdGhpcy51c2VySW5mby5pZDtcclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH0sXHJcblxyXG4gIF9jb252ZXJ0UGFyYW1ldGVyVG9TdHJpbmc6IGZ1bmN0aW9uIChhY3Rpb24sIGRhdGEgPSB7fSkge1xyXG4gICAgdmFyIG9iaiA9IHt9O1xyXG4gICAgb2JqLmFjdGlvbiA9IGFjdGlvbjtcclxuICAgIG9iai5kYXRhID0gZGF0YTtcclxuICAgIFxyXG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iaik7XHJcbiAgfSxcclxuXHJcbiAgLy8g5qOA5p+l572R57ucXHJcbiAgX2NoZWNrTmV0d29yazogZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKHRoaXMuY2hlY2tOZXR3b3JrTm93KSB7XHJcbiAgICAgIHRoaXMuY2hlY2tOZXR3b3JrTm93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5zaG91bGRDaGVjayA9IHRydWU7XHJcbiAgICBpZiAoIXRoaXMuc29ja2V0RXJyb3IpIHtcclxuICAgICAgdGhpcy5yZWN2VGltZSA9IDA7XHJcbiAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoJ2NoZWNrQWN0aW9uJywgJycpO1xyXG4gICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja05ldHdvcmtFbmQoKTtcclxuICAgICAgICB0aGlzLnNob3VsZENoZWNrID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMucmVjdlRpbWUgPT09IDApIHtcclxuICAgICAgICAgIHRoaXMuY29ubmVjdGlvbkRpc2Nvbm5lY3QoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIDIuNSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmNvbm5lY3Rpb25EaXNjb25uZWN0KCk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgLy8gTUFSSzogc29ja2V0IOaOiee6v+WwveaXqeehruiupFxyXG4gIF9jaGVja1NvY2tldDogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5zY2hlZHVsZSh0aGlzLl9jaGVja1NvY2tldEV4ZWN1dGUsIFNvY2tldENvbnN0YW50Lk1heFJlY29ubmVjdENoZWNrSW50ZXJ2YWwsIGNjLm1hY3JvLlJFUEVBVF9GT1JFVkVSKTtcclxuICB9LFxyXG5cclxuICBfY2FuY2VsQ2hlY2tTb2NrZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLl9jaGVja1NvY2tldEV4ZWN1dGUpO1xyXG4gIH0sXHJcblxyXG4gIF9jaGVja1NvY2tldEV4ZWN1dGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICh0aGlzLl9pc1NvY2tldFRpbWVvdXQoKSAmJiB0aGlzLndzKSB7XHJcbiAgICAgIHRoaXMud3MuX2txX29uZXJyb3IoJ+i/nuaOpei2heaXticpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgLy8gc29ja2V0IOaYr+WQpuW3sui2heaXtlxyXG4gIF9pc1NvY2tldFRpbWVvdXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB0aGlzLl9sYXN0UmVjZWl2ZU1lc3NhZ2VJbnRlcnZhbCgpID49IHRoaXMuX3RpbWVvdXQ7XHJcbiAgfSxcclxuXHJcbiAgLy8g5LiK5LiA5qyh5pS25Yiw5raI5oGv5Yiw546w5Zyo55qE5pe26Ze06Ze06ZqUXHJcbiAgX2xhc3RSZWNlaXZlTWVzc2FnZUludGVydmFsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xyXG4gICAgbGV0IGludGVydmFsID0gKG5vdyAtIHRoaXMuX2xhc3RSZWNlaXZlTXNnVGltZSkgLyAxMDAwO1xyXG4gICAgLy9jYy5sb2coYFdlYlNvY2tldCDnjrDlnKjot53kuIrkuIDmnaHmlLbliLDmtojmga/nmoTml7bpl7Tpl7TpmpTmmK/vvJoke2ludGVydmFsfSDnp5JgKTtcclxuICAgIHJldHVybiBpbnRlcnZhbDtcclxuICB9LFxyXG5cclxufSk7XHJcblxyXG4vLyBNQVJLOiBTb2NrZXQg5LqL5Lu25a6a5LmJXHJcblNvY2tldC5FdmVudCA9IHtcclxuICBTb2NrZXRDb25uZWN0aW5nOiBcIlNvY2tldENvbm5lY3RpbmdcIiwgICAgICAgICAgICAgLy8gU29ja2V0IOato+WcqOi/nuaOpVxyXG4gIFNvY2tldENvbm5lY3RTdWNjZXNzZWQ6IFwiU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZFwiLCAvLyDov57mjqXmiJDlip9cclxuICBTb2NrZXREaXNjb25uZWN0OiBcIlNvY2tldERpc2Nvbm5lY3RcIiwgICAgICAgICAvLyBTb2NrZXQg5pat5byA6L+e5o6lXHJcbiAgU29ja2V0Q29ubmVjdEVycm9yOiBcIlNvY2tldENvbm5lY3RFcnJvclwiLCAgICAgLy8gU29ja2V0IOi/nuaOpemUmeivr1xyXG4gIFNvY2tldFJlY2VpdmVNZXNzYWdlOiBcIlNvY2tldFJlY2VpdmVNZXNzYWdlXCIsIC8vIFNvY2tldCDmjqXmlLbliLDmtojmga9cclxuXHJcbiAgTG9naW5Kb2luOlwibG9naW5Kb2luXCIsICAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSDku47nmbvpmYbnlYzpnaLojrflj5bmiL/pl7Tlj7fov5vlhaXmuLjmiI9cclxuICBSZWNvcmRJZDpcInJlY29yZElkXCIsICAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBICBcclxuICBPbmNlQWdhaW46XCJvbmNlQWdhaW5cIiwgICAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgIFxyXG4gIEJlaUx2OiBcImJlaUx2XCIsICAgICAgICAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgIFxyXG4gIEludml0ZUNvZGU6IFwiaW52aXRlQ29kZVwiLCAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgICDpgoDor7fnoIFcclxuICBKb2luRGVzazogXCJqb2luRGVza1wiLCAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXHJcbiAgQ3JlYXRlRGVzazogXCJjcmVhdGVEZXNrXCIsICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxyXG4gIEdldERhaUthaURlc2s6XCJnZXREYWlLYWlEZXNrXCIsICAgICAgICAvL+S7o+W8gOaIv+aVsOaNruiOt+WPllxyXG4gIExlYXZlRGVzazogXCJsZWF2ZURlc2tcIiwgICAgICAgICAgICAgICAvLyDnprvlvIDmoYzlrZBcclxuICBEaXNzb2x2ZURlc2s6IFwiZGlzc29sdmVEZXNrXCIsICAgICAgICAgLy8g6Kej5pWj5qGM5a2QXHJcbiAgQW5zd2VyRGlzc29sdmU6IFwiYW5zd2VyRGlzc29sdmVcIiwgICAgIC8vIOWbnuetlOivt+axgumAgOWHuuWRveS7pFxyXG4gIEdldERlc2tJbmZvOiBcImdldERlc2tJbmZvXCIsICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcclxuICBTZW5kSW1hZ2U6IFwic2VuZEltYWdlXCIsICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXHJcbiAgU2VuZFRleHQ6IFwic2VuZFRleHRcIiwgICAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxyXG4gIFNlbmRFbW9qaTogXCJzZW5kRW1vamlcIiwgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcclxuICBDaGFuZ2VJbmZvOlwiY2hhbmdlSW5mb1wiLCAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXHJcbiAgU2VuZEF1ZGlvTWVzc2FnZTogXCJzZW5kQXVkaW9NZXNzYWdlXCIsIC8vIOWuouaIt+err+WPkemAgSAg5Y+R6YCB6K+t6Z+z5raI5oGvXHJcbiAgR2V0UmVjb3JkOiBcImdldFJlY29yZFwiLCAgICAgICAgICAgICAgIC8vIOiOt+WPluaImOe7qeS/oeaBr1xyXG4gIEdldEl0ZW1SZWNvcmQ6IFwiZ2V0SXRlbVJlY29yZFwiLCAgICAgICAvLyDojrflj5bmiJjnu6nkv6Hmga9cclxuICBQbGF5Q2FyZDogXCJwbGF5Q2FyZFwiLCAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCB77yM55So5oi35omT5Ye654mMXHJcbiAgVGltZW91dERpc3NvbHZlOiBcInRpbWVvdXREaXNzb2x2ZVwiLCAgIC8vIOivt+axgumAgOWHuui2heaXtuaXtu+8jOmcgOimgeWPkeWHuueahOa2iOaBr1xyXG4gIEZlZWRiYWNrOiBcImZlZWRiYWNrXCIsICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBICDlj43ppojkv6Hmga9cclxuICBTaGFyZVBuZzogXCJzaGFyZVBuZ1wiLCAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSAg5YiG5Lqr6aKG5Y+W56CW55+zXHJcbiAgRW50ZXJSYW5kb206IFwiaW50ZXJSYW5kb21cIiwgICAvLyDlrqLmiLfnq6/lj5HpgIEgIOi/m+WFpemaj+acuuWculxyXG4gIENhbmNlbFJhbmRvbTogXCJjYW5jZWxSYW5kb21cIiwgLy8g5a6i5oi356uv5Y+R6YCBICDlj5bmtojov5vlhaXpmo/mnLrlnLpcclxuICBGb3JjZUV4aXRSYW5kb206IFwiZGlzc29sdmVcIiwgIC8vIOWuouaIt+err+WPkemAgSDlvLrliLbpgIDlh7rpmo/mnLrlnLpcclxuICBSZWFkeTogXCJyZWFkeVwiLCAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSDlh4blpIdcclxuICBTdGFydEdhbWU6IFwic3RhcnRHYW1lXCIsIC8vIOWuouaIt+err+WPkemAgSDlvIDlp4vmuLjmiI9cclxuICBHZXRIYWxsSW5mbzogXCJnZXRIYWxsSW5mb1wiLCAgIC8vIOWuouaIt+err+WPkemAgSDojrflj5blpKfljoXkv6Hmga9cclxuICBHZXRVc2VySW5mbzogXCJnZXRVc2VySW5mb1wiLCAgIC8vIOWuouaIt+err+WPkemAgSDojrflj5bnlKjmiLfkv6Hmga9cclxuICBDaGVja0FjdGlvbjogXCJjaGVja0FjdGlvblwiLCAgIC8vIOWuouaIt+err+WPkemAge+8jOeUqOadpeajgOa1i+S4juacjeWKoeWZqOeahOi/numAmuaAp1xyXG4gIFBhdXNlOiBcInBhdXNlXCIsICAgICAgICAgICAgICAgLy8g5a6i5oi356uv6L+b5YWl5ZCO5Y+w5pe26KaB5Y+R6YCB55qE5raI5oGvXHJcbiAgQWN0aXZlOiBcImFjdGl2ZVwiLCAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lm57liLDliY3lj7Dml7bopoHlj5HpgIHnmoTmtojmga9cclxuICBRaW5nbGk6IFwicWluZ2xpXCIsICAgICAgICAgICAgIC8vIOWuouaIt+err+WbnuWIsOWJjeWPsOaXtuimgeWPkemAgeeahOa2iOaBr1xyXG5cclxuICBSZWNlaXZlUmVxdWVzdERpc3NvbHZlOiBcInJlcXVlc3REaXNzb2x2ZVwiLCAvLyDor7fmsYLop6PmlaPmoYzlrZAg5pyN5Yqh5Zmo5Y+R6YCBXHJcbiAgUmVjZWl2ZVJlcXVlc3REaXNzb2x2ZVJlc3VsdDogXCJyZXF1ZXN0RGlzc29sdmVSZXN1bHRcIiwgLy8g6K+35rGC6Kej5pWj5qGM5a2Q57uT5p6cXHJcbiAgUmVjZWl2ZUNoYXRUZXh0OiBcInNlbmRUZXh0XCIsICAgIC8vIOacjeWKoeWZqOWPkemAgVxyXG4gIFJlY2VpdmVDaGF0RW1vamk6IFwic2VuZEVtb2ppXCIsICAvLyDmnI3liqHlmajlj5HpgIFcclxuICBSZWNlaXZlRGVza0luZm86IFwiZGVza0luZm9cIiwgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXHJcbiAgUmVjZWl2ZUdhbWVPdmVyOiBcImdhbWVPdmVyXCIsICAgIC8vIOacjeWKoeWZqOWPkemAgVxyXG4gIFJlY2VpdmVGYVBhaTogXCJmYXBhaVwiLCAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIFcclxuICBSZWNlaXZlU2hhcmVQbmc6IFwic2hhcmVQbmdzXCIsICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXHJcbiAgUmVjZWl2ZU9ubGluZVN0YXR1czogXCJzZW5kT25saW5lU3RhdHVzXCIsICAvLyDmnI3liqHlmajlj5HpgIFcclxuICBSZWNlaXZlT25DaGFuZ2VJbmZvOiBcImNoYW5nZUluZm9cIiwgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgVxyXG4gIFJlY2VpdmVBdWRpb01lc3NhZ2U6IFwic2VuZEF1ZGlvTWVzc2FnZVwiLCAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5o6l5pS25Yiw55So5oi35Y+R6YCB5LqG6K+t6Z+z5raI5oGvXHJcbiAgUmVjZWl2ZVBsYXlDYXJkOiBcInBsYXlDYXJkXCIsICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmnInnlKjmiLflt7Lnu4/lh4blpIflpb3niYxcclxuICBSZWNlaXZlQ3JlYXRlRGVzazogXCJjcmVhdGVEZXNrXCIsICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOWIm+W7uuaIv+mXtOeahOWbnuiwg1xyXG4gIFJlY2VpdmVHZXREYWlLYWlEZXNrOlwiZ2V0RGFpS2FpRGVza1wiLCAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5Luj5byA5oi/6Ze0IOW3suW8gOaIv+mXtOaVsOaNrlxyXG4gIFJlY2VpdmVEYWlLYWlEZXNrOiBcImRhaWthaURlc2tcIiwgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5Luj5byA5oi/6Ze055qE5Zue6LCDXHJcbiAgUmVjZWl2ZVJlYWR5OiBcInJlYWR5XCIsICAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmnInnlKjmiLfngrnlh7vkuoblh4blpIdcclxuICBSZWNlaXZlSGFsbEluZm86IFwiZ2V0SGFsbEluZm9cIiwgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgVxyXG4gIFJlY2VpdmVHZXRVc2VySW5mbzogXCJnZXRVc2VySW5mb1wiLCAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBIOiOt+WPlueUqOaIt+S/oeaBr1xyXG4gIFJlY2VpdmVDaGVja0FjdGlvbjogXCJjaGVja0FjdGlvblwiLCAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBICDnlKjmnaXnoa7orqQgU29ja2V0IOi/mOWcqOi/nuedgFxyXG4gIFJlY2VpdmVGb3JjZUV4aXQ6IFwiZm9yY2VFeGl0XCIsICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBICDnlKjmnaXkvb/lrqLmiLfnq6/lvLrpgIBcclxuICBSZWNlaXZlRGlzc29sdmVEZXNrOiBcImRpc3NvbHZlRGVza1wiLCAgICAgIC8vIOacjeWKoeWZqOWPkemAgSAgIOW9k+aIv+S4u+mAgOWHuuaXtu+8jOino+aVo+ahjOWtkFxyXG4gIFJlY2VpdmVJbnRlclJhbmRvbTogXCJpbnRlclJhbmRvbVwiLCAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBICAg6L+b5YWl6ZqP5py65Zy655qE5Y+N6aaIXHJcbiAgUmVjZWl2ZVBhdXNlOiBcInBhdXNlXCIsICAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIEgICDlvZPmnInnlKjmiLforr7lpIfov5vlhaXlkI7lj7Dml7bvvIzkvJrmlLbliLDov5nmnaHmtojmga9cclxuICBSZWNlaXZlSW52aXRlQ29kZTogJ2ludml0ZUNvZGUnLCAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDpgoDor7fnoIHnmoTmtojmga9cclxuICBSZWNlaXZlTGVhdmVEZXNrOiAnbGVhdmVEZXNrJywgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDpnIDopoHnprvlvIDmoYzlrZDnmoTmtojmga9cclxuICBSZWNlaXZlU2VsZWN0QmVpTHY6ICdzZWxlY3RCZWlMdicsICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDpgInmi6nlgI3njofnmoTmtojmga9cclxuICBSZWNlaXZlQmVpTHY6J2JlaUx2JywgICAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDlgI3njofnmoTmtojmga9cclxuICBSZWNlaXZlUWluZ0xpOidxaW5nbGknLCAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDor7fnprtcclxuICBSZWNlaXZlUmVjb3JkSWQ6J3JlY29yZElkJywgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDmiJjnu6nkv6Hmga9cclxuICBSZWNlaXZlTG9naW5Kb2luOidsb2dpbkpvaW4nLCAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDku47pobXpnaLov5vlhaXmiL/pl7Tkv6Hmga9cclxuICBSZWNlaXZlT25jZUFnYWluOidvbmNlQWdhaW4nLCAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDlho3mnaXkuIDlsYDkv6Hmga9cclxuICBSZWNlaXZlTm9VaW9uaWQ6J25vVWlvbmlkJywgICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pS25Yiw5rKh5pyJdW5pb25JROS/oeWPt1xyXG59O1xyXG5cclxuXHJcbi8vIE1BUks6IFNvY2tldCDmj5DkvpvnmoTlj6/lj5Hnu5nmnI3liqHlmajmtojmga/nmoTmlrnms5VcclxuXHJcblNvY2tldC5zZW5kQ2hlY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ2hlY2tBY3Rpb24sIG51bGwpO1xyXG59O1xyXG4vKiovXHJcblNvY2tldC5zZW5kRGlkUmVjZWl2ZUdhbWVPdmVyQWN0aW9uID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gIGNvbnN0IHBhcmFtID0gdXNlcklkID8ge1widXNlcklkXCI6IHVzZXJJZH0gOiBudWxsO1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UoU29ja2V0LkV2ZW50LkRpZFJlY2VpdmVHYW1lT3ZlckFjdGlvbiwgcGFyYW0pO1xyXG59O1xyXG4vKiovXHJcblxyXG5cclxuLyoqXHJcbiAqIOW9kyBBUFAg6L+b5YWl5ZCO5Y+w5pe26KaB5Y+R6YCB55qE5raI5oGvXHJcbiAqL1xyXG5Tb2NrZXQuc2VuZEFwcFBhdXNlID0gZnVuY3Rpb24odXNlcklkKSB7XHJcbiAgbGV0IHBhcmFtID0gdXNlcklkID8ge1widXNlcklkXCI6IHVzZXJJZH0gOiBudWxsO1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5QYXVzZSwgcGFyYW0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIOW9kyBBUFAg6L+b5YWl5YmN5Y+w5pe25Y+R6YCB55qE5raI5oGvXHJcbiAqL1xyXG5Tb2NrZXQuc2VuZEFwcEFjdGl2ZSA9IGZ1bmN0aW9uKHVzZXJJZCkge1xyXG4gIGxldCBwYXJhbSA9IHVzZXJJZCA/IHtcInVzZXJJZFwiOiB1c2VySWR9IDogbnVsbDtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQWN0aXZlLCBwYXJhbSk7XHJcbn07XHJcblxyXG4vLyDlvIDmiL9cclxuU29ja2V0LnNlbmRDcmVhdGVEZXNrID0gZnVuY3Rpb24gKGNyZWF0ZURlc2NJbmZvLCB1c2VySWQpIHtcclxuICBjYy5hc3NlcnQoY3JlYXRlRGVzY0luZm8pO1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG5cclxuICBjcmVhdGVEZXNjSW5mb1tcInVzZXJJZFwiXSA9IHVzZXJJZDtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ3JlYXRlRGVzaywgY3JlYXRlRGVzY0luZm8pO1xyXG59O1xyXG5cclxuU29ja2V0LnNlbmRRaW5nbGkgPSBmdW5jdGlvbihsZWF2ZUlkLHVzZXJJZCl7XHJcbiBsZXQgcGFyYW0gPSB7XHJcbiAgICBcImxlYXZlSWRcIjogbGVhdmVJZCxcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5RaW5nbGksIHBhcmFtKTtcclxufTtcclxuLy8g5LuO55m76ZmG6aG16Z2i5Yqg5YWl5oi/6Ze0XHJcblNvY2tldC5zZW5kTG9naW5Kb2luID0gZnVuY3Rpb24gKHJvb21JZCwgdXNlcklkKSB7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJyb29tSWRcIjogcm9vbUlkLFxyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gIH07XHJcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkxvZ2luSm9pbiwgcGFyYW0pO1xyXG59O1xyXG4vLyDlho3mnaXkuIDlsYBcclxuU29ja2V0LnNlbmRPbmNlQWdhaW4gPSBmdW5jdGlvbiAoYWdhaW4sdXNlcklkKSB7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gICAgXCJhZ2FpblwiOmFnYWluLFxyXG4gIH07XHJcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50Lk9uY2VBZ2FpbiwgcGFyYW0pO1xyXG59O1xyXG4vLyDliqDlhaXmiL/pl7RcclxuU29ja2V0LnNlbmRKb2luRGVzayA9IGZ1bmN0aW9uIChyb29tSWQsIHVzZXJJZCkge1xyXG4gIGNjLmFzc2VydChyb29tSWQpO1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG5cclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInJvb21JZFwiOiByb29tSWQsXHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuSm9pbkRlc2ssIHBhcmFtKTtcclxufTtcclxuLy8g5ZCR5pyN5Yqh56uv5Y+R6YCB5oiR6YCJ5oup55qE5YCN546HXHJcblNvY2tldC5zZW5kQmVpTHYgPSBmdW5jdGlvbihiZWlsdix1c2VySWQpe1xyXG4gIGxldCBwYXJhbSA9IHtcclxuICAgIFwiYmVpbHZcIjogYmVpbHYsXHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQmVpTHYsIHBhcmFtKTtcclxufTtcclxuLy8g5Y+R6YCB6YKA6K+356CBXHJcblNvY2tldC5zZW5kSW52aXRlQ29kZSA9IGZ1bmN0aW9uKGludml0ZUNvZGUsdXNlcklkKXtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcImludml0ZUNvZGVcIjogaW52aXRlQ29kZSxcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5JbnZpdGVDb2RlLCBwYXJhbSk7XHJcbn07XHJcblxyXG4vLyDojrflj5bmiL/pl7Tkv6Hmga9cclxuU29ja2V0LnNlbmRHZXREZXNja0luZm8gPSBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gIH07XHJcblxyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXREZXNrSW5mbywgcGFyYW0pO1xyXG59O1xyXG5cclxuU29ja2V0LnNlbmRUZXh0ID0gZnVuY3Rpb24gKHVzZXJJZCwgdGV4dCkge1xyXG4gIC8vY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgLy9jYy5hc3NlcnQodGV4dCk7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJtc2dcIjogdGV4dCxcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TZW5kVGV4dCwgcGFyYW0pO1xyXG59O1xyXG5Tb2NrZXQuc2VuZEVtb2ppID0gZnVuY3Rpb24odXNlcklkLGVtb2ppKXtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcImVtb2ppXCI6IGVtb2ppLFxyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gIH07XHJcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlNlbmRFbW9qaSwgcGFyYW0pO1xyXG59O1xyXG5Tb2NrZXQuc2VuZENoYW5nZUluZm8gPSBmdW5jdGlvbih1c2VySWQsSW5mbyl7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJjaGFuZ2VJbmZvXCI6IEluZm8sXHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ2hhbmdlSW5mbywgcGFyYW0pO1xyXG59O1xyXG5Tb2NrZXQuc2VuZEF1ZGlvTWVzc2FnZSA9IGZ1bmN0aW9uICh1c2VySWQsIHVybCA9IFwiXCIpIHtcclxuICBjYy5hc3NlcnQodXNlcklkKTtcclxuICBjYy5hc3NlcnQodXJsLmxlbmd0aCA+IDApO1xyXG5cclxuICBpZiAodXJsLmxlbmd0aCA9PSAwKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInVybFwiOiB1cmwsXHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU2VuZEF1ZGlvTWVzc2FnZSwgcGFyYW0pO1xyXG59O1xyXG5cclxuU29ja2V0LnNlbmRJbWFnZSA9IGZ1bmN0aW9uICh1c2VySWQsIGltYWdlKSB7XHJcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgY2MuYXNzZXJ0KGltYWdlKTtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcIm1zZ1wiOiBpbWFnZSxcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TZW5kSW1hZ2UsIHBhcmFtKTtcclxufTtcclxuXHJcblNvY2tldC5zZW5kR2V0UmVjcm9kID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gIGxldCBwYXJhbSA9IHtcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXRSZWNvcmQsIHBhcmFtKTtcclxufTtcclxuXHJcblNvY2tldC5zZW5kR2V0UmVjcm9kRnJvbUlkID0gZnVuY3Rpb24ocmVjb3JkSWQpe1xyXG4gIGxldCBwYXJhbSA9IHtcclxuICAgIFwicmVjb3JkSWRcIjpyZWNvcmRJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5SZWNvcmRJZCxwYXJhbSk7XHJcbn07XHJcblxyXG5Tb2NrZXQuc2VuZERpc3NvbHZlRGVzayA9IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICBjYy5hc3NlcnQodXNlcklkKTtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuRGlzc29sdmVEZXNrLCBwYXJhbSk7XHJcbn07XHJcblxyXG5Tb2NrZXQuc2VuZEdldEl0ZW1SZWNvcmQgPSBmdW5jdGlvbiAodXNlcklkLCBwYXJlbnRJZCkge1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gIGNjLmFzc2VydChwYXJlbnRJZCk7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gICAgXCJwYXJlbnRJZFwiOiBwYXJlbnRJZCxcclxuICB9O1xyXG5cclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuR2V0SXRlbVJlY29yZCwgcGFyYW0pO1xyXG59O1xyXG5cclxuLy/ojrflj5bku6PlvIDmiL/orrDlvZVcclxuU29ja2V0LnNlbmRHZXREYWlLYWlGYW5nID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gIGxldCBwYXJhbSA9IHtcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZFxyXG4gIH07XHJcblxyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXREYWlLYWlEZXNrLCBwYXJhbSk7XHJcbn07XHJcblxyXG5Tb2NrZXQuc2VuZExlYXZlRGVzayA9IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gICAgbGV0IHBhcmFtID0ge1xyXG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5MZWF2ZURlc2ssIHBhcmFtKTtcclxufSxcclxuXHJcbi8qKlxyXG4gKiDlm57nrZTpgIDmiL/or7fmsYJcclxuICogXHJcbiAqIEBwYXJhbSAge051bWJlcn0gdXNlcklkIOW9k+WJjeeUqOaItyBpZFxyXG4gKiBAcGFyYW0gIHtOVW1iZXJ9IGFuc3dlcj0xIOWbnuetlOOAgjEg6KGo56S65ZCM5oSP77ybIDAg6KGo56S65ouS57ud77ybIC0xIOihqOekuuacqumAieaLqVxyXG4gKi9cclxuU29ja2V0LnNlbmRBbnN3ZXJEaXNzb2x2ZSA9IGZ1bmN0aW9uICh1c2VySWQsIGFuc3dlciA9IDApIHtcclxuICBjYy5hc3NlcnQodXNlcklkKTtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgICBcImFuc3dlclwiOiBhbnN3ZXJcclxuICB9O1xyXG5cclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQW5zd2VyRGlzc29sdmUsIHBhcmFtKTtcclxufSxcclxuXHJcbiAgU29ja2V0LnNlbmRGb3JjZUV4aXRSb29tID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgICBsZXQgcGFyYW0gPSB7XHJcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkRpc3NvbHZlRGVzaywgcGFyYW0pO1xyXG4gIH0sXHJcblxyXG4gIC8vIOWNgeS4ieW8oOS4rVxyXG4gIC8vIGNhcmRJbmZvIOexu+S8vOS6ju+8mlxyXG4gIC8vIFt7XHJcbiAgLy8gICAgICAgICAnY2FyZHMnOlt7J3N1aXQnOnN1aXQsJ251bWJlcic6bnVtYmVyfSx7fV0sLy/nibnmrorniYzkuI3nlKjkvKBcclxuICAvLyAgICAgICAgICd0eXBlJzowLFxyXG4gIC8vICAgICAgICAgJ3ZhbHVlJzo0LFxyXG4gIC8vICAgICAgICAgJ2lzQ29udGFpbkV4dHJhJzp0cnVlLC8vIOeJueauiueJjOaYr+WQpuWMheWQq+eJueauiueJjFxyXG4gIC8vICAgICB9LFxyXG4gIC8vICAgICB7XHJcbiAgLy8gICAgICAgICAnY2FyZHMnOlt7J3N1aXQnOnN1aXQsJ251bWJlcic6bnVtYmVyfSx7fV0sXHJcbiAgLy8gICAgICAgICAndHlwZSc6MCxcclxuICAvLyAgICAgICAgICd2YWx1ZSc6NFxyXG4gIC8vICAgICB9XVxyXG5Tb2NrZXQuc2VuZFBsYXlDYXJkID0gZnVuY3Rpb24gKHVzZXJJZCwgY2FyZEluZm8pIHtcclxuICAgIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gICAgbGV0IHBhcmFtID0ge1xyXG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgICAgIFwiY2FyZFwiOiBjYXJkSW5mb1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuUGxheUNhcmQsIHBhcmFtKTtcclxufTtcclxuXHJcblNvY2tldC5zZW5kVGltZW91dERpc3NvbHZlID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gIGxldCBwYXJhbSA9IHtcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG5cclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuVGltZW91dERpc3NvbHZlLCBwYXJhbSk7XHJcbn07XHJcblxyXG5Tb2NrZXQuc2VuZEZlZWRiYWNrID0gZnVuY3Rpb24gKHVzZXJJZCwgdGV4dCkge1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gIGNjLmFzc2VydCh0ZXh0KTtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgICBcInRleHRcIjogdGV4dFxyXG4gIH07XHJcblxyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5GZWVkYmFjaywgcGFyYW0pO1xyXG59XHJcblxyXG5Tb2NrZXQuc2VuZFNoYXJlUG5nID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gIGxldCBwYXJhbSA9IHtcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TaGFyZVBuZywgcGFyYW0pO1xyXG59O1xyXG4vLyDlvIDlp4vljLnphY3pmo/mnLrlnLpcclxuU29ja2V0LnNlbmRFbnRlclJhbmRvbSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICBjYy5hc3NlcnQodXNlcklkKTtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuXHJcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkVudGVyUmFuZG9tLCBwYXJhbSk7XHJcbn07XHJcblxyXG4vLyDlj5bmtojljLnphY3pmo/mnLrlnLpcclxuU29ja2V0LnNlbmRDYW5jZWxSYW5kb20gPSBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gIH07XHJcblxyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5DYW5jZWxSYW5kb20sIHBhcmFtKTtcclxufTtcclxuXHJcbi8vIOWHhuWkh1xyXG5Tb2NrZXQuc2VuZFJlYWR5ID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgICBsZXQgcGFyYW0gPSB7XHJcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlJlYWR5LCBwYXJhbSk7XHJcbiAgfSxcclxuICAgIFNvY2tldC5zZW5kU3RhcnRHYW1lID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICBjYy5hc3NlcnQodXNlcklkKTtcclxuICAgICAgbGV0IHBhcmFtID0ge1xyXG4gICAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICAgICAgfTtcclxuICAgICAgY2MubG9nKHRoaXMuRXZlbnQuU3RhcnRHYW1lKVxyXG4gICAgICBjYy5sb2coKVxyXG4gICAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU3RhcnRHYW1lLCBwYXJhbSk7XHJcbiAgICB9LFxyXG5cclxuLy8g6I635Y+W5aSn5Y6F5L+h5oGvXHJcblNvY2tldC5zZW5kR2V0SGFsbEluZm8gPSBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICBsZXQgcGFyYW0gPSB7XHJcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkdldEhhbGxJbmZvLCBwYXJhbSk7XHJcbn0sXHJcblxyXG4vLyDojrflj5bnlKjmiLfkv6Hmga9cclxuU29ja2V0LnNlbmRHZXRVc2VySW5mbyA9IGZ1bmN0aW9uICh1c2VySWQsIG9wZW5JZCkge1xyXG4gICAgbGV0IHBhcmFtID0ge1xyXG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgICAgIFwib3BlbklkXCI6IG9wZW5JZCxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkdldFVzZXJJbmZvLCBwYXJhbSk7XHJcbn0sXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFNvY2tldDsiLCJ0aGlzLl9jaGFuZ2VDYXJkU2NvcnMgPSBmdW5jdGlvbihjYXJkTW9kZWwpIHtcclxuXHJcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7Y2FyZC5zY29yZXMgPSBjYXJkLm51bWJlcjt9KTtcclxuXHJcbiAgICBjYXJkTW9kZWwgPSB0aGlzLl9jb252ZXJ0T25lVG9BKGNhcmRNb2RlbCk7XHJcblxyXG4gICAgdmFyIGlzMTQgPSB0cnVlOy8v5pivQSBLIFEgSiAxMCA7XHJcblxyXG4gICAgdmFyIGlzMSA9IHRydWU7Ly/mmK8xIDIgMyA0IDVcclxuXHJcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7aWYgKGNhcmQuc2NvcmVzIDwgMTApIGlzMTQgPSBmYWxzZTt9KTsvL+S4jeaYr0EgSyBRIEogMTBcclxuXHJcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7aWYgKChjYXJkLnNjb3JlcyA+IDUgfHwgY2FyZC5zY29yZXMgPT0gMTQpICYmIGNhcmQuc2NvcmVzICE9IDIwKWlzMSA9IGZhbHNlfSk7Ly/kuI3mmK8xIDIgMyA0IDV9KTtcclxuXHJcbiAgICBpZiAoaXMxNCkgeyAvL+aYr0EgSyBRIEogMTAgO1xyXG5cclxuICAgICAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtyZXR1cm4gYTIuc2NvcmVzIC0gYTEuc2NvcmVzO30pO1xyXG5cclxuICAgICAgICB2YXIgbnVtID0gMTQsXHJcbiAgICAgICAgICAgIHNjb3Jlc0F5eSA9IFtdOyAvL+S4gOWJr+eJjOeahOWIhuaVsFxyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgc2NvcmVzQXl5LnB1c2gobnVtKTtcclxuXHJcbiAgICAgICAgICAgIG51bSAtPSAxO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRNb2RlbC5sZW5ndGg7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjYXJkU2NvcmVzID0gY2FyZE1vZGVsW2ldLnNjb3JlcztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY2FyZFNjb3JlcyA9PSBzY29yZXNBeXlbal0gJiYgY2FyZFNjb3JlcyA8IDE1KSBzY29yZXNBeXkuc3BsaWNlKGosIDEpOyAvL+WIoOmZpOS4jeaYr+msvOeJjOeahOWIhlxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkgeyBpZiAoY2FyZC5zY29yZXMgPj0gMjApIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLCAxKVswXTt9KTsvL+aJvuWHuumAieS4reeahOeJjFxyXG4gICAgfVxyXG5cclxuICAgIGVsc2UgaWYgKGlzMSkgeyAvL+aYrzEgMiAzIDQgNVxyXG5cclxuICAgICAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtyZXR1cm4gYTIuc2NvcmVzIC0gYTEuc2NvcmVzO30pO1xyXG5cclxuICAgICAgICB2YXIgbnVtID0gNSxcclxuICAgICAgICAgICAgc2NvcmVzQXl5ID0gW107IC8v5LiA5Ymv54mM55qE5YiG5pWwXHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICBzY29yZXNBeXkucHVzaChudW0pO1xyXG5cclxuICAgICAgICAgICAgbnVtIC09IDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNjb3Jlc0F5eS5sZW5ndGg7IGorKykge1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkTW9kZWwubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkgc2NvcmVzQXl5LnNwbGljZShqLCAxKTsgLy/liKDpmaTkuI3mmK/prLzniYznmoTliIZcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtpZiAoY2FyZC5zY29yZXMgPj0gMjApIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLCAxKVswXTt9KTsvL+aJvuWHuumAieS4reeahOeJjFxyXG4gICAgfVxyXG5cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge3JldHVybiBhMS5zY29yZXMgLSBhMi5zY29yZXM7fSk7XHJcblxyXG4gICAgICAgIHZhciBzY29yZXNBeXkgPSBbXTsgLy/nlKjmnaXoo4XprLzniYzliIbmlbBcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBzID0gcGFyc2VJbnQoY2FyZE1vZGVsWzBdLnNjb3JlcykgKyBpOyAvL+acgOWwj+eahOeJjOeahOWIhuaVsFxyXG5cclxuICAgICAgICAgICAgc2NvcmVzQXl5LnB1c2gocyk7Ly/kuIDlia/niYznmoTliIbmlbBcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNjb3Jlc0F5eS5sZW5ndGg7IGorKykge1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkTW9kZWwubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkgc2NvcmVzQXl5LnNwbGljZShqLCAxKTsgLy/liKDpmaTkuI3mmK/prLzniYznmoTliIZcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge2lmIChjYXJkLnNjb3JlcyA+PSAyMCkgY2FyZC5zY29yZXMgPSBzY29yZXNBeXkuc3BsaWNlKDAsMSlbMF07fSk7IC8v5pS55Y+Y54mM55qE5YiG5pWwXHJcbiAgICB9XHJcblxyXG4gICAgY2FyZE1vZGVsID0gdGhpcy5fY29udmVydE9uZVRvQShjYXJkTW9kZWwpO1xyXG5cclxuICAgIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge3JldHVybiBhMS5zY29yZXMgLSBhMi5zY29yZXM7fSk7XHJcbiAgICByZXR1cm4gY2FyZE1vZGVsO1xyXG59OyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbGVmdE5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgUmlndGhOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIF90aW1lOm51bGwsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgc2V0VGltZTogZnVuY3Rpb24gKHRpbWUpIHtcclxuXHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX3RpbWUgPSB0aW1lO1xyXG5cclxuICAgICAgICB0aGlzLmxlZnROb2RlLnJvdGF0aW9uID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5SaWd0aE5vZGUucm90YXRpb24gPSAwO1xyXG5cclxuICAgICAgICB0aGlzLlJpZ3RoTm9kZS5zdG9wQWxsQWN0aW9ucygpO1xyXG5cclxuICAgICAgICB0aGlzLmxlZnROb2RlLnN0b3BBbGxBY3Rpb25zKCk7XHJcblxyXG4gICAgICAgIHRoaXMubGVmdE5vZGUucnVuQWN0aW9uKCBjYy5yb3RhdGVCeSAodGhpcy5fdGltZSwtMTgwKSApO1xyXG5cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICB0aGlzLlJpZ3RoTm9kZS5ydW5BY3Rpb24oIGNjLnJvdGF0ZUJ5ICh0aGlzLl90aW1lLDE4MCkgKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCB0aGlzLl90aW1lKTtcclxuXHJcbiAgICB9LFxyXG5cclxuXHJcblxyXG59KTtcclxuIiwiY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5jb25zdCBQbGF5YmFjayA9IHJlcXVpcmUoJ1BsYXliYWNrJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNwcml0ZUF2YXRhcjogY2MuU3ByaXRlLFxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxTY29yZTogY2MuTGFiZWwsXG4gICAgICAgIHNwcml0ZU9mZmxpbmU6IGNjLlNwcml0ZSxcbiAgICAgICAgdm9pY2VOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBob21lUnVuTm9kZTogY2MuTm9kZSxcbiAgICAgICAgcmVhZHlOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBiZWlsdjpjYy5MYWJlbCxcbiAgICAgICAgc2hvb3ROb2RlczogW2NjLk5vZGVdLFxuICAgICAgICBiYW5rZXJOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBmYW5nWmh1Tm9kZTogY2MuTm9kZSxcbiAgICAgICAgcWluZ2xpOmNjLk5vZGUsXG4gICAgICAgIGlkOmNjLkxhYmVsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMudXBkYXRlU2NvcmUoKTtcbiAgICB9LFxuXG4gICAgc2V0cWluZ2xpIDpmdW5jdGlvbih2aXNpYmxlID0gZmFsc2Upe1xuICAgICAgdGhpcy5xaW5nbGkuYWN0aXZlID0gKHZpc2libGUgIT0gZmFsc2UpO1xuICAgIH0sXG5cbiAgICBzZXRSZWFkeU5vZGVWaXNpYmxlOiBmdW5jdGlvbiAodmlzaWJsZSA9IGZhbHNlKSB7XG4gICAgICB0aGlzLnJlYWR5Tm9kZS5hY3RpdmUgPSAodmlzaWJsZSAhPSBmYWxzZSk7XG4gICAgfSxcbiAgICBzZXRCZWlsdkxhYmVsIDpmdW5jdGlvbihibCl7XG4gICAgICAvL3RoaXMuYmVpbHYuYWN0aXZlID0gdHJ1ZTtcbiAgICAgIHRoaXMuYmVpbHYuc3RyaW5nID0gYmw/YmwrXCLlgI1cIjonJztcbiAgICB9LFxuXG4gICAgc2V0RmFuZ1podU5vZGVWaXNpYmxlOiBmdW5jdGlvbiAodmlzaWJsZSA9IGZhbHNlKSB7XG4gICAgICAgIHRoaXMuZmFuZ1podU5vZGUuYWN0aXZlID0gKHZpc2libGUgIT0gZmFsc2UpO1xuICAgIH0sXG5cbiAgICB1cGRhdGVTY29yZTogZnVuY3Rpb24gKHNjb3JlID0gMCkge1xuICAgICAgICBpZihzY29yZSA+PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmxhYmVsU2NvcmUuc3RyaW5nID0gXCIrXCIgKyBzY29yZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubGFiZWxTY29yZS5zdHJpbmcgPSBcIlwiK3Njb3JlO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB1cGRhdGVVc2VySWQ6ZnVuY3Rpb24oaWQpe1xuICAgICAgdGhpcy5pZC5zdHJpbmcgPSBpZCA/IChcIklEOlwiK2lkKTpcIlwiO1xuICAgIH0sXG4gICAgdXBkYXRlTmlja25hbWU6IGZ1bmN0aW9uKG5pY2tuYW1lID0gXCJcIikge1xuICAgICAgdGhpcy5sYWJlbE5pY2tuYW1lLnN0cmluZyA9IG5pY2tuYW1lO1xuICAgIH0sXG5cbiAgICB1cGRhdGVBdmF0YXI6IGZ1bmN0aW9uIChhdmF0YXIpIHtcbiAgICAgIGlmIChhdmF0YXIuZW5kc1dpdGgoXCJwbmdcIilcbiAgICAgIHx8IGF2YXRhci5lbmRzV2l0aChcImpwZ1wiKVxuICAgICAgfHwgYXZhdGFyLmVuZHNXaXRoKFwiZ2lmXCIpKSB7XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vYXZhdGFyID0gYXZhdGFyICsgXCIucG5nXCI7XG4gICAgICB9XG5cbiAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6YXZhdGFyLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZShkYXRhKTtcbiAgICAgICAgdGhpcy5zcHJpdGVBdmF0YXIuc3ByaXRlRnJhbWUgPSBmcmFtZTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIHNldE9mZmxpbmVWaXNpYmxlOiBmdW5jdGlvbiAodmlzaWJsZSA9IGZhbHNlKSB7XG4gICAgICBpZiAoUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XG4gICAgICAgIC8vIOWmguaenOaYr+WkhOeQhuWbnuaUvueKtuaAge+8jOWwseS4jeeUqOWGjeWkhOeQhuemu+e6v+a2iOaBr+S6hlxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuc3ByaXRlT2ZmbGluZS5ub2RlLmFjdGl2ZSA9IHZpc2libGU7XG4gICAgfSxcblxuICAgIHNldElzQmFua2VyOiBmdW5jdGlvbihpc0JhbmtlciA9IGZhbHNlKSB7XG4gICAgICB0aGlzLmJhbmtlck5vZGUuYWN0aXZlID0gaXNCYW5rZXI7XG4gICAgfSxcblxuICAgIHBsYXlTaG9vdEFuaW1hdGlvbjogZnVuY3Rpb24gKHRvSW5kZXggPSAwKSB7XG4gICAgICAvL2xldCBzaG9vdE5vZGUgPSB0aGlzLnNob290Tm9kZXNbdG9JbmRleF07XG4gICAgICAvL3Nob290Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgLy9sZXQgYW5pbSA9IHNob290Tm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgIC8vYW5pbS5wbGF5KCdzaG9vdCcpLm9uKCdmaW5pc2hlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vICBzaG9vdE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAvL30sIHRoaXMpO1xuXG4gICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheURhUWlhbmcoKTtcbiAgICB9LFxuXG4gICAgcGxheUJ1bGxldEhvbGVBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBidWxsZXRIb2xlTm9kZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSgnYnVsbGV0SG9sZScpO1xuICAgICAgYnVsbGV0SG9sZU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgIGxldCBhbmltID0gYnVsbGV0SG9sZU5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICBhbmltLnBsYXkoJ2J1bGxldEhvbGUnKS5vbignZmluaXNoZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGJ1bGxldEhvbGVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIHBsYXlTcGVha0FuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy52b2ljZU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy52b2ljZU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB9LmJpbmQodGhpcyksIDQpO1xuICAgIH0sXG5cbiAgICAvLyDmkq3mlL7lhajlnpLmiZPliqjnlLtcbiAgICBwbGF5SG9tZVJ1bkFpbWF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAvL2xldCBhbGVydCA9IHRoaXMuaG9tZVJ1bk5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgLy9hbGVydC5hbGVydCgpO1xuICAgICAgLy90aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAvLyAgdGhpcy5ob21lUnVuTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIC8vfS5iaW5kKHRoaXMpLCAyKTtcbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBub2RlczpbY2MuTm9kZV0sXG4gICAgICAgIC8vc2VsZWN0ZWRJbmRleDogMCxcbiAgICAgICAgIF9zZWxlY3RlZDoxLFxuICAgIH0sXG5cbiAgICAvKiMjIyMqL1xuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3NlbGVjdCA9IHRydWU7IFxuICAgICAgICB2YXIgemhvbmd0dWppbnJ1ID0gMDtcbiAgICAgICAgaWYoY2Muc2V0KXtcbiAgICAgICAgICAgIHpob25ndHVqaW5ydSA9IGNjLnNldC5zZXR0aW5nMTA7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RlZCA9IHRoaXMuX3NlbGVjdCA9IHpob25ndHVqaW5ydTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWN0aXZlID0gdGhpcy5fc2VsZWN0O1xuICAgICAgICAgICAgdGhpcy5fc2VsZWN0ZWQgPSB0aGlzLl9zZWxlY3Q7XG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jykuc2V0U2VsZWN0ZWQoYWN0aXZlKTtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMubm9kZXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XG4gICAgICAgICAgICBpZiggc2VsZi5fc2VsZWN0ICl7XG4gICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0Q29tcCA9IHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcbiAgICAgICAgICAgIHRDb21wLmluZGV4ID0gaTtcbiAgICAgICAgICAgIHRDb21wLmNsaWNrQWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZCggc2VsZi5fc2VsZWN0ZWQgPSBzZWxmLl9zZWxlY3QgPSAhc2VsZi5fc2VsZWN0ICk7XG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwidGl0bGVcIik7XG4gICAgICAgICAgICAgICAgaWYoIHNlbGYuX3NlbGVjdCApe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxmLm9uU2VsZWN0Q2hhbmdlKHRoaXMuaW5kZXgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiggdGhpcy5ub2RlLl9uYW1lID09IFwib3JkZXJzXCIgJiYgY2Muc2V0KXtcbiAgICAgICAgICAgIC8vdGhpcy5yZW1lbWJlcl9zZXQob3ZlclRpbWUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICByZW1lbWJlcl9zZXQ6ZnVuY3Rpb24ob2JqKXtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKG9iaik7XG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENoaWxkQnlOYW1lKCd0aXRsZScpLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcbiAgICAgICAgICAgIGlmKCBvYmogKXtcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGVzWzBdLmdldENoaWxkQnlOYW1lKCd0aXRsZScpO1xuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uU2VsZWN0Q2hhbmdlOiBmdW5jdGlvbiAoc2VsZWN0SW5kZXgpIHtcbiAgICAgICAgLy9jYy5sb2coc2VsZWN0SW5kZXgpO1xuICAgIH0sXG4gICAgXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHpodWFuTnVtTGFiZWw6Y2MuTGFiZWwsXG4gICAgICAgIGp1c2h1OmNjLk5vZGUsXG4gICAgICAgIEFBOmNjLk5vZGUsXG4gICAgICAgIF9zZWxlY3RlZFBlb3BsZUluZGV4Om51bGwsXG4gICAgICAgIF9zZWxlY3RlZEp1c2h1SW5kZXg6bnVsbCxcbiAgICAgICAgX3NlbGVjdGVkQUFJbmRleDpudWxsXG4gICAgfSxcblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jdHJsKCk7XG4gICAgfSxcblxuICAgIGNsaWNrUGVvcGxlQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9jdHJsKCk7XG4gICAgfSxcblxuICAgIGNsaWNrQUFBY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY3RybCgpO1xuICAgIH0sXG5cbiAgICBjbGlja0p1c2h1QWN0aW9uOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY3RybCgpO1xuICAgIH0sXG5cbiAgICAgX2N0cmw6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChcInNpbmdsZVNlbGVjdFwiKS5zZWxlY3RlZEluZGV4O1xuICAgICAgICB0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPSB0aGlzLmp1c2h1LmdldENvbXBvbmVudChcInNpbmdsZVNlbGVjdFwiKS5zZWxlY3RlZEluZGV4O1xuICAgICAgICB0aGlzLl9zZWxlY3RlZEFBSW5kZXggPSB0aGlzLkFBLmdldENvbXBvbmVudChcImNoZWNrU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XG4gICAgICAgIC8v5Lq65pWw6YCJMuS6uuaXtuS4lOayoemAieS4ikFB5Yi25pS26LS5XG4gICAgICAgICB2YXIgcmVuU2h1ID0gMjtcbiAgICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMCl7XG4gICAgICAgICAgICAgcmVuU2h1ID0gMjtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9PSAxKXtcbiAgICAgICAgICAgICByZW5TaHUgPSAzO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDIpe1xuICAgICAgICAgICAgIHJlblNodSA9IDQ7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMyl7XG4gICAgICAgICAgICAgcmVuU2h1ID0gNTtcbiAgICAgICAgIH1cbiAgICAgICAgIHZhciB6aHVhbmdTaGkgPSAyMDtcbiAgICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgICAgICB6aHVhbmdTaGkgPSAyMDtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IDQwO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgICAgICAgemh1YW5nU2hpID0gODA7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAzKXtcbiAgICAgICAgICAgICB6aHVhbmdTaGkgPSAxMDtcbiAgICAgICAgIH1cbiAgICAgICAgIC8vQUFcbiAgICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkQUFJbmRleCAhPSBudWxsKXtcbiAgICAgICAgICAgICB6aHVhbmdTaGkgPSBNYXRoLmNlaWwoemh1YW5nU2hpIC8gcmVuU2h1KTtcbiAgICAgICAgIH1cbiAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSB6aHVhbmdTaGk7XG4gICAgICAgIC8vaWYodGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgaWYodGhpcy5fc2VsZWN0ZWRBQUluZGV4ID09IG51bGwpe1xuICAgICAgICAgICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgICAgICAgICAvL2lmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgICAgICAgICAvLyAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIxMFwiO1xuICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgIC8vLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAgICAgICAgIC8vaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAgICAgICAgIC8vICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjMwXCI7XG4gICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAgICAgLy8vL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgICAgICAgICAgLy9pZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgICAgICAgICAgLy8gICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiODBcIjtcbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgIC8vfVxuICAgICAgICAvLyAgICBlbHNle1xuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjhcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMjDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIxNVwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkzMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDIpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjIzXCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy9cbiAgICAgICAgLy99XG4gICAgICAgIC8v5Lq65pWw6YCJM+S6ulxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9PSAxKXtcbiAgICAgICAgLy8gICAgLy/msqHpgInkuIpBQeWItuaUtui0uVxuICAgICAgICAvLyAgICBpZih0aGlzLl9zZWxlY3RlZEFBSW5kZXggPT0gbnVsbCl7XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjFcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMjDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI0MlwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkzMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDIpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjYwXCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy8gICAgLy/pgInkuoZBQeaUtui0uVxuICAgICAgICAvLyAgICBlbHNle1xuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjdcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMjDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIxNFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkzMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDIpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjIwXCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy9cbiAgICAgICAgLy99XG4gICAgICAgIC8vLy/kurrmlbDpgIk05Lq65LiU5rKh6YCJ5LiKQUHliLbmlLbotLlcbiAgICAgICAgLy9lbHNle1xuICAgICAgICAvLyAgICBpZih0aGlzLl9zZWxlY3RlZEFBSW5kZXggPT0gbnVsbCl7XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjhcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMjDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI1NlwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkzMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDIpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjg0XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy8gICAgLy9BQeWItuaUtui0uemAieS4iuS6hlxuICAgICAgICAvLyAgICBlbHNle1xuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjdcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMjDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIxNFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkzMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDIpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjIxXCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgIH1cbiAgICAgICAgLy99XG4gICAgfSxcbn0pO1xuIl19