require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"ArrayExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4fd85NSsFJLd4qHrH0UjHzl', 'ArrayExtension');
// scripts\Extensions\ArrayExtension.js

// 给 Array 添加方法
// arr.find(...)
// arr.findIndex(...)
// arr.includes(e)
// arr.unique(equalFunction, isNewArray)
// Array.from
// Array.equal
// arr.isEqual(otherArray, isStrict)
// Array.sortByNumber
// arr.findSubArrayIndexs([])   用于查找数组内的部分元素的索引
// arr.translationWithStartIndex(startIndex) 将数组内的元素平移
// 如：[1, 2, 3, 4, 5].translationWithStartIndex(3) => [4,5,1,2,3]
// arr.kq_insert(index, e)   插入一个元素
// arr.kq_excludes(array)   // 除了array数组中的元素

module.exports = {};

if (!Array.prototype.find) {
  Array.prototype.find = function (predicate) {
    'use strict';
    if (this == null) {
      throw new TypeError('Array.prototype.find called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return value;
      }
    }
    return undefined;
  };
}

if (!Array.prototype.findIndex) {
  Array.prototype.findIndex = function (predicate) {
    if (this === null) {
      throw new TypeError('Array.prototype.findIndex called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return i;
      }
    }
    return -1;
  };
}

// https://tc39.github.io/ecma262/#sec-array.prototype.includes
if (!Array.prototype.includes) {
  Object.defineProperty(Array.prototype, 'includes', {
    enumerable: false,
    value: function value(searchElement, fromIndex) {

      // 1. Let O be ? ToObject(this value).
      if (this == null) {
        throw new TypeError('"this" is null or not defined');
      }

      var o = Object(this);

      // 2. Let len be ? ToLength(? Get(O, "length")).
      var len = o.length >>> 0;

      // 3. If len is 0, return false.
      if (len === 0) {
        return false;
      }

      // 4. Let n be ? ToInteger(fromIndex).
      //    (If fromIndex is undefined, this step produces the value 0.)
      var n = fromIndex | 0;

      // 5. If n ≥ 0, then
      //  a. Let k be n.
      // 6. Else n < 0,
      //  a. Let k be len + n.
      //  b. If k < 0, let k be 0.
      var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

      // 7. Repeat, while k < len
      while (k < len) {
        // a. Let elementK be the result of ? Get(O, ! ToString(k)).
        // b. If SameValueZero(searchElement, elementK) is true, return true.
        // c. Increase k by 1.
        // NOTE: === provides the correct "SameValueZero" comparison needed here.
        if (o[k] === searchElement) {
          return true;
        }
        k++;
      }

      // 8. Return false
      return false;
    }
  });
}

// unique
if (!Array.prototype.unique) {
  Object.defineProperty(Array.prototype, 'unique', {
    enumerable: false,
    value: function value(equalFunction) {
      var newArray = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

      if (newArray) {
        return this._unqiue_new(equalFunction);
      }

      return this._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue_new', {
    enumerable: false,
    value: function value(equalFunction) {
      var array = Array.from(this);

      return array._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue', {
    enumerable: false,
    value: function value(equalFunction) {
      var len = this.length;
      var i = -1;

      while (i++ < len) {
        var j = i + 1;

        for (; j < this.length; ++j) {
          var isEqual = false;
          if (equalFunction) {
            isEqual = equalFunction(this[i], this[j]);
          } else {
            isEqual = this[i] === this[j];
          }

          if (isEqual) {
            this.splice(j--, 1);
          }
        }
      }
      return this;
    }
  });
}

// Production steps of ECMA-262, Edition 6, 22.1.2.1
// Reference: https://people.mozilla.org/~jorendorff/es6-draft.html#sec-array.from
if (!Array.from) {
  Array.from = (function () {
    var toStr = Object.prototype.toString;
    var isCallable = function isCallable(fn) {
      return typeof fn === 'function' || toStr.call(fn) === '[object Function]';
    };
    var toInteger = function toInteger(value) {
      var number = Number(value);
      if (isNaN(number)) {
        return 0;
      }
      if (number === 0 || !isFinite(number)) {
        return number;
      }
      return (number > 0 ? 1 : -1) * Math.floor(Math.abs(number));
    };
    var maxSafeInteger = Math.pow(2, 53) - 1;
    var toLength = function toLength(value) {
      var len = toInteger(value);
      return Math.min(Math.max(len, 0), maxSafeInteger);
    };

    // The length property of the from method is 1.
    return function from(arrayLike /*, mapFn, thisArg */) {
      // 1. Let C be the this value.
      var C = this;

      // 2. Let items be ToObject(arrayLike).
      var items = Object(arrayLike);

      // 3. ReturnIfAbrupt(items).
      if (arrayLike == null) {
        throw new TypeError("Array.from requires an array-like object - not null or undefined");
      }

      // 4. If mapfn is undefined, then let mapping be false.
      var mapFn = arguments.length > 1 ? arguments[1] : void undefined;
      var T;
      if (typeof mapFn !== 'undefined') {
        // 5. else
        // 5. a If IsCallable(mapfn) is false, throw a TypeError exception.
        if (!isCallable(mapFn)) {
          throw new TypeError('Array.from: when provided, the second argument must be a function');
        }

        // 5. b. If thisArg was supplied, let T be thisArg; else let T be undefined.
        if (arguments.length > 2) {
          T = arguments[2];
        }
      }

      // 10. Let lenValue be Get(items, "length").
      // 11. Let len be ToLength(lenValue).
      var len = toLength(items.length);

      // 13. If IsConstructor(C) is true, then
      // 13. a. Let A be the result of calling the [[Construct]] internal method of C with an argument list containing the single item len.
      // 14. a. Else, Let A be ArrayCreate(len).
      var A = isCallable(C) ? Object(new C(len)) : new Array(len);

      // 16. Let k be 0.
      var k = 0;
      // 17. Repeat, while k < len… (also steps a - h)
      var kValue;
      while (k < len) {
        kValue = items[k];
        if (mapFn) {
          A[k] = typeof T === 'undefined' ? mapFn(kValue, k) : mapFn.call(T, kValue, k);
        } else {
          A[k] = kValue;
        }
        k += 1;
      }
      // 18. Let putStatus be Put(A, "length", len, true).
      A.length = len;
      // 20. Return A.
      return A;
    };
  })();
}

if (!Array.equal) {
  Array.equal = function (arr1, arr2) {
    var strict = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (arr1 === undefined || arr2 === undefined) {
      return false;
    }

    var length = arr1.length;
    if (length !== arr2.length) return false;
    for (var i = 0; i < length; i++) {
      if (strict) {
        if (arr1[i] !== arr2[i]) {
          return false;
        }
      } else {
        var value1 = arr1[i];
        var value2 = arr2[i];
        var result = true;
        if (Array.isArray(value1) && Array.isArray(value2)) {
          result = Array.equal(value1, value2, strict);
        } else {
          result = value1 == value2;
        }
      }
    }

    return true;
  };
}

if (!Array.prototype.isEqual) {
  Object.defineProperty(Array.prototype, 'isEqual', {
    enumerable: false,
    value: function value(otherArray) {
      var strict = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

      return Array.equal(this, otherArray, strict);
    }
  });
}

if (!Array.sortByNumber) {
  Array.sortByNumber = function (n1, n2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    return (n1 - n2) * (asc ? 1 : -1);
  };
}

if (!Array.prototype.findSubArrayIndexs) {
  Object.defineProperty(Array.prototype, 'findSubArrayIndexs', {
    enumerable: false,
    value: function value(subArray, f) {
      var _this = this;

      var indexs = [];

      var _loop = function () {
        var subValue = subArray[i];
        var findFunc = f || function (thisValue) {
          return subValue === thisValue;
        };
        var index = _this.findIndex(findFunc);
        if (index >= 0) {
          indexs.push(index);
        } else {
          indexs = [];
          return 'break';
        }
      };

      for (var i in subArray) {
        var _ret = _loop();

        if (_ret === 'break') break;
      }

      return indexs.length > 0 ? indexs : null;
    }
  });
}

if (!Array.prototype.translationWithStartIndex) {
  Object.defineProperty(Array.prototype, 'translationWithStartIndex', {
    enumerable: false,
    value: function value(startIndex) {
      if (startIndex == 0) {
        return this;
      }

      if (startIndex >= this.length) {
        return this;
      }

      var pre = this.slice(startIndex);
      var last = this.slice(0, startIndex);
      var result = pre.concat(last);

      return result;
    }
  });
}

if (!Array.prototype.kq_insert) {
  Object.defineProperty(Array.prototype, 'kq_insert', {
    enumerable: false,
    value: function value(index, e) {
      if (e == null) {
        return this;
      }

      if (index >= this.length) {
        this.push(e);
        return;
      }

      this.splice(index, 0, e);

      return this;
    }
  });
}

if (!Array.prototype.kq_excludes) {
  Object.defineProperty(Array.prototype, 'kq_excludes', {
    enumerable: false,
    value: function value(otherArray) {
      if (otherArray == null) {
        return this;
      }

      var result = [];
      this.forEach(function (element) {
        if (!otherArray.includes(element)) {
          result.push(element);
        }
      });

      return result;
    }
  });
}

/*
if(!Array.prototype.min){
  Array.prototype.min = function() {
    var min = this[0];
    var len = this.length;
    for (var i = 1; i < len; i++) {
      if (this[i] < min) {
        min = this[i];
      }
    }
    return min;
  }
}*/

cc._RFpop();
},{}],"AudioManager":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd5deKFuSZAC4Ky0zI4+z6O', 'AudioManager');
// scripts\Audio\AudioManager.js

var manager = require('manager');

var AudioManager = cc.Class({
    "extends": cc.Component,

    properties: {
        hall_bgm: {
            "default": null,
            url: cc.AudioClip
        },

        // 打枪
        daQiang: {
            "default": null,
            url: cc.AudioClip
        },

        fapai: {
            "default": null,
            url: cc.AudioClip
        },

        window: {
            "default": null,
            url: cc.AudioClip
        },

        click_weixin_login: {
            "default": null,
            url: cc.AudioClip
        },

        fangPai: {
            "default": null,
            url: cc.AudioClip
        }

    },

    statics: {
        instance: null
    },

    onLoad: function onLoad() {
        AudioManager.instance = this;
        this._registerAppActiveChange();

        this.soundOn = true;
        cc.game.addPersistRootNode(this.node);
        if (cc.game.isPersistRootNode(this.node)) {
            // cc.log('添加全局节点成功');
        }
        this.mValue = manager.getMusicValue();
        this.mEValue = manager.getMusicEffectValue();
        this.bgAudioId = -1;
    },

    stopHallMusic: function stopHallMusic() {
        cc.audioEngine.stop(this.bgAudioId);
    },

    playMusic: function playMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.hall_bgm, true);
        if (this.bgAudioId != -1) {
            //cc.log('play');
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
        //cc.audioEngine.playMusic( url, true )
    },

    playCompareCardsMusic: function playCompareCardsMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.hall_bgm, true);
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
    },

    playDaQiang: function playDaQiang() {
        for (var start = 0; start <= 1.6; start = start + 0.5) {
            this.scheduleOnce((function () {
                this._playSFX(this.daQiang);
            }).bind(this), start);
        }
    },

    // “打枪”
    playHumanDaQiang: function playHumanDaQiang() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = "resources/sounds/man" /* + (sex == 1 ? "man" : "woman")*/;
        path = path + "/daqiang1.mp3";

        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // “中枪”
    playHumanZQiang: function playHumanZQiang() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = "resources/sounds/man" /* + (sex == 1 ? "man" : "woman")*/;
        path = path + "/daqiang3.mp3";

        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playPokerClick: function playPokerClick() {
        var url = cc.url.raw('resources/sounds/public/click_wx_login.mp3');
        this._playSFX(url);
    },

    // 播放全垒打音效
    playHomeRun: function playHomeRun() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "special1.mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放发牌音效
    playFaPai: function playFaPai() {
        var path1 = this._soundsHumanPath(1) + "room_start_compare.mp3";
        var url1 = cc.url.raw(path1);
        this._playSFX(url1);
        //let pokerDeal = this._soundsHumanPath(1) + "poker_deal.mp3";
        //let urlPokerDeal = cc.url.raw(pokerDeal);
        //this._playSFX(urlPokerDeal);
        this._playSFX(this.fapai);
        for (var index = 0; index < 6; index++) {
            this.scheduleOnce((function () {
                this._playSFX(this.fapai);
            }).bind(this), index * 0.1);
        }
    },

    playCardType: function playCardType() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];
        var type = arguments.length <= 1 || arguments[1] === undefined ? -1 : arguments[1];

        // 只播放普通类型的语音
        if (type >= 10 || type < 0) {
            // 10 及以上是特殊牌
            var _path = this._soundsHumanPath(sex) + type + ".mp3";
            var _url = cc.url.raw(_path);
            this._playSFX(_url);
            return;
        }

        var path = this._soundsHumanPath(sex) + "common" + (type + 1) + ".mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放 开始比牌
    playStartCompare: function playStartCompare() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "start_compare.mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playWin: function playWin() {
        var url = cc.url.raw('resources/sounds/openface/win.mp3');
        this._playSFX(url);
    },

    playLose: function playLose() {
        var url = cc.url.raw('resources/sounds/openface/lose.mp3');
        this._playSFX(url);
    },

    coinIncome: function coinIncome() {
        var url = cc.url.raw('resources/sounds/openface/coin_income.mp3');
        this._playSFX(url);
    },

    _soundsHumanPath: function _soundsHumanPath(sex) {
        var path = "resources/sounds/man/" /* + (sex == 1 ? "man" : "woman") + "/"*/;
        return path;
    },

    setBgMusicVolumn: function setBgMusicVolumn(value) {
        this.mValue = value;
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, value);
        }
    },

    setEffectMusicVolum: function setEffectMusicVolum(value) {
        this.mEValue = value;
    },

    /*聊天*/
    playChatAudio: function playChatAudio(sex, str) {
        var index = this.chatTexts().indexOf(str);
        if (index === -1) {
            return;
        }
        var number = "CHAT" + (index + 1);
        var path = "resources/sounds/chat/" + number + ".mp3";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    chatTexts: function chatTexts() {
        return ['还不出牌，我都快去吃锅边糊了', '嗨呀，我家里老人都比你打的快', '嗨呀，打牌打的我都困了', '哎，你快慢慢找，我先去西湖逛一下', '快一点呀，我等你想好我厕所都上一趟了', '你这在干嘛，这么慢', '嗨呀，最近在忙什么，很久没见了', '来来来，三缺一', '来来来，赶紧坐下来打一圈', '跟你们这些高手打我会紧张，让我一点', '蛮晚到天亮，输了可以让你们先欠着'];
    },

    pauseMusic: function pauseMusic() {
        this.soundOn = false;
        cc.audioEngine.pauseMusic();
    },

    resumeMusic: function resumeMusic() {
        this.soundOn = true;
        cc.audioEngine.resumeMusic();
    },

    _playSFX: function _playSFX(clip) {
        if (this.soundOn) {
            var audioId = cc.audioEngine.playEffect(clip, false);
            cc.audioEngine.setVolume(audioId, this.mEValue);
            return audioId;
        }

        return null;
    },

    // MARK: 前后台操作
    _registerAppActiveChange: function _registerAppActiveChange() {
        cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
        cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
    },

    /**
     * 进入后台
     */
    _appEnterBackground: function _appEnterBackground() {
        var now = cc.sys.now();
        if (now - this._lastAppEnterBackgroundTime < 100) {
            return;
        }
        this._lastAppEnterBackgroundTime = now;

        this.pauseMusic();
    },

    /**
     * 进入前台
     */
    _appBecomActive: function _appBecomActive() {
        var now = cc.sys.now();
        if (now - this._lastAppBecomActiveTime < 100) {
            return;
        }
        this._lastAppBecomActiveTime = now;

        this.resumeMusic();
    },

    /*确定按钮音效*/
    playBtnClickSFX: function playBtnClickSFX() {
        this._playSFX(this.click_weixin_login);
    },
    /*公共按钮，按键或者关闭按钮之类的音效*/
    palyBtnPublicSFX: function palyBtnPublicSFX() {
        this._playSFX(this.click_weixin_login);
    },

    /*取消按钮音效*/
    palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyWindowSFX: function palyWindowSFX() {
        this._playSFX(this.window);
    },
    palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyFangPaiSFX: function palyFangPaiSFX() {
        this._playSFX(this.fangPai);
    }

});

module.exports = AudioManager;

cc._RFpop();
},{"manager":"manager"}],1:[function(require,module,exports){
'use strict'

exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function placeHoldersCount (b64) {
  var len = b64.length
  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // the number of equal signs (place holders)
  // if there are two placeholders, than the two characters before it
  // represent one byte
  // if there is only one, then the three characters before it represent 2 bytes
  // this is just a cheap hack to not do indexOf twice
  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0
}

function byteLength (b64) {
  // base64 is 4/3 + up to two characters of the original data
  return b64.length * 3 / 4 - placeHoldersCount(b64)
}

function toByteArray (b64) {
  var i, j, l, tmp, placeHolders, arr
  var len = b64.length
  placeHolders = placeHoldersCount(b64)

  arr = new Arr(len * 3 / 4 - placeHolders)

  // if there are placeholders, only get up to the last complete 4 chars
  l = placeHolders > 0 ? len - 4 : len

  var L = 0

  for (i = 0, j = 0; i < l; i += 4, j += 3) {
    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]
    arr[L++] = (tmp >> 16) & 0xFF
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  if (placeHolders === 2) {
    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[L++] = tmp & 0xFF
  } else if (placeHolders === 1) {
    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var output = ''
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    output += lookup[tmp >> 2]
    output += lookup[(tmp << 4) & 0x3F]
    output += '=='
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])
    output += lookup[tmp >> 10]
    output += lookup[(tmp >> 4) & 0x3F]
    output += lookup[(tmp << 2) & 0x3F]
    output += '='
  }

  parts.push(output)

  return parts.join('')
}

},{}],2:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

'use strict'

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('isarray')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":1,"ieee754":3,"isarray":4}],3:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],4:[function(require,module,exports){
var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};

},{}],"CardPrefab":[function(require,module,exports){
"use strict";
cc._RFpush(module, '94cdbrbPc9KRqx+1sHumWI3', 'CardPrefab');
// scripts\CardPrefab.js

var KQCard = require('KQCard');

cc.Class({
  'extends': cc.Component,

  properties: {
    graySprite: cc.Sprite,

    _cardName: null,
    _kqCardMode: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.graySprite.node.active = false;
  },

  // 通过牌名设置牌
  setCard: function setCard(cardName) {
    this._setCardName(cardName);

    this._loadCardFrame(cardName, (function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }).bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._kqCardMode;
  },

  _setCardName: function _setCardName(cardName) {
    this._cardName = cardName;
    this._kqCardMode = new KQCard(cardName);
  },

  // 设置选择状态
  setSelected: function setSelected() {
    var selected = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.graySprite.node.active = selected;
  },

  isSelected: function isSelected() {
    return this.graySprite.node.active;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"CardTypeCombine":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45c41vwAhFNYYSXDvaKpEP0', 'CardTypeCombine');
// scripts\CardTypeCombine.js

var _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var AudioManager = require('AudioManager');
var play = require('play');
var KQCardScoretsHelper = require('KQCardScoretsHelper');
// 牌类型 component
//
cc.Class({
    'extends': cc.Component,
    statics: {
        instances: null
    },
    properties: {
        cardsLayout: cc.Layout,
        // btnDuiZi: cc.Button,
        // btnLiangDui: cc.Button,
        // btnSanTiao: cc.Button,
        // btnShunZi: cc.Button,
        // btnTongHua: cc.Button,
        // btnHuLu: cc.Button,
        // btnTieZhi: cc.Button,
        // btnTongHuaShun: cc.Button,
        // btnWuTong: cc.Button,
        // typeButtonsNode: cc.Node,
        btnDeleteTouDao: cc.Button, // 头道
        btnDeleteZhongDao: cc.Button, // 中道
        btnDeleteWeiDao: cc.Button, // 尾道
        btnCancelAll: cc.Button, // 全部取消
        btnDone: cc.Button, // 确定出牌
        timeNode: cc.Node,
        labelTime: cc.Label,
        layoutTouDao: cc.Layout,
        layoutZhongDao: cc.Layout,
        layoutWeiDao: cc.Layout,
        cardAllNode: cc.Node,
        cardPrefab: cc.Prefab,
        cardTypePrefab: cc.Prefab,

        touDaoNode: cc.Node,
        zhongDaoNode: cc.Node,
        weiDaoNode: cc.Node,

        autoCardScrollView: cc.ScrollView,
        autoCard: cc.Prefab,
        autoCardLayout: cc.Layout,
        autoCardAnimation: cc.Node,

        LayoutWithEvent: [],

        BtnClickGongXiNiComfirm: false, //用于检查用户是否点击了恭喜你页面的确定按钮
        cardsLayoutSortColor: false,
        /*#####*/

        _cardOffsetY: null,

        _kqCardModes: [],
        _allCardModes: [],
        _findCardTypeObject: null, // 用来记录找到的牌型对象
        _findCardIndex: null, // 用来记录找到的牌型对象

        _finishSelectCardsCallback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.BtnClickGongXiNiComfirm = false;
        this.cardsLayoutSortColor = false;
        this._cardOffsetY = 0;
        this._registerTouchEvents();
        this._registerDaosLayoutClickEvent();
        this.reset();
        this._findCardIndex = {};
        this.cardTime = 0.3;

        this.cardSpriteAtlas = this.node.parent.getComponent('play').cardSpriteAtlas;
        this.daoSpriteAtlas = this.node.parent.getComponent('play').daoSpriteAtlas;
    },

    /*#####点击空白地方将牌收回去*/
    onClickCardTypeCombineNode: function onClickCardTypeCombineNode() {
        this._resetCardsPositionY();
    },

    _hideDeleteButtons: function _hideDeleteButtons() {
        //this.btnDeleteTouDao.node.active = false;
        //this.btnDeleteZhongDao.node.active = false;
        //this.btnDeleteWeiDao.node.active = false;
    },

    // 重置，回到最初始有状态
    reset: function reset() {
        this._hideDeleteButtons();
        this.clearCards();
        this.timeStop();
        //this._typeButtons().forEach(function (button) {
        //    button.interactable = false;
        //});
        this._allCardModes = [];
    },

    cardsLayoutSort: function cardsLayoutSort(e) {
        var nodeAyy = e.target.children;
        if (nodeAyy[0].active == true) {
            //按大小
            this.cardsLayoutSortColor = true;
            nodeAyy[0].active = false;
            nodeAyy[1].active = true;
            this._resetCardsPositionX();
            return;
        } else if (nodeAyy[1].active == true) {
            //按花色
            this.cardsLayoutSortColor = false;
            nodeAyy[0].active = true;
            nodeAyy[1].active = false;
            this._resetCardsPositionX();
        }
        //this.cardsLayoutSortColor = nodeAyy[1].active == false;
        //this.cardsLayoutSortColor == true
    },

    addCards: function addCards(cardNames) {
        cc.assert(cardNames);
        this._resetCardsPositionY();
        //cardNames.sort(function(a1,a2){
        //    return a1.split('_')[0] - a2.split('_')[0];
        //})
        cardNames.forEach((function (card, index) {
            this.addCard(card, false, index);
        }).bind(this));
        //this.cardsLayoutSort();
        this._resetCardsPositionX();
        this._reloadKQCardModesInner();
        this._resetTypeButtonEnablesWithModels(this._kqCardModes);
    },

    addCard: function addCard(cardName) {
        var autoChangePositionX = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var index = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];

        cc.assert(cardName.length > 0);

        var cardPrefab = cc.instantiate(this.cardPrefab);
        cardPrefab.name = cardName;
        // if(cc.maPai){
        //     var cardMaPai = '3_' + cc.maPai;
        //     if(cardName == cardMaPai){
        //         cardPrefab.color = new cc.Color(226, 145, 145);
        //     }
        // }
        cardPrefab.getComponent('CardPrefab').setCard(cardName, index);
        this.cardsLayout.node.addChild(cardPrefab);
        cardPrefab.setPositionY(this._cardOffsetY);

        if (autoChangePositionX) {
            this._resetCardsPositionX();
        }
        //let newCard = new KQCard(cardName,null,index);
        //let originCard = this._allCardModes.find(function(card) {
        //    return card.isEqual(newCard);
        //});
        //if (originCard == null && !autoChangePositionX) {
        //    this._allCardModes.push(newCard);
        //}
    },

    addCardModes: function addCardModes(cardNames) {
        cc.assert(cardNames.length > 0);
        this._allCardModes = [];
        cardNames.forEach((function (cardName, index) {
            var newCard = new KQCard(cardName, null, index);
            this._allCardModes.push(newCard);
        }).bind(this));
    },

    reloadCards: function reloadCards(cardNames) {
        //cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //三度同花
        // cardNames=['2_13', '2_5', '2_7', '3_1', '3_2', '3_4', '3_3', '3_13', '1_12', '1_6', '1_1', '1_4', '1_5'];
        //三同花顺
        //  cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '4_1', '4_2', '4_3'];
        //一条龙
        // cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '1_11', '1_12', '1_13'];
        //三顺子
        //cardNames=['4_1', '3_2', '4_3', '1_7', '4_5', '4_6', '3_9', '4_8', '3_1', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_9', '3_9', '4_8', '3_10', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_5', '3_6', '4_8', '3_6', '1_13', '4_12', '4_11', '2_7'];
        //cardNames=['3_4', '3_4', '4_6', '2_20', '1_20', '1_20', '3_6', '4_8', '3_6', '1_8', '4_12', '4_11', '2_20'];
        //三丰天下
        //cardNames=['1_1', '2_1', '3_1', '1_2', '2_2', '3_2', '4_1', '4_2', '3_3', '2_3', '1_3', '4_3', '1_13'];
        //4丰天下
        // cardNames=['1_1', '2_1', '3_1', '1_4', '2_4', '3_2', '4_2', '1_2', '3_4', '2_3', '1_3', '4_3', '1_2'];
        //六岁半
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //cardNames=['1_9', '2_11', '3_8', '1_12', '2_2', '3_2', '1_13', '2_5', '3_5','1_4', '2_4', '3_4', '3_10'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //   cardNames=['4_2', '2_3', '3_4', '3_5', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //cardNames=['4_1', '2_1', '1_4', '3_4', '1_6', '2_6', '1_8', '3_8', '2_8','2_12', '1_12', '2_13', '3_13'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_8', '2_9', '2_10', '2_11', '2_13','3_13', '3_12', '2_12', '1_12'];
        // cardNames=['4_9', '2_9', '3_4', '3_6', '1_8', '2_1', '2_5', '2_4', '2_3','3_13', '3_12', '2_2', '1_12'];
        //cardNames=['3_2', '4_2', '2_4', '3_5', '1_5', '3_7', '2_7', '3_10', '2_1','2_13', '2_10', '2_12', '2_11'];
        //cardNames=['4_2', '4_3', '4_4', '4_5', '4_5', '4_6', '4_12', '4_13', '2_12','3_12', '2_8', '3_8', '2_11'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '3_5', '2_5', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '2_20', '1_20', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_3', '3_4', '4_6', '4_5', '2_7', '1_20', '1_3', '4_4', '3_6','4_7', '4_8', '2_12', '1_12'];
        cc.log(cardNames);
        this.clearCards();
        this._kqCardModes = [];
        this.addCards(cardNames);
    },

    clearCards: function clearCards() {
        this.cardsLayout.node.removeAllChildren();
        this.layoutTouDao.node.removeAllChildren();
        this.layoutZhongDao.node.removeAllChildren();
        this.layoutWeiDao.node.removeAllChildren();
    },

    removeCard: function removeCard(cardName) {
        if (!cardName.length) {
            return;
        }

        this.cardsLayout.node.getChildByName(cardName).removeFromParent();
    },

    setFinishSelectCardsCallback: function setFinishSelectCardsCallback(callback) {
        this._finishSelectCardsCallback = callback;
        this.node.active = false;
    },

    _reloadKQCardModesInner: function _reloadKQCardModesInner() {
        //this._kqCardModes = this.cardsLayout.node.children.map(function (cardPrefabNode) {
        //    let cardPrefab = cardPrefabNode.getComponent('CardPrefab');
        //    return cardPrefab.cardMode();
        //}).sort(KQCard.sort);
        //this._findCardTypeObject = null;
    },

    _typeButtons: function _typeButtons() {
        //return [
        //    this.btnDuiZi,
        //    this.btnLiangDui,
        //    this.btnSanTiao,
        //    this.btnShunZi,
        //    this.btnTongHua,
        //    this.btnHuLu,
        //    this.btnTieZhi,
        //    this.btnTongHuaShun,
        //    /*#####*/
        //    //this.btnWuTong,
        //    /*#####*/
        //];
    },

    _resetTypeButtonEnablesWithModels: function _resetTypeButtonEnablesWithModels(cardModes) {
        /*cardModes.length == 13*/
        //cardModes = cardModes || this._kqCardModes;
        //
        ///*#####初始化牌*/
        //var ButtonsLayoutChilds = this.typeButtonsNode.children;
        //for(var i=0;i<ButtonsLayoutChilds.length;i++){
        //    ButtonsLayoutChilds[i].interactable = false;
        //}
        //
        //this.btnDuiZi.interactable = KQCard.containDuiZi(cardModes);
        //this.btnLiangDui.interactable = KQCard.containLiaDui(cardModes);
        //this.btnSanTiao.interactable = KQCard.containSanTiao(cardModes);
        //this.btnShunZi.interactable = KQCard.containShunZi(cardModes);
        //this.btnTongHua.interactable = KQCard.containTongHua(cardModes);
        //this.btnHuLu.interactable = KQCard.containHuLu(cardModes);
        //this.btnTieZhi.interactable = KQCard.containTieZhi(cardModes);
        //this.btnTongHuaShun.interactable = KQCard.containTongHuaShun(cardModes);
        ////this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        ////KQCard.isTeShuPai(cardModes)
        ////let typeName = KQCard.cardsTyp-eName(cardModes);
        ////KQCard.isLiuDuiBan(cardModes);
        ////alert(this.btnShunZi.interactable)
        ///*#####如果有多一色，就是设置无同按钮的可交互性*/
        ////if(cc.duoYiSe == 0) {
        ////    this.wuTongNode = this.typeButtonsNode.getChildByName("btnWuTong");
        ////    this.btnWuTong = this.wuTongNode.getComponent(cc.Button);
        ////    this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        ////}
        ///*#####*/
        //
        //this._autoActiveTypeButtons();
        //
        ///*#####设置按钮可交互和不可交互时的透明度*/
        //for(var i=0;i<ButtonsLayoutChilds.length;i++){
        //    if(ButtonsLayoutChilds[i].getComponent(cc.Button).interactable){
        //        ButtonsLayoutChilds[i].opacity = 255;
        //    }else{
        //        ButtonsLayoutChilds[i].opacity = 125;
        //    }
        //}
    },

    // 将找到了牌类型的牌突出出来
    _stickOutFindCardType: function _stickOutFindCardType(title, findMethods) {

        // 先根据牌类型找出所有的索引集合
        //var findedIndexsArray = null;
        //this._findCardTypeObject = this._findCardTypeObject || {};
        //if (this._findCardTypeObject.title != title) {
        //    findedIndexsArray = (findMethods() || []).reverse();
        //
        //    for(var i =0;i<findedIndexsArray.length-1;i++){//删除同类型牌
        //        var index = findedIndexsArray[i];
        //        /*if(title == 'liangDui'){
        //         let jStringspoint = index.map(function(indexs){
        //         return this._kqCardModes[indexs].point;
        //         }.bind(this));
        //         var isBreak = false;
        //         var repNum = jStringspoint.reduce(function(p,n){
        //         if(!p[n]){
        //         p[n] = 1;
        //         }else{
        //         p[n] += 1
        //         }
        //         return p
        //         },{});
        //         for(var y in repNum){
        //         if(repNum[y] >= 3){
        //         isBreak = true;
        //         }
        //         }
        //         if(isBreak){
        //         cc.log(repNum)
        //         cc.log(findedIndexsArray)
        //         cc.log(i)
        //         cc.log('--------291')
        //         findedIndexsArray.splice(i,1);
        //         continue;
        //         }
        //         }*/
        //        var iString = '';
        //        for(var j =i+1;j<findedIndexsArray.length;j++){
        //            var s = findedIndexsArray[j];
        //            var jString = '';
        //
        //            let iStrings = s.map(function(index){
        //                let cardModel = this._kqCardModes[index];
        //                return cardModel.cardName();
        //            }.bind(this));
        //
        //            let jStrings = index.map(function(indexs){
        //                let cardModel = this._kqCardModes[indexs];
        //                return cardModel.cardName();
        //            }.bind(this));
        //
        //
        //            for(var r = 0;r < index.length;r++){
        //                jString = jString + iStrings[r];
        //                iString = iString + jStrings[r];
        //            }
        //
        //            if(jString == iString){
        //                findedIndexsArray.splice(i,1);
        //                break;
        //            }
        //        }
        //    }
        //
        //    this._findCardTypeObject = {
        //        title: title,
        //        indexsArray: findedIndexsArray,
        //        //index: title=="duiZi"?findedIndexsArray.length-1:0
        //        index: 0
        //    };
        //}
        //
        //findedIndexsArray = this._findCardTypeObject.indexsArray;
        //if (!findedIndexsArray || findedIndexsArray.length == 0) {
        //    return;
        //}
        //// 将已有的突出的牌的位置重置回初始位置
        //this._resetCardsPositionY();
        //
        //// 计算出要突出的牌数组
        //var index = this._findCardTypeObject.index;
        //let indexs = findedIndexsArray[index];
        //
        //let selectedCardNames = indexs.map(function(index){
        //    let cardModel = this._kqCardModes[index];
        //    return cardModel.cardName();
        //}.bind(this));
        //
        //let cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {
        //    let cardPrefab = cardNode.getComponent('CardPrefab');
        //    if(selectedCardNames.includes(cardPrefab.cardName())) {
        //        var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());
        //        selectedCardNames.splice(nameIndex,1);
        //        return true;
        //    }
        //    return false;
        //});

        //// 突出计算出来的牌数组
        //this._changeCardPrefabsY(cardNodes);
        //// 保存好，用于再次点击了突出下一组牌
        //index = (index + 1) % findedIndexsArray.length;
        //this._findCardTypeObject.index = index;
    },

    clickDuiZi: function clickDuiZi() {
        this._stickOutFindCardType("duiZi", (function () {
            return KQCard.findDuiZi(this._kqCardModes);
        }).bind(this));
    },

    clickLiangDui: function clickLiangDui() {
        this._stickOutFindCardType("liangDui", (function () {
            return KQCard.findLiaDui(this._kqCardModes);
        }).bind(this));
    },

    clickSanTiao: function clickSanTiao() {
        this._stickOutFindCardType("sanTiao", (function () {
            return KQCard.findSanTiao(this._kqCardModes);
        }).bind(this));
    },

    clickShunZi: function clickShunZi() {
        this._stickOutFindCardType("shunZi", (function () {
            return KQCard.findShunZi(this._kqCardModes);
        }).bind(this));
    },

    clickTongHua: function clickTongHua() {
        this._stickOutFindCardType("tongHua", (function () {
            return KQCard.findTongHua(this._kqCardModes);
        }).bind(this));
    },

    clickHuLu: function clickHuLu() {
        this._stickOutFindCardType("huLu", (function () {
            return KQCard.findHuLu(this._kqCardModes);
        }).bind(this));
    },

    clickTieZhi: function clickTieZhi() {
        this._stickOutFindCardType("tieZhi", (function () {
            return KQCard.findTieZhi(this._kqCardModes);
        }).bind(this));
    },

    /*#####*/
    clickWuTong: function clickWuTong() {
        this._stickOutFindCardType("wuTong", (function () {
            return KQCard.findWuTong(this._kqCardModes);
        }).bind(this));
    },
    /*#####*/

    clickTongHuaShun: function clickTongHuaShun() {
        this._stickOutFindCardType("tongHuaShun", (function () {
            return KQCard.findTongHuaShun(this._kqCardModes);
        }).bind(this));
    },

    clickCancelAll: function clickCancelAll() {
        this.clickDeleteTouDao();
        this.clickDeleteZhongDao();
        this.clickDeleteWeiDao();
    },

    /*点击完成按钮*/
    clickDone: function clickDone() {
        cc.sys.localStorage.removeItem("timestamp");
        this.cardAlls = this.cardAllNode.children.sort(function (a, b) {
            return b.y - a.y;
        }).map(function (i) {
            return i.children[0];
        });

        var touCardModels = this._taoDaoCardModes();
        var zhongCardModes = this._zhongDaoCardModes();
        var weiCardModes = this._weiDaoCardModes();
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    /*点击恭喜你页面的确定按钮*/
    onBtnGongXiNiComfirmClick: function onBtnGongXiNiComfirmClick() {
        //记录玩家点击了确定按钮：
        this.BtnClickGongXiNiComfirm = true;

        var cards = [];

        cc.teShuPaiCards.forEach(function (i) {
            cards = cards.concat(i);
        });

        var teShuPaiCardsServerInfo = this._convertCardsToServerModel2(cards);
        var result = [teShuPaiCardsServerInfo];
        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    _didSelectedCards: function _didSelectedCards(touCards, zhongCards, weiCards) {
        touCards = touCards || [];
        zhongCards = zhongCards || [];
        weiCards = weiCards || [];
        var touServerInfo = this._convertCardsToServerModel(touCards);
        var zhongServerInfo = this._convertCardsToServerModel(zhongCards);
        var weiServerInfo = this._convertCardsToServerModel(weiCards);

        //console.log(touServerInfo);
        //console.log(zhongServerInfo);
        //console.log(weiServerInfo);
        //console.log("---------------------------------512");
        if (!(touServerInfo.value < zhongServerInfo.value && zhongServerInfo.value <= weiServerInfo.value)) {
            this.autoCardAnimation.y = -50;
            this.autoCardAnimation.opacity = 255;
            this.autoCardAnimation.runAction(cc.moveTo(1, cc.p(0, 0)));
            this.scheduleOnce((function () {
                var action = cc.spawn(cc.moveTo(this.cardTime, cc.p(0, 10)), cc.fadeOut(this.cardTime));
                this.autoCardAnimation.runAction(action);
            }).bind(this), 1.5);
            return;
        }
        var result = [touServerInfo, zhongServerInfo, weiServerInfo];
        //return;
        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    clickDeleteTouDao: function clickDeleteTouDao() {
        this._deleteDaoCardsOfLayout(this.layoutTouDao.node);
    },

    clickDeleteZhongDao: function clickDeleteZhongDao() {
        this._deleteDaoCardsOfLayout(this.layoutZhongDao.node);
    },

    clickDeleteWeiDao: function clickDeleteWeiDao() {
        this._deleteDaoCardsOfLayout(this.layoutWeiDao.node);
    },

    // 计时器事件
    timeStart: function timeStart(duration) {
        cc.assert(duration > 0);
        this.timeStop();
        this.timeNode.active = true;
        var timestamp = cc.sys.localStorage.getItem("timestamp"); // 获取本地存储的时间戳
        if (timestamp) {
            // 如果有则证明玩家是重新进来了的
            var now = Date.parse(new Date());
            var time = duration * 1000;
            if (now - timestamp > time) {
                // 超时
                if (now - timestamp < 2 * time) {
                    duration = 5; // 玩家可能出于其他原因退出游戏导致超时，为其提供5秒时间整理牌型（这已经是很仁慈的了）。
                } else {
                        cc.sys.localStorage.removeItem("timestamp");
                    }
            } else {
                duration = Math.floor(duration - (now - timestamp) / 1000);
            }
        } else {
            // 如果没有时间戳，则保存，为玩家退出游戏保留证据；
            var timestamp = Date.parse(new Date());
            cc.sys.localStorage.setItem('timestamp', timestamp);
        }
        this._timeRemainDuration = duration;
        this.labelTime.string = String(duration);
        this.timeNode.getComponent("time").setTime(duration * 0.5);
        this.schedule(this._timeMethod, 1, duration);
    },

    timeStop: function timeStop() {
        this.unschedule(this._timeMethod);
        this.timeNode.active = false;
    },

    _timeMethod: function _timeMethod() {
        this._timeRemainDuration = this._timeRemainDuration - 1;

        var remain = Math.max(this._timeRemainDuration, 0);
        this.labelTime.string = remain < 10 && remain > 0 ? '0' + remain : remain;

        if (this._timeRemainDuration <= 0) {
            this.timeStop();
            if (cc.chaoShiChuPai == true) this._timeOutAutoSelectCards();
            cc.sys.localStorage.removeItem("timestamp");
            return;
        }
    },

    // 超时后，自动选牌
    _timeOutAutoSelectCards: function _timeOutAutoSelectCards() {
        /**
         * 隐藏恭喜你
         */
        play.gongXiNiShow(false);
        if (typeof cc.teShuPaiCards != "undefined" && cc.teShuPaiCards != null) {
            this.onBtnGongXiNiComfirmClick();
            return;
        }

        //let [touCardModels, zhongCardModes, weiCardModes] = this._cacleAutoSelectedCards();

        var _findCardIndex$arr$0 = _slicedToArray(this._findCardIndex.arr[0], 3);

        var touCardModels = _findCardIndex$arr$0[0];
        var zhongCardModes = _findCardIndex$arr$0[1];
        var weiCardModes = _findCardIndex$arr$0[2];

        if (touCardModels == null || zhongCardModes == null || weiCardModes == null) {
            touCardModels = this._allCardModes.slice(-3);
            zhongCardModes = this._allCardModes.slice(5, 10);
            weiCardModes = this._allCardModes.slice(0, 5);
        }

        // cc.log(touCardModels)
        // cc.log(zhongCardModes)
        // cc.log(weiCardModes)
        // cc.log(this._allCardModes)
        // cc.log("自动选牌 touCardModels zhongCardModes weiCardModes：");
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    _cacleAutoSelectedCards: function _cacleAutoSelectedCards() {
        var cards = this._allCardModes.filter(function (i) {
            return i;
        });
        var resultCards = [];
        for (var i = 1; i < 3; i++) {
            var cardss = KQCard.autoSelectCards(cards, 5);
            cards = cards.kq_excludes(cardss);
            resultCards.push(cardss);
        }
        resultCards.push(cards);
        //let touScore = KQCard.scoreOfCards(resultCards[2]);
        //let zhongScore = KQCard.scoreOfCards(resultCards[1]);
        //let weiScore = KQCard.scoreOfCards(resultCards[0]);
        // cc.log(resultCards)
        // cc.log(this._allCardModes)
        // cc.log("牌分数自动选牌：", touScore, zhongScore, weiScore);
        //let weiCardModes = KQCard.autoSelectCards(cards, 5);
        //cards = cards.kq_excludes(weiCardModes);
        //
        //let zhongCardModes = KQCard.autoSelectCards(cards, 5);
        //
        //let touCardModes = cards.kq_excludes(zhongCardModes);
        //if (touCardModes.length == 3 && zhongCardModes.length == 5 && weiCardModes.length == 5) {
        //    return [touCardModes, zhongCardModes, weiCardModes];
        //}
        if (resultCards[2].length == 3 && resultCards[1].length == 5 && resultCards[0].length == 5) {
            return [resultCards[2], resultCards[1], resultCards[0]];
        }

        return [];
    },

    _convertCardsToServerModel: function _convertCardsToServerModel(cards) {
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = KQCard.scoreOfCards(cards);
        cards = KQCard._typeCardsSortByNumberOfPoints1(cards);
        result.cards = KQCard.convertToServerCards(cards);

        return result;
    },

    /*#####*/
    _convertCardsToServerModel2: function _convertCardsToServerModel2(cards) {
        var convertToServerCards = [];

        cc.teShuPaiCards.forEach(function (cardMode) {
            var arr = [];
            cardMode = KQCard._typeCardsSortByNumberOfPoints(KQCard.cardsFromArray(cardMode));
            cardMode.forEach(function (cca) {
                var point = cca.point == 14 ? 1 : cca.point;
                arr.push({ number: point, suit: cca.color });
            });
            convertToServerCards.push(arr);
        });
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = 0;
        result.cards = convertToServerCards;

        if (result.type >= KQCard.TYPE.SanTaoHua && cc.moshi != 1) {
            // 特殊牌
            result.isContainExtra = true;
        }

        return result;
    },
    /*#####*/
    // 特殊牌里是否还含有特殊牌
    // 包含的情况有：
    // 三桃花 可能含有同花顺
    // 三顺子 可能含有同花顺
    // 六对半 可能含有铁支
    _isContainExtraCardsType: function _isContainExtraCardsType(type, cards) {
        if (type == KQCard.TYPE.SanTaoHua) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.SanShunZi) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.LiuDuiBan) {
            return KQCard.containTieZhi(cards);
        }
        return false;
    },

    // 触摸事件
    _registerTouchEvents: function _registerTouchEvents() {
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_START, this._touchCardLayout.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_MOVE, this._touchCardLayout.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_END, this._touchCardLayoutEnd.bind(this));
        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_CANCEL, this._touchCardLayoutEnd.bind(this));
    },
    cacleAutoSelectedCardsIndex: function cacleAutoSelectedCardsIndex(cards) {
        //cc.log('------622')
        var testFind = KQCard.testFind(cards) || [];
        //cc.log('------6221')
        var result = [];
        for (var i = 0; i < testFind.length; i++) {
            var s = testFind[i];
            if (s.length >= 1) {
                for (var j = 0; j < s.length; j++) {
                    //result.push(s[0]);//只取一个
                    result.push(s[j]); //
                }
            }
        }
        return result;
    },

    cacleAutoSelectedCardsArray: function cacleAutoSelectedCardsArray(cards) {
        var indexs = this.cacleAutoSelectedCardsIndex(cards);
        if (indexs.length < 1) {
            return false;
        }
        var selectedCard = [];
        for (var i = 0; i < indexs.length; i++) {
            var s = indexs[i];
            var a = s.map(function (index) {
                return cards[index];
            });
            selectedCard.push(a);
        }
        return selectedCard;
    },

    cacleAutoSelectedCards2: function cacleAutoSelectedCards2() {
        var cards = this._allCardModes.slice();
        var cardsArray = this.cacleAutoSelectedCardsArray(cards);
        var resultArray = [];
        for (var i = 0; i < cardsArray.length; i++) {
            var _s = cardsArray[i] || [];
            var qwer = [];
            for (var j = 1; j < cardsArray.length; j++) {
                var d = cardsArray[j] || [];
                var sC = _s.kq_excludes(d);
                if (sC.length == _s.length && _s.length > 0) {
                    //判断牌相同 即没有重复的
                    qwer = [_s, d];
                }
            }
            if (qwer.length > 1) {
                resultArray.push(qwer);
            }
        }

        //补全计划1
        for (var i = 0; i < resultArray.length; i++) {

            var _s2 = resultArray[i];

            var cardss = this._allCardModes.slice();

            cardss = cardss.kq_excludes(_s2[0]);

            cardss = cardss.kq_excludes(_s2[1]);

            if (cardss.length >= 5) {
                _s2[2] = KQCard.autoSelectCards(cardss, 5);
            } else {
                _s2[2] = KQCard.autoSelectCards(cardss, 3);
            }

            resultArray[i].sort(function (a1, a2) {
                return KQCard.scoreOfCards(a1) - KQCard.scoreOfCards(a2);
            });
        }
        //补全计划2
        for (var i = 0; i < resultArray.length; i++) {
            var s = resultArray[i];
            var cardsqe = this._allCardModes.filter(function (ii) {
                //重新赋值cards
                return ii;
            });
            //去重
            var q = s[0].concat(s[1]).concat(s[2]);
            var cardsq = cardsqe.kq_excludes(q);
            s[0] = s[0].kq_excludes(s[1]);
            s[0] = s[0].kq_excludes(s[2]);
            s[1] = s[1].kq_excludes(s[0]);
            s[1] = s[1].kq_excludes(s[2]);
            s[2] = s[2].kq_excludes(s[1]);
            s[2] = s[2].kq_excludes(s[0]);
            //多余删除
            if (s[2].length > 5) {
                //尾道
                var a = s[2].splice(5, s[2].length - 5);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            if (s[1].length > 5) {
                //中道
                var a = s[1].splice(5, s[1].length - 5);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            if (s[0].length > 3) {
                //头道
                var a = s[0].splice(3, s[0].length - 3);
                for (var y in a) {
                    cardsq.push(a[y]);
                }
            }
            //cardsq = KQCard._convertOneToA(cardsq);
            cardsq.sort(KQCard.sortByPoint);
            cardsq.forEach(function (card11) {
                if (card11.point == 14) {
                    card11.point = 1;
                }
            });
            //有缺添加
            while (s[2].length < 5) {
                //尾道
                s[2].push(cardsq.pop() || []);
            }
            while (s[1].length < 5) {
                //中道
                s[1].push(cardsq.pop() || []);
            }
            while (s[0].length < 3) {
                //头道
                s[0].push(cardsq.pop() || []);
            }
            /*if(cardsq.length > 0){
                while(s[2].length < 5) {//尾道
                    s[2].push(cardsq.pop());
                }
            }
            if(cardsq.length > 0){
                while(s[1].length < 5) {//中道
                    s[1].push(cardsq.pop());
                }
            }
            if(cardsq.length > 0){
                while(s[0].length < 3) {//头道
                    s[0].push(cardsq.pop());
                }
            }*/
            if (s[2][4] == null || s[1][4] == null || s[0][2] == null || s[2][4] == '' || s[1][4] == '' || s[0][2] == '') {
                resultArray.splice(i, 1);
            }
        }

        var resultCards = [];
        var cardss1 = this._allCardModes.filter(function (i) {
            return i;
        });
        var indexasdf = 2;
        for (var i = 0; i < 3; i++) {
            var _length = indexasdf == 0 ? 3 : 5;
            var cardss = KQCard.autoSelectCards(cardss1, _length) || [];
            cardss1 = cardss1.kq_excludes(cardss);
            resultCards[indexasdf] = cardss;
            indexasdf--;
        }

        for (var i = 0; i < resultCards.length; i++) {
            var _length2 = i == 0 ? 3 : 5;
            if (resultCards[i].length < _length2) {
                cardss1 = cardss1.kq_excludes(resultCards[i]);
                while (resultCards[i].length < _length2) {
                    resultCards[i].push(cardss1.pop());
                }
            }
        }

        resultArray.push(resultCards);

        var cardsTypeNames = [];
        var resultArrays = [];

        for (var i = 0; i < resultArray.length; i++) {
            //删除类型相同的组合
            var _s3 = resultArray[i];
            var typeName0 = KQCard.cardsTypeName(_s3[0]);
            typeName0 += KQCard.cardsTypeName(_s3[1]);
            typeName0 += KQCard.cardsTypeName(_s3[2]);
            if (cardsTypeNames.indexOf(typeName0) == -1) {
                var touScore = KQCard.scoreOfCards(_s3[0]);
                var zhongScore = KQCard.scoreOfCards(_s3[1]);
                var weiScore = KQCard.scoreOfCards(_s3[2]);
                if (zhongScore > touScore && zhongScore < weiScore) {
                    cardsTypeNames.push(typeName0);
                    resultArrays.push(_s3);
                }
            }
        }

        resultArrays.sort(function (a1, a2) {
            var b0 = parseInt(KQCard.cardsType(a2[0])) + "";
            var b1 = parseInt(KQCard.cardsType(a2[1])) + "";
            var b2 = parseInt(KQCard.cardsType(a2[2])) + "";

            var s0 = parseInt(KQCard.cardsType(a1[0])) + "";
            var s1 = parseInt(KQCard.cardsType(a1[1])) + "";
            var s2 = parseInt(KQCard.cardsType(a1[2])) + "";

            var s = parseInt(s2 + s1 + s0);
            var b = parseInt(b2 + b1 + b0);

            return b - s;
        });

        if (resultArrays.length > 7) {
            resultArrays = resultArrays.slice(0, 7);
        }
        //for(var i = 0;i < resultArrays.length;i++){//如果有相公牌则删除
        //    let s = resultArrays[i];
        //    let touScore = KQCard.scoreOfCards(s[0]);
        //    let zhongScore = KQCard.scoreOfCards(s[1]);
        //    let weiScore = KQCard.scoreOfCards(s[2]);
        //    cc.log(touScore,zhongScore,weiScore);
        //    if(weiScore < touScore || weiScore < zhongScore){
        //        resultArrays.splice(i,1);
        //    }
        //}
        //cc.log(resultArrays)
        //cc.log('-------897')

        //if(cc.teShuPaiCards){
        //    var TeShuCards = cc.teShuPaiCards.map(function(ca){
        //       return KQCard._typeCardsSortByNumberOfPoints(KQCard.cardsFromArray(ca));
        //    });
        //    resultArrays.unshift(TeShuCards);
        //
        //}

        if (resultArrays.length <= 0) {

            this._allCardModes.forEach(function (i) {
                if (i.scores == 1) i.scores = 14;
            });

            var card20 = KQCard.contain20(this._allCardModes);

            this._allCardModes = this._allCardModes.kq_excludes(card20);

            this._allCardModes = KQCard._typeCardsSortByNumberOfPoints(this._allCardModes);

            this._allCardModes = card20.concat(this._allCardModes);

            var asdf1 = this._allCardModes.slice(0, 5);

            var asdf2 = this._allCardModes.slice(5, 10);

            var asdf3 = this._allCardModes.slice(10, 13);

            resultArrays.push([asdf3, asdf2, asdf1]);
        }

        this.autoCardLayout.node.removeAllChildren();
        this.autoCardScrollView.scrollToLeft();
        for (var i = 0; i < resultArrays.length; i++) {
            //添加预制体
            var _s4 = resultArrays[i];
            var autoCard = cc.instantiate(this.autoCard);
            autoCard.y = 0;
            _s4[0].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            _s4[1].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            _s4[2].forEach(function (i) {
                if (i.point == 14) i.point = 1;
            });
            var cardsNode = [autoCard.children[1], autoCard.children[3], autoCard.children[2]];

            this._setCardDaoSprite(cardsNode, _s4);

            autoCard.cardArray = _s4;
            var eventHandler = new cc.Component.EventHandler();
            eventHandler.target = this.node;
            eventHandler.component = "CardTypeCombine";
            eventHandler.handler = "clickAutoSelectedCards";
            eventHandler.customEventData = i;
            autoCard.getComponent(cc.Button).clickEvents.push(eventHandler);
            this.autoCardLayout.node.addChild(autoCard);
        }
        this._findCardIndex.arr = resultArrays;

        this.autoSelectedCardsOne();
    },

    //daoCancelAll: function () {
    //    var nodes = [this.layoutTouDao.node,this.layoutZhongDao.node,this.layoutWeiDao.node];
    //    for(var i = 0;i < nodes.length;i++){
    //        nodes[i].removeAllChildren();
    //    }
    //},

    autoSelectedCardsOne: function autoSelectedCardsOne() {
        this.cardsLayout.node.removeAllChildren();

        var indexs = 0;

        for (var i = 0; i < this.autoCardLayout.node.children.length; i++) {

            var nodes = this.autoCardLayout.node.children[i];

            nodes.children[0].active = false;
        }

        this.autoCardLayout.node.children[indexs].children[0].active = true;

        var resultArray = this._findCardIndex.arr[indexs];

        this._findCardIndex.indexs = indexs;

        for (var i = 0; i < resultArray.length; i++) {

            var cardModes = resultArray[i];

            cardModes.sort(KQCard.sort);

            var num = 0;
            if (i == 1) {
                num = 3;
            } else if (i == 2) {
                num = 8;
            }
            //cardModes.forEach(function(i){if (i.point == 14) i.point = 1;})
            cardModes.forEach((function (cardMode, index) {

                var cardName = cardMode.cardName();

                var numBer = num + index;

                var nodds1 = new cc.Node(); //创建一个节点对象

                nodds1.anchorY = 1;

                nodds1.addComponent(cc.Sprite); //添加精灵组件

                this.cardAllNode.children[numBer].addChild(nodds1);

                this.cardAllNode.children[numBer].children[0].cardName = cardName;

                this.cardAllNode.children[numBer].children[0]._cardModel = new KQCard(cardName, null, index);

                var btnSprites = this.cardAllNode.children[numBer].children[0].getComponent(cc.Sprite);

                this.cardAllNode.children[numBer].getComponent(cc.Sprite).spriteFrame = '';

                btnSprites.node.removeAllChildren();

                if (cc.maPai == cardName) {

                    var nodds = new cc.Node(); //创建一个节点对象

                    nodds.addComponent(cc.Sprite); //添加精灵组件

                    cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                        if (err) {
                            cc.error(err.message || err);return;
                        }

                        var btnSprite1 = nodds.getComponent(cc.Sprite);

                        btnSprite1.spriteFrame = spriteFrame;

                        btnSprite1.node.width = 107;

                        btnSprite1.node.height = 155;

                        btnSprite1.node.y = -65.5;
                    }).bind(this));

                    btnSprites.node.addChild(nodds);
                }

                var path = 'public-pic-card-poker-' + cardName;

                this._loadCardFrame(this.cardSpriteAtlas, path, btnSprites, 95, 130);
            }).bind(this));
        }

        this.clickAutoSelectedCards(null);

        //this._setCardDaoSprite();
    },

    clickAutoSelectedCards: function clickAutoSelectedCards(event) {
        var indexs = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];

        for (var i = 0; i < this.autoCardLayout.node.children.length; i++) {

            var nodes = this.autoCardLayout.node.children[i];

            nodes.children[0].active = false;
        }

        this.autoCardLayout.node.children[indexs].children[0].active = true;

        AudioManager.instance.playPokerClick();

        if (event) {
            var resultArray = event.target.cardArray;
        } else {
            var resultArray = this._findCardIndex.arr[indexs];
        }
        var touScore = KQCard.scoreOfCards(resultArray[0]);
        var zhongScore = KQCard.scoreOfCards(resultArray[1]);
        var weiScore = KQCard.scoreOfCards(resultArray[2]);
        //cc.log(touScore);
        //cc.log(zhongScore);
        //cc.log(weiScore);
        //console.log('----------1180')
        resultArray = resultArray.map((function (cardMode) {

            cardMode = KQCard._typeCardsSortByNumberOfPoints(cardMode);

            return cardMode.map((function (cardModes) {

                return cardModes.cardName();
            }).bind(this));
        }).bind(this));
        //console.log(resultArray)

        this.LayoutWithEvent.forEach(function (nodes) {

            nodes.color = new cc.Color(255, 255, 255);

            nodes.children.forEach(function (i) {
                i.color = new cc.Color(255, 255, 255);
            });
        });

        this.LayoutWithEvent = [];

        resultArray = resultArray[0].concat(resultArray[1]).concat(resultArray[2]);

        var cardAllNode = this.cardAllNode.children.map(function (i) {
            return i;
        });

        for (var i = 0; i < resultArray.length; i++) {

            var s = resultArray[i];

            for (var j = 0; j < cardAllNode.length; j++) {

                var d = cardAllNode[j];

                d.getComponent(cc.Button).interactable = false;

                if (d.children[0].cardName == s) {

                    d.stopAllActions();

                    var detail = this.changeNodeSpaceAR[i];

                    var call = cc.callFunc((function () {

                        this.cardAllNode.children.forEach(function (nodes) {
                            nodes.getComponent(cc.Button).interactable = true;
                        });

                        this._setCardDaoSprite();
                    }).bind(this), this);

                    d.runAction(cc.sequence(cc.moveTo(this.cardTime, detail), call));

                    cardAllNode.splice(j, 1);

                    break;
                }
            }
        }
    },

    _loadCardFrame: function _loadCardFrame(SpriteFrame, path, SpritesNode, w, h) {

        var Sprite = SpriteFrame.getSpriteFrame(path);

        SpritesNode.spriteFrame = Sprite;

        if (w) SpritesNode.node.width = w;

        if (h) SpritesNode.node.height = h;
    },

    stickOutFindCardType1: function stickOutFindCardType1(cards) {
        var index = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];
    },

    //// 将已有的突出的牌的位置重置回初始位置
    //this._resetCardsPositionY();
    //let selectedCardNames = cards.map(function(cardModel){
    //    return cardModel.cardName();
    //}.bind(this));
    //
    //let cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {
    //    let cardPrefab = cardNode.getComponent('CardPrefab');
    //    if(selectedCardNames.includes(cardPrefab.cardName())) {
    //        var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());
    //        selectedCardNames.splice(nameIndex,1);
    //        return true;
    //    }
    //    return false;
    //});
    //
    //cc.log('-------696')
    //this._changeCardPrefabsY(cardNodes);
    //if(index == 1){
    //    this._addDaoCardToLayout(this.layoutTouDao.node, 3);
    //}
    //else if(index == 2){
    //    this._addDaoCardToLayout(this.layoutZhongDao.node);
    //}
    //else if(index == 3){
    //    this._addDaoCardToLayout(this.layoutWeiDao.node);
    //}

    _touchCardLayout: function _touchCardLayout(event) {
        //event.bubbles = true;
        //let location = event.getLocation();
        //let cardPrefab = this._cardPrefabInCardLayoutWithLocation(location);
        //if (cardPrefab) {
        //    cardPrefab.getComponent('CardPrefab').setSelected(true);
        //    event.stopPropagation();
        //}
    },

    _touchCardLayoutEnd: function _touchCardLayoutEnd(event) {
        //this._changeSelectedCardPrefabsY();
        //this._diseclectCardPrefabs();
    },

    _cardPrefabInCardLayoutWithLocation: function _cardPrefabInCardLayoutWithLocation(location) {
        //location = this.cardsLayout.node.convertToNodeSpaceAR(location);
        //let cardNodes = this.cardsLayout.node.children.sort(function (cardNode1, cardNode2) {
        //    let rect1 = cardNode1.getBoundingBox();
        //    let rect2 = cardNode2.getBoundingBox();
        //    return rect2.x - rect1.x;
        //});
        //for (let index in cardNodes) {
        //    let cardNode = cardNodes[index];
        //
        //    let rect = cardNode.getBoundingBox();
        //
        //    if (cc.rectContainsPoint(rect, location)) {
        //        return cardNode;
        //    }
        //}
        //
        //return null;
    },

    _changeSelectedCardPrefabsY: function _changeSelectedCardPrefabsY() {
        //let cardNodes = this._selectedCardPrefabs();
        //this._changeCardPrefabsY(cardNodes);
        //
        //AudioManager.instance.playPokerClick();
    },

    _changeCardPrefabsY: function _changeCardPrefabsY(cardNodes) {
        //cardNodes.forEach(function (cardNode) {
        //    let y = cardNode.getPositionY();
        //    if (y == this._cardOffsetY) {
        //        cardNode.setPositionY(this._cardOffsetY + 55);
        //    } else {
        //        cardNode.setPositionY(this._cardOffsetY);
        //    }
        //}.bind(this));
    },

    _selectedCardPrefabs: function _selectedCardPrefabs() {
        var includeStickOut = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];
    },

    //let cardNodes = this.cardsLayout.node.children || [];
    //return cardNodes.filter(function (cardNode) {
    //    let cardPrefab = cardNode.getComponent('CardPrefab');
    //    let isSelected = cardPrefab.isSelected();
    //    if (!isSelected && includeStickOut) {
    //        isSelected = cardNode.getPositionY() > 10;
    //    }
    //
    //    return isSelected;
    //});
    _diseclectCardPrefabs: function _diseclectCardPrefabs() {
        //let cardNodes = this.cardsLayout.node.children;
        //cardNodes.forEach(function (node) {
        //    node.getComponent('CardPrefab').setSelected(false);
        //});
    },

    // 重置 cards 的 X
    _resetCardsPositionX: function _resetCardsPositionX() {
        //let interval = 98;
        //let interval = 78;
        //let cardNodes = this.cardsLayout.node.children || [];
        //let length = cardNodes.length;
        //if (length == 0) {
        //    return;
        //}
        //
        //let middleIndex = length / 2;
        //let cardWidth = 154;
        //
        //
        ////this.cardsLayoutSort();
        //if(this.cardsLayoutSortColor == true){
        //    this.cardsLayout.node.children.sort(function (n1, n2) {
        //        let component1 = n1.getComponent('CardPrefab');
        //        let component2 = n2.getComponent('CardPrefab');
        //        return component2.cardMode().color - component1.cardMode().color;
        //    });
        //}else{
        //    this.cardsLayout.node.children.sort(function (n1, n2) {
        //        let component1 = n1.getComponent('CardPrefab');
        //        let component2 = n2.getComponent('CardPrefab');
        //        return component1.cardMode().sort(component2.cardMode());
        //    });
        //}
        ////cardNodes.sort(function (n1, n2) {
        ////    let component1 = n1.getComponent('CardPrefab');
        ////    let component2 = n2.getComponent('CardPrefab');
        ////
        ////    return component1.cardMode().sort(component2.cardMode());
        ////});
        //
        //cardNodes.forEach(function (cardNode, index) {
        //    cardNode.zIndex = index;
        //    let x = (index - middleIndex) * interval + cardWidth / 3;
        //    cardNode.setPositionX(x);
        //});
    },

    // 重置 cards 的 X为0
    resetCardsPositionX1: function resetCardsPositionX1() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //let length = cardNodes.length;
        //if (length == 0) {
        //    return;
        //}
        //cardNodes.forEach(function (cardNode) {
        //    cardNode.setPositionY(0);
        //});
    },

    _resetCardsPositionY: function _resetCardsPositionY() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //cardNodes.forEach(function (cardNode) {
        //    cardNode.setPositionY(this._cardOffsetY);
        //}.bind(this));
    },

    // 头、中、尾道 layout 的点击事件
    _registerDaosLayoutClickEvent: function _registerDaosLayoutClickEvent() {

        this.changeNodeSpaceAR = []; //记录所有牌的坐标
        this.cardAllNode.children.forEach((function (nodes) {
            //获取节点的世界坐标
            var cardBackWorldSpace1 = nodes.convertToWorldSpaceAR(cc.v2(0, 0));
            //获取相对父节点所在的坐标
            var detail = nodes.parent.convertToNodeSpaceAR(cardBackWorldSpace1);

            this.changeNodeSpaceAR.push(detail);
        }).bind(this));
    },

    clickAllCard: function clickAllCard(event) {
        AudioManager.instance.playPokerClick();
        if (this.LayoutWithEvent.length <= 1) {
            this.LayoutWithEvent.push(event.target);
            event.target.color = new cc.Color(182, 182, 182);
            event.target.children.forEach(function (i) {
                i.color = new cc.Color(182, 182, 182);
            });
        }
        if (this.LayoutWithEvent.length == 2) {

            var arr = [];

            this.LayoutWithEvent.forEach((function (nodes) {
                //获取节点的世界坐标
                var cardBackWorldSpace1 = nodes.convertToWorldSpaceAR(cc.v2(0, 0));
                //获取相对父节点所在的坐标
                var detail = nodes.parent.convertToNodeSpaceAR(cardBackWorldSpace1);

                arr.unshift(detail);
            }).bind(this));

            this.LayoutWithEvent.forEach((function (nodes, index) {

                nodes.color = new cc.Color(255, 255, 255);

                nodes.children.forEach(function (i) {
                    i.color = new cc.Color(255, 255, 255);
                });

                nodes.getComponent(cc.Button).interactable = false;

                this.scheduleOnce((function () {

                    nodes.getComponent(cc.Button).interactable = true;

                    this._setCardDaoSprite();
                }).bind(this), this.cardTime);

                nodes.stopAllActions();

                var detail = arr[index];

                nodes.runAction(cc.moveTo(this.cardTime, detail));
            }).bind(this));

            this.LayoutWithEvent = [];
        }
    },

    _setCardDaoSprite: function _setCardDaoSprite() {
        var nodes = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];
        var cards = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];

        if (!nodes) {

            this.cardAlls = this.cardAllNode.children.sort(function (a, b) {
                return b.y - a.y;
            }).map(function (i) {
                return i.children[0];
            });

            cards = [this._taoDaoCardModes(), this._zhongDaoCardModes(), this._weiDaoCardModes()];

            cards.forEach(function (card) {
                card.forEach(function (i) {
                    if (i.scores == 14) {
                        i.scores = 1;
                    }
                });
            });

            nodes = [this.touDaoNode, this.zhongDaoNode, this.weiDaoNode];
        }

        //头道
        var typeName0 = KQCard.cardsType(cards[0]) + 1;

        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;

        typeName0 = typeName0 == '04' ? '11' : typeName0;

        var path = 'game_poker_type' + typeName0;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[0].getComponent(cc.Sprite));

        //中道
        var typeName1 = KQCard.cardsType(cards[1]) + 1;

        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;

        typeName1 = typeName1 == '07' ? '22' : typeName1;

        path = 'game_poker_type' + typeName1;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[1].getComponent(cc.Sprite));

        //尾道
        var typeName2 = KQCard.cardsType(cards[2]) + 1;

        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        path = 'game_poker_type' + typeName2;

        this._loadCardFrame(this.daoSpriteAtlas, path, nodes[2].getComponent(cc.Sprite));

        this.cardAllNode.children.forEach(function (n) {
            n.getComponent(cc.Sprite).spriteFrame = "";
        });

        if (cards) {

            if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards, this.cardAllNode.children, this.cardSpriteAtlas);

            if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards, this.cardAllNode.children, this.cardSpriteAtlas);

            if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards, this.cardAllNode.children, this.cardSpriteAtlas);
        }
    },

    _clickTouDaoLayout: function _clickTouDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutTouDao.node, event);
    },

    _clickZhongDaoLayout: function _clickZhongDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutZhongDao.node, event);
    },

    _clickWeiDaoLayout: function _clickWeiDaoLayout(event) {
        this._daoCardNodeInLayoutWithEvent(this.layoutWeiDao.node, event);
    },

    _daoCardNodeInLayoutWithEvent: function _daoCardNodeInLayoutWithEvent(node, event) {
        var cardNodes = node.children || [];
        var location = event.getLocation();
        location = node.convertToNodeSpaceAR(location);
        //var cardBackWorldSpace = this.layoutZhongDao.node.convertToWorldSpaceAR(cc.v2(0, 0));
        ////获取节点的世界坐标
        //var detail = this.layoutZhongDao.node.parent.convertToNodeSpaceAR(cardBackWorldSpace);
        ////获取相对父节点所在的坐标
        //this.layoutWeiDao.node.runAction(cc.moveTo(1,detail));
        for (var index in cardNodes) {
            var cardNode = cardNodes[index];
            var rect = cardNode.getBoundingBox();
            if (cc.rectContainsPoint(rect, location)) {
                AudioManager.instance.playPokerClick();
                var arrs = [node, cardNode];
                if (this.LayoutWithEvent.length == 1) {
                    if (this.LayoutWithEvent[0][0].name != node.name) {
                        cardNode.opacity = 200;
                        this.LayoutWithEvent.push(arrs);
                    } else {
                        this.LayoutWithEvent[0][1].opacity = 255;
                        this.LayoutWithEvent = [];
                    }
                } else if (this.LayoutWithEvent.length == 0) {
                    //cc.log(cardNode)
                    this.LayoutWithEvent.push(arrs);
                    cardNode.opacity = 200;
                }
                if (this.LayoutWithEvent.length == 2) {
                    var node1 = this.LayoutWithEvent[0][1];
                    var node2 = this.LayoutWithEvent[1][1];
                    //获取节点的世界坐标
                    var cardBackWorldSpace = node1.convertToWorldSpaceAR(cc.v2(0, 0));
                    //获取相对父节点所在的坐标
                    var detail = node1.parent.convertToNodeSpaceAR(cardBackWorldSpace);
                    node2.runAction(cc.moveTo(1, detail));
                }

                return;
            }
        }

        //return null;
    },

    _addDaoCardToLayout: function _addDaoCardToLayout(node) {
        var maxNumberCard = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];
    },

    //let cardNodes = node.children || [];
    //if (cardNodes.length >= 5) {
    //    return;
    //}
    //let remainCount = maxNumberCard - cardNodes.length;
    //
    //var selectedCards = this._selectedCardPrefabs(true) || [];
    //
    //if (selectedCards.length == 0) {
    //    return;
    //}
    //if (selectedCards.length > remainCount) {
    //    selectedCards = selectedCards.slice(0, remainCount);
    //}
    //
    //let selectedCardNames = selectedCards.map(function (cardPrefab) {
    //    return cardPrefab.getComponent('CardPrefab').cardName();
    //});
    //
    //cardNodes.forEach(function (cardTypeNode) {
    //    selectedCardNames.push(cardTypeNode.getComponent('CardTypeSprite').cardName());
    //});
    //
    //let cardModes = selectedCardNames.map(function (cardName,index) {
    //    return new KQCard(cardName,null,index);
    //}).sort(function (c1, c2) {
    //    return KQCard.sort(c1, c2, false);
    //});

    //let touCardModes = (node == this.layoutTouDao.node) ? cardModes : this._taoDaoCardModes();
    //let zhongCardModes = (node == this.layoutZhongDao.node) ? cardModes : this._zhongDaoCardModes();
    //let weiCardModes = (node == this.layoutWeiDao.node) ? cardModes : this._weiDaoCardModes();
    //if (!this._isValidCardModes(touCardModes, zhongCardModes, weiCardModes)) {
    //    this.cacleAutoSelectedCards1();
    //    cc.log('相公牌：自动选择牌')
    //    return;
    //}
    //
    //node.removeAllChildren();
    //
    //cardModes.forEach(function (cardMode,index) {
    //    let cardName = cardMode.cardName();
    //    let cardTypeSprite = cc.instantiate(this.cardTypePrefab);
    //    cardTypeSprite.names = cardName+'+'+index;
    //    cardTypeSprite.getComponent('CardTypeSprite').setCard(cardName,index);
    //    node.addChild(cardTypeSprite);
    //}.bind(this));
    //
    //
    //selectedCards.forEach(function (node) {
    //    node.removeFromParent();
    //});
    //this._resetCardsPositionY();
    //this._resetCardsPositionX();
    //
    //this._autoActiveDeleteDaoButtons();
    //
    //this._reloadKQCardModesInner();
    //this._resetTypeButtonEnablesWithModels();
    // 删除 头、中或尾道中的某中牌
    _deleteDaoCard: function _deleteDaoCard(cardTypeNode) {
        var reloadTypeButtonEnables = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
    },

    //let cardName = cardTypeNode.getComponent('CardTypeSprite').cardName();
    //this.addCard(cardName, true);
    //
    //this._resetCardsPositionY();
    //
    //cardTypeNode.removeFromParent(true);
    //this._autoActiveDeleteDaoButtons();
    //
    //if (reloadTypeButtonEnables) {
    //    this._reloadKQCardModesInner();
    //    this._resetTypeButtonEnablesWithModels();
    //}
    // 删除 头道或中道或尾道上所有的 牌
    _deleteDaoCardsOfLayout: function _deleteDaoCardsOfLayout(daoLayout) {
        //let cardNodes = Array.from(daoLayout.children);
        //cardNodes.forEach(this._deleteDaoCard.bind(this));
        //
        //this._reloadKQCardModesInner();
        //this._resetTypeButtonEnablesWithModels();
    },

    // 判断能否使用选择中的牌
    // 即：头道要小于中道、中道要小于尾道
    _isValidCardModes: function _isValidCardModes(touCardModes, zhongCardModes, weiCardModes) {
        touCardModes = touCardModes || [];
        zhongCardModes = zhongCardModes || [];
        weiCardModes = weiCardModes || [];
        if (touCardModes.length < 3 || zhongCardModes.length < 5 || weiCardModes.length < 5) {
            return true;
        }

        var touScore = KQCard.scoreOfCards(touCardModes);
        var zhongScore = KQCard.scoreOfCards(zhongCardModes);
        var weiScore = KQCard.scoreOfCards(weiCardModes);
        return touScore < zhongScore && zhongScore <= weiScore;
    },

    // 头道上已有的牌
    _taoDaoCardModes: function _taoDaoCardModes() {
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(0, 3));
    },

    // 中道上已有的牌
    _zhongDaoCardModes: function _zhongDaoCardModes() {
        //return this._cardModesOfCardPrefabs(this.layoutZhongDao.node.children);
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(3, 8));
    },

    // 尾道上已有的牌
    _weiDaoCardModes: function _weiDaoCardModes() {
        //return this._cardModesOfCardPrefabs(this.layoutWeiDao.node.children);
        return this._cardModesOfCardPrefabs(this.cardAlls.slice(8, 13));
    },

    _cardModesOfCardPrefabs: function _cardModesOfCardPrefabs(cardTypeNodes) {
        if (!cardTypeNodes) {
            return [];
        }

        var cardModes = cardTypeNodes.map(function (node) {
            //let component = node.getComponent('CardTypeSprite');
            //return component.cardMode();._cardModel
            return node._cardModel;
        });

        return cardModes || [];
    },

    // 自动设置 头、中、尾道的删除按钮的可见性
    _autoActiveDeleteDaoButtons: function _autoActiveDeleteDaoButtons() {
        //this._autoActiveDeleteDaoButton(this.layoutTouDao.node, this.btnDeleteTouDao.node);
        //this._autoActiveDeleteDaoButton(this.layoutZhongDao.node, this.btnDeleteZhongDao.node);
        //this._autoActiveDeleteDaoButton(this.layoutWeiDao.node, this.btnDeleteWeiDao.node);
    },

    _autoActiveDeleteDaoButton: function _autoActiveDeleteDaoButton(layout, button) {
        //button.active = layout.children.length > 0;
    },

    // 自动设置 “全部取消”、“确定出牌”、“类型选择”按钮的可见性
    _autoActiveTypeButtons: function _autoActiveTypeButtons() {
        //let cardNodes = this.cardsLayout.node.children || [];
        //let hasCardUnSelected = cardNodes.length > 0;
        //this.btnDone.node.active = !hasCardUnSelected;
        //this.btnCancelAll.node.active = this.btnDone.node.active;
        //this.typeButtonsNode.active = hasCardUnSelected;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardScoretsHelper":"KQCardScoretsHelper","play":"play"}],"CardTypeSprite":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e614c0FMndAtrOMcy8/PcZw', 'CardTypeSprite');
// scripts\CardTypeSprite.js

var KQCard = require('KQCard');
cc.Class({
  'extends': cc.Component,

  properties: {
    _cardName: null,
    _cardModel: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setCard: function setCard(cardName, index) {
    var asdf = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    this._cardName = cardName;
    if (asdf) {
      this._cardModel = new KQCard(cardName, null, index);
    }
    this._loadCardFrame(cardName, (function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }).bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._cardModel;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"ChatMessage":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dc8980X2ZVNKrH9BsIsSE4D', 'ChatMessage');
// scripts\Chat\ChatMessage.js

// 用于在游戏过程中，展示用户的聊天消息

var ChatMessage = cc.Class({
    "extends": cc.Component,

    properties: {
        richText: cc.RichText,
        spriteBackground: cc.Sprite,
        emoji: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        ChatMessage.instances = this;
    },

    setString: function setString() {
        var string = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];
        var autoHide = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (string.length == 0) {
            return;
        }

        this.node.active = true;
        this.richText.node.active = true;
        this.spriteBackground.node.active = true;
        this.emoji.active = false;
        var maxWidth = 300;
        var realStr = ChatMessage.parseString(string);

        // 由于 cc.RichText 在指定 maxWidth 后，该结点的 width 会一直
        // 是 maxWidth 值。而在将 maxWidth 指定为0时，其 contentSize.width 会
        // 是内容的真正所需的宽度
        //
        // 所以这里先将 maxWidth 设为 0，获取其实际内容 width 后再调整
        this.richText.maxWidth = 0;
        this.richText.string = realStr;

        var contentWidth = this.richText.node.getContentSize().width;
        if (contentWidth > maxWidth) {
            this.richText.maxWidth = maxWidth;
            this.richText.string = realStr;
            contentWidth = maxWidth;
        }

        this.node.width = contentWidth + 28;
        this.node.height = this.richText.node.getContentSize().height + 20;

        this.spriteBackground.node.width = this.node.width;
        this.spriteBackground.node.height = this.node.height;

        if (autoHide) {
            this._hideNode();
            //this.unscheduleAllCallbacks();
            //this.scheduleOnce(this._hideNode.bind(this), 3);
        }
    },

    showEmoji: function showEmoji(sprite) {
        this._hideNode();
        this.node.active = true;
        this.emoji.active = true;
        this.richText.node.active = false;
        this.spriteBackground.node.active = false;
        var btnSprites = this.emoji.getComponent(cc.Sprite);
        btnSprites.spriteFrame = sprite;
    },

    _hideNode: function _hideNode() {
        this.unscheduleAllCallbacks();
        this.scheduleOnce((function () {
            this.node.active = false;
        }).bind(this), 3);
    }

});
ChatMessage.setEmoji = function (sprite) {
    this.instances._hideNode();
    this.instances.node.active = true;
    this.instances.emoji.active = true;
    this.instances.richText.node.active = false;
    this.instances.spriteBackground.node.active = false;
    var btnSprites = this.instances.emoji.getComponent(cc.Sprite);
    btnSprites.spriteFrame = sprite;
    //console.log(this.emoji);
    //return;
    //
    //this.emoji.Sprite = sprite;
},

// 将 <bq10> 改为： <img src='bg10'/>
ChatMessage.parseString = function (str) {
    var result = str.replace(/<bq\d{1,2}>/g, function (match) {
        var bq = match.replace("<", " <img src='").replace(">", "'/> ");
        return bq;
    });
    return result;
}, module.exports = ChatMessage;

cc._RFpop();
},{}],"ChatTextRecord":[function(require,module,exports){
"use strict";
cc._RFpush(module, '88d10U9tIpHNK1entoUH0Ju', 'ChatTextRecord');
// scripts\Pefabs\ChatTextRecord.js

cc.Class({
    'extends': cc.Component,

    properties: {},

    // use this for initialization
    onLoad: function onLoad() {},

    setString: function setString(str) {
        this._richText().string = str;
    },

    _richText: function _richText() {
        return this.node.getComponent('cc.RichText');
    },

    setEmoji: function setEmoji(spraite) {
        this._spriteFrame().Spraite = spraite;
    },
    _spriteFrame: function _spriteFrame() {
        return this.node.getComponent('cc.Sprite');
    }
});

cc._RFpop();
},{}],"CompareCards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9aa4aH/Ha1JfaEeY5nFj5P1', 'CompareCards');
// scripts\Pefabs\CompareCards.js

var KQCardResHelper = require('KQCardResHelper');
var AudioManager = require('AudioManager');
var KQCard = require('KQCard');

cc.Class({
    'extends': cc.Component,

    properties: {
        touLayout: cc.Layout,
        zhongLayout: cc.Layout,
        weiLayout: cc.Layout,

        touLayoutBack: cc.Layout,
        zhongLayoutBack: cc.Layout,
        weiLayoutBack: cc.Layout,
        baoDao: cc.Node, //报道图,
        playTotalScore: cc.Layout, //所有玩家的总分数

        daoScoreLayouts: [cc.Layout],
        daoTitleNodes: [cc.Node],
        TScoreLayout: cc.Layout,
        TtitleNode: cc.Node,

        pNum: 0, //玩家人数
        teShuTime: 0, //特殊牌出牌顺序
        teShuNum: 0, //特殊牌人数

        _lCScore: null,
        _daoLayouts: null, // 头、中、尾集合
        _daoLayoutBacks: null, // 头、中、尾集合
        _scores: null,
        _user: null, // 用于比牌的数据
        _cardsInfo: null,
        _compareIndex: 0 },

    // 将要比较的 索引  0~2
    // use this for initialization
    onLoad: function onLoad() {

        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        this._daoLayoutBacks = [this.touLayoutBack, this.zhongLayoutBack, this.weiLayoutBack];
        this.reset();

        if (this._scores) {
            this.setScores(this._scores);
        }
    },

    reset: function reset() {
        this._compareIndex = 0;

        this.node.children.forEach(function (node) {
            node.active = false;
        });

        this.baoDao.getComponent(cc.Sprite).spriteFrame = null;

        var nodes = this.touLayoutBack.node.children.concat(this.zhongLayoutBack.node.children).concat(this.weiLayoutBack.node.children);

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        nodes.forEach((function (nod) {

            nod.removeAllChildren();

            var cardSprite = nod.getComponent(cc.Sprite);

            KQCard._loadCardFrame(this.cardSpriteAtlas, "public-pic-card-poker-back", cardSprite);
        }).bind(this));

        this.daoScoreLayouts.forEach((function (nod) {
            nod.node.active = false;
        }).bind(this));

        this.daoTitleNodes.forEach((function (nod) {
            nod.active = false;
        }).bind(this));

        if (this.TScoreLayout) this.TScoreLayout.node.active = false;

        if (this.TtitleNode) this.TtitleNode.active = false;

        this.unscheduleAllCallbacks();

        //console.log('执行了一遍清除定时器--------------------------------')

        if (this.TScoreLayout) this.TScoreLayout.node.stopAllActions();

        if (this.playTotalScore) this.playTotalScore.node.stopAllActions();
    },

    setCompareData: function setCompareData(user) {
        this._user = user;
        this._cardsInfo = user.cardInfo;
        var cardsInfo = user.cardInfo;
        this._lCScore = user.lCScore;
        var cards = cardsInfo.map(function (cardInfoItem) {
            return KQCard.cardsFromArray(cardInfoItem.cards);
        }).reduce(function (array, subCards) {
            return array.concat(subCards);
        }, []);

        var scores = [user.score1 || 0, user.score2 || 0, user.score3 || 0, user.lScore1 || 0, user.lScore2 || 0, user.lScore3 || 0];
        this.setCards(cards);
        this.setScores(scores);
    },

    //显示所有玩家的总分数
    showScoreResult: function showScoreResult() {
        if (!this._user) return;
        var scores = this._user.cScore;
        this.setScores([scores], [this.playTotalScore], true);
        this.playTotalScore.node.active = true;
        this.playTotalScore.node.opacity = 255;
        var x = this.playTotalScore.node.x;
        var y = this.playTotalScore.node.y;
        this.playTotalScore.node.runAction(cc.moveTo(0.8, cc.p(x, y + 30)));
        this.scheduleOnce((function () {
            this.playTotalScore.node.runAction(cc.fadeOut(0.2));
        }).bind(this), 0.6);
        this.scheduleOnce((function () {
            this.playTotalScore.node.y = y;
        }).bind(this), 1);
    },

    //显示三道分数
    showNextCompareScore: function showNextCompareScore(isContainExtra) {
        if (isContainExtra && this.TScoreLayout) {
            var scores1 = this._lCScore.splice(0, 1);
            if (scores1.length <= 0) return;
            this.setScores(scores1, [this.TScoreLayout], true);
            this.TtitleNode.active = true;
            this.TScoreLayout.node.active = true;

            var scaleTo11 = cc.scaleTo(0.3, 1.8);
            var scaleTo21 = cc.scaleTo(0.1, 1.1);
            var scaleTo31 = cc.scaleTo(0.1, 1.3);
            var scaleToSeq1 = cc.sequence(scaleTo11, scaleTo21, scaleTo31);
            this.TScoreLayout.node.runAction(scaleToSeq1);
        }

        if (this.daoScoreLayouts.length <= 0) return;
        if (!this._user.isContainExtra) {
            var index = this._compareIndex == 0 ? 1 : this._compareIndex;
            this.daoScoreLayouts[index - 1].node.active = true;
            this.daoScoreLayouts[index + 2].node.active = true;
            this.daoTitleNodes[index - 1].active = true;
        }

        var scores = this._lCScore.splice(0, 1);
        if (scores.length <= 0 && !this.TScoreLayout) return;
        this.setScores(scores, [this.TScoreLayout], true);
        this.TtitleNode.active = true;
        this.TScoreLayout.node.active = true;

        var scaleTo1 = cc.scaleTo(0.3, 1.8);
        var scaleTo2 = cc.scaleTo(0.1, 1.1);
        var scaleTo3 = cc.scaleTo(0.1, 1.3);
        var scaleToSeq = cc.sequence(scaleTo1, scaleTo2, scaleTo3);
        this.TScoreLayout.node.runAction(scaleToSeq);
    },

    // 下一个要比较的分数
    // 如果没有要比较的了，则返回 0
    nextCompareScore: function nextCompareScore() {
        if (!this._user) return 0;

        var data;
        if (this._user.isContainExtra) {
            data = this._cardsInfo[0];
            if (data) return data.type * 9000000000000000;
        } else {
            data = this._cardsInfo[this._compareIndex];
        }
        if (!data) return 0;
        return data.value;
    },

    setMaPai: function setMaPai(nodes, cardName) {
        if (cc.maPai == cardName) {

            var nodds = new cc.Node(); //创建一个节点对象

            nodds.addComponent(cc.Sprite); //添加精灵组件

            cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                if (err) {
                    cc.error(err.message || err);return;
                }

                var btnSprite1 = nodds.getComponent(cc.Sprite);

                btnSprite1.sizeMode = 0;

                btnSprite1.spriteFrame = spriteFrame;

                btnSprite1.node.width = nodes.width + 10;

                btnSprite1.node.height = nodes.height + 10;
            }).bind(this));

            nodes.addChild(nodds);
        }
    },

    setCards: function setCards(cards) {

        var cardSprites = this._allCardSprites();

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        cards.forEach((function (kqCard, index) {
            if (index >= cardSprites.length) {
                return;
            }
            cardSprites[index].node.removeAllChildren();

            cardSprites[index].node.getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.cardName = kqCard.cardName();

            nodds1.width = cardSprites[index].node.width;

            nodds1.height = cardSprites[index].node.height;

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var path = "public-pic-card-poker-" + kqCard.cardName();

            KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            this.setMaPai(cardSprite.node, kqCard.cardName());

            cardSprites[index].node.addChild(nodds1);
        }).bind(this));

        var cards0 = cards.slice(0, 3);
        var cards1 = cards.slice(3, 8);
        var cards2 = cards.slice(8, 13);

        var cards11 = [cards0, cards1, cards2];
        //头道
        var typeName0 = KQCard.cardsType(cards0) + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        typeName0 = typeName0 == '04' ? '11' : typeName0;

        //中道
        var typeName1 = KQCard.cardsType(cards1) + 1;
        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;
        typeName1 = typeName1 == '07' ? '22' : typeName1;

        //尾道
        var typeName2 = KQCard.cardsType(cards2) + 1;
        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        cardSprites = cardSprites.map(function (i) {
            return i.node;
        });

        if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards11, cardSprites, this.cardSpriteAtlas);
        if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards11, cardSprites, this.cardSpriteAtlas);
        if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards11, cardSprites, this.cardSpriteAtlas);
    },

    setScores: function setScores(scores) {
        var Layouts = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];
        var is_WH = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

        if (!Layouts) {
            Layouts = this.daoScoreLayouts;
            if (Layouts.length <= 0) return;
        }

        scores.forEach((function (string, index) {

            var labels = Layouts[index];

            labels.node.removeAllChildren();

            var path = "play/CardTypeCombine/" + (Number(string) >= 0 ? "addNum" : "delNum");

            this._creatorNodes(labels.node, 10, path, '', is_WH);

            var strings = string > 0 ? string + "" : string * -1 + "";

            var stringAyy = strings.split("");

            for (var i = 0; i < stringAyy.length; i++) {

                var s = stringAyy[i];

                this._creatorNodes(labels.node, Number(s), path, '', is_WH);
            }

            labels.type = 1;
        }).bind(this));
    },

    _creatorNodes: function _creatorNodes(nodes, name, path, paths) {
        var w_h = arguments.length <= 4 || arguments[4] === undefined ? false : arguments[4];

        var node = new cc.Node(); //创建一个节点对象

        node.addComponent(cc.Sprite); //添加精灵组件

        var btnSprite = node.getComponent(cc.Sprite);

        btnSprite.sizeMode = 0;

        btnSprite.node.width = 18;btnSprite.node.height = 23;
        //name = name + "";
        this._loadCardFrame(name, (function (spriteFrame) {

            btnSprite.spriteFrame = spriteFrame;

            if (w_h) {
                btnSprite.node.width = 30;btnSprite.node.height = 40;
            }
        }).bind(this), path, paths);

        nodes.addChild(node);
    },

    _setCardSpriteFrame: function _setCardSpriteFrame(indexs, nodes) {
        var cardsInfo = this._cardsInfo;
        var cards = cardsInfo.map(function (cardInfoItem) {
            return KQCard.cardsFromArray(cardInfoItem.cards);
        })[indexs] || [];

        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;

        // cc.log(this._cardsInfo)
        // cc.log(cards)
        // cc.log('------555')

        cards.forEach((function (kqCard, index) {

            nodes.children[index].removeAllChildren();

            nodes.children[index].getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.cardName = kqCard.cardName();

            nodds1.width = nodes.children[index].width;

            if (nodes.parent.parent.name == "playSelf") {

                nodes.children[index].height = 130;

                nodds1.height = 130;
            } else {

                nodes.children[index].height = 115;

                nodds1.height = 115;

                //console.log(nodes);
                //console.log(nodds1);
            }

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var path = "public-pic-card-poker-" + kqCard.cardName();

            cardSprite.node.removeAllChildren();

            KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            this.setMaPai(cardSprite.node, kqCard.cardName());

            nodes.children[index].addChild(nodds1);
        }).bind(this));

        var typeName = KQCard.cardsType(cards) + 1;

        typeName = typeName >= 10 ? typeName + "" : "0" + typeName;

        //头道
        if (indexs == 0) {
            typeName = typeName == '04' ? '11' : typeName;
        } else if (indexs == 1) {
            typeName = typeName == '07' ? '22' : typeName;
        }

        var cardSprites = nodes.children.map(function (i) {
            return i;
        });

        KQCard._setGuiCards(typeName, cards, cardSprites, this.cardSpriteAtlas);
    },

    showTouCards: function showTouCards() {
        if (this._user.isContainExtra == true) return;
        //console.log('开始执行一次定时动作--------------------------------')

        this.touLayoutBack.node.active = false;
        this._setCardSpriteFrame(0, this.touLayoutBack.node);
        this.scheduleOnce((function () {
            this.touLayout.node.active = false;
            this.touLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.touLayout.node.active = true;
        this.touLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.touLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        var types = this._cardsInfo[this._compareIndex].type == 3 ? 333 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showZhongCards: function showZhongCards() {
        if (this._user.isContainExtra == true) return;

        this.zhongLayoutBack.node.active = false;
        this._setCardSpriteFrame(1, this.zhongLayoutBack.node);
        this.scheduleOnce((function () {
            this.zhongLayout.node.active = false;
            this.zhongLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.zhongLayout.node.active = true;
        this.zhongLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.zhongLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        var types = this._cardsInfo[this._compareIndex].type == 6 ? 555 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showWeiCards: function showWeiCards() {
        //console.log('执行了一次尾道动画---------------')
        if (this._user.isContainExtra == true) return;
        //this._setCardSpriteFrame(1,this.zhongLayoutBack.node);
        this.weiLayoutBack.node.active = false;
        this._setCardSpriteFrame(2, this.weiLayoutBack.node);
        this.scheduleOnce((function () {
            this.weiLayout.node.active = false;
            this.weiLayoutBack.node.active = true;
        }).bind(this), 0.7);

        this.weiLayout.node.active = true;
        this.weiLayout.node.scaleY = 0.7;
        this.scheduleOnce((function () {
            this.weiLayout.node.scaleY = 1;
        }).bind(this), 0.02);

        AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[this._compareIndex].type);
        this._compareIndex += 1;
    },

    showTeShuCards: function showTeShuCards(cards) {
        //let typeName = KQCard.cardsTypeName(cardsNames);
        this._daoLayoutBacks = [this.touLayoutBack, this.zhongLayoutBack, this.weiLayoutBack];

        var touCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[0]);
        var zhongCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[1]);
        var weiCardSprites = this._cardSpritesWithLayout(this._daoLayoutBacks[2]);
        var cardSprites = touCardSprites.concat(zhongCardSprites).concat(weiCardSprites);
        this.cardSpriteAtlas = this.node.parent.parent.getComponent('play').cardSpriteAtlas;
        this.scheduleOnce((function () {
            cards.forEach((function (kqCard, index) {
                if (index >= cardSprites.length) return;

                var cardSprite = cardSprites[index];

                var path = "public-pic-card-poker-" + kqCard.cardName();

                cardSprite.node.removeAllChildren();

                KQCard._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

                this.setMaPai(cardSprite.node, kqCard.cardName());
            }).bind(this));
            this._daoLayoutBacks.forEach((function (nodes) {
                nodes.node.active = true;
            }).bind(this));
            AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[0].type);
        }).bind(this), 0.1);
    },

    showNextCards: function showNextCards() {
        var cardTypeCombine = this.node.parent.parent.getChildByName('CardTypeCombine').getComponent('CardTypeCombine');
        cardTypeCombine.reset();
        cardTypeCombine.node.active = false;

        this.touLayoutBack.node.parent.active = true;
        if (this._user.isContainExtra) {
            var cards = this._cardsInfo[0].cards.map(function (cardInfoItem) {
                return KQCard.cardsFromArray(cardInfoItem);
            }).reduce(function (array, subCards) {
                return array.concat(subCards);
            }, []);
            this.showTeShuCards(cards);
            this.showBaoDao(0, 0);
            this.baoDao.active = true;
            return;
        }
        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        this._daoLayouts.forEach(function (nodes) {
            nodes.node.active = false;
        });
        if (this._compareIndex == 0) {
            this.showBaoDao(0, 140);
            this.showTouCards();
        } else if (this._compareIndex == 1) {
            this.showBaoDao(1, 85);
            this.showZhongCards();
        } else if (this._compareIndex == 2) {
            this.showBaoDao(2, 34);
            this.showWeiCards();
        }

        this.baoDao.active = true;
        this.scheduleOnce((function () {
            this.baoDao.active = false;
        }).bind(this), 0.7);
    },

    showAllCards: function showAllCards() {
        if (!this._user) return;

        if (this._user.isContainExtra) {

            var cards = this._cardsInfo[0].cards.map(function (cardInfoItem) {
                return KQCard.cardsFromArray(cardInfoItem);
            }).reduce(function (array, subCards) {
                return array.concat(subCards);
            }, []);

            this.showTeShuCards(cards);

            //return;
        }

        if (!this._daoLayoutBacks) return;

        this.touLayoutBack.node.parent.active = true;

        this._daoLayoutBacks.forEach((function (nodes, index) {

            nodes.node.active = true;

            nodes.node.children.forEach(function (no) {
                no.active = true;
            });

            this._setCardSpriteFrame(index, nodes.node);

            if (this.TScoreLayout) this.daoTitleNodes[index].active = true;
        }).bind(this));

        if (!this.TScoreLayout) return;

        this.daoScoreLayouts.forEach((function (nodes) {

            nodes.node.active = true;
        }).bind(this));

        this.setScores([this._user.cScore], [this.TScoreLayout], true);

        this.TtitleNode.active = true;

        this.TScoreLayout.node.active = true;
    },

    showBaoDao: function showBaoDao(index, positonY) {
        var cardsInfo = this._cardsInfo;
        var cardType = cardsInfo.map(function (cardInfoItem) {
            return cardInfoItem.type;
        });

        var typeName0 = cardType[index] + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        if (index == 0) typeName0 = typeName0 == '04' ? '11' : typeName0;
        if (index == 1) typeName0 = typeName0 == '07' ? '22' : typeName0;

        if (cardType[index] == 10) typeName0 = '15'; //特殊牌
        if (cardType[index] == 11) typeName0 = '14';
        if (cardType[index] == 12) typeName0 = '16';
        if (cardType[index] == 18) typeName0 = '25';
        if (cardType[index] == 19) typeName0 = '26';

        var path = this._user.isContainExtra ? "game-right_specia" : "game-poker_type";

        this._loadCardFrame(typeName0, (function (spriteFrame) {
            var btnSprites1 = this.baoDao.getComponent(cc.Sprite);
            btnSprites1.spriteFrame = spriteFrame;
        }).bind(this), "play/CardTypeCombine/game_txt", path);
        this.baoDao.y = positonY;
    },

    _loadCardFrame: function _loadCardFrame(cardName, callback) {
        var path = arguments.length <= 2 || arguments[2] === undefined ? "play/CardTypeCombine/pockList" : arguments[2];
        var paths = arguments.length <= 3 || arguments[3] === undefined ? "public-pic-card-poker-" : arguments[3];

        cc.loader.loadRes(path, cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                cc.error(err);
                return;
            }
            cardName = cardName + "";
            cardName = this._cardFullName(cardName, paths);
            var frame = atlas.getSpriteFrame(cardName);
            callback(frame);
        }).bind(this));
    },

    _cardFullName: function _cardFullName(cardShortName, paths) {
        if (!paths) return cardShortName;
        var cardName = cardShortName;
        if (!cardName.startsWith(paths)) {
            cardName = paths + cardName;
        }
        return cardName;
    },

    _clearCards: function _clearCards() {
        this._clearLayoutCards(this.touLayout);
        this._clearLayoutCards(this.zhongLayout);
        this._clearLayoutCards(this.weiLayout);
    },

    _clearLayoutCards: function _clearLayoutCards(layout) {
        this._cardSpritesWithLayout(layout).forEach(function (sprite) {
            sprite.spriteFrame = null;
        });
    },

    _cardSpritesWithLayout: function _cardSpritesWithLayout(layout) {
        var node = layout.node;
        return node.children.map(function (node) {
            return node.getComponent('cc.Sprite');
        });
    },

    _allCardSprites: function _allCardSprites() {
        var touCardSprites = this._cardSpritesWithLayout(this.touLayout);
        var zhongCardSprites = this._cardSpritesWithLayout(this.zhongLayout);
        var weiCardSprites = this._cardSpritesWithLayout(this.weiLayout);
        var result = touCardSprites.concat(zhongCardSprites).concat(weiCardSprites);
        return result;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardResHelper":"KQCardResHelper"}],"Countdown":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6406dyBk8tKVrlJ1+mg7cLt', 'Countdown');
// scripts\Pefabs\Countdown.js

cc.Class({
    "extends": cc.Component,

    properties: {
        labelTime: cc.Label,
        //timeNode: cc.Node,

        _callback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.labelTime.string = "0";
    },

    /**
     * 开始倒计时
     * 
     * @param  {Number} time 时长
     * @param  {Function} callback 倒计时的回调
     */
    startCountdown: function startCountdown(time, callback) {
        this.stop();
        this._callback = callback;

        this.node.active = true;
        this.labelTime.string = "" + time;
        this.schedule(this._countDown, 1, time);
        this.getComponent("time").setTime(time * 0.5);
    },

    stop: function stop() {
        this.unschedule(this._countDown);
        this.node.active = false;

        if (this._callback) {
            var isTimeout = Number(this.labelTime.string) <= 0;
            var callback = this._callback;
            this._callback = null;
            callback(isTimeout);
        }

        this._callback = null;
    },

    _countDown: function _countDown() {
        var time = Number(this.labelTime.string || "0");
        time = time - 1;

        if (time <= 0) {
            this.stop();
        }

        this.labelTime.string = String(time);
    }

});

cc._RFpop();
},{}],"GameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6a3cdd+2shGlZ+jeI3trSsB', 'GameResult');
// scripts\Play\GameResult.js

var KQCard = require('KQCard');
var AudioManager = require('AudioManager');

var ResultStatus = {
  WIN: 2,
  DRAW: 1,
  LOSE: 0
};

var GameResult = cc.Class({
  'extends': cc.Component,

  properties: {
    winNode: cc.Node,
    loseNode: cc.Node,
    drawNode: cc.Node,
    contentNode: cc.Node,

    resultItems: [cc.Node],

    _deskInfo: null,
    _userId: null,
    _closeCallback: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._hideResultItems();
  },

  showResults: function showResults(deskInfo, currentUserId) {
    this._deskInfo = deskInfo;
    this._userId = currentUserId;

    var resultStatus = this._resultStatus();
    this.contentNode.active = true;
    this.winNode.active = resultStatus == ResultStatus.WIN;
    this.drawNode.active = resultStatus == ResultStatus.DRAW;
    this.loseNode.active = resultStatus == ResultStatus.LOSE;

    if (this.winNode.active) {
      AudioManager.instance.playWin();
    } else if (this.loseNode.active) {
      AudioManager.instance.playLose();
    }

    this.node.getComponent('alert').alert();
    this.node.getComponent('alert').setDismissCallback((function () {
      this._closeCallback;
    }).bind(this));

    var playerInfos = deskInfo.players.sort(function (p1, p2) {
      return p2.cScore - p1.cScore;
    });
    var itemComps = this.resultItems.map(function (node) {
      return node.getComponent('ResultItem');
    });
    itemComps.forEach((function (itemComp, index) {
      itemComp.node.active = index < playerInfos.length;
      if (!itemComp.node.active) {
        return;
      }

      var user = playerInfos[index];
      itemComp.updateWithPlayerInfo(user, deskInfo.isRandomDesk);
      var cards = this._cardsFromUser(user);
      itemComp.setCards(cards);
    }).bind(this));
  },

  setCloseCallback: function setCloseCallback(callback) {
    this._closeCallback = callback;
  },

  _cardsFromUser: function _cardsFromUser(user) {
    var cards = user.cardInfo.map(function (cardInfoItem) {
      return KQCard.cardsFromArray(cardInfoItem.cards);
    }).reduce(function (array, subCards) {
      return array.concat(subCards);
    }, []);

    return cards;
  },

  _hideResultItems: function _hideResultItems() {
    this.resultItems.forEach(function (node) {
      node.acitve = false;
    });
  },

  _resultStatus: function _resultStatus() {
    var playerInfos = this._deskInfo.players;
    var user = playerInfos.find((function (user) {
      return user.id == this._userId;
    }).bind(this));

    var score = user.cScore;
    if (this._deskInfo.isRandomDesk) {
      // 如果是随机场的话，应该用钻石来判断输赢
      score = user.diamond;
    }

    if (score > 0) {
      return ResultStatus.WIN;
    } else if (score < 0) {
      return ResultStatus.LOSE;
    }

    return ResultStatus.DRAW;
  }
});

module.exports = GameResult;

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard"}],"GetCardPointsSameCount":[function(require,module,exports){
"use strict";
cc._RFpush(module, '64665arSbVGtqTVZeISv/TD', 'GetCardPointsSameCount');
// scripts\KQCard\GetCardPointsSameCount.js

/*#####*/
//��������һ���������ڵ���ͬ�������Ƶ�����
var GetCardPointsSameCount = function GetCardPointsSameCount(cards) {
    this.cardNumbers = {};
    for (var i in cards) {
        var s;
        if (typeof cards[i].number == 'undefined') {
            s = cards[i].point;
        } else {
            s = cards[i].number;
        }
        if (this.cardNumbers[s]) {
            this.cardNumbers[s]++;
        } else {
            this.cardNumbers[s] = 1;
        }
        //cc.log(this.cardNumbers[cards[i].number])
        //cc.log(cards)
        //cc.log(cards[i].number)
        //cc.log('---7')
    }
    return this.cardNumbers;
};

module.exports = GetCardPointsSameCount;

cc._RFpop();
},{}],"Invit":[function(require,module,exports){
"use strict";
cc._RFpush(module, '37d962bf0NPxaQIYUcZDwR3', 'Invit');
// scripts\Invit.js

var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }
    var isComplete = this._lastEmptyLabel() == null;
    var inviteNumber = this._roomNumber();
    if (inviteNumber.length == 6) {
      this.callbackJoinRoom = inviteNumber;
    }
  },

  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackJoinRoom;
    console.log(inviteNumber, "------------------------");
    if (inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackJoinRoom = ''; //清空邀请码
    }
  },

  clickClear: function clickClear() {
    this.callbackJoinRoom = '';
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"KQCardColorsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf1deKQQ4NMMYVV+7xEr9Jf', 'KQCardColorsHelper');
// scripts\KQCard\KQCardColorsHelper.js

// 牌花色帮助类
// 用于计算一个牌数组的花色相同的牌的张数
var KQCardColorsHelper = function KQCardColorsHelper(cards) {
  this.colorNumber = {};

  cards.forEach((function (card) {
    var color = card.color;
    var number = this.colorNumber[color] || 0;
    this.colorNumber[color] = number + 1;
  }).bind(this));
};

// 相同花色的牌的最大数量
KQCardColorsHelper.prototype.maxNumber = function () {
  var result = 0;
  for (var prop in this.colorNumber) {
    var number = this.colorNumber[prop];
    result = Math.max(number, result);
  }

  return result;
};

module.exports = KQCardColorsHelper;

cc._RFpop();
},{}],"KQCardFindTypeExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '54a95JOLVRACIP91XEFodqF', 'KQCardFindTypeExtension');
// scripts\KQCard\KQCardFindTypeExtension.js

var KQCard = require('KQCard');
var ArrayExtension = require('ArrayExtension');
var KQCardPointsHelper = require('KQCardPointsHelper');

module.exports = {};

// 寻找 cardModes 中的 对子
// 这会返回 对子 的索引数组
// 如：[[1, 3], [4, 5]]
KQCard.findDuiZi = function (cardModes) {
  var sDuiZiIndexs = KQCard.findSanTiao(cardModes) || [];
  var result = KQCard._findPointLength(cardModes, 2) || [];
  if (result.length < 2) {
    if (sDuiZiIndexs.length > 0) {
      sDuiZiIndexs.forEach(function (indexs) {
        var s1 = [indexs[0], indexs[1]];
        //var s2 = [indexs[1],indexs[2]];
        //result.push(s2);
        result.push(s1);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 2);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }

  result = KQCard.repeat(result);

  return result.length > 0 ? result : [];
};

KQCard._findPointLength = function (cardModes, length) {
  if (cardModes.length < length) {
    return [];
  }

  var obj = cardModes.reduce(function (obj, card, index) {
    var pointIndexs = obj[card.point] || [];
    obj[card.point] = pointIndexs;
    pointIndexs.push(index);
    return obj;
  }, {});

  var result = [];
  for (var prop in obj) {
    var pointIndexs = obj[prop];
    // if (pointIndexs.length == length) {
    //   pointIndexs.sort(function (n1, n2) {
    //     return n1 - n2;
    //   });
    //   result.push(pointIndexs);
    // }
    while (pointIndexs.length >= length && length != 0) {
      //有多的分割多个数组
      var splices = pointIndexs.splice(0, length);
      if (splices.length >= length) {
        splices.sort(function (n1, n2) {
          return n1 - n2;
        });
        result.push(splices);
      }
    }
  }

  result.sort(function (arr1, arr2) {
    var n1 = arr1[0];
    var n2 = arr2[0];
    return n2 - n1;
  });
  return result.length > 0 ? result : [];
};

// 找 两对 的索引数组
// 如：[[1, 2, 3, 4], [5, 6, 7, 8]]
KQCard.findLiaDui = function (cardModes) {
  var duiZiIndexs = KQCard.findDuiZi(cardModes) || [];
  var duiZiIndex = KQCard.findGuiPai(cardModes, 2) || [];

  if (duiZiIndexs.length < 1 && duiZiIndex.length > 0) {
    duiZiIndex.forEach(function (indexs) {
      duiZiIndexs.unshift(indexs);
    });
  }
  if (duiZiIndexs.length < 2) {
    return [];
  }

  var result = [];
  for (var i = 0; i < duiZiIndexs.length; ++i) {
    for (var j = i + 1; j < duiZiIndexs.length; ++j) {
      if (result.length < 10) {
        var pre = duiZiIndexs[i];
        var next = duiZiIndexs[j];
        var s = pre.concat(next);
        var newS = [];
        for (var q = 0; q < s.length; q++) {
          if (newS.indexOf(s[q]) == -1) {
            newS.push(s[q]);
          } else {
            break;
          }
        }
        if (newS.length == 4) {
          newS.sort(function (n1, n2) {
            return n1 - n2;
          });
          result.unshift(newS);
        }
      } else {
        break;
      }
    }
  }
  result = KQCard.repeat(result);
  if (result.length > 6) {
    result = result.slice(0, 6);
  }
  return result;
};

// 找三条
// 如：[[1, 2, 3]];
KQCard.findSanTiao = function (cardModes) {
  if (cardModes.length < 3) {
    return [];
  }
  var result = KQCard._findPointLength(cardModes, 3) || [];
  //for(var q =0;q<result.length;q++){
  //  var indexs = result[q][0];
  //  if(cardModes[indexs].point >= 20){
  //    result.splice(q,1);
  //  }
  //}
  if (result.length < 2) {
    var tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray.length > 0) {
      tieZhiIndexsArray.forEach(function (indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        var sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 3);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }
  /*if(result.length < 1){
    // 铁支是包含三条的
    let tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray) {
      tieZhiIndexsArray.forEach(function(indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        let sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
  }*/

  //if(result.length > 10){
  //  result = result.slice(0,10);
  //}

  result = KQCard.repeat(result);
  return result.length > 0 ? result : [];
};

// 找同花顺
/*KQCard.findTongHuaShun = function (cardModes, length = 5) {
  if (cardModes.length < length) {
    return [];
  }
  let result = [];
  var sanShunZi = KQCard.sanShunZi1(cardModes,length);
  if(sanShunZi[0] == null){
    return false;
  }
  for(var i=0;i<sanShunZi[0].length;i++) {
    var s = sanShunZi[0][i];
    if (KQCard.isTongHuaShun(s, length)) {
      result.unshift(sanShunZi[1][i]);

    }
  }
  if(result.length > 0){
    return result
  }else{
    return KQCard.findTongHuaShun1(cardModes);
  }
};*/
KQCard.findTongHuaShun = function (cards) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cards.length < length) {
    return [];
  }
  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= 5) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var start = 0; start + 5 <= s.length; ++start) {
      var subCards = s.slice(start, start + 5);
      if (KQCard.isTongHuaShun(subCards)) {
        (function () {
          var indexs = [];
          subCards.forEach(function (ca) {
            for (var q = 0; q < cards.length; q++) {
              var r = cards[q];
              if (r === ca) {
                indexs.push(q);
                break;
              }
            }
          });
          indexs.sort(Array.sortByPoint);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
      cards.forEach(function (adfs) {
        if (adfs.point == 14) {
          adfs.point = 1;
          adfs.scores = 1;
        }
      });
      return KQCard.findTongHuaShun20(cards);
    }
    return KQCard.findTongHuaShun(convertedCards);
  }
  //return result.length > 0 ? result : null;
};
KQCard.findTongHuaShun20 = function (card) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (card.length < length) {
    return false;
  }
  var card20 = KQCard.contain20(card) || [];
  if (card20.length <= 0) {
    return false;
  }
  var cards = card.kq_excludes(card20);

  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= parseInt(5 - card20.length)) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  //cc.log(colorSum)

  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var j = 1; j <= card20.length; ++j) {
      var num = 5 - j;
      for (var start = 0; start + num <= s.length; ++start) {
        var subCards = s.slice(start, start + num);
        var bool = parseInt(subCards[num - 1]['scores']) - parseInt(subCards[0]['scores']) < 5;
        if (bool) {
          var newCard20;

          (function () {
            var indexs = [];
            newCard20 = card20.slice(0, j);

            subCards = subCards.concat(newCard20);
            subCards.forEach(function (ca) {
              for (var q = 0; q < card.length; q++) {
                var r = card[q];
                if (r === ca) {
                  indexs.push(q);
                  break;
                }
              }
            });
            indexs.sort(Array.sortByNumber);

            result.unshift(indexs);
          })();
        }
      }
    }
  }
  //cc.log(result)
  //cc.log('--------357')
  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(card);
    if (card === convertedCards) {
      return [];
    }
    return KQCard.findTongHuaShun20(convertedCards);
  }
  //return result.length > 0 ? result : null;
};

// 找铁支
// 如：[[1,2,3,4]]
KQCard.findTieZhi = function (cardModes) {
  var result = KQCard._findPointLength(cardModes, 4);
  if (result.length > 0) {
    return result;
  }
  result = [];
  // 五同是包含铁支的
  var wuTongIndexsArray = KQCard.findWuTong(cardModes);
  if (wuTongIndexsArray) {
    wuTongIndexsArray.forEach(function (indexs) {
      var tieZhiIndexs0 = [indexs[0], indexs[1], indexs[2], indexs[3]];
      var tieZhiIndexs1 = [indexs[0], indexs[1], indexs[2], indexs[4]];
      var tieZhiIndexs2 = [indexs[0], indexs[1], indexs[3], indexs[4]];
      var tieZhiIndexs3 = [indexs[0], indexs[2], indexs[3], indexs[4]];
      var tieZhiIndexs4 = [indexs[1], indexs[2], indexs[3], indexs[4]];
      result.push(tieZhiIndexs0);
      result.push(tieZhiIndexs1);
      result.push(tieZhiIndexs2);
      result.push(tieZhiIndexs3);
      result.push(tieZhiIndexs4);
    });
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result);
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 4);
};
//找五同
KQCard.findWuTong = function (cardModes) {
  if (cardModes.length < 5) {
    return [];
  }
  var result = this._findPointLength(cardModes, 5) || [];
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 5);
};
// 找顺子
// 如：[[1, 2, 3, 4, 5]]
KQCard.findShunZi = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  if (typeof cardModes[0]['point'] == "undefined") {
    cardModes = KQCard.cardsFromArray(cardModes);
  }
  // 先根据点数去重
  var uniqueCards = cardModes.unique(function (card1, card2) {
    return card1.point == card2.point;
  });
  uniqueCards.sort(KQCard.sortByPoint);

  // 如果有 A，则在最后添加 14
  var cardA = cardModes.find(function (card) {
    return card.point == 1;
  });
  if (cardA) {
    var cardAPlus = new KQCard(cardA);
    cardAPlus.point = 14;
    uniqueCards.push(cardAPlus);
  }

  var result = [];

  // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
  for (var start = 0; start + length <= uniqueCards.length; ++start) {
    var subCards = uniqueCards.slice(start, start + length);
    if (KQCard.isShunZi(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {

            if (card.point == 14) {
              return originCard.point == 1;
            }

            return card === originCard;
          });
          indexs.push(index);
        });

        indexs.sort(Array.sortByNumber);
        result.unshift(indexs);
      })();
    }
  }

  // 处理点数重复的情况
  // 比如 A A K Q J 10 这种
  var repeatIndexsArray = KQCard._findRepeatPointIndexsArray(result, cardModes);
  repeatIndexsArray.forEach(function (indexs) {
    result.unshift(indexs);
  });

  result.sort(function (arr1, arr2) {
    return arr1[0] - arr2[0];
  });

  return result.length > 0 ? result : KQCard.findShunZi20(cardModes);
};
KQCard.findShunZi20 = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes);
  if (card20.length <= 0) {
    return [];
  }
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  var newArr = [];
  var newArrs = [];
  for (var i = 0; i < cards.length; i++) {
    if (newArrs.indexOf(cards[i]['point']) == -1) {
      newArr.push(cards[i]);
      newArrs.push(cards[i].point);
    }
  }

  newArr.sort(function (n1, n2) {
    return n1.point - n2.point;
  });
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = length - j;
    for (var start = 0; start + num <= newArr.length; ++start) {
      var subCards = newArr.slice(start, start + num);
      var bool = parseInt(subCards[num - 1]['point']) - parseInt(subCards[0]['point']) < length;
      if (bool) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cardModes);
    if (cardModes === convertedCards) {
      return false;
    }
    return KQCard.findShunZi20(convertedCards);
  }
};
KQCard._findRepeatPointIndexsArray = function (indexsArray, originCards) {
  var repeatIndexsArray = [];
  indexsArray.forEach(function (indexs) {
    var cards = indexs.map(function (index) {
      return originCards[index];
    });

    cards.forEach(function (card, index) {
      var originIndex = originCards.findIndex(function (originCard) {
        if (typeof card == 'undefined') {
          return;
        }
        if (originCard !== card && originCard.point == card.point) {
          return true;
        }
        return false;
      });

      if (originIndex < 0) {
        return;
      }

      var repeatIndexs = indexs.slice();
      repeatIndexs[index] = originIndex;
      repeatIndexsArray.push(repeatIndexs);
    });
  });

  return repeatIndexsArray;
};

// 找同花
// 如：[[1, 2, 3, 4, 5]]
KQCard.findTongHua = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }

  var cards = Array.from(cardModes);
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var start = 0; start + length <= cards.length; ++start) {
    var subCards = cards.slice(start, start + length);
    if (KQCard.isTongHua(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {
            return card === originCard;
          });
          indexs.push(index);
        });
        //indexs = indexs.length > 5 ? indexs.splice(1,1) : indexs;
        indexs.sort(Array.sortByNumber);
        result.unshift(indexs);
      })();
    }
  }
  return result.length > 0 ? result : KQCard.findTongHua20(cardModes);
};
KQCard.findTongHua20 = function (cardModes) {
  if (cardModes.length < 5) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes);
  if (card20.length <= 0) {
    return [];
  }
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = 5 - j;
    for (var start = 0; start + num <= cards.length; ++start) {
      var subCards = cards.slice(start, start + num);
      if (KQCard.isTongHua(subCards, num)) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  return result.length > 0 ? result : [];
};

KQCard.findHuLu = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }

  var p_3 = KQCard.findSanTiao(cardModes);
  var p_4 = KQCard.findTieZhi(cardModes);
  var p2 = KQCard.findDuiZi(cardModes) || [];
  //var p_3 =  this._findPointLength(cardModes, 3) || [];
  //var p_4 = this._findPointLength(cardModes, 4) || [];
  //var p2 = this._findPointLength(cardModes, 2) || [];
  if (p2.length <= 0) {
    if (p_3) {
      p_3.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        var sanTiaoIndexs3 = [indexs[1], indexs[2]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        p2.push(sanTiaoIndexs3);
      });
    }

    if (p_4) {
      p_4.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[1], indexs[2]];
        //let sanTiaoIndexs4 = [indexs[1], indexs[3]];
        var sanTiaoIndexs6 = [indexs[2], indexs[3]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        //p2.unshift(sanTiaoIndexs2);
        //p2.unshift(sanTiaoIndexs3);
        //p2.unshift(sanTiaoIndexs4);
        p2.push(sanTiaoIndexs6);
      });
    }
  }

  if (p2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.unshift(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : KQCard.findHuLu20(cardModes);
};
KQCard.findHuLu20 = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }
  var card20 = KQCard.contain20(cardModes) || [];
  if (card20.length <= 0) {
    return [];
  }
  var p_3 = KQCard.findGuiPai(cardModes, 3);
  var p_4 = KQCard.findGuiPai(cardModes, 4);
  var p_2 = KQCard.findGuiPai(cardModes, 2);
  if (p_2 == null) {
    p_2 = [];
  }
  if (p_3) {
    p_3.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs3 = [indexs[1], indexs[2]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs3);
    });
  }

  if (p_4) {
    p_4.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs6 = [indexs[2], indexs[3]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs6);
    });
  }

  if (p_2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p_2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.unshift(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : [];
};

KQCard.findGuiPai = function (cardModes) {
  var numBer = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

  var card20 = KQCard.contain20(cardModes).map(function (card) {
    //得到鬼牌的索引
    for (var q = 0; q < cardModes.length; q++) {
      var r = cardModes[q];
      if (r === card) {
        return q;
      }
    }
  });
  if (card20.length <= 0) {
    return [];
  }
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = numBer - j; //除鬼牌外 我应该找多少张牌匹配
    var indexs = KQCard._findPointLength(cardModes, num) || [];
    for (var t = 0; t < indexs.length; t++) {
      if (numBer == 2) {
        //是对子的时候把鬼牌和单张匹配都循环一遍
        for (var o = 0; o < card20.length; ++o) {
          var s = indexs[t].concat(card20[o]);
          if (s.length == numBer) {
            result.push(s);
          }
        }
      } else {
        var s = indexs[t].concat(card20.slice(0, j)); //依次相加鬼牌第一次加一张 递增
        if (s.length == numBer) {
          result.push(s);
        }
      }
    }
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result); //去重
  return result.length > 0 ? result : [];
};

KQCard.repeat = function (result) {
  for (var i = 0; i < result.length; i++) {
    var index = result[i];

    var newAyy = [];
    for (var o = 0; o < index.length; o++) {
      //有重复干掉你
      if (newAyy.indexOf(index[o]) == -1) {
        newAyy.push(index[o]);
      } else {
        result.splice(i, 1);
        break;
      }
    }

    for (var j = i + 1; j < result.length - 1; j++) {
      var s = result[j];
      var jString = '';
      var iString = '';
      for (var r = 0; r < s.length; r++) {
        jString = jString + s[r];
        iString = iString + index[r];
      }
      if (jString == iString) {
        //有重复干掉你
        result.splice(i, 1);
        break;
      }
    }
  }
  return result;
};

KQCard.testFind = function (cardModes) {
  var WuTong = KQCard.findWuTong(cardModes) || [];
  var TongHuaShun = KQCard.findTongHuaShun(cardModes) || [];
  var TieZhi = KQCard.findTieZhi(cardModes) || [];
  var HuLu = KQCard.findHuLu(cardModes) || [];
  var TongHua = KQCard.findTongHua(cardModes) || [];
  var ShunZi = KQCard.findShunZi(cardModes) || [];
  var SanTiao = KQCard.findSanTiao(cardModes) || [];
  var LiaDui = KQCard.findLiaDui(cardModes) || [];
  var DuiZi = KQCard.findDuiZi(cardModes) || [];
  var result = [WuTong, TongHuaShun, TieZhi, HuLu, TongHua, ShunZi, SanTiao, LiaDui, DuiZi];
  return result;
};

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","KQCard":"KQCard","KQCardPointsHelper":"KQCardPointsHelper"}],"KQCardPointsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '42d3e866XhHdbkspy3Qytap', 'KQCardPointsHelper');
// scripts\KQCard\KQCardPointsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardPointsHelper = function KQCardPointsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.point;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardPointsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardPointsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardResHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'be420vtWaJOHoxQcZwP2xN2', 'KQCardResHelper');
// scripts\KQCard\KQCardResHelper.js

var Helper = {
  loadCardSpriteFrame: function loadCardSpriteFrame(cardName, callback) {
    this._loadCardFrame(cardName, callback);
  },

  setCardSpriteFrame: function setCardSpriteFrame(sprite, cardName) {
    this.loadCardSpriteFrame(cardName, function (spriteFrame) {
      sprite.spriteFrame = spriteFrame;
    });
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("play/CardTypeCombine/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        callback(null, err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
};

module.exports = Helper;

cc._RFpop();
},{}],"KQCardScoreExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3f5d8wDA+tMPbPd/k4hBAAR', 'KQCardScoreExtension');
// scripts\KQCard\KQCardScoreExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardScoretsHelper = require('KQCardScoretsHelper');
var GetCardPointsSameCount = require('GetCardPointsSameCount');
var KQCardPointsHelper = require('KQCardPointsHelper');

KQCard.scoreOfCards = function (cards) {
  if (cards == null || cards.length == null) {
    cards = [];
  }

  var isTou = cards.length == 3;
  var typeScore = KQCard._typeScoreOfCards(cards);
  var caleCards = KQCard._convertOneToA(cards.slice());
  caleCards.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  //caleCards = KQCard.Sort(caleCards);
  var card20 = KQCard.contain20(caleCards);
  var pointHelper = new KQCardScoretsHelper(caleCards.kq_excludes(card20));
  var maxNum = pointHelper.maxNumber() /*-card20.length == 0 ? 1: pointHelper.maxNumber()-card20.length*/;

  var maxScore = 0; //获取除鬼牌外最大的的点数
  for (var i in pointHelper.pointNumbers) {
    if (parseInt(i) > maxScore && pointHelper.pointNumbers[i] == maxNum) {
      maxScore = parseInt(i);
    }
  }
  caleCards.forEach(function (card) {
    if (card.scores >= 20) {
      card.scores = maxScore;
    }
  });
  card20.forEach(function (card) {
    card.scores = maxScore;
  });
  //cc.log(maxNum)
  //cc.log(maxScore)
  //cc.log(caleCards.kq_excludes(card20))
  //cc.log('----35')
  caleCards.sort(KQCard.sort);
  if (typeScore == 9000000000000000) {
    //五同
    caleCards.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var totalValue = "";
    //var totalColor = "";
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      //var c = caleCards[i].color;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      //totalColor = c+totalColor;
    }
    //totalValue = totalValue+totalColor;
    //cc.log(totalValue)
    //cc.log(parseInt(totalValue))
    //cc.log(typeScore+parseInt(totalValue))
    return typeScore + parseInt(totalValue);
  } else if (typeScore == 8000000000000000) {
    //同花顺比最大的那张，如果两张相同那就是相同
    if (card20.length > 0) {
      //有鬼牌的时候要改变鬼牌的分数
      caleCards = KQCard._changeCardScors(caleCards);
    }
    var totalValue = "";
    var valueColor = ""; //牌色
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      var c = caleCards[i].color; //牌色
      valueColor = c + valueColor; //牌色
    }
    if (cc.huaSe == 0) return typeScore + parseInt(totalValue);
    return typeScore + parseInt(totalValue + valueColor);
  } else if (typeScore == 7000000000000000) {
    //铁支,找出那四张是什么牌

    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }
    //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
    //var qwe = '';
    //qwe = oneValueColor.substr(0,oneValueColor.length -1);
    //oneValueColor = oneValueColor.substr(oneValueColor.length -1);
    //str = str+oneValue + oneValueColor + valueColor + qwe;
    //return typeScore+parseInt(str);
    return typeScore + parseInt(str + oneValue);
  } else if (typeScore == 6000000000000000) {
    //葫芦
    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }

    if (isTou) {
      oneValue = oneValue + '0000';
      oneValueColor = oneValueColor + '00';
    }
    return typeScore + parseInt(str + oneValue);
    //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
    //str = str+oneValue + valueColor + oneValueColor;
    //return typeScore+parseInt(str);
  } else if (typeScore == 5000000000000000) {
      //同花,有可能需要比5张牌
      var totalScore = "";
      var totalColor = "";
      //var colors = 0;//获取牌的类型颜色
      //for(var i in caleCards) {
      //  if(parseInt(caleCards[i].point) < 20){
      //    colors = parseInt(caleCards[i].color);
      //    break;
      //  }
      //}

      for (var i in caleCards) {
        var paiPoint = parseInt(caleCards[i].point);
        var colors = parseInt(caleCards[i].point) < 20 ? caleCards[i].color : 5;
        totalColor = colors + totalColor;
        totalScore = (paiPoint >= 10 ? paiPoint : "0" + paiPoint) + totalScore;
      }
      return typeScore + parseInt(totalScore);
      //if(cc.huaSe == 0) return typeScore+parseInt(totalScore);
      //return typeScore+parseInt(totalScore+totalColor);
    } else if (typeScore == 4000000000000000) {
        //顺子
        if (card20.length > 0) {
          //有鬼牌的时候要改变鬼牌的分数
          caleCards = KQCard._changeCardScors(caleCards);
        }
        var totalValue = "";
        var valueColor = ""; //牌色
        for (var i in caleCards) {
          var s = caleCards[i].scores;
          totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;

          var c = caleCards[i].color; //牌色
          valueColor = c + valueColor; //牌色
        }
        return typeScore + parseInt(totalValue);
        //if(cc.huaSe == 0) return typeScore+parseInt(totalValue);
        //return typeScore+parseInt(totalValue + valueColor);
      } else if (typeScore == 3000000000000000) {
          //三条，找出是哪张牌有3张
          //caleCards.sort(KQCard.sort);
          var str = "";
          var oneValue = "";
          var valueColor = ""; //牌色
          var oneValueColor = ""; //牌色
          var oneValueColor20 = ""; //牌色
          for (var w in caleCards) {
            if (maxScore == caleCards[w].scores) {
              //三条
              var s = caleCards[w].scores;
              str = (parseInt(s) >= 10 ? s : "0" + s) + str;

              var c = caleCards[w].color; //牌色
              valueColor = c + valueColor; //牌色
            } else {
                var s = caleCards[w].scores;
                oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

                var c = caleCards[w].color; //牌色
                if (parseInt(s) < 20) {
                  oneValueColor = c + oneValueColor; //牌色
                } else {
                    oneValueColor20 = c + oneValueColor20; //牌色
                  }
              }
          }
          if (isTou) {
            oneValue = oneValue + '0000';
            valueColor = valueColor + '00';
          }
          return typeScore + parseInt(str + oneValue);
          //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
          //str = str+oneValue + oneValueColor + valueColor + oneValueColor20;
          //return typeScore+parseInt(str);
        } else if (typeScore == 2000000000000000) {
            //caleCards.sort(KQCard.sort);
            //两对,有可能需要比5张牌
            var str = "";
            var oneValue = '';
            var valueColor = ""; //牌色
            var oneValueColor = ""; //牌色
            for (var i in pointHelper.pointNumbers) {
              if (pointHelper.pointNumbers[i] == 2) {
                //两对
                for (var w in caleCards) {
                  if (i == caleCards[w].scores) {
                    var s = caleCards[w].scores;
                    str = (parseInt(s) >= 10 ? s : "0" + s) + str;
                    var c = caleCards[w].color; //牌色
                    valueColor = c + valueColor; //牌色
                  }
                }
              } else {
                  for (var q in caleCards) {
                    //单张加花色
                    if (i == caleCards[q].scores) {
                      var s = caleCards[q].scores;
                      oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

                      var c = caleCards[q].color; //牌色
                      oneValueColor = oneValueColor + c; //牌色
                    }
                  }
                }
            }
            return typeScore + parseInt(str + oneValue);
            //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
            ////cc.log(str)
            ////cc.log(oneValue)
            //str = str+oneValue +oneValueColor + valueColor;
            //return typeScore+parseInt(str);
          } else if (typeScore == 1000000000000000) {
              //对子
              //caleCards.sort(KQCard.sort);
              var str = "";
              var oneValue = "";
              var oneValueColor = "";
              var valueColor = "";

              if (card20.length > 0) {
                caleCards.sort(function (card1, card2) {
                  return card2.point - card1.point;
                });
                caleCards = caleCards.kq_excludes(card20);
                caleCards.forEach(function (card, index) {
                  var s = card.scores;
                  var c = card.color;
                  str = str + (parseInt(s) >= 10 ? s : "0" + s);
                  if (index == 0) {
                    var s20 = card20[0].scores;
                    str = str + (parseInt(s20) >= 10 ? s20 : "0" + s20);
                    valueColor = valueColor + c;
                    valueColor = valueColor + card20[0].color;
                  } else {
                    oneValueColor = oneValueColor + c;
                  }
                });
                //cc.log(str)
                //cc.log('--------274')
                if (isTou) {
                  str = str + '0000';
                  valueColor = valueColor + '00';
                }
                return typeScore + parseInt(str);
                //if(cc.huaSe == 0) return typeScore+parseInt(str);
                //str = str + oneValueColor + valueColor;
                //return typeScore+parseInt(str);
              }

              for (var i in pointHelper.pointNumbers) {
                if (pointHelper.pointNumbers[i] == maxNum) {
                  //对子
                  for (var w in caleCards) {
                    //对子加花色
                    if (i == caleCards[w].scores) {
                      var s = caleCards[w].scores;
                      valueColor = caleCards[w].color + valueColor;
                      str = (parseInt(s) >= 10 ? s : "0" + s) + str;
                    }
                  }
                } else {
                  for (var q in caleCards) {
                    //单张加花色
                    if (i == caleCards[q].scores) {
                      var s = caleCards[q].scores;
                      oneValueColor = caleCards[q].color + oneValueColor;
                      oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;
                    }
                  }
                }
              }
              if (isTou) {
                oneValue = oneValue + '0000';
                valueColor = valueColor + '00';
              }
              return typeScore + parseInt(str + oneValue);
              //if(cc.huaSe == 0) return typeScore+parseInt(str+oneValue);
              //str = str+oneValue+oneValueColor+valueColor;
              //return typeScore+parseInt(str);
            } else if (typeScore == 0) {
                //乌龙
                var valuePoint = "";
                var valueColor = "";
                for (var q in caleCards) {
                  var s = caleCards[q].scores;
                  var c = caleCards[q].color; //单张加花色
                  valuePoint = (parseInt(s) >= 10 ? s : "0" + s) + valuePoint;
                  valueColor = c + valueColor;
                }
                if (isTou) {
                  valuePoint = valuePoint + '0000';
                  valueColor = valueColor + '00';
                }
                return typeScore + parseInt(valuePoint);
                //if(cc.huaSe == 0) return typeScore+parseInt(valuePoint);
                //valuePoint = valuePoint + valueColor;
                //return typeScore+parseInt(valuePoint);
              }

  var cardsTotalPoint = 0;
  caleCards.forEach(function (card) {
    cardsTotalPoint += card.point;
  });

  var result = typeScore + cardsTotalPoint;
  return result;
};
KQCard._changeCardScors = function (cardModel) {
  cardModel.forEach(function (card) {
    card.scores = card.point;
    if (card.scores == 1) {
      card.scores = 14;
    }
  });

  var is14 = true; //是 k q j 10 A;
  var is1 = true; //是1 2 3 4 5

  cardModel.forEach(function (card) {
    if (card.scores < 10) {
      is14 = false; //不是 k q j 10 A;
    }
  });
  cardModel.forEach(function (card) {
    card.scores = card.point;
    if (card.scores == 14) {
      card.scores = 1;
    }
  });
  cardModel.forEach(function (card) {
    if (card.scores > 5 && card.scores != 20) {
      is1 = false; //不是1 2 3 4 5
    }
  });

  if (is14) {
    //是 k q j 10 A;
    cardModel.forEach(function (card) {
      if (card.scores == 1) {
        card.scores = 14;
      }
    });

    cardModel.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var num = 14;
    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      scoresAyy.push(num);
      num -= 1;
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    //cc.log('----------是 k q j 10 A',scoresAyy)
    cardModel.forEach((function (card) {
      //找出选中的牌
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  } else if (is1) {
    //是1 2 3 4 5
    cardModel.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var num = 5;
    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      scoresAyy.push(num);
      num -= 1;
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    //cc.log('----------是1 2 3 4 5')
    cardModel.forEach((function (card) {
      //找出选中的牌
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  } else {
    cardModel.sort(function (a1, a2) {
      return a1.scores - a2.scores;
    });
    var scoresAyy = []; //用来装鬼牌分数
    for (var i = 0; i < 5; i++) {
      var s = parseInt(cardModel[0].scores) + i; //最小的牌的分数
      scoresAyy.push(s); //一副牌的分数
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    cardModel.forEach((function (card) {
      //改变牌的分数
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  }

  cardModel.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  cardModel.sort(function (a1, a2) {
    return a1.scores - a2.scores;
  });
  return cardModel;
};
/*#####*/

KQCard._typeScoreOfCards = function (cards) {
  var typeScore = 0;
  if (KQCard.containWuTong(cards)) {
    typeScore = 9000000000000000;
  } else if (KQCard.containTongHuaShun(cards)) {
    typeScore = 8000000000000000;
  } else if (KQCard.containTieZhi(cards)) {
    typeScore = 7000000000000000;
  } else if (KQCard.containHuLu(cards)) {
    typeScore = 6000000000000000;
  } else if (KQCard.containTongHua(cards)) {
    typeScore = 5000000000000000;
  } else if (KQCard.containShunZi(cards)) {
    typeScore = 4000000000000000;
  } else if (KQCard.containSanTiao(cards)) {
    typeScore = 3000000000000000;
  } else if (KQCard.containLiaDui(cards)) {
    typeScore = 2000000000000000;
  } else if (KQCard.containDuiZi(cards)) {
    typeScore = 1000000000000000;
  }

  return typeScore;
};
/*
 // 根据牌型进行排序
 KQCard._typeCardsSort = function (cards) {
 if ((cards == null) || (cards.length == 0)) {
 return cards;
 }
 if(KQCard.containWuTong(cards)){
 return KQCard._typeCardsSortWutong(cards);
 } else if (KQCard.containTongHuaShun(cards)) {
 return KQCard._typeCardsSortShunZi(cards);
 } else if (KQCard.containTieZhi(cards)) {
 return KQCard._typeCardsSortTieZhi(cards);
 } else if (KQCard.containHuLu(cards)) {
 return KQCard._typeCardsSortHuLu(cards);
 } else if (KQCard.containTongHua(cards)) {
 return KQCard._typeCardsSortTongHua(cards);
 } else if (KQCard.containShunZi(cards)) {
 return KQCard._typeCardsSortShunZi(cards);
 } else if (KQCard.containSanTiao(cards)) {
 return KQCard._typeCardsSortSanTiao(cards);
 } else if (KQCard.containLiaDui(cards)) {
 return KQCard._typeCardsSortLiangDui(cards);
 } else if (KQCard.containDuiZi(cards)) {
 return KQCard._typeCardsSortDuiZi(cards);
 }

 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortShunZi = function (cards) {
 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortTieZhi = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 /!*#####*!/
 KQCard._typeCardsSortWutong = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };
 /!*#####*!/

 KQCard._typeCardsSortHuLu = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortTongHua = function (cards) {
 return cards.sort(KQCard.sortByPoint).reverse();
 };

 KQCard._typeCardsSortSanTiao = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortLiangDui = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };

 KQCard._typeCardsSortDuiZi = function (cards) {
 return KQCard._typeCardsSortByNumberOfPoints(cards);
 };
 */
KQCard._typeCardsSortByNumberOfPoints = function (cards) {

  cards = KQCard._changeGuiCard(cards);

  cards.forEach(function (i) {
    if (i.scores == 1) i.scores = 14;
  });

  var pointHelper = new KQCardScoretsHelper(cards);
  var newCards = cards.slice().sort(function (card1, card2) {
    var numberOfCard1 = pointHelper.pointNumbers[card1.scores];
    var numberOfCard2 = pointHelper.pointNumbers[card2.scores];

    if (numberOfCard2 != numberOfCard1) {
      return numberOfCard2 - numberOfCard1;
    }
    var scores1 = card1.scores == 1 ? 14 : card1.scores;
    var scores2 = card2.scores == 1 ? 14 : card2.scores;
    return scores2 - scores1;
    //return card2.scores - card1.scores;
  });
  newCards.forEach(function (i) {
    if (i.scores == 14) i.scores = 1;
  });
  return newCards /*.concat(card20)*/;
};

KQCard._typeCardsSortByNumberOfPoints1 = function (cards) {

  cards = KQCard._changeGuiCard(cards);

  cards.forEach(function (i) {
    if (i.scores == 1) i.scores = 14;
  });

  var pointHelper = new KQCardScoretsHelper(cards);
  var newCards = cards.slice().sort(function (card1, card2) {
    var numberOfCard1 = pointHelper.pointNumbers[card1.scores];
    var numberOfCard2 = pointHelper.pointNumbers[card2.scores];

    if (numberOfCard2 != numberOfCard1) {
      return numberOfCard1 - numberOfCard2;
    }
    var scores1 = card1.scores == 1 ? 14 : card1.scores;
    var scores2 = card2.scores == 1 ? 14 : card2.scores;
    return scores1 - scores2;
    //return card1.scores - card2.scores;
  });
  newCards.forEach(function (i) {
    if (i.scores == 14) i.scores = 1;
  });
  return newCards;
};

KQCard._changeGuiCard = function (cards) {

  var card20 = KQCard.contain20(cards);

  var ca = cards.kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var type = KQCard.cardsType(cards) + 1;

  type = type >= 10 ? type : "0" + type;

  if (type == "05" || type == "09") {

    return KQCard._changeCardScors(cards);
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }
    color = ca[0].color;

    so = so == 14 ? 1 : so;

    card20.forEach(function (n) {

      n.scores = so;

      n.colorScores = color;
    });
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    card20.forEach((function (n) {

      n.scores = so;

      n.colorScores = color;
    }).bind(this));
  }

  return card20.concat(ca);
};

KQCard._setGuiCard = function (index, start, end, type, cards, nodes, cardSpriteAtlas) {
  //cc.log(cardSpriteAtlas)
  //cc.log('-----593')
  var card20 = KQCard.contain20(cards[index]);

  var ca = cards[index].kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var node = nodes.slice(start, end).filter(function (n) {

    if (n.childrenCount > 0 && n.children[0].cardName) {

      if (parseInt(n.children[0].cardName.split("_")[1]) == 20) return true;
    }
  });

  if (type == "05" || type == "09") {

    cards[index] = KQCard._changeCardScors(cards[index]);

    so = cards[index].filter(function (i) {
      if (i.point == 20) return true;
    }).map(function (i) {
      return i.scores == 14 ? 1 : i.scores;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = ca[0].color + "_" + so.splice(0, 1)[0];

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    color = ca[0].color;

    so = so == 14 ? 1 : so;

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
};

KQCard._setGuiCards = function (type, cards, nodes, cardSpriteAtlas) {
  //cc.log(cardSpriteAtlas)
  //cc.log('-----593')
  var card20 = KQCard.contain20(cards);

  var ca = cards.kq_excludes(card20);

  var helper = new KQCardPointsHelper(ca);

  var so = 0;

  var color = 1;

  var node = nodes.slice().filter(function (n) {

    if (n.childrenCount > 0 && n.children[0].cardName) {

      if (parseInt(n.children[0].cardName.split("_")[1]) == 20) return true;
    }
  });

  if (type == "05" || type == "09") {

    cards = KQCard._changeCardScors(cards);

    so = cards.filter(function (i) {
      if (i.point == 20) return true;
    }).map(function (i) {
      return i.scores == 14 ? 1 : i.scores;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = ca[0].color + "_" + so.splice(0, 1)[0];

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "06") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    color = ca[0].color;

    so = so == 14 ? 1 : so;

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
  if (type == "07" || type == "22" || type == "08" || type == "10" || type == "04" || type == "11" || type == "02") {

    for (var w in helper.pointNumbers) {

      var maxNumber = helper.pointNumbers[w];

      if (w == 1) w = 14;

      if (maxNumber >= helper.maxNumber() && so < parseInt(w) && parseInt(w) != 20) {
        so = parseInt(w);
      }
    }

    so = so == 14 ? 1 : so;

    ca.forEach(function (n) {
      if (so == n.point && color < n.color) color = n.color;
    });

    node.forEach((function (n) {

      var btnSprite = n.getComponent(cc.Sprite);

      var cardName = color + "_" + so;

      var path = "public-pic-card-poker-" + cardName;

      KQCard._loadCardFrame(cardSpriteAtlas, path, btnSprite);
    }).bind(this));
  }
};

KQCard._loadCardFrame = function (SpriteFrame, path, SpritesNode, w, h) {
  //cc.log(SpriteFrame)
  //cc.log('---769')
  var Sprite = SpriteFrame.getSpriteFrame(path);

  SpritesNode.spriteFrame = Sprite;

  if (w) SpritesNode.node.width = w;

  if (h) SpritesNode.node.height = h;
};

KQCard.testScore = function () {};

cc._RFpop();
},{"GetCardPointsSameCount":"GetCardPointsSameCount","KQCard":"KQCard","KQCardColorsHelper":"KQCardColorsHelper","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardPointsHelper":"KQCardPointsHelper","KQCardScoretsHelper":"KQCardScoretsHelper"}],"KQCardScoretsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3d3b5YPHXhN44h/B0miZFRE', 'KQCardScoretsHelper');
// scripts\KQCard\KQCardScoretsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardScoretsHelper = function KQCardScoretsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.scores;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardScoretsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardScoretsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardSelectExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '66642YNpFVIzb+JM2CkwEgS', 'KQCardSelectExtension');
// scripts\KQCard\KQCardSelectExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');

// 牌自动选择的扩展

/**
 * 自动选择牌，由大到小
 *
 * @param  {[KQCard]} originCards  被选择的原始牌数组
 *
 * @return {[KQCard]}
 */
KQCard.autoSelectCards = function (originCards, maxLength) {
    if (originCards.length <= maxLength) {
        return originCards;
    }
    originCards.forEach(function (card) {
        if (card.scores == 1) {
            card.scores = 14;
        }
    });
    var cards = originCards.slice().sort(function (a, b) {
        return a.scores - b.scores;
    });

    var findFuncs = [KQCard.findWuTong, KQCard.findTongHuaShun, KQCard.findTieZhi, KQCard.findHuLu, KQCard.findTongHua, KQCard.findShunZi, KQCard.findSanTiao, KQCard.findLiaDui, KQCard.findDuiZi];

    var indexArrays = null;
    for (var i = 0; i < findFuncs.length; ++i) {
        var func = findFuncs[i];
        indexArrays = func.bind(KQCard)(cards);
        if (indexArrays && indexArrays.length > 0) {
            break;
        }
    }

    var indexs = [];
    if (indexArrays && indexArrays.length > 0) {
        // 找出同类型的牌里的分数最大的牌
        var maxScore = 0;
        indexArrays.forEach(function (tempIndexs) {
            var tempCards = tempIndexs.map(function (index) {
                return cards[index];
            });
            var score = KQCard.scoreOfCards(tempCards);
            if (score > maxScore) {
                maxScore = score;
                indexs = tempIndexs;
            }
        });
    }

    var targetCards = indexs.map(function (index) {
        return cards[index];
    });

    /*if (targetCards.length < maxLength) {
     cards = cards.kq_excludes(targetCards);
     while(targetCards.length < maxLength) {
     targetCards.push(cards.pop());
     }
     } else */if (targetCards.length > maxLength) {
        targetCards = targetCards.slice(0, maxLength);
    }

    return targetCards || [];
};

KQCard.testAutoSelect = function (cards) {};

cc._RFpop();
},{"KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension"}],"KQCard":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c548c0gMf5BGIH4309MULw+', 'KQCard');
// scripts\KQCard\KQCard.js

var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardPointsHelper = require('KQCardPointsHelper');
var NumberExtension = require('NumberExtension');
var GetCardPointsSameCount = require('GetCardPointsSameCount');

cc = cc || {};
cc.assert = cc.assert || console.assert || function () {};
cc.log = cc.log || console.log || function () {};
cc.error = cc.error || console.error || function () {};

// 牌 Model 类，封装了花色和点数
// 使用：
// new KQCard(22);
var KQCard = function KQCard(point, color, index) {
    this.color = null;
    this.point = null;
    this.sindex = index;
    this._initWithColorAndPoint = function (color, point) {
        if (color == 's') {
            color = 4;
        }
        if (color == 'h') {
            color = 3;
        }
        if (color == 'c') {
            color = 2;
        }
        if (color == 'd') {
            color = 1;
        }

        this.point = Number(point);
        this.scores = Number(point);
        this.color = Number(color);
        this.colorScores = Number(color);

        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithNumber = function (number) {
        this.point = Math.floor(number / 10);
        this.color = number % 10;
        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithObject = function (object) {
        if (object.point) {
            this._initWithColorAndPoint(object.color, object.point);
        } else if (object.suit) {
            this._initWithColorAndPoint(object.suit, object.number);
        }
    };

    this.description = function () {
        return this.cardName();
    };

    this.cardName = function () {
        return this.color + "_" + this.point;
    };

    this.sort = function (otherCard) {
        var asc = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var AisMax = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

        return KQCard.sort(this, otherCard, asc, AisMax);
    };

    this.isEqual = function (otherCard) {
        if (!otherCard) {
            return false;
        }
        return this.point == otherCard.point && this.color == otherCard.color && this.sindex == otherCard.sindex;
    };

    if (point && color) {
        this._initWithColorAndPoint(color, point);
        return;
    }

    var number = Number(point);
    if (!Number.isNaN(number)) {
        this._initWithNumber(number);
        return;
    }

    if (typeof point == 'string') {
        // 解析 xxxxd_d 形式
        var found = point.match(/(\.)*\d_\d+/);
        if (found instanceof Array && found.length > 0) {
            var result = found[0];
            var numbers = result.split('_');

            var _color = Number(numbers[0]);
            var _point = Number(numbers[1]);

            this._initWithColorAndPoint(_color, _point);
        }

        return;
    }

    if (typeof point == 'object') {
        this._initWithObject(point);
        return;
    }

    cc.error("初始化错误：" + point + " " + color);
};

// 转换成服务器的牌 model
KQCard.prototype.toServerCard = function () {
    return {
        'suit': this.color,
        'number': this.point
    };
};

KQCard.COLOR_SPADE = 4;
KQCard.COLOR_HEART = 3;
KQCard.COLOR_CLUB = 2;
KQCard.COLOR_DIAMOND = 1;

module.exports = KQCard;

KQCard.cardsFromArray = function (cardNames) {
    return cardNames.map(function (cardName, index) {
        return new KQCard(cardName, null, index);
    });
};

// 将多张牌转换成服务器的形式
KQCard.convertToServerCards = function (cards) {
    return cards.map(function (card) {
        return card.toServerCard();
    });
};

KQCard.TYPE = {
    WuLong: 0,
    DuiZi: 1,
    LiangDui: 2,
    SanTiao: 3,
    ShunZi: 4,
    TongHua: 5,
    HuLu: 6,
    TieZhi: 7,
    TongHuaShun: 8,
    /*#####*/
    WuTong: 9,
    /*#####*/
    SanTaoHua: 10, // 特殊牌
    SanShunZi: 11,
    LiuDuiBan: 12,

    WuDuiSanTiao: 13,
    SiTaoSanTiao: 14,

    CouYiSe: 15,
    SanFenTianXia: 16,
    SanTongHuaShun: 17,
    YiTiaoLong: 18,
    QingLong: 19
};

// 牌类型名
KQCard.cardsTypeName = function (cards) {
    var names = ['乌龙', '对子', '两对', '三条', '顺子', '同花', '葫芦', '铁支', '同花顺', '五同', '三同花', '三顺子', '六对半', '五对三条', '四套三条', '凑一色', '三分天下', '三同花顺', '一条龙', '清龙'];
    var type = KQCard.cardsType(cards);
    return names[type];
};

// 找出牌的类型
KQCard.cardsType = function (cards) {
    if (KQCard.isQingLong(cards)) {
        return KQCard.TYPE.QingLong;
    }

    if (KQCard.isYiTiaoLong(cards)) {
        return KQCard.TYPE.YiTiaoLong;
    }

    //if (KQCard.isSanTongHuaShun(cards)) {
    //    return KQCard.TYPE.SanTongHuaShun;
    //}
    //
    //if (KQCard.isSanFenTianXia(cards)) {
    //    return KQCard.TYPE.SanFenTianXia;
    //}

    if (KQCard.isLiuDuiBan(cards)) {
        return KQCard.TYPE.LiuDuiBan;
    }

    if (KQCard.isSanTongHua(cards)) {
        return KQCard.TYPE.SanTaoHua;
    }

    if (KQCard.isSanShunZi(cards)) {
        return KQCard.TYPE.SanShunZi;
    }

    //if (KQCard.isCouYiSe(cards)) {
    //    return KQCard.TYPE.CouYiSe;
    //}
    //
    //if (KQCard.isWuDuiSanTiao(cards)) {
    //    return KQCard.TYPE.WuDuiSanTiao;
    //}
    //
    //if (KQCard.isSiTaoSanTiao(cards)) {
    //    return KQCard.TYPE.SiTaoSanTiao;
    //}

    /*#####*/
    if (KQCard.containWuTong(cards, 5)) {
        return KQCard.TYPE.WuTong;
    }

    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    //
    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    /*#####*/

    if (KQCard.containTongHuaShun(cards, 5)) {
        return KQCard.TYPE.TongHuaShun;
    }

    if (KQCard.containTieZhi(cards)) {
        return KQCard.TYPE.TieZhi;
    }

    if (KQCard.containHuLu(cards)) {
        return KQCard.TYPE.HuLu;
    }

    if (KQCard.containTongHua(cards)) {
        return KQCard.TYPE.TongHua;
    }

    if (KQCard.containShunZi(cards)) {
        return KQCard.TYPE.ShunZi;
    }

    if (KQCard.containSanTiao(cards)) {
        return KQCard.TYPE.SanTiao;
    }

    if (KQCard.containLiaDui(cards)) {
        return KQCard.TYPE.LiangDui;
    }

    if (KQCard.containDuiZi(cards)) {
        return KQCard.TYPE.DuiZi;
    }

    return KQCard.TYPE.WuLong;
};

// 判断是否是同花
KQCard.isTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    var colors = cards.map(function (card) {
        return card.color;
    });

    var color = colors[0];
    for (var index in colors) {
        var e = colors[index];
        if (e != color) {
            return false;
        }
    }
    return true;
};

// 是否包含同花
KQCard.containTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    //if (KQCard.findTongHua(cards).length > 0) {
    //    return true;
    //}
    //return false;
    cards = Array.from(cards);
    cards.sort(KQCard.sortByColor);

    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    minLength = minLength - card20.length;

    for (var start = 0; start + minLength <= cards.length; ++start) {
        var subCards = cards.slice(start, start + minLength);
        if (KQCard.isTongHua(subCards, minLength)) {
            return true;
        }
    }

    //return KQCard.containTongHua20(cards);
};
KQCard.containTongHua20 = function (card) {
    if (card.length < 5) {
        return false;
    }
    var card20 = KQCard.contain20(card);
    var cards = card.kq_excludes(card20);
    cards.sort(KQCard.sortByColor);

    for (var j = 1; j <= card20.length; ++j) {
        var num = 5 - j;
        for (var start = 0; start + num <= cards.length; ++start) {
            var subCards = cards.slice(start, start + num);
            if (KQCard.isTongHua(subCards, num)) {
                return true;
            }
        }
    }
    return false;
};
// 判断是否是顺子
KQCard.isShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    if (KQCard._isShunZiAKQ(cards)) {
        return true;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });

    var point = points[0];
    for (var index in points) {
        var e = points[index];
        if (e != point) {
            return false;
        }

        point = point + 1;
    }

    return true;
};

// 判断是否是 A K Q J 10 这个顺子
KQCard._isShunZiAKQ = function (cards) {
    var length = cards.length;
    if (length.length < 3) {
        return false;
    }

    var point1s = [1];
    var point14s = [14];
    var pointK = 13;

    Number(length - 1).kq_times(function (times) {
        point1s.push(pointK - times);
        point14s.push(pointK - times);
    });

    return KQCard._isCardsContainPoints(cards, point1s) || KQCard._isCardsContainPoints(cards, point14s);
};

// cards 中是否包含 points 这些点数

KQCard._isCardsContainPoints = function (cards, points) {
    var _loop = function (index) {
        var point = points[index];
        var pointCardIndex = cards.findIndex(function (card) {
            return card.point == point;
        });

        if (pointCardIndex < 0) {
            return {
                v: false
            };
        }
    };

    for (var index = 0; index < points.length; ++index) {
        var _ret = _loop(index);

        if (typeof _ret === 'object') return _ret.v;
    }

    return true;
};
KQCard.contain20 = function (cards) {
    if (cards.length <= 0) {
        return [];
    }
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var newCard = cards.filter(function (card) {
        //重新赋值cards
        if (card.point >= 20) {
            return card;
        }
    });
    return newCard || [];
};
// 是否包含顺子
KQCard.containShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findShunZi(cards).length > 0) {
        return true;
    }
    return false;
    //let uniqueCards = cards.unique(function(card1, card2) {
    //    return card1.point == card2.point;
    //});
    //uniqueCards.sort(KQCard.sortByPoint);
    //
    //let minPointCard = uniqueCards[0];
    //if (minPointCard.point == 1) {
    //    let APlusCard = new KQCard(minPointCard);
    //    APlusCard.point = 14;
    //    uniqueCards.push(APlusCard);
    //}
    //
    //for (var start = 0; (start + minLength) <= uniqueCards.length; ++start) {
    //    let subCards = uniqueCards.slice(start, start + minLength);
    //    if (KQCard.isShunZi(subCards, minLength)) {
    //        return true;
    //    }
    //}
    //
    //return KQCard.containShunZi20(cards);
};
/*KQCard.containShunZi20 = function (card) {
 if (card.length < 5) {
 return false;
 }
 var card20 = KQCard.contain20(card);
 var cards = card.kq_excludes(card20);
 // 先根据点数去重
 var newArr = [];
 var newArrs = [];
 for (var i = 0; i < cards.length; i++) {
 if (newArrs.indexOf(cards[i].point) == -1) {
 newArr.push(cards[i]);
 newArrs.push(cards[i].point);
 }
 }
 //newArr.forEach(function(card){
 //    if(card.scores == 14){
 //        card.scores = 1;
 //    }
 //})
 newArr.sort(function (n1, n2) {
 return n1.point - n2.point;
 });
 for(var j = 1;j <= card20.length;++j){
 var num = 5 - j;
 for (var start = 0; (start + num) <= newArr.length; ++start) {
 var subCards = newArr.slice(start, start + num);
 var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
 if(bool){
 return true;
 }
 }
 }
 // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
 let convertedCards = KQCard._convertOneToA1(card);
 if (card === convertedCards) {
 return false;
 }
 return KQCard.containShunZi20(convertedCards);
 };*/
// 是否是同花顺
KQCard.isTongHuaShun = function (cards) {
    return KQCard.isTongHua(cards) && KQCard.isShunZi(cards);
};

// 是否包含有同花顺
KQCard.containTongHuaShun = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findTongHuaShun(cards).length > 0) {
        return true;
    }
    return false;
    //var sanShunZi = KQCard.sanShunZi1(cards,minLength)[0];
    //if(sanShunZi == null){
    //    return false;
    //}
    //var result = false;
    //for(var i=0;i<sanShunZi.length;i++) {
    //    var s = sanShunZi[i];
    //    if (KQCard.isTongHuaShun(s, minLength)) {
    //        return true;
    //    }
    //}
    //return KQCard.containTongHuaShun1(cards);
};
/*KQCard.containTongHuaShun1 = function (cards, minLength = 5) {
 if (cards.length < minLength) {
 return false;
 }
 let tempCards = Array.from(cards).sort(KQCard.sortByColor);
 for (var start = 0; (start + minLength) <= tempCards.length; ++start) {
 let subCards = tempCards.slice(start, start + minLength);
 if (KQCard.isTongHuaShun(subCards, minLength)) {
 return true;
 }
 }

 let convertedCards = KQCard._convertOneToA1(cards);
 if (cards === convertedCards) {
 return KQCard.containTongHuaShun20(cards);
 }
 return KQCard.containTongHuaShun1(convertedCards);
 //return false;
 };
 KQCard.containTongHuaShun20 = function (card, minLength = 5) {
 if (card.length < minLength) {
 return false;
 }
 var card20 = KQCard.contain20(card) || [];
 var cards = card.kq_excludes(card20);

 cards = Array.from(cards);
 var colorS = []; //黑桃
 var colorH = []; //红心
 var colorC = []; //梅花
 var colorD = []; //方块
 var pointS = []; //黑桃
 var pointH = []; //红心
 var pointC = []; //梅花
 var pointD = []; //方块
 for(var i=0;i<cards.length;i++){
 if(cards[i].color == '4'){
 if(pointS.indexOf(cards[i].point) == -1){
 pointS.push(cards[i].point);
 colorS.push(cards[i]);
 }

 }else if(cards[i].color == '3'){
 if(pointH.indexOf(cards[i].point) == -1){
 pointH.push(cards[i].point);
 colorH.push(cards[i]);
 }
 }else if(cards[i].color == '2'){
 if(pointC.indexOf(cards[i].point) == -1){
 pointC.push(cards[i].point);
 colorC.push(cards[i]);
 }
 }else if(cards[i].color == '1'){
 if(pointD.indexOf(cards[i].point) == -1){
 pointD.push(cards[i].point);
 colorD.push(cards[i]);
 }
 }
 }

 var color = [colorS,colorH,colorC,colorD];
 var colorSum = [];    //总共有几种花色 [5,3,0....]
 for(var i=0;i<color.length;i++){
 if(color[i].length >= parseInt(5 - card20.length)){
 //color[i].forEach(function(ca){
 //    if(ca.scores == 14){
 //        ca.scores = 1;
 //    }
 //})
 color[i].sort(function(a1,a2){
 return a1 - a2;
 })
 colorSum.push(color[i]);
 }
 }

 for(var i=0;i<colorSum.length;i++) {
 var s = colorSum[i]
 for(var j = 1;j <= card20.length;++j){
 var num = 5 - j;
 for (var start = 0; (start + num) <= s.length; ++start) {
 var subCards = s.slice(start, start + num);
 var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
 if(bool){
 return true;
 }
 }
 }
 }



 let convertedCards = KQCard._convertOneToA1(card);
 if (card === convertedCards) {
 return false;
 }
 return KQCard.containTongHuaShun20(convertedCards);
 };*/

// 是否是清龙
KQCard.isQingLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    /**
     *
     */
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
        }
    }
    if (colorSum.length == 1) {
        if (colorSum[0] == 13) {

            if (KQCard.isYiTiaoLong(cards)) {

                var teShuCard = cards.filter(function (i) {
                    return i;
                });

                teShuCard = KQCard.cardsFromArray(teShuCard);

                teShuCard.forEach(function (a) {
                    if (a.scores == 1) a.scores = 14;
                });

                teShuCard.sort(function (a, b) {
                    return b.scores - a.scores;
                });

                teShuCard = KQCard.convertToServerCards(teShuCard);

                var a1 = teShuCard.splice(0, 5);

                var a2 = teShuCard.splice(0, 5);

                cc.teShuPaiCards = [teShuCard, a2, a1];

                return true;
            }
        }
    }
    //return KQCard.isTongHuaShun(cards);
    return false;
};

// 是否是一条龙
KQCard.isLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }

    return KQCard.isShunZi(cards);
};

/*#####*/
/*是否一条龙*/
KQCard.isYiTiaoLong = function (cards) {
    //cards:{number:1~13 ,'suit':'h'...}
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].number == 'undefined') {
        cards = KQCard.convertToServerCards(cards);
    }
    var number = cards.map(function (card) {
        return card.number;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });
    for (var i = 0; i < cards.length - 1; i++) {
        if (number[i] != number[i + 1] - 1) {
            return false;
        }
    }

    var teShuCard = cards.filter(function (i) {
        return i;
    });

    teShuCard = KQCard.cardsFromArray(teShuCard);

    teShuCard.forEach(function (a) {
        if (a.scores == 1) a.scores = 14;
    });

    teShuCard.sort(function (a, b) {
        return b.scores - a.scores;
    });

    teShuCard = KQCard.convertToServerCards(teShuCard);

    var a1 = teShuCard.splice(0, 5);

    var a2 = teShuCard.splice(0, 5);

    cc.teShuPaiCards = [teShuCard, a2, a1];
    //cc.log(cc.teShuPaiCards )
    //cc.log('--------728')
    return true;
};
/*#####*/
/*是否三同花*/
KQCard.isSanTongHua = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == "undefined") {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var sanCard = [colorS, colorH, colorC, colorD];
    var teShuCard = [];
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
            teShuCard.push(sanCard[i]);
        }
    }

    //三种花色
    if (colorSum.length == 3) {
        for (var i = 0; i < colorSum.length; i++) {
            if (colorSum[i] != 5 && colorSum[i] != 3) {
                return false;
            }
        }
        teShuCard.sort(function (a, b) {
            return a.length - b.length;
        });
        cc.teShuPaiCards = teShuCard;
        return true;
    }
    return false;
};
/*是否凑一色*/
KQCard.isCouYiSe = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's' || cards[i].suit == 'c') {
            colorS.push(cards[i]); //全黑
        } else if (cards[i].suit == 'h' || cards[i].suit == 'd') {
                colorH.push(cards[i]); //全红
            }
    }

    //如果牌中包含四种花色就不可能是三同花
    if (colorS.length == 13 || colorH.length == 13) {
        return true;
    }
    //else if(colorH.length == 13){
    //    return true;
    //}
    return false;
};
/*#####*/
// 是否是六对半
KQCard.isLiuDuiBan = function (cards) {
    var length = 12;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfYi = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength || value == 3) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value == 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        }
        //else if (value == 6 || value == 7 || value == 5) {
        //    numberOfDuiZi = numberOfDuiZi + 0;
        //}
        else if (value == 1) {
                numberOfYi += 1;
            }
    }

    if (numberOfDuiZi == 6) {

        var teShuCard = cards.filter(function (i) {
            return i;
        });

        teShuCard = KQCard.cardsFromArray(teShuCard);

        teShuCard.forEach(function (a) {
            if (a.scores == 1) a.scores = 14;
        });

        teShuCard.sort(function (a, b) {
            return b.scores - a.scores;
        });

        teShuCard = KQCard.convertToServerCards(teShuCard);

        var a1 = teShuCard.splice(0, 5);

        var a2 = teShuCard.splice(0, 5);

        cc.teShuPaiCards = [teShuCard, a2, a1];

        return true;
    }
    return false;
};

KQCard.isWuDuiSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    var sanTiaoLength = 3;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfSanTiao = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        } else if (value >= 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        }
    }
    return numberOfDuiZi == 5 && numberOfSanTiao == 1;
};

//判断5张或者3张是否顺子
KQCard.isShunZi1 = function (arr) {
    //console.log(arr);
    for (var i = 0; i < arr.length - 1; i++) {
        if (arr[i + 1] - arr[i] != 1) {
            //不是顺子
            //console.log("不是顺子");
            return false;
        }
    }
    return true;
};

KQCard.isSanShunZi = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }

    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }

    //取出牌的点数
    var number = cards.map(function (card) {
        return card.number;
    });
    //排序
    number.sort(function (n1, n2) {
        return n1 - n2;
    });
    if (KQCard.fenZhu(number, 5, 5) == false) {
        var number = cards.map(function (card) {
            return card.number;
        });
        //排序
        number.sort(function (n1, n2) {
            return n1 - n2;
        });
        if (KQCard.fenZhu(number, 5, 3) == false) {
            var number = cards.map(function (card) {
                return card.number;
            });
            //排序
            number.sort(function (n1, n2) {
                return n1 - n2;
            });
            if (KQCard.fenZhu(number, 3, 5) == false) {
                //不是三顺子
                var AIsExist = false; //是否存在A
                for (var i in cards) {
                    if (cards[i].number == 1) {
                        AIsExist = true;
                        //console.log("存在A");
                        break;
                    }
                }
                if (!AIsExist) {
                    //console.log("退出递归");
                    return false;
                }

                for (var i in cards) {
                    if (cards[i].number == 1) {
                        //console.log("A转为14");
                        cards[i].number = 14;
                        break;
                    }
                }
                if (cc.teShuPaiCards && cc.teShuPaiCards.length > 0 && cc.teShuPaiCards[0][0] && typeof cc.teShuPaiCards[0][0] == 'number') {
                    var newCards = cards.filter(function (i) {
                        return i;
                    });
                    var newCards1 = cc.teShuPaiCards.map(function (arr) {
                        var cad = arr.map(function (number) {
                            for (var i = 0; i < newCards.length; i++) {
                                if (newCards[i].number == number) {
                                    return newCards.splice(i, 1)[0];
                                    break;
                                }
                            }
                        });
                        return cad;
                    });
                    cc.teShuPaiCards = newCards1;
                }
                return KQCard.isSanShunZi(cards);
            }
        }
    }
    if (cc.teShuPaiCards && cc.teShuPaiCards.length > 0 && cc.teShuPaiCards[0][0] && typeof cc.teShuPaiCards[0][0] == 'number') {
        var newCards = cards.filter(function (i) {
            return i;
        });
        var newCards1 = cc.teShuPaiCards.map(function (arr) {
            var cad = arr.map(function (number) {
                for (var i = 0; i < newCards.length; i++) {
                    if (newCards[i].number == number) {
                        return newCards.splice(i, 1)[0];
                        break;
                    }
                }
            });
            return cad;
        });
        cc.teShuPaiCards = newCards1;
    }
    return true;
};

//分组553||535||355
KQCard.fenZhu = function (number, num1, num2) {
    var arr1 = [];
    var arr2 = [];
    var arr3 = [];
    for (var i = 0; i < number.length - 1; i++) {
        if (i == 0) {
            arr1.push(number[0]);
        }
        if (number[i + 1] - number[i] == 0) {
            continue;
        }
        arr1.push(number[i + 1]);
        if (arr1.length == num1) {
            //取第一组是顺子
            if (KQCard.isShunZi1(arr1)) {
                //这5个是顺子,从数组中移除
                for (var i = 0; i < arr1.length; i++) {
                    for (var j = 0; j < number.length; j++) {
                        if (number[j] == arr1[i]) {
                            //两个数一样的只删除一个
                            if (number[j] == number[j + 1]) {
                                continue;
                            }
                            number.splice(j, 1); //从number中移除
                        }
                    }
                }
                /*console.log("删除第一组后的number");
                 console.log(number);*/
                //接下来取第二组
                for (var i = 0; i < number.length - 1; i++) {
                    if (i == 0) {
                        arr2.push(number[0]);
                    }
                    if (number[i + 1] - number[i] == 0) {
                        continue;
                    }
                    arr2.push(number[i + 1]);
                    if (arr2.length == num2) {
                        //取第二组是顺子
                        if (KQCard.isShunZi1(arr2)) {
                            for (var i = 0; i < arr2.length; i++) {
                                for (var j = 0; j < number.length; j++) {
                                    if (number[j] == arr2[i]) {
                                        //两个数一样的只删除一个
                                        if (number[j] == number[j + 1]) {
                                            continue;
                                        }
                                        number.splice(j, 1); //从number中移除
                                    }
                                }
                            }
                            /*console.log("删除第二组后的number");
                             console.log(number);*/
                            arr3 = number;
                            //接下来就是剩下的了
                            if (KQCard.isShunZi1(arr3)) {
                                //第三组也是顺子
                                var asdf = [arr1, arr2, arr3];

                                asdf.sort(function (n1, n2) {
                                    return n1.length - n2.length;
                                });

                                if (!cc.teShuPaiCards) cc.teShuPaiCards = asdf;

                                return true;
                            }
                            //第三组不是顺子
                            return false;
                        }
                        //第二组不是顺子
                        return false;
                    }
                }
            }
            //第一组不是顺子
            return false;
        }
    }
    //如果取不到num1个数
    if (arr1.length < num1) {
        return false;
    }
    if (arr2.length < num2) {
        return false;
    }
};

KQCard.isSanShunZi1 = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }

    cards = Array.from(cards);
    cards.sort(KQCard.sortByPoint);
    var wei = [];
    var zhong = [];
    var tou = [];
    var sanShunZi = KQCard.sanShunZi1(cards)[0]; //获取所有组合的头道
    if (!sanShunZi) {
        //你连头道都没有 怎么更我混
        return false;
    }

    var newCard = cards.filter(function (i) {
        //重新赋值cards
        return i;
    });
    var newCards1 = [];
    var newPoint = []; //判断point是否相同
    var duiZi = []; //取出有对子当中的一张牌
    for (var s in cards) {
        if (newPoint.indexOf(cards[s].point) < 0) {
            newCards1.push(cards[s]);
            newPoint.push(cards[s].point);
        } else {
            //取出有对子当中的一张牌
            duiZi.push(cards[s]);
        }
    }

    for (var j = 0; j < sanShunZi.length; ++j) {
        //循环所有头道
        var number3 = sanShunZi[j];
        if (typeof number3 == 'undefined') {
            continue;
        }
        for (var i = 0; i < cards.length; ++i) {
            var newCards = newCards1.filter(function (i) {
                //重新赋值cards
                return i;
            });

            newCards = newCards.kq_excludes(number3); //删除牌里的头道
            if (wei.length != 5) {
                var subCards = newCards.slice(i, i + 5);
                if (subCards.length == 5 || KQCard.isShunZi(subCards)) {
                    //得到尾道 删除牌里的尾道
                    wei = subCards;
                    // cc.log(number3)
                    // cc.log(newCards1)
                    // cc.log(subCards)
                    // cc.log(newCards)
                    // cc.log(i)
                    // cc.log('-----716')
                    newCards = newCards.kq_excludes(subCards);
                }
            }

            if (wei.length == 5) {
                //把剩余的牌和对子的单张合并
                var tasks = duiZi.filter(function (i) {
                    //重新赋值对子
                    return i;
                });
                tasks = tasks.kq_excludes(number3); //判断头道和对子的单张是否有相同 有的话就删除
                newCards = newCards.concat(tasks); //把剩余的牌和对子的单张合并
            }

            if (zhong.length != 5 && newCards.length == 5) {
                if (KQCard.isShunZi(newCards)) {
                    //是三顺子
                    zhong = newCards;
                }
            }
            if (wei.length == 5 && zhong.length == 5) {
                //是三顺子终止循环
                break;
            } else {
                //来吧 继续吧
                zhong = [];wei = [];tou = [];
            }
        }
        if (wei.length == 5 && zhong.length == 5) {
            //是三顺子终止循环
            tou = number3;
            break;
        } else {
            //来吧 继续吧
            zhong = [];wei = [];tou = [];
        }
    }

    cards = newCard;
    if (KQCard._isSanShunZi(tou, zhong, wei)) {
        //是三顺子
        tou = KQCard.convertToServerCards(tou);
        zhong = KQCard.convertToServerCards(zhong);
        wei = KQCard.convertToServerCards(wei);

        if (!cc.teShuPaiCards) cc.teShuPaiCards = [tou, zhong, wei];
        return true;
    }
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
        cards.forEach(function (a) {
            if (a.point == 14) a.point = 1;
        });
        //return false;
        return KQCard.isSanShunZi1(cards);
    }
    return KQCard.isSanShunZi(convertedCards);
};

KQCard.sanShunZi1 = function (cards) {
    var length = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    var shunzi = KQCard.findShunZi(cards, length);
    var cardsT = [];
    var cardsIndex = [];
    if (shunzi == null) {
        return false;
    }
    for (var i = 0; i < shunzi.length; i++) {
        var a = shunzi[i];
        var cardsShunzi = [];
        // var cardsIndex = [];
        for (var j = 0; j < a.length; j++) {
            var index = a[j];
            if (typeof cards[index] == 'undefined') {
                continue;
            }
            cardsShunzi.push(cards[index]);
        }
        cardsIndex.push(a);
        cardsT.push(cardsShunzi);
    }
    return [cardsT, cardsIndex];
};

KQCard._isSanShunZi = function (touCards, zhongCards, weiCards) {
    return KQCard.isShunZi(touCards) && KQCard.isShunZi(zhongCards) && KQCard.isShunZi(weiCards);
};
// 是否是三同花顺
KQCard.isSanTongHuaShun = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorCardsObject = KQCard._colorClassCards(cards);

    var subCards = [];
    for (var prop in colorCardsObject) {
        var _cards = colorCardsObject[prop];
        subCards.push(_cards);
    }

    if (subCards.length != 3) {
        return false;
    }

    subCards = subCards.sort(function (s1, s2) {
        return s1.length > s2.length;
    });

    var touCards = subCards[0];
    var zhongCards = subCards[1];
    var weiCards = subCards[2];

    if (touCards.length != 3 || zhongCards.length != 5 || weiCards.length != 5) {
        return false;
    }

    return KQCard._isSanTongHuaShun(touCards, zhongCards, weiCards);
};

// 将牌根据 color 进行分类
KQCard._colorClassCards = function (cards) {
    var colorCardsObject = {};
    cards.forEach(function (card) {
        var color = card.color;
        var subCards = colorCardsObject[color];
        if (!subCards) {
            subCards = [];
            colorCardsObject[color] = subCards;
        }
        subCards.push(card);
    });

    return colorCardsObject;
};

// 是否是三同花顺
KQCard._isSanTongHuaShun = function (touCards, zhongCards, weiCards) {
    return KQCard.isTongHuaShun(touCards) && KQCard.isTongHuaShun(zhongCards) && KQCard.isTongHuaShun(weiCards);
};

// 是否是 “三分天下”
KQCard.isSanFenTianXia = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var tieZhiLength = 4;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfTieZhi = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == tieZhiLength) {
            numberOfTieZhi = numberOfTieZhi + 1;
        }
    }
    return numberOfTieZhi === 3;
};

// 是否是 “四套三条”
KQCard.isSiTaoSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var sanTiaoLength = 3;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfSanTiao = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        }
    }

    return numberOfSanTiao == 4;
};

// 是否是 “三桃花”
// 头、中、尾道为相同花色的牌
KQCard.isSanTaoHua = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorHelper = new KQCardColorsHelper(cards);
    var colorNumbers = [];
    for (var prop in colorHelper.colorNumber) {
        colorNumbers.push(colorHelper.colorNumber[prop]);
    }

    colorNumbers.sort(function (n1, n2) {
        return n1 - n2;
    });

    if (colorNumbers.length != 3) {
        return false;
    }

    if (colorNumbers[0] == 3 && colorNumbers[1] == 5 && colorNumbers[2] == 5) {
        return true;
    }

    return false;
};

// 判断是否包含铁支
// 四张同样点数的牌
KQCard.containTieZhi = function (cards) {
    var length = 4;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var helper = new KQCardPointsHelper(cards);

    for (var w in helper.pointNumbers) {
        var maxNumber = helper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}
    // else{
    //    return KQCard.containGuiPai(cards,4);
    //}
    //if (KQCard.findTieZhi(cards).length > 0) {
    //    return true;
    //}
    return false;
};

// 判断是否是铁支
KQCard.isTieZhi = function (cards) {
    var length = 4;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};

/*#####是否包含五同*/
//五张同样点数的牌
KQCard.containWuTong = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    //五张牌相同的
    var helper = new KQCardPointsHelper(cards);
    //for(var w in helper.pointNumbers) {
    //    cc.log(w)
    //}
    //cc.log(cards)
    //cc.log(helper)
    //cc.log(card20)
    //cc.log(helper.maxNumber())
    //cc.log('------1307')
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}
    for (var w in helper.pointNumbers) {
        var maxNumber = helper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return helper.maxNumber() >= length;
        }
    }
    return false;
};

/*判断是否五同*/
KQCard.isWuTong = function (cards) {
    var length = 5;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};
/*#####*/

// 是否是 “葫芦”
// 三张相同 + 一对
KQCard.containHuLu = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    if (KQCard.findHuLu(cards).length > 0) {
        return true;
    }
    //let pointHelper = new KQCardPointsHelper(cards);
    //var pointNumbers = [];
    //var index = 0;
    //for (let prop in pointHelper.pointNumbers) {
    //    pointNumbers[index] = pointHelper.pointNumbers[prop];
    //    index = index + 1;
    //}
    //var h=[];
    //var h1=[];
    //for(var i in pointNumbers){
    //    var s=pointNumbers[i];
    //    if(s == 3){
    //        h.push(s)
    //    }
    //    else if(s==4){
    //        h1.push(s)
    //    }
    //
    //}
    //
    //if ((pointNumbers.indexOf(3) != -1) && (pointNumbers.indexOf(2) != -1)
    // || h.length > 1 || h1.length > 1 ||(pointNumbers.indexOf(4) != -1)
    // && (pointNumbers.indexOf(2) != -1)) {
    //    return true;
    //}

    return false;
};

// 判断是否是 葫芦
KQCard.isHuLu = function (cards) {
    if (cards.length != 5) {
        return false;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (p1, p2) {
        return p1 - p2;
    });

    var p1 = points[0];
    var p2 = p1;
    var numberP1 = 0;
    var numberP2 = 0;

    points.forEach(function (point) {
        if (point != p1 && point != p2) {
            p2 = point;
            numberP2 = 0;
        }

        numberP1 = numberP1 + (point == p1 ? 1 : 0);
        numberP2 = numberP2 + (point == p2 ? 1 : 0);
    });

    var maxNumber = Math.max(numberP1);
    var minNumber = Math.min(numberP2);

    return minNumber == 2 && maxNumber == 3;
};

// 是否包含有 “三条”
KQCard.containSanTiao = function (cards) {
    var length = 3;
    if (cards.length < length) {
        return false;
    }
    //if (KQCard.findSanTiao(cards).length > 0) {
    //    return true;
    //}
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var pointHelper = new KQCardPointsHelper(cards);
    for (var w in pointHelper.pointNumbers) {
        var maxNumber = pointHelper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] >= length) {
    //        return true;
    //    }
    //}
    return false;

    //
    //return KQCard.containGuiPai(cards,3);
};

// 是否是 “三条”
KQCard.isSanTiao = function (cards) {
    if (cards.length != 3) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (card.point == point) {
            return point;
        }

        return -1;
    }, cards[0].point);

    return result != -1;
};

// 是否包含有 ：两对
KQCard.containLiaDui = function (cards) {
    if (cards.length < 4) {
        return false;
    }
    if (KQCard.findLiaDui(cards).length > 0) {
        return true;
    }
    //var numberOfDuiZi = 0;
    //let pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] == 2) {
    //        numberOfDuiZi = numberOfDuiZi + 1;
    //        if (numberOfDuiZi == 2) {
    //            return true;
    //        }
    //    }
    //}

    return false;
};

// 是否是 两对
KQCard.isLiaDui = function (cards) {
    if (cards.length != 4) {
        return false;
    }

    var pointHelper = new KQCardPointsHelper(cards);
    for (var prop in pointHelper.pointNumbers) {
        if (pointHelper.pointNumbers[prop] != 2) {
            return false;
        }
    }
    return true;
};

// 是不是对子
KQCard.isDuiZi = function (cards) {
    if (cards.length != 2) {
        return false;
    }

    var card1 = cards[0];
    var card2 = cards[1];

    return card1.point == card2.point;
};

// 是否包含对子
KQCard.containDuiZi = function (cards) {
    var length = 2;
    if (cards.length < length) {
        return false;
    }
    //if (KQCard.findDuiZi(cards).length > 0) {
    //    return true;
    //}
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    length = length - card20.length;
    var pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] >= length) {
    //        return true;
    //    }
    //}
    for (var w in pointHelper.pointNumbers) {
        var maxNumber = pointHelper.pointNumbers[w];
        if (maxNumber >= length) {
            card20.forEach(function (ca) {
                ca.scores = parseInt(w);
            });
            return true;
        }
    }
    return false;
    //return KQCard.containGuiPai(cards,2);
};

KQCard.containGuiPai = function (cards, length) {
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    var helper = new KQCardPointsHelper(cards);
    var maxNumber = helper.maxNumber() + card20.length;
    return maxNumber >= length;
};
/*#####*/
// 是否是特殊牌
KQCard.isTeShuPai = function (cards) {
    if (cards.length < 13) {
        return false;
    }

    return KQCard.isQingLong(cards) || KQCard.isYiTiaoLong(cards) || KQCard.isLiuDuiBan(cards) || KQCard.isSanShunZi(cards) || KQCard.isSanTongHua(cards)
    /*|| KQCard.isSanTongHuaShun(cards)
     || KQCard.isSanFenTianXia(cards)
     || KQCard.isSiTaoSanTiao(cards)
       || KQCard.isWuDuiSanTiao(cards)
     || KQCard.isCouYiSe(cards)*/;
};

// 将牌中的 1 变化为 A（14)
KQCard._convertOneToA = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var result = cards.map(function (card) {
        if (card.point == 1) {
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

KQCard._convertOneToA1 = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var num = 0;
    var result = cards.map(function (card) {
        if (card.point == 1 && num == 0) {
            num++;
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

// KQCard 的排序方法
KQCard.sortByPoint = function (card1, card2) {
    var result = Number(card1.point) - Number(card2.point);
    return result;
};

KQCard.sortByColor = function (card1, card2) {
    var pointAsc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (card2.color == card1.color) {
        return (card1.point - card2.point) * (pointAsc ? 1 : -1);
    }
    return card2.color - card1.color;
};

KQCard.sort = function (card1, card2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];
    var AisMax = arguments.length <= 3 || arguments[3] === undefined ? true : arguments[3];

    var result = 1;
    if (card1.point == card2.point) {
        result = card1.color - card2.color;
    } else {
        var point1 = card1.point;
        var point2 = card2.point;
        if (AisMax && point1 == 1) {
            point1 = 14;
        }

        if (AisMax && point2 == 1) {
            point2 = 14;
        }

        result = point1 - point2;
    }

    return result * (asc ? 1 : -1);
};

//转为客户端的牌
KQCard._convertCardsToCardNames = function (cards) {
    // [{"suit":"s","number":10}]
    var suitColorMap = ['', 'd', 'c', 'h', 's'];
    return cards.map(function (card) {
        var cardNumber = card.point;
        var color = suitColorMap[card.color];
        var number = Math.max(Math.min(cardNumber, 13), 1);
        return { number: number, suit: color };
    });
};

cc._RFpop();
},{"GetCardPointsSameCount":"GetCardPointsSameCount","KQCardColorsHelper":"KQCardColorsHelper","KQCardPointsHelper":"KQCardPointsHelper","NumberExtension":"NumberExtension"}],"KQGlabolSocketEventHander":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'babea3CWj9G1pWM9AkXao0n', 'KQGlabolSocketEventHander');
// scripts\Socket\KQGlabolSocketEventHander.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var KQGlabolSocketEventHander = {
    start: function start() {
        if (this._didStart) {
            return;
        }
        this._didStart = true;

        KQGlobalEvent.on(Socket.Event.ReceiveForceExit, this._forceExitApp, this);
    },

    _forceExitApp: function _forceExitApp(response) {
        KQNativeInvoke.forceExitApp();
    }
};

module.exports = KQGlabolSocketEventHander;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","socket":"socket"}],"KQGlobalEvent":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd90d6OrggVEXa29ffA+vZY0', 'KQGlobalEvent');
// scripts\Event\KQGlobalEvent.js

var KQGlobalEvent = {
    _handles: {},
    //发送事件
    emit: function emit(eventName) {
        var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

        if (typeof data == 'string') {
            data = { 'data': data };
        }

        var returns = []; //返回值
        data.eventName = eventName; //保存一下事件名字

        for (var findEvenName in this._handles) {
            if (findEvenName == eventName) {
                for (var i = 0; i < this._handles[findEvenName].length; i++) {
                    var returnValue = this._handles[findEvenName][i](data);
                    returns.push(returnValue);
                }
            }
        }

        return returns;
    },
    //添加普通事件
    on: function on(eventName, callback, target) {
        // console.log('收到事件', eventName);
        this._handles[eventName] = this._handles[eventName] || [];

        this._handles[eventName].push(callback.bind(target));
        callback._caller = target;
    },

    //通过事件名移除一个监听器
    off: function off(eventName) {
        for (var i = 0; i < this._handles[eventName].length; i++) {
            this._handles[eventName][i] = null;
        }
    },

    // 移动一个 target 上所有的监听
    offTarget: function offTarget(target) {
        for (var name in this._handles) {
            var eventHandlers = this._handles[name];
            var indexs = eventHandlers.filter(function (callback) {
                return callback._caller = target;
            }).map(function (callback, index) {
                return index;
            });

            var indexOffset = 0;
            indexs.forEach(function (index) {
                eventHandlers.splice(index + indexOffset, 1);
                indexOffset = indexOffset + 1;
            });
        }
    }
};

module.exports = KQGlobalEvent;

cc._RFpop();
},{}],"KQNativeInvoke":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7327dLBqWVNaJ14fJQ4jq6Y', 'KQNativeInvoke');
// scripts\Utils\KQNativeInvoke.js

var KQNativeInvoke = {
  IOSClassName: "AppController",
  ANDRIODClassName: "com/gongpa/ssz/AppActivity",

  isNativeIOS: function isNativeIOS() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.IPHONE || platform == cc.sys.IPAD) {
      return true;
    }
    return false;
  },

  isNativeAndroid: function isNativeAndroid() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.ANDROID) {
      return true;
    }
    return false;
  },

  isNative: function isNative() {
    return cc.sys.isNative == true;
  }
};

// MARK: 可调用的本地方法
/**
 * 微信登录
 */
KQNativeInvoke.wxLogin = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
  } else if (KQNativeInvoke.isNativeAndroid()) {
      //Android
      jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
    }
};

/**
 * 分享大厅信息到微信好友
 * 
 */
KQNativeInvoke.shareHallToWeChatFriend = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallFriend", "()V");
  }
};

/**
 * 分享大厅信息到朋友圈
 * 
 */
KQNativeInvoke.shareHallToWeChatTimeline = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", "()V");
  }
};

/**
 * 强制退出 APP
 * 
 */
KQNativeInvoke.forceExitApp = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
  }
};

/**
 * 下载新版本
 * 
 * @param {String} iosUrl      iOS 版本地址
 * @param {String} androidUrl  安卓版本地址
 */
KQNativeInvoke.downloadNewVersion = function (iosUrl, androidUrl) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", iosUrl);
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", androidUrl);
  }
};

/**
 * 分享房间给微信好友
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatFriend = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V", id, description, title);
  }
};

/**
 * 分享房间到微信朋友圈
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatTimeline = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShare:description:", id, description, title);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShare", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V", id, description, title);
  }
};

/**
 * 分享屏幕截图到微信好友
 */
KQNativeInvoke.shareScreenToWeChatFriend = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShareFriend", "()V");
  }
};

/**
 * 分享屏幕截图到微信朋友圈
 */
KQNativeInvoke.shareScreenToWeChatTimeline = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
  }
};

/**
 * 开始录音
 */
KQNativeInvoke.startRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
  }
};

/**
 * 结束录音
 */
KQNativeInvoke.endRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
  }
};

KQNativeInvoke.screenshotShare = function () {
  var strings = arguments.length <= 0 || arguments[0] === undefined ? 'shareIMG' : arguments[0];

  if (this._isCapturing) {
    return;
  }
  this._isCapturing = true;
  var size = cc.director.getWinSize();
  var fileName = "result_share.jpg";
  var fullPath = jsb.fileUtils.getWritablePath() + fileName;
  if (jsb.fileUtils.isFileExist(fullPath)) {
    jsb.fileUtils.removeFile(fullPath);
  }
  var texture = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height), cc.IMAGE_FORMAT_PNG, gl.DEPTH24_STENCIL8_OES);
  texture.setPosition(cc.p(size.width / 2, size.height / 2));
  texture.begin();
  cc.director.getRunningScene().visit();
  texture.end();
  texture.saveToFile(fileName, cc.IMAGE_FORMAT_PNG);

  var self = this;
  var tryTimes = 0;
  var fn = function fn() {
    if (jsb.fileUtils.isFileExist(fullPath)) {

      if (cc.sys.os == cc.sys.OS_ANDROID) {
        jsb.reflection.callStaticMethod(self.ANDRIODClassName, strings, "(Ljava/lang/String;)V", fullPath);
      }
      self._isCapturing = false;
    } else {
      tryTimes++;
      if (tryTimes > 10) {
        console.log("time out...");
        return;
      }
      setTimeout(fn, 50);
    }
  };
  setTimeout(fn, 50);
};

/**
 * 播放网络语音
 * 
 * @param {String} audioUrl 语音地址
 */
KQNativeInvoke.playAudioWithUrl = function (audioUrl) {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", audioUrl);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", audioUrl);
  }
};

module.exports = KQNativeInvoke;

cc._RFpop();
},{}],"MsgControl":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd242dsY+hBG5LpL7ZF7Kn6', 'MsgControl');
// scripts\Chat\MsgControl.js

var Socket = require('socket');
var ChatMessage = require('ChatMessage');
var AudioManager = require('AudioManager');

// 用来发送消息的 component
cc.Class({
    'extends': cc.Component,

    properties: {
        //bqNode:cc.Node,
        //bqNode1:cc.Node,
        //btnLanguageNode:cc.Node,
        //btnLanguageNode1:cc.Node,
        //btnChartNode:cc.Node,
        //btnChartNode1:cc.Node,
        textScrollView: cc.Node,
        imageContentNode: cc.Node,

        editBox: cc.EditBox,

        textRecordScrollView: cc.ScrollView,
        textRecordLayout: cc.Layout,

        textPrefab: cc.Prefab,
        chatTextRecordPrefab: cc.Prefab,
        emojiPrefab: cc.Prefab,
        // imagePrefab:cc.Prefab,

        biaoqing: [cc.Node], // [亮的背景, 暗的背景]   快捷语
        kuaijieyu: [cc.Node], // [亮的背景, 暗的背景]   表情
        content: [cc.Node], // [快捷语, 表情]  
        inputNode: cc.Node,
        emoji: [cc.Node],
        _userId: null,

        _playerInfos: null, // 记录用户信息
        _chatTextMessageRecords: null },

    // 聊天文本消息记录
    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        this._playerInfos = [];
        this.textContent = this.textScrollView.getComponent(cc.ScrollView).content;
        // this.imageContent = this.imageScrollView.getComponent(cc.ScrollView).content;
        var self = this;
        var textData = AudioManager.instance.chatTexts();
        for (var i = 0; i < textData.length; i++) {
            var item = cc.instantiate(this.textPrefab);
            item.getComponent('cellText').setText(textData[i]);
            item.getComponent('cellText').onSelectAction = function (text) {
                self.onTextClickAction(text);
            };
            this.textContent.h = 1000;
            this.textContent.addChild(item);
        }
    },

    clickKuaiJieYu: function clickKuaiJieYu() {
        this.kuaijieyu[0].active = true; // 快捷语 背景
        this.kuaijieyu[1].active = false; // 快捷语 按钮
        this.biaoqing[0].active = false; // 背景表情
        this.biaoqing[1].active = true; // 表情按钮
        this.content[0].active = true;
        this.content[1].active = false;
    },
    clickBiaoQing: function clickBiaoQing() {
        this.biaoqing[0].active = true; // 背景表情
        this.biaoqing[1].active = false; // 表情按钮
        this.kuaijieyu[0].active = false; // 快捷语 背景
        this.kuaijieyu[1].active = true; // 快捷语 按钮
        this.content[0].active = false;
        this.content[1].active = true;
    },
    onTextClickAction: function onTextClickAction() {
        var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        this.editBox.string = "";
        this.sendText(text);
    },

    clickEmoji: function clickEmoji(event, emojiName) {
        var string = this.editBox.string;
        this.editBox.string = string + "<" + emojiName + ">";
        this.sendEmoji(emojiName);
    },

    clickSend: function clickSend() {
        var string = this.editBox.string || "";
        if (string.length == 0) {
            return;
        }
        this.editBox.string = "";
        this.sendText(string);
    },

    sendEmoji: function sendEmoji(emojiName) {
        if (emojiName.length == 0) {
            return;
        }
        Socket.sendEmoji(this._userId, emojiName);
        this.dismiss();
    },

    sendText: function sendText() {
        var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        if (text.length == 0) {
            return;
        }
        Socket.sendText(this._userId, text);
        this.dismiss();
    },

    dismiss: function dismiss() {
        this.node.active = false;
    },

    bqAction: function bqAction() {
        this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode1.active = true;
        this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode.active = false;
        this.textScrollView.active = false;
        this.imageContentNode.active = true;
        this.textRecordScrollView.node.active = false;
    },

    textAction: function textAction() {
        this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode.active = false;
        this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode1.active = true;
        this.textScrollView.active = true;
        this.imageContentNode.active = false;
        this.textRecordScrollView.node.active = false;
    },

    chartAction: function chartAction() {
        this.bqNode1.active = this.btnLanguageNode1.active = this.btnChartNode1.active = false;
        this.bqNode.active = this.btnLanguageNode.active = this.btnChartNode.active = true;
        this.textScrollView.active = this.imageContentNode.active = false;
        this.textRecordScrollView.node.active = true;
    },

    addPlayerInfos: function addPlayerInfos(playerInfos) {
        this._playerInfos = this._playerInfos || [];

        playerInfos.forEach((function (userInfo) {
            var haveUserInfo = this._playerInfos.find(function (ownUserInfo) {
                return ownUserInfo.id == userInfo.id;
            });

            if (haveUserInfo == null) {
                this._playerInfos.push(userInfo);
            }
        }).bind(this));
    },

    addChatTextMessage: function addChatTextMessage(userId, text) {
        this._playerInfos = this._playerInfos || [];

        var nickname = "[ID:" + userId + "说]：";
        var userInfo = this._playerInfos.find(function (userInfo) {
            return userInfo.id == userId;
        });

        if (userInfo) {
            nickname = "[" + userInfo.nickname + "说]：";
        }

        var str = nickname + text;
        str = ChatMessage.parseString(str);
        this._addChatTextToRecord(str);
    },

    addChatEmojiMessage: function addChatEmojiMessage(userId, emoji) {
        this._playerInfos = this._playerInfos || [];

        var nickname = "[ID:" + userId + "说]：";
        var userInfo = this._playerInfos.find(function (userInfo) {
            return userInfo.id == userId;
        });
        if (userInfo) {
            nickname = "[" + userInfo.nickname + "说]：";
        };
        var str = nickname + emoji;
        str = ChatMessage.parseString(str);
        this._addChatEmojiToRecord(emoji);
        // cc.log(emoji)
        // cc.log('---190')
    },

    _addChatEmojiToRecord: function _addChatEmojiToRecord(emoji) {
        var self = this;
        this._loadEmojiFrame(emoji, function (frame) {
            //var item  = cc.instantiate(self.emojiPrefab);
            //cc.log(frame)
            //var btnSprites =  item.getComponent(cc.Sprite);
            //btnSprites.spriteFrame = frame;
            //let chatEmojiRecord = item.getComponent('ChatTextRecord');
            //chatEmojiRecord.setEmoji(frame);
            ChatMessage.setEmoji(frame);
        });
    },

    _loadEmojiFrame: function _loadEmojiFrame(Emojiname, callback) {
        cc.loader.loadRes("/textures/chat/bq", cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                //console.log(null, err)
                return;
            }
            var frame = atlas.getSpriteFrame(Emojiname);
            callback(frame);
        }).bind(this));
    },

    _addChatTextToRecord: function _addChatTextToRecord(text) {
        var item = cc.instantiate(this.chatTextRecordPrefab);
        var chatTextRecord = item.getComponent('ChatTextRecord');
        chatTextRecord.setString(text);

        this.textRecordLayout.node.addChild(item);
        this.textRecordScrollView.scrollToBottom();
    }
});

cc._RFpop();
},{"AudioManager":"AudioManager","ChatMessage":"ChatMessage","socket":"socket"}],"NetworkError":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c99d35Sy6hDPbrte9nVczxP', 'NetworkError');
// scripts\NetworkError.js

var manager = require('manager');
var KQNativeInvoke = require('KQNativeInvoke');

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    exitAction: function exitAction() {
        cc.director.end();
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"NumberExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '80e21gZRpNM4pIiCpZ+7s8m', 'NumberExtension');
// scripts\Extensions\NumberExtension.js

// number.kq_times(f)   调用多次

if (!Number.prototype.kq_times) {

    /**
     * 调用一个方法 this 次
     * 
     * @param  {Function} f 要调用的方法
     * @param  {Object}   thisArg   可选； f 的 this值
     */
    Number.prototype.kq_times = function (f, thisArg) {
        if (!f) {
            return;
        }

        for (var i = 0; i < this; ++i) {
            if (thisArg) {
                f.apply(thisArg, i);
            } else {
                f(i);
            }
        }
    };
}

cc._RFpop();
},{}],"Playback":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0d3095dnBVFo5D1hEDDa5KQ', 'Playback');
// scripts\Playback\Playback.js

var Socket = require('socket');

// 用于回放的组件
var Playback = cc.Class({
  'extends': cc.Component,

  properties: {
    _playbackDatas: null, // 用于回放的数据
    _isPlaybacking: false
  },

  statics: {
    instance: null
  },

  onLoad: function onLoad() {
    Playback.instance = this;
    cc.game.addPersistRootNode(this.node);
  },

  // 设置回放数据
  setPlaybackDatas: function setPlaybackDatas(datas) {
    this._playbackDatas = datas;
  },

  // 清空回放数据。同时会清空回放
  removePlaybackDatas: function removePlaybackDatas() {
    this.setPlaybackDatas(null);
    this.stopPlayback();
  },

  // 是否包含回放数据
  isContainPlaybackDatas: function isContainPlaybackDatas() {
    return this._playbackDatas != null;
  },

  // 开始回放
  startPlayback: function startPlayback() {
    // 模拟 socket 接收到了事件即可
    //cc.log("Playback 开始回放");

    this._isPlaybacking = true;

    if (!this._playbackDatas) {
      cc.error("想回放，却没有回放数据");
      this.stopPlayback();
      return;
    }

    this._executePlayback();
  },

  // 停止回放
  stopPlayback: function stopPlayback() {
    this._isPlaybacking = false;
    this.unscheduleAllCallbacks();
  },

  // 是否正在回放
  isPlaybacking: function isPlaybacking() {
    return this._isPlaybacking;
  },

  // 执行真正的回放操作
  _executePlayback: function _executePlayback() {
    var startTime = 1.0;
    var interval = 3.0;
    cc.log(this._playbackDatas);

    // 在某些特殊情况下
    // 回放数据里会包含两套 gameOver action
    // 所以需要过滤掉其中一个
    this._playbackDatas = this._playbackDatas.filter((function (string, index) {
      if (index == this._playbackDatas.length - 1) {
        return true;
      }

      return string.indexOf('"action":"gameOver') == -1;
    }).bind(this));

    this._playbackDatas.forEach((function (data, index) {
      var delay = startTime + index * interval;
      if (index == this._playbackDatas.length - 1) {
        // 如果是最后一个，则应该只间隔一秒
        delay = startTime + (index - 1) * interval + 1;
      }

      this.scheduleOnce(function () {
        cc.log("回放开始模拟 Socket 接收到服务器消息, ", index);
        Socket.instance._dispatchResponse(data);
      }, delay);
    }).bind(this));
  }

});

module.exports = Playback;

cc._RFpop();
},{"socket":"socket"}],"Player":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6ffa0O02PFOp78QADTW5zGf', 'Player');
// scripts\Play\Player.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
var KQCardResHelper = require('KQCardResHelper');
var KQCard = require('KQCard');
var AudioManager = require('AudioManager');

cc.Class({
    'extends': cc.Component,

    properties: {
        foldCardNode: cc.Node, // 牌盖着时的样子
        teShuPaiNode: cc.Node, // 特殊牌盖着时的样子
        cardsBackLayout: cc.Layout, // 13张牌背影，可用来展示发牌动画 含 cardsBack Component
        compareCardsNode: cc.Node, // compareCards   含 CompareCards Component
        userInfoNode: cc.Node, // 包含用户信息 含 userInfo Component
        chatMessageNode: cc.Node, // 聊天消息 包含 ChatMessage Component
        userAvatarNode: cc.Node,
        //userSampleInfoNode: cc.Node,
        bulletHolePrefab: cc.Prefab, //中枪
        bulletHoleNode: cc.Node, //中枪
        shotNode: [cc.Node], //打枪
        userId: 0,
        cardTypePrefab: cc.Prefab,
        // 用户信息
        // 1、 如果 包含：cardInfo:[]，表明用户已经出牌
        //
        _userInfo: null,
        _deskInfo: null,
        /**/
        playedCompareCardsIndexs: {
            visible: false,
            'default': undefined
        }
        /**/
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.userAvatarNode.on(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
        this.reset();
        this.foldCardNodeBack = false; //判断是否点击了拍的背影
        this.cardSpriteAtlas = this.node.parent.getComponent('play').cardSpriteAtlas;
    },

    onDestroy: function onDestroy() {
        this.userAvatarNode.off(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
    },

    click_leave: function click_leave() {
        var userid = Socket.instance.userInfo.id;
        var leaveId = this._userInfo.id;
        Socket.sendQingli(leaveId, userid);
    },

    _showUserInfo: function _showUserInfo() {
        //this.userSampleInfoNode.getComponent('UserSampleInfo').updateWithUser(this._userInfo);
    },

    reset: function reset() {
        this.foldCardNode.active = false;
        this.cardsBackLayout.active = false;
        this.compareCardsNode.active = false;
        this.teShuPaiNode.active = false;
        this.bulletHoleNode.active = false;
        this.bulletHoleNode.removeAllChildren();
        this.bulletHoleNode.children.forEach(function (node) {
            node.active = false;
        });
        if (this.shotNode.length > 0) this.shotNode.forEach(function (node) {
            if (node) node.active = false;
        });
        this.compareCardsNode.getComponent('CompareCards').reset();
        this.compareCardsNode.getComponent('CompareCards').unscheduleAllCallbacks();
    },

    /*####*/
    reset2: function reset2() {
        this.foldCardNode.active = false;
        this.cardsBackLayout.active = false;
        this.teShuPaiNode.active = false;
        this.bulletHoleNode.active = false;
        this.bulletHoleNode.removeAllChildren();
        this.bulletHoleNode.children.forEach(function (node) {
            node.active = false;
        });
        if (this.shotNode.length > 0) this.shotNode.forEach(function (node) {
            if (node) node.active = false;
        });
        //this.compareCardsNode.active = false;
        //this.compareCardsNode.getComponent('CompareCards').reset();
    },
    /*#####*/

    updateUserInfoWithUsers: function updateUserInfoWithUsers(users) {
        var user = users.find((function (e) {
            return this.userId == e.id;
        }).bind(this));

        this.updateUserInfo(user);
    },
    showQingli: function showQingli(creator, index) {
        if (!this.node.active) {
            return;
        }
        if (index > 0) {
            this.userInfoNode.getComponent('userInfo').setqingli(false);
        } else {
            if (creator) {
                this.userInfoNode.getComponent('userInfo').setqingli(false);
            } else {
                this.userInfoNode.getComponent('userInfo').setqingli(true);
            }
        }
    },
    updateUserInfo: function updateUserInfo(user) {
        this._userInfo = user;
        this.node.active = user != null;
        this.userInfoNode.active = this.node.active;
        if (!user) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.updateAvatar(user.avatarUrl);
        userInfo.updateUserId(user.id);
        userInfo.updateNickname(user.nickname);
        userInfo.setOfflineVisible(!user.onlineStatus);

        //if (this._deskInfo && this._deskInfo.cIndex > 0) {
        //  if (UserModelHelper.isPlayedCards(user)) {
        //    this.playCard(user.id);
        //    this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
        //  }
        //}
        /**/
        var cIndex = this._deskInfo.cIndex;
        if (this._deskInfo && cIndex > 0 && this.playedCompareCardsIndexs.indexOf(cIndex) == -1) {
            if (UserModelHelper.isPlayedCards(user)) {
                this.playCard(user.id, user.cardInfo);
                this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
            }
        }
        /**/
    },

    // 更新房主信息
    updateBanker: function updateBanker() {
        var userInfoComp = this.userInfoNode.getComponent('userInfo');
        if (!this._userInfo) {
            userInfoComp.setIsBanker(false);
            return;
        }

        var isBanker = this._userInfo ? this._userInfo.isBanker : false;
        userInfoComp.setIsBanker(isBanker);
    },

    showFangZhuStatus: function showFangZhuStatus(createId) {
        var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (!this.node.active) {
            return;
        }
        if (this._userInfo.id == createId) {
            this.userInfoNode.getComponent('userInfo').setFangZhuNodeVisible(visible);
        }
    },

    /**
     * 更新分数
     *
     * @param {Number} score 用户分数、可选
     */
    updateScore: function updateScore(score) {
        if (!score && this._userInfo) {
            score = this._userInfo.totalScore;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.updateScore(score);
    },

    showReadyStatus: function showReadyStatus(userId) {
        var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

        if (!this.node.active) {
            return;
        }

        if (this._userInfo.id == userId) {
            this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(visible);
        }
    },
    showBeilv: function showBeilv(userId, bl) {
        if (!this.node.active) {
            return;
        }
        if (this._userInfo.id == userId) {
            this.userInfoNode.getComponent('userInfo').setBeilvLabel(bl);
        }
    },
    /*setDeskInfo: function (deskInfo) {
     this._deskInfo = deskInfo;
     },*/
    updateDeskInfo: function updateDeskInfo(deskInfo) {
        this._deskInfo = deskInfo;

        if (deskInfo && !deskInfo.isCBegin) {
            this.reset();
        }
    },
    /**/

    hideReadyStatus: function hideReadyStatus() {
        this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(false);
    },

    playFaPaiAnimation: function playFaPaiAnimation() {
        if (!this.node.active) {
            return;
        }
        if (UserModelHelper.isPlayedCards(this._userInfo)) {
            return;
        }
        var cardsBack = this.cardsBackLayout.getComponent('cardsBack');
        cardsBack.showPlayCardBacks();
    },

    shouldShowFaPaiAnimation: function shouldShowFaPaiAnimation() {
        return UserModelHelper.isPlayedCards(this._userInfo);
    },

    setUserOnlineStatus: function setUserOnlineStatus(userId) {
        var status = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.setOfflineVisible(status != 1);
    },

    showChatText: function showChatText(userId, message) {
        if (userId != this.userId) {
            return;
        }

        var chatMessage = this.chatMessageNode.getComponent('ChatMessage');
        chatMessage.setString(message);
    },

    // 用户已经出牌，处于三堆盖着牌的状态
    playCard: function playCard(userId, cardInfo) {
        if (this.userId != userId) {
            return;
        }

        this.cardsBackLayout.node.active = false;
        this.compareCardsNode.active = false;
        this.foldCardNode.targetOff(this.foldCardNode);
        this.foldCardNode.active = true;
        this.foldCardNode.children.slice(0, 3).forEach((function (node) {
            node.active = true;
            node.children.forEach((function (noe) {
                noe.active = true;

                var cardSprite = noe.getComponent('cc.Sprite');

                var path = 'public-pic-card-poker-back';

                this._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);
            }).bind(this));
        }).bind(this));
        this.foldCardNode.on(cc.Node.EventType.TOUCH_END, (function (event) {
            this._clickFoldCardNode(event);
        }).bind(this), this.foldCardNode);
    },

    _clickFoldCardNode: function _clickFoldCardNode(event) {

        if (this.userId != Socket.instance.userInfo.id) return;

        var cardInfo = this._userInfo.cardInfo.length == 1 ? this._userInfo.cardInfo[0].cards : this._userInfo.cardInfo;

        var cards = cardInfo.map((function (cardInfoItem) {

            if (this._userInfo.cardInfo.length == 1) return KQCard.cardsFromArray(cardInfoItem);

            return KQCard.cardsFromArray(cardInfoItem.cards);
        }).bind(this)).reduce(function (array, subCards) {
            return array.concat(subCards);
        }, []);

        var foldCardNode = this.foldCardNode.children.slice(0, 3);

        var nodes = foldCardNode.map(function (node) {
            return node.children;
        }).reduce(function (array, sub) {
            return array.concat(sub);
        }, []);

        cards.forEach((function (kqCard, index) {

            if (index >= nodes.length) return;

            nodes[index].removeAllChildren();

            nodes[index].getComponent(cc.Sprite).spriteFrame = "";

            var nodds1 = new cc.Node(); //创建一个节点对象

            nodds1.width = nodes[0].width;

            nodds1.height = nodes[0].height;

            nodds1.addComponent(cc.Sprite); //添加精灵组件

            var cardSprite = nodds1.getComponent('cc.Sprite');

            cardSprite.sizeMode = 0;

            var cardName = this.foldCardNodeBack == false ? kqCard.cardName() : "back";

            nodds1.cardName = cardName;

            var path = 'public-pic-card-poker-' + cardName;

            this._loadCardFrame(this.cardSpriteAtlas, path, cardSprite);

            if (cc.maPai == cardName) {

                var nodds = new cc.Node(); //创建一个节点对象

                nodds.addComponent(cc.Sprite); //添加精灵组件

                cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, (function (err, spriteFrame) {

                    if (err) {
                        cc.error(err.message || err);return;
                    }

                    var btnSprite1 = nodds.getComponent(cc.Sprite);

                    btnSprite1.spriteFrame = spriteFrame;

                    btnSprite1.node.width = cardSprite.node.width + 10;

                    btnSprite1.node.height = cardSprite.node.height + 10;
                }).bind(this));

                cardSprite.node.addChild(nodds);
            }

            nodes[index].addChild(nodds1);
        }).bind(this));

        var cards0 = cards.slice(0, 3);
        var cards1 = cards.slice(3, 8);
        var cards2 = cards.slice(8, 13);

        cards = [cards0, cards1, cards2];
        //头道
        var typeName0 = KQCard.cardsType(cards0) + 1;
        typeName0 = typeName0 >= 10 ? typeName0 : "0" + typeName0;
        typeName0 = typeName0 == '04' ? '11' : typeName0;

        //中道
        var typeName1 = KQCard.cardsType(cards1) + 1;
        typeName1 = typeName1 >= 10 ? typeName1 : "0" + typeName1;
        typeName1 = typeName1 == '07' ? '22' : typeName1;

        //尾道
        var typeName2 = KQCard.cardsType(cards2) + 1;
        typeName2 = typeName2 >= 10 ? typeName2 : "0" + typeName2;

        if (typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards, nodes, this.cardSpriteAtlas);
        if (typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards, nodes, this.cardSpriteAtlas);
        if (typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards, nodes, this.cardSpriteAtlas);
        if (this.foldCardNodeBack == false) {
            this.foldCardNodeBack = true;
        } else if (this.foldCardNodeBack == true) {
            this.foldCardNodeBack = false;
        }
    },

    _loadCardFrame: function _loadCardFrame(SpriteFrame, path, SpritesNode, w, h) {

        var Sprite = SpriteFrame.getSpriteFrame(path);

        SpritesNode.spriteFrame = Sprite;

        if (w) SpritesNode.node.width = w;

        if (h) SpritesNode.node.height = h;
    },

    // 准备好开始比牌
    // readyToCompareCards: function () {
    //     this.foldCardNode.targetOff(this.foldCardNode);
    //     this.foldCardNodeBack = true;
    //     this._clickFoldCardNode();
    //     this.cardsBackLayout.node.active = false;
    //     this.compareCardsNode.active = true;
    //     //this.foldCardNode.active = false;
    //     if(this.compareCardsNode.getComponent('CompareCards')._user){
    //         if(this.compareCardsNode.getComponent('CompareCards')._user.isContainExtra){
    //             this.teShuPaiNode.active = true;
    //         }else{
    //             this.teShuPaiNode.active = false;
    //         }
    //     }
    // },
    readyToCompareCards: function readyToCompareCards() {
        this.foldCardNode.targetOff(this.foldCardNode);
        this.foldCardNodeBack = true;
        this._clickFoldCardNode();
        this.cardsBackLayout.node.active = false;
        this.compareCardsNode.active = true;
        this.foldCardNode.active = true;
        if (this.compareCardsNode.getComponent('CompareCards')._user) {
            if (this.compareCardsNode.getComponent('CompareCards')._user.isContainExtra) {
                this.teShuPaiNode.active = true;
            } else {
                this.teShuPaiNode.active = false;
            }
        }
    },

    // 播放打枪动画
    // @param userId   要主动打枪的用户id
    // @param toUserIndex  挨枪的用户的 index
    playShootAnimation: function playShootAnimation(userId, toUserIndex) {
        if (userId != this.userId) {
            return;
        }
        var shotNode = this.shotNode[toUserIndex];
        shotNode.active = true;
        shotNode.children[0].active = true;
        shotNode.children[1].active = true;

        //枪
        var rotateBy = cc.rotateTo(0.1, -15);
        var delay1 = cc.delayTime(0.1);
        var rotateBy1 = cc.rotateTo(0.1, 0);
        var start_func1 = cc.callFunc(function () {
            shotNode.children[0].active = true;
        });
        var end_func1 = cc.callFunc(function () {
            shotNode.children[0].active = false;
        });
        var action = cc.repeat(cc.sequence(start_func1, rotateBy, delay1, rotateBy1, end_func1), 3);

        //烟
        var fadeIn = cc.fadeIn(0);
        var scaleTo1 = cc.scaleTo(0, 0.8);
        var scaleTo2 = cc.scaleTo(0.08, 1);
        var fadeOutAndScaleTo = cc.spawn(cc.fadeOut(0.02), cc.scaleTo(0.02, 0.5));
        var delay2 = cc.delayTime(.2);
        var start_func2 = cc.callFunc(function () {
            shotNode.children[1].active = true;
        });
        var end_func2 = cc.callFunc(function () {
            shotNode.children[1].active = false;
        });
        var action1 = cc.repeat(cc.sequence(start_func2, fadeIn, scaleTo1, scaleTo2, fadeOutAndScaleTo, delay2, end_func2), 3);

        shotNode.children[0].runAction(action);
        shotNode.children[1].runAction(action1);

        //let userInfo = this.userInfoNode.getComponent('userInfo');
        //userInfo.playShootAnimation(toUserIndex);
    },

    // 播放中枪动画
    playBulletHoleAnimation: function playBulletHoleAnimation(userId) {
        if (userId != this.userId) {
            return;
        }

        this.bulletHoleNode.active = true;

        var bulletHoleNode = cc.instantiate(this.bulletHolePrefab);

        bulletHoleNode.children.forEach((function (node) {
            node.active = false;
        }).bind(this));

        bulletHoleNode.children[0].y = 0;

        this.bulletHoleNode.addChild(bulletHoleNode);

        var interval = 0.3;

        var initTime = 0;

        bulletHoleNode.children.forEach((function (node) {

            this.scheduleOnce(function () {

                AudioManager.instance.playHumanZQiang();

                node.active = true;

                var y = Math.round(Math.random()) == 0 ? -1 : 1;

                y = Math.floor(Math.random() * 38) * y;

                var x = Math.round(Math.random()) == 0 ? -1 : 1;

                x = Math.floor(Math.random() * 38) * x;

                node.x = x;

                node.y = y;
            }, initTime);

            initTime = initTime + interval;
        }).bind(this));
    },

    // 播放全垒打动画
    playHomeRunAimation: function playHomeRunAimation(userId) {
        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.playHomeRunAimation();
    },

    playSpeakAnimation: function playSpeakAnimation(userId) {
        if (userId != this.userId) {
            return;
        }

        var userInfo = this.userInfoNode.getComponent('userInfo');
        userInfo.playSpeakAnimation();
    },

    nextCompareScore: function nextCompareScore() {
        if (!this.node.active) {
            return 0;
        }

        var score = this.compareCardsNode.getComponent('CompareCards').nextCompareScore();
        return score;
    },

    showNextCompareCards: function showNextCompareCards() {
        if (this.nextCompareScore() <= 0) {
            return;
        }
        this.teShuPaiNode.active = false;
        this.compareCardsNode.getComponent('CompareCards').showNextCards();
    },

    showAllCompareCards: function showAllCompareCards(users) {
        var user = users.find((function (e) {
            return this.userId == e.id;
        }).bind(this));
        this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
        this.compareCardsNode.getComponent('CompareCards').showAllCards();

        this.updateScore(this._userInfo.totalScore || 0);
    },

    showNextCompareScore: function showNextCompareScore(isContainExtra) {
        this.compareCardsNode.getComponent('CompareCards').showNextCompareScore(isContainExtra);
    },

    showScoreResult: function showScoreResult() {
        this.compareCardsNode.getComponent('CompareCards').showScoreResult();
    }
});

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","AudioManager":"AudioManager","KQCard":"KQCard","KQCardResHelper":"KQCardResHelper","KQGlobalEvent":"KQGlobalEvent","Playback":"Playback","UserModelHelper":"UserModelHelper","socket":"socket"}],"ResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9b2behcoUlLYL1MIMs+04wI', 'ResultItem');
// scripts\Play\ResultItem.js

var KQCardResHelper = require('KQCardResHelper');
var SpriteHelper = require('SpriteHelper');
var KQCard = require('KQCard');

cc.Class({
    'extends': cc.Component,

    properties: {
        avatarSprite: cc.Sprite,
        labelNickname: cc.Label,
        labelResultNumber: cc.Label,
        layoutTouDao: cc.Layout,
        layoutZhongDao: cc.Layout,
        layoutWeiDao: cc.Layout,
        layoutTeShu: cc.Layout,

        labelTeShuPaiTitle: cc.Label,

        scoreUnitNode: cc.Node, // 积分
        diamondUnitNode: cc.Node },

    // 钻石
    onLoad: function onLoad() {},

    //{"id":100049,"nickname":"imya","openId":"xx","avatarUrl":"xx","sex":1,
    // "cardNumber":3,"onlineStatus":1,"inviteCode":"","ipAddress":"::ffff:222.244.65.201",
    // "lastLoginTime":"2017-04-13 22:09:01","createAt":"2017-04-11 22:39:30",
    // "updateAt":"2017-04-13 22:09:01",
    // "cards":[],"roomId":"598883","readyStatus":true,"totalScore":0,
    // "cScore":0,"isBanker":false}
    updateWithPlayerInfo: function updateWithPlayerInfo(playerInfo) {
        var isRandomRoom = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];

        SpriteHelper.setImageUrl(this.avatarSprite, playerInfo.avatarUrl);
        this.labelNickname.string = playerInfo.nickname;
        //cc.log(this.labelResultNumber.string)
        //cc.log(playerInfo)
        //cc.log(playerInfo.cScore)
        //cc.log('---36')
        this.labelResultNumber.string = playerInfo.cScore;

        this.scoreUnitNode.active = !isRandomRoom;
        this.diamondUnitNode.active = isRandomRoom;
        var Number = playerInfo.cScore;
        if (isRandomRoom) {
            // 如果是随机场的话，则显示钻石数量
            Number = playerInfo.cScore * 5;
        }
        this.labelResultNumber.string = Number;
    },

    setCards: function setCards(cards) {
        cc.assert(cards.length == 13);

        // 不会再有特殊牌了
        /*if (KQCard.isTeShuPai(cards)) {
          this.setTeShuCards(cards);
          return;
          }
        */

        //let touCards = cards.slice(0, 3);
        //let zhongCards = cards.slice(3, 3 + 5);
        //let weiCards = cards.slice(8);
        //this.setTouCards(touCards);
        //this.setZhongCards(zhongCards);
        //this.setWeiCards(weiCards);
    }

});
/*setTouCards: function (cards) {
  this._setCardsToLayout(this.layoutTouDao, cards);
},
  setZhongCards: function (cards) {
  this._setCardsToLayout(this.layoutZhongDao, cards);
},
    setWeiCards: function (cards) {
  this._setCardsToLayout(this.layoutWeiDao, cards);
},*/

//结算  将特殊牌放入Layout
/*setTeShuCards: function (cards) {
  this.layoutTeShu.node.active = true;
  this.layoutTouDao.node.active = false;
  this.layoutZhongDao.node.active = false;
  this.layoutWeiDao.node.active = false;
  this._setCardsToLayout(this.layoutTeShu, cards);
    let typeName = KQCard.cardsTypeName(cards);
  this.labelTeShuPaiTitle.string = typeName;
},*/

//结算将牌放到Layout里面
/*_setCardsToLayout: function (layout, cards) {
  let node = layout.node;
  node.children.forEach(function (spriteNode, index) {
    let sprite = spriteNode.getComponent('cc.Sprite');
    let card = cards[index];
    if (!card) {
      return;
    }
      KQCardResHelper.setCardSpriteFrame(sprite, card.cardName());
  });
},*/

cc._RFpop();
},{"KQCard":"KQCard","KQCardResHelper":"KQCardResHelper","SpriteHelper":"SpriteHelper"}],"Setting":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3ad6mNk4BMBZzipGQDNlr4', 'Setting');
// scripts\Setting\Setting.js

var Manager = require('manager');
var KQNativeInvoke = require('KQNativeInvoke');

cc.Class({
    'extends': cc.Component,

    properties: {
        phone: cc.Label,
        musicSlider: cc.Node,
        effectSlider: cc.Node,
        btnSwitchAccount: cc.Button,
        shareBg: cc.Node,
        wx: cc.Node,
        pyq: cc.Node,
        music: cc.Node,
        sounds: cc.Node,
        _audioManager: null,
        _musicOn: 1,
        _soundsOn: 1,
        _phone: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._audioManager = cc.find('AudioManager') || {};
        this._audioManager = this._audioManager.getComponent('AudioManager');
        this._initSliders();
        this.phone.string = this._phone ? this._phone : "无";
        var bgMusic = cc.sys.localStorage.getItem("bgMusic");
        var bgSound = cc.sys.localStorage.getItem("bgSound");
        //console.log(bgMusic);
        if (bgMusic != '') {
            if (parseInt(bgMusic) == 1) {
                this._musicOn = 1;
                this.music.getChildByName('music_on').active = true;
                this.music.getChildByName('music_off').active = false;
            } else {
                this._musicOn = 0;
                this.music.getChildByName('music_on').active = false;
                this.music.getChildByName('music_off').active = true;
            }
        }
        if (bgSound == 0) {
            // 如果背景音效是关闭的
            if (parseInt(bgSound) == 0) {
                this._soundsOn = 0;
                this.sounds.getChildByName('sounds_on').active = false;
                this.sounds.getChildByName('sounds_off').active = true;
            } else {
                this._soundsOn = 1;
                this.sounds.getChildByName('sounds_on').active = true;
                this.sounds.getChildByName('sounds_off').active = false;
            }
            this._audioManager.setEffectMusicVolum(this._soundsOn);
        }
    },
    clickWx: function clickWx() {
        //点击微信
        if (!cc.sys.isNative) {
            this.shareBg.active = true;
            this.wx.active = true;
        } else {
            var title = cc.sys.localStorage.getItem('shareTitle');
            var description = cc.sys.localStorage.getItem('desc');
            var recordId = cc.sys.localStorage.getItem('recordId');
            var roomId = cc.sys.localStorage.getItem('roomId');
            var id = '';
            if (roomId) {
                id = 'roomId=' + roomId;
            }
            if (recordId) {
                id = 'recordId=' + recordId;
            }
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
            } else if (KQNativeInvoke.isNativeAndroid()) {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
            }
        }
    },
    clickPyq: function clickPyq() {
        //点击朋友圈
        if (!cc.sys.isNative) {
            this.shareBg.active = true;
            this.pyq.active = true;
        } else {
            var title = cc.sys.localStorage.getItem('shareTitle');
            var description = cc.sys.localStorage.getItem('desc');
            var recordId = cc.sys.localStorage.getItem('recordId');
            var roomId = cc.sys.localStorage.getItem('roomId');
            var id = '';
            if (roomId) {
                id = 'roomId=' + roomId;
            }
            if (recordId) {
                id = 'recordId=' + recordId;
            }
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline:description:", id, description, title);
            } else if (KQNativeInvoke.isNativeAndroid()) {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
            }
        }
    },

    clickshareBg: function clickshareBg() {
        // 点击分享背景图
        this.shareBg.active = false;
        this.wx.active = false;
        this.pyq.active = false;
    },
    clickMusic: function clickMusic() {
        //点击音乐
        this.music.children[1].active = this._musicOn = !this._musicOn;
        this.music.children[2].active = !this._musicOn;
        var volume = 0;
        if (this._musicOn) {
            this._audioManager.setBgMusicVolumn(1);
            this._audioManager.playMusic();
            volume = 1;
        } else {
            this._audioManager.setBgMusicVolumn(0);
            volume = 0;
        }
        cc.sys.localStorage.setItem("bgMusic", volume);
    },

    clickSounds: function clickSounds() {
        //点击了音效
        this.sounds.children[1].active = this._soundsOn = !this._soundsOn;
        this.sounds.children[2].active = !this._soundsOn;
        var volume = 0;
        if (this._soundsOn) {
            this._audioManager.setEffectMusicVolum(1);
            volume = 1;
        } else {
            this._audioManager.setEffectMusicVolum(0);
            volume = 0;
        }
        cc.sys.localStorage.setItem("bgSound", volume);
    },
    clickSetting: function clickSetting() {//点击设置

    },
    _initSliders: function _initSliders() {
        this._initSliderEvents();

        var musicVal = Manager.getMusicValue();
        var effectVal = Manager.getMusicEffectValue();

        this._audioManager.setBgMusicVolumn(musicVal);
        this._audioManager.setEffectMusicVolum(effectVal);

        this.musicSlider.getComponent('slider').setValue(musicVal);
        this.effectSlider.getComponent('slider').setValue(effectVal);
    },

    _initSliderEvents: function _initSliderEvents() {
        var self = this;
        this.musicSlider.getComponent('slider').onValueChange = function (value) {
            Manager.setMusicValue(value);
            self._audioManager.setBgMusicVolumn(value);
        };

        this.effectSlider.getComponent('slider').onValueChange = function (value) {
            Manager.setMusicEffectValue(value);
            self._audioManager.setEffectMusicVolum(value);
        };
    },

    clickSwitch: function clickSwitch() {},

    hideSwitch: function hideSwitch() {
        if (this.btnSwitchAccount) {
            this.btnSwitchAccount.node.active = false;
        }
    }
});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"SpriteHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '936f2uPA8NAuqUZv0R8ZxgP', 'SpriteHelper');
// scripts\Extensions\SpriteHelper.js

var SpriteHelper = {
  setImageUrl: function setImageUrl(sprite, url) {
    if (url.endsWith("png") || url.endsWith("jpg") || url.endsWith("gif")) {} else {
      //url = url + ".png";
    }

    cc.loader.load({ url: url, type: "jpg" }, function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      sprite.spriteFrame = frame;
    });
  }
};

module.exports = SpriteHelper;

cc._RFpop();
},{}],"StringExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7b106eQ/I5F1J85hMxFBIlw', 'StringExtension');
// scripts\Extensions\StringExtension.js

// 给 String 添加功能

// str.startsWith("");
// str.endsWith("");

if (!String.prototype.startsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`
		var defineProperty = (function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		})();
		var toString = ({}).toString;
		var startsWith = function startsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var position = arguments.length > 1 ? arguments[1] : undefined;
			// `ToInteger`
			var pos = position ? Number(position) : 0;
			if (pos != pos) {
				// better `isNaN`
				pos = 0;
			}
			var start = Math.min(Math.max(pos, 0), stringLength);
			// Avoid the `indexOf` call if no match is possible
			if (searchLength + start > stringLength) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'startsWith', {
				'value': startsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.startsWith = startsWith;
		}
	})();
}

// str.endsWith("");
if (!String.prototype.endsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`
		var defineProperty = (function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		})();
		var toString = ({}).toString;
		var endsWith = function endsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var pos = stringLength;
			if (arguments.length > 1) {
				var position = arguments[1];
				if (position !== undefined) {
					// `ToInteger`
					pos = position ? Number(position) : 0;
					if (pos != pos) {
						// better `isNaN`
						pos = 0;
					}
				}
			}
			var end = Math.min(Math.max(pos, 0), stringLength);
			var start = end - searchLength;
			if (start < 0) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'endsWith', {
				'value': endsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.endsWith = endsWith;
		}
	})();
}

cc._RFpop();
},{}],"TotalGameResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1c6f93a1BOnoSiX6kJ0Efn', 'TotalGameResultItem');
// scripts\Play\TotalGameResultItem.js

var SpriteHelper = require('SpriteHelper');
cc.Class({
    "extends": cc.Component,

    properties: {
        avatarSprite: cc.Sprite,
        labelUserId: cc.Label,
        labelScore: cc.Label,
        labelNickname: cc.Label,

        _deskInfo: null
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setUserInfo: function setUserInfo(user, deskInfo) {
        if (!user) {
            return;
        }

        var totalScore = user.totalScore;
        if (deskInfo && (deskInfo.setting1 == 0 || deskInfo.setting1 == 1)) {
            var baseScore = deskInfo.setting1 == 0 ? 100 : 200;
            totalScore = totalScore - baseScore;
        }

        SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);
        this.labelUserId.string = "" + user.id;
        this.labelScore.string = totalScore > 0 ? "+ " + totalScore : "- " + totalScore * -1;
        if (totalScore == 0) {
            this.labelScore.string = "0";
        }
        this.labelNickname.string = user.nickname;
    }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"TotalGameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f7fb2e7foJFNJzjdtbAtk7O', 'TotalGameResult');
// scripts\Play\TotalGameResult.js

var KQNativeInvoke = require('KQNativeInvoke');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        itemLayout: cc.Layout,
        itemPrefab: cc.Prefab,
        timeLabel: cc.Label, // 时间
        jushuLabel: cc.Label, // 局数
        roomId: cc.Label, // 房间号
        nicknameLabels: cc.Label,
        recordInfo_sview: [cc.Node],

        sharrBg: cc.Node,
        btnWeiXin: cc.Node,
        btnGongXuoHao: cc.Node,
        btnZhuShou: cc.Node,
        btnZongFen: cc.Node,

        suanfen_sview: cc.Node,
        suanFenPrefab: cc.Prefab,
        suanFenBgPrefab: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {},

    onDisable: function onDisable() {
        //if(cc.sys.isBrowser){
        //
        var shareTitle = '开房玩[大众十三水]';
        var desc = '开好房了，就等你们一起来[大众十三水]啦！晚了位置就没了哟~';
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);

        // cc.sys.localStorage.removeItem("shareTitle");
        // cc.sys.localStorage.removeItem("desc");
        cc.sys.localStorage.removeItem("recordId");
        //cc.sys.localStorage.setItem("roomId",'');
        if (window.shareToTimeLine) {
            window.shareToTimeLine();
        }
        if (window.shareToSession) {
            window.shareToSession();
        }
        //}
    },
    js: function js(setting2) {
        var jushu = 5;
        switch (setting2) {
            case 0:
                jushu = 5;break;case 1:
                jushu = 10;break;
            case 2:
                jushu = 20;break;case 3:
                jushu = 30;break;
        }
        return jushu;
    },

    creator: function creator(_creator, players) {
        //创房者
        for (var i = 0; i < players.length; i++) {
            if (players[i].id == _creator) {
                return i;
            }
        }
    },

    _clickBtn: function _clickBtn() {
        this.btnZhuShou.active = true;
        this.btnZongFen.active = false;
    },

    clickZongFen: function clickZongFen() {

        this.btnZhuShou.active = true;

        this.btnZongFen.active = false;

        this.recordInfo_sview.forEach(function (node) {
            node.active = true;
        });

        this.suanfen_sview.active = false;
    },
    _globalMsg: function _globalMsg(recordInfo) {
        //if(cc.sys.isBrowser) {
        var roomId = "房间号：" + recordInfo.roomId;
        var pj = ["5 ", "10 ", "20 "];
        var js = "局数：" + pj[recordInfo.setting1 - 2];
        var time = "时间：" + (recordInfo.createAt ? recordInfo.createAt : recordInfo.createTime);
        var shareTitle = "[大众十三水]战绩";
        var desc = roomId + js + time + " 点击查看详情";
        var recordId = recordInfo.id != undefined ? recordInfo.id : recordInfo.recordId;
        cc.sys.localStorage.setItem("shareTitle", shareTitle);
        cc.sys.localStorage.setItem("desc", desc);
        cc.sys.localStorage.setItem("recordId", recordId);
        cc.sys.localStorage.setItem("roomId", '');

        if (window.shareToTimeLine) {
            window.shareToTimeLine();
        }
        if (window.shareToSession) {
            window.shareToSession();
        }
        //}
    },
    //大局
    setPlayerInfos: function setPlayerInfos(playerInfos, deskInfo) {
        playerInfos.sort(function (a, b) {
            return b.totalScore - a.totalScore;
        }); // 排序
        // cc.log(playerInfos)
        // cc.log(deskInfo)
        // cc.log('--65')

        this._globalMsg(deskInfo);
        this.recordInfo_sview.forEach(function (node) {
            node.active = true;
        });

        this.suanfen_sview.active = false;

        this.btnZhuShou.active = true;

        this.btnZongFen.active = false;

        this._playerInfos = playerInfos;

        this._deskInfo = deskInfo;

        var createId = deskInfo.createUserId ? deskInfo.createUserId : deskInfo.createId;

        var nickname = playerInfos[this.creator(createId, playerInfos)].nickname;

        this.roomId.string = deskInfo.roomId;

        var createAt = deskInfo.createAt ? deskInfo.createAt : deskInfo.createTime;

        this.timeLabel.string = createAt.substr(0, 11);

        this.jushuLabel.string = this.js(deskInfo.setting1 - 2);

        this.nicknameLabels.string = nickname;

        this.itemLayout.node.removeAllChildren();

        playerInfos.forEach((function (user) {

            var item = cc.instantiate(this.itemPrefab);

            item.getComponent('TotalGameResultItem').setUserInfo(user, deskInfo);

            if (deskInfo.createUserId == user.id || deskInfo.createId == user.id) {

                item.children[1].children[0].active = true;
            } else {

                item.children[1].children[0].active = false;
            }

            this.itemLayout.node.addChild(item);
        }).bind(this));
    },

    //算分能手
    clickSuanFen: function clickSuanFen() {

        this.btnZhuShou.active = false;

        this.btnZongFen.active = true;

        this.recordInfo_sview.forEach(function (node) {
            node.active = false;
        });

        this.suanfen_sview.active = true;

        var playersRigth = this._playerInfos.filter(function (player) {
            return player.totalScore > 0;
        });

        var playersLeft = this._playerInfos.filter(function (player) {
            return player.totalScore < 0;
        });

        var playersRigthScore = playersRigth.map(function (player) {
            return player.totalScore;
        });

        var playersLeftScore = playersLeft.map(function (player) {
            return player.totalScore * -1;
        });

        var playersIndex = [],
            arrs = [playersRigthScore.filter(function (i) {
            return i;
        }), playersLeftScore.filter(function (i) {
            return i;
        })],
            indexs = playersLeftScore.length > playersRigthScore.length ? 0 : 1; //1是赢的人 0输的人

        // for(var i = 0;i < arrs[indexs].length; i++){

        //     var score = arrs[indexs][i];

        //     var d = this.getCombBySum(arrs[indexs==1?0:1], score)[0] || [];

        //     if(d.length > 0){

        //         playersIndex.push([score,d]);

        //         d.forEach(function (s) {

        //             var index = arrs[indexs==1?0:1].indexOf(s);

        //             if(index != -1) arrs[indexs==1?0:1].splice(index,1);

        //         });
        //     }
        // }

        // if(playersIndex.length == 0) indexs = 2;
        indexs = 2;
        this.suanfen_sview.children[0].removeAllChildren();

        playersLeft.forEach((function (user, index) {

            var suanFenBgPrefab = cc.instantiate(this.suanFenBgPrefab);

            suanFenBgPrefab.removeAllChildren();

            this._ctarePrefab(1, suanFenBgPrefab, user, user.totalScore, this._deskInfo, -200, 0);

            var x = 0,
                y = 0;

            if (indexs == 1) {
                for (var j = 0; j < playersIndex[index][1].length; j++) {

                    var s = playersIndex[index][1][j];

                    var d = playersRigthScore.indexOf(s);

                    if (d != -1) {

                        var plays = playersRigth.splice(d, 1)[0];

                        playersRigthScore.splice(d, 1);

                        if (plays) {

                            if (suanFenBgPrefab.childrenCount >= 3) y = -90;

                            if (suanFenBgPrefab.childrenCount == 3) x = 0;

                            if (suanFenBgPrefab.childrenCount >= 5) y = -180;

                            if (suanFenBgPrefab.childrenCount == 5) x = 0;

                            this._ctarePrefab(0, suanFenBgPrefab, plays, plays.totalScore, this._deskInfo, x, y);

                            x += 200;
                        }
                    }
                }
            } else if (indexs == 0) {
                var fen = suanFenBgPrefab.children[0].getChildByName("fen").getComponent(cc.Label).string.substr(3) * -1;

                for (var j = 0; j < playersIndex.length; j++) {

                    var s = playersIndex[j];

                    var d = s[1].indexOf(fen);

                    var q = s[0];

                    var w = playersRigthScore.indexOf(q);

                    if (d != -1 && w != -1) {

                        var plays = playersRigth[w];

                        this._ctarePrefab(0, suanFenBgPrefab, plays, plays.totalScore, this._deskInfo, x, y, fen);
                    }
                }
            } else {
                var q = playersLeftScore[index];
                var addScore = 0;
                var arr = [];
                for (var j = 0; j < playersRigthScore.length; j++) {
                    var w = playersRigthScore[j];
                    if (addScore < q) {
                        addScore += w;
                        if (addScore > q) {
                            arr.push(w - (addScore - q));
                        } else {
                            arr.push(w);
                        }
                        if (q - w >= 0) {
                            playersRigthScore[j] = 0;
                        }
                    }
                    if (addScore > q) {
                        playersRigthScore[j] = addScore - q;
                        break;
                    }
                }

                for (var t = 0; t < arr.length; t++) {
                    var r = arr[t];
                    if (r == 0) continue;
                    if (suanFenBgPrefab.childrenCount >= 3) y = -90;

                    if (suanFenBgPrefab.childrenCount == 3) x = 0;

                    if (suanFenBgPrefab.childrenCount >= 5) y = -180;

                    if (suanFenBgPrefab.childrenCount == 5) x = 0;

                    var plays = playersRigth[t];

                    this._ctarePrefab(0, suanFenBgPrefab, plays, r, this._deskInfo, x, y);

                    x += 200;
                }
            }

            this.suanfen_sview.children[0].addChild(suanFenBgPrefab);
        }).bind(this));
    },

    _ctarePrefab: function _ctarePrefab(shu, node, user, totalScore, deskInfo, x, y) {
        var fen = arguments.length <= 7 || arguments[7] === undefined ? null : arguments[7];

        var suanFenPrefab = cc.instantiate(this.suanFenPrefab);

        suanFenPrefab.getChildByName("ID").getComponent(cc.Label).string = "ID:" + user.id;

        if (deskInfo.createUserId == user.id) suanFenPrefab.getChildByName("ID").color = new cc.Color(235, 115, 122);

        suanFenPrefab.getChildByName("shu").getComponent(cc.Label).string = shu == 0 ? "输" : "";

        var str = shu == 0 ? totalScore + "分" : "总分:" + totalScore;

        if (fen) str = fen + "分";

        suanFenPrefab.getChildByName("fen").getComponent(cc.Label).string = str;

        var sprite = suanFenPrefab.getChildByName("haed").getComponent(cc.Sprite);

        var headUrl = user.avatarUrl; // 头像URL

        cc.loader.load({ url: headUrl, type: "jpg" }, function (err, tex) {

            if (!err) {

                var frame = new cc.SpriteFrame(tex);

                sprite.spriteFrame = frame;

                sprite.node.height = 55;

                sprite.node.width = 55;
            }
        });

        suanFenPrefab.x = x;

        suanFenPrefab.y = y;

        node.height = 90 + y * -1;

        node.addChild(suanFenPrefab);
    },

    clickExit: function clickExit() {
        Socket.sendOnceAgain('false', this._userId);
        cc.director.loadScene('hall');
    },

    clickShareWeiChat: function clickShareWeiChat() {
        if (!cc.sys.isNative) {
            this.sharrBg.active = true;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
            } else {
                //Android
                KQNativeInvoke.screenshotShare();
            }
        }
    },
    clickShareBg: function clickShareBg() {
        this.sharrBg.active = false;
    },
    clickSharePengYouQuan: function clickSharePengYouQuan() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
        }
    },

    getCombBySum: function getCombBySum(array, sum, tolerance, targetCount) {
        var util = {
            /*
             get combination from array
             arr: target array
             num: combination item length
             return: one array that contain combination arrays
             */
            getCombination: function getCombination(arr, num) {
                var r = [];
                (function f(t, a, n) {
                    if (n == 0) {
                        return r.push(t);
                    }
                    for (var i = 0, l = a.length; i <= l - n; i++) {
                        f(t.concat(a[i]), a.slice(i + 1), n - 1);
                    }
                })([], arr, num);
                return r;
            },
            //take array index to a array
            getArrayIndex: function getArrayIndex(array) {
                var i = 0,
                    r = [];
                for (i = 0; i < array.length; i++) {
                    r.push(i);
                }

                return r;
            }
        },
            logic = {
            //sort the array,then get what's we need
            init: function init(array, sum) {
                //clone array
                var _array = array.concat(),
                    r = [],
                    i = 0;
                //sort by asc
                _array.sort(function (a, b) {
                    return a - b;
                });
                //get all number when it's less than or equal sum
                for (i = 0; i < _array.length; i++) {
                    if (_array[i] <= sum) {
                        r.push(_array[i]);
                    } else {
                        break;
                    }
                }

                return r;
            },
            //important function
            core: function core(array, sum, arrayIndex, count, r) {
                var i = 0,
                    k = 0,
                    combArray = [],
                    _sum = 0,
                    _cca = [],
                    _cache = [];

                if (count == _returnMark) {
                    return;
                }
                //get current count combination
                combArray = util.getCombination(arrayIndex, count);
                for (i = 0; i < combArray.length; i++) {
                    _cca = combArray[i];
                    _sum = 0;
                    _cache = [];
                    //calculate the sum from combination
                    for (k = 0; k < _cca.length; k++) {
                        _sum += array[_cca[k]];
                        _cache.push(array[_cca[k]]);
                    }
                    if (Math.abs(_sum - sum) <= _tolerance) {
                        r.push(_cache);
                    }
                }

                logic.core(array, sum, arrayIndex, count - 1, r);
            }

        },
            r = [],
            _array = [],
            _targetCount = 0,
            _tolerance = 0,
            _returnMark = 0;

        //check data
        _targetCount = targetCount || _targetCount;
        _tolerance = tolerance || _tolerance;

        _array = logic.init(array, sum);
        if (_targetCount) {
            _returnMark = _targetCount - 1;
        }

        logic.core(_array, sum, util.getArrayIndex(_array), _targetCount || _array.length, r);

        return r;
    }
});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","socket":"socket"}],"UserModelHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98854aScapF5oQnHKxJsvmF', 'UserModelHelper');
// scripts\ModelUtils\UserModelHelper.js

var UserModelHelper = {
  // 用户是否已出牌
  isPlayedCards: function isPlayedCards(user) {
    cc.assert(user);

    if (user && user.cardInfo && user.cardInfo.length > 0) {
      return true;
    }

    return false;
  },

  // 用户是否已准备
  isUserReady: function isUserReady(user) {
    return user.readyStatus == true;
  }
};

module.exports = UserModelHelper;

cc._RFpop();
},{}],"UserSampleInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3a9f7A0IgRGPrAZvy1p9s4i', 'UserSampleInfo');
// scripts\Play\UserSampleInfo.js

var SpriteHelper = require('SpriteHelper');

cc.Class({
    'extends': cc.Component,

    properties: {
        labelUserId: cc.Label,
        labelUserIP: cc.Label,
        labelNickname: cc.Label,
        avatarSprite: cc.Sprite,
        manSprite: cc.Sprite,
        womenSprite: cc.Sprite,

        _didShowUserInfo: null
    },

    // use this for initialization
    onLoad: function onLoad() {},

    updateWithUser: function updateWithUser(user) {
        return;
        if (!user) {
            return;
        }

        if (this._didShowUserInfo == user) {
            this.unscheduleAllCallbacks();
            this._disappearUserInfo();
            return;
        }

        this._didShowUserInfo = user;
        if (!this.node.active) {
            this.node.getComponent('alert').alert();
        }

        this.unscheduleAllCallbacks();
        this.scheduleOnce((function () {
            this._disappearUserInfo();
        }).bind(this), 5);

        this.labelUserId.string = "UID:\n" + user.id;
        this.labelUserIP.string = "用户IP:\n" + user.ipAddress.replace("::ffff:", "");
        this.labelNickname.string = user.nickname;
        this.avatarSprite.spriteFrame = null;
        SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);

        var sex = user.sex; // sex: 1 男  2 女
        this.manSprite.node.active = sex == 1;
        this.womenSprite.node.active = sex != 1;
    },

    _disappearUserInfo: function _disappearUserInfo() {
        this.node.active = false;
        this._didShowUserInfo = null;
    }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"agreement":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8f601dzNnZLtq+KGT0uqDqF', 'agreement');
// scripts\agreement.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');
cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        agreement: {
            'default': null,
            type: cc.Label
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        // cc.log('----61')
        //  cc.log(this.agreement)
    },
    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (!response.result) {
            return;
        }
        var s = cc.find('Canvas/agreement');
        var data = response.data;
        //this._info1 = response.data;
        // cc.log(this.agreement)
        // cc.log(s)
        // cc.log('----61')
        this.agreement.string = data.info1 || "";
    }
});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"alert":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16cd2qs73lByZaHhJkQAEee', 'alert');
// scripts\alert.js

var AudioManager = require('AudioManager');
cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        popNode: cc.Node,
        label: cc.Label,

        _alertCallback: null,
        _willDismissCallback: null,
        _dismissCallback: null,
        _confirmCallback: null, // 点击确定后的回调
        _tishi: null,
        _card_num: null
    },

    // use this for initialization
    onLoad: function onLoad() {},

    alert: function alert() {
        this.node.active = true;
        var anim = this.popNode.getComponent(cc.Animation);
        anim.play('pop');

        if (this._alertCallback) {
            this._alertCallback(this.node);
        }
    },
    /*#####弹出结果*/
    alertResult: function alertResult() {
        this.node.active = true;
        cc.find("Canvas/show_result").active = false;
        var anim = this.popNode.getComponent(cc.Animation);
        anim.play('pop');

        if (this._alertCallback) {
            this._alertCallback(this.node);
        }
    },

    /*#####点击确定*/
    playBtnClickSFX: function playBtnClickSFX() {
        AudioManager.instance.playBtnClickSFX();
    },

    /*#####点击取消*/
    palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
        AudioManager.instance.palyBtnCancelClickSFX();
    },

    /*#####点击关闭或者按键之类的按钮，播放音效*/
    palyBtnPublicSFX: function palyBtnPublicSFX() {
        AudioManager.instance.palyBtnPublicSFX();
    },

    /*#####点击创建房间，播放音效*/
    palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
        AudioManager.instance.palyBtnCreateRoomSFX();
    },
    /*#####点击创建房间，播放音效*/
    palyWindowSFX: function palyWindowSFX() {
        AudioManager.instance.palyWindowSFX();
    },

    palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
        AudioManager.instance.palyWeiXinLoginSFX();
    },
    palyFangPaiSFX: function palyFangPaiSFX() {
        AudioManager.instance.palyFangPaiSFX();
    },

    dismissAction: function dismissAction() {
        var willDismissCallback = this._willDismissCallback;
        if (willDismissCallback) {
            var result = willDismissCallback();
            if (result) {
                this.dismissComplete();
                return;
            }
        }

        var anim = this.popNode.getComponent(cc.Animation);
        var dismissAnim = anim.getAnimationState('pop_dismiss');
        dismissAnim.on('finished', this.dismissComplete, this);
        anim.play('pop_dismiss');
    },

    /*#####隐藏结果页面*/
    dismissActionResult: function dismissActionResult() {
        var willDismissCallback = this._willDismissCallback;
        if (willDismissCallback) {
            var result = willDismissCallback();
            if (result) {
                this.dismissComplete();
                return;
            }
        }

        var anim = this.popNode.getComponent(cc.Animation);
        var dismissAnim = anim.getAnimationState('pop_dismiss');
        dismissAnim.on('finished', this.dismissComplete, this);
        anim.play('pop_dismiss');
        cc.find("Canvas/show_result").active = true;
    },

    dismissComplete: function dismissComplete() {
        this.node.active = false;

        if (this.onDismissComplete) {
            this.onDismissComplete();
        }

        if (this._dismissCallback) {
            this._dismissCallback(this.node);
        }
    },
    dismissPlay: function dismissPlay() {
        cc.director.loadScene("hall");
    },

    onDismissComplete: function onDismissComplete() {
        //cc.log("onDismissComplete");
    },

    doneAction: function doneAction() {
        this.dismissAction();
        this.onDoneAction();

        var confirmCallback = this._confirmCallback;
        if (confirmCallback) {
            confirmCallback(this.node);
        }
    },

    onDoneAction: function onDoneAction() {},

    setMessage: function setMessage(msg) {
        this.label.string = msg;
    },

    getMessage: function getMessage() {
        return this.label.string;
    },

    setAlertCallbck: function setAlertCallbck(callback) {
        this._alertCallback = callback;
    },

    setWillDismissCallback: function setWillDismissCallback(callback) {
        this._willDismissCallback = callback;
    },

    setDismissCallback: function setDismissCallback(callback) {
        this._dismissCallback = callback;
    },

    setConfirmCallback: function setConfirmCallback(callback) {
        this._confirmCallback = callback;
    }

});
/*setMessage: function (message) {
  this.label.getComponent('cc.Label').string = message;
},*/

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"AudioManager":"AudioManager"}],"animation":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c9ee9y0ua5NRLSZAxQqDjdw', 'animation');
// scripts\animation.js

/**
 *  房间特殊牌动画
 *
 *
 *
 * 
 */
cc.Class({
    "extends": cc.Component,

    properties: {
        fapaiNode: cc.Prefab, //
        liuduiban: cc.Prefab,
        santonghua: cc.Prefab,
        sanshunzi: cc.Prefab,
        quanleida: cc.Prefab,
        qinglong: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {},
    fapaiAnimation: function fapaiAnimation() {
        var fapai = this.node.getChildByName('fapai');
        fapai = cc.removeSelf();
        var fapaiAnim = cc.instantiate(this.fapaiNode);
        this.node.addChild(fapaiAnim);

        var Lgun = fapaiAnim.getChildByName("left_gang"); // 左边的抢
        var Rgun = fapaiAnim.getChildByName("right_gang"); // 右边的抢
        var mask = fapaiAnim.getChildByName("mask");
        /* -----------start及子节点----------- */
        var start = fapaiAnim.getChildByName("start"),
            quan = start.getChildByName("quan"),
            baodian = start.getChildByName("baodian"),
            ditan = start.getChildByName("ditan"),
            beginIco = start.getChildByName("begin_icon"),
            title = start.getChildByName("title"),
            rWing = start.getChildByName("rWing"),
            lWing = start.getChildByName("lWing");
        /* --------------------------------- */
        var self = this;
        fapaiAnim.active = true;
        mask.runAction(cc.scaleTo(0.2, 10, 10));
        Lgun.runAction(cc.sequence(self.LgunAction()));
        Rgun.runAction(cc.sequence(self.RgunAction()));

        var startFinished = cc.callFunc(function () {
            rWing.active = true;
            lWing.active = true;
            lWing.runAction(cc.sequence(cc.repeat(cc.sequence(cc.skewTo(0.05, 20, -10), cc.skewTo(0.05, 0, 0)), 3), cc.fadeOut(0)));
            rWing.runAction(cc.sequence(cc.repeat(cc.sequence(cc.skewTo(0.05, 20, -10), cc.skewTo(0.05, 0, 0)), 3), cc.fadeOut(0)));
        });
        var wingFinished = cc.callFunc(function () {
            setTimeout(function () {
                start.runAction(cc.scaleTo(0.2, 0, 0));
            }, 500);
        });
        setTimeout(function () {
            start.active = true;
            start.runAction(cc.sequence(cc.scaleTo(0.2, 1.5, 1.5), cc.scaleTo(0.2, 1, 1), startFinished, wingFinished));
            quan.runAction(cc.sequence(cc.scaleTo(0.2, 10, 10), cc.fadeOut(0)));
            baodian.runAction(cc.sequence(cc.scaleTo(0.2, 1.5, 1.5), cc.fadeOut(0)));
        }, 400);
        setTimeout(function () {
            lWing.active = false;
            rWing.active = false;
            start.active = false;
            fapaiAnim.active = false;
            fapaiAnim.removeFromParent(true);
        }, 2000);
    },
    LgunAction: function LgunAction() {
        // 左边的枪
        return [cc.spawn([cc.moveTo(0.2, cc.v2(-430, 152)), cc.scaleTo(0.2, 2, 2)]), cc.spawn([cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(-220, 0)), cc.rotateTo(0.2, 35)]), cc.fadeOut(0)];
    },
    RgunAction: function RgunAction() {
        // 右边的枪
        return [cc.spawn([cc.moveTo(0.2, cc.v2(430, 152)), cc.scaleTo(0.2, -2, 2)]), cc.spawn([cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(220, 0)), cc.rotateTo(0.2, -35)]), cc.fadeOut(0)];
    },
    _bezier1: function _bezier1(index) {
        var bezier = [];
        bezier[0] = [[cc.v2(100, 74), cc.v2(150, 174), cc.v2(200, -174)], cc.v2(100, 74)];
        bezier[1] = [[cc.v2(-72, 284), cc.v2(-122, 384), cc.v2(-222, -150)], cc.v2(-72, 284)];
        bezier[2] = [[cc.v2(-70, 200), cc.v2(-120, 300), cc.v2(-220, -200)], cc.v2(-70, 200)];
        bezier[3] = [[cc.v2(-123, 213), cc.v2(-173, 313), cc.v2(-273, -160)], cc.v2(-123, 213)];
        bezier[4] = [[cc.v2(110, 237), cc.v2(160, 337), cc.v2(260, -177)], cc.v2(210, 237)];
        bezier[5] = [[cc.v2(183, 115), cc.v2(233, 215), cc.v2(333, -155)], cc.v2(183, 115)];
        bezier[6] = [[cc.v2(92, 116), cc.v2(142, 216), cc.v2(242, -146)], cc.v2(92, 116)];
        bezier[7] = [[cc.v2(-26, 124), cc.v2(-76, 224), cc.v2(-176, -164)], cc.v2(-26, 124)];
        bezier[8] = [[cc.v2(-110, 81), cc.v2(-220, 131), cc.v2(-460, -180)], cc.v2(-110, 81)];
        bezier[9] = [[cc.v2(-125, 33), cc.v2(-225, 133), cc.v2(-275, -133)], cc.v2(-125, 33)];
        bezier[10] = [[cc.v2(0, 0), cc.v2(50, 100), cc.v2(150, -150)], cc.v2(0, 0)];
        bezier[11] = [[cc.v2(-235, 5), cc.v2(-275, 105), cc.v2(-375, -186)], cc.v2(-235, 5)];
        bezier[12] = [[cc.v2(-80, 4), cc.v2(-130, 104), cc.v2(-230, -233)], cc.v2(-80, 4)];
        bezier[13] = [[cc.v2(100, -7), cc.v2(150, 107), cc.v2(250, -177)], cc.v2(100, -7)];
        bezier[14] = [[cc.v2(154, 23), cc.v2(204, 113), cc.v2(254, -173)], cc.v2(254, 23)];
        return bezier[index];
    },
    // 青龙动画
    _qinglongAniamtion: function _qinglongAniamtion(type) {
        var qinglong = cc.instantiate(this.qinglong);
        this.node.addChild(qinglong);
        var bg = qinglong.getChildByName('bg');
        var title = '';
        if (type == "ql") {
            title = qinglong.getChildByName('qlongtitle');
        } else {
            title = qinglong.getChildByName('longtitle');
        }

        var yun1 = qinglong.getChildByName('yun1');
        var yun2 = qinglong.getChildByName('yun2');
        var yun3 = qinglong.getChildByName('yun3');
        var yun4 = qinglong.getChildByName('yun4');
        var long = qinglong.getChildByName("long");

        var hua1 = qinglong.getChildByName('hua1');
        var hua2 = qinglong.getChildByName('hua2');
        var hua3 = qinglong.getChildByName('hua3');
        var A = [],
            B = [],
            C = [];
        var hua = [];

        var test = cc.instantiate(hua1);

        var self = this;
        for (var i = 0; i < 5; i++) {
            A[i] = cc.instantiate(hua1);
            A[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(A[i]);
            B[i] = cc.instantiate(hua2);
            B[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(B[i]);
            C[i] = cc.instantiate(hua3);
            C[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(C[i]);
        };
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), cc.scaleTo(0.2, 2, 2), cc.spawn(cc.scaleTo(0.2, 1.5, 1.5), longStart)));
        });
        var longStart = cc.callFunc(function () {
            long.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 0.5)), cc.scaleTo(0.1, 3, 3), cc.spawn(cc.scaleTo(0.1, 1, 1), yunStart)));
        });
        var flowerStart = cc.callFunc(function () {});
        var yunStart = cc.callFunc(function () {
            yun1.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(-334, 234)), cc.moveTo(0.2, cc.v2(-344, 234))), 3)));
            yun2.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(-368, -82)), cc.moveTo(0.2, cc.v2(-358, -82))), 3)));
            yun3.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(408, -4)), cc.moveTo(0.2, cc.v2(398, -4))), 3)));
            yun4.runAction(cc.spawn(cc.fadeTo(0.2, 255), cc.repeat(cc.sequence(cc.moveTo(0.2, cc.v2(406, 181)), cc.moveTo(0.2, cc.v2(416, 181))), 3)));
            for (var i = 1; i < hua.length; i++) {
                hua[i].setPosition(self._bezier(i)[1]);
                qinglong.addChild(hua[i]);
                hua[i].runAction(cc.sequence(cc.spawn(cc.bezierTo(0.3, self._bezier(i)[0]), cc.scaleTo(0.3, 1, 1), cc.fadeTo(0.3, 0))));
            }
            setTimeout(function () {
                qinglong.removeFromParent(true);
            }, 1500);
            //yun1
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.scaleTo(0.2, 2, 2));
    },
    // 三顺子动画
    _sanshunziAnimation: function _sanshunziAnimation() {
        var sanshunzi = cc.instantiate(this.sanshunzi);
        this.node.addChild(sanshunzi);
        var bg = sanshunzi.getChildByName('bg');
        var Ltu = sanshunzi.getChildByName('Ltu');
        var Rtu = sanshunzi.getChildByName('Rtu');
        var title = sanshunzi.getChildByName('title');
        var zushun1 = sanshunzi.getChildByName('zushun1');
        var zushun2 = sanshunzi.getChildByName('zushun2');
        var zushun3 = sanshunzi.getChildByName('zushun3');
        var zushun4 = sanshunzi.getChildByName('zushun4');
        var zushun5 = sanshunzi.getChildByName('zushun5');
        var self = this;
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.2, 2.5, 2.5), titleScale));
            Ltu.runAction(cc.sequence(cc.fadeTo(0.2, 255)));
            Rtu.runAction(cc.sequence(cc.fadeTo(0.2, 255)));
        });
        var titleScale = cc.callFunc(function () {
            // title放大完成后 竹笋2和3同时进行
            title.runAction(cc.scaleTo(0.2, 1.5, 1.5));
            zushun2.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10), ZS1));
            zushun3.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 22, 22)), cc.scaleTo(0.2, 20, 20), ZS4));
            setTimeout(function () {
                zushun5.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10)));
            }, 100);
            setTimeout(function () {
                self.sanshunzi.active = false;
                sanshunzi.removeFromParent(true);
            }, 2000);
        });
        var ZS1 = cc.callFunc(function () {
            zushun1.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 12, 12)), cc.scaleTo(0.2, 10, 10)));
        });
        var ZS4 = cc.callFunc(function () {
            zushun4.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 14, 14)), cc.scaleTo(0.2, 12, 12)));
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.scaleTo(0.2, 2, 2));
    },
    // 全垒打
    _quanleidaAnimation: function _quanleidaAnimation() {
        var quanleida = cc.instantiate(this.quanleida);
        this.node.addChild(quanleida);
        var bg = quanleida.getChildByName('bg');
        var ball = quanleida.getChildByName('ball');
        var bangqiutao = quanleida.getChildByName('bangqiutao');
        var bangqiugun = quanleida.getChildByName('bangqiugun');
        var Lyun = quanleida.getChildByName('Lyun');
        var Ryun = quanleida.getChildByName('Ryun');
        var title = quanleida.getChildByName('title');
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.2, 2.5, 2.5), cc.scaleTo(0.2, 1.5, 1.5), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(0, 20)), cc.moveTo(0.3, cc.v2(0, 0))), 2)));

            Lyun.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 20, 20), cc.moveTo(0.2, cc.v2(-270, 70))), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(-270, 26)), cc.moveTo(0.3, cc.v2(-270, 46))), 2)));

            Ryun.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 20, 20), cc.moveTo(0.2, cc.v2(270, 70))), cc.repeat(cc.sequence(cc.moveTo(0.3, cc.v2(270, 66)), cc.moveTo(0.3, cc.v2(270, 46))), 2)));

            bangqiutao.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.3, 10, 10), cc.moveTo(0.3, cc.v2(250, 50))), bqtFinished));
        });
        var bqtFinished = cc.callFunc(function () {
            bangqiutao.runAction(cc.repeat(cc.sequence(cc.rotateTo(0.2, -10), cc.rotateTo(0.2, 0)), 3));
            ball.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.1, 255), cc.moveTo(0.2, cc.v2(196, 83))), ballFinished));
        });
        var ballFinished = cc.callFunc(function () {
            ball.runAction(cc.spawn(cc.fadeTo(0.2, 0), cc.moveTo(0.2, cc.v2(0, 0)), cc.scaleTo(0.2, 4, 4)));
            bangqiugun.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 2, 2), cc.fadeTo(0.2, 255)), cc.scaleTo(0.3, 1.5, 1.5)));
            setTimeout(function () {
                bg.runAction(cc.fadeTo(0.2, 0));
                ball.runAction(cc.fadeTo(0.2, 0));
                bangqiutao.runAction(cc.fadeTo(0.2, 0));
                bangqiugun.runAction(cc.fadeTo(0.2, 0));
                Lyun.runAction(cc.fadeTo(0.2, 0));
                Ryun.runAction(cc.fadeTo(0.2, 0));
                title.runAction(cc.fadeTo(0.2, 0));

                quanleida.removeFromParent(true);
            }, 2000);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    },

    // 三同花动画
    _santonghuaAnimation: function _santonghuaAnimation() {
        var santonghua = cc.instantiate(this.santonghua);
        this.node.addChild(santonghua);
        var bg = santonghua.getChildByName('bg');
        var hua1 = santonghua.getChildByName('hua1');
        var hua2 = santonghua.getChildByName('hua2');
        var hua3 = santonghua.getChildByName('hua3');
        var Rtaohua = santonghua.getChildByName('Rtaohua');
        var Ltaohua = santonghua.getChildByName('Ltaohua');
        var title = santonghua.getChildByName('title');
        var self = this;
        //var H1 = cc.instantiate(hua1);
        var A = [],
            B = [],
            C = [];
        var hua = [];
        for (var i = 0; i < 5; i++) {
            A[i] = cc.instantiate(hua1);
            A[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(A[i]);
            B[i] = cc.instantiate(hua2);
            B[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(B[i]);
            C[i] = cc.instantiate(hua3);
            C[i].runAction(cc.fadeTo(0.1, 255));
            hua.push(C[i]);
        };
        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), cc.scaleTo(0.2, 1, 1), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.1, 1.8, 1.8)));
            Ltaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(-160, -60)))));
            Rtaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(140, -60)))));
            for (var i = 1; i < hua.length; i++) {
                hua[i].setPosition(self._bezier(i)[1]);
                santonghua.addChild(hua[i]);
                hua[i].runAction(cc.sequence(cc.spawn(cc.bezierTo(0.3, self._bezier(i)[0]), cc.scaleTo(0.3, 1, 1), cc.fadeTo(0.3, 0))));
            }
            setTimeout(function () {
                bg.runAction(cc.fadeTo(0.2, 0));
                Rtaohua.runAction(cc.fadeTo(0.2, 0));
                Ltaohua.runAction(cc.fadeTo(0.2, 0));
                title.runAction(cc.fadeTo(0.2, 0));
                santonghua.removeFromParent(true);
            }, 1500);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.3, 255), cc.scaleTo(0.3, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    },
    // 贝塞尔曲线(只能定三个点)
    _bezier: function _bezier(index) {
        var bezier = [];
        bezier[0] = [[cc.v2(200, 74), cc.v2(250, 124), cc.v2(400, -174)], cc.v2(200, 74)];
        bezier[1] = [[cc.v2(-72, 284), cc.v2(-122, 334), cc.v2(-272, -150)], cc.v2(-72, 284)];
        bezier[2] = [[cc.v2(-270, 300), cc.v2(-320, 350), cc.v2(-420, -200)], cc.v2(-270, 300)];
        bezier[3] = [[cc.v2(-223, 213), cc.v2(-273, 263), cc.v2(-373, -160)], cc.v2(-223, 213)];
        bezier[4] = [[cc.v2(210, 237), cc.v2(260, 287), cc.v2(360, -177)], cc.v2(210, 237)];
        bezier[5] = [[cc.v2(183, 115), cc.v2(233, 164), cc.v2(333, -155)], cc.v2(183, 115)];
        bezier[6] = [[cc.v2(92, 116), cc.v2(142, 166), cc.v2(242, -146)], cc.v2(92, 116)];
        bezier[7] = [[cc.v2(-26, 124), cc.v2(-76, 174), cc.v2(-176, -164)], cc.v2(-26, 124)];
        bezier[8] = [[cc.v2(-310, 81), cc.v2(-360, 131), cc.v2(-460, -180)], cc.v2(-310, 81)];
        bezier[9] = [[cc.v2(-125, 33), cc.v2(-175, 83), cc.v2(-275, -133)], cc.v2(-125, 33)];
        bezier[10] = [[cc.v2(0, 0), cc.v2(50, 50), cc.v2(150, -150)], cc.v2(0, 0)];
        bezier[11] = [[cc.v2(-235, 5), cc.v2(-275, 55), cc.v2(-375, -86)], cc.v2(-235, 5)];
        bezier[12] = [[cc.v2(-80, 4), cc.v2(-130, 54), cc.v2(-230, -233)], cc.v2(-80, 4)];
        bezier[13] = [[cc.v2(100, -7), cc.v2(150, 57), cc.v2(250, -177)], cc.v2(100, -7)];
        bezier[14] = [[cc.v2(254, 23), cc.v2(304, 73), cc.v2(404, -173)], cc.v2(254, 23)];
        return bezier[index];
    },

    // 六对半动画
    _liuduibanAnimation: function _liuduibanAnimation() {
        var liuduiban = cc.instantiate(this.liuduiban);
        this.node.addChild(liuduiban);
        var bg = liuduiban.getChildByName('bg');
        var Lqi = liuduiban.getChildByName('Lqi');
        var Rqi = liuduiban.getChildByName('Rqi');
        var Cqi = liuduiban.getChildByName('Cqi');
        var Rtaohua = liuduiban.getChildByName('Rtaohua');
        var Ltaohua = liuduiban.getChildByName('Ltaohua');
        var title = liuduiban.getChildByName('title');

        var bgFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.2, 1, 1), cc.fadeTo(0.2, 255)), titleFinished));
        });
        var titleFinished = cc.callFunc(function () {
            title.runAction(cc.sequence(cc.scaleTo(0.1, 2.5, 2.5), cc.scaleTo(0.1, 1.8, 1.8), Finished));
            Ltaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(-160, -60)))));
            Rtaohua.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.scaleTo(0.2, 3, 3), cc.moveTo(0.2, cc.v2(140, -60)))));
        });
        var Finished = cc.callFunc(function () {
            Lqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(-103, 158))), cc.moveTo(0.2, cc.v2(-103, 168)), cc.moveTo(0.2, cc.v2(-103, 158))));
            Rqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(133, 160))), cc.moveTo(0.2, cc.v2(133, 170)), cc.moveTo(0.2, cc.v2(133, 160))));
            setTimeout(function () {
                Cqi.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.2, 255), cc.moveTo(0.2, cc.v2(20, 96))), cc.moveTo(0.2, cc.v2(20, 106)), cc.moveTo(0.2, cc.v2(20, 96))));
                Ltaohua.runAction(cc.sequence(cc.repeat(cc.sequence(cc.rotateTo(0.3, 10), cc.rotateTo(0.3, 0)), 2), thFinished));
                Rtaohua.runAction(cc.repeat(cc.sequence(cc.rotateTo(0.3, -10), cc.rotateTo(0.3, 0)), 2));
            }, 500);
        });
        var thFinished = cc.callFunc(function () {
            bg.runAction(cc.fadeTo(0.2, 0));
            Lqi.runAction(cc.fadeTo(0.2, 0));
            Rqi.runAction(cc.fadeTo(0.2, 0));
            Cqi.runAction(cc.fadeTo(0.2, 0));
            Rtaohua.runAction(cc.fadeTo(0.2, 0));
            Ltaohua.runAction(cc.fadeTo(0.2, 0));
            title.runAction(cc.fadeTo(0.2, 0));
            liuduiban.removeFromParent(true);
        });
        bg.runAction(cc.sequence(cc.spawn(cc.fadeTo(0.4, 255), cc.scaleTo(0.4, 30, 30)), bgFinished));
        title.runAction(cc.sequence(cc.scaleTo(0.2, 2, 2)));
    }
});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"cardNum":[function(require,module,exports){
"use strict";
cc._RFpush(module, '19329zUw3hCTpBk+7waBT2d', 'cardNum');
// scripts\cardNum.js

cc.Class({
    "extends": cc.Component,

    properties: {

        cards: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.totalCards();
    },
    totalCards: function totalCards() {
        // var create = this.node.children;
        //console.log(this.node);
        var renshu = this.node.getChildByName("renshu");
        var jushu = this.node.getChildByName("jushu");
        var getCard = this.node.getChildByName("cards");
        //var renshu = create[3], jushu = create[4], getCard = create[6];

        var rs = renshu.getComponent("singleSelect").selectedIndex;
        var js = jushu.getComponent("singleSelect").selectedIndex;
        var gc = getCard.getComponent("singleSelect").selectedIndex;

        var R = 1,
            J = 1,
            G = 1;
        switch (rs) {
            case 0:
                R = 1;break;
            case 1:
                R = 2;break;
            case 2:
                R = 3;break;
            case 3:
                R = 4;break;
        }
        switch (js) {
            case 0:
                J = 1;break;
            case 1:
                J = 2;break;
            case 2:
                J = 3;break;
        }
        switch (gc) {
            case 0:
                G = 1;break; // AA制
            default:
                G = 0;break;
        }
        this.cards.string = R + J;
        //this.cards.string = G ? (R+J):(R+J)*(R+3);  // (R+J)表示每个人要出的房卡量；(R+3)表示一共有多少人，  
    }
});

cc._RFpop();
},{}],"cardsBack":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98986IsXIdHiqLGEVIG2CWP', 'cardsBack');
// scripts\cardsBack.js

// 牌背影列表 component
// 可以显示、隐藏牌背影列表
cc.Class({
    "extends": cc.Component,

    properties: {
        cardsBackLayout: cc.Layout,
        cardsBackList: [cc.Sprite]
    },

    // use this for initialization
    onLoad: function onLoad() {},

    // 以动画的方式显示牌背影
    showPlayCardBacks: function showPlayCardBacks() {
        this.hideCardBacks();
        this.cardsBackLayout.node.active = true;

        var interval = 0.05;
        var startTime = 0;
        this.cardsBackList.forEach((function (cardBack) {
            this.scheduleOnce(function () {
                cardBack.node.active = true;
            }, startTime);
            startTime = startTime + interval;
        }).bind(this));
    },

    // 隐藏显示牌背影
    hideCardBacks: function hideCardBacks() {
        this.cardsBackLayout.node.active = false;
        this.cardsBackList.forEach(function (cardBack) {
            cardBack.node.active = false;
        });
    }
});

cc._RFpop();
},{}],"cards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0fcbct/TBxC742saKLuFviQ', 'cards');
// scripts\cards.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        /*牌花色*/
        spadesImages: [cc.SpriteFrame],
        heartsImages: [cc.SpriteFrame],
        clubImages: [cc.SpriteFrame],
        diamondImages: [cc.SpriteFrame]
    },

    // use this for initialization
    onLoad: function onLoad() {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"cellText":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9c9fd3OxWNEp4rijfjJv05t', 'cellText');
// scripts\cellText.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        labelMsg: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setText: function setText(text) {
        this.labelMsg.getComponent(cc.Label).string = text;
    },

    clickAction: function clickAction() {
        var text = this.labelMsg.getComponent(cc.Label).string;
        this.onSelectAction(text);
    },

    onSelectAction: function onSelectAction(msg) {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"changInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cb225d0jXtB0JToI7yXR0hG', 'changInfo');
// scripts\changInfo.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        phoneEditBox: cc.EditBox,
        wxEditBox: cc.EditBox,
        alert: cc.Prefab,
        canvas: cc.Node,
        _userId: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        this._registerSocketEvent();
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveOnChangeInfo, this._ReceiveChangeInfo, this);
    },
    _ReceiveChangeInfo: function _ReceiveChangeInfo(response) {
        var changedRows = response.data;
        var msg = '';
        //console.log(response);
        //console.log(changedRows);
        //console.log("-------------------------------38");
        if (changedRows) {
            msg = "更改成功";
        } else {
            msg = "今天已经更新过了，请明天再更新";
        }
        this.alertMsg(msg);
    },
    clickAction: function clickAction() {
        var wx = this.wxEditBox.string;
        var phone = this.phoneEditBox.string;
        var info = {};
        var msg = '';
        if (!wx && !phone) {
            msg = "请填写微信号和手机号";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (!/(^[1-9]\d*$)/.test(phone)) {
            msg = "您输入的手机号码格式不对，请重新输入";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (phone.length != 11) {
            msg = "您输入的手机号码不够11位，请重新输入";
            phone = "";
            this.alertMsg(msg);
            return;
        }
        if (!/(^[1-9a-zA-Z]\d*$)/.test(wx)) {
            msg = "您输入的微信号格式不对，请重新输入";
            wx = "";
            this.alertMsg(msg);
            return;
        }
        if (wx.length < 6 || wx.length > 20) {
            msg = "您输入的微信号格式超出范围，请输入6~20位的微信号";
            wx = "";
            this.alertMsg(msg);
            return;
        }
        info.wx = wx;
        info.phone = phone;
        Socket.sendChangeInfo(this._userId, info);
    },

    alertMsg: function alertMsg(msg) {
        var alert = cc.instantiate(this.alert);
        this.canvas.addChild(alert);
        var comp = alert.getComponent('alert');
        comp.setMessage(msg);
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"change_mapai":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'ed8274emaRL471ny4dnQ8cA', 'change_mapai');
// scripts\change_mapai.js

cc.Class({
    "extends": cc.Component,

    properties: {

        mPtitle: cc.Label,
        _cards: [],
        renshuSelect: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        var hs = 3;
        var ds = 5;
        if (cc.set) {
            hs = cc.set.setting7[0];
            ds = cc.set.setting7[1];
        }
        this._cards = [hs, ds];
        this.mp(hs, ds);
    },
    change: function change() {
        var selectedIndex = this.renshuSelect.getComponent('singleSelect').selectedIndex;
        var hs = Math.ceil(Math.random() * 40 / 10); //获取一个1~4的数字，代表花色
        var ds = Math.ceil(Math.random() * 130 / 10); //获取一个1~13的数字，代表点数
        var card = [hs, ds];
        this._cards = card;
        this.mp(hs, ds, selectedIndex);
    },
    mp: function mp(h, d, index) {
        var ma = "单码";
        var hs = ["方块", "梅花", "红桃", "黑桃"];
        var ds = ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"];
        if (index) {
            var defaultMa = 4;
            if (h >= defaultMa - index + 1) {
                ma = "双码";
            }
        }
        this.mPtitle.string = hs[h - 1] + ds[d - 1] + ma;
    }
});

cc._RFpop();
},{}],"checkSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '974a0c6jzZPRI5AeaAb4U0z', 'checkSelect');
// scripts\checkSelect.js

cc.Class({
    "extends": cc.Component,

    properties: {
        selectedIndex: 0,
        selectedNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selected = true;
        this.selectedIndex = 0;
        this.selectedNode.active = true;
    },
    clickAction: function clickAction(e, data) {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        this.selectedIndex = this.selected ? 0 : null;
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"choujiang":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f64e0whLhNLmbOHtPpK94CG', 'choujiang');
// scripts\choujiang.js

var socket = require("socket");
cc.Class({
    "extends": cc.Component,

    properties: {
        option: {
            "default": [],
            type: cc.Node
        }
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickBtnchoujiang: function clickBtnchoujiang() {
        for (var i = 0; i < this.option.length; i++) {
            this.option[i].opacity = 255;
        }
        var index = 0;
        this._tishi = this.node.getChildByName("choujiang_bg").getChildByName("tishi");
        this._card_num = cc.find("Canvas/user/shop_bg/card_num");
        var comp = this._card_num.getComponent(cc.Label);
        this.callback = function () {
            if (index == 0) {
                this.option[index].opacity = 128;
                this.option[this.option.length - 1].opacity = 255;
            } else if (index == 1) {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            } else {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            }
            index++;
            if (index == this.option.length) {
                index = 0;
            }
        };
        if (comp.string < 20) {
            this._tishi.active = true;
        } else {
            //choujiang
            this.schedule(this.callback, 0.05);
            this.schedule(function () {
                this.unschedule(this.callback);
                for (var i = 0; i < this.option.length; i++) {
                    this.option[i].opacity = 255;
                }
                var i = Math.floor(Math.random() * 12);
                this.option[i].opacity = 128;
            }, 3, 0, 1);
        }
    },

    //***
    clickBtnComfirm: function clickBtnComfirm() {
        this._tishi.active = false;
        //this.node.active = false;
    }
});
//****

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"socket":"socket"}],"create_btn_anima":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'df337riLglP3YcI/IJFXecj', 'create_btn_anima');
// scripts\create_btn_anima.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...

    },

    // use this for initialization
    onLoad: function onLoad() {},
    loadCardSpriteFrame: function loadCardSpriteFrame(cardName, callback) {
        this._loadCardFrame(cardName, callback);
    },
    _cardFullName: function _cardFullName(cardShortName) {
        var cardName = cardShortName;
        if (!cardName.startsWith("public-pic-card-poker")) {
            cardName = "public-pic-card-poker-" + cardName;
        }
        return cardName;
    },
    _loadCardFrame: function _loadCardFrame(cardName, callback) {
        cc.assert(callback);
        cc.loader.loadRes("play/hall/public/all_effect_ttw_main", cc.SpriteAtlas, (function (err, atlas) {
            if (err) {
                callback(null, err);
                return;
            }
            cardName = this._cardFullName(cardName);
            var frame = atlas.getSpriteFrame(cardName);
            callback(frame);
        }).bind(this));
    },
    test: function test() {}

});

cc._RFpop();
},{}],"fecha":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e517077l0xMarB9uQsXGzvk', 'fecha');
// scripts\Extensions\fecha.js

(function (main) {
  'use strict';

  /**
   * Parse or format dates
   * @class fecha
   */
  var fecha = {};
  var token = /d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g;
  var twoDigits = /\d\d?/;
  var threeDigits = /\d{3}/;
  var fourDigits = /\d{4}/;
  var word = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;
  var literal = /\[([^]*?)\]/gm;
  var noop = function noop() {};

  function shorten(arr, sLen) {
    var newArr = [];
    for (var i = 0, len = arr.length; i < len; i++) {
      newArr.push(arr[i].substr(0, sLen));
    }
    return newArr;
  }

  function monthUpdate(arrName) {
    return function (d, v, i18n) {
      var index = i18n[arrName].indexOf(v.charAt(0).toUpperCase() + v.substr(1).toLowerCase());
      if (~index) {
        d.month = index;
      }
    };
  }

  function pad(val, len) {
    val = String(val);
    len = len || 2;
    while (val.length < len) {
      val = '0' + val;
    }
    return val;
  }

  var dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
  var monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  var monthNamesShort = shorten(monthNames, 3);
  var dayNamesShort = shorten(dayNames, 3);
  fecha.i18n = {
    dayNamesShort: dayNamesShort,
    dayNames: dayNames,
    monthNamesShort: monthNamesShort,
    monthNames: monthNames,
    amPm: ['am', 'pm'],
    DoFn: function DoFn(D) {
      return D + ['th', 'st', 'nd', 'rd'][D % 10 > 3 ? 0 : (D - D % 10 !== 10) * D % 10];
    }
  };

  var formatFlags = {
    D: function D(dateObj) {
      return dateObj.getDate();
    },
    DD: function DD(dateObj) {
      return pad(dateObj.getDate());
    },
    Do: function Do(dateObj, i18n) {
      return i18n.DoFn(dateObj.getDate());
    },
    d: function d(dateObj) {
      return dateObj.getDay();
    },
    dd: function dd(dateObj) {
      return pad(dateObj.getDay());
    },
    ddd: function ddd(dateObj, i18n) {
      return i18n.dayNamesShort[dateObj.getDay()];
    },
    dddd: function dddd(dateObj, i18n) {
      return i18n.dayNames[dateObj.getDay()];
    },
    M: function M(dateObj) {
      return dateObj.getMonth() + 1;
    },
    MM: function MM(dateObj) {
      return pad(dateObj.getMonth() + 1);
    },
    MMM: function MMM(dateObj, i18n) {
      return i18n.monthNamesShort[dateObj.getMonth()];
    },
    MMMM: function MMMM(dateObj, i18n) {
      return i18n.monthNames[dateObj.getMonth()];
    },
    YY: function YY(dateObj) {
      return String(dateObj.getFullYear()).substr(2);
    },
    YYYY: function YYYY(dateObj) {
      return dateObj.getFullYear();
    },
    h: function h(dateObj) {
      return dateObj.getHours() % 12 || 12;
    },
    hh: function hh(dateObj) {
      return pad(dateObj.getHours() % 12 || 12);
    },
    H: function H(dateObj) {
      return dateObj.getHours();
    },
    HH: function HH(dateObj) {
      return pad(dateObj.getHours());
    },
    m: function m(dateObj) {
      return dateObj.getMinutes();
    },
    mm: function mm(dateObj) {
      return pad(dateObj.getMinutes());
    },
    s: function s(dateObj) {
      return dateObj.getSeconds();
    },
    ss: function ss(dateObj) {
      return pad(dateObj.getSeconds());
    },
    S: function S(dateObj) {
      return Math.round(dateObj.getMilliseconds() / 100);
    },
    SS: function SS(dateObj) {
      return pad(Math.round(dateObj.getMilliseconds() / 10), 2);
    },
    SSS: function SSS(dateObj) {
      return pad(dateObj.getMilliseconds(), 3);
    },
    a: function a(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0] : i18n.amPm[1];
    },
    A: function A(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0].toUpperCase() : i18n.amPm[1].toUpperCase();
    },
    ZZ: function ZZ(dateObj) {
      var o = dateObj.getTimezoneOffset();
      return (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4);
    }
  };

  var parseFlags = {
    D: [twoDigits, function (d, v) {
      d.day = v;
    }],
    Do: [new RegExp(twoDigits.source + word.source), function (d, v) {
      d.day = parseInt(v, 10);
    }],
    M: [twoDigits, function (d, v) {
      d.month = v - 1;
    }],
    YY: [twoDigits, function (d, v) {
      var da = new Date(),
          cent = +('' + da.getFullYear()).substr(0, 2);
      d.year = '' + (v > 68 ? cent - 1 : cent) + v;
    }],
    h: [twoDigits, function (d, v) {
      d.hour = v;
    }],
    m: [twoDigits, function (d, v) {
      d.minute = v;
    }],
    s: [twoDigits, function (d, v) {
      d.second = v;
    }],
    YYYY: [fourDigits, function (d, v) {
      d.year = v;
    }],
    S: [/\d/, function (d, v) {
      d.millisecond = v * 100;
    }],
    SS: [/\d{2}/, function (d, v) {
      d.millisecond = v * 10;
    }],
    SSS: [threeDigits, function (d, v) {
      d.millisecond = v;
    }],
    d: [twoDigits, noop],
    ddd: [word, noop],
    MMM: [word, monthUpdate('monthNamesShort')],
    MMMM: [word, monthUpdate('monthNames')],
    a: [word, function (d, v, i18n) {
      var val = v.toLowerCase();
      if (val === i18n.amPm[0]) {
        d.isPm = false;
      } else if (val === i18n.amPm[1]) {
        d.isPm = true;
      }
    }],
    ZZ: [/([\+\-]\d\d:?\d\d|Z)/, function (d, v) {
      if (v === 'Z') v = '+00:00';
      var parts = (v + '').match(/([\+\-]|\d\d)/gi),
          minutes;

      if (parts) {
        minutes = +(parts[1] * 60) + parseInt(parts[2], 10);
        d.timezoneOffset = parts[0] === '+' ? minutes : -minutes;
      }
    }]
  };
  parseFlags.dd = parseFlags.d;
  parseFlags.dddd = parseFlags.ddd;
  parseFlags.DD = parseFlags.D;
  parseFlags.mm = parseFlags.m;
  parseFlags.hh = parseFlags.H = parseFlags.HH = parseFlags.h;
  parseFlags.MM = parseFlags.M;
  parseFlags.ss = parseFlags.s;
  parseFlags.A = parseFlags.a;

  // Some common format strings
  fecha.masks = {
    'default': 'ddd MMM DD YYYY HH:mm:ss',
    shortDate: 'M/D/YY',
    mediumDate: 'MMM D, YYYY',
    longDate: 'MMMM D, YYYY',
    fullDate: 'dddd, MMMM D, YYYY',
    shortTime: 'HH:mm',
    mediumTime: 'HH:mm:ss',
    longTime: 'HH:mm:ss.SSS'
  };

  /***
   * Format a date
   * @method format
   * @param {Date|number} dateObj
   * @param {string} mask Format of the date, i.e. 'mm-dd-yy' or 'shortDate'
   */
  fecha.format = function (dateObj, mask, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof dateObj === 'number') {
      dateObj = new Date(dateObj);
    }

    if (Object.prototype.toString.call(dateObj) !== '[object Date]' || isNaN(dateObj.getTime())) {
      throw new Error('Invalid Date in fecha.format');
    }

    mask = fecha.masks[mask] || mask || fecha.masks['default'];

    var literals = [];

    // Make literals inactive by replacing them with ??
    mask = mask.replace(literal, function ($0, $1) {
      literals.push($1);
      return '??';
    });
    // Apply formatting rules
    mask = mask.replace(token, function ($0) {
      return $0 in formatFlags ? formatFlags[$0](dateObj, i18n) : $0.slice(1, $0.length - 1);
    });
    // Inline literal values back into the formatted value
    return mask.replace(/\?\?/g, function () {
      return literals.shift();
    });
  };

  /**
   * Parse a date string into an object, changes - into /
   * @method parse
   * @param {string} dateStr Date string
   * @param {string} format Date parse format
   * @returns {Date|boolean}
   */
  fecha.parse = function (dateStr, format, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof format !== 'string') {
      throw new Error('Invalid format in fecha.parse');
    }

    format = fecha.masks[format] || format;

    // Avoid regular expression denial of service, fail early for really long strings
    // https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
    if (dateStr.length > 1000) {
      return false;
    }

    var isValid = true;
    var dateInfo = {};
    format.replace(token, function ($0) {
      if (parseFlags[$0]) {
        var info = parseFlags[$0];
        var index = dateStr.search(info[0]);
        if (! ~index) {
          isValid = false;
        } else {
          dateStr.replace(info[0], function (result) {
            info[1](dateInfo, result, i18n);
            dateStr = dateStr.substr(index + result.length);
            return result;
          });
        }
      }

      return parseFlags[$0] ? '' : $0.slice(1, $0.length - 1);
    });

    if (!isValid) {
      return false;
    }

    var today = new Date();
    if (dateInfo.isPm === true && dateInfo.hour != null && +dateInfo.hour !== 12) {
      dateInfo.hour = +dateInfo.hour + 12;
    } else if (dateInfo.isPm === false && +dateInfo.hour === 12) {
      dateInfo.hour = 0;
    }

    var date;
    if (dateInfo.timezoneOffset != null) {
      dateInfo.minute = +(dateInfo.minute || 0) - +dateInfo.timezoneOffset;
      date = new Date(Date.UTC(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0));
    } else {
      date = new Date(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0);
    }
    return date;
  };

  /* istanbul ignore next */
  if (typeof module !== 'undefined' && module.exports) {
    module.exports = fecha;
  } else if (typeof define === 'function' && define.amd) {
    define(function () {
      return fecha;
    });
  } else {
    main.fecha = fecha;
  }
})(this);

cc._RFpop();
},{}],"game":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45811N61jFFA6UrygQla5+x', 'game');
// scripts\game.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        messageNode: cc.Node,
        playNode: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {},

    showMessageAlert: function showMessageAlert() {
        this.messageNode.active = true;
        var comp = this.messageNode.getComponent(cc.Animation);
        comp.play('pop');
    },

    dismissMessageAlert: function dismissMessageAlert() {
        var self = this;
        this.scheduleOnce(function () {
            self.messageNode.active = false;
        }, 0.3);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"hall_btn_anima":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b8a30Txa91I27+7HOFLyJA6', 'hall_btn_anima');
// scripts\hall_btn_anima.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        create_anima: {
            type: cc.SpriteFrame,
            "default": []
        }
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"hall":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1e6741Q2VFGDLupV88mg60Z', 'hall');
// scripts\hall.js

var manager = require('manager');
var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var Playback = require('Playback');

var hall = cc.Class({
    'extends': cc.Component,

    properties: {

        //productNodes:[cc.Node],
        shopAlertNode: cc.Node,
        createNode: cc.Node,
        joinNode: cc.Node,
        gengxin: cc.Node,
        alertPrefab: cc.Prefab,
        tsSingleSelect: [cc.Node], // 创建房间信息，单选
        tsCheckSeclect: [cc.Node], // 创建房间信息，复选
        selectMoShi: cc.Node, // 创建房间信息，模式（庄家模式和无特殊牌）
        selectGuiPai: cc.Node, // 创建房间信息，模式（庄家模式和无特殊牌）
        overTime: cc.Node, // 超时出牌
        //labelNotice: cc.Label,      // 公告
        labelBanner: cc.Label, // banner label
        recordNode: cc.Node,
        waitingPrefab: cc.Prefab,
        setting: cc.Node,
        //用户信息
        avatarNode: cc.Node,
        nickNameLabel: cc.Label,
        cardNumberLabel: cc.Label,
        userIdLabel: cc.Label,
        codeLabel: cc.Label,
        //phone:cc.Label,
        // userInfoMsgNode:cc.Node,
        logoutNode: cc.Node,
        //战绩
        recordMsgNode: cc.Node,
        feedbackEditBox: cc.EditBox, //反馈
        feedbackNode: cc.Node,
        wxshare: cc.Node,
        _userId: 0,
        _openId: null,
        _help: null,
        _close: null,
        iosUrl: null,
        aUrl: null

    },

    statics: {
        lastHallInfo: null, // 上一次收到的大厅信息
        cacheImageInfo: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.keyBackListen();
        if (cc.sys.isBrowser) {
            if (window.shareToTimeLine) {
                window.shareToTimeLine();
            }
            if (window.shareToSession) {
                window.shareToSession();
            }
        }
        cc.sys.localStorage.removeItem("timestamp");
        var bg = this.node.getChildByName("room_bg");
        var windowP = cc.director.getWinSizeInPixels();
        var scaleX = windowP.width / bg.width;
        var scaleY = windowP.height / bg.height;
        var scale = Math.max(scaleX, scaleY);
        bg.scaleX = scale;
        bg.scaleY = scale;
        this.clearLocalStorage();
        cc.from = {};
        cc.from.isUseMa = true;
        cc.from.ma = 0;
        cc.isRoomViewShow = false;
        this._btn = this.node.getChildByName("btn");
        this._buttons = this.node.getChildByName("buttons");
        var volume = cc.sys.localStorage.getItem("bgVolume");
        if (volume != null && parseInt(volume)) {
            AudioManager.instance.playMusic();
        }

        var bgSound = cc.sys.localStorage.getItem("bgSound");
        if (bgSound == 0) {
            var audioManager = cc.find('AudioManager');
            audioManager = audioManager.getComponent('AudioManager');
            audioManager.setEffectMusicVolum(bgSound);
        }
        Playback.instance.removePlaybackDatas();

        hall.cacheImageInfo = hall.cacheImageInfo || {};

        this._registerSocketEvent();
        this._startBannerAnimation();
        this._initJoinRoom();

        this._userId = Socket.instance.userInfo.id;
        this._openId = Socket.instance.userInfo.openId;
        this._inviteCode = Socket.instance.userInfo.inviteCode; //邀请码
        var self = this;
        this.socket = cc.find('GameSocket').getComponent('socket');
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
        };

        this.socket.connectionSuccess = function () {
            self.hiddenNetworkMessage();
            self.hiddenCheckMessage();
        };
        this.socket.connectionDisconnect = function () {
            self.showNetworkMessage('网络链接断开，重新连接中...');
        };
        this.socket.checkNetworkNow = function () {
            self.showCheckMessage('检查网络中...');
        };
        this.socket.checkNetworkEnd = function () {
            self.hiddenCheckMessage();
            self.hiddenNetworkMessage();
        };

        //  /*设置用户信息*/
        this.updateUserInfo();
        /*刷新用户信息*/
        Socket.sendGetUserInfo(this._userId, this._openId);
        /*定时刷新用户信息*/
        this.schedule((function () {
            Socket.sendGetUserInfo(this._userId, this._openId);
        }).bind(this), 10); //10s一次
        Socket.sendGetHallInfo(this.socket.userInfo.id);
        if (hall.lastHallInfo) {
            this.updateBanner(hall.lastHallInfo.info);
        }
        cc.onShareWXResp = null;
        cc.director.preloadScene('play', function () {
            cc.director.preloadScene('login');
        });
        if (cc.joinDesk != null) {
            if (!cc.joinDesk.result) {
                var reason = cc.joinDesk.reason;
                this.alertMessage(reason);
            }
            cc.joinDesk = null;
        }
        if (cc.qingli != null) {
            this.alertMessage("您被房主请出房间");
            cc.qingli = null;
        }
        //var creatAnima = this.node.getChildByName("create_room");
    },

    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },

    clickWxShare: function clickWxShare() {
        if (!cc.sys.isNative) {
            this.wxshare.active = true;
        } else {
            var title = cc.sys.localStorage.getItem('shareTitle');
            var description = cc.sys.localStorage.getItem('desc');
            var recordId = cc.sys.localStorage.getItem('recordId');
            var id = '';
            if (recordId) {
                id = 'recordId=' + recordId;
            }

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
            }
        }
    },

    //分享到朋友圈
    shareHallTimeline: function shareHallTimeline() {
        if (!cc.sys.isNative) {
            this.wxshare.active = true;
        } else {
            var title = cc.sys.localStorage.getItem('shareTitle');
            var description = cc.sys.localStorage.getItem('desc');
            var recordId = cc.sys.localStorage.getItem('recordId');
            var id = '';
            if (recordId) {
                id = 'recordId=' + recordId;
            }

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
            }
        }
    },

    shareBg: function shareBg() {
        if (!cc.sys.isNative) {
            this.wxshare.active = false;
        } else {
            // if (KQNativeInvoke.isNativeIOS()) {
            //     jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,"wxShareHallTimeline",id, description,title);
            // }
            // else {//Android
            //     var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            //     jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str,id, description,title);
            // }
        }
    },

    clearLocalStorage: function clearLocalStorage() {
        var shareTitle = '开房玩[大众十三水]';
        var desc = '开好房了，就等你们一起来[大众十三水]啦！晚了位置就没了哟~';
        cc.sys.localStorage.removeItem('roomId');
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
        this.socket.connectionSuccess = function () {};
        this.socket.connectionDisconnect = function () {};
        this.socket.checkNetworkNow = function () {};
        this.socket.checkNetworkEnd = function () {};

        KQGlobalEvent.offTarget(this);
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.JoinDesk, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveCreateDesk, this._createRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGetUserInfo, this._socketReceiveUserInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        //KQGlobalEvent.on(Socket.Event.ReceiveInviteCode, this._socketReceiveInviteCode, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        //KQGlobalEvent.on(Socket.Event.ReceiveSharePng, this._socketSharePng, this);
    },

    // 跳转到公众号
    guanzhu: function guanzhu() {
        // var url = "http://www.honggefeng.cn/gzh/index.html";
        // cc.sys.openURL(url)
    },
    _startBannerAnimation: function _startBannerAnimation() {
        var anim = this.labelBanner.getComponent(cc.Animation);
        anim.play('banner');
    },
    downLoad: function downLoad() {
        var url = 'https://fir.im/5tne';
        cc.sys.openURL(url);

        //window.location.href = "http://www.baidu.com";
        //console.log("？？？？？？？？");
    },

    _initJoinRoom: function _initJoinRoom() {
        var self = this;
        var joinRoom = this.joinNode.getComponent('joinRoom');

        joinRoom.callbackJoinRoom = function (number) {
            // self.joinNode.getComponent('alert').dismissAction();
            // self.showWaitingMessage('加入中...');
            // self.scheduleOnce(function() {
            //     self.hiddenWaitingMessage();
            // }, 2.0);

            /*加入房间请求*/
            var userId = Socket.instance.userInfo.id;
            Socket.sendJoinDesk(number, userId);
        };
    },

    _jiinRoomSocketCallback: function _jiinRoomSocketCallback(response) {
        var _this2 = this;

        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            (function () {
                if (cc.from == null) {
                    cc.from = {};
                }
                var joinRoom = _this2.joinNode.getComponent('joinRoom');

                _this2.joinNode.getComponent('alert').setAlertCallbck(function () {
                    joinRoom.clickClear();
                });
                cc.from.ma = response.data.maPai;
                cc.director.loadScene('play');
            })();
        } else {
            var reasonInfo = this._joinReasonMap(response.data.reason);
            this.alertMessage(reasonInfo);
        }
    },

    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!response.result) {
            return;
        }
        var data = response.data;
        hall.lastHallInfo = data;
        var isIOS = data.isIOS;
        var isAndroid = data.isA;
        var vIOS = data.vIOS;
        var vA = data.vA;
        this.iosUrl = data.iosUrl;
        this.aUrl = data.aUrl;
        if (cc.sys.isNative) {
            if (KQNativeInvoke.isNativeIOS()) {
                if (isIOS == 1) {
                    if (vIOS != '1.0.3') {
                        this.gengxin.active = true;
                    }
                }
            } else {
                //Android
                if (isAndroid == 1) {
                    if (vA != '1.0.4') {
                        this.gengxin.active = true;
                    }
                }
            }
        }
        var notice = data.broadcast;
        var banner = data.info;
        //this.updateNotice(notice);
        this.updateBanner(banner);
    },
    downloadNewVersion: function downloadNewVersion() {
        if (KQNativeInvoke.isNativeIOS()) {
            cc.sys.openURL(this.iosUrl);
            // jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", this.iosUrl);
        } else {
                //Android
                cc.sys.openURL(this.aUrl);
                // jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", this.aUrl);
            }
    },
    _createRoomSocketCallback: function _createRoomSocketCallback(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            cc.director.loadScene('play');
        }
        /*如果钻石不足，则提示*/
        else {
                this.alertMessage("您的钻石不足");
            }
    },

    _joinReasonMap: function _joinReasonMap(reason) {
        var reasonInfo = {
            notExist: "房间不存在!",
            cardNumber: "您房卡不足!"
        };

        var info = reasonInfo[reason] || "房间已满!";
        return info;
    },

    /*shop*/
    shopAction: function shopAction() {
        var comp = this.shopAlertNode.getComponent('alert');
        comp.alert();
    },
    /*提示*/
    alertMessage: function alertMessage(msg) {
        var node = cc.instantiate(this.alertPrefab);
        this.node.addChild(node);
        var comp = node.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    //updateNotice: function (notice) {
    //    if(this.labelNotice == null){
    //        return;
    //    }
    //  this.labelNotice.string = notice || "";
    //},

    updateBanner: function updateBanner() {
        var banner = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        if (this.labelBanner == null) {
            return;
        }
        this.labelBanner.string = banner;
    },

    /*#####
    * setting1 局数  (0 | 1 | 2 )
    * setting2 人数  (0 | 1 | 2 | 3)
    * setting3 玩法  (0 | 1 | 2 | 3 | 4)
    * setting4 AA制收取房费  (0 | 1 | 2 )
    * setting5 其他  (0)
    * setting6  
    * setting7
    * */
    createDoneAction: function createDoneAction() {
        var info = {};
        var self = this;
        var key = ['setting1', 'setting2', 'setting4', 'setting5'];
        for (var i = 0; i < this.tsSingleSelect.length; i++) {
            var tsIndex = self.tsSingleSelect[i].getComponent('singleSelect').selectedIndex;
            info[key[i]] = tsIndex;
        }

        info['setting3'] = this.selectMoShi.getComponent('selectMoShi')._select;
        info['setting6'] = this.overTime.getComponent('overTime')._selected;
        //console.log( info['setting6'] );
        if (!info['setting3'][3]) {
            // 玩法 [疯狂场,鬼牌,比花色,坐庄,马牌] info['setting3'][3]第三项表示坐庄模式，非坐庄模式的倍率是1倍
            info['setting5'] = 0; // 倍率 (0~1) == (1~3倍)
        }
        info['setting8'] = null;

        info['setting7'] = this.selectMoShi.getComponent('change_mapai')._cards;
        cc.set = info;
        info['userId'] = this.socket.userInfo.id; //用户Id
        this.socket.sendMessage('createDesk', info);

        this.createNode.getComponent('alert').dismissAction();

        //let self = this;
        this.showWaitingMessage('创建中...');
        this.scheduleOnce(function () {
            self.hiddenWaitingMessage();
        }, 2.0);
    },

    // 随机场
    /*clickRandRoom: function () {
      cc.director.loadScene('randRoom');
    },*/

    clickRecord: function clickRecord() {
        var comp = this.recordNode.getComponent('alert');
        comp.alert();
        Socket.sendGetRecrod(Socket.instance.userInfo.id);
    },

    clickPlayRule: function clickPlayRule() {
        //cc.director.loadScene('rule');
        this.help = this.node.getChildByName("help");
        var comp = this.help.getComponent('alert');
        comp.alert();
    },

    clickPlay: function clickPlay() {
        if (cc.clickOut) cc.director.loadScene('play');
    },

    /*切换账号*/
    clickCancelLation: function clickCancelLation() {
        this.logoutNode.getComponent('alert').alert();
    },

    logoutAction: function logoutAction() {
        //manager.setUserInfo('');
        cc.director.loadScene('login');
        hall.cacheImageInfo = null;
    },

    exitAction: function exitAction() {
        //manager.setUserInfo('');
        if (!cc.sys.isNative) {
            cc.director.loadScene('login');
            hall.cacheImageInfo = null;
            return;
        }

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
        cc.director.end();
    },

    //接收处理用户数据
    _socketReceiveUserInfo: function _socketReceiveUserInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!this.socket.userInfo) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }
        //console.log(response,"----------------------用户信息");
        //this.phone.string = response.data.phone ? response.data.phone : "无";
        this.setting.getComponent('Setting')._phone = response.data.phone ? response.data.phone : null;
        this.setting.getComponent('Setting').phone.string = response.data.phone ? response.data.phone : '无';
        this.nickNameLabel.string = response.data.nickname; // 用户名
        this.userIdLabel.string = 'ID: ' + response.data.id; // ID
        this.cardNumberLabel.string = response.data.cardNumber;
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        cc.loader.load({ url: response.data.avatarUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;
            }
        });
    },

    _socketDisconnect: function _socketDisconnect() {
        this.showNetworkMessage("网络链接断开，重新连接中...");
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    //更新用户信息
    updateUserInfo: function updateUserInfo() {
        var info = this.socket.userInfo;
        if (!info) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }

        this.nickNameLabel.string = info.nickname;
        this.userIdLabel.string = 'ID: ' + info.id;
        this.cardNumberLabel.string = info.cardNumber;

        var avatarUrl = info.avatarUrl + ".jpg";
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        var texture = hall.cacheImageInfo[avatarUrl];
        if (texture) {
            var frame = new cc.SpriteFrame(texture);
            if (frame) {
                //cc.log("从缓存中加载头像");
                sprite.spriteFrame = frame;
                return;
            }
        }

        cc.loader.load({ url: info.avatarUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;

                hall.cacheImageInfo[avatarUrl] = tex;
            }
        });
    },

    /*提交意见*/
    feedbackAcion: function feedbackAcion() {
        var userId = this.socket.userInfo.id;
        var text = this.feedbackEditBox.string;
        if (text.length > 0) {
            this.feedbackNode.getComponent('alert').dismissAction();
            Socket.sendFeedback(userId, text);
            this.feedbackEditBox.string = '';
        }
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.sys.isObjectValid(this.waitingNode)) {
            this.waitingNode.destory();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    //network
    showNetworkMessage: function showNetworkMessage(msg) {
        if (this.networkNode && this.networkNode.active) {
            var _alert = this.networkNode.getComponent('alert');
            if (_alert.getMessage() == msg) {
                return;
            }
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage(msg) {
        if (!(this.checkNode && this.checkNode.active)) {} else {
            var _alert2 = this.checkNode.getComponent('alert');
            if (_alert2.getMessage() == msg) {
                return;
            }
        }

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },
    onBtnClick: function onBtnClick() {
        if (this._buttons.active) {
            this._buttons.active = false;
        } else {
            this._buttons.active = true;
        }
    }

});

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },
module.exports = hall;

cc._RFpop();
},{"AudioManager":"AudioManager","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","manager":"manager","socket":"socket"}],"help":[function(require,module,exports){
"use strict";
cc._RFpush(module, '09981CwNMZOI4DHUg8u9kcj', 'help');
// scripts\help.js

cc.Class({
    "extends": cc.Component,
    properties: {
        /*sprites: {
            default: null,
            type: cc.SpriteAtlas
        },*/
        play_method_before: cc.Node, //玩法介绍
        play_method_content_label: cc.Node, //玩法介绍内容
        introduce_pai_before: cc.Node, //牌型介绍
        details: cc.Node, //牌型介绍内容
        caozuo_before: cc.Node, //操作介绍
        caozuo_content: cc.Node, //操作介绍内容
        _btn: null,
        _content: null,
        _buttonCom: null,
        _play_method_button: null,
        _introduce_pai_button: null,
        _caozuo_button: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        //this._play_method_button = this.play_method_before.getComponent(cc.Button);
        //this._introduce_pai_button = this.introduce_pai_before.getComponent(cc.Button);
        //this._caozuo_button = this.caozuo_before.getComponent(cc.Button);
        //this._btn = [this.play_method_before,this.introduce_pai_before,this.caozuo_before];
        //this._content = [this.play_method_content_label,this.details,this.caozuo_content];
        //this._buttonCom = [this._play_method_button,this._introduce_pai_button,this._caozuo_button];
        ////刚开始牌型介绍的按钮不可用
        //this._buttonCom[1].interactable = false;
    },
    // 点击玩法介绍
    onBtnPlayMethodClick: function onBtnPlayMethodClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[0].interactable = false;
        ////当前点击的对应的内容可见
        this._content[0].active = true;
    },
    //点击牌型介绍
    onBtnIntroducePaiClick: function onBtnIntroducePaiClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[1].interactable = false;
        ////当前点击的对应的内容可见
        //this._content[1].active = true;
    },
    //点击操作介绍
    onBtnCaozuoClick: function onBtnCaozuoClick() {
        //for(var i=0;i<3;i++){
        //    //所有按钮设置为可用
        //    this._buttonCom[i].interactable = true;
        //    //所有的内容都隐藏掉
        //    this._content[i].active = false;
        //}
        ////当前点击的设置为不可用
        //this._buttonCom[2].interactable = false;
        ////当前点击的对应的内容可见
        //this._content[2].active = true;
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"inviteCode":[function(require,module,exports){
"use strict";
cc._RFpush(module, '777f9/eB7RKK4aO7FmNYFgO', 'inviteCode');
// scripts\inviteCode.js

/**
 * 邀请码
 * @authors 黄成(you@example.org)
 * @date    2017-06-16 09:44:10
 * @version $Id$
 */
var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackInviteCode: ''
  },

  onLoad: function onLoad() {
    this.clickClear(); //清除数字
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
      //cc.log(label.string ,"----------------");
    } else {
        return;
      }
    var isComplete = this._lastEmptyLabel() == null;
    //cc.log("isComplete-------------", this.callbackInviteCode);
    var inviteNumber = this._inviteNumber();

    if (inviteNumber.length == 6) {
      //cc.log(inviteNumber,"--------------------38"); //邀请码
      var userId = Socket.instance.userInfo.id;
      //Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = inviteNumber;
    }
  },
  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackInviteCode;
    //cc.log(inviteNumber,"--------------------38")
    if (inviteNumber && inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = ''; //清空邀请码
    }
  },
  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _inviteNumber: function _inviteNumber() {
    return this.labelNumbers.reduce(function (inviteNumber, label) {
      //cc.log(inviteNumber,"-----------------");
      return inviteNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"joinRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd5dcb9CJvpPJpnsCQ/q197x', 'joinRoom');
// scripts\joinRoom.js

cc.Class({
  "extends": cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }

    var isComplete = this._lastEmptyLabel() == null;
    if (isComplete && this.callbackJoinRoom) {
      var roomNumber = this._roomNumber();
      // cc.log("要加入的房间号是：", roomNumber);
      this.callbackJoinRoom(roomNumber);
    }
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{}],"launch":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0efb2ngHglDtK2A+W4dmfzt', 'launch');
// scripts\launch.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.scheduleOnce(function () {
            cc.director.loadScene('login');
        }, 0.5);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"login":[function(require,module,exports){
(function (Buffer){
"use strict";
cc._RFpush(module, '9c72dn88ytPxZWrZRaxt5cr', 'login');
// scripts\login.js

var manager = require('manager');
var KQCard = require('KQCard');
var Socket = require('socket');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');

var APPID = 'wxe8993f468b16fa5d';
var ROOMID = '';
//授权地址
//正式地址
// var REDIRECT_URI = "http%3A%2F%2Fwww.honggefeng.cn%2FsszWeb%2Findex.php";
// 测试地址
var REDIRECT_URI = "http%3a%2f%2fo1o2.cn";

var HREF = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + APPID + "&redirect_uri=" + REDIRECT_URI + "&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";

cc.Class({

    'extends': cc.Component,
    properties: {
        //selectNode:cc.Node,
        alertPrefab: cc.Prefab,
        canvasNode: cc.Node,
        loadingNode: cc.Node,
        //err:cc.Node,
        waitingPrefab: cc.Prefab,
        recordInfo: cc.Prefab,
        label: cc.Label
    },

    goUpdateAction: function goUpdateAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod("AppController", "downloadNewVersion:", this.iosUrl);
        } else {
            //Android
            jsb.reflection.callStaticMethod("com/gongpa/ssz/AppActivity", "downloadNewVersion", "(Ljava/lang/String;)V", this.androidUrl);
        }
    },

    checkVersion: function checkVersion(vData) {
        //var version = vData.version;
        cc.info1 = vData.version;
        this.iosUrl = vData.iosUrl;
        this.androidUrl = vData.androidUrl;
        //if (manager.version != version) {//更新版本
        //    this.versionEnable = false;
        //    this.goUpdateAction();
        //    //this.versionLabel.string = '请到服务器更新到最新版本';
        //}
        //else {
        //this.versionLabel.string = '当前版本 ' + manager.version;
        if (KQNativeInvoke.isNativeIOS()) {
            // if(iosVersion != manager.version) {
            //     this.versionEnable = false;
            //     var updateAlert = cc.find("Canvas/update").getComponent("alert");
            //     updateAlert.alert();
            // }
            // else {
            this.versionEnable = true;
            var self = this;
            var info = manager.getUserInfo();
            if (info.length == 0) {
                this.loginEnable = true;
            }
            this.scheduleOnce(function () {
                if (info.length > 0) {
                    this.loginEnable = true;
                    self.loginAction();
                }
            }, 0.5);
            //}
        } else if (KQNativeInvoke.isNativeAndroid()) {
                // if(androidVersion != manager.version) {
                //     this.versionEnable = false;
                //     var updateAlert = cc.find("Canvas/update").getComponent("alert");
                //     updateAlert.alert();
                // }
                // else {
                this.versionEnable = true;
                var self = this;
                var info = manager.getUserInfo();
                if (info.length == 0) {
                    this.loginEnable = true;
                }
                this.scheduleOnce(function () {
                    if (info.length > 0) {
                        this.loginEnable = true;
                        self.loginAction();
                    }
                }, 0.5);
                //}
            } else {
                    this.versionEnable = true;
                    var self = this;
                    // var info = manager.getUserInfo();
                    // if (info.length == 0) {
                    //     this.loginEnable = true;
                    // }
                    this.scheduleOnce(function () {
                        if (!cc.sys.isNative) {
                            var recordId = self.getQueryString('recordId');
                            if (recordId) {
                                Socket.sendGetRecrodFromId(recordId);
                                return;
                            }
                            var roomId = self.getQueryString("roomId");
                            if (roomId) {
                                var info = manager.getUserInfo();
                                if (info.length > 0) {
                                    var data = JSON.parse(info);
                                    if (!data.errcode) {
                                        self.sendLoginRequest(data);
                                    } else {
                                        manager.setUserInfo("");
                                    }
                                    return;
                                } else {
                                    self._get_HREF(roomId);
                                }
                            }
                        }
                        var info = manager.getUserInfo();
                        if (info.length > 0) {
                            var data = null;
                            try {
                                data = JSON.parse(info);
                            } catch (e) {
                                manager.setUserInfo("");
                                data = null;
                            }
                            if (!data || data.errcode) {
                                manager.setUserInfo("");
                            } else {
                                this.loginEnable = true;
                                self.loginAction();
                            }
                        } else {
                            if (!cc.sys.isNative) {
                                var code = self.getQueryString("code");
                                var roomId = self.getQueryString("roomId");
                                if (roomId) {
                                    var info = manager.getUserInfo();
                                    if (info.length > 0) {
                                        var data = JSON.parse(info);
                                        if (!data.errcode) {
                                            self.sendLoginRequest(data);
                                        } else {
                                            manager.setUserInfo("");
                                        }
                                        return;
                                    } else {
                                        self._get_HREF(roomId);
                                    }
                                }
                                if (code) {
                                    try {
                                        var obj = new XMLHttpRequest(); // XMLHttpRequest对象用于在后台与服务器交换数据
                                        var url = "./get_token.php";
                                        obj.open("POST", url, true);
                                        obj.setRequestHeader("Content-type", "application/x-www-form-urlencoded"); // 添加http头，发送信息至服务器时内容编码类型
                                        obj.onreadystatechange = function () {
                                            if (obj.readyState == 4 && (obj.status == 200 || obj.status == 304)) {
                                                // 304未修改
                                                //alert(obj.responseText);
                                                var data = JSON.parse(obj.responseText);
                                                if (!data.errcode) {
                                                    manager.setUserInfo(obj.responseText);
                                                    self.sendLoginRequest(data);
                                                }
                                            }
                                        };
                                        obj.send("code=" + code);
                                    } catch (e) {
                                        //alert(e);
                                    }
                                }
                            }
                        }
                    }, 0.5);
                }
        //}
    },
    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },
    //随机生成 num 位 的随机数 含大小写字母及数字
    getRandomAccount: function getRandomAccount(num) {
        /**
         * 返回一个字母
         */
        function getCharacter(flag) {
            var character = "";
            if (flag === "lower") {
                character = String.fromCharCode(Math.floor(Math.random() * 26) + "a".charCodeAt(0));
            }
            if (flag === "upper") {
                character = String.fromCharCode(Math.floor(Math.random() * 26) + "A".charCodeAt(0));
            }
            return character;
        }

        var str = "";
        for (var i = 0; i < num; i++) {
            var flag = "lower";
            var random = Math.floor(Math.random() * 3);
            if (random == 0) {
                flag = "upper";
                str += getCharacter(flag);
            } else if (random == 1) {
                str += getCharacter(flag);
            } else {
                str += Math.floor(Math.random() * 10);
            }
        }
        return str;
    },
    getGuestUserInfo: function getGuestUserInfo() {
        var search = window.location.search;
        var openid = "guest_" + this.getRandomAccount(8);
        var unionid = 'guest_' + this.getRandomAccount(8);
        var nickname = this.getRandomAccount(8);
        var testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
        return testData;
    },
    onLoad: function onLoad() {
        this.keyBackListen();
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var canvas = cc.find("Canvas");
            var cvs = canvas.getComponent(cc.Canvas);
        }
        KQGlabolSocketEventHander.start();
        this.socket = cc.find('GameSocket').getComponent('socket');
        var self = this;
        this.loginEnable = false;
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
            //console.log(data)
            if (data.action == 'checkVersion') {
                try {
                    self.checkVersion(data.data);
                } catch (e) {
                    //this.err.string = e;
                }
            } else if (data.action == 'login') {
                    if (data.result) {
                        //成功
                        self.socket.userInfo = data.data; //运行时态信息
                        if (!cc.sys.isNative) {
                            var roomId = self.getQueryString("roomId");
                            //console.log(roomId);
                            if (roomId) {
                                var userId = data.data.id;
                                var exitInRoom = data.data.roomId;
                                if (exitInRoom != "") {
                                    roomId = exitInRoom;
                                }
                                Socket.sendLoginJoin(roomId, userId);
                                return;
                            }
                        }
                        self._loadingLabel("登录中");
                        if (data.data.roomId.length > 0) {
                            cc.director.loadScene('play');
                        } else {
                            cc.director.loadScene('hall');
                        }
                    } else {
                        // self.alertMessage('登录失败!');
                    }
                }
        };
        this._registerSocketEvent();

        this.socket.getWxInfo = function (info) {
            manager.setUserInfo(info); //保存本地
            var data = JSON.parse(info); //str -> json(obj)
            self.scheduleOnce(function () {
                //延迟执行 1s
                self.sendLoginRequest(data); //登录请求
            }, 1);
        };
        this.getOnlyUserInfoByBrowser();
        //cc.sys.localStorage.removeItem("userinfo");
        // let search = window.location.search;
        // var openid = "JzIwMTcvNi8xNiDkuIrljYgxMMzowOCc=";
        // var unionid = '8dOtAcDic5Sichv3lxtMXYJgmunTLOLv';
        // var nickname = "哇哈哈";

        //var openid = "JzIwMTcvNi8xNiDkuIrljYgxMMzowOCc=";
        //var openid = "guest_" + this.getRandomAccount(8);
        //var unionid = '8dOtAcDic5Sichv3lxtMXYJgmunTLOLv';
        //var unionid = 'guest_' + this.getRandomAccount(8);
        //var nickname = this.getRandomAccount(8);

        //if (search) {
        //    var url = window.location.search;
        //    var loc = url.substring(url.lastIndexOf('=') + 1, url.length);
        //    if (loc == 1) {
        //        openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';
        //        unionid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc';
        //        nickname = loc;
        //    }
        //    else if (loc == 2) {
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';
        //        unionid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw';
        //        nickname = loc;
        //    }
        //    else if (loc == 3) {
        //        openid = 'JzIwMTctNi0xNiAwOTo0NToc=';
        //        unionid = '8dOtAcDic5Sichv3lxtMXYmunTLOLv';
        //        nickname = loc;
        //    }
        //    else if (loc == 4) {
        //        openid = 'ozlXIwgv_QJT0ykdUihaABmsWp2A';
        //        unionid = 'o-3911qWsQsW3wUodqFfUtbsAeNk';
        //        nickname = loc;
        //    }
        //    else if (loc == 5) {
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';
        //         unionid = 'o-JzIwMTcvNi8xNiDkuIrljYgxMDowM';
        //        nickname = loc;
        //    }else if(loc == 6){
        //        openid = 'JzIwMTcvNi8xNiDkuIrljYgxMMzoc=';
        //         unionid = 'o-zIwMTcvNi8xNiDkuIrl';
        //        nickname = loc;
        //    }
        //
        //}
        // var testData = '{"openid":"'+openid+'","nickname":"'+nickname+'","unionid":"'+unionid+'","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';

        //if (!cc.sys.isNative){
        //    var info = manager.getUserInfo();
        //    if (info.length > 0) {
        //        //this.showWaitingMessage('已存有账号=====');
        //        //return;
        //    }else
        //    {
        //        //this.showWaitingMessage('新账号=====');
        //        var userInfo = this.getGuestUserInfo();
        //        manager.setUserInfo(userInfo);
        //    }
        //}
    },

    getOnlyUserInfoByBrowser: function getOnlyUserInfoByBrowser() {
        var openid = "";
        var unionid = "";
        var nickname = "";

        var testData = "";
        var userInfo = manager.getUserInfo();

        var search = window.location.search;
        if (userInfo.length > 0) {
            openid = userInfo.openId;
            unionid = userInfo.unionid;
            nickname = userInfo.nickname;
        }

        if (search) {
            var url = window.location.search;
            var loc = url.substring(url.lastIndexOf('=') + 1, url.length);
            if (loc == 1) {
                openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';
                unionid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc';
                nickname = "guest_1";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 2) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';
                unionid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw';
                nickname = "guest_2";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 3) {
                openid = 'JzIwMTctNi0xNiAwOTo0NToc=';
                unionid = '8dOtAcDic5Sichv3lxtMXYmunTLOLv';
                nickname = "guest_3";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 4) {
                openid = 'ozlXIwgv_QJT0ykdUihaABmsWp2A';
                unionid = 'o-3911qWsQsW3wUodqFfUtbsAeNk';
                nickname = "guest_4";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 5) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';
                unionid = 'o-JzIwMTcvNi8xNiDkuIrljYgxMDowM';
                nickname = "guest_5";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            } else if (loc == 6) {
                openid = 'JzIwMTcvNi8xNiDkuIrljYgxMMzoc=';
                unionid = 'o-zIwMTcvNi8xNiDkuIrl';
                nickname = "guest_6";
                testData = '{"openid":"' + openid + '","nickname":"' + nickname + '","unionid":"' + unionid + '","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
            }
        }
        if (testData && testData.length > 0) {
            if (!cc.sys.isNative) {
                manager.setUserInfo(testData);
            }
        }
    },
    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveLoginJoin, this._LoginJoin, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRecordId, this._ReceiveRecordId, this);
        KQGlobalEvent.on(Socket.Event.ReceiveNoUionid, this._ReceiveNoUionid, this);
    },
    _get_HREF: function _get_HREF(roomId) {
        if (roomId != ROOMID) {
            ROOMID = roomId;
            roomId = "%3froomId%3d" + roomId;
            REDIRECT_URI = REDIRECT_URI + roomId;
            HREF = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=" + APPID + "&redirect_uri=" + REDIRECT_URI + "&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";
        }
    },
    _ReceiveNoUionid: function _ReceiveNoUionid(response) {
        manager.setUserInfo("");
        var self = this;
        var roomId = this.getQueryString("roomId");
        if (roomId) {
            //roomId = "%3froomId%3d"+roomId ;
            //REDIRECT_URI = REDIRECT_URI+roomId;
            this._get_HREF(roomId);
        }
        setTimeout(function () {
            self.loadingNode.parent.active = false;
            self.loadingNode.stopAllActions();
        }, 2000);
        this._loadingLabel("登录失败，请重新登录");
    },
    _ReceiveRecordId: function _ReceiveRecordId(response) {
        var data = response.data;
        if (data.recordMsg.length > 0) {
            var record = data.recordMsg[0];
            var playersInfo = JSON.parse(record.playersInfo).players;
            var recordNode = cc.instantiate(this.recordInfo);
            var totalGameResult = recordNode.getComponent("TotalGameResult");
            playersInfo.sort(function (a, b) {
                return b.totalScore - a.totalScore;
            }); // 排序
            totalGameResult.setPlayerInfos(playersInfo, record);
            totalGameResult._clickBtn();
            recordNode.getComponent('alert').alert();
            this.node.addChild(recordNode);
        }
    },
    _LoginJoin: function _LoginJoin(response) {
        this._loadingLabel("进入房间，正在为您请求数据");
        if (response.result) {
            if (cc.from == null) {
                cc.from = {};
            }
            cc.from.ma = response.data.maPai;
            cc.director.loadScene('play');
        } else {
            cc.joinDesk = {};
            cc.director.loadScene('hall');
            var reasonInfo = this._joinReasonMap(response.data.reason);
            cc.joinDesk.result = response.result;
            cc.joinDesk.reason = reasonInfo;
        }
    },
    _joinReasonMap: function _joinReasonMap(reason) {
        var reasonInfo = {
            notExist: "房间不存在!",
            cardNumber: "您房卡不足!"
        };
        var info = reasonInfo[reason] || "房间已满!";
        return info;
    },

    getQueryString: function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);return null;
    },

    agreements: function agreements() {
        this.agreementNode.active = true;
        //this.agreementLabel.string = cc.info1;
        this.agreementLabel.node.y = 0;
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
    },

    _loadingLabel: function _loadingLabel(label) {
        this.label.string = label;
    },

    sendLoginRequest: function sendLoginRequest(data) {
        //this.showWaitingMessage('登录中...');
        this.loadingNode.parent.active = true;
        this.loadingNode.runAction(cc.repeatForever(cc.rotateBy(2, 360)));
        //return;
        this.socket.sendMessage('login', data);
    },

    loginAction: function loginAction() {
        if (!cc.sys.isNative) {
            var info = manager.getUserInfo();
            if (info.length > 0) {
                //this.showWaitingMessage('已存有账号=====');
                //return;
            } else {
                    //this.showWaitingMessage('新账号=====');
                    var userInfo = this.getGuestUserInfo();
                    manager.setUserInfo(userInfo);
                }
        }

        var info = manager.getUserInfo();
        if (info.length > 0) {
            var data = JSON.parse(info);
            this.sendLoginRequest(data);
            return;
        }
        if (!cc.sys.isNative) {
            // cc.sys.openURL(HREF);
            window.location.href = HREF;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
            } else if (KQNativeInvoke.isNativeAndroid()) {
                    //Android
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
                }
        }
    },

    changeGuestUserInfo: function changeGuestUserInfo() {
        manager.setUserInfo('');
        this.loginAction();
    },

    loginYkAction: function loginYkAction() {
        //var comp = this.selectNode.getComponent('select');
        //if (!comp.selected) {
        //    this.showMsg = cc.instantiate(this.alertPrefab);
        //    this.canvasNode.addChild(this.showMsg);
        //    let comp = this.showMsg.getComponent('alert');
        //    comp.setMessage('请同意用户协议');
        //    return;
        //}
        var testDate = new Date();
        var time = "'" + testDate.toLocaleString() + "'";
        var openid = new Buffer(time).toString('base64');
        var testData = '{"openid":"' + openid + '","nickname":"游客","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/BVyz4R8q6puJibEv1hrsaTmIKQhkaTS9FyvcevvC5hlxFnfOuspDjicG0GtzyJXOhNT7g1WZDeCDQhnRdEOgz3QMnP0F9iboQGy\/0","privilege":[]}';
        var data = JSON.parse(testData);
        this.sendLoginRequest(data);
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.isValid(this.waitingNode)) {
            if (msg == this.waitingNode.getComponent('alert').getMessage()) {
                return;
            }
            this.waitingNode.removeFromParent();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.canvasNode.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        //console.log(comp);

        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    protocolAction: function protocolAction() {
        cc.log('protocol action');
    }
});

cc._RFpop();
}).call(this,require("buffer").Buffer)

},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","buffer":2,"manager":"manager","socket":"socket"}],"maPai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8b896xHkCtE1IzD8BDK4cWL', 'maPai');
// scripts\Play\maPai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        maPaiSprite: [cc.SpriteFrame],
        spriteNode: cc.Sprite,
        labelNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"manager":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4a47fj0J/VHup24OT7njkko', 'manager');
// scripts\manager.js

module.exports = {
    version: 'v1.0.0',

    setUserInfo: function setUserInfo(str) {
        cc.sys.localStorage.setItem('userinfo', str);
    },

    getUserInfo: function getUserInfo() {
        var value = cc.sys.localStorage.getItem('userinfo');
        if (!value) {
            return "";
        }
        return value;
    },

    setMusicValue: function setMusicValue(value) {
        cc.sys.localStorage.setItem('musicVolumn', value);
    },

    getMusicValue: function getMusicValue() {
        var value = cc.sys.localStorage.getItem('musicVolumn');
        if (!value) {
            return 1;
        }
        return value;
    },

    setMusicEffectValue: function setMusicEffectValue(value) {
        cc.sys.localStorage.setItem('musicEffectVolumn', value);
    },

    getMusicEffectValue: function getMusicEffectValue() {
        var value = cc.sys.localStorage.getItem('musicEffectVolumn');
        if (!value) {
            return 1;
        }
        return value;
    }
};

cc._RFpop();
},{}],"overTime":[function(require,module,exports){
"use strict";
cc._RFpush(module, '48748u5hxdOD4WTPWQqSQwN', 'overTime');
// scripts\overTime.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        //selectedIndex: 0,
        _selected: 1
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        this._select = true;
        var overTime = 0;
        if (cc.set) {
            overTime = cc.set.setting6;
            this._selected = this._select = overTime;
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select;
            this._selected = this._select;
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (self._select) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                this.setSelected(self._selected = self._select = !self._select);
                var title = this.node.getChildByName("title");
                if (self._select) {
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    title.color = new cc.Color(255, 255, 255);
                }
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "orders" && cc.set) {
            //this.remember_set(overTime);
        }
    },
    remember_set: function remember_set(obj) {
        for (var i = 0; i < this.nodes.length; i++) {
            this.nodes[i].getComponent('select').setSelected(obj);
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (obj) {
                var title = this.nodes[0].getChildByName('title');
                title.color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
    }

});

cc._RFpop();
},{}],"play":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16c65H2Pw9PBaQSvw69LGLQ', 'play');
// scripts\play.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var Manager = require('manager');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
var fecha = require('fecha');
var manager = require('manager');
/*#####*/
var KQCard = require('KQCard');
/**/
var Player = require('Player');
/**/
//const isTeShuPai = require('isTeShuPai');
//特殊牌类型
var TESHUPAITYPE = {
    isTeShuPai: false,
    isLiuDuiBan: false,
    isSanShunZi: false,
    isSanTaoHua: false,

    isQingLong: false,
    isYiTiaoLong: false,
    isSanTongHuaShun: false,
    isSanFenTianXia: false,
    isCouYiSe: false,
    isSiTaoSanTiao: false,
    isWuDuiSanTiao: false
};

var GAMESTATUS = {
    WAIT_PEOPLE: 0, // 等人
    WAIT_READY: 1, // 等待他人准备
    PLAYING: 2 };
// 正在玩游戏
var sTitle = '';
var sDescription = '';
var sId = '';
// 布局
//          2
//   3            1
//     self 0
var Play = cc.Class({
    'extends': cc.Component,

    properties: {
        playerNodes: [cc.Node],
        //playsCoins: [cc.Node],
        chatNode: cc.Node,
        cardTypeCombineNode: cc.Node,
        typeButtonsNode: cc.Node,
        phone: cc.Label,
        labelRoomNumber: cc.Label,
        labelOverview: cc.Label,
        labelRemainTime: cc.Label,
        btnShare: cc.Button,
        btnReady: cc.Button, // 准备按钮
        btnStartGame: cc.Button, // 开始按钮
        beilv: cc.Node, // 选择倍率节点
        btnChatVoice: cc.Button,
        btnChatText: cc.Button,
        againBtn: cc.Node,

        startCompareCardsNode: cc.Node,
        settingNode: cc.Node,
        VoiceMsgBg: cc.Node,
        exit: cc.Node, // 离开房间节点
        Dissolve: cc.Node, // 解散房间节点
        shareBg: cc.Node, // 分享背景
        totalGameResult: cc.Node, // 结果节点
        alertRequestExitNode: cc.Node, // 申请退出 Node
        dissolveAlter: cc.Node, // 申请退出 Node
        alertRequestExitCountdownNode: cc.Node, // 申请退出倒计时 Node
        alertAnsowerExitNode: cc.Node, // 回答申请退出  Node
        contentAnsowerExitNode: cc.Node, // 回答申请退出头像  Node
        alertAnsowerExitResult: cc.Node, // 回答申请退出结果  Node
        alertAnsowerExitCountdownNode: cc.Node, // 回答以上请退出的倒计时
        Countdown: cc.Node, // 倒计时
        labelTime: cc.Label,
        needCard: cc.Label,
        alert: cc.Node,
        coinsContainerNode: cc.Node,
        btnAlertRequestExitConfirmButton: cc.Button,
        btnAlertRequestExitCancelButton: cc.Button,

        autoTishi: cc.Prefab,
        waitingPrefab: cc.Prefab,
        coinsPrefab: cc.Prefab,
        playerComps: [Player],

        gongXiNi: cc.Node,
        teShuPai: cc.Node,

        cardSpriteAtlas: cc.SpriteAtlas,
        daoSpriteAtlas: cc.SpriteAtlas,

        _liuDuiBan: false,
        _sanShunZi: false,
        _sanTongHua: false,
        _yiTiaoLong: false,

        _QingLong: false,
        _SanTongHuaShun: false,
        _SanFenTianXia: false,
        _CouYiSe: false,
        _SiTaoSanTiao: false,
        _WuDuiSanTiao: false,

        _playerComponents: null,
        _msgControl: null,
        _nowTimeAgain: 0,

        _socket: null,
        _userId: 0,
        _playerInfos: null,
        _deskInfo: null, // createTime 创建时间  isDissolving 表示是否正在解散 dissolveLeftTime 离解散剩余多长时间 dissolveAnswerInfo [处理过的人的信息]
        _gameStatus: GAMESTATUS.WAIT_PEOPLE,
        _enterTime: null,
        _bigRecordInfo: null,
        _players: null,
        /**/
        _isComparingCardsNow: false, // 是否正在比牌
        _playedCompareCardsIndexs: [], // 已经播放过比牌的局数
        /**/
        fapaiNode: cc.Prefab,
        liuduiban: cc.Prefab,
        santonghua: cc.Prefab,
        sanshunzi: cc.Prefab,
        quanleida: cc.Prefab
    },
    keyBackListen: function keyBackListen() {
        var _this = this;
        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, function (e) {
            if (e.keyCode == cc.KEY.back) {
                if (!KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "backToDesk", "()V");
                }
            }
        }, this);
    },
    // use this for initialization
    onLoad: function onLoad() {
        var _this2 = this;

        this.keyBackListen();
        this.headCardTime = 0.85;
        var bg = this.node.getChildByName("room_bg");
        var windowP = cc.director.getWinSizeInPixels();
        var scaleX = windowP.width / bg.width;
        var scaleY = windowP.height / bg.height;
        var scale = Math.max(scaleX, scaleY);
        bg.scaleX = scale;
        bg.scaleY = scale;

        this.BtnClickGongXiNiComfirm = this.cardTypeCombineNode.getComponent("CardTypeCombine").BtnClickGongXiNiComfirm;
        this._enterTime = Date.now();
        /**/
        this.playerComps.forEach(function (playerComp) {
            playerComp.playedCompareCardsIndexs = _this2._playedCompareCardsIndexs;
        });
        /**/
        /*AudioManager.instance.playDeskMusic();*/

        AudioManager.instance.stopHallMusic();
        var bgSound = cc.sys.localStorage.getItem("bgSound");
        if (bgSound == 0) {
            var audioManager = cc.find('AudioManager');
            audioManager = audioManager.getComponent('AudioManager');
            audioManager.setEffectMusicVolum(bgSound);
        }

        this._initPlayerComponents();
        this._initSelectCardNode();
        this._initOneGameResult();
        this._remainTimeStartUpdate();

        this._userId = Socket.instance.userInfo.id;
        this._msgControl = this.chatNode.getComponent('MsgControl');
        this._userId = Socket.instance.userInfo.id;
        this.beilv.getComponent("selectbeilv")._userid = this._userId;
        //this.settingNode.getComponent("Setting").hideSwitch();
        this.labelRoomNumber.string = "";
        this.labelRemainTime.node.active = false;

        this._registerVoiceNodeEvents();
        this._registerSocketEvent();

        Play.instances = this;
        this._gongXiNiShow(false);
        if (Playback.instance.isContainPlaybackDatas()) {
            Playback.instance.startPlayback();
            this.playbackNode.active = true;
            this.btnChatVoice.node.active = false;
            //this.cardsFromArray.node.active = false;
        } else {
                this._loadDeskInfo();
            }

        this._socket = Socket.instance;

        cc.director.preloadScene('hall', function () {
            cc.director.preloadScene('login');
        });

        cc.clickOut = false;
        //this.timeStart(5);
    },

    timeStart: function timeStart(duration, action) {
        cc.assert(duration > 0);
        this.timeStop();
        this.Countdown.active = true;
        if (action != "ready") {
            var timestamp = cc.sys.localStorage.getItem("timestamp"); // 获取本地存储的时间戳
            if (timestamp) {
                // 如果有则证明玩家是重新进来了的
                var now = Date.parse(new Date());
                var time = duration * 1000;
                if (now - timestamp > time) {
                    // 超时
                    if (now - timestamp < 2 * time) {
                        duration = 5; // 玩家可能出于其他原因退出游戏导致超时，为其提供5秒时间整理牌型（这已经是很仁慈的了）。
                    } else {
                            cc.sys.localStorage.removeItem("timestamp");
                        }
                } else {
                    duration = Math.floor(duration - (now - timestamp) / 1000);
                }
            } else {
                // 如果没有时间戳，则保存，为玩家退出游戏保留证据；
                var timestamp = Date.parse(new Date());
                cc.sys.localStorage.setItem('timestamp', timestamp);
            }
        }
        this._timeRemainDuration = duration;
        this.labelTime.string = String(duration);
        this.Countdown.getComponent("time").setTime(duration * 0.5);
        var self = this;
        this.callback = function () {
            self._timeMethod(action);
        };
        this.schedule(this.callback, 1, duration);
    },

    timeStop: function timeStop() {
        this.unschedule(this.callback);
        this.Countdown.active = false;
    },

    _timeMethod: function _timeMethod(action) {
        this._timeRemainDuration = this._timeRemainDuration - 1;

        var remain = Math.max(this._timeRemainDuration, 0);
        this.labelTime.string = remain < 10 && remain > 0 ? '0' + remain : remain;

        if (this._timeRemainDuration <= 0) {
            this.timeStop();
            if (action == "ready") {
                if (this._deskInfo.cIndex > 0) {
                    this.clickReady();
                }
            }
            cc.sys.localStorage.removeItem("timestamp");
            return;
        }
    },

    _globalMsg: function _globalMsg(data) {
        //if(!cc.sys.isNative){
        var roomId = data.roomId;
        var wf = data.setting3; ///[疯狂场,鬼牌,比花色,坐庄,马牌]
        var room = "房号：" + roomId;
        var fk = wf[0] ? "疯狂场 " : "普通场 "; // 疯狂场
        var gp = wf[1] ? "鬼牌 " : "无鬼 "; // 鬼牌
        var hs = wf[2] ? "比花色 " : "不比花色 "; // 比花色
        var zj = wf[3] ? "坐庄 " : "不坐庄 "; // 庄家
        var mp = wf[4] ? "买马 " : "不买马 "; // 马牌
        var sf = "房费:" + (data.setting4 ? data.setting4 == 1 ? "赢者扣 " : "房主扣 " : "平摊 "); //收费
        var shareTitle = room + " 模式:" + zj + sf;

        var pj = ["5局 ", "10局 ", "20局 "]; //牌局
        var ds = ["4人不加色 ", "5人加一色 ", "6人二色 ", "7人加三色 "]; //多色
        var rs = ds[data.setting2] + "";
        var js = pj[data.setting1 - 2];
        var desc = '[大众十三水] ' + zj + fk + mp + gp + sf + rs + js + " 点击直接进入房间";

        sTitle = shareTitle;
        sDescription = desc;
        sId = 'roomId=' + roomId;

        cc.sys.localStorage.setItem('roomId', roomId);
        cc.sys.localStorage.setItem('shareTitle', shareTitle);
        cc.sys.localStorage.setItem('desc', desc);

        if (cc.sys.isBrowser) {
            if (window.shareToTimeLine) {
                window.shareToTimeLine();
            }
            if (window.shareToSession) {
                window.shareToSession();
            }
        }
        //}
    },

    /*#####*/
    /*显示马牌*/
    _initMaPai: function _initMaPai() {},

    _initPlayerComponents: function _initPlayerComponents(playerIndex) {
        this._playerComponents = this.playerNodes.map(function (node) {
            return node.getComponent('Player');
        });

        if (!playerIndex) {
            playerIndex = [0, 1, 2, 3, 4, 5];
        }

        var a = this._playerComponents.splice(1, 7);

        for (var i = 0; i < playerIndex.length - 1; i++) {
            var index1 = playerIndex[i];
            var index2 = playerIndex[i + 1];
            var tmp = null;
            tmp = a[index1];
            a[index1] = a[index2];
            a[index2] = tmp;
        }

        a.forEach((function (node) {
            this._playerComponents.push(node);
        }).bind(this));

        if (this.playsCoins && this.playsCoins.length > 0) {
            this.playsCoins.forEach((function (node) {
                node.active = false;
            }).bind(this));
        }

        this.playsCoins = [];

        this._playerComponents.forEach((function (plays, i) {
            var name = "coins" + i;

            var node = new cc.Node();

            node.name = name;

            node.x = plays.node.x;

            node.y = plays.node.y;

            this.node.addChild(node);

            this.playsCoins.push(node);
        }).bind(this));
    },

    _initSelectCardNode: function _initSelectCardNode() {
        var self = this;
        var cardTypeCombineComp = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombineComp.setFinishSelectCardsCallback(function (serverCardsInfo) {
            cardTypeCombineComp.reset();
            Socket.sendPlayCard(self._userId, serverCardsInfo);
            self.cardTypeCombineNode.active = false;
        });
    },

    /**/
    _initOneGameResult: function _initOneGameResult() {
        var self = this;
        // this.oneGameResult.setCloseCallback = function () {
        //     if (self._isRandomRoom()) {
        //         cc.director.loadScene('hall');
        //     }
        // };
    },

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickLeaveDesk: function clickLeaveDesk() {
        // 点击离开桌子
        if (this._deskInfo.cIndex == 0) {
            // 还没开始可以退出房间
            if (this._deskInfo.createId == this._userId) {
                cc.director.loadScene('hall');
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
        }
    },
    clickDissolveDesk: function clickDissolveDesk() {
        // 点击解散桌子
        if (this._deskInfo.createId == this._userId) {
            // 只有房主才能解散桌子
            this.btnAlertRequestExitCancelButton.node.active = true;
            this.btnAlertRequestExitConfirmButton.node.active = true;
            var _alert = this.alertRequestExitNode.getComponent('alert');
            _alert.unscheduleAllCallbacks();
            _alert.setMessage("是否要解散房间");
            _alert.alert();
        }
    },

    clickExitOut: function clickExitOut() {
        Socket.sendDissolveDesk(this._userId);
    },

    //解散退出房间
    clickExit: function clickExit() {
        if (Playback.instance.isPlaybacking()) {
            cc.director.loadScene('hall');
            return;
        }
        /**/
        if (this._deskInfo && this._deskInfo.isDeskOver) {
            if (!this._isComparingCardsNow) {
                // 如果房间已结束，并且不是正在播放打牌动画, 则直接离开房间
                cc.director.loadScene('hall');
            }
            return;
        }
        /**/
        //if (this._isRandomRoom()) {
        //    this.alertForceExitNode.getComponent('alert').alert();
        //    return;
        //}
        if (this._deskInfo.cIndex == 0) {
            if (this._deskInfo.createId == this._userId) {
                var alert1 = this.dissolveAlter.getComponent('alert');
                alert1.alert();
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
            return;
        }
        this.btnAlertRequestExitCancelButton.node.active = true;
        this.btnAlertRequestExitConfirmButton.node.active = true;

        var alert = this.alertRequestExitNode.getComponent('alert');
        alert.unscheduleAllCallbacks();
        alert.setMessage("是否解散房间？");
        alert.alert();

        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },
    //不解散退出房间
    clickOut: function clickOut() {
        if (this._deskInfo.cIndex == 0) {
            if (this._deskInfo.createId == this._userId) {
                cc.clickOut = true;
                cc.director.loadScene('hall');
                return;
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
        }
    },

    clickShareBg: function clickShareBg() {
        cc.find("Canvas/shareBg").active = false;
        this.shareBg.active = false;
    },
    guanzhu: function guanzhu() {
        // var url = "http://www.honggefeng.cn/gzh/index.html";
        // cc.sys.openURL(url)
    },
    recordShare: function recordShare() {
        if (this._deskInfo.recordId) {
            var shareTitle = "[大众十三水]战绩";
            var roomId = "房间号：" + this._deskInfo.roomId;
            var pj = ["5 ", "10 ", "20 "]; //牌局
            var js = "局数：" + pj[this._deskInfo.setting1 - 2];
            var time = "时间：" + this._deskInfo.createTime;
            var desc = roomId + js + time + "点击查看详情";

            var recordId = this._deskInfo.recordId;
            cc.sys.localStorage.setItem("shareTitle", shareTitle);
            cc.sys.localStorage.setItem("desc", desc);
            cc.sys.localStorage.setItem("recordId", recordId);
            cc.sys.localStorage.setItem("roomId", '');

            sTitle = shareTitle;
            sDescription = desc;
            sId = 'roomId=' + roomId;
            if (recordId) {
                sId = 'recordId=' + recordId;
            }

            if (cc.sys.isBrowser) {
                if (window.shareToTimeLine) {
                    window.shareToTimeLine();
                }
                if (window.shareToSession) {
                    window.shareToSession();
                }
            }
        };
        if (!cc.sys.isNative) {
            cc.find("Canvas/shareBg").active = true;
        } else {
            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
            } else {
                //Android
                KQNativeInvoke.screenshotShare();
            }
        }
    },
    // 点击桌面分享
    clickDeskShare: function clickDeskShare() {
        //this._globalMsg(this._deskInfo);
        if (!cc.sys.isNative) {
            var shareBg = cc.find("Canvas/shareBg");
            shareBg.active = true;
            //var wxBg = this.shareBg.getChildByName("wx");
            //var pyqBg = this.shareBg.getChildByName("PYQ");
            //wxBg.active = true;
            //pyqBg.active = false;
            //this.shareBg.active = true;
        }
        var id = sId;
        var title = sTitle;
        var description = sDescription;
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
        }
    },
    //点击分享按钮
    clickShare: function clickShare() {
        //this._globalMsg(this._deskInfo);
        if (!cc.sys.isNative) {
            var wxBg = this.shareBg.getChildByName("wx");
            var pyqBg = this.shareBg.getChildByName("PYQ");
            wxBg.active = true;
            pyqBg.active = false;
            this.shareBg.active = true;
        }
        var id = sId;
        var title = sTitle;
        var description = sDescription;

        // let roomId = String(this._deskInfo.roomId);
        // var description = "大众十三水 玩法:"
        // description = description + " " + this._deskInfoNumberOfPeople();
        // description = description + "," + this._deskInfoPayInfo();
        // description = description + " " + this._deskInfoNumberOfGame();

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description, title);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", str, id, description, title);
        }
    },

    //分享到朋友圈
    shareHallTimeline: function shareHallTimeline() {
        if (!cc.sys.isNative) {
            var wxBg = this.shareBg.getChildByName("wx");
            var pyqBg = this.shareBg.getChildByName("PYQ");
            wxBg.active = false;
            pyqBg.active = true;
            this.shareBg.active = true;
        } else {
            var id = sId;
            var title = sTitle;
            var description = sDescription;

            if (KQNativeInvoke.isNativeIOS()) {
                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline", id, description, title);
            } else {
                //Android
                var str = "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V";
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", str, id, description, title);
            }
        }
    },

    //点击准备按钮
    clickReady: function clickReady() {
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.timeStop();
        Socket.sendReady(this._userId);
    },

    //点击开始按钮
    clickStartGame: function clickStartGame() {
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.btnStartGame.node.active = false;
        Socket.sendStartGame(this._userId);
    },

    updateRoomNumber: function updateRoomNumber(roomNumber) {
        var gameNumberString = "";
        if (this._deskInfo.setting1 != 0 && this._deskInfo.setting1 != 1) {
            gameNumberString = "局数 : " + "" + this._deskInfo.cIndex + "/" + this._deskInfo.mMax;
        } else if (this._deskInfo.setting1 == 0) {
            gameNumberString = "局数 : 10局";
        } else if (this._deskInfo.setting1 == 1) {
            gameNumberString = "局数 : 20局";
        }
        this.labelRoomNumber.string = "房号 : " + "" + roomNumber + "    " + gameNumberString;
    },

    updateGameStatus: function updateGameStatus() {
        var status = arguments.length <= 0 || arguments[0] === undefined ? GAMESTATUS.WAIT_PEOPLE : arguments[0];

        this._gameStatus = status;

        this.btnShare.node.active = status == GAMESTATUS.WAIT_PEOPLE;
        this.btnReady.node.active = status == GAMESTATUS.WAIT_READY;
        this.isReadyStatus();
    },

    gameStatus: function gameStatus() {
        return this._gameStatus;
    },
    isReadyStatus: function isReadyStatus() {
        if (this._playerInfos && this._playerInfos.length > 0) {
            this._playerInfos.forEach((function (playerInfo) {
                var userInfoSelf = cc.find('Canvas/playSelf/userInfoSelf');
                if (playerInfo.id == this._userId) {
                    if (!playerInfo.readyStatus && !this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas()) {
                        userInfoSelf.getComponent('userInfo').setReadyNodeVisible(false);
                        if (this._deskInfo.cIndex == 0) {
                            //一局还没开始
                            this.btnReady.node.active = false;
                            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {
                                this.btnShare.node.active = true;
                            } else {
                                this.btnShare.node.active = false;
                            }

                            if (this._deskInfo.players.length >= 2 && this._deskInfo.createId == this._userId) {
                                //是否是房主
                                this.btnStartGame.node.active = true;
                            } else {
                                this.btnStartGame.node.active = false;
                            }
                        } else {
                            this.btnReady.node.active = true;
                            this.btnShare.node.active = false;
                            this.btnStartGame.node.active = false;
                            this.btnStartGame.node.active = false;
                        }
                    } else {
                        this.btnReady.node.active = false;
                        this.btnShare.node.active = false;
                        this.btnStartGame.node.active = false;
                        if (!this._isComparingCardsNow) {
                            userInfoSelf.getComponent('userInfo').setReadyNodeVisible(true);
                        } else {
                            this._playerComponents.forEach(function (playerComp) {
                                playerComp.hideReadyStatus();
                            });
                        }
                    }
                }
                //console.log(this._isComparingCardsNow)
                //console.log("准备状态--------")
                if (this._isComparingCardsNow) {
                    //
                    this._playerComponents.forEach(function (playerComp) {
                        playerComp.hideReadyStatus();
                    });
                }
            }).bind(this));
        }
    },

    isGameStart: function isGameStart() {
        if (this._deskInfo.cIndex == 0) {
            //一局还没开始
            if (this._deskInfo.createId == this._userId) {
                //是否是房主
                if (!this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas() && this._deskInfo.players.length >= 2) {
                    this.btnStartGame.node.active = true;
                    this.btnReady.node.active = false;
                } else {
                    this.btnStartGame.node.active = false;
                }
            } else {
                this.btnStartGame.node.active = false;
            }

            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {
                this.btnShare.node.active = true;
            } else {
                this.btnShare.node.active = false;
            }
        } else {
            this.btnStartGame.node.active = false;
            this.btnShare.node.active = false;
        }
    },

    /// 游戏动画
    _startGame: function _startGame(playMusic) {

        if (this.gameStatus() == GAMESTATUS.PLAYING) {
            return;
        }
        //this._playerInfos = players;
        //this._playerComponents.forEach(function (player) {
        //
        //});
        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset(); //#####
            playerComp.hideReadyStatus();
        });
        this.teShuPai.active = false;

        this.unscheduleAllCallbacks();

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        this._playerComponents.forEach((function (plays, i) {

            var name = "coins" + i;

            var node = this.node.getChildByName(name);

            if (node) {
                node.removeAllChildren();
                this.node.removeChild(node);
            }
        }).bind(this));
        // cc.log(this.node)
        // cc.log('------709')
        this._updateUserInfos(this._playerInfos);
        this.showCompareCard();
        this._isComparingCardsNow = true;
        this.updateGameStatus(GAMESTATUS.PLAYING);
        this._playFaPaiAnimation(playMusic);

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');

        cardTypeCombine.reset();

        cardTypeCombine.node.active = false;

        if (!UserModelHelper.isPlayedCards(this._findPlayerInfoByUserId(this._userId))) {
            this.node.getComponent("animation").fapaiAnimation();
            this.scheduleOnce((function () {
                this._showCardTypeCombine();
            }).bind(this), 1.9);
        }
    },

    _playFaPaiAnimation: function _playFaPaiAnimation(playMusic) {
        this._playerComponents.forEach(function (player) {
            player.playFaPaiAnimation();
        });
        if (playMusic) {
            AudioManager.instance.playFaPai();
        }
    },

    /*#####*/
    //是否特殊牌
    isTeShuPai: function isTeShuPai(cards) {
        var result = KQCard.isTeShuPai(cards);
        if (result) {
            TESHUPAITYPE.isTeShuPai = true;
        } else {
            TESHUPAITYPE.isTeShuPai = false;
        }
        return result;
    },
    //是否一条龙
    isYiTiaoLong: function isYiTiaoLong(cards) {
        var result = KQCard.isYiTiaoLong(cards);
        if (result) {
            TESHUPAITYPE.isYiTiaoLong = true;
        } else {
            TESHUPAITYPE.isYiTiaoLong = false;
        }
        return result;
    },
    //是否六对半
    isLiuDuiBan: function isLiuDuiBan(cards) {
        var result = KQCard.isLiuDuiBan(cards);
        if (result) {
            TESHUPAITYPE.isLiuDuiBan = true;
        } else {
            TESHUPAITYPE.isLiuDuiBan = false;
        }
    },
    //是否三顺子
    isSanShunZi: function isSanShunZi(cards) {
        var result = KQCard.isSanShunZi(cards);
        if (result) {
            TESHUPAITYPE.isSanShunZi = true;
        } else {
            TESHUPAITYPE.isSanShunZi = false;
        }
    },
    //是否三同花
    isSanTongHua: function isSanTongHua(cards) {
        var result = KQCard.isSanTongHua(cards);
        if (result) {
            TESHUPAITYPE.isSanTaoHua = true;
        } else {
            TESHUPAITYPE.isSanTaoHua = false;
        }
    },
    //是否三同花顺
    isSanTongHuaShun: function isSanTongHuaShun(cards) {
        var result = KQCard.isSanTongHuaShun(cards);
        if (result) {
            TESHUPAITYPE.isSanTongHuaShun = true;
        } else {
            TESHUPAITYPE.isSanTongHuaShun = false;
        }
    },
    //是否是清龙
    isQingLong: function isQingLong(cards) {
        var result = KQCard.isQingLong(cards);
        if (result) {
            TESHUPAITYPE.isQingLong = true;
        } else {
            TESHUPAITYPE.isQingLong = false;
        }
    },
    //是否是 “三分天下”
    isSanFenTianXia: function isSanFenTianXia(cards) {
        var result = KQCard.isSanFenTianXia(cards);
        if (result) {
            TESHUPAITYPE.isSanFenTianXia = true;
        } else {
            TESHUPAITYPE.isSanFenTianXia = false;
        }
    },
    //是否是 “四套三条”
    isSiTaoSanTiao: function isSiTaoSanTiao(cards) {
        var result = KQCard.isSiTaoSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isSiTaoSanTiao = true;
        } else {
            TESHUPAITYPE.isSiTaoSanTiao = false;
        }
    },
    //是否是五对三条
    isWuDuiSanTiao: function isWuDuiSanTiao(cards) {
        var result = KQCard.isWuDuiSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isWuDuiSanTiao = true;
        } else {
            TESHUPAITYPE.isWuDuiSanTiao = false;
        }
    },
    //是否是凑一色
    isCouYiSe: function isCouYiSe(cards) {
        var result = KQCard.isCouYiSe(cards);
        if (result) {
            TESHUPAITYPE.isCouYiSe = true;
        } else {
            TESHUPAITYPE.isCouYiSe = false;
        }
    },
    /*#####*/

    /*显示配牌页面*/
    _showCardTypeCombine: function _showCardTypeCombine() {
        if (Playback.instance.isPlaybacking()) {
            return;
        }
        if (this.cardTypeCombineNode.active) {
            return;
        }

        this.startCompareCardsNode.active = false;
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;

        cc.teShuPaiCards = null;

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombine.reset();
        cardTypeCombine.reloadCards([]);
        cardTypeCombine.node.active = true;
        cardTypeCombine.timeStart(60);
        this.timeStart(60, "");
        this.cardTypeCombineNode.scale = 1;

        var cards = this._findCardsByUserId(this._userId);
        //"1_9""3_9""2_9"
        // "2_7""1_7""3_3""2_12"
        //"1_1""1_3""2_6""1_11""2_1""3_4"//
        // if(this._userId == 2){
        //     cards = [{suit: "d", number:2},{suit: "d", number:2}, {suit: "d", number:2},//青龙

        //         {suit: "h", number:2}, {suit: "d", number:2},
        //         {suit: "c", number:3}, {suit: "c", number:3}, {suit: "c", number:3},

        //         {suit: "d", number:3}, {suit: "d", number:4},
        //         {suit: "d", number:4}, {suit: "d", number:4}, {suit: "d", number:4}];
        // }
        //if(this._userId == 1){d
        //    cards = [{suit: "c", number:1},{suit: "h", number:1}, {suit: "s", number:1},//青龙
        //
        //        {suit: "h", number:8}, {suit: "c", number:2},
        //        {suit: "d", number:8}, {suit: "h", number:8}, {suit: "d", number:20},
        //        {suit: "h", number:9}, {suit: "s", number:9},
        //        {suit: "s", number:9}, {suit: "s", number:9}, {suit: "h", number:9}];
        //}
        // else if(this._userId == 6){
        //     cards = [{suit: "d", number:11},{suit: "d", number:13}, {suit: "d", number:11},//青龙
        //         {suit: "d", number:1}, {suit: "d", number:1},
        //         {suit: "h", number:2}, {suit: "h", number:4}, {suit: "h", number:9},
        //         {suit: "s", number:7}, {suit: "s", number:7},
        //         {suit: "s", number:5}, {suit: "s", number:5}, {suit: "s", number:5},];
        // }

        //else if(this._userId == 3){
        //    cards = [{suit: "d", number:4},{suit: "d", number:13}, {suit: "s", number:13},//青龙
        //        {suit: "d", number:6}, {suit: "s", number:7},
        //        {suit: "d", number:8}, {suit: "c", number:9}, {suit: "c", number:10},
        //        {suit: "s", number:1}, {suit: "s", number:3},
        //        {suit: "s", number:10}, {suit: "s", number:8}, {suit: "s", number:12},];
        //}
        cc.moshi = 0;
        for (var i = 0; i < cards.length; i++) {
            var s = cards[i].number;
            if (s >= 20) {
                cc.moshi = 1;
                break;
            }
        }
        var cardNames = this._convertCardsToCardNames(cards);
        cardTypeCombine.reloadCards(cardNames);
        cardTypeCombine.addCardModes(cardNames);

        //cc.from.moshi == 0选择了庄家模式

        if (cc.moshi != 1) {
            this.isTeShuPai(cards);
            this.isQingLong(cards);
            this.isYiTiaoLong(cards);
            this.isLiuDuiBan(cards);
            this.isSanShunZi(cards);
            this.isSanTongHua(cards);
            if (TESHUPAITYPE.isTeShuPai) {
                this.cardTypeCombineNode.scale = 0;
                var nodes = this.gongXiNi.getChildByName("bg");
                nodes.opacity = 240;
            }
            //this.isSanTongHuaShun(cards);
            //this.isSanFenTianXia(cards);
            //this.isSiTaoSanTiao(cards);
            //this.isWuDuiSanTiao(cards);
            //this.isCouYiSe(cards);
            this._showGongXiNiAndBtnTeShuPai();
        }
        cardTypeCombine.cacleAutoSelectedCards2();

        if (cc.moshi == 1) cc.teShuPaiCards = null;
        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset(); //#####
            playerComp.hideReadyStatus();
        });
    },

    getIsTeShuPai: function getIsTeShuPai(userId) {
        var cards = this._findCardsByUserId(userId);
        return this.isTeShuPai(cards);
    },

    /*#####检测特殊牌类型，显示相对应的恭喜你页面和特殊牌精灵*/
    _showGongXiNiAndBtnTeShuPai: function _showGongXiNiAndBtnTeShuPai() {
        /*如果有特殊牌*/
        if (TESHUPAITYPE.isTeShuPai) {
            if (TESHUPAITYPE.isQingLong) {
                this._gongXiNiShow(true, "同花十三水");
                this._sanTongHua = true;
            } else if (TESHUPAITYPE.isYiTiaoLong) {
                this._gongXiNiShow(true, "十三水");
                this._yiTiaoLong = true;
            } else if (TESHUPAITYPE.isLiuDuiBan) {
                this._gongXiNiShow(true, "六对半");
                this._liuDuiBan = true;
            } else if (TESHUPAITYPE.isSanShunZi) {
                this._gongXiNiShow(true, "三顺子");
                this._sanShunZi = true;
            } else if (TESHUPAITYPE.isSanTaoHua) {
                this._gongXiNiShow(true, "三同花");
                this._sanTongHua = true;
            }
            //else if(TESHUPAITYPE.isSanTongHuaShun){
            //    this._gongXiNiShow(true);
            //    this._SanTongHuaShun = true;
            //}
            //else if(TESHUPAITYPE.isSanFenTianXia){
            //    this._gongXiNiShow(true);
            //    this._SanFenTianXia = true;
            //}
            //else if(TESHUPAITYPE.isCouYiSe){
            //    this._gongXiNiShow(true);
            //    this._CouYiSe = true;
            //}
            //else if(TESHUPAITYPE.isSiTaoSanTiao){
            //    this._gongXiNiShow(true);
            //    this._SiTaoSanTiao = true;
            //}
            //else if(TESHUPAITYPE.isWuDuiSanTiao){
            //    this._gongXiNiShow(true);
            //    this._WuDuiSanTiao = true;
            //}
            else {
                    this._gongXiNiShow(false);
                }
        }
        //this._initTeShuPaiSprite();
    },

    /*#####控制特殊牌精灵的显示*/
    _initTeShuPaiSprite: function _initTeShuPaiSprite() {
        /*把所有的特殊牌精灵都隐藏掉*/
        //for(var i=0;i<this.teshupai_min.length;i++){
        //    this.teshupai_min[i].active = false;
        //    this.teshupai_max[i].active = false;
        //}
        ///*如果是一条龙，就显示一条龙的精灵*/
        //if(this._yiTiaoLong){
        //    this.teshupai_min[3].active = true;
        //    this.teshupai_max[3].active = true;
        //}
        ///*如果是六对半就显示六对半的精灵*/
        //else if(this._liuDuiBan){
        //    this.teshupai_min[0].active = true;
        //    this.teshupai_max[0].active = true;
        //}
        ///*如果是三顺子就显示三顺子的精灵*/
        //else if(this._sanShunZi){
        //    this.teshupai_min[1].active = true;
        //    this.teshupai_max[1].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._sanTongHua){
        //    this.teshupai_min[2].active = true;
        //    this.teshupai_max[2].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._QingLong){
        //    this.teshupai_min[4].active = true;
        //    this.teshupai_max[4].active = true;
        //}_gongXiNiShow
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SanTongHuaShun){
        //    this.teshupai_min[5].active = true;
        //    this.teshupai_max[5].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SanFenTianXia){
        //    this.teshupai_min[6].active = true;
        //    this.teshupai_max[6].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._CouYiSe){
        //    this.teshupai_min[7].active = true;
        //    this.teshupai_max[7].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._SiTaoSanTiao){
        //    this.teshupai_min[8].active = true;
        //    this.teshupai_max[8].active = true;
        //}
        ///*如果是三同花，就显示三同花的精灵*/
        //else if(this._WuDuiSanTiao){
        //    this.teshupai_min[9].active = true;
        //    this.teshupai_max[9].active = true;
        //}
    },

    /*#####*/
    //显示gongXiNi 页面和teShuPai
    clickGongXiNiShow: function clickGongXiNiShow() {
        this.cardTypeCombineNode.scale = 1;
        var nodes = this.gongXiNi.getChildByName("bg");
        nodes.opacity = 0;
    },

    _gongXiNiShow: function _gongXiNiShow(statues) {
        var test = arguments.length <= 1 || arguments[1] === undefined ? "" : arguments[1];

        //var alterCom = this.gongXiNi.getComponent("alert");
        var alterCom = this.gongXiNi.getComponent('alert');
        alterCom.unscheduleAllCallbacks();
        test = "是否按特殊牌型[" + test + "]出牌？" + "\n" + "(取消后点击左下角可再报道)";
        alterCom.setMessage(test);
        if (statues) {
            alterCom.alert();
        } else {
            alterCom.dismissAction();
        }
        this.teShuPai.active = statues;
        var nodes = this.teShuPai.getChildByName("btnTeshupai");
        nodes.children[0].runAction(cc.repeatForever(cc.rotateBy(1, -360)));
        nodes.children[1].runAction(cc.repeatForever(cc.rotateBy(1, 360)));
    },
    /*#####*/

    //  结果相关
    // 显示一局结果
    _showOneGameResult: function _showOneGameResult() {
        /**/
        this._isComparingCardsNow = false;
        /**/
        this.updateGameStatus(GAMESTATUS.WAIT_PEOPLE);
        //let oneGameResult = this.oneGameResult.getComponent('GameResult');
        //oneGameResult.unscheduleAllCallbacks();
        //oneGameResult.showResults(this._deskInfo, this._userId);
        this._updateUserScores();
        //this._updateBanker();
        //
        var self = this;
        this.scheduleOnce(function () {
            //self._playerComponents.forEach(function (playerComp) {
            //  //playerComp.reset();
            //  //playerComp.reset2();  //#####
            //});

            if (!self._isRandomRoom()) {
                //if (self._deskInfo.cIndex == 0) {//一局还没开始
                //    self.btnReady.node.active = true;
                //}
                if (self._isTotalGameOver()) {
                    self._showTotalGameResult();
                }
            }
        }, 0.5);

        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.scheduleOnce(function () {
                oneGameResult.getComponent('alert').dismissAction();
                cc.director.loadScene('hall');
            }, 2);
            return true;
        }
    },

    // 显示总结果
    _showTotalGameResult: function _showTotalGameResult() {
        var showDelay = arguments.length <= 0 || arguments[0] === undefined ? 2 : arguments[0];

        this.timeStop();
        //cc.find("Canvas/show_result").active = false;
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.alertAnsowerExitNode.active = false;
        this.alertRequestExitNode.active = false;
        if (this._deskInfo.cIndex == this._deskInfo.mMax) {
            this.againBtn.active = true;
        } else {
            this.againBtn.active = false;
        }

        var totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');
        if (totalGameResultComp.node.active) {
            return;
        }

        if (this._bigRecordInfo == null) {
            this._bigRecordInfo = this._deskInfo.players;
        }
        totalGameResultComp.setPlayerInfos(this._bigRecordInfo, this._deskInfo);

        var alert = this.totalGameResult.getComponent('alert');
        this.scheduleOnce((function () {
            //this.oneGameResult.active = false;
            //alert.alert();
            /**/
            if (!this.totalGameResult.active) {
                alert.alert();
            }
            /**/
        }).bind(this), showDelay);

        alert.setDismissCallback(function () {
            Socket.sendOnceAgain('false', this._userId);
            //cc.director.loadScene('hall');
        });
    },
    clickAgain: function clickAgain() {
        Socket.sendOnceAgain('true', this._userId);
    },

    // MARK: Socket 相关
    _loadDeskInfo: function _loadDeskInfo() {
        Socket.sendGetDesckInfo(this._userId);
    },
    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveOnlineStatus, this._socketReciveOnlineStatus, this);
        KQGlobalEvent.on(Socket.Event.ReceiveChatText, this._socketReciveChatTextMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveChatEmoji, this._socketReciveChatEmojiMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolve, this._socketReceiveRequestExitMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolveResult, this._socketReceiveRequestExitResultMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveAudioMessage, this._socketReceiveAudioMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceivePlayCard, this._socketReceivePlayCard, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGameOver, this._socketReceiveGameOver, this);
        KQGlobalEvent.on(Socket.Event.ReceiveFaPai, this._socketReciveFaPai, this);
        KQGlobalEvent.on(Socket.Event.ReceiveReady, this._socketReciveReady, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDissolveDesk, this._socketReceiveDissolveDesk, this);
        KQGlobalEvent.on(Socket.Event.ReceiveLeaveDesk, this._socketLeaveDesk, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._receiveSocketConnectError, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._receiveSocketConnectSuccessed, this);
        KQGlobalEvent.on(Socket.Event.ReceivePause, this._socketReceivePause, this);
        KQGlobalEvent.on(Socket.Event.ReceiveSelectBeiLv, this._ReceiveSelectBeiLv, this);
        KQGlobalEvent.on(Socket.Event.ReceiveBeiLv, this._ReceiveBeiLv, this);
        KQGlobalEvent.on(Socket.Event.ReceiveQingLi, this._ReceiveQingLi, this);
        KQGlobalEvent.on(Socket.Event.ReceiveOnceAgain, this._ReceiveOnceAgain, this);
    },

    _ReceiveOnceAgain: function _ReceiveOnceAgain(response) {
        var _this3 = this;

        /**
         * 再来一局
         * 总结果要隐藏掉
         * 比牌要隐藏掉
         * 发牌要显示
         */
        this._playedCompareCardsIndexs = [];
        this.playerComps.forEach(function (playerComp) {
            playerComp.playedCompareCardsIndexs = _this3._playedCompareCardsIndexs;
        });
        var data = response.data;
        if (!data.reason) {
            this.totalGameResult.active = false;
            this.startCompareCardsNode.active = false;
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset(); //#####
            });
            this._socketReceiveDeskInfo(response);
        } else {
            var now = Date.now();
            if (now - this._nowTimeAgain > 1500) {
                this._nowTimeAgain = now;
                this.alertAnsowerExitResult.y = -143;
                this.alertAnsowerExitResult.opacity = 255;
                this.alertAnsowerExitResult.children[0].getComponent(cc.Label).string = '房卡不足';
                var action = cc.spawn(cc.moveTo(0.3, cc.p(0, 20)), cc.fadeOut(0.3));
                this.alertAnsowerExitResult.runAction(cc.sequence(cc.moveTo(1, cc.p(0, 0)), action));
            }
        }
    },

    _ReceiveSelectBeiLv: function _ReceiveSelectBeiLv() {
        if (this._deskInfo.createId != this._userId) {
            this.beilv.active = true;
            var B3 = this.beilv.getChildByName('bg').getChildByName('btn3').getComponent(cc.Button);
            if (this._deskInfo.setting5 == 1) {
                /**
                 * 庄家选择两倍的时候 3倍按钮是不能响应的
                 * 选择三倍不用管，全部显示，
                 * 选择一倍也不用管，直接发牌，
                 */
                B3.interactable = false;
            }
            var selectBl = this.beilv.getComponent('selectBeilv');
            selectBl._userid = this._userid;
        }
    },

    _ReceiveBeiLv: function _ReceiveBeiLv(response) {
        var userId = response.data.userId;
        var bl = response.data.beilv;
        this._playerComponents.forEach(function (player) {
            player.showBeilv(userId, bl);
        });
    },

    _ReceiveQingLi: function _ReceiveQingLi(response) {
        var leaveId = response.data.leaveId;
        if (leaveId == this._userId) {
            if (cc.qingli == null) {
                var ql = response.action;
                cc.qingli = '';
                cc.qingli = ql;
            }
            cc.director.loadScene('hall');
        }
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        var data = response.data;

        this._initPlayerComponents(data.playersIndexAyy);
        /*#####添加五同按钮*/
        // cc.moshi = 0;

        // if(data.setting3[1] == true) cc.moshi = 1;  //  ？？？

        cc.maPai = null;

        if (data.maPai.length == 2) cc.maPai = data.maPai[0] + "_" + data.maPai[1];

        cc.huaSe = data.setting3[2];

        cc.chaoShiChuPai = data.setting6;

        cc.duoYiSe = response.data.setting2; //setting2为 4~7 人（0~3）

        this._deskInfo = data;
        this._globalMsg(data);
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(data.roomId);
        this.needCard.string = data.needCard; // 开放需要的房卡
        var playerIndexs = data.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._updateUserScores();
        this._updateBanker();
        this._msgControl.addPlayerInfos(this._playerInfos);

        var currentUserInfo = players.find((function (playerInfo) {
            return playerInfo.id == this._userId;
        }).bind(this));

        if (data.createId == this._userId) {
            if (data.cIndex > 0) {
                // 开始游戏了，请离按钮全部隐藏
                this._playerComponents.forEach(function (player) {
                    player.showQingli(false, data.cIndex);
                });
            } else {
                // 游戏没开始，房主的请离按钮不显示
                this._playerComponents.forEach(function (player) {
                    if (data.createId == player.userId) {
                        // 我是房主，不显示我的请离按钮
                        player.showQingli(true, data.cIndex);
                    } else {
                        player.showQingli(false, data.cIndex);
                    }
                });
            }
        }

        this._playerComponents.forEach(function (player) {
            if (data.createId == player.userId) {
                //显示房主
                player.showFangZhuStatus(data.createId, true);
            } else {
                player.showFangZhuStatus(player.userId, false);
            }
        });

        if (this._deskInfo.createId != this._userId) {
            // 非庄家
            if (this._deskInfo.cIndex == 0) {
                // 如果还没开始游戏，显示退出按钮，隐藏解散按钮
                this.exit.active = true;
                this.Dissolve.active = false;
            } else {
                // 反之
                this.exit.active = false;
                this.Dissolve.active = true;
            }
        } else {
            // 庄家
            if (this._deskInfo.cIndex > 0) {
                // 开局了 隐藏退出按钮
                this.exit.active = false;
                this.Dissolve.active = true;
            } else {
                // 没开局 两个都显示
                this.exit.active = true;
                this.Dissolve.active = true;
            }
        }

        if (!this._deskInfo.isCBegin) {
            this._gameStatus = GAMESTATUS.WAIT_READY;
        }
        for (var i = 0; i < players.length; i++) {
            var s = players[i];
            var is = s.readyStatus; //true/false
            var userId = s.id;
            this._playerComponents.forEach((function (player) {
                if (!this._deskInfo.isCBegin) player.showReadyStatus(userId, is);
            }).bind(this));
        }
        if (currentUserInfo && currentUserInfo.cards.length > 0 && this._deskInfo.isCBegin) {
            if (!currentUserInfo.cardInfo.length) {
                this._startGame(true);
            } else {
                this._startGame(false);
            }
        } else if (UserModelHelper.isPlayedCards(currentUserInfo) && !this._deskInfo.isCBegin) {
            this._socketReceiveGameOver(response);
        }
        this.isReadyStatus();
        this._handleUpdateDeskInfoAboutExitRoom(this._deskInfo);
        this.showCompareCard();
    },

    showCompareCard: function showCompareCard() {
        if (this._deskInfo.cIndex == 0 || this._deskInfo.isCBegin || !this._deskInfo.players || this._deskInfo.players.length <= 0 || this._deskInfo.players[0].cardInfo <= 0) {
            return;
        }

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        this.unscheduleAllCallbacks();

        this.node.stopAllActions();

        this._playerComponents.forEach(function (playerComp) {
            playerComp.readyToCompareCards();
        });

        this._playerComponents.forEach((function (player) {

            if (player.node.active) player.showAllCompareCards(this._deskInfo.players);
        }).bind(this));

        this.startCompareCardsNode.active = false;

        this._isComparingCardsNow = false;

        this.isReadyStatus();

        this.scheduleOnce((function () {

            if (this._isTotalGameOver()) this._showTotalGameResult();
        }).bind(this), 0.5);
    },

    _socketReciveFaPai: function _socketReciveFaPai(response) {
        //  发牌了开始比牌隐藏掉
        this.startCompareCardsNode.active = false;
        this.timeStop();
        this._isComparingCardsNow = true;
        this._gameStatus = GAMESTATUS.WAIT_READY;
        this._socketReceiveDeskInfo(response);
    },
    logoutAction: function logoutAction() {
        cc.director.loadScene('login');
        //manager.setUserInfo('');
        //hall.cacheImageInfo = null;
    },
    _socketReciveOnlineStatus: function _socketReciveOnlineStatus(response) {
        //{"action":"sendOnlineStatus","result":true,"data":{"userId":100049,"status":1}}
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }

        var data = response.data;
        var userId = data.userId;
        var status = data.status;

        this._playerComponents.forEach(function (player) {
            player.setUserOnlineStatus(userId, status);
        });
    },

    _socketReciveChatTextMessage: function _socketReciveChatTextMessage(response) {
        var userId = response.data.userId;
        var message = response.data.msg;

        this._playerComponents.forEach(function (player) {
            player.showChatText(userId, message);
        });

        this._msgControl.addChatTextMessage(userId, message);

        var sex = this._playerInfos.find(function (user) {
            return user.id == userId;
        }).sex;
        AudioManager.instance.playChatAudio(sex, message);
    },
    _socketReciveChatEmojiMessage: function _socketReciveChatEmojiMessage(response) {
        var userId = response.data.userId;
        var emoji = response.data.emoji;

        //this._playerComponents.forEach(function (player) {
        //    player.showChatText(userId, emoji);
        //});
        //this._msgControl.addChatEmojiMessage(userId, emoji);
        this._msgControl._loadEmojiFrame(emoji, (function (frame) {
            this._playerComponents.forEach(function (player) {
                if (player.userId == userId) player.chatMessageNode.getComponent('ChatMessage').showEmoji(frame);
            });
        }).bind(this));
    },

    _socketReceiveRequestExitMessage: function _socketReceiveRequestExitMessage(response) {
        //if (response.data.userId == this._userId) {
        //    return;
        //}

        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");

        var btnAgree = alert_bg.getChildByName("btnAgree");

        var btnDisagree = alert_bg.getChildByName("btnDisagree");

        btnAgree.active = true;

        btnDisagree.active = true;

        var dataInfos = response.data.info;

        if (!this.alertAnsowerExitNode.active) {

            var alertComp = this.alertAnsowerExitNode.getComponent('alert');

            alertComp.alert();

            alertComp.unscheduleAllCallbacks();

            this.contentAnsowerExitNode.children.forEach(function (i) {
                i.active = false;
            });

            this._playerInfos.forEach((function (playerInfo, index) {

                var play = this.contentAnsowerExitNode.children[index];

                var name = play.getChildByName("nickname");

                var back = play.getChildByName("fanzhu");

                var img = play.getChildByName("avatar_bg");

                play.active = true;

                name.getComponent(cc.Label).string = playerInfo.nickname;

                if (this._deskInfo.createId == playerInfo.id) {
                    //显示房主

                    back.active = true;
                } else {

                    back.active = false;
                }

                cc.loader.load({ url: playerInfo.avatarUrl, type: "jpg" }, (function (err, data) {

                    if (err) return;

                    var frame = new cc.SpriteFrame(data);

                    img.getComponent(cc.Sprite).spriteFrame = frame;
                }).bind(this));
            }).bind(this));

            var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');

            countdown.startCountdown(60, (function (isTimeout) {

                if (isTimeout) {

                    this.clickAgreeOtherPlayerExit();

                    return;
                }
            }).bind(this));
        }

        this._playerInfos.forEach((function (playerInfo, index) {

            var dataInfo = dataInfos[index];

            var play = this.contentAnsowerExitNode.children[index];

            var str = play.getChildByName("id");

            var dataInfo = dataInfos[index];

            if (dataInfo == 1) {

                if (this._userId == playerInfo.id) {
                    //显示房主

                    btnAgree.active = false;

                    btnDisagree.active = false;
                }

                str.getComponent(cc.Label).string = "同意";
            } else {

                str.getComponent(cc.Label).string = "";
            }
        }).bind(this));
    },

    _socketReceiveRequestExitResultMessage: function _socketReceiveRequestExitResultMessage(response) {
        this._hideReqestExitNode();
        if (this.alertAnsowerExitNode.active) {
            this.alertAnsowerExitNode.getComponent('alert').dismissAction();
            this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        }

        if (response.data.result) {
            // 解散成功
        } else {
                var userId = response.data.userId;
                var nickname = this._findPlayerInfoByUserId(userId).nickname;
                this.alertAnsowerExitResult.y = -143;
                this.alertAnsowerExitResult.opacity = 255;
                this.alertAnsowerExitResult.children[0].getComponent(cc.Label).string = nickname + '不同意退出';
                var action = cc.spawn(cc.moveTo(.3, cc.p(0, 20)), cc.fadeOut(this.cardTime));
                this.alertAnsowerExitResult.runAction(cc.sequence(cc.moveTo(1, cc.p(0, 0)), action));

                //this.showAlertMessage('解散失败，因为' + nickname + '不同意退出');
            }
    },

    _socketReceiveAudioMessage: function _socketReceiveAudioMessage(response) {
        var userId = response.data.userId;
        this.playSpeakAnimation(userId);

        if (userId == this._userId) {
            return;
        }

        var url = response.data.url;
        this.playAudioUrl(url);
    },

    _socketReceivePlayCard: function _socketReceivePlayCard(response) {
        // 有用户已经准备好了牌
        var userId = response.data[0].userId;
        var cardInfo = response.data[1].card;
        this._deskInfo = response.data[2].s;
        var players = response.data[2].s.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._playerComponents.forEach(function (player) {
            player.playCard(userId, cardInfo);
        });

        if (userId == this._userId) {
            this.cardTypeCombineNode.active = false;
        }
    },
    _getSelfReadyStatus: function _getSelfReadyStatus() {
        var self = this._findPlayerInfoByUserId(this._userId);
        return self.readyStatus;
    },
    _socketReciveReady: function _socketReciveReady(response) {
        var userId = response.data.userId;
        this._playerComponents.forEach((function (player) {
            if (!this._deskInfo.isCBegin) player.showReadyStatus(userId);
        }).bind(this));
    },

    //收到游戏结束
    _socketReceiveGameOver: function _socketReceiveGameOver(response) {
        this.timeStop();
        cc.sys.localStorage.removeItem("timestamp");

        this._hideReqestExitNode();

        // 一局游戏结束
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        /**/
        var deskInfo = response.data;
        if (response.action == 'gameOver' && deskInfo.isDeskOver) {

            Socket.sendDidReceiveGameOverAction(this._userId);
        }
        /**/
        this._deskInfo = response.data;

        // 如果是强制解散房间，则直接显示总成绩
        if (this._isDissvledRoom() && !Playback.instance.isPlaybacking()) {
            this._showTotalGameResult(0.1);
            return;
        }

        if (Date.now() - this._enterTime < 1000 * 4) {
            // 刚进来的话，不展示比牌动画
            //  let oneGameResult = this.oneGameResult.getComponent('GameResult');
            //  oneGameResult.unscheduleAllCallbacks();
            //  oneGameResult.showResults(this._deskInfo, this._userId);
            this.isReadyStatus();
            this.btnShare.node.active = false;
            this.btnReady.node.active = true;
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
            /**/
            this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
            /**/
            return;
        }

        var data = response.data;
        this._deskInfo = data;
        this._bigRecordInfo = data.bigRecordInfo;
        //console.log(data);
        //console.log("-----------------------------------1709");
        this._updatGameOverview(this._deskInfo);
        //let playerIndexs = data.playersIndex; // [100049]

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        //this._updateRecordInfo(players);

        if (UserModelHelper.isUserReady(this._findCurrentUserInfo())) {
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
        } else {
            this._startCompareCards(response);
        }

        if (Date.now() - this._enterTime < 1000 * 4) {
            this.showCompareCard();
            return;
        }
    },
    // _updateRecordInfo:function(players){

    //     // this._bigRecordInfo.push();
    // },
    _socketReceiveDissolveDesk: function _socketReceiveDissolveDesk(response) {
        this.cardTypeCombineNode.active = false;
        cc.director.loadScene('hall');

        // this.alert.getComponent('alert').setWillDismissCallback(function(){

        //   return true;
        // });

        // let message = "房主已解散房间";
        // if (this._isRandomRoom()) {
        //   message = "有玩家已强制退出房间，游戏结束。本局游戏不会扣除您的钻石。";
        // }

        // this.showAlertMessage(message, false);
    },
    /**/
    _socketLeaveDesk: function _socketLeaveDesk(response) {
        if (!response.result) {
            return;
        }

        if (this._deskInfo.isDeskOver) {
            // 如果房间已结束，也不用再自动退回到大厅了
            return;
        }

        cc.director.loadScene('hall');
    },
    /**/
    // socket 收到有人手机进入后台消息
    _socketReceivePause: function _socketReceivePause(response) {
        if (!response.result) {
            return;
        }

        var userId = response.data.userId;
        this._playerComponents.forEach(function (player) {
            if (player.userId == userId) {
                player.setUserOnlineStatus(userId, 0);
            }
        });
    },

    _receiveSocketConnectError: function _receiveSocketConnectError(response) {
        this.showNetworkMessage();
    },

    _receiveSocketConnectSuccessed: function _receiveSocketConnectSuccessed(response) {
        this.hiddenNetworkMessage();

        if (!Playback.instance.isPlaybacking()) {
            this._loadDeskInfo();
        }
    },
    /**/
    // MARK: 更新房间信息
    updateDeskInfo: function updateDeskInfo(deskInfo) {
        this._deskInfo = deskInfo;
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(deskInfo.roomId);

        var playerIndexs = deskInfo.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = deskInfo.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._msgControl.addPlayerInfos(this._playerInfos);
        if (deskInfo.cIndex == 0 && this._deskInfo.players.length < this._deskInfo.maxNumber) {
            this.btnShare.node.active = true;
        }
    },
    /**/
    _injectUserIdToPlayerComponents: function _injectUserIdToPlayerComponents(playerIndexs) {
        var currentUserIdIndex = playerIndexs.findIndex((function (userId) {
            return userId == this._userId;
        }).bind(this));

        var fixedPlayerIndexs = playerIndexs.translationWithStartIndex(currentUserIdIndex);
        this._playerComponents.forEach(function (playerComponent, index) {
            var userId = fixedPlayerIndexs.length > index ? fixedPlayerIndexs[index] : null;
            playerComponent.userId = userId;
        });
    },

    _updateUserInfos: function _updateUserInfos(userInfos) {
        var self = this;
        this._playerComponents.forEach(function (playerComponent, index) {
            //playerComponent.setDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateUserInfoWithUsers(userInfos);
        });

        //this._handleTheSameOfIPAdress(userInfos);
    },

    _updateUserScores: function _updateUserScores(userInfos) {
        this._playerComponents.forEach(function (player) {
            player.updateScore();
        });
    },

    _updateBanker: function _updateBanker() {
        this._playerComponents.forEach(function (player) {
            player.updateBanker();
        });
    },

    // 私有方法
    _findCardsByUserId: function _findCardsByUserId(userId) {
        var player = this._findPlayerInfoByUserId(userId);

        return player != null ? player.cards : null;
    },

    _findPlayerInfoByUserId: function _findPlayerInfoByUserId(userId) {
        var player = (this._playerInfos || []).find(function (playerInfo) {
            return userId == playerInfo.id;
        });

        return player;
    },

    _findPlayerIndexByUserId: function _findPlayerIndexByUserId(userId) {
        //let index = this._playerComponents.findIndex(function (playerComp) {
        //    return playerComp.userId == userId;
        //});
        var index = this.playerNodes.findIndex(function (node) {
            return node.getComponent('Player').userId == userId;
        });
        return index;
    },

    _findCurrentUserInfo: function _findCurrentUserInfo() {
        return this._findPlayerInfoByUserId(this._userId);
    },

    _convertCardsToCardNames: function _convertCardsToCardNames(cards) {
        // [{"suit":"s","number":10}]
        var suitColorMap = {
            s: 4,
            h: 3,
            c: 2,
            d: 1
        };
        return cards.map(function (card) {
            var cardNumber = card.number;

            // 服务器中的 14 是 A
            if (card.number == 14) {
                cardNumber = 1;
            }
            var color = suitColorMap[card.suit];
            var number = Math.max(Math.min(cardNumber, 21), 1);
            return color + "_" + number;
        });
    },

    // 更新游戏总览信息
    _updatGameOverview: function _updatGameOverview(deskInfo) {
        if (Playback.instance.isPlaybacking()) {
            this.labelOverview.string = "回放";
            return;
        }

        if (this._isRandomRoom()) {
            this.labelOverview.string = "";
            return;
        }
        var bihuase = "不比花色 ";
        var zuozhuang = "不坐庄 ";
        var putong = "普通场 ";
        var wugui = "无鬼 ";
        var maPai = '不买马 ';
        var renshu = "4人不加色 ";
        var card = "平摊";

        //[疯狂场,鬼牌,比花色,坐庄,马牌]
        if (this._deskInfo.setting3[2]) {
            bihuase = "比花色  ";
        }
        if (this._deskInfo.setting3[3]) {
            zuozhuang = "坐庄 ";
        }
        if (this._deskInfo.setting3[0]) {
            putong = "疯狂场  ";
        }
        if (this._deskInfo.setting3[1]) {
            wugui = "有鬼  ";
        }
        if (this._deskInfo.setting3[4]) {
            maPai = "买马";
            var huaSe = "方块";
            var dianShu = 1;
            switch (this._deskInfo.setting7[0]) {//setting7 [1~4,1~13] 表示 [花色，点数]
                case 1:
                    huaSe = "方块";break;
                case 2:
                    huaSe = "梅花";break;
                case 3:
                    huaSe = "红心";break;
                case 4:
                    huaSe = "黑桃";break;
            }
            switch (this._deskInfo.setting7[1]) {
                case 1:
                    dianShu = 'A';break;
                case 2:
                    dianShu = 2;break;
                case 3:
                    dianShu = 3;break;
                case 4:
                    dianShu = 4;break;
                case 5:
                    dianShu = 5;break;
                case 6:
                    dianShu = 6;break;
                case 7:
                    dianShu = 7;break;
                case 8:
                    dianShu = 8;break;
                case 9:
                    dianShu = 9;break;
                case 10:
                    dianShu = 10;break;
                case 11:
                    dianShu = 'J';break;
                case 12:
                    dianShu = 'Q';break;
                case 13:
                    dianShu = 'K';break;
            }
            maPai = huaSe + dianShu + maPai;
        }

        if (this._deskInfo.setting2 == 1) {
            renshu = "5人加一色 ";
        } else if (this._deskInfo.setting2 == 2) {
            renshu = "6人加二色 ";
        } else if (this._deskInfo.setting2 == 3) {
            renshu = "7人加三色 ";
        }
        if (this._deskInfo.setting4 == 1) {
            card = "赢者扣 ";
        } else if (this._deskInfo.setting4 == 2) {
            card = "房主扣 ";
        }

        this.labelOverview.string = "模式 : " + bihuase + zuozhuang + putong + wugui + maPai + "\n" + "其他：" + renshu + card;
        //this.labelOverview.string = "模式 : " + "" + deskInfo.maxNumber + "人" +bihuase+zuozhuang+putong+wugui+maPai;
    },

    // 是否是随机房
    _isRandomRoom: function _isRandomRoom() {
        if (this._deskInfo == null) {
            return true;
        }

        return this._deskInfo.isRandomDesk;
    },

    // 是否所有局数都用完了
    _isTotalGameOver: function _isTotalGameOver() {
        if (this._deskInfo == null) {
            return false;
        }

        if (this._deskInfo.isDeskOver) {
            return true;
        }

        return this._deskInfo.mMax <= this._deskInfo.cIndex;
    },

    // 是否已解散房间
    _isDissvledRoom: function _isDissvledRoom() {
        if (this._deskInfo) {
            return this._deskInfo.dissolveStatus;
        }

        return false;
    },

    _startCompareCards: function _startCompareCards(data) {
        this._isComparingCardsNow = true;
        this._gongXiNiShow(false);
        this._players = data.data.players;
        var user = this._findPlayerInfoByUserId(this._userId);
        if (!this.totalGameResult.active) {
            AudioManager.instance.playStartCompare(user.sex);
        }

        this.startCompareCardsNode.getComponent('alert').alert();
        this._playerComponents.forEach(function (playerComp) {
            playerComp.readyToCompareCards();
        });
        this.unscheduleAllCallbacks();
        this.scheduleOnce((function () {
            this.startCompareCardsNode.active = false;
            this._showCompareCardDetails(data);
        }).bind(this), 1.0);
    },

    _showCompareCardDetails: function _showCompareCardDetails(data) {

        this._playerComponents.forEach(function (playerComp) {
            playerComp.reset();
            playerComp.readyToCompareCards();
        });

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');

        cardTypeCombine.reset();

        cardTypeCombine.node.active = false;

        var comparePlayers1 = this._playerComponents.filter(function (player) {

            if (player.node.active) {

                var user = player.compareCardsNode.getComponent('CompareCards')._user;

                if (!user.isContainExtra) return player.node.active;
            }
        });

        var teShuPlayers = this._playerComponents.filter(function (player) {

            if (player.node.active) {

                var user = player.compareCardsNode.getComponent('CompareCards')._user;

                if (user.isContainExtra) return player.node.active;
            }
        });
        var self = this;
        var duration = this._showCompareCardStep(0, comparePlayers1);

        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers1);
        }, duration);

        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers1);
        }, duration * 2);

        if (teShuPlayers.length > 0) {
            this.scheduleOnce(function () {
                self._showCompareCardStep(0, teShuPlayers, true);
            }, duration * 3);
        }

        duration = duration * 3 + 0.5;

        for (var i = 0; i < teShuPlayers.length; i++) {

            var user = teShuPlayers[i].compareCardsNode.getComponent('CompareCards')._user;

            if (user.isContainExtra) duration = duration + 2.5;
        }

        var shootDuration = this.headCardTime;

        var shootDatas = this._shootDatas() || [];

        var shotData = this._shotData() || [];

        var homeRunUserId = this._homeRunUserId();

        var shotDataTimes = 0;

        shotData.forEach(function (data, index) {

            self.scheduleOnce(function () {

                self.playShoot(data.fromUserId, data.toUserId);
            }, duration + index * shootDuration);

            shotDataTimes += self.headCardTime;

            duration += self.headCardTime;
        });

        if (homeRunUserId.length >= 1) {

            shootDatas.forEach(function (data, index) {

                self.scheduleOnce(function () {

                    self.playShoot(data.fromUserId, data.toUserId);
                }, duration + (index + shotDataTimes) * shootDuration);

                duration += self.headCardTime;
            });
        }

        duration = duration + shootDatas.length * shootDuration + shotData.length * shootDuration;

        if (homeRunUserId > 0) {

            self.scheduleOnce(function () {
                self.playHomeRun(homeRunUserId);
            }, duration);

            duration = duration + 1;
        }

        if (homeRunUserId) {
            duration = duration + 1;
        }

        //this.scheduleOnce(function () {this._jinBiAction();}.bind(this), duration);//显示结算金币//显示结果
        this._jinBiAction(duration);
        //this.scheduleOnce(function () {
        //
        //    this._playerComponents.forEach(function (playerComp) {playerComp.showScoreResult();});
        //
        //    self._showCompareCardFinished();
        //
        //}.bind(this), duration);
    },

    _jinBiAction: function _jinBiAction(duration) {
        var comparePlayers1 = this._playerComponents.filter(function (player) {
            return player.node.active;
        });

        var nextTime = 0; //下一个动作开始的时间

        var zTime = 0; //下下一个动作开始的时间

        var start = 0;

        var end = 0;

        var coinsContainerAyy = []; //所有的用户的金币 一个用户一个数组

        var coinsAyy = []; //所有的金币，一个数组

        this.playsCoins.forEach(function (no) {
            if (no) no.removeAllChildren();
        });

        comparePlayers1.forEach((function (plays, index) {
            //根据积分创建金币

            var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

            if (cScore < 0) {

                cScore *= -1;

                var node = new cc.Node();

                node.name = "coinsContainer";

                var numScore = cScore > 30 ? 30 : cScore;
                for (var i = 0; i < numScore; i++) {
                    this._createJinBiPrefab(node, node); //根据积分创建金币
                }

                this.playsCoins[index].addChild(node);

                coinsContainerAyy.push(node.children);
            }
        }).bind(this));

        this.playsCoins.forEach(function (no) {
            if (no) no.active = false;
        });

        this.scheduleOnce((function () {
            //显示结果

            this.playsCoins.forEach(function (no) {
                if (no) no.active = true;
            });

            AudioManager.instance.coinIncome();

            coinsContainerAyy.forEach((function (coinsAyys) {
                //把金币移动到容器

                var initTime = 0;

                var interval = 0.002;

                coinsAyys.forEach((function (coins) {
                    //把金币移动到容器

                    var y = Math.round(Math.random()) == 0 ? -1 : 1;

                    y = Math.floor(Math.random() * 38) * y;

                    var x = Math.round(Math.random()) == 0 ? -1 : 1;

                    x = Math.floor(Math.random() * 38) * x;

                    var cardBackWorldSpace1 = this.node.convertToWorldSpaceAR(cc.v2(x, y));

                    var v2 = coins.convertToNodeSpaceAR(cardBackWorldSpace1);

                    this.scheduleOnce(function () {

                        coins.runAction(cc.moveBy(0.2, v2));
                    }, initTime);

                    initTime = initTime + interval;
                }).bind(this));

                nextTime = initTime;

                coinsAyy = coinsAyy.concat(coinsAyys); //把金币集合到一个数组
            }).bind(this));

            var zcScore = 0;

            comparePlayers1.forEach((function (plays) {
                //计算金币

                var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

                cScore = cScore > 30 ? 30 : cScore;

                if (cScore > 0) zcScore += cScore * 1;
            }).bind(this));

            var coinsAyy1 = coinsAyy.splice(zcScore, coinsAyy.length);

            coinsAyy1.forEach(function (node) {
                node.parent.removeChild(node);
            });

            comparePlayers1.forEach((function (plays) {
                //把金币到用户头像附近

                var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;

                if (cScore > 0) {

                    var interval = 0.0025;

                    var initTime = nextTime + 1;

                    var numScore = cScore > 30 ? 30 : cScore;

                    //end += numScore;

                    coinsAyy.splice(0, numScore).forEach((function (coinsNode) {
                        //把金币到用户头像附近

                        this.scheduleOnce(function () {

                            //获取节点的世界坐标
                            var cardBackWorldSpace1 = plays.node.convertToWorldSpaceAR(cc.v2(0, 0));
                            //获取相对父节点所在的坐标
                            var detail = coinsNode.convertToNodeSpaceAR(cardBackWorldSpace1);

                            var moveBy = cc.moveBy(0.25, detail);

                            var nextFadeIn = cc.fadeOut(0.13);

                            var moveSeq = cc.sequence(moveBy, nextFadeIn);

                            coinsNode.runAction(moveSeq);
                        }, initTime);

                        initTime = initTime + interval;
                    }).bind(this));

                    //start += cScore;

                    zTime = initTime;
                }
            }).bind(this));

            this.scheduleOnce((function () {
                //显示结果

                //this.playsCoins.forEach(function(no){if(no) no.active = false;});

                this._showCompareCardFinished();

                comparePlayers1.forEach(function (playerComp) {
                    playerComp.showScoreResult();
                });
            }).bind(this), zTime);

            this.scheduleOnce((function () {
                //显示结果

                this.playsCoins.forEach(function (no) {
                    if (no) no.removeAllChildren();
                });
            }).bind(this), zTime + 5);
        }).bind(this), duration);
    },

    _createJinBiPrefab: function _createJinBiPrefab(node, v2Node) {

        var nodes = cc.instantiate(this.coinsPrefab);

        var y = Math.round(Math.random()) == 0 ? -1 : 1;

        y = Math.floor(Math.random() * 38) * y + v2Node.y;

        var x = Math.round(Math.random()) == 0 ? -1 : 1;

        x = Math.floor(Math.random() * 38) * x + v2Node.x;

        nodes.x = x;

        nodes.y = y;

        node.addChild(nodes);
    },

    _showCompareCardStep: function _showCompareCardStep() {
        var startTime = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];
        var comparePlayers = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];
        var isContainExtra = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

        var duration = startTime;
        var interval = this.headCardTime;
        var teshuTime = 0;
        var self = this;

        comparePlayers = comparePlayers.sort(function (player1, player2) {
            return player1.nextCompareScore() - player2.nextCompareScore();
        });

        var co = comparePlayers;
        //console.log(co)
        //console.log('-------------执行了几次')

        co.forEach(function (player) {

            self.scheduleOnce(function () {
                player.showNextCompareCards();
            }, duration + teshuTime);

            duration = duration + interval;
            var user = player.compareCardsNode.getComponent('CompareCards')._user;
            if (user.isContainExtra) {
                if (user.cardInfo[0].type == 10) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._santonghuaAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 11) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._sanshunziAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 12) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._liuduibanAnimation();
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 18) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._qinglongAniamtion('long');
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                } else if (user.cardInfo[0].type == 19) {

                    self.scheduleOnce(function () {
                        this.node.getComponent("animation")._qinglongAniamtion("ql");
                    }, duration - 1 + teshuTime);

                    teshuTime += 2.5;
                }
            }
        });

        if (isContainExtra) {

            for (var i = 0; i < co.length; i++) duration = duration + 2.5;

            this._playerComponents.forEach(function (player) {
                if (player.node.active) {
                    self.scheduleOnce(function () {
                        player.showNextCompareScore(isContainExtra);
                    }, duration - interval);
                }
            });
        } else {
            co.forEach(function (player) {
                self.scheduleOnce(function () {
                    player.showNextCompareScore();
                }, duration - interval);
            });
        }

        return duration + teshuTime;
    },

    _isGameOver: function _isGameOver() {},

    // 比牌完成后会调用的方法
    _showCompareCardFinished: function _showCompareCardFinished() {
        this.timeStart(5, "ready");
        this._showOneGameResult();
        /**/
        this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
        /**/
    },

    //network
    showNetworkMessage: function showNetworkMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? "网络链接断开，重新连接中..." : arguments[0];

        if (this.networkNode && this.networkNode.active) {
            return;
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg, autoDismiss) {
        var alertComp = this.alert.getComponent('alert');
        if (!this.alert.active) {
            alertComp.alert();
        }

        alertComp.setMessage(msg);
        alertComp.unscheduleAllCallbacks();
        if (autoDismiss) {
            alertComp.scheduleOnce(function () {
                alertComp.dismissAction();
            }, 5);
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? '检查网络中...' : arguments[0];

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null && this.checkNode.active) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },

    /////  聊天语音逻辑
    // _registerVoiceNodeEvents: function () {
    //     let self = this;
    //     let chatVoiceNode = this.btnChatVoice.node;
    //     this.endRecordTime = Date.now();
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_START,function(event) {
    //         if (Date.now() - self.endRecordTime >= 1000) {
    //             self.nativeRecordAction();
    //             //self.voiceRecordAnimationNode.active = true;

    //             let action = cc.scaleTo(0.12, 1.2);
    //             self.btnChatVoice.node.runAction(action);

    //             self._isRecording = true;
    //         }
    //     });
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_END,function(event) {
    //         if (self._isRecording) {
    //             self.endRecordTime = Date.now();
    //         }
    //         self._isRecording = false;

    //         self.nativeEndRecordAction();
    //         //self.voiceRecordAnimationNode.active = false;

    //         let action = cc.scaleTo(0.12, 1);
    //         self.btnChatVoice.node.runAction(action);
    //     });
    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL,function(event) {
    //         if (self._isRecording) {
    //             self.endRecordTime = Date.now();
    //         }
    //         self._isRecording = false;

    //         self.nativeEndRecordAction();
    //         //self.voiceRecordAnimationNode.active = false;

    //         let action = cc.scaleTo(0.12, 1);
    //         self.btnChatVoice.node.runAction(action);
    //     });
    //     Socket.instance.uploadFinish = function(url) {
    //         let userId = self._userId;
    //         Socket.sendAudioMessage(userId, url);
    //         self.playSpeakAnimation(self._userId);
    //     };
    // },

    _registerVoiceNodeEvents: function _registerVoiceNodeEvents() {
        var self = this;
        var chatVoiceNode = this.btnChatVoice.node;
        this.endRecordTime = Date.now();
        chatVoiceNode.on(cc.Node.EventType.TOUCH_START, function (event) {
            // self.VoiceMsgBgAnimation();
            if (!cc.sys.isNative) {
                var runTime = 0.3;
                var tishi = cc.instantiate(self.autoTishi);
                self.node.addChild(tishi);
                var action = cc.spawn(cc.moveTo(0.3, cc.v2(0, 0)), cc.fadeIn(0.3));
                tishi.runAction(action);
                self.scheduleOnce((function () {
                    var finished = cc.callFunc(function () {
                        tishi.removeFromParent(true);
                    });
                    var action = cc.sequence(cc.spawn(cc.fadeOut(runTime), cc.moveTo(runTime, cc.v2(0, 50))), finished);
                    tishi.runAction(action);
                }).bind(this), 1.5);
                //var url = "www.baidu.com";
                //let userId = self._userId;
                //Socket.sendAudioMessage(userId, url);
            } else {
                    if (Date.now() - self.endRecordTime >= 1000) {
                        self.VoiceMsgBgAnimation();
                        self.nativeRecordAction();
                        var _action = cc.scaleTo(0.12, 1.2);
                        self.btnChatVoice.node.runAction(_action);
                        self._isRecording = true;
                    }
                }
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            self.VoiceMsgBg.active = false;
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            //self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            self.VoiceMsgBg.active = false;
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            //self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        Socket.instance.uploadFinish = function (url) {
            var userId = self._userId;
            Socket.sendAudioMessage(userId, url);
            self.playSpeakAnimation(self._userId);
        };
    },
    VoiceMsgBgAnimation: function VoiceMsgBgAnimation() {
        this.VoiceMsgBg.active = true;
        var whileLayout = this.VoiceMsgBg.getChildByName("whileLayout");
        var childWhile = whileLayout.getChildByName("childWhile");
        if (this.whileLayoutInterval) {
            clearInterval(this.whileLayoutInterval);
        }

        this.whileLayoutInterval = setInterval(function () {
            var node = cc.instantiate(childWhile);
            if (whileLayout.children.length > 5) {
                whileLayout.removeAllChildren();
            }
            whileLayout.addChild(node);
        }, 200);

        var layout = this.VoiceMsgBg.getChildByName("layout");
        var cWhile = layout.getChildByName("while");

        if (this.layoutInterval) {
            clearInterval(this.layoutInterval);
        }

        this.layoutInterval = setInterval(function () {
            var node = cc.instantiate(cWhile);
            if (layout.children.length > 3) {
                layout.removeAllChildren();
            }
            layout.addChild(node);
        }, 300);
    },
    nativeRecordAction: function nativeRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
            AudioManager.instance.pauseMusic();
        }
    },

    nativeEndRecordAction: function nativeEndRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
            AudioManager.instance.resumeMusic();
        }
    },

    playAudioUrl: function playAudioUrl(url) {
        //console.log("---------------------------2553");
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", url);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", url);
        }
    },

    // MARK:  退出游戏逻辑
    _handleUpdateDeskInfoAboutExitRoom: function _handleUpdateDeskInfoAboutExitRoom(deskInfo) {
        if (!deskInfo.isDissolving) {
            return;
        }
        var dataInfos = deskInfo.dissolveAnswerInfo;

        var alertComp = this.alertAnsowerExitNode.getComponent('alert');

        alertComp.alert();

        alertComp.unscheduleAllCallbacks();

        this.contentAnsowerExitNode.children.forEach(function (i) {
            i.active = false;
        });

        this._playerInfos.forEach((function (playerInfo, index) {

            var play = this.contentAnsowerExitNode.children[index];

            var name = play.getChildByName("nickname");

            var back = play.getChildByName("fanzhu");

            var img = play.getChildByName("avatar_bg");

            var str = play.getChildByName("id");

            var dataInfo = dataInfos[index];

            play.active = true;

            name.getComponent(cc.Label).string = playerInfo.nickname;

            if (this._deskInfo.createId == playerInfo.id) {
                //显示房主

                back.active = true;
            } else {

                back.active = false;
            }

            cc.loader.load({ url: playerInfo.avatarUrl, type: "jpg" }, (function (err, data) {

                if (err) return;

                var frame = new cc.SpriteFrame(data);

                img.getComponent(cc.Sprite).spriteFrame = frame;
            }).bind(this));

            if (dataInfo == 1) {

                str.getComponent(cc.Label).string = "同意";
            } else {

                str.getComponent(cc.Label).string = "";
            }
        }).bind(this));

        var dissolveLeftTime = deskInfo.dissolveLeftTime || 60;

        var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');

        countdown.startCountdown(dissolveLeftTime, (function (isTimeout) {

            if (isTimeout) {
                this.clickAgreeOtherPlayerExit();
                return;
            }
        }).bind(this));

        var dissolveUserId = deskInfo.dissolveUserId;

        if (dissolveUserId == this._userId) {

            var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");

            var btnAgree = alert_bg.getChildByName("btnAgree");

            var btnDisagree = alert_bg.getChildByName("btnDisagree");

            btnAgree.active = false;

            btnDisagree.active = false;
            //this.alertRequestExitNode.active = true;
            //this.btnAlertRequestExitCancelButton.node.active = false;
            //this.btnAlertRequestExitConfirmButton.node.active = false;
            //let alert = this.alertRequestExitNode.getComponent('alert');
            //alert.setMessage("您正在申请协商退出，等待其他玩家同意");
            //this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(dissolveLeftTime);
            return;
        }

        //let dissolveAnswerInfos = deskInfo.dissolveAnswerInfo;
        //let currentUserIdIndex = deskInfo.playersIndex.findIndex(function(userId) {
        //    return this._userId == userId;
        //}.bind(this));
        //
        //let answerResult = dissolveAnswerInfos[currentUserIdIndex];
        //
        //if (answerResult == -1) {
        //    // -1 表示未处理  0 表示拒绝  1表示同意
        //    this.alertAnsowerExitNode.active = true;
        //
        //    let countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');
        //
        //    countdown.startCountdown(dissolveLeftTime, function(isTimeout) {
        //        if (isTimeout) {
        //            this.clickAgreeOtherPlayerExit();
        //        }
        //    }.bind(this));
        //
        //}
    },

    // 确定要强制退出游戏
    clickConfirmForceExit: function clickConfirmForceExit() {
        Socket.sendForceExitRoom(this._userId);
        cc.director.loadScene('hall');
    },

    // 确认请求退出游戏
    clickConfirmRequestExit: function clickConfirmRequestExit() {
        this.btnAlertRequestExitCancelButton.node.active = false;
        this.btnAlertRequestExitConfirmButton.node.active = false;
        var alert = this.alertRequestExitNode.getComponent('alert');
        if (this._deskInfo.cIndex > 0) {
            alert.setMessage("您正在申请协商退出，等待其他玩家同意");
            this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(60);
        }
        Socket.sendLeaveDesk(this._userId);
    },

    // 同意他人退出
    clickAgreeOtherPlayerExit: function clickAgreeOtherPlayerExit() {
        //this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        //this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        //this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");
        var btnAgree = alert_bg.getChildByName("btnAgree");
        var btnDisagree = alert_bg.getChildByName("btnDisagree");
        btnAgree.active = false;
        btnDisagree.active = false;
        Socket.sendAnswerDissolve(this._userId, 1);
    },

    // 不同意他人退出
    clickDisagreeOtherPlayerExit: function clickDisagreeOtherPlayerExit() {
        //this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        //this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        //this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        var alert_bg = this.alertAnsowerExitNode.getChildByName("alert_bg");
        var btnAgree = alert_bg.getChildByName("btnAgree");
        var btnDisagree = alert_bg.getChildByName("btnDisagree");
        btnAgree.active = false;
        btnDisagree.active = false;
        Socket.sendAnswerDissolve(this._userId, 0);
    },

    // 隐藏请求退出 Node
    _hideReqestExitNode: function _hideReqestExitNode() {
        if (!this.alertRequestExitNode.active) {
            return;
        }

        this.alertRequestExitNode.active = false;
        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },

    //// 打枪
    playShoot: function playShoot(fromUserId, toUserId) {
        var user = this._findPlayerInfoByUserId(fromUserId);
        if (user) {
            AudioManager.instance.playHumanDaQiang(user.sex);
        }

        var toUserIndex = this._findPlayerIndexByUserId(toUserId);

        this._playerComponents.forEach((function (player) {
            if (this._userId == fromUserId || this._userId == toUserId) player.showNextCompareScore();
            player.playShootAnimation(fromUserId, toUserIndex);
            player.playBulletHoleAnimation(toUserId);
        }).bind(this));
    },

    // 播放全垒打动效
    playHomeRun: function playHomeRun(userId) {
        var user = this._findPlayerInfoByUserId(userId);
        if (user) {
            AudioManager.instance.playHomeRun(user.sex);
        }
        this.node.getComponent("animation")._quanleidaAnimation('long');

        this._playerComponents.forEach((function (player) {

            player.showNextCompareScore();
        }).bind(this));
    },

    playSpeakAnimation: function playSpeakAnimation(userId) {
        this._playerComponents.forEach(function (player) {
            player.playSpeakAnimation(userId);
        });
    },

    _shootDatas: function _shootDatas() {
        var homeRunUserId = this._homeRunUserId(); // 全垒打
        var shootDatas = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId == homeRunUserId;
        });
        return shootDatas;
    },

    _shotData: function _shotData() {
        var homeRunUserId = this._homeRunUserId(); // 打枪
        var shotData = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId != homeRunUserId;
        });
        return shotData;
    },

    _homeRunUserId: function _homeRunUserId() {
        return this._deskInfo.allShotData;
    },

    // MARK: 房间信息部分

    // 获取房间的玩法
    _deskInfoGameWay: function _deskInfoGameWay() {
        var setting = this._deskInfo.setting3;
        if (setting == null) {
            setting = 2;
        }
        var names = ["庄家模式", "无特殊牌", "普通模式"];
        return names[setting];
    },

    _deskInfoNumberOfGame: function _deskInfoNumberOfGame() {
        var setting = this._deskInfo.setting1;
        var infos = ['10局', '20局', '40局', '5局'];
        /*if (setting <= 1) {
         return '条数：' + infos[setting];
         }*/
        if (setting == 2) {
            setting = 0;
        } else if (setting == 3) {
            setting = 1;
        } else if (setting == 4) {
            setting = 2;
        } else if (setting == 5) {
            setting = 3;
        }
        return '局数：' + infos[setting];
    },

    _deskInfoNumberOfPeople: function _deskInfoNumberOfPeople() {
        var setting = this._deskInfo.setting2;
        var infos = ['2人', '3人', '4人', '5人'];
        return infos[setting];
    },

    _deskInfoPayInfo: function _deskInfoPayInfo() {
        var setting = this._deskInfo.setting4;
        if (setting == null) {
            setting = 0;
        }
        if (setting == 0) {
            setting = 1;
        }
        var infos = ['房主霸主庄', '房费AA'];
        return infos[setting];
    },

    _deskInfoJiaYiSeInfo: function _deskInfoJiaYiSeInfo() {
        var setting = this._deskInfo.setting7 == 0 ? 1 : 0;
        var infos = ['无多一色', '多一色'];
        return infos[setting];
    },

    _deskInfoGuiPaiInfo: function _deskInfoGuiPaiInfo() {
        var setting = undefined;
        if (this._deskInfo.setting8 == null) {
            setting = 0;
        } else if (this._deskInfo.setting8 == 0) {
            setting = 1;
        } else if (this._deskInfo.setting8 == 1) {
            setting = 2;
        }
        var infos = ['无王牌', '两张王牌', '四张王牌'];
        return infos[setting];
    },

    // MARK: 剩余时间
    _remainTimeStartUpdate: function _remainTimeStartUpdate() {
        //this.schedule(this._remainTimeUpdate, 1.0, cc.macro.REPEAT_FOREVER);
    },

    _remainTimeUpdate: function _remainTimeUpdate() {
        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        if (this._deskInfo == null) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        var isTaoShu = this._deskInfo.setting1 == 0 || this._deskInfo.setting1 == 1;
        if (isTaoShu) {
            this.labelRemainTime.node.active = false;
            return;
        }

        if (!this._deskInfo.createTime) {
            return;
        }

        this.labelRemainTime.node.active = true;
        var createTime = fecha.parse(this._deskInfo.createTime, 'YYYY-MM-DD HH:mm:ss').getTime();
        var oneHour = 60 * 60;
        var remain = (Date.now() - createTime) / 1000;
        remain = Math.max(oneHour - remain, 0);

        var mins = Math.floor(remain / 60);
        var secs = Math.floor(remain % 60);
        if (mins == 0 && secs == 0) {
            this.labelRemainTime.string = "";
            return;
        }

        var minsString = "" + mins;
        if (minsString.length < 2) {
            minsString = "0" + minsString;
        }

        var secsString = "" + secs;
        if (secsString.length < 2) {
            secsString = "0" + secsString;
        }

        var string = "剩余时间：00:" + minsString + ":" + secsString;
        this.labelRemainTime.string = string;
    },

    // MARK: 处理同 IP 的用户
    _handleTheSameOfIPAdress: function _handleTheSameOfIPAdress(userInfos) {
        if (!userInfos || userInfos.length == 0) {
            return;
        }

        var ipUserInfos = userInfos.reduce(function (ips, userInfo) {
            var users = ips[userInfo.ipAddress] || [];
            users.push(userInfo);

            ips[userInfo.ipAddress] = users;
            return ips;
        }, {});

        var sameIpUsers = null;
        for (var ip in ipUserInfos) {
            var users = ipUserInfos[ip];
            if (users.length > 1) {
                sameIpUsers = users;
                break;
            }
        }

        if (sameIpUsers == null) {
            return;
        }

        this._alertSameIpUserInfos(sameIpUsers);
    },

    _alertSameIpUserInfos: function _alertSameIpUserInfos(users) {
        var message = "";
        var userIds = "";
        users.forEach(function (user, index) {
            message = message + (index > 0 ? ' 和 ' : '') + user.nickname;
            userIds = userIds + user.id;
        });
        message = message + ' 在同一 IP 下！';

        this._didAlertSameIpMessage = this._didAlertSameIpMessage || {};
        if (this._didAlertSameIpMessage[userIds]) {
            return;
        }

        this.showAlertMessage(message, true);
        this._didAlertSameIpMessage[userIds] = true;
    }

});
Play.gongXiNiShow = function (type) {
    this.instances._gongXiNiShow(type);
};
module.exports = Play;

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","AudioManager":"AudioManager","KQCard":"KQCard","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","Player":"Player","UserModelHelper":"UserModelHelper","fecha":"fecha","manager":"manager","socket":"socket"}],"product":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'a9ad2cC2BdEiaFSqV4XCWQV', 'product');
// scripts\product.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        productId: ''
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickAction: function clickAction() {
        this.onClickAction(this.productId);
    },

    onClickAction: function onClickAction(productId) {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"randRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4d298BlaelCHqiV5dTDjhuY', 'randRoom');
// scripts\randRoom.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');

cc.Class({
    'extends': cc.Component,

    properties: {
        matchingLabel: cc.Label,
        timeNode: cc.Node,
        matchingNode: cc.Node,
        waitingPrefab: cc.Prefab,
        alertPrefab: cc.Prefab,

        tishi: cc.Node,

        _userId: null,
        _response: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        cc.isRoomViewShow = true;
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        KQGlobalEvent.on(Socket.Event.ReceiveInterRandom, this._socketReceiveInterRandom, this);
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            return;
        }

        cc.director.loadScene('play');
    },

    _socketReceiveInterRandom: function _socketReceiveInterRandom(response) {
        //服务器发送  {'action':'interRandom','result':false,'data':{'reason':reason}}
        this._response = response;
        this.unschedule(this._timeoutRandomAction);
        // 处理随机场匹配不成功的情况
        if (response.result) {
            return;
        }

        var reason = response.data.reason || "加入随机场失败";
        this.showAlertMessage(reason);

        if (reason == '你已经在匹配队列') {
            this._showMatching();
        } else {
            this._hideMatching();
        }
    },

    _socketDisconnect: function _socketDisconnect() {
        // 连接已断开
        this.matchingNode.active = false;
        this.showNetworkMessage('网络链接断开，重新连接中...');
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    },

    clickStart: function clickStart() {
        Socket.sendEnterRandom(this._userId);
        this._showMatching();

        /*#####begin*/
        //reason是服务器发送回来的
        /*if(this._response.data.reason == "你的钻石不足"){
            this.tishi.active = true;
        }*/
        /*#####end*/

        this.scheduleOnce(this._timeoutRandomAction, 5);
    },
    /*#####点击空白地方，砖石不足提示消失*/
    /*onBtnKong:function () {
        if(this.tishi.active){
            this.tishi.active = false;
        }else{
            //什么也不做
        }
    },*/
    /*取消匹配*/
    clickCancel: function clickCancel() {
        Socket.sendCancelRandom(this._userId);

        this._hideMatching();
    },

    _timeoutRandomAction: function _timeoutRandomAction() {
        this._hideMatching();
        this.showAlertMessage('进入匹配失败');
    },

    _showMatching: function _showMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.alert();
        this.matchingLabel.string = '正在匹配中，请稍后...';
        var num = 0;
        this.schedule(function () {
            num = num + 0.5;
            this.timeNode.rotation = num;
        }, 0.01);
    },

    _hideMatching: function _hideMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.dismissAction();
    },

    showNetworkMessage: function showNetworkMessage(msg) {
        this.unschedule(this._timeoutRandomAction);

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg) {
        if (!msg) {
            cc.error("不能显示为空的信息");
            return;
        }

        if (!this.alertMessageNode) {
            this.alertMessageNode = cc.instantiate(this.alertPrefab);
            this.node.addChild(this.alertMessageNode);
        }

        this.alertMessageNode.getComponent('alert').setMessage(msg);
        this.alertMessageNode.getComponent('alert').alert();
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"recordInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1457gdvd5I5aENjKvCTkCd', 'recordInfo');
// scripts\recordInfo.js

var Socket = require('socket');
var Playback = require('Playback');
var record = require('record');

cc.Class({
    'extends': cc.Component,

    properties: {
        timeLabel: cc.Label, // 时间
        jushuLabel: cc.Label, // 局数
        createUser: cc.Node, // 房主
        roomId: cc.Label, // 房间号
        jifen: cc.Label, // 积分
        id: cc.Label,
        avatarNode: cc.Node, // 头像
        creatorImg: cc.Node, // 创房头像
        nicknameLabels: cc.Label,
        scoreLabels: [cc.Label],
        //numNode:cc.Label,
        _parentId: null,
        //playbackNode:cc.Node,//回放按钮
        //watchNode:cc.Node,//查看按钮
        reordInfo: cc.Node,
        _recordItemInfo: null,
        totalGameResult: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {
        this.totalGameResult = cc.find("Canvas/recordInfo");
    },

    setInfo: function setInfo(recordInfo) {
        this._parentId = recordInfo.id;
        //this.watchNode.active = true;
        //this.playbackNode.active = false;
        if (recordInfo.playersInfo.length == 0) {
            return;
        }

        var playersInfo = JSON.parse(recordInfo.playersInfo);
        recordInfo.scores = JSON.parse(recordInfo.scores);

        var fen = recordInfo.scores[this.fen(recordInfo.userid, playersInfo.playersIndex)];
        //cc.log(fen)
        //cc.log(recordInfo.scores)
        //cc.log(this.fen(recordInfo.userid,playersInfo.playersIndex))
        //cc.log(recordInfo.userid)
        //cc.log(playersInfo.playersIndex)
        //cc.log(recordInfo)
        //cc.log(playersInfo)
        //cc.log('----47')
        this.jifen.string = fen >= 0 ? "+" + fen : fen;

        var headUrl = playersInfo.players[this.creator(recordInfo.createUserId, playersInfo.playersIndex)].avatarUrl; // 头像URL
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        cc.loader.load({ url: headUrl, type: "jpg" }, function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;
            }
        });

        this.roomId.string = "房号：" + playersInfo.roomId;
        this.timeLabel.string = "时间：" + playersInfo.time.substr(5, 11);
        this.jushuLabel.string = "局数：" + this.js(playersInfo.setting1 - 2);

        //for (var i = 0;i < playersInfo.players.length;i++) {
        //  this.nicknameLabels[i].string = playersInfo.players[i].nickname;
        //  this.scoreLabels[i].string = playersInfo.players[i].totalScore;
        //}
    },
    js: function js(setting2) {
        var jushu = 5;
        switch (setting2) {
            case 0:
                jushu = 5;break;
            case 1:
                jushu = 10;break;
            case 2:
                jushu = 20;break;
            case 3:
                jushu = 30;break;
        }
        return jushu;
    },

    fen: function fen(userid, players) {
        // 找积分
        for (var i = 0; i < players.length; i++) {
            if (players[i] == userid) {
                return i;
            }
        }
    },
    creator: function creator(_creator, players) {
        //创房者
        for (var i = 0; i < players.length; i++) {
            if (players[i] == _creator) {
                return i;
            }
        }
    },

    clickAction: function clickAction(event, data) {
        var playersInfo = JSON.parse(data.playersInfo);
        var totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');
        totalGameResultComp.setPlayerInfos(playersInfo.players, data);
        totalGameResultComp._clickBtn();
        this.totalGameResult.getComponent('alert').alert();

        //if (this._recordItemInfo) {
        //  this._startPlayback(this._recordItemInfo._info8Array);
        //  return;
        //}
        ////Socket.sendGetItemRecord(Socket.instance.userInfo.id,this._parentId);
        //Socket.sendGetItemRecord(Socket.instance.userInfo.id,--index);
    },

    _startPlayback: function _startPlayback(playBackInfo) {
        //Playback.instance.setPlaybackDatas(playBackInfo);
        //cc.director.loadScene('play');
    },

    detailAction: function detailAction(recordItemInfo, index) {
        //this._recordItemInfo = recordItemInfo;
        ////this.playbackNode.active = true
        ////console.log();
        ////this.numNode.string = "第" + (index + 1) + "局";
        //this.timeLabel.string = recordItemInfo.creatAt.substr(5,11);
        //let objArray = JSON.parse(recordItemInfo.info8);
        //this._recordItemInfo._info8Array = objArray;
        //let playersArray = objArray.map(function(str){
        //  return JSON.parse(str);
        //});
        //
        //var players = playersArray[playersArray.length-1].data.players;
        //for (var i = 0;i < players.length;i++) {
        //    this.nicknameLabels[i].string = players[i].nickname;
        //    this.scoreLabels[i].string = players[i].cScore;
        //}
    },
    records: function records() {}

});

cc._RFpop();
},{"Playback":"Playback","record":"record","socket":"socket"}],"record":[function(require,module,exports){
"use strict";
cc._RFpush(module, '452f4rFUqRLFYlGEJS5kEWs', 'record');
// scripts\record.js

var KQGlobalEvent = require('KQGlobalEvent');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        scrollView: cc.Node,
        recordItem: cc.Prefab
    },

    //subScrollView:cc.Node,
    //subRecordItem:cc.Node,
    //splash:cc.Prefab,
    //reordInfo:cc.Node,
    //
    //jifen:cc.Label,
    //head:cc.Node,
    //id:cc.Label,
    //nickname:cc.Label,
    //creat:cc.Label,        // 创房人
    //createUser:cc.Node,     //  头像
    //
    //timeLabel:cc.Label,   // 时间
    //jushuLabel:cc.Label,  // 局数
    ////createUser:cc.Node,   // 房主
    //roomId:cc.Label,      // 房间号
    //_records:null,
    // use this for initialization
    onLoad: function onLoad() {
        //this.isSubPage = false;
        //this.subScrollView.active = false;
        //
        //this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;
        //console.log( this.subScrollViewContent );
        //this.recordInfo = this.subScrollViewContent.children[0];
        //this.reords = this.subScrollViewContent.children[0].children[3];
        this.scrollViewContent = this.scrollView.getComponent(cc.ScrollView).content;
        this._registerSocketEvent();
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.GetRecord, this._ReceiveRecordInfo, this);
        //KQGlobalEvent.on(Socket.Event.GetItemRecord, this._ReceiveRecordItem, this);
    },

    _ReceiveRecordInfo: function _ReceiveRecordInfo(response) {
        //cc.log(response)
        //cc.log('------78')
        //console.log(response);
        //this._records = response.data;
        //this.isSubPage = false;
        //this.subScrollView.active = false;
        //this.scrollView.active = true;

        this.scrollViewContent.removeAllChildren();
        var index = 0;
        response.data.filter(function (record) {
            return record.playersInfo.length > 0;
        }).forEach((function (recordInfo) {
            index++;
            var item = cc.instantiate(this.recordItem);
            this.scrollViewContent.addChild(item);
            var comp = item.getComponent('recordInfo');
            comp.setInfo(recordInfo);
            var recordBtn = item.children[7].getComponent(cc.Button);
            recordBtn.clickEvents[0].customEventData = recordInfo;
            // var eventHandler = new cc.Component.EventHandler();
            // eventHandler.target = comp.node.children[7];
            // eventHandler.component = "btn";
            // eventHandler.handler = "clickAction";
            //eventHandler.customEventData = "my data";
            //console.log(comp.node.children[7]);
        }).bind(this));
    },

    closeAction: function closeAction() {
        if (this.isSubPage) {
            this.isSubPage = false;
            this.subScrollView.active = false;
            this.scrollView.active = true;
        } else {
            this.node.getComponent('alert').dismissAction();
        }
    }
});
/* clickAction:function( index ){
     //_ReceiveRecordItem()
 },
 _ReceiveRecordItem:function(RecordItemInfo) {
     cc.log(RecordItemInfo)
     cc.log('------78')
     //console.log(RecordItemInfo);return;
     var index = RecordItemInfo.data
     var playersInfo = JSON.parse(this._records[index].playersInfo);
     
     var players = playersInfo.players;                  // 玩家信息
     var playersIndex = playersInfo.playersIndex;        // 玩家的位置
     var createUserId = this._records[index].createUserId;   // 创房ID
     var sendUserId = this._records[index].userid;           // 发送人ID
       this.isSubPage = true;
     this.subScrollView.active = true;
     this.scrollView.active = false;
       this.timeLabel.string = (this._records[index].createAt).substr(5,11);               // 时间
     this.jushuLabel.string = this.js(JSON.parse(this._records[index].setting2));        // 局数
     this.roomId.string = this._records[index].roomId;                                   // 房间号
     this.creat.string = this.findCreator(this._records[index].createUserId,players);    // 房主
       this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;
     this.subScrollViewContent.removeAllChildren();
       for(var i = 0; i < players.length; i++ ){
         var item = cc.instantiate(this.splash);
         this.subScrollViewContent.addChild(item);
         var comp = item.getComponent('recordInfo');
         var creator = 0;       
         var self = 0;       // 表示自己，要对自己的比牌记录背景做处理
         if(createUserId == players[i].id){
             creator =1;
         }
         if( sendUserId == players[i].id){
             self = 1;
         }
         this.records(comp,i,creator,self,index);
     }
   },
 records:function(info,i,creator,self,index){
     if(self){
         info.node.color = new cc.Color(125, 126, 200);
     }
     cc.log(info)
     cc.log('----119')
     var players = JSON.parse(this._records[index].playersInfo).players;
     var scores = this._records[index].scores ;
     info.nicknameLabels.string = players[i].nickname;
     info.id.string = players[i].id;
     info.jifen.string = scores[i];
       var headUrl = players[i].avatarUrl;   //头像连接
     var sprite = info.avatarNode.getComponent(cc.Sprite);
     cc.loader.load(headUrl+".jpg", function (err, tex) {
       if (!err) {
           var frame = new cc.SpriteFrame(tex);
           sprite.spriteFrame=frame;
       }
     });
     info.creatorImg.active = creator;
 },
 findCreator:function(createId,players){ //找房主
     for(var i=0; i<players.length;i++){
         if(createId == players[i].id){
             return players[i].nickname;
         }
     }
 },
 js:function(num){
     var J = 5;
     switch(num){
         case 0: J = 5;break;
         case 1: J = 10;break;
         case 2: J = 20;break;
         case 3: J = 30;break;
     }
     return J;
 },*/

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"rule":[function(require,module,exports){
"use strict";
cc._RFpush(module, '92f6eNs7RdDRJIRLCZnyulJ', 'rule');
// scripts\rule.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    }
});

cc._RFpop();
},{}],"scale":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c1c33tgIe9JvLb/mE+2mRnK', 'scale');
// scripts\scale.js

cc.Class({
    "extends": cc.Component,

    properties: {
        content: cc.Node
    },

    onLoad: function onLoad() {
        var visibleSize = cc.director.getVisibleSize();
        var contentSize = {};
        contentSize.width = this.node.width;
        contentSize.height = this.node.height;
        var scaleX = visibleSize.width / contentSize.width;
        var scaleY = visibleSize.height / contentSize.height;
        var scale = Math.min(scaleX, scaleY).toFixed(2);
        this.node.scaleX = scale;
        this.node.scaleY = scale;
    }
});

cc._RFpop();
},{}],"selectMoShi":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0030eDrh7xEm6AeR3FCg5WU', 'selectMoShi');
// scripts\selectMoShi.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        selectedIndex: 0,
        _select: [],
        _selected: 0,
        beilv: cc.Node, // 倍率
        _blShow: 0 },

    // 倍率的显示状态
    onLoad: function onLoad() {
        this.beilv.active = this._blShow;
        this._select = [1, 1, 1, 0, 0];
        if (cc.set) {
            // 记录上一句的房间情况
            this._select = cc.set['setting3'];
        }
        var self = this;
        for (var i = 0; i < this.nodes.length; i++) {
            var active = this._select[i];
            this.nodes[i].getComponent('select').setSelected(active);
            var title = this.nodes[i].getChildByName('title');
            if (this._select[i]) {
                title.color = new cc.Color(13, 210, 222);
            } else {
                title.color = new cc.Color(255, 255, 255);
            }
            if (i == 3) {
                this.beilv.active = this._blShow = this._select[3];
            }
        }

        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                var index = this.index;
                for (var i = 0; i < self.nodes.length; i++) {
                    var comp = self.nodes[i].getComponent('select');
                }
                this.setSelected(self._select[index] = !self._select[index]);
                if (this.index == 3) {
                    // 第三个是庄家模式，庄家模式显示倍率
                    self.beilv.active = this._blShow = self._select[3];
                }

                self._select[index] = self._select[index];
                self.selectedIndex = index;
                self.onSelectChange(index);

                var title = this.node.children[0];
                if (self._select[index]) {
                    // 如果当前选项为TRUE 则显示青色
                    title.color = new cc.Color(13, 210, 222);
                } else {
                    // 反之 白色
                    title.color = new cc.Color(255, 255, 255);
                }
            };
        }
    },
    onSelectChange: function onSelectChange(selectIndex) {
        //cc.log(selectIndex);
        //console.log(this._select);
    }

});

cc._RFpop();
},{}],"select_mapai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8e7e53kJcJK9rwMSxnloqI5', 'select_mapai');
// scripts\select_mapai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        pai: cc.Node,
        mapai: {
            "default": [],
            type: cc.SpriteFrame
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selectMa = this.node.getComponent("select_ma");
        this.selectMa.onLoad();
        this.com = this.pai.getComponent(cc.Sprite);
    },

    clickBtnComfirm: function clickBtnComfirm() {
        this.com.spriteFrame = this.mapai[cc.from.ma];
        //console.log(this.com.spriteFrame);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"select_ma":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4bc0b2bZGRGXoAfdO3Y6Squ', 'select_ma');
// scripts\select_ma.js

cc.Class({
    "extends": cc.Component,

    properties: {
        rightIcon: [cc.Node],
        mapaiRight: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.from == null) {
            cc.from = {};
        }
        //如果不带马，则马牌为空
        if (this.mapaiRight.active == false) {
            cc.from.isUseMa = false;
            cc.from.ma = null;
        } else {
            cc.from.isUseMa = true;
            //否则马牌默认为第0个，即黑桃5
            cc.from.ma = 0;
        }
        for (var i = 0; i < this.rightIcon.length; i++) {
            if (i == 0) {
                this.rightIcon[i].active = true;
                cc.from.ma = 0;
                this.select = this.rightIcon[i];
            } else {
                this.rightIcon[i].active = false;
            }
        }
    },
    onMaPaiClick: function onMaPaiClick(e) {
        var targetName = e.target.name;
        //cc.log(targetName)
        if (targetName != this.select.parent.name) {
            if (targetName == "select_kuang1") {
                this.select = this.rightIcon[2];
                cc.from.ma = 2;
            } else if (targetName == "select_kuang2") {
                this.select = this.rightIcon[1];
                cc.from.ma = 1;
            } else if (targetName == "select_kuang3") {
                this.select = this.rightIcon[0];
                cc.from.ma = 0;
            }
            for (var i = 0; i < this.rightIcon.length; i++) {
                this.rightIcon[i].active = false;
            }
            this.select.active = true;
        }
        //console.log(cc.from.ma);
    }

});

cc._RFpop();
},{}],"selectbeilv":[function(require,module,exports){
"use strict";
cc._RFpush(module, '253cf+Bll9FV5ngl0DW3PxZ', 'selectbeilv');
// scripts\selectbeilv.js

var KQGlobalEvent = require('KQGlobalEvent');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        _userid: 0
    },

    // use this for initialization
    onLoad: function onLoad() {},
    clickBeiLv: function clickBeiLv(event, num) {
        this.node.active = false;
        Socket.sendBeiLv(num, this._userid);
    }

});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"select":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e913aIwAtVEo5jMrf40D5rw', 'select');
// scripts\select.js

cc.Class({
    "extends": cc.Component,

    properties: {
        bgNode: cc.Node, //选择框
        selectedNode: cc.Node, //对号
        pai: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        //console.log(this.node);
        this.selected = true;
        //console.log(cc.set);
    },

    clickAction: function clickAction() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
    },

    setSelected: function setSelected(selected) {
        this.selected = selected;
        this.selectedNode.active = this.selected;
    },
    /*#####*/
    clickSelectKuang: function clickSelectKuang() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        cc.from.isUseMa = this.selected;
        var mapaiCom = this.pai.getComponent(cc.Button);
        if (this.selectedNode.active === false) {
            mapaiCom.interactable = false;
        } else {
            mapaiCom.interactable = true;
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"singleSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '194a8h4vXFO+bXX92yzqbfq', 'singleSelect');
// scripts\singleSelect.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        selectedIndex: 0
    },

    /*####*/
    onLoad: function onLoad() {
        var self = this;
        var rs = 0;
        var js = 0;
        var sf = 0;
        var bl = 0;
        if (cc.set) {
            js = cc.set.setting1;
            rs = cc.set.setting2;
            sf = cc.set.setting4;
            bl = cc.set.setting5;
        }
        for (var i = 0; i < this.nodes.length; i++) {
            var isSelected = this.selectedIndex == i;
            this.nodes[i].getComponent('select').setSelected(isSelected);
            var index = 0;
            var selectIndex = this.selectedIndex;
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (selectIndex == i) {
                this.nodes[selectIndex].getChildByName("title").color = new cc.Color(13, 210, 222);
            }
        }
        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;

            tComp.clickAction = function () {
                for (var i = 0; i < self.nodes.length; i++) {
                    var comp = self.nodes[i].getComponent('select');
                    comp.setSelected(false);
                }
                var Peers = this.node.parent.children; // 同辈节点
                var index = 0;
                for (var a = 0; a < Peers.length; a++) {
                    if (Peers[a].children.length > 0) {
                        // 如果同辈有子节点 处理子节点文字的颜色
                        var title = Peers[a].getChildByName("title");
                        title.color = new cc.Color(255, 255, 255);
                    }
                }
                this.node.getChildByName('title').color = new cc.Color(13, 210, 222);
                //this.node.children[index].color = new cc.Color(13,210,222);
                this.setSelected(true);
                self.selectedIndex = this.index;
                self.onSelectChange(this.index);
            };
        }
        if (this.node._name == "renshu" && cc.set) {
            console.log(rs);
            this.remember_set(rs);
        }
        if (this.node._name == "jushu" && cc.set) {
            this.remember_set(js);
        }
        if (this.node._name == "cards" && cc.set) {
            this.remember_set(sf);
        }
        if (this.node._name == "beiLv" && cc.set) {
            this.remember_set(bl);
        }
    },
    remember_set: function remember_set(num) {
        this.selectedIndex = num;
        for (var i = 0; i < this.nodes.length; i++) {
            var isSelected = num == i;
            this.nodes[i].getComponent('select').setSelected(isSelected);
            var index = 0;
            this.nodes[i].getChildByName('title').color = new cc.Color(255, 255, 255);
            if (num == i) {
                // if( this.nodes[num].children[0].name == "title" ){
                //     index = 0;
                // }else if(this.nodes[num].children[1].name == "title"){
                //     index =1;
                // }
                this.nodes[num].getChildByName('title').color = new cc.Color(13, 210, 222);
            }
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {}

});

cc._RFpop();
},{}],"slider":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1c921w7bEFKUIdNwItOX3oG', 'slider');
// scripts\slider.js

cc.Class({
    "extends": cc.Component,

    properties: {
        indicatorNode: cc.Node,
        backgroundNode: cc.Node,
        selectedNode: cc.Node,

        value: 0
    },

    // use this for initialization
    onLoad: function onLoad() {
        var self = this;
        this.indicatorNode.on(cc.Node.EventType.TOUCH_START, function (event) {});
        this.indicatorNode.on(cc.Node.EventType.TOUCH_MOVE, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });

        //this.maxWidth = this.node.width - 40;
        this.maxWidth = this.node.width - 28;
        this.setValue(this.value);
    },

    updateSlider: function updateSlider(pt) {
        var x = pt.x;
        if (x < 0) {
            x = 0;
        }

        if (x > this.maxWidth) {
            x = this.maxWidth;
        }
        this.setValue(x / this.maxWidth);
        this.onValueChange(this.value);
    },

    /*0 - 1*/
    setValue: function setValue(value) {
        this.value = value;
        if (this.value < 0) {
            this.value = 0;
        }
        if (this.value > 1) {
            this.value = 1;
        }
        //this.maxWidth = this.node.width - 38;
        this.maxWidth = this.node.width - 28;
        this.indicatorNode.x = this.value * this.maxWidth + 10;
        this.selectedNode.width = this.value * this.maxWidth + this.indicatorNode.width / 2;
    },

    onValueChange: function onValueChange(value) {
        cc.log(value);
    }
});

cc._RFpop();
},{}],"socket":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf75cLLNo1ETbJFrx/23i/H', 'socket');
// scripts\socket.js

var manager = require('manager');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var SocketConstant = {
  MaxReconnectCheckInterval: 5 };

/**
 * 这是对 WebSocket 的一个封装
 * 
 * 里面包含自动重连的功能
 */
// 重连检测时间片
var Socket = cc.Class({
  'extends': cc.Component,

  properties: {
    _lastReceiveMsgTime: 0, // 最后一次收到消息时间(毫秒)
    _timeout: 8 },

  // 超时时长 （秒）
  statics: {
    instance: null,
    // url:"ws://182.18.26.13:5041",
    //url:"ws://123.56.20.164:5041",//修改前
    url: "ws://127.0.0.1:5041"
  },

  // url:"ws://192.168.0.108:5041",
  //url:"ws://183.3.205.149:5002",
  // use this for initialization
  onLoad: function onLoad() {
    Socket.instance = this;

    this.name = "socket";

    cc.game.addPersistRootNode(this.node);
    if (cc.game.isPersistRootNode(this.node)) {
      cc.log('添加全局节点 Socket 成功');
    }

    this._registerAppActiveChange();

    this.isCreating = false;
    this.createIndex = 0;
    this.createSocket();

    this.schedule(function () {
      this.checkConnection();
    }, 5);

    this.recvTime = Date.now(); //接收到最新一条服务器的信息的时间
    //cc.log(manager.version);

    this._checkSocket();
  },

  checkConnection: function checkConnection() {
    //客户端定时给服务端发送点数据，防止连接由于长时间没有通讯而被某些节点的防火墙关闭导致连接断开的情况。
    this.sendMessage('checkAction', '');
  },

  createSocket: function createSocket() {
    var self = this;
    this.createIndex++; //创建次数加1
    if (this.createIndex > 5) {
      this.networkError();
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.isCreating = true;

    KQGlobalEvent.emit(Socket.Event.SocketConnecting);
    this.ws = new WebSocket(Socket.url);
    if (this.ws === null) {
      this.networkError();
      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { 'data': 'Socket 创建失败' });
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.socketError = false;

    // socket 连接成功
    this.ws.onopen = function (event) {
      //cc.log("WebSocket 连接成功：", event);

      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketConnectSuccessed, event);

      self.isCreating = false;
      self.socketError = false;
      self.createIndex = 0;
      self.connectionSuccess();
      self.sendReconnectInfo();
    };

    // socket 接收到消息
    this.ws.onmessage = function (event) {
      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketReceiveMessage, event.data);

      self.isCreating = false;
      self.socketError = false;
      self.receviceMessage(event.data);
      self._dispatchResponse(event.data);
      self.recvTime = Date.now(); //接收最新一条信息的时间

      /**/
    };

    /**
     * socket 发生错误
     * 
     * socket 本身有 `onerror` 回调，但事实证明，其不靠谱，
     * 有很大的机率有误报的行为，常常在没有错误时，会给错误回调。
     * 且不能定制超时时长
     * 
     * @param {String} message 
     */
    this.ws._kq_onerror = function (message) {
      cc.error('WebSocket 连接错误：' + message);

      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { data: message });
      self.ws.close();
      if (!self.ws) {
        return;
      }

      // 虽然调用了 websocket 的 close 方法，但是
      // 它并会立即调用 onclose 回调，而是在未来的某
      // 一时间再回调 onclose；但这里明显可以直接回调了。
      var ws = self.ws;

      self.ws.onclose();
      ws.onclose = function () {};
    };

    // socke 已关闭
    this.ws.onclose = function (event) {
      //cc.log('WebSocket 已关闭 close time=' + Date.now() + " event: " + event);

      self.isCreating = false;
      self.socketError = true;
      self.ws = null;
      self.connectionDisconnect();
      KQGlobalEvent.emit(Socket.Event.SocketDisconnect, event);
      //cc.log('socket close'+JSON.stringify(event));
    };
  },

  reconnect: function reconnect() {
    var self = this;
    this.scheduleOnce(function () {
      if (!self.isCreating && self.socketError) {
        self.createSocket();
      }
    }, 2);
  },

  sendReconnectInfo: function sendReconnectInfo() {
    var self = this;
    this.scheduleOnce(function () {
      if (this.userInfo != null) {
        var userId = self.userInfo.user_id || self.userInfo.id;
        self.sendMessage('reconnect', {
          'userId': userId
        });
      }
    }, 1);
  },

  receviceMessage: function receviceMessage(response) {},

  connectionDisconnect: function connectionDisconnect() {},

  connectionSuccess: function connectionSuccess() {},

  networkError: function networkError() {},

  checkNetworkStart: function checkNetworkStart() {},

  checkNetworkEnd: function checkNetworkEnd() {},

  _dispatchResponse: function _dispatchResponse(responseString) {
    //cc.log("WebSocket 接收到服务器消息：", responseString);
    var response = JSON.parse(responseString);
    var action = response["action"];
    if (action) {
      KQGlobalEvent.emit(action, response);
    }
  },

  // MARK: 前后台操作
  _registerAppActiveChange: function _registerAppActiveChange() {
    //cc.log("WebSocket 注册应用进入前、后台事件");
    cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
    cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
  },

  /**
   * 进入后台
   */
  _appEnterBackground: function _appEnterBackground() {
    var now = cc.sys.now();
    if (now - this._lastAppEnterBackgroundTime < 100) {
      return;
    }
    this._lastAppEnterBackgroundTime = now;

    //cc.log("WebSocket 检测到应用进入后台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppPause(id);
    this._cancelCheckSocket();
  },

  /**
   * 进入前台 
   */
  _appBecomActive: function _appBecomActive() {
    var now = cc.sys.now();
    if (now - this._lastAppBecomActiveTime < 100) {
      return;
    }
    this._lastAppBecomActiveTime = now;

    //cc.log("WebSocket 检测到应用进入前台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppActive(id);
    this._checkSocket();

    this.scheduleOnce((function () {
      this._checkSocketExecute();
    }).bind(this), 1.5);
  },

  //进入后台操作
  enterbackgroudAction: function enterbackgroudAction() {
    this._appEnterBackground();
  },

  //进入前台操作
  resumeAction: function resumeAction() {
    //检查网络
    this._checkNetwork();
    this._appBecomActive();
  },

  sendMessage: function sendMessage(action, data) {
    data = this._strongVerifyData(data);

    if (this.socketError) {
      cc.error("socket 连接错误：" + this.socketError);
      this.reconnect();
      return;
    }
    //cc.log('WebSocket 发送消息：' + action, data);
    if (cc.sys.isObjectValid(this.ws)) {
      if (this.ws.readyState === WebSocket.OPEN) {
        this.ws.send(this._convertParameterToString(action, data));
      }
    } else {
      this.connectionDisconnect();
    }
  },

  _strongVerifyData: function _strongVerifyData() {
    var data = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

    if (typeof data == 'string') {
      data = { "string": data };
    }

    if (data == null) {
      data = {};
    }

    if (!data["userId"]) {
      if (this.userInfo && typeof this.userInfo == 'object' && this.userInfo.id) {
        data["userId"] = this.userInfo.id;
      }
    }
    return data;
  },

  _convertParameterToString: function _convertParameterToString(action) {
    var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var obj = {};
    obj.action = action;
    obj.data = data;

    return JSON.stringify(obj);
  },

  // 检查网络
  _checkNetwork: function _checkNetwork() {
    if (this.checkNetworkNow) {
      this.checkNetworkNow();
    }

    this.shouldCheck = true;
    if (!this.socketError) {
      this.recvTime = 0;
      this.sendMessage('checkAction', '');
      this.scheduleOnce(function () {
        this.checkNetworkEnd();
        this.shouldCheck = false;
        if (this.recvTime === 0) {
          this.connectionDisconnect();
        }
      }, 2.5);
    } else {
      this.connectionDisconnect();
    }
  },

  // MARK: socket 掉线尽早确认
  _checkSocket: function _checkSocket() {
    this.schedule(this._checkSocketExecute, SocketConstant.MaxReconnectCheckInterval, cc.macro.REPEAT_FOREVER);
  },

  _cancelCheckSocket: function _cancelCheckSocket() {
    this.unschedule(this._checkSocketExecute);
  },

  _checkSocketExecute: function _checkSocketExecute() {
    if (this._isSocketTimeout() && this.ws) {
      this.ws._kq_onerror('连接超时');
      return;
    }
  },

  // socket 是否已超时
  _isSocketTimeout: function _isSocketTimeout() {
    return this._lastReceiveMessageInterval() >= this._timeout;
  },

  // 上一次收到消息到现在的时间间隔
  _lastReceiveMessageInterval: function _lastReceiveMessageInterval() {
    var now = cc.sys.now();
    var interval = (now - this._lastReceiveMsgTime) / 1000;
    //cc.log(`WebSocket 现在距上一条收到消息的时间间隔是：${interval} 秒`);
    return interval;
  }

});

// MARK: Socket 事件定义
Socket.Event = {
  SocketConnecting: "SocketConnecting", // Socket 正在连接
  SocketConnectSuccessed: "SocketConnectSuccessed", // 连接成功
  SocketDisconnect: "SocketDisconnect", // Socket 断开连接
  SocketConnectError: "SocketConnectError", // Socket 连接错误
  SocketReceiveMessage: "SocketReceiveMessage", // Socket 接收到消息

  LoginJoin: "loginJoin", // 客户端发送 从登陆界面获取房间号进入游戏
  RecordId: "recordId", // 客户端发送 
  OnceAgain: "onceAgain", // 客户端发送 
  BeiLv: "beiLv", // 客户端发送 
  InviteCode: "inviteCode", // 客户端发送   邀请码
  JoinDesk: "joinDesk", // 客户端发送
  CreateDesk: "createDesk", // 客户端发送
  LeaveDesk: "leaveDesk", // 离开桌子
  DissolveDesk: "dissolveDesk", // 解散桌子
  AnswerDissolve: "answerDissolve", // 回答请求退出命令
  GetDeskInfo: "getDeskInfo", // 客户端发送
  SendImage: "sendImage", // 客户端发送
  SendText: "sendText", // 客户端发送
  SendEmoji: "sendEmoji", // 客户端发送
  ChangeInfo: "changeInfo", // 客户端发送
  SendAudioMessage: "sendAudioMessage", // 客户端发送  发送语音消息
  GetRecord: "getRecord", // 获取战绩信息
  GetItemRecord: "getItemRecord", // 获取战绩信息
  PlayCard: "playCard", // 客户端发送，用户打出牌
  TimeoutDissolve: "timeoutDissolve", // 请求退出超时时，需要发出的消息
  Feedback: "feedback", // 客户端发送  反馈信息
  SharePng: "sharePng", // 客户端发送  分享领取砖石
  EnterRandom: "interRandom", // 客户端发送  进入随机场
  CancelRandom: "cancelRandom", // 客户端发送  取消进入随机场
  ForceExitRandom: "dissolve", // 客户端发送 强制退出随机场
  Ready: "ready", // 客户端发送 准备
  StartGame: "startGame", // 客户端发送 开始游戏
  GetHallInfo: "getHallInfo", // 客户端发送 获取大厅信息
  GetUserInfo: "getUserInfo", // 客户端发送 获取用户信息
  CheckAction: "checkAction", // 客户端发送，用来检测与服务器的连通性
  Pause: "pause", // 客户端进入后台时要发送的消息
  Active: "active", // 客户端回到前台时要发送的消息
  Qingli: "qingli", // 客户端回到前台时要发送的消息

  ReceiveRequestDissolve: "requestDissolve", // 请求解散桌子 服务器发送
  ReceiveRequestDissolveResult: "requestDissolveResult", // 请求解散桌子结果
  ReceiveChatText: "sendText", // 服务器发送
  ReceiveChatEmoji: "sendEmoji", // 服务器发送
  ReceiveDeskInfo: "deskInfo", // 服务器发送
  ReceiveGameOver: "gameOver", // 服务器发送
  ReceiveFaPai: "fapai", // 服务器发送
  ReceiveSharePng: "sharePngs", // 服务器发送
  ReceiveOnlineStatus: "sendOnlineStatus", // 服务器发送
  ReceiveOnChangeInfo: "changeInfo", // 服务器发送
  ReceiveAudioMessage: "sendAudioMessage", // 服务器发送，接收到用户发送了语音消息
  ReceivePlayCard: "playCard", // 服务器发送，有用户已经准备好牌
  ReceiveCreateDesk: "createDesk", // 服务器发送，创建房间的回调
  ReceiveReady: "ready", // 服务器发送，有用户点击了准备
  ReceiveHallInfo: "getHallInfo", // 服务器发送
  ReceiveGetUserInfo: "getUserInfo", // 服务器发送 获取用户信息
  ReceiveCheckAction: "checkAction", // 服务器发送  用来确认 Socket 还在连着
  ReceiveForceExit: "forceExit", // 服务器发送  用来使客户端强退
  ReceiveDissolveDesk: "dissolveDesk", // 服务器发送   当房主退出时，解散桌子
  ReceiveInterRandom: "interRandom", // 服务器发送   进入随机场的反馈
  ReceivePause: "pause", // 服务器发送   当有用户设备进入后台时，会收到这条消息
  ReceiveInviteCode: 'inviteCode', // 服务器发送，收到邀请码的消息
  ReceiveLeaveDesk: 'leaveDesk', // 服务器发送，收到需要离开桌子的消息
  ReceiveSelectBeiLv: 'selectBeiLv', // 服务器发送，收到选择倍率的消息
  ReceiveBeiLv: 'beiLv', // 服务器发送，收到倍率的消息
  ReceiveQingLi: 'qingli', // 服务器发送，收到请离
  ReceiveRecordId: 'recordId', // 服务器发送，收到战绩信息
  ReceiveLoginJoin: 'loginJoin', // 服务器发送，收到从页面进入房间信息
  ReceiveOnceAgain: 'onceAgain', // 服务器发送，收到再来一局信息
  ReceiveNoUionid: 'noUionid' };

// MARK: Socket 提供的可发给服务器消息的方法

// 服务器发送，收到没有unionID信号
Socket.sendCheckAction = function () {
  this.instance.sendMessage(this.Event.CheckAction, null);
};
/**/
Socket.sendDidReceiveGameOverAction = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(Socket.Event.DidReceiveGameOverAction, param);
};
/**/

/**
 * 当 APP 进入后台时要发送的消息
 */
Socket.sendAppPause = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Pause, param);
};

/**
 * 当 APP 进入前台时发送的消息
 */
Socket.sendAppActive = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Active, param);
};

// 开房
Socket.sendCreateDesk = function (createDescInfo, userId) {
  cc.assert(createDescInfo);
  cc.assert(userId);

  createDescInfo["userId"] = userId;
  this.instance.sendMessage(this.Event.CreateDesk, createDescInfo);
};

Socket.sendQingli = function (leaveId, userId) {
  var param = {
    "leaveId": leaveId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.Qingli, param);
};
// 从登陆页面加入房间
Socket.sendLoginJoin = function (roomId, userId) {
  var param = {
    "roomId": roomId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.LoginJoin, param);
};
// 再来一局
Socket.sendOnceAgain = function (again, userId) {
  var param = {
    "userId": userId,
    "again": again
  };
  this.instance.sendMessage(this.Event.OnceAgain, param);
};
// 加入房间
Socket.sendJoinDesk = function (roomId, userId) {
  cc.assert(roomId);
  cc.assert(userId);

  var param = {
    "roomId": roomId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.JoinDesk, param);
};
// 向服务端发送我选择的倍率
Socket.sendBeiLv = function (beilv, userId) {
  var param = {
    "beilv": beilv,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.BeiLv, param);
};
// 发送邀请码
Socket.sendInviteCode = function (inviteCode, userId) {
  var param = {
    "inviteCode": inviteCode,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.InviteCode, param);
};

// 获取房间信息
Socket.sendGetDesckInfo = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetDeskInfo, param);
};

Socket.sendText = function (userId, text) {
  //cc.assert(userId);
  //cc.assert(text);
  var param = {
    "msg": text,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendText, param);
};
Socket.sendEmoji = function (userId, emoji) {
  var param = {
    "emoji": emoji,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendEmoji, param);
};
Socket.sendChangeInfo = function (userId, Info) {
  var param = {
    "changeInfo": Info,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.ChangeInfo, param);
};
Socket.sendAudioMessage = function (userId) {
  var url = arguments.length <= 1 || arguments[1] === undefined ? "" : arguments[1];

  cc.assert(userId);
  cc.assert(url.length > 0);

  if (url.length == 0) {
    return;
  }

  var param = {
    "url": url,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendAudioMessage, param);
};

Socket.sendImage = function (userId, image) {
  cc.assert(userId);
  cc.assert(image);
  var param = {
    "msg": image,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendImage, param);
};

Socket.sendGetRecrod = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.GetRecord, param);
};

Socket.sendGetRecrodFromId = function (recordId) {
  var param = {
    "recordId": recordId
  };
  this.instance.sendMessage(this.Event.RecordId, param);
};

Socket.sendDissolveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.DissolveDesk, param);
};

Socket.sendGetItemRecord = function (userId, parentId) {
  cc.assert(userId);
  cc.assert(parentId);
  var param = {
    "userId": userId,
    "parentId": parentId
  };

  this.instance.sendMessage(this.Event.GetItemRecord, param);
};

Socket.sendLeaveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.LeaveDesk, param);
},

/**
 * 回答退房请求
 * 
 * @param  {Number} userId 当前用户 id
 * @param  {NUmber} answer=1 回答。1 表示同意； 0 表示拒绝； -1 表示未选择
 */
Socket.sendAnswerDissolve = function (userId) {
  var answer = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];

  cc.assert(userId);
  var param = {
    "userId": userId,
    "answer": answer
  };

  this.instance.sendMessage(this.Event.AnswerDissolve, param);
}, Socket.sendForceExitRoom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.DissolveDesk, param);
},

// 十三张中
// cardInfo 类似于：
// [{
//         'cards':[{'suit':suit,'number':number},{}],//特殊牌不用传
//         'type':0,
//         'value':4,
//         'isContainExtra':true,// 特殊牌是否包含特殊牌
//     },
//     {
//         'cards':[{'suit':suit,'number':number},{}],
//         'type':0,
//         'value':4
//     }]
Socket.sendPlayCard = function (userId, cardInfo) {
  cc.assert(userId);
  var param = {
    "userId": userId,
    "card": cardInfo
  };

  this.instance.sendMessage(this.Event.PlayCard, param);
};

Socket.sendTimeoutDissolve = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.TimeoutDissolve, param);
};

Socket.sendFeedback = function (userId, text) {
  cc.assert(userId);
  cc.assert(text);
  var param = {
    "userId": userId,
    "text": text
  };

  this.instance.sendMessage(this.Event.Feedback, param);
};

Socket.sendSharePng = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SharePng, param);
};
// 开始匹配随机场
Socket.sendEnterRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.EnterRandom, param);
};

// 取消匹配随机场
Socket.sendCancelRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.CancelRandom, param);
};

// 准备
Socket.sendReady = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.Ready, param);
}, Socket.sendStartGame = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  cc.log(this.Event.StartGame);
  cc.log();
  this.instance.sendMessage(this.Event.StartGame, param);
},

// 获取大厅信息
Socket.sendGetHallInfo = function (userId) {
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetHallInfo, param);
},

// 获取用户信息
Socket.sendGetUserInfo = function (userId, openId) {
  var param = {
    "userId": userId,
    "openId": openId
  };

  this.instance.sendMessage(this.Event.GetUserInfo, param);
}, module.exports = Socket;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"test":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3a5ah1deZEh6HfPdghRXyA', 'test');
// scripts\KQCard\test.js

this._changeCardScors = function (cardModel) {

    cardModel.forEach(function (card) {
        card.scores = card.number;
    });

    cardModel = this._convertOneToA(cardModel);

    var is14 = true; //是A K Q J 10 ;

    var is1 = true; //是1 2 3 4 5

    cardModel.forEach(function (card) {
        if (card.scores < 10) is14 = false;
    }); //不是A K Q J 10

    cardModel.forEach(function (card) {
        if ((card.scores > 5 || card.scores == 14) && card.scores != 20) is1 = false;
    }); //不是1 2 3 4 5});

    if (is14) {
        //是A K Q J 10 ;

        cardModel.sort(function (a1, a2) {
            return a2.scores - a1.scores;
        });

        var num = 14,
            scoresAyy = []; //一副牌的分数

        for (var i = 0; i < 5; i++) {

            scoresAyy.push(num);

            num -= 1;
        }

        for (var j = 0; j < scoresAyy.length; j++) {

            for (var i = 0; i < cardModel.length; i++) {

                var cardScores = cardModel[i].scores;

                if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
            }
        }

        cardModel.forEach(function (card) {
            if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
        }); //找出选中的牌
    } else if (is1) {
            //是1 2 3 4 5

            cardModel.sort(function (a1, a2) {
                return a2.scores - a1.scores;
            });

            var num = 5,
                scoresAyy = []; //一副牌的分数

            for (var i = 0; i < 5; i++) {

                scoresAyy.push(num);

                num -= 1;
            }

            for (var j = 0; j < scoresAyy.length; j++) {

                for (var i = 0; i < cardModel.length; i++) {

                    var cardScores = cardModel[i].scores;

                    if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
                }
            }

            cardModel.forEach(function (card) {
                if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
            }); //找出选中的牌
        } else {
                cardModel.sort(function (a1, a2) {
                    return a1.scores - a2.scores;
                });

                var scoresAyy = []; //用来装鬼牌分数

                for (var i = 0; i < 5; i++) {

                    var s = parseInt(cardModel[0].scores) + i; //最小的牌的分数

                    scoresAyy.push(s); //一副牌的分数
                }

                for (var j = 0; j < scoresAyy.length; j++) {

                    for (var i = 0; i < cardModel.length; i++) {

                        var cardScores = cardModel[i].scores;

                        if (cardScores == scoresAyy[j] && cardScores < 15) scoresAyy.splice(j, 1); //删除不是鬼牌的分
                    }
                }
                cardModel.forEach(function (card) {
                    if (card.scores >= 20) card.scores = scoresAyy.splice(0, 1)[0];
                }); //改变牌的分数
            }

    cardModel = this._convertOneToA(cardModel);

    cardModel.sort(function (a1, a2) {
        return a1.scores - a2.scores;
    });
    return cardModel;
};

cc._RFpop();
},{}],"time":[function(require,module,exports){
"use strict";
cc._RFpush(module, '458d4VWlwNDT6xQ+pFW8Bby', 'time');
// scripts\time.js

cc.Class({
        "extends": cc.Component,

        properties: {
                leftNode: cc.Node,
                RigthNode: cc.Node,
                _time: null
        },

        // use this for initialization
        onLoad: function onLoad() {},

        setTime: function setTime(time) {

                this.unscheduleAllCallbacks();

                this._time = time;

                this.leftNode.rotation = 0;

                this.RigthNode.rotation = 0;

                this.RigthNode.stopAllActions();

                this.leftNode.stopAllActions();

                this.leftNode.runAction(cc.rotateBy(this._time, -180));

                this.scheduleOnce((function () {

                        this.RigthNode.runAction(cc.rotateBy(this._time, 180));
                }).bind(this), this._time);
        }

});

cc._RFpop();
},{}],"userInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e8d10xRGnJAn42wJsuC6aBi', 'userInfo');
// scripts\userInfo.js

var AudioManager = require('AudioManager');
var Playback = require('Playback');

cc.Class({
  'extends': cc.Component,

  properties: {
    spriteAvatar: cc.Sprite,
    labelNickname: cc.Label,
    labelScore: cc.Label,
    spriteOffline: cc.Sprite,
    voiceNode: cc.Node,
    homeRunNode: cc.Node,
    readyNode: cc.Node,
    beilv: cc.Label,
    shootNodes: [cc.Node],
    bankerNode: cc.Node,
    fangZhuNode: cc.Node,
    qingli: cc.Node,
    id: cc.Label
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.updateScore();
  },

  setqingli: function setqingli() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.qingli.active = visible != false;
  },

  setReadyNodeVisible: function setReadyNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.readyNode.active = visible != false;
  },
  setBeilvLabel: function setBeilvLabel(bl) {
    //this.beilv.active = true;
    this.beilv.string = bl ? bl + "倍" : '';
  },

  setFangZhuNodeVisible: function setFangZhuNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.fangZhuNode.active = visible != false;
  },

  updateScore: function updateScore() {
    var score = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    if (score >= 0) {
      this.labelScore.string = "+" + score;
    } else {
      this.labelScore.string = "" + score;
    }
  },
  updateUserId: function updateUserId(id) {
    this.id.string = id ? "ID:" + id : "";
  },
  updateNickname: function updateNickname() {
    var nickname = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

    this.labelNickname.string = nickname;
  },

  updateAvatar: function updateAvatar(avatar) {
    if (avatar.endsWith("png") || avatar.endsWith("jpg") || avatar.endsWith("gif")) {} else {
      //avatar = avatar + ".png";
    }

    cc.loader.load({ url: avatar, type: "jpg" }, (function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      this.spriteAvatar.spriteFrame = frame;
    }).bind(this));
  },

  setOfflineVisible: function setOfflineVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    if (Playback.instance.isPlaybacking()) {
      // 如果是处理回放状态，就不用再处理离线消息了
      return;
    }

    this.spriteOffline.node.active = visible;
  },

  setIsBanker: function setIsBanker() {
    var isBanker = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.bankerNode.active = isBanker;
  },

  playShootAnimation: function playShootAnimation() {
    var toIndex = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    //let shootNode = this.shootNodes[toIndex];
    //shootNode.active = true;
    //let anim = shootNode.getComponent(cc.Animation);
    //anim.play('shoot').on('finished', function () {
    //  shootNode.active = false;
    //}, this);

    AudioManager.instance.playDaQiang();
  },

  playBulletHoleAnimation: function playBulletHoleAnimation() {
    var bulletHoleNode = this.node.getChildByName('bulletHole');
    bulletHoleNode.active = true;
    var anim = bulletHoleNode.getComponent(cc.Animation);
    anim.play('bulletHole').on('finished', function () {
      bulletHoleNode.active = false;
    }, this);
  },

  playSpeakAnimation: function playSpeakAnimation() {
    this.voiceNode.active = true;
    this.scheduleOnce((function () {
      this.voiceNode.active = false;
    }).bind(this), 4);
  },

  // 播放全垒打动画
  playHomeRunAimation: function playHomeRunAimation() {
    //let alert = this.homeRunNode.getComponent('alert');
    //alert.alert();
    //this.scheduleOnce(function () {
    //  this.homeRunNode.active = false;
    //}.bind(this), 2);
  }
});

cc._RFpop();
},{"AudioManager":"AudioManager","Playback":"Playback"}],"zhuanNumCtrl":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1b0dfWuicJLYJDmjjT1lmQc', 'zhuanNumCtrl');
// scripts\zhuanNumCtrl.js

cc.Class({
    "extends": cc.Component,

    properties: {
        zhuanNumLabel: cc.Label,
        jushu: cc.Node,
        AA: cc.Node,
        _selectedPeopleIndex: null,
        _selectedJushuIndex: null,
        _selectedAAIndex: null
    },

    onLoad: function onLoad() {
        this._ctrl();
    },

    clickPeopleAction: function clickPeopleAction() {
        this._ctrl();
    },

    clickAAAction: function clickAAAction() {
        this._ctrl();
    },

    clickJushuAction: function clickJushuAction() {
        this._ctrl();
    },

    _ctrl: function _ctrl() {
        this._selectedPeopleIndex = this.node.getComponent("singleSelect").selectedIndex;
        this._selectedJushuIndex = this.jushu.getComponent("singleSelect").selectedIndex;
        this._selectedAAIndex = this.AA.getComponent("checkSelect").selectedIndex;
        //人数选2人时且没选上AA制收费
        var renShu = 2;
        if (this._selectedPeopleIndex == 0) {
            renShu = 2;
        } else if (this._selectedPeopleIndex == 1) {
            renShu = 3;
        } else if (this._selectedPeopleIndex == 2) {
            renShu = 4;
        } else if (this._selectedPeopleIndex == 3) {
            renShu = 5;
        }
        var zhuangShi = 20;
        if (this._selectedJushuIndex == 0) {
            zhuangShi = 20;
        } else if (this._selectedJushuIndex == 1) {
            zhuangShi = 40;
        } else if (this._selectedJushuIndex == 2) {
            zhuangShi = 80;
        } else if (this._selectedJushuIndex == 3) {
            zhuangShi = 10;
        }
        //AA
        if (this._selectedAAIndex != null) {
            zhuangShi = Math.ceil(zhuangShi / renShu);
        }
        this.zhuanNumLabel.string = zhuangShi;
        //if(this._selectedPeopleIndex == 0){
        //    if(this._selectedAAIndex == null){
        //局数选10局时
        //if(this._selectedJushuIndex == 0){
        //    this.zhuanNumLabel.string = "10";
        //}
        ////局数选20局时
        //if(this._selectedJushuIndex == 1){
        //    this.zhuanNumLabel.string = "30";
        //}
        ////局数选30局时
        //if(this._selectedJushuIndex == 2){
        //    this.zhuanNumLabel.string = "80";
        //}
        //}
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "8";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "15";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "23";
        //        }
        //    }
        //
        //}
        //人数选3人
        //else if(this._selectedPeopleIndex == 1){
        //    //没选上AA制收费
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "42";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "60";
        //        }
        //    }
        //    //选了AA收费
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "20";
        //        }
        //    }
        //
        //}
        ////人数选4人且没选上AA制收费
        //else{
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "28";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "56";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "84";
        //        }
        //    }
        //    //AA制收费选上了
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //    }
        //}
    }
});

cc._RFpop();
},{}]},{},["AudioManager","CardPrefab","CardTypeCombine","CardTypeSprite","ChatMessage","MsgControl","KQGlobalEvent","ArrayExtension","NumberExtension","SpriteHelper","StringExtension","fecha","Invit","GetCardPointsSameCount","KQCard","KQCardColorsHelper","KQCardFindTypeExtension","KQCardPointsHelper","KQCardResHelper","KQCardScoreExtension","KQCardScoretsHelper","KQCardSelectExtension","test","UserModelHelper","NetworkError","ChatTextRecord","CompareCards","Countdown","GameResult","Player","ResultItem","TotalGameResult","TotalGameResultItem","UserSampleInfo","maPai","Playback","Setting","KQGlabolSocketEventHander","KQNativeInvoke","agreement","alert","animation","cardNum","cards","cardsBack","cellText","changInfo","change_mapai","checkSelect","choujiang","create_btn_anima","game","hall","hall_btn_anima","help","inviteCode","joinRoom","launch","login","manager","overTime","play","product","randRoom","record","recordInfo","rule","scale","select","selectMoShi","select_ma","select_mapai","selectbeilv","singleSelect","slider","socket","time","userInfo","zhuanNumCtrl"])

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6L0NvY29zQ3JlYXRvci9yZXNvdXJjZXMvYXBwLmFzYXIvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvQXJyYXlFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9BdWRpby9BdWRpb01hbmFnZXIuanMiLCJDOi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9iYXNlNjQtanMvaW5kZXguanMiLCJDOi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9idWZmZXIvaW5kZXguanMiLCJDOi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9pZWVlNzU0L2luZGV4LmpzIiwiQzovQ29jb3NDcmVhdG9yL3Jlc291cmNlcy9hcHAuYXNhci9ub2RlX21vZHVsZXMvaXNhcnJheS9pbmRleC5qcyIsImFzc2V0cy9zY3JpcHRzL0NhcmRQcmVmYWIuanMiLCJhc3NldHMvc2NyaXB0cy9DYXJkVHlwZUNvbWJpbmUuanMiLCJhc3NldHMvc2NyaXB0cy9DYXJkVHlwZVNwcml0ZS5qcyIsImFzc2V0cy9zY3JpcHRzL0NoYXQvQ2hhdE1lc3NhZ2UuanMiLCJhc3NldHMvc2NyaXB0cy9QZWZhYnMvQ2hhdFRleHRSZWNvcmQuanMiLCJhc3NldHMvc2NyaXB0cy9QZWZhYnMvQ29tcGFyZUNhcmRzLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGVmYWJzL0NvdW50ZG93bi5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvR2FtZVJlc3VsdC5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9HZXRDYXJkUG9pbnRzU2FtZUNvdW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvSW52aXQuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkQ29sb3JzSGVscGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZFBvaW50c0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRSZXNIZWxwZXIuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2NvcmVFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2NvcmV0c0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRTZWxlY3RFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkLmpzIiwiYXNzZXRzL3NjcmlwdHMvU29ja2V0L0tRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIuanMiLCJhc3NldHMvc2NyaXB0cy9FdmVudC9LUUdsb2JhbEV2ZW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvVXRpbHMvS1FOYXRpdmVJbnZva2UuanMiLCJhc3NldHMvc2NyaXB0cy9DaGF0L01zZ0NvbnRyb2wuanMiLCJhc3NldHMvc2NyaXB0cy9OZXR3b3JrRXJyb3IuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL051bWJlckV4dGVuc2lvbi5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXliYWNrL1BsYXliYWNrLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9QbGF5ZXIuanMiLCJhc3NldHMvc2NyaXB0cy9QbGF5L1Jlc3VsdEl0ZW0uanMiLCJhc3NldHMvc2NyaXB0cy9TZXR0aW5nL1NldHRpbmcuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL1Nwcml0ZUhlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvU3RyaW5nRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9Ub3RhbEdhbWVSZXN1bHRJdGVtLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9Ub3RhbEdhbWVSZXN1bHQuanMiLCJhc3NldHMvc2NyaXB0cy9Nb2RlbFV0aWxzL1VzZXJNb2RlbEhlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvVXNlclNhbXBsZUluZm8uanMiLCJhc3NldHMvc2NyaXB0cy9hZ3JlZW1lbnQuanMiLCJhc3NldHMvc2NyaXB0cy9hbGVydC5qcyIsImFzc2V0cy9zY3JpcHRzL2FuaW1hdGlvbi5qcyIsImFzc2V0cy9zY3JpcHRzL2NhcmROdW0uanMiLCJhc3NldHMvc2NyaXB0cy9jYXJkc0JhY2suanMiLCJhc3NldHMvc2NyaXB0cy9jYXJkcy5qcyIsImFzc2V0cy9zY3JpcHRzL2NlbGxUZXh0LmpzIiwiYXNzZXRzL3NjcmlwdHMvY2hhbmdJbmZvLmpzIiwiYXNzZXRzL3NjcmlwdHMvY2hhbmdlX21hcGFpLmpzIiwiYXNzZXRzL3NjcmlwdHMvY2hlY2tTZWxlY3QuanMiLCJhc3NldHMvc2NyaXB0cy9jaG91amlhbmcuanMiLCJhc3NldHMvc2NyaXB0cy9jcmVhdGVfYnRuX2FuaW1hLmpzIiwiYXNzZXRzL3NjcmlwdHMvRXh0ZW5zaW9ucy9mZWNoYS5qcyIsImFzc2V0cy9zY3JpcHRzL2dhbWUuanMiLCJhc3NldHMvc2NyaXB0cy9oYWxsX2J0bl9hbmltYS5qcyIsImFzc2V0cy9zY3JpcHRzL2hhbGwuanMiLCJhc3NldHMvc2NyaXB0cy9oZWxwLmpzIiwiYXNzZXRzL3NjcmlwdHMvaW52aXRlQ29kZS5qcyIsImFzc2V0cy9zY3JpcHRzL2pvaW5Sb29tLmpzIiwiYXNzZXRzL3NjcmlwdHMvbGF1bmNoLmpzIiwiYXNzZXRzL3NjcmlwdHMvbG9naW4uanMiLCJhc3NldHMvc2NyaXB0cy9QbGF5L21hUGFpLmpzIiwiYXNzZXRzL3NjcmlwdHMvbWFuYWdlci5qcyIsImFzc2V0cy9zY3JpcHRzL292ZXJUaW1lLmpzIiwiYXNzZXRzL3NjcmlwdHMvcGxheS5qcyIsImFzc2V0cy9zY3JpcHRzL3Byb2R1Y3QuanMiLCJhc3NldHMvc2NyaXB0cy9yYW5kUm9vbS5qcyIsImFzc2V0cy9zY3JpcHRzL3JlY29yZEluZm8uanMiLCJhc3NldHMvc2NyaXB0cy9yZWNvcmQuanMiLCJhc3NldHMvc2NyaXB0cy9ydWxlLmpzIiwiYXNzZXRzL3NjcmlwdHMvc2NhbGUuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3RNb1NoaS5qcyIsImFzc2V0cy9zY3JpcHRzL3NlbGVjdF9tYXBhaS5qcyIsImFzc2V0cy9zY3JpcHRzL3NlbGVjdF9tYS5qcyIsImFzc2V0cy9zY3JpcHRzL3NlbGVjdGJlaWx2LmpzIiwiYXNzZXRzL3NjcmlwdHMvc2VsZWN0LmpzIiwiYXNzZXRzL3NjcmlwdHMvc2luZ2xlU2VsZWN0LmpzIiwiYXNzZXRzL3NjcmlwdHMvc2xpZGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvc29ja2V0LmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL3Rlc3QuanMiLCJhc3NldHMvc2NyaXB0cy90aW1lLmpzIiwiYXNzZXRzL3NjcmlwdHMvdXNlckluZm8uanMiLCJhc3NldHMvc2NyaXB0cy96aHVhbk51bUN0cmwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUVBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQUo7QUFFSTtBQUNFO0FBQ0E7QUFDRTtBQUFSO0FBQ0E7QUFFSTtBQUFKO0FBQ0E7QUFDQTtBQUVBO0FBQ0U7QUFDRTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFBUjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0U7QUFDRTtBQUNBO0FBREo7QUFDQTtBQUdNO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFETjtBQUNBO0FBR007QUFETjtBQUNBO0FBR007QUFDRTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHTTtBQUROO0FBQ0E7QUFHTTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBR1E7QUFDRTtBQURWO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFHTTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNFO0FBQ0U7QUFDQTtBQURKO0FBQ0E7QUFDTTtBQUNFO0FBQ1I7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNOO0FBQ007QUFDRTtBQUNSO0FBQ1E7QUFDRTtBQUNBO0FBQ0U7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNVO0FBQ0U7QUFDWjtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFDQTtBQUNFO0FBQVI7QUFFTTtBQUNFO0FBQVI7QUFFTTtBQUFOO0FBRUk7QUFDQTtBQUNFO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRU07QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUVNO0FBQ0E7QUFDQTtBQUFOO0FBQ0E7QUFFUTtBQUNFO0FBQVY7QUFDQTtBQUNBO0FBRVE7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFTTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRU07QUFBTjtBQUVNO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFBVjtBQUVVO0FBQVY7QUFFUTtBQUFSO0FBQ0E7QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0U7QUFBRjtBQUNBO0FBQUk7QUFDRTtBQUVOO0FBQ0E7QUFBSTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFFVjtBQUNBO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUVWO0FBQVU7QUFFVjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDSjtBQUNBO0FBRE07QUFHTjtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0U7QUFHRjtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBQ0E7QUFIQTtBQUNFO0FBQ0U7QUFDQTtBQUtKO0FBQ0E7QUFMTTtBQU9OO0FBQ0E7QUFOUTtBQUNBO0FBQ0U7QUFRVjtBQU5RO0FBQ0E7QUFDRTtBQVFWO0FBTlU7QUFDQTtBQVFWO0FBQ0E7QUFDQTtBQXBCTTtBQXNCTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWk07QUFjTjtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQWNSO0FBQ0E7QUFaTTtBQUNFO0FBY1I7QUFDQTtBQVpNO0FBQ0E7QUFDQTtBQWNOO0FBWk07QUFjTjtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQWNSO0FBQ0E7QUFaTTtBQUNFO0FBQ0E7QUFjUjtBQUNBO0FBWk07QUFjTjtBQVpNO0FBY047QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFjUjtBQUNBO0FBWk07QUFDQTtBQUNFO0FBQ0U7QUFjVjtBQUNBO0FBQ0E7QUFaTTtBQWNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVpBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0k7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFDSTtBQUFoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQVE7QUFDQTtBQUVSO0FBQVE7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUZRO0FBQ0E7QUFJUjtBQUZRO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBRkk7QUFJSjtBQUNBO0FBSlE7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQ0E7QUFNUjtBQUNBO0FBQ0E7QUFKUTtBQUNBO0FBQ0k7QUFDSTtBQU1oQjtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFQUTtBQVNSO0FBUFk7QUFDQTtBQUNBO0FBQ0E7QUFTWjtBQUNBO0FBUFE7QUFDQTtBQUNBO0FBU1I7QUFDQTtBQUNBO0FBUEk7QUFTSjtBQUNBO0FBVFE7QUFDQTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFDSTtBQVdaO0FBQ0E7QUFDQTtBQVRJO0FBQ0k7QUFXUjtBQUNBO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFDSTtBQVdaO0FBVFE7QUFDQTtBQUNBO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQVdSO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFEWjtBQUNBO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBQ0k7QUFEWjtBQUdRO0FBRFI7QUFHUTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBR1E7QUFEUjtBQUdRO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUN0U0EsQUR1U0E7QUN0U0EsQUR1U0E7QUN0U0EsQUR1U0E7QUN0U0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ2xIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDN3ZEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUNMQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDTTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURNO0FBR047QUFDQTtBQURJO0FBQ0U7QUFHTjtBQUNBO0FBREk7QUFDRTtBQUNBO0FBQ0U7QUFHUjtBQUNBO0FBRE07QUFHTjtBQUNBO0FBREk7QUFDRTtBQUdOO0FBRE07QUFDRTtBQUNFO0FBQ0E7QUFHVjtBQUNBO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9FQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFEQTtBQUNJO0FBQ0E7QUFDSTtBQUdSO0FBREk7QUFDSTtBQUdSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUFRO0FBRVI7QUFBUTtBQUNBO0FBRVI7QUFDQTtBQUFRO0FBRVI7QUFBUTtBQUNBO0FBQ0E7QUFDQTtBQUVSO0FBQVE7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFUjtBQUFRO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBRVI7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBUTtBQUVSO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFFUjtBQURZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQUNBO0FBRFk7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFHSjtBQUNBO0FBQ0E7QUFKUTtBQU1SO0FBSlE7QUFDQTtBQU1SO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQU1SO0FBSlE7QUFDSTtBQU1aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKUTtBQUNBO0FBQ0E7QUFDQTtBQU1SO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQU1aO0FBQ0E7QUFKUTtBQU1SO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFNUjtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQU1aO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBQThEO0FBT3RFO0FBUDBHO0FBUzFHO0FBQ0E7QUFSUTtBQUNBO0FBQ0E7QUFDQTtBQVVSO0FBQ0E7QUFDQTtBQVJJO0FBVUo7QUFSUTtBQVVSO0FBUlE7QUFVUjtBQVJRO0FBQXFDO0FBVzdDO0FBQ0E7QUFWUTtBQUNBO0FBQ0E7QUFDSTtBQVlaO0FBQ0E7QUFDQTtBQVZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBWWhCO0FBVlk7QUFZWjtBQVZRO0FBWVI7QUFWUTtBQUNJO0FBWVo7QUFDQTtBQUNBO0FBVkk7QUFDSTtBQVlSO0FBQ0E7QUFWSTtBQUNJO0FBWVI7QUFDQTtBQVZJO0FBQ0k7QUFZUjtBQUNBO0FBQ0E7QUFWSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZUjtBQVhZO0FBQ0E7QUFDQTtBQWFaO0FBWmdCO0FBQ0k7QUFjcEI7QUFab0I7QUFjcEI7QUFDQTtBQVpnQjtBQWNoQjtBQUNBO0FBQ0E7QUFiWTtBQUNBO0FBZVo7QUFiUTtBQUNBO0FBQ0E7QUFDQTtBQWVSO0FBQ0E7QUFiSTtBQUNJO0FBQ0E7QUFlUjtBQUNBO0FBYkk7QUFDSTtBQWVSO0FBYlE7QUFDQTtBQWVSO0FBYlE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQWVaO0FBQ0E7QUFDQTtBQUNBO0FBYkk7QUFlSjtBQUNBO0FBQ0E7QUFiUTtBQUNBO0FBQ0k7QUFDQTtBQWVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJRO0FBQ0k7QUFDQTtBQUNBO0FBbUJaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJRO0FBbUJSO0FBQ0E7QUFqQkk7QUFDSTtBQUNJO0FBbUJaO0FBakJRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFtQlo7QUFqQlE7QUFtQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJRO0FBQ0k7QUFtQlo7QUFDQTtBQWpCUTtBQW1CUjtBQUNBO0FBakJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW1CUjtBQWpCUTtBQW1CUjtBQUNBO0FBQ0E7QUFqQkk7QUFDSTtBQW1CUjtBQWpCUTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFtQmhCO0FBakJZO0FBbUJaO0FBakJRO0FBQ0E7QUFDQTtBQUNBO0FBbUJSO0FBakJRO0FBbUJSO0FBakJZO0FBbUJaO0FBQ0E7QUFqQlE7QUFtQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQkk7QUFDSTtBQUNJO0FBbUJaO0FBakJZO0FBbUJaO0FBakJZO0FBbUJaO0FBakJRO0FBbUJSO0FBQ0E7QUFDQTtBQWpCSTtBQW1CSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJJO0FBbUJKO0FBakJRO0FBbUJSO0FBakJRO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFtQmhCO0FBakJvQjtBQW1CcEI7QUFDQTtBQUNBO0FBakJRO0FBbUJSO0FBQ0E7QUFqQkk7QUFDSTtBQUNBO0FBQ0k7QUFtQlo7QUFqQlE7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQW1CaEI7QUFqQlk7QUFtQlo7QUFqQlE7QUFtQlI7QUFDQTtBQWpCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBbUJoQjtBQWxCb0I7QUFvQnBCO0FBQ0E7QUFsQlk7QUFDSTtBQW9CaEI7QUFDQTtBQUNBO0FBQ0E7QUFsQlE7QUFvQlI7QUFsQlk7QUFvQlo7QUFsQlk7QUFvQlo7QUFsQlk7QUFvQlo7QUFsQlk7QUFvQlo7QUFsQlk7QUFDSTtBQW9CaEI7QUFsQmdCO0FBb0JoQjtBQUNBO0FBbEJZO0FBQ0k7QUFvQmhCO0FBQ0E7QUFDQTtBQWxCUTtBQUNJO0FBQ0E7QUFvQlo7QUFuQmdCO0FBcUJoQjtBQUNBO0FBbkJZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFxQlo7QUFuQlk7QUFxQlo7QUFwQmdCO0FBQ0E7QUFDSTtBQXNCcEI7QUFDQTtBQXBCWTtBQXNCWjtBQXJCZ0I7QUFDQTtBQUNJO0FBdUJwQjtBQUNBO0FBckJZO0FBdUJaO0FBdEJnQjtBQUNBO0FBQ0k7QUF3QnBCO0FBQ0E7QUFDQTtBQXRCWTtBQUNBO0FBQ0k7QUFDSTtBQXdCcEI7QUFDQTtBQUNBO0FBdEJZO0FBd0JaO0FBdkJnQjtBQXlCaEI7QUF2Qlk7QUF5Qlo7QUF4QmdCO0FBMEJoQjtBQXhCWTtBQTBCWjtBQXpCZ0I7QUEyQmhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBekJZO0FBRUk7QUEwQmhCO0FBQ0E7QUFDQTtBQXhCUTtBQUNBO0FBQW9EO0FBMkI1RDtBQTFCUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTRCWjtBQUNBO0FBMUJRO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQTRCcEI7QUFDQTtBQUNBO0FBQ0E7QUExQlE7QUE0QlI7QUExQlE7QUFDQTtBQTRCUjtBQTFCUTtBQTRCUjtBQTNCWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBNkJwQjtBQUNBO0FBQ0E7QUFDQTtBQTNCUTtBQUNJO0FBQ0E7QUFDQTtBQTZCWjtBQTNCWTtBQUNBO0FBQ0E7QUE2Qlo7QUEzQlk7QUFDQTtBQTZCWjtBQTNCWTtBQTZCWjtBQUNBO0FBM0JRO0FBQ0k7QUE2Qlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzQlE7QUE2QlI7QUEzQlk7QUFBdUM7QUE4Qm5EO0FBQ0E7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUE3Qlk7QUErQlo7QUFDQTtBQTdCUTtBQUNBO0FBQ0E7QUErQlI7QUE5Qlk7QUFDQTtBQUNBO0FBQ0E7QUFBeUI7QUFpQ3JDO0FBaENZO0FBQXlCO0FBbUNyQztBQWxDWTtBQUF5QjtBQXFDckM7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXNDWjtBQXBDUTtBQXNDUjtBQXBDUTtBQXNDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQ0k7QUFDSTtBQXNDUjtBQXBDUTtBQXNDUjtBQXBDUTtBQXNDUjtBQXBDWTtBQXNDWjtBQXBDWTtBQXNDWjtBQUNBO0FBbkNRO0FBcUNSO0FBbkNRO0FBcUNSO0FBbkNRO0FBcUNSO0FBbENRO0FBb0NSO0FBbENZO0FBb0NaO0FBbENZO0FBb0NaO0FBbENZO0FBQ0E7QUFDSTtBQW9DaEI7QUFqQ2dCO0FBbUNoQjtBQUNBO0FBakNZO0FBbUNaO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFqQ2dCO0FBbUNoQjtBQWpDZ0I7QUFtQ2hCO0FBakNvQjtBQW1DcEI7QUFqQ29CO0FBbUNwQjtBQWpDb0I7QUFtQ3BCO0FBakN3QjtBQUFVO0FBb0NsQztBQUNBO0FBbkN3QjtBQXFDeEI7QUFuQ3dCO0FBcUN4QjtBQW5Dd0I7QUFxQ3hCO0FBbkN3QjtBQXFDeEI7QUFuQ3dCO0FBcUN4QjtBQUNBO0FBbENvQjtBQW9DcEI7QUFDQTtBQWpDZ0I7QUFtQ2hCO0FBakNnQjtBQW1DaEI7QUFDQTtBQUNBO0FBaENRO0FBa0NSO0FBQ0E7QUFDQTtBQUNBO0FBL0JJO0FBaUNKO0FBQ0E7QUFoQ1E7QUFrQ1I7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFrQ1o7QUFDQTtBQS9CUTtBQWlDUjtBQS9CUTtBQWlDUjtBQS9CUTtBQUNJO0FBaUNaO0FBOUJZO0FBZ0NaO0FBOUJRO0FBQ0E7QUFDQTtBQWdDUjtBQUNBO0FBQ0E7QUFDQTtBQTlCUTtBQWdDUjtBQTlCWTtBQWdDWjtBQTlCWTtBQWdDWjtBQTlCZ0I7QUFnQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBNUJRO0FBOEJSO0FBNUJZO0FBOEJaO0FBNUJZO0FBQW1DO0FBK0IvQztBQUNBO0FBQ0E7QUE5QlE7QUFnQ1I7QUE5QlE7QUFnQ1I7QUE5QlE7QUFBNEQ7QUFpQ3BFO0FBQ0E7QUFoQ1E7QUFrQ1I7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFrQ1o7QUFoQ2dCO0FBa0NoQjtBQWhDZ0I7QUFrQ2hCO0FBaENnQjtBQWtDaEI7QUFoQ29CO0FBa0NwQjtBQWhDb0I7QUFrQ3BCO0FBaENvQjtBQWtDcEI7QUFoQ3dCO0FBQ0k7QUFrQzVCO0FBQ0E7QUFoQ3dCO0FBa0N4QjtBQUNBO0FBL0JvQjtBQWlDcEI7QUEvQm9CO0FBaUNwQjtBQS9Cb0I7QUFpQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzQkk7QUE2Qko7QUEzQlE7QUE2QlI7QUEzQlE7QUE2QlI7QUEzQlE7QUE2QlI7QUEzQlE7QUE2QlI7QUFDQTtBQTNCSTtBQTZCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUE4Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJJO0FBOEJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJJO0FBOEJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBN0JJO0FBK0JKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBN0JJO0FBK0JKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUE3QlE7QUFDQTtBQStCUjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQTdCWTtBQStCWjtBQUNBO0FBQ0E7QUE1Qkk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQTBDO0FBK0J0RDtBQUNBO0FBOUJRO0FBZ0NSO0FBOUJZO0FBZ0NaO0FBOUJZO0FBZ0NaO0FBOUJnQjtBQWdDaEI7QUE5QmdCO0FBZ0NoQjtBQTlCZ0I7QUFnQ2hCO0FBQ0E7QUE3Qlk7QUErQlo7QUE3QmdCO0FBK0JoQjtBQTdCZ0I7QUFBbUM7QUFnQ25EO0FBQ0E7QUEvQmdCO0FBaUNoQjtBQS9CZ0I7QUFpQ2hCO0FBL0JvQjtBQWlDcEI7QUEvQm9CO0FBaUNwQjtBQUNBO0FBOUJnQjtBQWdDaEI7QUE5QmdCO0FBZ0NoQjtBQTlCZ0I7QUFnQ2hCO0FBQ0E7QUE3Qlk7QUErQlo7QUFDQTtBQUNBO0FBM0JJO0FBNkJKO0FBQ0E7QUFDQTtBQTdCUTtBQStCUjtBQTdCWTtBQUE4RDtBQWdDMUU7QUFoQzhHO0FBa0M5RztBQUNBO0FBakNZO0FBbUNaO0FBakNZO0FBQTZCO0FBQXlCO0FBQW9CO0FBc0N0RjtBQUNBO0FBQ0E7QUFDQTtBQXZDWTtBQXlDWjtBQUNBO0FBQ0E7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUF0Q1E7QUF3Q1I7QUFDQTtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQXRDUTtBQXdDUjtBQUNBO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBd0NSO0FBdENRO0FBQThDO0FBeUN0RDtBQUNBO0FBeENRO0FBMENSO0FBeENZO0FBMENaO0FBeENZO0FBMENaO0FBeENZO0FBMENaO0FBQ0E7QUFDQTtBQXZDSTtBQUNJO0FBeUNSO0FBQ0E7QUF2Q0k7QUFDSTtBQXlDUjtBQUNBO0FBdkNJO0FBQ0k7QUF5Q1I7QUFDQTtBQXZDSTtBQUNJO0FBQ0E7QUFDQTtBQXlDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBeUN4QjtBQXZDd0I7QUFDQTtBQXlDeEI7QUFDQTtBQUNBO0FBdENvQjtBQUNBO0FBd0NwQjtBQXRDZ0I7QUFDSTtBQUNBO0FBd0NwQjtBQXRDb0I7QUF3Q3BCO0FBdENvQjtBQUNBO0FBd0NwQjtBQUNBO0FBckNnQjtBQXVDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBckNJO0FBdUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXRDSTtBQXdDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZDSTtBQXlDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2Q0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBeUNaO0FBQ0E7QUF2Q1E7QUFDQTtBQUNBO0FBQ0E7QUF5Q1I7QUFDQTtBQUNBO0FBdkNJO0FBQ0k7QUF5Q1I7QUFDQTtBQUNBO0FBdkNJO0FBeUNKO0FBdkNRO0FBeUNSO0FBQ0E7QUFDQTtBQXZDSTtBQXlDSjtBQXZDUTtBQXlDUjtBQUNBO0FBdkNJO0FBQ0k7QUFDSTtBQXlDWjtBQUNBO0FBdkNRO0FBeUNSO0FBQ0E7QUF2Q1k7QUF5Q1o7QUFDQTtBQXZDUTtBQXlDUjtBQUNBO0FBQ0E7QUF2Q0k7QUF5Q0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZDSTtBQXlDSjtBQUNBO0FBQ0E7QUFDQTtBQXZDSTtBQXlDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xzREE7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFESjtBQUNBO0FBQ007QUFDQTtBQUNJO0FBQ1Y7QUFDTTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNNO0FBQ0U7QUFDRTtBQUNBO0FBQ1Y7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUZRO0FBQ0k7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRlE7QUFDQTtBQUlSO0FBRlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBSVI7QUFGUTtBQUNBO0FBSVI7QUFGUTtBQUNJO0FBSVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBQ0k7QUFJWjtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0k7QUFDSTtBQUNBO0FBSVI7QUFGSTtBQUlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hHQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFFSTtBQUFKO0FBSUk7QUFDRTtBQUZOO0FBQ0E7QUFJSTtBQUNFO0FBRk47QUFDQTtBQUlJO0FBQ0k7QUFGUjtBQUlJO0FBQ0k7QUFGUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQVI7QUFFUTtBQUE0QztBQUNwRDtBQUNBO0FBQVE7QUFFUjtBQUFRO0FBRVI7QUFBUTtBQUVSO0FBQVE7QUFFUjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ1E7QUFBNkM7QUFFckQ7QUFDQTtBQURRO0FBQTJDO0FBSW5EO0FBQ0E7QUFIUTtBQUtSO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUNBO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBS1o7QUFIWTtBQUtaO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBSVo7QUFGUTtBQUE4QjtBQUt0QztBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVo7QUFKWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQU1aO0FBQ0E7QUFKUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFKUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBS1I7QUFIUTtBQUNBO0FBQ0k7QUFDQTtBQUtaO0FBSFk7QUFLWjtBQUhRO0FBQ0E7QUFLUjtBQUNBO0FBSEk7QUFDSTtBQUtSO0FBSFk7QUFLWjtBQUhZO0FBS1o7QUFIWTtBQUtaO0FBSGdCO0FBQVU7QUFNMUI7QUFDQTtBQUxnQjtBQU9oQjtBQUxnQjtBQU9oQjtBQUxnQjtBQU9oQjtBQUxnQjtBQU9oQjtBQUxnQjtBQU9oQjtBQUNBO0FBSlk7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBSlE7QUFNUjtBQUpRO0FBTVI7QUFKUTtBQUNJO0FBQ0k7QUFNaEI7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBQ0E7QUFIUTtBQUNBO0FBQ0E7QUFLUjtBQUhRO0FBS1I7QUFIUTtBQUNBO0FBQ0E7QUFLUjtBQUNBO0FBSFE7QUFDQTtBQUNBO0FBS1I7QUFDQTtBQUhRO0FBQ0E7QUFLUjtBQUhRO0FBQTBDO0FBTWxEO0FBQ0E7QUFMUTtBQUNBO0FBQ0E7QUFPUjtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBQ0E7QUFOUTtBQUNJO0FBQ0E7QUFRWjtBQUNBO0FBTlE7QUFRUjtBQU5ZO0FBUVo7QUFOWTtBQVFaO0FBTlk7QUFRWjtBQU5ZO0FBUVo7QUFOWTtBQVFaO0FBTlk7QUFRWjtBQU5ZO0FBUVo7QUFOZ0I7QUFRaEI7QUFOZ0I7QUFRaEI7QUFDQTtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFk7QUFPWjtBQUxZO0FBQVE7QUFRcEI7QUFDQTtBQUNBO0FBTlE7QUFRUjtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ1E7QUFPaEI7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBT1I7QUFMWTtBQU9aO0FBTFk7QUFPWjtBQUxZO0FBT1o7QUFMWTtBQU9aO0FBTFk7QUFPWjtBQUxZO0FBT1o7QUFMZ0I7QUFPaEI7QUFMZ0I7QUFPaEI7QUFDQTtBQUpnQjtBQU1oQjtBQUpnQjtBQU1oQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUpZO0FBTVo7QUFDQTtBQUhRO0FBS1I7QUFIUTtBQUtSO0FBQ0E7QUFIUTtBQUNJO0FBS1o7QUFGWTtBQUlaO0FBQ0E7QUFGUTtBQUFpRDtBQUt6RDtBQUNBO0FBSlE7QUFNUjtBQUNBO0FBSEk7QUFDSTtBQUtSO0FBQ0E7QUFIUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBS1o7QUFDQTtBQUhRO0FBQ0E7QUFDQTtBQUNJO0FBS1o7QUFDQTtBQUZRO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUNJO0FBSVI7QUFGUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBSVo7QUFDQTtBQUZRO0FBQ0E7QUFDQTtBQUNJO0FBSVo7QUFDQTtBQUZRO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUlKO0FBRlE7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBQ0k7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUlKO0FBRlE7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFJaEI7QUFGZ0I7QUFJaEI7QUFGZ0I7QUFJaEI7QUFGZ0I7QUFJaEI7QUFGZ0I7QUFJaEI7QUFGZ0I7QUFJaEI7QUFEWTtBQUErQztBQUkzRDtBQUhZO0FBS1o7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0E7QUFLUjtBQUhRO0FBQ0E7QUFDSTtBQUNJO0FBS2hCO0FBSGdCO0FBS2hCO0FBSFk7QUFDQTtBQUNBO0FBQ0E7QUFLWjtBQUhRO0FBQ0E7QUFDSTtBQUtaO0FBSFE7QUFDSTtBQUNBO0FBS1o7QUFGWTtBQUNBO0FBSVo7QUFEWTtBQUNBO0FBR1o7QUFDQTtBQURRO0FBQ0E7QUFBOEI7QUFJdEM7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUlSO0FBRlE7QUFJUjtBQUZZO0FBQWtFO0FBSzlFO0FBSm9EO0FBTXBEO0FBQ0E7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFk7QUFPWjtBQUxZO0FBQTJDO0FBUXZEO0FBQ0E7QUFQWTtBQVNaO0FBUFk7QUFTWjtBQUNBO0FBTlE7QUFRUjtBQU5RO0FBUVI7QUFOWTtBQVFaO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQUNJO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFKUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVI7QUFKUTtBQU1SO0FBSlE7QUFDSTtBQUNBO0FBTVo7QUFKUTtBQU1SO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQU5RO0FBQ0k7QUFDSTtBQUNBO0FBUWhCO0FBTlk7QUFDQTtBQUNBO0FBQ0E7QUFRWjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBUVo7QUFOUTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDQTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBQ0k7QUFRWjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDSTtBQVFaO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzcEJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRjtBQUNBO0FBRUE7QUFDRTtBQUFGO0FBRUU7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBRUk7QUFBSjtBQUVJO0FBQ0E7QUFDQTtBQUFKO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFBSjtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQUo7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUo7QUFFSTtBQUNFO0FBQU47QUFFTTtBQUFOO0FBQ0E7QUFFSTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFBUjtBQUNBO0FBRU07QUFDQTtBQUNBO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQUo7QUFDQTtBQUVFO0FBQ0U7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBRUU7QUFDRTtBQUNFO0FBQU47QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBRUk7QUFDQTtBQUFKO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0SEE7QUFDQTtBQUNDO0FBQ0c7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNaO0FBQ1k7QUFDWjtBQUNRO0FBQ0k7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ1E7QUFDUjtBQUNNO0FBQ0E7QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUFNO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBQ0U7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0U7QUFDQTtBQUVFO0FBQ1Y7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDVjtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckZBO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNKO0FBQ0E7QUFDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDQTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0o7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFBTTtBQUNBO0FBQ0U7QUFDRTtBQUVWO0FBQVE7QUFFUjtBQUNBO0FBQ0E7QUFDQTtBQUFFO0FBQ0U7QUFDQTtBQUNBO0FBRUo7QUFBRTtBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDRTtBQUNBO0FBRUY7QUFBRTtBQUNFO0FBQ0k7QUFFUjtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQ0E7QUFBRTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBRVo7QUFBWTtBQUVaO0FBQ0E7QUFBUTtBQUNFO0FBQ0U7QUFFWjtBQUFVO0FBRVY7QUFDQTtBQUFRO0FBRVI7QUFDQTtBQUNBO0FBRUU7QUFDQTtBQUNFO0FBQUo7QUFFRTtBQUFGO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDRTtBQUNFO0FBQUo7QUFFRTtBQUFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFDQTtBQUNBO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDQTtBQUFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUVSO0FBQ0E7QUFDTTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ1I7QUFDTTtBQUNOO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDTjtBQUFRO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBRWQ7QUFDQTtBQUNBO0FBQVE7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFERTtBQUNFO0FBR0o7QUFESTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ0E7QUFHVjtBQUNBO0FBRE07QUFHTjtBQURJO0FBR0o7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBSEU7QUFDRTtBQUtKO0FBSEU7QUFDQTtBQUNFO0FBS0o7QUFIRTtBQUtGO0FBSEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUtSO0FBQ0E7QUFGTTtBQUNFO0FBQ0E7QUFJUjtBQUNBO0FBRk07QUFDRTtBQUNBO0FBSVI7QUFDQTtBQUZNO0FBQ0U7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUNBO0FBRkU7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBSVI7QUFGTTtBQUlOO0FBQ0E7QUFDQTtBQUNBO0FBRkU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBTFU7QUFDSTtBQU9kO0FBTlU7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFRaEI7QUFDQTtBQUNBO0FBTFU7QUFPVjtBQUxVO0FBT1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMRTtBQUNFO0FBT0o7QUFMSTtBQUNBO0FBQ0U7QUFPTjtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFDRTtBQUNBO0FBQ0U7QUFPSjtBQUxFO0FBT0Y7QUFMRTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9OO0FBQ0E7QUFMRTtBQUNFO0FBT0o7QUFMRTtBQUNBO0FBT0Y7QUFDQTtBQUxBO0FBQ0U7QUFDRTtBQU9KO0FBTEU7QUFDQTtBQU9GO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQVBFO0FBQ0U7QUFTSjtBQVBFO0FBQ0U7QUFTSjtBQUNBO0FBUEU7QUFDRTtBQVNKO0FBUEU7QUFTRjtBQUNBO0FBUEU7QUFDRTtBQVNKO0FBUEU7QUFDRTtBQUNBO0FBQ0E7QUFTSjtBQUNBO0FBUEU7QUFTRjtBQUNBO0FBUEU7QUFDRTtBQUNBO0FBU0o7QUFSTTtBQUNBO0FBQ0U7QUFVUjtBQVJVO0FBQ0U7QUFVWjtBQUNBO0FBUlU7QUFVVjtBQVJRO0FBVVI7QUFDQTtBQVJNO0FBQ0E7QUFVTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFURTtBQUNBO0FBQ0U7QUFXSjtBQUNBO0FBVEU7QUFDRTtBQVdKO0FBQ0E7QUFURTtBQVdGO0FBVEE7QUFXQTtBQUNBO0FBWEU7QUFDRTtBQWFKO0FBWEU7QUFDQTtBQUNFO0FBYUo7QUFYRTtBQWFGO0FBWEU7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBYU47QUFDQTtBQUNBO0FBWEU7QUFDRTtBQWFKO0FBWEU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFhTjtBQUNBO0FBQ0E7QUFkUTtBQUNJO0FBZ0JaO0FBZlE7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFpQmQ7QUFDQTtBQUNBO0FBQ0E7QUFkUTtBQUNBO0FBZ0JSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmRTtBQUNFO0FBaUJKO0FBZkk7QUFDQTtBQUNFO0FBaUJOO0FBZkk7QUFpQko7QUFDQTtBQWZBO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFpQk47QUFDQTtBQWZJO0FBQ0U7QUFDRTtBQUNFO0FBaUJWO0FBZlE7QUFDRTtBQWlCVjtBQWZRO0FBaUJSO0FBQ0E7QUFmTTtBQUNFO0FBaUJSO0FBQ0E7QUFmTTtBQUNBO0FBQ0E7QUFpQk47QUFDQTtBQUNBO0FBZkU7QUFpQkY7QUFDQTtBQUNBO0FBQ0E7QUFmQTtBQWlCQTtBQUNBO0FBakJFO0FBQ0U7QUFtQko7QUFDQTtBQWpCRTtBQUNBO0FBbUJGO0FBakJFO0FBQ0E7QUFDRTtBQUNBO0FBbUJKO0FBbEJNO0FBQ0E7QUFDRTtBQUNFO0FBb0JWO0FBbEJVO0FBb0JWO0FBQ0E7QUFsQk07QUFDQTtBQW9CTjtBQUNBO0FBQ0E7QUFuQkU7QUFxQkY7QUFuQkE7QUFDRTtBQUNFO0FBcUJKO0FBbkJFO0FBQ0E7QUFDRTtBQXFCSjtBQW5CRTtBQXFCRjtBQW5CRTtBQXFCRjtBQW5CRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFxQk47QUFDQTtBQUNBO0FBdEJRO0FBQ0k7QUF3Qlo7QUF2QlE7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUF5QmQ7QUFDQTtBQUNBO0FBQ0E7QUF0QlE7QUFDQTtBQXdCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkJFO0FBeUJGO0FBQ0E7QUF2QkE7QUFDRTtBQUNBO0FBQ0U7QUF5Qko7QUFDQTtBQXRCRTtBQUNBO0FBQ0E7QUF3QkY7QUFDQTtBQUNBO0FBdEJFO0FBQ0U7QUFDRTtBQUNFO0FBd0JSO0FBdEJRO0FBQ0E7QUF3QlI7QUF0QlE7QUF3QlI7QUFDQTtBQUNBO0FBdEJJO0FBQ0U7QUFDRTtBQXdCUjtBQUNBO0FBQ0E7QUFDQTtBQXRCUTtBQUNBO0FBd0JSO0FBQ0E7QUFDQTtBQUNBO0FBdEJRO0FBd0JSO0FBQ0E7QUFDQTtBQUNBO0FBcEJFO0FBQ0U7QUFzQko7QUFwQkU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQXNCWjtBQUNBO0FBcEJRO0FBQ0U7QUFzQlY7QUFDQTtBQXBCTTtBQUNFO0FBc0JSO0FBQ0E7QUFDQTtBQXBCRTtBQUNFO0FBc0JKO0FBcEJFO0FBc0JGO0FBcEJBO0FBQ0U7QUFDQTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0E7QUFDRTtBQXNCSjtBQXBCRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQXNCTjtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBc0JOO0FBQ0E7QUFDQTtBQXBCRTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFzQlo7QUFDQTtBQXBCUTtBQUNFO0FBc0JWO0FBQ0E7QUFwQk07QUFDRTtBQXNCUjtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQXNCSjtBQXBCRTtBQXNCRjtBQUNBO0FBcEJBO0FBc0JBO0FBQ0E7QUF0QkU7QUF3QkY7QUF2Qkk7QUFDRTtBQUNBO0FBQ0U7QUF5QlI7QUFDQTtBQUNBO0FBdkJFO0FBQ0U7QUF5Qko7QUF2QkU7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBeUJOO0FBeEJRO0FBQ0U7QUFDQTtBQUNFO0FBMEJaO0FBQ0E7QUFDQTtBQXhCUTtBQUNBO0FBQ0U7QUEwQlY7QUFDQTtBQUNBO0FBQ0E7QUF4QkU7QUFDRTtBQTBCSjtBQXhCRTtBQUNBO0FBMEJGO0FBQ0E7QUF4QkE7QUFDRTtBQUNFO0FBMEJKO0FBeEJJO0FBQ0E7QUEwQko7QUF6Qk07QUFDRTtBQTJCUjtBQXpCUTtBQUNBO0FBMkJSO0FBQ0E7QUFDQTtBQXpCSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQTJCVjtBQXpCTTtBQTJCTjtBQTFCUTtBQUNBO0FBNEJSO0FBQ0E7QUFDQTtBQXpCRTtBQTJCRjtBQUNBO0FBeEJBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQWdCRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0NEJBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0o7QUFDVTtBQUNWO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDQTtBQUdBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDRTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBQ007QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0Y7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNOO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDTjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0Y7QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNKO0FBQ0k7QUFDRTtBQUNOO0FBQ007QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFFSTtBQUFKO0FBQ007QUFDTjtBQUNJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDSTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQU47QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUdJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUROO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUROO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFDQTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBSE47QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBTUk7QUFKSjtBQUtNO0FBSE47QUFLSTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBSE47QUFLTTtBQUNBO0FBSE47QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUpOO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUNFO0FBSFY7QUFLVTtBQUhWO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDQTtBQUhOO0FBS0k7QUFISjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFMTjtBQU1RO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUpaO0FBQ0E7QUFDQTtBQVFRO0FBTlI7QUFPVTtBQUNFO0FBQ0E7QUFMWjtBQU9ZO0FBQ0E7QUFMWjtBQUNBO0FBQ0E7QUFDQTtBQVVJO0FBUko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdJO0FBQ0E7QUFDQTtBQUNBO0FBVEo7QUFXSTtBQUNFO0FBQ0U7QUFUUjtBQVdNO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBVFY7QUFXVTtBQVRWO0FBQ0E7QUFDQTtBQUNBO0FBV007QUFDRTtBQUNBO0FBVFI7QUFXTTtBQVROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXSTtBQUNFO0FBVE47QUFVUTtBQVJSO0FBU1U7QUFDRTtBQUNBO0FBQ0E7QUFQWjtBQUNBO0FBQ0E7QUFVUTtBQVJSO0FBU1U7QUFDRTtBQUNBO0FBQ0E7QUFQWjtBQUNBO0FBQ0E7QUFDQTtBQVdJO0FBQ0U7QUFDQTtBQVROO0FBV0k7QUFUSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWUk7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFWTjtBQVlJO0FBQ0U7QUFDQTtBQVZOO0FBWUk7QUFWSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYUU7QUFDQTtBQUNFO0FBWEo7QUFDQTtBQWFFO0FBQ0E7QUFYRjtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFYTjtBQUNBO0FBQ0E7QUFhRTtBQUNBO0FBWEY7QUFhRTtBQUNFO0FBQ0U7QUFYTjtBQUNBO0FBYUU7QUFDRTtBQUNBO0FBQ0U7QUFYTjtBQUNBO0FBYUU7QUFDRTtBQUNFO0FBWE47QUFDQTtBQUNBO0FBYUU7QUFYRjtBQVlJO0FBQ0U7QUFDRTtBQVZSO0FBQ0E7QUFDQTtBQVlJO0FBQ0U7QUFWTjtBQVlJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFWTjtBQVlJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFWVjtBQUNBO0FBQ0E7QUFDQTtBQVlJO0FBVko7QUFXTTtBQUNFO0FBVFI7QUFDQTtBQUNBO0FBQ0E7QUFXSTtBQUNFO0FBVE47QUFXSTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBVE47QUFXSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBVFY7QUFDQTtBQUNBO0FBQ0E7QUFXSTtBQVRKO0FBVU07QUFDRTtBQVJSO0FBQ0E7QUFDQTtBQVdJO0FBQ0U7QUFUTjtBQVdJO0FBQ0E7QUFDRTtBQUNBO0FBVE47QUFXSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBVFY7QUFDQTtBQUNBO0FBV0k7QUFUSjtBQVVNO0FBQ0U7QUFSUjtBQUNBO0FBQ0E7QUFDQTtBQVVFO0FBQ0U7QUFDRTtBQVJOO0FBQ0E7QUFVRTtBQUNFO0FBUko7QUFVRTtBQVJGO0FBQ0E7QUFDQTtBQVVBO0FBQ0U7QUFDQTtBQUNFO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQVVJO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQVVJO0FBUko7QUFVSTtBQVJKO0FBVUk7QUFSSjtBQUNBO0FBVUU7QUFSRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBUkE7QUFVRTtBQVJGO0FBVUU7QUFBMEI7QUFQNUI7QUFDQTtBQVFFO0FBQ0E7QUFDRTtBQUNBO0FBTko7QUFRSTtBQUNFO0FBTk47QUFRSTtBQUNBO0FBQ0E7QUFOSjtBQUNBO0FBUUU7QUFBNkI7QUFML0I7QUFNRTtBQUpGO0FBQ0E7QUFNQTtBQUpBO0FBTUU7QUFKRjtBQU1FO0FBQTBCO0FBSDVCO0FBQ0E7QUFJRTtBQUNBO0FBQ0U7QUFDQTtBQUZKO0FBSUk7QUFDRTtBQUZOO0FBSUk7QUFDQTtBQUNBO0FBRko7QUFDQTtBQUlFO0FBQTZCO0FBRC9CO0FBRUU7QUFBRjtBQUNBO0FBRUE7QUFBQTtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUU7QUFBRjtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUU7QUFBRjtBQUVFO0FBQUY7QUFFRTtBQUFGO0FBRUk7QUFBSjtBQUdFO0FBREY7QUFHSTtBQURKO0FBR007QUFETjtBQUdNO0FBRE47QUFHTTtBQUE2RTtBQUFuRjtBQUNBO0FBRUk7QUFBSjtBQUVJO0FBQUo7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUlFO0FBRkY7QUFLSTtBQUhKO0FBS007QUFITjtBQUtNO0FBSE47QUFLTTtBQUE2RTtBQUZuRjtBQUNBO0FBQ0E7QUFJSTtBQUZKO0FBSUk7QUFBdUI7QUFEM0I7QUFDQTtBQUVJO0FBQUo7QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFJRTtBQUZGO0FBQ0E7QUFJQTtBQUZBO0FBQ0E7QUFJRTtBQUZGO0FBSUU7QUFGRjtBQUlFO0FBRkY7QUFJRTtBQUZGO0FBSUU7QUFGRjtBQUlFO0FBRkY7QUFJSTtBQUZKO0FBSU07QUFGTjtBQUNBO0FBQ0E7QUFLRTtBQUhGO0FBS0k7QUFISjtBQUtJO0FBQXFDO0FBRnpDO0FBRXlGO0FBQXpGO0FBQ0E7QUFDSTtBQUNKO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNBO0FBR0U7QUFERjtBQUdJO0FBREo7QUFHTTtBQUROO0FBR007QUFETjtBQUdNO0FBQTZFO0FBQW5GO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFFSTtBQUFKO0FBRUk7QUFBSjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUdFO0FBREY7QUFJSTtBQUZKO0FBSU07QUFGTjtBQUlNO0FBRk47QUFJTTtBQUE2RTtBQURuRjtBQUNBO0FBQ0E7QUFHSTtBQURKO0FBR0k7QUFBdUI7QUFBM0I7QUFDQTtBQUNJO0FBQ0o7QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFIQTtBQUNBO0FBS0U7QUFIRjtBQUtFO0FBSEY7QUFLRTtBQUhGO0FBS0U7QUFIRjtBQUtFO0FBSEY7QUFLRTtBQUhGO0FBS0k7QUFISjtBQUtNO0FBSE47QUFDQTtBQUNBO0FBTUU7QUFKRjtBQU1JO0FBSko7QUFNSTtBQUE4QjtBQUhsQztBQUdrRjtBQURsRjtBQUNBO0FBRUk7QUFBSjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUlFO0FBRkY7QUFJSTtBQUZKO0FBSU07QUFGTjtBQUlNO0FBRk47QUFJTTtBQUE2RTtBQURuRjtBQUNBO0FBQ0E7QUFHSTtBQURKO0FBR0k7QUFESjtBQUdJO0FBREo7QUFHTTtBQUROO0FBR007QUFETjtBQUdNO0FBRE47QUFHTTtBQUROO0FBQ0E7QUFJRTtBQUZGO0FBS0k7QUFISjtBQUtNO0FBSE47QUFLTTtBQUhOO0FBS007QUFBNkU7QUFGbkY7QUFDQTtBQUNBO0FBSUk7QUFGSjtBQUlJO0FBQXVCO0FBRDNCO0FBQ0E7QUFFSTtBQUFKO0FBRU07QUFBTjtBQUVNO0FBQU47QUFFTTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBSkE7QUFDQTtBQU1FO0FBSkY7QUFNRTtBQUpGO0FBTUU7QUFKRjtBQU1FO0FBSkY7QUFDQTtBQU9BO0FBTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzE0QkE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDSjtBQUNVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSjtBQVdJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQVRaO0FBQ0E7QUFDQTtBQVdJO0FBQ0E7QUFUSjtBQVdRO0FBQ0E7QUFDSTtBQVRaO0FBQ0E7QUFTUTtBQUNBO0FBQ0k7QUFDQTtBQVBaO0FBQ0E7QUFDQTtBQUNBO0FBU0k7QUFDSTtBQVBSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTUTtBQVBSO0FBQ0E7QUFTSTtBQVBKO0FBQ0E7QUFTQTtBQVBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBb0I7QUFFNUI7QUFEUTtBQUFvQjtBQUk1QjtBQUhRO0FBQW9CO0FBTTVCO0FBTFE7QUFBb0I7QUFRNUI7QUFDQTtBQVBRO0FBQ0E7QUFDQTtBQUNBO0FBU1I7QUFQUTtBQUNBO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQUNJO0FBU1o7QUFQWTtBQVNaO0FBQ0E7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQVNKO0FBQ0E7QUFDQTtBQVZRO0FBWVI7QUFDQTtBQVZJO0FBQ0k7QUFDSTtBQVlaO0FBVlE7QUFZUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0E7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBV0o7QUFUUTtBQUNBO0FBQ0k7QUFDQTtBQVdaO0FBVFk7QUFDQTtBQVdaO0FBVFk7QUFXWjtBQUNBO0FBVFE7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBV0o7QUFDQTtBQUNBO0FBVEE7QUFDSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBQ0E7QUFUQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBVEE7QUFXQTtBQVRBO0FBQ0k7QUFDSTtBQVdSO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFDSTtBQUNJO0FBV1I7QUFDQTtBQUNBO0FBVEE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXSjtBQVRJO0FBV0o7QUFUSTtBQUNBO0FBQ0E7QUFXSjtBQVRJO0FBQ0E7QUFXSjtBQVRJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXSjtBQUNBO0FBQ0E7QUFUQTtBQUNJO0FBR0E7QUFDQTtBQVNKO0FBQ0E7QUFDQTtBQVBBO0FBQ0k7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBUUo7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBQ0E7QUFSSTtBQUNJO0FBVVI7QUFDQTtBQVJJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFVWjtBQUNBO0FBUkk7QUFVSjtBQUNBO0FBQ0E7QUFSQTtBQVVBO0FBQ0E7QUFWSTtBQUNJO0FBWVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZJO0FBQ0E7QUFZSjtBQVZJO0FBQ0E7QUFDQTtBQVlKO0FBVkk7QUFDSTtBQUNBO0FBQ0k7QUFZWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFDSTtBQUNJO0FBWVI7QUFWSTtBQUNBO0FBQ0E7QUFZSjtBQVZJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQVloQjtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBQ0E7QUFWQTtBQVlBO0FBQ0E7QUFaSTtBQUNJO0FBY1I7QUFDQTtBQVpJO0FBQ0k7QUFjUjtBQUNBO0FBWkk7QUFDSTtBQWNSO0FBWlE7QUFjUjtBQUNBO0FBWkk7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQWNaO0FBQ0E7QUFaUTtBQWNSO0FBQ0E7QUFaSTtBQWNKO0FBQ0E7QUFDQTtBQVpBO0FBQ0k7QUFDQTtBQUNJO0FBY1I7QUFDQTtBQVpJO0FBQ0E7QUFDQTtBQWNKO0FBWkk7QUFDSTtBQUNBO0FBY1I7QUFDQTtBQVpJO0FBY0o7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQWNBO0FBWlE7QUFDQTtBQUNJO0FBY1o7QUFDQTtBQVpRO0FBQ0k7QUFjWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBekJJO0FBMkJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQkk7QUFzQko7QUFwQkE7QUFDSTtBQUNJO0FBc0JSO0FBcEJJO0FBQ0k7QUFzQlI7QUFwQkk7QUFzQko7QUFyQlE7QUFDSTtBQXVCWjtBQUNBO0FBckJJO0FBdUJKO0FBQ0E7QUFyQkE7QUF1QkE7QUFDQTtBQXZCSTtBQUNJO0FBeUJSO0FBdkJJO0FBQ0k7QUF5QlI7QUF2Qkk7QUF5Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZCQTtBQUNJO0FBeUJKO0FBQ0E7QUFDQTtBQXZCQTtBQXlCQTtBQUNBO0FBekJJO0FBQ0k7QUEyQlI7QUF6Qkk7QUFDSTtBQTJCUjtBQXpCSTtBQTJCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkJBO0FBQ0k7QUFDQTtBQUNJO0FBeUJSO0FBdkJJO0FBQ0E7QUFDSTtBQXlCUjtBQUNBO0FBQ0E7QUFDQTtBQXZCSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQXlCWjtBQXZCWTtBQXlCWjtBQXZCWTtBQXlCWjtBQXZCWTtBQXlCWjtBQUNBO0FBdkJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQXlCWjtBQUNBO0FBdkJJO0FBQ0k7QUF5QlI7QUF2Qlk7QUF5Qlo7QUF2QmdCO0FBQXlDO0FBMEJ6RDtBQUNBO0FBekJnQjtBQTJCaEI7QUF6QmdCO0FBQ0k7QUEyQnBCO0FBQ0E7QUF6QmdCO0FBQ0k7QUEyQnBCO0FBQ0E7QUF6QmdCO0FBMkJoQjtBQXpCZ0I7QUEyQmhCO0FBekJnQjtBQTJCaEI7QUF6QmdCO0FBMkJoQjtBQXpCZ0I7QUEyQmhCO0FBQ0E7QUFDQTtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0E7QUFDSTtBQTBCUjtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQUNBO0FBeEJBO0FBMEJBO0FBeEJJO0FBQ0E7QUFDSTtBQTBCUjtBQXhCSTtBQUNBO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBMEJSO0FBeEJRO0FBMEJSO0FBeEJJO0FBQ0k7QUFDSTtBQTBCWjtBQUNBO0FBQ0E7QUF4Qkk7QUFBeUM7QUEyQjdDO0FBQ0E7QUExQkk7QUE0Qko7QUExQkk7QUFDSTtBQTRCUjtBQUNBO0FBMUJJO0FBQ0k7QUE0QlI7QUFDQTtBQTFCSTtBQTRCSjtBQTFCSTtBQTRCSjtBQTFCSTtBQTRCSjtBQTFCSTtBQTRCSjtBQUNBO0FBMUJJO0FBNEJKO0FBQ0E7QUFDQTtBQTFCQTtBQUNJO0FBQ0E7QUFDSTtBQTRCUjtBQTFCSTtBQUNBO0FBQ0k7QUE0QlI7QUExQkk7QUFDSTtBQTRCUjtBQTFCSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQTRCWjtBQTFCWTtBQTRCWjtBQTFCWTtBQTRCWjtBQTFCWTtBQTRCWjtBQUNBO0FBMUJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQTRCWjtBQUNBO0FBQ0E7QUFDQTtBQTFCSTtBQUNJO0FBQ0k7QUFDSTtBQTRCaEI7QUFDQTtBQTFCUTtBQUNJO0FBNEJaO0FBMUJRO0FBQ0E7QUE0QlI7QUExQkk7QUE0Qko7QUFDQTtBQXpCQTtBQUNJO0FBQ0E7QUFDSTtBQTJCUjtBQXpCSTtBQUNBO0FBQ0k7QUEyQlI7QUF6Qkk7QUFDSTtBQTJCUjtBQXpCSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBMkJaO0FBekJZO0FBMkJaO0FBQ0E7QUFDQTtBQUNBO0FBekJJO0FBQ0k7QUEyQlI7QUFDQTtBQUNBO0FBQ0E7QUF6Qkk7QUEyQko7QUFDQTtBQUNBO0FBekJBO0FBQ0k7QUFDQTtBQUNJO0FBMkJSO0FBQ0E7QUF6Qkk7QUEyQko7QUF6Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUEyQlo7QUF4Qlk7QUEwQlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCWTtBQTBCWjtBQUNBO0FBQ0E7QUF4Qkk7QUEwQko7QUF4QlE7QUFBeUM7QUEyQmpEO0FBQ0E7QUExQlE7QUE0QlI7QUExQlE7QUFDSTtBQTRCWjtBQUNBO0FBMUJRO0FBQ0k7QUE0Qlo7QUFDQTtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCUTtBQTRCUjtBQTFCSTtBQTRCSjtBQUNBO0FBMUJBO0FBQ0k7QUFDQTtBQUNJO0FBNEJSO0FBQ0E7QUExQkk7QUFDQTtBQTRCSjtBQTFCSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQTRCWjtBQXpCWTtBQTJCWjtBQXhCWTtBQTBCWjtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQTBCQTtBQXhCSTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qlk7QUEwQlo7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUFDSTtBQTBCUjtBQUNBO0FBQ0E7QUF4Qkk7QUFDSTtBQTBCUjtBQUNBO0FBeEJJO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQUNJO0FBMEJaO0FBQ0E7QUF4QlE7QUFDSTtBQTBCWjtBQXhCUTtBQUNJO0FBQ0k7QUEwQmhCO0FBQ0E7QUF4Qlk7QUFDSTtBQTBCaEI7QUF4Qlk7QUEwQlo7QUF4QmdCO0FBQ0E7QUFDSTtBQUNJO0FBMEJ4QjtBQXhCd0I7QUEwQnhCO0FBQ0E7QUF4QmdCO0FBMEJoQjtBQXhCb0I7QUEwQnBCO0FBQ0E7QUF4QmdCO0FBQ0k7QUEwQnBCO0FBeEJ3QjtBQUNBO0FBMEJ4QjtBQUNBO0FBeEJnQjtBQUNJO0FBQXdDO0FBMkI1RDtBQTFCb0I7QUFDSTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBNEJwQztBQUNBO0FBQ0E7QUExQndCO0FBNEJ4QjtBQTFCb0I7QUE0QnBCO0FBMUJnQjtBQTRCaEI7QUFDQTtBQUNBO0FBMUJJO0FBQ0k7QUFBd0M7QUE2QmhEO0FBNUJRO0FBQ0k7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQThCeEI7QUFDQTtBQUNBO0FBNUJZO0FBOEJaO0FBNUJRO0FBOEJSO0FBNUJJO0FBOEJKO0FBQ0E7QUFDQTtBQTVCQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQThCWjtBQTVCUTtBQUNJO0FBOEJaO0FBNUJRO0FBQ0E7QUE4QlI7QUE1Qlk7QUE4Qlo7QUE1QmdCO0FBQ0k7QUFDSTtBQThCeEI7QUE1QjRCO0FBQ0k7QUE4QmhDO0FBNUI0QjtBQThCNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJnQjtBQUNJO0FBQ0k7QUE4QnhCO0FBNUJvQjtBQUNJO0FBOEJ4QjtBQTVCb0I7QUFDQTtBQThCcEI7QUE1QndCO0FBQ0k7QUFDSTtBQUNJO0FBOEJwQztBQTVCd0M7QUFDSTtBQThCNUM7QUE1QndDO0FBOEJ4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUI0QjtBQThCNUI7QUE1QjRCO0FBOEI1QjtBQTVCZ0M7QUE4QmhDO0FBNUJnQztBQUE2QjtBQStCN0Q7QUFDQTtBQTlCZ0M7QUFnQ2hDO0FBOUJnQztBQWdDaEM7QUFDQTtBQTlCNEI7QUFnQzVCO0FBQ0E7QUE5QndCO0FBZ0N4QjtBQUNBO0FBQ0E7QUFDQTtBQTlCWTtBQWdDWjtBQUNBO0FBQ0E7QUE5Qkk7QUFDSTtBQWdDUjtBQTlCSTtBQUNJO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCQTtBQUNJO0FBQ0E7QUFDSTtBQWdDUjtBQTlCSTtBQUNJO0FBZ0NSO0FBOUJJO0FBQ0E7QUFDSTtBQWdDUjtBQUNBO0FBOUJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0NKO0FBL0JRO0FBaUNSO0FBQ0E7QUEvQkk7QUFpQ0o7QUFoQ1E7QUFrQ1I7QUFoQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFrQ1o7QUFDQTtBQWpDWTtBQW1DWjtBQUNBO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFsQ1E7QUFDQTtBQUNJO0FBb0NaO0FBbENRO0FBQ0k7QUFvQ1o7QUFuQ2dCO0FBcUNoQjtBQUNBO0FBbkNZO0FBQ0E7QUFDSTtBQUNBO0FBcUNoQjtBQXBDb0I7QUFzQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBDb0I7QUFzQ3BCO0FBQ0E7QUFDQTtBQW5DWTtBQXFDWjtBQXBDZ0I7QUFzQ2hCO0FBckNvQjtBQXVDcEI7QUFyQ2dCO0FBQ0E7QUF1Q2hCO0FBQ0E7QUFyQ1k7QUFDSTtBQXVDaEI7QUF0Q29CO0FBd0NwQjtBQUNBO0FBdENZO0FBd0NaO0FBdkNnQjtBQXlDaEI7QUFDQTtBQXZDZ0I7QUF5Q2hCO0FBQ0E7QUF2Q1E7QUF5Q1I7QUF4Q1k7QUFDQTtBQTBDWjtBQUNBO0FBeENZO0FBMENaO0FBQ0E7QUFDQTtBQXhDSTtBQUNBO0FBMENKO0FBekNRO0FBQ0E7QUFDQTtBQTJDUjtBQXpDUTtBQUNBO0FBMkNSO0FBekNJO0FBQ0E7QUFDSTtBQUNJO0FBMkNaO0FBQ0E7QUF6Q1E7QUEyQ1I7QUF6Q0k7QUEyQ0o7QUFDQTtBQXpDQTtBQTJDQTtBQUNBO0FBM0NJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUE2Q1I7QUEzQ0k7QUFDSTtBQUNBO0FBNkNSO0FBM0NRO0FBQ0k7QUFDQTtBQUNJO0FBNkNoQjtBQTNDWTtBQTZDWjtBQTFDUTtBQUNBO0FBNENSO0FBMUNJO0FBNENKO0FBQ0E7QUExQ0E7QUFDSTtBQTRDSjtBQUNBO0FBekNBO0FBQ0k7QUFDQTtBQUNJO0FBMkNSO0FBekNJO0FBQ0E7QUFDSTtBQTJDUjtBQXpDSTtBQTJDSjtBQXpDSTtBQUNBO0FBQ0k7QUFDQTtBQTJDUjtBQUNBO0FBekNJO0FBQ0k7QUEyQ1I7QUFDQTtBQXpDSTtBQUNJO0FBMkNSO0FBQ0E7QUF6Q0k7QUFDQTtBQUNBO0FBMkNKO0FBekNJO0FBQ0k7QUEyQ1I7QUFDQTtBQXpDSTtBQTJDSjtBQUNBO0FBQ0E7QUF6Q0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQTJDWjtBQXpDUTtBQTJDUjtBQUNBO0FBekNJO0FBMkNKO0FBQ0E7QUFDQTtBQXpDQTtBQUNJO0FBMkNKO0FBQ0E7QUFDQTtBQXZDQTtBQUNJO0FBQ0E7QUFDSTtBQXlDUjtBQUNBO0FBdkNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBeUNaO0FBQ0E7QUF2Q0k7QUF5Q0o7QUFDQTtBQUNBO0FBdENBO0FBQ0k7QUFDQTtBQUNJO0FBd0NSO0FBdENJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBd0NaO0FBQ0E7QUFDQTtBQXRDSTtBQXdDSjtBQUNBO0FBQ0E7QUFDQTtBQXJDQTtBQUNJO0FBQ0E7QUFDSTtBQXVDUjtBQXJDSTtBQUNBO0FBQ0k7QUF1Q1I7QUFyQ0k7QUFDQTtBQUNBO0FBQ0k7QUF1Q1I7QUFDQTtBQXJDSTtBQUNJO0FBdUNSO0FBQ0E7QUFyQ0k7QUFDSTtBQXVDUjtBQUNBO0FBckNJO0FBR0k7QUFxQ1I7QUFDQTtBQW5DSTtBQXFDSjtBQUNBO0FBQ0E7QUFDQTtBQWxDQTtBQUNJO0FBQ0E7QUFDSTtBQW9DUjtBQWxDSTtBQUNBO0FBQ0E7QUFDQTtBQW9DSjtBQWxDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBb0NoQjtBQWxDWTtBQW9DWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbENJO0FBb0NKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0E7QUFDSTtBQW1DUjtBQUNBO0FBakNJO0FBQ0k7QUFDSTtBQW1DWjtBQWpDUTtBQW1DUjtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBakNJO0FBQ0E7QUFDQTtBQW1DSjtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFtQ2hCO0FBakNZO0FBbUNaO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDSTtBQUNJO0FBbUNaO0FBakNRO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0E7QUFDSTtBQW1DUjtBQWpDSTtBQUNJO0FBbUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDSTtBQW1DUjtBQWpDUTtBQW1DUjtBQUNBO0FBakNJO0FBQ0E7QUFDQTtBQUNBO0FBbUNKO0FBakNJO0FBQ0k7QUFDSTtBQUNBO0FBbUNaO0FBQ0E7QUFqQ1E7QUFDQTtBQW1DUjtBQUNBO0FBakNJO0FBQ0E7QUFtQ0o7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDQTtBQUNJO0FBbUNSO0FBQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQW1DaEI7QUFqQ1k7QUFtQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDSTtBQW1DUjtBQUNBO0FBakNJO0FBQ0k7QUFDSTtBQW1DWjtBQUNBO0FBakNRO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBakNBO0FBQ0k7QUFDSTtBQW1DUjtBQWpDSTtBQUNJO0FBbUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDQTtBQUNJO0FBQ0k7QUFtQ1o7QUFDQTtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFDQTtBQW1DSjtBQWpDSTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNBO0FBQ0k7QUFtQ1I7QUFDQTtBQUNBO0FBQ0E7QUFqQ0k7QUFDQTtBQUNBO0FBQ0E7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBbUNoQjtBQWpDWTtBQW1DWjtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQUNJO0FBQ0k7QUFtQ1I7QUFqQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW1DSjtBQUNBO0FBQ0E7QUFqQ0E7QUFDSTtBQUNJO0FBbUNSO0FBQ0E7QUFqQ0k7QUFtQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCQTtBQUNJO0FBQ1E7QUE4Qlo7QUE1QlE7QUE4QlI7QUE1Qkk7QUFDSTtBQUNJO0FBQ0E7QUE4Qlo7QUE1QlE7QUE4QlI7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBNUJBO0FBQ0k7QUFDUTtBQThCWjtBQTVCUTtBQThCUjtBQTVCSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUE4Qlo7QUE1QlE7QUE4QlI7QUFDQTtBQTVCSTtBQThCSjtBQUNBO0FBQ0E7QUE1QkE7QUFDSTtBQUNBO0FBOEJKO0FBQ0E7QUE1QkE7QUE4QkE7QUFDQTtBQTlCSTtBQUNJO0FBZ0NSO0FBOUJJO0FBZ0NKO0FBQ0E7QUE5QkE7QUFnQ0E7QUFDQTtBQUNBO0FBakNJO0FBQ0E7QUFDSTtBQW1DUjtBQWpDUTtBQUNBO0FBQ0E7QUFDSTtBQW1DWjtBQUNBO0FBakNRO0FBQ0k7QUFtQ1o7QUFDQTtBQWpDUTtBQW1DUjtBQUNBO0FBakNJO0FBbUNKO0FBQ0E7QUFDQTtBQWpDQTtBQW1DQTtBQWpDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFtQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6eURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQUNBO0FBRFE7QUFDQTtBQUdSO0FBRFE7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUdwQjtBQUNBO0FBQ0E7QUFDQTtBQURRO0FBR1I7QUFDQTtBQURJO0FBR0o7QUFEUTtBQUdSO0FBRFE7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUdWO0FBRFU7QUFHVjtBQUNBO0FBRFE7QUFDQTtBQUNFO0FBQ0E7QUFHVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakVBO0FBQ0U7QUFDQTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNJO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ047QUFDSTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFBSTtBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQUk7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNFO0FBQ0U7QUFFSjtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0U7QUFDRTtBQUdKO0FBQ0E7QUFGSTtBQUlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0U7QUFDRTtBQUlKO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQ0U7QUFDRTtBQUtKO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0U7QUFDRTtBQU1KO0FBQ0E7QUFKRTtBQUNFO0FBTUo7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0U7QUFDRTtBQU1KO0FBQ0E7QUFKRTtBQUNFO0FBTUo7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQU5RO0FBQ0k7QUFRWjtBQU5RO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBTlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUVI7QUFOUTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBTmdCO0FBQ0k7QUFRcEI7QUFOZ0I7QUFRaEI7QUFMZ0I7QUFDQTtBQUNJO0FBQ0E7QUFPcEI7QUFMZ0I7QUFPaEI7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNFO0FBQ0U7QUFNSjtBQUNBO0FBSkU7QUFDRTtBQU1KO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNZO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBR0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUdJO0FBREo7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQURRO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUdSO0FBRFE7QUFDSTtBQUNJO0FBR2hCO0FBQ0E7QUFEWTtBQUNJO0FBR2hCO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUdSO0FBRFE7QUFDQTtBQUNJO0FBR1o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQUNBO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFHUjtBQURRO0FBQ0E7QUFDSTtBQUdaO0FBRFE7QUFDSTtBQUdaO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEWTtBQUdaO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDSTtBQUVaO0FBQWdCO0FBRWhCO0FBQVk7QUFDQTtBQUVaO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuT0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBQ0E7QUFHWTtBQURaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFDQTtBQUVRO0FBQ0k7QUFDSTtBQUFoQjtBQUVnQjtBQUFoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNNO0FBQ047QUFDTTtBQUNFO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDRTtBQUNFO0FBQ1Y7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ1U7QUFDVjtBQUNBO0FBQ1E7QUFDRTtBQUNBO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFvRDtBQUU1RDtBQURRO0FBQWtFO0FBSTFFO0FBSFE7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQW9EO0FBTTVEO0FBTFE7QUFBa0U7QUFRMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEk7QUFDSTtBQUNJO0FBU1o7QUFDQTtBQVBRO0FBU1I7QUFQSTtBQUNJO0FBQ0k7QUFTWjtBQVBRO0FBQ0k7QUFTWjtBQVBZO0FBQ0k7QUFTaEI7QUFQZ0I7QUFTaEI7QUFDQTtBQUNBO0FBUEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBU1o7QUFDQTtBQVBRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUFE7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQVNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBU1o7QUFDQTtBQVBRO0FBQ0E7QUFTUjtBQUNBO0FBUEk7QUFTSjtBQUNBO0FBVFE7QUFDSTtBQVdaO0FBVFE7QUFDSTtBQVdaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUSTtBQUNJO0FBQ0k7QUFXWjtBQUNBO0FBVFE7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQVdKO0FBQ0E7QUFYUTtBQUNJO0FBYVo7QUFDQTtBQVhRO0FBQ0k7QUFhWjtBQUNBO0FBWEk7QUFDSTtBQUNJO0FBYVo7QUFYUTtBQUNLO0FBYWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhJO0FBQ0k7QUFhUjtBQVhRO0FBQ0k7QUFhWjtBQUNBO0FBQ0E7QUFDQTtBQVhJO0FBQ0k7QUFhUjtBQUNBO0FBWEk7QUFDSTtBQUNJO0FBYVo7QUFYUTtBQUNJO0FBYVo7QUFYUTtBQUNBO0FBYVI7QUFDQTtBQVhJO0FBQ0k7QUFhUjtBQUNBO0FBWEk7QUFhSjtBQUNBO0FBYlE7QUFDSTtBQWVaO0FBQ0E7QUFiUTtBQUNBO0FBZVI7QUFDQTtBQWJJO0FBQ0k7QUFDSTtBQWVaO0FBQ0E7QUFiUTtBQUNBO0FBZVI7QUFDQTtBQUNBO0FBYkk7QUFDSTtBQUNJO0FBZVo7QUFDQTtBQWJRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFiZ0I7QUFlaEI7QUFDQTtBQVpRO0FBQ0k7QUFjWjtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBVlE7QUFZUjtBQVZRO0FBWVI7QUFWUTtBQVlSO0FBVlk7QUFZWjtBQVZZO0FBWVo7QUFWeUQ7QUFZekQ7QUFDQTtBQVhRO0FBYVI7QUFYUTtBQUE4QztBQWN0RDtBQWQ0RztBQWdCNUc7QUFDQTtBQWZRO0FBaUJSO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQWZnQjtBQWlCaEI7QUFmZ0I7QUFpQmhCO0FBZmdCO0FBaUJoQjtBQWZvQjtBQUFVO0FBa0I5QjtBQUNBO0FBakJvQjtBQW1CcEI7QUFqQm9CO0FBbUJwQjtBQWpCb0I7QUFtQnBCO0FBakJvQjtBQW1CcEI7QUFDQTtBQWhCZ0I7QUFrQmhCO0FBQ0E7QUFmWTtBQWlCWjtBQUNBO0FBZlE7QUFDQTtBQUNBO0FBaUJSO0FBZlE7QUFpQlI7QUFmUTtBQUNBO0FBQ0E7QUFpQlI7QUFDQTtBQWZRO0FBQ0E7QUFDQTtBQWlCUjtBQUNBO0FBZlE7QUFDQTtBQWlCUjtBQWRRO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFnQlo7QUFiWTtBQWVaO0FBQ0E7QUFDQTtBQVpJO0FBY0o7QUFaUTtBQWNSO0FBWlE7QUFjUjtBQVpRO0FBY1I7QUFaUTtBQWNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBY2hCO0FBWmdCO0FBY2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkk7QUFDSTtBQUNJO0FBY1o7QUFaUTtBQUNBO0FBQ0E7QUFDQTtBQWNSO0FBQ0E7QUFaUTtBQUNBO0FBQ0E7QUFDQTtBQUF5QztBQWVqRDtBQWRRO0FBQXVDO0FBaUIvQztBQWhCUTtBQWtCUjtBQUNBO0FBaEJRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUF5QztBQW1CakQ7QUFsQlE7QUFBdUM7QUFxQi9DO0FBcEJRO0FBc0JSO0FBcEJRO0FBQ0E7QUFzQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkJJO0FBQ0k7QUFDSTtBQXFCWjtBQUNBO0FBbkJRO0FBcUJSO0FBbkJRO0FBcUJSO0FBbkJRO0FBQStDO0FBc0J2RDtBQUNBO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJZO0FBdUJaO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQXJCZ0I7QUF1QmhCO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQXJCZ0I7QUF1QmhCO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQUNBO0FBcEJZO0FBc0JaO0FBQ0E7QUFDQTtBQUNBO0FBbEJJO0FBQ0k7QUFDSTtBQW9CWjtBQUNBO0FBbEJRO0FBQ0E7QUFvQlI7QUFDQTtBQWxCSTtBQUNJO0FBQ0k7QUFvQlo7QUFDQTtBQWxCUTtBQUNBO0FBb0JSO0FBQ0E7QUFsQkk7QUFDSTtBQUNJO0FBb0JaO0FBQ0E7QUFsQlE7QUFDQTtBQW9CUjtBQUNBO0FBbEJJO0FBQ0k7QUFDSTtBQW9CWjtBQWxCUTtBQUNBO0FBb0JSO0FBQ0E7QUFsQkk7QUFDSTtBQUNJO0FBb0JaO0FBbEJRO0FBQ0E7QUFvQlI7QUFsQlE7QUFvQlI7QUFDQTtBQWxCSTtBQUNJO0FBb0JSO0FBQ0E7QUFsQkk7QUFDSTtBQW9CUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQU07QUFDQTtBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQU07QUFFTjtBQUFNO0FBQ0E7QUFDQTtBQUNBO0FBRU47QUFBVTtBQUVWO0FBQVE7QUFFUjtBQUNBO0FBQUk7QUFDRTtBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNoQjtBQUVnQjtBQUNBO0FBQ0E7QUFBaEI7QUFDQTtBQUVRO0FBQVI7QUFDWTtBQUNJO0FBQ0E7QUFDQTtBQUNoQjtBQUVnQjtBQUNBO0FBQ0E7QUFBaEI7QUFFWTtBQUFaO0FBQ0E7QUFFSTtBQUFKO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDSTtBQUNaO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFBWTtBQUNBO0FBRVo7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUFNO0FBQ0U7QUFDQTtBQUVSO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBRFk7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFFSjtBQURNO0FBQ0E7QUFDQTtBQUdOO0FBREk7QUFHSjtBQUZNO0FBQ0E7QUFDRTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBSVY7QUFGUTtBQUNFO0FBSVY7QUFGUTtBQUlSO0FBQ0E7QUFGSTtBQUlKO0FBSE07QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBS1I7QUFIUTtBQUNBO0FBS1I7QUFITTtBQUtOO0FBSEk7QUFLSjtBQUNBO0FBSEk7QUFDRTtBQUtOO0FBSE07QUFDQTtBQUtOO0FBSE07QUFDQTtBQUtOO0FBSE07QUFDQTtBQUtOO0FBQ0E7QUFISTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBS1I7QUFDQTtBQUhNO0FBQ0U7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUhJO0FBS0o7QUFESTtBQUNFO0FBQ0U7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0xBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDQTtBQUdJO0FBQ0U7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0o7QUFDTTtBQUNFO0FBQ0E7QUFDQTtBQUNSO0FBQ007QUFDTjtBQUNJO0FBQ0E7QUFDRTtBQUNFO0FBQ1I7QUFDTTtBQUNBO0FBQ0U7QUFDUjtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDTTtBQUNBO0FBQ047QUFBUTtBQUVSO0FBQU07QUFFTjtBQUFNO0FBQ0U7QUFFUjtBQUFNO0FBQ0E7QUFDRTtBQUNFO0FBRVY7QUFDQTtBQUFNO0FBRU47QUFBSTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBRVI7QUFDQTtBQUFNO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0M7QUFDQztBQUNBO0FBRUY7QUFBRztBQUNDO0FBQ0E7QUFDQTtBQUVKO0FBQUc7QUFFSDtBQUFFO0FBQ0E7QUFDQztBQUNDO0FBRUo7QUFBRztBQUNBO0FBQ0M7QUFFSjtBQUFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBRUo7QUFBSztBQUNBO0FBRUw7QUFETTtBQUdOO0FBQ0E7QUFDQTtBQURHO0FBQ0E7QUFDQTtBQUNDO0FBR0o7QUFERztBQUNBO0FBQ0M7QUFDQztBQUdMO0FBQ0E7QUFERztBQUdIO0FBREU7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUdKO0FBQ0E7QUFERztBQUdIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSEE7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNFO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNFO0FBQ0E7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQURSO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBREo7QUFDQTtBQUdZO0FBQ0E7QUFDQTtBQUNBO0FBRFo7QUFDQTtBQUNBO0FBR1k7QUFEWjtBQUdZO0FBQ0k7QUFEaEI7QUFHWTtBQUNJO0FBRGhCO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDQTtBQUNJO0FBQVE7QUFBeUI7QUFBa0I7QUFDM0M7QUFBMEI7QUFBa0I7QUFFeEQ7QUFFUjtBQUNBO0FBQUk7QUFFSjtBQURRO0FBQ0k7QUFDSTtBQUdoQjtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUdKO0FBRFE7QUFHUjtBQURRO0FBR1I7QUFEUTtBQUErQztBQUl2RDtBQUNBO0FBSFE7QUFLUjtBQUhJO0FBS0o7QUFIWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS1o7QUFIWTtBQUNJO0FBS2hCO0FBSFk7QUFDSTtBQUtoQjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFBK0I7QUFNdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBQ0E7QUFBK0M7QUFRdkQ7QUFDQTtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFE7QUFTUjtBQVBRO0FBU1I7QUFQUTtBQVNSO0FBUFk7QUFTWjtBQVBZO0FBU1o7QUFQWTtBQVNaO0FBUGdCO0FBU2hCO0FBQ0E7QUFOZ0I7QUFRaEI7QUFDQTtBQUxZO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUtKO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFIUTtBQUErQztBQU12RDtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBQStEO0FBUXZFO0FBQ0E7QUFQUTtBQUE4RDtBQVV0RTtBQUNBO0FBVFE7QUFBNEQ7QUFZcEU7QUFDQTtBQVhRO0FBQTBEO0FBY2xFO0FBQ0E7QUFiUTtBQWVSO0FBYnlEO0FBZXpEO0FBZnlHO0FBaUJ6RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmUTtBQUNBO0FBaUJSO0FBZlE7QUFpQlI7QUFmWTtBQWlCWjtBQWZZO0FBaUJaO0FBZlk7QUFpQlo7QUFmWTtBQWlCWjtBQUNBO0FBaEJZO0FBQ0k7QUFrQmhCO0FBaEJvQjtBQWtCcEI7QUFoQm9CO0FBa0JwQjtBQWhCb0I7QUFrQnBCO0FBaEJ3QjtBQWtCeEI7QUFoQndCO0FBa0J4QjtBQWhCd0I7QUFrQnhCO0FBaEI0QjtBQWtCNUI7QUFoQjRCO0FBa0I1QjtBQWhCNEI7QUFrQjVCO0FBaEI0QjtBQWtCNUI7QUFoQjRCO0FBa0I1QjtBQWhCNEI7QUFrQjVCO0FBQ0E7QUFDQTtBQUNBO0FBZGdCO0FBZ0JoQjtBQWRnQjtBQWdCaEI7QUFkb0I7QUFnQnBCO0FBZG9CO0FBZ0JwQjtBQWRvQjtBQWdCcEI7QUFkb0I7QUFnQnBCO0FBZG9CO0FBZ0JwQjtBQWR3QjtBQWdCeEI7QUFkd0I7QUFnQnhCO0FBQ0E7QUFDQTtBQWJnQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFlNUI7QUFiNEI7QUFlNUI7QUFid0I7QUFDSTtBQWU1QjtBQUNBO0FBYm9CO0FBQ0k7QUFDQTtBQWV4QjtBQUNBO0FBQ0E7QUFiZ0I7QUFDSTtBQUNBO0FBQ0E7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFDQTtBQUNBO0FBWlk7QUFjWjtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBQ0E7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFk7QUFhWjtBQVhnQjtBQWFoQjtBQVhnQjtBQWFoQjtBQVhnQjtBQWFoQjtBQVhnQjtBQWFoQjtBQUNBO0FBQ0E7QUFUUTtBQVdSO0FBVFE7QUFXUjtBQVRRO0FBV1I7QUFUUTtBQVdSO0FBQ0E7QUFSSTtBQUNJO0FBQ0E7QUFVUjtBQUNBO0FBUkk7QUFDSTtBQUNJO0FBVVo7QUFSWTtBQUNJO0FBVWhCO0FBQ0E7QUFSa0I7QUFVbEI7QUFDQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBUkk7QUFDRTtBQUNJO0FBVVY7QUFDQTtBQVJVO0FBVVY7QUFDQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJnQjtBQUNJO0FBQ0E7QUFFSTtBQUVJO0FBUTVCO0FBTndCO0FBRUk7QUFPNUI7QUFDQTtBQUxvQjtBQU9wQjtBQUNBO0FBTGdCO0FBQ0k7QUFPcEI7QUFMb0I7QUFDSTtBQU94QjtBQUNBO0FBTG9CO0FBT3BCO0FBQ0E7QUFDQTtBQUNBO0FBTmdCO0FBUWhCO0FBTm9CO0FBUXBCO0FBQ0E7QUFDQTtBQU5vQjtBQUNJO0FBUXhCO0FBQ0E7QUFOb0I7QUFDSTtBQUNJO0FBUTVCO0FBTjRCO0FBUTVCO0FBQ0E7QUFDQTtBQU5vQjtBQVFwQjtBQUNBO0FBTmdCO0FBQ0k7QUFRcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTm9CO0FBQ0k7QUFReEI7QUFDQTtBQU5vQjtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBUXhCO0FBTndCO0FBQ0k7QUFDQTtBQVE1QjtBQU53QjtBQUNJO0FBUTVCO0FBQ0E7QUFDQTtBQU5vQjtBQVFwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5RO0FBQ0E7QUFRUjtBQU5RO0FBQ0E7QUFDSTtBQVFaO0FBQ0E7QUFOUTtBQVFSO0FBTlE7QUFRUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JnQkE7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDRTtBQUNBO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFDRTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNFO0FBRFI7QUFDQTtBQUdNO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRE47QUFHTTtBQUNBO0FBQ0E7QUFETjtBQUNBO0FBR0k7QUFDRTtBQUNBO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkRBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFDRTtBQURWO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUdRO0FBQ0U7QUFEVjtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBRFY7QUFDQTtBQUNBO0FBR1E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQURWO0FBQ0E7QUFDQTtBQUdRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBR1E7QUFDRTtBQURWO0FBQ0E7QUFHUTtBQUNFO0FBRFY7QUFDQTtBQUdJO0FBQ0U7QUFETjtBQUNBO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUdRO0FBQ0E7QUFDRTtBQURWO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFLSTtBQUNJO0FBSFI7QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFLSTtBQUNFO0FBSE47QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUdBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUdRO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQURaO0FBR1E7QUFDSTtBQUNJO0FBRGhCO0FBQ0E7QUFHUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBRFo7QUFHUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEWjtBQUNBO0FBSUk7QUFGSjtBQUdRO0FBRFI7QUFjSTtBQVpKO0FBYVE7QUFYUjtBQXdCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0QlI7QUFDQTtBQXdCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQXRCWjtBQXdCWTtBQXRCWjtBQUNBO0FBd0JRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0QlI7QUF3QlE7QUFDQTtBQUNBO0FBQ0E7QUF0QlI7QUFDQTtBQXNCUTtBQXBCUjtBQXNCUTtBQXBCUjtBQXNCUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcEJaO0FBc0JRO0FBQ0k7QUFwQlo7QUFzQlE7QUFDSTtBQXBCWjtBQXNCUTtBQUdBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQXRCaEI7QUF3Qlk7QUFDSTtBQXRCaEI7QUFDQTtBQUNBO0FBd0JRO0FBQ0E7QUF0QlI7QUFDQTtBQXlCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUF2Qlo7QUF5QlE7QUFDSTtBQUNBO0FBQ0E7QUF2Qlo7QUF5QlE7QUF2QlI7QUF3Qlk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQXRCaEI7QUF3Qlk7QUFDSTtBQUNBO0FBdEJoQjtBQUNBO0FBeUJRO0FBQ0k7QUF2Qlo7QUF5QlE7QUFDSTtBQXZCWjtBQXlCUTtBQUNBO0FBdkJSO0FBQ0E7QUEwQkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBeEJaO0FBMEJRO0FBQ0k7QUF4Qlo7QUEyQlk7QUF6Qlo7QUE0Qlk7QUExQlo7QUE2Qlk7QUEzQlo7QUE2QlE7QUFDSTtBQUNBO0FBM0JaO0FBNkJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzQmhCO0FBNkJnQjtBQTNCaEI7QUFDQTtBQTZCUTtBQUNBO0FBM0JSO0FBQ0E7QUFDQTtBQThCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJSO0FBOEJRO0FBNUJSO0FBQ0E7QUE0QlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCWjtBQTRCUTtBQUNJO0FBMUJaO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUExQmhCO0FBNEJZO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCaEI7QUFDQTtBQTRCUTtBQUNBO0FBMUJSO0FBQ0E7QUE0Qkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBMUJSO0FBQ0E7QUFDQTtBQTRCSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCUjtBQTRCUTtBQUNJO0FBMUJaO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBMUJaO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBMUJoQjtBQUNBO0FBNEJRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCWjtBQTRCUTtBQUNBO0FBMUJSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6WEE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0k7QUFDSjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBRFE7QUFDSTtBQUFRO0FBQVk7QUFDWjtBQUFZO0FBQ1o7QUFBWTtBQUNaO0FBQVk7QUFFeEI7QUFDSTtBQUFRO0FBQVk7QUFDWjtBQUFZO0FBQ1o7QUFBWTtBQUV4QjtBQUNJO0FBQVE7QUFDUjtBQUFRO0FBQVk7QUFFeEI7QUFZUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFETjtBQUdNO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFEVjtBQUdRO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDSztBQUNHO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ1E7QUFDUjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEdBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDWjtBQUNRO0FBQ0M7QUFDVDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ2hCO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDSTtBQUNJO0FBRFo7QUFHUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBRHBCO0FBR29CO0FBQ0E7QUFEcEI7QUFHb0I7QUFDQTtBQURwQjtBQUdnQjtBQUNBO0FBQ0k7QUFEcEI7QUFDQTtBQUdRO0FBQ0k7QUFEWjtBQUNBO0FBR1k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQURwQjtBQUdnQjtBQUNBO0FBRGhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBRlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZFQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUtBO0FBQ0k7QUFIUjtBQUtJO0FBQ0k7QUFDQTtBQUNFO0FBSFY7QUFLUTtBQUhSO0FBS0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBSGhCO0FBS1k7QUFDQTtBQUNBO0FBSFo7QUFDQTtBQUtJO0FBSEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Y7QUFFRTtBQUNFO0FBQ0E7QUFDRTtBQUFOO0FBRUk7QUFBSjtBQUNBO0FBRUU7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUFOO0FBRUk7QUFBSjtBQUNBO0FBRUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQU47QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUNNO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNFO0FBQ047QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQU07QUFDRTtBQUNBO0FBRVI7QUFDQTtBQUNBO0FBQUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVGO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ1Y7QUFDVTtBQUNFO0FBQ0E7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNBO0FBQ0U7QUFDTjtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBQ047QUFFTTtBQUFOO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFHRTtBQUNFO0FBREo7QUFHSTtBQUNFO0FBRE47QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqVkE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ1E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNoQjtBQUNZO0FBQ0k7QUFDaEI7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ1o7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUNRO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDQTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ0k7QUFDQTtBQUNoQjtBQUNZO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDaEI7QUFDQTtBQUNZO0FBQ0k7QUFDaEI7QUFDQTtBQUNnQjtBQUNBO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNBO0FBQ1k7QUFDSTtBQUNoQjtBQUNBO0FBQ2dCO0FBQ0E7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBRVE7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVZO0FBQ0E7QUFBWjtBQUNBO0FBQ0E7QUFHSTtBQURKO0FBQ0E7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUFZO0FBQ0k7QUFFaEI7QUFBWTtBQUVaO0FBQVk7QUFDSTtBQUVoQjtBQUFZO0FBQ0E7QUFFWjtBQUNBO0FBRFk7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUdaO0FBRFE7QUFDSTtBQUdaO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ0k7QUFHeEI7QUFDQTtBQUNBO0FBQ0E7QUFEZ0I7QUFDSTtBQUNJO0FBR3hCO0FBQ0E7QUFDQTtBQUNBO0FBQVE7QUFDQTtBQUVSO0FBQVE7QUFFUjtBQUFJO0FBQ0k7QUFDSTtBQUVaO0FBQ0E7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFEUTtBQUdSO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUNFO0FBQ0E7QUFHUjtBQUNBO0FBRE07QUFDQTtBQUdOO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFIUTtBQUNJO0FBS1o7QUFITTtBQUtOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBSVI7QUFGUTtBQUlSO0FBSFk7QUFLWjtBQUhRO0FBS1I7QUFIUTtBQUNBO0FBQ0E7QUFDQTtBQUtSO0FBSFE7QUFLUjtBQUNBO0FBSFE7QUFDQTtBQUNJO0FBS1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBS1I7QUFDQTtBQUZJO0FBSUo7QUFGUTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUlSO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFJUjtBQUNBO0FBRkk7QUFJSjtBQUZRO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFJSjtBQUZNO0FBQ0U7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUZRO0FBQ0k7QUFJWjtBQUNBO0FBSFk7QUFLWjtBQUhRO0FBS1I7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNJO0FBSVo7QUFGTTtBQUNFO0FBQ0E7QUFJUjtBQUNBO0FBQ0E7QUFGTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUlkO0FBQ0E7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUlSO0FBQ0E7QUFGSTtBQUNJO0FBSVI7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBQ0U7QUFDQTtBQUlWO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFJUjtBQUZRO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUlaO0FBRmdCO0FBQ0E7QUFJaEI7QUFDQTtBQUNBO0FBRlE7QUFDSTtBQUNJO0FBQ0E7QUFJaEI7QUFGZ0I7QUFJaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZJO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBRkk7QUFDRTtBQUNJO0FBQ0E7QUFJVjtBQUZNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJTjtBQUNBO0FBRkk7QUFDRTtBQUNJO0FBSVY7QUFDQTtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBSWhCO0FBQ0E7QUFDQTtBQUZRO0FBQ0k7QUFDQTtBQUNBO0FBSVo7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFJWjtBQUZRO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNJO0FBSVo7QUFDQTtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBRUk7QUFDQTtBQUNJO0FBR2hCO0FBQ0E7QUFDQTtBQURRO0FBQ0k7QUFDQTtBQUNBO0FBR1o7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFHWjtBQURRO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUdaO0FBRFk7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3cUJBO0FBQ0k7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNBO0FBQ1E7QUFDUjtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQU07QUFDQTtBQUVOO0FBQU07QUFDRTtBQUNBO0FBRVI7QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNFO0FBQ0E7QUFFRTtBQUNWO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ1Y7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUZBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNNO0FBQ0E7QUFDRTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNBO0FBRUU7QUFBVjtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQ0U7QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFSTtBQUNBO0FBQUo7QUFFUTtBQUNBO0FBQ0E7QUFBUjtBQUVRO0FBQ0E7QUFDQTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBRVk7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBRVE7QUFDQTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFWTtBQUFaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVvQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQXhCO0FBRW9CO0FBQ0k7QUFDSTtBQUNBO0FBQTVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR29CO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFEeEI7QUFHb0I7QUFDSTtBQUNJO0FBQ0E7QUFENUI7QUFDQTtBQUNBO0FBQ0E7QUFJYztBQUNBO0FBRmQ7QUFDQTtBQUNBO0FBQ0E7QUFJYztBQUNJO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFGeEI7QUFJc0I7QUFDQTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFGOUI7QUFJOEI7QUFGOUI7QUFJNEI7QUFGNUI7QUFJNEI7QUFGNUI7QUFDQTtBQUNBO0FBSWtCO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFGdEI7QUFLc0I7QUFDQTtBQUh0QjtBQUtvQjtBQUNFO0FBSHRCO0FBS3NCO0FBQ0E7QUFIdEI7QUFDQTtBQU1vQjtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFKaEM7QUFNZ0M7QUFKaEM7QUFNOEI7QUFKOUI7QUFNOEI7QUFKOUI7QUFDQTtBQU13QjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBSmxDO0FBQ0E7QUFLc0M7QUFDQTtBQUNJO0FBQ0E7QUFIMUM7QUFDQTtBQUNBO0FBS2dDO0FBSGhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBSHBCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQU1RO0FBQ0k7QUFDQTtBQUNJO0FBSmhCO0FBTVk7QUFDSTtBQUpoQjtBQU1ZO0FBSlo7QUFDQTtBQU1RO0FBQ0E7QUFFSTtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBTmhCO0FBU2dCO0FBUGhCO0FBVWdCO0FBUmhCO0FBQ0E7QUFVUTtBQVJSO0FBVUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSUjtBQVVJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFSWjtBQVVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQVJaO0FBVVk7QUFDRTtBQUNFO0FBUmhCO0FBQ0E7QUFDQTtBQUNBO0FBV2U7QUFUZjtBQVVtQjtBQUNBO0FBQ0c7QUFSdEI7QUFVc0I7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQVIxQjtBQVV3QjtBQUNBO0FBUnhCO0FBQ0E7QUFVb0I7QUFDRDtBQUNLO0FBUnhCO0FBV3dCO0FBVHhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVlRO0FBVlI7QUFZUTtBQUNHO0FBQ0E7QUFDQTtBQVZYO0FBV2U7QUFUZjtBQUNBO0FBV1E7QUFUUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBY0k7QUFFSTtBQUNBO0FBQ0E7QUFiUjtBQWVRO0FBQ0E7QUFiUjtBQWVRO0FBQ0E7QUFFSTtBQUNBO0FBQ0E7QUFkWjtBQUNBO0FBZ0JRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFkaEI7QUFpQmdCO0FBQ0E7QUFDQTtBQUNBO0FBZmhCO0FBa0JnQjtBQUNBO0FBQ0E7QUFDQTtBQWhCaEI7QUFtQmdCO0FBQ0E7QUFDQTtBQUNBO0FBakJoQjtBQW9CZ0I7QUFDQztBQUNEO0FBQ0E7QUFsQmhCO0FBb0JnQjtBQUNDO0FBQ0Q7QUFDQTtBQWxCaEI7QUFDQTtBQW9CUztBQUVJO0FBQ0k7QUFuQmpCO0FBQ0E7QUFDQTtBQXFCSTtBQUNJO0FBQ0E7QUFDQTtBQW5CUjtBQXFCSTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFuQlI7QUFDQTtBQXFCSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBbkJOO0FBQ0E7QUFxQlE7QUFuQlI7QUFxQk07QUFDRTtBQUNBO0FBbkJSO0FBcUJNO0FBbkJOO0FBcUJJO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBK0I7QUFsQnpDO0FBbUJVO0FBQ0E7QUFDQTtBQUNBO0FBakJWO0FBQ0E7QUFtQkk7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQWpCaEI7QUFtQlk7QUFDQTtBQWpCWjtBQW1CWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakJaO0FBQ0E7QUFtQkk7QUFDRTtBQUNFO0FBQ0E7QUFqQlI7QUFtQk07QUFDQTtBQWpCTjtBQUNBO0FBbUJJO0FBQ0k7QUFDQTtBQUNBO0FBakJSO0FBQ0E7QUFtQkk7QUFDSTtBQWpCUjtBQW1CUTtBQWpCUjtBQUNBO0FBbUJJO0FBQ0U7QUFqQk47QUFDQTtBQW1CSTtBQUNJO0FBakJSO0FBQ0E7QUFtQkk7QUFqQko7QUFtQlE7QUFDQTtBQWpCUjtBQW1CUTtBQWpCUjtBQUNBO0FBbUJJO0FBQ0k7QUFDSTtBQUNBO0FBakJaO0FBQ0E7QUFDQTtBQUNBO0FBb0JnQjtBQUNBO0FBbEJoQjtBQUNBO0FBQ0E7QUFvQlE7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQWxCVjtBQW9CUTtBQWxCUjtBQW9CWTtBQWxCWjtBQW9CVTtBQUNFO0FBbEJaO0FBQ0E7QUFtQlk7QUFqQlo7QUFDQTtBQUNBO0FBQ0E7QUFvQkk7QUFFSTtBQUNBO0FBbkJSO0FBQ0E7QUFxQkk7QUFuQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXFCUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFuQlI7QUFDQTtBQXNCSTtBQUNJO0FBQ0U7QUFDRTtBQXBCWjtBQXNCWTtBQUNBO0FBcEJaO0FBc0JRO0FBQ0E7QUFDQTtBQXBCUjtBQUNBO0FBc0JRO0FBQ0E7QUFwQlI7QUFDQTtBQXNCSTtBQUNJO0FBQ0k7QUFwQlo7QUFDQTtBQUNBO0FBc0JJO0FBQ0k7QUFwQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ2psQkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1Q0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ1M7QUFDVDtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ3BCO0FBQ29CO0FBQ3BCO0FBQ2dCO0FBQ2hCO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSjtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFHUjtBQURRO0FBQ0k7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQURRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUdaO0FBQ0E7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUdaO0FBQ0E7QUFEWTtBQUdaO0FBQ0E7QUFBUTtBQUVSO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ1o7QUFBZ0I7QUFDQTtBQUNBO0FBRWhCO0FBRG9CO0FBQ0k7QUFHeEI7QUFEd0I7QUFHeEI7QUFDQTtBQURvQjtBQUdwQjtBQUNBO0FBQ0E7QUFGZ0I7QUFDQTtBQUloQjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBSVo7QUFGUztBQUlUO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUlSO0FBRlE7QUFDQTtBQUlSO0FBRlE7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUlwQjtBQUNBO0FBRlk7QUFDQTtBQUlaO0FBQ0E7QUFDQTtBQUZJO0FBSUo7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlSO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlSO0FBRlE7QUFDQTtBQUNBO0FBSVI7QUFGUTtBQUNBO0FBQ0E7QUFJUjtBQUZRO0FBQ0k7QUFDSTtBQUloQjtBQUZZO0FBQ0k7QUFJaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUVKO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFDQTtBQUVRO0FBQ0k7QUFBWjtBQUNBO0FBRVE7QUFBUjtBQUVRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVo7QUFDQTtBQUVRO0FBQXlCO0FBQ2pDO0FBQ0E7QUFBUTtBQUNJO0FBQ0k7QUFFaEI7QUFDQTtBQUNBO0FBQVE7QUFFUjtBQUFRO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQVk7QUFFWjtBQUFZO0FBRVo7QUFBWTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUFaO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQURKO0FBRVE7QUFBUjtBQUNZO0FBQ0k7QUFDaEI7QUFDZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUFRO0FBRVI7QUFEWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBR1I7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBQ0E7QUFHWjtBQUNBO0FBRFE7QUFDSTtBQUdaO0FBRGdCO0FBR2hCO0FBRFk7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUTtBQUNJO0FBQ0k7QUFDQTtBQUdoQjtBQURnQjtBQUdoQjtBQURZO0FBR1o7QUFEUTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBR2hCO0FBRGdCO0FBR2hCO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBRVI7QUFBSztBQUVMO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFWjtBQUFZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFWjtBQUFZO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFFaEI7QUFDQTtBQUFZO0FBQ0k7QUFDSTtBQUVwQjtBQUFnQjtBQUNJO0FBRXBCO0FBQ0E7QUFDQTtBQUFRO0FBQ0s7QUFFYjtBQUFZO0FBQ0k7QUFFaEI7QUFDQTtBQUFnQjtBQUVoQjtBQUNBO0FBQ0E7QUFDQTtBQUFJO0FBRUo7QUFBUTtBQUNJO0FBQ0E7QUFFWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBRVo7QUFDQTtBQURZO0FBQ0E7QUFHWjtBQUNBO0FBQ0E7QUFESTtBQUdKO0FBRFE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1o7QUFEUTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBRFk7QUFDQTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQURZO0FBQ0E7QUFDQTtBQUdaO0FBRFk7QUFDSTtBQUdoQjtBQUNBO0FBRGdCO0FBQ0E7QUFHaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNJO0FBR1o7QUFEWTtBQUdaO0FBRFk7QUFHWjtBQURRO0FBR1I7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUhRO0FBS1I7QUFIUTtBQUNBO0FBQ0E7QUFLUjtBQUNBO0FBSEk7QUFDSTtBQUtSO0FBSEk7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUt4QjtBQUo0QjtBQUNBO0FBQ0k7QUFNaEM7QUFKZ0M7QUFNaEM7QUFDQTtBQUo0QjtBQU01QjtBQUxnQztBQU9oQztBQUxnQztBQU9oQztBQUNBO0FBTDRCO0FBQ0E7QUFDQTtBQUNBO0FBTzVCO0FBQ0E7QUFKd0I7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQU01QjtBQUo0QjtBQUNJO0FBTWhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpnQjtBQU1oQjtBQUxvQjtBQUNJO0FBT3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFPUjtBQU5ZO0FBUVo7QUFQZ0I7QUFFSTtBQUNBO0FBUXBCO0FBTm9CO0FBUXBCO0FBQ0E7QUFMZ0I7QUFPaEI7QUFDQTtBQUxZO0FBQ0k7QUFPaEI7QUFMZ0I7QUFPaEI7QUFDQTtBQUxZO0FBQ0E7QUFPWjtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBT0o7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBQ0k7QUFDQTtBQU9aO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQUFxQztBQVE3QztBQUNBO0FBUFE7QUFTUjtBQVBZO0FBU1o7QUFQWTtBQVNaO0FBUFk7QUFDSTtBQUNBO0FBU2hCO0FBQ0E7QUFDQTtBQUNBO0FBTlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVFSO0FBTlE7QUFRUjtBQU5RO0FBUVI7QUFOUTtBQVFSO0FBTlE7QUFDSTtBQUNBO0FBQ0k7QUFRaEI7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0k7QUFPWjtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFMUTtBQU9SO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUxRO0FBT1I7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNJO0FBT1o7QUFMWTtBQU9aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0k7QUFPWjtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFDQTtBQUNBO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPUjtBQUxRO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQU9oQjtBQUNBO0FBTFE7QUFDQTtBQUNBO0FBT1I7QUFDQTtBQUNBO0FBTFE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQU9oQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMWTtBQU9aO0FBTFE7QUFPUjtBQUxRO0FBQ0E7QUFDSTtBQUNBO0FBT1o7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBT1I7QUFDQTtBQUNBO0FBTEk7QUFPSjtBQUxRO0FBQ0k7QUFDSTtBQUNBO0FBT2hCO0FBSmdCO0FBQ0E7QUFNaEI7QUFIZ0I7QUFDQTtBQUtoQjtBQUZnQjtBQUNBO0FBSWhCO0FBRGdCO0FBQ0E7QUFHaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEZ0I7QUFHaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFHSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFHSjtBQUNBO0FBQ0E7QUFIUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFLWjtBQUhZO0FBS1o7QUFIUTtBQUNBO0FBQ0E7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUtKO0FBSFE7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUNBO0FBSFE7QUFLUjtBQUNBO0FBSFE7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIWTtBQUtaO0FBQ0E7QUFDQTtBQUhnQjtBQUNJO0FBS3BCO0FBQ0E7QUFDQTtBQUNBO0FBSFE7QUFDSTtBQUNJO0FBQ0E7QUFLaEI7QUFIWTtBQUtaO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBTFE7QUFDQTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQUxRO0FBT1I7QUFMUTtBQUNBO0FBT1I7QUFDQTtBQUNBO0FBTFk7QUFDSTtBQU9oQjtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBT1I7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQU9SO0FBTEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT1I7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBRO0FBQ0E7QUFDSTtBQVNaO0FBUFE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBU2hCO0FBUFk7QUFTWjtBQVBZO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTaEI7QUFDQTtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBUVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5nQjtBQVFoQjtBQU5ZO0FBQ0E7QUFRWjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBUVo7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFRaEI7QUFOWTtBQVFaO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDSTtBQUNBO0FBT1o7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9SO0FBTFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT1I7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQU5nQjtBQUNJO0FBUXBCO0FBQ0E7QUFDQTtBQVBnQjtBQUNJO0FBU3BCO0FBUndCO0FBVXhCO0FBUndCO0FBVXhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSUTtBQUNJO0FBVVo7QUFUZ0I7QUFXaEI7QUFUZ0I7QUFXaEI7QUFDQTtBQUNBO0FBVFE7QUFXUjtBQVZZO0FBWVo7QUFYZ0I7QUFDQTtBQWFoQjtBQUNBO0FBWmdCO0FBQ0E7QUFjaEI7QUFDQTtBQUNBO0FBWlk7QUFjWjtBQWJnQjtBQUNBO0FBZWhCO0FBQ0E7QUFiZ0I7QUFDQTtBQWVoQjtBQUNBO0FBQ0E7QUFiUTtBQUNJO0FBZVo7QUFiUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFlaEI7QUFDQTtBQWJRO0FBQ0k7QUFDSTtBQWVoQjtBQWJnQjtBQWVoQjtBQUNBO0FBWlk7QUFjWjtBQVpRO0FBQ0E7QUFDQTtBQWNSO0FBQ0E7QUFaSTtBQUNJO0FBRUk7QUFhWjtBQUNBO0FBWFE7QUFBcUM7QUFjN0M7QUFDQTtBQWJRO0FBZVI7QUFiUTtBQWVSO0FBYlE7QUFBc0Q7QUFnQjlEO0FBQ0E7QUFmUTtBQWlCUjtBQWZZO0FBaUJaO0FBQ0E7QUFkUTtBQWdCUjtBQWRRO0FBZ0JSO0FBZFE7QUFnQlI7QUFkUTtBQWdCUjtBQWRZO0FBZ0JaO0FBQ0E7QUFDQTtBQVpJO0FBY0o7QUFaUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBY1I7QUFaSTtBQUNJO0FBY1I7QUFDQTtBQUNBO0FBWkk7QUFjSjtBQVpRO0FBQ0k7QUFDQTtBQWNaO0FBQ0E7QUFaUTtBQUNBO0FBQ0E7QUFjUjtBQVpRO0FBQ0k7QUFjWjtBQUNBO0FBQ0E7QUFaSTtBQUNJO0FBQ0E7QUFjUjtBQVpRO0FBQ0k7QUFjWjtBQUNBO0FBWlE7QUFjUjtBQVpRO0FBQ0k7QUFjWjtBQVpRO0FBY1I7QUFaSTtBQUNJO0FBQ0E7QUFjUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWlE7QUFDSTtBQUNJO0FBY2hCO0FBQ0E7QUFDQTtBQUNBO0FBWkk7QUFjSjtBQUNBO0FBQ0E7QUFDQTtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYUTtBQWFSO0FBWFE7QUFhUjtBQVhRO0FBYVI7QUFYWTtBQWFaO0FBWFk7QUFhWjtBQVhZO0FBYVo7QUFYWTtBQUF5RDtBQWNyRTtBQUNBO0FBYlk7QUFlWjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQWJnQjtBQWVoQjtBQUNBO0FBZG9CO0FBZ0JwQjtBQUNBO0FBYm9CO0FBZXBCO0FBQ0E7QUFiZ0I7QUFlaEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFib0I7QUFlcEI7QUFDQTtBQUNBO0FBVlk7QUFZWjtBQVZZO0FBWVo7QUFWZ0I7QUFZaEI7QUFWb0I7QUFZcEI7QUFWb0I7QUFZcEI7QUFDQTtBQUNBO0FBQ0E7QUFSUTtBQVVSO0FBUlk7QUFVWjtBQVJZO0FBVVo7QUFSWTtBQVVaO0FBUlk7QUFVWjtBQVJZO0FBVVo7QUFSZ0I7QUFVaEI7QUFDQTtBQVRvQjtBQVdwQjtBQVRvQjtBQVdwQjtBQUNBO0FBVGdCO0FBV2hCO0FBQ0E7QUFSZ0I7QUFVaEI7QUFDQTtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBUVo7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUxZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQU9SO0FBTFE7QUFDSTtBQU9aO0FBQ0E7QUFMUTtBQUNBO0FBT1I7QUFDQTtBQUxJO0FBT0o7QUFMUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBT1I7QUFMSTtBQUNJO0FBQ0E7QUFDSTtBQU9aO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBT1I7QUFMUTtBQU9SO0FBQ0E7QUFMUTtBQUNJO0FBQ0E7QUFPWjtBQUNBO0FBTFE7QUFDQTtBQU9SO0FBTFk7QUFPWjtBQUNBO0FBTFE7QUFPUjtBQUNBO0FBTFE7QUFDSTtBQUNBO0FBT1o7QUFDQTtBQUpRO0FBTVI7QUFDQTtBQUNBO0FBQ0E7QUFKWTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBTWhCO0FBQ0E7QUFKWTtBQU1aO0FBSlk7QUFNWjtBQUNBO0FBSlE7QUFDQTtBQUNBO0FBTVI7QUFDQTtBQUpRO0FBTVI7QUFDQTtBQUpRO0FBQ0E7QUFDQTtBQU1SO0FBQ0E7QUFKUTtBQUNJO0FBQ0k7QUFNaEI7QUFDQTtBQUpZO0FBTVo7QUFDQTtBQUpRO0FBQ0k7QUFDQTtBQU1aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQU1SO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBSlE7QUFNUjtBQUpZO0FBTVo7QUFDQTtBQUpRO0FBTVI7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDSTtBQUNJO0FBTWhCO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQU1SO0FBQ0E7QUFKSTtBQUNJO0FBTVI7QUFKUTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFDQTtBQU1SO0FBSlE7QUFDQTtBQU1SO0FBSlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNJO0FBTVo7QUFDQTtBQUpRO0FBQ0E7QUFDSTtBQUNBO0FBTVo7QUFDQTtBQUNBO0FBSkk7QUFDSTtBQUNBO0FBTVI7QUFDQTtBQUpZO0FBTVo7QUFKWTtBQU1aO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0k7QUFNWjtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBQ0k7QUFLWjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFLUjtBQUhRO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFDSTtBQUtaO0FBQ0E7QUFIUTtBQUtSO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFDQTtBQUhRO0FBQ0k7QUFLWjtBQUhRO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFLUjtBQUNBO0FBSEk7QUFLSjtBQUhRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFLWjtBQUhRO0FBQ0k7QUFLWjtBQUNBO0FBSFk7QUFDSTtBQUtoQjtBQUhZO0FBQ0E7QUFDQTtBQUtaO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNJO0FBQ0E7QUFLWjtBQUNBO0FBSFE7QUFDSTtBQUNBO0FBS1o7QUFIUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtSO0FBQ0E7QUFIUTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBUTtBQUFtQjtBQUNuQjtBQUFtQjtBQUNuQjtBQUFtQjtBQUNuQjtBQUFtQjtBQUUvQjtBQUNJO0FBQVE7QUFBb0I7QUFDcEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDakI7QUFBbUI7QUFDbkI7QUFBb0I7QUFDcEI7QUFBb0I7QUFDcEI7QUFBb0I7QUFFakM7QUFzQlo7QUFDQTtBQXBCUTtBQUNJO0FBc0JaO0FBcEJZO0FBc0JaO0FBcEJZO0FBc0JaO0FBcEJRO0FBQ0k7QUFzQlo7QUFwQlk7QUFzQlo7QUFDQTtBQXBCUTtBQXNCUjtBQUNBO0FBQ0E7QUFDQTtBQXBCSTtBQUNJO0FBQ0k7QUFzQlo7QUFDQTtBQXBCUTtBQXNCUjtBQUNBO0FBQ0E7QUFwQkk7QUFDSTtBQUNJO0FBc0JaO0FBQ0E7QUFwQlE7QUFDSTtBQXNCWjtBQUNBO0FBcEJRO0FBc0JSO0FBQ0E7QUFDQTtBQXBCSTtBQUNJO0FBQ0k7QUFzQlo7QUFDQTtBQXBCUTtBQXNCUjtBQUNBO0FBbkJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBcUJaO0FBQ0E7QUFuQlE7QUFDQTtBQUFzRDtBQXNCOUQ7QUFyQlE7QUFDQTtBQUNJO0FBQ0E7QUF1Qlo7QUFDQTtBQUNBO0FBckJJO0FBdUJKO0FBckJRO0FBQ0k7QUFDQTtBQXVCWjtBQUNBO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJZO0FBdUJaO0FBckJnQjtBQXVCaEI7QUFyQmdCO0FBdUJoQjtBQUNBO0FBQ0E7QUFwQlE7QUFzQlI7QUFwQlk7QUFzQlo7QUFwQmdCO0FBc0JoQjtBQXBCZ0I7QUFzQmhCO0FBQ0E7QUFuQlE7QUFDQTtBQXFCUjtBQW5CUTtBQUErQjtBQXNCdkM7QUFDQTtBQXJCUTtBQUErQjtBQXdCdkM7QUFDQTtBQXZCUTtBQUNJO0FBQStCO0FBMEIzQztBQUNBO0FBQ0E7QUF4QlE7QUEwQlI7QUF4QlE7QUEwQlI7QUF4Qlk7QUEwQlo7QUF4Qlk7QUEwQlo7QUFDQTtBQXZCUTtBQXlCUjtBQXZCUTtBQXlCUjtBQXZCUTtBQXlCUjtBQXZCUTtBQXlCUjtBQXZCUTtBQXlCUjtBQXZCUTtBQXlCUjtBQXZCWTtBQXlCWjtBQXZCZ0I7QUF5QmhCO0FBQ0E7QUF0Qlk7QUF3Qlo7QUF0Qlk7QUF3Qlo7QUFDQTtBQXJCUTtBQXVCUjtBQXJCWTtBQXVCWjtBQXJCZ0I7QUF1QmhCO0FBckJvQjtBQXVCcEI7QUFDQTtBQXBCZ0I7QUFzQmhCO0FBQ0E7QUFDQTtBQWxCUTtBQW9CUjtBQWxCUTtBQW9CUjtBQWxCWTtBQUErQjtBQXFCM0M7QUFDQTtBQXBCWTtBQXNCWjtBQUNBO0FBcEJRO0FBQ0k7QUFzQlo7QUFDQTtBQUNBO0FBcEJRO0FBc0JSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5CSTtBQUNJO0FBQXVFO0FBc0IvRTtBQUNBO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBdUJSO0FBckJRO0FBQXFDO0FBd0I3QztBQUNBO0FBdkJRO0FBeUJSO0FBQ0E7QUF4Qlk7QUEwQlo7QUF4Qlk7QUEwQlo7QUF2QmdCO0FBeUJoQjtBQXZCZ0I7QUF5QmhCO0FBdkJnQjtBQXlCaEI7QUF2QmdCO0FBQ0E7QUFDSTtBQXlCcEI7QUFDQTtBQXZCZ0I7QUF5QmhCO0FBdkJnQjtBQXlCaEI7QUFDQTtBQUNBO0FBckJRO0FBQXFDO0FBd0I3QztBQUNBO0FBdkJRO0FBeUJSO0FBQ0E7QUF4Qlk7QUFBcUM7QUEyQmpEO0FBQ0E7QUExQlk7QUE0Qlo7QUExQlk7QUE0Qlo7QUFDQTtBQTNCZ0I7QUE2QmhCO0FBM0JnQjtBQTZCaEI7QUEzQmdCO0FBNkJoQjtBQUNBO0FBNUJvQjtBQThCcEI7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUE1QndCO0FBOEJ4QjtBQUNBO0FBM0JvQjtBQTZCcEI7QUFDQTtBQTFCZ0I7QUE0QmhCO0FBMUJnQjtBQTRCaEI7QUFDQTtBQXpCWTtBQTJCWjtBQXpCWTtBQTJCWjtBQUNBO0FBMUJnQjtBQTRCaEI7QUExQmdCO0FBNEJoQjtBQTFCZ0I7QUE0QmhCO0FBQ0E7QUF6Qlk7QUEyQlo7QUF6Qlk7QUFBaUM7QUE0QjdDO0FBQ0E7QUEzQlk7QUE2Qlo7QUFDQTtBQTVCZ0I7QUE4QmhCO0FBNUJnQjtBQThCaEI7QUE1Qm9CO0FBOEJwQjtBQTVCb0I7QUE4QnBCO0FBNUJvQjtBQThCcEI7QUFDQTtBQUNBO0FBNUJvQjtBQThCcEI7QUFDQTtBQTdCd0I7QUErQnhCO0FBQ0E7QUE3QjRCO0FBK0I1QjtBQTdCNEI7QUErQjVCO0FBN0I0QjtBQStCNUI7QUE3QjRCO0FBK0I1QjtBQTdCNEI7QUErQjVCO0FBN0I0QjtBQStCNUI7QUFDQTtBQTVCd0I7QUE4QnhCO0FBQ0E7QUFDQTtBQUNBO0FBM0JvQjtBQTZCcEI7QUFDQTtBQUNBO0FBekJZO0FBMkJaO0FBQ0E7QUFDQTtBQUNBO0FBMUJnQjtBQTRCaEI7QUExQmdCO0FBQStDO0FBNkIvRDtBQUNBO0FBQ0E7QUExQlk7QUE0Qlo7QUFDQTtBQTNCZ0I7QUFBcUM7QUE4QnJEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExQkk7QUE0Qko7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUExQlE7QUE0QlI7QUFDQTtBQTFCSTtBQTRCSjtBQUNBO0FBQ0E7QUFDQTtBQTlCUTtBQUNBO0FBQ0E7QUFDQTtBQWdDUjtBQTlCUTtBQUNJO0FBZ0NaO0FBQ0E7QUE5QlE7QUFnQ1I7QUFDQTtBQUNBO0FBOUJRO0FBZ0NSO0FBOUJZO0FBQ0k7QUFnQ2hCO0FBQ0E7QUE5Qlk7QUFDQTtBQUNBO0FBQ0k7QUFnQ2hCO0FBOUJvQjtBQUErQjtBQWlDbkQ7QUFDQTtBQWhDb0I7QUFrQ3BCO0FBQ0E7QUE5Qm9CO0FBQStCO0FBaUNuRDtBQUNBO0FBaENvQjtBQWtDcEI7QUFDQTtBQTlCb0I7QUFBK0I7QUFpQ25EO0FBQ0E7QUFoQ29CO0FBa0NwQjtBQUNBO0FBL0JvQjtBQUErQjtBQWtDbkQ7QUFDQTtBQWpDb0I7QUFtQ3BCO0FBQ0E7QUEvQm9CO0FBQStCO0FBa0NuRDtBQUNBO0FBakNvQjtBQW1DcEI7QUFDQTtBQUNBO0FBQ0E7QUFoQ1E7QUFrQ1I7QUFoQ1k7QUFrQ1o7QUFoQ1k7QUFDSTtBQUNJO0FBQ0k7QUFrQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBL0JZO0FBQ0k7QUFDSTtBQWlDcEI7QUFDQTtBQUNBO0FBQ0E7QUEvQlE7QUFpQ1I7QUFDQTtBQS9CSTtBQWlDSjtBQUNBO0FBN0JJO0FBQ0k7QUFDQTtBQStCUjtBQTdCUTtBQStCUjtBQUNBO0FBQ0E7QUFDQTtBQTdCSTtBQStCSjtBQUNBO0FBL0JRO0FBQ0k7QUFpQ1o7QUFDQTtBQS9CUTtBQUNJO0FBQ0E7QUFDQTtBQWlDWjtBQS9CUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFpQ1o7QUEvQlE7QUFDQTtBQWlDUjtBQUNBO0FBL0JJO0FBQ0k7QUFDSTtBQWlDWjtBQUNBO0FBQ0E7QUEvQkk7QUFDSTtBQUNBO0FBQ0k7QUFpQ1o7QUFDQTtBQS9CUTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBaUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBL0JJO0FBaUNKO0FBQ0E7QUFqQ1E7QUFDSTtBQUNBO0FBQ0E7QUFtQ1o7QUFqQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBbUNaO0FBakNRO0FBQ0E7QUFtQ1I7QUFDQTtBQWpDSTtBQUNJO0FBQ0k7QUFtQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBbUNSO0FBakNZO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSztBQW1DekI7QUFqQ29CO0FBQ0E7QUFtQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFoQ2dCO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWtDcEI7QUFDQTtBQUNBO0FBaENRO0FBQ0k7QUFDQTtBQUNJO0FBa0NoQjtBQWhDWTtBQWtDWjtBQWhDWTtBQWtDWjtBQUNBO0FBaENZO0FBQ0E7QUFrQ1o7QUFoQ1E7QUFDSTtBQUNBO0FBQ0k7QUFrQ2hCO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBQ0E7QUFoQ1k7QUFDQTtBQWtDWjtBQWhDUTtBQUNJO0FBQ0E7QUFDQTtBQWtDWjtBQUNBO0FBaENJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQWtDWjtBQUNBO0FBaENRO0FBQ0k7QUFDQTtBQUNJO0FBa0NoQjtBQWhDWTtBQWtDWjtBQUNBO0FBaENRO0FBQ0E7QUFrQ1I7QUEvQlE7QUFDSTtBQWlDWjtBQUNBO0FBL0JRO0FBQ0k7QUFDQTtBQUNJO0FBaUNoQjtBQS9CWTtBQWlDWjtBQUNBO0FBL0JJO0FBQ0k7QUFDSTtBQWlDWjtBQUNBO0FBaENZO0FBQ0E7QUFrQ1o7QUFDQTtBQUNBO0FBaENJO0FBQ0k7QUFDSTtBQWtDWjtBQUNBO0FBakNZO0FBQ0E7QUFtQ1o7QUFDQTtBQUNBO0FBakNJO0FBbUNKO0FBakNRO0FBQ0k7QUFtQ1o7QUFDQTtBQWxDWTtBQW9DWjtBQUNBO0FBQ0E7QUFDQTtBQWxDSTtBQUNJO0FBQ0k7QUFvQ1o7QUFsQ1E7QUFvQ1I7QUFsQ1E7QUFvQ1I7QUFsQ1E7QUFvQ1I7QUFsQ1E7QUFvQ1I7QUFsQ1E7QUFBeUQ7QUFxQ2pFO0FBQ0E7QUFwQ1E7QUFzQ1I7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFwQ1k7QUFzQ1o7QUFDQTtBQXJDZ0I7QUF1Q2hCO0FBQ0E7QUFwQ2dCO0FBc0NoQjtBQUNBO0FBcENZO0FBc0NaO0FBcENnQjtBQXNDaEI7QUFwQ2dCO0FBc0NoQjtBQXBDZ0I7QUFzQ2hCO0FBQ0E7QUFuQ1k7QUFxQ1o7QUFuQ2dCO0FBcUNoQjtBQUNBO0FBbENnQjtBQW9DaEI7QUFDQTtBQUNBO0FBakNRO0FBbUNSO0FBakNRO0FBbUNSO0FBakNRO0FBbUNSO0FBakNZO0FBQ0k7QUFDQTtBQW1DaEI7QUFDQTtBQUNBO0FBaENRO0FBa0NSO0FBaENRO0FBa0NSO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBaENZO0FBa0NaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWhDWTtBQWtDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlCSTtBQUNJO0FBQ0E7QUFnQ1I7QUFDQTtBQUNBO0FBOUJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBZ0NaO0FBOUJRO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCSTtBQWdDSjtBQUNBO0FBQ0E7QUE5QlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCSTtBQWdDSjtBQUNBO0FBQ0E7QUE5QlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCSTtBQUNJO0FBQ0k7QUFnQ1o7QUFDQTtBQTlCUTtBQUNBO0FBZ0NSO0FBQ0E7QUFDQTtBQTlCSTtBQUNJO0FBQ0E7QUFDSTtBQWdDWjtBQUNBO0FBOUJRO0FBZ0NSO0FBOUJRO0FBQ0k7QUFDQTtBQUNBO0FBZ0NaO0FBQ0E7QUFDQTtBQUNBO0FBOUJJO0FBQ0k7QUFDQTtBQUNJO0FBZ0NaO0FBOUJRO0FBZ0NSO0FBOUJRO0FBZ0NSO0FBOUJZO0FBZ0NaO0FBQ0E7QUFDQTtBQTVCSTtBQUNJO0FBQ0k7QUE4Qlo7QUFDQTtBQUNBO0FBNUJJO0FBQ0k7QUFDQTtBQUNJO0FBOEJaO0FBNUJRO0FBOEJSO0FBQ0E7QUE1Qkk7QUFDSTtBQUNBO0FBQ0k7QUE4Qlo7QUE1QlE7QUE4QlI7QUFDQTtBQTVCSTtBQUNJO0FBOEJSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Qkk7QUFDSTtBQUNBO0FBQ0k7QUE4Qlo7QUE1QlE7QUFDQTtBQThCUjtBQUNBO0FBNUJJO0FBQ0k7QUFDQTtBQThCUjtBQUNBO0FBQ0E7QUE1QlE7QUFDSTtBQThCWjtBQTNCWTtBQTZCWjtBQTFCWTtBQTRCWjtBQXpCWTtBQTJCWjtBQXpCUTtBQTJCUjtBQUNBO0FBekJJO0FBQ0k7QUFDQTtBQUNBO0FBMkJSO0FBQ0E7QUF6Qkk7QUFDSTtBQUNBO0FBQ0k7QUEyQlo7QUF6QlE7QUFDSTtBQTJCWjtBQXpCUTtBQUNBO0FBMkJSO0FBQ0E7QUF6Qkk7QUFDSTtBQUNBO0FBQ0E7QUEyQlI7QUFDQTtBQXpCSTtBQUNJO0FBQ0E7QUFDSTtBQTJCWjtBQXhCWTtBQTBCWjtBQXZCWTtBQXlCWjtBQXZCUTtBQUNBO0FBeUJSO0FBQ0E7QUFDQTtBQXZCSTtBQXlCSjtBQUNBO0FBQ0E7QUF2Qkk7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQXlCWjtBQUNBO0FBdkJRO0FBQ0k7QUFDQTtBQUNBO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQUNJO0FBQ0E7QUF5Qlo7QUFDQTtBQXZCUTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXlCUjtBQXZCUTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQXlCUjtBQUNBO0FBQ0E7QUF2Qkk7QUFDSTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUFDSTtBQUNBO0FBeUJaO0FBdkJZO0FBQ0E7QUF5Qlo7QUFDQTtBQXZCUTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUF5QmhCO0FBQ0E7QUFDQTtBQXZCUTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUF5QlI7QUFDQTtBQXZCSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUF5Qlo7QUF2QlE7QUF5QlI7QUF2QlE7QUFDQTtBQUNJO0FBeUJaO0FBQ0E7QUF2QlE7QUFDQTtBQXlCUjtBQUNBO0FBQ0E7QUF2QkE7QUFDSTtBQXlCSjtBQXZCQTtBQXlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL2lHQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQURKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDTTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBQ0E7QUFFSTtBQUNJO0FBQVI7QUFDQTtBQUVJO0FBQ0U7QUFDQTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFTTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFBUjtBQUNBO0FBRUs7QUFDRztBQUFSO0FBRVE7QUFDSTtBQUNBO0FBQ0E7QUFBWjtBQUVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUFaO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFDQTtBQUFaO0FBQ0E7QUFFUTtBQUNJO0FBQ0E7QUFBWjtBQUNBO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ2hCO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQVE7QUFBaUI7QUFDakI7QUFBa0I7QUFDbEI7QUFBa0I7QUFDbEI7QUFBa0I7QUFFOUI7QUFLUjtBQUNBO0FBSEk7QUFLSjtBQUpRO0FBQ0k7QUFDSTtBQU1oQjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBTFE7QUFDSTtBQUNJO0FBT2hCO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEk7QUFPSjtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SkE7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQXlDO0FBRWpEO0FBRFk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBR1o7QUFBWTtBQUVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RLQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0U7QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUFZO0FBRVo7QUFBUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUVoQjtBQUFnQjtBQUVoQjtBQUFZO0FBQ0k7QUFFaEI7QUFDQTtBQUNBO0FBQVE7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFFcEI7QUFBZ0I7QUFDQTtBQUVoQjtBQURvQjtBQUdwQjtBQUNBO0FBRGdCO0FBQ0E7QUFDQTtBQUdoQjtBQURnQjtBQUNBO0FBR2hCO0FBRm9CO0FBSXBCO0FBQ0E7QUFIb0I7QUFLcEI7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUVBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0NBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNZO0FBQ1o7QUFDWTtBQUNaO0FBQ1E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNoQjtBQUVnQjtBQUFoQjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFHUTtBQUNJO0FBQ0k7QUFDQTtBQURoQjtBQUlnQjtBQUNBO0FBRmhCO0FBS2dCO0FBQ0E7QUFIaEI7QUFLWTtBQUNJO0FBSGhCO0FBS1k7QUFIWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBR0E7QUFDSTtBQUNBO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBWjtBQUVZO0FBQVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoREE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNaO0FBQ1E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNoQjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDWTtBQUNJO0FBQ0k7QUFDQTtBQUNwQjtBQUNnQjtBQUNBO0FBQ0E7QUFDSTtBQUNwQjtBQUF3QjtBQUNBO0FBRXhCO0FBQ0E7QUFBZ0I7QUFFaEI7QUFBZ0I7QUFDQTtBQUNBO0FBRWhCO0FBQ0E7QUFBUTtBQUNJO0FBQ0E7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBZ0I7QUFFaEI7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEdBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUdBO0FBQ0k7QUFDQTtBQURaO0FBR1E7QUFDSTtBQUNBO0FBRFo7QUFHUTtBQUNJO0FBQ0E7QUFEWjtBQUNBO0FBQ0E7QUFHUTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFDQTtBQUdRO0FBQ0k7QUFEWjtBQUdRO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBR1E7QUFDSTtBQURaO0FBQ0E7QUFHUTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDSjtBQUNJO0FBQ0E7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDQTtBQUNBO0FBQ0o7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNFO0FBQ0Y7QUFDSTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNOO0FBQ0k7QUFDSjtBQUNJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDSTtBQUNKO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDTTtBQUNBO0FBQ047QUFDTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDTTtBQUNBO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ007QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUVNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQVY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVFO0FBQUY7QUFJRTtBQUZGO0FBTUU7QUFKRjtBQVFFO0FBTkY7QUFVRTtBQVJGO0FBWUU7QUFWRjtBQWNFO0FBWkY7QUFjSTtBQUNBO0FBQ0E7QUFDRTtBQVpOO0FBQ0E7QUFDQTtBQUNBO0FBY0U7QUFaRjtBQWNJO0FBQ0E7QUFaSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBY0U7QUFDRTtBQUNBO0FBQ0U7QUFaTjtBQWNJO0FBWko7QUFDQTtBQWNJO0FBQ0E7QUFDQTtBQVpKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFjRTtBQUNFO0FBQ0E7QUFDRTtBQVpOO0FBY0k7QUFaSjtBQUNBO0FBY0k7QUFDQTtBQUNBO0FBWko7QUFjSTtBQUNFO0FBWk47QUFDQTtBQUNBO0FBQ0E7QUFjRTtBQUNFO0FBWko7QUFDQTtBQUNBO0FBY0U7QUFaRjtBQWNJO0FBQ0E7QUFaSjtBQUNBO0FBY0U7QUFDRTtBQVpKO0FBY0k7QUFDRTtBQUNBO0FBQ0E7QUFaTjtBQUNBO0FBY0k7QUFDRTtBQUNFO0FBWlI7QUFDQTtBQWNNO0FBWk47QUFDQTtBQUNBO0FBY0U7QUFaRjtBQUNBO0FBWUk7QUFDRTtBQVZOO0FBQ0E7QUFZSTtBQUNFO0FBVk47QUFDQTtBQVlJO0FBQ0U7QUFDRTtBQVZSO0FBQ0E7QUFhSTtBQVhKO0FBQ0E7QUFhRTtBQVhGO0FBQ0E7QUFXSTtBQUNBO0FBQ0E7QUFUSjtBQVdJO0FBVEo7QUFDQTtBQUNBO0FBV0U7QUFDRTtBQUNFO0FBVE47QUFDQTtBQVdJO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQVRWO0FBQ0E7QUFDQTtBQVdNO0FBVE47QUFDQTtBQUNBO0FBQ0E7QUFXRTtBQUNFO0FBVEo7QUFDQTtBQVdFO0FBQ0U7QUFUSjtBQUNBO0FBV0U7QUFDRTtBQUNFO0FBQ0E7QUFUTjtBQUNBO0FBQ0E7QUFDQTtBQVdFO0FBQ0U7QUFUSjtBQUNBO0FBQ0E7QUFXRTtBQUNFO0FBQ0E7QUFUSjtBQVdJO0FBVEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRGO0FBV0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEY7QUFXRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFURjtBQUNBO0FBQ0E7QUFDQTtBQVlBO0FBQ0U7QUFWRjtBQUNBO0FBWUE7QUFDRTtBQUNBO0FBVkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYUE7QUFDRTtBQUNBO0FBWEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWFBO0FBQ0U7QUFDQTtBQVhGO0FBQ0E7QUFDQTtBQWFBO0FBQ0U7QUFDQTtBQVhGO0FBYUU7QUFDQTtBQVhGO0FBQ0E7QUFhQTtBQUNDO0FBQ0c7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQUNBO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFDQTtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBQ0E7QUFhQTtBQUNFO0FBQ0E7QUFYRjtBQWFFO0FBQ0U7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQUNBO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFDQTtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBQ0E7QUFDQTtBQWFBO0FBQ0U7QUFDQTtBQUNFO0FBWEo7QUFDQTtBQWFFO0FBWEY7QUFDQTtBQWFBO0FBWEE7QUFDQTtBQWFFO0FBQ0U7QUFDQTtBQVhKO0FBYUU7QUFYRjtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBWEo7QUFhRTtBQVhGO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFYSjtBQWFFO0FBWEY7QUFhQTtBQVhBO0FBQ0E7QUFXRTtBQUNBO0FBVEY7QUFXRTtBQUNFO0FBVEo7QUFDQTtBQVdFO0FBQ0U7QUFDQTtBQVRKO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBVEo7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNFO0FBVEo7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBVEo7QUFDQTtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0k7QUFDQTtBQUNFO0FBVE47QUFDQTtBQVdJO0FBVEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBVEE7QUFDQTtBQVNFO0FBQ0E7QUFDRTtBQUNBO0FBUEo7QUFDQTtBQVNFO0FBUEY7QUFXSTtBQUNBO0FBQ0U7QUFUTjtBQUNBO0FBV0k7QUFUSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBVE47QUFDQTtBQVdJO0FBVEo7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNFO0FBVEo7QUFDQTtBQVdFO0FBVEY7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQVRKO0FBQ0E7QUFXRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBV0U7QUFURjtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0U7QUFUSjtBQUNBO0FBV0U7QUFURjtBQUNBO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDRTtBQVRKO0FBQ0E7QUFXRTtBQVRGO0FBQ0E7QUFDQTtBQVdBO0FBQ0k7QUFDQTtBQUNFO0FBVE47QUFDQTtBQVdJO0FBVEo7QUFZTTtBQUNBO0FBQ0U7QUFWUjtBQVlNO0FBQ0E7QUFDQTtBQVZOO0FBQ0E7QUFDQTtBQVlBO0FBQ0k7QUFDRTtBQVZOO0FBQ0E7QUFZSTtBQVZKO0FBQ0E7QUFDQTtBQVlBO0FBQ0k7QUFDRTtBQUNBO0FBVk47QUFDQTtBQVlJO0FBVko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNXVCQTtBQUNBO0FBQ0k7QUFBa0M7QUFFdEM7QUFDQTtBQURJO0FBR0o7QUFESTtBQUdKO0FBREk7QUFHSjtBQURJO0FBQWtDO0FBSXRDO0FBQ0E7QUFISTtBQUFrQztBQU10QztBQUNBO0FBTEk7QUFPSjtBQUNBO0FBTlE7QUFBaUM7QUFTekM7QUFDQTtBQVJRO0FBVVI7QUFDQTtBQVJRO0FBVVI7QUFSWTtBQVVaO0FBUlk7QUFVWjtBQUNBO0FBUFE7QUFTUjtBQVBZO0FBU1o7QUFQZ0I7QUFTaEI7QUFQZ0I7QUFTaEI7QUFDQTtBQUNBO0FBTlE7QUFBbUM7QUFTM0M7QUFDQTtBQUNBO0FBQ0E7QUFQUTtBQUFpQztBQVV6QztBQUNBO0FBVFE7QUFXUjtBQUNBO0FBVFE7QUFXUjtBQVRZO0FBV1o7QUFUWTtBQVdaO0FBQ0E7QUFUUTtBQVdSO0FBVFk7QUFXWjtBQVRnQjtBQVdoQjtBQVRnQjtBQVdoQjtBQUNBO0FBQ0E7QUFSUTtBQUFrQztBQVcxQztBQUNBO0FBUlE7QUFBaUM7QUFXekM7QUFDQTtBQVZRO0FBWVI7QUFWUTtBQVlSO0FBVlk7QUFZWjtBQVZZO0FBWVo7QUFDQTtBQVRRO0FBV1I7QUFUWTtBQVdaO0FBVGdCO0FBV2hCO0FBVGdCO0FBV2hCO0FBQ0E7QUFSUTtBQUFrQztBQVcxQztBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBVkk7QUFBaUM7QUFhckM7QUFaSTtBQWNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hIQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFJSTtBQUZKO0FBSVE7QUFGUjtBQUlRO0FBRlI7QUFJUTtBQUZSO0FBSVE7QUFGUjtBQUlRO0FBRlI7QUFJUTtBQUZSO0FBSVE7QUFGUjtBQUlRO0FBRlI7QUFJWTtBQUZaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFETTtBQUdOO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFITTtBQUtOO0FBSEk7QUFLSjtBQUhNO0FBS047QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQVBRO0FBQ0k7QUFTWjtBQU5ZO0FBUVo7QUFDQTtBQU5JO0FBQ0U7QUFRTjtBQU5JO0FBUUo7QUFDQTtBQVJNO0FBVU47QUFDQTtBQVJJO0FBQ0U7QUFVTjtBQUNBO0FBQ0E7QUFKTTtBQUNFO0FBQ0U7QUFNVjtBQUNBO0FBSlE7QUFDQTtBQU1SO0FBQ0E7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQU5NO0FBUU47QUFOUTtBQVFSO0FBQ0E7QUFOTTtBQVFOO0FBQ0E7QUFOSTtBQVFKO0FBQ0E7QUFSTTtBQVVOO0FBQ0E7QUFSSTtBQVVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZNO0FBWU47QUFDQTtBQVZJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQVlSO0FBQ0E7QUFDQTtBQVZJO0FBQ0U7QUFDQTtBQUNFO0FBWVI7QUFDQTtBQUNBO0FBQ0E7QUFWSTtBQVlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlJQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNLO0FBQ0c7QUFDQTtBQUNBO0FBQ1I7QUFDUztBQUNBO0FBQ0k7QUFDYjtBQUVhO0FBQWI7QUFHYTtBQURiO0FBSWE7QUFGYjtBQUlTO0FBQ0E7QUFDSTtBQUZiO0FBS2E7QUFIYjtBQU1hO0FBSmI7QUFPYTtBQUxiO0FBQ0E7QUFPUztBQUNJO0FBTGI7QUFPUztBQUxUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIOe7mSBBcnJheSDmt7vliqDmlrnms5VcclxuLy8gYXJyLmZpbmQoLi4uKVxyXG4vLyBhcnIuZmluZEluZGV4KC4uLilcclxuLy8gYXJyLmluY2x1ZGVzKGUpXHJcbi8vIGFyci51bmlxdWUoZXF1YWxGdW5jdGlvbiwgaXNOZXdBcnJheSlcclxuLy8gQXJyYXkuZnJvbVxyXG4vLyBBcnJheS5lcXVhbFxyXG4vLyBhcnIuaXNFcXVhbChvdGhlckFycmF5LCBpc1N0cmljdClcclxuLy8gQXJyYXkuc29ydEJ5TnVtYmVyXHJcbi8vIGFyci5maW5kU3ViQXJyYXlJbmRleHMoW10pICAg55So5LqO5p+l5om+5pWw57uE5YaF55qE6YOo5YiG5YWD57Sg55qE57Si5byVXHJcbi8vIGFyci50cmFuc2xhdGlvbldpdGhTdGFydEluZGV4KHN0YXJ0SW5kZXgpIOWwhuaVsOe7hOWGheeahOWFg+e0oOW5s+enu1xyXG4vLyDlpoLvvJpbMSwgMiwgMywgNCwgNV0udHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleCgzKSA9PiBbNCw1LDEsMiwzXVxyXG4vLyBhcnIua3FfaW5zZXJ0KGluZGV4LCBlKSAgIOaPkuWFpeS4gOS4quWFg+e0oFxyXG4vLyBhcnIua3FfZXhjbHVkZXMoYXJyYXkpICAgLy8g6Zmk5LqGYXJyYXnmlbDnu4TkuK3nmoTlhYPntKBcclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHt9O1xyXG5cclxuaWYgKCFBcnJheS5wcm90b3R5cGUuZmluZCkge1xyXG4gIEFycmF5LnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBpZiAodGhpcyA9PSBudWxsKSB7XHJcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FycmF5LnByb3RvdHlwZS5maW5kIGNhbGxlZCBvbiBudWxsIG9yIHVuZGVmaW5lZCcpO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBwcmVkaWNhdGUgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigncHJlZGljYXRlIG11c3QgYmUgYSBmdW5jdGlvbicpO1xyXG4gICAgfVxyXG4gICAgdmFyIGxpc3QgPSBPYmplY3QodGhpcyk7XHJcbiAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGggPj4+IDA7XHJcbiAgICB2YXIgdGhpc0FyZyA9IGFyZ3VtZW50c1sxXTtcclxuICAgIHZhciB2YWx1ZTtcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHZhbHVlID0gbGlzdFtpXTtcclxuICAgICAgaWYgKHByZWRpY2F0ZS5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpLCBsaXN0KSkge1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICB9O1xyXG59XHJcblxyXG5pZiAoIUFycmF5LnByb3RvdHlwZS5maW5kSW5kZXgpIHtcclxuICBBcnJheS5wcm90b3R5cGUuZmluZEluZGV4ID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7XHJcbiAgICBpZiAodGhpcyA9PT0gbnVsbCkge1xyXG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcnJheS5wcm90b3R5cGUuZmluZEluZGV4IGNhbGxlZCBvbiBudWxsIG9yIHVuZGVmaW5lZCcpO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBwcmVkaWNhdGUgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigncHJlZGljYXRlIG11c3QgYmUgYSBmdW5jdGlvbicpO1xyXG4gICAgfVxyXG4gICAgdmFyIGxpc3QgPSBPYmplY3QodGhpcyk7XHJcbiAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGggPj4+IDA7XHJcbiAgICB2YXIgdGhpc0FyZyA9IGFyZ3VtZW50c1sxXTtcclxuICAgIHZhciB2YWx1ZTtcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHZhbHVlID0gbGlzdFtpXTtcclxuICAgICAgaWYgKHByZWRpY2F0ZS5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpLCBsaXN0KSkge1xyXG4gICAgICAgIHJldHVybiBpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gLTE7XHJcbiAgfTtcclxufVxyXG5cclxuXHJcbi8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS5pbmNsdWRlc1xyXG5pZiAoIUFycmF5LnByb3RvdHlwZS5pbmNsdWRlcykge1xyXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpbmNsdWRlcycsIHtcclxuICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgdmFsdWU6IGZ1bmN0aW9uKHNlYXJjaEVsZW1lbnQsIGZyb21JbmRleCkge1xyXG5cclxuICAgICAgLy8gMS4gTGV0IE8gYmUgPyBUb09iamVjdCh0aGlzIHZhbHVlKS5cclxuICAgICAgaWYgKHRoaXMgPT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1widGhpc1wiIGlzIG51bGwgb3Igbm90IGRlZmluZWQnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIG8gPSBPYmplY3QodGhpcyk7XHJcblxyXG4gICAgICAvLyAyLiBMZXQgbGVuIGJlID8gVG9MZW5ndGgoPyBHZXQoTywgXCJsZW5ndGhcIikpLlxyXG4gICAgICB2YXIgbGVuID0gby5sZW5ndGggPj4+IDA7XHJcblxyXG4gICAgICAvLyAzLiBJZiBsZW4gaXMgMCwgcmV0dXJuIGZhbHNlLlxyXG4gICAgICBpZiAobGVuID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyA0LiBMZXQgbiBiZSA/IFRvSW50ZWdlcihmcm9tSW5kZXgpLlxyXG4gICAgICAvLyAgICAoSWYgZnJvbUluZGV4IGlzIHVuZGVmaW5lZCwgdGhpcyBzdGVwIHByb2R1Y2VzIHRoZSB2YWx1ZSAwLilcclxuICAgICAgdmFyIG4gPSBmcm9tSW5kZXggfCAwO1xyXG5cclxuICAgICAgLy8gNS4gSWYgbiDiiaUgMCwgdGhlblxyXG4gICAgICAvLyAgYS4gTGV0IGsgYmUgbi5cclxuICAgICAgLy8gNi4gRWxzZSBuIDwgMCxcclxuICAgICAgLy8gIGEuIExldCBrIGJlIGxlbiArIG4uXHJcbiAgICAgIC8vICBiLiBJZiBrIDwgMCwgbGV0IGsgYmUgMC5cclxuICAgICAgdmFyIGsgPSBNYXRoLm1heChuID49IDAgPyBuIDogbGVuIC0gTWF0aC5hYnMobiksIDApO1xyXG5cclxuICAgICAgLy8gNy4gUmVwZWF0LCB3aGlsZSBrIDwgbGVuXHJcbiAgICAgIHdoaWxlIChrIDwgbGVuKSB7XHJcbiAgICAgICAgLy8gYS4gTGV0IGVsZW1lbnRLIGJlIHRoZSByZXN1bHQgb2YgPyBHZXQoTywgISBUb1N0cmluZyhrKSkuXHJcbiAgICAgICAgLy8gYi4gSWYgU2FtZVZhbHVlWmVybyhzZWFyY2hFbGVtZW50LCBlbGVtZW50SykgaXMgdHJ1ZSwgcmV0dXJuIHRydWUuXHJcbiAgICAgICAgLy8gYy4gSW5jcmVhc2UgayBieSAxLlxyXG4gICAgICAgIC8vIE5PVEU6ID09PSBwcm92aWRlcyB0aGUgY29ycmVjdCBcIlNhbWVWYWx1ZVplcm9cIiBjb21wYXJpc29uIG5lZWRlZCBoZXJlLlxyXG4gICAgICAgIGlmIChvW2tdID09PSBzZWFyY2hFbGVtZW50KSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaysrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyA4LiBSZXR1cm4gZmFsc2VcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG4vLyB1bmlxdWVcclxuaWYgKCFBcnJheS5wcm90b3R5cGUudW5pcXVlKSB7XHJcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ3VuaXF1ZScsIHtcclxuICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgdmFsdWU6IGZ1bmN0aW9uKGVxdWFsRnVuY3Rpb24sIG5ld0FycmF5ID0gdHJ1ZSkge1xyXG4gICAgICBpZiAobmV3QXJyYXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdW5xaXVlX25ldyhlcXVhbEZ1bmN0aW9uKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHRoaXMuX3VucWl1ZShlcXVhbEZ1bmN0aW9uKTtcclxuICAgIH0sXHJcbiAgfSk7XHJcblxyXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdfdW5xaXVlX25ldycsIHtcclxuICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgdmFsdWU6IGZ1bmN0aW9uKGVxdWFsRnVuY3Rpb24pIHtcclxuICAgICAgbGV0IGFycmF5ID0gQXJyYXkuZnJvbSh0aGlzKTtcclxuXHJcbiAgICAgIHJldHVybiBhcnJheS5fdW5xaXVlKGVxdWFsRnVuY3Rpb24pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnX3VucWl1ZScsIHtcclxuICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgdmFsdWU6IGZ1bmN0aW9uKGVxdWFsRnVuY3Rpb24pIHtcclxuICAgICAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoO1xyXG4gICAgICB2YXIgaSA9IC0xO1xyXG5cclxuICAgICAgd2hpbGUgKGkrKyA8IGxlbikge1xyXG4gICAgICAgIHZhciBqID0gaSArIDE7XHJcblxyXG4gICAgICAgIGZvciAoOyBqIDwgdGhpcy5sZW5ndGg7ICsraikge1xyXG4gICAgICAgICAgdmFyIGlzRXF1YWwgPSBmYWxzZTtcclxuICAgICAgICAgIGlmIChlcXVhbEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgIGlzRXF1YWwgPSBlcXVhbEZ1bmN0aW9uKHRoaXNbaV0sIHRoaXNbal0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaXNFcXVhbCA9IHRoaXNbaV0gPT09IHRoaXNbal07XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaWYgKGlzRXF1YWwpIHtcclxuICAgICAgICAgICAgdGhpcy5zcGxpY2Uoai0tLCAxKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9LFxyXG4gIH0pO1xyXG59XHJcblxyXG5cclxuLy8gUHJvZHVjdGlvbiBzdGVwcyBvZiBFQ01BLTI2MiwgRWRpdGlvbiA2LCAyMi4xLjIuMVxyXG4vLyBSZWZlcmVuY2U6IGh0dHBzOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy1hcnJheS5mcm9tXHJcbmlmICghQXJyYXkuZnJvbSkge1xyXG4gIEFycmF5LmZyb20gPSAoZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xyXG4gICAgdmFyIGlzQ2FsbGFibGUgPSBmdW5jdGlvbihmbikge1xyXG4gICAgICByZXR1cm4gdHlwZW9mIGZuID09PSAnZnVuY3Rpb24nIHx8IHRvU3RyLmNhbGwoZm4pID09PSAnW29iamVjdCBGdW5jdGlvbl0nO1xyXG4gICAgfTtcclxuICAgIHZhciB0b0ludGVnZXIgPSBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICB2YXIgbnVtYmVyID0gTnVtYmVyKHZhbHVlKTtcclxuICAgICAgaWYgKGlzTmFOKG51bWJlcikpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgICAgfVxyXG4gICAgICBpZiAobnVtYmVyID09PSAwIHx8ICFpc0Zpbml0ZShudW1iZXIpKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bWJlcjtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gKG51bWJlciA+IDAgPyAxIDogLTEpICogTWF0aC5mbG9vcihNYXRoLmFicyhudW1iZXIpKTtcclxuICAgIH07XHJcbiAgICB2YXIgbWF4U2FmZUludGVnZXIgPSBNYXRoLnBvdygyLCA1MykgLSAxO1xyXG4gICAgdmFyIHRvTGVuZ3RoID0gZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgdmFyIGxlbiA9IHRvSW50ZWdlcih2YWx1ZSk7XHJcbiAgICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heChsZW4sIDApLCBtYXhTYWZlSW50ZWdlcik7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFRoZSBsZW5ndGggcHJvcGVydHkgb2YgdGhlIGZyb20gbWV0aG9kIGlzIDEuXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gZnJvbShhcnJheUxpa2UgLyosIG1hcEZuLCB0aGlzQXJnICovICkge1xyXG4gICAgICAvLyAxLiBMZXQgQyBiZSB0aGUgdGhpcyB2YWx1ZS5cclxuICAgICAgdmFyIEMgPSB0aGlzO1xyXG5cclxuICAgICAgLy8gMi4gTGV0IGl0ZW1zIGJlIFRvT2JqZWN0KGFycmF5TGlrZSkuXHJcbiAgICAgIHZhciBpdGVtcyA9IE9iamVjdChhcnJheUxpa2UpO1xyXG5cclxuICAgICAgLy8gMy4gUmV0dXJuSWZBYnJ1cHQoaXRlbXMpLlxyXG4gICAgICBpZiAoYXJyYXlMaWtlID09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQXJyYXkuZnJvbSByZXF1aXJlcyBhbiBhcnJheS1saWtlIG9iamVjdCAtIG5vdCBudWxsIG9yIHVuZGVmaW5lZFwiKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gNC4gSWYgbWFwZm4gaXMgdW5kZWZpbmVkLCB0aGVuIGxldCBtYXBwaW5nIGJlIGZhbHNlLlxyXG4gICAgICB2YXIgbWFwRm4gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHZvaWQgdW5kZWZpbmVkO1xyXG4gICAgICB2YXIgVDtcclxuICAgICAgaWYgKHR5cGVvZiBtYXBGbiAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAvLyA1LiBlbHNlXHJcbiAgICAgICAgLy8gNS4gYSBJZiBJc0NhbGxhYmxlKG1hcGZuKSBpcyBmYWxzZSwgdGhyb3cgYSBUeXBlRXJyb3IgZXhjZXB0aW9uLlxyXG4gICAgICAgIGlmICghaXNDYWxsYWJsZShtYXBGbikpIHtcclxuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FycmF5LmZyb206IHdoZW4gcHJvdmlkZWQsIHRoZSBzZWNvbmQgYXJndW1lbnQgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyA1LiBiLiBJZiB0aGlzQXJnIHdhcyBzdXBwbGllZCwgbGV0IFQgYmUgdGhpc0FyZzsgZWxzZSBsZXQgVCBiZSB1bmRlZmluZWQuXHJcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAyKSB7XHJcbiAgICAgICAgICBUID0gYXJndW1lbnRzWzJdO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMTAuIExldCBsZW5WYWx1ZSBiZSBHZXQoaXRlbXMsIFwibGVuZ3RoXCIpLlxyXG4gICAgICAvLyAxMS4gTGV0IGxlbiBiZSBUb0xlbmd0aChsZW5WYWx1ZSkuXHJcbiAgICAgIHZhciBsZW4gPSB0b0xlbmd0aChpdGVtcy5sZW5ndGgpO1xyXG5cclxuICAgICAgLy8gMTMuIElmIElzQ29uc3RydWN0b3IoQykgaXMgdHJ1ZSwgdGhlblxyXG4gICAgICAvLyAxMy4gYS4gTGV0IEEgYmUgdGhlIHJlc3VsdCBvZiBjYWxsaW5nIHRoZSBbW0NvbnN0cnVjdF1dIGludGVybmFsIG1ldGhvZCBvZiBDIHdpdGggYW4gYXJndW1lbnQgbGlzdCBjb250YWluaW5nIHRoZSBzaW5nbGUgaXRlbSBsZW4uXHJcbiAgICAgIC8vIDE0LiBhLiBFbHNlLCBMZXQgQSBiZSBBcnJheUNyZWF0ZShsZW4pLlxyXG4gICAgICB2YXIgQSA9IGlzQ2FsbGFibGUoQykgPyBPYmplY3QobmV3IEMobGVuKSkgOiBuZXcgQXJyYXkobGVuKTtcclxuXHJcbiAgICAgIC8vIDE2LiBMZXQgayBiZSAwLlxyXG4gICAgICB2YXIgayA9IDA7XHJcbiAgICAgIC8vIDE3LiBSZXBlYXQsIHdoaWxlIGsgPCBsZW7igKYgKGFsc28gc3RlcHMgYSAtIGgpXHJcbiAgICAgIHZhciBrVmFsdWU7XHJcbiAgICAgIHdoaWxlIChrIDwgbGVuKSB7XHJcbiAgICAgICAga1ZhbHVlID0gaXRlbXNba107XHJcbiAgICAgICAgaWYgKG1hcEZuKSB7XHJcbiAgICAgICAgICBBW2tdID0gdHlwZW9mIFQgPT09ICd1bmRlZmluZWQnID8gbWFwRm4oa1ZhbHVlLCBrKSA6IG1hcEZuLmNhbGwoVCwga1ZhbHVlLCBrKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgQVtrXSA9IGtWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgayArPSAxO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIDE4LiBMZXQgcHV0U3RhdHVzIGJlIFB1dChBLCBcImxlbmd0aFwiLCBsZW4sIHRydWUpLlxyXG4gICAgICBBLmxlbmd0aCA9IGxlbjtcclxuICAgICAgLy8gMjAuIFJldHVybiBBLlxyXG4gICAgICByZXR1cm4gQTtcclxuICAgIH07XHJcbiAgfSgpKTtcclxufVxyXG5cclxuaWYgKCFBcnJheS5lcXVhbCkge1xyXG4gIEFycmF5LmVxdWFsID0gZnVuY3Rpb24oYXJyMSwgYXJyMiwgc3RyaWN0ID0gdHJ1ZSkge1xyXG4gICAgaWYgKGFycjEgPT09IHVuZGVmaW5lZCB8fCBhcnIyID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBsZW5ndGggPSBhcnIxLmxlbmd0aFxyXG4gICAgaWYgKGxlbmd0aCAhPT0gYXJyMi5sZW5ndGgpIHJldHVybiBmYWxzZVxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAoc3RyaWN0KSB7XHJcbiAgICAgICAgaWYgKGFycjFbaV0gIT09IGFycjJbaV0pIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB2YXIgdmFsdWUxID0gYXJyMVtpXTtcclxuICAgICAgICB2YXIgdmFsdWUyID0gYXJyMltpXTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZTEpICYmIEFycmF5LmlzQXJyYXkodmFsdWUyKSkge1xyXG4gICAgICAgICAgcmVzdWx0ID0gQXJyYXkuZXF1YWwodmFsdWUxLCB2YWx1ZTIsIHN0cmljdCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlc3VsdCA9ICh2YWx1ZTEgPT0gdmFsdWUyKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRydWVcclxuICB9O1xyXG59XHJcblxyXG5pZiAoIUFycmF5LnByb3RvdHlwZS5pc0VxdWFsKSB7XHJcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2lzRXF1YWwnLCB7XHJcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgIHZhbHVlOiBmdW5jdGlvbihvdGhlckFycmF5LCBzdHJpY3QgPSB0cnVlKSB7XHJcbiAgICAgIHJldHVybiBBcnJheS5lcXVhbCh0aGlzLCBvdGhlckFycmF5LCBzdHJpY3QpO1xyXG4gICAgfSxcclxuICB9KTtcclxufVxyXG5cclxuaWYgKCFBcnJheS5zb3J0QnlOdW1iZXIpIHtcclxuICBBcnJheS5zb3J0QnlOdW1iZXIgPSBmdW5jdGlvbiAobjEsIG4yLCBhc2MgPSB0cnVlKSB7XHJcbiAgICByZXR1cm4gKG4xIC0gbjIpICogKGFzYyA/IDEgOiAtMSk7XHJcbiAgfTtcclxufVxyXG5cclxuaWYgKCFBcnJheS5wcm90b3R5cGUuZmluZFN1YkFycmF5SW5kZXhzKSB7XHJcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2ZpbmRTdWJBcnJheUluZGV4cycsIHtcclxuICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgdmFsdWU6IGZ1bmN0aW9uIChzdWJBcnJheSwgZikge1xyXG4gICAgICBsZXQgaW5kZXhzID0gW107XHJcbiAgICAgIGZvciAodmFyIGkgaW4gc3ViQXJyYXkpIHtcclxuICAgICAgICBsZXQgc3ViVmFsdWUgPSBzdWJBcnJheVtpXTtcclxuICAgICAgICBsZXQgZmluZEZ1bmMgPSBmIHx8IGZ1bmN0aW9uICh0aGlzVmFsdWUpIHtcclxuICAgICAgICAgIHJldHVybiBzdWJWYWx1ZSA9PT0gdGhpc1ZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmZpbmRJbmRleChmaW5kRnVuYyk7XHJcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICAgIGluZGV4cy5wdXNoKGluZGV4KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaW5kZXhzID0gW107XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBpbmRleHMubGVuZ3RoID4gMCA/IGluZGV4cyA6IG51bGw7XHJcbiAgICB9LFxyXG4gIH0pO1xyXG59XHJcblxyXG5pZiAoIUFycmF5LnByb3RvdHlwZS50cmFuc2xhdGlvbldpdGhTdGFydEluZGV4KSB7XHJcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ3RyYW5zbGF0aW9uV2l0aFN0YXJ0SW5kZXgnLCB7XHJcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgIHZhbHVlOiBmdW5jdGlvbiAoc3RhcnRJbmRleCkge1xyXG4gICAgICBpZiAoc3RhcnRJbmRleCA9PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChzdGFydEluZGV4ID49IHRoaXMubGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBwcmUgPSB0aGlzLnNsaWNlKHN0YXJ0SW5kZXgpO1xyXG4gICAgICBsZXQgbGFzdCA9IHRoaXMuc2xpY2UoMCwgc3RhcnRJbmRleCk7XHJcbiAgICAgIGxldCByZXN1bHQgPSBwcmUuY29uY2F0KGxhc3QpO1xyXG5cclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sXHJcbiAgfSk7XHJcbn1cclxuXHJcbmlmICghQXJyYXkucHJvdG90eXBlLmtxX2luc2VydCkge1xyXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdrcV9pbnNlcnQnLCB7XHJcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgIHZhbHVlOiBmdW5jdGlvbihpbmRleCwgZSkge1xyXG4gICAgICBpZiAoZSA9PSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChpbmRleCA+PSB0aGlzLmxlbmd0aCkge1xyXG4gICAgICAgIHRoaXMucHVzaChlKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuc3BsaWNlKGluZGV4LCAwLCBlKTtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSxcclxuICB9KTtcclxufVxyXG5cclxuaWYgKCFBcnJheS5wcm90b3R5cGUua3FfZXhjbHVkZXMpIHtcclxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAna3FfZXhjbHVkZXMnLCB7XHJcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgIHZhbHVlOiBmdW5jdGlvbihvdGhlckFycmF5KSB7XHJcbiAgICAgIGlmIChvdGhlckFycmF5ID09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IHJlc3VsdCA9IFtdO1xyXG4gICAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgIGlmICghb3RoZXJBcnJheS5pbmNsdWRlcyhlbGVtZW50KSkge1xyXG4gICAgICAgICAgcmVzdWx0LnB1c2goZWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9LFxyXG4gIH0pO1xyXG59XHJcblxyXG4vKlxyXG5pZighQXJyYXkucHJvdG90eXBlLm1pbil7XHJcbiAgQXJyYXkucHJvdG90eXBlLm1pbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG1pbiA9IHRoaXNbMF07XHJcbiAgICB2YXIgbGVuID0gdGhpcy5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgIGlmICh0aGlzW2ldIDwgbWluKSB7XHJcbiAgICAgICAgbWluID0gdGhpc1tpXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG1pbjtcclxuICB9XHJcbn0qL1xyXG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcclxuXHJcbmxldCBBdWRpb01hbmFnZXIgPSBjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGhhbGxfYmdtOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLy8g5omT5p6qXHJcbiAgICAgICAgZGFRaWFuZzoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGZhcGFpOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgd2luZG93OiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgY2xpY2tfd2VpeGluX2xvZ2luOntcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBmYW5nUGFpOntcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcclxuICAgICAgICB9LFxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc3RhdGljczoge1xyXG4gICAgICAgIGluc3RhbmNlOiBudWxsLFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQ6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlID0gdGhpcztcclxuICAgICAgICB0aGlzLl9yZWdpc3RlckFwcEFjdGl2ZUNoYW5nZSgpO1xyXG5cclxuICAgICAgICB0aGlzLnNvdW5kT24gPSB0cnVlO1xyXG4gICAgICAgIGNjLmdhbWUuYWRkUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSk7XHJcbiAgICAgICAgaWYgKGNjLmdhbWUuaXNQZXJzaXN0Um9vdE5vZGUodGhpcy5ub2RlKSkge1xyXG4gICAgICAgICAgICAvLyBjYy5sb2coJ+a3u+WKoOWFqOWxgOiKgueCueaIkOWKnycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm1WYWx1ZSA9IG1hbmFnZXIuZ2V0TXVzaWNWYWx1ZSgpO1xyXG4gICAgICAgIHRoaXMubUVWYWx1ZSA9IG1hbmFnZXIuZ2V0TXVzaWNFZmZlY3RWYWx1ZSgpO1xyXG4gICAgICAgIHRoaXMuYmdBdWRpb0lkID0gLTE7XHJcbiAgICB9LFxyXG5cclxuICAgIHN0b3BIYWxsTXVzaWM6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgY2MuYXVkaW9FbmdpbmUuc3RvcCh0aGlzLmJnQXVkaW9JZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHBsYXlNdXNpYzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5iZ0F1ZGlvSWQgPSBjYy5hdWRpb0VuZ2luZS5wbGF5TXVzaWMoIHRoaXMuaGFsbF9iZ20sIHRydWUpO1xyXG4gICAgICAgIGlmICh0aGlzLmJnQXVkaW9JZCAhPSAtMSkge1xyXG4gICAgICAgICAgICAvL2NjLmxvZygncGxheScpO1xyXG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUodGhpcy5iZ0F1ZGlvSWQsdGhpcy5tVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL2NjLmF1ZGlvRW5naW5lLnBsYXlNdXNpYyggdXJsLCB0cnVlIClcclxuICAgIH0sXHJcblxyXG5cclxuICAgIHBsYXlDb21wYXJlQ2FyZHNNdXNpYzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYmdBdWRpb0lkID0gY2MuYXVkaW9FbmdpbmUucGxheU11c2ljKCB0aGlzLmhhbGxfYmdtLCB0cnVlKTtcclxuICAgICAgICBpZiAodGhpcy5iZ0F1ZGlvSWQgIT0gLTEpIHtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc2V0Vm9sdW1lKHRoaXMuYmdBdWRpb0lkLHRoaXMubVZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHBsYXlEYVFpYW5nOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZm9yICh2YXIgc3RhcnQgPSAwOyBzdGFydCA8PSAxLjY7IHN0YXJ0ID0gc3RhcnQgKyAwLjUpIHtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmRhUWlhbmcpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIHN0YXJ0KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOKAnOaJk+aequKAnVxyXG4gICAgcGxheUh1bWFuRGFRaWFuZzogZnVuY3Rpb24gKHNleCA9IDEpIHtcclxuICAgICAgICB2YXIgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9tYW5cIi8qICsgKHNleCA9PSAxID8gXCJtYW5cIiA6IFwid29tYW5cIikqLztcclxuICAgICAgICBwYXRoID0gcGF0aCArIFwiL2RhcWlhbmcxLm1wM1wiO1xyXG5cclxuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcclxuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOKAnOS4reaequKAnVxyXG4gICAgcGxheUh1bWFuWlFpYW5nOiBmdW5jdGlvbiAoc2V4ID0gMSkge1xyXG4gICAgICAgIHZhciBwYXRoID0gXCJyZXNvdXJjZXMvc291bmRzL21hblwiLyogKyAoc2V4ID09IDEgPyBcIm1hblwiIDogXCJ3b21hblwiKSovO1xyXG4gICAgICAgIHBhdGggPSBwYXRoICsgXCIvZGFxaWFuZzMubXAzXCI7XHJcblxyXG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xyXG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcclxuICAgIH0sXHJcblxyXG4gICAgcGxheVBva2VyQ2xpY2s6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdygncmVzb3VyY2VzL3NvdW5kcy9wdWJsaWMvY2xpY2tfd3hfbG9naW4ubXAzJyk7XHJcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmkq3mlL7lhajlnpLmiZPpn7PmlYhcclxuICAgIHBsYXlIb21lUnVuOiBmdW5jdGlvbiAoc2V4ID0gMSkge1xyXG4gICAgICAgIGxldCBwYXRoID0gdGhpcy5fc291bmRzSHVtYW5QYXRoKHNleCkgKyBcInNwZWNpYWwxLm1wM1wiO1xyXG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xyXG4gICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5pKt5pS+5Y+R54mM6Z+z5pWIXHJcbiAgICBwbGF5RmFQYWk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBwYXRoMSA9IHRoaXMuX3NvdW5kc0h1bWFuUGF0aCgxKSArIFwicm9vbV9zdGFydF9jb21wYXJlLm1wM1wiO1xyXG4gICAgICAgIGxldCB1cmwxID0gY2MudXJsLnJhdyhwYXRoMSk7XHJcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwxKTtcclxuICAgICAgICAvL2xldCBwb2tlckRlYWwgPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoMSkgKyBcInBva2VyX2RlYWwubXAzXCI7XHJcbiAgICAgICAgLy9sZXQgdXJsUG9rZXJEZWFsID0gY2MudXJsLnJhdyhwb2tlckRlYWwpO1xyXG4gICAgICAgIC8vdGhpcy5fcGxheVNGWCh1cmxQb2tlckRlYWwpO1xyXG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5mYXBhaSk7XHJcbiAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IDY7IGluZGV4KyspIHtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuZmFwYWkpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIGluZGV4ICogMC4xKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHBsYXlDYXJkVHlwZTogZnVuY3Rpb24gKHNleCA9IDEsIHR5cGUgPSAtMSkge1xyXG4gICAgICAgIC8vIOWPquaSreaUvuaZrumAmuexu+Wei+eahOivremfs1xyXG4gICAgICAgIGlmICgodHlwZSA+PSAxMCkgfHwgKHR5cGUgPCAwKSkge1xyXG4gICAgICAgICAgICAvLyAxMCDlj4rku6XkuIrmmK/nibnmrorniYxcclxuICAgICAgICAgICAgbGV0IHBhdGggPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoc2V4KSArICh0eXBlKSArIFwiLm1wM1wiO1xyXG4gICAgICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcclxuICAgICAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgcGF0aCA9IHRoaXMuX3NvdW5kc0h1bWFuUGF0aChzZXgpICsgXCJjb21tb25cIiArICh0eXBlICsgMSkgKyBcIi5tcDNcIjtcclxuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcclxuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaSreaUviDlvIDlp4vmr5TniYxcclxuICAgIHBsYXlTdGFydENvbXBhcmU6IGZ1bmN0aW9uIChzZXggPSAxKSB7XHJcbiAgICAgICAgbGV0IHBhdGggPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoc2V4KSArIFwic3RhcnRfY29tcGFyZS5tcDNcIjtcclxuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcclxuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHBsYXlXaW46IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdygncmVzb3VyY2VzL3NvdW5kcy9vcGVuZmFjZS93aW4ubXAzJyk7XHJcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xyXG4gICAgfSxcclxuXHJcbiAgICBwbGF5TG9zZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KCdyZXNvdXJjZXMvc291bmRzL29wZW5mYWNlL2xvc2UubXAzJyk7XHJcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjb2luSW5jb21lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcoJ3Jlc291cmNlcy9zb3VuZHMvb3BlbmZhY2UvY29pbl9pbmNvbWUubXAzJyk7XHJcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc291bmRzSHVtYW5QYXRoOiBmdW5jdGlvbiAoc2V4KSB7XHJcbiAgICAgICAgbGV0IHBhdGggPSBcInJlc291cmNlcy9zb3VuZHMvbWFuL1wiLyogKyAoc2V4ID09IDEgPyBcIm1hblwiIDogXCJ3b21hblwiKSArIFwiL1wiKi87XHJcbiAgICAgICAgcmV0dXJuIHBhdGg7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldEJnTXVzaWNWb2x1bW46IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5tVmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICBpZiAodGhpcy5iZ0F1ZGlvSWQgIT0gLTEpIHtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc2V0Vm9sdW1lKHRoaXMuYmdBdWRpb0lkLHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHNldEVmZmVjdE11c2ljVm9sdW06IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5tRVZhbHVlID0gdmFsdWU7XHJcbiAgICB9LFxyXG5cclxuICAgIC8q6IGK5aSpKi9cclxuICAgIHBsYXlDaGF0QXVkaW86ZnVuY3Rpb24oc2V4LCBzdHIpIHtcclxuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmNoYXRUZXh0cygpLmluZGV4T2Yoc3RyKTtcclxuICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IG51bWJlciA9IFwiQ0hBVFwiKyhpbmRleCsxKTtcclxuICAgICAgICBsZXQgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9jaGF0L1wiICsgbnVtYmVyICsgXCIubXAzXCI7XHJcbiAgICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcocGF0aCk7XHJcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjaGF0VGV4dHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAn6L+Y5LiN5Ye654mM77yM5oiR6YO95b+r5Y675ZCD6ZSF6L6557OK5LqGJyxcclxuICAgICAgICAgICAgJ+WXqOWRgO+8jOaIkeWutumHjOiAgeS6uumDveavlOS9oOaJk+eahOW/qycsXHJcbiAgICAgICAgICAgICfll6jlkYDvvIzmiZPniYzmiZPnmoTmiJHpg73lm7DkuoYnLFxyXG4gICAgICAgICAgICAn5ZOO77yM5L2g5b+r5oWi5oWi5om+77yM5oiR5YWI5Y676KW/5rmW6YCb5LiA5LiLJyxcclxuICAgICAgICAgICAgJ+W/q+S4gOeCueWRgO+8jOaIkeetieS9oOaDs+WlveaIkeWOleaJgOmDveS4iuS4gOi2n+S6hicsXHJcbiAgICAgICAgICAgICfkvaDov5nlnKjlubLlmJvvvIzov5nkuYjmhaInLFxyXG4gICAgICAgICAgICAn5Zeo5ZGA77yM5pyA6L+R5Zyo5b+Z5LuA5LmI77yM5b6I5LmF5rKh6KeB5LqGJyxcclxuICAgICAgICAgICAgJ+adpeadpeadpe+8jOS4iee8uuS4gCcsXHJcbiAgICAgICAgICAgICfmnaXmnaXmnaXvvIzotbbntKflnZDkuIvmnaXmiZPkuIDlnIgnLFxyXG4gICAgICAgICAgICAn6Lef5L2g5Lus6L+Z5Lqb6auY5omL5omT5oiR5Lya57Sn5byg77yM6K6p5oiR5LiA54K5JyxcclxuICAgICAgICAgICAgJ+ibruaZmuWIsOWkqeS6ru+8jOi+k+S6huWPr+S7peiuqeS9oOS7rOWFiOasoOedgCdcclxuICAgICAgICBdO1xyXG4gICAgfSxcclxuXHJcbiAgICBwYXVzZU11c2ljOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLnNvdW5kT24gPSBmYWxzZTtcclxuICAgICAgICBjYy5hdWRpb0VuZ2luZS5wYXVzZU11c2ljKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlc3VtZU11c2ljOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLnNvdW5kT24gPSB0cnVlO1xyXG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnJlc3VtZU11c2ljKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9wbGF5U0ZYOiBmdW5jdGlvbihjbGlwKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc291bmRPbikge1xyXG4gICAgICAgICAgICB2YXIgYXVkaW9JZCA9IGNjLmF1ZGlvRW5naW5lLnBsYXlFZmZlY3QoIGNsaXAsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnNldFZvbHVtZShhdWRpb0lkLHRoaXMubUVWYWx1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBhdWRpb0lkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6IOWJjeWQjuWPsOaTjeS9nFxyXG4gICAgX3JlZ2lzdGVyQXBwQWN0aXZlQ2hhbmdlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX0hJREUsIHRoaXMuX2FwcEVudGVyQmFja2dyb3VuZCwgdGhpcyk7XHJcbiAgICAgICAgY2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX1NIT1csIHRoaXMuX2FwcEJlY29tQWN0aXZlLCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDov5vlhaXlkI7lj7BcclxuICAgICAqL1xyXG4gICAgX2FwcEVudGVyQmFja2dyb3VuZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGxldCBub3cgPSBjYy5zeXMubm93KCk7XHJcbiAgICAgICAgaWYgKG5vdyAtIHRoaXMuX2xhc3RBcHBFbnRlckJhY2tncm91bmRUaW1lIDwgMTAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbGFzdEFwcEVudGVyQmFja2dyb3VuZFRpbWUgPSBub3c7XHJcblxyXG4gICAgICAgIHRoaXMucGF1c2VNdXNpYygpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIOi/m+WFpeWJjeWPsFxyXG4gICAgICovXHJcbiAgICBfYXBwQmVjb21BY3RpdmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xyXG4gICAgICAgIGlmIChub3cgLSB0aGlzLl9sYXN0QXBwQmVjb21BY3RpdmVUaW1lIDwgMTAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbGFzdEFwcEJlY29tQWN0aXZlVGltZSA9IG5vdztcclxuXHJcbiAgICAgICAgdGhpcy5yZXN1bWVNdXNpYygpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKuehruWumuaMiemSrumfs+aViCovXHJcbiAgICBwbGF5QnRuQ2xpY2tTRlg6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX3dlaXhpbl9sb2dpbik7XHJcbiAgICB9LFxyXG4gICAgLyrlhazlhbHmjInpkq7vvIzmjInplK7miJbogIXlhbPpl63mjInpkq7kuYvnsbvnmoTpn7PmlYgqL1xyXG4gICAgcGFseUJ0blB1YmxpY1NGWDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX3dlaXhpbl9sb2dpbik7XHJcbiAgICB9LFxyXG5cclxuICAgIC8q5Y+W5raI5oyJ6ZKu6Z+z5pWIKi9cclxuICAgIHBhbHlCdG5DYW5jZWxDbGlja1NGWDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX3dlaXhpbl9sb2dpbik7XHJcbiAgICB9LFxyXG4gICAgcGFseUJ0bkNyZWF0ZVJvb21TRlg6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5jbGlja193ZWl4aW5fbG9naW4pO1xyXG4gICAgfSxcclxuICAgIHBhbHlXaW5kb3dTRlg6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMud2luZG93KTtcclxuICAgIH0sXHJcbiAgICBwYWx5V2VpWGluTG9naW5TRlg6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuY2xpY2tfd2VpeGluX2xvZ2luKTtcclxuICAgIH0sXHJcbiAgICBwYWx5RmFuZ1BhaVNGWDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5mYW5nUGFpKTtcclxuICAgIH0sXHJcblxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQXVkaW9NYW5hZ2VyO1xyXG4iLCIndXNlIHN0cmljdCdcblxuZXhwb3J0cy5ieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aFxuZXhwb3J0cy50b0J5dGVBcnJheSA9IHRvQnl0ZUFycmF5XG5leHBvcnRzLmZyb21CeXRlQXJyYXkgPSBmcm9tQnl0ZUFycmF5XG5cbnZhciBsb29rdXAgPSBbXVxudmFyIHJldkxvb2t1cCA9IFtdXG52YXIgQXJyID0gdHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnID8gVWludDhBcnJheSA6IEFycmF5XG5cbnZhciBjb2RlID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nXG5mb3IgKHZhciBpID0gMCwgbGVuID0gY29kZS5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICBsb29rdXBbaV0gPSBjb2RlW2ldXG4gIHJldkxvb2t1cFtjb2RlLmNoYXJDb2RlQXQoaSldID0gaVxufVxuXG5yZXZMb29rdXBbJy0nLmNoYXJDb2RlQXQoMCldID0gNjJcbnJldkxvb2t1cFsnXycuY2hhckNvZGVBdCgwKV0gPSA2M1xuXG5mdW5jdGlvbiBwbGFjZUhvbGRlcnNDb3VudCAoYjY0KSB7XG4gIHZhciBsZW4gPSBiNjQubGVuZ3RoXG4gIGlmIChsZW4gJSA0ID4gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdHJpbmcuIExlbmd0aCBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNCcpXG4gIH1cblxuICAvLyB0aGUgbnVtYmVyIG9mIGVxdWFsIHNpZ25zIChwbGFjZSBob2xkZXJzKVxuICAvLyBpZiB0aGVyZSBhcmUgdHdvIHBsYWNlaG9sZGVycywgdGhhbiB0aGUgdHdvIGNoYXJhY3RlcnMgYmVmb3JlIGl0XG4gIC8vIHJlcHJlc2VudCBvbmUgYnl0ZVxuICAvLyBpZiB0aGVyZSBpcyBvbmx5IG9uZSwgdGhlbiB0aGUgdGhyZWUgY2hhcmFjdGVycyBiZWZvcmUgaXQgcmVwcmVzZW50IDIgYnl0ZXNcbiAgLy8gdGhpcyBpcyBqdXN0IGEgY2hlYXAgaGFjayB0byBub3QgZG8gaW5kZXhPZiB0d2ljZVxuICByZXR1cm4gYjY0W2xlbiAtIDJdID09PSAnPScgPyAyIDogYjY0W2xlbiAtIDFdID09PSAnPScgPyAxIDogMFxufVxuXG5mdW5jdGlvbiBieXRlTGVuZ3RoIChiNjQpIHtcbiAgLy8gYmFzZTY0IGlzIDQvMyArIHVwIHRvIHR3byBjaGFyYWN0ZXJzIG9mIHRoZSBvcmlnaW5hbCBkYXRhXG4gIHJldHVybiBiNjQubGVuZ3RoICogMyAvIDQgLSBwbGFjZUhvbGRlcnNDb3VudChiNjQpXG59XG5cbmZ1bmN0aW9uIHRvQnl0ZUFycmF5IChiNjQpIHtcbiAgdmFyIGksIGosIGwsIHRtcCwgcGxhY2VIb2xkZXJzLCBhcnJcbiAgdmFyIGxlbiA9IGI2NC5sZW5ndGhcbiAgcGxhY2VIb2xkZXJzID0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KVxuXG4gIGFyciA9IG5ldyBBcnIobGVuICogMyAvIDQgLSBwbGFjZUhvbGRlcnMpXG5cbiAgLy8gaWYgdGhlcmUgYXJlIHBsYWNlaG9sZGVycywgb25seSBnZXQgdXAgdG8gdGhlIGxhc3QgY29tcGxldGUgNCBjaGFyc1xuICBsID0gcGxhY2VIb2xkZXJzID4gMCA/IGxlbiAtIDQgOiBsZW5cblxuICB2YXIgTCA9IDBcblxuICBmb3IgKGkgPSAwLCBqID0gMDsgaSA8IGw7IGkgKz0gNCwgaiArPSAzKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTgpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDEyKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDIpXSA8PCA2KSB8IHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMyldXG4gICAgYXJyW0wrK10gPSAodG1wID4+IDE2KSAmIDB4RkZcbiAgICBhcnJbTCsrXSA9ICh0bXAgPj4gOCkgJiAweEZGXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH1cblxuICBpZiAocGxhY2VIb2xkZXJzID09PSAyKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMikgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPj4gNClcbiAgICBhcnJbTCsrXSA9IHRtcCAmIDB4RkZcbiAgfSBlbHNlIGlmIChwbGFjZUhvbGRlcnMgPT09IDEpIHtcbiAgICB0bXAgPSAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAxMCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPDwgNCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAyKV0gPj4gMilcbiAgICBhcnJbTCsrXSA9ICh0bXAgPj4gOCkgJiAweEZGXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH1cblxuICByZXR1cm4gYXJyXG59XG5cbmZ1bmN0aW9uIHRyaXBsZXRUb0Jhc2U2NCAobnVtKSB7XG4gIHJldHVybiBsb29rdXBbbnVtID4+IDE4ICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDEyICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDYgJiAweDNGXSArIGxvb2t1cFtudW0gJiAweDNGXVxufVxuXG5mdW5jdGlvbiBlbmNvZGVDaHVuayAodWludDgsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHRtcFxuICB2YXIgb3V0cHV0ID0gW11cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpICs9IDMpIHtcbiAgICB0bXAgPSAodWludDhbaV0gPDwgMTYpICsgKHVpbnQ4W2kgKyAxXSA8PCA4KSArICh1aW50OFtpICsgMl0pXG4gICAgb3V0cHV0LnB1c2godHJpcGxldFRvQmFzZTY0KHRtcCkpXG4gIH1cbiAgcmV0dXJuIG91dHB1dC5qb2luKCcnKVxufVxuXG5mdW5jdGlvbiBmcm9tQnl0ZUFycmF5ICh1aW50OCkge1xuICB2YXIgdG1wXG4gIHZhciBsZW4gPSB1aW50OC5sZW5ndGhcbiAgdmFyIGV4dHJhQnl0ZXMgPSBsZW4gJSAzIC8vIGlmIHdlIGhhdmUgMSBieXRlIGxlZnQsIHBhZCAyIGJ5dGVzXG4gIHZhciBvdXRwdXQgPSAnJ1xuICB2YXIgcGFydHMgPSBbXVxuICB2YXIgbWF4Q2h1bmtMZW5ndGggPSAxNjM4MyAvLyBtdXN0IGJlIG11bHRpcGxlIG9mIDNcblxuICAvLyBnbyB0aHJvdWdoIHRoZSBhcnJheSBldmVyeSB0aHJlZSBieXRlcywgd2UnbGwgZGVhbCB3aXRoIHRyYWlsaW5nIHN0dWZmIGxhdGVyXG4gIGZvciAodmFyIGkgPSAwLCBsZW4yID0gbGVuIC0gZXh0cmFCeXRlczsgaSA8IGxlbjI7IGkgKz0gbWF4Q2h1bmtMZW5ndGgpIHtcbiAgICBwYXJ0cy5wdXNoKGVuY29kZUNodW5rKHVpbnQ4LCBpLCAoaSArIG1heENodW5rTGVuZ3RoKSA+IGxlbjIgPyBsZW4yIDogKGkgKyBtYXhDaHVua0xlbmd0aCkpKVxuICB9XG5cbiAgLy8gcGFkIHRoZSBlbmQgd2l0aCB6ZXJvcywgYnV0IG1ha2Ugc3VyZSB0byBub3QgZm9yZ2V0IHRoZSBleHRyYSBieXRlc1xuICBpZiAoZXh0cmFCeXRlcyA9PT0gMSkge1xuICAgIHRtcCA9IHVpbnQ4W2xlbiAtIDFdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFt0bXAgPj4gMl1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPDwgNCkgJiAweDNGXVxuICAgIG91dHB1dCArPSAnPT0nXG4gIH0gZWxzZSBpZiAoZXh0cmFCeXRlcyA9PT0gMikge1xuICAgIHRtcCA9ICh1aW50OFtsZW4gLSAyXSA8PCA4KSArICh1aW50OFtsZW4gLSAxXSlcbiAgICBvdXRwdXQgKz0gbG9va3VwW3RtcCA+PiAxMF1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPj4gNCkgJiAweDNGXVxuICAgIG91dHB1dCArPSBsb29rdXBbKHRtcCA8PCAyKSAmIDB4M0ZdXG4gICAgb3V0cHV0ICs9ICc9J1xuICB9XG5cbiAgcGFydHMucHVzaChvdXRwdXQpXG5cbiAgcmV0dXJuIHBhcnRzLmpvaW4oJycpXG59XG4iLCIvKiFcbiAqIFRoZSBidWZmZXIgbW9kdWxlIGZyb20gbm9kZS5qcywgZm9yIHRoZSBicm93c2VyLlxuICpcbiAqIEBhdXRob3IgICBGZXJvc3MgQWJvdWtoYWRpamVoIDxmZXJvc3NAZmVyb3NzLm9yZz4gPGh0dHA6Ly9mZXJvc3Mub3JnPlxuICogQGxpY2Vuc2UgIE1JVFxuICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqL1xuXG4ndXNlIHN0cmljdCdcblxudmFyIGJhc2U2NCA9IHJlcXVpcmUoJ2Jhc2U2NC1qcycpXG52YXIgaWVlZTc1NCA9IHJlcXVpcmUoJ2llZWU3NTQnKVxudmFyIGlzQXJyYXkgPSByZXF1aXJlKCdpc2FycmF5JylcblxuZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXJcbmV4cG9ydHMuU2xvd0J1ZmZlciA9IFNsb3dCdWZmZXJcbmV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVMgPSA1MFxuXG4vKipcbiAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6XG4gKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KVxuICogICA9PT0gZmFsc2UgICBVc2UgT2JqZWN0IGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KVxuICpcbiAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKyxcbiAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy5cbiAqXG4gKiBEdWUgdG8gdmFyaW91cyBicm93c2VyIGJ1Z3MsIHNvbWV0aW1lcyB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uIHdpbGwgYmUgdXNlZCBldmVuXG4gKiB3aGVuIHRoZSBicm93c2VyIHN1cHBvcnRzIHR5cGVkIGFycmF5cy5cbiAqXG4gKiBOb3RlOlxuICpcbiAqICAgLSBGaXJlZm94IDQtMjkgbGFja3Mgc3VwcG9ydCBmb3IgYWRkaW5nIG5ldyBwcm9wZXJ0aWVzIHRvIGBVaW50OEFycmF5YCBpbnN0YW5jZXMsXG4gKiAgICAgU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02OTU0MzguXG4gKlxuICogICAtIENocm9tZSA5LTEwIGlzIG1pc3NpbmcgdGhlIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24uXG4gKlxuICogICAtIElFMTAgaGFzIGEgYnJva2VuIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhcnJheXMgb2ZcbiAqICAgICBpbmNvcnJlY3QgbGVuZ3RoIGluIHNvbWUgc2l0dWF0aW9ucy5cblxuICogV2UgZGV0ZWN0IHRoZXNlIGJ1Z2d5IGJyb3dzZXJzIGFuZCBzZXQgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYCB0byBgZmFsc2VgIHNvIHRoZXlcbiAqIGdldCB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uLCB3aGljaCBpcyBzbG93ZXIgYnV0IGJlaGF2ZXMgY29ycmVjdGx5LlxuICovXG5CdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCA9IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUICE9PSB1bmRlZmluZWRcbiAgPyBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVFxuICA6IHR5cGVkQXJyYXlTdXBwb3J0KClcblxuLypcbiAqIEV4cG9ydCBrTWF4TGVuZ3RoIGFmdGVyIHR5cGVkIGFycmF5IHN1cHBvcnQgaXMgZGV0ZXJtaW5lZC5cbiAqL1xuZXhwb3J0cy5rTWF4TGVuZ3RoID0ga01heExlbmd0aCgpXG5cbmZ1bmN0aW9uIHR5cGVkQXJyYXlTdXBwb3J0ICgpIHtcbiAgdHJ5IHtcbiAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSlcbiAgICBhcnIuX19wcm90b19fID0ge19fcHJvdG9fXzogVWludDhBcnJheS5wcm90b3R5cGUsIGZvbzogZnVuY3Rpb24gKCkgeyByZXR1cm4gNDIgfX1cbiAgICByZXR1cm4gYXJyLmZvbygpID09PSA0MiAmJiAvLyB0eXBlZCBhcnJheSBpbnN0YW5jZXMgY2FuIGJlIGF1Z21lbnRlZFxuICAgICAgICB0eXBlb2YgYXJyLnN1YmFycmF5ID09PSAnZnVuY3Rpb24nICYmIC8vIGNocm9tZSA5LTEwIGxhY2sgYHN1YmFycmF5YFxuICAgICAgICBhcnIuc3ViYXJyYXkoMSwgMSkuYnl0ZUxlbmd0aCA9PT0gMCAvLyBpZTEwIGhhcyBicm9rZW4gYHN1YmFycmF5YFxuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZnVuY3Rpb24ga01heExlbmd0aCAoKSB7XG4gIHJldHVybiBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVFxuICAgID8gMHg3ZmZmZmZmZlxuICAgIDogMHgzZmZmZmZmZlxufVxuXG5mdW5jdGlvbiBjcmVhdGVCdWZmZXIgKHRoYXQsIGxlbmd0aCkge1xuICBpZiAoa01heExlbmd0aCgpIDwgbGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgdHlwZWQgYXJyYXkgbGVuZ3RoJylcbiAgfVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKVxuICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3NcbiAgICBpZiAodGhhdCA9PT0gbnVsbCkge1xuICAgICAgdGhhdCA9IG5ldyBCdWZmZXIobGVuZ3RoKVxuICAgIH1cbiAgICB0aGF0Lmxlbmd0aCA9IGxlbmd0aFxuICB9XG5cbiAgcmV0dXJuIHRoYXRcbn1cblxuLyoqXG4gKiBUaGUgQnVmZmVyIGNvbnN0cnVjdG9yIHJldHVybnMgaW5zdGFuY2VzIG9mIGBVaW50OEFycmF5YCB0aGF0IGhhdmUgdGhlaXJcbiAqIHByb3RvdHlwZSBjaGFuZ2VkIHRvIGBCdWZmZXIucHJvdG90eXBlYC4gRnVydGhlcm1vcmUsIGBCdWZmZXJgIGlzIGEgc3ViY2xhc3Mgb2ZcbiAqIGBVaW50OEFycmF5YCwgc28gdGhlIHJldHVybmVkIGluc3RhbmNlcyB3aWxsIGhhdmUgYWxsIHRoZSBub2RlIGBCdWZmZXJgIG1ldGhvZHNcbiAqIGFuZCB0aGUgYFVpbnQ4QXJyYXlgIG1ldGhvZHMuIFNxdWFyZSBicmFja2V0IG5vdGF0aW9uIHdvcmtzIGFzIGV4cGVjdGVkIC0tIGl0XG4gKiByZXR1cm5zIGEgc2luZ2xlIG9jdGV0LlxuICpcbiAqIFRoZSBgVWludDhBcnJheWAgcHJvdG90eXBlIHJlbWFpbnMgdW5tb2RpZmllZC5cbiAqL1xuXG5mdW5jdGlvbiBCdWZmZXIgKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgJiYgISh0aGlzIGluc3RhbmNlb2YgQnVmZmVyKSkge1xuICAgIHJldHVybiBuZXcgQnVmZmVyKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgLy8gQ29tbW9uIGNhc2UuXG4gIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykge1xuICAgIGlmICh0eXBlb2YgZW5jb2RpbmdPck9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ0lmIGVuY29kaW5nIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nJ1xuICAgICAgKVxuICAgIH1cbiAgICByZXR1cm4gYWxsb2NVbnNhZmUodGhpcywgYXJnKVxuICB9XG4gIHJldHVybiBmcm9tKHRoaXMsIGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxufVxuXG5CdWZmZXIucG9vbFNpemUgPSA4MTkyIC8vIG5vdCB1c2VkIGJ5IHRoaXMgaW1wbGVtZW50YXRpb25cblxuLy8gVE9ETzogTGVnYWN5LCBub3QgbmVlZGVkIGFueW1vcmUuIFJlbW92ZSBpbiBuZXh0IG1ham9yIHZlcnNpb24uXG5CdWZmZXIuX2F1Z21lbnQgPSBmdW5jdGlvbiAoYXJyKSB7XG4gIGFyci5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIHJldHVybiBhcnJcbn1cblxuZnVuY3Rpb24gZnJvbSAodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1widmFsdWVcIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpXG4gIH1cblxuICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgcmV0dXJuIGZyb21BcnJheUJ1ZmZlcih0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZnJvbVN0cmluZyh0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldClcbiAgfVxuXG4gIHJldHVybiBmcm9tT2JqZWN0KHRoYXQsIHZhbHVlKVxufVxuXG4vKipcbiAqIEZ1bmN0aW9uYWxseSBlcXVpdmFsZW50IHRvIEJ1ZmZlcihhcmcsIGVuY29kaW5nKSBidXQgdGhyb3dzIGEgVHlwZUVycm9yXG4gKiBpZiB2YWx1ZSBpcyBhIG51bWJlci5cbiAqIEJ1ZmZlci5mcm9tKHN0clssIGVuY29kaW5nXSlcbiAqIEJ1ZmZlci5mcm9tKGFycmF5KVxuICogQnVmZmVyLmZyb20oYnVmZmVyKVxuICogQnVmZmVyLmZyb20oYXJyYXlCdWZmZXJbLCBieXRlT2Zmc2V0WywgbGVuZ3RoXV0pXG4gKiovXG5CdWZmZXIuZnJvbSA9IGZ1bmN0aW9uICh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBmcm9tKG51bGwsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpXG59XG5cbmlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICBCdWZmZXIucHJvdG90eXBlLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkucHJvdG90eXBlXG4gIEJ1ZmZlci5fX3Byb3RvX18gPSBVaW50OEFycmF5XG4gIGlmICh0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wuc3BlY2llcyAmJlxuICAgICAgQnVmZmVyW1N5bWJvbC5zcGVjaWVzXSA9PT0gQnVmZmVyKSB7XG4gICAgLy8gRml4IHN1YmFycmF5KCkgaW4gRVMyMDE2LiBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvYnVmZmVyL3B1bGwvOTdcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVmZmVyLCBTeW1ib2wuc3BlY2llcywge1xuICAgICAgdmFsdWU6IG51bGwsXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KVxuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFNpemUgKHNpemUpIHtcbiAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3QgYmUgYSBudW1iZXInKVxuICB9IGVsc2UgaWYgKHNpemUgPCAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG5lZ2F0aXZlJylcbiAgfVxufVxuXG5mdW5jdGlvbiBhbGxvYyAodGhhdCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHtcbiAgYXNzZXJ0U2l6ZShzaXplKVxuICBpZiAoc2l6ZSA8PSAwKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKVxuICB9XG4gIGlmIChmaWxsICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBPbmx5IHBheSBhdHRlbnRpb24gdG8gZW5jb2RpbmcgaWYgaXQncyBhIHN0cmluZy4gVGhpc1xuICAgIC8vIHByZXZlbnRzIGFjY2lkZW50YWxseSBzZW5kaW5nIGluIGEgbnVtYmVyIHRoYXQgd291bGRcbiAgICAvLyBiZSBpbnRlcnByZXR0ZWQgYXMgYSBzdGFydCBvZmZzZXQuXG4gICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZydcbiAgICAgID8gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpLmZpbGwoZmlsbCwgZW5jb2RpbmcpXG4gICAgICA6IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKS5maWxsKGZpbGwpXG4gIH1cbiAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS5cbiAqIGFsbG9jKHNpemVbLCBmaWxsWywgZW5jb2RpbmddXSlcbiAqKi9cbkJ1ZmZlci5hbGxvYyA9IGZ1bmN0aW9uIChzaXplLCBmaWxsLCBlbmNvZGluZykge1xuICByZXR1cm4gYWxsb2MobnVsbCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpXG59XG5cbmZ1bmN0aW9uIGFsbG9jVW5zYWZlICh0aGF0LCBzaXplKSB7XG4gIGFzc2VydFNpemUoc2l6ZSlcbiAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplIDwgMCA/IDAgOiBjaGVja2VkKHNpemUpIHwgMClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgKytpKSB7XG4gICAgICB0aGF0W2ldID0gMFxuICAgIH1cbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gQnVmZmVyKG51bSksIGJ5IGRlZmF1bHQgY3JlYXRlcyBhIG5vbi16ZXJvLWZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuXG4gKiAqL1xuQnVmZmVyLmFsbG9jVW5zYWZlID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgcmV0dXJuIGFsbG9jVW5zYWZlKG51bGwsIHNpemUpXG59XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gU2xvd0J1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICovXG5CdWZmZXIuYWxsb2NVbnNhZmVTbG93ID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgcmV0dXJuIGFsbG9jVW5zYWZlKG51bGwsIHNpemUpXG59XG5cbmZ1bmN0aW9uIGZyb21TdHJpbmcgKHRoYXQsIHN0cmluZywgZW5jb2RpbmcpIHtcbiAgaWYgKHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycgfHwgZW5jb2RpbmcgPT09ICcnKSB7XG4gICAgZW5jb2RpbmcgPSAndXRmOCdcbiAgfVxuXG4gIGlmICghQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJlbmNvZGluZ1wiIG11c3QgYmUgYSB2YWxpZCBzdHJpbmcgZW5jb2RpbmcnKVxuICB9XG5cbiAgdmFyIGxlbmd0aCA9IGJ5dGVMZW5ndGgoc3RyaW5nLCBlbmNvZGluZykgfCAwXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKVxuXG4gIHZhciBhY3R1YWwgPSB0aGF0LndyaXRlKHN0cmluZywgZW5jb2RpbmcpXG5cbiAgaWYgKGFjdHVhbCAhPT0gbGVuZ3RoKSB7XG4gICAgLy8gV3JpdGluZyBhIGhleCBzdHJpbmcsIGZvciBleGFtcGxlLCB0aGF0IGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycyB3aWxsXG4gICAgLy8gY2F1c2UgZXZlcnl0aGluZyBhZnRlciB0aGUgZmlyc3QgaW52YWxpZCBjaGFyYWN0ZXIgdG8gYmUgaWdub3JlZC4gKGUuZy5cbiAgICAvLyAnYWJ4eGNkJyB3aWxsIGJlIHRyZWF0ZWQgYXMgJ2FiJylcbiAgICB0aGF0ID0gdGhhdC5zbGljZSgwLCBhY3R1YWwpXG4gIH1cblxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXlMaWtlICh0aGF0LCBhcnJheSkge1xuICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoIDwgMCA/IDAgOiBjaGVja2VkKGFycmF5Lmxlbmd0aCkgfCAwXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgdGhhdFtpXSA9IGFycmF5W2ldICYgMjU1XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5QnVmZmVyICh0aGF0LCBhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKSB7XG4gIGFycmF5LmJ5dGVMZW5ndGggLy8gdGhpcyB0aHJvd3MgaWYgYGFycmF5YCBpcyBub3QgYSB2YWxpZCBBcnJheUJ1ZmZlclxuXG4gIGlmIChieXRlT2Zmc2V0IDwgMCB8fCBhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcXCdvZmZzZXRcXCcgaXMgb3V0IG9mIGJvdW5kcycpXG4gIH1cblxuICBpZiAoYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQgKyAobGVuZ3RoIHx8IDApKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1xcJ2xlbmd0aFxcJyBpcyBvdXQgb2YgYm91bmRzJylcbiAgfVxuXG4gIGlmIChieXRlT2Zmc2V0ID09PSB1bmRlZmluZWQgJiYgbGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5KVxuICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldClcbiAgfSBlbHNlIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0LCBsZW5ndGgpXG4gIH1cblxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gYXJyYXlcbiAgICB0aGF0Ll9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzXG4gICAgdGhhdCA9IGZyb21BcnJheUxpa2UodGhhdCwgYXJyYXkpXG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbU9iamVjdCAodGhhdCwgb2JqKSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIob2JqKSkge1xuICAgIHZhciBsZW4gPSBjaGVja2VkKG9iai5sZW5ndGgpIHwgMFxuICAgIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuKVxuXG4gICAgaWYgKHRoYXQubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gdGhhdFxuICAgIH1cblxuICAgIG9iai5jb3B5KHRoYXQsIDAsIDAsIGxlbilcbiAgICByZXR1cm4gdGhhdFxuICB9XG5cbiAgaWYgKG9iaikge1xuICAgIGlmICgodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICBvYmouYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHx8ICdsZW5ndGgnIGluIG9iaikge1xuICAgICAgaWYgKHR5cGVvZiBvYmoubGVuZ3RoICE9PSAnbnVtYmVyJyB8fCBpc25hbihvYmoubGVuZ3RoKSkge1xuICAgICAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIDApXG4gICAgICB9XG4gICAgICByZXR1cm4gZnJvbUFycmF5TGlrZSh0aGF0LCBvYmopXG4gICAgfVxuXG4gICAgaWYgKG9iai50eXBlID09PSAnQnVmZmVyJyAmJiBpc0FycmF5KG9iai5kYXRhKSkge1xuICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqLmRhdGEpXG4gICAgfVxuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcignRmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZywgQnVmZmVyLCBBcnJheUJ1ZmZlciwgQXJyYXksIG9yIGFycmF5LWxpa2Ugb2JqZWN0LicpXG59XG5cbmZ1bmN0aW9uIGNoZWNrZWQgKGxlbmd0aCkge1xuICAvLyBOb3RlOiBjYW5ub3QgdXNlIGBsZW5ndGggPCBrTWF4TGVuZ3RoKClgIGhlcmUgYmVjYXVzZSB0aGF0IGZhaWxzIHdoZW5cbiAgLy8gbGVuZ3RoIGlzIE5hTiAod2hpY2ggaXMgb3RoZXJ3aXNlIGNvZXJjZWQgdG8gemVyby4pXG4gIGlmIChsZW5ndGggPj0ga01heExlbmd0aCgpKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gYWxsb2NhdGUgQnVmZmVyIGxhcmdlciB0aGFuIG1heGltdW0gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ3NpemU6IDB4JyArIGtNYXhMZW5ndGgoKS50b1N0cmluZygxNikgKyAnIGJ5dGVzJylcbiAgfVxuICByZXR1cm4gbGVuZ3RoIHwgMFxufVxuXG5mdW5jdGlvbiBTbG93QnVmZmVyIChsZW5ndGgpIHtcbiAgaWYgKCtsZW5ndGggIT0gbGVuZ3RoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZXFlcWVxXG4gICAgbGVuZ3RoID0gMFxuICB9XG4gIHJldHVybiBCdWZmZXIuYWxsb2MoK2xlbmd0aClcbn1cblxuQnVmZmVyLmlzQnVmZmVyID0gZnVuY3Rpb24gaXNCdWZmZXIgKGIpIHtcbiAgcmV0dXJuICEhKGIgIT0gbnVsbCAmJiBiLl9pc0J1ZmZlcilcbn1cblxuQnVmZmVyLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlIChhLCBiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGEpIHx8ICFCdWZmZXIuaXNCdWZmZXIoYikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzJylcbiAgfVxuXG4gIGlmIChhID09PSBiKSByZXR1cm4gMFxuXG4gIHZhciB4ID0gYS5sZW5ndGhcbiAgdmFyIHkgPSBiLmxlbmd0aFxuXG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBNYXRoLm1pbih4LCB5KTsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKGFbaV0gIT09IGJbaV0pIHtcbiAgICAgIHggPSBhW2ldXG4gICAgICB5ID0gYltpXVxuICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbkJ1ZmZlci5pc0VuY29kaW5nID0gZnVuY3Rpb24gaXNFbmNvZGluZyAoZW5jb2RpbmcpIHtcbiAgc3dpdGNoIChTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlICdoZXgnOlxuICAgIGNhc2UgJ3V0ZjgnOlxuICAgIGNhc2UgJ3V0Zi04JzpcbiAgICBjYXNlICdhc2NpaSc6XG4gICAgY2FzZSAnbGF0aW4xJzpcbiAgICBjYXNlICdiaW5hcnknOlxuICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgY2FzZSAndWNzMic6XG4gICAgY2FzZSAndWNzLTInOlxuICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgIHJldHVybiB0cnVlXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbkJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQgKGxpc3QsIGxlbmd0aCkge1xuICBpZiAoIWlzQXJyYXkobGlzdCkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImxpc3RcIiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKVxuICB9XG5cbiAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5hbGxvYygwKVxuICB9XG5cbiAgdmFyIGlcbiAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbGVuZ3RoID0gMFxuICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7XG4gICAgICBsZW5ndGggKz0gbGlzdFtpXS5sZW5ndGhcbiAgICB9XG4gIH1cblxuICB2YXIgYnVmZmVyID0gQnVmZmVyLmFsbG9jVW5zYWZlKGxlbmd0aClcbiAgdmFyIHBvcyA9IDBcbiAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgYnVmID0gbGlzdFtpXVxuICAgIGlmICghQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wibGlzdFwiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpXG4gICAgfVxuICAgIGJ1Zi5jb3B5KGJ1ZmZlciwgcG9zKVxuICAgIHBvcyArPSBidWYubGVuZ3RoXG4gIH1cbiAgcmV0dXJuIGJ1ZmZlclxufVxuXG5mdW5jdGlvbiBieXRlTGVuZ3RoIChzdHJpbmcsIGVuY29kaW5nKSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIoc3RyaW5nKSkge1xuICAgIHJldHVybiBzdHJpbmcubGVuZ3RoXG4gIH1cbiAgaWYgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIEFycmF5QnVmZmVyLmlzVmlldyA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgKEFycmF5QnVmZmVyLmlzVmlldyhzdHJpbmcpIHx8IHN0cmluZyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSkge1xuICAgIHJldHVybiBzdHJpbmcuYnl0ZUxlbmd0aFxuICB9XG4gIGlmICh0eXBlb2Ygc3RyaW5nICE9PSAnc3RyaW5nJykge1xuICAgIHN0cmluZyA9ICcnICsgc3RyaW5nXG4gIH1cblxuICB2YXIgbGVuID0gc3RyaW5nLmxlbmd0aFxuICBpZiAobGVuID09PSAwKSByZXR1cm4gMFxuXG4gIC8vIFVzZSBhIGZvciBsb29wIHRvIGF2b2lkIHJlY3Vyc2lvblxuICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZVxuICBmb3IgKDs7KSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBsZW5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICAgIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aFxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIGxlbiAqIDJcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBsZW4gPj4+IDFcbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRUb0J5dGVzKHN0cmluZykubGVuZ3RoXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aCAvLyBhc3N1bWUgdXRmOFxuICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuQnVmZmVyLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoXG5cbmZ1bmN0aW9uIHNsb3dUb1N0cmluZyAoZW5jb2RpbmcsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcblxuICAvLyBObyBuZWVkIHRvIHZlcmlmeSB0aGF0IFwidGhpcy5sZW5ndGggPD0gTUFYX1VJTlQzMlwiIHNpbmNlIGl0J3MgYSByZWFkLW9ubHlcbiAgLy8gcHJvcGVydHkgb2YgYSB0eXBlZCBhcnJheS5cblxuICAvLyBUaGlzIGJlaGF2ZXMgbmVpdGhlciBsaWtlIFN0cmluZyBub3IgVWludDhBcnJheSBpbiB0aGF0IHdlIHNldCBzdGFydC9lbmRcbiAgLy8gdG8gdGhlaXIgdXBwZXIvbG93ZXIgYm91bmRzIGlmIHRoZSB2YWx1ZSBwYXNzZWQgaXMgb3V0IG9mIHJhbmdlLlxuICAvLyB1bmRlZmluZWQgaXMgaGFuZGxlZCBzcGVjaWFsbHkgYXMgcGVyIEVDTUEtMjYyIDZ0aCBFZGl0aW9uLFxuICAvLyBTZWN0aW9uIDEzLjMuMy43IFJ1bnRpbWUgU2VtYW50aWNzOiBLZXllZEJpbmRpbmdJbml0aWFsaXphdGlvbi5cbiAgaWYgKHN0YXJ0ID09PSB1bmRlZmluZWQgfHwgc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgPSAwXG4gIH1cbiAgLy8gUmV0dXJuIGVhcmx5IGlmIHN0YXJ0ID4gdGhpcy5sZW5ndGguIERvbmUgaGVyZSB0byBwcmV2ZW50IHBvdGVudGlhbCB1aW50MzJcbiAgLy8gY29lcmNpb24gZmFpbCBiZWxvdy5cbiAgaWYgKHN0YXJ0ID4gdGhpcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGlmIChlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiB0aGlzLmxlbmd0aCkge1xuICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gIH1cblxuICBpZiAoZW5kIDw9IDApIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIC8vIEZvcmNlIGNvZXJzaW9uIHRvIHVpbnQzMi4gVGhpcyB3aWxsIGFsc28gY29lcmNlIGZhbHNleS9OYU4gdmFsdWVzIHRvIDAuXG4gIGVuZCA+Pj49IDBcbiAgc3RhcnQgPj4+PSAwXG5cbiAgaWYgKGVuZCA8PSBzdGFydCkge1xuICAgIHJldHVybiAnJ1xuICB9XG5cbiAgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSAndXRmOCdcblxuICB3aGlsZSAodHJ1ZSkge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBoZXhTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICAgIHJldHVybiBhc2NpaVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICByZXR1cm4gbGF0aW4xU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgICAgcmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgIHJldHVybiB1dGYxNmxlU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpXG4gICAgICAgIGVuY29kaW5nID0gKGVuY29kaW5nICsgJycpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlXG4gICAgfVxuICB9XG59XG5cbi8vIFRoZSBwcm9wZXJ0eSBpcyB1c2VkIGJ5IGBCdWZmZXIuaXNCdWZmZXJgIGFuZCBgaXMtYnVmZmVyYCAoaW4gU2FmYXJpIDUtNykgdG8gZGV0ZWN0XG4vLyBCdWZmZXIgaW5zdGFuY2VzLlxuQnVmZmVyLnByb3RvdHlwZS5faXNCdWZmZXIgPSB0cnVlXG5cbmZ1bmN0aW9uIHN3YXAgKGIsIG4sIG0pIHtcbiAgdmFyIGkgPSBiW25dXG4gIGJbbl0gPSBiW21dXG4gIGJbbV0gPSBpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDE2ID0gZnVuY3Rpb24gc3dhcDE2ICgpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIGlmIChsZW4gJSAyICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAxNi1iaXRzJylcbiAgfVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7XG4gICAgc3dhcCh0aGlzLCBpLCBpICsgMSlcbiAgfVxuICByZXR1cm4gdGhpc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uIHN3YXAzMiAoKSB7XG4gIHZhciBsZW4gPSB0aGlzLmxlbmd0aFxuICBpZiAobGVuICUgNCAhPT0gMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMzItYml0cycpXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xuICAgIHN3YXAodGhpcywgaSwgaSArIDMpXG4gICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDIpXG4gIH1cbiAgcmV0dXJuIHRoaXNcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5zd2FwNjQgPSBmdW5jdGlvbiBzd2FwNjQgKCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgaWYgKGxlbiAlIDggIT09IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDY0LWJpdHMnKVxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDgpIHtcbiAgICBzd2FwKHRoaXMsIGksIGkgKyA3KVxuICAgIHN3YXAodGhpcywgaSArIDEsIGkgKyA2KVxuICAgIHN3YXAodGhpcywgaSArIDIsIGkgKyA1KVxuICAgIHN3YXAodGhpcywgaSArIDMsIGkgKyA0KVxuICB9XG4gIHJldHVybiB0aGlzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZyAoKSB7XG4gIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCB8IDBcbiAgaWYgKGxlbmd0aCA9PT0gMCkgcmV0dXJuICcnXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIDAsIGxlbmd0aClcbiAgcmV0dXJuIHNsb3dUb1N0cmluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gZXF1YWxzIChiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyJylcbiAgaWYgKHRoaXMgPT09IGIpIHJldHVybiB0cnVlXG4gIHJldHVybiBCdWZmZXIuY29tcGFyZSh0aGlzLCBiKSA9PT0gMFxufVxuXG5CdWZmZXIucHJvdG90eXBlLmluc3BlY3QgPSBmdW5jdGlvbiBpbnNwZWN0ICgpIHtcbiAgdmFyIHN0ciA9ICcnXG4gIHZhciBtYXggPSBleHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTXG4gIGlmICh0aGlzLmxlbmd0aCA+IDApIHtcbiAgICBzdHIgPSB0aGlzLnRvU3RyaW5nKCdoZXgnLCAwLCBtYXgpLm1hdGNoKC8uezJ9L2cpLmpvaW4oJyAnKVxuICAgIGlmICh0aGlzLmxlbmd0aCA+IG1heCkgc3RyICs9ICcgLi4uICdcbiAgfVxuICByZXR1cm4gJzxCdWZmZXIgJyArIHN0ciArICc+J1xufVxuXG5CdWZmZXIucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlICh0YXJnZXQsIHN0YXJ0LCBlbmQsIHRoaXNTdGFydCwgdGhpc0VuZCkge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcih0YXJnZXQpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIH1cblxuICBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCkge1xuICAgIHN0YXJ0ID0gMFxuICB9XG4gIGlmIChlbmQgPT09IHVuZGVmaW5lZCkge1xuICAgIGVuZCA9IHRhcmdldCA/IHRhcmdldC5sZW5ndGggOiAwXG4gIH1cbiAgaWYgKHRoaXNTdGFydCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpc1N0YXJ0ID0gMFxuICB9XG4gIGlmICh0aGlzRW5kID09PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzRW5kID0gdGhpcy5sZW5ndGhcbiAgfVxuXG4gIGlmIChzdGFydCA8IDAgfHwgZW5kID4gdGFyZ2V0Lmxlbmd0aCB8fCB0aGlzU3RhcnQgPCAwIHx8IHRoaXNFbmQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdvdXQgb2YgcmFuZ2UgaW5kZXgnKVxuICB9XG5cbiAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kICYmIHN0YXJ0ID49IGVuZCkge1xuICAgIHJldHVybiAwXG4gIH1cbiAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kKSB7XG4gICAgcmV0dXJuIC0xXG4gIH1cbiAgaWYgKHN0YXJ0ID49IGVuZCkge1xuICAgIHJldHVybiAxXG4gIH1cblxuICBzdGFydCA+Pj49IDBcbiAgZW5kID4+Pj0gMFxuICB0aGlzU3RhcnQgPj4+PSAwXG4gIHRoaXNFbmQgPj4+PSAwXG5cbiAgaWYgKHRoaXMgPT09IHRhcmdldCkgcmV0dXJuIDBcblxuICB2YXIgeCA9IHRoaXNFbmQgLSB0aGlzU3RhcnRcbiAgdmFyIHkgPSBlbmQgLSBzdGFydFxuICB2YXIgbGVuID0gTWF0aC5taW4oeCwgeSlcblxuICB2YXIgdGhpc0NvcHkgPSB0aGlzLnNsaWNlKHRoaXNTdGFydCwgdGhpc0VuZClcbiAgdmFyIHRhcmdldENvcHkgPSB0YXJnZXQuc2xpY2Uoc3RhcnQsIGVuZClcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKHRoaXNDb3B5W2ldICE9PSB0YXJnZXRDb3B5W2ldKSB7XG4gICAgICB4ID0gdGhpc0NvcHlbaV1cbiAgICAgIHkgPSB0YXJnZXRDb3B5W2ldXG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIGlmICh4IDwgeSkgcmV0dXJuIC0xXG4gIGlmICh5IDwgeCkgcmV0dXJuIDFcbiAgcmV0dXJuIDBcbn1cblxuLy8gRmluZHMgZWl0aGVyIHRoZSBmaXJzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPj0gYGJ5dGVPZmZzZXRgLFxuLy8gT1IgdGhlIGxhc3QgaW5kZXggb2YgYHZhbGAgaW4gYGJ1ZmZlcmAgYXQgb2Zmc2V0IDw9IGBieXRlT2Zmc2V0YC5cbi8vXG4vLyBBcmd1bWVudHM6XG4vLyAtIGJ1ZmZlciAtIGEgQnVmZmVyIHRvIHNlYXJjaFxuLy8gLSB2YWwgLSBhIHN0cmluZywgQnVmZmVyLCBvciBudW1iZXJcbi8vIC0gYnl0ZU9mZnNldCAtIGFuIGluZGV4IGludG8gYGJ1ZmZlcmA7IHdpbGwgYmUgY2xhbXBlZCB0byBhbiBpbnQzMlxuLy8gLSBlbmNvZGluZyAtIGFuIG9wdGlvbmFsIGVuY29kaW5nLCByZWxldmFudCBpcyB2YWwgaXMgYSBzdHJpbmdcbi8vIC0gZGlyIC0gdHJ1ZSBmb3IgaW5kZXhPZiwgZmFsc2UgZm9yIGxhc3RJbmRleE9mXG5mdW5jdGlvbiBiaWRpcmVjdGlvbmFsSW5kZXhPZiAoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHtcbiAgLy8gRW1wdHkgYnVmZmVyIG1lYW5zIG5vIG1hdGNoXG4gIGlmIChidWZmZXIubGVuZ3RoID09PSAwKSByZXR1cm4gLTFcblxuICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldFxuICBpZiAodHlwZW9mIGJ5dGVPZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgZW5jb2RpbmcgPSBieXRlT2Zmc2V0XG4gICAgYnl0ZU9mZnNldCA9IDBcbiAgfSBlbHNlIGlmIChieXRlT2Zmc2V0ID4gMHg3ZmZmZmZmZikge1xuICAgIGJ5dGVPZmZzZXQgPSAweDdmZmZmZmZmXG4gIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA8IC0weDgwMDAwMDAwKSB7XG4gICAgYnl0ZU9mZnNldCA9IC0weDgwMDAwMDAwXG4gIH1cbiAgYnl0ZU9mZnNldCA9ICtieXRlT2Zmc2V0ICAvLyBDb2VyY2UgdG8gTnVtYmVyLlxuICBpZiAoaXNOYU4oYnl0ZU9mZnNldCkpIHtcbiAgICAvLyBieXRlT2Zmc2V0OiBpdCBpdCdzIHVuZGVmaW5lZCwgbnVsbCwgTmFOLCBcImZvb1wiLCBldGMsIHNlYXJjaCB3aG9sZSBidWZmZXJcbiAgICBieXRlT2Zmc2V0ID0gZGlyID8gMCA6IChidWZmZXIubGVuZ3RoIC0gMSlcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSBieXRlT2Zmc2V0OiBuZWdhdGl2ZSBvZmZzZXRzIHN0YXJ0IGZyb20gdGhlIGVuZCBvZiB0aGUgYnVmZmVyXG4gIGlmIChieXRlT2Zmc2V0IDwgMCkgYnl0ZU9mZnNldCA9IGJ1ZmZlci5sZW5ndGggKyBieXRlT2Zmc2V0XG4gIGlmIChieXRlT2Zmc2V0ID49IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICBpZiAoZGlyKSByZXR1cm4gLTFcbiAgICBlbHNlIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoIC0gMVxuICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAwKSB7XG4gICAgaWYgKGRpcikgYnl0ZU9mZnNldCA9IDBcbiAgICBlbHNlIHJldHVybiAtMVxuICB9XG5cbiAgLy8gTm9ybWFsaXplIHZhbFxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICB2YWwgPSBCdWZmZXIuZnJvbSh2YWwsIGVuY29kaW5nKVxuICB9XG5cbiAgLy8gRmluYWxseSwgc2VhcmNoIGVpdGhlciBpbmRleE9mIChpZiBkaXIgaXMgdHJ1ZSkgb3IgbGFzdEluZGV4T2ZcbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7XG4gICAgLy8gU3BlY2lhbCBjYXNlOiBsb29raW5nIGZvciBlbXB0eSBzdHJpbmcvYnVmZmVyIGFsd2F5cyBmYWlsc1xuICAgIGlmICh2YWwubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gLTFcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcilcbiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykge1xuICAgIHZhbCA9IHZhbCAmIDB4RkYgLy8gU2VhcmNoIGZvciBhIGJ5dGUgdmFsdWUgWzAtMjU1XVxuICAgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCAmJlxuICAgICAgICB0eXBlb2YgVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgaWYgKGRpcikge1xuICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnJheUluZGV4T2YoYnVmZmVyLCBbIHZhbCBdLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKVxuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcigndmFsIG11c3QgYmUgc3RyaW5nLCBudW1iZXIgb3IgQnVmZmVyJylcbn1cblxuZnVuY3Rpb24gYXJyYXlJbmRleE9mIChhcnIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikge1xuICB2YXIgaW5kZXhTaXplID0gMVxuICB2YXIgYXJyTGVuZ3RoID0gYXJyLmxlbmd0aFxuICB2YXIgdmFsTGVuZ3RoID0gdmFsLmxlbmd0aFxuXG4gIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZW5jb2RpbmcgPSBTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKClcbiAgICBpZiAoZW5jb2RpbmcgPT09ICd1Y3MyJyB8fCBlbmNvZGluZyA9PT0gJ3Vjcy0yJyB8fFxuICAgICAgICBlbmNvZGluZyA9PT0gJ3V0ZjE2bGUnIHx8IGVuY29kaW5nID09PSAndXRmLTE2bGUnKSB7XG4gICAgICBpZiAoYXJyLmxlbmd0aCA8IDIgfHwgdmFsLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIC0xXG4gICAgICB9XG4gICAgICBpbmRleFNpemUgPSAyXG4gICAgICBhcnJMZW5ndGggLz0gMlxuICAgICAgdmFsTGVuZ3RoIC89IDJcbiAgICAgIGJ5dGVPZmZzZXQgLz0gMlxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYWQgKGJ1ZiwgaSkge1xuICAgIGlmIChpbmRleFNpemUgPT09IDEpIHtcbiAgICAgIHJldHVybiBidWZbaV1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGJ1Zi5yZWFkVUludDE2QkUoaSAqIGluZGV4U2l6ZSlcbiAgICB9XG4gIH1cblxuICB2YXIgaVxuICBpZiAoZGlyKSB7XG4gICAgdmFyIGZvdW5kSW5kZXggPSAtMVxuICAgIGZvciAoaSA9IGJ5dGVPZmZzZXQ7IGkgPCBhcnJMZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHJlYWQoYXJyLCBpKSA9PT0gcmVhZCh2YWwsIGZvdW5kSW5kZXggPT09IC0xID8gMCA6IGkgLSBmb3VuZEluZGV4KSkge1xuICAgICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIGZvdW5kSW5kZXggPSBpXG4gICAgICAgIGlmIChpIC0gZm91bmRJbmRleCArIDEgPT09IHZhbExlbmd0aCkgcmV0dXJuIGZvdW5kSW5kZXggKiBpbmRleFNpemVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkgaSAtPSBpIC0gZm91bmRJbmRleFxuICAgICAgICBmb3VuZEluZGV4ID0gLTFcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGJ5dGVPZmZzZXQgKyB2YWxMZW5ndGggPiBhcnJMZW5ndGgpIGJ5dGVPZmZzZXQgPSBhcnJMZW5ndGggLSB2YWxMZW5ndGhcbiAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpID49IDA7IGktLSkge1xuICAgICAgdmFyIGZvdW5kID0gdHJ1ZVxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB2YWxMZW5ndGg7IGorKykge1xuICAgICAgICBpZiAocmVhZChhcnIsIGkgKyBqKSAhPT0gcmVhZCh2YWwsIGopKSB7XG4gICAgICAgICAgZm91bmQgPSBmYWxzZVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGlcbiAgICB9XG4gIH1cblxuICByZXR1cm4gLTFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbmNsdWRlcyA9IGZ1bmN0aW9uIGluY2x1ZGVzICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7XG4gIHJldHVybiB0aGlzLmluZGV4T2YodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgIT09IC0xXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIHRydWUpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUubGFzdEluZGV4T2YgPSBmdW5jdGlvbiBsYXN0SW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICByZXR1cm4gYmlkaXJlY3Rpb25hbEluZGV4T2YodGhpcywgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZmFsc2UpXG59XG5cbmZ1bmN0aW9uIGhleFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgb2Zmc2V0ID0gTnVtYmVyKG9mZnNldCkgfHwgMFxuICB2YXIgcmVtYWluaW5nID0gYnVmLmxlbmd0aCAtIG9mZnNldFxuICBpZiAoIWxlbmd0aCkge1xuICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICB9IGVsc2Uge1xuICAgIGxlbmd0aCA9IE51bWJlcihsZW5ndGgpXG4gICAgaWYgKGxlbmd0aCA+IHJlbWFpbmluZykge1xuICAgICAgbGVuZ3RoID0gcmVtYWluaW5nXG4gICAgfVxuICB9XG5cbiAgLy8gbXVzdCBiZSBhbiBldmVuIG51bWJlciBvZiBkaWdpdHNcbiAgdmFyIHN0ckxlbiA9IHN0cmluZy5sZW5ndGhcbiAgaWYgKHN0ckxlbiAlIDIgIT09IDApIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpXG5cbiAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHtcbiAgICBsZW5ndGggPSBzdHJMZW4gLyAyXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBwYXJzZWQgPSBwYXJzZUludChzdHJpbmcuc3Vic3RyKGkgKiAyLCAyKSwgMTYpXG4gICAgaWYgKGlzTmFOKHBhcnNlZCkpIHJldHVybiBpXG4gICAgYnVmW29mZnNldCArIGldID0gcGFyc2VkXG4gIH1cbiAgcmV0dXJuIGlcbn1cblxuZnVuY3Rpb24gdXRmOFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIodXRmOFRvQnl0ZXMoc3RyaW5nLCBidWYubGVuZ3RoIC0gb2Zmc2V0KSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYXNjaWlXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKGFzY2lpVG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBsYXRpbjFXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBhc2NpaVdyaXRlKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYmFzZTY0V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcihiYXNlNjRUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIHVjczJXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKHV0ZjE2bGVUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiB3cml0ZSAoc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCwgZW5jb2RpbmcpIHtcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZylcbiAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZW5jb2RpbmcgPSAndXRmOCdcbiAgICBsZW5ndGggPSB0aGlzLmxlbmd0aFxuICAgIG9mZnNldCA9IDBcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgZW5jb2RpbmcpXG4gIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIG9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICBlbmNvZGluZyA9IG9mZnNldFxuICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoXG4gICAgb2Zmc2V0ID0gMFxuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBvZmZzZXRbLCBsZW5ndGhdWywgZW5jb2RpbmddKVxuICB9IGVsc2UgaWYgKGlzRmluaXRlKG9mZnNldCkpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gICAgaWYgKGlzRmluaXRlKGxlbmd0aCkpIHtcbiAgICAgIGxlbmd0aCA9IGxlbmd0aCB8IDBcbiAgICAgIGlmIChlbmNvZGluZyA9PT0gdW5kZWZpbmVkKSBlbmNvZGluZyA9ICd1dGY4J1xuICAgIH0gZWxzZSB7XG4gICAgICBlbmNvZGluZyA9IGxlbmd0aFxuICAgICAgbGVuZ3RoID0gdW5kZWZpbmVkXG4gICAgfVxuICAvLyBsZWdhY3kgd3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0LCBsZW5ndGgpIC0gcmVtb3ZlIGluIHYwLjEzXG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ0J1ZmZlci53cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXRbLCBsZW5ndGhdKSBpcyBubyBsb25nZXIgc3VwcG9ydGVkJ1xuICAgIClcbiAgfVxuXG4gIHZhciByZW1haW5pbmcgPSB0aGlzLmxlbmd0aCAtIG9mZnNldFxuICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgfHwgbGVuZ3RoID4gcmVtYWluaW5nKSBsZW5ndGggPSByZW1haW5pbmdcblxuICBpZiAoKHN0cmluZy5sZW5ndGggPiAwICYmIChsZW5ndGggPCAwIHx8IG9mZnNldCA8IDApKSB8fCBvZmZzZXQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIHdyaXRlIG91dHNpZGUgYnVmZmVyIGJvdW5kcycpXG4gIH1cblxuICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4J1xuXG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG4gIGZvciAoOzspIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gaGV4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndXRmOCc6XG4gICAgICBjYXNlICd1dGYtOCc6XG4gICAgICAgIHJldHVybiB1dGY4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICByZXR1cm4gYXNjaWlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdsYXRpbjEnOlxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGxhdGluMVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIC8vIFdhcm5pbmc6IG1heExlbmd0aCBub3QgdGFrZW4gaW50byBhY2NvdW50IGluIGJhc2U2NFdyaXRlXG4gICAgICAgIHJldHVybiBiYXNlNjRXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdWNzMldyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIHRvSlNPTiAoKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0J1ZmZlcicsXG4gICAgZGF0YTogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5fYXJyIHx8IHRoaXMsIDApXG4gIH1cbn1cblxuZnVuY3Rpb24gYmFzZTY0U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBpZiAoc3RhcnQgPT09IDAgJiYgZW5kID09PSBidWYubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1ZilcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmLnNsaWNlKHN0YXJ0LCBlbmQpKVxuICB9XG59XG5cbmZ1bmN0aW9uIHV0ZjhTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcbiAgdmFyIHJlcyA9IFtdXG5cbiAgdmFyIGkgPSBzdGFydFxuICB3aGlsZSAoaSA8IGVuZCkge1xuICAgIHZhciBmaXJzdEJ5dGUgPSBidWZbaV1cbiAgICB2YXIgY29kZVBvaW50ID0gbnVsbFxuICAgIHZhciBieXRlc1BlclNlcXVlbmNlID0gKGZpcnN0Qnl0ZSA+IDB4RUYpID8gNFxuICAgICAgOiAoZmlyc3RCeXRlID4gMHhERikgPyAzXG4gICAgICA6IChmaXJzdEJ5dGUgPiAweEJGKSA/IDJcbiAgICAgIDogMVxuXG4gICAgaWYgKGkgKyBieXRlc1BlclNlcXVlbmNlIDw9IGVuZCkge1xuICAgICAgdmFyIHNlY29uZEJ5dGUsIHRoaXJkQnl0ZSwgZm91cnRoQnl0ZSwgdGVtcENvZGVQb2ludFxuXG4gICAgICBzd2l0Y2ggKGJ5dGVzUGVyU2VxdWVuY2UpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGlmIChmaXJzdEJ5dGUgPCAweDgwKSB7XG4gICAgICAgICAgICBjb2RlUG9pbnQgPSBmaXJzdEJ5dGVcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHgxRikgPDwgMHg2IHwgKHNlY29uZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkge1xuICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweEYpIDw8IDB4QyB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKHRoaXJkQnl0ZSAmIDB4M0YpXG4gICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0ZGICYmICh0ZW1wQ29kZVBvaW50IDwgMHhEODAwIHx8IHRlbXBDb2RlUG9pbnQgPiAweERGRkYpKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXVxuICAgICAgICAgIGZvdXJ0aEJ5dGUgPSBidWZbaSArIDNdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwICYmIChmb3VydGhCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweDEyIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweEMgfCAodGhpcmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKGZvdXJ0aEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweEZGRkYgJiYgdGVtcENvZGVQb2ludCA8IDB4MTEwMDAwKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNvZGVQb2ludCA9PT0gbnVsbCkge1xuICAgICAgLy8gd2UgZGlkIG5vdCBnZW5lcmF0ZSBhIHZhbGlkIGNvZGVQb2ludCBzbyBpbnNlcnQgYVxuICAgICAgLy8gcmVwbGFjZW1lbnQgY2hhciAoVStGRkZEKSBhbmQgYWR2YW5jZSBvbmx5IDEgYnl0ZVxuICAgICAgY29kZVBvaW50ID0gMHhGRkZEXG4gICAgICBieXRlc1BlclNlcXVlbmNlID0gMVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50ID4gMHhGRkZGKSB7XG4gICAgICAvLyBlbmNvZGUgdG8gdXRmMTYgKHN1cnJvZ2F0ZSBwYWlyIGRhbmNlKVxuICAgICAgY29kZVBvaW50IC09IDB4MTAwMDBcbiAgICAgIHJlcy5wdXNoKGNvZGVQb2ludCA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMClcbiAgICAgIGNvZGVQb2ludCA9IDB4REMwMCB8IGNvZGVQb2ludCAmIDB4M0ZGXG4gICAgfVxuXG4gICAgcmVzLnB1c2goY29kZVBvaW50KVxuICAgIGkgKz0gYnl0ZXNQZXJTZXF1ZW5jZVxuICB9XG5cbiAgcmV0dXJuIGRlY29kZUNvZGVQb2ludHNBcnJheShyZXMpXG59XG5cbi8vIEJhc2VkIG9uIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIyNzQ3MjcyLzY4MDc0MiwgdGhlIGJyb3dzZXIgd2l0aFxuLy8gdGhlIGxvd2VzdCBsaW1pdCBpcyBDaHJvbWUsIHdpdGggMHgxMDAwMCBhcmdzLlxuLy8gV2UgZ28gMSBtYWduaXR1ZGUgbGVzcywgZm9yIHNhZmV0eVxudmFyIE1BWF9BUkdVTUVOVFNfTEVOR1RIID0gMHgxMDAwXG5cbmZ1bmN0aW9uIGRlY29kZUNvZGVQb2ludHNBcnJheSAoY29kZVBvaW50cykge1xuICB2YXIgbGVuID0gY29kZVBvaW50cy5sZW5ndGhcbiAgaWYgKGxlbiA8PSBNQVhfQVJHVU1FTlRTX0xFTkdUSCkge1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZywgY29kZVBvaW50cykgLy8gYXZvaWQgZXh0cmEgc2xpY2UoKVxuICB9XG5cbiAgLy8gRGVjb2RlIGluIGNodW5rcyB0byBhdm9pZCBcImNhbGwgc3RhY2sgc2l6ZSBleGNlZWRlZFwiLlxuICB2YXIgcmVzID0gJydcbiAgdmFyIGkgPSAwXG4gIHdoaWxlIChpIDwgbGVuKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoXG4gICAgICBTdHJpbmcsXG4gICAgICBjb2RlUG9pbnRzLnNsaWNlKGksIGkgKz0gTUFYX0FSR1VNRU5UU19MRU5HVEgpXG4gICAgKVxuICB9XG4gIHJldHVybiByZXNcbn1cblxuZnVuY3Rpb24gYXNjaWlTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIHZhciByZXQgPSAnJ1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG5cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0gJiAweDdGKVxuICB9XG4gIHJldHVybiByZXRcbn1cblxuZnVuY3Rpb24gbGF0aW4xU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldKVxuICB9XG4gIHJldHVybiByZXRcbn1cblxuZnVuY3Rpb24gaGV4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gYnVmLmxlbmd0aFxuXG4gIGlmICghc3RhcnQgfHwgc3RhcnQgPCAwKSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgfHwgZW5kIDwgMCB8fCBlbmQgPiBsZW4pIGVuZCA9IGxlblxuXG4gIHZhciBvdXQgPSAnJ1xuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgIG91dCArPSB0b0hleChidWZbaV0pXG4gIH1cbiAgcmV0dXJuIG91dFxufVxuXG5mdW5jdGlvbiB1dGYxNmxlU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgYnl0ZXMgPSBidWYuc2xpY2Uoc3RhcnQsIGVuZClcbiAgdmFyIHJlcyA9ICcnXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpICs9IDIpIHtcbiAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSArIGJ5dGVzW2kgKyAxXSAqIDI1NilcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZSAoc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgc3RhcnQgPSB+fnN0YXJ0XG4gIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogfn5lbmRcblxuICBpZiAoc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgKz0gbGVuXG4gICAgaWYgKHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIH0gZWxzZSBpZiAoc3RhcnQgPiBsZW4pIHtcbiAgICBzdGFydCA9IGxlblxuICB9XG5cbiAgaWYgKGVuZCA8IDApIHtcbiAgICBlbmQgKz0gbGVuXG4gICAgaWYgKGVuZCA8IDApIGVuZCA9IDBcbiAgfSBlbHNlIGlmIChlbmQgPiBsZW4pIHtcbiAgICBlbmQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCBzdGFydCkgZW5kID0gc3RhcnRcblxuICB2YXIgbmV3QnVmXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIG5ld0J1ZiA9IHRoaXMuc3ViYXJyYXkoc3RhcnQsIGVuZClcbiAgICBuZXdCdWYuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIHZhciBzbGljZUxlbiA9IGVuZCAtIHN0YXJ0XG4gICAgbmV3QnVmID0gbmV3IEJ1ZmZlcihzbGljZUxlbiwgdW5kZWZpbmVkKVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2xpY2VMZW47ICsraSkge1xuICAgICAgbmV3QnVmW2ldID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ld0J1ZlxufVxuXG4vKlxuICogTmVlZCB0byBtYWtlIHN1cmUgdGhhdCBidWZmZXIgaXNuJ3QgdHJ5aW5nIHRvIHdyaXRlIG91dCBvZiBib3VuZHMuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrT2Zmc2V0IChvZmZzZXQsIGV4dCwgbGVuZ3RoKSB7XG4gIGlmICgob2Zmc2V0ICUgMSkgIT09IDAgfHwgb2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ29mZnNldCBpcyBub3QgdWludCcpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBsZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludExFID0gZnVuY3Rpb24gcmVhZFVJbnRMRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldF1cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludEJFID0gZnVuY3Rpb24gcmVhZFVJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcbiAgfVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF1cbiAgdmFyIG11bCA9IDFcbiAgd2hpbGUgKGJ5dGVMZW5ndGggPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXSAqIG11bFxuICB9XG5cbiAgcmV0dXJuIHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50OCA9IGZ1bmN0aW9uIHJlYWRVSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkxFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiB0aGlzW29mZnNldF0gfCAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCA4KSB8IHRoaXNbb2Zmc2V0ICsgMV1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDMyTEUgPSBmdW5jdGlvbiByZWFkVUludDMyTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcblxuICByZXR1cm4gKCh0aGlzW29mZnNldF0pIHxcbiAgICAgICh0aGlzW29mZnNldCArIDFdIDw8IDgpIHxcbiAgICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSkgK1xuICAgICAgKHRoaXNbb2Zmc2V0ICsgM10gKiAweDEwMDAwMDApXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkJFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gKiAweDEwMDAwMDApICtcbiAgICAoKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgdGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50TEUgPSBmdW5jdGlvbiByZWFkSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cbiAgbXVsICo9IDB4ODBcblxuICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50QkUgPSBmdW5jdGlvbiByZWFkSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgaSA9IGJ5dGVMZW5ndGhcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgLS1pXVxuICB3aGlsZSAoaSA+IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyAtLWldICogbXVsXG4gIH1cbiAgbXVsICo9IDB4ODBcblxuICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50OCA9IGZ1bmN0aW9uIHJlYWRJbnQ4IChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpXG4gIGlmICghKHRoaXNbb2Zmc2V0XSAmIDB4ODApKSByZXR1cm4gKHRoaXNbb2Zmc2V0XSlcbiAgcmV0dXJuICgoMHhmZiAtIHRoaXNbb2Zmc2V0XSArIDEpICogLTEpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2TEUgPSBmdW5jdGlvbiByZWFkSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbiAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gcmVhZEludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgMV0gfCAodGhpc1tvZmZzZXRdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJMRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0pIHxcbiAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAzXSA8PCAyNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgMjQpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCAxNikgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDgpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdExFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCAyMywgNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRCRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdEJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUxFID0gZnVuY3Rpb24gcmVhZERvdWJsZUxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCA1MiwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlQkUgPSBmdW5jdGlvbiByZWFkRG91YmxlQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCA1MiwgOClcbn1cblxuZnVuY3Rpb24gY2hlY2tJbnQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImJ1ZmZlclwiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKVxuICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInZhbHVlXCIgYXJndW1lbnQgaXMgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlVUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKVxuICB9XG5cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlVUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVVSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweGZmLCAwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIHJldHVybiBvZmZzZXQgKyAxXG59XG5cbmZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDE2IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZiArIHZhbHVlICsgMVxuICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDIpOyBpIDwgajsgKytpKSB7XG4gICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlICYgKDB4ZmYgPDwgKDggKiAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSkpKSA+Pj5cbiAgICAgIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpICogOFxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbmZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDMyIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZmZmZmYgKyB2YWx1ZSArIDFcbiAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCA0KTsgaSA8IGo7ICsraSkge1xuICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSA+Pj4gKGxpdHRsZUVuZGlhbiA/IGkgOiAzIC0gaSkgKiA4KSAmIDB4ZmZcbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyTEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSAwXG4gIHZhciBtdWwgPSAxXG4gIHZhciBzdWIgPSAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSAtIDFdICE9PSAwKSB7XG4gICAgICBzdWIgPSAxXG4gICAgfVxuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gMFxuICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSArIDFdICE9PSAwKSB7XG4gICAgICBzdWIgPSAxXG4gICAgfVxuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4N2YsIC0weDgwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZiArIHZhbHVlICsgMVxuICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICByZXR1cm4gb2Zmc2V0ICsgMVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQxNkJFID0gZnVuY3Rpb24gd3JpdGVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5mdW5jdGlvbiBjaGVja0lFRUU3NTQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG4gIGlmIChvZmZzZXQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuZnVuY3Rpb24gd3JpdGVGbG9hdCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA0LCAzLjQwMjgyMzQ2NjM4NTI4ODZlKzM4LCAtMy40MDI4MjM0NjYzODUyODg2ZSszOClcbiAgfVxuICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCAyMywgNClcbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0TEUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUsIG5vQXNzZXJ0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRCRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KVxufVxuXG5mdW5jdGlvbiB3cml0ZURvdWJsZSAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA4LCAxLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCwgLTEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4KVxuICB9XG4gIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDUyLCA4KVxuICByZXR1cm4gb2Zmc2V0ICsgOFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVCRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpXG59XG5cbi8vIGNvcHkodGFyZ2V0QnVmZmVyLCB0YXJnZXRTdGFydD0wLCBzb3VyY2VTdGFydD0wLCBzb3VyY2VFbmQ9YnVmZmVyLmxlbmd0aClcbkJ1ZmZlci5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIGNvcHkgKHRhcmdldCwgdGFyZ2V0U3RhcnQsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKCFzdGFydCkgc3RhcnQgPSAwXG4gIGlmICghZW5kICYmIGVuZCAhPT0gMCkgZW5kID0gdGhpcy5sZW5ndGhcbiAgaWYgKHRhcmdldFN0YXJ0ID49IHRhcmdldC5sZW5ndGgpIHRhcmdldFN0YXJ0ID0gdGFyZ2V0Lmxlbmd0aFxuICBpZiAoIXRhcmdldFN0YXJ0KSB0YXJnZXRTdGFydCA9IDBcbiAgaWYgKGVuZCA+IDAgJiYgZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgLy8gQ29weSAwIGJ5dGVzOyB3ZSdyZSBkb25lXG4gIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm4gMFxuICBpZiAodGFyZ2V0Lmxlbmd0aCA9PT0gMCB8fCB0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcblxuICAvLyBGYXRhbCBlcnJvciBjb25kaXRpb25zXG4gIGlmICh0YXJnZXRTdGFydCA8IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcigndGFyZ2V0U3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIH1cbiAgaWYgKHN0YXJ0IDwgMCB8fCBzdGFydCA+PSB0aGlzLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZVN0YXJ0IG91dCBvZiBib3VuZHMnKVxuICBpZiAoZW5kIDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZUVuZCBvdXQgb2YgYm91bmRzJylcblxuICAvLyBBcmUgd2Ugb29iP1xuICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmICh0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgPCBlbmQgLSBzdGFydCkge1xuICAgIGVuZCA9IHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCArIHN0YXJ0XG4gIH1cblxuICB2YXIgbGVuID0gZW5kIC0gc3RhcnRcbiAgdmFyIGlcblxuICBpZiAodGhpcyA9PT0gdGFyZ2V0ICYmIHN0YXJ0IDwgdGFyZ2V0U3RhcnQgJiYgdGFyZ2V0U3RhcnQgPCBlbmQpIHtcbiAgICAvLyBkZXNjZW5kaW5nIGNvcHkgZnJvbSBlbmRcbiAgICBmb3IgKGkgPSBsZW4gLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF1cbiAgICB9XG4gIH0gZWxzZSBpZiAobGVuIDwgMTAwMCB8fCAhQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBhc2NlbmRpbmcgY29weSBmcm9tIHN0YXJ0XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBVaW50OEFycmF5LnByb3RvdHlwZS5zZXQuY2FsbChcbiAgICAgIHRhcmdldCxcbiAgICAgIHRoaXMuc3ViYXJyYXkoc3RhcnQsIHN0YXJ0ICsgbGVuKSxcbiAgICAgIHRhcmdldFN0YXJ0XG4gICAgKVxuICB9XG5cbiAgcmV0dXJuIGxlblxufVxuXG4vLyBVc2FnZTpcbi8vICAgIGJ1ZmZlci5maWxsKG51bWJlclssIG9mZnNldFssIGVuZF1dKVxuLy8gICAgYnVmZmVyLmZpbGwoYnVmZmVyWywgb2Zmc2V0WywgZW5kXV0pXG4vLyAgICBidWZmZXIuZmlsbChzdHJpbmdbLCBvZmZzZXRbLCBlbmRdXVssIGVuY29kaW5nXSlcbkJ1ZmZlci5wcm90b3R5cGUuZmlsbCA9IGZ1bmN0aW9uIGZpbGwgKHZhbCwgc3RhcnQsIGVuZCwgZW5jb2RpbmcpIHtcbiAgLy8gSGFuZGxlIHN0cmluZyBjYXNlczpcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKHR5cGVvZiBzdGFydCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGVuY29kaW5nID0gc3RhcnRcbiAgICAgIHN0YXJ0ID0gMFxuICAgICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbmQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBlbmNvZGluZyA9IGVuZFxuICAgICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgICB9XG4gICAgaWYgKHZhbC5sZW5ndGggPT09IDEpIHtcbiAgICAgIHZhciBjb2RlID0gdmFsLmNoYXJDb2RlQXQoMClcbiAgICAgIGlmIChjb2RlIDwgMjU2KSB7XG4gICAgICAgIHZhbCA9IGNvZGVcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIGVuY29kaW5nICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZW5jb2RpbmcgbXVzdCBiZSBhIHN0cmluZycpXG4gICAgfVxuICAgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnICYmICFCdWZmZXIuaXNFbmNvZGluZyhlbmNvZGluZykpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICB2YWwgPSB2YWwgJiAyNTVcbiAgfVxuXG4gIC8vIEludmFsaWQgcmFuZ2VzIGFyZSBub3Qgc2V0IHRvIGEgZGVmYXVsdCwgc28gY2FuIHJhbmdlIGNoZWNrIGVhcmx5LlxuICBpZiAoc3RhcnQgPCAwIHx8IHRoaXMubGVuZ3RoIDwgc3RhcnQgfHwgdGhpcy5sZW5ndGggPCBlbmQpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignT3V0IG9mIHJhbmdlIGluZGV4JylcbiAgfVxuXG4gIGlmIChlbmQgPD0gc3RhcnQpIHtcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgc3RhcnQgPSBzdGFydCA+Pj4gMFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IHRoaXMubGVuZ3RoIDogZW5kID4+PiAwXG5cbiAgaWYgKCF2YWwpIHZhbCA9IDBcblxuICB2YXIgaVxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgICB0aGlzW2ldID0gdmFsXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBieXRlcyA9IEJ1ZmZlci5pc0J1ZmZlcih2YWwpXG4gICAgICA/IHZhbFxuICAgICAgOiB1dGY4VG9CeXRlcyhuZXcgQnVmZmVyKHZhbCwgZW5jb2RpbmcpLnRvU3RyaW5nKCkpXG4gICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aFxuICAgIGZvciAoaSA9IDA7IGkgPCBlbmQgLSBzdGFydDsgKytpKSB7XG4gICAgICB0aGlzW2kgKyBzdGFydF0gPSBieXRlc1tpICUgbGVuXVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8vIEhFTFBFUiBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PT1cblxudmFyIElOVkFMSURfQkFTRTY0X1JFID0gL1teK1xcLzAtOUEtWmEtei1fXS9nXG5cbmZ1bmN0aW9uIGJhc2U2NGNsZWFuIChzdHIpIHtcbiAgLy8gTm9kZSBzdHJpcHMgb3V0IGludmFsaWQgY2hhcmFjdGVycyBsaWtlIFxcbiBhbmQgXFx0IGZyb20gdGhlIHN0cmluZywgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHN0ciA9IHN0cmluZ3RyaW0oc3RyKS5yZXBsYWNlKElOVkFMSURfQkFTRTY0X1JFLCAnJylcbiAgLy8gTm9kZSBjb252ZXJ0cyBzdHJpbmdzIHdpdGggbGVuZ3RoIDwgMiB0byAnJ1xuICBpZiAoc3RyLmxlbmd0aCA8IDIpIHJldHVybiAnJ1xuICAvLyBOb2RlIGFsbG93cyBmb3Igbm9uLXBhZGRlZCBiYXNlNjQgc3RyaW5ncyAobWlzc2luZyB0cmFpbGluZyA9PT0pLCBiYXNlNjQtanMgZG9lcyBub3RcbiAgd2hpbGUgKHN0ci5sZW5ndGggJSA0ICE9PSAwKSB7XG4gICAgc3RyID0gc3RyICsgJz0nXG4gIH1cbiAgcmV0dXJuIHN0clxufVxuXG5mdW5jdGlvbiBzdHJpbmd0cmltIChzdHIpIHtcbiAgaWYgKHN0ci50cmltKSByZXR1cm4gc3RyLnRyaW0oKVxuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKVxufVxuXG5mdW5jdGlvbiB0b0hleCAobikge1xuICBpZiAobiA8IDE2KSByZXR1cm4gJzAnICsgbi50b1N0cmluZygxNilcbiAgcmV0dXJuIG4udG9TdHJpbmcoMTYpXG59XG5cbmZ1bmN0aW9uIHV0ZjhUb0J5dGVzIChzdHJpbmcsIHVuaXRzKSB7XG4gIHVuaXRzID0gdW5pdHMgfHwgSW5maW5pdHlcbiAgdmFyIGNvZGVQb2ludFxuICB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aFxuICB2YXIgbGVhZFN1cnJvZ2F0ZSA9IG51bGxcbiAgdmFyIGJ5dGVzID0gW11cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgY29kZVBvaW50ID0gc3RyaW5nLmNoYXJDb2RlQXQoaSlcblxuICAgIC8vIGlzIHN1cnJvZ2F0ZSBjb21wb25lbnRcbiAgICBpZiAoY29kZVBvaW50ID4gMHhEN0ZGICYmIGNvZGVQb2ludCA8IDB4RTAwMCkge1xuICAgICAgLy8gbGFzdCBjaGFyIHdhcyBhIGxlYWRcbiAgICAgIGlmICghbGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgICAvLyBubyBsZWFkIHlldFxuICAgICAgICBpZiAoY29kZVBvaW50ID4gMHhEQkZGKSB7XG4gICAgICAgICAgLy8gdW5leHBlY3RlZCB0cmFpbFxuICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH0gZWxzZSBpZiAoaSArIDEgPT09IGxlbmd0aCkge1xuICAgICAgICAgIC8vIHVucGFpcmVkIGxlYWRcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gdmFsaWQgbGVhZFxuICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50XG5cbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gMiBsZWFkcyBpbiBhIHJvd1xuICAgICAgaWYgKGNvZGVQb2ludCA8IDB4REMwMCkge1xuICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICAvLyB2YWxpZCBzdXJyb2dhdGUgcGFpclxuICAgICAgY29kZVBvaW50ID0gKGxlYWRTdXJyb2dhdGUgLSAweEQ4MDAgPDwgMTAgfCBjb2RlUG9pbnQgLSAweERDMDApICsgMHgxMDAwMFxuICAgIH0gZWxzZSBpZiAobGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgLy8gdmFsaWQgYm1wIGNoYXIsIGJ1dCBsYXN0IGNoYXIgd2FzIGEgbGVhZFxuICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgfVxuXG4gICAgbGVhZFN1cnJvZ2F0ZSA9IG51bGxcblxuICAgIC8vIGVuY29kZSB1dGY4XG4gICAgaWYgKGNvZGVQb2ludCA8IDB4ODApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMSkgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChjb2RlUG9pbnQpXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDgwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2IHwgMHhDMCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTAwMDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMykgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4QyB8IDB4RTAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTEwMDAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDQpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDEyIHwgMHhGMCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4QyAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjb2RlIHBvaW50JylcbiAgICB9XG4gIH1cblxuICByZXR1cm4gYnl0ZXNcbn1cblxuZnVuY3Rpb24gYXNjaWlUb0J5dGVzIChzdHIpIHtcbiAgdmFyIGJ5dGVBcnJheSA9IFtdXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgLy8gTm9kZSdzIGNvZGUgc2VlbXMgdG8gYmUgZG9pbmcgdGhpcyBhbmQgbm90ICYgMHg3Ri4uXG4gICAgYnl0ZUFycmF5LnB1c2goc3RyLmNoYXJDb2RlQXQoaSkgJiAweEZGKVxuICB9XG4gIHJldHVybiBieXRlQXJyYXlcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVRvQnl0ZXMgKHN0ciwgdW5pdHMpIHtcbiAgdmFyIGMsIGhpLCBsb1xuICB2YXIgYnl0ZUFycmF5ID0gW11cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWtcblxuICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKVxuICAgIGhpID0gYyA+PiA4XG4gICAgbG8gPSBjICUgMjU2XG4gICAgYnl0ZUFycmF5LnB1c2gobG8pXG4gICAgYnl0ZUFycmF5LnB1c2goaGkpXG4gIH1cblxuICByZXR1cm4gYnl0ZUFycmF5XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFRvQnl0ZXMgKHN0cikge1xuICByZXR1cm4gYmFzZTY0LnRvQnl0ZUFycmF5KGJhc2U2NGNsZWFuKHN0cikpXG59XG5cbmZ1bmN0aW9uIGJsaXRCdWZmZXIgKHNyYywgZHN0LCBvZmZzZXQsIGxlbmd0aCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgaWYgKChpICsgb2Zmc2V0ID49IGRzdC5sZW5ndGgpIHx8IChpID49IHNyYy5sZW5ndGgpKSBicmVha1xuICAgIGRzdFtpICsgb2Zmc2V0XSA9IHNyY1tpXVxuICB9XG4gIHJldHVybiBpXG59XG5cbmZ1bmN0aW9uIGlzbmFuICh2YWwpIHtcbiAgcmV0dXJuIHZhbCAhPT0gdmFsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2VsZi1jb21wYXJlXG59XG4iLCJleHBvcnRzLnJlYWQgPSBmdW5jdGlvbiAoYnVmZmVyLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykge1xuICB2YXIgZSwgbVxuICB2YXIgZUxlbiA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMVxuICB2YXIgZU1heCA9ICgxIDw8IGVMZW4pIC0gMVxuICB2YXIgZUJpYXMgPSBlTWF4ID4+IDFcbiAgdmFyIG5CaXRzID0gLTdcbiAgdmFyIGkgPSBpc0xFID8gKG5CeXRlcyAtIDEpIDogMFxuICB2YXIgZCA9IGlzTEUgPyAtMSA6IDFcbiAgdmFyIHMgPSBidWZmZXJbb2Zmc2V0ICsgaV1cblxuICBpICs9IGRcblxuICBlID0gcyAmICgoMSA8PCAoLW5CaXRzKSkgLSAxKVxuICBzID4+PSAoLW5CaXRzKVxuICBuQml0cyArPSBlTGVuXG4gIGZvciAoOyBuQml0cyA+IDA7IGUgPSBlICogMjU2ICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHt9XG5cbiAgbSA9IGUgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgZSA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gbUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBtID0gbSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fVxuXG4gIGlmIChlID09PSAwKSB7XG4gICAgZSA9IDEgLSBlQmlhc1xuICB9IGVsc2UgaWYgKGUgPT09IGVNYXgpIHtcbiAgICByZXR1cm4gbSA/IE5hTiA6ICgocyA/IC0xIDogMSkgKiBJbmZpbml0eSlcbiAgfSBlbHNlIHtcbiAgICBtID0gbSArIE1hdGgucG93KDIsIG1MZW4pXG4gICAgZSA9IGUgLSBlQmlhc1xuICB9XG4gIHJldHVybiAocyA/IC0xIDogMSkgKiBtICogTWF0aC5wb3coMiwgZSAtIG1MZW4pXG59XG5cbmV4cG9ydHMud3JpdGUgPSBmdW5jdGlvbiAoYnVmZmVyLCB2YWx1ZSwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHtcbiAgdmFyIGUsIG0sIGNcbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBydCA9IChtTGVuID09PSAyMyA/IE1hdGgucG93KDIsIC0yNCkgLSBNYXRoLnBvdygyLCAtNzcpIDogMClcbiAgdmFyIGkgPSBpc0xFID8gMCA6IChuQnl0ZXMgLSAxKVxuICB2YXIgZCA9IGlzTEUgPyAxIDogLTFcbiAgdmFyIHMgPSB2YWx1ZSA8IDAgfHwgKHZhbHVlID09PSAwICYmIDEgLyB2YWx1ZSA8IDApID8gMSA6IDBcblxuICB2YWx1ZSA9IE1hdGguYWJzKHZhbHVlKVxuXG4gIGlmIChpc05hTih2YWx1ZSkgfHwgdmFsdWUgPT09IEluZmluaXR5KSB7XG4gICAgbSA9IGlzTmFOKHZhbHVlKSA/IDEgOiAwXG4gICAgZSA9IGVNYXhcbiAgfSBlbHNlIHtcbiAgICBlID0gTWF0aC5mbG9vcihNYXRoLmxvZyh2YWx1ZSkgLyBNYXRoLkxOMilcbiAgICBpZiAodmFsdWUgKiAoYyA9IE1hdGgucG93KDIsIC1lKSkgPCAxKSB7XG4gICAgICBlLS1cbiAgICAgIGMgKj0gMlxuICAgIH1cbiAgICBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIHZhbHVlICs9IHJ0IC8gY1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZSArPSBydCAqIE1hdGgucG93KDIsIDEgLSBlQmlhcylcbiAgICB9XG4gICAgaWYgKHZhbHVlICogYyA+PSAyKSB7XG4gICAgICBlKytcbiAgICAgIGMgLz0gMlxuICAgIH1cblxuICAgIGlmIChlICsgZUJpYXMgPj0gZU1heCkge1xuICAgICAgbSA9IDBcbiAgICAgIGUgPSBlTWF4XG4gICAgfSBlbHNlIGlmIChlICsgZUJpYXMgPj0gMSkge1xuICAgICAgbSA9ICh2YWx1ZSAqIGMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pXG4gICAgICBlID0gZSArIGVCaWFzXG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSB2YWx1ZSAqIE1hdGgucG93KDIsIGVCaWFzIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IDBcbiAgICB9XG4gIH1cblxuICBmb3IgKDsgbUxlbiA+PSA4OyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBtICYgMHhmZiwgaSArPSBkLCBtIC89IDI1NiwgbUxlbiAtPSA4KSB7fVxuXG4gIGUgPSAoZSA8PCBtTGVuKSB8IG1cbiAgZUxlbiArPSBtTGVuXG4gIGZvciAoOyBlTGVuID4gMDsgYnVmZmVyW29mZnNldCArIGldID0gZSAmIDB4ZmYsIGkgKz0gZCwgZSAvPSAyNTYsIGVMZW4gLT0gOCkge31cblxuICBidWZmZXJbb2Zmc2V0ICsgaSAtIGRdIHw9IHMgKiAxMjhcbn1cbiIsInZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGFycikge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChhcnIpID09ICdbb2JqZWN0IEFycmF5XSc7XG59O1xuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGdyYXlTcHJpdGU6IGNjLlNwcml0ZSxcclxuXHJcbiAgICAgICAgX2NhcmROYW1lOiBudWxsLFxyXG4gICAgICAgIF9rcUNhcmRNb2RlOiBudWxsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuZ3JheVNwcml0ZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDpgJrov4fniYzlkI3orr7nva7niYxcclxuICAgIHNldENhcmQ6IGZ1bmN0aW9uIChjYXJkTmFtZSkge1xyXG4gICAgICB0aGlzLl9zZXRDYXJkTmFtZShjYXJkTmFtZSk7XHJcblxyXG4gICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKGNhcmROYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcclxuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xyXG4gICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjYXJkTmFtZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FyZE5hbWU7XHJcbiAgICB9LFxyXG5cclxuICAgIGNhcmRNb2RlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9rcUNhcmRNb2RlO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc2V0Q2FyZE5hbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSkge1xyXG4gICAgICB0aGlzLl9jYXJkTmFtZSA9IGNhcmROYW1lO1xyXG4gICAgICB0aGlzLl9rcUNhcmRNb2RlID0gbmV3IEtRQ2FyZChjYXJkTmFtZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOiuvue9rumAieaLqeeKtuaAgVxyXG4gICAgc2V0U2VsZWN0ZWQ6IGZ1bmN0aW9uIChzZWxlY3RlZCA9IGZhbHNlKSB7XHJcbiAgICAgIHRoaXMuZ3JheVNwcml0ZS5ub2RlLmFjdGl2ZSA9IHNlbGVjdGVkO1xyXG4gICAgfSxcclxuXHJcbiAgICBpc1NlbGVjdGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmdyYXlTcHJpdGUubm9kZS5hY3RpdmU7XHJcbiAgICB9LFxyXG5cclxuICAgIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lKSB7XHJcbiAgICAgIHZhciBjYXJkTmFtZSA9IGNhcmRTaG9ydE5hbWU7XHJcbiAgICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChcInB1YmxpYy1waWMtY2FyZC1wb2tlclwiKSkge1xyXG4gICAgICAgIGNhcmROYW1lID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIGNhcmROYW1lO1xyXG4gICAgfSxcclxuXHJcbiAgICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICBjYy5hc3NlcnQoY2FsbGJhY2spO1xyXG5cclxuICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCJwbGF5L0NhcmRUeXBlQ29tYmluZS9wb2NrTGlzdFwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcclxuICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICBjYy5lcnJvcihlcnIpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUpO1xyXG4gICAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcclxuICAgICAgICBjYWxsYmFjayhmcmFtZSk7XHJcbiAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG59KTtcclxuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XHJcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcclxuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XHJcbmNvbnN0IHBsYXkgPSByZXF1aXJlKCdwbGF5Jyk7XHJcbmNvbnN0IEtRQ2FyZFNjb3JldHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRTY29yZXRzSGVscGVyJyk7XHJcbi8vIOeJjOexu+WeiyBjb21wb25lbnRcclxuLy9cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgc3RhdGljczoge1xyXG4gICAgICAgIGluc3RhbmNlczogbnVsbCxcclxuICAgIH0sXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgY2FyZHNMYXlvdXQ6IGNjLkxheW91dCxcclxuICAgICAgICAvLyBidG5EdWlaaTogY2MuQnV0dG9uLFxyXG4gICAgICAgIC8vIGJ0bkxpYW5nRHVpOiBjYy5CdXR0b24sXHJcbiAgICAgICAgLy8gYnRuU2FuVGlhbzogY2MuQnV0dG9uLFxyXG4gICAgICAgIC8vIGJ0blNodW5aaTogY2MuQnV0dG9uLFxyXG4gICAgICAgIC8vIGJ0blRvbmdIdWE6IGNjLkJ1dHRvbixcclxuICAgICAgICAvLyBidG5IdUx1OiBjYy5CdXR0b24sXHJcbiAgICAgICAgLy8gYnRuVGllWmhpOiBjYy5CdXR0b24sXHJcbiAgICAgICAgLy8gYnRuVG9uZ0h1YVNodW46IGNjLkJ1dHRvbixcclxuICAgICAgICAvLyBidG5XdVRvbmc6IGNjLkJ1dHRvbixcclxuICAgICAgICAvLyB0eXBlQnV0dG9uc05vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgYnRuRGVsZXRlVG91RGFvOiBjYy5CdXR0b24sICAgLy8g5aS06YGTXHJcbiAgICAgICAgYnRuRGVsZXRlWmhvbmdEYW86IGNjLkJ1dHRvbiwgLy8g5Lit6YGTXHJcbiAgICAgICAgYnRuRGVsZXRlV2VpRGFvOiBjYy5CdXR0b24sICAgLy8g5bC+6YGTXHJcbiAgICAgICAgYnRuQ2FuY2VsQWxsOiBjYy5CdXR0b24sICAgICAgLy8g5YWo6YOo5Y+W5raIXHJcbiAgICAgICAgYnRuRG9uZTogY2MuQnV0dG9uLCAgICAgICAgICAgLy8g56Gu5a6a5Ye654mMXHJcbiAgICAgICAgdGltZU5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgbGFiZWxUaW1lOiBjYy5MYWJlbCxcclxuICAgICAgICBsYXlvdXRUb3VEYW86IGNjLkxheW91dCxcclxuICAgICAgICBsYXlvdXRaaG9uZ0RhbzogY2MuTGF5b3V0LFxyXG4gICAgICAgIGxheW91dFdlaURhbzogY2MuTGF5b3V0LFxyXG4gICAgICAgIGNhcmRBbGxOb2RlOmNjLk5vZGUsXHJcbiAgICAgICAgY2FyZFByZWZhYjogY2MuUHJlZmFiLFxyXG4gICAgICAgIGNhcmRUeXBlUHJlZmFiOiBjYy5QcmVmYWIsXHJcblxyXG4gICAgICAgIHRvdURhb05vZGU6Y2MuTm9kZSxcclxuICAgICAgICB6aG9uZ0Rhb05vZGU6Y2MuTm9kZSxcclxuICAgICAgICB3ZWlEYW9Ob2RlOmNjLk5vZGUsXHJcblxyXG4gICAgICAgIGF1dG9DYXJkU2Nyb2xsVmlldzogY2MuU2Nyb2xsVmlldyxcclxuICAgICAgICBhdXRvQ2FyZDogY2MuUHJlZmFiLFxyXG4gICAgICAgIGF1dG9DYXJkTGF5b3V0OiBjYy5MYXlvdXQsXHJcbiAgICAgICAgYXV0b0NhcmRBbmltYXRpb246Y2MuTm9kZSxcclxuXHJcblxyXG4gICAgICAgIExheW91dFdpdGhFdmVudDogW10sXHJcblxyXG4gICAgICAgIEJ0bkNsaWNrR29uZ1hpTmlDb21maXJtOmZhbHNlLCAgLy/nlKjkuo7mo4Dmn6XnlKjmiLfmmK/lkKbngrnlh7vkuobmga3llpzkvaDpobXpnaLnmoTnoa7lrprmjInpkq5cclxuICAgICAgICBjYXJkc0xheW91dFNvcnRDb2xvcjogZmFsc2UsXHJcbiAgICAgICAgLyojIyMjIyovXHJcblxyXG4gICAgICAgIF9jYXJkT2Zmc2V0WTogbnVsbCxcclxuXHJcbiAgICAgICAgX2txQ2FyZE1vZGVzOiBbXSxcclxuICAgICAgICBfYWxsQ2FyZE1vZGVzOiBbXSxcclxuICAgICAgICBfZmluZENhcmRUeXBlT2JqZWN0OiBudWxsLCAgLy8g55So5p2l6K6w5b2V5om+5Yiw55qE54mM5Z6L5a+56LGhXHJcbiAgICAgICAgX2ZpbmRDYXJkSW5kZXg6IG51bGwsICAvLyDnlKjmnaXorrDlvZXmib7liLDnmoTniYzlnovlr7nosaFcclxuXHJcbiAgICAgICAgX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2s6IG51bGwsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5CdG5DbGlja0dvbmdYaU5pQ29tZmlybSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9jYXJkT2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJUb3VjaEV2ZW50cygpO1xyXG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyRGFvc0xheW91dENsaWNrRXZlbnQoKTtcclxuICAgICAgICB0aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgdGhpcy5fZmluZENhcmRJbmRleCA9IHt9O1xyXG4gICAgICAgIHRoaXMuY2FyZFRpbWUgPSAwLjM7XHJcblxyXG4gICAgICAgIHRoaXMuY2FyZFNwcml0ZUF0bGFzID0gdGhpcy5ub2RlLnBhcmVudC5nZXRDb21wb25lbnQoJ3BsYXknKS5jYXJkU3ByaXRlQXRsYXM7XHJcbiAgICAgICAgdGhpcy5kYW9TcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQuZ2V0Q29tcG9uZW50KCdwbGF5JykuZGFvU3ByaXRlQXRsYXM7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyPngrnlh7vnqbrnmb3lnLDmlrnlsIbniYzmlLblm57ljrsqL1xyXG4gICAgb25DbGlja0NhcmRUeXBlQ29tYmluZU5vZGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9oaWRlRGVsZXRlQnV0dG9uczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vdGhpcy5idG5EZWxldGVUb3VEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL3RoaXMuYnRuRGVsZXRlWmhvbmdEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL3RoaXMuYnRuRGVsZXRlV2VpRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOmHjee9ru+8jOWbnuWIsOacgOWIneWni+acieeKtuaAgVxyXG4gICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9oaWRlRGVsZXRlQnV0dG9ucygpO1xyXG4gICAgICAgIHRoaXMuY2xlYXJDYXJkcygpO1xyXG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICAvL3RoaXMuX3R5cGVCdXR0b25zKCkuZm9yRWFjaChmdW5jdGlvbiAoYnV0dG9uKSB7XHJcbiAgICAgICAgLy8gICAgYnV0dG9uLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfSk7XHJcbiAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzID0gW107XHJcbiAgICB9LFxyXG5cclxuICAgIGNhcmRzTGF5b3V0U29ydDogZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB2YXIgbm9kZUF5eSA9IGUudGFyZ2V0LmNoaWxkcmVuO1xyXG4gICAgICAgIGlmKG5vZGVBeXlbMF0uYWN0aXZlID09IHRydWUpey8v5oyJ5aSn5bCPXHJcbiAgICAgICAgICAgIHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSB0cnVlO1xyXG4gICAgICAgICAgICBub2RlQXl5WzBdLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBub2RlQXl5WzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKG5vZGVBeXlbMV0uYWN0aXZlID09IHRydWUpey8v5oyJ6Iqx6ImyXHJcbiAgICAgICAgICAgIHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSBmYWxzZTtcclxuICAgICAgICAgICAgbm9kZUF5eVswXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBub2RlQXl5WzFdLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25YKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9IG5vZGVBeXlbMV0uYWN0aXZlID09IGZhbHNlO1xyXG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9PSB0cnVlXHJcbiAgICB9LFxyXG5cclxuICAgIGFkZENhcmRzOiBmdW5jdGlvbiAoY2FyZE5hbWVzKSB7XHJcbiAgICAgICAgY2MuYXNzZXJ0KGNhcmROYW1lcyk7XHJcbiAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xyXG4gICAgICAgIC8vY2FyZE5hbWVzLnNvcnQoZnVuY3Rpb24oYTEsYTIpe1xyXG4gICAgICAgIC8vICAgIHJldHVybiBhMS5zcGxpdCgnXycpWzBdIC0gYTIuc3BsaXQoJ18nKVswXTtcclxuICAgICAgICAvL30pXHJcbiAgICAgICAgY2FyZE5hbWVzLmZvckVhY2goZnVuY3Rpb24oY2FyZCxpbmRleCl7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkQ2FyZChjYXJkLGZhbHNlLGluZGV4KVxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0U29ydCgpO1xyXG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcclxuICAgICAgICB0aGlzLl9yZWxvYWRLUUNhcmRNb2Rlc0lubmVyKCk7XHJcbiAgICAgICAgdGhpcy5fcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHModGhpcy5fa3FDYXJkTW9kZXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBhZGRDYXJkOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGF1dG9DaGFuZ2VQb3NpdGlvblggPSBmYWxzZSxpbmRleCA9IG51bGwpIHtcclxuICAgICAgICBjYy5hc3NlcnQoY2FyZE5hbWUubGVuZ3RoID4gMCk7XHJcblxyXG4gICAgICAgIGxldCBjYXJkUHJlZmFiID0gY2MuaW5zdGFudGlhdGUodGhpcy5jYXJkUHJlZmFiKTtcclxuICAgICAgICBjYXJkUHJlZmFiLm5hbWUgPSBjYXJkTmFtZTtcclxuICAgICAgICAvLyBpZihjYy5tYVBhaSl7XHJcbiAgICAgICAgLy8gICAgIHZhciBjYXJkTWFQYWkgPSAnM18nICsgY2MubWFQYWk7XHJcbiAgICAgICAgLy8gICAgIGlmKGNhcmROYW1lID09IGNhcmRNYVBhaSl7XHJcbiAgICAgICAgLy8gICAgICAgICBjYXJkUHJlZmFiLmNvbG9yID0gbmV3IGNjLkNvbG9yKDIyNiwgMTQ1LCAxNDUpO1xyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuc2V0Q2FyZChjYXJkTmFtZSxpbmRleCk7XHJcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLmFkZENoaWxkKGNhcmRQcmVmYWIpO1xyXG4gICAgICAgIGNhcmRQcmVmYWIuc2V0UG9zaXRpb25ZKHRoaXMuX2NhcmRPZmZzZXRZKTtcclxuXHJcbiAgICAgICAgaWYgKGF1dG9DaGFuZ2VQb3NpdGlvblgpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL2xldCBuZXdDYXJkID0gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcclxuICAgICAgICAvL2xldCBvcmlnaW5DYXJkID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmZpbmQoZnVuY3Rpb24oY2FyZCkge1xyXG4gICAgICAgIC8vICAgIHJldHVybiBjYXJkLmlzRXF1YWwobmV3Q2FyZCk7XHJcbiAgICAgICAgLy99KTtcclxuICAgICAgICAvL2lmIChvcmlnaW5DYXJkID09IG51bGwgJiYgIWF1dG9DaGFuZ2VQb3NpdGlvblgpIHtcclxuICAgICAgICAvLyAgICB0aGlzLl9hbGxDYXJkTW9kZXMucHVzaChuZXdDYXJkKTtcclxuICAgICAgICAvL31cclxuICAgIH0sXHJcblxyXG4gICAgYWRkQ2FyZE1vZGVzOiBmdW5jdGlvbiAoY2FyZE5hbWVzKSB7XHJcbiAgICAgICAgY2MuYXNzZXJ0KGNhcmROYW1lcy5sZW5ndGggPiAwKTtcclxuICAgICAgICB0aGlzLl9hbGxDYXJkTW9kZXMgPSBbXTtcclxuICAgICAgICBjYXJkTmFtZXMuZm9yRWFjaChmdW5jdGlvbihjYXJkTmFtZSxpbmRleCl7XHJcbiAgICAgICAgICAgIGxldCBuZXdDYXJkID0gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcclxuICAgICAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzLnB1c2gobmV3Q2FyZCk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcblxyXG4gICAgcmVsb2FkQ2FyZHM6IGZ1bmN0aW9uIChjYXJkTmFtZXMpIHtcclxuICAgICAgICAvL2NhcmROYW1lcz1bJzFfMScsICcyXzEnLCAnM18xMScsICcxXzEyJywgJzJfMicsICczXzInLCAnNF8xMScsICc0XzEyJywgJzNfMTMnLCAnMl81JywgJzFfMTMnLCAnNF8zJywgJzFfMyddO1xyXG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzFfMScsICcyXzEnLCAnM18xMScsICcxXzEyJywgJzJfMicsICczXzInLCAnNF8xMScsICc0XzEyJywgJzNfMTMnLCAnMl81JywgJzFfMTMnLCAnNF8zJywgJzFfMyddO1xyXG4gICAgICAgIC8v5LiJ5bqm5ZCM6IqxXHJcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMl8xMycsICcyXzUnLCAnMl83JywgJzNfMScsICczXzInLCAnM180JywgJzNfMycsICczXzEzJywgJzFfMTInLCAnMV82JywgJzFfMScsICcxXzQnLCAnMV81J107XHJcbiAgICAgICAgLy/kuInlkIzoirHpobpcclxuICAgICAgICAvLyAgY2FyZE5hbWVzPVsnMl8xJywgJzJfMicsICcyXzMnLCAnMl80JywgJzJfNScsICczXzYnLCAnM183JywgJzNfOCcsICczXzknLCAnM18xMCcsICc0XzEnLCAnNF8yJywgJzRfMyddO1xyXG4gICAgICAgIC8v5LiA5p2h6b6ZXHJcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMl8xJywgJzJfMicsICcyXzMnLCAnMl80JywgJzJfNScsICczXzYnLCAnM183JywgJzNfOCcsICczXzknLCAnM18xMCcsICcxXzExJywgJzFfMTInLCAnMV8xMyddO1xyXG4gICAgICAgIC8v5LiJ6aG65a2QXHJcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzEnLCAnM18yJywgJzRfMycsICcxXzcnLCAnNF81JywgJzRfNicsICczXzknLCAnNF84JywgJzNfMScsICcxXzEzJywgJzRfMTInLCAnNF8xMScsICcyXzEwJ107XHJcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnM181JywgJzNfNCcsICc0XzMnLCAnMV8yJywgJzNfMScsICc0XzknLCAnM185JywgJzRfOCcsICczXzEwJywgJzFfMTMnLCAnNF8xMicsICc0XzExJywgJzJfMTAnXTtcclxuICAgICAgICAvLyBjYXJkTmFtZXM9WyczXzUnLCAnM180JywgJzRfMycsICcxXzInLCAnM18xJywgJzRfNScsICczXzYnLCAnNF84JywgJzNfNicsICcxXzEzJywgJzRfMTInLCAnNF8xMScsICcyXzcnXTtcclxuICAgICAgICAvL2NhcmROYW1lcz1bJzNfNCcsICczXzQnLCAnNF82JywgJzJfMjAnLCAnMV8yMCcsICcxXzIwJywgJzNfNicsICc0XzgnLCAnM182JywgJzFfOCcsICc0XzEyJywgJzRfMTEnLCAnMl8yMCddO1xyXG4gICAgICAgIC8v5LiJ5Liw5aSp5LiLXHJcbiAgICAgICAgLy9jYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMScsICcxXzInLCAnMl8yJywgJzNfMicsICc0XzEnLCAnNF8yJywgJzNfMycsICcyXzMnLCAnMV8zJywgJzRfMycsICcxXzEzJ107XHJcbiAgICAgICAgLy805Liw5aSp5LiLXHJcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMV8xJywgJzJfMScsICczXzEnLCAnMV80JywgJzJfNCcsICczXzInLCAnNF8yJywgJzFfMicsICczXzQnLCAnMl8zJywgJzFfMycsICc0XzMnLCAnMV8yJ107XHJcbiAgICAgICAgLy/lha3lsoHljYpcclxuICAgICAgICAvLyBjYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMTEnLCAnMV8xMicsICcyXzInLCAnM18yJywgJzRfMTEnLCAnNF8xMicsICczXzEzJywgJzJfNScsICcxXzEzJywgJzRfMycsICcxXzMnXTtcclxuICAgICAgICAvL2NhcmROYW1lcz1bJzFfOScsICcyXzExJywgJzNfOCcsICcxXzEyJywgJzJfMicsICczXzInLCAnMV8xMycsICcyXzUnLCAnM181JywnMV80JywgJzJfNCcsICczXzQnLCAnM18xMCddO1xyXG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzRfOScsICcyXzMnLCAnM180JywgJzNfNicsICcyXzEnLCAnMl80JywgJzJfMicsICcyXzUnLCAnMl8xMycsJzJfOCcsICcyXzEwJywgJzJfMTEnLCAnMl8xMiddO1xyXG4gICAgICAgIC8vICAgY2FyZE5hbWVzPVsnNF8yJywgJzJfMycsICczXzQnLCAnM181JywgJzJfMScsICcyXzQnLCAnMl8yJywgJzJfNScsICcyXzEzJywnMl84JywgJzJfMTAnLCAnMl8xMScsICcyXzEyJ107XHJcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzEnLCAnMl8xJywgJzFfNCcsICczXzQnLCAnMV82JywgJzJfNicsICcxXzgnLCAnM184JywgJzJfOCcsJzJfMTInLCAnMV8xMicsICcyXzEzJywgJzNfMTMnXTtcclxuICAgICAgICAvLyBjYXJkTmFtZXM9Wyc0XzknLCAnMl8zJywgJzNfNCcsICczXzYnLCAnMl84JywgJzJfOScsICcyXzEwJywgJzJfMTEnLCAnMl8xMycsJzNfMTMnLCAnM18xMicsICcyXzEyJywgJzFfMTInXTtcclxuICAgICAgICAvLyBjYXJkTmFtZXM9Wyc0XzknLCAnMl85JywgJzNfNCcsICczXzYnLCAnMV84JywgJzJfMScsICcyXzUnLCAnMl80JywgJzJfMycsJzNfMTMnLCAnM18xMicsICcyXzInLCAnMV8xMiddO1xyXG4gICAgICAgIC8vY2FyZE5hbWVzPVsnM18yJywgJzRfMicsICcyXzQnLCAnM181JywgJzFfNScsICczXzcnLCAnMl83JywgJzNfMTAnLCAnMl8xJywnMl8xMycsICcyXzEwJywgJzJfMTInLCAnMl8xMSddO1xyXG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8yJywgJzRfMycsICc0XzQnLCAnNF81JywgJzRfNScsICc0XzYnLCAnNF8xMicsICc0XzEzJywgJzJfMTInLCczXzEyJywgJzJfOCcsICczXzgnLCAnMl8xMSddO1xyXG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8zJywgJzFfMycsICc0XzUnLCAnNF81JywgJzNfNScsICcyXzUnLCAnMV8yMCcsICc0XzExJywgJzNfMTInLCc0XzEyJywgJzRfOCcsICc0XzEnLCAnMV8xMiddO1xyXG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8zJywgJzFfMycsICc0XzUnLCAnNF81JywgJzJfMjAnLCAnMV8yMCcsICcxXzIwJywgJzRfMTEnLCAnM18xMicsJzRfMTInLCAnNF84JywgJzRfMScsICcxXzEyJ107XHJcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzMnLCAnM180JywgJzRfNicsICc0XzUnLCAnMl83JywgJzFfMjAnLCAnMV8zJywgJzRfNCcsICczXzYnLCc0XzcnLCAnNF84JywgJzJfMTInLCAnMV8xMiddO1xyXG4gICAgICAgIGNjLmxvZyhjYXJkTmFtZXMpXHJcbiAgICAgICAgdGhpcy5jbGVhckNhcmRzKCk7XHJcbiAgICAgICAgdGhpcy5fa3FDYXJkTW9kZXMgPSBbXTtcclxuICAgICAgICB0aGlzLmFkZENhcmRzKGNhcmROYW1lcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsZWFyQ2FyZHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICB0aGlzLmxheW91dFRvdURhby5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgdGhpcy5sYXlvdXRXZWlEYW8ubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgfSxcclxuXHJcbiAgICByZW1vdmVDYXJkOiBmdW5jdGlvbiAoY2FyZE5hbWUpIHtcclxuICAgICAgICBpZiAoIWNhcmROYW1lLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoY2FyZE5hbWUpLnJlbW92ZUZyb21QYXJlbnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2V0RmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjayA9IGNhbGxiYWNrO1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgX3JlbG9hZEtRQ2FyZE1vZGVzSW5uZXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL3RoaXMuX2txQ2FyZE1vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2FyZFByZWZhYk5vZGUpIHtcclxuICAgICAgICAvLyAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmRQcmVmYWJOb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xyXG4gICAgICAgIC8vICAgIHJldHVybiBjYXJkUHJlZmFiLmNhcmRNb2RlKCk7XHJcbiAgICAgICAgLy99KS5zb3J0KEtRQ2FyZC5zb3J0KTtcclxuICAgICAgICAvL3RoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCA9IG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF90eXBlQnV0dG9uczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vcmV0dXJuIFtcclxuICAgICAgICAvLyAgICB0aGlzLmJ0bkR1aVppLFxyXG4gICAgICAgIC8vICAgIHRoaXMuYnRuTGlhbmdEdWksXHJcbiAgICAgICAgLy8gICAgdGhpcy5idG5TYW5UaWFvLFxyXG4gICAgICAgIC8vICAgIHRoaXMuYnRuU2h1blppLFxyXG4gICAgICAgIC8vICAgIHRoaXMuYnRuVG9uZ0h1YSxcclxuICAgICAgICAvLyAgICB0aGlzLmJ0bkh1THUsXHJcbiAgICAgICAgLy8gICAgdGhpcy5idG5UaWVaaGksXHJcbiAgICAgICAgLy8gICAgdGhpcy5idG5Ub25nSHVhU2h1bixcclxuICAgICAgICAvLyAgICAvKiMjIyMjKi9cclxuICAgICAgICAvLyAgICAvL3RoaXMuYnRuV3VUb25nLFxyXG4gICAgICAgIC8vICAgIC8qIyMjIyMqL1xyXG4gICAgICAgIC8vXTtcclxuICAgIH0sXHJcblxyXG4gICAgX3Jlc2V0VHlwZUJ1dHRvbkVuYWJsZXNXaXRoTW9kZWxzOiBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XHJcbiAgICAgICAgLypjYXJkTW9kZXMubGVuZ3RoID09IDEzKi9cclxuICAgICAgICAvL2NhcmRNb2RlcyA9IGNhcmRNb2RlcyB8fCB0aGlzLl9rcUNhcmRNb2RlcztcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vLyojIyMjI+WIneWni+WMlueJjCovXHJcbiAgICAgICAgLy92YXIgQnV0dG9uc0xheW91dENoaWxkcyA9IHRoaXMudHlwZUJ1dHRvbnNOb2RlLmNoaWxkcmVuO1xyXG4gICAgICAgIC8vZm9yKHZhciBpPTA7aTxCdXR0b25zTGF5b3V0Q2hpbGRzLmxlbmd0aDtpKyspe1xyXG4gICAgICAgIC8vICAgIEJ1dHRvbnNMYXlvdXRDaGlsZHNbaV0uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL3RoaXMuYnRuRHVpWmkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5EdWlaaShjYXJkTW9kZXMpO1xyXG4gICAgICAgIC8vdGhpcy5idG5MaWFuZ0R1aS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbkxpYUR1aShjYXJkTW9kZXMpO1xyXG4gICAgICAgIC8vdGhpcy5idG5TYW5UaWFvLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluU2FuVGlhbyhjYXJkTW9kZXMpO1xyXG4gICAgICAgIC8vdGhpcy5idG5TaHVuWmkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5TaHVuWmkoY2FyZE1vZGVzKTtcclxuICAgICAgICAvL3RoaXMuYnRuVG9uZ0h1YS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpblRvbmdIdWEoY2FyZE1vZGVzKTtcclxuICAgICAgICAvL3RoaXMuYnRuSHVMdS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbkh1THUoY2FyZE1vZGVzKTtcclxuICAgICAgICAvL3RoaXMuYnRuVGllWmhpLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRNb2Rlcyk7XHJcbiAgICAgICAgLy90aGlzLmJ0blRvbmdIdWFTaHVuLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZE1vZGVzKTtcclxuICAgICAgICAvLy8vdGhpcy5idG5XdVRvbmcuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZE1vZGVzKTtcclxuICAgICAgICAvLy8vS1FDYXJkLmlzVGVTaHVQYWkoY2FyZE1vZGVzKVxyXG4gICAgICAgIC8vLy9sZXQgdHlwZU5hbWUgPSBLUUNhcmQuY2FyZHNUeXAtZU5hbWUoY2FyZE1vZGVzKTtcclxuICAgICAgICAvLy8vS1FDYXJkLmlzTGl1RHVpQmFuKGNhcmRNb2Rlcyk7XHJcbiAgICAgICAgLy8vL2FsZXJ0KHRoaXMuYnRuU2h1blppLmludGVyYWN0YWJsZSlcclxuICAgICAgICAvLy8qIyMjIyPlpoLmnpzmnInlpJrkuIDoibLvvIzlsLHmmK/orr7nva7ml6DlkIzmjInpkq7nmoTlj6/kuqTkupLmgKcqL1xyXG4gICAgICAgIC8vLy9pZihjYy5kdW9ZaVNlID09IDApIHtcclxuICAgICAgICAvLy8vICAgIHRoaXMud3VUb25nTm9kZSA9IHRoaXMudHlwZUJ1dHRvbnNOb2RlLmdldENoaWxkQnlOYW1lKFwiYnRuV3VUb25nXCIpO1xyXG4gICAgICAgIC8vLy8gICAgdGhpcy5idG5XdVRvbmcgPSB0aGlzLnd1VG9uZ05vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XHJcbiAgICAgICAgLy8vLyAgICB0aGlzLmJ0bld1VG9uZy5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkTW9kZXMpO1xyXG4gICAgICAgIC8vLy99XHJcbiAgICAgICAgLy8vKiMjIyMjKi9cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZVR5cGVCdXR0b25zKCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLy8qIyMjIyPorr7nva7mjInpkq7lj6/kuqTkupLlkozkuI3lj6/kuqTkupLml7bnmoTpgI/mmI7luqYqL1xyXG4gICAgICAgIC8vZm9yKHZhciBpPTA7aTxCdXR0b25zTGF5b3V0Q2hpbGRzLmxlbmd0aDtpKyspe1xyXG4gICAgICAgIC8vICAgIGlmKEJ1dHRvbnNMYXlvdXRDaGlsZHNbaV0uZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlKXtcclxuICAgICAgICAvLyAgICAgICAgQnV0dG9uc0xheW91dENoaWxkc1tpXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgIC8vICAgIH1lbHNle1xyXG4gICAgICAgIC8vICAgICAgICBCdXR0b25zTGF5b3V0Q2hpbGRzW2ldLm9wYWNpdHkgPSAxMjU7XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDlsIbmib7liLDkuobniYznsbvlnovnmoTniYznqoHlh7rlh7rmnaVcclxuICAgIF9zdGlja091dEZpbmRDYXJkVHlwZTogZnVuY3Rpb24gKHRpdGxlLCBmaW5kTWV0aG9kcykge1xyXG5cclxuICAgICAgICAvLyDlhYjmoLnmja7niYznsbvlnovmib7lh7rmiYDmnInnmoTntKLlvJXpm4blkIhcclxuICAgICAgICAvL3ZhciBmaW5kZWRJbmRleHNBcnJheSA9IG51bGw7XHJcbiAgICAgICAgLy90aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QgPSB0aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QgfHwge307XHJcbiAgICAgICAgLy9pZiAodGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LnRpdGxlICE9IHRpdGxlKSB7XHJcbiAgICAgICAgLy8gICAgZmluZGVkSW5kZXhzQXJyYXkgPSAoZmluZE1ldGhvZHMoKSB8fCBbXSkucmV2ZXJzZSgpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgZm9yKHZhciBpID0wO2k8ZmluZGVkSW5kZXhzQXJyYXkubGVuZ3RoLTE7aSsrKXsvL+WIoOmZpOWQjOexu+Wei+eJjFxyXG4gICAgICAgIC8vICAgICAgICB2YXIgaW5kZXggPSBmaW5kZWRJbmRleHNBcnJheVtpXTtcclxuICAgICAgICAvLyAgICAgICAgLyppZih0aXRsZSA9PSAnbGlhbmdEdWknKXtcclxuICAgICAgICAvLyAgICAgICAgIGxldCBqU3RyaW5nc3BvaW50ID0gaW5kZXgubWFwKGZ1bmN0aW9uKGluZGV4cyl7XHJcbiAgICAgICAgLy8gICAgICAgICByZXR1cm4gdGhpcy5fa3FDYXJkTW9kZXNbaW5kZXhzXS5wb2ludDtcclxuICAgICAgICAvLyAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLy8gICAgICAgICB2YXIgaXNCcmVhayA9IGZhbHNlO1xyXG4gICAgICAgIC8vICAgICAgICAgdmFyIHJlcE51bSA9IGpTdHJpbmdzcG9pbnQucmVkdWNlKGZ1bmN0aW9uKHAsbil7XHJcbiAgICAgICAgLy8gICAgICAgICBpZighcFtuXSl7XHJcbiAgICAgICAgLy8gICAgICAgICBwW25dID0gMTtcclxuICAgICAgICAvLyAgICAgICAgIH1lbHNle1xyXG4gICAgICAgIC8vICAgICAgICAgcFtuXSArPSAxXHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICByZXR1cm4gcFxyXG4gICAgICAgIC8vICAgICAgICAgfSx7fSk7XHJcbiAgICAgICAgLy8gICAgICAgICBmb3IodmFyIHkgaW4gcmVwTnVtKXtcclxuICAgICAgICAvLyAgICAgICAgIGlmKHJlcE51bVt5XSA+PSAzKXtcclxuICAgICAgICAvLyAgICAgICAgIGlzQnJlYWsgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgaWYoaXNCcmVhayl7XHJcbiAgICAgICAgLy8gICAgICAgICBjYy5sb2cocmVwTnVtKVxyXG4gICAgICAgIC8vICAgICAgICAgY2MubG9nKGZpbmRlZEluZGV4c0FycmF5KVxyXG4gICAgICAgIC8vICAgICAgICAgY2MubG9nKGkpXHJcbiAgICAgICAgLy8gICAgICAgICBjYy5sb2coJy0tLS0tLS0tMjkxJylcclxuICAgICAgICAvLyAgICAgICAgIGZpbmRlZEluZGV4c0FycmF5LnNwbGljZShpLDEpO1xyXG4gICAgICAgIC8vICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICB9Ki9cclxuICAgICAgICAvLyAgICAgICAgdmFyIGlTdHJpbmcgPSAnJztcclxuICAgICAgICAvLyAgICAgICAgZm9yKHZhciBqID1pKzE7ajxmaW5kZWRJbmRleHNBcnJheS5sZW5ndGg7aisrKXtcclxuICAgICAgICAvLyAgICAgICAgICAgIHZhciBzID0gZmluZGVkSW5kZXhzQXJyYXlbal07XHJcbiAgICAgICAgLy8gICAgICAgICAgICB2YXIgalN0cmluZyA9ICcnO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgICAgICAgICBsZXQgaVN0cmluZ3MgPSBzLm1hcChmdW5jdGlvbihpbmRleCl7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgbGV0IGNhcmRNb2RlbCA9IHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4XTtcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICByZXR1cm4gY2FyZE1vZGVsLmNhcmROYW1lKCk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgICAgICAgICBsZXQgalN0cmluZ3MgPSBpbmRleC5tYXAoZnVuY3Rpb24oaW5kZXhzKXtcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICBsZXQgY2FyZE1vZGVsID0gdGhpcy5fa3FDYXJkTW9kZXNbaW5kZXhzXTtcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICByZXR1cm4gY2FyZE1vZGVsLmNhcmROYW1lKCk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICAgICAgICAgIGZvcih2YXIgciA9IDA7ciA8IGluZGV4Lmxlbmd0aDtyKyspe1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgIGpTdHJpbmcgPSBqU3RyaW5nICsgaVN0cmluZ3Nbcl07XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgaVN0cmluZyA9IGlTdHJpbmcgKyBqU3RyaW5nc1tyXTtcclxuICAgICAgICAvLyAgICAgICAgICAgIH1cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgICAgICAgICAgaWYoalN0cmluZyA9PSBpU3RyaW5nKXtcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICBmaW5kZWRJbmRleHNBcnJheS5zcGxpY2UoaSwxKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAvLyAgICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgfVxyXG4gICAgICAgIC8vICAgIH1cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgIHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCA9IHtcclxuICAgICAgICAvLyAgICAgICAgdGl0bGU6IHRpdGxlLFxyXG4gICAgICAgIC8vICAgICAgICBpbmRleHNBcnJheTogZmluZGVkSW5kZXhzQXJyYXksXHJcbiAgICAgICAgLy8gICAgICAgIC8vaW5kZXg6IHRpdGxlPT1cImR1aVppXCI/ZmluZGVkSW5kZXhzQXJyYXkubGVuZ3RoLTE6MFxyXG4gICAgICAgIC8vICAgICAgICBpbmRleDogMFxyXG4gICAgICAgIC8vICAgIH07XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL2ZpbmRlZEluZGV4c0FycmF5ID0gdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LmluZGV4c0FycmF5O1xyXG4gICAgICAgIC8vaWYgKCFmaW5kZWRJbmRleHNBcnJheSB8fCBmaW5kZWRJbmRleHNBcnJheS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgIC8vICAgIHJldHVybjtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8vIOWwhuW3suacieeahOeqgeWHuueahOeJjOeahOS9jee9rumHjee9ruWbnuWIneWni+S9jee9rlxyXG4gICAgICAgIC8vdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8vLyDorqHnrpflh7ropoHnqoHlh7rnmoTniYzmlbDnu4RcclxuICAgICAgICAvL3ZhciBpbmRleCA9IHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdC5pbmRleDtcclxuICAgICAgICAvL2xldCBpbmRleHMgPSBmaW5kZWRJbmRleHNBcnJheVtpbmRleF07XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL2xldCBzZWxlY3RlZENhcmROYW1lcyA9IGluZGV4cy5tYXAoZnVuY3Rpb24oaW5kZXgpe1xyXG4gICAgICAgIC8vICAgIGxldCBjYXJkTW9kZWwgPSB0aGlzLl9rcUNhcmRNb2Rlc1tpbmRleF07XHJcbiAgICAgICAgLy8gICAgcmV0dXJuIGNhcmRNb2RlbC5jYXJkTmFtZSgpO1xyXG4gICAgICAgIC8vfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5maWx0ZXIoZnVuY3Rpb24gKGNhcmROb2RlKSB7XHJcbiAgICAgICAgLy8gICAgbGV0IGNhcmRQcmVmYWIgPSBjYXJkTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcclxuICAgICAgICAvLyAgICBpZihzZWxlY3RlZENhcmROYW1lcy5pbmNsdWRlcyhjYXJkUHJlZmFiLmNhcmROYW1lKCkpKSB7XHJcbiAgICAgICAgLy8gICAgICAgIHZhciBuYW1lSW5kZXggPSBzZWxlY3RlZENhcmROYW1lcy5pbmRleE9mKGNhcmRQcmVmYWIuY2FyZE5hbWUoKSk7XHJcbiAgICAgICAgLy8gICAgICAgIHNlbGVjdGVkQ2FyZE5hbWVzLnNwbGljZShuYW1lSW5kZXgsMSk7XHJcbiAgICAgICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIC8vICAgIH1cclxuICAgICAgICAvLyAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgLy99KTtcclxuXHJcbiAgICAgICAgLy8vLyDnqoHlh7rorqHnrpflh7rmnaXnmoTniYzmlbDnu4RcclxuICAgICAgICAvL3RoaXMuX2NoYW5nZUNhcmRQcmVmYWJzWShjYXJkTm9kZXMpO1xyXG4gICAgICAgIC8vLy8g5L+d5a2Y5aW977yM55So5LqO5YaN5qyh54K55Ye75LqG56qB5Ye65LiL5LiA57uE54mMXHJcbiAgICAgICAgLy9pbmRleCA9IChpbmRleCArIDEpICUgZmluZGVkSW5kZXhzQXJyYXkubGVuZ3RoO1xyXG4gICAgICAgIC8vdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LmluZGV4ID0gaW5kZXg7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrRHVpWmk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcImR1aVppXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kRHVpWmkodGhpcy5fa3FDYXJkTW9kZXMpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrTGlhbmdEdWk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcImxpYW5nRHVpXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kTGlhRHVpKHRoaXMuX2txQ2FyZE1vZGVzKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja1NhblRpYW86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcInNhblRpYW9cIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRTYW5UaWFvKHRoaXMuX2txQ2FyZE1vZGVzKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja1NodW5aaTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwic2h1blppXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kU2h1blppKHRoaXMuX2txQ2FyZE1vZGVzKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja1RvbmdIdWE6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcInRvbmdIdWFcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhKHRoaXMuX2txQ2FyZE1vZGVzKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0h1THU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcImh1THVcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRIdUx1KHRoaXMuX2txQ2FyZE1vZGVzKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja1RpZVpoaTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwidGllWmhpXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kVGllWmhpKHRoaXMuX2txQ2FyZE1vZGVzKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMjKi9cclxuICAgIGNsaWNrV3VUb25nOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJ3dVRvbmdcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRXdVRvbmcodGhpcy5fa3FDYXJkTW9kZXMpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG4gICAgLyojIyMjIyovXHJcblxyXG4gICAgY2xpY2tUb25nSHVhU2h1bjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwidG9uZ0h1YVNodW5cIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bih0aGlzLl9rcUNhcmRNb2Rlcyk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tDYW5jZWxBbGw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNsaWNrRGVsZXRlVG91RGFvKCk7XHJcbiAgICAgICAgdGhpcy5jbGlja0RlbGV0ZVpob25nRGFvKCk7XHJcbiAgICAgICAgdGhpcy5jbGlja0RlbGV0ZVdlaURhbygpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKueCueWHu+WujOaIkOaMiemSriovXHJcbiAgICBjbGlja0RvbmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XHJcbiAgICAgICAgdGhpcy5jYXJkQWxscyA9ICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi55IC0gYS55O30pLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS5jaGlsZHJlblswXTt9KTtcclxuXHJcbiAgICAgICAgbGV0IHRvdUNhcmRNb2RlbHMgPSB0aGlzLl90YW9EYW9DYXJkTW9kZXMoKTtcclxuICAgICAgICBsZXQgemhvbmdDYXJkTW9kZXMgPSB0aGlzLl96aG9uZ0Rhb0NhcmRNb2RlcygpO1xyXG4gICAgICAgIGxldCB3ZWlDYXJkTW9kZXMgPSB0aGlzLl93ZWlEYW9DYXJkTW9kZXMoKTtcclxuICAgICAgICB0aGlzLl9kaWRTZWxlY3RlZENhcmRzKHRvdUNhcmRNb2RlbHMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKueCueWHu+aBreWWnOS9oOmhtemdoueahOehruWumuaMiemSriovXHJcbiAgICBvbkJ0bkdvbmdYaU5pQ29tZmlybUNsaWNrOmZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL+iusOW9leeOqeWutueCueWHu+S6huehruWumuaMiemSru+8mlxyXG4gICAgICAgIHRoaXMuQnRuQ2xpY2tHb25nWGlOaUNvbWZpcm0gPSB0cnVlO1xyXG5cclxuICAgICAgICB2YXIgY2FyZHMgPSBbXTtcclxuXHJcbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2NhcmRzID0gY2FyZHMuY29uY2F0KGkpO30pO1xyXG5cclxuICAgICAgICB2YXIgdGVTaHVQYWlDYXJkc1NlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsMihjYXJkcyk7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFt0ZVNodVBhaUNhcmRzU2VydmVySW5mb107XHJcbiAgICAgICAgaWYgKHRoaXMuX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5fZmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjayhyZXN1bHQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgX2RpZFNlbGVjdGVkQ2FyZHM6IGZ1bmN0aW9uICh0b3VDYXJkcywgemhvbmdDYXJkcywgd2VpQ2FyZHMpIHtcclxuICAgICAgICB0b3VDYXJkcyA9IHRvdUNhcmRzIHx8IFtdO1xyXG4gICAgICAgIHpob25nQ2FyZHMgPSB6aG9uZ0NhcmRzIHx8IFtdO1xyXG4gICAgICAgIHdlaUNhcmRzID0gd2VpQ2FyZHMgfHwgW107XHJcbiAgICAgICAgbGV0IHRvdVNlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsKHRvdUNhcmRzKTtcclxuICAgICAgICBsZXQgemhvbmdTZXJ2ZXJJbmZvID0gdGhpcy5fY29udmVydENhcmRzVG9TZXJ2ZXJNb2RlbCh6aG9uZ0NhcmRzKTtcclxuICAgICAgICBsZXQgd2VpU2VydmVySW5mbyA9IHRoaXMuX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWwod2VpQ2FyZHMpO1xyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRvdVNlcnZlckluZm8pO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coemhvbmdTZXJ2ZXJJbmZvKTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHdlaVNlcnZlckluZm8pO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS01MTJcIik7XHJcbiAgICAgICAgaWYoISh0b3VTZXJ2ZXJJbmZvLnZhbHVlIDwgemhvbmdTZXJ2ZXJJbmZvLnZhbHVlICYmIHpob25nU2VydmVySW5mby52YWx1ZSA8PSB3ZWlTZXJ2ZXJJbmZvLnZhbHVlKSl7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0b0NhcmRBbmltYXRpb24ueSA9IC01MDtcclxuICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZEFuaW1hdGlvbi5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICB0aGlzLmF1dG9DYXJkQW5pbWF0aW9uLnJ1bkFjdGlvbihjYy5tb3ZlVG8oMSwgY2MucCgwLCAwKSkpO1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gY2Muc3Bhd24oY2MubW92ZVRvKHRoaXMuY2FyZFRpbWUsIGNjLnAoMCwgMTApKSwgY2MuZmFkZU91dCh0aGlzLmNhcmRUaW1lKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9DYXJkQW5pbWF0aW9uLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIDEuNSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IFt0b3VTZXJ2ZXJJbmZvLCB6aG9uZ1NlcnZlckluZm8sIHdlaVNlcnZlckluZm9dO1xyXG4gICAgICAgIC8vcmV0dXJuO1xyXG4gICAgICAgIGlmICh0aGlzLl9maW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2socmVzdWx0KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrRGVsZXRlVG91RGFvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlRGFvQ2FyZHNPZkxheW91dCh0aGlzLmxheW91dFRvdURhby5ub2RlKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tEZWxldGVaaG9uZ0RhbzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZURhb0NhcmRzT2ZMYXlvdXQodGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tEZWxldGVXZWlEYW86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkc09mTGF5b3V0KHRoaXMubGF5b3V0V2VpRGFvLm5vZGUpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDorqHml7blmajkuovku7ZcclxuICAgIHRpbWVTdGFydDogZnVuY3Rpb24gKGR1cmF0aW9uKSB7XHJcbiAgICAgICAgY2MuYXNzZXJ0KGR1cmF0aW9uID4gMCk7XHJcbiAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xyXG4gICAgICAgIHRoaXMudGltZU5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB2YXIgdGltZXN0YW1wID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidGltZXN0YW1wXCIpOyAgLy8g6I635Y+W5pys5Zyw5a2Y5YKo55qE5pe26Ze05oizXHJcbiAgICAgICAgaWYodGltZXN0YW1wKXsgIC8vIOWmguaenOacieWImeivgeaYjueOqeWutuaYr+mHjeaWsOi/m+adpeS6hueahFxyXG4gICAgICAgICAgICB2YXIgbm93ID0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTtcclxuICAgICAgICAgICAgdmFyIHRpbWUgPSBkdXJhdGlvbioxMDAwO1xyXG4gICAgICAgICAgICBpZihub3cgLSB0aW1lc3RhbXAgPiB0aW1lKXsgLy8g6LaF5pe2XHJcbiAgICAgICAgICAgICAgICBpZihub3cgLSB0aW1lc3RhbXAgPCAyKnRpbWUpe1xyXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gNTsgIC8vIOeOqeWutuWPr+iDveWHuuS6juWFtuS7luWOn+WboOmAgOWHuua4uOaIj+WvvOiHtOi2heaXtu+8jOS4uuWFtuaPkOS+mzXnp5Lml7bpl7TmlbTnkIbniYzlnovvvIjov5nlt7Lnu4/mmK/lvojku4HmhYjnmoTkuobvvInjgIJcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRpbWVzdGFtcFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IE1hdGguZmxvb3IoIGR1cmF0aW9uIC0gKG5vdyAtIHRpbWVzdGFtcCkvMTAwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9ZWxzZXsgIC8vIOWmguaenOayoeacieaXtumXtOaIs++8jOWImeS/neWtmO+8jOS4uueOqeWutumAgOWHuua4uOaIj+S/neeVmeivgeaNru+8m1xyXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gRGF0ZS5wYXJzZShuZXcgRGF0ZSgpKTsgICAgIFxyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3RpbWVzdGFtcCcsdGltZXN0YW1wKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uID0gZHVyYXRpb247XHJcbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gU3RyaW5nKGR1cmF0aW9uKTtcclxuICAgICAgICB0aGlzLnRpbWVOb2RlLmdldENvbXBvbmVudChcInRpbWVcIikuc2V0VGltZShkdXJhdGlvbiAqIDAuNSk7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZSh0aGlzLl90aW1lTWV0aG9kLCAxLCBkdXJhdGlvbik7XHJcbiAgICB9LFxyXG5cclxuICAgIHRpbWVTdG9wOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuX3RpbWVNZXRob2QpO1xyXG4gICAgICAgIHRoaXMudGltZU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIF90aW1lTWV0aG9kOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uID0gdGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uIC0gMTtcclxuXHJcbiAgICAgICAgdmFyIHJlbWFpbiA9IE1hdGgubWF4KHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiwgMCk7XHJcbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gKHJlbWFpbiA8IDEwICYmIHJlbWFpbiA+IDApID8gKCcwJyArIHJlbWFpbikgOiByZW1haW47XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gPD0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XHJcbiAgICAgICAgICAgIGlmKGNjLmNoYW9TaGlDaHVQYWkgPT0gdHJ1ZSkgdGhpcy5fdGltZU91dEF1dG9TZWxlY3RDYXJkcygpO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOi2heaXtuWQju+8jOiHquWKqOmAieeJjFxyXG4gICAgX3RpbWVPdXRBdXRvU2VsZWN0Q2FyZHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDpmpDol4/mga3llpzkvaBcclxuICAgICAgICAgKi9cclxuICAgICAgICBwbGF5LmdvbmdYaU5pU2hvdyhmYWxzZSk7XHJcbiAgICAgICAgaWYgKHR5cGVvZihjYy50ZVNodVBhaUNhcmRzKSAhPSBcInVuZGVmaW5lZFwiICYmIGNjLnRlU2h1UGFpQ2FyZHMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLm9uQnRuR29uZ1hpTmlDb21maXJtQ2xpY2soKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9sZXQgW3RvdUNhcmRNb2RlbHMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXNdID0gdGhpcy5fY2FjbGVBdXRvU2VsZWN0ZWRDYXJkcygpO1xyXG4gICAgICAgIGxldCBbdG91Q2FyZE1vZGVscywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2Rlc10gPSB0aGlzLl9maW5kQ2FyZEluZGV4LmFyclswXTtcclxuXHJcblxyXG4gICAgICAgIGlmICh0b3VDYXJkTW9kZWxzID09IG51bGwgfHwgemhvbmdDYXJkTW9kZXMgPT0gbnVsbCB8fCB3ZWlDYXJkTW9kZXMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0b3VDYXJkTW9kZWxzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLnNsaWNlKC0zKTtcclxuICAgICAgICAgICAgemhvbmdDYXJkTW9kZXMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoNSwgMTApO1xyXG4gICAgICAgICAgICB3ZWlDYXJkTW9kZXMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoMCwgNSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBjYy5sb2codG91Q2FyZE1vZGVscylcclxuICAgICAgICAvLyBjYy5sb2coemhvbmdDYXJkTW9kZXMpXHJcbiAgICAgICAgLy8gY2MubG9nKHdlaUNhcmRNb2RlcylcclxuICAgICAgICAvLyBjYy5sb2codGhpcy5fYWxsQ2FyZE1vZGVzKVxyXG4gICAgICAgIC8vIGNjLmxvZyhcIuiHquWKqOmAieeJjCB0b3VDYXJkTW9kZWxzIHpob25nQ2FyZE1vZGVzIHdlaUNhcmRNb2Rlc++8mlwiKTtcclxuICAgICAgICB0aGlzLl9kaWRTZWxlY3RlZENhcmRzKHRvdUNhcmRNb2RlbHMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfY2FjbGVBdXRvU2VsZWN0ZWRDYXJkczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IGNhcmRzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmZpbHRlcihmdW5jdGlvbihpKXtcclxuICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHJlc3VsdENhcmRzID0gW107XHJcbiAgICAgICAgZm9yKHZhciBpID0gMTtpIDwgMzsgaSsrKXtcclxuICAgICAgICAgICAgbGV0IGNhcmRzcyA9IEtRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMoY2FyZHMsIDUpO1xyXG4gICAgICAgICAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmRzcyk7XHJcbiAgICAgICAgICAgIHJlc3VsdENhcmRzLnB1c2goY2FyZHNzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmVzdWx0Q2FyZHMucHVzaChjYXJkcyk7XHJcbiAgICAgICAgLy9sZXQgdG91U2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHJlc3VsdENhcmRzWzJdKTtcclxuICAgICAgICAvL2xldCB6aG9uZ1Njb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhyZXN1bHRDYXJkc1sxXSk7XHJcbiAgICAgICAgLy9sZXQgd2VpU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHJlc3VsdENhcmRzWzBdKTtcclxuICAgICAgICAvLyBjYy5sb2cocmVzdWx0Q2FyZHMpXHJcbiAgICAgICAgLy8gY2MubG9nKHRoaXMuX2FsbENhcmRNb2RlcylcclxuICAgICAgICAvLyBjYy5sb2coXCLniYzliIbmlbDoh6rliqjpgInniYzvvJpcIiwgdG91U2NvcmUsIHpob25nU2NvcmUsIHdlaVNjb3JlKTtcclxuICAgICAgICAvL2xldCB3ZWlDYXJkTW9kZXMgPSBLUUNhcmQuYXV0b1NlbGVjdENhcmRzKGNhcmRzLCA1KTtcclxuICAgICAgICAvL2NhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMod2VpQ2FyZE1vZGVzKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vbGV0IHpob25nQ2FyZE1vZGVzID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkcywgNSk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL2xldCB0b3VDYXJkTW9kZXMgPSBjYXJkcy5rcV9leGNsdWRlcyh6aG9uZ0NhcmRNb2Rlcyk7XHJcbiAgICAgICAgLy9pZiAodG91Q2FyZE1vZGVzLmxlbmd0aCA9PSAzICYmIHpob25nQ2FyZE1vZGVzLmxlbmd0aCA9PSA1ICYmIHdlaUNhcmRNb2Rlcy5sZW5ndGggPT0gNSkge1xyXG4gICAgICAgIC8vICAgIHJldHVybiBbdG91Q2FyZE1vZGVzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzXTtcclxuICAgICAgICAvL31cclxuICAgICAgICBpZiAocmVzdWx0Q2FyZHNbMl0ubGVuZ3RoID09IDMgJiYgcmVzdWx0Q2FyZHNbMV0ubGVuZ3RoID09IDUgJiYgcmVzdWx0Q2FyZHNbMF0ubGVuZ3RoID09IDUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtyZXN1bHRDYXJkc1syXSwgcmVzdWx0Q2FyZHNbMV0sIHJlc3VsdENhcmRzWzBdXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWw6IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSB7fTtcclxuICAgICAgICByZXN1bHQudHlwZSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMpO1xyXG4gICAgICAgIHJlc3VsdC52YWx1ZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoY2FyZHMpO1xyXG4gICAgICAgIGNhcmRzID0gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50czEoY2FyZHMpO1xyXG4gICAgICAgIHJlc3VsdC5jYXJkcyA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyhjYXJkcyk7XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyMqL1xyXG4gICAgX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWwyOiBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgICAgICB2YXIgY29udmVydFRvU2VydmVyQ2FyZHMgPSBbXTtcclxuXHJcbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmRNb2RlKXtcclxuICAgICAgICAgICAgdmFyIGFyciA9IFtdO1xyXG4gICAgICAgICAgICBjYXJkTW9kZSA9IEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRNb2RlKSk7XHJcbiAgICAgICAgICAgIGNhcmRNb2RlLmZvckVhY2goZnVuY3Rpb24oY2NhKXtcclxuICAgICAgICAgICAgICAgIHZhciBwb2ludCA9IGNjYS5wb2ludCA9PSAxNCA/IDE6Y2NhLnBvaW50O1xyXG4gICAgICAgICAgICAgICAgYXJyLnB1c2goe251bWJlcjpwb2ludCxzdWl0OmNjYS5jb2xvcn0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29udmVydFRvU2VydmVyQ2FyZHMucHVzaChhcnIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGxldCByZXN1bHQgPSB7fTtcclxuICAgICAgICByZXN1bHQudHlwZSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMpO1xyXG4gICAgICAgIHJlc3VsdC52YWx1ZSA9IDA7XHJcbiAgICAgICAgcmVzdWx0LmNhcmRzID0gY29udmVydFRvU2VydmVyQ2FyZHM7XHJcblxyXG4gICAgICAgIGlmIChyZXN1bHQudHlwZSA+PSBLUUNhcmQuVFlQRS5TYW5UYW9IdWEgJiYgY2MubW9zaGkgIT0gMSkge1xyXG4gICAgICAgICAgICAvLyDnibnmrorniYxcclxuICAgICAgICAgICAgcmVzdWx0LmlzQ29udGFpbkV4dHJhID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9LFxyXG4gICAgLyojIyMjIyovXHJcbiAgICAvLyDnibnmrorniYzph4zmmK/lkKbov5jlkKvmnInnibnmrorniYxcclxuICAgIC8vIOWMheWQq+eahOaDheWGteacie+8mlxyXG4gICAgLy8g5LiJ5qGD6IqxIOWPr+iDveWQq+acieWQjOiKsemhulxyXG4gICAgLy8g5LiJ6aG65a2QIOWPr+iDveWQq+acieWQjOiKsemhulxyXG4gICAgLy8g5YWt5a+55Y2KIOWPr+iDveWQq+aciemTgeaUr1xyXG4gICAgX2lzQ29udGFpbkV4dHJhQ2FyZHNUeXBlOiBmdW5jdGlvbiAodHlwZSwgY2FyZHMpIHtcclxuICAgICAgICBpZiAodHlwZSA9PSBLUUNhcmQuVFlQRS5TYW5UYW9IdWEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBLUUNhcmQuVFlQRS5TYW5TaHVuWmkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBLUUNhcmQuVFlQRS5MaXVEdWlCYW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDop6bmkbjkuovku7ZcclxuICAgIF9yZWdpc3RlclRvdWNoRXZlbnRzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIHRoaXMuX3RvdWNoQ2FyZExheW91dC5iaW5kKHRoaXMpKTtcclxuICAgICAgICAvL3RoaXMuY2FyZHNMYXlvdXQubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFLCB0aGlzLl90b3VjaENhcmRMYXlvdXQuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCB0aGlzLl90b3VjaENhcmRMYXlvdXRFbmQuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLCB0aGlzLl90b3VjaENhcmRMYXlvdXRFbmQuYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG4gICAgY2FjbGVBdXRvU2VsZWN0ZWRDYXJkc0luZGV4OiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIC8vY2MubG9nKCctLS0tLS02MjInKVxyXG4gICAgICAgIGxldCB0ZXN0RmluZCA9IEtRQ2FyZC50ZXN0RmluZChjYXJkcykgfHwgW107XHJcbiAgICAgICAgLy9jYy5sb2coJy0tLS0tLTYyMjEnKVxyXG4gICAgICAgIHZhciByZXN1bHQgPSBbXVxyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHRlc3RGaW5kLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgdmFyIHMgPSB0ZXN0RmluZFtpXTtcclxuICAgICAgICAgICAgaWYocy5sZW5ndGggPj0gMSl7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwO2ogPCBzLmxlbmd0aDsgaisrKXtcclxuICAgICAgICAgICAgICAgICAgICAvL3Jlc3VsdC5wdXNoKHNbMF0pOy8v5Y+q5Y+W5LiA5LiqXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goc1tqXSk7Ly9cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSxcclxuXHJcbiAgICBjYWNsZUF1dG9TZWxlY3RlZENhcmRzQXJyYXk6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIGluZGV4cyA9IHRoaXMuY2FjbGVBdXRvU2VsZWN0ZWRDYXJkc0luZGV4KGNhcmRzKTtcclxuICAgICAgICBpZihpbmRleHMubGVuZ3RoIDwgMSl7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHNlbGVjdGVkQ2FyZCA9IFtdO1xyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IGluZGV4cy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgIGxldCBzID0gaW5kZXhzW2ldO1xyXG4gICAgICAgICAgICBsZXQgYSA9IHMubWFwKGZ1bmN0aW9uKGluZGV4KXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjYXJkc1tpbmRleF07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBzZWxlY3RlZENhcmQucHVzaChhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkQ2FyZDtcclxuICAgIH0sXHJcblxyXG4gICAgY2FjbGVBdXRvU2VsZWN0ZWRDYXJkczI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBjYXJkcyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSgpO1xyXG4gICAgICAgIHZhciBjYXJkc0FycmF5ID0gdGhpcy5jYWNsZUF1dG9TZWxlY3RlZENhcmRzQXJyYXkoY2FyZHMpO1xyXG4gICAgICAgIHZhciByZXN1bHRBcnJheSA9IFtdO1xyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IGNhcmRzQXJyYXkubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIGxldCBzID0gY2FyZHNBcnJheVtpXSB8fCBbXTtcclxuICAgICAgICAgICAgbGV0IHF3ZXIgPSBbXTtcclxuICAgICAgICAgICAgZm9yKHZhciBqID0gMTtqIDwgY2FyZHNBcnJheS5sZW5ndGg7aisrKXtcclxuICAgICAgICAgICAgICAgIGxldCBkID0gY2FyZHNBcnJheVtqXSB8fCBbXTtcclxuICAgICAgICAgICAgICAgIGxldCBzQyA9IHMua3FfZXhjbHVkZXMoZCk7XHJcbiAgICAgICAgICAgICAgICBpZihzQy5sZW5ndGggPT0gcy5sZW5ndGggJiYgcy5sZW5ndGggPiAwKXsvL+WIpOaWreeJjOebuOWQjCDljbPmsqHmnInph43lpI3nmoRcclxuICAgICAgICAgICAgICAgICAgICBxd2VyID0gW3MsZF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYocXdlci5sZW5ndGggPiAxKXtcclxuICAgICAgICAgICAgICAgIHJlc3VsdEFycmF5LnB1c2gocXdlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8v6KGl5YWo6K6h5YiSMVxyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHJlc3VsdEFycmF5Lmxlbmd0aDtpKyspe1xyXG5cclxuICAgICAgICAgICAgbGV0IHMgPSByZXN1bHRBcnJheVtpXTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjYXJkc3MgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoKTtcclxuXHJcbiAgICAgICAgICAgIGNhcmRzcyA9IGNhcmRzcy5rcV9leGNsdWRlcyhzWzBdKTtcclxuXHJcbiAgICAgICAgICAgIGNhcmRzcyA9IGNhcmRzcy5rcV9leGNsdWRlcyhzWzFdKTtcclxuXHJcbiAgICAgICAgICAgIGlmKGNhcmRzcy5sZW5ndGggPj0gNSl7XHJcbiAgICAgICAgICAgICAgICBzWzJdID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkc3MsIDUpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHNbMl0gPSBLUUNhcmQuYXV0b1NlbGVjdENhcmRzKGNhcmRzcywgMyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlc3VsdEFycmF5W2ldLnNvcnQoZnVuY3Rpb24gKGExLGEyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gS1FDYXJkLnNjb3JlT2ZDYXJkcyhhMSktS1FDYXJkLnNjb3JlT2ZDYXJkcyhhMik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+ihpeWFqOiuoeWIkjJcclxuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCByZXN1bHRBcnJheS5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgdmFyIHMgPSByZXN1bHRBcnJheVtpXTtcclxuICAgICAgICAgICAgdmFyIGNhcmRzcWUgPSB0aGlzLl9hbGxDYXJkTW9kZXMuZmlsdGVyKGZ1bmN0aW9uKGlpKXsvL+mHjeaWsOi1i+WAvGNhcmRzXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaWk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvL+WOu+mHjVxyXG4gICAgICAgICAgICB2YXIgcSA9IHNbMF0uY29uY2F0KHNbMV0pLmNvbmNhdChzWzJdKTtcclxuICAgICAgICAgICAgdmFyIGNhcmRzcSA9IGNhcmRzcWUua3FfZXhjbHVkZXMocSk7XHJcbiAgICAgICAgICAgIHNbMF0gPSBzWzBdLmtxX2V4Y2x1ZGVzKHNbMV0pO1xyXG4gICAgICAgICAgICBzWzBdID0gc1swXS5rcV9leGNsdWRlcyhzWzJdKTtcclxuICAgICAgICAgICAgc1sxXSA9IHNbMV0ua3FfZXhjbHVkZXMoc1swXSk7XHJcbiAgICAgICAgICAgIHNbMV0gPSBzWzFdLmtxX2V4Y2x1ZGVzKHNbMl0pO1xyXG4gICAgICAgICAgICBzWzJdID0gc1syXS5rcV9leGNsdWRlcyhzWzFdKTtcclxuICAgICAgICAgICAgc1syXSA9IHNbMl0ua3FfZXhjbHVkZXMoc1swXSk7XHJcbiAgICAgICAgICAgIC8v5aSa5L2Z5Yig6ZmkXHJcbiAgICAgICAgICAgIGlmIChzWzJdLmxlbmd0aCA+IDUpIHsvL+WwvumBk1xyXG4gICAgICAgICAgICAgICAgbGV0IGEgPSBzWzJdLnNwbGljZSg1LCBzWzJdLmxlbmd0aC01KTtcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgeSBpbiBhKXtcclxuICAgICAgICAgICAgICAgICAgICBjYXJkc3EucHVzaChhW3ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc1sxXS5sZW5ndGggPiA1KSB7Ly/kuK3pgZNcclxuICAgICAgICAgICAgICAgIGxldCBhID0gc1sxXS5zcGxpY2UoNSwgc1sxXS5sZW5ndGgtNSk7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIHkgaW4gYSl7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FyZHNxLnB1c2goYVt5XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHNbMF0ubGVuZ3RoID4gMykgey8v5aS06YGTXHJcbiAgICAgICAgICAgICAgICBsZXQgYSA9IHNbMF0uc3BsaWNlKDMsIHNbMF0ubGVuZ3RoLTMpO1xyXG4gICAgICAgICAgICAgICAgZm9yKHZhciB5IGluIGEpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNhcmRzcS5wdXNoKGFbeV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vY2FyZHNxID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BKGNhcmRzcSk7XHJcbiAgICAgICAgICAgIGNhcmRzcS5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XHJcbiAgICAgICAgICAgIGNhcmRzcS5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQxMSl7XHJcbiAgICAgICAgICAgICAgICBpZihjYXJkMTEucG9pbnQgPT0gMTQpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNhcmQxMS5wb2ludCA9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvL+aciee8uua3u+WKoFxyXG4gICAgICAgICAgICB3aGlsZShzWzJdLmxlbmd0aCA8IDUpIHsvL+WwvumBk1xyXG4gICAgICAgICAgICAgICAgc1syXS5wdXNoKGNhcmRzcS5wb3AoKSB8fCBbXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgd2hpbGUoc1sxXS5sZW5ndGggPCA1KSB7Ly/kuK3pgZNcclxuICAgICAgICAgICAgICAgIHNbMV0ucHVzaChjYXJkc3EucG9wKCkgfHwgW10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHdoaWxlKHNbMF0ubGVuZ3RoIDwgMykgey8v5aS06YGTXHJcbiAgICAgICAgICAgICAgICBzWzBdLnB1c2goY2FyZHNxLnBvcCgpIHx8IFtdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvKmlmKGNhcmRzcS5sZW5ndGggPiAwKXtcclxuICAgICAgICAgICAgICAgIHdoaWxlKHNbMl0ubGVuZ3RoIDwgNSkgey8v5bC+6YGTXHJcbiAgICAgICAgICAgICAgICAgICAgc1syXS5wdXNoKGNhcmRzcS5wb3AoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoY2FyZHNxLmxlbmd0aCA+IDApe1xyXG4gICAgICAgICAgICAgICAgd2hpbGUoc1sxXS5sZW5ndGggPCA1KSB7Ly/kuK3pgZNcclxuICAgICAgICAgICAgICAgICAgICBzWzFdLnB1c2goY2FyZHNxLnBvcCgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihjYXJkc3EubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgICAgICB3aGlsZShzWzBdLmxlbmd0aCA8IDMpIHsvL+WktOmBk1xyXG4gICAgICAgICAgICAgICAgICAgIHNbMF0ucHVzaChjYXJkc3EucG9wKCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9Ki9cclxuICAgICAgICAgICAgaWYoc1syXVs0XSA9PSBudWxsIHx8IHNbMV1bNF0gPT0gbnVsbCB8fCBzWzBdWzJdID09IG51bGxcclxuICAgICAgICAgICAgICAgIHx8IHNbMl1bNF0gPT0gJycgfHwgc1sxXVs0XSA9PSAnJyB8fCBzWzBdWzJdID09ICcnKXtcclxuICAgICAgICAgICAgICAgIHJlc3VsdEFycmF5LnNwbGljZShpLDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgcmVzdWx0Q2FyZHMgPSBbXTtcclxuICAgICAgICBsZXQgY2FyZHNzMSA9IHRoaXMuX2FsbENhcmRNb2Rlcy5maWx0ZXIoZnVuY3Rpb24oaSl7cmV0dXJuIGk7fSk7XHJcbiAgICAgICAgdmFyIGluZGV4YXNkZiA9IDI7XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgMzsgaSsrKXtcclxuICAgICAgICAgICAgbGV0IGxlbmd0aCA9IGluZGV4YXNkZiA9PSAwPyAzOiA1O1xyXG4gICAgICAgICAgICBsZXQgY2FyZHNzID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkc3MxLCBsZW5ndGgpIHx8IFtdO1xyXG4gICAgICAgICAgICBjYXJkc3MxID0gY2FyZHNzMS5rcV9leGNsdWRlcyhjYXJkc3MpO1xyXG4gICAgICAgICAgICByZXN1bHRDYXJkc1tpbmRleGFzZGZdID0gY2FyZHNzO1xyXG4gICAgICAgICAgICBpbmRleGFzZGYtLTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7aSA8IHJlc3VsdENhcmRzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgbGV0IGxlbmd0aCA9IGkgPT0gMD8gMzogNTtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdENhcmRzW2ldLmxlbmd0aCA8IGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY2FyZHNzMSA9IGNhcmRzczEua3FfZXhjbHVkZXMocmVzdWx0Q2FyZHNbaV0pO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUocmVzdWx0Q2FyZHNbaV0ubGVuZ3RoIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Q2FyZHNbaV0ucHVzaChjYXJkc3MxLnBvcCgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVzdWx0QXJyYXkucHVzaChyZXN1bHRDYXJkcyk7XHJcblxyXG4gICAgICAgIHZhciBjYXJkc1R5cGVOYW1lcyA9IFtdO1xyXG4gICAgICAgIHZhciByZXN1bHRBcnJheXMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXkubGVuZ3RoO2krKyl7Ly/liKDpmaTnsbvlnovnm7jlkIznmoTnu4TlkIhcclxuICAgICAgICAgICAgbGV0IHMgPSByZXN1bHRBcnJheVtpXTtcclxuICAgICAgICAgICAgbGV0IHR5cGVOYW1lMCA9IEtRQ2FyZC5jYXJkc1R5cGVOYW1lKHNbMF0pO1xyXG4gICAgICAgICAgICB0eXBlTmFtZTAgKz0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoc1sxXSk7XHJcbiAgICAgICAgICAgIHR5cGVOYW1lMCArPSBLUUNhcmQuY2FyZHNUeXBlTmFtZShzWzJdKTtcclxuICAgICAgICAgICAgaWYoY2FyZHNUeXBlTmFtZXMuaW5kZXhPZih0eXBlTmFtZTApID09IC0xKXtcclxuICAgICAgICAgICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1swXSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoc1sxXSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgd2VpU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHNbMl0pO1xyXG4gICAgICAgICAgICAgICAgaWYoemhvbmdTY29yZSA+IHRvdVNjb3JlICYmIHpob25nU2NvcmUgPCB3ZWlTY29yZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FyZHNUeXBlTmFtZXMucHVzaCh0eXBlTmFtZTApO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdEFycmF5cy5wdXNoKHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXN1bHRBcnJheXMuc29ydChmdW5jdGlvbiAoYTEsYTIpIHtcclxuICAgICAgICAgICAgdmFyIGIwID0gcGFyc2VJbnQoS1FDYXJkLmNhcmRzVHlwZShhMlswXSkgKSArIFwiXCI7XHJcbiAgICAgICAgICAgIHZhciBiMSA9IHBhcnNlSW50KEtRQ2FyZC5jYXJkc1R5cGUoYTJbMV0pICkgKyBcIlwiO1xyXG4gICAgICAgICAgICB2YXIgYjIgPSBwYXJzZUludChLUUNhcmQuY2FyZHNUeXBlKGEyWzJdKSApICsgXCJcIjtcclxuXHJcbiAgICAgICAgICAgIHZhciBzMCA9IHBhcnNlSW50KEtRQ2FyZC5jYXJkc1R5cGUoYTFbMF0pICkgKyBcIlwiO1xyXG4gICAgICAgICAgICB2YXIgczEgPSBwYXJzZUludChLUUNhcmQuY2FyZHNUeXBlKGExWzFdKSApICsgXCJcIjtcclxuICAgICAgICAgICAgdmFyIHMyID0gcGFyc2VJbnQoS1FDYXJkLmNhcmRzVHlwZShhMVsyXSkgKSArIFwiXCI7XHJcblxyXG4gICAgICAgICAgICB2YXIgcyA9IHBhcnNlSW50KHMyICsgczEgKyBzMCk7XHJcbiAgICAgICAgICAgIHZhciBiID0gcGFyc2VJbnQoYjIgKyBiMSArIGIwKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBiIC0gcztcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYocmVzdWx0QXJyYXlzLmxlbmd0aCA+IDcpe1xyXG4gICAgICAgICAgICByZXN1bHRBcnJheXMgPSByZXN1bHRBcnJheXMuc2xpY2UoMCw3KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy9mb3IodmFyIGkgPSAwO2kgPCByZXN1bHRBcnJheXMubGVuZ3RoO2krKyl7Ly/lpoLmnpzmnInnm7jlhazniYzliJnliKDpmaRcclxuICAgICAgICAvLyAgICBsZXQgcyA9IHJlc3VsdEFycmF5c1tpXTtcclxuICAgICAgICAvLyAgICBsZXQgdG91U2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHNbMF0pO1xyXG4gICAgICAgIC8vICAgIGxldCB6aG9uZ1Njb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhzWzFdKTtcclxuICAgICAgICAvLyAgICBsZXQgd2VpU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHNbMl0pO1xyXG4gICAgICAgIC8vICAgIGNjLmxvZyh0b3VTY29yZSx6aG9uZ1Njb3JlLHdlaVNjb3JlKTtcclxuICAgICAgICAvLyAgICBpZih3ZWlTY29yZSA8IHRvdVNjb3JlIHx8IHdlaVNjb3JlIDwgemhvbmdTY29yZSl7XHJcbiAgICAgICAgLy8gICAgICAgIHJlc3VsdEFycmF5cy5zcGxpY2UoaSwxKTtcclxuICAgICAgICAvLyAgICB9XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy9jYy5sb2cocmVzdWx0QXJyYXlzKVxyXG4gICAgICAgIC8vY2MubG9nKCctLS0tLS0tODk3JylcclxuXHJcbiAgICAgICAgLy9pZihjYy50ZVNodVBhaUNhcmRzKXtcclxuICAgICAgICAvLyAgICB2YXIgVGVTaHVDYXJkcyA9IGNjLnRlU2h1UGFpQ2FyZHMubWFwKGZ1bmN0aW9uKGNhKXtcclxuICAgICAgICAvLyAgICAgICByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2EpKTtcclxuICAgICAgICAvLyAgICB9KTtcclxuICAgICAgICAvLyAgICByZXN1bHRBcnJheXMudW5zaGlmdChUZVNodUNhcmRzKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vfVxyXG5cclxuICAgICAgICBpZihyZXN1bHRBcnJheXMubGVuZ3RoIDw9IDApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fYWxsQ2FyZE1vZGVzLmZvckVhY2goZnVuY3Rpb24oaSl7aWYoaS5zY29yZXMgPT0gMSkgaS5zY29yZXMgPSAxNDt9KTtcclxuXHJcbiAgICAgICAgICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKHRoaXMuX2FsbENhcmRNb2Rlcyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9hbGxDYXJkTW9kZXMgPSB0aGlzLl9hbGxDYXJkTW9kZXMua3FfZXhjbHVkZXMoY2FyZDIwKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2FsbENhcmRNb2RlcyA9IEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHModGhpcy5fYWxsQ2FyZE1vZGVzKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2FsbENhcmRNb2RlcyA9IGNhcmQyMC5jb25jYXQodGhpcy5fYWxsQ2FyZE1vZGVzKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBhc2RmMSA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSgwLDUpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGFzZGYyID0gdGhpcy5fYWxsQ2FyZE1vZGVzLnNsaWNlKDUsMTApO1xyXG5cclxuICAgICAgICAgICAgdmFyIGFzZGYzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLnNsaWNlKDEwLDEzKTtcclxuXHJcbiAgICAgICAgICAgIHJlc3VsdEFycmF5cy5wdXNoKFthc2RmMyxhc2RmMixhc2RmMV0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmF1dG9DYXJkTGF5b3V0Lm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICB0aGlzLmF1dG9DYXJkU2Nyb2xsVmlldy5zY3JvbGxUb0xlZnQoKTtcclxuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCByZXN1bHRBcnJheXMubGVuZ3RoO2krKyl7Ly/mt7vliqDpooTliLbkvZNcclxuICAgICAgICAgICAgbGV0IHMgPSByZXN1bHRBcnJheXNbaV07XHJcbiAgICAgICAgICAgIGxldCBhdXRvQ2FyZCA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYXV0b0NhcmQpO1xyXG4gICAgICAgICAgICBhdXRvQ2FyZC55ID0gMDtcclxuICAgICAgICAgICAgc1swXS5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmIChpLnBvaW50ID09IDE0KSBpLnBvaW50ID0gMTt9KVxyXG4gICAgICAgICAgICBzWzFdLmZvckVhY2goZnVuY3Rpb24oaSl7aWYgKGkucG9pbnQgPT0gMTQpIGkucG9pbnQgPSAxO30pXHJcbiAgICAgICAgICAgIHNbMl0uZm9yRWFjaChmdW5jdGlvbihpKXtpZiAoaS5wb2ludCA9PSAxNCkgaS5wb2ludCA9IDE7fSlcclxuICAgICAgICAgICAgdmFyIGNhcmRzTm9kZSA9IFthdXRvQ2FyZC5jaGlsZHJlblsxXSxhdXRvQ2FyZC5jaGlsZHJlblszXSxhdXRvQ2FyZC5jaGlsZHJlblsyXV07XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9zZXRDYXJkRGFvU3ByaXRlKGNhcmRzTm9kZSxzKTtcclxuXHJcbiAgICAgICAgICAgIGF1dG9DYXJkLmNhcmRBcnJheSA9IHM7XHJcbiAgICAgICAgICAgIHZhciBldmVudEhhbmRsZXIgPSBuZXcgY2MuQ29tcG9uZW50LkV2ZW50SGFuZGxlcigpO1xyXG4gICAgICAgICAgICBldmVudEhhbmRsZXIudGFyZ2V0ID0gdGhpcy5ub2RlO1xyXG4gICAgICAgICAgICBldmVudEhhbmRsZXIuY29tcG9uZW50ID0gXCJDYXJkVHlwZUNvbWJpbmVcIjtcclxuICAgICAgICAgICAgZXZlbnRIYW5kbGVyLmhhbmRsZXIgPSBcImNsaWNrQXV0b1NlbGVjdGVkQ2FyZHNcIjtcclxuICAgICAgICAgICAgZXZlbnRIYW5kbGVyLmN1c3RvbUV2ZW50RGF0YSA9IGk7XHJcbiAgICAgICAgICAgIGF1dG9DYXJkLmdldENvbXBvbmVudChjYy5CdXR0b24pLmNsaWNrRXZlbnRzLnB1c2goZXZlbnRIYW5kbGVyKTtcclxuICAgICAgICAgICAgdGhpcy5hdXRvQ2FyZExheW91dC5ub2RlLmFkZENoaWxkKGF1dG9DYXJkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZmluZENhcmRJbmRleC5hcnIgPSByZXN1bHRBcnJheXM7XHJcblxyXG4gICAgICAgIHRoaXMuYXV0b1NlbGVjdGVkQ2FyZHNPbmUoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy9kYW9DYW5jZWxBbGw6IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgIHZhciBub2RlcyA9IFt0aGlzLmxheW91dFRvdURhby5ub2RlLHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZSx0aGlzLmxheW91dFdlaURhby5ub2RlXTtcclxuICAgIC8vICAgIGZvcih2YXIgaSA9IDA7aSA8IG5vZGVzLmxlbmd0aDtpKyspe1xyXG4gICAgLy8gICAgICAgIG5vZGVzW2ldLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAvLyAgICB9XHJcbiAgICAvL30sXHJcblxyXG4gICAgYXV0b1NlbGVjdGVkQ2FyZHNPbmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuY2FyZHNMYXlvdXQubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG5cclxuICAgICAgICB2YXIgaW5kZXhzID0gMDtcclxuXHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMuYXV0b0NhcmRMYXlvdXQubm9kZS5jaGlsZHJlbi5sZW5ndGg7aSsrKXtcclxuXHJcbiAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXMuYXV0b0NhcmRMYXlvdXQubm9kZS5jaGlsZHJlbltpXTtcclxuXHJcbiAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYXV0b0NhcmRMYXlvdXQubm9kZS5jaGlsZHJlbltpbmRleHNdLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIGxldCByZXN1bHRBcnJheSA9IHRoaXMuX2ZpbmRDYXJkSW5kZXguYXJyW2luZGV4c107XHJcblxyXG4gICAgICAgIHRoaXMuX2ZpbmRDYXJkSW5kZXguaW5kZXhzID0gaW5kZXhzO1xyXG5cclxuXHJcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXkubGVuZ3RoO2krKyl7XHJcblxyXG4gICAgICAgICAgICB2YXIgY2FyZE1vZGVzID0gcmVzdWx0QXJyYXlbaV07XHJcblxyXG4gICAgICAgICAgICBjYXJkTW9kZXMuc29ydChLUUNhcmQuc29ydCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbnVtID0gMDtcclxuICAgICAgICAgICAgaWYoaSA9PSAxKXtcclxuICAgICAgICAgICAgICAgIG51bSA9IDM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihpID09IDIpe1xyXG4gICAgICAgICAgICAgICAgbnVtID0gODtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL2NhcmRNb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmIChpLnBvaW50ID09IDE0KSBpLnBvaW50ID0gMTt9KVxyXG4gICAgICAgICAgICBjYXJkTW9kZXMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZE1vZGUsaW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2FyZE5hbWUgPSBjYXJkTW9kZS5jYXJkTmFtZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBudW1CZXIgPSBudW0raW5kZXg7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG5vZGRzMSA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXHJcblxyXG4gICAgICAgICAgICAgICAgbm9kZHMxLmFuY2hvclkgPSAxO1xyXG5cclxuICAgICAgICAgICAgICAgIG5vZGRzMS5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTsgLy/mt7vliqDnsr7ngbXnu4Tku7ZcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuW251bUJlcl0uYWRkQ2hpbGQobm9kZHMxKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuW251bUJlcl0uY2hpbGRyZW5bMF0uY2FyZE5hbWUgPSBjYXJkTmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuW251bUJlcl0uY2hpbGRyZW5bMF0uX2NhcmRNb2RlbCA9IG5ldyBLUUNhcmQoY2FyZE5hbWUsbnVsbCxpbmRleCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGJ0blNwcml0ZXMgPSAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbltudW1CZXJdLmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW5bbnVtQmVyXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9ICcnO1xyXG5cclxuICAgICAgICAgICAgICAgIGJ0blNwcml0ZXMubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGNjLm1hUGFpID09IGNhcmROYW1lKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGRzID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZHMuYWRkQ29tcG9uZW50KGNjLlNwcml0ZSk7IC8v5re75Yqg57K+54G157uE5Lu2XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNjLmxvYWRlci5sb2FkUmVzKCdwbGF5L2Rlc2svaW1nX3JlZDVfMScsIGNjLlNwcml0ZUZyYW1lLCBmdW5jdGlvbiAoZXJyLCBzcHJpdGVGcmFtZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycikge2NjLmVycm9yKGVyci5tZXNzYWdlIHx8IGVycik7cmV0dXJuO31cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidG5TcHJpdGUxID0gbm9kZHMuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUud2lkdGggPSAxMDc7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUuaGVpZ2h0ID0gMTU1O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnRuU3ByaXRlMS5ub2RlLnkgPSAtNjUuNTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnRuU3ByaXRlcy5ub2RlLmFkZENoaWxkKG5vZGRzKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSAncHVibGljLXBpYy1jYXJkLXBva2VyLScrIGNhcmROYW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZXMsIDk1LCAxMzApO1xyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY2xpY2tBdXRvU2VsZWN0ZWRDYXJkcyhudWxsKTtcclxuXHJcbiAgICAgICAgLy90aGlzLl9zZXRDYXJkRGFvU3ByaXRlKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0F1dG9TZWxlY3RlZENhcmRzOiBmdW5jdGlvbihldmVudCxpbmRleHMgPSAwKSB7XHJcblxyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmF1dG9DYXJkTGF5b3V0Lm5vZGUuY2hpbGRyZW4ubGVuZ3RoO2krKyl7XHJcblxyXG4gICAgICAgICAgICB2YXIgbm9kZXMgPSB0aGlzLmF1dG9DYXJkTGF5b3V0Lm5vZGUuY2hpbGRyZW5baV07XHJcblxyXG4gICAgICAgICAgICBub2Rlcy5jaGlsZHJlblswXS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmF1dG9DYXJkTGF5b3V0Lm5vZGUuY2hpbGRyZW5baW5kZXhzXS5jaGlsZHJlblswXS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVBva2VyQ2xpY2soKTtcclxuXHJcbiAgICAgICAgaWYoZXZlbnQpe1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0QXJyYXkgPSBldmVudC50YXJnZXQuY2FyZEFycmF5O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0QXJyYXkgPSB0aGlzLl9maW5kQ2FyZEluZGV4LmFycltpbmRleHNdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgdG91U2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHJlc3VsdEFycmF5WzBdKTtcclxuICAgICAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0QXJyYXlbMV0pO1xyXG4gICAgICAgIGxldCB3ZWlTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0QXJyYXlbMl0pO1xyXG4gICAgICAgIC8vY2MubG9nKHRvdVNjb3JlKTtcclxuICAgICAgICAvL2NjLmxvZyh6aG9uZ1Njb3JlKTtcclxuICAgICAgICAvL2NjLmxvZyh3ZWlTY29yZSk7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZygnLS0tLS0tLS0tLTExODAnKVxyXG4gICAgICAgIHJlc3VsdEFycmF5ID0gcmVzdWx0QXJyYXkubWFwKGZ1bmN0aW9uIChjYXJkTW9kZSl7XHJcblxyXG4gICAgICAgICAgICBjYXJkTW9kZSA9IEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZE1vZGUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhcmRNb2RlLm1hcChmdW5jdGlvbiAoY2FyZE1vZGVzKXtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FyZE1vZGVzLmNhcmROYW1lKCk7XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2cocmVzdWx0QXJyYXkpXHJcblxyXG4gICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50LmZvckVhY2goZnVuY3Rpb24obm9kZXMpe1xyXG5cclxuICAgICAgICAgICAgbm9kZXMuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7XHJcblxyXG4gICAgICAgICAgICBub2Rlcy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGkpe2kuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7fSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuTGF5b3V0V2l0aEV2ZW50ID0gW107XHJcblxyXG4gICAgICAgIHJlc3VsdEFycmF5ID0gcmVzdWx0QXJyYXlbMF0uY29uY2F0KHJlc3VsdEFycmF5WzFdKS5jb25jYXQocmVzdWx0QXJyYXlbMl0pO1xyXG5cclxuICAgICAgICB2YXIgY2FyZEFsbE5vZGUgPSB0aGlzLmNhcmRBbGxOb2RlLmNoaWxkcmVuLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaTt9KTtcclxuXHJcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgcmVzdWx0QXJyYXkubGVuZ3RoO2krKyl7XHJcblxyXG4gICAgICAgICAgICB2YXIgcyA9IHJlc3VsdEFycmF5W2ldO1xyXG5cclxuICAgICAgICAgICAgZm9yKHZhciBqID0gMDtqIDwgY2FyZEFsbE5vZGUubGVuZ3RoO2orKyl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBjYXJkQWxsTm9kZVtqXTtcclxuXHJcbiAgICAgICAgICAgICAgICBkLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGQuY2hpbGRyZW5bMF0uY2FyZE5hbWUgPT0gcyl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGQuc3RvcEFsbEFjdGlvbnMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRldGFpbCA9IHRoaXMuY2hhbmdlTm9kZVNwYWNlQVJbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjYWxsID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG5vZGVzKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0Q2FyZERhb1Nwcml0ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcyksIHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5tb3ZlVG8odGhpcy5jYXJkVGltZSxkZXRhaWwpLCBjYWxsKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNhcmRBbGxOb2RlLnNwbGljZShqLDEpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uKFNwcml0ZUZyYW1lLCBwYXRoLCBTcHJpdGVzTm9kZSwgdywgaCkge1xyXG5cclxuICAgICAgICB2YXIgU3ByaXRlID0gU3ByaXRlRnJhbWUuZ2V0U3ByaXRlRnJhbWUoIHBhdGggKTtcclxuXHJcbiAgICAgICAgU3ByaXRlc05vZGUuc3ByaXRlRnJhbWUgPSBTcHJpdGU7XHJcblxyXG4gICAgICAgIGlmKHcpIFNwcml0ZXNOb2RlLm5vZGUud2lkdGggPSB3O1xyXG5cclxuICAgICAgICBpZihoKSBTcHJpdGVzTm9kZS5ub2RlLmhlaWdodCA9IGg7XHJcbiAgICB9LFxyXG5cclxuICAgIHN0aWNrT3V0RmluZENhcmRUeXBlMTogZnVuY3Rpb24gKGNhcmRzLGluZGV4ID0gMCkge1xyXG4gICAgICAgIC8vLy8g5bCG5bey5pyJ55qE56qB5Ye655qE54mM55qE5L2N572u6YeN572u5Zue5Yid5aeL5L2N572uXHJcbiAgICAgICAgLy90aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XHJcbiAgICAgICAgLy9sZXQgc2VsZWN0ZWRDYXJkTmFtZXMgPSBjYXJkcy5tYXAoZnVuY3Rpb24oY2FyZE1vZGVsKXtcclxuICAgICAgICAvLyAgICByZXR1cm4gY2FyZE1vZGVsLmNhcmROYW1lKCk7XHJcbiAgICAgICAgLy99LmJpbmQodGhpcykpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy9sZXQgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLmZpbHRlcihmdW5jdGlvbiAoY2FyZE5vZGUpIHtcclxuICAgICAgICAvLyAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmROb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xyXG4gICAgICAgIC8vICAgIGlmKHNlbGVjdGVkQ2FyZE5hbWVzLmluY2x1ZGVzKGNhcmRQcmVmYWIuY2FyZE5hbWUoKSkpIHtcclxuICAgICAgICAvLyAgICAgICAgdmFyIG5hbWVJbmRleCA9IHNlbGVjdGVkQ2FyZE5hbWVzLmluZGV4T2YoY2FyZFByZWZhYi5jYXJkTmFtZSgpKTtcclxuICAgICAgICAvLyAgICAgICAgc2VsZWN0ZWRDYXJkTmFtZXMuc3BsaWNlKG5hbWVJbmRleCwxKTtcclxuICAgICAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAvL30pO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy9jYy5sb2coJy0tLS0tLS02OTYnKVxyXG4gICAgICAgIC8vdGhpcy5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XHJcbiAgICAgICAgLy9pZihpbmRleCA9PSAxKXtcclxuICAgICAgICAvLyAgICB0aGlzLl9hZGREYW9DYXJkVG9MYXlvdXQodGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgMyk7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy9lbHNlIGlmKGluZGV4ID09IDIpe1xyXG4gICAgICAgIC8vICAgIHRoaXMuX2FkZERhb0NhcmRUb0xheW91dCh0aGlzLmxheW91dFpob25nRGFvLm5vZGUpO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vZWxzZSBpZihpbmRleCA9PSAzKXtcclxuICAgICAgICAvLyAgICB0aGlzLl9hZGREYW9DYXJkVG9MYXlvdXQodGhpcy5sYXlvdXRXZWlEYW8ubm9kZSk7XHJcbiAgICAgICAgLy99XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfdG91Y2hDYXJkTGF5b3V0OiBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAvL2V2ZW50LmJ1YmJsZXMgPSB0cnVlO1xyXG4gICAgICAgIC8vbGV0IGxvY2F0aW9uID0gZXZlbnQuZ2V0TG9jYXRpb24oKTtcclxuICAgICAgICAvL2xldCBjYXJkUHJlZmFiID0gdGhpcy5fY2FyZFByZWZhYkluQ2FyZExheW91dFdpdGhMb2NhdGlvbihsb2NhdGlvbik7XHJcbiAgICAgICAgLy9pZiAoY2FyZFByZWZhYikge1xyXG4gICAgICAgIC8vICAgIGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuc2V0U2VsZWN0ZWQodHJ1ZSk7XHJcbiAgICAgICAgLy8gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgLy99XHJcbiAgICB9LFxyXG5cclxuICAgIF90b3VjaENhcmRMYXlvdXRFbmQ6IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIC8vdGhpcy5fY2hhbmdlU2VsZWN0ZWRDYXJkUHJlZmFic1koKTtcclxuICAgICAgICAvL3RoaXMuX2Rpc2VjbGVjdENhcmRQcmVmYWJzKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9jYXJkUHJlZmFiSW5DYXJkTGF5b3V0V2l0aExvY2F0aW9uOiBmdW5jdGlvbiAobG9jYXRpb24pIHtcclxuICAgICAgICAvL2xvY2F0aW9uID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZUFSKGxvY2F0aW9uKTtcclxuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbiAoY2FyZE5vZGUxLCBjYXJkTm9kZTIpIHtcclxuICAgICAgICAvLyAgICBsZXQgcmVjdDEgPSBjYXJkTm9kZTEuZ2V0Qm91bmRpbmdCb3goKTtcclxuICAgICAgICAvLyAgICBsZXQgcmVjdDIgPSBjYXJkTm9kZTIuZ2V0Qm91bmRpbmdCb3goKTtcclxuICAgICAgICAvLyAgICByZXR1cm4gcmVjdDIueCAtIHJlY3QxLng7XHJcbiAgICAgICAgLy99KTtcclxuICAgICAgICAvL2ZvciAobGV0IGluZGV4IGluIGNhcmROb2Rlcykge1xyXG4gICAgICAgIC8vICAgIGxldCBjYXJkTm9kZSA9IGNhcmROb2Rlc1tpbmRleF07XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICBsZXQgcmVjdCA9IGNhcmROb2RlLmdldEJvdW5kaW5nQm94KCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICBpZiAoY2MucmVjdENvbnRhaW5zUG9pbnQocmVjdCwgbG9jYXRpb24pKSB7XHJcbiAgICAgICAgLy8gICAgICAgIHJldHVybiBjYXJkTm9kZTtcclxuICAgICAgICAvLyAgICB9XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL3JldHVybiBudWxsO1xyXG4gICAgfSxcclxuXHJcbiAgICBfY2hhbmdlU2VsZWN0ZWRDYXJkUHJlZmFic1k6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLl9zZWxlY3RlZENhcmRQcmVmYWJzKCk7XHJcbiAgICAgICAgLy90aGlzLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlQb2tlckNsaWNrKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9jaGFuZ2VDYXJkUHJlZmFic1k6IGZ1bmN0aW9uIChjYXJkTm9kZXMpIHtcclxuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xyXG4gICAgICAgIC8vICAgIGxldCB5ID0gY2FyZE5vZGUuZ2V0UG9zaXRpb25ZKCk7XHJcbiAgICAgICAgLy8gICAgaWYgKHkgPT0gdGhpcy5fY2FyZE9mZnNldFkpIHtcclxuICAgICAgICAvLyAgICAgICAgY2FyZE5vZGUuc2V0UG9zaXRpb25ZKHRoaXMuX2NhcmRPZmZzZXRZICsgNTUpO1xyXG4gICAgICAgIC8vICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gICAgICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSk7XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NlbGVjdGVkQ2FyZFByZWZhYnM6IGZ1bmN0aW9uIChpbmNsdWRlU3RpY2tPdXQgPSBmYWxzZSkge1xyXG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcclxuICAgICAgICAvL3JldHVybiBjYXJkTm9kZXMuZmlsdGVyKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xyXG4gICAgICAgIC8vICAgIGxldCBjYXJkUHJlZmFiID0gY2FyZE5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XHJcbiAgICAgICAgLy8gICAgbGV0IGlzU2VsZWN0ZWQgPSBjYXJkUHJlZmFiLmlzU2VsZWN0ZWQoKTtcclxuICAgICAgICAvLyAgICBpZiAoIWlzU2VsZWN0ZWQgJiYgaW5jbHVkZVN0aWNrT3V0KSB7XHJcbiAgICAgICAgLy8gICAgICAgIGlzU2VsZWN0ZWQgPSBjYXJkTm9kZS5nZXRQb3NpdGlvblkoKSA+IDEwO1xyXG4gICAgICAgIC8vICAgIH1cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgIHJldHVybiBpc1NlbGVjdGVkO1xyXG4gICAgICAgIC8vfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9kaXNlY2xlY3RDYXJkUHJlZmFiczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbjtcclxuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgICAgLy8gICAgbm9kZS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKS5zZXRTZWxlY3RlZChmYWxzZSk7XHJcbiAgICAgICAgLy99KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g6YeN572uIGNhcmRzIOeahCBYXHJcbiAgICBfcmVzZXRDYXJkc1Bvc2l0aW9uWDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vbGV0IGludGVydmFsID0gOTg7XHJcbiAgICAgICAgLy9sZXQgaW50ZXJ2YWwgPSA3ODtcclxuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4gfHwgW107XHJcbiAgICAgICAgLy9sZXQgbGVuZ3RoID0gY2FyZE5vZGVzLmxlbmd0aDtcclxuICAgICAgICAvL2lmIChsZW5ndGggPT0gMCkge1xyXG4gICAgICAgIC8vICAgIHJldHVybjtcclxuICAgICAgICAvL31cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vbGV0IG1pZGRsZUluZGV4ID0gbGVuZ3RoIC8gMjtcclxuICAgICAgICAvL2xldCBjYXJkV2lkdGggPSAxNTQ7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vLy90aGlzLmNhcmRzTGF5b3V0U29ydCgpO1xyXG4gICAgICAgIC8vaWYodGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9PSB0cnVlKXtcclxuICAgICAgICAvLyAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XHJcbiAgICAgICAgLy8gICAgICAgIGxldCBjb21wb25lbnQxID0gbjEuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XHJcbiAgICAgICAgLy8gICAgICAgIGxldCBjb21wb25lbnQyID0gbjIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XHJcbiAgICAgICAgLy8gICAgICAgIHJldHVybiBjb21wb25lbnQyLmNhcmRNb2RlKCkuY29sb3IgLSBjb21wb25lbnQxLmNhcmRNb2RlKCkuY29sb3I7XHJcbiAgICAgICAgLy8gICAgfSk7XHJcbiAgICAgICAgLy99ZWxzZXtcclxuICAgICAgICAvLyAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XHJcbiAgICAgICAgLy8gICAgICAgIGxldCBjb21wb25lbnQxID0gbjEuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XHJcbiAgICAgICAgLy8gICAgICAgIGxldCBjb21wb25lbnQyID0gbjIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XHJcbiAgICAgICAgLy8gICAgICAgIHJldHVybiBjb21wb25lbnQxLmNhcmRNb2RlKCkuc29ydChjb21wb25lbnQyLmNhcmRNb2RlKCkpO1xyXG4gICAgICAgIC8vICAgIH0pO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLy9jYXJkTm9kZXMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XHJcbiAgICAgICAgLy8vLyAgICBsZXQgY29tcG9uZW50MSA9IG4xLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xyXG4gICAgICAgIC8vLy8gICAgbGV0IGNvbXBvbmVudDIgPSBuMi5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcclxuICAgICAgICAvLy8vXHJcbiAgICAgICAgLy8vLyAgICByZXR1cm4gY29tcG9uZW50MS5jYXJkTW9kZSgpLnNvcnQoY29tcG9uZW50Mi5jYXJkTW9kZSgpKTtcclxuICAgICAgICAvLy8vfSk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSwgaW5kZXgpIHtcclxuICAgICAgICAvLyAgICBjYXJkTm9kZS56SW5kZXggPSBpbmRleDtcclxuICAgICAgICAvLyAgICBsZXQgeCA9IChpbmRleCAtIG1pZGRsZUluZGV4KSAqIGludGVydmFsICsgY2FyZFdpZHRoIC8gMztcclxuICAgICAgICAvLyAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblgoeCk7XHJcbiAgICAgICAgLy99KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g6YeN572uIGNhcmRzIOeahCBY5Li6MFxyXG4gICAgcmVzZXRDYXJkc1Bvc2l0aW9uWDE6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL2xldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4gfHwgW107XHJcbiAgICAgICAgLy9sZXQgbGVuZ3RoID0gY2FyZE5vZGVzLmxlbmd0aDtcclxuICAgICAgICAvL2lmIChsZW5ndGggPT0gMCkge1xyXG4gICAgICAgIC8vICAgIHJldHVybjtcclxuICAgICAgICAvL31cclxuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xyXG4gICAgICAgIC8vICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSgwKTtcclxuICAgICAgICAvL30pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcmVzZXRDYXJkc1Bvc2l0aW9uWTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcclxuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xyXG4gICAgICAgIC8vICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSk7XHJcbiAgICAgICAgLy99LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDlpLTjgIHkuK3jgIHlsL7pgZMgbGF5b3V0IOeahOeCueWHu+S6i+S7tlxyXG4gICAgX3JlZ2lzdGVyRGFvc0xheW91dENsaWNrRXZlbnQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jaGFuZ2VOb2RlU3BhY2VBUiA9IFtdOy8v6K6w5b2V5omA5pyJ54mM55qE5Z2Q5qCHXHJcbiAgICAgICAgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG5vZGVzKXtcclxuICAgICAgICAgICAgLy/ojrflj5boioLngrnnmoTkuJbnlYzlnZDmoIdcclxuICAgICAgICAgICAgdmFyIGNhcmRCYWNrV29ybGRTcGFjZTEgPSBub2Rlcy5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoMCwgMCkpO1xyXG4gICAgICAgICAgICAvL+iOt+WPluebuOWvueeItuiKgueCueaJgOWcqOeahOWdkOagh1xyXG4gICAgICAgICAgICB2YXIgZGV0YWlsID0gbm9kZXMucGFyZW50LmNvbnZlcnRUb05vZGVTcGFjZUFSKGNhcmRCYWNrV29ybGRTcGFjZTEpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VOb2RlU3BhY2VBUi5wdXNoKGRldGFpbCk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrQWxsQ2FyZDogZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlQb2tlckNsaWNrKCk7XHJcbiAgICAgICAgaWYodGhpcy5MYXlvdXRXaXRoRXZlbnQubGVuZ3RoIDw9IDEpe1xyXG4gICAgICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudC5wdXNoKGV2ZW50LnRhcmdldCk7XHJcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC5jb2xvciA9IG5ldyBjYy5Db2xvcigxODIsIDE4MiwgMTgyKTtcclxuICAgICAgICAgICAgZXZlbnQudGFyZ2V0LmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oaSl7aS5jb2xvciA9IG5ldyBjYy5Db2xvcigxODIsIDE4MiwgMTgyKTt9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5MYXlvdXRXaXRoRXZlbnQubGVuZ3RoID09IDIpe1xyXG5cclxuICAgICAgICAgICAgdmFyIGFyciA9IFtdO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQuZm9yRWFjaChmdW5jdGlvbihub2Rlcyl7XHJcbiAgICAgICAgICAgICAgICAvL+iOt+WPluiKgueCueeahOS4lueVjOWdkOagh1xyXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRCYWNrV29ybGRTcGFjZTEgPSBub2Rlcy5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoMCwgMCkpO1xyXG4gICAgICAgICAgICAgICAgLy/ojrflj5bnm7jlr7nniLboioLngrnmiYDlnKjnmoTlnZDmoIdcclxuICAgICAgICAgICAgICAgIHZhciBkZXRhaWwgPSBub2Rlcy5wYXJlbnQuY29udmVydFRvTm9kZVNwYWNlQVIoY2FyZEJhY2tXb3JsZFNwYWNlMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgYXJyLnVuc2hpZnQoZGV0YWlsKTtcclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudC5mb3JFYWNoKGZ1bmN0aW9uKG5vZGVzLGluZGV4KXtcclxuXHJcbiAgICAgICAgICAgICAgICBub2Rlcy5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTtcclxuXHJcbiAgICAgICAgICAgICAgICBub2Rlcy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGkpe2kuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7fSk7XHJcblxyXG4gICAgICAgICAgICAgICAgbm9kZXMuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBub2Rlcy5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRDYXJkRGFvU3ByaXRlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCB0aGlzLmNhcmRUaW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICBub2Rlcy5zdG9wQWxsQWN0aW9ucygpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBkZXRhaWwgPSBhcnJbaW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgICAgIG5vZGVzLnJ1bkFjdGlvbihjYy5tb3ZlVG8odGhpcy5jYXJkVGltZSxkZXRhaWwpKTtcclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudCA9IFtdO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfc2V0Q2FyZERhb1Nwcml0ZTogZnVuY3Rpb24gKG5vZGVzID0gbnVsbCAsY2FyZHMgPSBudWxsKSB7XHJcblxyXG4gICAgICAgIGlmKCFub2Rlcyl7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNhcmRBbGxzID0gIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBiLnkgLSBhLnk7fSkubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBpLmNoaWxkcmVuWzBdO30pO1xyXG5cclxuICAgICAgICAgICAgY2FyZHMgPSBbdGhpcy5fdGFvRGFvQ2FyZE1vZGVzKCksdGhpcy5femhvbmdEYW9DYXJkTW9kZXMoKSx0aGlzLl93ZWlEYW9DYXJkTW9kZXMoKV07XHJcblxyXG4gICAgICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe2NhcmQuZm9yRWFjaChmdW5jdGlvbihpKXtpZiAoaS5zY29yZXMgPT0gMTQpe2kuc2NvcmVzID0gMTt9fSk7fSk7XHJcblxyXG4gICAgICAgICAgICBub2RlcyA9IFt0aGlzLnRvdURhb05vZGUsdGhpcy56aG9uZ0Rhb05vZGUsdGhpcy53ZWlEYW9Ob2RlXTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL+WktOmBk1xyXG4gICAgICAgIGxldCB0eXBlTmFtZTAgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzWzBdKSsxO1xyXG5cclxuICAgICAgICB0eXBlTmFtZTAgPSB0eXBlTmFtZTA+PTEwID8gdHlwZU5hbWUwIDpcIjBcIit0eXBlTmFtZTA7XHJcblxyXG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD09JzA0JyA/ICcxMScgOnR5cGVOYW1lMDtcclxuXHJcbiAgICAgICAgdmFyIHBhdGggPSAnZ2FtZV9wb2tlcl90eXBlJysgdHlwZU5hbWUwO1xyXG5cclxuICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuZGFvU3ByaXRlQXRsYXMsIHBhdGggLG5vZGVzWzBdLmdldENvbXBvbmVudChjYy5TcHJpdGUpKTtcclxuXHJcbiAgICAgICAgLy/kuK3pgZNcclxuICAgICAgICBsZXQgdHlwZU5hbWUxID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkc1sxXSkrMTtcclxuXHJcbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPj0xMCA/IHR5cGVOYW1lMSA6XCIwXCIrdHlwZU5hbWUxO1xyXG5cclxuICAgICAgICB0eXBlTmFtZTEgPSB0eXBlTmFtZTE9PScwNycgPyAnMjInIDp0eXBlTmFtZTE7XHJcblxyXG4gICAgICAgIHBhdGggPSAnZ2FtZV9wb2tlcl90eXBlJysgdHlwZU5hbWUxO1xyXG5cclxuICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuZGFvU3ByaXRlQXRsYXMsIHBhdGggLG5vZGVzWzFdLmdldENvbXBvbmVudChjYy5TcHJpdGUpKTtcclxuXHJcbiAgICAgICAgLy/lsL7pgZNcclxuICAgICAgICBsZXQgdHlwZU5hbWUyID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkc1syXSkrMTtcclxuXHJcbiAgICAgICAgdHlwZU5hbWUyID0gdHlwZU5hbWUyPj0xMCA/IHR5cGVOYW1lMiA6XCIwXCIrdHlwZU5hbWUyO1xyXG5cclxuICAgICAgICBwYXRoID0gJ2dhbWVfcG9rZXJfdHlwZScrIHR5cGVOYW1lMjtcclxuXHJcbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZSh0aGlzLmRhb1Nwcml0ZUF0bGFzLCBwYXRoICxub2Rlc1syXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihuKXtuLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gXCJcIjt9KTtcclxuXHJcbiAgICAgICAgaWYoY2FyZHMpe1xyXG5cclxuICAgICAgICAgICAgaWYodHlwZU5hbWUwKSBLUUNhcmQuX3NldEd1aUNhcmQoMCwgMCwgMywgdHlwZU5hbWUwLCBjYXJkcywgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbiwgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xyXG5cclxuICAgICAgICAgICAgaWYodHlwZU5hbWUxKSBLUUNhcmQuX3NldEd1aUNhcmQoMSwgMywgOCwgdHlwZU5hbWUxLCBjYXJkcywgdGhpcy5jYXJkQWxsTm9kZS5jaGlsZHJlbiwgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xyXG5cclxuICAgICAgICAgICAgaWYodHlwZU5hbWUyKSBLUUNhcmQuX3NldEd1aUNhcmQoMiwgOCwgMTMsIHR5cGVOYW1lMiwgY2FyZHMsIHRoaXMuY2FyZEFsbE5vZGUuY2hpbGRyZW4sIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfY2xpY2tUb3VEYW9MYXlvdXQ6IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIHRoaXMuX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQodGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgZXZlbnQpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfY2xpY2taaG9uZ0Rhb0xheW91dDogZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5fZGFvQ2FyZE5vZGVJbkxheW91dFdpdGhFdmVudCh0aGlzLmxheW91dFpob25nRGFvLm5vZGUsIGV2ZW50KTtcclxuICAgIH0sXHJcblxyXG4gICAgX2NsaWNrV2VpRGFvTGF5b3V0OiBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICB0aGlzLl9kYW9DYXJkTm9kZUluTGF5b3V0V2l0aEV2ZW50KHRoaXMubGF5b3V0V2VpRGFvLm5vZGUsIGV2ZW50KTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQ6IGZ1bmN0aW9uIChub2RlLCBldmVudCkge1xyXG4gICAgICAgIGxldCBjYXJkTm9kZXMgPSBub2RlLmNoaWxkcmVuIHx8IFtdO1xyXG4gICAgICAgIHZhciBsb2NhdGlvbiA9IGV2ZW50LmdldExvY2F0aW9uKCk7XHJcbiAgICAgICAgbG9jYXRpb24gPSBub2RlLmNvbnZlcnRUb05vZGVTcGFjZUFSKGxvY2F0aW9uKTtcclxuICAgICAgICAvL3ZhciBjYXJkQmFja1dvcmxkU3BhY2UgPSB0aGlzLmxheW91dFpob25nRGFvLm5vZGUuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLnYyKDAsIDApKTtcclxuICAgICAgICAvLy8v6I635Y+W6IqC54K555qE5LiW55WM5Z2Q5qCHXHJcbiAgICAgICAgLy92YXIgZGV0YWlsID0gdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLnBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihjYXJkQmFja1dvcmxkU3BhY2UpO1xyXG4gICAgICAgIC8vLy/ojrflj5bnm7jlr7nniLboioLngrnmiYDlnKjnmoTlnZDmoIdcclxuICAgICAgICAvL3RoaXMubGF5b3V0V2VpRGFvLm5vZGUucnVuQWN0aW9uKGNjLm1vdmVUbygxLGRldGFpbCkpO1xyXG4gICAgICAgIGZvciAobGV0IGluZGV4IGluIGNhcmROb2Rlcykge1xyXG4gICAgICAgICAgICBsZXQgY2FyZE5vZGUgPSBjYXJkTm9kZXNbaW5kZXhdO1xyXG4gICAgICAgICAgICBsZXQgcmVjdCA9IGNhcmROb2RlLmdldEJvdW5kaW5nQm94KCk7XHJcbiAgICAgICAgICAgIGlmIChjYy5yZWN0Q29udGFpbnNQb2ludChyZWN0LCBsb2NhdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5UG9rZXJDbGljaygpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGFycnMgPSBbbm9kZSAsY2FyZE5vZGVdO1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5MYXlvdXRXaXRoRXZlbnQubGVuZ3RoID09IDEpe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuTGF5b3V0V2l0aEV2ZW50WzBdWzBdLm5hbWUgIT0gbm9kZS5uYW1lKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZE5vZGUub3BhY2l0eSA9IDIwMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQucHVzaChhcnJzKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnRbMF1bMV0ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5MYXlvdXRXaXRoRXZlbnQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMuTGF5b3V0V2l0aEV2ZW50Lmxlbmd0aCA9PSAwKXtcclxuICAgICAgICAgICAgICAgICAgICAvL2NjLmxvZyhjYXJkTm9kZSlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkxheW91dFdpdGhFdmVudC5wdXNoKGFycnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhcmROb2RlLm9wYWNpdHkgPSAyMDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLkxheW91dFdpdGhFdmVudC5sZW5ndGggPT0gMil7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUxID0gdGhpcy5MYXlvdXRXaXRoRXZlbnRbMF1bMV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUyID0gdGhpcy5MYXlvdXRXaXRoRXZlbnRbMV1bMV07XHJcbiAgICAgICAgICAgICAgICAgICAgLy/ojrflj5boioLngrnnmoTkuJbnlYzlnZDmoIdcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZEJhY2tXb3JsZFNwYWNlID0gbm9kZTEuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLnYyKDAsIDApKTtcclxuICAgICAgICAgICAgICAgICAgICAvL+iOt+WPluebuOWvueeItuiKgueCueaJgOWcqOeahOWdkOagh1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXRhaWwgPSBub2RlMS5wYXJlbnQuY29udmVydFRvTm9kZVNwYWNlQVIoY2FyZEJhY2tXb3JsZFNwYWNlKTtcclxuICAgICAgICAgICAgICAgICAgICBub2RlMi5ydW5BY3Rpb24oY2MubW92ZVRvKDEsZGV0YWlsKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vcmV0dXJuIG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9hZGREYW9DYXJkVG9MYXlvdXQ6IGZ1bmN0aW9uIChub2RlLCBtYXhOdW1iZXJDYXJkID0gNSkge1xyXG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IG5vZGUuY2hpbGRyZW4gfHwgW107XHJcbiAgICAgICAgLy9pZiAoY2FyZE5vZGVzLmxlbmd0aCA+PSA1KSB7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vbGV0IHJlbWFpbkNvdW50ID0gbWF4TnVtYmVyQ2FyZCAtIGNhcmROb2Rlcy5sZW5ndGg7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL3ZhciBzZWxlY3RlZENhcmRzID0gdGhpcy5fc2VsZWN0ZWRDYXJkUHJlZmFicyh0cnVlKSB8fCBbXTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vaWYgKHNlbGVjdGVkQ2FyZHMubGVuZ3RoID09IDApIHtcclxuICAgICAgICAvLyAgICByZXR1cm47XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy9pZiAoc2VsZWN0ZWRDYXJkcy5sZW5ndGggPiByZW1haW5Db3VudCkge1xyXG4gICAgICAgIC8vICAgIHNlbGVjdGVkQ2FyZHMgPSBzZWxlY3RlZENhcmRzLnNsaWNlKDAsIHJlbWFpbkNvdW50KTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vbGV0IHNlbGVjdGVkQ2FyZE5hbWVzID0gc2VsZWN0ZWRDYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmRQcmVmYWIpIHtcclxuICAgICAgICAvLyAgICByZXR1cm4gY2FyZFByZWZhYi5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKS5jYXJkTmFtZSgpO1xyXG4gICAgICAgIC8vfSk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkVHlwZU5vZGUpIHtcclxuICAgICAgICAvLyAgICBzZWxlY3RlZENhcmROYW1lcy5wdXNoKGNhcmRUeXBlTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlU3ByaXRlJykuY2FyZE5hbWUoKSk7XHJcbiAgICAgICAgLy99KTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vbGV0IGNhcmRNb2RlcyA9IHNlbGVjdGVkQ2FyZE5hbWVzLm1hcChmdW5jdGlvbiAoY2FyZE5hbWUsaW5kZXgpIHtcclxuICAgICAgICAvLyAgICByZXR1cm4gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcclxuICAgICAgICAvL30pLnNvcnQoZnVuY3Rpb24gKGMxLCBjMikge1xyXG4gICAgICAgIC8vICAgIHJldHVybiBLUUNhcmQuc29ydChjMSwgYzIsIGZhbHNlKTtcclxuICAgICAgICAvL30pO1xyXG5cclxuICAgICAgICAvL2xldCB0b3VDYXJkTW9kZXMgPSAobm9kZSA9PSB0aGlzLmxheW91dFRvdURhby5ub2RlKSA/IGNhcmRNb2RlcyA6IHRoaXMuX3Rhb0Rhb0NhcmRNb2RlcygpO1xyXG4gICAgICAgIC8vbGV0IHpob25nQ2FyZE1vZGVzID0gKG5vZGUgPT0gdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKSA/IGNhcmRNb2RlcyA6IHRoaXMuX3pob25nRGFvQ2FyZE1vZGVzKCk7XHJcbiAgICAgICAgLy9sZXQgd2VpQ2FyZE1vZGVzID0gKG5vZGUgPT0gdGhpcy5sYXlvdXRXZWlEYW8ubm9kZSkgPyBjYXJkTW9kZXMgOiB0aGlzLl93ZWlEYW9DYXJkTW9kZXMoKTtcclxuICAgICAgICAvL2lmICghdGhpcy5faXNWYWxpZENhcmRNb2Rlcyh0b3VDYXJkTW9kZXMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXMpKSB7XHJcbiAgICAgICAgLy8gICAgdGhpcy5jYWNsZUF1dG9TZWxlY3RlZENhcmRzMSgpO1xyXG4gICAgICAgIC8vICAgIGNjLmxvZygn55u45YWs54mM77ya6Ieq5Yqo6YCJ5oup54mMJylcclxuICAgICAgICAvLyAgICByZXR1cm47XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL25vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vY2FyZE1vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmRNb2RlLGluZGV4KSB7XHJcbiAgICAgICAgLy8gICAgbGV0IGNhcmROYW1lID0gY2FyZE1vZGUuY2FyZE5hbWUoKTtcclxuICAgICAgICAvLyAgICBsZXQgY2FyZFR5cGVTcHJpdGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmNhcmRUeXBlUHJlZmFiKTtcclxuICAgICAgICAvLyAgICBjYXJkVHlwZVNwcml0ZS5uYW1lcyA9IGNhcmROYW1lKycrJytpbmRleDtcclxuICAgICAgICAvLyAgICBjYXJkVHlwZVNwcml0ZS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlU3ByaXRlJykuc2V0Q2FyZChjYXJkTmFtZSxpbmRleCk7XHJcbiAgICAgICAgLy8gICAgbm9kZS5hZGRDaGlsZChjYXJkVHlwZVNwcml0ZSk7XHJcbiAgICAgICAgLy99LmJpbmQodGhpcykpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL3NlbGVjdGVkQ2FyZHMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgIC8vICAgIG5vZGUucmVtb3ZlRnJvbVBhcmVudCgpO1xyXG4gICAgICAgIC8vfSk7XHJcbiAgICAgICAgLy90aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XHJcbiAgICAgICAgLy90aGlzLl9yZXNldENhcmRzUG9zaXRpb25YKCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL3RoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b25zKCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL3RoaXMuX3JlbG9hZEtRQ2FyZE1vZGVzSW5uZXIoKTtcclxuICAgICAgICAvL3RoaXMuX3Jlc2V0VHlwZUJ1dHRvbkVuYWJsZXNXaXRoTW9kZWxzKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOWIoOmZpCDlpLTjgIHkuK3miJblsL7pgZPkuK3nmoTmn5DkuK3niYxcclxuICAgIF9kZWxldGVEYW9DYXJkOiBmdW5jdGlvbiAoY2FyZFR5cGVOb2RlLCByZWxvYWRUeXBlQnV0dG9uRW5hYmxlcyA9IGZhbHNlKSB7XHJcbiAgICAgICAgLy9sZXQgY2FyZE5hbWUgPSBjYXJkVHlwZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLmNhcmROYW1lKCk7XHJcbiAgICAgICAgLy90aGlzLmFkZENhcmQoY2FyZE5hbWUsIHRydWUpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy90aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL2NhcmRUeXBlTm9kZS5yZW1vdmVGcm9tUGFyZW50KHRydWUpO1xyXG4gICAgICAgIC8vdGhpcy5fYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbnMoKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vaWYgKHJlbG9hZFR5cGVCdXR0b25FbmFibGVzKSB7XHJcbiAgICAgICAgLy8gICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xyXG4gICAgICAgIC8vICAgIHRoaXMuX3Jlc2V0VHlwZUJ1dHRvbkVuYWJsZXNXaXRoTW9kZWxzKCk7XHJcbiAgICAgICAgLy99XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOWIoOmZpCDlpLTpgZPmiJbkuK3pgZPmiJblsL7pgZPkuIrmiYDmnInnmoQg54mMXHJcbiAgICBfZGVsZXRlRGFvQ2FyZHNPZkxheW91dDogZnVuY3Rpb24gKGRhb0xheW91dCkge1xyXG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IEFycmF5LmZyb20oZGFvTGF5b3V0LmNoaWxkcmVuKTtcclxuICAgICAgICAvL2NhcmROb2Rlcy5mb3JFYWNoKHRoaXMuX2RlbGV0ZURhb0NhcmQuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL3RoaXMuX3JlbG9hZEtRQ2FyZE1vZGVzSW5uZXIoKTtcclxuICAgICAgICAvL3RoaXMuX3Jlc2V0VHlwZUJ1dHRvbkVuYWJsZXNXaXRoTW9kZWxzKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOWIpOaWreiDveWQpuS9v+eUqOmAieaLqeS4reeahOeJjFxyXG4gICAgLy8g5Y2z77ya5aS06YGT6KaB5bCP5LqO5Lit6YGT44CB5Lit6YGT6KaB5bCP5LqO5bC+6YGTXHJcbiAgICBfaXNWYWxpZENhcmRNb2RlczogZnVuY3Rpb24gKHRvdUNhcmRNb2RlcywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2Rlcykge1xyXG4gICAgICAgIHRvdUNhcmRNb2RlcyA9IHRvdUNhcmRNb2RlcyB8fCBbXTtcclxuICAgICAgICB6aG9uZ0NhcmRNb2RlcyA9IHpob25nQ2FyZE1vZGVzIHx8IFtdO1xyXG4gICAgICAgIHdlaUNhcmRNb2RlcyA9IHdlaUNhcmRNb2RlcyB8fCBbXTtcclxuICAgICAgICBpZiAodG91Q2FyZE1vZGVzLmxlbmd0aCA8IDMgfHwgemhvbmdDYXJkTW9kZXMubGVuZ3RoIDwgNSB8fCB3ZWlDYXJkTW9kZXMubGVuZ3RoIDwgNSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHModG91Q2FyZE1vZGVzKTtcclxuICAgICAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMoemhvbmdDYXJkTW9kZXMpO1xyXG4gICAgICAgIGxldCB3ZWlTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMod2VpQ2FyZE1vZGVzKTtcclxuICAgICAgICByZXR1cm4gKHRvdVNjb3JlIDwgemhvbmdTY29yZSkgJiYgKHpob25nU2NvcmUgPD0gd2VpU2NvcmUpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDlpLTpgZPkuIrlt7LmnInnmoTniYxcclxuICAgIF90YW9EYW9DYXJkTW9kZXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZE1vZGVzT2ZDYXJkUHJlZmFicyh0aGlzLmNhcmRBbGxzLnNsaWNlKDAsMykpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDkuK3pgZPkuIrlt7LmnInnmoTniYxcclxuICAgIF96aG9uZ0Rhb0NhcmRNb2RlczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vcmV0dXJuIHRoaXMuX2NhcmRNb2Rlc09mQ2FyZFByZWZhYnModGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLmNoaWxkcmVuKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZE1vZGVzT2ZDYXJkUHJlZmFicyh0aGlzLmNhcmRBbGxzLnNsaWNlKDMsOCkpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDlsL7pgZPkuIrlt7LmnInnmoTniYxcclxuICAgIF93ZWlEYW9DYXJkTW9kZXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL3JldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMubGF5b3V0V2VpRGFvLm5vZGUuY2hpbGRyZW4pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMuY2FyZEFsbHMuc2xpY2UoOCwxMykpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfY2FyZE1vZGVzT2ZDYXJkUHJlZmFiczogZnVuY3Rpb24gKGNhcmRUeXBlTm9kZXMpIHtcclxuICAgICAgICBpZiAoIWNhcmRUeXBlTm9kZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGNhcmRNb2RlcyA9IGNhcmRUeXBlTm9kZXMubWFwKGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgICAgICAgIC8vbGV0IGNvbXBvbmVudCA9IG5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpO1xyXG4gICAgICAgICAgICAvL3JldHVybiBjb21wb25lbnQuY2FyZE1vZGUoKTsuX2NhcmRNb2RlbFxyXG4gICAgICAgICAgICByZXR1cm4gbm9kZS5fY2FyZE1vZGVsO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gY2FyZE1vZGVzIHx8IFtdO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDoh6rliqjorr7nva4g5aS044CB5Lit44CB5bC+6YGT55qE5Yig6Zmk5oyJ6ZKu55qE5Y+v6KeB5oCnXHJcbiAgICBfYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbnM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL3RoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b24odGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgdGhpcy5idG5EZWxldGVUb3VEYW8ubm9kZSk7XHJcbiAgICAgICAgLy90aGlzLl9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9uKHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZSwgdGhpcy5idG5EZWxldGVaaG9uZ0Rhby5ub2RlKTtcclxuICAgICAgICAvL3RoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b24odGhpcy5sYXlvdXRXZWlEYW8ubm9kZSwgdGhpcy5idG5EZWxldGVXZWlEYW8ubm9kZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9uOiBmdW5jdGlvbiAobGF5b3V0LCBidXR0b24pIHtcclxuICAgICAgICAvL2J1dHRvbi5hY3RpdmUgPSBsYXlvdXQuY2hpbGRyZW4ubGVuZ3RoID4gMDtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g6Ieq5Yqo6K6+572uIOKAnOWFqOmDqOWPlua2iOKAneOAgeKAnOehruWumuWHuueJjOKAneOAgeKAnOexu+Wei+mAieaLqeKAneaMiemSrueahOWPr+ingeaAp1xyXG4gICAgX2F1dG9BY3RpdmVUeXBlQnV0dG9uczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcclxuICAgICAgICAvL2xldCBoYXNDYXJkVW5TZWxlY3RlZCA9IGNhcmROb2Rlcy5sZW5ndGggPiAwO1xyXG4gICAgICAgIC8vdGhpcy5idG5Eb25lLm5vZGUuYWN0aXZlID0gIWhhc0NhcmRVblNlbGVjdGVkO1xyXG4gICAgICAgIC8vdGhpcy5idG5DYW5jZWxBbGwubm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkRvbmUubm9kZS5hY3RpdmU7XHJcbiAgICAgICAgLy90aGlzLnR5cGVCdXR0b25zTm9kZS5hY3RpdmUgPSBoYXNDYXJkVW5TZWxlY3RlZDtcclxuICAgIH0sXHJcblxyXG59KTtcclxuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgIF9jYXJkTmFtZTogbnVsbCxcclxuICAgICAgX2NhcmRNb2RlbDogbnVsbCxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNldENhcmQ6IGZ1bmN0aW9uIChjYXJkTmFtZSwgaW5kZXgsIGFzZGYgPSB0cnVlKSB7XHJcbiAgICAgIHRoaXMuX2NhcmROYW1lID0gY2FyZE5hbWU7XHJcbiAgICAgIGlmKGFzZGYpe1xyXG4gICAgICAgICAgdGhpcy5fY2FyZE1vZGVsID0gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKGNhcmROYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcclxuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xyXG4gICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjYXJkTmFtZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FyZE5hbWU7XHJcbiAgICB9LFxyXG5cclxuICAgIGNhcmRNb2RlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jYXJkTW9kZWw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lKSB7XHJcbiAgICAgIHZhciBjYXJkTmFtZSA9IGNhcmRTaG9ydE5hbWU7XHJcbiAgICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChcInB1YmxpYy1waWMtY2FyZC1wb2tlclwiKSkge1xyXG4gICAgICAgIGNhcmROYW1lID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIGNhcmROYW1lO1xyXG4gICAgfSxcclxuXHJcbiAgICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICBjYy5hc3NlcnQoY2FsbGJhY2spO1xyXG5cclxuICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCJwbGF5L0NhcmRUeXBlQ29tYmluZS9wb2NrTGlzdFwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcclxuICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICBjYy5lcnJvcihlcnIpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUpO1xyXG4gICAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcclxuICAgICAgICBjYWxsYmFjayhmcmFtZSk7XHJcbiAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG59KTtcclxuIiwiLy8g55So5LqO5Zyo5ri45oiP6L+H56iL5Lit77yM5bGV56S655So5oi355qE6IGK5aSp5raI5oGvXHJcblxyXG5sZXQgQ2hhdE1lc3NhZ2UgPSBjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHJpY2hUZXh0OiBjYy5SaWNoVGV4dCxcclxuICAgICAgICBzcHJpdGVCYWNrZ3JvdW5kOiBjYy5TcHJpdGUsXHJcbiAgICAgICAgZW1vamk6Y2MuTm9kZSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBDaGF0TWVzc2FnZS5pbnN0YW5jZXMgPSB0aGlzO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRTdHJpbmc6IGZ1bmN0aW9uIChzdHJpbmcgPSBcIlwiLCBhdXRvSGlkZSA9IHRydWUpIHtcclxuICAgICAgICBpZiAoc3RyaW5nLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucmljaFRleHQubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc3ByaXRlQmFja2dyb3VuZC5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5lbW9qaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBsZXQgbWF4V2lkdGggPSAzMDA7XHJcbiAgICAgICAgbGV0IHJlYWxTdHIgPSBDaGF0TWVzc2FnZS5wYXJzZVN0cmluZyhzdHJpbmcpO1xyXG5cclxuICAgICAgICAvLyDnlLHkuo4gY2MuUmljaFRleHQg5Zyo5oyH5a6aIG1heFdpZHRoIOWQju+8jOivpee7k+eCueeahCB3aWR0aCDkvJrkuIDnm7RcclxuICAgICAgICAvLyDmmK8gbWF4V2lkdGgg5YC844CC6ICM5Zyo5bCGIG1heFdpZHRoIOaMh+WumuS4ujDml7bvvIzlhbYgY29udGVudFNpemUud2lkdGgg5LyaXHJcbiAgICAgICAgLy8g5piv5YaF5a6555qE55yf5q2j5omA6ZyA55qE5a695bqmXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyDmiYDku6Xov5nph4zlhYjlsIYgbWF4V2lkdGgg6K6+5Li6IDDvvIzojrflj5blhbblrp7pmYXlhoXlrrkgd2lkdGgg5ZCO5YaN6LCD5pW0XHJcbiAgICAgICAgdGhpcy5yaWNoVGV4dC5tYXhXaWR0aCA9IDA7XHJcbiAgICAgICAgdGhpcy5yaWNoVGV4dC5zdHJpbmcgPSByZWFsU3RyO1xyXG5cclxuICAgICAgICBsZXQgY29udGVudFdpZHRoID0gdGhpcy5yaWNoVGV4dC5ub2RlLmdldENvbnRlbnRTaXplKCkud2lkdGg7XHJcbiAgICAgICAgaWYgKGNvbnRlbnRXaWR0aCA+IG1heFdpZHRoKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmljaFRleHQubWF4V2lkdGggPSBtYXhXaWR0aDtcclxuICAgICAgICAgICAgdGhpcy5yaWNoVGV4dC5zdHJpbmcgPSByZWFsU3RyO1xyXG4gICAgICAgICAgICBjb250ZW50V2lkdGggPSBtYXhXaWR0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubm9kZS53aWR0aCA9IGNvbnRlbnRXaWR0aCArIDI4O1xyXG4gICAgICAgIHRoaXMubm9kZS5oZWlnaHQgPSB0aGlzLnJpY2hUZXh0Lm5vZGUuZ2V0Q29udGVudFNpemUoKS5oZWlnaHQgKyAyMDtcclxuXHJcbiAgICAgICAgdGhpcy5zcHJpdGVCYWNrZ3JvdW5kLm5vZGUud2lkdGggPSB0aGlzLm5vZGUud2lkdGg7XHJcbiAgICAgICAgdGhpcy5zcHJpdGVCYWNrZ3JvdW5kLm5vZGUuaGVpZ2h0ID0gdGhpcy5ub2RlLmhlaWdodDtcclxuXHJcbiAgICAgICAgaWYgKGF1dG9IaWRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVOb2RlKClcclxuICAgICAgICAgICAgLy90aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICAgICAgLy90aGlzLnNjaGVkdWxlT25jZSh0aGlzLl9oaWRlTm9kZS5iaW5kKHRoaXMpLCAzKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dFbW9qaTogZnVuY3Rpb24gKHNwcml0ZSkge1xyXG4gICAgICAgIHRoaXMuX2hpZGVOb2RlKCk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5lbW9qaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucmljaFRleHQubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNwcml0ZUJhY2tncm91bmQubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB2YXIgYnRuU3ByaXRlcyA9ICB0aGlzLmVtb2ppLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgIGJ0blNwcml0ZXMuc3ByaXRlRnJhbWUgPSBzcHJpdGU7XHJcbiAgICB9LFxyXG5cclxuICAgIF9oaWRlTm9kZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9LmJpbmQodGhpcyksIDMpO1xyXG4gICAgfSxcclxuXHJcbn0pO1xyXG5DaGF0TWVzc2FnZS5zZXRFbW9qaSA9IGZ1bmN0aW9uKHNwcml0ZSl7XHJcbiAgICB0aGlzLmluc3RhbmNlcy5faGlkZU5vZGUoKTtcclxuICAgIHRoaXMuaW5zdGFuY2VzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgIHRoaXMuaW5zdGFuY2VzLmVtb2ppLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB0aGlzLmluc3RhbmNlcy5yaWNoVGV4dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgdGhpcy5pbnN0YW5jZXMuc3ByaXRlQmFja2dyb3VuZC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgdmFyIGJ0blNwcml0ZXMgPSAgdGhpcy5pbnN0YW5jZXMuZW1vamkuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICBidG5TcHJpdGVzLnNwcml0ZUZyYW1lID0gc3ByaXRlO1xyXG4gICAgLy9jb25zb2xlLmxvZyh0aGlzLmVtb2ppKTtcclxuICAgIC8vcmV0dXJuO1xyXG4gICAgLy9cclxuICAgIC8vdGhpcy5lbW9qaS5TcHJpdGUgPSBzcHJpdGU7XHJcbn0sXHJcblxyXG4vLyDlsIYgPGJxMTA+IOaUueS4uu+8miA8aW1nIHNyYz0nYmcxMCcvPlxyXG5DaGF0TWVzc2FnZS5wYXJzZVN0cmluZyA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIGxldCByZXN1bHQgPSBzdHIucmVwbGFjZSgvPGJxXFxkezEsMn0+L2csIGZ1bmN0aW9uKG1hdGNoKXtcclxuICAgICAgICB2YXIgYnEgPSBtYXRjaC5yZXBsYWNlKFwiPFwiLCBcIiA8aW1nIHNyYz0nXCIpLnJlcGxhY2UoXCI+XCIsIFwiJy8+IFwiKTtcclxuICAgICAgICByZXR1cm4gYnE7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn0sXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IENoYXRNZXNzYWdlO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc2V0U3RyaW5nOiBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICAgIHRoaXMuX3JpY2hUZXh0KCkuc3RyaW5nID0gc3RyO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcmljaFRleHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2NjLlJpY2hUZXh0Jyk7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBzZXRFbW9qaTpmdW5jdGlvbihzcHJhaXRlKXtcclxuICAgICAgICB0aGlzLl9zcHJpdGVGcmFtZSgpLlNwcmFpdGUgPSBzcHJhaXRlO1xyXG4gICAgfSxcclxuICAgIF9zcHJpdGVGcmFtZTpmdW5jdGlvbigpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcclxuICAgIH0sXHJcbn0pO1xyXG4iLCJjb25zdCBLUUNhcmRSZXNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRSZXNIZWxwZXInKTtcclxuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XHJcbmNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xyXG5cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICB0b3VMYXlvdXQ6IGNjLkxheW91dCxcclxuICAgICAgICB6aG9uZ0xheW91dDogY2MuTGF5b3V0LFxyXG4gICAgICAgIHdlaUxheW91dDogY2MuTGF5b3V0LFxyXG5cclxuICAgICAgICB0b3VMYXlvdXRCYWNrOiBjYy5MYXlvdXQsXHJcbiAgICAgICAgemhvbmdMYXlvdXRCYWNrOiBjYy5MYXlvdXQsXHJcbiAgICAgICAgd2VpTGF5b3V0QmFjazogY2MuTGF5b3V0LFxyXG4gICAgICAgIGJhb0RhbzogY2MuTm9kZSwgIC8v5oql6YGT5Zu+LFxyXG4gICAgICAgIHBsYXlUb3RhbFNjb3JlOiBjYy5MYXlvdXQsICAvL+aJgOacieeOqeWutueahOaAu+WIhuaVsFxyXG5cclxuICAgICAgICBkYW9TY29yZUxheW91dHM6IFtjYy5MYXlvdXRdLFxyXG4gICAgICAgIGRhb1RpdGxlTm9kZXM6IFtjYy5Ob2RlXSxcclxuICAgICAgICBUU2NvcmVMYXlvdXQ6IGNjLkxheW91dCxcclxuICAgICAgICBUdGl0bGVOb2RlOiBjYy5Ob2RlLFxyXG5cclxuICAgICAgICBwTnVtOjAsICAgICAgICAgLy/njqnlrrbkurrmlbBcclxuICAgICAgICB0ZVNodVRpbWU6MCwgICAgLy/nibnmrorniYzlh7rniYzpobrluo9cclxuICAgICAgICB0ZVNodU51bTowLCAgICAgLy/nibnmrorniYzkurrmlbBcclxuXHJcbiAgICAgICAgX2xDU2NvcmU6bnVsbCxcclxuICAgICAgICBfZGFvTGF5b3V0czogbnVsbCwgLy8g5aS044CB5Lit44CB5bC+6ZuG5ZCIXHJcbiAgICAgICAgX2Rhb0xheW91dEJhY2tzOiBudWxsLCAvLyDlpLTjgIHkuK3jgIHlsL7pm4blkIhcclxuICAgICAgICBfc2NvcmVzOiBudWxsLFxyXG4gICAgICAgIF91c2VyOiBudWxsLCAgICAgICAvLyDnlKjkuo7mr5TniYznmoTmlbDmja5cclxuICAgICAgICBfY2FyZHNJbmZvOiBudWxsLFxyXG4gICAgICAgIF9jb21wYXJlSW5kZXg6IDAsICAvLyDlsIbopoHmr5TovoPnmoQg57Si5byVICAwfjJcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0cyA9IFt0aGlzLnRvdUxheW91dCwgdGhpcy56aG9uZ0xheW91dCwgdGhpcy53ZWlMYXlvdXRdO1xyXG4gICAgICAgIHRoaXMuX2Rhb0xheW91dEJhY2tzID0gW3RoaXMudG91TGF5b3V0QmFjaywgdGhpcy56aG9uZ0xheW91dEJhY2ssIHRoaXMud2VpTGF5b3V0QmFja107XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5fc2NvcmVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U2NvcmVzKHRoaXMuX3Njb3Jlcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggPSAwO1xyXG5cclxuICAgICAgICB0aGlzLm5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge25vZGUuYWN0aXZlID0gZmFsc2U7fSk7XHJcblxyXG4gICAgICAgIHRoaXMuYmFvRGFvLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIG5vZGVzID0gdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUuY2hpbGRyZW4uY29uY2F0KHRoaXMuemhvbmdMYXlvdXRCYWNrLm5vZGUuY2hpbGRyZW4pLmNvbmNhdCh0aGlzLndlaUxheW91dEJhY2subm9kZS5jaGlsZHJlbik7XHJcblxyXG4gICAgICAgIHRoaXMuY2FyZFNwcml0ZUF0bGFzID0gdGhpcy5ub2RlLnBhcmVudC5wYXJlbnQuZ2V0Q29tcG9uZW50KCdwbGF5JykuY2FyZFNwcml0ZUF0bGFzO1xyXG5cclxuICAgICAgICBub2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChub2QpIHtcclxuXHJcbiAgICAgICAgICAgIG5vZC5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNhcmRTcHJpdGUgPSBub2QuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcblxyXG4gICAgICAgICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIFwicHVibGljLXBpYy1jYXJkLXBva2VyLWJhY2tcIiAsY2FyZFNwcml0ZSk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIHRoaXMuZGFvU2NvcmVMYXlvdXRzLmZvckVhY2goZnVuY3Rpb24gKG5vZCkge25vZC5ub2RlLmFjdGl2ZSA9IGZhbHNlO30uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIHRoaXMuZGFvVGl0bGVOb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChub2QpIHtub2QuYWN0aXZlID0gZmFsc2U7fS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgaWYodGhpcy5UU2NvcmVMYXlvdXQpIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKHRoaXMuVHRpdGxlTm9kZSkgdGhpcy5UdGl0bGVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuXHJcbiAgICAgICAgLy9jb25zb2xlLmxvZygn5omn6KGM5LqG5LiA6YGN5riF6Zmk5a6a5pe25ZmoLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKVxyXG5cclxuICAgICAgICBpZih0aGlzLlRTY29yZUxheW91dCkgdGhpcy5UU2NvcmVMYXlvdXQubm9kZS5zdG9wQWxsQWN0aW9ucygpO1xyXG5cclxuICAgICAgICBpZih0aGlzLnBsYXlUb3RhbFNjb3JlKSB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2V0Q29tcGFyZURhdGE6IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlciA9IHVzZXI7XHJcbiAgICAgICAgdGhpcy5fY2FyZHNJbmZvID0gdXNlci5jYXJkSW5mbztcclxuICAgICAgICBsZXQgY2FyZHNJbmZvID0gdXNlci5jYXJkSW5mbztcclxuICAgICAgICB0aGlzLl9sQ1Njb3JlID0gdXNlci5sQ1Njb3JlO1xyXG4gICAgICAgIGxldCBjYXJkcyA9IGNhcmRzSW5mby5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRJbmZvSXRlbS5jYXJkcyk7XHJcbiAgICAgICAgfSkucmVkdWNlKGZ1bmN0aW9uIChhcnJheSwgc3ViQ2FyZHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7XHJcbiAgICAgICAgfSwgW10pO1xyXG5cclxuXHJcbiAgICAgICAgbGV0IHNjb3JlcyA9IFt1c2VyLnNjb3JlMSB8fCAwLCB1c2VyLnNjb3JlMiB8fCAwLCB1c2VyLnNjb3JlMyB8fCAwLHVzZXIubFNjb3JlMSB8fCAwLCB1c2VyLmxTY29yZTIgfHwgMCwgdXNlci5sU2NvcmUzIHx8IDBdO1xyXG4gICAgICAgIHRoaXMuc2V0Q2FyZHMoY2FyZHMpO1xyXG4gICAgICAgIHRoaXMuc2V0U2NvcmVzKHNjb3Jlcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8v5pi+56S65omA5pyJ546p5a6255qE5oC75YiG5pWwXHJcbiAgICBzaG93U2NvcmVSZXN1bHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmKCF0aGlzLl91c2VyKSByZXR1cm47XHJcbiAgICAgICAgdmFyIHNjb3JlcyA9IHRoaXMuX3VzZXIuY1Njb3JlO1xyXG4gICAgICAgIHRoaXMuc2V0U2NvcmVzKFtzY29yZXNdLFt0aGlzLnBsYXlUb3RhbFNjb3JlXSx0cnVlKTtcclxuICAgICAgICB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICB2YXIgeCA9IHRoaXMucGxheVRvdGFsU2NvcmUubm9kZS54O1xyXG4gICAgICAgIHZhciB5ID0gdGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLnk7XHJcbiAgICAgICAgdGhpcy5wbGF5VG90YWxTY29yZS5ub2RlLnJ1bkFjdGlvbihjYy5tb3ZlVG8oMC44LCBjYy5wKHgsIHkrMzApKSk7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGxheVRvdGFsU2NvcmUubm9kZS5ydW5BY3Rpb24oY2MuZmFkZU91dCgwLjIpKTtcclxuICAgICAgICB9LmJpbmQodGhpcyksMC42KTtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHt0aGlzLnBsYXlUb3RhbFNjb3JlLm5vZGUueSA9IHk7fS5iaW5kKHRoaXMpLDEpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+aYvuekuuS4iemBk+WIhuaVsFxyXG4gICAgc2hvd05leHRDb21wYXJlU2NvcmU6IGZ1bmN0aW9uKGlzQ29udGFpbkV4dHJhKSB7XHJcbiAgICAgICAgaWYoaXNDb250YWluRXh0cmEgJiYgdGhpcy5UU2NvcmVMYXlvdXQpe1xyXG4gICAgICAgICAgICB2YXIgc2NvcmVzMSA9IHRoaXMuX2xDU2NvcmUuc3BsaWNlKDAsMSk7XHJcbiAgICAgICAgICAgIGlmKHNjb3JlczEubGVuZ3RoIDw9IDApIHJldHVybjtcclxuICAgICAgICAgICAgdGhpcy5zZXRTY29yZXMoc2NvcmVzMSxbdGhpcy5UU2NvcmVMYXlvdXRdLHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzLlR0aXRsZU5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5UU2NvcmVMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgdmFyIHNjYWxlVG8xMSA9IGNjLnNjYWxlVG8gKDAuMywgMS44KVxyXG4gICAgICAgICAgICB2YXIgc2NhbGVUbzIxID0gY2Muc2NhbGVUbyAoMC4xLCAxLjEpXHJcbiAgICAgICAgICAgIHZhciBzY2FsZVRvMzEgPSBjYy5zY2FsZVRvICgwLjEsIDEuMylcclxuICAgICAgICAgICAgdmFyIHNjYWxlVG9TZXExID1jYy5zZXF1ZW5jZShzY2FsZVRvMTEsc2NhbGVUbzIxLHNjYWxlVG8zMSk7XHJcbiAgICAgICAgICAgIHRoaXMuVFNjb3JlTGF5b3V0Lm5vZGUucnVuQWN0aW9uKHNjYWxlVG9TZXExKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKHRoaXMuZGFvU2NvcmVMYXlvdXRzLmxlbmd0aCA8PSAwKSByZXR1cm47XHJcbiAgICAgICAgaWYoIXRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEpe1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9jb21wYXJlSW5kZXggPT0gMCA/IDE6IHRoaXMuX2NvbXBhcmVJbmRleDtcclxuICAgICAgICAgICAgdGhpcy5kYW9TY29yZUxheW91dHNbaW5kZXgtMV0ubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmRhb1Njb3JlTGF5b3V0c1tpbmRleCsyXS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuZGFvVGl0bGVOb2Rlc1tpbmRleC0xXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHNjb3JlcyA9IHRoaXMuX2xDU2NvcmUuc3BsaWNlKDAsMSk7XHJcbiAgICAgICAgaWYoc2NvcmVzLmxlbmd0aCA8PSAwICAmJiAhdGhpcy5UU2NvcmVMYXlvdXQpIHJldHVybjtcclxuICAgICAgICB0aGlzLnNldFNjb3JlcyhzY29yZXMsW3RoaXMuVFNjb3JlTGF5b3V0XSx0cnVlKTtcclxuICAgICAgICB0aGlzLlR0aXRsZU5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLlRTY29yZUxheW91dC5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHZhciBzY2FsZVRvMSA9IGNjLnNjYWxlVG8gKDAuMywgMS44KVxyXG4gICAgICAgIHZhciBzY2FsZVRvMiA9IGNjLnNjYWxlVG8gKDAuMSwgMS4xKVxyXG4gICAgICAgIHZhciBzY2FsZVRvMyA9IGNjLnNjYWxlVG8gKDAuMSwgMS4zKVxyXG4gICAgICAgIHZhciBzY2FsZVRvU2VxID1jYy5zZXF1ZW5jZShzY2FsZVRvMSxzY2FsZVRvMixzY2FsZVRvMyk7XHJcbiAgICAgICAgdGhpcy5UU2NvcmVMYXlvdXQubm9kZS5ydW5BY3Rpb24oc2NhbGVUb1NlcSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDkuIvkuIDkuKropoHmr5TovoPnmoTliIbmlbBcclxuICAgIC8vIOWmguaenOayoeacieimgeavlOi+g+eahOS6hu+8jOWImei/lOWbniAwXHJcbiAgICBuZXh0Q29tcGFyZVNjb3JlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX3VzZXIpIHJldHVybiAwO1xyXG5cclxuICAgICAgICB2YXIgZGF0YTtcclxuICAgICAgICBpZih0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhKXtcclxuICAgICAgICAgICAgZGF0YSA9IHRoaXMuX2NhcmRzSW5mb1swXTtcclxuICAgICAgICAgICAgaWYgKGRhdGEpIHJldHVybiBkYXRhLnR5cGUgKiA5MDAwMDAwMDAwMDAwMDAwO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBkYXRhID0gdGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZGF0YSkgcmV0dXJuIDA7XHJcbiAgICAgICAgcmV0dXJuIGRhdGEudmFsdWU7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldE1hUGFpOiBmdW5jdGlvbiAobm9kZXMgLGNhcmROYW1lKSB7XHJcbiAgICAgICAgaWYoY2MubWFQYWkgPT0gY2FyZE5hbWUpe1xyXG5cclxuICAgICAgICAgICAgdmFyIG5vZGRzID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcclxuXHJcbiAgICAgICAgICAgIG5vZGRzLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxyXG5cclxuICAgICAgICAgICAgY2MubG9hZGVyLmxvYWRSZXMoJ3BsYXkvZGVzay9pbWdfcmVkNV8xJywgY2MuU3ByaXRlRnJhbWUsIGZ1bmN0aW9uIChlcnIsIHNwcml0ZUZyYW1lKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGVycikge2NjLmVycm9yKGVyci5tZXNzYWdlIHx8IGVycik7cmV0dXJuO31cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgYnRuU3ByaXRlMSA9IG5vZGRzLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEuc2l6ZU1vZGUgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUud2lkdGggPSBub2Rlcy53aWR0aCArIDEwO1xyXG5cclxuICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEubm9kZS5oZWlnaHQgPSBub2Rlcy5oZWlnaHQgKyAxMDtcclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICBub2Rlcy5hZGRDaGlsZChub2Rkcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBzZXRDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XHJcblxyXG4gICAgICAgIGxldCBjYXJkU3ByaXRlcyA9IHRoaXMuX2FsbENhcmRTcHJpdGVzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuY2FyZFNwcml0ZUF0bGFzID0gdGhpcy5ub2RlLnBhcmVudC5wYXJlbnQuZ2V0Q29tcG9uZW50KCdwbGF5JykuY2FyZFNwcml0ZUF0bGFzO1xyXG5cclxuICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChrcUNhcmQsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIGlmIChpbmRleCA+PSBjYXJkU3ByaXRlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXJkU3ByaXRlc1tpbmRleF0ubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG5cclxuICAgICAgICAgICAgY2FyZFNwcml0ZXNbaW5kZXhdLm5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBcIlwiO1xyXG5cclxuICAgICAgICAgICAgdmFyIG5vZGRzMSA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXHJcblxyXG4gICAgICAgICAgICBub2RkczEuY2FyZE5hbWUgPSBrcUNhcmQuY2FyZE5hbWUoKTtcclxuXHJcbiAgICAgICAgICAgIG5vZGRzMS53aWR0aCA9IGNhcmRTcHJpdGVzW2luZGV4XS5ub2RlLndpZHRoO1xyXG5cclxuICAgICAgICAgICAgbm9kZHMxLmhlaWdodCA9IGNhcmRTcHJpdGVzW2luZGV4XS5ub2RlLmhlaWdodDtcclxuXHJcbiAgICAgICAgICAgIG5vZGRzMS5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTsgLy/mt7vliqDnsr7ngbXnu4Tku7ZcclxuXHJcbiAgICAgICAgICAgIHZhciBjYXJkU3ByaXRlID0gbm9kZHMxLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XHJcblxyXG4gICAgICAgICAgICBjYXJkU3ByaXRlLnNpemVNb2RlID0gMDtcclxuXHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBrcUNhcmQuY2FyZE5hbWUoKTtcclxuXHJcbiAgICAgICAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZSh0aGlzLmNhcmRTcHJpdGVBdGxhcywgcGF0aCAsY2FyZFNwcml0ZSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNldE1hUGFpKGNhcmRTcHJpdGUubm9kZSwga3FDYXJkLmNhcmROYW1lKCkpO1xyXG5cclxuICAgICAgICAgICAgY2FyZFNwcml0ZXNbaW5kZXhdLm5vZGUuYWRkQ2hpbGQobm9kZHMxKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgdmFyIGNhcmRzMCA9IGNhcmRzLnNsaWNlKDAsMylcclxuICAgICAgICB2YXIgY2FyZHMxID0gY2FyZHMuc2xpY2UoMyw4KVxyXG4gICAgICAgIHZhciBjYXJkczIgPSBjYXJkcy5zbGljZSg4LDEzKVxyXG5cclxuICAgICAgICB2YXIgY2FyZHMxMSA9IFtjYXJkczAsIGNhcmRzMSwgY2FyZHMyXVxyXG4gICAgICAgIC8v5aS06YGTXHJcbiAgICAgICAgbGV0IHR5cGVOYW1lMCA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMwKSsxO1xyXG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD49MTAgPyB0eXBlTmFtZTAgOlwiMFwiK3R5cGVOYW1lMDtcclxuICAgICAgICB0eXBlTmFtZTAgPSB0eXBlTmFtZTA9PScwNCcgPyAnMTEnIDp0eXBlTmFtZTA7XHJcblxyXG4gICAgICAgIC8v5Lit6YGTXHJcbiAgICAgICAgbGV0IHR5cGVOYW1lMSA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMxKSsxO1xyXG4gICAgICAgIHR5cGVOYW1lMSA9IHR5cGVOYW1lMT49MTAgPyB0eXBlTmFtZTEgOlwiMFwiK3R5cGVOYW1lMTtcclxuICAgICAgICB0eXBlTmFtZTEgPSB0eXBlTmFtZTE9PScwNycgPyAnMjInIDp0eXBlTmFtZTE7XHJcblxyXG4gICAgICAgIC8v5bC+6YGTXHJcbiAgICAgICAgbGV0IHR5cGVOYW1lMiA9IEtRQ2FyZC5jYXJkc1R5cGUoY2FyZHMyKSsxO1xyXG4gICAgICAgIHR5cGVOYW1lMiA9IHR5cGVOYW1lMj49MTAgPyB0eXBlTmFtZTIgOlwiMFwiK3R5cGVOYW1lMjtcclxuXHJcbiAgICAgICAgY2FyZFNwcml0ZXMgPSBjYXJkU3ByaXRlcy5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkubm9kZTt9KTtcclxuXHJcbiAgICAgICAgaWYodHlwZU5hbWUwKSBLUUNhcmQuX3NldEd1aUNhcmQoMCwgMCwgMywgdHlwZU5hbWUwLCBjYXJkczExLCBjYXJkU3ByaXRlcywgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xyXG4gICAgICAgIGlmKHR5cGVOYW1lMSkgS1FDYXJkLl9zZXRHdWlDYXJkKDEsIDMsIDgsIHR5cGVOYW1lMSwgY2FyZHMxMSwgY2FyZFNwcml0ZXMsIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcclxuICAgICAgICBpZih0eXBlTmFtZTIpIEtRQ2FyZC5fc2V0R3VpQ2FyZCgyLCA4LCAxMywgdHlwZU5hbWUyLCBjYXJkczExLCBjYXJkU3ByaXRlcywgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xyXG5cclxuICAgIH0sXHJcblxyXG5cclxuICAgIHNldFNjb3JlczogZnVuY3Rpb24gKHNjb3JlcyAsTGF5b3V0cyA9IG51bGwgLGlzX1dIID0gZmFsc2UpIHtcclxuICAgICAgICBpZighTGF5b3V0cyl7XHJcbiAgICAgICAgICAgIExheW91dHMgPSB0aGlzLmRhb1Njb3JlTGF5b3V0cztcclxuICAgICAgICAgICAgaWYoTGF5b3V0cy5sZW5ndGggPD0gMCkgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2NvcmVzLmZvckVhY2goZnVuY3Rpb24gKHN0cmluZywgaW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgIGxldCBsYWJlbHMgPSBMYXlvdXRzW2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgIGxhYmVscy5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IFwicGxheS9DYXJkVHlwZUNvbWJpbmUvXCIgKyAoKE51bWJlcihzdHJpbmcpID49IDApID8gXCJhZGROdW1cIiA6IFwiZGVsTnVtXCIpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fY3JlYXRvck5vZGVzKGxhYmVscy5ub2RlICwxMCAscGF0aCAsJycgLGlzX1dIKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzdHJpbmdzID0gKHN0cmluZyA+IDApID8gKHN0cmluZykgKyBcIlwiOiAoc3RyaW5nICogLTEpICsgXCJcIjtcclxuXHJcbiAgICAgICAgICAgIHZhciBzdHJpbmdBeXkgPSBzdHJpbmdzLnNwbGl0KFwiXCIpO1xyXG5cclxuICAgICAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgc3RyaW5nQXl5Lmxlbmd0aDtpKyspe1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBzID0gc3RyaW5nQXl5W2ldO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuX2NyZWF0b3JOb2RlcyhsYWJlbHMubm9kZSAsTnVtYmVyKHMpICxwYXRoICwnJyAsaXNfV0gpO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGFiZWxzLnR5cGUgPSAxO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfY3JlYXRvck5vZGVzOmZ1bmN0aW9uKG5vZGVzLG5hbWUscGF0aCxwYXRocyx3X2ggPSBmYWxzZSl7XHJcblxyXG4gICAgICAgIHZhciBub2RlID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcclxuXHJcbiAgICAgICAgbm9kZS5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTsgLy/mt7vliqDnsr7ngbXnu4Tku7ZcclxuXHJcbiAgICAgICAgdmFyIGJ0blNwcml0ZSA9IG5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcblxyXG4gICAgICAgIGJ0blNwcml0ZS5zaXplTW9kZSA9IDA7XHJcblxyXG4gICAgICAgIGJ0blNwcml0ZS5ub2RlLndpZHRoID0gMTg7YnRuU3ByaXRlLm5vZGUuaGVpZ2h0ID0gMjM7XHJcbiAgICAgICAgLy9uYW1lID0gbmFtZSArIFwiXCI7XHJcbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZShuYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcclxuXHJcbiAgICAgICAgICAgIGJ0blNwcml0ZS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xyXG5cclxuICAgICAgICAgICAgaWYod19oKXtidG5TcHJpdGUubm9kZS53aWR0aCA9IDMwO2J0blNwcml0ZS5ub2RlLmhlaWdodCA9IDQwO31cclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCBwYXRoLCBwYXRocyk7XHJcblxyXG4gICAgICAgIG5vZGVzLmFkZENoaWxkKG5vZGUpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX3NldENhcmRTcHJpdGVGcmFtZTogZnVuY3Rpb24gKGluZGV4cyxub2Rlcykge1xyXG4gICAgICAgIGxldCBjYXJkc0luZm8gPSB0aGlzLl9jYXJkc0luZm87XHJcbiAgICAgICAgbGV0IGNhcmRzID0gY2FyZHNJbmZvLm1hcChmdW5jdGlvbiAoY2FyZEluZm9JdGVtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRJbmZvSXRlbS5jYXJkcyk7XHJcbiAgICAgICAgICAgIH0pW2luZGV4c10gfHwgW107XHJcblxyXG4gICAgICAgIHRoaXMuY2FyZFNwcml0ZUF0bGFzID0gdGhpcy5ub2RlLnBhcmVudC5wYXJlbnQuZ2V0Q29tcG9uZW50KCdwbGF5JykuY2FyZFNwcml0ZUF0bGFzO1xyXG5cclxuICAgICAgICAvLyBjYy5sb2codGhpcy5fY2FyZHNJbmZvKVxyXG4gICAgICAgIC8vIGNjLmxvZyhjYXJkcylcclxuICAgICAgICAvLyBjYy5sb2coJy0tLS0tLTU1NScpXHJcblxyXG4gICAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGtxQ2FyZCwgaW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG5cclxuICAgICAgICAgICAgbm9kZXMuY2hpbGRyZW5baW5kZXhdLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gXCJcIlxyXG5cclxuICAgICAgICAgICAgdmFyIG5vZGRzMSA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXHJcblxyXG4gICAgICAgICAgICBub2RkczEuY2FyZE5hbWUgPSBrcUNhcmQuY2FyZE5hbWUoKTtcclxuXHJcbiAgICAgICAgICAgIG5vZGRzMS53aWR0aCA9IG5vZGVzLmNoaWxkcmVuW2luZGV4XS53aWR0aDtcclxuXHJcbiAgICAgICAgICAgIGlmKG5vZGVzLnBhcmVudC5wYXJlbnQubmFtZSA9PSBcInBsYXlTZWxmXCIpe1xyXG5cclxuICAgICAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5oZWlnaHQgPSAxMzA7XHJcblxyXG4gICAgICAgICAgICAgICAgbm9kZHMxLmhlaWdodCA9IDEzMDtcclxuXHJcbiAgICAgICAgICAgIH1lbHNle1xyXG5cclxuICAgICAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5oZWlnaHQgPSAxMTU7XHJcblxyXG4gICAgICAgICAgICAgICAgbm9kZHMxLmhlaWdodCA9IDExNTtcclxuXHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG5vZGVzKTtcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cobm9kZHMxKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbm9kZHMxLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxyXG5cclxuICAgICAgICAgICAgdmFyIGNhcmRTcHJpdGUgPSBub2RkczEuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcclxuXHJcbiAgICAgICAgICAgIGNhcmRTcHJpdGUuc2l6ZU1vZGUgPSAwO1xyXG5cclxuICAgICAgICAgICAgdmFyIHBhdGggPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGtxQ2FyZC5jYXJkTmFtZSgpO1xyXG5cclxuICAgICAgICAgICAgY2FyZFNwcml0ZS5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcblxyXG4gICAgICAgICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGNhcmRTcHJpdGUpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zZXRNYVBhaShjYXJkU3ByaXRlLm5vZGUsIGtxQ2FyZC5jYXJkTmFtZSgpKTtcclxuXHJcbiAgICAgICAgICAgIG5vZGVzLmNoaWxkcmVuW2luZGV4XS5hZGRDaGlsZChub2RkczEpO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICB2YXIgdHlwZU5hbWUgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzKSsxO1xyXG5cclxuICAgICAgICB0eXBlTmFtZSA9IHR5cGVOYW1lPj0xMCA/IHR5cGVOYW1lK1wiXCIgOlwiMFwiK3R5cGVOYW1lO1xyXG5cclxuICAgICAgICAvL+WktOmBk1xyXG4gICAgICAgIGlmKGluZGV4cyA9PSAwKXtcclxuICAgICAgICAgICAgdHlwZU5hbWUgPSB0eXBlTmFtZT09JzA0JyA/ICcxMScgOnR5cGVOYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKGluZGV4cyA9PSAxKXtcclxuICAgICAgICAgICAgdHlwZU5hbWUgPSB0eXBlTmFtZT09JzA3JyA/ICcyMicgOnR5cGVOYW1lO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGNhcmRTcHJpdGVzID0gbm9kZXMuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uKGkpe3JldHVybiBpO30pO1xyXG5cclxuICAgICAgICBLUUNhcmQuX3NldEd1aUNhcmRzKHR5cGVOYW1lLCBjYXJkcywgY2FyZFNwcml0ZXMsIHRoaXMuY2FyZFNwcml0ZUF0bGFzKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dUb3VDYXJkczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmEgPT0gdHJ1ZSkgcmV0dXJuO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coJ+W8gOWni+aJp+ihjOS4gOasoeWumuaXtuWKqOS9nC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJylcclxuXHJcbiAgICAgICAgdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fc2V0Q2FyZFNwcml0ZUZyYW1lKDAsdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUpO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnRvdUxheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLnRvdUxheW91dEJhY2subm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSwgMC43KTtcclxuXHJcbiAgICAgICAgdGhpcy50b3VMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudG91TGF5b3V0Lm5vZGUuc2NhbGVZID0gMC43O1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnRvdUxheW91dC5ub2RlLnNjYWxlWSA9IDE7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjAyKTtcclxuXHJcblxyXG4gICAgICAgIHZhciB0eXBlcyA9IHRoaXMuX2NhcmRzSW5mb1t0aGlzLl9jb21wYXJlSW5kZXhdLnR5cGUgPT0gMyA/IDMzMzp0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlO1xyXG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5Q2FyZFR5cGUodGhpcy5fdXNlci5zZXgsIHR5cGVzKTtcclxuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggKz0gMTtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvd1pob25nQ2FyZHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZih0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhID09IHRydWUpIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy56aG9uZ0xheW91dEJhY2subm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9zZXRDYXJkU3ByaXRlRnJhbWUoMSx0aGlzLnpob25nTGF5b3V0QmFjay5ub2RlKTtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy56aG9uZ0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLnpob25nTGF5b3V0QmFjay5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjcpO1xyXG5cclxuICAgICAgICB0aGlzLnpob25nTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnpob25nTGF5b3V0Lm5vZGUuc2NhbGVZID0gMC43O1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnpob25nTGF5b3V0Lm5vZGUuc2NhbGVZID0gMTtcclxuICAgICAgICB9LmJpbmQodGhpcyksIDAuMDIpO1xyXG5cclxuICAgICAgICB2YXIgdHlwZXMgPSB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlID09IDYgPyA1NTU6dGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF0udHlwZTtcclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0eXBlcyk7XHJcbiAgICAgICAgdGhpcy5fY29tcGFyZUluZGV4ICs9IDE7XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dXZWlDYXJkczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coJ+aJp+ihjOS6huS4gOasoeWwvumBk+WKqOeUuy0tLS0tLS0tLS0tLS0tLScpXHJcbiAgICAgICAgaWYodGhpcy5fdXNlci5pc0NvbnRhaW5FeHRyYSA9PSB0cnVlKSByZXR1cm47XHJcbiAgICAgICAgLy90aGlzLl9zZXRDYXJkU3ByaXRlRnJhbWUoMSx0aGlzLnpob25nTGF5b3V0QmFjay5ub2RlKTtcclxuICAgICAgICB0aGlzLndlaUxheW91dEJhY2subm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9zZXRDYXJkU3ByaXRlRnJhbWUoMix0aGlzLndlaUxheW91dEJhY2subm9kZSk7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2VpTGF5b3V0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMud2VpTGF5b3V0QmFjay5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAwLjcpO1xyXG5cclxuICAgICAgICB0aGlzLndlaUxheW91dC5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy53ZWlMYXlvdXQubm9kZS5zY2FsZVkgPSAwLjc7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2VpTGF5b3V0Lm5vZGUuc2NhbGVZID0gMTtcclxuICAgICAgICB9LmJpbmQodGhpcyksIDAuMDIpO1xyXG5cclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlKTtcclxuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggKz0gMTtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvd1RlU2h1Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgICAgIC8vbGV0IHR5cGVOYW1lID0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoY2FyZHNOYW1lcyk7XHJcbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0QmFja3MgPSBbdGhpcy50b3VMYXlvdXRCYWNrLCB0aGlzLnpob25nTGF5b3V0QmFjaywgdGhpcy53ZWlMYXlvdXRCYWNrXTtcclxuXHJcbiAgICAgICAgbGV0IHRvdUNhcmRTcHJpdGVzID0gdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KHRoaXMuX2Rhb0xheW91dEJhY2tzWzBdKTtcclxuICAgICAgICBsZXQgemhvbmdDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLl9kYW9MYXlvdXRCYWNrc1sxXSk7XHJcbiAgICAgICAgbGV0IHdlaUNhcmRTcHJpdGVzID0gdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KHRoaXMuX2Rhb0xheW91dEJhY2tzWzJdKTtcclxuICAgICAgICBsZXQgY2FyZFNwcml0ZXMgPSB0b3VDYXJkU3ByaXRlcy5jb25jYXQoemhvbmdDYXJkU3ByaXRlcykuY29uY2F0KHdlaUNhcmRTcHJpdGVzKTtcclxuICAgICAgICB0aGlzLmNhcmRTcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQucGFyZW50LmdldENvbXBvbmVudCgncGxheScpLmNhcmRTcHJpdGVBdGxhcztcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoa3FDYXJkLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IGNhcmRTcHJpdGVzLmxlbmd0aCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBjYXJkU3ByaXRlID0gY2FyZFNwcml0ZXNbaW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBrcUNhcmQuY2FyZE5hbWUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXJkU3ByaXRlLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuXHJcbiAgICAgICAgICAgICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUodGhpcy5jYXJkU3ByaXRlQXRsYXMsIHBhdGggLGNhcmRTcHJpdGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0TWFQYWkoY2FyZFNwcml0ZS5ub2RlLCBrcUNhcmQuY2FyZE5hbWUoKSk7XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB0aGlzLl9kYW9MYXlvdXRCYWNrcy5mb3JFYWNoKGZ1bmN0aW9uIChub2Rlcykge25vZGVzLm5vZGUuYWN0aXZlID0gdHJ1ZTt9LmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0aGlzLl9jYXJkc0luZm9bMF0udHlwZSk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLDAuMSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dOZXh0Q2FyZHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY2FyZFR5cGVDb21iaW5lID0gdGhpcy5ub2RlLnBhcmVudC5wYXJlbnQuZ2V0Q2hpbGRCeU5hbWUoJ0NhcmRUeXBlQ29tYmluZScpLmdldENvbXBvbmVudCgnQ2FyZFR5cGVDb21iaW5lJyk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnJlc2V0KCk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMudG91TGF5b3V0QmFjay5ub2RlLnBhcmVudC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhKSB7XHJcbiAgICAgICAgICAgIHZhciBjYXJkcyA9IHRoaXMuX2NhcmRzSW5mb1swXS5jYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0pO1xyXG4gICAgICAgICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7XHJcbiAgICAgICAgICAgIH0sIFtdKTtcclxuICAgICAgICAgICAgdGhpcy5zaG93VGVTaHVDYXJkcyhjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0Jhb0RhbygwLDApO1xyXG4gICAgICAgICAgICB0aGlzLmJhb0Rhby5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2Rhb0xheW91dHMgPSBbdGhpcy50b3VMYXlvdXQsIHRoaXMuemhvbmdMYXlvdXQsIHRoaXMud2VpTGF5b3V0XTtcclxuICAgICAgICB0aGlzLl9kYW9MYXlvdXRzLmZvckVhY2goZnVuY3Rpb24gKG5vZGVzKSB7XHJcbiAgICAgICAgICAgIG5vZGVzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2NvbXBhcmVJbmRleCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0Jhb0RhbygwLDE0MCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1RvdUNhcmRzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX2NvbXBhcmVJbmRleCA9PSAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0Jhb0RhbygxLDg1KTtcclxuICAgICAgICAgICAgdGhpcy5zaG93WmhvbmdDYXJkcygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLl9jb21wYXJlSW5kZXggPT0gMikge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dCYW9EYW8oMiwzNCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1dlaUNhcmRzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmJhb0Rhby5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge3RoaXMuYmFvRGFvLmFjdGl2ZSA9IGZhbHNlO30uYmluZCh0aGlzKSwgMC43KTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dBbGxDYXJkczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKCF0aGlzLl91c2VyKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgY2FyZHMgPSB0aGlzLl9jYXJkc0luZm9bMF0uY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkSW5mb0l0ZW0pIHtyZXR1cm4gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRJbmZvSXRlbSk7fSlcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge3JldHVybiBhcnJheS5jb25jYXQoc3ViQ2FyZHMpO30sIFtdKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1RlU2h1Q2FyZHMoY2FyZHMpO1xyXG5cclxuICAgICAgICAgICAgLy9yZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZighdGhpcy5fZGFvTGF5b3V0QmFja3MpIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy50b3VMYXlvdXRCYWNrLm5vZGUucGFyZW50LmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMuX2Rhb0xheW91dEJhY2tzLmZvckVhY2goZnVuY3Rpb24gKG5vZGVzLGluZGV4KSB7XHJcblxyXG4gICAgICAgICAgICBub2Rlcy5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICBub2Rlcy5ub2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKG5vKSB7bm8uYWN0aXZlID0gdHJ1ZTt9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3NldENhcmRTcHJpdGVGcmFtZShpbmRleCxub2Rlcy5ub2RlKTtcclxuXHJcbiAgICAgICAgICAgIGlmKHRoaXMuVFNjb3JlTGF5b3V0KSB0aGlzLmRhb1RpdGxlTm9kZXNbaW5kZXhdLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIGlmKCF0aGlzLlRTY29yZUxheW91dCkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLmRhb1Njb3JlTGF5b3V0cy5mb3JFYWNoKGZ1bmN0aW9uIChub2Rlcykge1xyXG5cclxuICAgICAgICAgICAgbm9kZXMubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICB0aGlzLnNldFNjb3JlcyhbdGhpcy5fdXNlci5jU2NvcmVdLFt0aGlzLlRTY29yZUxheW91dF0sdHJ1ZSk7XHJcblxyXG4gICAgICAgIHRoaXMuVHRpdGxlTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLlRTY29yZUxheW91dC5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzaG93QmFvRGFvOiBmdW5jdGlvbiAoaW5kZXgscG9zaXRvblkpIHtcclxuICAgICAgICBsZXQgY2FyZHNJbmZvID0gdGhpcy5fY2FyZHNJbmZvO1xyXG4gICAgICAgIGxldCBjYXJkVHlwZSA9IGNhcmRzSW5mby5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2FyZEluZm9JdGVtLnR5cGVcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IHR5cGVOYW1lMCA9IGNhcmRUeXBlW2luZGV4XSsxO1xyXG4gICAgICAgIHR5cGVOYW1lMCA9IHR5cGVOYW1lMD49MTAgPyB0eXBlTmFtZTAgOlwiMFwiK3R5cGVOYW1lMDtcclxuICAgICAgICBpZihpbmRleCA9PSAwKSB0eXBlTmFtZTAgPSB0eXBlTmFtZTA9PScwNCcgPyAnMTEnIDp0eXBlTmFtZTA7XHJcbiAgICAgICAgaWYoaW5kZXggPT0gMSkgdHlwZU5hbWUwID0gdHlwZU5hbWUwPT0nMDcnID8gJzIyJyA6dHlwZU5hbWUwO1xyXG5cclxuICAgICAgICBpZihjYXJkVHlwZVtpbmRleF0gPT0gMTApIHR5cGVOYW1lMCA9ICcxNSc7Ly/nibnmrorniYxcclxuICAgICAgICBpZihjYXJkVHlwZVtpbmRleF0gPT0gMTEpIHR5cGVOYW1lMCA9ICcxNCc7XHJcbiAgICAgICAgaWYoY2FyZFR5cGVbaW5kZXhdID09IDEyKSB0eXBlTmFtZTAgPSAnMTYnO1xyXG4gICAgICAgIGlmKGNhcmRUeXBlW2luZGV4XSA9PSAxOCkgdHlwZU5hbWUwID0gJzI1JztcclxuICAgICAgICBpZihjYXJkVHlwZVtpbmRleF0gPT0gMTkpIHR5cGVOYW1lMCA9ICcyNic7XHJcblxyXG4gICAgICAgIHZhciBwYXRoID0gdGhpcy5fdXNlci5pc0NvbnRhaW5FeHRyYT9cImdhbWUtcmlnaHRfc3BlY2lhXCI6XCJnYW1lLXBva2VyX3R5cGVcIjtcclxuXHJcbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZSh0eXBlTmFtZTAsIGZ1bmN0aW9uIChzcHJpdGVGcmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgYnRuU3ByaXRlczEgPSAgdGhpcy5iYW9EYW8uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgICAgICAgIGJ0blNwcml0ZXMxLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpLCBcInBsYXkvQ2FyZFR5cGVDb21iaW5lL2dhbWVfdHh0XCIscGF0aCk7XHJcbiAgICAgICAgdGhpcy5iYW9EYW8ueSA9IHBvc2l0b25ZO1xyXG4gICAgfSxcclxuXHJcbiAgICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaywgcGF0aCA9IFwicGxheS9DYXJkVHlwZUNvbWJpbmUvcG9ja0xpc3RcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aHMgPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIikge1xyXG4gICAgICAgIGNjLmxvYWRlci5sb2FkUmVzKHBhdGgsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xyXG4gICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjYy5lcnJvcihlcnIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhcmROYW1lID0gY2FyZE5hbWUgKyBcIlwiO1xyXG4gICAgICAgICAgICBjYXJkTmFtZSA9IHRoaXMuX2NhcmRGdWxsTmFtZShjYXJkTmFtZSxwYXRocyk7XHJcbiAgICAgICAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcclxuICAgICAgICAgICAgY2FsbGJhY2soZnJhbWUpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lLHBhdGhzKSB7XHJcbiAgICAgICAgaWYoIXBhdGhzKSByZXR1cm4gY2FyZFNob3J0TmFtZTtcclxuICAgICAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xyXG4gICAgICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChwYXRocykpIHtcclxuICAgICAgICAgICAgY2FyZE5hbWUgPSBwYXRocyArIGNhcmROYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2FyZE5hbWU7XHJcbiAgICB9LFxyXG5cclxuICAgIF9jbGVhckNhcmRzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fY2xlYXJMYXlvdXRDYXJkcyh0aGlzLnRvdUxheW91dCk7XHJcbiAgICAgICAgdGhpcy5fY2xlYXJMYXlvdXRDYXJkcyh0aGlzLnpob25nTGF5b3V0KTtcclxuICAgICAgICB0aGlzLl9jbGVhckxheW91dENhcmRzKHRoaXMud2VpTGF5b3V0KTtcclxuICAgIH0sXHJcblxyXG4gICAgX2NsZWFyTGF5b3V0Q2FyZHM6IGZ1bmN0aW9uIChsYXlvdXQpIHtcclxuICAgICAgICB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQobGF5b3V0KS5mb3JFYWNoKGZ1bmN0aW9uIChzcHJpdGUpIHtcclxuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX2NhcmRTcHJpdGVzV2l0aExheW91dDogZnVuY3Rpb24gKGxheW91dCkge1xyXG4gICAgICAgIGxldCBub2RlID0gbGF5b3V0Lm5vZGU7XHJcbiAgICAgICAgcmV0dXJuIG5vZGUuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBub2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9hbGxDYXJkU3ByaXRlczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGxldCB0b3VDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLnRvdUxheW91dCk7XHJcbiAgICAgICAgbGV0IHpob25nQ2FyZFNwcml0ZXMgPSB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQodGhpcy56aG9uZ0xheW91dCk7XHJcbiAgICAgICAgbGV0IHdlaUNhcmRTcHJpdGVzID0gdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KHRoaXMud2VpTGF5b3V0KTtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gdG91Q2FyZFNwcml0ZXMuY29uY2F0KHpob25nQ2FyZFNwcml0ZXMpLmNvbmNhdCh3ZWlDYXJkU3ByaXRlcyk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sXHJcblxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBsYWJlbFRpbWU6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vdGltZU5vZGU6IGNjLk5vZGUsXHJcblxyXG4gICAgICAgIF9jYWxsYmFjazogbnVsbCxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBcIjBcIjtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlvIDlp4vlgJLorqHml7ZcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtICB7TnVtYmVyfSB0aW1lIOaXtumVv1xyXG4gICAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIOWAkuiuoeaXtueahOWbnuiwg1xyXG4gICAgICovXHJcbiAgICBzdGFydENvdW50ZG93bjogZnVuY3Rpb24odGltZSwgY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xyXG5cclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBcIlwiICsgdGltZTtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMuX2NvdW50RG93biwgMSwgdGltZSk7XHJcbiAgICAgICAgdGhpcy5nZXRDb21wb25lbnQoXCJ0aW1lXCIpLnNldFRpbWUodGltZSAqIDAuNSlcclxuICAgIH0sXHJcblxyXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuX2NvdW50RG93bik7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5fY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgbGV0IGlzVGltZW91dCA9IE51bWJlcih0aGlzLmxhYmVsVGltZS5zdHJpbmcpIDw9IDA7XHJcbiAgICAgICAgICAgIGxldCBjYWxsYmFjayA9IHRoaXMuX2NhbGxiYWNrO1xyXG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGlzVGltZW91dCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9jYWxsYmFjayA9IG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9jb3VudERvd246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB0aW1lID0gTnVtYmVyKHRoaXMubGFiZWxUaW1lLnN0cmluZyB8fCBcIjBcIik7XHJcbiAgICAgICAgdGltZSA9IHRpbWUgLSAxO1xyXG5cclxuICAgICAgICBpZiAodGltZSA8PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gU3RyaW5nKHRpbWUpO1xyXG4gICAgfSxcclxuXHJcblxyXG59KTtcclxuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XHJcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xyXG5cclxubGV0IFJlc3VsdFN0YXR1cyA9IHtcclxuICBXSU46IDIsXHJcbiAgRFJBVzogMSxcclxuICBMT1NFOiAwLFxyXG59O1xyXG5cclxuXHJcbmxldCBHYW1lUmVzdWx0ID0gY2MuQ2xhc3Moe1xyXG4gIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgcHJvcGVydGllczoge1xyXG4gICAgd2luTm9kZTogY2MuTm9kZSxcclxuICAgIGxvc2VOb2RlOiBjYy5Ob2RlLFxyXG4gICAgZHJhd05vZGU6IGNjLk5vZGUsXHJcbiAgICBjb250ZW50Tm9kZTogY2MuTm9kZSxcclxuXHJcbiAgICByZXN1bHRJdGVtczogW2NjLk5vZGVdLFxyXG5cclxuICAgIF9kZXNrSW5mbzogbnVsbCxcclxuICAgIF91c2VySWQ6IG51bGwsXHJcbiAgICBfY2xvc2VDYWxsYmFjazogbnVsbCxcclxuICB9LFxyXG5cclxuICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuX2hpZGVSZXN1bHRJdGVtcygpO1xyXG4gIH0sXHJcblxyXG4gIHNob3dSZXN1bHRzOiBmdW5jdGlvbiAoZGVza0luZm8sIGN1cnJlbnRVc2VySWQpIHtcclxuICAgIHRoaXMuX2Rlc2tJbmZvID0gZGVza0luZm87XHJcbiAgICB0aGlzLl91c2VySWQgPSBjdXJyZW50VXNlcklkO1xyXG5cclxuICAgIGxldCByZXN1bHRTdGF0dXMgPSB0aGlzLl9yZXN1bHRTdGF0dXMoKTtcclxuICAgIHRoaXMuY29udGVudE5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgIHRoaXMud2luTm9kZS5hY3RpdmUgPSAgKHJlc3VsdFN0YXR1cyA9PSBSZXN1bHRTdGF0dXMuV0lOKTtcclxuICAgIHRoaXMuZHJhd05vZGUuYWN0aXZlID0gKHJlc3VsdFN0YXR1cyA9PSBSZXN1bHRTdGF0dXMuRFJBVyk7XHJcbiAgICB0aGlzLmxvc2VOb2RlLmFjdGl2ZSA9IChyZXN1bHRTdGF0dXMgPT0gUmVzdWx0U3RhdHVzLkxPU0UpO1xyXG5cclxuICAgIGlmICh0aGlzLndpbk5vZGUuYWN0aXZlKSB7XHJcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5V2luKCk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMubG9zZU5vZGUuYWN0aXZlKSB7XHJcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5TG9zZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcclxuICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jykuc2V0RGlzbWlzc0NhbGxiYWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5fY2xvc2VDYWxsYmFja1xyXG4gICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICBsZXQgcGxheWVySW5mb3MgPSBkZXNrSW5mby5wbGF5ZXJzLnNvcnQoZnVuY3Rpb24gKHAxLCBwMikge1xyXG4gICAgICByZXR1cm4gcDIuY1Njb3JlIC0gcDEuY1Njb3JlO1xyXG4gICAgfSk7XHJcbiAgICBsZXQgaXRlbUNvbXBzID0gdGhpcy5yZXN1bHRJdGVtcy5tYXAoZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgcmV0dXJuIG5vZGUuZ2V0Q29tcG9uZW50KCdSZXN1bHRJdGVtJyk7XHJcbiAgICB9KTtcclxuICAgIGl0ZW1Db21wcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtQ29tcCwgaW5kZXgpIHtcclxuICAgICAgaXRlbUNvbXAubm9kZS5hY3RpdmUgPSBpbmRleCA8IHBsYXllckluZm9zLmxlbmd0aDtcclxuICAgICAgaWYgKCFpdGVtQ29tcC5ub2RlLmFjdGl2ZSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IHVzZXIgPSBwbGF5ZXJJbmZvc1tpbmRleF07XHJcbiAgICAgIGl0ZW1Db21wLnVwZGF0ZVdpdGhQbGF5ZXJJbmZvKHVzZXIsIGRlc2tJbmZvLmlzUmFuZG9tRGVzayk7XHJcbiAgICAgIGxldCBjYXJkcyA9IHRoaXMuX2NhcmRzRnJvbVVzZXIodXNlcik7XHJcbiAgICAgIGl0ZW1Db21wLnNldENhcmRzKGNhcmRzKTtcclxuICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgfSxcclxuXHJcbiAgc2V0Q2xvc2VDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICB0aGlzLl9jbG9zZUNhbGxiYWNrID0gY2FsbGJhY2s7XHJcbiAgfSxcclxuXHJcbiAgX2NhcmRzRnJvbVVzZXI6IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICBsZXQgY2FyZHMgPSB1c2VyLmNhcmRJbmZvLm1hcChmdW5jdGlvbiAoY2FyZEluZm9JdGVtKSB7XHJcbiAgICAgIHJldHVybiBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZEluZm9JdGVtLmNhcmRzKTtcclxuICAgIH0pLnJlZHVjZShmdW5jdGlvbiAoYXJyYXksIHN1YkNhcmRzKSB7XHJcbiAgICAgIHJldHVybiBhcnJheS5jb25jYXQoc3ViQ2FyZHMpO1xyXG4gICAgfSwgW10pO1xyXG5cclxuICAgIHJldHVybiBjYXJkcztcclxuICB9LFxyXG5cclxuICBfaGlkZVJlc3VsdEl0ZW1zOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLnJlc3VsdEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgbm9kZS5hY2l0dmUgPSBmYWxzZTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIF9yZXN1bHRTdGF0dXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgbGV0IHBsYXllckluZm9zID0gdGhpcy5fZGVza0luZm8ucGxheWVycztcclxuICAgIGxldCB1c2VyID0gcGxheWVySW5mb3MuZmluZChmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICByZXR1cm4gdXNlci5pZCA9PSB0aGlzLl91c2VySWQ7XHJcbiAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgIGxldCBzY29yZSA9IHVzZXIuY1Njb3JlO1xyXG4gICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmlzUmFuZG9tRGVzaykge1xyXG4gICAgICAvLyDlpoLmnpzmmK/pmo/mnLrlnLrnmoTor53vvIzlupTor6XnlKjpkrvnn7PmnaXliKTmlq3ovpPotaJcclxuICAgICAgc2NvcmUgPSB1c2VyLmRpYW1vbmQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNjb3JlID4gMCkge1xyXG4gICAgICByZXR1cm4gUmVzdWx0U3RhdHVzLldJTjtcclxuICAgIH0gZWxzZSBpZiAoc2NvcmUgPCAwKSB7XHJcbiAgICAgIHJldHVybiBSZXN1bHRTdGF0dXMuTE9TRTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gUmVzdWx0U3RhdHVzLkRSQVc7XHJcbiAgfSxcclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVSZXN1bHQ7XHJcbiIsIi8qIyMjIyMqL1xyXG4vL++/ve+/ve+/ve+/ve+/ve+/ve+/ve+/vdK777+977+977+977+977+977+977+977+977+92rXvv73vv73vv73NrO+/ve+/ve+/ve+/ve+/ve+/ve+/vca177+977+977+977+977+9XHJcbiB2YXIgR2V0Q2FyZFBvaW50c1NhbWVDb3VudCA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdGhpcy5jYXJkTnVtYmVycyA9IHt9O1xyXG4gICAgZm9yKHZhciBpIGluIGNhcmRzKXtcclxuICAgICAgICB2YXIgcztcclxuICAgICAgICBpZih0eXBlb2YoY2FyZHNbaV0ubnVtYmVyKSA9PSAndW5kZWZpbmVkJyl7XHJcbiAgICAgICAgICAgIHMgPSBjYXJkc1tpXS5wb2ludDtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcyA9IGNhcmRzW2ldLm51bWJlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5jYXJkTnVtYmVyc1tzXSl7XHJcbiAgICAgICAgICAgIHRoaXMuY2FyZE51bWJlcnNbc10gKys7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuY2FyZE51bWJlcnNbc10gPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL2NjLmxvZyh0aGlzLmNhcmROdW1iZXJzW2NhcmRzW2ldLm51bWJlcl0pXHJcbiAgICAgICAgLy9jYy5sb2coY2FyZHMpXHJcbiAgICAgICAgLy9jYy5sb2coY2FyZHNbaV0ubnVtYmVyKVxyXG4gICAgICAgIC8vY2MubG9nKCctLS03JylcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLmNhcmROdW1iZXJzO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBHZXRDYXJkUG9pbnRzU2FtZUNvdW50O1xyXG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBsYWJlbE51bWJlcnM6IFtjYy5MYWJlbF0sXHJcbiAgICAgICAgY2FsbGJhY2tKb2luUm9vbTogbnVsbCxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5jbGlja0NsZWFyKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrTnVtYmVyOiBmdW5jdGlvbiAoZXZlbnQsIG51bWJlcikge1xyXG4gICAgICB2YXIgbGFiZWwgPSB0aGlzLl9sYXN0RW1wdHlMYWJlbCgpO1xyXG4gICAgICBpZiAobGFiZWwpIHtcclxuICAgICAgICBsYWJlbC5zdHJpbmcgPSBudW1iZXI7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGxldCBpc0NvbXBsZXRlID0gKHRoaXMuX2xhc3RFbXB0eUxhYmVsKCkgPT0gbnVsbCk7XHJcbiAgICAgIGxldCBpbnZpdGVOdW1iZXIgPSB0aGlzLl9yb29tTnVtYmVyKCk7XHJcbiAgICAgIGlmIChpbnZpdGVOdW1iZXIubGVuZ3RoID09IDYpIHtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrSm9pblJvb20gPSBpbnZpdGVOdW1iZXI7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc2VuZENvZGUgOmZ1bmN0aW9uKCl7ICAvL+WPkemAgemCgOivt+eggVxyXG4gICAgICBsZXQgdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICBsZXQgaW52aXRlTnVtYmVyID0gdGhpcy5jYWxsYmFja0pvaW5Sb29tO1xyXG4gICAgICBjb25zb2xlLmxvZyhpbnZpdGVOdW1iZXIgLFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXCIpO1xyXG4gICAgICBpZiggaW52aXRlTnVtYmVyLmxlbmd0aD09Nil7ICBcclxuICAgICAgICBTb2NrZXQuc2VuZEludml0ZUNvZGUoaW52aXRlTnVtYmVyLCB1c2VySWQpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tKb2luUm9vbSA9ICcnOyAgIC8v5riF56m66YKA6K+356CBXHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tDbGVhcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNhbGxiYWNrSm9pblJvb20gPSAnJztcclxuICAgICAgdGhpcy5sYWJlbE51bWJlcnMuZm9yRWFjaChmdW5jdGlvbiAobGFiZWwpIHtcclxuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tEZWxldGVPbmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGxhYmVsID0gdGhpcy5fbGFzdE51bWJlckxhYmVsKCk7XHJcbiAgICAgIGlmIChsYWJlbCkge1xyXG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgX2xhc3RFbXB0eUxhYmVsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGZvciAodmFyIGluZGV4IGluIHRoaXMubGFiZWxOdW1iZXJzKSB7XHJcbiAgICAgICAgdmFyIGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xyXG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgPT0gbnVsbFxyXG4gICAgICAgIHx8IGxhYmVsLnN0cmluZy5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgX2xhc3ROdW1iZXJMYWJlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBmb3IgKHZhciBpbmRleCA9IHRoaXMubGFiZWxOdW1iZXJzLmxlbmd0aCAtIDE7IGluZGV4ID49IDA7IC0taW5kZXgpIHtcclxuICAgICAgICBsZXQgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XHJcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyAmJiBsYWJlbC5zdHJpbmcubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yb29tTnVtYmVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmxhYmVsTnVtYmVycy5yZWR1Y2UoZnVuY3Rpb24gKHJvb21OdW1iZXIsIGxhYmVsKSB7XHJcbiAgICAgICAgcmV0dXJuIHJvb21OdW1iZXIgKyAobGFiZWwuc3RyaW5nIHx8IFwiXCIpO1xyXG4gICAgICB9LCBcIlwiKTtcclxuICAgIH0sXHJcbn0pO1xyXG4iLCIvLyDniYzoirHoibLluK7liqnnsbtcclxuLy8g55So5LqO6K6h566X5LiA5Liq54mM5pWw57uE55qE6Iqx6Imy55u45ZCM55qE54mM55qE5byg5pWwXHJcbnZhciBLUUNhcmRDb2xvcnNIZWxwZXIgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICB0aGlzLmNvbG9yTnVtYmVyID0ge307XHJcblxyXG4gIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgIGxldCBjb2xvciA9IGNhcmQuY29sb3I7XHJcbiAgICB2YXIgbnVtYmVyID0gdGhpcy5jb2xvck51bWJlcltjb2xvcl0gfHwgMDtcclxuICAgIHRoaXMuY29sb3JOdW1iZXJbY29sb3JdID0gbnVtYmVyICsgMTtcclxuICB9LmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLy8g55u45ZCM6Iqx6Imy55qE54mM55qE5pyA5aSn5pWw6YePXHJcbktRQ2FyZENvbG9yc0hlbHBlci5wcm90b3R5cGUubWF4TnVtYmVyID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciByZXN1bHQgPSAwO1xyXG4gIGZvciAobGV0IHByb3AgaW4gdGhpcy5jb2xvck51bWJlcikge1xyXG4gICAgbGV0IG51bWJlciA9IHRoaXMuY29sb3JOdW1iZXJbcHJvcF07XHJcbiAgICByZXN1bHQgPSBNYXRoLm1heChudW1iZXIsIHJlc3VsdCk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVzdWx0O1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBLUUNhcmRDb2xvcnNIZWxwZXI7XHJcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xyXG5jb25zdCBBcnJheUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0FycmF5RXh0ZW5zaW9uJyk7XHJcbmNvbnN0IEtRQ2FyZFBvaW50c0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFBvaW50c0hlbHBlcicpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7fTtcclxuXHJcbi8vIOWvu+aJviBjYXJkTW9kZXMg5Lit55qEIOWvueWtkFxyXG4vLyDov5nkvJrov5Tlm54g5a+55a2QIOeahOe0ouW8leaVsOe7hFxyXG4vLyDlpoLvvJpbWzEsIDNdLCBbNCwgNV1dXHJcbktRQ2FyZC5maW5kRHVpWmkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XHJcbiAgbGV0IHNEdWlaaUluZGV4cyA9IEtRQ2FyZC5maW5kU2FuVGlhbyhjYXJkTW9kZXMpIHx8IFtdO1xyXG4gIGxldCByZXN1bHQgPSBLUUNhcmQuX2ZpbmRQb2ludExlbmd0aChjYXJkTW9kZXMsIDIpIHx8IFtdO1xyXG4gIGlmKHJlc3VsdC5sZW5ndGggPCAyICl7XHJcbiAgICBpZihzRHVpWmlJbmRleHMubGVuZ3RoID4gMCl7XHJcbiAgICAgIHNEdWlaaUluZGV4cy5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xyXG4gICAgICAgIHZhciBzMSA9IFtpbmRleHNbMF0saW5kZXhzWzFdXTtcclxuICAgICAgICAvL3ZhciBzMiA9IFtpbmRleHNbMV0saW5kZXhzWzJdXTtcclxuICAgICAgICAvL3Jlc3VsdC5wdXNoKHMyKTtcclxuICAgICAgICByZXN1bHQucHVzaChzMSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdmFyIHRyZXN1bHQgPSBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMik7XHJcbiAgICBmb3IodmFyIGkgPSAwO2kgPCB0cmVzdWx0Lmxlbmd0aDtpKyspe1xyXG4gICAgICByZXN1bHQucHVzaCh0cmVzdWx0W2ldKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlc3VsdCA9IEtRQ2FyZC5yZXBlYXQocmVzdWx0KTtcclxuXHJcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XHJcbn07XHJcblxyXG5LUUNhcmQuX2ZpbmRQb2ludExlbmd0aCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsIGxlbmd0aCkge1xyXG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG5cclxuICBsZXQgb2JqID0gY2FyZE1vZGVzLnJlZHVjZShmdW5jdGlvbihvYmosIGNhcmQsIGluZGV4KSB7XHJcbiAgICBsZXQgcG9pbnRJbmRleHMgPSBvYmpbY2FyZC5wb2ludF0gfHwgW107XHJcbiAgICBvYmpbY2FyZC5wb2ludF0gPSBwb2ludEluZGV4cztcclxuICAgIHBvaW50SW5kZXhzLnB1c2goaW5kZXgpO1xyXG4gICAgcmV0dXJuIG9iajtcclxuICB9LCB7fSk7XHJcblxyXG4gIGxldCByZXN1bHQgPSBbXTtcclxuICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xyXG4gICAgbGV0IHBvaW50SW5kZXhzID0gb2JqW3Byb3BdO1xyXG4gICAgLy8gaWYgKHBvaW50SW5kZXhzLmxlbmd0aCA9PSBsZW5ndGgpIHtcclxuICAgIC8vICAgcG9pbnRJbmRleHMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XHJcbiAgICAvLyAgICAgcmV0dXJuIG4xIC0gbjI7XHJcbiAgICAvLyAgIH0pO1xyXG4gICAgLy8gICByZXN1bHQucHVzaChwb2ludEluZGV4cyk7XHJcbiAgICAvLyB9XHJcbiAgICB3aGlsZShwb2ludEluZGV4cy5sZW5ndGggPj0gbGVuZ3RoICYmIGxlbmd0aCAhPSAwKXsvL+acieWkmueahOWIhuWJsuWkmuS4quaVsOe7hFxyXG4gICAgICB2YXIgc3BsaWNlcyA9IHBvaW50SW5kZXhzLnNwbGljZSgwLGxlbmd0aCk7XHJcbiAgICAgIGlmIChzcGxpY2VzLmxlbmd0aCA+PSBsZW5ndGgpe1xyXG4gICAgICAgIHNwbGljZXMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XHJcbiAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXN1bHQucHVzaChzcGxpY2VzKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzdWx0LnNvcnQoZnVuY3Rpb24gKGFycjEsIGFycjIpIHtcclxuICAgIGxldCBuMSA9IGFycjFbMF07XHJcbiAgICBsZXQgbjIgPSBhcnIyWzBdO1xyXG4gICAgcmV0dXJuIG4yIC0gbjE7XHJcbiAgfSk7XHJcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XHJcbn07XHJcblxyXG4vLyDmib4g5Lik5a+5IOeahOe0ouW8leaVsOe7hFxyXG4vLyDlpoLvvJpbWzEsIDIsIDMsIDRdLCBbNSwgNiwgNywgOF1dXHJcbktRQ2FyZC5maW5kTGlhRHVpID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xyXG4gIGxldCBkdWlaaUluZGV4cyA9IEtRQ2FyZC5maW5kRHVpWmkoY2FyZE1vZGVzKSB8fCBbXTtcclxuICBsZXQgZHVpWmlJbmRleCA9IEtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2RlcywyKSB8fCBbXTtcclxuXHJcbiAgaWYoZHVpWmlJbmRleHMubGVuZ3RoIDwgMSAmJiBkdWlaaUluZGV4Lmxlbmd0aCA+IDApe1xyXG4gICAgZHVpWmlJbmRleC5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xyXG4gICAgICAgIGR1aVppSW5kZXhzLnVuc2hpZnQoaW5kZXhzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBpZiAoZHVpWmlJbmRleHMubGVuZ3RoIDwgMikge1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxuXHJcbiAgbGV0IHJlc3VsdCA9IFtdO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZHVpWmlJbmRleHMubGVuZ3RoOyArK2kpIHtcclxuICAgIGZvciAobGV0IGogPSBpICsgMTsgaiA8IGR1aVppSW5kZXhzLmxlbmd0aDsgKytqKSB7XHJcbiAgICAgIGlmKHJlc3VsdC5sZW5ndGggPCAxMCl7XHJcbiAgICAgICAgbGV0IHByZSA9IGR1aVppSW5kZXhzW2ldO1xyXG4gICAgICAgIGxldCBuZXh0ID0gZHVpWmlJbmRleHNbal07XHJcbiAgICAgICAgdmFyIHMgPSBwcmUuY29uY2F0KG5leHQpO1xyXG4gICAgICAgIHZhciBuZXdTID0gW107XHJcbiAgICAgICAgZm9yKHZhciBxID0gMDtxIDwgcy5sZW5ndGggO3ErKyl7XHJcbiAgICAgICAgICBpZihuZXdTLmluZGV4T2Yoc1txXSkgPT0gLTEpe1xyXG4gICAgICAgICAgICBuZXdTLnB1c2goc1txXSk7XHJcbiAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKG5ld1MubGVuZ3RoID09IDQpe1xyXG4gICAgICAgICAgbmV3Uy5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG4xIC0gbjI7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHJlc3VsdC51bnNoaWZ0KG5ld1MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG4gIH1cclxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7XHJcbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDYpe1xyXG4gICAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsNik7XHJcbiAgfVxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn07XHJcblxyXG4vLyDmib7kuInmnaFcclxuLy8g5aaC77yaW1sxLCAyLCAzXV07XHJcbktRQ2FyZC5maW5kU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcclxuICBpZihjYXJkTW9kZXMubGVuZ3RoIDwgMyl7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG4gIGxldCByZXN1bHQgPSBLUUNhcmQuX2ZpbmRQb2ludExlbmd0aChjYXJkTW9kZXMsIDMpIHx8IFtdO1xyXG4gIC8vZm9yKHZhciBxID0wO3E8cmVzdWx0Lmxlbmd0aDtxKyspe1xyXG4gIC8vICB2YXIgaW5kZXhzID0gcmVzdWx0W3FdWzBdO1xyXG4gIC8vICBpZihjYXJkTW9kZXNbaW5kZXhzXS5wb2ludCA+PSAyMCl7XHJcbiAgLy8gICAgcmVzdWx0LnNwbGljZShxLDEpO1xyXG4gIC8vICB9XHJcbiAgLy99XHJcbiAgaWYocmVzdWx0Lmxlbmd0aCA8IDIgKXtcclxuICAgIGxldCB0aWVaaGlJbmRleHNBcnJheSA9IEtRQ2FyZC5maW5kVGllWmhpKGNhcmRNb2Rlcyk7XHJcbiAgICBpZih0aWVaaGlJbmRleHNBcnJheS5sZW5ndGggPiAwKXtcclxuICAgICAgdGllWmhpSW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcclxuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMV0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcclxuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMiA9IFtpbmRleHNbMF0sIGluZGV4c1sxXSwgaW5kZXhzWzNdXTtcclxuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMF0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcclxuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1syXV07XHJcbiAgICAgICAgcmVzdWx0LnB1c2goc2FuVGlhb0luZGV4czApO1xyXG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xyXG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czIpO1xyXG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czMpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHZhciB0cmVzdWx0ID0gS1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDMpO1xyXG4gICAgZm9yKHZhciBpID0gMDtpIDwgdHJlc3VsdC5sZW5ndGg7aSsrKXtcclxuICAgICAgcmVzdWx0LnB1c2godHJlc3VsdFtpXSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qaWYocmVzdWx0Lmxlbmd0aCA8IDEpe1xyXG4gICAgLy8g6ZOB5pSv5piv5YyF5ZCr5LiJ5p2h55qEXHJcbiAgICBsZXQgdGllWmhpSW5kZXhzQXJyYXkgPSBLUUNhcmQuZmluZFRpZVpoaShjYXJkTW9kZXMpO1xyXG4gICAgaWYgKHRpZVpoaUluZGV4c0FycmF5KSB7XHJcbiAgICAgIHRpZVpoaUluZGV4c0FycmF5LmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XHJcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czEgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1szXV07XHJcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czIgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1szXV07XHJcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czMgPSBbaW5kZXhzWzBdLCBpbmRleHNbMl0sIGluZGV4c1szXV07XHJcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xyXG4gICAgICAgIHJlc3VsdC5wdXNoKHNhblRpYW9JbmRleHMwKTtcclxuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMxKTtcclxuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMyKTtcclxuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMzKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSovXHJcblxyXG4gIC8vaWYocmVzdWx0Lmxlbmd0aCA+IDEwKXtcclxuICAvLyAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsMTApO1xyXG4gIC8vfVxyXG5cclxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7XHJcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XHJcbn07XHJcblxyXG4vLyDmib7lkIzoirHpobpcclxuLypLUUNhcmQuZmluZFRvbmdIdWFTaHVuID0gZnVuY3Rpb24gKGNhcmRNb2RlcywgbGVuZ3RoID0gNSkge1xyXG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG4gIGxldCByZXN1bHQgPSBbXTtcclxuICB2YXIgc2FuU2h1blppID0gS1FDYXJkLnNhblNodW5aaTEoY2FyZE1vZGVzLGxlbmd0aCk7XHJcbiAgaWYoc2FuU2h1blppWzBdID09IG51bGwpe1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBmb3IodmFyIGk9MDtpPHNhblNodW5aaVswXS5sZW5ndGg7aSsrKSB7XHJcbiAgICB2YXIgcyA9IHNhblNodW5aaVswXVtpXTtcclxuICAgIGlmIChLUUNhcmQuaXNUb25nSHVhU2h1bihzLCBsZW5ndGgpKSB7XHJcbiAgICAgIHJlc3VsdC51bnNoaWZ0KHNhblNodW5aaVsxXVtpXSk7XHJcblxyXG4gICAgfVxyXG4gIH1cclxuICBpZihyZXN1bHQubGVuZ3RoID4gMCl7XHJcbiAgICByZXR1cm4gcmVzdWx0XHJcbiAgfWVsc2V7XHJcbiAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bjEoY2FyZE1vZGVzKTtcclxuICB9XHJcbn07Ki9cclxuS1FDYXJkLmZpbmRUb25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkcywgbGVuZ3RoID0gNSkge1xyXG4gIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbiAgY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRzKTtcclxuICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXHJcbiAgdmFyIGNvbG9ySCA9IFtdOyAvL+e6ouW/g1xyXG4gIHZhciBjb2xvckMgPSBbXTsgLy/mooXoirFcclxuICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXHJcbiAgdmFyIHBvaW50UyA9IFtdOyAvL+m7keahg1xyXG4gIHZhciBwb2ludEggPSBbXTsgLy/nuqLlv4NcclxuICB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXHJcbiAgdmFyIHBvaW50RCA9IFtdOyAvL+aWueWdl1xyXG4gIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XHJcbiAgICBpZihjYXJkc1tpXS5jb2xvciA9PSAnNCcpe1xyXG4gICAgICBpZihwb2ludFMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xyXG4gICAgICAgIHBvaW50Uy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcclxuICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMycpe1xyXG4gICAgICBpZihwb2ludEguaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xyXG4gICAgICAgIHBvaW50SC5wdXNoKGNhcmRzW2ldLnBvaW50KTtcclxuICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgIH1cclxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcyJyl7XHJcbiAgICAgIGlmKHBvaW50Qy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XHJcbiAgICAgICAgcG9pbnRDLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xyXG4gICAgICAgIGNvbG9yQy5wdXNoKGNhcmRzW2ldKTtcclxuICAgICAgfVxyXG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzEnKXtcclxuICAgICAgaWYocG9pbnRELmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcclxuICAgICAgICBwb2ludEQucHVzaChjYXJkc1tpXS5wb2ludCk7XHJcbiAgICAgICAgY29sb3JELnB1c2goY2FyZHNbaV0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB2YXIgY29sb3IgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcclxuICB2YXIgY29sb3JTdW0gPSBbXTsgICAgLy/mgLvlhbHmnInlh6Dnp43oirHoibIgWzUsMywwLi4uLl1cclxuICBmb3IodmFyIGk9MDtpPGNvbG9yLmxlbmd0aDtpKyspe1xyXG4gICAgaWYoY29sb3JbaV0ubGVuZ3RoID49IDUpe1xyXG4gICAgICBjb2xvcltpXS5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcclxuICAgICAgICByZXR1cm4gYTEucG9pbnQgLSBhMi5wb2ludDtcclxuICAgICAgfSlcclxuICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHZhciByZXN1bHQgPSBbXTtcclxuICBmb3IodmFyIGk9MDtpPGNvbG9yU3VtLmxlbmd0aDtpKyspIHtcclxuICAgIHZhciBzID0gY29sb3JTdW1baV1cclxuICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgNSkgPD0gcy5sZW5ndGg7ICsrc3RhcnQpIHtcclxuICAgICAgdmFyIHN1YkNhcmRzID0gcy5zbGljZShzdGFydCwgc3RhcnQgKyA1KTtcclxuICAgICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHN1YkNhcmRzKSkge1xyXG4gICAgICAgIGxldCBpbmRleHMgPSBbXTtcclxuICAgICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhKSB7XHJcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkcy5sZW5ndGg7IHErKyl7XHJcbiAgICAgICAgICAgIHZhciByID0gY2FyZHNbcV07XHJcbiAgICAgICAgICAgIGlmKHIgPT09IGNhKXtcclxuICAgICAgICAgICAgICBpbmRleHMucHVzaChxKTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGluZGV4cy5zb3J0KEFycmF5LnNvcnRCeVBvaW50KTtcclxuICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBpZihyZXN1bHQubGVuZ3RoID4gMCl7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1lbHNle1xyXG4gICAgbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkcyk7XHJcbiAgICBpZiAoY2FyZHMgPT09IGNvbnZlcnRlZENhcmRzKSB7XHJcbiAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24oYWRmcyl7XHJcbiAgICAgICAgaWYoYWRmcy5wb2ludCA9PSAxNCl7XHJcbiAgICAgICAgICBhZGZzLnBvaW50ID0gMTtcclxuICAgICAgICAgIGFkZnMuc2NvcmVzID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAgIHJldHVybiBLUUNhcmQuZmluZFRvbmdIdWFTaHVuMjAoY2FyZHMpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4oY29udmVydGVkQ2FyZHMpO1xyXG4gIH1cclxuICAvL3JldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IG51bGw7XHJcbn07XHJcbktRQ2FyZC5maW5kVG9uZ0h1YVNodW4yMCA9IGZ1bmN0aW9uIChjYXJkLCBsZW5ndGggPSA1KSB7XHJcbiAgaWYgKGNhcmQubGVuZ3RoIDwgbGVuZ3RoKSB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmQpIHx8IFtdO1xyXG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG4gIHZhciBjYXJkcyA9IGNhcmQua3FfZXhjbHVkZXMoY2FyZDIwKTtcclxuXHJcbiAgY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRzKTtcclxuICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXHJcbiAgdmFyIGNvbG9ySCA9IFtdOyAvL+e6ouW/g1xyXG4gIHZhciBjb2xvckMgPSBbXTsgLy/mooXoirFcclxuICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXHJcbiAgdmFyIHBvaW50UyA9IFtdOyAvL+m7keahg1xyXG4gIHZhciBwb2ludEggPSBbXTsgLy/nuqLlv4NcclxuICB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXHJcbiAgdmFyIHBvaW50RCA9IFtdOyAvL+aWueWdl1xyXG4gIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XHJcbiAgICBpZihjYXJkc1tpXS5jb2xvciA9PSAnNCcpe1xyXG4gICAgICBpZihwb2ludFMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xyXG4gICAgICAgIHBvaW50Uy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcclxuICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMycpe1xyXG4gICAgICBpZihwb2ludEguaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xyXG4gICAgICAgIHBvaW50SC5wdXNoKGNhcmRzW2ldLnBvaW50KTtcclxuICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgIH1cclxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcyJyl7XHJcbiAgICAgIGlmKHBvaW50Qy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XHJcbiAgICAgICAgcG9pbnRDLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xyXG4gICAgICAgIGNvbG9yQy5wdXNoKGNhcmRzW2ldKTtcclxuICAgICAgfVxyXG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzEnKXtcclxuICAgICAgaWYocG9pbnRELmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcclxuICAgICAgICBwb2ludEQucHVzaChjYXJkc1tpXS5wb2ludCk7XHJcbiAgICAgICAgY29sb3JELnB1c2goY2FyZHNbaV0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB2YXIgY29sb3IgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcclxuICB2YXIgY29sb3JTdW0gPSBbXTsgICAgLy/mgLvlhbHmnInlh6Dnp43oirHoibIgWzUsMywwLi4uLl1cclxuICBmb3IodmFyIGk9MDtpPGNvbG9yLmxlbmd0aDtpKyspe1xyXG4gICAgaWYoY29sb3JbaV0ubGVuZ3RoID49IHBhcnNlSW50KDUgLSBjYXJkMjAubGVuZ3RoKSl7XHJcbiAgICAgIGNvbG9yW2ldLnNvcnQoZnVuY3Rpb24oYTEsYTIpe1xyXG4gICAgICAgIHJldHVybiBhMS5wb2ludCAtIGEyLnBvaW50O1xyXG4gICAgICB9KVxyXG4gICAgICBjb2xvclN1bS5wdXNoKGNvbG9yW2ldKTtcclxuICAgIH1cclxuICB9XHJcbiAgLy9jYy5sb2coY29sb3JTdW0pXHJcblxyXG4gIHZhciByZXN1bHQgPSBbXTtcclxuICBmb3IodmFyIGk9MDtpPGNvbG9yU3VtLmxlbmd0aDtpKyspIHtcclxuICAgIHZhciBzID0gY29sb3JTdW1baV1cclxuICAgIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XHJcbiAgICAgIHZhciBudW0gPSA1IC0gajtcclxuICAgICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IHMubGVuZ3RoOyArK3N0YXJ0KSB7XHJcbiAgICAgICAgdmFyIHN1YkNhcmRzID0gcy5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xyXG4gICAgICAgIHZhciBib29sID0gcGFyc2VJbnQoc3ViQ2FyZHNbbnVtLTFdWydzY29yZXMnXSkgLSBwYXJzZUludChzdWJDYXJkc1swXVsnc2NvcmVzJ10pIDwgNTtcclxuICAgICAgICBpZihib29sKXtcclxuICAgICAgICAgIGxldCBpbmRleHMgPSBbXTtcclxuICAgICAgICAgIHZhciBuZXdDYXJkMjAgPSBjYXJkMjAuc2xpY2UoMCxqKTtcclxuICAgICAgICAgIHN1YkNhcmRzID0gc3ViQ2FyZHMuY29uY2F0KG5ld0NhcmQyMCk7XHJcbiAgICAgICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhKSB7XHJcbiAgICAgICAgICAgIGZvcih2YXIgcSA9IDA7cSA8IGNhcmQubGVuZ3RoOyBxKyspe1xyXG4gICAgICAgICAgICAgIHZhciByID0gY2FyZFtxXTtcclxuICAgICAgICAgICAgICBpZihyID09PSBjYSl7XHJcbiAgICAgICAgICAgICAgICBpbmRleHMucHVzaChxKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgaW5kZXhzLnNvcnQoQXJyYXkuc29ydEJ5TnVtYmVyKTtcclxuXHJcbiAgICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgLy9jYy5sb2cocmVzdWx0KVxyXG4gIC8vY2MubG9nKCctLS0tLS0tLTM1NycpXHJcbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9ZWxzZXtcclxuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZCk7XHJcbiAgICBpZiAoY2FyZCA9PT0gY29udmVydGVkQ2FyZHMpIHtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4yMChjb252ZXJ0ZWRDYXJkcyk7XHJcbiAgfVxyXG4gIC8vcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogbnVsbDtcclxufTtcclxuXHJcbi8vIOaJvumTgeaUr1xyXG4vLyDlpoLvvJpbWzEsMiwzLDRdXVxyXG5LUUNhcmQuZmluZFRpZVpoaSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcclxuICB2YXIgcmVzdWx0ID0gIEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgNCk7XHJcbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcbiAgcmVzdWx0ID0gW107XHJcbiAgLy8g5LqU5ZCM5piv5YyF5ZCr6ZOB5pSv55qEXHJcbiAgbGV0IHd1VG9uZ0luZGV4c0FycmF5ID0gS1FDYXJkLmZpbmRXdVRvbmcoY2FyZE1vZGVzKTtcclxuICBpZiAod3VUb25nSW5kZXhzQXJyYXkpIHtcclxuICAgIHd1VG9uZ0luZGV4c0FycmF5LmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XHJcbiAgICAgIGxldCB0aWVaaGlJbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1szXV07XHJcbiAgICAgIGxldCB0aWVaaGlJbmRleHMxID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1s0XV07XHJcbiAgICAgIGxldCB0aWVaaGlJbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbM10sIGluZGV4c1s0XV07XHJcbiAgICAgIGxldCB0aWVaaGlJbmRleHMzID0gW2luZGV4c1swXSwgaW5kZXhzWzJdLCBpbmRleHNbM10sIGluZGV4c1s0XV07XHJcbiAgICAgIGxldCB0aWVaaGlJbmRleHM0ID0gW2luZGV4c1sxXSwgaW5kZXhzWzJdLCBpbmRleHNbM10sIGluZGV4c1s0XV07XHJcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czApO1xyXG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHMxKTtcclxuICAgICAgcmVzdWx0LnB1c2godGllWmhpSW5kZXhzMik7XHJcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czMpO1xyXG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHM0KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBpZihyZXN1bHQubGVuZ3RoID4gMTApe1xyXG4gICAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsMTApO1xyXG4gIH1cclxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7XHJcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogS1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDQpO1xyXG59O1xyXG4vL+aJvuS6lOWQjFxyXG5LUUNhcmQuZmluZFd1VG9uZyA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcclxuICBpZihjYXJkTW9kZXMubGVuZ3RoIDwgNSl7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG4gIHZhciByZXN1bHQgPSB0aGlzLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCA1KSB8fCBbXTtcclxuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsNSk7XHJcbn07XHJcbi8vIOaJvumhuuWtkFxyXG4vLyDlpoLvvJpbWzEsIDIsIDMsIDQsIDVdXVxyXG5LUUNhcmQuZmluZFNodW5aaSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsbGVuZ3RoID0gNSkge1xyXG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG4gIGlmKHR5cGVvZihjYXJkTW9kZXNbMF1bJ3BvaW50J10pPT1cInVuZGVmaW5lZFwiKXtcclxuICAgIGNhcmRNb2RlcyA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkTW9kZXMpO1xyXG4gIH1cclxuICAvLyDlhYjmoLnmja7ngrnmlbDljrvph41cclxuICBsZXQgdW5pcXVlQ2FyZHMgPSBjYXJkTW9kZXMudW5pcXVlKGZ1bmN0aW9uKGNhcmQxLCBjYXJkMikge1xyXG4gICAgcmV0dXJuIGNhcmQxLnBvaW50ID09IGNhcmQyLnBvaW50O1xyXG4gIH0pO1xyXG4gIHVuaXF1ZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KTtcclxuXHJcbiAgLy8g5aaC5p6c5pyJIEHvvIzliJnlnKjmnIDlkI7mt7vliqAgMTRcclxuICBsZXQgY2FyZEEgPSBjYXJkTW9kZXMuZmluZChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gMTtcclxuICB9KTtcclxuICBpZiAoY2FyZEEpIHtcclxuICAgIGxldCBjYXJkQVBsdXMgPSBuZXcgS1FDYXJkKGNhcmRBKTtcclxuICAgIGNhcmRBUGx1cy5wb2ludCA9IDE0O1xyXG4gICAgdW5pcXVlQ2FyZHMucHVzaChjYXJkQVBsdXMpO1xyXG4gIH1cclxuXHJcbiAgbGV0IHJlc3VsdCA9IFtdO1xyXG5cclxuICAvLyDnlLHkuo7ngrnmlbDmmK/llK/kuIDkuJTljYfluo/vvIzlj6rpnIDopoHkvp3mrKHpgY3ljobliKTmlq3mmK/lkKbmmK/pobrlrZDljbPlj69cclxuICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIGxlbmd0aCkgPD0gdW5pcXVlQ2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XHJcbiAgICBsZXQgc3ViQ2FyZHMgPSB1bmlxdWVDYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBsZW5ndGgpO1xyXG4gICAgaWYgKEtRQ2FyZC5pc1NodW5aaShzdWJDYXJkcywgbGVuZ3RoKSkge1xyXG4gICAgICBsZXQgaW5kZXhzID0gW107XHJcbiAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xyXG4gICAgICAgIGxldCBpbmRleCA9IGNhcmRNb2Rlcy5maW5kSW5kZXgoZnVuY3Rpb24gKG9yaWdpbkNhcmQpIHtcclxuXHJcbiAgICAgICAgICBpZiAoY2FyZC5wb2ludCA9PSAxNCkge1xyXG4gICAgICAgICAgICByZXR1cm4gb3JpZ2luQ2FyZC5wb2ludCA9PSAxO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHJldHVybiBjYXJkID09PSBvcmlnaW5DYXJkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGluZGV4cy5wdXNoKGluZGV4KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xyXG4gICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8g5aSE55CG54K55pWw6YeN5aSN55qE5oOF5Ya1XHJcbiAgLy8g5q+U5aaCIEEgQSBLIFEgSiAxMCDov5nnp40gXHJcbiAgbGV0IHJlcGVhdEluZGV4c0FycmF5ID0gS1FDYXJkLl9maW5kUmVwZWF0UG9pbnRJbmRleHNBcnJheShyZXN1bHQsIGNhcmRNb2Rlcyk7XHJcbiAgcmVwZWF0SW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcclxuICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XHJcbiAgfSk7XHJcblxyXG4gIHJlc3VsdC5zb3J0KGZ1bmN0aW9uIChhcnIxLCBhcnIyKSB7XHJcbiAgICByZXR1cm4gYXJyMVswXSAtIGFycjJbMF07XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IEtRQ2FyZC5maW5kU2h1blppMjAoY2FyZE1vZGVzKTtcclxufTtcclxuS1FDYXJkLmZpbmRTaHVuWmkyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMgLGxlbmd0aCA9IDUpIHtcclxuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkTW9kZXMpO1xyXG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG4gIHZhciBjYXJkcyA9IGNhcmRNb2Rlcy5rcV9leGNsdWRlcyhjYXJkMjApO1xyXG4gIC8vIOWFiOagueaNrueCueaVsOWOu+mHjVxyXG4gIHZhciBuZXdBcnIgPSBbXTtcclxuICB2YXIgbmV3QXJycyA9IFtdO1xyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspIHtcclxuICAgIGlmIChuZXdBcnJzLmluZGV4T2YoY2FyZHNbaV1bJ3BvaW50J10pID09IC0xKSB7XHJcbiAgICAgIG5ld0Fyci5wdXNoKGNhcmRzW2ldKTtcclxuICAgICAgbmV3QXJycy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5ld0Fyci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcclxuICAgIHJldHVybiBuMS5wb2ludCAtIG4yLnBvaW50O1xyXG4gIH0pO1xyXG4gIHZhciByZXN1bHQgPSBbXTtcclxuICBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xyXG4gICAgdmFyIG51bSA9IGxlbmd0aCAtIGo7XHJcbiAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gbmV3QXJyLmxlbmd0aDsgKytzdGFydCkge1xyXG4gICAgICB2YXIgc3ViQ2FyZHMgPSBuZXdBcnIuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcclxuICAgICAgdmFyIGJvb2wgPSBwYXJzZUludChzdWJDYXJkc1tudW0tMV1bJ3BvaW50J10pIC0gcGFyc2VJbnQoc3ViQ2FyZHNbMF1bJ3BvaW50J10pIDwgbGVuZ3RoO1xyXG4gICAgICBpZihib29sKXtcclxuICAgICAgICBsZXQgaW5kZXhzID0gW107XHJcbiAgICAgICAgdmFyIG5ld0NhcmQyMCA9IGNhcmQyMC5zbGljZSgwLGopO1xyXG4gICAgICAgIHN1YkNhcmRzID0gc3ViQ2FyZHMuY29uY2F0KG5ld0NhcmQyMCk7XHJcbiAgICAgICAgc3ViQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XHJcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkTW9kZXMubGVuZ3RoOyBxKyspe1xyXG4gICAgICAgICAgICB2YXIgciA9IGNhcmRNb2Rlc1txXTtcclxuICAgICAgICAgICAgaWYociA9PT0gY2FyZCl7XHJcbiAgICAgICAgICAgICAgaW5kZXhzLnB1c2gocSk7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGluZGV4cy5zb3J0KEFycmF5LnNvcnRCeU51bWJlcik7XHJcbiAgICAgICAgcmVzdWx0LnVuc2hpZnQoaW5kZXhzKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9ZWxzZXtcclxuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZE1vZGVzKTtcclxuICAgIGlmIChjYXJkTW9kZXMgPT09IGNvbnZlcnRlZENhcmRzKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiBLUUNhcmQuZmluZFNodW5aaTIwKGNvbnZlcnRlZENhcmRzKTtcclxuICB9XHJcbn07XHJcbktRQ2FyZC5fZmluZFJlcGVhdFBvaW50SW5kZXhzQXJyYXkgPSBmdW5jdGlvbihpbmRleHNBcnJheSwgb3JpZ2luQ2FyZHMpIHtcclxuICBsZXQgcmVwZWF0SW5kZXhzQXJyYXkgPSBbXTtcclxuICBpbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xyXG4gICAgbGV0IGNhcmRzID0gaW5kZXhzLm1hcChmdW5jdGlvbihpbmRleCkge1xyXG4gICAgICByZXR1cm4gb3JpZ2luQ2FyZHNbaW5kZXhdO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkLCBpbmRleCkge1xyXG4gICAgICBsZXQgb3JpZ2luSW5kZXggPSBvcmlnaW5DYXJkcy5maW5kSW5kZXgoZnVuY3Rpb24ob3JpZ2luQ2FyZCkge1xyXG4gICAgICAgIGlmKHR5cGVvZihjYXJkKSA9PSAndW5kZWZpbmVkJyl7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvcmlnaW5DYXJkICE9PSBjYXJkICYmIG9yaWdpbkNhcmQucG9pbnQgPT0gY2FyZC5wb2ludCkge1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAob3JpZ2luSW5kZXggPCAwKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgcmVwZWF0SW5kZXhzID0gaW5kZXhzLnNsaWNlKCk7XHJcbiAgICAgIHJlcGVhdEluZGV4c1tpbmRleF0gPSBvcmlnaW5JbmRleDtcclxuICAgICAgcmVwZWF0SW5kZXhzQXJyYXkucHVzaChyZXBlYXRJbmRleHMpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiByZXBlYXRJbmRleHNBcnJheTtcclxufTtcclxuXHJcbi8vIOaJvuWQjOiKsVxyXG4vLyDlpoLvvJpbWzEsIDIsIDMsIDQsIDVdXVxyXG5LUUNhcmQuZmluZFRvbmdIdWEgPSBmdW5jdGlvbiAoY2FyZE1vZGVzLCBsZW5ndGggPSA1KSB7XHJcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcblxyXG4gIGxldCBjYXJkcyA9IEFycmF5LmZyb20oY2FyZE1vZGVzKTtcclxuICBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlDb2xvcik7XHJcblxyXG4gIGxldCByZXN1bHQgPSBbXTtcclxuICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIGxlbmd0aCkgPD0gY2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XHJcbiAgICBsZXQgc3ViQ2FyZHMgPSBjYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBsZW5ndGgpO1xyXG4gICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWEoc3ViQ2FyZHMsIGxlbmd0aCkpIHtcclxuICAgICAgbGV0IGluZGV4cyA9IFtdO1xyXG4gICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcclxuICAgICAgICBsZXQgaW5kZXggPSBjYXJkTW9kZXMuZmluZEluZGV4KGZ1bmN0aW9uIChvcmlnaW5DYXJkKSB7XHJcbiAgICAgICAgICByZXR1cm4gY2FyZCA9PT0gb3JpZ2luQ2FyZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICAgIGluZGV4cy5wdXNoKGluZGV4KTtcclxuICAgICAgfSk7XHJcbiAgICAgIC8vaW5kZXhzID0gaW5kZXhzLmxlbmd0aCA+IDUgPyBpbmRleHMuc3BsaWNlKDEsMSkgOiBpbmRleHM7XHJcbiAgICAgIGluZGV4cy5zb3J0KEFycmF5LnNvcnRCeU51bWJlcik7XHJcbiAgICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IEtRQ2FyZC5maW5kVG9uZ0h1YTIwKGNhcmRNb2Rlcyk7XHJcbn07XHJcbktRQ2FyZC5maW5kVG9uZ0h1YTIwID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xyXG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgNSkge1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkTW9kZXMpO1xyXG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG4gIHZhciBjYXJkcyA9IGNhcmRNb2Rlcy5rcV9leGNsdWRlcyhjYXJkMjApO1xyXG4gIC8vIOWFiOagueaNrueCueaVsOWOu+mHjVxyXG4gIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcclxuXHJcbiAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XHJcbiAgICB2YXIgbnVtID0gNSAtIGo7XHJcbiAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gY2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XHJcbiAgICAgIHZhciBzdWJDYXJkcyA9IGNhcmRzLnNsaWNlKHN0YXJ0LCBzdGFydCArIG51bSk7XHJcbiAgICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBudW0pKSB7XHJcbiAgICAgICAgbGV0IGluZGV4cyA9IFtdO1xyXG4gICAgICAgIHZhciBuZXdDYXJkMjAgPSBjYXJkMjAuc2xpY2UoMCxqKTtcclxuICAgICAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLmNvbmNhdChuZXdDYXJkMjApO1xyXG4gICAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xyXG4gICAgICAgICAgZm9yKHZhciBxID0gMDtxIDwgY2FyZE1vZGVzLmxlbmd0aDsgcSsrKXtcclxuICAgICAgICAgICAgdmFyIHIgPSBjYXJkTW9kZXNbcV07XHJcbiAgICAgICAgICAgIGlmKHIgPT09IGNhcmQpe1xyXG4gICAgICAgICAgICAgIGluZGV4cy5wdXNoKHEpO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xyXG4gICAgICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IFtdO1xyXG59O1xyXG5cclxuS1FDYXJkLmZpbmRIdUx1ID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xyXG4gIGxldCBsZW5ndGggPSA1O1xyXG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG5cclxuXHJcbiAgdmFyIHBfMz1LUUNhcmQuZmluZFNhblRpYW8oY2FyZE1vZGVzKTtcclxuICB2YXIgcF80PUtRQ2FyZC5maW5kVGllWmhpKGNhcmRNb2Rlcyk7XHJcbiAgdmFyIHAyPUtRQ2FyZC5maW5kRHVpWmkoY2FyZE1vZGVzKSB8fCBbXTtcclxuICAvL3ZhciBwXzMgPSAgdGhpcy5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgMykgfHwgW107XHJcbiAgLy92YXIgcF80ID0gdGhpcy5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgNCkgfHwgW107XHJcbiAgLy92YXIgcDIgPSB0aGlzLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCAyKSB8fCBbXTtcclxuICBpZihwMi5sZW5ndGggPD0gMCl7XHJcbiAgICBpZiAocF8zKSB7XHJcbiAgICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xyXG4gICAgICAgIGxldCBzYW5UaWFvSW5kZXhzMCA9IFtpbmRleHNbMF0sIGluZGV4c1sxXV07XHJcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czEgPSBbaW5kZXhzWzBdLCBpbmRleHNbMl1dO1xyXG4gICAgICAgIGxldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMV0sIGluZGV4c1syXV07XHJcbiAgICAgICAgcDIucHVzaChzYW5UaWFvSW5kZXhzMCk7XHJcbiAgICAgICAgLy9wMi51bnNoaWZ0KHNhblRpYW9JbmRleHMxKTtcclxuICAgICAgICBwMi5wdXNoKHNhblRpYW9JbmRleHMzKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHBfNCkge1xyXG4gICAgICBwXzQuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcclxuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV1dO1xyXG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMxID0gW2luZGV4c1swXSwgaW5kZXhzWzJdXTtcclxuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMiA9IFtpbmRleHNbMF0sIGluZGV4c1szXV07XHJcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czMgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xyXG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHM0ID0gW2luZGV4c1sxXSwgaW5kZXhzWzNdXTtcclxuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czYgPSBbaW5kZXhzWzJdLCBpbmRleHNbM11dO1xyXG4gICAgICAgIHAyLnB1c2goc2FuVGlhb0luZGV4czApO1xyXG4gICAgICAgIC8vcDIudW5zaGlmdChzYW5UaWFvSW5kZXhzMSk7XHJcbiAgICAgICAgLy9wMi51bnNoaWZ0KHNhblRpYW9JbmRleHMyKTtcclxuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czMpO1xyXG4gICAgICAgIC8vcDIudW5zaGlmdChzYW5UaWFvSW5kZXhzNCk7XHJcbiAgICAgICAgcDIucHVzaChzYW5UaWFvSW5kZXhzNik7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG5cclxuICBpZiAoKHAyID09IG51bGwpIHx8IChwXzMgPT0gbnVsbCkpIHtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbiAgdmFyIHRyZXN1bHQ9W11cclxuICBwMi5mb3JFYWNoKGZ1bmN0aW9uIChpXzMpIHtcclxuICAgIHZhciBzPWlfMztcclxuICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uIChpXzIpIHtcclxuICAgICAgcyA9IGlfMy5jb25jYXQoaV8yKTtcclxuICAgICAgZm9yKHZhciBpID0wO2k8cy5sZW5ndGgtMTtpKyspe1xyXG4gICAgICAgIHZhciBpbmRleCA9IHNbaV07XHJcbiAgICAgICAgZm9yKHZhciBqID1pKzE7ajxzLmxlbmd0aDtqKyspe1xyXG4gICAgICAgICAgaWYoaW5kZXggPT0gc1tqXSkge1xyXG4gICAgICAgICAgICBzID0gbnVsbDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmKHMgIT09IG51bGwpe1xyXG4gICAgICAgIHRyZXN1bHQudW5zaGlmdChzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSk7XHJcbiAgaWYodHJlc3VsdC5sZW5ndGggPiAxMCl7XHJcbiAgICB0cmVzdWx0ID0gdHJlc3VsdC5zbGljZSgwLDEwKTtcclxuICB9XHJcbiAgcmV0dXJuIHRyZXN1bHQubGVuZ3RoID4gMCA/IHRyZXN1bHQgOiBLUUNhcmQuZmluZEh1THUyMChjYXJkTW9kZXMpO1xyXG59O1xyXG5LUUNhcmQuZmluZEh1THUyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcclxuICBsZXQgbGVuZ3RoID0gNTtcclxuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkTW9kZXMpIHx8IFtdO1xyXG4gIGlmKGNhcmQyMC5sZW5ndGggPD0gMCl7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG4gIHZhciBwXzM9S1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDMpO1xyXG4gIHZhciBwXzQ9S1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDQpO1xyXG4gIHZhciBwXzI9S1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDIpO1xyXG4gIGlmKHBfMj09bnVsbCl7XHJcbiAgICBwXzI9W107XHJcbiAgfVxyXG4gIGlmIChwXzMpIHtcclxuICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xyXG4gICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV1dO1xyXG4gICAgICBsZXQgc2FuVGlhb0luZGV4czMgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xyXG4gICAgICBwXzIudW5zaGlmdChzYW5UaWFvSW5kZXhzMCk7XHJcbiAgICAgIHBfMi51bnNoaWZ0KHNhblRpYW9JbmRleHMzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaWYgKHBfNCkge1xyXG4gICAgcF80LmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XHJcbiAgICAgIGxldCBzYW5UaWFvSW5kZXhzMCA9IFtpbmRleHNbMF0sIGluZGV4c1sxXV07XHJcbiAgICAgIGxldCBzYW5UaWFvSW5kZXhzNiA9IFtpbmRleHNbMl0sIGluZGV4c1szXV07XHJcbiAgICAgIHBfMi51bnNoaWZ0KHNhblRpYW9JbmRleHMwKTtcclxuICAgICAgcF8yLnVuc2hpZnQoc2FuVGlhb0luZGV4czYpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpZiAoKHBfMiA9PSBudWxsKSB8fCAocF8zID09IG51bGwpKSB7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG4gIHZhciB0cmVzdWx0PVtdXHJcbiAgcF8yLmZvckVhY2goZnVuY3Rpb24gKGlfMykge1xyXG4gICAgdmFyIHM9aV8zO1xyXG4gICAgcF8zLmZvckVhY2goZnVuY3Rpb24gKGlfMikge1xyXG4gICAgICBzID0gaV8zLmNvbmNhdChpXzIpO1xyXG4gICAgICBmb3IodmFyIGkgPTA7aTxzLmxlbmd0aC0xO2krKyl7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gc1tpXTtcclxuICAgICAgICBmb3IodmFyIGogPWkrMTtqPHMubGVuZ3RoO2orKyl7XHJcbiAgICAgICAgICBpZihpbmRleCA9PSBzW2pdKSB7XHJcbiAgICAgICAgICAgIHMgPSBudWxsO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocyA9PSBudWxsKSB7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYocyAhPT0gbnVsbCl7XHJcbiAgICAgICAgdHJlc3VsdC51bnNoaWZ0KHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuICBpZih0cmVzdWx0Lmxlbmd0aCA+IDEwKXtcclxuICAgIHRyZXN1bHQgPSB0cmVzdWx0LnNsaWNlKDAsMTApO1xyXG4gIH1cclxuICByZXR1cm4gdHJlc3VsdC5sZW5ndGggPiAwID8gdHJlc3VsdCA6IFtdO1xyXG59O1xyXG5cclxuS1FDYXJkLmZpbmRHdWlQYWkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzLG51bUJlciA9IDEpIHtcclxuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkTW9kZXMpLm1hcChmdW5jdGlvbihjYXJkKXsvL+W+l+WIsOmsvOeJjOeahOe0ouW8lVxyXG4gICAgZm9yKHZhciBxID0gMDtxIDwgY2FyZE1vZGVzLmxlbmd0aDsgcSsrKXtcclxuICAgICAgdmFyIHIgPSBjYXJkTW9kZXNbcV07XHJcbiAgICAgIGlmKHIgPT09IGNhcmQpe1xyXG4gICAgICAgIHJldHVybiBxO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgaWYoY2FyZDIwLmxlbmd0aCA8PSAwKXtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbiAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XHJcbiAgICB2YXIgbnVtID0gbnVtQmVyLWo7Ly/pmaTprLzniYzlpJYg5oiR5bqU6K+l5om+5aSa5bCR5byg54mM5Yy56YWNXHJcbiAgICB2YXIgaW5kZXhzID0gS1FDYXJkLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCBudW0pIHx8IFtdO1xyXG4gICAgZm9yKHZhciB0ID0gMDt0IDwgaW5kZXhzLmxlbmd0aDsgdCsrKSB7XHJcbiAgICAgIGlmKG51bUJlciA9PSAyKXsvL+aYr+WvueWtkOeahOaXtuWAmeaKiumsvOeJjOWSjOWNleW8oOWMuemFjemDveW+queOr+S4gOmBjVxyXG4gICAgICAgIGZvcih2YXIgbyA9IDA7byA8IGNhcmQyMC5sZW5ndGg7KytvKXtcclxuICAgICAgICAgIHZhciBzID0gaW5kZXhzW3RdLmNvbmNhdChjYXJkMjBbb10pO1xyXG4gICAgICAgICAgaWYocy5sZW5ndGggPT0gbnVtQmVyKXtcclxuICAgICAgICAgICAgcmVzdWx0LnB1c2gocyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICB2YXIgcyA9IGluZGV4c1t0XS5jb25jYXQoY2FyZDIwLnNsaWNlKDAsaikpOy8v5L6d5qyh55u45Yqg6ay854mM56ys5LiA5qyh5Yqg5LiA5bygIOmAkuWinlxyXG4gICAgICAgIGlmKHMubGVuZ3RoID09IG51bUJlcil7XHJcbiAgICAgICAgICByZXN1bHQucHVzaChzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDEwKXtcclxuICAgIHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLDEwKTtcclxuICB9XHJcbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpOy8v5Y676YeNXHJcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XHJcbn07XHJcblxyXG5LUUNhcmQucmVwZWF0ID0gZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gIGZvcih2YXIgaSA9MDtpPHJlc3VsdC5sZW5ndGg7aSsrKXtcclxuICAgIHZhciBpbmRleCA9IHJlc3VsdFtpXTtcclxuXHJcbiAgICB2YXIgbmV3QXl5ID0gW107XHJcbiAgICBmb3IodmFyIG8gPSAwO28gPCBpbmRleC5sZW5ndGg7bysrKXsvL+aciemHjeWkjeW5suaOieS9oFxyXG4gICAgICBpZihuZXdBeXkuaW5kZXhPZihpbmRleFtvXSkgPT0gLTEpe1xyXG4gICAgICAgIG5ld0F5eS5wdXNoKGluZGV4W29dKTtcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgcmVzdWx0LnNwbGljZShpLDEpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZm9yKHZhciBqID1pKzE7ajxyZXN1bHQubGVuZ3RoLTE7aisrKXtcclxuICAgICAgdmFyIHMgPSByZXN1bHRbal07XHJcbiAgICAgIHZhciBqU3RyaW5nID0gJyc7XHJcbiAgICAgIHZhciBpU3RyaW5nID0gJyc7XHJcbiAgICAgIGZvcih2YXIgciA9IDA7ciA8IHMubGVuZ3RoO3IrKyl7XHJcbiAgICAgICAgICBqU3RyaW5nID0galN0cmluZyArIHNbcl07XHJcbiAgICAgICAgICBpU3RyaW5nID0gaVN0cmluZyArIGluZGV4W3JdO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKGpTdHJpbmcgPT0gaVN0cmluZyl7Ly/mnInph43lpI3lubLmjonkvaBcclxuICAgICAgICByZXN1bHQuc3BsaWNlKGksMSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfVxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn07XHJcblxyXG5cclxuS1FDYXJkLnRlc3RGaW5kID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xyXG4gIHZhciBXdVRvbmcgPSBLUUNhcmQuZmluZFd1VG9uZyhjYXJkTW9kZXMpIHx8IFtdO1xyXG4gIHZhciBUb25nSHVhU2h1biA9IEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4oY2FyZE1vZGVzKSB8fCBbXTtcclxuICB2YXIgVGllWmhpID0gS1FDYXJkLmZpbmRUaWVaaGkoY2FyZE1vZGVzKSB8fCBbXTtcclxuICB2YXIgSHVMdSA9IEtRQ2FyZC5maW5kSHVMdShjYXJkTW9kZXMpIHx8IFtdO1xyXG4gIHZhciBUb25nSHVhID0gS1FDYXJkLmZpbmRUb25nSHVhKGNhcmRNb2RlcykgfHwgW107XHJcbiAgdmFyIFNodW5aaSA9IEtRQ2FyZC5maW5kU2h1blppKGNhcmRNb2RlcykgfHwgW107XHJcbiAgdmFyIFNhblRpYW8gPSBLUUNhcmQuZmluZFNhblRpYW8oY2FyZE1vZGVzKSB8fCBbXTtcclxuICB2YXIgTGlhRHVpID0gS1FDYXJkLmZpbmRMaWFEdWkoY2FyZE1vZGVzKSB8fCBbXTtcclxuICB2YXIgRHVpWmkgPSBLUUNhcmQuZmluZER1aVppKGNhcmRNb2RlcykgfHwgW107XHJcbiAgdmFyIHJlc3VsdCA9IFtcclxuICAgIFd1VG9uZyxcclxuICAgIFRvbmdIdWFTaHVuLFxyXG4gICAgVGllWmhpLFxyXG4gICAgSHVMdSxcclxuICAgIFRvbmdIdWEsXHJcbiAgICBTaHVuWmksXHJcbiAgICBTYW5UaWFvLFxyXG4gICAgTGlhRHVpLFxyXG4gICAgRHVpWmksXHJcbiAgXVxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn07XHJcbiIsIi8vIOeJjOeCueaVsOW4ruWKqeexu1xyXG4vLyDnlKjmnaXorqHnrpfkuIDkuKrniYzmlbDnu4TlhoXnmoTnm7jlkIzngrnmlbDnmoTniYznmoTlvKDmlbBcclxudmFyIEtRQ2FyZFBvaW50c0hlbHBlciA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdGhpcy5wb2ludE51bWJlcnMgPSB7fTtcclxuICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICBsZXQgcG9pbnQgPSBjYXJkLnBvaW50O1xyXG4gICAgICAgIHZhciBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twb2ludF0gfHwgMDtcclxuICAgICAgICB0aGlzLnBvaW50TnVtYmVyc1twb2ludF0gPSBudW1iZXIgKyAxO1xyXG4gICAgfS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8vIOebuOWQjOeCueaVsOeJjOeahOacgOWkp+aVsOmHj1xyXG5LUUNhcmRQb2ludHNIZWxwZXIucHJvdG90eXBlLm1heE51bWJlciA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgcmVzdWx0ID0gMDtcclxuICBmb3IgKGxldCBwcm9wIGluIHRoaXMucG9pbnROdW1iZXJzKSB7XHJcbiAgICBsZXQgbnVtYmVyID0gdGhpcy5wb2ludE51bWJlcnNbcHJvcF07XHJcbiAgICAgIC8vaWYobnVtYmVyIDwgMjApe1xyXG4gICAgICAgICAgcmVzdWx0ID0gTWF0aC5tYXgobnVtYmVyLCByZXN1bHQpO1xyXG4gICAgICAvL31cclxuICB9XHJcblxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn07XHJcblxyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gS1FDYXJkUG9pbnRzSGVscGVyO1xyXG5cclxuLyp2YXIgY2FyZHMgPSBbXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEwfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTJ9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjE0fVxyXG5dO1xyXG52YXIgdGVzdCA9IG5ldyBLUUNhcmRQb2ludHNTYW1lKGNhcmRzKTtcclxuY29uc29sZS5sb2codGVzdCk7Ki9cclxuIiwibGV0IEhlbHBlciA9IHtcclxuICBsb2FkQ2FyZFNwcml0ZUZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XHJcbiAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKGNhcmROYW1lLCBjYWxsYmFjayk7XHJcbiAgfSxcclxuXHJcbiAgc2V0Q2FyZFNwcml0ZUZyYW1lOiBmdW5jdGlvbiAoc3ByaXRlLCBjYXJkTmFtZSkge1xyXG4gICAgdGhpcy5sb2FkQ2FyZFNwcml0ZUZyYW1lKGNhcmROYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcclxuICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBfY2FyZEZ1bGxOYW1lOiBmdW5jdGlvbiAoY2FyZFNob3J0TmFtZSkge1xyXG4gICAgdmFyIGNhcmROYW1lID0gY2FyZFNob3J0TmFtZTtcclxuICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChcInB1YmxpYy1waWMtY2FyZC1wb2tlclwiKSkge1xyXG4gICAgICBjYXJkTmFtZSA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGNhcmROYW1lO1xyXG4gIH0sXHJcblxyXG4gIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XHJcbiAgICBjYy5hc3NlcnQoY2FsbGJhY2spO1xyXG5cclxuICAgIGNjLmxvYWRlci5sb2FkUmVzKFwicGxheS9DYXJkVHlwZUNvbWJpbmUvcG9ja0xpc3RcIiwgY2MuU3ByaXRlQXRsYXMsIGZ1bmN0aW9uIChlcnIsIGF0bGFzKSB7XHJcbiAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCBlcnIpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjYXJkTmFtZSA9IHRoaXMuX2NhcmRGdWxsTmFtZShjYXJkTmFtZSk7XHJcbiAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcclxuICAgICAgY2FsbGJhY2soZnJhbWUpO1xyXG4gICAgfS5iaW5kKHRoaXMpKTtcclxuICB9LFxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBIZWxwZXI7XHJcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xyXG5jb25zdCBLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uJyk7XHJcbmNvbnN0IEtRQ2FyZENvbG9yc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZENvbG9yc0hlbHBlcicpO1xyXG5jb25zdCBLUUNhcmRTY29yZXRzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkU2NvcmV0c0hlbHBlcicpO1xyXG5jb25zdCBHZXRDYXJkUG9pbnRzU2FtZUNvdW50ID0gcmVxdWlyZSgnR2V0Q2FyZFBvaW50c1NhbWVDb3VudCcpO1xyXG5jb25zdCBLUUNhcmRQb2ludHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRQb2ludHNIZWxwZXInKTtcclxuXHJcbktRQ2FyZC5zY29yZU9mQ2FyZHMgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICBpZihjYXJkcyA9PSBudWxsIHx8IGNhcmRzLmxlbmd0aCA9PSBudWxsKSB7XHJcbiAgICBjYXJkcyA9IFtdO1xyXG4gIH1cclxuXHJcbiAgdmFyIGlzVG91ID0gY2FyZHMubGVuZ3RoID09IDM7XHJcbiAgbGV0IHR5cGVTY29yZSA9IEtRQ2FyZC5fdHlwZVNjb3JlT2ZDYXJkcyhjYXJkcyk7XHJcbiAgdmFyIGNhbGVDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQShjYXJkcy5zbGljZSgpKTtcclxuICBjYWxlQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcclxuICAgIGlmKGNhcmQuc2NvcmVzID09IDEpe1xyXG4gICAgICBjYXJkLnNjb3JlcyA9IDE0O1xyXG4gICAgfVxyXG4gIH0pXHJcbiAgLy9jYWxlQ2FyZHMgPSBLUUNhcmQuU29ydChjYWxlQ2FyZHMpO1xyXG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhbGVDYXJkcyk7XHJcbiAgdmFyIHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFNjb3JldHNIZWxwZXIoY2FsZUNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCkpO1xyXG4gIHZhciBtYXhOdW0gPSBwb2ludEhlbHBlci5tYXhOdW1iZXIoKS8qLWNhcmQyMC5sZW5ndGggPT0gMCA/IDE6IHBvaW50SGVscGVyLm1heE51bWJlcigpLWNhcmQyMC5sZW5ndGgqLztcclxuXHJcbiAgdmFyIG1heFNjb3JlID0gMDsvL+iOt+WPlumZpOmsvOeJjOWkluacgOWkp+eahOeahOeCueaVsFxyXG4gIGZvcih2YXIgaSBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuICAgIGlmIChwYXJzZUludChpKSA+IG1heFNjb3JlICYmIHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tpXSA9PSBtYXhOdW0pIHtcclxuICAgICAgbWF4U2NvcmUgPSBwYXJzZUludChpKTtcclxuICAgIH1cclxuICB9XHJcbiAgY2FsZUNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XHJcbiAgICBpZihjYXJkLnNjb3JlcyA+PSAyMCl7XHJcbiAgICAgIGNhcmQuc2NvcmVzID0gbWF4U2NvcmU7XHJcbiAgICB9XHJcbiAgfSlcclxuICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcclxuICAgIGNhcmQuc2NvcmVzID0gbWF4U2NvcmU7XHJcbiAgfSlcclxuICAvL2NjLmxvZyhtYXhOdW0pXHJcbiAgLy9jYy5sb2cobWF4U2NvcmUpXHJcbiAgLy9jYy5sb2coY2FsZUNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCkpXHJcbiAgLy9jYy5sb2coJy0tLS0zNScpXHJcbiAgY2FsZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnQpO1xyXG4gIGlmKHR5cGVTY29yZSA9PSA5MDAwMDAwMDAwMDAwMDAwKXtcclxuICAgIC8v5LqU5ZCMXHJcbiAgICBjYWxlQ2FyZHMuc29ydChmdW5jdGlvbihhMSxhMil7XHJcbiAgICAgIHJldHVybiBhMi5zY29yZXMgLSBhMS5zY29yZXM7XHJcbiAgICB9KTtcclxuICAgIHZhciB0b3RhbFZhbHVlID0gXCJcIjtcclxuICAgIC8vdmFyIHRvdGFsQ29sb3IgPSBcIlwiO1xyXG4gICAgZm9yKHZhciBpIGluIGNhbGVDYXJkcykge1xyXG4gICAgICB2YXIgcyA9IGNhbGVDYXJkc1tpXS5zY29yZXM7XHJcbiAgICAgIC8vdmFyIGMgPSBjYWxlQ2FyZHNbaV0uY29sb3I7XHJcbiAgICAgIHRvdGFsVmFsdWUgPSAocGFyc2VJbnQocykgPj0gMTAgPyBzIDogXCIwXCIrcykrdG90YWxWYWx1ZTtcclxuICAgICAgLy90b3RhbENvbG9yID0gYyt0b3RhbENvbG9yO1xyXG4gICAgfVxyXG4gICAgLy90b3RhbFZhbHVlID0gdG90YWxWYWx1ZSt0b3RhbENvbG9yO1xyXG4gICAgLy9jYy5sb2codG90YWxWYWx1ZSlcclxuICAgIC8vY2MubG9nKHBhcnNlSW50KHRvdGFsVmFsdWUpKVxyXG4gICAgLy9jYy5sb2codHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpKVxyXG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlKTtcclxuICB9XHJcbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gODAwMDAwMDAwMDAwMDAwMCkge1xyXG4gICAgLy/lkIzoirHpobrmr5TmnIDlpKfnmoTpgqPlvKDvvIzlpoLmnpzkuKTlvKDnm7jlkIzpgqPlsLHmmK/nm7jlkIxcclxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKXsvL+aciemsvOeJjOeahOaXtuWAmeimgeaUueWPmOmsvOeJjOeahOWIhuaVsFxyXG4gICAgICBjYWxlQ2FyZHMgPSBLUUNhcmQuX2NoYW5nZUNhcmRTY29ycyhjYWxlQ2FyZHMpO1xyXG4gICAgfVxyXG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xyXG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXHJcbiAgICBmb3IodmFyIGkgaW4gY2FsZUNhcmRzKSB7XHJcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcclxuICAgICAgdG90YWxWYWx1ZSA9IChwYXJzZUludChzKSA+PSAxMCA/IHMgOiBcIjBcIitzKSt0b3RhbFZhbHVlO1xyXG4gICAgICB2YXIgYyA9IGNhbGVDYXJkc1tpXS5jb2xvcjsvL+eJjOiJslxyXG4gICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcclxuICAgIH1cclxuICAgIGlmKGNjLmh1YVNlID09IDApIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxWYWx1ZSk7XHJcbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUgKyB2YWx1ZUNvbG9yKTtcclxuICB9XHJcbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gNzAwMDAwMDAwMDAwMDAwMCkge1xyXG4gICAgLy/pk4HmlK8s5om+5Ye66YKj5Zub5byg5piv5LuA5LmI54mMXHJcblxyXG4gICAgdmFyIHN0ciA9IFwiXCI7XHJcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xyXG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXHJcbiAgICB2YXIgb25lVmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcclxuICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHtcclxuICAgICAgaWYobWF4U2NvcmUgPT0gY2FsZUNhcmRzW3ddLnNjb3Jlcyl7Ly/kuInmnaFcclxuICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XHJcbiAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xyXG5cclxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxyXG4gICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XHJcbiAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcclxuXHJcbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcclxuICAgICAgICBvbmVWYWx1ZUNvbG9yID0gYyArIG9uZVZhbHVlQ29sb3I7Ly/niYzoibJcclxuXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xyXG4gICAgLy92YXIgcXdlID0gJyc7XHJcbiAgICAvL3F3ZSA9IG9uZVZhbHVlQ29sb3Iuc3Vic3RyKDAsb25lVmFsdWVDb2xvci5sZW5ndGggLTEpO1xyXG4gICAgLy9vbmVWYWx1ZUNvbG9yID0gb25lVmFsdWVDb2xvci5zdWJzdHIob25lVmFsdWVDb2xvci5sZW5ndGggLTEpO1xyXG4gICAgLy9zdHIgPSBzdHIrb25lVmFsdWUgKyBvbmVWYWx1ZUNvbG9yICsgdmFsdWVDb2xvciArIHF3ZTtcclxuICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xyXG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xyXG4gIH1cclxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA2MDAwMDAwMDAwMDAwMDAwKSB7XHJcbiAgICAvL+iRq+iKplxyXG4gICAgdmFyIHN0ciA9IFwiXCI7XHJcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xyXG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXHJcbiAgICB2YXIgb25lVmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcclxuICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHtcclxuICAgICAgaWYobWF4U2NvcmUgPT0gY2FsZUNhcmRzW3ddLnNjb3Jlcyl7Ly/kuInmnaFcclxuICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XHJcbiAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xyXG5cclxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxyXG4gICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XHJcbiAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcclxuXHJcbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcclxuICAgICAgICBvbmVWYWx1ZUNvbG9yID0gYyArIG9uZVZhbHVlQ29sb3I7Ly/niYzoibJcclxuXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZihpc1RvdSl7XHJcbiAgICAgIG9uZVZhbHVlID0gb25lVmFsdWUrJzAwMDAnO1xyXG4gICAgICBvbmVWYWx1ZUNvbG9yID0gb25lVmFsdWVDb2xvcisnMDAnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xyXG4gICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0citvbmVWYWx1ZSk7XHJcbiAgICAvL3N0ciA9IHN0citvbmVWYWx1ZSArIHZhbHVlQ29sb3IgKyBvbmVWYWx1ZUNvbG9yO1xyXG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XHJcblxyXG4gIH1cclxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA1MDAwMDAwMDAwMDAwMDAwKSB7XHJcbiAgICAvL+WQjOiKsSzmnInlj6/og73pnIDopoHmr5Q15byg54mMXHJcbiAgICB2YXIgdG90YWxTY29yZSA9IFwiXCI7XHJcbiAgICB2YXIgdG90YWxDb2xvciA9IFwiXCI7XHJcbiAgICAvL3ZhciBjb2xvcnMgPSAwOy8v6I635Y+W54mM55qE57G75Z6L6aKc6ImyXHJcbiAgICAvL2Zvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcclxuICAgIC8vICBpZihwYXJzZUludChjYWxlQ2FyZHNbaV0ucG9pbnQpIDwgMjApe1xyXG4gICAgLy8gICAgY29sb3JzID0gcGFyc2VJbnQoY2FsZUNhcmRzW2ldLmNvbG9yKTtcclxuICAgIC8vICAgIGJyZWFrO1xyXG4gICAgLy8gIH1cclxuICAgIC8vfVxyXG5cclxuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcclxuICAgICAgdmFyIHBhaVBvaW50ID0gcGFyc2VJbnQoY2FsZUNhcmRzW2ldLnBvaW50KTtcclxuICAgICAgdmFyIGNvbG9ycyA9IHBhcnNlSW50KGNhbGVDYXJkc1tpXS5wb2ludCkgPCAyMCA/IGNhbGVDYXJkc1tpXS5jb2xvcjogNTtcclxuICAgICAgdG90YWxDb2xvciA9IGNvbG9ycyArIHRvdGFsQ29sb3I7XHJcbiAgICAgIHRvdGFsU2NvcmUgPSAocGFpUG9pbnQ+PTEwID8gcGFpUG9pbnQgOiBcIjBcIitwYWlQb2ludCkrdG90YWxTY29yZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxTY29yZSk7XHJcbiAgICAvL2lmKGNjLmh1YVNlID09IDApIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxTY29yZSk7XHJcbiAgICAvL3JldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxTY29yZSt0b3RhbENvbG9yKTtcclxuICB9XHJcbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gNDAwMDAwMDAwMDAwMDAwMCkge1xyXG4gICAgLy/pobrlrZBcclxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKXsvL+aciemsvOeJjOeahOaXtuWAmeimgeaUueWPmOmsvOeJjOeahOWIhuaVsFxyXG4gICAgICBjYWxlQ2FyZHMgPSBLUUNhcmQuX2NoYW5nZUNhcmRTY29ycyhjYWxlQ2FyZHMpO1xyXG4gICAgfVxyXG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xyXG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXHJcbiAgICBmb3IodmFyIGkgaW4gY2FsZUNhcmRzKSB7XHJcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcclxuICAgICAgdG90YWxWYWx1ZSA9IChwYXJzZUludChzKSA+PSAxMCA/IHMgOiBcIjBcIitzKSt0b3RhbFZhbHVlO1xyXG5cclxuICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbaV0uY29sb3I7Ly/niYzoibJcclxuICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yOy8v54mM6ImyXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpO1xyXG4gICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpO1xyXG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUgKyB2YWx1ZUNvbG9yKTtcclxuICB9XHJcbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gMzAwMDAwMDAwMDAwMDAwMCkge1xyXG4gICAgLy/kuInmnaHvvIzmib7lh7rmmK/lk6rlvKDniYzmnIkz5bygXHJcbiAgICAvL2NhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcclxuICAgIHZhciBzdHIgPSBcIlwiO1xyXG4gICAgdmFyIG9uZVZhbHVlID0gXCJcIjtcclxuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXHJcbiAgICB2YXIgb25lVmFsdWVDb2xvcjIwID0gXCJcIjsvL+eJjOiJslxyXG4gICAgZm9yKHZhciB3IGluIGNhbGVDYXJkcykge1xyXG4gICAgICBpZihtYXhTY29yZSA9PSBjYWxlQ2FyZHNbd10uc2NvcmVzKXsvL+S4ieadoVxyXG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcclxuICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XHJcblxyXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXHJcbiAgICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yOy8v54mM6ImyXHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcclxuICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xyXG5cclxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxyXG4gICAgICAgIGlmKHBhcnNlSW50KHMpIDwgMjApe1xyXG4gICAgICAgICAgb25lVmFsdWVDb2xvciA9IGMgKyBvbmVWYWx1ZUNvbG9yOy8v54mM6ImyXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICBvbmVWYWx1ZUNvbG9yMjAgPSBjICsgb25lVmFsdWVDb2xvcjIwOy8v54mM6ImyXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZihpc1RvdSl7XHJcbiAgICAgIG9uZVZhbHVlID0gb25lVmFsdWUrJzAwMDAnO1xyXG4gICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcisnMDAnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xyXG4gICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0citvbmVWYWx1ZSk7XHJcbiAgICAvL3N0ciA9IHN0citvbmVWYWx1ZSArIG9uZVZhbHVlQ29sb3IgKyB2YWx1ZUNvbG9yICsgb25lVmFsdWVDb2xvcjIwO1xyXG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XHJcblxyXG4gIH1cclxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSAyMDAwMDAwMDAwMDAwMDAwKSB7XHJcbiAgICAvL2NhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcclxuICAgIC8v5Lik5a+5LOacieWPr+iDvemcgOimgeavlDXlvKDniYxcclxuICAgIHZhciBzdHIgPSBcIlwiO1xyXG4gICAgdmFyIG9uZVZhbHVlID0gJyc7XHJcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcclxuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxyXG4gICAgZm9yKHZhciBpIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xyXG4gICAgICBpZihwb2ludEhlbHBlci5wb2ludE51bWJlcnNbaV0gPT0gMikgey8v5Lik5a+5XHJcbiAgICAgICAgZm9yKHZhciB3IGluIGNhbGVDYXJkcykge1xyXG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbd10uc2NvcmVzKXtcclxuICAgICAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xyXG4gICAgICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XHJcbiAgICAgICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXHJcbiAgICAgICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxyXG5cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgZm9yKHZhciBxIGluIGNhbGVDYXJkcykgey8v5Y2V5byg5Yqg6Iqx6ImyXHJcbiAgICAgICAgICBpZihpID09IGNhbGVDYXJkc1txXS5zY29yZXMpe1xyXG4gICAgICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1txXS5zY29yZXM7XHJcbiAgICAgICAgICAgIG9uZVZhbHVlID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgb25lVmFsdWU7XHJcblxyXG4gICAgICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1txXS5jb2xvcjsvL+eJjOiJslxyXG4gICAgICAgICAgICBvbmVWYWx1ZUNvbG9yID0gb25lVmFsdWVDb2xvciArIGM7Ly/niYzoibJcclxuXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcclxuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xyXG4gICAgLy8vL2NjLmxvZyhzdHIpXHJcbiAgICAvLy8vY2MubG9nKG9uZVZhbHVlKVxyXG4gICAgLy9zdHIgPSBzdHIrb25lVmFsdWUgK29uZVZhbHVlQ29sb3IgKyB2YWx1ZUNvbG9yO1xyXG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XHJcbiAgfVxyXG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDEwMDAwMDAwMDAwMDAwMDApIHtcclxuICAgIC8v5a+55a2QXHJcbiAgICAvL2NhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcclxuICAgIHZhciBzdHIgPSBcIlwiO1xyXG4gICAgdmFyIG9uZVZhbHVlID0gXCJcIjtcclxuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjtcclxuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjtcclxuXHJcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCl7XHJcbiAgICAgIGNhbGVDYXJkcy5zb3J0KGZ1bmN0aW9uKGNhcmQxLGNhcmQyKSB7XHJcbiAgICAgICAgcmV0dXJuIGNhcmQyLnBvaW50LWNhcmQxLnBvaW50O1xyXG4gICAgICB9KTtcclxuICAgICAgY2FsZUNhcmRzID0gY2FsZUNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XHJcbiAgICAgIGNhbGVDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQsaW5kZXgpIHtcclxuICAgICAgICB2YXIgcyA9IGNhcmQuc2NvcmVzO1xyXG4gICAgICAgIHZhciBjID0gY2FyZC5jb2xvcjtcclxuICAgICAgICBzdHIgPSBzdHIrKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpO1xyXG4gICAgICAgIGlmKGluZGV4ID09IDApe1xyXG4gICAgICAgICAgdmFyIHMyMCA9IGNhcmQyMFswXS5zY29yZXM7XHJcbiAgICAgICAgICBzdHIgPSBzdHIrKHBhcnNlSW50KHMyMCk+PTEwID8gczIwIDpcIjBcIitzMjApO1xyXG4gICAgICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrYztcclxuICAgICAgICAgIHZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yK2NhcmQyMFswXS5jb2xvcjtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgIG9uZVZhbHVlQ29sb3IgPSBvbmVWYWx1ZUNvbG9yK2M7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgLy9jYy5sb2coc3RyKVxyXG4gICAgICAvL2NjLmxvZygnLS0tLS0tLS0yNzQnKVxyXG4gICAgICBpZihpc1RvdSl7XHJcbiAgICAgICAgc3RyID0gc3RyKycwMDAwJztcclxuICAgICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcisnMDAnO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcclxuICAgICAgLy9pZihjYy5odWFTZSA9PSAwKSByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XHJcbiAgICAgIC8vc3RyID0gc3RyICsgb25lVmFsdWVDb2xvciArIHZhbHVlQ29sb3I7XHJcbiAgICAgIC8vcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xyXG4gICAgfVxyXG5cclxuICAgIGZvcih2YXIgaSBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuICAgICAgaWYocG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW2ldID09IG1heE51bSkgey8v5a+55a2QXHJcbiAgICAgICAgZm9yKHZhciB3IGluIGNhbGVDYXJkcykgey8v5a+55a2Q5Yqg6Iqx6ImyXHJcbiAgICAgICAgICBpZihpID09IGNhbGVDYXJkc1t3XS5zY29yZXMpe1xyXG4gICAgICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XHJcbiAgICAgICAgICAgIHZhbHVlQ29sb3IgPSBjYWxlQ2FyZHNbd10uY29sb3IgKyB2YWx1ZUNvbG9yO1xyXG4gICAgICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGZvcih2YXIgcSBpbiBjYWxlQ2FyZHMpIHsvL+WNleW8oOWKoOiKseiJslxyXG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbcV0uc2NvcmVzKXtcclxuICAgICAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbcV0uc2NvcmVzO1xyXG4gICAgICAgICAgICBvbmVWYWx1ZUNvbG9yID0gY2FsZUNhcmRzW3FdLmNvbG9yICsgb25lVmFsdWVDb2xvcjtcclxuICAgICAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgaWYoaXNUb3Upe1xyXG4gICAgICBvbmVWYWx1ZSA9IG9uZVZhbHVlKycwMDAwJztcclxuICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrJzAwJztcclxuICAgIH1cclxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyK29uZVZhbHVlKTtcclxuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIrb25lVmFsdWUpO1xyXG4gICAgLy9zdHIgPSBzdHIrb25lVmFsdWUrb25lVmFsdWVDb2xvcit2YWx1ZUNvbG9yO1xyXG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XHJcbiAgfVxyXG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDApIHtcclxuICAgIC8v5LmM6b6ZXHJcbiAgICB2YXIgdmFsdWVQb2ludCA9IFwiXCI7XHJcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7XHJcbiAgICBmb3IodmFyIHEgaW4gY2FsZUNhcmRzKSB7XHJcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW3FdLnNjb3JlcztcclxuICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbcV0uY29sb3I7Ly/ljZXlvKDliqDoirHoibJcclxuICAgICAgdmFsdWVQb2ludCA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIHZhbHVlUG9pbnQ7XHJcbiAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjtcclxuICAgIH1cclxuICAgIGlmKGlzVG91KXtcclxuICAgICAgdmFsdWVQb2ludCA9IHZhbHVlUG9pbnQrJzAwMDAnO1xyXG4gICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcisnMDAnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh2YWx1ZVBvaW50KTtcclxuICAgIC8vaWYoY2MuaHVhU2UgPT0gMCkgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh2YWx1ZVBvaW50KTtcclxuICAgIC8vdmFsdWVQb2ludCA9IHZhbHVlUG9pbnQgKyB2YWx1ZUNvbG9yO1xyXG4gICAgLy9yZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHZhbHVlUG9pbnQpO1xyXG4gIH1cclxuXHJcblxyXG4gIHZhciBjYXJkc1RvdGFsUG9pbnQ9MDtcclxuICBjYWxlQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XHJcbiAgICBjYXJkc1RvdGFsUG9pbnQgKz0gY2FyZC5wb2ludDtcclxuICB9KTtcclxuXHJcbiAgbGV0IHJlc3VsdCA9IHR5cGVTY29yZSArIGNhcmRzVG90YWxQb2ludDtcclxuICByZXR1cm4gcmVzdWx0O1xyXG59O1xyXG5LUUNhcmQuX2NoYW5nZUNhcmRTY29ycyA9IGZ1bmN0aW9uKGNhcmRNb2RlbCkge1xyXG4gIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcclxuICAgIGNhcmQuc2NvcmVzID0gY2FyZC5wb2ludDtcclxuICAgIGlmIChjYXJkLnNjb3JlcyA9PSAxKSB7XHJcbiAgICAgIGNhcmQuc2NvcmVzID0gMTQ7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHZhciBpczE0ID0gdHJ1ZTsvL+aYryBrIHEgaiAxMCBBO1xyXG4gIHZhciBpczEgPSB0cnVlOy8v5pivMSAyIDMgNCA1XHJcblxyXG4gIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcclxuICAgIGlmIChjYXJkLnNjb3JlcyA8IDEwKSB7XHJcbiAgICAgIGlzMTQgPSBmYWxzZTsgLy/kuI3mmK8gayBxIGogMTAgQTtcclxuICAgIH1cclxuICB9KTtcclxuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XHJcbiAgICBjYXJkLnNjb3JlcyA9IGNhcmQucG9pbnQ7XHJcbiAgICBpZiAoY2FyZC5zY29yZXMgPT0gMTQpIHtcclxuICAgICAgY2FyZC5zY29yZXMgPSAxO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcclxuICAgIGlmIChjYXJkLnNjb3JlcyA+IDUgJiYgY2FyZC5zY29yZXMgIT0gMjApIHtcclxuICAgICAgaXMxID0gZmFsc2U7Ly/kuI3mmK8xIDIgMyA0IDVcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgaWYgKGlzMTQpIHsgLy/mmK8gayBxIGogMTAgQTtcclxuICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcclxuICAgICAgaWYgKGNhcmQuc2NvcmVzID09IDEpIHtcclxuICAgICAgICBjYXJkLnNjb3JlcyA9IDE0O1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtcclxuICAgICAgcmV0dXJuIGEyLnNjb3JlcyAtIGExLnNjb3JlcztcclxuICAgIH0pO1xyXG4gICAgdmFyIG51bSA9IDE0O1xyXG4gICAgdmFyIHNjb3Jlc0F5eSA9IFtdOyAvL+S4gOWJr+eJjOeahOWIhuaVsFxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuICAgICAgc2NvcmVzQXl5LnB1c2gobnVtKTtcclxuICAgICAgbnVtIC09IDE7XHJcbiAgICB9XHJcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNjb3Jlc0F5eS5sZW5ndGg7IGorKykge1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRNb2RlbC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBjYXJkU2NvcmVzID0gY2FyZE1vZGVsW2ldLnNjb3JlcztcclxuICAgICAgICBpZiAoY2FyZFNjb3JlcyA9PSBzY29yZXNBeXlbal0gJiYgY2FyZFNjb3JlcyA8IDE1KSB7XHJcbiAgICAgICAgICBzY29yZXNBeXkuc3BsaWNlKGosIDEpOyAvL+WIoOmZpOS4jeaYr+msvOeJjOeahOWIhlxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy9jYy5sb2coJy0tLS0tLS0tLS3mmK8gayBxIGogMTAgQScsc2NvcmVzQXl5KVxyXG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkgeyAvL+aJvuWHuumAieS4reeahOeJjFxyXG4gICAgICBpZiAoY2FyZC5wb2ludCA+PSAyMCkge1xyXG4gICAgICAgIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLCAxKVswXTtcclxuICAgICAgfVxyXG4gICAgfS5iaW5kKHRoaXMpKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoaXMxKSB7IC8v5pivMSAyIDMgNCA1XHJcbiAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtcclxuICAgICAgcmV0dXJuIGEyLnNjb3JlcyAtIGExLnNjb3JlcztcclxuICAgIH0pO1xyXG4gICAgdmFyIG51bSA9IDU7XHJcbiAgICB2YXIgc2NvcmVzQXl5ID0gW107IC8v5LiA5Ymv54mM55qE5YiG5pWwXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG4gICAgICBzY29yZXNBeXkucHVzaChudW0pO1xyXG4gICAgICBudW0gLT0gMTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGNhcmRTY29yZXMgPSBjYXJkTW9kZWxbaV0uc2NvcmVzO1xyXG4gICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHtcclxuICAgICAgICAgIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvL2NjLmxvZygnLS0tLS0tLS0tLeaYrzEgMiAzIDQgNScpXHJcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7IC8v5om+5Ye66YCJ5Lit55qE54mMXHJcbiAgICAgIGlmIChjYXJkLnBvaW50ID49IDIwKSB7XHJcbiAgICAgICAgY2FyZC5zY29yZXMgPSBzY29yZXNBeXkuc3BsaWNlKDAsIDEpWzBdO1xyXG4gICAgICB9XHJcbiAgICB9LmJpbmQodGhpcykpO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge1xyXG4gICAgICByZXR1cm4gYTEuc2NvcmVzIC0gYTIuc2NvcmVzO1xyXG4gICAgfSk7XHJcbiAgICB2YXIgc2NvcmVzQXl5ID0gW107IC8v55So5p2l6KOF6ay854mM5YiG5pWwXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG4gICAgICB2YXIgcyA9IHBhcnNlSW50KGNhcmRNb2RlbFswXS5zY29yZXMpICsgaTsgLy/mnIDlsI/nmoTniYznmoTliIbmlbBcclxuICAgICAgc2NvcmVzQXl5LnB1c2gocyk7Ly/kuIDlia/niYznmoTliIbmlbBcclxuICAgIH1cclxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGNhcmRTY29yZXMgPSBjYXJkTW9kZWxbaV0uc2NvcmVzO1xyXG4gICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHtcclxuICAgICAgICAgIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7IC8v5pS55Y+Y54mM55qE5YiG5pWwXHJcbiAgICAgIGlmIChjYXJkLnBvaW50ID49IDIwKSB7XHJcbiAgICAgICAgY2FyZC5zY29yZXMgPSBzY29yZXNBeXkuc3BsaWNlKDAsMSlbMF07XHJcbiAgICAgIH1cclxuICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgfVxyXG5cclxuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XHJcbiAgICBpZiAoY2FyZC5zY29yZXMgPT0gMSkge1xyXG4gICAgICBjYXJkLnNjb3JlcyA9IDE0O1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge1xyXG4gICAgcmV0dXJuIGExLnNjb3JlcyAtIGEyLnNjb3JlcztcclxuICB9KTtcclxuICByZXR1cm4gY2FyZE1vZGVsO1xyXG59O1xyXG4vKiMjIyMjKi9cclxuXHJcbktRQ2FyZC5fdHlwZVNjb3JlT2ZDYXJkcyA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gIHZhciB0eXBlU2NvcmUgPSAwO1xyXG4gIGlmKEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRzKSl7XHJcbiAgICB0eXBlU2NvcmUgPSA5MDAwMDAwMDAwMDAwMDAwO1xyXG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bihjYXJkcykpIHtcclxuICAgIHR5cGVTY29yZSA9IDgwMDAwMDAwMDAwMDAwMDA7XHJcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblRpZVpoaShjYXJkcykpIHtcclxuICAgIHR5cGVTY29yZSA9IDcwMDAwMDAwMDAwMDAwMDA7XHJcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkh1THUoY2FyZHMpKSB7XHJcbiAgICB0eXBlU2NvcmUgPSA2MDAwMDAwMDAwMDAwMDAwO1xyXG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhKGNhcmRzKSkge1xyXG4gICAgdHlwZVNjb3JlID0gNTAwMDAwMDAwMDAwMDAwMDtcclxuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2h1blppKGNhcmRzKSkge1xyXG4gICAgdHlwZVNjb3JlID0gNDAwMDAwMDAwMDAwMDAwMDtcclxuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2FuVGlhbyhjYXJkcykpIHtcclxuICAgIHR5cGVTY29yZSA9IDMwMDAwMDAwMDAwMDAwMDA7XHJcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkxpYUR1aShjYXJkcykpIHtcclxuICAgIHR5cGVTY29yZSA9IDIwMDAwMDAwMDAwMDAwMDA7XHJcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkR1aVppKGNhcmRzKSkge1xyXG4gICAgdHlwZVNjb3JlID0gMTAwMDAwMDAwMDAwMDAwMDtcclxuICB9XHJcblxyXG4gIHJldHVybiB0eXBlU2NvcmU7XHJcbn07XHJcbi8qXHJcbiAvLyDmoLnmja7niYzlnovov5vooYzmjpLluo9cclxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydCA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gaWYgKChjYXJkcyA9PSBudWxsKSB8fCAoY2FyZHMubGVuZ3RoID09IDApKSB7XHJcbiByZXR1cm4gY2FyZHM7XHJcbiB9XHJcbiBpZihLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcykpe1xyXG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFd1dG9uZyhjYXJkcyk7XHJcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMpKSB7XHJcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2h1blppKGNhcmRzKTtcclxuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5UaWVaaGkoY2FyZHMpKSB7XHJcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0VGllWmhpKGNhcmRzKTtcclxuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5IdUx1KGNhcmRzKSkge1xyXG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEh1THUoY2FyZHMpO1xyXG4gfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWEoY2FyZHMpKSB7XHJcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0VG9uZ0h1YShjYXJkcyk7XHJcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2h1blppKGNhcmRzKSkge1xyXG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFNodW5aaShjYXJkcyk7XHJcbiB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2FuVGlhbyhjYXJkcykpIHtcclxuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRTYW5UaWFvKGNhcmRzKTtcclxuIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZHMpKSB7XHJcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0TGlhbmdEdWkoY2FyZHMpO1xyXG4gfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkR1aVppKGNhcmRzKSkge1xyXG4gcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydER1aVppKGNhcmRzKTtcclxuIH1cclxuXHJcbiByZXR1cm4gY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpLnJldmVyc2UoKTtcclxuIH07XHJcblxyXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2h1blppID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiByZXR1cm4gY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpLnJldmVyc2UoKTtcclxuIH07XHJcblxyXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0VGllWmhpID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhjYXJkcyk7XHJcbiB9O1xyXG5cclxuIC8hKiMjIyMjKiEvXHJcbiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRXdXRvbmcgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcclxuIH07XHJcbiAvISojIyMjIyohL1xyXG5cclxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEh1THUgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcclxuIH07XHJcblxyXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0VG9uZ0h1YSA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gcmV0dXJuIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KS5yZXZlcnNlKCk7XHJcbiB9O1xyXG5cclxuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcclxuIH07XHJcblxyXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0TGlhbmdEdWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcclxuIH07XHJcblxyXG4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0RHVpWmkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcclxuIH07XHJcbiAqL1xyXG5LUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzID0gZnVuY3Rpb24oY2FyZHMpIHtcclxuXHJcbiAgY2FyZHMgPSBLUUNhcmQuX2NoYW5nZUd1aUNhcmQoY2FyZHMpO1xyXG5cclxuICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmKGkuc2NvcmVzID09IDEpIGkuc2NvcmVzID0gMTQ7fSlcclxuXHJcbiAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFNjb3JldHNIZWxwZXIoY2FyZHMpO1xyXG4gIGxldCBuZXdDYXJkcyA9IGNhcmRzLnNsaWNlKCkuc29ydChmdW5jdGlvbihjYXJkMSwgY2FyZDIpIHtcclxuICAgIGxldCBudW1iZXJPZkNhcmQxID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW2NhcmQxLnNjb3Jlc107XHJcbiAgICBsZXQgbnVtYmVyT2ZDYXJkMiA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tjYXJkMi5zY29yZXNdO1xyXG5cclxuICAgIGlmIChudW1iZXJPZkNhcmQyICE9IG51bWJlck9mQ2FyZDEpIHtcclxuICAgICAgcmV0dXJuIG51bWJlck9mQ2FyZDIgLSBudW1iZXJPZkNhcmQxO1xyXG4gICAgfVxyXG4gICAgdmFyIHNjb3JlczEgPSBjYXJkMS5zY29yZXMgPT0gMT8gMTQ6Y2FyZDEuc2NvcmVzO1xyXG4gICAgdmFyIHNjb3JlczIgPSBjYXJkMi5zY29yZXMgPT0gMT8gMTQ6Y2FyZDIuc2NvcmVzO1xyXG4gICAgcmV0dXJuIHNjb3JlczIgLSBzY29yZXMxO1xyXG4gICAgLy9yZXR1cm4gY2FyZDIuc2NvcmVzIC0gY2FyZDEuc2NvcmVzO1xyXG4gIH0pO1xyXG4gIG5ld0NhcmRzLmZvckVhY2goZnVuY3Rpb24oaSl7aWYoaS5zY29yZXMgPT0gMTQpIGkuc2NvcmVzID0gMTt9KVxyXG4gIHJldHVybiBuZXdDYXJkcy8qLmNvbmNhdChjYXJkMjApKi87XHJcbn07XHJcblxyXG5LUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzMSA9IGZ1bmN0aW9uKGNhcmRzKSB7XHJcblxyXG4gIGNhcmRzID0gS1FDYXJkLl9jaGFuZ2VHdWlDYXJkKGNhcmRzKTtcclxuXHJcbiAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihpKXtpZihpLnNjb3JlcyA9PSAxKSBpLnNjb3JlcyA9IDE0O30pXHJcblxyXG4gIGxldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRTY29yZXRzSGVscGVyKGNhcmRzKTtcclxuICBsZXQgbmV3Q2FyZHMgPSBjYXJkcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XHJcbiAgICBsZXQgbnVtYmVyT2ZDYXJkMSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tjYXJkMS5zY29yZXNdO1xyXG4gICAgbGV0IG51bWJlck9mQ2FyZDIgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbY2FyZDIuc2NvcmVzXTtcclxuXHJcbiAgICBpZiAobnVtYmVyT2ZDYXJkMiAhPSBudW1iZXJPZkNhcmQxKSB7XHJcbiAgICAgIHJldHVybiBudW1iZXJPZkNhcmQxIC0gbnVtYmVyT2ZDYXJkMjtcclxuICAgIH1cclxuICAgIHZhciBzY29yZXMxID0gY2FyZDEuc2NvcmVzID09IDE/IDE0OmNhcmQxLnNjb3JlcztcclxuICAgIHZhciBzY29yZXMyID0gY2FyZDIuc2NvcmVzID09IDE/IDE0OmNhcmQyLnNjb3JlcztcclxuICAgIHJldHVybiBzY29yZXMxIC0gc2NvcmVzMjtcclxuICAgIC8vcmV0dXJuIGNhcmQxLnNjb3JlcyAtIGNhcmQyLnNjb3JlcztcclxuICB9KTtcclxuICBuZXdDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2lmKGkuc2NvcmVzID09IDE0KSBpLnNjb3JlcyA9IDE7fSlcclxuICByZXR1cm4gbmV3Q2FyZHM7XHJcbn07XHJcblxyXG5LUUNhcmQuX2NoYW5nZUd1aUNhcmQgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuXHJcbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xyXG5cclxuICB2YXIgY2EgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xyXG5cclxuICB2YXIgaGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYSk7XHJcblxyXG4gIHZhciBzbyA9IDA7XHJcblxyXG4gIHZhciBjb2xvciA9IDE7XHJcblxyXG4gIHZhciB0eXBlID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkcykgKyAxO1xyXG5cclxuICB0eXBlID0gdHlwZSA+PSAxMCA/IHR5cGUgOiBcIjBcIiArIHR5cGU7XHJcblxyXG4gIGlmKHR5cGUgPT0gXCIwNVwiIHx8IHR5cGUgPT0gXCIwOVwiKXtcclxuXHJcbiAgICByZXR1cm4gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FyZHMpO1xyXG5cclxuICB9XHJcbiAgaWYodHlwZSA9PSBcIjA2XCIpe1xyXG5cclxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XHJcblxyXG4gICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcclxuXHJcbiAgICAgIGlmKHcgPT0gMSkgdyA9IDE0O1xyXG5cclxuICAgICAgaWYobWF4TnVtYmVyID49IGhlbHBlci5tYXhOdW1iZXIoKSAmJiBzbyA8IHBhcnNlSW50KHcpICYmIHBhcnNlSW50KHcpICE9IDIwKXtzbyA9IHBhcnNlSW50KHcpO31cclxuXHJcbiAgICB9XHJcbiAgICBjb2xvciA9IGNhWzBdLmNvbG9yO1xyXG5cclxuICAgIHNvID0gc28gPT0gMTQ/IDE6IHNvO1xyXG5cclxuICAgIGNhcmQyMC5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xyXG5cclxuICAgICAgbi5zY29yZXMgPSBzbztcclxuXHJcbiAgICAgIG4uY29sb3JTY29yZXMgPSBjb2xvcjtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgfVxyXG4gIGlmKHR5cGUgPT0gXCIwN1wiIHx8IHR5cGUgPT0gXCIyMlwiIHx8IHR5cGUgPT0gXCIwOFwiIHx8IHR5cGUgPT0gXCIxMFwiXHJcbiAgICAgIHx8IHR5cGUgPT0gXCIwNFwiIHx8IHR5cGUgPT0gXCIxMVwiIHx8IHR5cGUgPT0gXCIwMlwiKXtcclxuXHJcbiAgICBmb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xyXG5cclxuICAgICAgdmFyIG1heE51bWJlciA9IGhlbHBlci5wb2ludE51bWJlcnNbd107XHJcblxyXG4gICAgICBpZih3ID09IDEpIHcgPSAxNDtcclxuXHJcbiAgICAgIGlmKG1heE51bWJlciA+PSBoZWxwZXIubWF4TnVtYmVyKCkgJiYgc28gPCBwYXJzZUludCh3KSAmJiBwYXJzZUludCh3KSAhPSAyMCl7c28gPSBwYXJzZUludCh3KTt9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNvID0gc28gPT0gMTQgPyAxOiBzb1xyXG5cclxuICAgIGNhLmZvckVhY2goZnVuY3Rpb24obil7aWYoc28gPT0gbi5wb2ludCAmJiBjb2xvciA8IG4uY29sb3IpIGNvbG9yID0gbi5jb2xvcjt9KTtcclxuXHJcbiAgICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihuKXtcclxuXHJcbiAgICAgIG4uc2NvcmVzID0gc287XHJcblxyXG4gICAgICBuLmNvbG9yU2NvcmVzID0gY29sb3I7XHJcblxyXG4gICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgfVxyXG5cclxuICByZXR1cm4gY2FyZDIwLmNvbmNhdChjYSk7XHJcbn07XHJcblxyXG5LUUNhcmQuX3NldEd1aUNhcmQgPSBmdW5jdGlvbiAoaW5kZXgsIHN0YXJ0LCBlbmQsIHR5cGUsIGNhcmRzICxub2RlcywgY2FyZFNwcml0ZUF0bGFzKSB7XHJcbiAgLy9jYy5sb2coY2FyZFNwcml0ZUF0bGFzKVxyXG4gIC8vY2MubG9nKCctLS0tLTU5MycpXHJcbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHNbaW5kZXhdKTtcclxuXHJcbiAgdmFyIGNhID0gY2FyZHNbaW5kZXhdLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XHJcblxyXG4gIHZhciBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhKTtcclxuXHJcbiAgdmFyIHNvID0gMDtcclxuXHJcbiAgdmFyIGNvbG9yID0gMTtcclxuXHJcbiAgdmFyIG5vZGUgPSBub2Rlcy5zbGljZShzdGFydCwgZW5kKS5maWx0ZXIoZnVuY3Rpb24obil7XHJcblxyXG4gICAgaWYobi5jaGlsZHJlbkNvdW50ID4gMCAmJiBuLmNoaWxkcmVuWzBdLmNhcmROYW1lKXtcclxuXHJcbiAgICAgIGlmKHBhcnNlSW50KG4uY2hpbGRyZW5bMF0uY2FyZE5hbWUuc3BsaXQoXCJfXCIpWzFdKSA9PSAyMCkgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBpZih0eXBlID09IFwiMDVcIiB8fCB0eXBlID09IFwiMDlcIil7XHJcblxyXG4gICAgY2FyZHNbaW5kZXhdID0gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FyZHNbaW5kZXhdKTtcclxuXHJcbiAgICBzbyA9IGNhcmRzW2luZGV4XS5maWx0ZXIoZnVuY3Rpb24oaSl7aWYoaS5wb2ludCA9PSAyMClyZXR1cm4gdHJ1ZTt9KS5tYXAoZnVuY3Rpb24oaSl7cmV0dXJuIGkuc2NvcmVzID09IDE0PyAxOmkuc2NvcmVzO30pO1xyXG5cclxuICAgIG5vZGUuZm9yRWFjaChmdW5jdGlvbihuKXtcclxuXHJcbiAgICAgIHZhciBidG5TcHJpdGUgPSBuLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG5cclxuICAgICAgdmFyIGNhcmROYW1lID0gY2FbMF0uY29sb3IgKyBcIl9cIiArIHNvLnNwbGljZSgwLDEpWzBdO1xyXG5cclxuICAgICAgdmFyIHBhdGggPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xyXG5cclxuICAgICAgS1FDYXJkLl9sb2FkQ2FyZEZyYW1lKGNhcmRTcHJpdGVBdGxhcywgcGF0aCAsYnRuU3ByaXRlKTtcclxuXHJcbiAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICB9XHJcbiAgaWYodHlwZSA9PSBcIjA2XCIpe1xyXG5cclxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XHJcblxyXG4gICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcclxuXHJcbiAgICAgIGlmKHcgPT0gMSkgdyA9IDE0O1xyXG5cclxuICAgICAgaWYobWF4TnVtYmVyID49IGhlbHBlci5tYXhOdW1iZXIoKSAmJiBzbyA8IHBhcnNlSW50KHcpICYmIHBhcnNlSW50KHcpICE9IDIwKXtzbyA9IHBhcnNlSW50KHcpO31cclxuXHJcbiAgICB9XHJcblxyXG4gICAgY29sb3IgPSBjYVswXS5jb2xvcjtcclxuXHJcbiAgICBzbyA9IHNvID09IDE0PyAxOiBzbztcclxuXHJcbiAgICBub2RlLmZvckVhY2goZnVuY3Rpb24obil7XHJcblxyXG4gICAgICB2YXIgYnRuU3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuXHJcbiAgICAgIHZhciBjYXJkTmFtZSA9IGNvbG9yICsgXCJfXCIgKyBzbztcclxuXHJcbiAgICAgIHZhciBwYXRoID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcclxuXHJcbiAgICAgIEtRQ2FyZC5fbG9hZENhcmRGcmFtZShjYXJkU3ByaXRlQXRsYXMsIHBhdGggLGJ0blNwcml0ZSk7XHJcblxyXG4gICAgfS5iaW5kKHRoaXMpKTtcclxuICB9XHJcbiAgaWYodHlwZSA9PSBcIjA3XCIgfHwgdHlwZSA9PSBcIjIyXCIgfHwgdHlwZSA9PSBcIjA4XCIgfHwgdHlwZSA9PSBcIjEwXCJcclxuICAgICAgfHwgdHlwZSA9PSBcIjA0XCIgfHwgdHlwZSA9PSBcIjExXCIgfHwgdHlwZSA9PSBcIjAyXCIpe1xyXG5cclxuICAgIGZvcih2YXIgdyBpbiBoZWxwZXIucG9pbnROdW1iZXJzKSB7XHJcblxyXG4gICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcclxuXHJcbiAgICAgIGlmKHcgPT0gMSkgdyA9IDE0O1xyXG5cclxuICAgICAgaWYobWF4TnVtYmVyID49IGhlbHBlci5tYXhOdW1iZXIoKSAmJiBzbyA8IHBhcnNlSW50KHcpICYmIHBhcnNlSW50KHcpICE9IDIwKXtzbyA9IHBhcnNlSW50KHcpO31cclxuXHJcbiAgICB9XHJcblxyXG4gICAgc28gPSBzbyA9PSAxNCA/IDE6IHNvXHJcblxyXG4gICAgY2EuZm9yRWFjaChmdW5jdGlvbihuKXtpZihzbyA9PSBuLnBvaW50ICYmIGNvbG9yIDwgbi5jb2xvcikgY29sb3IgPSBuLmNvbG9yO30pO1xyXG5cclxuICAgIG5vZGUuZm9yRWFjaChmdW5jdGlvbihuKXtcclxuXHJcbiAgICAgIHZhciBidG5TcHJpdGUgPSBuLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG5cclxuICAgICAgdmFyIGNhcmROYW1lID0gY29sb3IgKyBcIl9cIiArIHNvO1xyXG5cclxuICAgICAgdmFyIHBhdGggPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xyXG5cclxuICAgICAgS1FDYXJkLl9sb2FkQ2FyZEZyYW1lKGNhcmRTcHJpdGVBdGxhcywgcGF0aCAsYnRuU3ByaXRlKTtcclxuXHJcbiAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuXHJcbiAgfVxyXG5cclxufTtcclxuXHJcbktRQ2FyZC5fc2V0R3VpQ2FyZHMgPSBmdW5jdGlvbiAodHlwZSwgY2FyZHMgLG5vZGVzLCBjYXJkU3ByaXRlQXRsYXMpIHtcclxuICAvL2NjLmxvZyhjYXJkU3ByaXRlQXRsYXMpXHJcbiAgLy9jYy5sb2coJy0tLS0tNTkzJylcclxuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XHJcblxyXG4gIHZhciBjYSA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XHJcblxyXG4gIHZhciBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhKTtcclxuXHJcbiAgdmFyIHNvID0gMDtcclxuXHJcbiAgdmFyIGNvbG9yID0gMTtcclxuXHJcbiAgdmFyIG5vZGUgPSBub2Rlcy5zbGljZSgpLmZpbHRlcihmdW5jdGlvbihuKXtcclxuXHJcbiAgICBpZihuLmNoaWxkcmVuQ291bnQgPiAwICYmIG4uY2hpbGRyZW5bMF0uY2FyZE5hbWUpe1xyXG5cclxuICAgICAgaWYocGFyc2VJbnQobi5jaGlsZHJlblswXS5jYXJkTmFtZS5zcGxpdChcIl9cIilbMV0pID09IDIwKSByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGlmKHR5cGUgPT0gXCIwNVwiIHx8IHR5cGUgPT0gXCIwOVwiKXtcclxuXHJcbiAgICBjYXJkcyA9IEtRQ2FyZC5fY2hhbmdlQ2FyZFNjb3JzKGNhcmRzKTtcclxuXHJcbiAgICBzbyA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihpKXtpZihpLnBvaW50ID09IDIwKXJldHVybiB0cnVlO30pLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gaS5zY29yZXMgPT0gMTQ/IDE6aS5zY29yZXM7fSk7XHJcblxyXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xyXG5cclxuICAgICAgdmFyIGJ0blNwcml0ZSA9IG4uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcblxyXG4gICAgICB2YXIgY2FyZE5hbWUgPSBjYVswXS5jb2xvciArIFwiX1wiICsgc28uc3BsaWNlKDAsMSlbMF07XHJcblxyXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XHJcblxyXG4gICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUoY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxidG5TcHJpdGUpO1xyXG5cclxuICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gIH1cclxuICBpZih0eXBlID09IFwiMDZcIil7XHJcblxyXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuXHJcbiAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xyXG5cclxuICAgICAgaWYodyA9PSAxKSB3ID0gMTQ7XHJcblxyXG4gICAgICBpZihtYXhOdW1iZXIgPj0gaGVscGVyLm1heE51bWJlcigpICYmIHNvIDwgcGFyc2VJbnQodykgJiYgcGFyc2VJbnQodykgIT0gMjApe3NvID0gcGFyc2VJbnQodyk7fVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBjb2xvciA9IGNhWzBdLmNvbG9yO1xyXG5cclxuICAgIHNvID0gc28gPT0gMTQ/IDE6IHNvO1xyXG5cclxuICAgIG5vZGUuZm9yRWFjaChmdW5jdGlvbihuKXtcclxuXHJcbiAgICAgIHZhciBidG5TcHJpdGUgPSBuLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG5cclxuICAgICAgdmFyIGNhcmROYW1lID0gY29sb3IgKyBcIl9cIiArIHNvO1xyXG5cclxuICAgICAgdmFyIHBhdGggPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xyXG5cclxuICAgICAgS1FDYXJkLl9sb2FkQ2FyZEZyYW1lKGNhcmRTcHJpdGVBdGxhcywgcGF0aCAsYnRuU3ByaXRlKTtcclxuXHJcbiAgICB9LmJpbmQodGhpcykpO1xyXG4gIH1cclxuICBpZih0eXBlID09IFwiMDdcIiB8fCB0eXBlID09IFwiMjJcIiB8fCB0eXBlID09IFwiMDhcIiB8fCB0eXBlID09IFwiMTBcIlxyXG4gICAgICB8fCB0eXBlID09IFwiMDRcIiB8fCB0eXBlID09IFwiMTFcIiB8fCB0eXBlID09IFwiMDJcIil7XHJcblxyXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuXHJcbiAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xyXG5cclxuICAgICAgaWYodyA9PSAxKSB3ID0gMTQ7XHJcblxyXG4gICAgICBpZihtYXhOdW1iZXIgPj0gaGVscGVyLm1heE51bWJlcigpICYmIHNvIDwgcGFyc2VJbnQodykgJiYgcGFyc2VJbnQodykgIT0gMjApe3NvID0gcGFyc2VJbnQodyk7fVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBzbyA9IHNvID09IDE0ID8gMTogc29cclxuXHJcbiAgICBjYS5mb3JFYWNoKGZ1bmN0aW9uKG4pe2lmKHNvID09IG4ucG9pbnQgJiYgY29sb3IgPCBuLmNvbG9yKSBjb2xvciA9IG4uY29sb3I7fSk7XHJcblxyXG4gICAgbm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG4pe1xyXG5cclxuICAgICAgdmFyIGJ0blNwcml0ZSA9IG4uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcblxyXG4gICAgICB2YXIgY2FyZE5hbWUgPSBjb2xvciArIFwiX1wiICsgc287XHJcblxyXG4gICAgICB2YXIgcGF0aCA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XHJcblxyXG4gICAgICBLUUNhcmQuX2xvYWRDYXJkRnJhbWUoY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxidG5TcHJpdGUpO1xyXG5cclxuICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG5cclxuICB9XHJcblxyXG59O1xyXG5cclxuS1FDYXJkLl9sb2FkQ2FyZEZyYW1lID0gZnVuY3Rpb24oU3ByaXRlRnJhbWUsIHBhdGgsIFNwcml0ZXNOb2RlLCB3LCBoKSB7XHJcbiAgLy9jYy5sb2coU3ByaXRlRnJhbWUpXHJcbiAgLy9jYy5sb2coJy0tLTc2OScpXHJcbiAgdmFyIFNwcml0ZSA9IFNwcml0ZUZyYW1lLmdldFNwcml0ZUZyYW1lKCBwYXRoICk7XHJcblxyXG4gIFNwcml0ZXNOb2RlLnNwcml0ZUZyYW1lID0gU3ByaXRlO1xyXG5cclxuICBpZih3KSBTcHJpdGVzTm9kZS5ub2RlLndpZHRoID0gdztcclxuXHJcbiAgaWYoaCkgU3ByaXRlc05vZGUubm9kZS5oZWlnaHQgPSBoO1xyXG59O1xyXG5cclxuXHJcbktRQ2FyZC50ZXN0U2NvcmUgPSBmdW5jdGlvbigpIHtcclxuXHJcbn07IiwiLy8g54mM54K55pWw5biu5Yqp57G7XHJcbi8vIOeUqOadpeiuoeeul+S4gOS4queJjOaVsOe7hOWGheeahOebuOWQjOeCueaVsOeahOeJjOeahOW8oOaVsFxyXG52YXIgS1FDYXJkU2NvcmV0c0hlbHBlciA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdGhpcy5wb2ludE51bWJlcnMgPSB7fTtcclxuICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICBsZXQgcG9pbnQgPSBjYXJkLnNjb3JlcztcclxuICAgICAgICB2YXIgbnVtYmVyID0gdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdIHx8IDA7XHJcbiAgICAgICAgdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdID0gbnVtYmVyICsgMTtcclxuICAgIH0uYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vLyDnm7jlkIzngrnmlbDniYznmoTmnIDlpKfmlbDph49cclxuS1FDYXJkU2NvcmV0c0hlbHBlci5wcm90b3R5cGUubWF4TnVtYmVyID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciByZXN1bHQgPSAwO1xyXG4gIGZvciAobGV0IHByb3AgaW4gdGhpcy5wb2ludE51bWJlcnMpIHtcclxuICAgIGxldCBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twcm9wXTtcclxuICAgICAgLy9pZihudW1iZXIgPCAyMCl7XHJcbiAgICAgICAgICByZXN1bHQgPSBNYXRoLm1heChudW1iZXIsIHJlc3VsdCk7XHJcbiAgICAgIC8vfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufTtcclxuXHJcblxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBLUUNhcmRTY29yZXRzSGVscGVyO1xyXG5cclxuLyp2YXIgY2FyZHMgPSBbXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEwfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTJ9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjE0fVxyXG5dO1xyXG52YXIgdGVzdCA9IG5ldyBLUUNhcmRQb2ludHNTYW1lKGNhcmRzKTtcclxuY29uc29sZS5sb2codGVzdCk7Ki9cclxuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XHJcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcclxuXHJcbi8vIOeJjOiHquWKqOmAieaLqeeahOaJqeWxlVxyXG5cclxuLyoqXHJcbiAqIOiHquWKqOmAieaLqeeJjO+8jOeUseWkp+WIsOWwj1xyXG4gKlxyXG4gKiBAcGFyYW0gIHtbS1FDYXJkXX0gb3JpZ2luQ2FyZHMgIOiiq+mAieaLqeeahOWOn+Wni+eJjOaVsOe7hFxyXG4gKlxyXG4gKiBAcmV0dXJuIHtbS1FDYXJkXX1cclxuICovXHJcbktRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMgPSBmdW5jdGlvbihvcmlnaW5DYXJkcywgbWF4TGVuZ3RoKSB7XHJcbiAgICBpZiAob3JpZ2luQ2FyZHMubGVuZ3RoIDw9IG1heExlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBvcmlnaW5DYXJkcztcclxuICAgIH1cclxuICAgIG9yaWdpbkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XHJcbiAgICAgICAgaWYoY2FyZC5zY29yZXMgPT0gMSl7XHJcbiAgICAgICAgICAgIGNhcmQuc2NvcmVzID0gMTQ7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBsZXQgY2FyZHMgPSBvcmlnaW5DYXJkcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24oYSxiKXtcclxuICAgICAgICByZXR1cm4gYS5zY29yZXMgLSBiLnNjb3JlcztcclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBmaW5kRnVuY3MgPSBbXHJcbiAgICAgICAgS1FDYXJkLmZpbmRXdVRvbmcsXHJcbiAgICAgICAgS1FDYXJkLmZpbmRUb25nSHVhU2h1bixcclxuICAgICAgICBLUUNhcmQuZmluZFRpZVpoaSxcclxuICAgICAgICBLUUNhcmQuZmluZEh1THUsXHJcbiAgICAgICAgS1FDYXJkLmZpbmRUb25nSHVhLFxyXG4gICAgICAgIEtRQ2FyZC5maW5kU2h1blppLFxyXG4gICAgICAgIEtRQ2FyZC5maW5kU2FuVGlhbyxcclxuICAgICAgICBLUUNhcmQuZmluZExpYUR1aSxcclxuICAgICAgICBLUUNhcmQuZmluZER1aVppXHJcbiAgICBdO1xyXG5cclxuICAgIGxldCBpbmRleEFycmF5cyA9IG51bGw7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZpbmRGdW5jcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGxldCBmdW5jID0gZmluZEZ1bmNzW2ldO1xyXG4gICAgICAgIGluZGV4QXJyYXlzID0gKGZ1bmMuYmluZChLUUNhcmQpKShjYXJkcyk7XHJcbiAgICAgICAgaWYgKGluZGV4QXJyYXlzICYmIGluZGV4QXJyYXlzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciBpbmRleHMgPSBbXTtcclxuICAgIGlmIChpbmRleEFycmF5cyAmJiBpbmRleEFycmF5cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgLy8g5om+5Ye65ZCM57G75Z6L55qE54mM6YeM55qE5YiG5pWw5pyA5aSn55qE54mMXHJcbiAgICAgICAgdmFyIG1heFNjb3JlID0gMDtcclxuICAgICAgICBpbmRleEFycmF5cy5mb3JFYWNoKHRlbXBJbmRleHMgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0ZW1wQ2FyZHMgPSB0ZW1wSW5kZXhzLm1hcChpbmRleCA9PiBjYXJkc1tpbmRleF0pO1xyXG4gICAgICAgIGNvbnN0IHNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyh0ZW1wQ2FyZHMpO1xyXG4gICAgICAgIGlmIChzY29yZSA+IG1heFNjb3JlKSB7XHJcbiAgICAgICAgICAgIG1heFNjb3JlID0gc2NvcmU7XHJcbiAgICAgICAgICAgIGluZGV4cyA9IHRlbXBJbmRleHM7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHRhcmdldENhcmRzID0gaW5kZXhzLm1hcChmdW5jdGlvbihpbmRleCkge1xyXG4gICAgICAgIHJldHVybiBjYXJkc1tpbmRleF07XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKmlmICh0YXJnZXRDYXJkcy5sZW5ndGggPCBtYXhMZW5ndGgpIHtcclxuICAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKHRhcmdldENhcmRzKTtcclxuICAgICB3aGlsZSh0YXJnZXRDYXJkcy5sZW5ndGggPCBtYXhMZW5ndGgpIHtcclxuICAgICB0YXJnZXRDYXJkcy5wdXNoKGNhcmRzLnBvcCgpKTtcclxuICAgICB9XHJcbiAgICAgfSBlbHNlICovaWYgKHRhcmdldENhcmRzLmxlbmd0aCA+IG1heExlbmd0aCkge1xyXG4gICAgICAgIHRhcmdldENhcmRzID0gdGFyZ2V0Q2FyZHMuc2xpY2UoMCwgbWF4TGVuZ3RoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGFyZ2V0Q2FyZHMgfHwgW107XHJcbn07XHJcblxyXG5LUUNhcmQudGVzdEF1dG9TZWxlY3QgPSBmdW5jdGlvbihjYXJkcykge1xyXG5cclxufTsiLCJjb25zdCBLUUNhcmRDb2xvcnNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRDb2xvcnNIZWxwZXInKTtcclxuY29uc3QgS1FDYXJkUG9pbnRzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUG9pbnRzSGVscGVyJyk7XHJcbmNvbnN0IE51bWJlckV4dGVuc2lvbiA9IHJlcXVpcmUoJ051bWJlckV4dGVuc2lvbicpO1xyXG5jb25zdCBHZXRDYXJkUG9pbnRzU2FtZUNvdW50ID0gcmVxdWlyZSgnR2V0Q2FyZFBvaW50c1NhbWVDb3VudCcpO1xyXG5cclxuY2MgPSBjYyB8fCB7fTtcclxuY2MuYXNzZXJ0ID0gY2MuYXNzZXJ0IHx8IGNvbnNvbGUuYXNzZXJ0IHx8IGZ1bmN0aW9uICgpIHt9O1xyXG5jYy5sb2cgPSBjYy5sb2cgfHwgY29uc29sZS5sb2cgfHwgZnVuY3Rpb24gKCkge307XHJcbmNjLmVycm9yID0gY2MuZXJyb3IgfHwgY29uc29sZS5lcnJvciB8fCBmdW5jdGlvbiAoKSB7fTtcclxuXHJcbi8vIOeJjCBNb2RlbCDnsbvvvIzlsIHoo4XkuoboirHoibLlkozngrnmlbBcclxuLy8g5L2/55So77yaXHJcbi8vIG5ldyBLUUNhcmQoMjIpO1xyXG52YXIgS1FDYXJkID0gZnVuY3Rpb24gKHBvaW50LCBjb2xvciAsaW5kZXgpIHtcclxuICAgIHRoaXMuY29sb3IgPSBudWxsO1xyXG4gICAgdGhpcy5wb2ludCA9IG51bGw7XHJcbiAgICB0aGlzLnNpbmRleCA9IGluZGV4O1xyXG4gICAgdGhpcy5faW5pdFdpdGhDb2xvckFuZFBvaW50ID0gZnVuY3Rpb24gKGNvbG9yLCBwb2ludCkge1xyXG4gICAgICAgIGlmIChjb2xvciA9PSAncycpIHsgY29sb3IgPSA0O31cclxuICAgICAgICBpZiAoY29sb3IgPT0gJ2gnKSB7IGNvbG9yID0gMzt9XHJcbiAgICAgICAgaWYgKGNvbG9yID09ICdjJykgeyBjb2xvciA9IDI7fVxyXG4gICAgICAgIGlmIChjb2xvciA9PSAnZCcpIHsgY29sb3IgPSAxO31cclxuXHJcbiAgICAgICAgdGhpcy5wb2ludCA9IE51bWJlcihwb2ludCk7XHJcbiAgICAgICAgdGhpcy5zY29yZXMgPSBOdW1iZXIocG9pbnQpO1xyXG4gICAgICAgIHRoaXMuY29sb3IgPSBOdW1iZXIoY29sb3IpO1xyXG4gICAgICAgIHRoaXMuY29sb3JTY29yZXMgPSBOdW1iZXIoY29sb3IpO1xyXG5cclxuICAgICAgICBjYy5hc3NlcnQodGhpcy5wb2ludCA+IDApO1xyXG4gICAgICAgIGNjLmFzc2VydCh0aGlzLmNvbG9yID4gMCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuX2luaXRXaXRoTnVtYmVyID0gZnVuY3Rpb24gKG51bWJlcikge1xyXG4gICAgICAgIHRoaXMucG9pbnQgPSBNYXRoLmZsb29yKG51bWJlciAvIDEwKTtcclxuICAgICAgICB0aGlzLmNvbG9yID0gbnVtYmVyICUgMTA7XHJcbiAgICAgICAgY2MuYXNzZXJ0KHRoaXMucG9pbnQgPiAwKTtcclxuICAgICAgICBjYy5hc3NlcnQodGhpcy5jb2xvciA+IDApO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLl9pbml0V2l0aE9iamVjdCA9IGZ1bmN0aW9uIChvYmplY3QpIHtcclxuICAgICAgICBpZiAob2JqZWN0LnBvaW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luaXRXaXRoQ29sb3JBbmRQb2ludChvYmplY3QuY29sb3IsIG9iamVjdC5wb2ludCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChvYmplY3Quc3VpdCkge1xyXG4gICAgICAgICAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQob2JqZWN0LnN1aXQsIG9iamVjdC5udW1iZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jYXJkTmFtZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmNhcmROYW1lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbG9yICsgXCJfXCIgKyB0aGlzLnBvaW50O1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnNvcnQgPSBmdW5jdGlvbiAob3RoZXJDYXJkLCBhc2MgPSBmYWxzZSwgQWlzTWF4ID0gdHJ1ZSkge1xyXG4gICAgICAgIHJldHVybiBLUUNhcmQuc29ydCh0aGlzLCBvdGhlckNhcmQsIGFzYywgQWlzTWF4KTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyQ2FyZCkge1xyXG4gICAgICAgIGlmICghb3RoZXJDYXJkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLnBvaW50ID09IG90aGVyQ2FyZC5wb2ludCkgJiYgKHRoaXMuY29sb3IgPT0gb3RoZXJDYXJkLmNvbG9yKVxyXG4gICAgICAgICAgICAmJiAodGhpcy5zaW5kZXggPT0gb3RoZXJDYXJkLnNpbmRleCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChwb2ludCAmJiBjb2xvcikge1xyXG4gICAgICAgIHRoaXMuX2luaXRXaXRoQ29sb3JBbmRQb2ludChjb2xvciwgcG9pbnQpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgbnVtYmVyID0gTnVtYmVyKHBvaW50KTtcclxuICAgIGlmICghTnVtYmVyLmlzTmFOKG51bWJlcikpIHtcclxuICAgICAgICB0aGlzLl9pbml0V2l0aE51bWJlcihudW1iZXIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodHlwZW9mKHBvaW50KSA9PSAnc3RyaW5nJykge1xyXG4gICAgICAgIC8vIOino+aekCB4eHh4ZF9kIOW9ouW8j1xyXG4gICAgICAgIGxldCBmb3VuZCA9IHBvaW50Lm1hdGNoKC8oXFwuKSpcXGRfXFxkKy8pO1xyXG4gICAgICAgIGlmICgoZm91bmQgaW5zdGFuY2VvZiBBcnJheSkgJiYgZm91bmQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gZm91bmRbMF07XHJcbiAgICAgICAgICAgIGxldCBudW1iZXJzID0gcmVzdWx0LnNwbGl0KCdfJyk7XHJcblxyXG4gICAgICAgICAgICBsZXQgY29sb3IgPSBOdW1iZXIobnVtYmVyc1swXSk7XHJcbiAgICAgICAgICAgIGxldCBwb2ludCA9IE51bWJlcihudW1iZXJzWzFdKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2luaXRXaXRoQ29sb3JBbmRQb2ludChjb2xvciwgcG9pbnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YocG9pbnQpID09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgdGhpcy5faW5pdFdpdGhPYmplY3QocG9pbnQpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjYy5lcnJvcihcIuWIneWni+WMlumUmeivr++8mlwiICsgcG9pbnQgKyBcIiBcIiArIGNvbG9yKTtcclxufTtcclxuXHJcbi8vIOi9rOaNouaIkOacjeWKoeWZqOeahOeJjCBtb2RlbFxyXG5LUUNhcmQucHJvdG90eXBlLnRvU2VydmVyQ2FyZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgJ3N1aXQnOiB0aGlzLmNvbG9yLFxyXG4gICAgICAgICdudW1iZXInOiB0aGlzLnBvaW50LFxyXG4gICAgfTtcclxufTtcclxuXHJcbktRQ2FyZC5DT0xPUl9TUEFERSAgID0gNDtcclxuS1FDYXJkLkNPTE9SX0hFQVJUICAgPSAzO1xyXG5LUUNhcmQuQ09MT1JfQ0xVQiAgICA9IDI7XHJcbktRQ2FyZC5DT0xPUl9ESUFNT05EID0gMTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gS1FDYXJkO1xyXG5cclxuS1FDYXJkLmNhcmRzRnJvbUFycmF5ID0gZnVuY3Rpb24gKGNhcmROYW1lcykge1xyXG4gICAgcmV0dXJuIGNhcmROYW1lcy5tYXAoZnVuY3Rpb24gKGNhcmROYW1lLGluZGV4KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBLUUNhcmQoY2FyZE5hbWUsbnVsbCxpbmRleCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8vIOWwhuWkmuW8oOeJjOi9rOaNouaIkOacjeWKoeWZqOeahOW9ouW8j1xyXG5LUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIHJldHVybiBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICByZXR1cm4gY2FyZC50b1NlcnZlckNhcmQoKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuS1FDYXJkLlRZUEUgPSB7XHJcbiAgICBXdUxvbmc6IDAsXHJcbiAgICBEdWlaaTogMSxcclxuICAgIExpYW5nRHVpOiAyLFxyXG4gICAgU2FuVGlhbzogMyxcclxuICAgIFNodW5aaTogNCxcclxuICAgIFRvbmdIdWE6IDUsXHJcbiAgICBIdUx1OiA2LFxyXG4gICAgVGllWmhpOiA3LFxyXG4gICAgVG9uZ0h1YVNodW46IDgsXHJcbiAgICAvKiMjIyMjKi9cclxuICAgIFd1VG9uZzo5LFxyXG4gICAgLyojIyMjIyovXHJcbiAgICBTYW5UYW9IdWE6IDEwLCAgLy8g54m55q6K54mMXHJcbiAgICBTYW5TaHVuWmk6IDExLFxyXG4gICAgTGl1RHVpQmFuOiAxMixcclxuXHJcbiAgICBXdUR1aVNhblRpYW86MTMsXHJcbiAgICBTaVRhb1NhblRpYW86IDE0LFxyXG5cclxuICAgIENvdVlpU2U6IDE1LFxyXG4gICAgU2FuRmVuVGlhblhpYTogMTYsXHJcbiAgICBTYW5Ub25nSHVhU2h1bjogMTcsXHJcbiAgICBZaVRpYW9Mb25nOiAxOCxcclxuICAgIFFpbmdMb25nOiAxOSxcclxufTtcclxuXHJcbi8vIOeJjOexu+Wei+WQjVxyXG5LUUNhcmQuY2FyZHNUeXBlTmFtZSA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgbGV0IG5hbWVzID0gWyfkuYzpvpknLCAn5a+55a2QJywgJ+S4pOWvuScsICfkuInmnaEnLCAn6aG65a2QJywgJ+WQjOiKsScsICfokavoiqYnLCAn6ZOB5pSvJywgJ+WQjOiKsemhuicsICfkupTlkIwnLFxyXG4gICAgICAgICfkuInlkIzoirEnLCAn5LiJ6aG65a2QJywn5YWt5a+55Y2KJywgJ+S6lOWvueS4ieadoScsICflm5vlpZfkuInmnaEnLFxyXG4gICAgICAgICflh5HkuIDoibInLCfkuInliIblpKnkuIsnLCAn5LiJ5ZCM6Iqx6aG6JywgJ+S4gOadoem+mScsICfmuIXpvpknXTtcclxuICAgIGxldCB0eXBlID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkcyk7XHJcbiAgICByZXR1cm4gbmFtZXNbdHlwZV07XHJcbn07XHJcblxyXG4vLyDmib7lh7rniYznmoTnsbvlnotcclxuS1FDYXJkLmNhcmRzVHlwZSA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgaWYgKEtRQ2FyZC5pc1FpbmdMb25nKGNhcmRzKSkge1xyXG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5RaW5nTG9uZztcclxuICAgIH1cclxuXHJcbiAgICBpZiAoS1FDYXJkLmlzWWlUaWFvTG9uZyhjYXJkcykpIHtcclxuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuWWlUaWFvTG9uZztcclxuICAgIH1cclxuXHJcbiAgICAvL2lmIChLUUNhcmQuaXNTYW5Ub25nSHVhU2h1bihjYXJkcykpIHtcclxuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5Ub25nSHVhU2h1bjtcclxuICAgIC8vfVxyXG4gICAgLy9cclxuICAgIC8vaWYgKEtRQ2FyZC5pc1NhbkZlblRpYW5YaWEoY2FyZHMpKSB7XHJcbiAgICAvLyAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuRmVuVGlhblhpYTtcclxuICAgIC8vfVxyXG5cclxuICAgIGlmIChLUUNhcmQuaXNMaXVEdWlCYW4oY2FyZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLkxpdUR1aUJhbjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoS1FDYXJkLmlzU2FuVG9uZ0h1YShjYXJkcykpIHtcclxuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuVGFvSHVhO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChLUUNhcmQuaXNTYW5TaHVuWmkoY2FyZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNhblNodW5aaTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy9pZiAoS1FDYXJkLmlzQ291WWlTZShjYXJkcykpIHtcclxuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5Db3VZaVNlO1xyXG4gICAgLy99XHJcbiAgICAvL1xyXG4gICAgLy9pZiAoS1FDYXJkLmlzV3VEdWlTYW5UaWFvKGNhcmRzKSkge1xyXG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1RHVpU2FuVGlhbztcclxuICAgIC8vfVxyXG4gICAgLy9cclxuICAgIC8vaWYgKEtRQ2FyZC5pc1NpVGFvU2FuVGlhbyhjYXJkcykpIHtcclxuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5TaVRhb1NhblRpYW87XHJcbiAgICAvL31cclxuXHJcbiAgICAvKiMjIyMjKi9cclxuICAgIGlmIChLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcywgNSkpIHtcclxuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuV3VUb25nO1xyXG4gICAgfVxyXG5cclxuICAgIC8vaWYgKEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRzKSkge1xyXG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1VG9uZztcclxuICAgIC8vfVxyXG4gICAgLy9cclxuICAgIC8vaWYgKEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRzKSkge1xyXG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1VG9uZztcclxuICAgIC8vfVxyXG4gICAgLyojIyMjIyovXHJcblxyXG4gICAgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMsIDUpKSB7XHJcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlRvbmdIdWFTaHVuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChLUUNhcmQuY29udGFpblRpZVpoaShjYXJkcykpIHtcclxuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuVGllWmhpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChLUUNhcmQuY29udGFpbkh1THUoY2FyZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLkh1THU7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YShjYXJkcykpIHtcclxuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuVG9uZ0h1YTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5TaHVuWmkoY2FyZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNodW5aaTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5TYW5UaWFvKGNhcmRzKSkge1xyXG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5UaWFvO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChLUUNhcmQuY29udGFpbkxpYUR1aShjYXJkcykpIHtcclxuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuTGlhbmdEdWk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKEtRQ2FyZC5jb250YWluRHVpWmkoY2FyZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLkR1aVppO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBLUUNhcmQuVFlQRS5XdUxvbmc7XHJcbn07XHJcblxyXG4vLyDliKTmlq3mmK/lkKbmmK/lkIzoirFcclxuS1FDYXJkLmlzVG9uZ0h1YSA9IGZ1bmN0aW9uKGNhcmRzLCBtaW5MZW5ndGggPSAzKSB7XHJcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBjb2xvcnMgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICByZXR1cm4gY2FyZC5jb2xvcjtcclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb2xvciA9IGNvbG9yc1swXTtcclxuICAgIGZvciAobGV0IGluZGV4IGluIGNvbG9ycykge1xyXG4gICAgICAgIGxldCBlID0gY29sb3JzW2luZGV4XTtcclxuICAgICAgICBpZiAoZSAhPSBjb2xvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn07XHJcblxyXG4vLyDmmK/lkKbljIXlkKvlkIzoirFcclxuS1FDYXJkLmNvbnRhaW5Ub25nSHVhID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XHJcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLy9pZiAoS1FDYXJkLmZpbmRUb25nSHVhKGNhcmRzKS5sZW5ndGggPiAwKSB7XHJcbiAgICAvLyAgICByZXR1cm4gdHJ1ZTtcclxuICAgIC8vfVxyXG4gICAgLy9yZXR1cm4gZmFsc2U7XHJcbiAgICBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xyXG4gICAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xyXG5cclxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcclxuICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKTtcclxuICAgIG1pbkxlbmd0aCA9IG1pbkxlbmd0aC1jYXJkMjAubGVuZ3RoO1xyXG5cclxuICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbWluTGVuZ3RoKSA8PSBjYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcclxuICAgICAgICBsZXQgc3ViQ2FyZHMgPSBjYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBtaW5MZW5ndGgpO1xyXG4gICAgICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBtaW5MZW5ndGgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWEyMChjYXJkcyk7XHJcbn07XHJcbktRQ2FyZC5jb250YWluVG9uZ0h1YTIwID0gZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgIGlmIChjYXJkLmxlbmd0aCA8IDUpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkKTtcclxuICAgIHZhciBjYXJkcyA9IGNhcmQua3FfZXhjbHVkZXMoY2FyZDIwKTtcclxuICAgIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcclxuXHJcbiAgICBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xyXG4gICAgICAgIHZhciBudW0gPSA1IC0gajtcclxuICAgICAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gY2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XHJcbiAgICAgICAgICAgIHZhciBzdWJDYXJkcyA9IGNhcmRzLnNsaWNlKHN0YXJ0LCBzdGFydCArIG51bSk7XHJcbiAgICAgICAgICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBudW0pKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufTtcclxuLy8g5Yik5pat5piv5ZCm5piv6aG65a2QXHJcbktRQ2FyZC5pc1NodW5aaSA9IGZ1bmN0aW9uKGNhcmRzLCBtaW5MZW5ndGggPSAzKSB7XHJcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChLUUNhcmQuX2lzU2h1blppQUtRKGNhcmRzKSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBwb2ludHMgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICByZXR1cm4gY2FyZC5wb2ludDtcclxuICAgIH0pLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xyXG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHBvaW50ID0gcG9pbnRzWzBdO1xyXG4gICAgZm9yICh2YXIgaW5kZXggaW4gcG9pbnRzKSB7XHJcbiAgICAgICAgdmFyIGUgPSBwb2ludHNbaW5kZXhdO1xyXG4gICAgICAgIGlmIChlICE9IHBvaW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHBvaW50ID0gcG9pbnQgKyAxO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0cnVlO1xyXG59O1xyXG5cclxuLy8g5Yik5pat5piv5ZCm5pivIEEgSyBRIEogMTAg6L+Z5Liq6aG65a2QXHJcbktRQ2FyZC5faXNTaHVuWmlBS1EgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIGxldCBsZW5ndGggPSBjYXJkcy5sZW5ndGg7XHJcbiAgICBpZiAobGVuZ3RoLmxlbmd0aCA8IDMpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHBvaW50MXMgPSBbMV07XHJcbiAgICBsZXQgcG9pbnQxNHMgPSBbMTRdO1xyXG4gICAgbGV0IHBvaW50SyA9IDEzO1xyXG5cclxuICAgIE51bWJlcihsZW5ndGggLSAxKS5rcV90aW1lcyhmdW5jdGlvbih0aW1lcykge1xyXG4gICAgICAgIHBvaW50MXMucHVzaChwb2ludEsgLSB0aW1lcyk7XHJcbiAgICAgICAgcG9pbnQxNHMucHVzaChwb2ludEsgLSB0aW1lcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gS1FDYXJkLl9pc0NhcmRzQ29udGFpblBvaW50cyhjYXJkcywgcG9pbnQxcykgfHwgS1FDYXJkLl9pc0NhcmRzQ29udGFpblBvaW50cyhjYXJkcywgcG9pbnQxNHMpO1xyXG59O1xyXG5cclxuLy8gY2FyZHMg5Lit5piv5ZCm5YyF5ZCrIHBvaW50cyDov5nkupvngrnmlbBcclxuXHJcbktRQ2FyZC5faXNDYXJkc0NvbnRhaW5Qb2ludHMgPSBmdW5jdGlvbihjYXJkcywgcG9pbnRzKSB7XHJcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcG9pbnRzLmxlbmd0aDsgKytpbmRleCkge1xyXG4gICAgICAgIGxldCBwb2ludCA9IHBvaW50c1tpbmRleF07XHJcbiAgICAgICAgbGV0IHBvaW50Q2FyZEluZGV4ID0gY2FyZHMuZmluZEluZGV4KGZ1bmN0aW9uKGNhcmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gcG9pbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChwb2ludENhcmRJbmRleCA8IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufTtcclxuS1FDYXJkLmNvbnRhaW4yMCA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgaWYoY2FyZHMubGVuZ3RoIDw9IDApe1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5wb2ludCkgPT0gJ3VuZGVmaW5lZCcpe1xyXG4gICAgICAgIGNhcmRzID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRzKTtcclxuICAgIH1cclxuICAgIHZhciBuZXdDYXJkID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGNhcmQpey8v6YeN5paw6LWL5YC8Y2FyZHNcclxuICAgICAgICBpZihjYXJkLnBvaW50ID49IDIwKXtcclxuICAgICAgICAgICAgcmV0dXJuIGNhcmQ7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbmV3Q2FyZCB8fCBbXTtcclxufTtcclxuLy8g5piv5ZCm5YyF5ZCr6aG65a2QXHJcbktRQ2FyZC5jb250YWluU2h1blppID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XHJcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgaWYgKEtRQ2FyZC5maW5kU2h1blppKGNhcmRzKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAvL2xldCB1bmlxdWVDYXJkcyA9IGNhcmRzLnVuaXF1ZShmdW5jdGlvbihjYXJkMSwgY2FyZDIpIHtcclxuICAgIC8vICAgIHJldHVybiBjYXJkMS5wb2ludCA9PSBjYXJkMi5wb2ludDtcclxuICAgIC8vfSk7XHJcbiAgICAvL3VuaXF1ZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KTtcclxuICAgIC8vXHJcbiAgICAvL2xldCBtaW5Qb2ludENhcmQgPSB1bmlxdWVDYXJkc1swXTtcclxuICAgIC8vaWYgKG1pblBvaW50Q2FyZC5wb2ludCA9PSAxKSB7XHJcbiAgICAvLyAgICBsZXQgQVBsdXNDYXJkID0gbmV3IEtRQ2FyZChtaW5Qb2ludENhcmQpO1xyXG4gICAgLy8gICAgQVBsdXNDYXJkLnBvaW50ID0gMTQ7XHJcbiAgICAvLyAgICB1bmlxdWVDYXJkcy5wdXNoKEFQbHVzQ2FyZCk7XHJcbiAgICAvL31cclxuICAgIC8vXHJcbiAgICAvL2ZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbWluTGVuZ3RoKSA8PSB1bmlxdWVDYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcclxuICAgIC8vICAgIGxldCBzdWJDYXJkcyA9IHVuaXF1ZUNhcmRzLnNsaWNlKHN0YXJ0LCBzdGFydCArIG1pbkxlbmd0aCk7XHJcbiAgICAvLyAgICBpZiAoS1FDYXJkLmlzU2h1blppKHN1YkNhcmRzLCBtaW5MZW5ndGgpKSB7XHJcbiAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAvLyAgICB9XHJcbiAgICAvL31cclxuICAgIC8vXHJcbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpblNodW5aaTIwKGNhcmRzKTtcclxufTtcclxuLypLUUNhcmQuY29udGFpblNodW5aaTIwID0gZnVuY3Rpb24gKGNhcmQpIHtcclxuIGlmIChjYXJkLmxlbmd0aCA8IDUpIHtcclxuIHJldHVybiBmYWxzZTtcclxuIH1cclxuIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmQpO1xyXG4gdmFyIGNhcmRzID0gY2FyZC5rcV9leGNsdWRlcyhjYXJkMjApO1xyXG4gLy8g5YWI5qC55o2u54K55pWw5Y676YeNXHJcbiB2YXIgbmV3QXJyID0gW107XHJcbiB2YXIgbmV3QXJycyA9IFtdO1xyXG4gZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkcy5sZW5ndGg7IGkrKykge1xyXG4gaWYgKG5ld0FycnMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpIHtcclxuIG5ld0Fyci5wdXNoKGNhcmRzW2ldKTtcclxuIG5ld0FycnMucHVzaChjYXJkc1tpXS5wb2ludCk7XHJcbiB9XHJcbiB9XHJcbiAvL25ld0Fyci5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe1xyXG4gLy8gICAgaWYoY2FyZC5zY29yZXMgPT0gMTQpe1xyXG4gLy8gICAgICAgIGNhcmQuc2NvcmVzID0gMTtcclxuIC8vICAgIH1cclxuIC8vfSlcclxuIG5ld0Fyci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcclxuIHJldHVybiBuMS5wb2ludCAtIG4yLnBvaW50O1xyXG4gfSk7XHJcbiBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xyXG4gdmFyIG51bSA9IDUgLSBqO1xyXG4gZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IG5ld0Fyci5sZW5ndGg7ICsrc3RhcnQpIHtcclxuIHZhciBzdWJDYXJkcyA9IG5ld0Fyci5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xyXG4gdmFyIGJvb2wgPSBwYXJzZUludChzdWJDYXJkc1tudW0tMV1bJ3Njb3JlcyddKSAtIHBhcnNlSW50KHN1YkNhcmRzWzBdWydzY29yZXMnXSkgPCA1O1xyXG4gaWYoYm9vbCl7XHJcbiByZXR1cm4gdHJ1ZTtcclxuIH1cclxuIH1cclxuIH1cclxuIC8vIOeUseS6jueCueaVsOaYr+WUr+S4gOS4lOWNh+W6j++8jOWPqumcgOimgeS+neasoemBjeWOhuWIpOaWreaYr+WQpuaYr+mhuuWtkOWNs+WPr1xyXG4gbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkKTtcclxuIGlmIChjYXJkID09PSBjb252ZXJ0ZWRDYXJkcykge1xyXG4gcmV0dXJuIGZhbHNlO1xyXG4gfVxyXG4gcmV0dXJuIEtRQ2FyZC5jb250YWluU2h1blppMjAoY29udmVydGVkQ2FyZHMpO1xyXG4gfTsqL1xyXG4vLyDmmK/lkKbmmK/lkIzoirHpobpcclxuS1FDYXJkLmlzVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIHJldHVybiBLUUNhcmQuaXNUb25nSHVhKGNhcmRzKSAmJiBLUUNhcmQuaXNTaHVuWmkoY2FyZHMpO1xyXG59O1xyXG5cclxuLy8g5piv5ZCm5YyF5ZCr5pyJ5ZCM6Iqx6aG6XHJcbktRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAoY2FyZHMsIG1pbkxlbmd0aCA9IDUpIHtcclxuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZiAoS1FDYXJkLmZpbmRUb25nSHVhU2h1bihjYXJkcykubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgLy92YXIgc2FuU2h1blppID0gS1FDYXJkLnNhblNodW5aaTEoY2FyZHMsbWluTGVuZ3RoKVswXTtcclxuICAgIC8vaWYoc2FuU2h1blppID09IG51bGwpe1xyXG4gICAgLy8gICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgLy99XHJcbiAgICAvL3ZhciByZXN1bHQgPSBmYWxzZTtcclxuICAgIC8vZm9yKHZhciBpPTA7aTxzYW5TaHVuWmkubGVuZ3RoO2krKykge1xyXG4gICAgLy8gICAgdmFyIHMgPSBzYW5TaHVuWmlbaV07XHJcbiAgICAvLyAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YVNodW4ocywgbWluTGVuZ3RoKSkge1xyXG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgLy8gICAgfVxyXG4gICAgLy99XHJcbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMShjYXJkcyk7XHJcblxyXG59O1xyXG4vKktRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4xID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XHJcbiBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XHJcbiByZXR1cm4gZmFsc2U7XHJcbiB9XHJcbiBsZXQgdGVtcENhcmRzID0gQXJyYXkuZnJvbShjYXJkcykuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xyXG4gZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBtaW5MZW5ndGgpIDw9IHRlbXBDYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcclxuIGxldCBzdWJDYXJkcyA9IHRlbXBDYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBtaW5MZW5ndGgpO1xyXG4gaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHN1YkNhcmRzLCBtaW5MZW5ndGgpKSB7XHJcbiByZXR1cm4gdHJ1ZTtcclxuIH1cclxuIH1cclxuXHJcbiBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRzKTtcclxuIGlmIChjYXJkcyA9PT0gY29udmVydGVkQ2FyZHMpIHtcclxuIHJldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMjAoY2FyZHMpO1xyXG4gfVxyXG4gcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4xKGNvbnZlcnRlZENhcmRzKTtcclxuIC8vcmV0dXJuIGZhbHNlO1xyXG4gfTtcclxuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4yMCA9IGZ1bmN0aW9uIChjYXJkLCBtaW5MZW5ndGggPSA1KSB7XHJcbiBpZiAoY2FyZC5sZW5ndGggPCBtaW5MZW5ndGgpIHtcclxuIHJldHVybiBmYWxzZTtcclxuIH1cclxuIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmQpIHx8IFtdO1xyXG4gdmFyIGNhcmRzID0gY2FyZC5rcV9leGNsdWRlcyhjYXJkMjApO1xyXG5cclxuIGNhcmRzID0gQXJyYXkuZnJvbShjYXJkcyk7XHJcbiB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXHJcbiB2YXIgY29sb3JIID0gW107IC8v57qi5b+DXHJcbiB2YXIgY29sb3JDID0gW107IC8v5qKF6IqxXHJcbiB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXHJcbiB2YXIgcG9pbnRTID0gW107IC8v6buR5qGDXHJcbiB2YXIgcG9pbnRIID0gW107IC8v57qi5b+DXHJcbiB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXHJcbiB2YXIgcG9pbnREID0gW107IC8v5pa55Z2XXHJcbiBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aDtpKyspe1xyXG4gaWYoY2FyZHNbaV0uY29sb3IgPT0gJzQnKXtcclxuIGlmKHBvaW50Uy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XHJcbiBwb2ludFMucHVzaChjYXJkc1tpXS5wb2ludCk7XHJcbiBjb2xvclMucHVzaChjYXJkc1tpXSk7XHJcbiB9XHJcblxyXG4gfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzMnKXtcclxuIGlmKHBvaW50SC5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XHJcbiBwb2ludEgucHVzaChjYXJkc1tpXS5wb2ludCk7XHJcbiBjb2xvckgucHVzaChjYXJkc1tpXSk7XHJcbiB9XHJcbiB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMicpe1xyXG4gaWYocG9pbnRDLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcclxuIHBvaW50Qy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcclxuIGNvbG9yQy5wdXNoKGNhcmRzW2ldKTtcclxuIH1cclxuIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcxJyl7XHJcbiBpZihwb2ludEQuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xyXG4gcG9pbnRELnB1c2goY2FyZHNbaV0ucG9pbnQpO1xyXG4gY29sb3JELnB1c2goY2FyZHNbaV0pO1xyXG4gfVxyXG4gfVxyXG4gfVxyXG5cclxuIHZhciBjb2xvciA9IFtjb2xvclMsY29sb3JILGNvbG9yQyxjb2xvckRdO1xyXG4gdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXHJcbiBmb3IodmFyIGk9MDtpPGNvbG9yLmxlbmd0aDtpKyspe1xyXG4gaWYoY29sb3JbaV0ubGVuZ3RoID49IHBhcnNlSW50KDUgLSBjYXJkMjAubGVuZ3RoKSl7XHJcbiAvL2NvbG9yW2ldLmZvckVhY2goZnVuY3Rpb24oY2Epe1xyXG4gLy8gICAgaWYoY2Euc2NvcmVzID09IDE0KXtcclxuIC8vICAgICAgICBjYS5zY29yZXMgPSAxO1xyXG4gLy8gICAgfVxyXG4gLy99KVxyXG4gY29sb3JbaV0uc29ydChmdW5jdGlvbihhMSxhMil7XHJcbiByZXR1cm4gYTEgLSBhMjtcclxuIH0pXHJcbiBjb2xvclN1bS5wdXNoKGNvbG9yW2ldKTtcclxuIH1cclxuIH1cclxuXHJcbiBmb3IodmFyIGk9MDtpPGNvbG9yU3VtLmxlbmd0aDtpKyspIHtcclxuIHZhciBzID0gY29sb3JTdW1baV1cclxuIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XHJcbiB2YXIgbnVtID0gNSAtIGo7XHJcbiBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gcy5sZW5ndGg7ICsrc3RhcnQpIHtcclxuIHZhciBzdWJDYXJkcyA9IHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcclxuIHZhciBib29sID0gcGFyc2VJbnQoc3ViQ2FyZHNbbnVtLTFdWydzY29yZXMnXSkgLSBwYXJzZUludChzdWJDYXJkc1swXVsnc2NvcmVzJ10pIDwgNTtcclxuIGlmKGJvb2wpe1xyXG4gcmV0dXJuIHRydWU7XHJcbiB9XHJcbiB9XHJcbiB9XHJcbiB9XHJcblxyXG5cclxuXHJcbiBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmQpO1xyXG4gaWYgKGNhcmQgPT09IGNvbnZlcnRlZENhcmRzKSB7XHJcbiByZXR1cm4gZmFsc2U7XHJcbiB9XHJcbiByZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bjIwKGNvbnZlcnRlZENhcmRzKTtcclxuIH07Ki9cclxuXHJcblxyXG4vLyDmmK/lkKbmmK/muIXpvplcclxuS1FDYXJkLmlzUWluZ0xvbmcgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIGxldCBsZW5ndGggPSAxMztcclxuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xyXG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcclxuICAgIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcclxuICAgIHZhciBjb2xvckMgPSBbXTsgLy/mooXoirFcclxuICAgIHZhciBjb2xvckQgPSBbXTsgLy/mlrnlnZdcclxuICAgIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgaWYoY2FyZHNbaV0uc3VpdCA9PSAncycpe1xyXG4gICAgICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnaCcpe1xyXG4gICAgICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnYycpe1xyXG4gICAgICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnZCcpe1xyXG4gICAgICAgICAgICBjb2xvckQucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmFyIGxzID0gY29sb3JTLmxlbmd0aDsgIC8v6buR5qGD5Liq5pWwXHJcbiAgICB2YXIgbGggPSBjb2xvckgubGVuZ3RoOyAgLy/nuqLmoYPkuKrmlbBcclxuICAgIHZhciBsYyA9IGNvbG9yQy5sZW5ndGg7ICAvL+aiheiKseS4quaVsFxyXG4gICAgdmFyIGxkID0gY29sb3JELmxlbmd0aDsgIC8v5pa55Z2X5Liq5pWwXHJcbiAgICB2YXIgY29sb3IgPSBbbHMsbGgsbGMsbGRdO1xyXG4gICAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXHJcbiAgICBmb3IodmFyIGk9MDtpPGNvbG9yLmxlbmd0aDtpKyspe1xyXG4gICAgICAgIGlmKGNvbG9yW2ldICE9IDApe1xyXG4gICAgICAgICAgICBjb2xvclN1bS5wdXNoKGNvbG9yW2ldKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZihjb2xvclN1bS5sZW5ndGggPT0gMSl7XHJcbiAgICAgICAgaWYoY29sb3JTdW1bMF0gPT0gMTMpe1xyXG5cclxuICAgICAgICAgICAgaWYoS1FDYXJkLmlzWWlUaWFvTG9uZyhjYXJkcykpe1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB0ZVNodUNhcmQgPSBjYXJkcy5maWx0ZXIoZnVuY3Rpb24oaSl7cmV0dXJuIGl9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB0ZVNodUNhcmQgPSBLUUNhcmQuY2FyZHNGcm9tQXJyYXkodGVTaHVDYXJkKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0ZVNodUNhcmQuZm9yRWFjaChmdW5jdGlvbihhKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihhLnNjb3JlcyA9PSAxKSBhLnNjb3JlcyA9IDE0O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGVTaHVDYXJkLnNvcnQoZnVuY3Rpb24oYSxiKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYi5zY29yZXMgLSBhLnNjb3JlcztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyh0ZVNodUNhcmQpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBhMSA9IHRlU2h1Q2FyZC5zcGxpY2UoMCw1KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgYTIgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9IFt0ZVNodUNhcmQsIGEyLCBhMV07XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy9yZXR1cm4gS1FDYXJkLmlzVG9uZ0h1YVNodW4oY2FyZHMpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG5cclxuLy8g5piv5ZCm5piv5LiA5p2h6b6ZXHJcbktRQ2FyZC5pc0xvbmcgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIGxldCBsZW5ndGggPSAxMztcclxuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBLUUNhcmQuaXNTaHVuWmkoY2FyZHMpO1xyXG59O1xyXG5cclxuLyojIyMjIyovXHJcbi8q5piv5ZCm5LiA5p2h6b6ZKi9cclxuS1FDYXJkLmlzWWlUaWFvTG9uZyA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgLy9jYXJkczp7bnVtYmVyOjF+MTMgLCdzdWl0JzonaCcuLi59XHJcbiAgICB2YXIgbGVuZ3RoID0gMTM7XHJcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xyXG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZih0eXBlb2YoY2FyZHNbMF0ubnVtYmVyKSA9PSAndW5kZWZpbmVkJyl7XHJcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMoY2FyZHMpO1xyXG4gICAgfVxyXG4gICAgdmFyIG51bWJlciA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgIHJldHVybiBjYXJkLm51bWJlcjtcclxuICAgIH0pLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xyXG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xyXG4gICAgfSk7XHJcbiAgICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aC0xO2krKykge1xyXG4gICAgICAgIGlmKG51bWJlcltpXSAhPSBudW1iZXJbaSsxXSAtIDEpe1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHZhciB0ZVNodUNhcmQgPSBjYXJkcy5maWx0ZXIoZnVuY3Rpb24oaSl7cmV0dXJuIGl9KTtcclxuXHJcbiAgICB0ZVNodUNhcmQgPSBLUUNhcmQuY2FyZHNGcm9tQXJyYXkodGVTaHVDYXJkKTtcclxuXHJcbiAgICB0ZVNodUNhcmQuZm9yRWFjaChmdW5jdGlvbihhKXtcclxuICAgICAgICBpZihhLnNjb3JlcyA9PSAxKSBhLnNjb3JlcyA9IDE0O1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGVTaHVDYXJkLnNvcnQoZnVuY3Rpb24oYSxiKXtcclxuICAgICAgICByZXR1cm4gYi5zY29yZXMgLSBhLnNjb3JlcztcclxuICAgIH0pO1xyXG5cclxuICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyh0ZVNodUNhcmQpO1xyXG5cclxuICAgIHZhciBhMSA9IHRlU2h1Q2FyZC5zcGxpY2UoMCw1KTtcclxuXHJcbiAgICB2YXIgYTIgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XHJcblxyXG4gICAgY2MudGVTaHVQYWlDYXJkcyA9IFt0ZVNodUNhcmQsIGEyLCBhMV07XHJcbiAgICAvL2NjLmxvZyhjYy50ZVNodVBhaUNhcmRzIClcclxuICAgIC8vY2MubG9nKCctLS0tLS0tLTcyOCcpXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufTtcclxuLyojIyMjIyovXHJcbi8q5piv5ZCm5LiJ5ZCM6IqxKi9cclxuS1FDYXJkLmlzU2FuVG9uZ0h1YSA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdmFyIGxlbmd0aCA9IDEzO1xyXG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcclxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZihjYXJkc1swXS5zdWl0KSA9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzKGNhcmRzKTtcclxuICAgIH1cclxuICAgIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcclxuICAgIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcclxuICAgIHZhciBjb2xvckMgPSBbXTsgLy/mooXoirFcclxuICAgIHZhciBjb2xvckQgPSBbXTsgLy/mlrnlnZdcclxuICAgIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgaWYoY2FyZHNbaV0uc3VpdCA9PSAncycpe1xyXG4gICAgICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnaCcpe1xyXG4gICAgICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnYycpe1xyXG4gICAgICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnZCcpe1xyXG4gICAgICAgICAgICBjb2xvckQucHVzaChjYXJkc1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmFyIGxzID0gY29sb3JTLmxlbmd0aDsgIC8v6buR5qGD5Liq5pWwXHJcbiAgICB2YXIgbGggPSBjb2xvckgubGVuZ3RoOyAgLy/nuqLmoYPkuKrmlbBcclxuICAgIHZhciBsYyA9IGNvbG9yQy5sZW5ndGg7ICAvL+aiheiKseS4quaVsFxyXG4gICAgdmFyIGxkID0gY29sb3JELmxlbmd0aDsgIC8v5pa55Z2X5Liq5pWwXHJcbiAgICB2YXIgc2FuQ2FyZCA9IFtjb2xvclMsY29sb3JILGNvbG9yQyxjb2xvckRdO1xyXG4gICAgdmFyIHRlU2h1Q2FyZCA9IFtdO1xyXG4gICAgdmFyIGNvbG9yID0gW2xzLGxoLGxjLGxkXTtcclxuICAgIHZhciBjb2xvclN1bSA9IFtdOyAgICAvL+aAu+WFseacieWHoOenjeiKseiJsiBbNSwzLDAuLi4uXVxyXG4gICAgZm9yKHZhciBpPTA7aTxjb2xvci5sZW5ndGg7aSsrKXtcclxuICAgICAgICBpZihjb2xvcltpXSAhPSAwKXtcclxuICAgICAgICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XHJcbiAgICAgICAgICAgIHRlU2h1Q2FyZC5wdXNoKHNhbkNhcmRbaV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL+S4ieenjeiKseiJslxyXG4gICAgaWYoY29sb3JTdW0ubGVuZ3RoID09IDMpe1xyXG4gICAgICAgIGZvcih2YXIgaT0wO2k8Y29sb3JTdW0ubGVuZ3RoO2krKykge1xyXG4gICAgICAgICAgICBpZiAoY29sb3JTdW1baV0gIT0gNSAmJiBjb2xvclN1bVtpXSAhPSAzKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0ZVNodUNhcmQuc29ydChmdW5jdGlvbihhLGIpe1xyXG4gICAgICAgICAgICByZXR1cm4gYS5sZW5ndGggLSBiLmxlbmd0aDtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy50ZVNodVBhaUNhcmRzID0gdGVTaHVDYXJkO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG5cclxufTtcclxuLyrmmK/lkKblh5HkuIDoibIqL1xyXG5LUUNhcmQuaXNDb3VZaVNlID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICB2YXIgbGVuZ3RoID0gMTM7XHJcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xyXG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZih0eXBlb2YoY2FyZHNbMF0uc3VpdCkgPT0gJ3VuZGVmaW5lZCcpe1xyXG4gICAgICAgIGNhcmRzID0gS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XHJcbiAgICB9XHJcbiAgICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXHJcbiAgICB2YXIgY29sb3JIID0gW107IC8v57qi5b+DXHJcbiAgICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aDtpKyspe1xyXG4gICAgICAgIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ3MnIHx8IGNhcmRzW2ldLnN1aXQgPT0gJ2MnKXtcclxuICAgICAgICAgICAgY29sb3JTLnB1c2goY2FyZHNbaV0pOy8v5YWo6buRXHJcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnaCcgfHwgY2FyZHNbaV0uc3VpdCA9PSAnZCcpe1xyXG4gICAgICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7Ly/lhajnuqJcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy/lpoLmnpzniYzkuK3ljIXlkKvlm5vnp43oirHoibLlsLHkuI3lj6/og73mmK/kuInlkIzoirFcclxuICAgIGlmKGNvbG9yUy5sZW5ndGggPT0gMTMgfHwgY29sb3JILmxlbmd0aCA9PSAxMyl7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICAvL2Vsc2UgaWYoY29sb3JILmxlbmd0aCA9PSAxMyl7XHJcbiAgICAvLyAgICByZXR1cm4gdHJ1ZTtcclxuICAgIC8vfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG4vKiMjIyMjKi9cclxuLy8g5piv5ZCm5piv5YWt5a+55Y2KXHJcbktRQ2FyZC5pc0xpdUR1aUJhbiA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgbGV0IGxlbmd0aCA9IDEyO1xyXG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgZHVpWmlMZW5ndGggPSAyO1xyXG4gICAgLy/orqHnrpfkuIDkuKrniYzmlbDnu4TlhoXnmoTnm7jlkIzngrnmlbDnmoTniYznmoTlvKDmlbBcclxuICAgIGxldCBjYXJkTnVtYmVycyA9IG5ldyBHZXRDYXJkUG9pbnRzU2FtZUNvdW50KGNhcmRzKTtcclxuICAgIGxldCBudW1iZXJPZkR1aVppID0gMDtcclxuICAgIGxldCBudW1iZXJPZllpID0gMDtcclxuICAgIGZvciAobGV0IHByb3AgaW4gY2FyZE51bWJlcnMpIHtcclxuICAgICAgICBsZXQgdmFsdWUgPSBjYXJkTnVtYmVyc1twcm9wXTtcclxuICAgICAgICBpZiAodmFsdWUgPT0gZHVpWmlMZW5ndGggfHwgdmFsdWUgPT0gMykge1xyXG4gICAgICAgICAgICBudW1iZXJPZkR1aVppID0gbnVtYmVyT2ZEdWlaaSArIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IDQpIHtcclxuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL2Vsc2UgaWYgKHZhbHVlID09IDYgfHwgdmFsdWUgPT0gNyB8fCB2YWx1ZSA9PSA1KSB7XHJcbiAgICAgICAgLy8gICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAwO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IDEpIHtcclxuICAgICAgICAgICAgbnVtYmVyT2ZZaSArPSAxO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZihudW1iZXJPZkR1aVppID09IDYpe1xyXG5cclxuICAgICAgICB2YXIgdGVTaHVDYXJkID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpfSk7XHJcblxyXG4gICAgICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheSh0ZVNodUNhcmQpO1xyXG5cclxuICAgICAgICB0ZVNodUNhcmQuZm9yRWFjaChmdW5jdGlvbihhKXtcclxuICAgICAgICAgICAgaWYoYS5zY29yZXMgPT0gMSkgYS5zY29yZXMgPSAxNDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVTaHVDYXJkLnNvcnQoZnVuY3Rpb24oYSxiKXtcclxuICAgICAgICAgICAgcmV0dXJuIGIuc2NvcmVzIC0gYS5zY29yZXM7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRlU2h1Q2FyZCA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyh0ZVNodUNhcmQpO1xyXG5cclxuICAgICAgICB2YXIgYTEgPSB0ZVNodUNhcmQuc3BsaWNlKDAsNSk7XHJcblxyXG4gICAgICAgIHZhciBhMiA9IHRlU2h1Q2FyZC5zcGxpY2UoMCw1KTtcclxuXHJcbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9IFt0ZVNodUNhcmQsIGEyLCBhMV07XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG5cclxuS1FDYXJkLmlzV3VEdWlTYW5UaWFvID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICBsZXQgbGVuZ3RoID0gMTM7XHJcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBkdWlaaUxlbmd0aCA9IDI7XHJcbiAgICBsZXQgc2FuVGlhb0xlbmd0aCA9IDM7XHJcbiAgICAvL+iuoeeul+S4gOS4queJjOaVsOe7hOWGheeahOebuOWQjOeCueaVsOeahOeJjOeahOW8oOaVsFxyXG4gICAgbGV0IGNhcmROdW1iZXJzID0gbmV3IEdldENhcmRQb2ludHNTYW1lQ291bnQoY2FyZHMpO1xyXG4gICAgbGV0IG51bWJlck9mRHVpWmkgPSAwO1xyXG4gICAgbGV0IG51bWJlck9mU2FuVGlhbyA9IDA7XHJcbiAgICBmb3IgKGxldCBwcm9wIGluIGNhcmROdW1iZXJzKSB7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gY2FyZE51bWJlcnNbcHJvcF07XHJcbiAgICAgICAgaWYgKHZhbHVlID09IGR1aVppTGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPT0gc2FuVGlhb0xlbmd0aCkge1xyXG4gICAgICAgICAgICBudW1iZXJPZlNhblRpYW8gPSBudW1iZXJPZlNhblRpYW8gKyAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSA+PSA0KSB7XHJcbiAgICAgICAgICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVtYmVyT2ZEdWlaaSA9PSA1ICYmIG51bWJlck9mU2FuVGlhbyA9PSAxO1xyXG59O1xyXG5cclxuLy/liKTmlq015byg5oiW6ICFM+W8oOaYr+WQpumhuuWtkFxyXG5LUUNhcmQuaXNTaHVuWmkxID0gZnVuY3Rpb24oYXJyKXtcclxuICAgIC8vY29uc29sZS5sb2coYXJyKTtcclxuICAgIGZvcih2YXIgaT0wO2k8YXJyLmxlbmd0aC0xO2krKyl7XHJcbiAgICAgICAgaWYoYXJyW2krMV0gLSBhcnJbaV0gIT0gMSl7XHJcbiAgICAgICAgICAgIC8v5LiN5piv6aG65a2QXHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCLkuI3mmK/pobrlrZBcIik7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufTtcclxuXHJcbktRQ2FyZC5pc1NhblNodW5aaSA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdmFyIGxlbmd0aCA9IDEzO1xyXG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpZih0eXBlb2YoY2FyZHNbMF0uc3VpdCkgPT0gJ3VuZGVmaW5lZCcpe1xyXG4gICAgICAgIGNhcmRzID0gS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy/lj5blh7rniYznmoTngrnmlbBcclxuICAgIHZhciBudW1iZXIgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICByZXR1cm4gY2FyZC5udW1iZXI7XHJcbiAgICB9KTtcclxuICAgIC8v5o6S5bqPXHJcbiAgICBudW1iZXIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XHJcbiAgICAgICAgcmV0dXJuIG4xIC0gbjI7XHJcbiAgICB9KTtcclxuICAgIGlmKEtRQ2FyZC5mZW5aaHUobnVtYmVyLDUsNSkgPT0gZmFsc2Upe1xyXG4gICAgICAgIHZhciBudW1iZXIgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNhcmQubnVtYmVyO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8v5o6S5bqPXHJcbiAgICAgICAgbnVtYmVyLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xyXG4gICAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZihLUUNhcmQuZmVuWmh1KG51bWJlciw1LDMpID09IGZhbHNlKXtcclxuICAgICAgICAgICAgdmFyIG51bWJlciA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhcmQubnVtYmVyO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy/mjpLluo9cclxuICAgICAgICAgICAgbnVtYmVyLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG4xIC0gbjI7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZihLUUNhcmQuZmVuWmh1KG51bWJlciwzLDUpID09IGZhbHNlKXtcclxuICAgICAgICAgICAgICAgIC8v5LiN5piv5LiJ6aG65a2QXHJcbiAgICAgICAgICAgICAgICB2YXIgQUlzRXhpc3QgPSBmYWxzZTsgIC8v5piv5ZCm5a2Y5ZyoQVxyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpIGluIGNhcmRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoY2FyZHNbaV0ubnVtYmVyID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQUlzRXhpc3QgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwi5a2Y5ZyoQVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYoIUFJc0V4aXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIumAgOWHuumAkuW9klwiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpIGluIGNhcmRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoY2FyZHNbaV0ubnVtYmVyID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkHovazkuLoxNFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNbaV0ubnVtYmVyID0gMTQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKGNjLnRlU2h1UGFpQ2FyZHMgJiYgY2MudGVTaHVQYWlDYXJkcy5sZW5ndGggPiAwICYmIGNjLnRlU2h1UGFpQ2FyZHNbMF1bMF0gICYmIHR5cGVvZihjYy50ZVNodVBhaUNhcmRzWzBdWzBdKSA9PSAnbnVtYmVyJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0NhcmRzID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpO30pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdDYXJkczEgPSBjYy50ZVNodVBhaUNhcmRzLm1hcChmdW5jdGlvbihhcnIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FkID0gYXJyLm1hcChmdW5jdGlvbihudW1iZXIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IG5ld0NhcmRzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihuZXdDYXJkc1tpXS5udW1iZXIgPT0gbnVtYmVyKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld0NhcmRzLnNwbGljZShpLDEpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FkO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMgPSBuZXdDYXJkczE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gS1FDYXJkLmlzU2FuU2h1blppKGNhcmRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmKGNjLnRlU2h1UGFpQ2FyZHMgJiYgY2MudGVTaHVQYWlDYXJkcy5sZW5ndGggPiAwICYmIGNjLnRlU2h1UGFpQ2FyZHNbMF1bMF0gICYmIHR5cGVvZihjYy50ZVNodVBhaUNhcmRzWzBdWzBdKSA9PSAnbnVtYmVyJyl7XHJcbiAgICAgICAgdmFyIG5ld0NhcmRzID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpO30pO1xyXG4gICAgICAgIHZhciBuZXdDYXJkczEgPSBjYy50ZVNodVBhaUNhcmRzLm1hcChmdW5jdGlvbihhcnIpe1xyXG4gICAgICAgICAgICB2YXIgY2FkID0gYXJyLm1hcChmdW5jdGlvbihudW1iZXIpe1xyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IG5ld0NhcmRzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihuZXdDYXJkc1tpXS5udW1iZXIgPT0gbnVtYmVyKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld0NhcmRzLnNwbGljZShpLDEpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gY2FkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnRlU2h1UGFpQ2FyZHMgPSBuZXdDYXJkczE7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufTtcclxuXHJcbi8v5YiG57uENTUzfHw1MzV8fDM1NVxyXG5LUUNhcmQuZmVuWmh1ID0gZnVuY3Rpb24gKG51bWJlcixudW0xLG51bTIpICB7XHJcbiAgICB2YXIgYXJyMSA9IFtdO1xyXG4gICAgdmFyIGFycjIgPSBbXTtcclxuICAgIHZhciBhcnIzID0gW107XHJcbiAgICBmb3IodmFyIGk9MDtpPG51bWJlci5sZW5ndGgtMTtpKyspe1xyXG4gICAgICAgIGlmKGkgPT0gMCl7XHJcbiAgICAgICAgICAgIGFycjEucHVzaChudW1iZXJbMF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihudW1iZXJbaSsxXSAtIG51bWJlcltpXSA9PSAwKXtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFycjEucHVzaChudW1iZXJbaSsxXSk7XHJcbiAgICAgICAgaWYoYXJyMS5sZW5ndGggPT0gbnVtMSl7XHJcbiAgICAgICAgICAgIC8v5Y+W56ys5LiA57uE5piv6aG65a2QXHJcbiAgICAgICAgICAgIGlmKEtRQ2FyZC5pc1NodW5aaTEoYXJyMSkpe1xyXG4gICAgICAgICAgICAgICAgLy/ov5k15Liq5piv6aG65a2QLOS7juaVsOe7hOS4reenu+mZpFxyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxhcnIxLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaj0wO2o8bnVtYmVyLmxlbmd0aDtqKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXJbal0gPT0gYXJyMVtpXSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+S4pOS4quaVsOS4gOagt+eahOWPquWIoOmZpOS4gOS4qlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IG51bWJlcltqKzFdKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlci5zcGxpY2UoaiwxKTsgICAgLy/ku45udW1iZXLkuK3np7vpmaRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8qY29uc29sZS5sb2coXCLliKDpmaTnrKzkuIDnu4TlkI7nmoRudW1iZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobnVtYmVyKTsqL1xyXG4gICAgICAgICAgICAgICAgLy/mjqXkuIvmnaXlj5bnrKzkuoznu4RcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8bnVtYmVyLmxlbmd0aC0xO2krKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoaSA9PSAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJyMi5wdXNoKG51bWJlclswXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKG51bWJlcltpKzFdIC0gbnVtYmVyW2ldID09IDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyMi5wdXNoKG51bWJlcltpKzFdKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihhcnIyLmxlbmd0aCA9PSBudW0yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5Y+W56ys5LqM57uE5piv6aG65a2QXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChLUUNhcmQuaXNTaHVuWmkxKGFycjIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDtpPGFycjIubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBqPTA7ajxudW1iZXIubGVuZ3RoO2orKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG51bWJlcltqXSA9PSBhcnIyW2ldKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Lik5Liq5pWw5LiA5qC355qE5Y+q5Yig6Zmk5LiA5LiqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXJbal0gPT0gbnVtYmVyW2orMV0pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyLnNwbGljZShqLDEpOyAgICAvL+S7jm51bWJlcuS4reenu+mZpFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLypjb25zb2xlLmxvZyhcIuWIoOmZpOesrOS6jOe7hOWQjueahG51bWJlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhudW1iZXIpOyovXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnIzID0gbnVtYmVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mjqXkuIvmnaXlsLHmmK/liankuIvnmoTkuoZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKEtRQ2FyZC5pc1NodW5aaTEoYXJyMykpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v56ys5LiJ57uE5Lmf5piv6aG65a2QXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzZGYgPSBbYXJyMSxhcnIyLGFycjNdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc2RmLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge3JldHVybiBuMS5sZW5ndGggLSBuMi5sZW5ndGg7fSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFjYy50ZVNodVBhaUNhcmRzKSBjYy50ZVNodVBhaUNhcmRzID0gYXNkZjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+esrOS4iee7hOS4jeaYr+mhuuWtkFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v56ys5LqM57uE5LiN5piv6aG65a2QXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy/nrKzkuIDnu4TkuI3mmK/pobrlrZBcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8v5aaC5p6c5Y+W5LiN5YiwbnVtMeS4quaVsFxyXG4gICAgaWYoYXJyMS5sZW5ndGggPCBudW0xKXtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZihhcnIyLmxlbmd0aCA8IG51bTIpe1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufTtcclxuXHJcbktRQ2FyZC5pc1NhblNodW5aaTEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIHZhciBsZW5ndGggPSAxMztcclxuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZih0eXBlb2YoY2FyZHNbMF0ucG9pbnQpID09ICd1bmRlZmluZWQnKXtcclxuICAgICAgICBjYXJkcyA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkcyk7XHJcbiAgICB9XHJcbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XHJcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xyXG4gICAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpO1xyXG4gICAgdmFyIHdlaSA9IFtdO1xyXG4gICAgdmFyIHpob25nID0gW107XHJcbiAgICB2YXIgdG91ID0gW107XHJcbiAgICB2YXIgc2FuU2h1blppID0gS1FDYXJkLnNhblNodW5aaTEoY2FyZHMpWzBdOy8v6I635Y+W5omA5pyJ57uE5ZCI55qE5aS06YGTXHJcbiAgICBpZighc2FuU2h1blppKXsgLy/kvaDov57lpLTpgZPpg73msqHmnIkg5oCO5LmI5pu05oiR5re3XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBuZXdDYXJkID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGkpey8v6YeN5paw6LWL5YC8Y2FyZHNcclxuICAgICAgICByZXR1cm4gaTtcclxuICAgIH0pO1xyXG4gICAgdmFyIG5ld0NhcmRzMSA9IFtdO1xyXG4gICAgdmFyIG5ld1BvaW50ID0gW107Ly/liKTmlq1wb2ludOaYr+WQpuebuOWQjFxyXG4gICAgdmFyIGR1aVppID0gW107Ly/lj5blh7rmnInlr7nlrZDlvZPkuK3nmoTkuIDlvKDniYxcclxuICAgIGZvcih2YXIgcyBpbiBjYXJkcyl7XHJcbiAgICAgICAgaWYobmV3UG9pbnQuaW5kZXhPZihjYXJkc1tzXS5wb2ludCk8MCl7XHJcbiAgICAgICAgICAgIG5ld0NhcmRzMS5wdXNoKGNhcmRzW3NdKTtcclxuICAgICAgICAgICAgbmV3UG9pbnQucHVzaChjYXJkc1tzXS5wb2ludCk7XHJcbiAgICAgICAgfWVsc2V7Ly/lj5blh7rmnInlr7nlrZDlvZPkuK3nmoTkuIDlvKDniYxcclxuICAgICAgICAgICAgZHVpWmkucHVzaChjYXJkc1tzXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2FuU2h1blppLmxlbmd0aDsgKytqKSB7Ly/lvqrnjq/miYDmnInlpLTpgZNcclxuICAgICAgICB2YXIgbnVtYmVyMyA9IHNhblNodW5aaVtqXTtcclxuICAgICAgICBpZih0eXBlb2YobnVtYmVyMykgPT0gJ3VuZGVmaW5lZCcpe1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IChpKSA8IGNhcmRzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBuZXdDYXJkcyA9IG5ld0NhcmRzMS5maWx0ZXIoZnVuY3Rpb24oaSl7Ly/ph43mlrDotYvlgLxjYXJkc1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbmV3Q2FyZHMgPSBuZXdDYXJkcy5rcV9leGNsdWRlcyhudW1iZXIzKTsvL+WIoOmZpOeJjOmHjOeahOWktOmBk1xyXG4gICAgICAgICAgICBpZiAod2VpLmxlbmd0aCAhPSA1KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3ViQ2FyZHMgPSBuZXdDYXJkcy5zbGljZShpLCBpICsgNSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3ViQ2FyZHMubGVuZ3RoID09IDUgfHwgS1FDYXJkLmlzU2h1blppKHN1YkNhcmRzKSkgey8v5b6X5Yiw5bC+6YGTIOWIoOmZpOeJjOmHjOeahOWwvumBk1xyXG4gICAgICAgICAgICAgICAgICAgIHdlaSA9IHN1YkNhcmRzO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhudW1iZXIzKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhuZXdDYXJkczEpXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY2MubG9nKHN1YkNhcmRzKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhuZXdDYXJkcylcclxuICAgICAgICAgICAgICAgICAgICAvLyBjYy5sb2coaSlcclxuICAgICAgICAgICAgICAgICAgICAvLyBjYy5sb2coJy0tLS0tNzE2JylcclxuICAgICAgICAgICAgICAgICAgICBuZXdDYXJkcyA9IG5ld0NhcmRzLmtxX2V4Y2x1ZGVzKHN1YkNhcmRzKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKHdlaS5sZW5ndGggPT0gNSl7Ly/miorliankvZnnmoTniYzlkozlr7nlrZDnmoTljZXlvKDlkIjlubZcclxuICAgICAgICAgICAgICAgIGxldCB0YXNrcyA9IGR1aVppLmZpbHRlcihmdW5jdGlvbihpKXsvL+mHjeaWsOi1i+WAvOWvueWtkFxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0YXNrcyA9IHRhc2tzLmtxX2V4Y2x1ZGVzKG51bWJlcjMpOy8v5Yik5pat5aS06YGT5ZKM5a+55a2Q55qE5Y2V5byg5piv5ZCm5pyJ55u45ZCMIOacieeahOivneWwseWIoOmZpFxyXG4gICAgICAgICAgICAgICAgbmV3Q2FyZHMgPSBuZXdDYXJkcy5jb25jYXQodGFza3MpOy8v5oqK5Ymp5L2Z55qE54mM5ZKM5a+55a2Q55qE5Y2V5byg5ZCI5bm2XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh6aG9uZy5sZW5ndGggIT0gNSAmJiBuZXdDYXJkcy5sZW5ndGggPT0gNSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKEtRQ2FyZC5pc1NodW5aaShuZXdDYXJkcykpIHsvL+aYr+S4iemhuuWtkFxyXG4gICAgICAgICAgICAgICAgICAgIHpob25nID0gbmV3Q2FyZHM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYod2VpLmxlbmd0aCA9PSA1ICYmIHpob25nLmxlbmd0aCA9PSA1ICl7Ly/mmK/kuInpobrlrZDnu4jmraLlvqrnjq9cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7Ly/mnaXlkKcg57un57ut5ZCnXHJcbiAgICAgICAgICAgICAgICB6aG9uZyA9IFtdO3dlaSA9IFtdO3RvdSA9IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHdlaS5sZW5ndGggPT0gNSAmJiB6aG9uZy5sZW5ndGggPT0gNSApey8v5piv5LiJ6aG65a2Q57uI5q2i5b6q546vXHJcbiAgICAgICAgICAgIHRvdSA9IG51bWJlcjM7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNley8v5p2l5ZCnIOe7p+e7reWQp1xyXG4gICAgICAgICAgICB6aG9uZyA9IFtdO3dlaSA9IFtdO3RvdSA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjYXJkcyA9IG5ld0NhcmQ7XHJcbiAgICBpZiAoS1FDYXJkLl9pc1NhblNodW5aaSh0b3Usemhvbmcsd2VpKSkgey8v5piv5LiJ6aG65a2QXHJcbiAgICAgICAgdG91ID0gS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzKHRvdSk7XHJcbiAgICAgICAgemhvbmcgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMoemhvbmcpO1xyXG4gICAgICAgIHdlaSA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyh3ZWkpO1xyXG5cclxuICAgICAgICBpZighY2MudGVTaHVQYWlDYXJkcykgY2MudGVTaHVQYWlDYXJkcyA9IFt0b3Usemhvbmcsd2VpXTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZHMpO1xyXG4gICAgaWYgKGNhcmRzID09PSBjb252ZXJ0ZWRDYXJkcykge1xyXG4gICAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24oYSl7XHJcbiAgICAgICAgICAgIGlmKGEucG9pbnQgPT0gMTQpIGEucG9pbnQgPSAxO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBLUUNhcmQuaXNTYW5TaHVuWmkxKGNhcmRzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBLUUNhcmQuaXNTYW5TaHVuWmkoY29udmVydGVkQ2FyZHMpO1xyXG59O1xyXG5cclxuS1FDYXJkLnNhblNodW5aaTEgPSBmdW5jdGlvbiAoY2FyZHMsbGVuZ3RoID0gMykge1xyXG4gICAgdmFyIHNodW56aSA9IEtRQ2FyZC5maW5kU2h1blppKGNhcmRzLGxlbmd0aCk7XHJcbiAgICB2YXIgY2FyZHNUID0gW107XHJcbiAgICB2YXIgY2FyZHNJbmRleCA9IFtdO1xyXG4gICAgaWYoc2h1bnppID09IG51bGwpe1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBzaHVuemkubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgdmFyIGEgPSBzaHVuemlbaV07XHJcbiAgICAgICAgdmFyIGNhcmRzU2h1bnppID0gW107XHJcbiAgICAgICAgLy8gdmFyIGNhcmRzSW5kZXggPSBbXTtcclxuICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgYS5sZW5ndGg7aisrKXtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gYVtqXTtcclxuICAgICAgICAgICAgaWYodHlwZW9mKGNhcmRzW2luZGV4XSkgPT0gJ3VuZGVmaW5lZCcpe1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FyZHNTaHVuemkucHVzaChjYXJkc1tpbmRleF0pO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgY2FyZHNJbmRleC5wdXNoKGEpO1xyXG4gICAgICAgIGNhcmRzVC5wdXNoKGNhcmRzU2h1bnppKTtcclxuICAgIH1cclxuICAgIHJldHVybiBbY2FyZHNULGNhcmRzSW5kZXhdO1xyXG59O1xyXG5cclxuS1FDYXJkLl9pc1NhblNodW5aaSA9IGZ1bmN0aW9uICh0b3VDYXJkcywgemhvbmdDYXJkcywgd2VpQ2FyZHMpIHtcclxuICAgIHJldHVybiBLUUNhcmQuaXNTaHVuWmkodG91Q2FyZHMpICYmIEtRQ2FyZC5pc1NodW5aaSh6aG9uZ0NhcmRzKVxyXG4gICAgICAgICYmIEtRQ2FyZC5pc1NodW5aaSh3ZWlDYXJkcyk7XHJcbn07XHJcbi8vIOaYr+WQpuaYr+S4ieWQjOiKsemhulxyXG5LUUNhcmQuaXNTYW5Ub25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdmFyIGxlbmd0aCA9IDEzO1xyXG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcclxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgbGV0IGNvbG9yQ2FyZHNPYmplY3QgPSBLUUNhcmQuX2NvbG9yQ2xhc3NDYXJkcyhjYXJkcyk7XHJcblxyXG4gICAgdmFyIHN1YkNhcmRzID0gW107XHJcbiAgICBmb3IgKGxldCBwcm9wIGluIGNvbG9yQ2FyZHNPYmplY3QpIHtcclxuICAgICAgICBsZXQgY2FyZHMgPSBjb2xvckNhcmRzT2JqZWN0W3Byb3BdO1xyXG4gICAgICAgIHN1YkNhcmRzLnB1c2goY2FyZHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzdWJDYXJkcy5sZW5ndGggIT0gMykge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLnNvcnQoZnVuY3Rpb24gKHMxLCBzMikge1xyXG4gICAgICAgIHJldHVybiBzMS5sZW5ndGggPiBzMi5sZW5ndGg7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgdG91Q2FyZHMgPSBzdWJDYXJkc1swXTtcclxuICAgIGxldCB6aG9uZ0NhcmRzID0gc3ViQ2FyZHNbMV07XHJcbiAgICBsZXQgd2VpQ2FyZHMgPSBzdWJDYXJkc1syXTtcclxuXHJcbiAgICBpZiAoKHRvdUNhcmRzLmxlbmd0aCAhPSAzKSB8fCAoemhvbmdDYXJkcy5sZW5ndGggIT0gNSkgfHwgKHdlaUNhcmRzLmxlbmd0aCAhPSA1KSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gS1FDYXJkLl9pc1NhblRvbmdIdWFTaHVuKHRvdUNhcmRzLCB6aG9uZ0NhcmRzLCB3ZWlDYXJkcyk7XHJcbn07XHJcblxyXG4vLyDlsIbniYzmoLnmja4gY29sb3Ig6L+b6KGM5YiG57G7XHJcbktRQ2FyZC5fY29sb3JDbGFzc0NhcmRzID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICBsZXQgY29sb3JDYXJkc09iamVjdCA9IHt9O1xyXG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgIGxldCBjb2xvciA9IGNhcmQuY29sb3I7XHJcbiAgICAgICAgdmFyIHN1YkNhcmRzID0gY29sb3JDYXJkc09iamVjdFtjb2xvcl07XHJcbiAgICAgICAgaWYgKCFzdWJDYXJkcykge1xyXG4gICAgICAgICAgICBzdWJDYXJkcyA9IFtdO1xyXG4gICAgICAgICAgICBjb2xvckNhcmRzT2JqZWN0W2NvbG9yXSA9IHN1YkNhcmRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdWJDYXJkcy5wdXNoKGNhcmQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGNvbG9yQ2FyZHNPYmplY3Q7XHJcbn07XHJcblxyXG4vLyDmmK/lkKbmmK/kuInlkIzoirHpobpcclxuS1FDYXJkLl9pc1NhblRvbmdIdWFTaHVuID0gZnVuY3Rpb24gKHRvdUNhcmRzLCB6aG9uZ0NhcmRzLCB3ZWlDYXJkcykge1xyXG4gICAgcmV0dXJuIEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHRvdUNhcmRzKSAmJiBLUUNhcmQuaXNUb25nSHVhU2h1bih6aG9uZ0NhcmRzKVxyXG4gICAgICAgICYmIEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHdlaUNhcmRzKTtcclxufTtcclxuXHJcblxyXG4vLyDmmK/lkKbmmK8g4oCc5LiJ5YiG5aSp5LiL4oCdXHJcbktRQ2FyZC5pc1NhbkZlblRpYW5YaWEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIGxldCBsZW5ndGggPSAxMztcclxuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHRpZVpoaUxlbmd0aCA9IDQ7XHJcbiAgICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcclxuICAgIGxldCBudW1iZXJPZlRpZVpoaSA9IDA7XHJcbiAgICBmb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xyXG4gICAgICAgIGxldCB2YWx1ZSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXTtcclxuICAgICAgICBpZiAodmFsdWUgPT0gdGllWmhpTGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIG51bWJlck9mVGllWmhpID0gbnVtYmVyT2ZUaWVaaGkgKyAxO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBudW1iZXJPZlRpZVpoaSA9PT0gMztcclxufTtcclxuXHJcblxyXG4vLyDmmK/lkKbmmK8g4oCc5Zub5aWX5LiJ5p2h4oCdXHJcbktRQ2FyZC5pc1NpVGFvU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgbGV0IGxlbmd0aCA9IDEzO1xyXG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGxldCBzYW5UaWFvTGVuZ3RoID0gMztcclxuICAgIGxldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xyXG4gICAgbGV0IG51bWJlck9mU2FuVGlhbyA9IDA7XHJcbiAgICBmb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xyXG4gICAgICAgIGxldCB2YWx1ZSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXTtcclxuICAgICAgICBpZiAodmFsdWUgPT0gc2FuVGlhb0xlbmd0aCkge1xyXG4gICAgICAgICAgICBudW1iZXJPZlNhblRpYW8gPSBudW1iZXJPZlNhblRpYW8gKyAxO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbnVtYmVyT2ZTYW5UaWFvID09IDQ7XHJcbn07XHJcblxyXG5cclxuLy8g5piv5ZCm5pivIOKAnOS4ieahg+iKseKAnVxyXG4vLyDlpLTjgIHkuK3jgIHlsL7pgZPkuLrnm7jlkIzoirHoibLnmoTniYxcclxuS1FDYXJkLmlzU2FuVGFvSHVhID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICBsZXQgbGVuZ3RoID0gMTM7XHJcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xyXG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBsZXQgY29sb3JIZWxwZXIgPSBuZXcgS1FDYXJkQ29sb3JzSGVscGVyKGNhcmRzKTtcclxuICAgIHZhciBjb2xvck51bWJlcnMgPSBbXTtcclxuICAgIGZvciAobGV0IHByb3AgaW4gY29sb3JIZWxwZXIuY29sb3JOdW1iZXIpIHtcclxuICAgICAgICBjb2xvck51bWJlcnMucHVzaChjb2xvckhlbHBlci5jb2xvck51bWJlcltwcm9wXSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29sb3JOdW1iZXJzLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xyXG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGNvbG9yTnVtYmVycy5sZW5ndGggIT0gMykge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoY29sb3JOdW1iZXJzWzBdID09IDNcclxuICAgICAgICAmJiAoY29sb3JOdW1iZXJzWzFdID09IDUpXHJcbiAgICAgICAgJiYgKGNvbG9yTnVtYmVyc1syXSA9PSA1KSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcblxyXG4vLyDliKTmlq3mmK/lkKbljIXlkKvpk4HmlK9cclxuLy8g5Zub5byg5ZCM5qC354K55pWw55qE54mMXHJcbktRQ2FyZC5jb250YWluVGllWmhpID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICBsZXQgbGVuZ3RoID0gNDtcclxuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XHJcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XHJcbiAgICBsZW5ndGggPSBsZW5ndGgtY2FyZDIwLmxlbmd0aDtcclxuICAgIGxldCBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcclxuXHJcbiAgICBmb3IodmFyIHcgaW4gaGVscGVyLnBvaW50TnVtYmVycykge1xyXG4gICAgICAgIHZhciBtYXhOdW1iZXIgPSBoZWxwZXIucG9pbnROdW1iZXJzW3ddO1xyXG4gICAgICAgIGlmKG1heE51bWJlciA+PSBsZW5ndGgpe1xyXG4gICAgICAgICAgICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihjYSl7XHJcbiAgICAgICAgICAgICAgICBjYS5zY29yZXMgPSBwYXJzZUludCh3KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vaWYoaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aCl7XHJcbiAgICAvLyAgICByZXR1cm4gaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aDtcclxuICAgIC8vfVxyXG4gICAgLy8gZWxzZXtcclxuICAgIC8vICAgIHJldHVybiBLUUNhcmQuY29udGFpbkd1aVBhaShjYXJkcyw0KTtcclxuICAgIC8vfVxyXG4gICAgLy9pZiAoS1FDYXJkLmZpbmRUaWVaaGkoY2FyZHMpLmxlbmd0aCA+IDApIHtcclxuICAgIC8vICAgIHJldHVybiB0cnVlO1xyXG4gICAgLy99XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn07XHJcblxyXG5cclxuLy8g5Yik5pat5piv5ZCm5piv6ZOB5pSvXHJcbktRQ2FyZC5pc1RpZVpoaSA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgbGV0IGxlbmd0aCA9IDQ7XHJcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMucmVkdWNlKGZ1bmN0aW9uIChwb2ludCwgY2FyZCkge1xyXG4gICAgICAgIGlmIChwb2ludCA9PSBjYXJkLnBvaW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwb2ludDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgfSwgY2FyZHNbMF0ucG9pbnQpO1xyXG5cclxuICAgIHJldHVybiByZXN1bHQgIT0gLTE7XHJcbn07XHJcblxyXG4vKiMjIyMj5piv5ZCm5YyF5ZCr5LqU5ZCMKi9cclxuLy/kupTlvKDlkIzmoLfngrnmlbDnmoTniYxcclxuS1FDYXJkLmNvbnRhaW5XdVRvbmcgPSBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgdmFyIGxlbmd0aCA9IDU7XHJcbiAgICBpZihjYXJkcy5sZW5ndGggPCBsZW5ndGgpe1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcclxuICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKTtcclxuICAgIGxlbmd0aCA9IGxlbmd0aC1jYXJkMjAubGVuZ3RoO1xyXG4gICAgLy/kupTlvKDniYznm7jlkIznmoRcclxuICAgIGxldCBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcclxuICAgIC8vZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuICAgIC8vICAgIGNjLmxvZyh3KVxyXG4gICAgLy99XHJcbiAgICAvL2NjLmxvZyhjYXJkcylcclxuICAgIC8vY2MubG9nKGhlbHBlcilcclxuICAgIC8vY2MubG9nKGNhcmQyMClcclxuICAgIC8vY2MubG9nKGhlbHBlci5tYXhOdW1iZXIoKSlcclxuICAgIC8vY2MubG9nKCctLS0tLS0xMzA3JylcclxuICAgIC8vaWYoaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aCl7XHJcbiAgICAvLyAgICByZXR1cm4gaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aDtcclxuICAgIC8vfVxyXG4gICAgZm9yKHZhciB3IGluIGhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuICAgICAgICB2YXIgbWF4TnVtYmVyID0gaGVscGVyLnBvaW50TnVtYmVyc1t3XTtcclxuICAgICAgICBpZihtYXhOdW1iZXIgPj0gbGVuZ3RoKXtcclxuICAgICAgICAgICAgY2FyZDIwLmZvckVhY2goZnVuY3Rpb24oY2Epe1xyXG4gICAgICAgICAgICAgICAgY2Euc2NvcmVzID0gcGFyc2VJbnQodyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn07XHJcblxyXG4vKuWIpOaWreaYr+WQpuS6lOWQjCovXHJcbktRQ2FyZC5pc1d1VG9uZyA9IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICB2YXIgbGVuZ3RoID0gNTtcclxuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLnJlZHVjZShmdW5jdGlvbiAocG9pbnQsIGNhcmQpIHtcclxuICAgICAgICBpZiAocG9pbnQgPT0gY2FyZC5wb2ludCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcG9pbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH0sIGNhcmRzWzBdLnBvaW50KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0ICE9IC0xO1xyXG59O1xyXG4vKiMjIyMjKi9cclxuXHJcbi8vIOaYr+WQpuaYryDigJzokavoiqbigJ1cclxuLy8g5LiJ5byg55u45ZCMICsg5LiA5a+5XHJcbktRQ2FyZC5jb250YWluSHVMdSA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgbGV0IGxlbmd0aCA9IDU7XHJcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgaWYgKEtRQ2FyZC5maW5kSHVMdShjYXJkcykubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgLy9sZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcclxuICAgIC8vdmFyIHBvaW50TnVtYmVycyA9IFtdO1xyXG4gICAgLy92YXIgaW5kZXggPSAwO1xyXG4gICAgLy9mb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xyXG4gICAgLy8gICAgcG9pbnROdW1iZXJzW2luZGV4XSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXTtcclxuICAgIC8vICAgIGluZGV4ID0gaW5kZXggKyAxO1xyXG4gICAgLy99XHJcbiAgICAvL3ZhciBoPVtdO1xyXG4gICAgLy92YXIgaDE9W107XHJcbiAgICAvL2Zvcih2YXIgaSBpbiBwb2ludE51bWJlcnMpe1xyXG4gICAgLy8gICAgdmFyIHM9cG9pbnROdW1iZXJzW2ldO1xyXG4gICAgLy8gICAgaWYocyA9PSAzKXtcclxuICAgIC8vICAgICAgICBoLnB1c2gocylcclxuICAgIC8vICAgIH1cclxuICAgIC8vICAgIGVsc2UgaWYocz09NCl7XHJcbiAgICAvLyAgICAgICAgaDEucHVzaChzKVxyXG4gICAgLy8gICAgfVxyXG4gICAgLy9cclxuICAgIC8vfVxyXG4gICAgLy9cclxuICAgIC8vaWYgKChwb2ludE51bWJlcnMuaW5kZXhPZigzKSAhPSAtMSkgJiYgKHBvaW50TnVtYmVycy5pbmRleE9mKDIpICE9IC0xKVxyXG4gICAgLy8gfHwgaC5sZW5ndGggPiAxIHx8IGgxLmxlbmd0aCA+IDEgfHwocG9pbnROdW1iZXJzLmluZGV4T2YoNCkgIT0gLTEpXHJcbiAgICAvLyAmJiAocG9pbnROdW1iZXJzLmluZGV4T2YoMikgIT0gLTEpKSB7XHJcbiAgICAvLyAgICByZXR1cm4gdHJ1ZTtcclxuICAgIC8vfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbi8vIOWIpOaWreaYr+WQpuaYryDokavoiqZcclxuS1FDYXJkLmlzSHVMdSA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgaWYgKGNhcmRzLmxlbmd0aCAhPSA1KSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBwb2ludHMgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICByZXR1cm4gY2FyZC5wb2ludDtcclxuICAgIH0pLnNvcnQoZnVuY3Rpb24gKHAxLCBwMikge1xyXG4gICAgICAgIHJldHVybiBwMSAtIHAyO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHAxID0gcG9pbnRzWzBdO1xyXG4gICAgdmFyIHAyID0gcDE7XHJcbiAgICB2YXIgbnVtYmVyUDEgPSAwO1xyXG4gICAgdmFyIG51bWJlclAyID0gMDtcclxuXHJcbiAgICBwb2ludHMuZm9yRWFjaChmdW5jdGlvbiAocG9pbnQpIHtcclxuICAgICAgICBpZiAocG9pbnQgIT0gcDEgJiYgcG9pbnQgIT0gcDIpIHtcclxuICAgICAgICAgICAgcDIgPSBwb2ludDtcclxuICAgICAgICAgICAgbnVtYmVyUDIgPSAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbnVtYmVyUDEgPSBudW1iZXJQMSArICgocG9pbnQgPT0gcDEpID8gMSA6IDApO1xyXG4gICAgICAgIG51bWJlclAyID0gbnVtYmVyUDIgKyAoKHBvaW50ID09IHAyKSA/IDEgOiAwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBtYXhOdW1iZXIgPSBNYXRoLm1heChudW1iZXJQMSk7XHJcbiAgICBsZXQgbWluTnVtYmVyID0gTWF0aC5taW4obnVtYmVyUDIpO1xyXG5cclxuICAgIHJldHVybiAobWluTnVtYmVyID09IDIpICYmIChtYXhOdW1iZXIgPT0gMyk7XHJcbn07XHJcblxyXG4vLyDmmK/lkKbljIXlkKvmnIkg4oCc5LiJ5p2h4oCdXHJcbktRQ2FyZC5jb250YWluU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdmFyIGxlbmd0aCA9IDM7XHJcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLy9pZiAoS1FDYXJkLmZpbmRTYW5UaWFvKGNhcmRzKS5sZW5ndGggPiAwKSB7XHJcbiAgICAvLyAgICByZXR1cm4gdHJ1ZTtcclxuICAgIC8vfVxyXG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xyXG4gICAgY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xyXG4gICAgbGVuZ3RoID0gbGVuZ3RoLWNhcmQyMC5sZW5ndGg7XHJcbiAgICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcclxuICAgIGZvcih2YXIgdyBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuICAgICAgICB2YXIgbWF4TnVtYmVyID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3ddO1xyXG4gICAgICAgIGlmKG1heE51bWJlciA+PSBsZW5ndGgpe1xyXG4gICAgICAgICAgICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihjYSl7XHJcbiAgICAgICAgICAgICAgICBjYS5zY29yZXMgPSBwYXJzZUludCh3KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vZm9yIChsZXQgcHJvcCBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuICAgIC8vICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gPj0gbGVuZ3RoKSB7XHJcbiAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAvLyAgICB9XHJcbiAgICAvL31cclxuICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAvL1xyXG4gICAgLy9yZXR1cm4gS1FDYXJkLmNvbnRhaW5HdWlQYWkoY2FyZHMsMyk7XHJcbn07XHJcblxyXG4vLyDmmK/lkKbmmK8g4oCc5LiJ5p2h4oCdXHJcbktRQ2FyZC5pc1NhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gMykge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMucmVkdWNlKGZ1bmN0aW9uIChwb2ludCwgY2FyZCkge1xyXG4gICAgICAgIGlmIChjYXJkLnBvaW50ID09IHBvaW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwb2ludDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH0sIGNhcmRzWzBdLnBvaW50KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0ICE9IC0xO1xyXG59O1xyXG5cclxuLy8g5piv5ZCm5YyF5ZCr5pyJIO+8muS4pOWvuVxyXG5LUUNhcmQuY29udGFpbkxpYUR1aSA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IDQpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZiAoS1FDYXJkLmZpbmRMaWFEdWkoY2FyZHMpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIC8vdmFyIG51bWJlck9mRHVpWmkgPSAwO1xyXG4gICAgLy9sZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcclxuICAgIC8vZm9yIChsZXQgcHJvcCBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuICAgIC8vICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gPT0gMikge1xyXG4gICAgLy8gICAgICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMTtcclxuICAgIC8vICAgICAgICBpZiAobnVtYmVyT2ZEdWlaaSA9PSAyKSB7XHJcbiAgICAvLyAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgLy8gICAgICAgIH1cclxuICAgIC8vICAgIH1cclxuICAgIC8vfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbi8vIOaYr+WQpuaYryDkuKTlr7lcclxuS1FDYXJkLmlzTGlhRHVpID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IDQpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XHJcbiAgICBmb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xyXG4gICAgICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gIT0gMikge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn07XHJcblxyXG4vLyDmmK/kuI3mmK/lr7nlrZBcclxuS1FDYXJkLmlzRHVpWmkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gMikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgY2FyZDEgPSBjYXJkc1swXTtcclxuICAgIGxldCBjYXJkMiA9IGNhcmRzWzFdO1xyXG5cclxuICAgIHJldHVybiBjYXJkMS5wb2ludCA9PSBjYXJkMi5wb2ludDtcclxufTtcclxuXHJcbi8vIOaYr+WQpuWMheWQq+WvueWtkFxyXG5LUUNhcmQuY29udGFpbkR1aVppID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICB2YXIgbGVuZ3RoID0gMjtcclxuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvL2lmIChLUUNhcmQuZmluZER1aVppKGNhcmRzKS5sZW5ndGggPiAwKSB7XHJcbiAgICAvLyAgICByZXR1cm4gdHJ1ZTtcclxuICAgIC8vfVxyXG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xyXG4gICAgY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApO1xyXG4gICAgbGVuZ3RoID0gbGVuZ3RoLWNhcmQyMC5sZW5ndGg7XHJcbiAgICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcclxuICAgIC8vZm9yIChsZXQgcHJvcCBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuICAgIC8vICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gPj0gbGVuZ3RoKSB7XHJcbiAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAvLyAgICB9XHJcbiAgICAvL31cclxuICAgIGZvcih2YXIgdyBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcclxuICAgICAgICB2YXIgbWF4TnVtYmVyID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3ddO1xyXG4gICAgICAgIGlmKG1heE51bWJlciA+PSBsZW5ndGgpe1xyXG4gICAgICAgICAgICBjYXJkMjAuZm9yRWFjaChmdW5jdGlvbihjYSl7XHJcbiAgICAgICAgICAgICAgICBjYS5zY29yZXMgPSBwYXJzZUludCh3KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluR3VpUGFpKGNhcmRzLDIpO1xyXG59O1xyXG5cclxuS1FDYXJkLmNvbnRhaW5HdWlQYWkgPSBmdW5jdGlvbiAoY2FyZHMgLCBsZW5ndGgpIHtcclxuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XHJcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XHJcbiAgICBsZXQgaGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XHJcbiAgICB2YXIgbWF4TnVtYmVyID0gKGhlbHBlci5tYXhOdW1iZXIoKSArIGNhcmQyMC5sZW5ndGgpO1xyXG4gICAgcmV0dXJuIG1heE51bWJlciA+PSBsZW5ndGg7XHJcbn07XHJcbi8qIyMjIyMqL1xyXG4vLyDmmK/lkKbmmK/nibnmrorniYxcclxuS1FDYXJkLmlzVGVTaHVQYWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIGlmIChjYXJkcy5sZW5ndGggPCAxMykge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gS1FDYXJkLmlzUWluZ0xvbmcoY2FyZHMpXHJcbiAgICAgICAgfHwgS1FDYXJkLmlzWWlUaWFvTG9uZyhjYXJkcylcclxuICAgICAgICB8fCBLUUNhcmQuaXNMaXVEdWlCYW4oY2FyZHMpXHJcbiAgICAgICAgfHwgS1FDYXJkLmlzU2FuU2h1blppKGNhcmRzKVxyXG4gICAgICAgIHx8IEtRQ2FyZC5pc1NhblRvbmdIdWEoY2FyZHMpXHJcbiAgICAgICAgLyp8fCBLUUNhcmQuaXNTYW5Ub25nSHVhU2h1bihjYXJkcylcclxuICAgICAgICAgfHwgS1FDYXJkLmlzU2FuRmVuVGlhblhpYShjYXJkcylcclxuICAgICAgICAgfHwgS1FDYXJkLmlzU2lUYW9TYW5UaWFvKGNhcmRzKVxyXG5cclxuICAgICAgICAgfHwgS1FDYXJkLmlzV3VEdWlTYW5UaWFvKGNhcmRzKVxyXG4gICAgICAgICB8fCBLUUNhcmQuaXNDb3VZaVNlKGNhcmRzKSovO1xyXG59O1xyXG5cclxuLy8g5bCG54mM5Lit55qEIDEg5Y+Y5YyW5Li6IEHvvIgxNClcclxuS1FDYXJkLl9jb252ZXJ0T25lVG9BID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICBpZiAoY2FyZHMuZmluZChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2FyZC5wb2ludCA9PSAxO1xyXG4gICAgICAgIH0pID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiBjYXJkcztcclxuICAgIH1cclxuICAgIGxldCByZXN1bHQgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICBpZiAoY2FyZC5wb2ludCA9PSAxKSB7XHJcbiAgICAgICAgICAgIGxldCBuZXdDYXJkID0gbmV3IEtRQ2FyZCgxNCwgY2FyZC5jb2xvcik7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXdDYXJkO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2FyZDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn07XHJcblxyXG5LUUNhcmQuX2NvbnZlcnRPbmVUb0ExID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICBpZiAoY2FyZHMuZmluZChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2FyZC5wb2ludCA9PSAxO1xyXG4gICAgICAgIH0pID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiBjYXJkcztcclxuICAgIH1cclxuICAgIHZhciBudW0gPSAwO1xyXG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgIGlmIChjYXJkLnBvaW50ID09IDEgJiYgbnVtID09IDApIHtcclxuICAgICAgICAgICAgbnVtKys7XHJcbiAgICAgICAgICAgIGxldCBuZXdDYXJkID0gbmV3IEtRQ2FyZCgxNCwgY2FyZC5jb2xvcik7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXdDYXJkO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2FyZDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn07XHJcblxyXG4vLyBLUUNhcmQg55qE5o6S5bqP5pa55rOVXHJcbktRQ2FyZC5zb3J0QnlQb2ludCA9IGZ1bmN0aW9uIChjYXJkMSwgY2FyZDIpIHtcclxuICAgIGxldCByZXN1bHQgPSBOdW1iZXIoY2FyZDEucG9pbnQpIC0gTnVtYmVyKGNhcmQyLnBvaW50KVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufTtcclxuXHJcbktRQ2FyZC5zb3J0QnlDb2xvciA9IGZ1bmN0aW9uIChjYXJkMSwgY2FyZDIsIHBvaW50QXNjID0gdHJ1ZSkge1xyXG4gICAgaWYgKGNhcmQyLmNvbG9yID09IGNhcmQxLmNvbG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIChjYXJkMS5wb2ludCAtIGNhcmQyLnBvaW50KSAqIChwb2ludEFzYyA/IDEgOiAtMSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY2FyZDIuY29sb3IgLSBjYXJkMS5jb2xvcjtcclxufVxyXG5cclxuS1FDYXJkLnNvcnQgPSBmdW5jdGlvbiAoY2FyZDEsIGNhcmQyLCBhc2MgPSB0cnVlLCBBaXNNYXggPSB0cnVlKSB7XHJcbiAgICBsZXQgcmVzdWx0ID0gMTtcclxuICAgIGlmIChjYXJkMS5wb2ludCA9PSBjYXJkMi5wb2ludCkge1xyXG4gICAgICAgIHJlc3VsdCA9IGNhcmQxLmNvbG9yIC0gY2FyZDIuY29sb3I7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZhciBwb2ludDEgPSBjYXJkMS5wb2ludDtcclxuICAgICAgICB2YXIgcG9pbnQyID0gY2FyZDIucG9pbnQ7XHJcbiAgICAgICAgaWYgKEFpc01heCAmJiBwb2ludDEgPT0gMSkge1xyXG4gICAgICAgICAgICBwb2ludDEgPSAxNDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChBaXNNYXggJiYgcG9pbnQyID09IDEpIHtcclxuICAgICAgICAgICAgcG9pbnQyID0gMTQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXN1bHQgPSBwb2ludDEgLSBwb2ludDI7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdCAqIChhc2MgPyAxIDogLTEpO1xyXG59O1xyXG5cclxuLy/ovazkuLrlrqLmiLfnq6/nmoTniYxcclxuS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgLy8gW3tcInN1aXRcIjpcInNcIixcIm51bWJlclwiOjEwfV1cclxuICAgIGxldCBzdWl0Q29sb3JNYXAgPVsnJywnZCcsJ2MnLCdoJywncyddO1xyXG4gICAgcmV0dXJuIGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgIHZhciBjYXJkTnVtYmVyID0gY2FyZC5wb2ludDtcclxuICAgICAgICBsZXQgY29sb3IgPSBzdWl0Q29sb3JNYXBbY2FyZC5jb2xvcl07XHJcbiAgICAgICAgbGV0IG51bWJlciA9IE1hdGgubWF4KE1hdGgubWluKGNhcmROdW1iZXIsIDEzKSwgMSk7XHJcbiAgICAgICAgcmV0dXJuIHtudW1iZXI6bnVtYmVyLHN1aXQ6Y29sb3J9O1xyXG4gICAgfSk7XHJcbn07IiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XHJcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcclxuXHJcbmxldCBLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyID0ge1xyXG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kaWRTdGFydCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2RpZFN0YXJ0ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUZvcmNlRXhpdCwgdGhpcy5fZm9yY2VFeGl0QXBwLCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgX2ZvcmNlRXhpdEFwcDogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICBLUU5hdGl2ZUludm9rZS5mb3JjZUV4aXRBcHAoKTtcclxuICAgIH0sXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEtRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXI7IiwibGV0IEtRR2xvYmFsRXZlbnQgPSB7XHJcbiAgICBfaGFuZGxlczoge30sXHJcbiAgICAvL+WPkemAgeS6i+S7tlxyXG4gICAgZW1pdDogZnVuY3Rpb24gKGV2ZW50TmFtZSwgZGF0YSA9IHt9KSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRhID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSB7J2RhdGEnOiBkYXRhfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciByZXR1cm5zID0gW10gLy/ov5Tlm57lgLxcclxuICAgICAgICBkYXRhLmV2ZW50TmFtZSA9IGV2ZW50TmFtZS8v5L+d5a2Y5LiA5LiL5LqL5Lu25ZCN5a2XXHJcblxyXG4gICAgICAgIGZvciAoIHZhciBmaW5kRXZlbk5hbWUgaW4gdGhpcy5faGFuZGxlcyl7XHJcbiAgICAgICAgICAgIGlmIChmaW5kRXZlbk5hbWUgPT0gZXZlbnROYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2hhbmRsZXNbZmluZEV2ZW5OYW1lXS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXR1cm5WYWx1ZSA9IHRoaXMuX2hhbmRsZXNbZmluZEV2ZW5OYW1lXVtpXShkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybnMucHVzaChyZXR1cm5WYWx1ZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJldHVybnNcclxuICAgIH0sXHJcbiAgICAvL+a3u+WKoOaZrumAmuS6i+S7tlxyXG4gICAgb246IGZ1bmN0aW9uIChldmVudE5hbWUsIGNhbGxiYWNrLCB0YXJnZXQpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygn5pS25Yiw5LqL5Lu2JywgZXZlbnROYW1lKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV0gPSB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV0gfHwgW11cclxuXHJcbiAgICAgICAgdGhpcy5faGFuZGxlc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2suYmluZCh0YXJnZXQpKVxyXG4gICAgICAgIGNhbGxiYWNrLl9jYWxsZXIgPSB0YXJnZXQ7XHJcbiAgICB9LFxyXG5cclxuICAgIC8v6YCa6L+H5LqL5Lu25ZCN56e76Zmk5LiA5Liq55uR5ZCs5ZmoXHJcbiAgICBvZmY6IGZ1bmN0aW9uIChldmVudE5hbWUpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2hhbmRsZXNbZXZlbnROYW1lXS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV1baV0gPSBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDnp7vliqjkuIDkuKogdGFyZ2V0IOS4iuaJgOacieeahOebkeWQrFxyXG4gICAgb2ZmVGFyZ2V0OiBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcy5faGFuZGxlcykge1xyXG4gICAgICAgIHZhciBldmVudEhhbmRsZXJzID0gdGhpcy5faGFuZGxlc1tuYW1lXTtcclxuICAgICAgICB2YXIgaW5kZXhzID0gZXZlbnRIYW5kbGVycy5maWx0ZXIoZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2suX2NhbGxlciA9IHRhcmdldDtcclxuICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKGNhbGxiYWNrLCBpbmRleCkge1xyXG4gICAgICAgICAgcmV0dXJuIGluZGV4O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgaW5kZXhPZmZzZXQgPSAwO1xyXG4gICAgICAgIGluZGV4cy5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgICAgZXZlbnRIYW5kbGVycy5zcGxpY2UoaW5kZXggKyBpbmRleE9mZnNldCwgMSk7XHJcbiAgICAgICAgICBpbmRleE9mZnNldCA9IGluZGV4T2Zmc2V0ICsgMTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSxcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gS1FHbG9iYWxFdmVudDtcclxuIiwibGV0IEtRTmF0aXZlSW52b2tlID0ge1xyXG4gIElPU0NsYXNzTmFtZTogXCJBcHBDb250cm9sbGVyXCIsXHJcbiAgQU5EUklPRENsYXNzTmFtZTogXCJjb20vZ29uZ3BhL3Nzei9BcHBBY3Rpdml0eVwiLFxyXG5cclxuICBpc05hdGl2ZUlPUzogZnVuY3Rpb24gKCkge1xyXG4gICAgbGV0IHBsYXRmb3JtID0gY2Muc3lzLnBsYXRmb3JtO1xyXG4gICAgaWYgKChwbGF0Zm9ybSA9PSBjYy5zeXMuSVBIT05FKSB8fCAocGxhdGZvcm0gPT0gY2Muc3lzLklQQUQpKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0sXHJcblxyXG4gIGlzTmF0aXZlQW5kcm9pZDogZnVuY3Rpb24gKCkge1xyXG4gICAgbGV0IHBsYXRmb3JtID0gY2Muc3lzLnBsYXRmb3JtO1xyXG4gICAgaWYgKHBsYXRmb3JtID09IGNjLnN5cy5BTkRST0lEKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0sXHJcblxyXG4gIGlzTmF0aXZlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gY2Muc3lzLmlzTmF0aXZlID09IHRydWU7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gTUFSSzog5Y+v6LCD55So55qE5pys5Zyw5pa55rOVXHJcbi8qKlxyXG4gKiDlvq7kv6HnmbvlvZVcclxuICovXHJcbktRTmF0aXZlSW52b2tlLnd4TG9naW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hMb2dpblwiKTsgLy9JT1NcclxuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7IC8vQW5kcm9pZFxyXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4TG9naW5cIiwgXCIoKVZcIik7XHJcbiAgfVxyXG59O1xyXG5cclxuXHJcbi8qKlxyXG4gKiDliIbkuqvlpKfljoXkv6Hmga/liLDlvq7kv6Hlpb3lj4tcclxuICogXHJcbiAqL1xyXG5LUU5hdGl2ZUludm9rZS5zaGFyZUhhbGxUb1dlQ2hhdEZyaWVuZCA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbEZyaWVuZFwiLCApO1xyXG4gIH0gZWxzZSB7IC8vQW5kcm9pZFxyXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVIYWxsRnJpZW5kXCIsIFwiKClWXCIpO1xyXG4gIH1cclxufTtcclxuXHJcblxyXG4vKipcclxuICog5YiG5Lqr5aSn5Y6F5L+h5oGv5Yiw5pyL5Y+L5ZyIXHJcbiAqIFxyXG4gKi9cclxuS1FOYXRpdmVJbnZva2Uuc2hhcmVIYWxsVG9XZUNoYXRUaW1lbGluZSA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsICk7XHJcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCBcIigpVlwiKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICog5by65Yi26YCA5Ye6IEFQUFxyXG4gKiBcclxuICovXHJcbktRTmF0aXZlSW52b2tlLmZvcmNlRXhpdEFwcCA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJleGl0QXBwXCIsICk7XHJcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZXhpdEFwcFwiLCBcIigpVlwiKTtcclxuICB9XHJcbn07XHJcblxyXG5cclxuLyoqXHJcbiAqIOS4i+i9veaWsOeJiOacrFxyXG4gKiBcclxuICogQHBhcmFtIHtTdHJpbmd9IGlvc1VybCAgICAgIGlPUyDniYjmnKzlnLDlnYBcclxuICogQHBhcmFtIHtTdHJpbmd9IGFuZHJvaWRVcmwgIOWuieWNk+eJiOacrOWcsOWdgFxyXG4gKi9cclxuS1FOYXRpdmVJbnZva2UuZG93bmxvYWROZXdWZXJzaW9uID0gZnVuY3Rpb24gKGlvc1VybCwgYW5kcm9pZFVybCkge1xyXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJkb3dubG9hZE5ld1ZlcnNpb246XCIsIGlvc1VybCk7XHJcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZG93bmxvYWROZXdWZXJzaW9uXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGFuZHJvaWRVcmwpO1xyXG4gIH1cclxufTtcclxuXHJcblxyXG4vKipcclxuICog5YiG5Lqr5oi/6Ze057uZ5b6u5L+h5aW95Y+LXHJcbiAqIFxyXG4gKiBAcGFyYW0ge1N0cmluZ30gcm9vbUlkICAgICAgICAg5oi/6Ze0IGlkIOS/oeaBr1xyXG4gKiBAcGFyYW0ge1N0cmluZ30gZGVzY3JpcHRpb24gICAg5paH5pys5o+P6L+wXHJcbiAqL1xyXG5LUU5hdGl2ZUludm9rZS5zaGFyZVJvb21Ub1dlQ2hhdEZyaWVuZCA9IGZ1bmN0aW9uIChyb29tSWQsIGRlc2NyaXB0aW9uKSB7XHJcbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2hhcmVGcmllbmQ6ZGVzY3JpcHRpb246XCIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgeyAvL0FuZHJvaWRcclxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlRnJpZW5kXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIOWIhuS6q+aIv+mXtOWIsOW+ruS/oeaci+WPi+WciFxyXG4gKiBcclxuICogQHBhcmFtIHtTdHJpbmd9IHJvb21JZCAgICAgICAgIOaIv+mXtCBpZCDkv6Hmga9cclxuICogQHBhcmFtIHtTdHJpbmd9IGRlc2NyaXB0aW9uICAgIOaWh+acrOaPj+i/sFxyXG4gKi9cclxuS1FOYXRpdmVJbnZva2Uuc2hhcmVSb29tVG9XZUNoYXRUaW1lbGluZSA9IGZ1bmN0aW9uIChyb29tSWQsIGRlc2NyaXB0aW9uKSB7XHJcbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2hhcmU6ZGVzY3JpcHRpb246XCIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgeyAvL0FuZHJvaWRcclxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIOWIhuS6q+Wxj+W5leaIquWbvuWIsOW+ruS/oeWlveWPi1xyXG4gKi9cclxuS1FOYXRpdmVJbnZva2Uuc2hhcmVTY3JlZW5Ub1dlQ2hhdEZyaWVuZCA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZUZyaWVuZFwiLCApO1xyXG4gIH0gZWxzZSB7IC8vQW5kcm9pZFxyXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVGcmllbmRcIiwgXCIoKVZcIik7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIOWIhuS6q+Wxj+W5leaIquWbvuWIsOW+ruS/oeaci+WPi+WciFxyXG4gKi9cclxuS1FOYXRpdmVJbnZva2Uuc2hhcmVTY3JlZW5Ub1dlQ2hhdFRpbWVsaW5lID0gZnVuY3Rpb24gKCkge1xyXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNjcmVlblNoYXJlXCIsICk7XHJcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZVwiLCBcIigpVlwiKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICog5byA5aeL5b2V6Z+zXHJcbiAqL1xyXG5LUU5hdGl2ZUludm9rZS5zdGFydFJlY29yZCA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJyZWNvcmRcIik7XHJcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkge1xyXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInJlY29yZFwiLCBcIigpVlwiKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICog57uT5p2f5b2V6Z+zXHJcbiAqL1xyXG5LUU5hdGl2ZUludm9rZS5lbmRSZWNvcmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwiZW5kUmVjb3JkXCIpO1xyXG4gIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHtcclxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJlbmRSZWNvcmRcIiwgXCIoKVZcIik7XHJcbiAgfVxyXG59O1xyXG5cclxuS1FOYXRpdmVJbnZva2Uuc2NyZWVuc2hvdFNoYXJlID0gZnVuY3Rpb24oc3RyaW5ncyA9ICdzaGFyZUlNRycpIHtcclxuICAgICAgICBpZih0aGlzLl9pc0NhcHR1cmluZyl7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5faXNDYXB0dXJpbmcgPSB0cnVlO1xyXG4gICAgICAgIHZhciBzaXplID0gY2MuZGlyZWN0b3IuZ2V0V2luU2l6ZSgpO1xyXG4gICAgICAgIHZhciBmaWxlTmFtZSA9IFwicmVzdWx0X3NoYXJlLmpwZ1wiO1xyXG4gICAgICAgIHZhciBmdWxsUGF0aCA9IGpzYi5maWxlVXRpbHMuZ2V0V3JpdGFibGVQYXRoKCkgKyBmaWxlTmFtZTtcclxuICAgICAgICBpZihqc2IuZmlsZVV0aWxzLmlzRmlsZUV4aXN0KGZ1bGxQYXRoKSl7XHJcbiAgICAgICAgICAgIGpzYi5maWxlVXRpbHMucmVtb3ZlRmlsZShmdWxsUGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0ZXh0dXJlID0gbmV3IGNjLlJlbmRlclRleHR1cmUoTWF0aC5mbG9vcihzaXplLndpZHRoKSwgTWF0aC5mbG9vcihzaXplLmhlaWdodCksY2MuSU1BR0VfRk9STUFUX1BORyxnbC5ERVBUSDI0X1NURU5DSUw4X09FUyk7XHJcbiAgICAgICAgdGV4dHVyZS5zZXRQb3NpdGlvbihjYy5wKHNpemUud2lkdGgvMiwgc2l6ZS5oZWlnaHQvMikpO1xyXG4gICAgICAgIHRleHR1cmUuYmVnaW4oKTtcclxuICAgICAgICBjYy5kaXJlY3Rvci5nZXRSdW5uaW5nU2NlbmUoKS52aXNpdCgpO1xyXG4gICAgICAgIHRleHR1cmUuZW5kKCk7XHJcbiAgICAgICAgdGV4dHVyZS5zYXZlVG9GaWxlKGZpbGVOYW1lLCBjYy5JTUFHRV9GT1JNQVRfUE5HKTtcclxuXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciB0cnlUaW1lcyA9IDA7XHJcbiAgICAgICAgdmFyIGZuID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgaWYoanNiLmZpbGVVdGlscy5pc0ZpbGVFeGlzdChmdWxsUGF0aCkpe1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfQU5EUk9JRCl7XHJcbiAgICAgICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChzZWxmLkFORFJJT0RDbGFzc05hbWUsIHN0cmluZ3MsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsZnVsbFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VsZi5faXNDYXB0dXJpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgdHJ5VGltZXMrKztcclxuICAgICAgICAgICAgICAgIGlmKHRyeVRpbWVzID4gMTApe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidGltZSBvdXQuLi5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmbiw1MCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgc2V0VGltZW91dChmbiw1MCk7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICog5pKt5pS+572R57uc6K+t6Z+zXHJcbiAqIFxyXG4gKiBAcGFyYW0ge1N0cmluZ30gYXVkaW9Vcmwg6K+t6Z+z5Zyw5Z2AXHJcbiAqL1xyXG5LUU5hdGl2ZUludm9rZS5wbGF5QXVkaW9XaXRoVXJsID0gZnVuY3Rpb24gKGF1ZGlvVXJsKSB7XHJcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwicGxheVVybDpcIiwgYXVkaW9VcmwpO1xyXG4gIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsgLy9BbmRyb2lkXHJcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwicGxheVVybFwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCBhdWRpb1VybCk7XHJcbiAgfVxyXG59O1xyXG5cclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEtRTmF0aXZlSW52b2tlOyIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jb25zdCBDaGF0TWVzc2FnZSA9IHJlcXVpcmUoJ0NoYXRNZXNzYWdlJyk7XHJcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xyXG5cclxuLy8g55So5p2l5Y+R6YCB5raI5oGv55qEIGNvbXBvbmVudFxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vYnFOb2RlOmNjLk5vZGUsXHJcbiAgICAgICAgLy9icU5vZGUxOmNjLk5vZGUsXHJcbiAgICAgICAgLy9idG5MYW5ndWFnZU5vZGU6Y2MuTm9kZSxcclxuICAgICAgICAvL2J0bkxhbmd1YWdlTm9kZTE6Y2MuTm9kZSxcclxuICAgICAgICAvL2J0bkNoYXJ0Tm9kZTpjYy5Ob2RlLFxyXG4gICAgICAgIC8vYnRuQ2hhcnROb2RlMTpjYy5Ob2RlLFxyXG4gICAgICAgIHRleHRTY3JvbGxWaWV3OmNjLk5vZGUsXHJcbiAgICAgICAgaW1hZ2VDb250ZW50Tm9kZTpjYy5Ob2RlLFxyXG5cclxuICAgICAgICBlZGl0Qm94OiBjYy5FZGl0Qm94LFxyXG5cclxuICAgICAgICB0ZXh0UmVjb3JkU2Nyb2xsVmlldzogY2MuU2Nyb2xsVmlldyxcclxuICAgICAgICB0ZXh0UmVjb3JkTGF5b3V0OiBjYy5MYXlvdXQsXHJcblxyXG4gICAgICAgIHRleHRQcmVmYWI6Y2MuUHJlZmFiLFxyXG4gICAgICAgIGNoYXRUZXh0UmVjb3JkUHJlZmFiOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgZW1vamlQcmVmYWI6Y2MuUHJlZmFiLFxyXG4gICAgICAgIC8vIGltYWdlUHJlZmFiOmNjLlByZWZhYixcclxuXHJcbiAgICAgICAgYmlhb3Fpbmc6IFtjYy5Ob2RlXSwgICAgLy8gW+S6rueahOiDjOaZrywg5pqX55qE6IOM5pmvXSAgIOW/q+aNt+ivrVxyXG4gICAgICAgIGt1YWlqaWV5dTogW2NjLk5vZGVdLCAgIC8vIFvkuq7nmoTog4zmma8sIOaal+eahOiDjOaZr10gICDooajmg4VcclxuICAgICAgICBjb250ZW50OltjYy5Ob2RlXSwgICAgICAvLyBb5b+r5o236K+tLCDooajmg4VdICAgXHJcbiAgICAgICAgaW5wdXROb2RlOmNjLk5vZGUsXHJcbiAgICAgICAgZW1vamk6W2NjLk5vZGVdLFxyXG4gICAgICAgIF91c2VySWQ6IG51bGwsXHJcblxyXG4gICAgICAgIF9wbGF5ZXJJbmZvczogbnVsbCwgICAgICAgIC8vIOiusOW9leeUqOaIt+S/oeaBr1xyXG4gICAgICAgIF9jaGF0VGV4dE1lc3NhZ2VSZWNvcmRzOiBudWxsLCAvLyDogYrlpKnmlofmnKzmtojmga/orrDlvZVcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XHJcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSBbXTtcclxuICAgICAgICB0aGlzLnRleHRDb250ZW50ID0gdGhpcy50ZXh0U2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcclxuICAgICAgICAvLyB0aGlzLmltYWdlQ29udGVudCA9IHRoaXMuaW1hZ2VTY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgdGV4dERhdGEgPSBBdWRpb01hbmFnZXIuaW5zdGFuY2UuY2hhdFRleHRzKCk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0RGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMudGV4dFByZWZhYik7XHJcbiAgICAgICAgICAgIGl0ZW0uZ2V0Q29tcG9uZW50KCdjZWxsVGV4dCcpLnNldFRleHQodGV4dERhdGFbaV0pO1xyXG4gICAgICAgICAgICBpdGVtLmdldENvbXBvbmVudCgnY2VsbFRleHQnKS5vblNlbGVjdEFjdGlvbiA9IGZ1bmN0aW9uKHRleHQpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYub25UZXh0Q2xpY2tBY3Rpb24odGV4dCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMudGV4dENvbnRlbnQuaCA9IDEwMDA7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dENvbnRlbnQuYWRkQ2hpbGQoaXRlbSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG5cclxuICAgIGNsaWNrS3VhaUppZVl1IDpmdW5jdGlvbigpe1xyXG4gICAgICAgIHRoaXMua3VhaWppZXl1WzBdLmFjdGl2ZSA9IHRydWU7ICAgIC8vIOW/q+aNt+ivrSDog4zmma9cclxuICAgICAgICB0aGlzLmt1YWlqaWV5dVsxXS5hY3RpdmUgPSBmYWxzZTsgICAvLyDlv6vmjbfor60g5oyJ6ZKuXHJcbiAgICAgICAgdGhpcy5iaWFvcWluZ1swXS5hY3RpdmUgPSBmYWxzZTsgICAgLy8g6IOM5pmv6KGo5oOFXHJcbiAgICAgICAgdGhpcy5iaWFvcWluZ1sxXS5hY3RpdmUgPSB0cnVlOyAgICAgLy8g6KGo5oOF5oyJ6ZKuXHJcbiAgICAgICAgdGhpcy5jb250ZW50WzBdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5jb250ZW50WzFdLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIGNsaWNrQmlhb1FpbmcgOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdGhpcy5iaWFvcWluZ1swXS5hY3RpdmUgPSB0cnVlOyAgICAgLy8g6IOM5pmv6KGo5oOFXHJcbiAgICAgICAgdGhpcy5iaWFvcWluZ1sxXS5hY3RpdmUgPSBmYWxzZTsgICAgLy8g6KGo5oOF5oyJ6ZKuXHJcbiAgICAgICAgdGhpcy5rdWFpamlleXVbMF0uYWN0aXZlID0gZmFsc2U7ICAgLy8g5b+r5o236K+tIOiDjOaZr1xyXG4gICAgICAgIHRoaXMua3VhaWppZXl1WzFdLmFjdGl2ZSA9IHRydWUgOyAgIC8vIOW/q+aNt+ivrSDmjInpkq5cclxuICAgICAgICB0aGlzLmNvbnRlbnRbMF0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jb250ZW50WzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgb25UZXh0Q2xpY2tBY3Rpb246ZnVuY3Rpb24odGV4dCA9IFwiXCIpIHtcclxuICAgICAgICB0aGlzLmVkaXRCb3guc3RyaW5nID0gXCJcIjtcclxuICAgICAgICB0aGlzLnNlbmRUZXh0KHRleHQpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0Vtb2ppOiBmdW5jdGlvbiAoZXZlbnQsIGVtb2ppTmFtZSkge1xyXG4gICAgICAgIGxldCBzdHJpbmcgPSB0aGlzLmVkaXRCb3guc3RyaW5nO1xyXG4gICAgICAgIHRoaXMuZWRpdEJveC5zdHJpbmcgPSBzdHJpbmcgKyBcIjxcIiArIGVtb2ppTmFtZSArIFwiPlwiO1xyXG4gICAgICAgIHRoaXMuc2VuZEVtb2ppKGVtb2ppTmFtZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrU2VuZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGxldCBzdHJpbmcgPSB0aGlzLmVkaXRCb3guc3RyaW5nIHx8IFwiXCI7XHJcbiAgICAgICAgaWYgKHN0cmluZy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZWRpdEJveC5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgIHRoaXMuc2VuZFRleHQoc3RyaW5nKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2VuZEVtb2ppIDpmdW5jdGlvbihlbW9qaU5hbWUpe1xyXG4gICAgICAgIGlmKGVtb2ppTmFtZS5sZW5ndGggPT0wKXtcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFNvY2tldC5zZW5kRW1vamkodGhpcy5fdXNlcklkLCBlbW9qaU5hbWUpO1xyXG4gICAgICAgIHRoaXMuZGlzbWlzcygpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZW5kVGV4dDogZnVuY3Rpb24gKHRleHQgPSBcIlwiKSB7XHJcbiAgICAgICAgaWYgKHRleHQubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBTb2NrZXQuc2VuZFRleHQodGhpcy5fdXNlcklkLCB0ZXh0KTtcclxuICAgICAgICB0aGlzLmRpc21pc3MoKTtcclxuICAgIH0sXHJcblxyXG4gICAgZGlzbWlzczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgYnFBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5icU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuTGFuZ3VhZ2VOb2RlLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlMS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuYnFOb2RlLmFjdGl2ZSA9IHRoaXMuYnRuTGFuZ3VhZ2VOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnRleHRTY3JvbGxWaWV3LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaW1hZ2VDb250ZW50Tm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudGV4dFJlY29yZFNjcm9sbFZpZXcubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgdGV4dEFjdGlvbjpmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmJxTm9kZTEuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5icU5vZGUuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlMS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudGV4dFNjcm9sbFZpZXcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmltYWdlQ29udGVudE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkU2Nyb2xsVmlldy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuXHJcbiAgICBjaGFydEFjdGlvbjpmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmJxTm9kZTEuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlMS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJxTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudGV4dFNjcm9sbFZpZXcuYWN0aXZlID0gdGhpcy5pbWFnZUNvbnRlbnROb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMudGV4dFJlY29yZFNjcm9sbFZpZXcubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuXHJcbiAgICBhZGRQbGF5ZXJJbmZvczogZnVuY3Rpb24gKHBsYXllckluZm9zKSB7XHJcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSB0aGlzLl9wbGF5ZXJJbmZvcyB8fCBbXTtcclxuXHJcbiAgICAgICAgcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbiAodXNlckluZm8pIHtcclxuICAgICAgICAgICAgbGV0IGhhdmVVc2VySW5mbyA9IHRoaXMuX3BsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKG93blVzZXJJbmZvKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb3duVXNlckluZm8uaWQgPT0gdXNlckluZm8uaWQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGhhdmVVc2VySW5mbyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcy5wdXNoKHVzZXJJbmZvKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGFkZENoYXRUZXh0TWVzc2FnZTogZnVuY3Rpb24gKHVzZXJJZCwgdGV4dCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gdGhpcy5fcGxheWVySW5mb3MgfHwgW107XHJcblxyXG4gICAgICAgIHZhciBuaWNrbmFtZSA9IFwiW0lEOlwiICsgdXNlcklkICsgXCLor7Rd77yaXCI7XHJcbiAgICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy5fcGxheWVySW5mb3MuZmluZChmdW5jdGlvbiAodXNlckluZm8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVzZXJJbmZvLmlkID09IHVzZXJJZDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHVzZXJJbmZvKSB7XHJcbiAgICAgICAgICAgIG5pY2tuYW1lID0gXCJbXCIgKyB1c2VySW5mby5uaWNrbmFtZSArIFwi6K+0Xe+8mlwiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHN0ciA9IG5pY2tuYW1lICsgdGV4dDtcclxuICAgICAgICBzdHIgPSBDaGF0TWVzc2FnZS5wYXJzZVN0cmluZyhzdHIpO1xyXG4gICAgICAgIHRoaXMuX2FkZENoYXRUZXh0VG9SZWNvcmQoc3RyKTtcclxuICAgIH0sXHJcblxyXG4gICAgYWRkQ2hhdEVtb2ppTWVzc2FnZTpmdW5jdGlvbih1c2VySWQsZW1vamkpe1xyXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gdGhpcy5fcGxheWVySW5mb3MgfHwgW107XHJcblxyXG4gICAgICAgIHZhciBuaWNrbmFtZSA9IFwiW0lEOlwiICsgdXNlcklkICsgXCLor7Rd77yaXCI7XHJcbiAgICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy5fcGxheWVySW5mb3MuZmluZChmdW5jdGlvbiAodXNlckluZm8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVzZXJJbmZvLmlkID09IHVzZXJJZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAodXNlckluZm8pIHtcclxuICAgICAgICAgICAgbmlja25hbWUgPSBcIltcIiArIHVzZXJJbmZvLm5pY2tuYW1lICsgXCLor7Rd77yaXCI7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgc3RyID0gbmlja25hbWUgKyBlbW9qaTtcclxuICAgICAgICBzdHIgPSBDaGF0TWVzc2FnZS5wYXJzZVN0cmluZyhzdHIpO1xyXG4gICAgICAgIHRoaXMuX2FkZENoYXRFbW9qaVRvUmVjb3JkKGVtb2ppKTtcclxuICAgICAgICAvLyBjYy5sb2coZW1vamkpXHJcbiAgICAgICAgLy8gY2MubG9nKCctLS0xOTAnKVxyXG4gICAgfSxcclxuXHJcbiAgICBfYWRkQ2hhdEVtb2ppVG9SZWNvcmQ6ZnVuY3Rpb24oZW1vamkpe1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLl9sb2FkRW1vamlGcmFtZShlbW9qaSxmdW5jdGlvbihmcmFtZSl7XHJcbiAgICAgICAgICAgIC8vdmFyIGl0ZW0gID0gY2MuaW5zdGFudGlhdGUoc2VsZi5lbW9qaVByZWZhYik7XHJcbiAgICAgICAgICAgIC8vY2MubG9nKGZyYW1lKVxyXG4gICAgICAgICAgICAvL3ZhciBidG5TcHJpdGVzID0gIGl0ZW0uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgICAgICAgIC8vYnRuU3ByaXRlcy5zcHJpdGVGcmFtZSA9IGZyYW1lO1xyXG4gICAgICAgICAgICAvL2xldCBjaGF0RW1vamlSZWNvcmQgPSBpdGVtLmdldENvbXBvbmVudCgnQ2hhdFRleHRSZWNvcmQnKTtcclxuICAgICAgICAgICAgLy9jaGF0RW1vamlSZWNvcmQuc2V0RW1vamkoZnJhbWUpO1xyXG4gICAgICAgICAgICBDaGF0TWVzc2FnZS5zZXRFbW9qaShmcmFtZSk7XHJcblxyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG5cclxuICAgIF9sb2FkRW1vamlGcmFtZSA6ZnVuY3Rpb24oRW1vamluYW1lICxjYWxsYmFjayl7XHJcbiAgICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCIvdGV4dHVyZXMvY2hhdC9icVwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcclxuICAgICAgICAgICAgaWYoZXJyKXtcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cobnVsbCwgZXJyKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKEVtb2ppbmFtZSk7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGZyYW1lKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfYWRkQ2hhdFRleHRUb1JlY29yZDogZnVuY3Rpb24gKHRleHQpIHtcclxuICAgICAgICB2YXIgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2hhdFRleHRSZWNvcmRQcmVmYWIpO1xyXG4gICAgICAgIGxldCBjaGF0VGV4dFJlY29yZCA9IGl0ZW0uZ2V0Q29tcG9uZW50KCdDaGF0VGV4dFJlY29yZCcpO1xyXG4gICAgICAgIGNoYXRUZXh0UmVjb3JkLnNldFN0cmluZyh0ZXh0KTtcclxuXHJcbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkTGF5b3V0Lm5vZGUuYWRkQ2hpbGQoaXRlbSk7XHJcbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkU2Nyb2xsVmlldy5zY3JvbGxUb0JvdHRvbSgpO1xyXG4gICAgfSxcclxufSk7XHJcbiIsInZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xyXG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBleGl0QWN0aW9uOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmVuZCgpO1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwiZXhpdEFwcFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJleGl0QXBwXCIsIFwiKClWXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsIi8vIG51bWJlci5rcV90aW1lcyhmKSAgIOiwg+eUqOWkmuasoVxyXG5cclxuXHJcbmlmICghTnVtYmVyLnByb3RvdHlwZS5rcV90aW1lcykge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIOiwg+eUqOS4gOS4quaWueazlSB0aGlzIOasoVxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gZiDopoHosIPnlKjnmoTmlrnms5VcclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gICB0aGlzQXJnICAg5Y+v6YCJ77ybIGYg55qEIHRoaXPlgLxcclxuICAgICAqL1xyXG4gICAgTnVtYmVyLnByb3RvdHlwZS5rcV90aW1lcyA9IGZ1bmN0aW9uKGYsIHRoaXNBcmcpIHtcclxuICAgICAgICBpZiAoIWYpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXNBcmcpIHtcclxuICAgICAgICAgICAgICAgIGYuYXBwbHkodGhpc0FyZywgaSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmKGkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuXHJcbi8vIOeUqOS6juWbnuaUvueahOe7hOS7tlxyXG5jb25zdCBQbGF5YmFjayA9IGNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgIF9wbGF5YmFja0RhdGFzOiBudWxsLCAgIC8vIOeUqOS6juWbnuaUvueahOaVsOaNrlxyXG4gICAgICBfaXNQbGF5YmFja2luZzogZmFsc2UsXHJcbiAgICB9LFxyXG5cclxuICAgIHN0YXRpY3M6IHtcclxuICAgICAgaW5zdGFuY2U6IG51bGwsXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBQbGF5YmFjay5pbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgIGNjLmdhbWUuYWRkUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOiuvue9ruWbnuaUvuaVsOaNrlxyXG4gICAgc2V0UGxheWJhY2tEYXRhczogZnVuY3Rpb24gKGRhdGFzKSB7XHJcbiAgICAgIHRoaXMuX3BsYXliYWNrRGF0YXMgPSBkYXRhcztcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5riF56m65Zue5pS+5pWw5o2u44CC5ZCM5pe25Lya5riF56m65Zue5pS+XHJcbiAgICByZW1vdmVQbGF5YmFja0RhdGFzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuc2V0UGxheWJhY2tEYXRhcyhudWxsKTtcclxuICAgICAgdGhpcy5zdG9wUGxheWJhY2soKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5piv5ZCm5YyF5ZCr5Zue5pS+5pWw5o2uXHJcbiAgICBpc0NvbnRhaW5QbGF5YmFja0RhdGFzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9wbGF5YmFja0RhdGFzICE9IG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOW8gOWni+WbnuaUvlxyXG4gICAgc3RhcnRQbGF5YmFjazogZnVuY3Rpb24gKCkge1xyXG4gICAgICAvLyDmqKHmi58gc29ja2V0IOaOpeaUtuWIsOS6huS6i+S7tuWNs+WPr1xyXG4gICAgICAvL2NjLmxvZyhcIlBsYXliYWNrIOW8gOWni+WbnuaUvlwiKTtcclxuXHJcbiAgICAgIHRoaXMuX2lzUGxheWJhY2tpbmcgPSB0cnVlO1xyXG5cclxuICAgICAgaWYgKCF0aGlzLl9wbGF5YmFja0RhdGFzKSB7XHJcbiAgICAgICAgY2MuZXJyb3IoXCLmg7Plm57mlL7vvIzljbTmsqHmnInlm57mlL7mlbDmja5cIik7XHJcbiAgICAgICAgdGhpcy5zdG9wUGxheWJhY2soKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuX2V4ZWN1dGVQbGF5YmFjaygpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDlgZzmraLlm57mlL5cclxuICAgIHN0b3BQbGF5YmFjazogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9pc1BsYXliYWNraW5nID0gZmFsc2U7XHJcbiAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmmK/lkKbmraPlnKjlm57mlL5cclxuICAgIGlzUGxheWJhY2tpbmc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2lzUGxheWJhY2tpbmc7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaJp+ihjOecn+ato+eahOWbnuaUvuaTjeS9nFxyXG4gICAgX2V4ZWN1dGVQbGF5YmFjazogZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgc3RhcnRUaW1lID0gMS4wO1xyXG4gICAgICBsZXQgaW50ZXJ2YWwgPSAzLjA7XHJcbiAgICAgIGNjLmxvZyh0aGlzLl9wbGF5YmFja0RhdGFzKTtcclxuXHJcbiAgICAgIC8vIOWcqOafkOS6m+eJueauiuaDheWGteS4i1xyXG4gICAgICAvLyDlm57mlL7mlbDmja7ph4zkvJrljIXlkKvkuKTlpZcgZ2FtZU92ZXIgYWN0aW9uXHJcbiAgICAgIC8vIOaJgOS7pemcgOimgei/h+a7pOaOieWFtuS4reS4gOS4qlxyXG4gICAgICB0aGlzLl9wbGF5YmFja0RhdGFzID0gdGhpcy5fcGxheWJhY2tEYXRhcy5maWx0ZXIoZnVuY3Rpb24oc3RyaW5nLCBpbmRleCkge1xyXG4gICAgICAgIGlmIChpbmRleCA9PSB0aGlzLl9wbGF5YmFja0RhdGFzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIChzdHJpbmcuaW5kZXhPZignXCJhY3Rpb25cIjpcImdhbWVPdmVyJykgPT0gLTEpO1xyXG4gICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgdGhpcy5fcGxheWJhY2tEYXRhcy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhLCBpbmRleCkge1xyXG4gICAgICAgIHZhciBkZWxheSA9IHN0YXJ0VGltZSArIGluZGV4ICogaW50ZXJ2YWw7XHJcbiAgICAgICAgaWYgKGluZGV4ID09IHRoaXMuX3BsYXliYWNrRGF0YXMubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgLy8g5aaC5p6c5piv5pyA5ZCO5LiA5Liq77yM5YiZ5bqU6K+l5Y+q6Ze06ZqU5LiA56eSXHJcbiAgICAgICAgICBkZWxheSA9IHN0YXJ0VGltZSArIChpbmRleCAtIDEpICogaW50ZXJ2YWwgKyAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgY2MubG9nKFwi5Zue5pS+5byA5aeL5qih5oufIFNvY2tldCDmjqXmlLbliLDmnI3liqHlmajmtojmga8sIFwiLCBpbmRleCk7XHJcbiAgICAgICAgICBTb2NrZXQuaW5zdGFuY2UuX2Rpc3BhdGNoUmVzcG9uc2UoZGF0YSk7XHJcbiAgICAgICAgfSwgZGVsYXkpO1xyXG5cclxuICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICB9LFxyXG5cclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFBsYXliYWNrO1xyXG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcclxuY29uc3QgQXJyYXlFeHRlbnNpb24gPSByZXF1aXJlKCdBcnJheUV4dGVuc2lvbicpO1xyXG5jb25zdCBVc2VyTW9kZWxIZWxwZXIgPSByZXF1aXJlKCdVc2VyTW9kZWxIZWxwZXInKTtcclxuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xyXG5jb25zdCBLUUNhcmRSZXNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRSZXNIZWxwZXInKTtcclxuY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XHJcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xyXG5cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBmb2xkQ2FyZE5vZGU6IGNjLk5vZGUsICAgICAgLy8g54mM55uW552A5pe255qE5qC35a2QXHJcbiAgICAgICAgdGVTaHVQYWlOb2RlOiBjYy5Ob2RlLCAgICAgIC8vIOeJueauiueJjOebluedgOaXtueahOagt+WtkFxyXG4gICAgICAgIGNhcmRzQmFja0xheW91dDogY2MuTGF5b3V0LCAvLyAxM+W8oOeJjOiDjOW9se+8jOWPr+eUqOadpeWxleekuuWPkeeJjOWKqOeUuyDlkKsgY2FyZHNCYWNrIENvbXBvbmVudFxyXG4gICAgICAgIGNvbXBhcmVDYXJkc05vZGU6IGNjLk5vZGUsICAvLyBjb21wYXJlQ2FyZHMgICDlkKsgQ29tcGFyZUNhcmRzIENvbXBvbmVudFxyXG4gICAgICAgIHVzZXJJbmZvTm9kZTogY2MuTm9kZSwgICAgICAgICAgLy8g5YyF5ZCr55So5oi35L+h5oGvIOWQqyB1c2VySW5mbyBDb21wb25lbnRcclxuICAgICAgICBjaGF0TWVzc2FnZU5vZGU6IGNjLk5vZGUsICAgICAgIC8vIOiBiuWkqea2iOaBryDljIXlkKsgQ2hhdE1lc3NhZ2UgQ29tcG9uZW50XHJcbiAgICAgICAgdXNlckF2YXRhck5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgLy91c2VyU2FtcGxlSW5mb05vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgYnVsbGV0SG9sZVByZWZhYjogY2MuUHJlZmFiLC8v5Lit5p6qXHJcbiAgICAgICAgYnVsbGV0SG9sZU5vZGU6IGNjLk5vZGUsLy/kuK3mnqpcclxuICAgICAgICBzaG90Tm9kZTogW2NjLk5vZGVdLC8v5omT5p6qXHJcbiAgICAgICAgdXNlcklkOiAwLFxyXG4gICAgICAgIGNhcmRUeXBlUHJlZmFiOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgLy8g55So5oi35L+h5oGvXHJcbiAgICAgICAgLy8gMeOAgSDlpoLmnpwg5YyF5ZCr77yaY2FyZEluZm86W13vvIzooajmmI7nlKjmiLflt7Lnu4/lh7rniYxcclxuICAgICAgICAvL1xyXG4gICAgICAgIF91c2VySW5mbzogbnVsbCxcclxuICAgICAgICBfZGVza0luZm86IG51bGwsXHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHBsYXllZENvbXBhcmVDYXJkc0luZGV4czoge1xyXG4gICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgZGVmYXVsdDogdW5kZWZpbmVkLFxyXG4gICAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy51c2VyQXZhdGFyTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgdGhpcy5fc2hvd1VzZXJJbmZvLCB0aGlzKTtcclxuICAgICAgICB0aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID0gZmFsc2U7Ly/liKTmlq3mmK/lkKbngrnlh7vkuobmi43nmoTog4zlvbFcclxuICAgICAgICB0aGlzLmNhcmRTcHJpdGVBdGxhcyA9IHRoaXMubm9kZS5wYXJlbnQuZ2V0Q29tcG9uZW50KCdwbGF5JykuY2FyZFNwcml0ZUF0bGFzO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnVzZXJBdmF0YXJOb2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgdGhpcy5fc2hvd1VzZXJJbmZvLCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tfbGVhdmU6ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgdXNlcmlkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIHZhciBsZWF2ZUlkID0gdGhpcy5fdXNlckluZm8uaWQ7XHJcbiAgICAgICAgU29ja2V0LnNlbmRRaW5nbGkobGVhdmVJZCx1c2VyaWQpO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgX3Nob3dVc2VySW5mbzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vdGhpcy51c2VyU2FtcGxlSW5mb05vZGUuZ2V0Q29tcG9uZW50KCdVc2VyU2FtcGxlSW5mbycpLnVwZGF0ZVdpdGhVc2VyKHRoaXMuX3VzZXJJbmZvKTtcclxuICAgIH0sXHJcblxyXG4gICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy50ZVNodVBhaU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ1bGxldEhvbGVOb2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe25vZGUuYWN0aXZlID0gZmFsc2U7fSk7XHJcbiAgICAgICAgaWYodGhpcy5zaG90Tm9kZS5sZW5ndGggPiAwKSB0aGlzLnNob3ROb2RlLmZvckVhY2goZnVuY3Rpb24obm9kZSl7aWYobm9kZSkgbm9kZS5hY3RpdmUgPSBmYWxzZTt9KTtcclxuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjKi9cclxuICAgIHJlc2V0MjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMudGVTaHVQYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2RlKXtub2RlLmFjdGl2ZSA9IGZhbHNlO30pO1xyXG4gICAgICAgIGlmKHRoaXMuc2hvdE5vZGUubGVuZ3RoID4gMCkgdGhpcy5zaG90Tm9kZS5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe2lmKG5vZGUpIG5vZGUuYWN0aXZlID0gZmFsc2U7fSk7XHJcbiAgICAgICAgLy90aGlzLmNvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLy90aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5yZXNldCgpO1xyXG4gICAgfSxcclxuICAgIC8qIyMjIyMqL1xyXG5cclxuICAgIHVwZGF0ZVVzZXJJbmZvV2l0aFVzZXJzOiBmdW5jdGlvbiAodXNlcnMpIHtcclxuICAgICAgICBsZXQgdXNlciA9IHVzZXJzLmZpbmQoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXNlcklkID09IGUuaWQ7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGVVc2VySW5mbyh1c2VyKTtcclxuICAgIH0sXHJcbiAgICBzaG93UWluZ2xpOmZ1bmN0aW9uKGNyZWF0b3IsIGluZGV4KXtcclxuICAgICAgICBpZighdGhpcy5ub2RlLmFjdGl2ZSl7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoaW5kZXg+MCl7XHJcbiAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRxaW5nbGkoZmFsc2UpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBpZihjcmVhdG9yKXtcclxuICAgICAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRxaW5nbGkoZmFsc2UpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRxaW5nbGkodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlVXNlckluZm86IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckluZm8gPSB1c2VyO1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSAodXNlciAhPSBudWxsKTtcclxuICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5hY3RpdmUgPSB0aGlzLm5vZGUuYWN0aXZlO1xyXG4gICAgICAgIGlmICghdXNlcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XHJcbiAgICAgICAgdXNlckluZm8udXBkYXRlQXZhdGFyKHVzZXIuYXZhdGFyVXJsKTtcclxuICAgICAgICB1c2VySW5mby51cGRhdGVVc2VySWQodXNlci5pZCk7XHJcbiAgICAgICAgdXNlckluZm8udXBkYXRlTmlja25hbWUodXNlci5uaWNrbmFtZSk7XHJcbiAgICAgICAgdXNlckluZm8uc2V0T2ZmbGluZVZpc2libGUoIXVzZXIub25saW5lU3RhdHVzKTtcclxuXHJcbiAgICAgICAgLy9pZiAodGhpcy5fZGVza0luZm8gJiYgdGhpcy5fZGVza0luZm8uY0luZGV4ID4gMCkge1xyXG4gICAgICAgIC8vICBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModXNlcikpIHtcclxuICAgICAgICAvLyAgICB0aGlzLnBsYXlDYXJkKHVzZXIuaWQpO1xyXG4gICAgICAgIC8vICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNldENvbXBhcmVEYXRhKHVzZXIpO1xyXG4gICAgICAgIC8vICB9XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIGNvbnN0IGNJbmRleCA9IHRoaXMuX2Rlc2tJbmZvLmNJbmRleDtcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8gJiYgY0luZGV4ID4gMCAmJiAodGhpcy5wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMuaW5kZXhPZihjSW5kZXgpID09IC0xKSkge1xyXG4gICAgICAgICAgICBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModXNlcikpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheUNhcmQodXNlci5pZCx1c2VyLmNhcmRJbmZvKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNldENvbXBhcmVEYXRhKHVzZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKi9cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5pu05paw5oi/5Li75L+h5oGvXHJcbiAgICB1cGRhdGVCYW5rZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCB1c2VySW5mb0NvbXAgPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLl91c2VySW5mbykge1xyXG4gICAgICAgICAgICB1c2VySW5mb0NvbXAuc2V0SXNCYW5rZXIoZmFsc2UpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaXNCYW5rZXIgPSB0aGlzLl91c2VySW5mbyA/IHRoaXMuX3VzZXJJbmZvLmlzQmFua2VyIDogZmFsc2U7XHJcbiAgICAgICAgdXNlckluZm9Db21wLnNldElzQmFua2VyKGlzQmFua2VyKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvd0ZhbmdaaHVTdGF0dXM6IGZ1bmN0aW9uIChjcmVhdGVJZCwgdmlzaWJsZSA9IHRydWUpIHtcclxuICAgICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fdXNlckluZm8uaWQgPT0gY3JlYXRlSWQpIHtcclxuICAgICAgICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldEZhbmdaaHVOb2RlVmlzaWJsZSh2aXNpYmxlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pu05paw5YiG5pWwXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHNjb3JlIOeUqOaIt+WIhuaVsOOAgeWPr+mAiVxyXG4gICAgICovXHJcbiAgICB1cGRhdGVTY29yZTogZnVuY3Rpb24oc2NvcmUpIHtcclxuICAgICAgICBpZiAoIXNjb3JlICYmIHRoaXMuX3VzZXJJbmZvKSB7XHJcbiAgICAgICAgICAgIHNjb3JlID0gdGhpcy5fdXNlckluZm8udG90YWxTY29yZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcclxuICAgICAgICB1c2VySW5mby51cGRhdGVTY29yZShzY29yZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dSZWFkeVN0YXR1czogZnVuY3Rpb24gKHVzZXJJZCwgdmlzaWJsZSA9IHRydWUpIHtcclxuICAgICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3VzZXJJbmZvLmlkID09IHVzZXJJZCkge1xyXG4gICAgICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZSh2aXNpYmxlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2hvd0JlaWx2OmZ1bmN0aW9uKHVzZXJJZCxibCl7XHJcbiAgICAgICAgaWYoIXRoaXMubm9kZS5hY3RpdmUpe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCB0aGlzLl91c2VySW5mby5pZCA9PSB1c2VySWQgKXtcclxuICAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRCZWlsdkxhYmVsKGJsKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLypzZXREZXNrSW5mbzogZnVuY3Rpb24gKGRlc2tJbmZvKSB7XHJcbiAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcclxuICAgICB9LCovXHJcbiAgICB1cGRhdGVEZXNrSW5mbzogZnVuY3Rpb24gKGRlc2tJbmZvKSB7XHJcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcclxuXHJcbiAgICAgICAgaWYgKGRlc2tJbmZvICYmICFkZXNrSW5mby5pc0NCZWdpbikge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8qKi9cclxuXHJcbiAgICBoaWRlUmVhZHlTdGF0dXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZShmYWxzZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHBsYXlGYVBhaUFuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5ub2RlLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyh0aGlzLl91c2VySW5mbykpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgY2FyZHNCYWNrID0gdGhpcy5jYXJkc0JhY2tMYXlvdXQuZ2V0Q29tcG9uZW50KCdjYXJkc0JhY2snKTtcclxuICAgICAgICBjYXJkc0JhY2suc2hvd1BsYXlDYXJkQmFja3MoKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvdWxkU2hvd0ZhUGFpQW5pbWF0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKHRoaXMuX3VzZXJJbmZvKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2V0VXNlck9ubGluZVN0YXR1czogZnVuY3Rpb24gKHVzZXJJZCwgc3RhdHVzID0gMSkge1xyXG4gICAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xyXG4gICAgICAgIHVzZXJJbmZvLnNldE9mZmxpbmVWaXNpYmxlKHN0YXR1cyAhPSAxKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvd0NoYXRUZXh0OiBmdW5jdGlvbiAodXNlcklkLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgaWYgKHVzZXJJZCAhPSB0aGlzLnVzZXJJZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgY2hhdE1lc3NhZ2UgPSB0aGlzLmNoYXRNZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoJ0NoYXRNZXNzYWdlJyk7XHJcbiAgICAgICAgY2hhdE1lc3NhZ2Uuc2V0U3RyaW5nKG1lc3NhZ2UpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDnlKjmiLflt7Lnu4/lh7rniYzvvIzlpITkuo7kuInloIbnm5bnnYDniYznmoTnirbmgIFcclxuICAgIHBsYXlDYXJkOiBmdW5jdGlvbiAodXNlcklkLGNhcmRJbmZvKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudXNlcklkICE9IHVzZXJJZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS50YXJnZXRPZmYodGhpcy5mb2xkQ2FyZE5vZGUpO1xyXG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUuY2hpbGRyZW4uc2xpY2UoMCwzKS5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe1xyXG4gICAgICAgICAgICBub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihub2Upe1xyXG4gICAgICAgICAgICAgICAgbm9lLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRTcHJpdGUgPSBub2UuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9ICdwdWJsaWMtcGljLWNhcmQtcG9rZXItYmFjayc7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZSh0aGlzLmNhcmRTcHJpdGVBdGxhcywgcGF0aCAsY2FyZFNwcml0ZSk7XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5fY2xpY2tGb2xkQ2FyZE5vZGUoZXZlbnQpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSx0aGlzLmZvbGRDYXJkTm9kZSk7XHJcblxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX2NsaWNrRm9sZENhcmROb2RlOiBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudXNlcklkICE9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICB2YXIgY2FyZEluZm8gPSB0aGlzLl91c2VySW5mby5jYXJkSW5mby5sZW5ndGggPT0gMT8gdGhpcy5fdXNlckluZm8uY2FyZEluZm9bMF0uY2FyZHM6IHRoaXMuX3VzZXJJbmZvLmNhcmRJbmZvO1xyXG5cclxuICAgICAgICB2YXIgY2FyZHMgPSBjYXJkSW5mby5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xyXG5cclxuICAgICAgICAgICAgaWYodGhpcy5fdXNlckluZm8uY2FyZEluZm8ubGVuZ3RoID09IDEpIHJldHVybiBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZEluZm9JdGVtKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZEluZm9JdGVtLmNhcmRzKTtcclxuXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge3JldHVybiBhcnJheS5jb25jYXQoc3ViQ2FyZHMpO30sIFtdKTtcclxuXHJcbiAgICAgICAgdmFyIGZvbGRDYXJkTm9kZSA9IHRoaXMuZm9sZENhcmROb2RlLmNoaWxkcmVuLnNsaWNlKDAsMyk7XHJcblxyXG4gICAgICAgIHZhciBub2RlcyA9IGZvbGRDYXJkTm9kZS5tYXAoZnVuY3Rpb24gKG5vZGUpIHtyZXR1cm4gbm9kZS5jaGlsZHJlbjt9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWIpIHtyZXR1cm4gYXJyYXkuY29uY2F0KHN1Yik7fSwgW10pO1xyXG5cclxuICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChrcUNhcmQsIGluZGV4KSB7XHJcblxyXG4gICAgICAgICAgICBpZiAoaW5kZXggPj0gbm9kZXMubGVuZ3RoKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBub2Rlc1tpbmRleF0ucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuXHJcbiAgICAgICAgICAgIG5vZGVzW2luZGV4XS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICB2YXIgbm9kZHMxID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcclxuXHJcbiAgICAgICAgICAgIG5vZGRzMS53aWR0aCA9IG5vZGVzWzBdLndpZHRoO1xyXG5cclxuICAgICAgICAgICAgbm9kZHMxLmhlaWdodCA9IG5vZGVzWzBdLmhlaWdodDtcclxuXHJcbiAgICAgICAgICAgIG5vZGRzMS5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTsgLy/mt7vliqDnsr7ngbXnu4Tku7ZcclxuXHJcbiAgICAgICAgICAgIHZhciBjYXJkU3ByaXRlID0gbm9kZHMxLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XHJcblxyXG4gICAgICAgICAgICBjYXJkU3ByaXRlLnNpemVNb2RlID0gMDtcclxuXHJcbiAgICAgICAgICAgIHZhciBjYXJkTmFtZSA9IHRoaXMuZm9sZENhcmROb2RlQmFjayA9PSBmYWxzZT8ga3FDYXJkLmNhcmROYW1lKCk6IFwiYmFja1wiO1xyXG5cclxuICAgICAgICAgICAgbm9kZHMxLmNhcmROYW1lID0gY2FyZE5hbWU7XHJcblxyXG4gICAgICAgICAgICB2YXIgcGF0aCA9ICdwdWJsaWMtcGljLWNhcmQtcG9rZXItJysgY2FyZE5hbWU7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKHRoaXMuY2FyZFNwcml0ZUF0bGFzLCBwYXRoICxjYXJkU3ByaXRlKTtcclxuXHJcbiAgICAgICAgICAgIGlmKGNjLm1hUGFpID09IGNhcmROYW1lKXtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZHMgPSBuZXcgY2MuTm9kZSgpOyAvL+WIm+W7uuS4gOS4quiKgueCueWvueixoVxyXG5cclxuICAgICAgICAgICAgICAgIG5vZGRzLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxyXG5cclxuICAgICAgICAgICAgICAgIGNjLmxvYWRlci5sb2FkUmVzKCdwbGF5L2Rlc2svaW1nX3JlZDVfMScsIGNjLlNwcml0ZUZyYW1lLCBmdW5jdGlvbiAoZXJyLCBzcHJpdGVGcmFtZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7Y2MuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyKTtyZXR1cm47fVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgYnRuU3ByaXRlMSA9IG5vZGRzLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJ0blNwcml0ZTEubm9kZS53aWR0aCA9IGNhcmRTcHJpdGUubm9kZS53aWR0aCArIDEwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBidG5TcHJpdGUxLm5vZGUuaGVpZ2h0ID0gY2FyZFNwcml0ZS5ub2RlLmhlaWdodCArIDEwO1xyXG5cclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FyZFNwcml0ZS5ub2RlLmFkZENoaWxkKG5vZGRzKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG5vZGVzW2luZGV4XS5hZGRDaGlsZChub2RkczEpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIHZhciBjYXJkczAgPSBjYXJkcy5zbGljZSgwLDMpXHJcbiAgICAgICAgdmFyIGNhcmRzMSA9IGNhcmRzLnNsaWNlKDMsOClcclxuICAgICAgICB2YXIgY2FyZHMyID0gY2FyZHMuc2xpY2UoOCwxMylcclxuXHJcbiAgICAgICAgY2FyZHMgPSBbY2FyZHMwLCBjYXJkczEsIGNhcmRzMl1cclxuICAgICAgICAvL+WktOmBk1xyXG4gICAgICAgIGxldCB0eXBlTmFtZTAgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzMCkrMTtcclxuICAgICAgICB0eXBlTmFtZTAgPSB0eXBlTmFtZTA+PTEwID8gdHlwZU5hbWUwIDpcIjBcIit0eXBlTmFtZTA7XHJcbiAgICAgICAgdHlwZU5hbWUwID0gdHlwZU5hbWUwPT0nMDQnID8gJzExJyA6dHlwZU5hbWUwO1xyXG5cclxuICAgICAgICAvL+S4remBk1xyXG4gICAgICAgIGxldCB0eXBlTmFtZTEgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzMSkrMTtcclxuICAgICAgICB0eXBlTmFtZTEgPSB0eXBlTmFtZTE+PTEwID8gdHlwZU5hbWUxIDpcIjBcIit0eXBlTmFtZTE7XHJcbiAgICAgICAgdHlwZU5hbWUxID0gdHlwZU5hbWUxPT0nMDcnID8gJzIyJyA6dHlwZU5hbWUxO1xyXG5cclxuICAgICAgICAvL+WwvumBk1xyXG4gICAgICAgIGxldCB0eXBlTmFtZTIgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzMikrMTtcclxuICAgICAgICB0eXBlTmFtZTIgPSB0eXBlTmFtZTI+PTEwID8gdHlwZU5hbWUyIDpcIjBcIit0eXBlTmFtZTI7XHJcblxyXG5cclxuICAgICAgICBpZih0eXBlTmFtZTApIEtRQ2FyZC5fc2V0R3VpQ2FyZCgwLCAwLCAzLCB0eXBlTmFtZTAsIGNhcmRzLCBub2RlcywgdGhpcy5jYXJkU3ByaXRlQXRsYXMpO1xyXG4gICAgICAgIGlmKHR5cGVOYW1lMSkgS1FDYXJkLl9zZXRHdWlDYXJkKDEsIDMsIDgsIHR5cGVOYW1lMSwgY2FyZHMsIG5vZGVzLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XHJcbiAgICAgICAgaWYodHlwZU5hbWUyKSBLUUNhcmQuX3NldEd1aUNhcmQoMiwgOCwgMTMsIHR5cGVOYW1lMiwgY2FyZHMsIG5vZGVzLCB0aGlzLmNhcmRTcHJpdGVBdGxhcyk7XHJcbiAgICAgICAgaWYodGhpcy5mb2xkQ2FyZE5vZGVCYWNrID09IGZhbHNlKXtcclxuICAgICAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGVCYWNrID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLmZvbGRDYXJkTm9kZUJhY2sgPT0gdHJ1ZSl7XHJcbiAgICAgICAgICAgIHRoaXMuZm9sZENhcmROb2RlQmFjayA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbihTcHJpdGVGcmFtZSwgcGF0aCwgU3ByaXRlc05vZGUsIHcsIGgpIHtcclxuXHJcbiAgICAgICAgdmFyIFNwcml0ZSA9IFNwcml0ZUZyYW1lLmdldFNwcml0ZUZyYW1lKCBwYXRoICk7XHJcblxyXG4gICAgICAgIFNwcml0ZXNOb2RlLnNwcml0ZUZyYW1lID0gU3ByaXRlO1xyXG5cclxuICAgICAgICBpZih3KSBTcHJpdGVzTm9kZS5ub2RlLndpZHRoID0gdztcclxuXHJcbiAgICAgICAgaWYoaCkgU3ByaXRlc05vZGUubm9kZS5oZWlnaHQgPSBoO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDlh4blpIflpb3lvIDlp4vmr5TniYxcclxuICAgIC8vIHJlYWR5VG9Db21wYXJlQ2FyZHM6IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgICB0aGlzLmZvbGRDYXJkTm9kZS50YXJnZXRPZmYodGhpcy5mb2xkQ2FyZE5vZGUpO1xyXG4gICAgLy8gICAgIHRoaXMuZm9sZENhcmROb2RlQmFjayA9IHRydWU7XHJcbiAgICAvLyAgICAgdGhpcy5fY2xpY2tGb2xkQ2FyZE5vZGUoKTtcclxuICAgIC8vICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgLy8gICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgLy8gICAgIC8vdGhpcy5mb2xkQ2FyZE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAvLyAgICAgaWYodGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXIpe1xyXG4gICAgLy8gICAgICAgICBpZih0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlci5pc0NvbnRhaW5FeHRyYSl7XHJcbiAgICAvLyAgICAgICAgICAgICB0aGlzLnRlU2h1UGFpTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgLy8gICAgICAgICB9ZWxzZXtcclxuICAgIC8vICAgICAgICAgICAgIHRoaXMudGVTaHVQYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfSxcclxuICAgIHJlYWR5VG9Db21wYXJlQ2FyZHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS50YXJnZXRPZmYodGhpcy5mb2xkQ2FyZE5vZGUpO1xyXG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlQmFjayA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fY2xpY2tGb2xkQ2FyZE5vZGUoKTtcclxuICAgICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgaWYodGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXIpe1xyXG4gICAgICAgICAgICBpZih0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlci5pc0NvbnRhaW5FeHRyYSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRlU2h1UGFpTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHRoaXMudGVTaHVQYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmkq3mlL7miZPmnqrliqjnlLtcclxuICAgIC8vIEBwYXJhbSB1c2VySWQgICDopoHkuLvliqjmiZPmnqrnmoTnlKjmiLdpZFxyXG4gICAgLy8gQHBhcmFtIHRvVXNlckluZGV4ICDmjKjmnqrnmoTnlKjmiLfnmoQgaW5kZXhcclxuICAgIHBsYXlTaG9vdEFuaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCwgdG9Vc2VySW5kZXgpIHtcclxuICAgICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNob3ROb2RlID0gdGhpcy5zaG90Tm9kZVt0b1VzZXJJbmRleF07XHJcbiAgICAgICAgc2hvdE5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBzaG90Tm9kZS5jaGlsZHJlblswXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHNob3ROb2RlLmNoaWxkcmVuWzFdLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIC8v5p6qXHJcbiAgICAgICAgdmFyIHJvdGF0ZUJ5ID0gY2Mucm90YXRlVG8oMC4xLC0xNSk7XHJcbiAgICAgICAgdmFyIGRlbGF5MSA9IGNjLmRlbGF5VGltZSgwLjEpO1xyXG4gICAgICAgIHZhciByb3RhdGVCeTEgPSBjYy5yb3RhdGVUbygwLjEsMCk7XHJcbiAgICAgICAgdmFyIHN0YXJ0X2Z1bmMxID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtzaG90Tm9kZS5jaGlsZHJlblswXS5hY3RpdmUgPSB0cnVlO30pO1xyXG4gICAgICAgIHZhciBlbmRfZnVuYzEgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe3Nob3ROb2RlLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IGZhbHNlO30pO1xyXG4gICAgICAgIHZhciBhY3Rpb24gPSBjYy5yZXBlYXQoY2Muc2VxdWVuY2Uoc3RhcnRfZnVuYzEgLHJvdGF0ZUJ5LCBkZWxheTEsIHJvdGF0ZUJ5MSwgZW5kX2Z1bmMxKSwzKTtcclxuXHJcbiAgICAgICAgLy/ng59cclxuICAgICAgICB2YXIgZmFkZUluID0gY2MuZmFkZUluICgwKTtcclxuICAgICAgICB2YXIgc2NhbGVUbzEgPSBjYy5zY2FsZVRvICgwLCAwLjgpO1xyXG4gICAgICAgIHZhciBzY2FsZVRvMiA9IGNjLnNjYWxlVG8gKDAuMDgsIDEpO1xyXG4gICAgICAgIHZhciBmYWRlT3V0QW5kU2NhbGVUbyA9IGNjLnNwYXduKGNjLmZhZGVPdXQoMC4wMiksIGNjLnNjYWxlVG8oMC4wMiwgMC41KSk7XHJcbiAgICAgICAgdmFyIGRlbGF5MiA9IGNjLmRlbGF5VGltZSguMik7XHJcbiAgICAgICAgdmFyIHN0YXJ0X2Z1bmMyID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtzaG90Tm9kZS5jaGlsZHJlblsxXS5hY3RpdmUgPSB0cnVlO30pO1xyXG4gICAgICAgIHZhciBlbmRfZnVuYzIgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe3Nob3ROb2RlLmNoaWxkcmVuWzFdLmFjdGl2ZSA9IGZhbHNlO30pO1xyXG4gICAgICAgIHZhciBhY3Rpb24xID0gIGNjLnJlcGVhdChjYy5zZXF1ZW5jZShzdGFydF9mdW5jMiwgZmFkZUluLCBzY2FsZVRvMSwgc2NhbGVUbzIsIGZhZGVPdXRBbmRTY2FsZVRvLCBkZWxheTIsIGVuZF9mdW5jMiksMyk7XHJcblxyXG4gICAgICAgIHNob3ROb2RlLmNoaWxkcmVuWzBdLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgIHNob3ROb2RlLmNoaWxkcmVuWzFdLnJ1bkFjdGlvbihhY3Rpb24xKTtcclxuXHJcblxyXG4gICAgICAgIC8vbGV0IHVzZXJJbmZvID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xyXG4gICAgICAgIC8vdXNlckluZm8ucGxheVNob290QW5pbWF0aW9uKHRvVXNlckluZGV4KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5pKt5pS+5Lit5p6q5Yqo55S7XHJcbiAgICBwbGF5QnVsbGV0SG9sZUFuaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5idWxsZXRIb2xlTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICBsZXQgYnVsbGV0SG9sZU5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmJ1bGxldEhvbGVQcmVmYWIpO1xyXG5cclxuICAgICAgICBidWxsZXRIb2xlTm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe25vZGUuYWN0aXZlID0gZmFsc2U7fS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgYnVsbGV0SG9sZU5vZGUuY2hpbGRyZW5bMF0ueSA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuYnVsbGV0SG9sZU5vZGUuYWRkQ2hpbGQoYnVsbGV0SG9sZU5vZGUpO1xyXG5cclxuICAgICAgICB2YXIgaW50ZXJ2YWwgPSAwLjM7XHJcblxyXG4gICAgICAgIHZhciBpbml0VGltZSA9IDA7XHJcblxyXG4gICAgICAgIGJ1bGxldEhvbGVOb2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24obm9kZSl7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUh1bWFuWlFpYW5nKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgbm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB5ID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSA9PSAwID8gLTEgOiAxO1xyXG5cclxuICAgICAgICAgICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMzgpICogeTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgeCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgPT0gMCA/IC0xIDogMTtcclxuXHJcbiAgICAgICAgICAgICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjM4KSAqIHg7XHJcblxyXG4gICAgICAgICAgICAgICAgbm9kZS54ID0geDtcclxuXHJcbiAgICAgICAgICAgICAgICBub2RlLnkgPSB5O1xyXG5cclxuICAgICAgICAgICAgfSwgaW5pdFRpbWUpO1xyXG5cclxuICAgICAgICAgICAgaW5pdFRpbWUgPSBpbml0VGltZSArIGludGVydmFsO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5pKt5pS+5YWo5Z6S5omT5Yqo55S7XHJcbiAgICBwbGF5SG9tZVJ1bkFpbWF0aW9uOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgaWYgKHVzZXJJZCAhPSB0aGlzLnVzZXJJZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XHJcbiAgICAgICAgdXNlckluZm8ucGxheUhvbWVSdW5BaW1hdGlvbigpO1xyXG4gICAgfSxcclxuXHJcbiAgICBwbGF5U3BlYWtBbmltYXRpb246IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcclxuICAgICAgICB1c2VySW5mby5wbGF5U3BlYWtBbmltYXRpb24oKTtcclxuICAgIH0sXHJcblxyXG4gICAgbmV4dENvbXBhcmVTY29yZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5ub2RlLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBzY29yZSA9IHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLm5leHRDb21wYXJlU2NvcmUoKTtcclxuICAgICAgICByZXR1cm4gc2NvcmU7XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dOZXh0Q29tcGFyZUNhcmRzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubmV4dENvbXBhcmVTY29yZSgpIDw9IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRlU2h1UGFpTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zaG93TmV4dENhcmRzKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dBbGxDb21wYXJlQ2FyZHM6IGZ1bmN0aW9uICh1c2Vycykge1xyXG4gICAgICAgIGxldCB1c2VyID0gdXNlcnMuZmluZChmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy51c2VySWQgPT0gZS5pZDtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNldENvbXBhcmVEYXRhKHVzZXIpO1xyXG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNob3dBbGxDYXJkcygpO1xyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZVNjb3JlKHRoaXMuX3VzZXJJbmZvLnRvdGFsU2NvcmUgfHwgMCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dOZXh0Q29tcGFyZVNjb3JlOiBmdW5jdGlvbiAoaXNDb250YWluRXh0cmEpIHtcclxuICAgICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zaG93TmV4dENvbXBhcmVTY29yZShpc0NvbnRhaW5FeHRyYSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dTY29yZVJlc3VsdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNob3dTY29yZVJlc3VsdCgpO1xyXG4gICAgfSxcclxufSk7XHJcbiIsImNvbnN0IEtRQ2FyZFJlc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFJlc0hlbHBlcicpO1xyXG5jb25zdCBTcHJpdGVIZWxwZXIgPSByZXF1aXJlKCdTcHJpdGVIZWxwZXInKTtcclxuY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGF2YXRhclNwcml0ZTogY2MuU3ByaXRlLFxyXG4gICAgICAgIGxhYmVsTmlja25hbWU6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxhYmVsUmVzdWx0TnVtYmVyOiBjYy5MYWJlbCxcclxuICAgICAgICBsYXlvdXRUb3VEYW86IGNjLkxheW91dCxcclxuICAgICAgICBsYXlvdXRaaG9uZ0RhbzogY2MuTGF5b3V0LFxyXG4gICAgICAgIGxheW91dFdlaURhbzogY2MuTGF5b3V0LFxyXG4gICAgICAgIGxheW91dFRlU2h1OiBjYy5MYXlvdXQsXHJcblxyXG4gICAgICAgIGxhYmVsVGVTaHVQYWlUaXRsZTogY2MuTGFiZWwsXHJcblxyXG4gICAgICAgIHNjb3JlVW5pdE5vZGU6IGNjLk5vZGUsICAgICAgLy8g56ev5YiGXHJcbiAgICAgICAgZGlhbW9uZFVuaXROb2RlOiBjYy5Ob2RlLCAgICAvLyDpkrvnn7NcclxuICAgIH0sXHJcblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB9LFxyXG5cclxuICAgIC8ve1wiaWRcIjoxMDAwNDksXCJuaWNrbmFtZVwiOlwiaW15YVwiLFwib3BlbklkXCI6XCJ4eFwiLFwiYXZhdGFyVXJsXCI6XCJ4eFwiLFwic2V4XCI6MSxcclxuICAgIC8vIFwiY2FyZE51bWJlclwiOjMsXCJvbmxpbmVTdGF0dXNcIjoxLFwiaW52aXRlQ29kZVwiOlwiXCIsXCJpcEFkZHJlc3NcIjpcIjo6ZmZmZjoyMjIuMjQ0LjY1LjIwMVwiLFxyXG4gICAgLy8gXCJsYXN0TG9naW5UaW1lXCI6XCIyMDE3LTA0LTEzIDIyOjA5OjAxXCIsXCJjcmVhdGVBdFwiOlwiMjAxNy0wNC0xMSAyMjozOTozMFwiLFxyXG4gICAgLy8gXCJ1cGRhdGVBdFwiOlwiMjAxNy0wNC0xMyAyMjowOTowMVwiLFxyXG4gICAgLy8gXCJjYXJkc1wiOltdLFwicm9vbUlkXCI6XCI1OTg4ODNcIixcInJlYWR5U3RhdHVzXCI6dHJ1ZSxcInRvdGFsU2NvcmVcIjowLFxyXG4gICAgLy8gXCJjU2NvcmVcIjowLFwiaXNCYW5rZXJcIjpmYWxzZX1cclxuICAgIHVwZGF0ZVdpdGhQbGF5ZXJJbmZvOiBmdW5jdGlvbiAocGxheWVySW5mbywgaXNSYW5kb21Sb29tID0gZmFsc2UpIHtcclxuICAgICAgU3ByaXRlSGVscGVyLnNldEltYWdlVXJsKHRoaXMuYXZhdGFyU3ByaXRlLCBwbGF5ZXJJbmZvLmF2YXRhclVybCk7XHJcbiAgICAgIHRoaXMubGFiZWxOaWNrbmFtZS5zdHJpbmcgPSBwbGF5ZXJJbmZvLm5pY2tuYW1lO1xyXG4gICAgICAgIC8vY2MubG9nKHRoaXMubGFiZWxSZXN1bHROdW1iZXIuc3RyaW5nKVxyXG4gICAgICAgIC8vY2MubG9nKHBsYXllckluZm8pXHJcbiAgICAgICAgLy9jYy5sb2cocGxheWVySW5mby5jU2NvcmUpXHJcbiAgICAgICAgLy9jYy5sb2coJy0tLTM2JylcclxuICAgICAgdGhpcy5sYWJlbFJlc3VsdE51bWJlci5zdHJpbmcgPSBwbGF5ZXJJbmZvLmNTY29yZTtcclxuXHJcbiAgICAgIHRoaXMuc2NvcmVVbml0Tm9kZS5hY3RpdmUgPSAhaXNSYW5kb21Sb29tO1xyXG4gICAgICB0aGlzLmRpYW1vbmRVbml0Tm9kZS5hY3RpdmUgPSBpc1JhbmRvbVJvb207XHJcbiAgICAgIHZhciBOdW1iZXIgPSBwbGF5ZXJJbmZvLmNTY29yZTtcclxuICAgICAgaWYgKGlzUmFuZG9tUm9vbSkge1xyXG4gICAgICAgIC8vIOWmguaenOaYr+maj+acuuWcuueahOivne+8jOWImeaYvuekuumSu+efs+aVsOmHj1xyXG4gICAgICAgICAgTnVtYmVyID0gcGxheWVySW5mby5jU2NvcmUgKiA1O1xyXG4gICAgICB9XHJcbiAgICAgICAgdGhpcy5sYWJlbFJlc3VsdE51bWJlci5zdHJpbmcgPSBOdW1iZXI7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldENhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgICAgY2MuYXNzZXJ0KGNhcmRzLmxlbmd0aCA9PSAxMyk7XHJcblxyXG4gICAgICAvLyDkuI3kvJrlho3mnInnibnmrorniYzkuoZcclxuICAgICAgIC8qaWYgKEtRQ2FyZC5pc1RlU2h1UGFpKGNhcmRzKSkge1xyXG4gICAgICAgICB0aGlzLnNldFRlU2h1Q2FyZHMoY2FyZHMpO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgICAgIH1cclxuICAgICAgKi9cclxuXHJcbiAgICAgIC8vbGV0IHRvdUNhcmRzID0gY2FyZHMuc2xpY2UoMCwgMyk7XHJcbiAgICAgIC8vbGV0IHpob25nQ2FyZHMgPSBjYXJkcy5zbGljZSgzLCAzICsgNSk7XHJcbiAgICAgIC8vbGV0IHdlaUNhcmRzID0gY2FyZHMuc2xpY2UoOCk7XHJcbiAgICAgIC8vdGhpcy5zZXRUb3VDYXJkcyh0b3VDYXJkcyk7XHJcbiAgICAgIC8vdGhpcy5zZXRaaG9uZ0NhcmRzKHpob25nQ2FyZHMpO1xyXG4gICAgICAvL3RoaXMuc2V0V2VpQ2FyZHMod2VpQ2FyZHMpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKnNldFRvdUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgICAgdGhpcy5fc2V0Q2FyZHNUb0xheW91dCh0aGlzLmxheW91dFRvdURhbywgY2FyZHMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRaaG9uZ0NhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgICAgdGhpcy5fc2V0Q2FyZHNUb0xheW91dCh0aGlzLmxheW91dFpob25nRGFvLCBjYXJkcyk7XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBzZXRXZWlDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy5sYXlvdXRXZWlEYW8sIGNhcmRzKTtcclxuICAgIH0sKi9cclxuXHJcbiAgICAvL+e7k+eulyAg5bCG54m55q6K54mM5pS+5YWlTGF5b3V0XHJcbiAgICAvKnNldFRlU2h1Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgICB0aGlzLmxheW91dFRlU2h1Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgdGhpcy5sYXlvdXRUb3VEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmxheW91dFdlaURhby5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLl9zZXRDYXJkc1RvTGF5b3V0KHRoaXMubGF5b3V0VGVTaHUsIGNhcmRzKTtcclxuXHJcbiAgICAgIGxldCB0eXBlTmFtZSA9IEtRQ2FyZC5jYXJkc1R5cGVOYW1lKGNhcmRzKTtcclxuICAgICAgdGhpcy5sYWJlbFRlU2h1UGFpVGl0bGUuc3RyaW5nID0gdHlwZU5hbWU7XHJcbiAgICB9LCovXHJcblxyXG4gICAvL+e7k+eul+WwhueJjOaUvuWIsExheW91dOmHjOmdolxyXG4gICAgLypfc2V0Q2FyZHNUb0xheW91dDogZnVuY3Rpb24gKGxheW91dCwgY2FyZHMpIHtcclxuICAgICAgbGV0IG5vZGUgPSBsYXlvdXQubm9kZTtcclxuICAgICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChzcHJpdGVOb2RlLCBpbmRleCkge1xyXG4gICAgICAgIGxldCBzcHJpdGUgPSBzcHJpdGVOb2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XHJcbiAgICAgICAgbGV0IGNhcmQgPSBjYXJkc1tpbmRleF07XHJcbiAgICAgICAgaWYgKCFjYXJkKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBLUUNhcmRSZXNIZWxwZXIuc2V0Q2FyZFNwcml0ZUZyYW1lKHNwcml0ZSwgY2FyZC5jYXJkTmFtZSgpKTtcclxuICAgICAgfSk7XHJcbiAgICB9LCovXHJcbn0pO1xyXG4iLCJjb25zdCBNYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xyXG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICBwaG9uZTpjYy5MYWJlbCxcclxuICAgICAgbXVzaWNTbGlkZXI6Y2MuTm9kZSxcclxuICAgICAgZWZmZWN0U2xpZGVyOmNjLk5vZGUsXHJcbiAgICAgIGJ0blN3aXRjaEFjY291bnQ6IGNjLkJ1dHRvbixcclxuICAgICAgc2hhcmVCZzpjYy5Ob2RlLFxyXG4gICAgICB3eDpjYy5Ob2RlLFxyXG4gICAgICBweXE6Y2MuTm9kZSxcclxuICAgICAgbXVzaWM6Y2MuTm9kZSxcclxuICAgICAgc291bmRzOmNjLk5vZGUsXHJcbiAgICAgIF9hdWRpb01hbmFnZXI6IG51bGwsXHJcbiAgICAgIF9tdXNpY09uIDogMSxcclxuICAgICAgX3NvdW5kc09uIDogMSxcclxuICAgICAgX3Bob25lOm51bGwsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlciA9IGNjLmZpbmQoJ0F1ZGlvTWFuYWdlcicpIHx8IHt9O1xyXG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIgPSB0aGlzLl9hdWRpb01hbmFnZXIuZ2V0Q29tcG9uZW50KCdBdWRpb01hbmFnZXInKTtcclxuICAgICAgdGhpcy5faW5pdFNsaWRlcnMoKTtcclxuICAgICAgdGhpcy5waG9uZS5zdHJpbmcgPSB0aGlzLl9waG9uZT90aGlzLl9waG9uZTpcIuaXoFwiO1xyXG4gICAgICAgIHZhciBiZ011c2ljID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdNdXNpY1wiKTtcclxuICAgICAgICB2YXIgYmdTb3VuZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImJnU291bmRcIik7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhiZ011c2ljKTtcclxuICAgICAgICBpZihiZ011c2ljICE9ICcnKSB7XHJcbiAgICAgICAgICAgIGlmIChwYXJzZUludChiZ011c2ljKSA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tdXNpY09uID0gMTtcclxuICAgICAgICAgICAgICAgIHRoaXMubXVzaWMuZ2V0Q2hpbGRCeU5hbWUoJ211c2ljX29uJykuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMubXVzaWMuZ2V0Q2hpbGRCeU5hbWUoJ211c2ljX29mZicpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbXVzaWNPbiA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm11c2ljLmdldENoaWxkQnlOYW1lKCdtdXNpY19vbicpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tdXNpYy5nZXRDaGlsZEJ5TmFtZSgnbXVzaWNfb2ZmJykuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihiZ1NvdW5kID09IDApeyAvLyDlpoLmnpzog4zmma/pn7PmlYjmmK/lhbPpl63nmoRcclxuICAgICAgICAgICAgaWYgKHBhcnNlSW50KGJnU291bmQpID09IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NvdW5kc09uID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc291bmRzLmdldENoaWxkQnlOYW1lKCdzb3VuZHNfb24nKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc291bmRzLmdldENoaWxkQnlOYW1lKCdzb3VuZHNfb2ZmJykuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NvdW5kc09uID0gMTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc291bmRzLmdldENoaWxkQnlOYW1lKCdzb3VuZHNfb24nKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zb3VuZHMuZ2V0Q2hpbGRCeU5hbWUoJ3NvdW5kc19vZmYnKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bSh0aGlzLl9zb3VuZHNPbik7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsaWNrV3g6IGZ1bmN0aW9uKCl7ICAvL+eCueWHu+W+ruS/oVxyXG4gICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcclxuICAgICAgICB0aGlzLnNoYXJlQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnd4LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgIHZhciB0aXRsZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2hhcmVUaXRsZScpO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGVzYycpO1xyXG4gICAgICAgIHZhciByZWNvcmRJZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVjb3JkSWQnKTtcclxuICAgICAgICB2YXIgcm9vbUlkID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyb29tSWQnKTtcclxuICAgICAgICB2YXIgaWQ9ICcnO1xyXG4gICAgICAgIGlmKHJvb21JZCl7XHJcbiAgICAgICAgICAgIGlkID0gJ3Jvb21JZD0nK3Jvb21JZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocmVjb3JkSWQpe1xyXG4gICAgICAgICAgICBpZCA9ICdyZWNvcmRJZD0nK3JlY29yZElkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVGcmllbmQ6ZGVzY3JpcHRpb246XCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLHN0ciwgaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICB9LFxyXG4gICAgY2xpY2tQeXE6IGZ1bmN0aW9uKCl7IC8v54K55Ye75pyL5Y+L5ZyIXHJcbiAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgIHRoaXMuc2hhcmVCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucHlxLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgIHZhciB0aXRsZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2hhcmVUaXRsZScpO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGVzYycpO1xyXG4gICAgICAgIHZhciByZWNvcmRJZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVjb3JkSWQnKTtcclxuICAgICAgICB2YXIgcm9vbUlkID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyb29tSWQnKTtcclxuICAgICAgICB2YXIgaWQ9ICcnO1xyXG4gICAgICAgIGlmKHJvb21JZCl7XHJcbiAgICAgICAgICAgIGlkID0gJ3Jvb21JZD0nK3Jvb21JZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocmVjb3JkSWQpe1xyXG4gICAgICAgICAgICBpZCA9ICdyZWNvcmRJZD0nK3JlY29yZElkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVIYWxsVGltZWxpbmU6ZGVzY3JpcHRpb246XCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLHN0ciwgaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrc2hhcmVCZzogZnVuY3Rpb24oKXsgIC8vIOeCueWHu+WIhuS6q+iDjOaZr+WbvlxyXG4gICAgICB0aGlzLnNoYXJlQmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMud3guYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMucHlxLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIGNsaWNrTXVzaWMgOmZ1bmN0aW9uKCl7ICAgLy/ngrnlh7vpn7PkuZBcclxuICAgICAgdGhpcy5tdXNpYy5jaGlsZHJlblsxXS5hY3RpdmUgPSAodGhpcy5fbXVzaWNPbiA9ICF0aGlzLl9tdXNpY09uKTsgICBcclxuICAgICAgdGhpcy5tdXNpYy5jaGlsZHJlblsyXS5hY3RpdmUgPSAhdGhpcy5fbXVzaWNPbjtcclxuICAgICAgICB2YXIgdm9sdW1lID0gMDtcclxuICAgICAgaWYodGhpcy5fbXVzaWNPbil7XHJcbiAgICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnNldEJnTXVzaWNWb2x1bW4oMSk7XHJcbiAgICAgICAgICB0aGlzLl9hdWRpb01hbmFnZXIucGxheU11c2ljKCk7XHJcbiAgICAgICAgICB2b2x1bWUgPSAxO1xyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0QmdNdXNpY1ZvbHVtbigwKTtcclxuICAgICAgICAgIHZvbHVtZSA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJiZ011c2ljXCIsdm9sdW1lKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tTb3VuZHMgOmZ1bmN0aW9uKCl7ICAvL+eCueWHu+S6humfs+aViFxyXG4gICAgICB0aGlzLnNvdW5kcy5jaGlsZHJlblsxXS5hY3RpdmUgPSAodGhpcy5fc291bmRzT24gPSAhdGhpcy5fc291bmRzT24pO1xyXG4gICAgICB0aGlzLnNvdW5kcy5jaGlsZHJlblsyXS5hY3RpdmUgPSAhdGhpcy5fc291bmRzT247XHJcbiAgICAgIHZhciB2b2x1bWU9MDtcclxuICAgICAgaWYodGhpcy5fc291bmRzT24pe1xyXG4gICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKDEpO1xyXG4gICAgICAgIHZvbHVtZSA9IDE7XHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKDApO1xyXG4gICAgICAgIHZvbHVtZSA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYmdTb3VuZFwiLHZvbHVtZSk7XHJcbiAgICB9LFxyXG4gICAgY2xpY2tTZXR0aW5nOmZ1bmN0aW9uKCl7ICAvL+eCueWHu+iuvue9rlxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuICAgIF9pbml0U2xpZGVyczogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9pbml0U2xpZGVyRXZlbnRzKCk7XHJcblxyXG4gICAgICBsZXQgbXVzaWNWYWwgPSBNYW5hZ2VyLmdldE11c2ljVmFsdWUoKTtcclxuICAgICAgbGV0IGVmZmVjdFZhbCA9IE1hbmFnZXIuZ2V0TXVzaWNFZmZlY3RWYWx1ZSgpO1xyXG5cclxuICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnNldEJnTXVzaWNWb2x1bW4obXVzaWNWYWwpO1xyXG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bShlZmZlY3RWYWwpO1xyXG5cclxuICAgICAgdGhpcy5tdXNpY1NsaWRlci5nZXRDb21wb25lbnQoJ3NsaWRlcicpLnNldFZhbHVlKG11c2ljVmFsKTtcclxuICAgICAgdGhpcy5lZmZlY3RTbGlkZXIuZ2V0Q29tcG9uZW50KCdzbGlkZXInKS5zZXRWYWx1ZShlZmZlY3RWYWwpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdFNsaWRlckV2ZW50czogZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgIHRoaXMubXVzaWNTbGlkZXIuZ2V0Q29tcG9uZW50KCdzbGlkZXInKS5vblZhbHVlQ2hhbmdlID0gZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICBNYW5hZ2VyLnNldE11c2ljVmFsdWUodmFsdWUpO1xyXG4gICAgICAgIHNlbGYuX2F1ZGlvTWFuYWdlci5zZXRCZ011c2ljVm9sdW1uKHZhbHVlKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHRoaXMuZWZmZWN0U2xpZGVyLmdldENvbXBvbmVudCgnc2xpZGVyJykub25WYWx1ZUNoYW5nZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgTWFuYWdlci5zZXRNdXNpY0VmZmVjdFZhbHVlKHZhbHVlKTtcclxuICAgICAgICBzZWxmLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bSh2YWx1ZSk7XHJcbiAgICAgIH07XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrU3dpdGNoOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBoaWRlU3dpdGNoOiBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKHRoaXMuYnRuU3dpdGNoQWNjb3VudCkge1xyXG4gICAgICAgIHRoaXMuYnRuU3dpdGNoQWNjb3VudC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG59KTtcclxuIiwibGV0IFNwcml0ZUhlbHBlciA9IHtcclxuICBzZXRJbWFnZVVybDogZnVuY3Rpb24gKHNwcml0ZSwgdXJsKSB7XHJcbiAgICBpZiAodXJsLmVuZHNXaXRoKFwicG5nXCIpIHx8IHVybC5lbmRzV2l0aChcImpwZ1wiKSB8fCB1cmwuZW5kc1dpdGgoXCJnaWZcIikpIHtcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvL3VybCA9IHVybCArIFwiLnBuZ1wiO1xyXG4gICAgfVxyXG5cclxuICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6dXJsLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcclxuICAgICAgaWYgKGVycikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKGRhdGEpO1xyXG4gICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBmcmFtZTtcclxuICAgIH0pO1xyXG4gIH0sXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFNwcml0ZUhlbHBlcjtcclxuIiwiLy8g57uZIFN0cmluZyDmt7vliqDlip/og71cclxuXHJcbi8vIHN0ci5zdGFydHNXaXRoKFwiXCIpO1xyXG4vLyBzdHIuZW5kc1dpdGgoXCJcIik7XHJcblxyXG5pZiAoIVN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aCkge1xyXG4gIChmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JzsgLy8gbmVlZGVkIHRvIHN1cHBvcnQgYGFwcGx5YC9gY2FsbGAgd2l0aCBgdW5kZWZpbmVkYC9gbnVsbGBcclxuICAgIHZhciBkZWZpbmVQcm9wZXJ0eSA9IChmdW5jdGlvbigpIHtcclxuICAgICAgLy8gSUUgOCBvbmx5IHN1cHBvcnRzIGBPYmplY3QuZGVmaW5lUHJvcGVydHlgIG9uIERPTSBlbGVtZW50c1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIHZhciBvYmplY3QgPSB7fTtcclxuICAgICAgICB2YXIgJGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xyXG4gICAgICAgIHZhciByZXN1bHQgPSAkZGVmaW5lUHJvcGVydHkob2JqZWN0LCBvYmplY3QsIG9iamVjdCkgJiYgJGRlZmluZVByb3BlcnR5O1xyXG4gICAgICB9IGNhdGNoKGVycm9yKSB7fVxyXG4gICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSgpKTtcclxuICAgIHZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xyXG4gICAgdmFyIHN0YXJ0c1dpdGggPSBmdW5jdGlvbihzZWFyY2gpIHtcclxuICAgICAgaWYgKHRoaXMgPT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBzdHJpbmcgPSBTdHJpbmcodGhpcyk7XHJcbiAgICAgIGlmIChzZWFyY2ggJiYgdG9TdHJpbmcuY2FsbChzZWFyY2gpID09ICdbb2JqZWN0IFJlZ0V4cF0nKSB7XHJcbiAgICAgICAgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIHN0cmluZ0xlbmd0aCA9IHN0cmluZy5sZW5ndGg7XHJcbiAgICAgIHZhciBzZWFyY2hTdHJpbmcgPSBTdHJpbmcoc2VhcmNoKTtcclxuICAgICAgdmFyIHNlYXJjaExlbmd0aCA9IHNlYXJjaFN0cmluZy5sZW5ndGg7XHJcbiAgICAgIHZhciBwb3NpdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkO1xyXG4gICAgICAvLyBgVG9JbnRlZ2VyYFxyXG4gICAgICB2YXIgcG9zID0gcG9zaXRpb24gPyBOdW1iZXIocG9zaXRpb24pIDogMDtcclxuICAgICAgaWYgKHBvcyAhPSBwb3MpIHsgLy8gYmV0dGVyIGBpc05hTmBcclxuICAgICAgICBwb3MgPSAwO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBzdGFydCA9IE1hdGgubWluKE1hdGgubWF4KHBvcywgMCksIHN0cmluZ0xlbmd0aCk7XHJcbiAgICAgIC8vIEF2b2lkIHRoZSBgaW5kZXhPZmAgY2FsbCBpZiBubyBtYXRjaCBpcyBwb3NzaWJsZVxyXG4gICAgICBpZiAoc2VhcmNoTGVuZ3RoICsgc3RhcnQgPiBzdHJpbmdMZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGluZGV4ID0gLTE7XHJcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgc2VhcmNoTGVuZ3RoKSB7XHJcbiAgICAgICAgaWYgKHN0cmluZy5jaGFyQ29kZUF0KHN0YXJ0ICsgaW5kZXgpICE9IHNlYXJjaFN0cmluZy5jaGFyQ29kZUF0KGluZGV4KSkge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBpZiAoZGVmaW5lUHJvcGVydHkpIHtcclxuICAgICAgZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ3N0YXJ0c1dpdGgnLCB7XHJcbiAgICAgICAgJ3ZhbHVlJzogc3RhcnRzV2l0aCxcclxuICAgICAgICAnY29uZmlndXJhYmxlJzogdHJ1ZSxcclxuICAgICAgICAnd3JpdGFibGUnOiB0cnVlXHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoID0gc3RhcnRzV2l0aDtcclxuICAgIH1cclxuICB9KCkpO1xyXG59XHJcblxyXG4vLyBzdHIuZW5kc1dpdGgoXCJcIik7XHJcbmlmICghU3RyaW5nLnByb3RvdHlwZS5lbmRzV2l0aCkge1xyXG5cdChmdW5jdGlvbigpIHtcclxuXHRcdCd1c2Ugc3RyaWN0JzsgLy8gbmVlZGVkIHRvIHN1cHBvcnQgYGFwcGx5YC9gY2FsbGAgd2l0aCBgdW5kZWZpbmVkYC9gbnVsbGBcclxuXHRcdHZhciBkZWZpbmVQcm9wZXJ0eSA9IChmdW5jdGlvbigpIHtcclxuXHRcdFx0Ly8gSUUgOCBvbmx5IHN1cHBvcnRzIGBPYmplY3QuZGVmaW5lUHJvcGVydHlgIG9uIERPTSBlbGVtZW50c1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdHZhciBvYmplY3QgPSB7fTtcclxuXHRcdFx0XHR2YXIgJGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xyXG5cdFx0XHRcdHZhciByZXN1bHQgPSAkZGVmaW5lUHJvcGVydHkob2JqZWN0LCBvYmplY3QsIG9iamVjdCkgJiYgJGRlZmluZVByb3BlcnR5O1xyXG5cdFx0XHR9IGNhdGNoKGVycm9yKSB7fVxyXG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdFx0fSgpKTtcclxuXHRcdHZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xyXG5cdFx0dmFyIGVuZHNXaXRoID0gZnVuY3Rpb24oc2VhcmNoKSB7XHJcblx0XHRcdGlmICh0aGlzID09IG51bGwpIHtcclxuXHRcdFx0XHR0aHJvdyBUeXBlRXJyb3IoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgc3RyaW5nID0gU3RyaW5nKHRoaXMpO1xyXG5cdFx0XHRpZiAoc2VhcmNoICYmIHRvU3RyaW5nLmNhbGwoc2VhcmNoKSA9PSAnW29iamVjdCBSZWdFeHBdJykge1xyXG5cdFx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBzdHJpbmdMZW5ndGggPSBzdHJpbmcubGVuZ3RoO1xyXG5cdFx0XHR2YXIgc2VhcmNoU3RyaW5nID0gU3RyaW5nKHNlYXJjaCk7XHJcblx0XHRcdHZhciBzZWFyY2hMZW5ndGggPSBzZWFyY2hTdHJpbmcubGVuZ3RoO1xyXG5cdFx0XHR2YXIgcG9zID0gc3RyaW5nTGVuZ3RoO1xyXG5cdFx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcclxuXHRcdFx0XHR2YXIgcG9zaXRpb24gPSBhcmd1bWVudHNbMV07XHJcblx0XHRcdFx0aWYgKHBvc2l0aW9uICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdC8vIGBUb0ludGVnZXJgXHJcblx0XHRcdFx0XHRwb3MgPSBwb3NpdGlvbiA/IE51bWJlcihwb3NpdGlvbikgOiAwO1xyXG5cdFx0XHRcdFx0aWYgKHBvcyAhPSBwb3MpIHsgLy8gYmV0dGVyIGBpc05hTmBcclxuXHRcdFx0XHRcdFx0cG9zID0gMDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIGVuZCA9IE1hdGgubWluKE1hdGgubWF4KHBvcywgMCksIHN0cmluZ0xlbmd0aCk7XHJcblx0XHRcdHZhciBzdGFydCA9IGVuZCAtIHNlYXJjaExlbmd0aDtcclxuXHRcdFx0aWYgKHN0YXJ0IDwgMCkge1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgaW5kZXggPSAtMTtcclxuXHRcdFx0d2hpbGUgKCsraW5kZXggPCBzZWFyY2hMZW5ndGgpIHtcclxuXHRcdFx0XHRpZiAoc3RyaW5nLmNoYXJDb2RlQXQoc3RhcnQgKyBpbmRleCkgIT0gc2VhcmNoU3RyaW5nLmNoYXJDb2RlQXQoaW5kZXgpKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fTtcclxuXHRcdGlmIChkZWZpbmVQcm9wZXJ0eSkge1xyXG5cdFx0XHRkZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAnZW5kc1dpdGgnLCB7XHJcblx0XHRcdFx0J3ZhbHVlJzogZW5kc1dpdGgsXHJcblx0XHRcdFx0J2NvbmZpZ3VyYWJsZSc6IHRydWUsXHJcblx0XHRcdFx0J3dyaXRhYmxlJzogdHJ1ZVxyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdFN0cmluZy5wcm90b3R5cGUuZW5kc1dpdGggPSBlbmRzV2l0aDtcclxuXHRcdH1cclxuXHR9KCkpO1xyXG59XHJcbiIsImNvbnN0IFNwcml0ZUhlbHBlciA9IHJlcXVpcmUoJ1Nwcml0ZUhlbHBlcicpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGF2YXRhclNwcml0ZTogY2MuU3ByaXRlLFxyXG4gICAgICAgIGxhYmVsVXNlcklkOiBjYy5MYWJlbCxcclxuICAgICAgICBsYWJlbFNjb3JlOiBjYy5MYWJlbCxcclxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcclxuXHJcbiAgICAgICAgX2Rlc2tJbmZvOiBudWxsLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc2V0VXNlckluZm86IGZ1bmN0aW9uICh1c2VyLCBkZXNrSW5mbykge1xyXG4gICAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciB0b3RhbFNjb3JlID0gdXNlci50b3RhbFNjb3JlO1xyXG4gICAgICBpZiAoZGVza0luZm8gJiYgKChkZXNrSW5mby5zZXR0aW5nMSA9PSAwKSB8fCAoZGVza0luZm8uc2V0dGluZzEgPT0gMSkpKSB7XHJcbiAgICAgICAgbGV0IGJhc2VTY29yZSA9IChkZXNrSW5mby5zZXR0aW5nMSA9PSAwKSA/IDEwMCA6IDIwMDtcclxuICAgICAgICB0b3RhbFNjb3JlID0gdG90YWxTY29yZSAtIGJhc2VTY29yZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgU3ByaXRlSGVscGVyLnNldEltYWdlVXJsKHRoaXMuYXZhdGFyU3ByaXRlLCB1c2VyLmF2YXRhclVybCk7XHJcbiAgICAgIHRoaXMubGFiZWxVc2VySWQuc3RyaW5nID0gXCJcIiArIHVzZXIuaWQ7XHJcbiAgICAgIHRoaXMubGFiZWxTY29yZS5zdHJpbmcgPSAodG90YWxTY29yZSA+IDApID8gKFwiKyBcIiArIHRvdGFsU2NvcmUpIDogKFwiLSBcIiArIHRvdGFsU2NvcmUgKiAtMSk7XHJcbiAgICAgIGlmICh0b3RhbFNjb3JlID09IDApIHtcclxuICAgICAgICB0aGlzLmxhYmVsU2NvcmUuc3RyaW5nID0gXCIwXCI7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5sYWJlbE5pY2tuYW1lLnN0cmluZyA9IHVzZXIubmlja25hbWU7XHJcbiAgICB9LFxyXG59KTtcclxuIiwiY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xyXG5jb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBpdGVtTGF5b3V0OiBjYy5MYXlvdXQsXHJcbiAgICAgICAgaXRlbVByZWZhYjogY2MuUHJlZmFiLFxyXG4gICAgICAgIHRpbWVMYWJlbDpjYy5MYWJlbCwgICAvLyDml7bpl7RcclxuICAgICAgICBqdXNodUxhYmVsOmNjLkxhYmVsLCAgLy8g5bGA5pWwXHJcbiAgICAgICAgcm9vbUlkOmNjLkxhYmVsLCAgICAgIC8vIOaIv+mXtOWPt1xyXG4gICAgICAgIG5pY2tuYW1lTGFiZWxzOmNjLkxhYmVsLFxyXG4gICAgICAgIHJlY29yZEluZm9fc3ZpZXc6W2NjLk5vZGVdLFxyXG5cclxuICAgICAgICBzaGFyckJnOmNjLk5vZGUsXHJcbiAgICAgICAgYnRuV2VpWGluOmNjLk5vZGUsXHJcbiAgICAgICAgYnRuR29uZ1h1b0hhbzpjYy5Ob2RlLFxyXG4gICAgICAgIGJ0blpodVNob3U6Y2MuTm9kZSxcclxuICAgICAgICBidG5ab25nRmVuOmNjLk5vZGUsXHJcblxyXG4gICAgICAgIHN1YW5mZW5fc3ZpZXc6Y2MuTm9kZSxcclxuICAgICAgICBzdWFuRmVuUHJlZmFiOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgc3VhbkZlbkJnUHJlZmFiOiBjYy5QcmVmYWIsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBvbkRpc2FibGU6ZnVuY3Rpb24oKXtcclxuICAgICAgICAvL2lmKGNjLnN5cy5pc0Jyb3dzZXIpe1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgICAgIHZhciBzaGFyZVRpdGxlID0gJ+W8gOaIv+eOqVvlpKfkvJfljYHkuInmsLRdJztcclxuICAgICAgICAgICAgdmFyIGRlc2MgPSAn5byA5aW95oi/5LqG77yM5bCx562J5L2g5Lus5LiA6LW35p2lW+Wkp+S8l+WNgeS4ieawtF3llabvvIHmmZrkuobkvY3nva7lsLHmsqHkuoblk59+JzsgXHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2hhcmVUaXRsZScsc2hhcmVUaXRsZSk7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGVzYycsZGVzYyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJzaGFyZVRpdGxlXCIpO1xyXG4gICAgICAgICAgICAvLyBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJkZXNjXCIpO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJyZWNvcmRJZFwiKTtcclxuICAgICAgICAgICAgLy9jYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJyb29tSWRcIiwnJyk7XHJcbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvVGltZUxpbmUpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvVGltZUxpbmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1Nlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvU2Vzc2lvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgLy99XHJcblxyXG4gICAgfSxcclxuICAgIGpzOiBmdW5jdGlvbihzZXR0aW5nMil7XHJcbiAgICAgICAgdmFyIGp1c2h1ID0gNTtcclxuICAgICAgICBzd2l0Y2goc2V0dGluZzIpe1xyXG4gICAgICAgICAgICBjYXNlIDA6IGp1c2h1ID0gNTsgYnJlYWs7Y2FzZSAxOiBqdXNodSA9IDEwOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOiBqdXNodSA9IDIwOyBicmVhaztjYXNlIDM6IGp1c2h1ID0gMzA7IGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ganVzaHU7XHJcbiAgICB9LFxyXG5cclxuICAgIGNyZWF0b3IgOmZ1bmN0aW9uKGNyZWF0b3IscGxheWVycyl7ICAgIC8v5Yib5oi/6ICFXHJcbiAgICAgICAgZm9yKHZhciBpID0wOyBpPHBsYXllcnMubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIGlmKHBsYXllcnNbaV0uaWQgPT0gY3JlYXRvcil7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgX2NsaWNrQnRuIDpmdW5jdGlvbigpe1xyXG4gICAgICAgIHRoaXMuYnRuWmh1U2hvdS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuYnRuWm9uZ0Zlbi5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tab25nRmVuIDpmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICB0aGlzLmJ0blpodVNob3UuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5idG5ab25nRmVuLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnJlY29yZEluZm9fc3ZpZXcuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge25vZGUuYWN0aXZlID0gdHJ1ZTt9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zdWFuZmVuX3N2aWV3LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIF9nbG9iYWxNc2c6ZnVuY3Rpb24ocmVjb3JkSW5mbyl7XHJcbiAgICAgICAgLy9pZihjYy5zeXMuaXNCcm93c2VyKSB7XHJcbiAgICAgICAgICAgIHZhciByb29tSWQgPVwi5oi/6Ze05Y+377yaXCIrcmVjb3JkSW5mby5yb29tSWQ7XHJcbiAgICAgICAgICAgIHZhciBwaiA9IFtcIjUgXCIsXCIxMCBcIixcIjIwIFwiXTsgIFxyXG4gICAgICAgICAgICB2YXIganMgPSBcIuWxgOaVsO+8mlwiK3BqW3JlY29yZEluZm8uc2V0dGluZzEtMl07XHJcbiAgICAgICAgICAgIHZhciB0aW1lID0gXCLml7bpl7TvvJpcIisocmVjb3JkSW5mby5jcmVhdGVBdD9yZWNvcmRJbmZvLmNyZWF0ZUF0OnJlY29yZEluZm8uY3JlYXRlVGltZSk7XHJcbiAgICAgICAgICAgIHZhciBzaGFyZVRpdGxlID0gXCJb5aSn5LyX5Y2B5LiJ5rC0XeaImOe7qVwiO1xyXG4gICAgICAgICAgICB2YXIgZGVzYyA9IHJvb21JZCtqcyt0aW1lK1wiIOeCueWHu+afpeeci+ivpuaDhVwiO1xyXG4gICAgICAgICAgICB2YXIgcmVjb3JkSWQgPSAocmVjb3JkSW5mby5pZCE9dW5kZWZpbmVkKT9yZWNvcmRJbmZvLmlkOnJlY29yZEluZm8ucmVjb3JkSWQ7ICBcclxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwic2hhcmVUaXRsZVwiLHNoYXJlVGl0bGUpO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJkZXNjXCIsZGVzYyk7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInJlY29yZElkXCIscmVjb3JkSWQpO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJyb29tSWRcIiwnJyk7XHJcblxyXG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYod2luZG93LnNoYXJlVG9TZXNzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1Nlc3Npb24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIC8vfVxyXG4gICAgfSxcclxuICAgIC8v5aSn5bGAXHJcbiAgICBzZXRQbGF5ZXJJbmZvczogZnVuY3Rpb24gKHBsYXllckluZm9zLCBkZXNrSW5mbyl7XHJcbiAgICAgICAgcGxheWVySW5mb3Muc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBiLnRvdGFsU2NvcmUtYS50b3RhbFNjb3JlfSk7IC8vIOaOkuW6j1xyXG4gICAgICAgIC8vIGNjLmxvZyhwbGF5ZXJJbmZvcylcclxuICAgICAgICAvLyBjYy5sb2coZGVza0luZm8pXHJcbiAgICAgICAgLy8gY2MubG9nKCctLTY1JylcclxuICAgICAgICAgXHJcbiAgICAgICAgdGhpcy5fZ2xvYmFsTXNnKGRlc2tJbmZvKTtcclxuICAgICAgICB0aGlzLnJlY29yZEluZm9fc3ZpZXcuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge25vZGUuYWN0aXZlID0gdHJ1ZTt9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zdWFuZmVuX3N2aWV3LmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmJ0blpodVNob3UuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5idG5ab25nRmVuLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllckluZm9zO1xyXG5cclxuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IGRlc2tJbmZvO1xyXG5cclxuICAgICAgICB2YXIgY3JlYXRlSWQgPSBkZXNrSW5mby5jcmVhdGVVc2VySWQ/IGRlc2tJbmZvLmNyZWF0ZVVzZXJJZDogZGVza0luZm8uY3JlYXRlSWQ7XHJcblxyXG4gICAgICAgIHZhciBuaWNrbmFtZSA9IHBsYXllckluZm9zWyB0aGlzLmNyZWF0b3IoY3JlYXRlSWQsIHBsYXllckluZm9zKSBdLm5pY2tuYW1lO1xyXG5cclxuICAgICAgICB0aGlzLnJvb21JZC5zdHJpbmcgPSBkZXNrSW5mby5yb29tSWQ7XHJcblxyXG4gICAgICAgIHZhciBjcmVhdGVBdCA9IGRlc2tJbmZvLmNyZWF0ZUF0PyBkZXNrSW5mby5jcmVhdGVBdDogZGVza0luZm8uY3JlYXRlVGltZTtcclxuXHJcbiAgICAgICAgdGhpcy50aW1lTGFiZWwuc3RyaW5nID0gY3JlYXRlQXQuc3Vic3RyKDAsMTEpO1xyXG5cclxuICAgICAgICB0aGlzLmp1c2h1TGFiZWwuc3RyaW5nID0gdGhpcy5qcyhkZXNrSW5mby5zZXR0aW5nMS0yKTtcclxuXHJcbiAgICAgICAgdGhpcy5uaWNrbmFtZUxhYmVscy5zdHJpbmcgPSBuaWNrbmFtZTtcclxuXHJcbiAgICAgICAgdGhpcy5pdGVtTGF5b3V0Lm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuXHJcbiAgICAgICAgcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbiAodXNlcikge1xyXG5cclxuICAgICAgICAgICAgbGV0IGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLml0ZW1QcmVmYWIpO1xyXG5cclxuICAgICAgICAgICAgaXRlbS5nZXRDb21wb25lbnQoJ1RvdGFsR2FtZVJlc3VsdEl0ZW0nKS5zZXRVc2VySW5mbyh1c2VyLCBkZXNrSW5mbyk7XHJcblxyXG4gICAgICAgICAgICBpZihkZXNrSW5mby5jcmVhdGVVc2VySWQgPT0gdXNlci5pZCB8fCBkZXNrSW5mby5jcmVhdGVJZCA9PSB1c2VyLmlkKXtcclxuXHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoaWxkcmVuWzFdLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICB9ZWxzZXtcclxuXHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoaWxkcmVuWzFdLmNoaWxkcmVuWzBdLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5pdGVtTGF5b3V0Lm5vZGUuYWRkQ2hpbGQoaXRlbSk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvL+eul+WIhuiDveaJi1xyXG4gICAgY2xpY2tTdWFuRmVuOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuYnRuWmh1U2hvdS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5idG5ab25nRmVuLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMucmVjb3JkSW5mb19zdmlldy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7bm9kZS5hY3RpdmUgPSBmYWxzZTt9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zdWFuZmVuX3N2aWV3LmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHZhciBwbGF5ZXJzUmlndGggPSB0aGlzLl9wbGF5ZXJJbmZvcy5maWx0ZXIoZnVuY3Rpb24gKHBsYXllcikge3JldHVybiBwbGF5ZXIudG90YWxTY29yZSA+IDA7fSk7XHJcblxyXG4gICAgICAgIHZhciBwbGF5ZXJzTGVmdCA9IHRoaXMuX3BsYXllckluZm9zLmZpbHRlcihmdW5jdGlvbiAocGxheWVyKSB7cmV0dXJuIHBsYXllci50b3RhbFNjb3JlIDwgMDt9KTtcclxuXHJcbiAgICAgICAgdmFyIHBsYXllcnNSaWd0aFNjb3JlID0gcGxheWVyc1JpZ3RoLm1hcChmdW5jdGlvbiAocGxheWVyKSB7cmV0dXJuIHBsYXllci50b3RhbFNjb3JlO30pO1xyXG5cclxuICAgICAgICB2YXIgcGxheWVyc0xlZnRTY29yZSA9IHBsYXllcnNMZWZ0Lm1hcChmdW5jdGlvbiAocGxheWVyKSB7cmV0dXJuIHBsYXllci50b3RhbFNjb3JlICogLTE7fSk7XHJcblxyXG4gICAgICAgIHZhciBwbGF5ZXJzSW5kZXggPSBbXSxcclxuXHJcbiAgICAgICAgICAgIGFycnMgPSBbcGxheWVyc1JpZ3RoU2NvcmUuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpO30pLHBsYXllcnNMZWZ0U2NvcmUuZmlsdGVyKGZ1bmN0aW9uKGkpe3JldHVybiBpO30pXSxcclxuXHJcbiAgICAgICAgICAgIGluZGV4cyA9IHBsYXllcnNMZWZ0U2NvcmUubGVuZ3RoID4gcGxheWVyc1JpZ3RoU2NvcmUubGVuZ3RoPyAwOiAxOy8vMeaYr+i1oueahOS6uiAw6L6T55qE5Lq6XHJcblxyXG4gICAgICAgIC8vIGZvcih2YXIgaSA9IDA7aSA8IGFycnNbaW5kZXhzXS5sZW5ndGg7IGkrKyl7XHJcblxyXG4gICAgICAgIC8vICAgICB2YXIgc2NvcmUgPSBhcnJzW2luZGV4c11baV07XHJcblxyXG4gICAgICAgIC8vICAgICB2YXIgZCA9IHRoaXMuZ2V0Q29tYkJ5U3VtKGFycnNbaW5kZXhzPT0xPzA6MV0sIHNjb3JlKVswXSB8fCBbXTtcclxuXHJcbiAgICAgICAgLy8gICAgIGlmKGQubGVuZ3RoID4gMCl7XHJcblxyXG4gICAgICAgIC8vICAgICAgICAgcGxheWVyc0luZGV4LnB1c2goW3Njb3JlLGRdKTtcclxuXHJcbiAgICAgICAgLy8gICAgICAgICBkLmZvckVhY2goZnVuY3Rpb24gKHMpIHtcclxuXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGluZGV4ID0gYXJyc1tpbmRleHM9PTE/MDoxXS5pbmRleE9mKHMpO1xyXG5cclxuICAgICAgICAvLyAgICAgICAgICAgICBpZihpbmRleCAhPSAtMSkgYXJyc1tpbmRleHM9PTE/MDoxXS5zcGxpY2UoaW5kZXgsMSk7XHJcblxyXG4gICAgICAgIC8vICAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIC8vIGlmKHBsYXllcnNJbmRleC5sZW5ndGggPT0gMCkgaW5kZXhzID0gMjtcclxuICAgICAgICBpbmRleHMgPSAyXHJcbiAgICAgICAgdGhpcy5zdWFuZmVuX3N2aWV3LmNoaWxkcmVuWzBdLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcblxyXG4gICAgICAgIHBsYXllcnNMZWZ0LmZvckVhY2goZnVuY3Rpb24gKHVzZXIsIGluZGV4KSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgc3VhbkZlbkJnUHJlZmFiID0gY2MuaW5zdGFudGlhdGUodGhpcy5zdWFuRmVuQmdQcmVmYWIpO1xyXG5cclxuICAgICAgICAgICAgc3VhbkZlbkJnUHJlZmFiLnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9jdGFyZVByZWZhYigxICxzdWFuRmVuQmdQcmVmYWIsIHVzZXIsIHVzZXIudG90YWxTY29yZSwgdGhpcy5fZGVza0luZm8gLC0yMDAgLDApO1xyXG5cclxuICAgICAgICAgICAgdmFyIHggPSAwLCB5ID0gMDtcclxuXHJcbiAgICAgICAgICAgIGlmKGluZGV4cyA9PSAxKXtcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCBwbGF5ZXJzSW5kZXhbaW5kZXhdWzFdLmxlbmd0aDsgaisrKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBwbGF5ZXJzSW5kZXhbaW5kZXhdWzFdW2pdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHBsYXllcnNSaWd0aFNjb3JlLmluZGV4T2Yocyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKGQgIT0gLTEpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXlzID0gcGxheWVyc1JpZ3RoLnNwbGljZShkLDEpWzBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyc1JpZ3RoU2NvcmUuc3BsaWNlKGQsMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihwbGF5cyl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPj0gMykgeSA9IC05MDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdWFuRmVuQmdQcmVmYWIuY2hpbGRyZW5Db3VudCA9PSAzKSB4ID0gMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdWFuRmVuQmdQcmVmYWIuY2hpbGRyZW5Db3VudCA+PSA1KSB5ID0gLTE4MDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdWFuRmVuQmdQcmVmYWIuY2hpbGRyZW5Db3VudCA9PSA1KSB4ID0gMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdGFyZVByZWZhYigwLCBzdWFuRmVuQmdQcmVmYWIsIHBsYXlzLCBwbGF5cy50b3RhbFNjb3JlLCB0aGlzLl9kZXNrSW5mbywgeCAseSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeCArPSAyMDA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYoaW5kZXhzID09IDApe1xyXG4gICAgICAgICAgICAgICAgdmFyIGZlbiA9IHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlblswXS5nZXRDaGlsZEJ5TmFtZShcImZlblwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZy5zdWJzdHIoMykgKiAtMTtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgcGxheWVyc0luZGV4Lmxlbmd0aDsgaisrKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBwbGF5ZXJzSW5kZXhbal07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gc1sxXS5pbmRleE9mKGZlbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBxID0gc1swXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHcgPSBwbGF5ZXJzUmlndGhTY29yZS5pbmRleE9mKHEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihkICE9IC0xICYmIHcgIT0gLTEpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXlzID0gcGxheWVyc1JpZ3RoW3ddO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3RhcmVQcmVmYWIoMCwgc3VhbkZlbkJnUHJlZmFiLCBwbGF5cywgcGxheXMudG90YWxTY29yZSwgdGhpcy5fZGVza0luZm8sIHgsIHksIGZlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHEgPSBwbGF5ZXJzTGVmdFNjb3JlW2luZGV4XTtcclxuICAgICAgICAgICAgICAgIHZhciBhZGRTY29yZSA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgcGxheWVyc1JpZ3RoU2NvcmUubGVuZ3RoOyBqKyspe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB3ID0gcGxheWVyc1JpZ3RoU2NvcmVbal07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoYWRkU2NvcmUgPCBxKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkU2NvcmUgKz0gdztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYWRkU2NvcmUgPiBxKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKHcgLSAoYWRkU2NvcmUgLSBxKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2godyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYocSAtIHcgPj0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJzUmlndGhTY29yZVtqXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoYWRkU2NvcmUgPiBxKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyc1JpZ3RoU2NvcmVbal0gPSBhZGRTY29yZSAtIHE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIHQgPSAwOyB0IDwgYXJyLmxlbmd0aDsgdCsrKXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGFyclt0XTtcclxuICAgICAgICAgICAgICAgICAgICBpZihyID09IDApIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID49IDMpIHkgPSAtOTA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHN1YW5GZW5CZ1ByZWZhYi5jaGlsZHJlbkNvdW50ID09IDMpIHggPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihzdWFuRmVuQmdQcmVmYWIuY2hpbGRyZW5Db3VudCA+PSA1KSB5ID0gLTE4MDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc3VhbkZlbkJnUHJlZmFiLmNoaWxkcmVuQ291bnQgPT0gNSkgeCA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwbGF5cyA9IHBsYXllcnNSaWd0aFt0XTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3RhcmVQcmVmYWIoMCwgc3VhbkZlbkJnUHJlZmFiLCBwbGF5cywgciwgdGhpcy5fZGVza0luZm8sIHgsIHkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB4ICs9IDIwMDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3VhbmZlbl9zdmlldy5jaGlsZHJlblswXS5hZGRDaGlsZChzdWFuRmVuQmdQcmVmYWIpO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX2N0YXJlUHJlZmFiOiBmdW5jdGlvbiAoc2h1LCBub2RlLCB1c2VyLCB0b3RhbFNjb3JlLCBkZXNrSW5mbywgeCwgeSwgZmVuID0gbnVsbCkge1xyXG5cclxuICAgICAgICB2YXIgc3VhbkZlblByZWZhYiA9IGNjLmluc3RhbnRpYXRlKHRoaXMuc3VhbkZlblByZWZhYik7XHJcblxyXG4gICAgICAgIHN1YW5GZW5QcmVmYWIuZ2V0Q2hpbGRCeU5hbWUoXCJJRFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwiSUQ6XCIrdXNlci5pZDtcclxuXHJcbiAgICAgICAgaWYoZGVza0luZm8uY3JlYXRlVXNlcklkID09IHVzZXIuaWQpc3VhbkZlblByZWZhYi5nZXRDaGlsZEJ5TmFtZShcIklEXCIpLmNvbG9yID0gbmV3IGNjLkNvbG9yKDIzNSwgMTE1LCAxMjIpO1xyXG5cclxuICAgICAgICBzdWFuRmVuUHJlZmFiLmdldENoaWxkQnlOYW1lKFwic2h1XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gc2h1ID09IDA/IFwi6L6TXCI6IFwiXCI7XHJcblxyXG4gICAgICAgIHZhciBzdHIgPSBzaHUgPT0gMD8gdG90YWxTY29yZStcIuWIhlwiOiBcIuaAu+WIhjpcIit0b3RhbFNjb3JlO1xyXG5cclxuICAgICAgICBpZihmZW4pIHN0ciA9IGZlbitcIuWIhlwiO1xyXG5cclxuICAgICAgICBzdWFuRmVuUHJlZmFiLmdldENoaWxkQnlOYW1lKFwiZmVuXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gc3RyO1xyXG5cclxuICAgICAgICB2YXIgc3ByaXRlID0gc3VhbkZlblByZWZhYi5nZXRDaGlsZEJ5TmFtZShcImhhZWRcIikuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcblxyXG4gICAgICAgIHZhciBoZWFkVXJsID0gdXNlci5hdmF0YXJVcmw7IC8vIOWktOWDj1VSTFxyXG5cclxuICAgICAgICBjYy5sb2FkZXIubG9hZCh7dXJsOmhlYWRVcmwsdHlwZTpcImpwZ1wifSwgZnVuY3Rpb24gKGVyciwgdGV4KSB7XHJcblxyXG4gICAgICAgICAgICBpZiAoIWVycikge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGZyYW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmhlaWdodCA9IDU1O1xyXG5cclxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLndpZHRoID0gNTU7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzdWFuRmVuUHJlZmFiLnggPSB4O1xyXG5cclxuICAgICAgICBzdWFuRmVuUHJlZmFiLnkgPSB5O1xyXG5cclxuICAgICAgICBub2RlLmhlaWdodCA9IDkwICsgeSAqIC0xO1xyXG5cclxuICAgICAgICBub2RlLmFkZENoaWxkKHN1YW5GZW5QcmVmYWIpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgU29ja2V0LnNlbmRPbmNlQWdhaW4oJ2ZhbHNlJyx0aGlzLl91c2VySWQpO1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja1NoYXJlV2VpQ2hhdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICB0aGlzLnNoYXJyQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTY3JlZW5TaGFyZUZyaWVuZFwiLCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxyXG4gICAgICAgICAgICAgICAgICBLUU5hdGl2ZUludm9rZS5zY3JlZW5zaG90U2hhcmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsaWNrU2hhcmVCZyA6ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc2hhcnJCZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBjbGlja1NoYXJlUGVuZ1lvdVF1YW46IGZ1bmN0aW9uICgpIHtcclxuICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTY3JlZW5TaGFyZVwiLCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZVwiLCBcIigpVlwiKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBnZXRDb21iQnlTdW06IGZ1bmN0aW9uIChhcnJheSxzdW0sdG9sZXJhbmNlLHRhcmdldENvdW50KSB7XHJcbiAgICAgICAgdmFyIHV0aWwgPSB7XHJcbiAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgIGdldCBjb21iaW5hdGlvbiBmcm9tIGFycmF5XHJcbiAgICAgICAgICAgICAgICAgYXJyOiB0YXJnZXQgYXJyYXlcclxuICAgICAgICAgICAgICAgICBudW06IGNvbWJpbmF0aW9uIGl0ZW0gbGVuZ3RoXHJcbiAgICAgICAgICAgICAgICAgcmV0dXJuOiBvbmUgYXJyYXkgdGhhdCBjb250YWluIGNvbWJpbmF0aW9uIGFycmF5c1xyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBnZXRDb21iaW5hdGlvbjogZnVuY3Rpb24oYXJyLCBudW0pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcj1bXTtcclxuICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gZih0LGEsbilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuPT0wKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gci5wdXNoKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MCxsPWEubGVuZ3RoOyBpPD1sLW47IGkrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZih0LmNvbmNhdChhW2ldKSwgYS5zbGljZShpKzEpLCBuLTEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkoW10sYXJyLG51bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgLy90YWtlIGFycmF5IGluZGV4IHRvIGEgYXJyYXlcclxuICAgICAgICAgICAgICAgIGdldEFycmF5SW5kZXg6IGZ1bmN0aW9uKGFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwO2k8YXJyYXkubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHIucHVzaChpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LGxvZ2ljID0ge1xyXG4gICAgICAgICAgICAgICAgLy9zb3J0IHRoZSBhcnJheSx0aGVuIGdldCB3aGF0J3Mgd2UgbmVlZFxyXG4gICAgICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24oYXJyYXksc3VtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9jbG9uZSBhcnJheVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBfYXJyYXkgPSBhcnJheS5jb25jYXQoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgciA9IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAvL3NvcnQgYnkgYXNjXHJcbiAgICAgICAgICAgICAgICAgICAgX2FycmF5LnNvcnQoZnVuY3Rpb24oYSxiKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgLSBiO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IGFsbCBudW1iZXIgd2hlbiBpdCdzIGxlc3MgdGhhbiBvciBlcXVhbCBzdW1cclxuICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7aTxfYXJyYXkubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKF9hcnJheVtpXTw9c3VtKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIucHVzaChfYXJyYXlbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAvL2ltcG9ydGFudCBmdW5jdGlvblxyXG4gICAgICAgICAgICAgICAgY29yZTogZnVuY3Rpb24oYXJyYXksc3VtLGFycmF5SW5kZXgsY291bnQscil7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBrID0gMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tYkFycmF5ID0gW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9zdW0gPSAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2NhID0gW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jYWNoZSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihjb3VudCA9PSBfcmV0dXJuTWFyayl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgY3VycmVudCBjb3VudCBjb21iaW5hdGlvblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbWJBcnJheSA9IHV0aWwuZ2V0Q29tYmluYXRpb24oYXJyYXlJbmRleCxjb3VudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwO2k8Y29tYkFycmF5Lmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2NhID0gY29tYkFycmF5W2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfc3VtID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2NhY2hlID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRlIHRoZSBzdW0gZnJvbSBjb21iaW5hdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IoayA9IDA7azxfY2NhLmxlbmd0aDtrKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N1bSArPSBhcnJheVtfY2NhW2tdXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jYWNoZS5wdXNoKGFycmF5W19jY2Fba11dKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihNYXRoLmFicyhfc3VtLXN1bSkgPD0gX3RvbGVyYW5jZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnB1c2goX2NhY2hlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbG9naWMuY29yZShhcnJheSxzdW0sYXJyYXlJbmRleCxjb3VudC0xLHIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgciA9IFtdLFxyXG4gICAgICAgICAgICBfYXJyYXkgPSBbXSxcclxuICAgICAgICAgICAgX3RhcmdldENvdW50ID0gMCxcclxuICAgICAgICAgICAgX3RvbGVyYW5jZSA9IDAsXHJcbiAgICAgICAgICAgIF9yZXR1cm5NYXJrID0gMDtcclxuXHJcbiAgICAgICAgLy9jaGVjayBkYXRhXHJcbiAgICAgICAgX3RhcmdldENvdW50ID0gdGFyZ2V0Q291bnQgfHwgX3RhcmdldENvdW50O1xyXG4gICAgICAgIF90b2xlcmFuY2UgPSB0b2xlcmFuY2UgfHwgX3RvbGVyYW5jZTtcclxuXHJcbiAgICAgICAgX2FycmF5ID0gbG9naWMuaW5pdChhcnJheSxzdW0pO1xyXG4gICAgICAgIGlmKF90YXJnZXRDb3VudCl7XHJcbiAgICAgICAgICAgIF9yZXR1cm5NYXJrID0gX3RhcmdldENvdW50LTE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsb2dpYy5jb3JlKF9hcnJheSxzdW0sdXRpbC5nZXRBcnJheUluZGV4KF9hcnJheSksKF90YXJnZXRDb3VudCB8fCBfYXJyYXkubGVuZ3RoKSxyKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHI7XHJcbiAgICB9LFxyXG59KTtcclxuIiwiY29uc3QgVXNlck1vZGVsSGVscGVyID0ge1xyXG4gIC8vIOeUqOaIt+aYr+WQpuW3suWHuueJjFxyXG4gIGlzUGxheWVkQ2FyZHM6IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICBjYy5hc3NlcnQodXNlcik7XHJcblxyXG4gICAgaWYgKHVzZXIgJiYgdXNlci5jYXJkSW5mbyAmJiB1c2VyLmNhcmRJbmZvLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0sXHJcblxyXG4gIC8vIOeUqOaIt+aYr+WQpuW3suWHhuWkh1xyXG4gIGlzVXNlclJlYWR5OiBmdW5jdGlvbiAodXNlcikge1xyXG4gICAgcmV0dXJuIHVzZXIucmVhZHlTdGF0dXMgPT0gdHJ1ZTtcclxuICB9LFxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBVc2VyTW9kZWxIZWxwZXI7XHJcbiIsImNvbnN0IFNwcml0ZUhlbHBlciA9IHJlcXVpcmUoJ1Nwcml0ZUhlbHBlcicpO1xyXG5cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBsYWJlbFVzZXJJZDogY2MuTGFiZWwsXHJcbiAgICAgICAgbGFiZWxVc2VySVA6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxhYmVsTmlja25hbWU6IGNjLkxhYmVsLFxyXG4gICAgICAgIGF2YXRhclNwcml0ZTogY2MuU3ByaXRlLFxyXG4gICAgICAgIG1hblNwcml0ZTogY2MuU3ByaXRlLFxyXG4gICAgICAgIHdvbWVuU3ByaXRlOiBjYy5TcHJpdGUsXHJcblxyXG4gICAgICAgIF9kaWRTaG93VXNlckluZm86IG51bGwsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVXaXRoVXNlcjogZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0aGlzLl9kaWRTaG93VXNlckluZm8gPT0gdXNlcikge1xyXG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIHRoaXMuX2Rpc2FwcGVhclVzZXJJbmZvKCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLl9kaWRTaG93VXNlckluZm8gPSB1c2VyO1xyXG4gICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcclxuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fZGlzYXBwZWFyVXNlckluZm8oKTtcclxuICAgICAgfS5iaW5kKHRoaXMpLCA1KTtcclxuXHJcbiAgICAgIHRoaXMubGFiZWxVc2VySWQuc3RyaW5nID1cIlVJRDpcXG5cIit1c2VyLmlkO1xyXG4gICAgICB0aGlzLmxhYmVsVXNlcklQLnN0cmluZyA9XCLnlKjmiLdJUDpcXG5cIit1c2VyLmlwQWRkcmVzcy5yZXBsYWNlKFwiOjpmZmZmOlwiLCBcIlwiKTtcclxuICAgICAgdGhpcy5sYWJlbE5pY2tuYW1lLnN0cmluZyA9IHVzZXIubmlja25hbWU7XHJcbiAgICAgIHRoaXMuYXZhdGFyU3ByaXRlLnNwcml0ZUZyYW1lID0gbnVsbDtcclxuICAgICAgU3ByaXRlSGVscGVyLnNldEltYWdlVXJsKHRoaXMuYXZhdGFyU3ByaXRlLCB1c2VyLmF2YXRhclVybCk7XHJcblxyXG4gICAgICBsZXQgc2V4ID0gdXNlci5zZXg7ICAvLyBzZXg6IDEg55S3ICAyIOWls1xyXG4gICAgICB0aGlzLm1hblNwcml0ZS5ub2RlLmFjdGl2ZSA9IChzZXggPT0gMSk7XHJcbiAgICAgIHRoaXMud29tZW5TcHJpdGUubm9kZS5hY3RpdmUgPSAoc2V4ICE9IDEpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGlzYXBwZWFyVXNlckluZm86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLl9kaWRTaG93VXNlckluZm8gPSBudWxsO1xyXG4gICAgfSxcclxufSk7XHJcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xyXG5jb25zdCBLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyID0gcmVxdWlyZSgnS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlcicpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgYWdyZWVtZW50OiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkxhYmVsXHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlSGFsbEluZm8sIHRoaXMuX3NvY2tldFJlY2VpdmVIYWxsSW5mbywgdGhpcyk7XHJcbiAgICAgICAgLy8gY2MubG9nKCctLS0tNjEnKVxyXG4gICAgICAgIC8vICBjYy5sb2codGhpcy5hZ3JlZW1lbnQpXHJcbiAgICB9LFxyXG4gICAgX3NvY2tldFJlY2VpdmVIYWxsSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcyA9IGNjLmZpbmQoJ0NhbnZhcy9hZ3JlZW1lbnQnKTtcclxuICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgLy90aGlzLl9pbmZvMSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgLy8gY2MubG9nKHRoaXMuYWdyZWVtZW50KVxyXG4gICAgICAgIC8vIGNjLmxvZyhzKVxyXG4gICAgICAgIC8vIGNjLmxvZygnLS0tLTYxJylcclxuICAgICAgICB0aGlzLmFncmVlbWVudC5zdHJpbmcgPSBkYXRhLmluZm8xIHx8IFwiXCI7XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsInZhciBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIHBvcE5vZGU6Y2MuTm9kZSxcclxuICAgICAgICBsYWJlbDpjYy5MYWJlbCxcclxuXHJcbiAgICAgICAgX2FsZXJ0Q2FsbGJhY2s6IG51bGwsXHJcbiAgICAgICAgX3dpbGxEaXNtaXNzQ2FsbGJhY2s6IG51bGwsXHJcbiAgICAgICAgX2Rpc21pc3NDYWxsYmFjazogbnVsbCxcclxuICAgICAgICBfY29uZmlybUNhbGxiYWNrOiBudWxsLCAgIC8vIOeCueWHu+ehruWumuWQjueahOWbnuiwg1xyXG4gICAgICAgIF90aXNoaTpudWxsLFxyXG4gICAgICAgIF9jYXJkX251bTpudWxsLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBcclxuICAgIH0sXHJcblxyXG4gICAgYWxlcnQ6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBvcE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgYW5pbS5wbGF5KCdwb3AnKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2FsZXJ0Q2FsbGJhY2spIHtcclxuICAgICAgICAgIHRoaXMuX2FsZXJ0Q2FsbGJhY2sodGhpcy5ub2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyojIyMjI+W8ueWHuue7k+aenCovXHJcbiAgICBhbGVydFJlc3VsdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGNjLmZpbmQoXCJDYW52YXMvc2hvd19yZXN1bHRcIikuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBvcE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgYW5pbS5wbGF5KCdwb3AnKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2FsZXJ0Q2FsbGJhY2spIHtcclxuICAgICAgICAgIHRoaXMuX2FsZXJ0Q2FsbGJhY2sodGhpcy5ub2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyPngrnlh7vnoa7lrpoqL1xyXG4gICAgcGxheUJ0bkNsaWNrU0ZYOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5QnRuQ2xpY2tTRlgoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjI+eCueWHu+WPlua2iCovXHJcbiAgICBwYWx5QnRuQ2FuY2VsQ2xpY2tTRlg6ZnVuY3Rpb24oKXtcclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseUJ0bkNhbmNlbENsaWNrU0ZYKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyPngrnlh7vlhbPpl63miJbogIXmjInplK7kuYvnsbvnmoTmjInpkq7vvIzmkq3mlL7pn7PmlYgqL1xyXG4gICAgcGFseUJ0blB1YmxpY1NGWDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5QnRuUHVibGljU0ZYKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyPngrnlh7vliJvlu7rmiL/pl7TvvIzmkq3mlL7pn7PmlYgqL1xyXG4gICAgcGFseUJ0bkNyZWF0ZVJvb21TRlg6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseUJ0bkNyZWF0ZVJvb21TRlgoKTtcclxuICAgIH0sXHJcbiAgICAvKiMjIyMj54K55Ye75Yib5bu65oi/6Ze077yM5pKt5pS+6Z+z5pWIKi9cclxuICAgIHBhbHlXaW5kb3dTRlg6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseVdpbmRvd1NGWCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBwYWx5V2VpWGluTG9naW5TRlg6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlXZWlYaW5Mb2dpblNGWCgpO1xyXG4gICAgfSxcclxuICAgIHBhbHlGYW5nUGFpU0ZYOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlGYW5nUGFpU0ZYKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGRpc21pc3NBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxldCB3aWxsRGlzbWlzc0NhbGxiYWNrID0gdGhpcy5fd2lsbERpc21pc3NDYWxsYmFjaztcclxuICAgICAgaWYgKHdpbGxEaXNtaXNzQ2FsbGJhY2spIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gd2lsbERpc21pc3NDYWxsYmFjaygpO1xyXG4gICAgICAgIGlmIChyZXN1bHQpIHtcclxuICAgICAgICAgIHRoaXMuZGlzbWlzc0NvbXBsZXRlKCk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAgIHZhciBhbmltID0gdGhpcy5wb3BOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xyXG4gICAgICAgIHZhciBkaXNtaXNzQW5pbSA9IGFuaW0uZ2V0QW5pbWF0aW9uU3RhdGUoJ3BvcF9kaXNtaXNzJyk7XHJcbiAgICAgICAgZGlzbWlzc0FuaW0ub24oJ2ZpbmlzaGVkJyx0aGlzLmRpc21pc3NDb21wbGV0ZSx0aGlzKTtcclxuICAgICAgICBhbmltLnBsYXkoJ3BvcF9kaXNtaXNzJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyPpmpDol4/nu5PmnpzpobXpnaIqL1xyXG4gICAgZGlzbWlzc0FjdGlvblJlc3VsdDpmdW5jdGlvbigpIHtcclxuICAgICAgbGV0IHdpbGxEaXNtaXNzQ2FsbGJhY2sgPSB0aGlzLl93aWxsRGlzbWlzc0NhbGxiYWNrO1xyXG4gICAgICBpZiAod2lsbERpc21pc3NDYWxsYmFjaykge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSB3aWxsRGlzbWlzc0NhbGxiYWNrKCk7XHJcbiAgICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgICAgdGhpcy5kaXNtaXNzQ29tcGxldGUoKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBvcE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgdmFyIGRpc21pc3NBbmltID0gYW5pbS5nZXRBbmltYXRpb25TdGF0ZSgncG9wX2Rpc21pc3MnKTtcclxuICAgICAgICBkaXNtaXNzQW5pbS5vbignZmluaXNoZWQnLHRoaXMuZGlzbWlzc0NvbXBsZXRlLHRoaXMpO1xyXG4gICAgICAgIGFuaW0ucGxheSgncG9wX2Rpc21pc3MnKTtcclxuICAgICAgICBjYy5maW5kKFwiQ2FudmFzL3Nob3dfcmVzdWx0XCIpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG5cclxuICAgIGRpc21pc3NDb21wbGV0ZTpmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm9uRGlzbWlzc0NvbXBsZXRlKSB7XHJcbiAgICAgICAgICB0aGlzLm9uRGlzbWlzc0NvbXBsZXRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fZGlzbWlzc0NhbGxiYWNrKSB7XHJcbiAgICAgICAgICB0aGlzLl9kaXNtaXNzQ2FsbGJhY2sodGhpcy5ub2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZGlzbWlzc1BsYXk6ZnVuY3Rpb24oKSB7XHJcbiAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcImhhbGxcIik7ICBcclxuICAgIH0sXHJcblxyXG4gICAgb25EaXNtaXNzQ29tcGxldGU6ZnVuY3Rpb24oKSB7XHJcbiAgICAgIC8vY2MubG9nKFwib25EaXNtaXNzQ29tcGxldGVcIik7XHJcbiAgICB9LFxyXG5cclxuICAgIGRvbmVBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5vbkRvbmVBY3Rpb24oKTtcclxuXHJcbiAgICAgICAgbGV0IGNvbmZpcm1DYWxsYmFjayA9IHRoaXMuX2NvbmZpcm1DYWxsYmFjaztcclxuICAgICAgICBpZiAoY29uZmlybUNhbGxiYWNrKSB7XHJcbiAgICAgICAgICBjb25maXJtQ2FsbGJhY2sodGhpcy5ub2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIG9uRG9uZUFjdGlvbjpmdW5jdGlvbigpIHtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNldE1lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XHJcbiAgICAgICAgdGhpcy5sYWJlbC5zdHJpbmcgPSBtc2c7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldE1lc3NhZ2U6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubGFiZWwuc3RyaW5nO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRBbGVydENhbGxiY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICB0aGlzLl9hbGVydENhbGxiYWNrID0gY2FsbGJhY2s7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldFdpbGxEaXNtaXNzQ2FsbGJhY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICB0aGlzLl93aWxsRGlzbWlzc0NhbGxiYWNrID0gY2FsbGJhY2s7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldERpc21pc3NDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgIHRoaXMuX2Rpc21pc3NDYWxsYmFjayA9IGNhbGxiYWNrO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRDb25maXJtQ2FsbGJhY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICB0aGlzLl9jb25maXJtQ2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICAgIH0sXHJcblxyXG4gICAgLypzZXRNZXNzYWdlOiBmdW5jdGlvbiAobWVzc2FnZSkge1xyXG4gICAgICB0aGlzLmxhYmVsLmdldENvbXBvbmVudCgnY2MuTGFiZWwnKS5zdHJpbmcgPSBtZXNzYWdlO1xyXG4gICAgfSwqL1xyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCIvKipcclxuICogIOaIv+mXtOeJueauiueJjOWKqOeUu1xyXG4gKlxyXG4gKlxyXG4gKlxyXG4gKiBcclxuICovXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgZmFwYWlOb2RlOiBjYy5QcmVmYWIsICAvL1xyXG4gICAgICAgIGxpdWR1aWJhbjpjYy5QcmVmYWIsXHJcbiAgICAgICAgc2FudG9uZ2h1YTpjYy5QcmVmYWIsXHJcbiAgICAgICAgc2Fuc2h1bnppOmNjLlByZWZhYixcclxuICAgICAgICBxdWFubGVpZGE6Y2MuUHJlZmFiLFxyXG4gICAgICAgIHFpbmdsb25nOmNjLlByZWZhYixcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9LFxyXG4gICAgZmFwYWlBbmltYXRpb246ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgZmFwYWkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ2ZhcGFpJyk7XHJcbiAgICAgICAgZmFwYWkgPSBjYy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgdmFyIGZhcGFpQW5pbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuZmFwYWlOb2RlKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQoZmFwYWlBbmltKTtcclxuXHJcbiAgICAgICAgdmFyIExndW4gPSBmYXBhaUFuaW0uZ2V0Q2hpbGRCeU5hbWUoXCJsZWZ0X2dhbmdcIik7ICAgLy8g5bem6L6555qE5oqiXHJcbiAgICAgICAgdmFyIFJndW4gPSAgZmFwYWlBbmltLmdldENoaWxkQnlOYW1lKFwicmlnaHRfZ2FuZ1wiKTsgLy8g5Y+z6L6555qE5oqiXHJcbiAgICAgICAgdmFyIG1hc2sgPSBmYXBhaUFuaW0uZ2V0Q2hpbGRCeU5hbWUoXCJtYXNrXCIpO1xyXG4gICAgICAgIC8qIC0tLS0tLS0tLS0tc3RhcnTlj4rlrZDoioLngrktLS0tLS0tLS0tLSAqL1xyXG4gICAgICAgIHZhciBzdGFydCA9IGZhcGFpQW5pbS5nZXRDaGlsZEJ5TmFtZShcInN0YXJ0XCIpLFxyXG4gICAgICAgICAgICBxdWFuID0gc3RhcnQuZ2V0Q2hpbGRCeU5hbWUoXCJxdWFuXCIpLFxyXG4gICAgICAgICAgICBiYW9kaWFuID0gc3RhcnQuZ2V0Q2hpbGRCeU5hbWUoXCJiYW9kaWFuXCIpLFxyXG4gICAgICAgICAgICBkaXRhbiA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwiZGl0YW5cIiksXHJcbiAgICAgICAgICAgIGJlZ2luSWNvID0gc3RhcnQuZ2V0Q2hpbGRCeU5hbWUoXCJiZWdpbl9pY29uXCIpLFxyXG4gICAgICAgICAgICB0aXRsZSA9IHN0YXJ0LmdldENoaWxkQnlOYW1lKFwidGl0bGVcIiksXHJcbiAgICAgICAgICAgIHJXaW5nID0gc3RhcnQuZ2V0Q2hpbGRCeU5hbWUoXCJyV2luZ1wiKSxcclxuICAgICAgICAgICAgbFdpbmcgPSBzdGFydC5nZXRDaGlsZEJ5TmFtZShcImxXaW5nXCIpO1xyXG4gICAgICAgIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBmYXBhaUFuaW0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBtYXNrLnJ1bkFjdGlvbiggY2Muc2NhbGVUbygwLjIsMTAsMTApICk7XHJcbiAgICAgICAgTGd1bi5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKHNlbGYuTGd1bkFjdGlvbigpKSApO1xyXG4gICAgICAgIFJndW4ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShzZWxmLlJndW5BY3Rpb24oKSkgKTtcclxuXHJcbiAgICAgICAgdmFyIHN0YXJ0RmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICByV2luZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBsV2luZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBsV2luZy5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKCBjYy5yZXBlYXQoIGNjLnNlcXVlbmNlKCBjYy5za2V3VG8oMC4wNSwyMCwtMTApLGNjLnNrZXdUbygwLjA1LDAsMCkgKSwzKSxjYy5mYWRlT3V0KDApKSApO1xyXG4gICAgICAgICAgICByV2luZy5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKCBjYy5yZXBlYXQoIGNjLnNlcXVlbmNlKCBjYy5za2V3VG8oMC4wNSwyMCwtMTApLGNjLnNrZXdUbygwLjA1LDAsMCkgKSwzKSxjYy5mYWRlT3V0KDApKSApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB3aW5nRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBzdGFydC5ydW5BY3Rpb24oY2Muc2NhbGVUbygwLjIsMCwwKSk7XHJcbiAgICAgICAgICAgIH0sNTAwKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHN0YXJ0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHN0YXJ0LnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc2NhbGVUbygwLjIsMS41LDEuNSksY2Muc2NhbGVUbygwLjIsMSwxKSxzdGFydEZpbmlzaGVkLHdpbmdGaW5pc2hlZCkgKTtcclxuICAgICAgICAgICAgcXVhbi5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNjYWxlVG8oMC4yLDEwLDEwKSxjYy5mYWRlT3V0KDApKSk7XHJcbiAgICAgICAgICAgIGJhb2RpYW4ucnVuQWN0aW9uKCAgY2Muc2VxdWVuY2UoY2Muc2NhbGVUbygwLjIsMS41LDEuNSksY2MuZmFkZU91dCgwKSkgKTtcclxuICAgICAgICB9LDQwMCk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBsV2luZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgcldpbmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHN0YXJ0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmYXBhaUFuaW0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGZhcGFpQW5pbS5yZW1vdmVGcm9tUGFyZW50KHRydWUpO1xyXG4gICAgICAgIH0sMjAwMClcclxuXHJcbiAgICB9LFxyXG4gICAgTGd1bkFjdGlvbjpmdW5jdGlvbigpeyAvLyDlt6bovrnnmoTmnqpcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICBjYy5zcGF3bihbXHJcbiAgICAgICAgICAgICAgICBjYy5tb3ZlVG8oIDAuMiwgY2MudjIoLTQzMCwgMTUyKSApLFxyXG4gICAgICAgICAgICAgICAgY2Muc2NhbGVUbygwLjIsMiwyKVxyXG4gICAgICAgICAgICBdKSxcclxuICAgICAgICAgICAgY2Muc3Bhd24oW1xyXG4gICAgICAgICAgICAgICAgY2MuZmFkZVRvKDAuMiwgMjU1KSxcclxuICAgICAgICAgICAgICAgIGNjLm1vdmVUbyggMC4yLCBjYy52MigtMjIwLCAwKSApLFxyXG4gICAgICAgICAgICAgICAgY2Mucm90YXRlVG8oMC4yLDM1KVxyXG4gICAgICAgICAgICBdKSxcclxuICAgICAgICAgICAgY2MuZmFkZU91dCgwKSxcclxuICAgICAgICBdO1xyXG4gICAgfSxcclxuICAgIFJndW5BY3Rpb246ZnVuY3Rpb24oKXsgLy8g5Y+z6L6555qE5p6qXHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgY2Muc3Bhd24oW1xyXG4gICAgICAgICAgICAgICAgY2MubW92ZVRvKCAwLjIsIGNjLnYyKDQzMCwgMTUyKSApLFxyXG4gICAgICAgICAgICAgICAgY2Muc2NhbGVUbygwLjIsLTIsMilcclxuICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgIGNjLnNwYXduKFtcclxuICAgICAgICAgICAgICAgIGNjLmZhZGVUbygwLjIsIDI1NSksXHJcbiAgICAgICAgICAgICAgICBjYy5tb3ZlVG8oIDAuMiwgY2MudjIoMjIwLCAwKSApLFxyXG4gICAgICAgICAgICAgICAgY2Mucm90YXRlVG8oMC4yLC0zNSlcclxuICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgIGNjLmZhZGVPdXQoMClcclxuICAgICAgICBdO1xyXG4gICAgfSxcclxuICAgIF9iZXppZXIxOmZ1bmN0aW9uKGluZGV4KXtcclxuICAgICAgICB2YXIgYmV6aWVyID0gW107XHJcbiAgICAgICAgYmV6aWVyWzBdID0gWyBbY2MudjIoMTAwLCA3NCksY2MudjIoMTUwLDE3NCksY2MudjIoMjAwLCAtMTc0KV0sIGNjLnYyKDEwMCwgNzQpIF07XHJcbiAgICAgICAgYmV6aWVyWzFdID0gWyBbY2MudjIoLTcyLCAyODQpLGNjLnYyKC0xMjIsMzg0KSxjYy52MigtMjIyLCAtMTUwKV0sIGNjLnYyKC03MiwgMjg0KSBdO1xyXG4gICAgICAgIGJlemllclsyXSA9IFsgW2NjLnYyKC03MCwgMjAwKSxjYy52MigtMTIwLDMwMCksY2MudjIoLTIyMCwgLTIwMCldLCBjYy52MigtNzAsIDIwMCkgXTtcclxuICAgICAgICBiZXppZXJbM10gPSBbIFtjYy52MigtMTIzLCAyMTMpLGNjLnYyKC0xNzMsMzEzKSxjYy52MigtMjczLCAtMTYwKV0sIGNjLnYyKC0xMjMsIDIxMykgXTtcclxuICAgICAgICBiZXppZXJbNF0gPSBbIFtjYy52MigxMTAsIDIzNyksY2MudjIoMTYwLDMzNyksY2MudjIoMjYwLCAtMTc3KV0sIGNjLnYyKDIxMCwgMjM3KSBdO1xyXG4gICAgICAgIGJlemllcls1XSA9IFsgW2NjLnYyKDE4MywgMTE1KSxjYy52MigyMzMsMjE1KSxjYy52MigzMzMsIC0xNTUpXSwgY2MudjIoMTgzLCAxMTUpIF07XHJcbiAgICAgICAgYmV6aWVyWzZdID0gWyBbY2MudjIoOTIsIDExNiksY2MudjIoMTQyLDIxNiksY2MudjIoMjQyLCAtMTQ2KV0sIGNjLnYyKDkyLCAxMTYpIF07XHJcbiAgICAgICAgYmV6aWVyWzddID0gWyBbY2MudjIoLTI2LCAxMjQpLGNjLnYyKC03NiwyMjQpLGNjLnYyKC0xNzYsIC0xNjQpXSwgY2MudjIoLTI2LCAxMjQpIF07XHJcbiAgICAgICAgYmV6aWVyWzhdID0gWyBbY2MudjIoLTExMCwgODEpLGNjLnYyKC0yMjAsMTMxKSxjYy52MigtNDYwLCAtMTgwKV0sIGNjLnYyKC0xMTAsIDgxKSBdO1xyXG4gICAgICAgIGJlemllcls5XSA9IFsgW2NjLnYyKC0xMjUsIDMzKSxjYy52MigtMjI1LDEzMyksY2MudjIoLTI3NSwgLTEzMyldLCBjYy52MigtMTI1LCAzMykgXTtcclxuICAgICAgICBiZXppZXJbMTBdID0gWyBbY2MudjIoMCwgMCksY2MudjIoNTAsMTAwKSxjYy52MigxNTAsIC0xNTApXSwgY2MudjIoMCwgMCkgXTtcclxuICAgICAgICBiZXppZXJbMTFdID0gWyBbY2MudjIoLTIzNSwgNSksY2MudjIoLTI3NSwxMDUpLGNjLnYyKC0zNzUsIC0xODYpXSwgY2MudjIoLTIzNSwgNSkgXTtcclxuICAgICAgICBiZXppZXJbMTJdID0gWyBbY2MudjIoLTgwLCA0KSxjYy52MigtMTMwLDEwNCksY2MudjIoLTIzMCwgLTIzMyldLCBjYy52MigtODAsIDQpIF07XHJcbiAgICAgICAgYmV6aWVyWzEzXSA9IFsgW2NjLnYyKDEwMCwgLTcpLGNjLnYyKDE1MCwxMDcpLGNjLnYyKDI1MCwgLTE3NyldLCBjYy52MigxMDAsIC03KSBdO1xyXG4gICAgICAgIGJlemllclsxNF0gPSBbIFtjYy52MigxNTQsIDIzKSxjYy52MigyMDQsMTEzKSxjYy52MigyNTQsIC0xNzMpXSwgY2MudjIoMjU0LCAyMykgXTtcclxuICAgICAgICByZXR1cm4gYmV6aWVyW2luZGV4XTtcclxuICAgIH0sXHJcbiAgICAvLyDpnZLpvpnliqjnlLtcclxuICAgIF9xaW5nbG9uZ0FuaWFtdGlvbjpmdW5jdGlvbih0eXBlKXtcclxuICAgICAgICB2YXIgcWluZ2xvbmcgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnFpbmdsb25nKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQocWluZ2xvbmcpO1xyXG4gICAgICAgIHZhciBiZyA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCdiZycpO1xyXG4gICAgICAgIHZhciB0aXRsZSA9ICcnO1xyXG4gICAgICAgIGlmKHR5cGUgPT0gXCJxbFwiKXtcclxuICAgICAgICAgICAgdGl0bGUgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgncWxvbmd0aXRsZScpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aXRsZSA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCdsb25ndGl0bGUnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB5dW4xID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ3l1bjEnKTtcclxuICAgICAgICB2YXIgeXVuMiA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCd5dW4yJyk7XHJcbiAgICAgICAgdmFyIHl1bjMgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgneXVuMycpO1xyXG4gICAgICAgIHZhciB5dW40ID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ3l1bjQnKTtcclxuICAgICAgICB2YXIgbG9uZyA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKFwibG9uZ1wiKTtcclxuXHJcbiAgICAgICAgdmFyIGh1YTEgPSBxaW5nbG9uZy5nZXRDaGlsZEJ5TmFtZSgnaHVhMScpO1xyXG4gICAgICAgIHZhciBodWEyID0gcWluZ2xvbmcuZ2V0Q2hpbGRCeU5hbWUoJ2h1YTInKTtcclxuICAgICAgICB2YXIgaHVhMyA9IHFpbmdsb25nLmdldENoaWxkQnlOYW1lKCdodWEzJyk7XHJcbiAgICAgICAgdmFyIEEgPSBbXSAsIEIgPSBbXSAsIEMgPSBbXTtcclxuICAgICAgICB2YXIgaHVhID0gW107XHJcblxyXG4gICAgICAgIHZhciB0ZXN0ID0gY2MuaW5zdGFudGlhdGUoaHVhMSk7XHJcblxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBmb3IgKHZhciBpPTA7aTw1O2krKyl7XHJcbiAgICAgICAgICAgIEFbaV0gPSBjYy5pbnN0YW50aWF0ZShodWExKTtcclxuICAgICAgICAgICAgQVtpXS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMSwyNTUpKTtcclxuICAgICAgICAgICAgaHVhLnB1c2goIEFbaV0gKTtcclxuICAgICAgICAgICAgQltpXSA9IGNjLmluc3RhbnRpYXRlKGh1YTIpO1xyXG4gICAgICAgICAgICBCW2ldLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4xLDI1NSkpO1xyXG4gICAgICAgICAgICBodWEucHVzaCggQltpXSApO1xyXG4gICAgICAgICAgICBDW2ldID0gY2MuaW5zdGFudGlhdGUoaHVhMyk7XHJcbiAgICAgICAgICAgIENbaV0ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjEsMjU1KSk7XHJcbiAgICAgICAgICAgIGh1YS5wdXNoKCBDW2ldICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgYmdGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5zY2FsZVRvKDAuMiwxLDEpLGNjLmZhZGVUbygwLjIsMjU1KSksY2Muc2NhbGVUbygwLjIsMiwyKSxjYy5zcGF3bihjYy5zY2FsZVRvKDAuMiwxLjUsMS41KSxsb25nU3RhcnQpICkgKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgbG9uZ1N0YXJ0ID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgbG9uZy5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDAuNSkpLGNjLnNjYWxlVG8oMC4xLDMsMyksY2Muc3Bhd24oY2Muc2NhbGVUbygwLjEsMSwxKSx5dW5TdGFydCkgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGZsb3dlclN0YXJ0ID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgfSk7IFxyXG4gICAgICAgIHZhciB5dW5TdGFydCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHl1bjEucnVuQWN0aW9uKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLm1vdmVUbygwLjIsY2MudjIoLTMzNCwyMzQpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0zNDQsMjM0KSkpLDMpICkpO1xyXG4gICAgICAgICAgICB5dW4yLnJ1bkFjdGlvbihjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnJlcGVhdChjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4yLGNjLnYyKC0zNjgsLTgyKSksY2MubW92ZVRvKDAuMixjYy52MigtMzU4LC04MikpKSwzKSApKTtcclxuICAgICAgICAgICAgeXVuMy5ydW5BY3Rpb24oY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMixjYy52Mig0MDgsLTQpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDM5OCwtNCkpKSwzKSkpO1xyXG4gICAgICAgICAgICB5dW40LnJ1bkFjdGlvbihjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnJlcGVhdChjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4yLGNjLnYyKDQwNiwxODEpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDQxNiwxODEpKSksMykgKSk7XHJcbiAgICAgICAgICAgIGZvcih2YXIgaT0xO2k8aHVhLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgaHVhW2ldLnNldFBvc2l0aW9uKHNlbGYuX2JlemllcihpKVsxXSk7XHJcbiAgICAgICAgICAgICAgICBxaW5nbG9uZy5hZGRDaGlsZChodWFbaV0pO1xyXG4gICAgICAgICAgICAgICAgaHVhW2ldLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oIGNjLmJlemllclRvKDAuMyxzZWxmLl9iZXppZXIoaSlbMF0pLGNjLnNjYWxlVG8oMC4zLDEsMSksY2MuZmFkZVRvKDAuMywwKSApKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgcWluZ2xvbmcucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcclxuICAgICAgICAgICAgfSwxNTAwKTtcclxuICAgICAgICAgICAgLy95dW4xXHJcbiAgICAgICAgfSlcclxuICAgICAgICBiZy5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuNCwyNTUpLGNjLnNjYWxlVG8oMC40LDMwLDMwKSksYmdGaW5pc2hlZCApKTtcclxuICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2NhbGVUbygwLjIsMiwyKSk7XHJcblxyXG4gICAgfSxcclxuICAgIC8vIOS4iemhuuWtkOWKqOeUu1xyXG4gICAgX3NhbnNodW56aUFuaW1hdGlvbjpmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBzYW5zaHVuemkgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnNhbnNodW56aSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHNhbnNodW56aSk7XHJcbiAgICAgICAgdmFyIGJnID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCdiZycpO1xyXG4gICAgICAgIHZhciBMdHUgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ0x0dScpO1xyXG4gICAgICAgIHZhciBSdHUgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ1J0dScpO1xyXG4gICAgICAgIHZhciB0aXRsZSA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcclxuICAgICAgICB2YXIgenVzaHVuMSA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnenVzaHVuMScpO1xyXG4gICAgICAgIHZhciB6dXNodW4yID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCd6dXNodW4yJyk7XHJcbiAgICAgICAgdmFyIHp1c2h1bjMgPSBzYW5zaHVuemkuZ2V0Q2hpbGRCeU5hbWUoJ3p1c2h1bjMnKTtcclxuICAgICAgICB2YXIgenVzaHVuNCA9IHNhbnNodW56aS5nZXRDaGlsZEJ5TmFtZSgnenVzaHVuNCcpO1xyXG4gICAgICAgIHZhciB6dXNodW41ID0gc2Fuc2h1bnppLmdldENoaWxkQnlOYW1lKCd6dXNodW41Jyk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBiZ0ZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5zY2FsZVRvKDAuMiwxLDEpLGNjLmZhZGVUbygwLjIsMjU1KSksdGl0bGVGaW5pc2hlZCApKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgdGl0bGVGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoIGNjLnNjYWxlVG8oMC4yLDIuNSwyLjUpLHRpdGxlU2NhbGUpKTtcclxuICAgICAgICAgICAgTHR1LnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2MuZmFkZVRvKDAuMiwyNTUpICkpO1xyXG4gICAgICAgICAgICBSdHUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5mYWRlVG8oMC4yLDI1NSkpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgdGl0bGVTY2FsZSA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7ICAgIC8vIHRpdGxl5pS+5aSn5a6M5oiQ5ZCOIOerueesizLlkowz5ZCM5pe26L+b6KGMXHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbiggY2Muc2NhbGVUbygwLjIsMS41LDEuNSkgKTtcclxuICAgICAgICAgICAgenVzaHVuMi5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKCBjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMTIsMTIpKSxjYy5zY2FsZVRvKDAuMiwxMCwxMCksWlMxICkpO1xyXG4gICAgICAgICAgICB6dXNodW4zLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwyMiwyMikpLGNjLnNjYWxlVG8oMC4yLDIwLDIwKSxaUzQgKSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHp1c2h1bjUucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3biggY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDEyLDEyKSksY2Muc2NhbGVUbygwLjIsMTAsMTApKSApO1xyXG4gICAgICAgICAgICB9LDEwMClcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zYW5zaHVuemkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBzYW5zaHVuemkucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcclxuICAgICAgICAgICAgfSwyMDAwKVxyXG5cclxuICAgICAgICB9KVxyXG4gICAgICAgIHZhciBaUzEgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB6dXNodW4xLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwxMiwxMikpLGNjLnNjYWxlVG8oMC4yLDEwLDEwKSkgKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHZhciBaUzQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB6dXNodW40LnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oIGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwxNCwxNCkpLGNjLnNjYWxlVG8oMC4yLDEyLDEyKSkgKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIGJnLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC40LDI1NSksY2Muc2NhbGVUbygwLjQsMzAsMzApKSxiZ0ZpbmlzaGVkICkpO1xyXG4gICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5zY2FsZVRvKDAuMiwyLDIpKTtcclxuXHJcbiAgICB9LFxyXG4gICAgLy8g5YWo5Z6S5omTXHJcbiAgICBfcXVhbmxlaWRhQW5pbWF0aW9uOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIHF1YW5sZWlkYSA9IGNjLmluc3RhbnRpYXRlKHRoaXMucXVhbmxlaWRhKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQocXVhbmxlaWRhKTtcclxuICAgICAgICB2YXIgYmcgPSBxdWFubGVpZGEuZ2V0Q2hpbGRCeU5hbWUoJ2JnJyk7XHJcbiAgICAgICAgdmFyIGJhbGwgPSBxdWFubGVpZGEuZ2V0Q2hpbGRCeU5hbWUoJ2JhbGwnKTtcclxuICAgICAgICB2YXIgYmFuZ3FpdXRhbyA9IHF1YW5sZWlkYS5nZXRDaGlsZEJ5TmFtZSgnYmFuZ3FpdXRhbycpO1xyXG4gICAgICAgIHZhciBiYW5ncWl1Z3VuID0gcXVhbmxlaWRhLmdldENoaWxkQnlOYW1lKCdiYW5ncWl1Z3VuJyk7XHJcbiAgICAgICAgdmFyIEx5dW4gPSBxdWFubGVpZGEuZ2V0Q2hpbGRCeU5hbWUoJ0x5dW4nKTtcclxuICAgICAgICB2YXIgUnl1biA9IHF1YW5sZWlkYS5nZXRDaGlsZEJ5TmFtZSgnUnl1bicpO1xyXG4gICAgICAgIHZhciB0aXRsZSA9IHF1YW5sZWlkYS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcclxuICAgICAgICB2YXIgYmdGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2Muc2NhbGVUbygwLjIsMSwxKSxjYy5mYWRlVG8oMC4yLDI1NSkpLHRpdGxlRmluaXNoZWQgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHRpdGxlRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKCBjYy5zY2FsZVRvKDAuMiwyLjUsMi41KSxjYy5zY2FsZVRvKDAuMiwxLjUsMS41KSxcclxuICAgICAgICAgICAgICAgIGNjLnJlcGVhdChjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4zLGNjLnYyKDAsMjApKSxjYy5tb3ZlVG8oMC4zLGNjLnYyKDAsMCkpKSwyKSApKTtcclxuXHJcbiAgICAgICAgICAgIEx5dW4ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMjAsMjApLGNjLm1vdmVUbygwLjIsY2MudjIoLTI3MCw3MCkpICksXHJcbiAgICAgICAgICAgICAgICBjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMyxjYy52MigtMjcwLDI2KSksY2MubW92ZVRvKDAuMyxjYy52MigtMjcwLDQ2KSkpLDIpICkpO1xyXG5cclxuICAgICAgICAgICAgUnl1bi5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwyMCwyMCksY2MubW92ZVRvKDAuMixjYy52MigyNzAsNzApKSApLFxyXG4gICAgICAgICAgICAgICAgY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLm1vdmVUbygwLjMsY2MudjIoMjcwLDY2KSksY2MubW92ZVRvKDAuMyxjYy52MigyNzAsNDYpKSksMikgKSk7XHJcblxyXG4gICAgICAgICAgICBiYW5ncWl1dGFvLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZSggY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4zLDEwLDEwKSxjYy5tb3ZlVG8oMC4zLGNjLnYyKDI1MCw1MCkpKSxicXRGaW5pc2hlZCApKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgYnF0RmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBiYW5ncWl1dGFvLnJ1bkFjdGlvbihjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2Mucm90YXRlVG8oMC4yLC0xMCksY2Mucm90YXRlVG8oMC4yLDApKSwzKSk7XHJcbiAgICAgICAgICAgIGJhbGwucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4xLDI1NSksY2MubW92ZVRvKDAuMixjYy52MigxOTYsODMpKSksYmFsbEZpbmlzaGVkICkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBiYWxsRmluaXNoZWQgPSBjYy4gY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgYmFsbC5ydW5BY3Rpb24oY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwwKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDAsMCkpLGNjLnNjYWxlVG8oMC4yLDQsNCkgKSk7XHJcbiAgICAgICAgICAgIGJhbmdxaXVndW4ucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZSggY2Muc3Bhd24oY2Muc2NhbGVUbygwLjIsMiwyKSxjYy5mYWRlVG8oMC4yLDI1NSkpLGNjLnNjYWxlVG8oMC4zLDEuNSwxLjUpICkpO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBiZy5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBiYWxsLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIGJhbmdxaXV0YW8ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgYmFuZ3FpdWd1bi5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBMeXVuLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIFJ5dW4ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG5cclxuICAgICAgICAgICAgICAgIHF1YW5sZWlkYS5yZW1vdmVGcm9tUGFyZW50KHRydWUpO1xyXG4gICAgICAgICAgICB9LDIwMDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGJnLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC40LDI1NSksY2Muc2NhbGVUbygwLjQsMzAsMzApKSxiZ0ZpbmlzaGVkICkpO1xyXG4gICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zY2FsZVRvKDAuMiwyLDIpKSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDkuInlkIzoirHliqjnlLtcclxuICAgIF9zYW50b25naHVhQW5pbWF0aW9uOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIHNhbnRvbmdodWEgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnNhbnRvbmdodWEpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChzYW50b25naHVhKTtcclxuICAgICAgICB2YXIgYmcgPSBzYW50b25naHVhLmdldENoaWxkQnlOYW1lKCdiZycpO1xyXG4gICAgICAgIHZhciBodWExID0gc2FudG9uZ2h1YS5nZXRDaGlsZEJ5TmFtZSgnaHVhMScpO1xyXG4gICAgICAgIHZhciBodWEyID0gc2FudG9uZ2h1YS5nZXRDaGlsZEJ5TmFtZSgnaHVhMicpO1xyXG4gICAgICAgIHZhciBodWEzID0gc2FudG9uZ2h1YS5nZXRDaGlsZEJ5TmFtZSgnaHVhMycpO1xyXG4gICAgICAgIHZhciBSdGFvaHVhID0gc2FudG9uZ2h1YS5nZXRDaGlsZEJ5TmFtZSgnUnRhb2h1YScpO1xyXG4gICAgICAgIHZhciBMdGFvaHVhID0gc2FudG9uZ2h1YS5nZXRDaGlsZEJ5TmFtZSgnTHRhb2h1YScpO1xyXG4gICAgICAgIHZhciB0aXRsZSA9IHNhbnRvbmdodWEuZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIC8vdmFyIEgxID0gY2MuaW5zdGFudGlhdGUoaHVhMSk7XHJcbiAgICAgICAgdmFyIEEgPSBbXSAsIEIgPSBbXSAsIEMgPSBbXTtcclxuICAgICAgICB2YXIgaHVhID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaT0wO2k8NTtpKyspe1xyXG4gICAgICAgICAgICBBW2ldID0gY2MuaW5zdGFudGlhdGUoaHVhMSk7XHJcbiAgICAgICAgICAgIEFbaV0ucnVuQWN0aW9uKGNjLmZhZGVUbygwLjEsMjU1KSk7XHJcbiAgICAgICAgICAgIGh1YS5wdXNoKCBBW2ldICk7XHJcbiAgICAgICAgICAgIEJbaV0gPSBjYy5pbnN0YW50aWF0ZShodWEyKTtcclxuICAgICAgICAgICAgQltpXS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMSwyNTUpKTtcclxuICAgICAgICAgICAgaHVhLnB1c2goIEJbaV0gKTtcclxuICAgICAgICAgICAgQ1tpXSA9IGNjLmluc3RhbnRpYXRlKGh1YTMpO1xyXG4gICAgICAgICAgICBDW2ldLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4xLDI1NSkpO1xyXG4gICAgICAgICAgICBodWEucHVzaCggQ1tpXSApO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGJnRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oIGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLnNjYWxlVG8oMC4yLDEsMSksY2MuZmFkZVRvKDAuMiwyNTUpKSxjYy5zY2FsZVRvKDAuMiwxLDEpLHRpdGxlRmluaXNoZWQgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHRpdGxlRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc2NhbGVUbygwLjEsMS44LDEuOCkgKSk7XHJcbiAgICAgICAgICAgIEx0YW9odWEucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5zY2FsZVRvKDAuMiwzLDMpLGNjLm1vdmVUbygwLjIsY2MudjIoLTE2MCwtNjApKSApICkpO1xyXG4gICAgICAgICAgICBSdGFvaHVhLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMywzKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDE0MCwtNjApKSApICkpO1xyXG4gICAgICAgICAgICBmb3IodmFyIGk9MTtpPGh1YS5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgIGh1YVtpXS5zZXRQb3NpdGlvbihzZWxmLl9iZXppZXIoaSlbMV0pO1xyXG4gICAgICAgICAgICAgICAgc2FudG9uZ2h1YS5hZGRDaGlsZChodWFbaV0pO1xyXG4gICAgICAgICAgICAgICAgaHVhW2ldLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oIGNjLmJlemllclRvKDAuMyxzZWxmLl9iZXppZXIoaSlbMF0pLGNjLnNjYWxlVG8oMC4zLDEsMSksY2MuZmFkZVRvKDAuMywwKSApKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgYmcucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICAgICAgUnRhb2h1YS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgICAgICBMdGFvaHVhLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgICAgIHNhbnRvbmdodWEucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcclxuICAgICAgICAgICAgfSwxNTAwKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBiZy5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMywyNTUpLGNjLnNjYWxlVG8oMC4zLDMwLDMwKSksYmdGaW5pc2hlZCApKTtcclxuICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc2NhbGVUbygwLjIsMiwyKSkpO1xyXG4gICAgfSxcclxuICAgIC8vIOi0neWhnuWwlOabsue6vyjlj6rog73lrprkuInkuKrngrkpXHJcbiAgICBfYmV6aWVyOmZ1bmN0aW9uKGluZGV4KXtcclxuICAgICAgICB2YXIgYmV6aWVyID0gW107XHJcbiAgICAgICAgYmV6aWVyWzBdID0gWyBbY2MudjIoMjAwLCA3NCksY2MudjIoMjUwLDEyNCksY2MudjIoNDAwLCAtMTc0KV0sIGNjLnYyKDIwMCwgNzQpIF07XHJcbiAgICAgICAgYmV6aWVyWzFdID0gWyBbY2MudjIoLTcyLCAyODQpLGNjLnYyKC0xMjIsMzM0KSxjYy52MigtMjcyLCAtMTUwKV0sIGNjLnYyKC03MiwgMjg0KSBdO1xyXG4gICAgICAgIGJlemllclsyXSA9IFsgW2NjLnYyKC0yNzAsIDMwMCksY2MudjIoLTMyMCwzNTApLGNjLnYyKC00MjAsIC0yMDApXSwgY2MudjIoLTI3MCwgMzAwKSBdO1xyXG4gICAgICAgIGJlemllclszXSA9IFsgW2NjLnYyKC0yMjMsIDIxMyksY2MudjIoLTI3MywyNjMpLGNjLnYyKC0zNzMsIC0xNjApXSwgY2MudjIoLTIyMywgMjEzKSBdO1xyXG4gICAgICAgIGJlemllcls0XSA9IFsgW2NjLnYyKDIxMCwgMjM3KSxjYy52MigyNjAsMjg3KSxjYy52MigzNjAsIC0xNzcpXSwgY2MudjIoMjEwLCAyMzcpIF07XHJcbiAgICAgICAgYmV6aWVyWzVdID0gWyBbY2MudjIoMTgzLCAxMTUpLGNjLnYyKDIzMywxNjQpLGNjLnYyKDMzMywgLTE1NSldLCBjYy52MigxODMsIDExNSkgXTtcclxuICAgICAgICBiZXppZXJbNl0gPSBbIFtjYy52Mig5MiwgMTE2KSxjYy52MigxNDIsMTY2KSxjYy52MigyNDIsIC0xNDYpXSwgY2MudjIoOTIsIDExNikgXTtcclxuICAgICAgICBiZXppZXJbN10gPSBbIFtjYy52MigtMjYsIDEyNCksY2MudjIoLTc2LDE3NCksY2MudjIoLTE3NiwgLTE2NCldLCBjYy52MigtMjYsIDEyNCkgXTtcclxuICAgICAgICBiZXppZXJbOF0gPSBbIFtjYy52MigtMzEwLCA4MSksY2MudjIoLTM2MCwxMzEpLGNjLnYyKC00NjAsIC0xODApXSwgY2MudjIoLTMxMCwgODEpIF07XHJcbiAgICAgICAgYmV6aWVyWzldID0gWyBbY2MudjIoLTEyNSwgMzMpLGNjLnYyKC0xNzUsODMpLGNjLnYyKC0yNzUsIC0xMzMpXSwgY2MudjIoLTEyNSwgMzMpIF07XHJcbiAgICAgICAgYmV6aWVyWzEwXSA9IFsgW2NjLnYyKDAsIDApLGNjLnYyKDUwLDUwKSxjYy52MigxNTAsIC0xNTApXSwgY2MudjIoMCwgMCkgXTtcclxuICAgICAgICBiZXppZXJbMTFdID0gWyBbY2MudjIoLTIzNSwgNSksY2MudjIoLTI3NSw1NSksY2MudjIoLTM3NSwgLTg2KV0sIGNjLnYyKC0yMzUsIDUpIF07XHJcbiAgICAgICAgYmV6aWVyWzEyXSA9IFsgW2NjLnYyKC04MCwgNCksY2MudjIoLTEzMCw1NCksY2MudjIoLTIzMCwgLTIzMyldLCBjYy52MigtODAsIDQpIF07XHJcbiAgICAgICAgYmV6aWVyWzEzXSA9IFsgW2NjLnYyKDEwMCwgLTcpLGNjLnYyKDE1MCw1NyksY2MudjIoMjUwLCAtMTc3KV0sIGNjLnYyKDEwMCwgLTcpIF07XHJcbiAgICAgICAgYmV6aWVyWzE0XSA9IFsgW2NjLnYyKDI1NCwgMjMpLGNjLnYyKDMwNCw3MyksY2MudjIoNDA0LCAtMTczKV0sIGNjLnYyKDI1NCwgMjMpIF07XHJcbiAgICAgICAgcmV0dXJuIGJlemllcltpbmRleF07XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOWFreWvueWNiuWKqOeUu1xyXG4gICAgX2xpdWR1aWJhbkFuaW1hdGlvbjogZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgbGl1ZHVpYmFuID0gY2MuaW5zdGFudGlhdGUodGhpcy5saXVkdWliYW4pO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChsaXVkdWliYW4pO1xyXG4gICAgICAgIHZhciBiZyA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgnYmcnKTtcclxuICAgICAgICB2YXIgTHFpID0gbGl1ZHVpYmFuLmdldENoaWxkQnlOYW1lKCdMcWknKTtcclxuICAgICAgICB2YXIgUnFpID0gbGl1ZHVpYmFuLmdldENoaWxkQnlOYW1lKCdScWknKTtcclxuICAgICAgICB2YXIgQ3FpID0gbGl1ZHVpYmFuLmdldENoaWxkQnlOYW1lKCdDcWknKTtcclxuICAgICAgICB2YXIgUnRhb2h1YSA9IGxpdWR1aWJhbi5nZXRDaGlsZEJ5TmFtZSgnUnRhb2h1YScpO1xyXG4gICAgICAgIHZhciBMdGFvaHVhID0gbGl1ZHVpYmFuLmdldENoaWxkQnlOYW1lKCdMdGFvaHVhJyk7XHJcbiAgICAgICAgdmFyIHRpdGxlID0gbGl1ZHVpYmFuLmdldENoaWxkQnlOYW1lKCd0aXRsZScpO1xyXG5cclxuICAgICAgICB2YXIgYmdGaW5pc2hlZCA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRpdGxlLnJ1bkFjdGlvbiggY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2Muc2NhbGVUbygwLjIsMSwxKSxjYy5mYWRlVG8oMC4yLDI1NSkpLHRpdGxlRmluaXNoZWQgKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHRpdGxlRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoIGNjLnNjYWxlVG8oMC4xLDIuNSwyLjUpLGNjLnNjYWxlVG8oMC4xLDEuOCwxLjgpLEZpbmlzaGVkICkpO1xyXG4gICAgICAgICAgICBMdGFvaHVhLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2Muc2NhbGVUbygwLjIsMywzKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0xNjAsLTYwKSkgKSApKTtcclxuICAgICAgICAgICAgUnRhb2h1YS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLnNjYWxlVG8oMC4yLDMsMyksY2MubW92ZVRvKDAuMixjYy52MigxNDAsLTYwKSkgKSApKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBMcWkucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLnNwYXduKGNjLmZhZGVUbygwLjIsMjU1KSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0xMDMsMTU4KSkpLGNjLm1vdmVUbygwLjIsY2MudjIoLTEwMywxNjgpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKC0xMDMsMTU4KSkgKSk7XHJcbiAgICAgICAgICAgIFJxaS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuMiwyNTUpLGNjLm1vdmVUbygwLjIsY2MudjIoMTMzLDE2MCkpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDEzMywxNzApKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDEzMywxNjApKSApKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgQ3FpLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zcGF3bihjYy5mYWRlVG8oMC4yLDI1NSksY2MubW92ZVRvKDAuMixjYy52MigyMCw5NikpKSxjYy5tb3ZlVG8oMC4yLGNjLnYyKDIwLDEwNikpLGNjLm1vdmVUbygwLjIsY2MudjIoMjAsOTYpKSApKTtcclxuICAgICAgICAgICAgICAgIEx0YW9odWEucnVuQWN0aW9uKCBjYy5zZXF1ZW5jZShjYy5yZXBlYXQoIGNjLnNlcXVlbmNlKGNjLnJvdGF0ZVRvKDAuMywxMCksY2Mucm90YXRlVG8oMC4zLDApKSwyICksdGhGaW5pc2hlZCkpO1xyXG4gICAgICAgICAgICAgICAgUnRhb2h1YS5ydW5BY3Rpb24oIGNjLnJlcGVhdCggY2Muc2VxdWVuY2UoY2Mucm90YXRlVG8oMC4zLC0xMCksY2Mucm90YXRlVG8oMC4zLDApKSwyICkpO1xyXG4gICAgICAgICAgICB9LDUwMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHRoRmluaXNoZWQgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBiZy5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgIExxaS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgIFJxaS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgIENxaS5ydW5BY3Rpb24oY2MuZmFkZVRvKDAuMiwwKSk7XHJcbiAgICAgICAgICAgIFJ0YW9odWEucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICBMdGFvaHVhLnJ1bkFjdGlvbihjYy5mYWRlVG8oMC4yLDApKTtcclxuICAgICAgICAgICAgdGl0bGUucnVuQWN0aW9uKGNjLmZhZGVUbygwLjIsMCkpO1xyXG4gICAgICAgICAgICBsaXVkdWliYW4ucmVtb3ZlRnJvbVBhcmVudCh0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBiZy5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc3Bhd24oY2MuZmFkZVRvKDAuNCwyNTUpLGNjLnNjYWxlVG8oMC40LDMwLDMwKSksYmdGaW5pc2hlZCApKTtcclxuICAgICAgICB0aXRsZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc2NhbGVUbygwLjIsMiwyKSkpO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG5cclxuICAgICAgICBjYXJkcyA6IGNjLkxhYmVsLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMudG90YWxDYXJkcygpO1xyXG4gICAgfSxcclxuICAgIHRvdGFsQ2FyZHMgOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy8gdmFyIGNyZWF0ZSA9IHRoaXMubm9kZS5jaGlsZHJlbjtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMubm9kZSk7XHJcbiAgICAgICAgdmFyIHJlbnNodSA9ICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJyZW5zaHVcIik7XHJcbiAgICAgICAgdmFyIGp1c2h1ID0gIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImp1c2h1XCIpO1xyXG4gICAgICAgIHZhciBnZXRDYXJkID0gIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImNhcmRzXCIpO1xyXG4gICAgICAgIC8vdmFyIHJlbnNodSA9IGNyZWF0ZVszXSwganVzaHUgPSBjcmVhdGVbNF0sIGdldENhcmQgPSBjcmVhdGVbNl07XHJcblxyXG4gICAgICAgIHZhciBycyA9IHJlbnNodS5nZXRDb21wb25lbnQoXCJzaW5nbGVTZWxlY3RcIikuc2VsZWN0ZWRJbmRleDtcclxuICAgICAgICB2YXIganMgPSBqdXNodS5nZXRDb21wb25lbnQoXCJzaW5nbGVTZWxlY3RcIikuc2VsZWN0ZWRJbmRleDtcclxuICAgICAgICB2YXIgZ2MgPSBnZXRDYXJkLmdldENvbXBvbmVudChcInNpbmdsZVNlbGVjdFwiKS5zZWxlY3RlZEluZGV4O1xyXG5cclxuICAgICAgICB2YXIgUiA9IDEsIEogPSAxLCBHID0gMTtcclxuICAgICAgICBzd2l0Y2gocnMpe1xyXG4gICAgICAgICAgICBjYXNlIDA6IFIgPSAxO2JyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDE6IFIgPSAyO2JyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDI6IFIgPSAzO2JyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM6IFIgPSA0O2JyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzd2l0Y2goanMpe1xyXG4gICAgICAgICAgICBjYXNlIDA6IEogPSAxO2JyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDE6IEogPSAyO2JyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDI6IEogPSAzO2JyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzd2l0Y2goZ2Mpe1xyXG4gICAgICAgICAgICBjYXNlIDA6IEcgPSAxO2JyZWFrOyAvLyBBQeWItlxyXG4gICAgICAgICAgICBkZWZhdWx0OkcgPSAwO2JyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNhcmRzLnN0cmluZyA9IFIrSjtcclxuICAgICAgICAvL3RoaXMuY2FyZHMuc3RyaW5nID0gRyA/IChSK0opOihSK0opKihSKzMpOyAgLy8gKFIrSinooajnpLrmr4/kuKrkurropoHlh7rnmoTmiL/ljaHph4/vvJsoUiszKeihqOekuuS4gOWFseacieWkmuWwkeS6uu+8jCAgICBcclxuICAgIH1cclxufSk7XHJcbiIsIi8vIOeJjOiDjOW9seWIl+ihqCBjb21wb25lbnRcclxuLy8g5Y+v5Lul5pi+56S644CB6ZqQ6JeP54mM6IOM5b2x5YiX6KGoXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgY2FyZHNCYWNrTGF5b3V0OiBjYy5MYXlvdXQsXHJcbiAgICAgICAgY2FyZHNCYWNrTGlzdDogW2NjLlNwcml0ZV0sXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDku6XliqjnlLvnmoTmlrnlvI/mmL7npLrniYzog4zlvbFcclxuICAgIHNob3dQbGF5Q2FyZEJhY2tzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuaGlkZUNhcmRCYWNrcygpO1xyXG4gICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICBsZXQgaW50ZXJ2YWwgPSAwLjA1O1xyXG4gICAgICB2YXIgc3RhcnRUaW1lID0gMDtcclxuICAgICAgdGhpcy5jYXJkc0JhY2tMaXN0LmZvckVhY2goZnVuY3Rpb24oY2FyZEJhY2spe1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgY2FyZEJhY2subm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH0sIHN0YXJ0VGltZSk7XHJcbiAgICAgICAgc3RhcnRUaW1lID0gc3RhcnRUaW1lICsgaW50ZXJ2YWw7XHJcbiAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOmakOiXj+aYvuekuueJjOiDjOW9sVxyXG4gICAgaGlkZUNhcmRCYWNrczogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmNhcmRzQmFja0xpc3QuZm9yRWFjaChmdW5jdGlvbihjYXJkQmFjayl7XHJcbiAgICAgICAgY2FyZEJhY2subm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIC8q54mM6Iqx6ImyKi9cclxuICAgICAgICBzcGFkZXNJbWFnZXM6W2NjLlNwcml0ZUZyYW1lXSxcclxuICAgICAgICBoZWFydHNJbWFnZXM6W2NjLlNwcml0ZUZyYW1lXSxcclxuICAgICAgICBjbHViSW1hZ2VzOltjYy5TcHJpdGVGcmFtZV0sXHJcbiAgICAgICAgZGlhbW9uZEltYWdlczpbY2MuU3ByaXRlRnJhbWVdLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBsYWJlbE1zZzpjYy5MYWJlbCxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNldFRleHQ6ZnVuY3Rpb24odGV4dCkge1xyXG4gICAgICAgIHRoaXMubGFiZWxNc2cuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0ZXh0O1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0FjdGlvbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHRleHQgPSB0aGlzLmxhYmVsTXNnLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nO1xyXG4gICAgICAgIHRoaXMub25TZWxlY3RBY3Rpb24odGV4dCk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uU2VsZWN0QWN0aW9uOmZ1bmN0aW9uKG1zZykge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xyXG5cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIHBob25lRWRpdEJveDpjYy5FZGl0Qm94LFxyXG4gICAgICAgIHd4RWRpdEJveDpjYy5FZGl0Qm94LFxyXG4gICAgICAgIGFsZXJ0OmNjLlByZWZhYixcclxuICAgICAgICBjYW52YXM6Y2MuTm9kZSxcclxuICAgICAgICBfdXNlcklkOm51bGwsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyU29ja2V0RXZlbnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgIF9yZWdpc3RlclNvY2tldEV2ZW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZU9uQ2hhbmdlSW5mbywgdGhpcy5fUmVjZWl2ZUNoYW5nZUluZm8sIHRoaXMpO1xyXG4gICAgfSxcclxuICAgIF9SZWNlaXZlQ2hhbmdlSW5mbyA6ZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAgIHZhciBjaGFuZ2VkUm93cyA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgdmFyIG1zZyA9ICcnO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coY2hhbmdlZFJvd3MpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMzhcIik7XHJcbiAgICAgICAgaWYoY2hhbmdlZFJvd3Mpe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuabtOaUueaIkOWKn1wiO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBtc2cgPSBcIuS7iuWkqeW3sue7j+abtOaWsOi/h+S6hu+8jOivt+aYjuWkqeWGjeabtOaWsFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFsZXJ0TXNnKG1zZyk7XHJcbiAgICB9LFxyXG4gICAgY2xpY2tBY3Rpb24gOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIHd4ID0gdGhpcy53eEVkaXRCb3guc3RyaW5nO1xyXG4gICAgICAgIHZhciBwaG9uZSA9IHRoaXMucGhvbmVFZGl0Qm94LnN0cmluZztcclxuICAgICAgICB2YXIgaW5mbyA9IHt9O1xyXG4gICAgICAgIHZhciBtc2cgPSAnJztcclxuICAgICAgICBpZighd3ggJiYgIXBob25lKXtcclxuICAgICAgICAgICAgbXNnID0gXCLor7floavlhpnlvq7kv6Hlj7flkozmiYvmnLrlj7dcIjtcclxuICAgICAgICAgICAgcGhvbmUgPSBcIlwiO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TXNnKG1zZyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoICEoLyheWzEtOV1cXGQqJCkvLnRlc3QocGhvbmUpKSApe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuaCqOi+k+WFpeeahOaJi+acuuWPt+eggeagvOW8j+S4jeWvue+8jOivt+mHjeaWsOi+k+WFpVwiO1xyXG4gICAgICAgICAgICBwaG9uZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiggcGhvbmUubGVuZ3RoICE9MTEgKXtcclxuICAgICAgICAgICAgbXNnID0gXCLmgqjovpPlhaXnmoTmiYvmnLrlj7fnoIHkuI3lpJ8xMeS9je+8jOivt+mHjeaWsOi+k+WFpVwiO1xyXG4gICAgICAgICAgICBwaG9uZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNc2cobXNnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZighKC8oXlsxLTlhLXpBLVpdXFxkKiQpLy50ZXN0KHd4KSkgKXtcclxuICAgICAgICAgICAgbXNnID0gXCLmgqjovpPlhaXnmoTlvq7kv6Hlj7fmoLzlvI/kuI3lr7nvvIzor7fph43mlrDovpPlhaVcIjtcclxuICAgICAgICAgICAgd3ggPSBcIlwiO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TXNnKG1zZyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoIHd4Lmxlbmd0aDw2IHx8IHd4Lmxlbmd0aD4yMCApe1xyXG4gICAgICAgICAgICBtc2cgPSBcIuaCqOi+k+WFpeeahOW+ruS/oeWPt+agvOW8j+i2heWHuuiMg+WbtO+8jOivt+i+k+WFpTZ+MjDkvY3nmoTlvq7kv6Hlj7dcIjtcclxuICAgICAgICAgICAgd3ggPSBcIlwiO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TXNnKG1zZyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaW5mby53eCA9IHd4O1xyXG4gICAgICAgIGluZm8ucGhvbmUgPSBwaG9uZTtcclxuICAgICAgICBTb2NrZXQuc2VuZENoYW5nZUluZm8odGhpcy5fdXNlcklkLGluZm8pO1xyXG4gICAgfSxcclxuXHJcbiAgICBhbGVydE1zZzogZnVuY3Rpb24obXNnKXtcclxuICAgICAgICB2YXIgYWxlcnQgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmFsZXJ0KTtcclxuICAgICAgICB0aGlzLmNhbnZhcy5hZGRDaGlsZChhbGVydCk7XHJcbiAgICAgICAgbGV0IGNvbXAgPSBhbGVydC5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBcclxuICAgICAgICBtUHRpdGxlOmNjLkxhYmVsLFxyXG4gICAgICAgIF9jYXJkczpbXSxcclxuICAgICAgICByZW5zaHVTZWxlY3Q6Y2MuTm9kZSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaHMgPSAzO1xyXG4gICAgICAgIHZhciBkcyA9IDU7XHJcbiAgICAgICAgaWYoY2Muc2V0KXtcclxuICAgICAgICAgICAgaHMgPSBjYy5zZXQuc2V0dGluZzdbMF07XHJcbiAgICAgICAgICAgIGRzID0gY2Muc2V0LnNldHRpbmc3WzFdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9jYXJkcyA9IFtocyxkc107XHJcbiAgICAgICAgIHRoaXMubXAoaHMsZHMpO1xyXG4gICAgfSxcclxuICAgIGNoYW5nZTogZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgc2VsZWN0ZWRJbmRleCA9IHRoaXMucmVuc2h1U2VsZWN0LmdldENvbXBvbmVudCgnc2luZ2xlU2VsZWN0Jykuc2VsZWN0ZWRJbmRleDtcclxuICAgICAgICB2YXIgaHMgPSBNYXRoLmNlaWwoIChNYXRoLnJhbmRvbSgpKjQwKS8xMCApOyAgICAvL+iOt+WPluS4gOS4qjF+NOeahOaVsOWtl++8jOS7o+ihqOiKseiJslxyXG4gICAgICAgIHZhciBkcyA9IE1hdGguY2VpbCggKE1hdGgucmFuZG9tKCkqMTMwKS8xMCApOyAgIC8v6I635Y+W5LiA5LiqMX4xM+eahOaVsOWtl++8jOS7o+ihqOeCueaVsFxyXG4gICAgICAgIHZhciBjYXJkID0gW2hzLGRzXTtcclxuICAgICAgICB0aGlzLl9jYXJkcyA9IGNhcmQ7XHJcbiAgICAgICAgdGhpcy5tcChocyxkcyxzZWxlY3RlZEluZGV4KVxyXG4gICAgfSxcclxuICAgIG1wOiBmdW5jdGlvbihoLGQsaW5kZXgpe1xyXG4gICAgICAgIHZhciBtYSA9IFwi5Y2V56CBXCI7XHJcbiAgICAgICAgdmFyIGhzID0gWyBcIuaWueWdl1wiLFwi5qKF6IqxXCIsXCLnuqLmoYNcIixcIum7keahg1wiXTtcclxuICAgICAgICB2YXIgZHMgPSBbIFwiMVwiLFwiMlwiLFwiM1wiLFwiNFwiLFwiNVwiLFwiNlwiLFwiN1wiLFwiOFwiLFwiOVwiLFwiMTBcIixcIkpcIixcIlFcIixcIktcIiBdO1xyXG4gICAgICAgIGlmKGluZGV4KXsgIFxyXG4gICAgICAgICAgICB2YXIgZGVmYXVsdE1hID0gNDtcclxuICAgICAgICAgICAgaWYoaCA+PSAoZGVmYXVsdE1hLWluZGV4KzEpICl7XHJcbiAgICAgICAgICAgICAgICBtYSA9IFwi5Y+M56CBXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tUHRpdGxlLnN0cmluZyA9IGhzW2gtMV0rZHNbZC0xXSttYTtcclxuICAgfSxcclxufSk7XHJcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgc2VsZWN0ZWRJbmRleCA6IDAsXHJcbiAgICAgICAgc2VsZWN0ZWROb2RlIDogY2MuTm9kZSAgXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKGUsZGF0YSkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhdGhpcy5zZWxlY3RlZDtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0aGlzLnNlbGVjdGVkO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IHRoaXMuc2VsZWN0ZWQ/MDpudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJ2YXIgc29ja2V0ID0gcmVxdWlyZShcInNvY2tldFwiKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBvcHRpb246e1xyXG4gICAgICAgICAgICBkZWZhdWx0OltdLFxyXG4gICAgICAgICAgICB0eXBlOmNjLk5vZGVcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcbiAgICBcclxuICAgIGNsaWNrQnRuY2hvdWppYW5nOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5vcHRpb24ubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIHRoaXMub3B0aW9uW2ldLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5fdGlzaGkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjaG91amlhbmdfYmdcIikuZ2V0Q2hpbGRCeU5hbWUoXCJ0aXNoaVwiKTtcclxuICAgICAgICB0aGlzLl9jYXJkX251bSA9IGNjLmZpbmQoXCJDYW52YXMvdXNlci9zaG9wX2JnL2NhcmRfbnVtXCIpO1xyXG4gICAgICAgIHZhciBjb21wID0gdGhpcy5fY2FyZF9udW0uZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGlmKGluZGV4ID09IDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uW2luZGV4XS5vcGFjaXR5ID0gMTI4O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uW3RoaXMub3B0aW9uLmxlbmd0aC0xXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYoaW5kZXggPT0gMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXhdLm9wYWNpdHkgPSAxMjg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXggLSAxXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXhdLm9wYWNpdHkgPSAxMjg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXgtMV0ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGluZGV4ICsrO1xyXG4gICAgICAgICAgICAgICAgaWYoaW5kZXggPT0gdGhpcy5vcHRpb24ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgaWYoY29tcC5zdHJpbmcgPCAyMCkge1xyXG4gICAgICAgICAgICB0aGlzLl90aXNoaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAvL2Nob3VqaWFuZ1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMuY2FsbGJhY2ssMC4wNSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLmNhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5vcHRpb24ubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baV0ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBpID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baV0ub3BhY2l0eSA9IDEyODtcclxuICAgICAgICAgICAgfSwzLDAsMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8qKipcclxuICAgIGNsaWNrQnRuQ29tZmlybTpmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl90aXNoaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL3RoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICAvLyoqKipcclxuXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICBcclxuICAgICAgICBcclxuICAgIH0sXHJcbiAgICBsb2FkQ2FyZFNwcml0ZUZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdGhpcy5fbG9hZENhcmRGcmFtZShjYXJkTmFtZSwgY2FsbGJhY2spO1xyXG4gICAgfSxcclxuICAgIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lKSB7XHJcbiAgICAgICAgdmFyIGNhcmROYW1lID0gY2FyZFNob3J0TmFtZTtcclxuICAgICAgICBpZiAoIWNhcmROYW1lLnN0YXJ0c1dpdGgoXCJwdWJsaWMtcGljLWNhcmQtcG9rZXJcIikpIHtcclxuICAgICAgICAgIGNhcmROYW1lID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNhcmROYW1lO1xyXG4gICAgfSxcclxuICAgIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgY2MuYXNzZXJ0KGNhbGxiYWNrKTtcclxuICAgICAgICBjYy5sb2FkZXIubG9hZFJlcyhcInBsYXkvaGFsbC9wdWJsaWMvYWxsX2VmZmVjdF90dHdfbWFpblwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcclxuICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZXJyKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhcmROYW1lID0gdGhpcy5fY2FyZEZ1bGxOYW1lKGNhcmROYW1lKTtcclxuICAgICAgICAgICAgdmFyIGZyYW1lID0gYXRsYXMuZ2V0U3ByaXRlRnJhbWUoY2FyZE5hbWUpO1xyXG4gICAgICAgICAgICBjYWxsYmFjayhmcmFtZSk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgfSxcclxuICAgIHRlc3Q6ZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgXHJcbiAgICB9LFxyXG4gICAgXHJcbn0pO1xyXG4iLCIoZnVuY3Rpb24gKG1haW4pIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhcnNlIG9yIGZvcm1hdCBkYXRlc1xyXG4gICAqIEBjbGFzcyBmZWNoYVxyXG4gICAqL1xyXG4gIHZhciBmZWNoYSA9IHt9O1xyXG4gIHZhciB0b2tlbiA9IC9kezEsNH18TXsxLDR9fFlZKD86WVkpP3xTezEsM318RG98Wlp8KFtIaE1zRG1dKVxcMT98W2FBXXxcIlteXCJdKlwifCdbXiddKicvZztcclxuICB2YXIgdHdvRGlnaXRzID0gL1xcZFxcZD8vO1xyXG4gIHZhciB0aHJlZURpZ2l0cyA9IC9cXGR7M30vO1xyXG4gIHZhciBmb3VyRGlnaXRzID0gL1xcZHs0fS87XHJcbiAgdmFyIHdvcmQgPSAvWzAtOV0qWydhLXpcXHUwMEEwLVxcdTA1RkZcXHUwNzAwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdK3xbXFx1MDYwMC1cXHUwNkZGXFwvXSsoXFxzKj9bXFx1MDYwMC1cXHUwNkZGXSspezEsMn0vaTtcclxuICB2YXIgbGl0ZXJhbCA9IC9cXFsoW15dKj8pXFxdL2dtO1xyXG4gIHZhciBub29wID0gZnVuY3Rpb24gKCkge1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHNob3J0ZW4oYXJyLCBzTGVuKSB7XHJcbiAgICB2YXIgbmV3QXJyID0gW107XHJcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYXJyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgIG5ld0Fyci5wdXNoKGFycltpXS5zdWJzdHIoMCwgc0xlbikpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ld0FycjtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG1vbnRoVXBkYXRlKGFyck5hbWUpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgdiwgaTE4bikge1xyXG4gICAgICB2YXIgaW5kZXggPSBpMThuW2Fyck5hbWVdLmluZGV4T2Yodi5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHYuc3Vic3RyKDEpLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICBpZiAofmluZGV4KSB7XHJcbiAgICAgICAgZC5tb250aCA9IGluZGV4O1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcGFkKHZhbCwgbGVuKSB7XHJcbiAgICB2YWwgPSBTdHJpbmcodmFsKTtcclxuICAgIGxlbiA9IGxlbiB8fCAyO1xyXG4gICAgd2hpbGUgKHZhbC5sZW5ndGggPCBsZW4pIHtcclxuICAgICAgdmFsID0gJzAnICsgdmFsO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbDtcclxuICB9XHJcblxyXG4gIHZhciBkYXlOYW1lcyA9IFsnU3VuZGF5JywgJ01vbmRheScsICdUdWVzZGF5JywgJ1dlZG5lc2RheScsICdUaHVyc2RheScsICdGcmlkYXknLCAnU2F0dXJkYXknXTtcclxuICB2YXIgbW9udGhOYW1lcyA9IFsnSmFudWFyeScsICdGZWJydWFyeScsICdNYXJjaCcsICdBcHJpbCcsICdNYXknLCAnSnVuZScsICdKdWx5JywgJ0F1Z3VzdCcsICdTZXB0ZW1iZXInLCAnT2N0b2JlcicsICdOb3ZlbWJlcicsICdEZWNlbWJlciddO1xyXG4gIHZhciBtb250aE5hbWVzU2hvcnQgPSBzaG9ydGVuKG1vbnRoTmFtZXMsIDMpO1xyXG4gIHZhciBkYXlOYW1lc1Nob3J0ID0gc2hvcnRlbihkYXlOYW1lcywgMyk7XHJcbiAgZmVjaGEuaTE4biA9IHtcclxuICAgIGRheU5hbWVzU2hvcnQ6IGRheU5hbWVzU2hvcnQsXHJcbiAgICBkYXlOYW1lczogZGF5TmFtZXMsXHJcbiAgICBtb250aE5hbWVzU2hvcnQ6IG1vbnRoTmFtZXNTaG9ydCxcclxuICAgIG1vbnRoTmFtZXM6IG1vbnRoTmFtZXMsXHJcbiAgICBhbVBtOiBbJ2FtJywgJ3BtJ10sXHJcbiAgICBEb0ZuOiBmdW5jdGlvbiBEb0ZuKEQpIHtcclxuICAgICAgcmV0dXJuIEQgKyBbJ3RoJywgJ3N0JywgJ25kJywgJ3JkJ11bRCAlIDEwID4gMyA/IDAgOiAoRCAtIEQgJSAxMCAhPT0gMTApICogRCAlIDEwXTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICB2YXIgZm9ybWF0RmxhZ3MgPSB7XHJcbiAgICBEOiBmdW5jdGlvbihkYXRlT2JqKSB7XHJcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldERhdGUoKTtcclxuICAgIH0sXHJcbiAgICBERDogZnVuY3Rpb24oZGF0ZU9iaikge1xyXG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0RGF0ZSgpKTtcclxuICAgIH0sXHJcbiAgICBEbzogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xyXG4gICAgICByZXR1cm4gaTE4bi5Eb0ZuKGRhdGVPYmouZ2V0RGF0ZSgpKTtcclxuICAgIH0sXHJcbiAgICBkOiBmdW5jdGlvbihkYXRlT2JqKSB7XHJcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldERheSgpO1xyXG4gICAgfSxcclxuICAgIGRkOiBmdW5jdGlvbihkYXRlT2JqKSB7XHJcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXREYXkoKSk7XHJcbiAgICB9LFxyXG4gICAgZGRkOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XHJcbiAgICAgIHJldHVybiBpMThuLmRheU5hbWVzU2hvcnRbZGF0ZU9iai5nZXREYXkoKV07XHJcbiAgICB9LFxyXG4gICAgZGRkZDogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xyXG4gICAgICByZXR1cm4gaTE4bi5kYXlOYW1lc1tkYXRlT2JqLmdldERheSgpXTtcclxuICAgIH0sXHJcbiAgICBNOiBmdW5jdGlvbihkYXRlT2JqKSB7XHJcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldE1vbnRoKCkgKyAxO1xyXG4gICAgfSxcclxuICAgIE1NOiBmdW5jdGlvbihkYXRlT2JqKSB7XHJcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRNb250aCgpICsgMSk7XHJcbiAgICB9LFxyXG4gICAgTU1NOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XHJcbiAgICAgIHJldHVybiBpMThuLm1vbnRoTmFtZXNTaG9ydFtkYXRlT2JqLmdldE1vbnRoKCldO1xyXG4gICAgfSxcclxuICAgIE1NTU06IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcclxuICAgICAgcmV0dXJuIGkxOG4ubW9udGhOYW1lc1tkYXRlT2JqLmdldE1vbnRoKCldO1xyXG4gICAgfSxcclxuICAgIFlZOiBmdW5jdGlvbihkYXRlT2JqKSB7XHJcbiAgICAgIHJldHVybiBTdHJpbmcoZGF0ZU9iai5nZXRGdWxsWWVhcigpKS5zdWJzdHIoMik7XHJcbiAgICB9LFxyXG4gICAgWVlZWTogZnVuY3Rpb24oZGF0ZU9iaikge1xyXG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRGdWxsWWVhcigpO1xyXG4gICAgfSxcclxuICAgIGg6IGZ1bmN0aW9uKGRhdGVPYmopIHtcclxuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0SG91cnMoKSAlIDEyIHx8IDEyO1xyXG4gICAgfSxcclxuICAgIGhoOiBmdW5jdGlvbihkYXRlT2JqKSB7XHJcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRIb3VycygpICUgMTIgfHwgMTIpO1xyXG4gICAgfSxcclxuICAgIEg6IGZ1bmN0aW9uKGRhdGVPYmopIHtcclxuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0SG91cnMoKTtcclxuICAgIH0sXHJcbiAgICBISDogZnVuY3Rpb24oZGF0ZU9iaikge1xyXG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0SG91cnMoKSk7XHJcbiAgICB9LFxyXG4gICAgbTogZnVuY3Rpb24oZGF0ZU9iaikge1xyXG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRNaW51dGVzKCk7XHJcbiAgICB9LFxyXG4gICAgbW06IGZ1bmN0aW9uKGRhdGVPYmopIHtcclxuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldE1pbnV0ZXMoKSk7XHJcbiAgICB9LFxyXG4gICAgczogZnVuY3Rpb24oZGF0ZU9iaikge1xyXG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRTZWNvbmRzKCk7XHJcbiAgICB9LFxyXG4gICAgc3M6IGZ1bmN0aW9uKGRhdGVPYmopIHtcclxuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldFNlY29uZHMoKSk7XHJcbiAgICB9LFxyXG4gICAgUzogZnVuY3Rpb24oZGF0ZU9iaikge1xyXG4gICAgICByZXR1cm4gTWF0aC5yb3VuZChkYXRlT2JqLmdldE1pbGxpc2Vjb25kcygpIC8gMTAwKTtcclxuICAgIH0sXHJcbiAgICBTUzogZnVuY3Rpb24oZGF0ZU9iaikge1xyXG4gICAgICByZXR1cm4gcGFkKE1hdGgucm91bmQoZGF0ZU9iai5nZXRNaWxsaXNlY29uZHMoKSAvIDEwKSwgMik7XHJcbiAgICB9LFxyXG4gICAgU1NTOiBmdW5jdGlvbihkYXRlT2JqKSB7XHJcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRNaWxsaXNlY29uZHMoKSwgMyk7XHJcbiAgICB9LFxyXG4gICAgYTogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xyXG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRIb3VycygpIDwgMTIgPyBpMThuLmFtUG1bMF0gOiBpMThuLmFtUG1bMV07XHJcbiAgICB9LFxyXG4gICAgQTogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xyXG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRIb3VycygpIDwgMTIgPyBpMThuLmFtUG1bMF0udG9VcHBlckNhc2UoKSA6IGkxOG4uYW1QbVsxXS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgfSxcclxuICAgIFpaOiBmdW5jdGlvbihkYXRlT2JqKSB7XHJcbiAgICAgIHZhciBvID0gZGF0ZU9iai5nZXRUaW1lem9uZU9mZnNldCgpO1xyXG4gICAgICByZXR1cm4gKG8gPiAwID8gJy0nIDogJysnKSArIHBhZChNYXRoLmZsb29yKE1hdGguYWJzKG8pIC8gNjApICogMTAwICsgTWF0aC5hYnMobykgJSA2MCwgNCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgdmFyIHBhcnNlRmxhZ3MgPSB7XHJcbiAgICBEOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xyXG4gICAgICBkLmRheSA9IHY7XHJcbiAgICB9XSxcclxuICAgIERvOiBbbmV3IFJlZ0V4cCh0d29EaWdpdHMuc291cmNlICsgd29yZC5zb3VyY2UpLCBmdW5jdGlvbiAoZCwgdikge1xyXG4gICAgICBkLmRheSA9IHBhcnNlSW50KHYsIDEwKTtcclxuICAgIH1dLFxyXG4gICAgTTogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcclxuICAgICAgZC5tb250aCA9IHYgLSAxO1xyXG4gICAgfV0sXHJcbiAgICBZWTogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcclxuICAgICAgdmFyIGRhID0gbmV3IERhdGUoKSwgY2VudCA9ICsoJycgKyBkYS5nZXRGdWxsWWVhcigpKS5zdWJzdHIoMCwgMik7XHJcbiAgICAgIGQueWVhciA9ICcnICsgKHYgPiA2OCA/IGNlbnQgLSAxIDogY2VudCkgKyB2O1xyXG4gICAgfV0sXHJcbiAgICBoOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xyXG4gICAgICBkLmhvdXIgPSB2O1xyXG4gICAgfV0sXHJcbiAgICBtOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xyXG4gICAgICBkLm1pbnV0ZSA9IHY7XHJcbiAgICB9XSxcclxuICAgIHM6IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XHJcbiAgICAgIGQuc2Vjb25kID0gdjtcclxuICAgIH1dLFxyXG4gICAgWVlZWTogW2ZvdXJEaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XHJcbiAgICAgIGQueWVhciA9IHY7XHJcbiAgICB9XSxcclxuICAgIFM6IFsvXFxkLywgZnVuY3Rpb24gKGQsIHYpIHtcclxuICAgICAgZC5taWxsaXNlY29uZCA9IHYgKiAxMDA7XHJcbiAgICB9XSxcclxuICAgIFNTOiBbL1xcZHsyfS8sIGZ1bmN0aW9uIChkLCB2KSB7XHJcbiAgICAgIGQubWlsbGlzZWNvbmQgPSB2ICogMTA7XHJcbiAgICB9XSxcclxuICAgIFNTUzogW3RocmVlRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xyXG4gICAgICBkLm1pbGxpc2Vjb25kID0gdjtcclxuICAgIH1dLFxyXG4gICAgZDogW3R3b0RpZ2l0cywgbm9vcF0sXHJcbiAgICBkZGQ6IFt3b3JkLCBub29wXSxcclxuICAgIE1NTTogW3dvcmQsIG1vbnRoVXBkYXRlKCdtb250aE5hbWVzU2hvcnQnKV0sXHJcbiAgICBNTU1NOiBbd29yZCwgbW9udGhVcGRhdGUoJ21vbnRoTmFtZXMnKV0sXHJcbiAgICBhOiBbd29yZCwgZnVuY3Rpb24gKGQsIHYsIGkxOG4pIHtcclxuICAgICAgdmFyIHZhbCA9IHYudG9Mb3dlckNhc2UoKTtcclxuICAgICAgaWYgKHZhbCA9PT0gaTE4bi5hbVBtWzBdKSB7XHJcbiAgICAgICAgZC5pc1BtID0gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSBpZiAodmFsID09PSBpMThuLmFtUG1bMV0pIHtcclxuICAgICAgICBkLmlzUG0gPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XSxcclxuICAgIFpaOiBbLyhbXFwrXFwtXVxcZFxcZDo/XFxkXFxkfFopLywgZnVuY3Rpb24gKGQsIHYpIHtcclxuICAgICAgaWYgKHYgPT09ICdaJykgdiA9ICcrMDA6MDAnO1xyXG4gICAgICB2YXIgcGFydHMgPSAodiArICcnKS5tYXRjaCgvKFtcXCtcXC1dfFxcZFxcZCkvZ2kpLCBtaW51dGVzO1xyXG5cclxuICAgICAgaWYgKHBhcnRzKSB7XHJcbiAgICAgICAgbWludXRlcyA9ICsocGFydHNbMV0gKiA2MCkgKyBwYXJzZUludChwYXJ0c1syXSwgMTApO1xyXG4gICAgICAgIGQudGltZXpvbmVPZmZzZXQgPSBwYXJ0c1swXSA9PT0gJysnID8gbWludXRlcyA6IC1taW51dGVzO1xyXG4gICAgICB9XHJcbiAgICB9XVxyXG4gIH07XHJcbiAgcGFyc2VGbGFncy5kZCA9IHBhcnNlRmxhZ3MuZDtcclxuICBwYXJzZUZsYWdzLmRkZGQgPSBwYXJzZUZsYWdzLmRkZDtcclxuICBwYXJzZUZsYWdzLkREID0gcGFyc2VGbGFncy5EO1xyXG4gIHBhcnNlRmxhZ3MubW0gPSBwYXJzZUZsYWdzLm07XHJcbiAgcGFyc2VGbGFncy5oaCA9IHBhcnNlRmxhZ3MuSCA9IHBhcnNlRmxhZ3MuSEggPSBwYXJzZUZsYWdzLmg7XHJcbiAgcGFyc2VGbGFncy5NTSA9IHBhcnNlRmxhZ3MuTTtcclxuICBwYXJzZUZsYWdzLnNzID0gcGFyc2VGbGFncy5zO1xyXG4gIHBhcnNlRmxhZ3MuQSA9IHBhcnNlRmxhZ3MuYTtcclxuXHJcblxyXG4gIC8vIFNvbWUgY29tbW9uIGZvcm1hdCBzdHJpbmdzXHJcbiAgZmVjaGEubWFza3MgPSB7XHJcbiAgICBkZWZhdWx0OiAnZGRkIE1NTSBERCBZWVlZIEhIOm1tOnNzJyxcclxuICAgIHNob3J0RGF0ZTogJ00vRC9ZWScsXHJcbiAgICBtZWRpdW1EYXRlOiAnTU1NIEQsIFlZWVknLFxyXG4gICAgbG9uZ0RhdGU6ICdNTU1NIEQsIFlZWVknLFxyXG4gICAgZnVsbERhdGU6ICdkZGRkLCBNTU1NIEQsIFlZWVknLFxyXG4gICAgc2hvcnRUaW1lOiAnSEg6bW0nLFxyXG4gICAgbWVkaXVtVGltZTogJ0hIOm1tOnNzJyxcclxuICAgIGxvbmdUaW1lOiAnSEg6bW06c3MuU1NTJ1xyXG4gIH07XHJcblxyXG4gIC8qKipcclxuICAgKiBGb3JtYXQgYSBkYXRlXHJcbiAgICogQG1ldGhvZCBmb3JtYXRcclxuICAgKiBAcGFyYW0ge0RhdGV8bnVtYmVyfSBkYXRlT2JqXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1hc2sgRm9ybWF0IG9mIHRoZSBkYXRlLCBpLmUuICdtbS1kZC15eScgb3IgJ3Nob3J0RGF0ZSdcclxuICAgKi9cclxuICBmZWNoYS5mb3JtYXQgPSBmdW5jdGlvbiAoZGF0ZU9iaiwgbWFzaywgaTE4blNldHRpbmdzKSB7XHJcbiAgICB2YXIgaTE4biA9IGkxOG5TZXR0aW5ncyB8fCBmZWNoYS5pMThuO1xyXG5cclxuICAgIGlmICh0eXBlb2YgZGF0ZU9iaiA9PT0gJ251bWJlcicpIHtcclxuICAgICAgZGF0ZU9iaiA9IG5ldyBEYXRlKGRhdGVPYmopO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZGF0ZU9iaikgIT09ICdbb2JqZWN0IERhdGVdJyB8fCBpc05hTihkYXRlT2JqLmdldFRpbWUoKSkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIERhdGUgaW4gZmVjaGEuZm9ybWF0Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgbWFzayA9IGZlY2hhLm1hc2tzW21hc2tdIHx8IG1hc2sgfHwgZmVjaGEubWFza3NbJ2RlZmF1bHQnXTtcclxuXHJcbiAgICB2YXIgbGl0ZXJhbHMgPSBbXTtcclxuXHJcbiAgICAvLyBNYWtlIGxpdGVyYWxzIGluYWN0aXZlIGJ5IHJlcGxhY2luZyB0aGVtIHdpdGggPz9cclxuICAgIG1hc2sgPSBtYXNrLnJlcGxhY2UobGl0ZXJhbCwgZnVuY3Rpb24oJDAsICQxKSB7XHJcbiAgICAgIGxpdGVyYWxzLnB1c2goJDEpO1xyXG4gICAgICByZXR1cm4gJz8/JztcclxuICAgIH0pO1xyXG4gICAgLy8gQXBwbHkgZm9ybWF0dGluZyBydWxlc1xyXG4gICAgbWFzayA9IG1hc2sucmVwbGFjZSh0b2tlbiwgZnVuY3Rpb24gKCQwKSB7XHJcbiAgICAgIHJldHVybiAkMCBpbiBmb3JtYXRGbGFncyA/IGZvcm1hdEZsYWdzWyQwXShkYXRlT2JqLCBpMThuKSA6ICQwLnNsaWNlKDEsICQwLmxlbmd0aCAtIDEpO1xyXG4gICAgfSk7XHJcbiAgICAvLyBJbmxpbmUgbGl0ZXJhbCB2YWx1ZXMgYmFjayBpbnRvIHRoZSBmb3JtYXR0ZWQgdmFsdWVcclxuICAgIHJldHVybiBtYXNrLnJlcGxhY2UoL1xcP1xcPy9nLCBmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuIGxpdGVyYWxzLnNoaWZ0KCk7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICAvKipcclxuICAgKiBQYXJzZSBhIGRhdGUgc3RyaW5nIGludG8gYW4gb2JqZWN0LCBjaGFuZ2VzIC0gaW50byAvXHJcbiAgICogQG1ldGhvZCBwYXJzZVxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBkYXRlU3RyIERhdGUgc3RyaW5nXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZvcm1hdCBEYXRlIHBhcnNlIGZvcm1hdFxyXG4gICAqIEByZXR1cm5zIHtEYXRlfGJvb2xlYW59XHJcbiAgICovXHJcbiAgZmVjaGEucGFyc2UgPSBmdW5jdGlvbiAoZGF0ZVN0ciwgZm9ybWF0LCBpMThuU2V0dGluZ3MpIHtcclxuICAgIHZhciBpMThuID0gaTE4blNldHRpbmdzIHx8IGZlY2hhLmkxOG47XHJcblxyXG4gICAgaWYgKHR5cGVvZiBmb3JtYXQgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBmb3JtYXQgaW4gZmVjaGEucGFyc2UnKTtcclxuICAgIH1cclxuXHJcbiAgICBmb3JtYXQgPSBmZWNoYS5tYXNrc1tmb3JtYXRdIHx8IGZvcm1hdDtcclxuXHJcbiAgICAvLyBBdm9pZCByZWd1bGFyIGV4cHJlc3Npb24gZGVuaWFsIG9mIHNlcnZpY2UsIGZhaWwgZWFybHkgZm9yIHJlYWxseSBsb25nIHN0cmluZ3NcclxuICAgIC8vIGh0dHBzOi8vd3d3Lm93YXNwLm9yZy9pbmRleC5waHAvUmVndWxhcl9leHByZXNzaW9uX0RlbmlhbF9vZl9TZXJ2aWNlXy1fUmVEb1NcclxuICAgIGlmIChkYXRlU3RyLmxlbmd0aCA+IDEwMDApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBpc1ZhbGlkID0gdHJ1ZTtcclxuICAgIHZhciBkYXRlSW5mbyA9IHt9O1xyXG4gICAgZm9ybWF0LnJlcGxhY2UodG9rZW4sIGZ1bmN0aW9uICgkMCkge1xyXG4gICAgICBpZiAocGFyc2VGbGFnc1skMF0pIHtcclxuICAgICAgICB2YXIgaW5mbyA9IHBhcnNlRmxhZ3NbJDBdO1xyXG4gICAgICAgIHZhciBpbmRleCA9IGRhdGVTdHIuc2VhcmNoKGluZm9bMF0pO1xyXG4gICAgICAgIGlmICghfmluZGV4KSB7XHJcbiAgICAgICAgICBpc1ZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGRhdGVTdHIucmVwbGFjZShpbmZvWzBdLCBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGluZm9bMV0oZGF0ZUluZm8sIHJlc3VsdCwgaTE4bik7XHJcbiAgICAgICAgICAgIGRhdGVTdHIgPSBkYXRlU3RyLnN1YnN0cihpbmRleCArIHJlc3VsdC5sZW5ndGgpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcGFyc2VGbGFnc1skMF0gPyAnJyA6ICQwLnNsaWNlKDEsICQwLmxlbmd0aCAtIDEpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKCFpc1ZhbGlkKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpO1xyXG4gICAgaWYgKGRhdGVJbmZvLmlzUG0gPT09IHRydWUgJiYgZGF0ZUluZm8uaG91ciAhPSBudWxsICYmICtkYXRlSW5mby5ob3VyICE9PSAxMikge1xyXG4gICAgICBkYXRlSW5mby5ob3VyID0gK2RhdGVJbmZvLmhvdXIgKyAxMjtcclxuICAgIH0gZWxzZSBpZiAoZGF0ZUluZm8uaXNQbSA9PT0gZmFsc2UgJiYgK2RhdGVJbmZvLmhvdXIgPT09IDEyKSB7XHJcbiAgICAgIGRhdGVJbmZvLmhvdXIgPSAwO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBkYXRlO1xyXG4gICAgaWYgKGRhdGVJbmZvLnRpbWV6b25lT2Zmc2V0ICE9IG51bGwpIHtcclxuICAgICAgZGF0ZUluZm8ubWludXRlID0gKyhkYXRlSW5mby5taW51dGUgfHwgMCkgLSArZGF0ZUluZm8udGltZXpvbmVPZmZzZXQ7XHJcbiAgICAgIGRhdGUgPSBuZXcgRGF0ZShEYXRlLlVUQyhkYXRlSW5mby55ZWFyIHx8IHRvZGF5LmdldEZ1bGxZZWFyKCksIGRhdGVJbmZvLm1vbnRoIHx8IDAsIGRhdGVJbmZvLmRheSB8fCAxLFxyXG4gICAgICAgIGRhdGVJbmZvLmhvdXIgfHwgMCwgZGF0ZUluZm8ubWludXRlIHx8IDAsIGRhdGVJbmZvLnNlY29uZCB8fCAwLCBkYXRlSW5mby5taWxsaXNlY29uZCB8fCAwKSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkYXRlID0gbmV3IERhdGUoZGF0ZUluZm8ueWVhciB8fCB0b2RheS5nZXRGdWxsWWVhcigpLCBkYXRlSW5mby5tb250aCB8fCAwLCBkYXRlSW5mby5kYXkgfHwgMSxcclxuICAgICAgICBkYXRlSW5mby5ob3VyIHx8IDAsIGRhdGVJbmZvLm1pbnV0ZSB8fCAwLCBkYXRlSW5mby5zZWNvbmQgfHwgMCwgZGF0ZUluZm8ubWlsbGlzZWNvbmQgfHwgMCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGF0ZTtcclxuICB9O1xyXG5cclxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xyXG4gIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmZWNoYTtcclxuICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xyXG4gICAgZGVmaW5lKGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIGZlY2hhO1xyXG4gICAgfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIG1haW4uZmVjaGEgPSBmZWNoYTtcclxuICB9XHJcbn0pKHRoaXMpO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgbWVzc2FnZU5vZGU6Y2MuTm9kZSxcclxuICAgICAgICBwbGF5Tm9kZTpjYy5Ob2RlLFxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dNZXNzYWdlQWxlcnQ6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHZhciBjb21wID0gdGhpcy5tZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcclxuICAgICAgICBjb21wLnBsYXkoJ3BvcCcpO1xyXG4gICAgfSxcclxuXHJcbiAgICBkaXNtaXNzTWVzc2FnZUFsZXJ0OmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzZWxmLm1lc3NhZ2VOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0sMC4zKTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgY3JlYXRlX2FuaW1hOntcclxuICAgICAgICAgICAgdHlwZTpjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICAgICAgZGVmYXVsdDpbXSxcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcbiBcclxuICAgIFxyXG59KTtcclxuIiwidmFyIG1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XHJcbmNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xyXG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcclxuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xyXG5jb25zdCBQbGF5YmFjayA9IHJlcXVpcmUoJ1BsYXliYWNrJyk7XHJcblxyXG5sZXQgaGFsbCA9IGNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcblxyXG4gICAgICAgIC8vcHJvZHVjdE5vZGVzOltjYy5Ob2RlXSxcclxuICAgICAgICBzaG9wQWxlcnROb2RlOmNjLk5vZGUsXHJcbiAgICAgICAgY3JlYXRlTm9kZTpjYy5Ob2RlLFxyXG4gICAgICAgIGpvaW5Ob2RlOmNjLk5vZGUsXHJcbiAgICAgICAgZ2VuZ3hpbjpjYy5Ob2RlLFxyXG4gICAgICAgIGFsZXJ0UHJlZmFiOmNjLlByZWZhYixcclxuICAgICAgICB0c1NpbmdsZVNlbGVjdDpbY2MuTm9kZV0sICAgLy8g5Yib5bu65oi/6Ze05L+h5oGv77yM5Y2V6YCJXHJcbiAgICAgICAgdHNDaGVja1NlY2xlY3Q6W2NjLk5vZGVdLCAgIC8vIOWIm+W7uuaIv+mXtOS/oeaBr++8jOWkjemAiVxyXG4gICAgICAgIHNlbGVjdE1vU2hpOmNjLk5vZGUsICAgICAgICAvLyDliJvlu7rmiL/pl7Tkv6Hmga/vvIzmqKHlvI/vvIjluoTlrrbmqKHlvI/lkozml6DnibnmrorniYzvvIlcclxuICAgICAgICBzZWxlY3RHdWlQYWk6Y2MuTm9kZSwgICAgICAgLy8g5Yib5bu65oi/6Ze05L+h5oGv77yM5qih5byP77yI5bqE5a625qih5byP5ZKM5peg54m55q6K54mM77yJXHJcbiAgICAgICAgb3ZlclRpbWU6Y2MuTm9kZSwgICAgICAgICAgIC8vIOi2heaXtuWHuueJjFxyXG4gICAgICAgIC8vbGFiZWxOb3RpY2U6IGNjLkxhYmVsLCAgICAgIC8vwqDlhazlkYpcclxuICAgICAgICBsYWJlbEJhbm5lcjogY2MuTGFiZWwsICAgICAgLy8gYmFubmVyIGxhYmVsXHJcbiAgICAgICAgcmVjb3JkTm9kZTpjYy5Ob2RlLFxyXG4gICAgICAgIHdhaXRpbmdQcmVmYWI6Y2MuUHJlZmFiLFxyXG4gICAgICAgIHNldHRpbmc6Y2MuTm9kZSxcclxuICAgICAgICAvL+eUqOaIt+S/oeaBr1xyXG4gICAgICAgIGF2YXRhck5vZGU6Y2MuTm9kZSxcclxuICAgICAgICBuaWNrTmFtZUxhYmVsOmNjLkxhYmVsLFxyXG4gICAgICAgIGNhcmROdW1iZXJMYWJlbDpjYy5MYWJlbCxcclxuICAgICAgICB1c2VySWRMYWJlbDpjYy5MYWJlbCxcclxuICAgICAgICBjb2RlTGFiZWw6Y2MuTGFiZWwsXHJcbiAgICAgICAgLy9waG9uZTpjYy5MYWJlbCxcclxuICAgICAgICAvLyB1c2VySW5mb01zZ05vZGU6Y2MuTm9kZSxcclxuICAgICAgICBsb2dvdXROb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIC8v5oiY57upXHJcbiAgICAgICAgcmVjb3JkTXNnTm9kZTpjYy5Ob2RlLFxyXG4gICAgICAgIGZlZWRiYWNrRWRpdEJveDpjYy5FZGl0Qm94LC8v5Y+N6aaIXHJcbiAgICAgICAgZmVlZGJhY2tOb2RlOmNjLk5vZGUsXHJcbiAgICAgICAgd3hzaGFyZTpjYy5Ob2RlLFxyXG4gICAgICAgIF91c2VySWQ6MCxcclxuICAgICAgICBfb3BlbklkOm51bGwsXHJcbiAgICAgICAgX2hlbHA6bnVsbCxcclxuICAgICAgICBfY2xvc2U6bnVsbCxcclxuICAgICAgICBpb3NVcmw6bnVsbCxcclxuICAgICAgICBhVXJsOm51bGwsXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzdGF0aWNzOiB7XHJcbiAgICAgICAgbGFzdEhhbGxJbmZvOiBudWxsLCAgIC8vIOS4iuS4gOasoeaUtuWIsOeahOWkp+WOheS/oeaBr1xyXG4gICAgICAgIGNhY2hlSW1hZ2VJbmZvOiBudWxsLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMua2V5QmFja0xpc3RlbigpO1xyXG4gICAgICAgIGlmKGNjLnN5cy5pc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgaWYod2luZG93LnNoYXJlVG9UaW1lTGluZSkge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LnNoYXJlVG9UaW1lTGluZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvU2Vzc2lvbikge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LnNoYXJlVG9TZXNzaW9uKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwidGltZXN0YW1wXCIpO1xyXG4gICAgICAgIHZhciBiZyA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInJvb21fYmdcIik7XHJcbiAgICAgICAgdmFyIHdpbmRvd1AgPSBjYy5kaXJlY3Rvci5nZXRXaW5TaXplSW5QaXhlbHMoKTtcclxuICAgICAgICB2YXIgc2NhbGVYID0gd2luZG93UC53aWR0aC9iZy53aWR0aDtcclxuICAgICAgICB2YXIgc2NhbGVZID0gd2luZG93UC5oZWlnaHQvYmcuaGVpZ2h0O1xyXG4gICAgICAgIHZhciBzY2FsZSA9IE1hdGgubWF4KHNjYWxlWCxzY2FsZVkpO1xyXG4gICAgICAgIGJnLnNjYWxlWCA9IHNjYWxlO1xyXG4gICAgICAgIGJnLnNjYWxlWSA9IHNjYWxlO1xyXG4gICAgICAgIHRoaXMuY2xlYXJMb2NhbFN0b3JhZ2UoKTtcclxuICAgICAgICBjYy5mcm9tID0ge307XHJcbiAgICAgICAgY2MuZnJvbS5pc1VzZU1hID0gdHJ1ZTtcclxuICAgICAgICBjYy5mcm9tLm1hID0gMDtcclxuICAgICAgICBjYy5pc1Jvb21WaWV3U2hvdyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2J0biA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0blwiKTtcclxuICAgICAgICB0aGlzLl9idXR0b25zID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiYnV0dG9uc1wiKTtcclxuICAgICAgICB2YXIgdm9sdW1lID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdWb2x1bWVcIik7XHJcbiAgICAgICAgaWYodm9sdW1lIT1udWxsICYmIHBhcnNlSW50KHZvbHVtZSkpIHtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlNdXNpYygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGJnU291bmQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJiZ1NvdW5kXCIpO1xyXG4gICAgICAgIGlmKGJnU291bmQgPT0gMCl7XHJcbiAgICAgICAgICAgIHZhciBhdWRpb01hbmFnZXIgPSBjYy5maW5kKCdBdWRpb01hbmFnZXInKTtcclxuICAgICAgICAgICAgYXVkaW9NYW5hZ2VyID0gYXVkaW9NYW5hZ2VyLmdldENvbXBvbmVudCgnQXVkaW9NYW5hZ2VyJyk7XHJcbiAgICAgICAgICAgIGF1ZGlvTWFuYWdlci5zZXRFZmZlY3RNdXNpY1ZvbHVtKGJnU291bmQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBQbGF5YmFjay5pbnN0YW5jZS5yZW1vdmVQbGF5YmFja0RhdGFzKCk7XHJcblxyXG4gICAgICAgIGhhbGwuY2FjaGVJbWFnZUluZm8gPSBoYWxsLmNhY2hlSW1hZ2VJbmZvIHx8IHt9O1xyXG5cclxuICAgICAgICB0aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XHJcbiAgICAgICAgdGhpcy5fc3RhcnRCYW5uZXJBbmltYXRpb24oKTtcclxuICAgICAgICB0aGlzLl9pbml0Sm9pblJvb20oKTtcclxuXHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuX29wZW5JZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5vcGVuSWQ7XHJcbiAgICAgICAgdGhpcy5faW52aXRlQ29kZSA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pbnZpdGVDb2RlOyAgLy/pgoDor7fnoIFcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zb2NrZXQgPSBjYy5maW5kKCdHYW1lU29ja2V0JykuZ2V0Q29tcG9uZW50KCdzb2NrZXQnKTtcclxuICAgICAgICB0aGlzLnNvY2tldC5yZWNldmljZU1lc3NhZ2UgPSBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2UpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25TdWNjZXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcclxuICAgICAgICAgICAgc2VsZi5oaWRkZW5DaGVja01lc3NhZ2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25EaXNjb25uZWN0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2hvd05ldHdvcmtNZXNzYWdlKCfnvZHnu5zpk77mjqXmlq3lvIDvvIzph43mlrDov57mjqXkuK0uLi4nKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc29ja2V0LmNoZWNrTmV0d29ya05vdyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLnNob3dDaGVja01lc3NhZ2UoJ+ajgOafpee9kee7nOS4rS4uLicpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zb2NrZXQuY2hlY2tOZXR3b3JrRW5kID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuQ2hlY2tNZXNzYWdlKCk7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyAgLyrorr7nva7nlKjmiLfkv6Hmga8qL1xyXG4gICAgICAgIHRoaXMudXBkYXRlVXNlckluZm8oKTtcclxuICAgICAgICAvKuWIt+aWsOeUqOaIt+S/oeaBryovXHJcbiAgICAgICAgU29ja2V0LnNlbmRHZXRVc2VySW5mbyh0aGlzLl91c2VySWQsdGhpcy5fb3BlbklkKTtcclxuICAgICAgICAvKuWumuaXtuWIt+aWsOeUqOaIt+S/oeaBryovXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBTb2NrZXQuc2VuZEdldFVzZXJJbmZvKHRoaXMuX3VzZXJJZCx0aGlzLl9vcGVuSWQpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSwxMCk7Ly8xMHPkuIDmrKFcclxuICAgICAgICBTb2NrZXQuc2VuZEdldEhhbGxJbmZvKHRoaXMuc29ja2V0LnVzZXJJbmZvLmlkKTtcclxuICAgICAgICBpZiAoaGFsbC5sYXN0SGFsbEluZm8pIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVCYW5uZXIoaGFsbC5sYXN0SGFsbEluZm8uaW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLm9uU2hhcmVXWFJlc3AgPSBudWxsO1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLnByZWxvYWRTY2VuZSgncGxheScsZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IucHJlbG9hZFNjZW5lKCdsb2dpbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmKGNjLmpvaW5EZXNrIT1udWxsKXtcclxuICAgICAgICAgICAgaWYoIWNjLmpvaW5EZXNrLnJlc3VsdCl7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVhc29uID0gY2Muam9pbkRlc2sucmVhc29uO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UocmVhc29uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYy5qb2luRGVzayA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGNjLnFpbmdsaSAhPSBudWxsKXtcclxuICAgICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UoXCLmgqjooqvmiL/kuLvor7flh7rmiL/pl7RcIik7XHJcbiAgICAgICAgICAgIGNjLnFpbmdsaSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdmFyIGNyZWF0QW5pbWEgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjcmVhdGVfcm9vbVwiKTtcclxuICAgIH0sXHJcblxyXG4gICAga2V5QmFja0xpc3RlbjpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX0RPV04sZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT0gY2MuS0VZLmJhY2spIHtcclxuICAgICAgICAgICAgICAgIGlmKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKXtcclxuICAgICAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiYmFja1RvRGVza1wiLCBcIigpVlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrV3hTaGFyZTpmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICB0aGlzLnd4c2hhcmUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdmFyIHRpdGxlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzaGFyZVRpdGxlJyk7XHJcbiAgICAgICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGVzYycpO1xyXG4gICAgICAgICAgICB2YXIgcmVjb3JkSWQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JlY29yZElkJyk7XHJcbiAgICAgICAgICAgIHZhciBpZD0gJyc7XHJcbiAgICAgICAgICAgIGlmKHJlY29yZElkKXtcclxuICAgICAgICAgICAgICAgIGlkID0gJ3JlY29yZElkPScrcmVjb3JkSWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVGcmllbmRcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxyXG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XHJcbiAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLCBzdHIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy/liIbkuqvliLDmnIvlj4vlnIhcclxuICAgIHNoYXJlSGFsbFRpbWVsaW5lOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgIHRoaXMud3hzaGFyZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB2YXIgdGl0bGUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3NoYXJlVGl0bGUnKTtcclxuICAgICAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkZXNjJyk7XHJcbiAgICAgICAgICAgIHZhciByZWNvcmRJZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVjb3JkSWQnKTtcclxuICAgICAgICAgICAgdmFyIGlkPSAnJztcclxuICAgICAgICAgICAgaWYocmVjb3JkSWQpe1xyXG4gICAgICAgICAgICAgICAgaWQgPSAncmVjb3JkSWQ9JytyZWNvcmRJZDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgICAgICB2YXIgc3RyID0gXCIoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVZcIjtcclxuICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsIHN0cixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgc2hhcmVCZzpmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICB0aGlzLnd4c2hhcmUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIC8vIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVIYWxsVGltZWxpbmVcIixpZCwgZGVzY3JpcHRpb24sdGl0bGUpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIC8vIGVsc2Ugey8vQW5kcm9pZFxyXG4gICAgICAgICAgICAvLyAgICAgdmFyIHN0ciA9IFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCI7XHJcbiAgICAgICAgICAgIC8vICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCBzdHIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgY2xlYXJMb2NhbFN0b3JhZ2U6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc2hhcmVUaXRsZSA9ICflvIDmiL/njqlb5aSn5LyX5Y2B5LiJ5rC0XSc7XHJcbiAgICAgICAgdmFyIGRlc2MgPSAn5byA5aW95oi/5LqG77yM5bCx562J5L2g5Lus5LiA6LW35p2lW+Wkp+S8l+WNgeS4ieawtF3llabvvIHmmZrkuobkvY3nva7lsLHmsqHkuoblk59+JzsgXHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdyb29tSWQnKTtcclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3NoYXJlVGl0bGUnLHNoYXJlVGl0bGUpO1xyXG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGVzYycsZGVzYyk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc29ja2V0LnJlY2V2aWNlTWVzc2FnZSA9IGZ1bmN0aW9uKCkge307XHJcbiAgICAgICAgdGhpcy5zb2NrZXQuY29ubmVjdGlvblN1Y2Nlc3MgPSBmdW5jdGlvbigpIHt9O1xyXG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25EaXNjb25uZWN0ID0gZnVuY3Rpb24oKSB7fTtcclxuICAgICAgICB0aGlzLnNvY2tldC5jaGVja05ldHdvcmtOb3cgPSBmdW5jdGlvbigpe307XHJcbiAgICAgICAgdGhpcy5zb2NrZXQuY2hlY2tOZXR3b3JrRW5kID0gZnVuY3Rpb24oKSB7fTtcclxuICAgICAgICBcclxuICAgICAgS1FHbG9iYWxFdmVudC5vZmZUYXJnZXQodGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yZWdpc3RlclNvY2tldEV2ZW50OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuSm9pbkRlc2ssIHRoaXMuX2ppaW5Sb29tU29ja2V0Q2FsbGJhY2ssIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEZXNrSW5mbywgdGhpcy5famlpblJvb21Tb2NrZXRDYWxsYmFjaywgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUNyZWF0ZURlc2ssIHRoaXMuX2NyZWF0ZVJvb21Tb2NrZXRDYWxsYmFjaywgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUhhbGxJbmZvLCB0aGlzLl9zb2NrZXRSZWNlaXZlSGFsbEluZm8sIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVHZXRVc2VySW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZVVzZXJJbmZvLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Tb2NrZXREaXNjb25uZWN0LCB0aGlzLl9zb2NrZXREaXNjb25uZWN0LCB0aGlzKTtcclxuICAgICAgICAvL0tRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVJbnZpdGVDb2RlLCB0aGlzLl9zb2NrZXRSZWNlaXZlSW52aXRlQ29kZSwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcy5fc29ja2V0Q29ubmVjdGVkLCB0aGlzKTtcclxuICAgICAgICAvL0tRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVTaGFyZVBuZywgdGhpcy5fc29ja2V0U2hhcmVQbmcsIHRoaXMpO1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgLy8g6Lez6L2s5Yiw5YWs5LyX5Y+3XHJcbiAgICBndWFuemh1OmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy8gdmFyIHVybCA9IFwiaHR0cDovL3d3dy5ob25nZ2VmZW5nLmNuL2d6aC9pbmRleC5odG1sXCI7XHJcbiAgICAgICAgLy8gY2Muc3lzLm9wZW5VUkwodXJsKVxyXG4gICAgfSxcclxuICAgIF9zdGFydEJhbm5lckFuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhbmltID0gdGhpcy5sYWJlbEJhbm5lci5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcclxuICAgICAgICBhbmltLnBsYXkoJ2Jhbm5lcicpO1xyXG4gICAgfSxcclxuICAgIGRvd25Mb2FkOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIHVybCA9J2h0dHBzOi8vZmlyLmltLzV0bmUnO1xyXG4gICAgICAgIGNjLnN5cy5vcGVuVVJMKHVybCk7XHJcblxyXG4gICAgICAgIC8vd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcImh0dHA6Ly93d3cuYmFpZHUuY29tXCI7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIu+8n++8n++8n++8n++8n++8n++8n++8n1wiKTtcclxuICAgIH0sXHJcblxyXG4gICAgX2luaXRKb2luUm9vbTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBsZXQgam9pblJvb20gPSB0aGlzLmpvaW5Ob2RlLmdldENvbXBvbmVudCgnam9pblJvb20nKTtcclxuXHJcbiAgICAgICAgam9pblJvb20uY2FsbGJhY2tKb2luUm9vbSA9IGZ1bmN0aW9uIChudW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2VsZi5qb2luTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgICAgICAvLyBzZWxmLnNob3dXYWl0aW5nTWVzc2FnZSgn5Yqg5YWl5LitLi4uJyk7XHJcbiAgICAgICAgICAgIC8vIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyAgICAgc2VsZi5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xyXG4gICAgICAgICAgICAvLyB9LCAyLjApO1xyXG5cclxuICAgICAgICAgICAgLyrliqDlhaXmiL/pl7Tor7fmsYIqL1xyXG4gICAgICAgICAgICBsZXQgdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgICAgICBTb2NrZXQuc2VuZEpvaW5EZXNrKG51bWJlciwgdXNlcklkKTtcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgX2ppaW5Sb29tU29ja2V0Q2FsbGJhY2s6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIGlmKGNjLmlzUm9vbVZpZXdTaG93KXtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmhpZGRlbldhaXRpbmdNZXNzYWdlKCk7XHJcblxyXG4gICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgaWYoY2MuZnJvbSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjYy5mcm9tID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGpvaW5Sb29tID0gdGhpcy5qb2luTm9kZS5nZXRDb21wb25lbnQoJ2pvaW5Sb29tJyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmpvaW5Ob2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5zZXRBbGVydENhbGxiY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgam9pblJvb20uY2xpY2tDbGVhcigpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY2MuZnJvbS5tYSA9IHJlc3BvbnNlLmRhdGEubWFQYWk7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCByZWFzb25JbmZvID0gdGhpcy5fam9pblJlYXNvbk1hcChyZXNwb25zZS5kYXRhLnJlYXNvbik7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlKHJlYXNvbkluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVIYWxsSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYoY2MuaXNSb29tVmlld1Nob3cpe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIGhhbGwubGFzdEhhbGxJbmZvID0gZGF0YTtcclxuICAgICAgICBsZXQgaXNJT1MgPSBkYXRhLmlzSU9TO1xyXG4gICAgICAgIGxldCBpc0FuZHJvaWQgPSBkYXRhLmlzQTtcclxuICAgICAgICBsZXQgdklPUyA9IGRhdGEudklPUztcclxuICAgICAgICBsZXQgdkEgPSBkYXRhLnZBO1xyXG4gICAgICAgIHRoaXMuaW9zVXJsID0gZGF0YS5pb3NVcmw7XHJcbiAgICAgICAgdGhpcy5hVXJsID0gZGF0YS5hVXJsO1xyXG4gICAgICAgIGlmKGNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgICAgICBpZihpc0lPUyA9PSAxKXtcclxuICAgICAgICAgICAgICAgICAgICBpZih2SU9TICE9ICcxLjAuMycgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZW5neGluLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Ugey8vQW5kcm9pZFxyXG4gICAgICAgICAgICAgICAgaWYoaXNBbmRyb2lkID09IDEpe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHZBICE9ICcxLjAuNCcgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZW5neGluLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbm90aWNlID0gZGF0YS5icm9hZGNhc3Q7XHJcbiAgICAgICAgbGV0IGJhbm5lciA9IGRhdGEuaW5mbztcclxuICAgICAgICAvL3RoaXMudXBkYXRlTm90aWNlKG5vdGljZSk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVCYW5uZXIoYmFubmVyKTtcclxuICAgIH0sXHJcbiAgICBkb3dubG9hZE5ld1ZlcnNpb246ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGNjLnN5cy5vcGVuVVJMKHRoaXMuaW9zVXJsKTtcclxuICAgICAgICAgICAgLy8ganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwiZG93bmxvYWROZXdWZXJzaW9uOlwiLCB0aGlzLmlvc1VybCk7XHJcbiAgICAgICAgfSBlbHNlIHsgLy9BbmRyb2lkXHJcbiAgICAgICAgICAgIGNjLnN5cy5vcGVuVVJMKHRoaXMuYVVybCk7XHJcbiAgICAgICAgICAgIC8vIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJkb3dubG9hZE5ld1ZlcnNpb25cIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgdGhpcy5hVXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgX2NyZWF0ZVJvb21Tb2NrZXRDYWxsYmFjazogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYoY2MuaXNSb29tVmlld1Nob3cpe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGlkZGVuV2FpdGluZ01lc3NhZ2UoKTtcclxuXHJcbiAgICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3BsYXknKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyrlpoLmnpzpkrvnn7PkuI3otrPvvIzliJnmj5DnpLoqL1xyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZShcIuaCqOeahOmSu+efs+S4jei2s1wiKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9qb2luUmVhc29uTWFwOiBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgIGxldCByZWFzb25JbmZvID0ge1xyXG4gICAgICAgIG5vdEV4aXN0OiBcIuaIv+mXtOS4jeWtmOWcqCFcIixcclxuICAgICAgICBjYXJkTnVtYmVyOiBcIuaCqOaIv+WNoeS4jei2syFcIixcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGxldCBpbmZvID0gcmVhc29uSW5mb1tyZWFzb25dIHx8IFwi5oi/6Ze05bey5ruhIVwiO1xyXG4gICAgICByZXR1cm4gaW5mbztcclxuICAgIH0sXHJcblxyXG4gICAgLypzaG9wKi9cclxuICAgIHNob3BBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLnNob3BBbGVydE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIGNvbXAuYWxlcnQoKTtcclxuICAgIH0sXHJcbiAgICAvKuaPkOekuiovXHJcbiAgICBhbGVydE1lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XHJcbiAgICAgICAgdmFyIG5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmFsZXJ0UHJlZmFiKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgdmFyIGNvbXAgPSBub2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgICBjb21wLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vdXBkYXRlTm90aWNlOiBmdW5jdGlvbiAobm90aWNlKSB7XHJcbiAgICAvLyAgICBpZih0aGlzLmxhYmVsTm90aWNlID09IG51bGwpe1xyXG4gICAgLy8gICAgICAgIHJldHVybjtcclxuICAgIC8vICAgIH1cclxuICAgIC8vICB0aGlzLmxhYmVsTm90aWNlLnN0cmluZyA9IG5vdGljZSB8fCBcIlwiO1xyXG4gICAgLy99LFxyXG5cclxuICAgIHVwZGF0ZUJhbm5lcjogZnVuY3Rpb24gKGJhbm5lciA9IFwiXCIpIHtcclxuICAgICAgICBpZih0aGlzLmxhYmVsQmFubmVyID09IG51bGwpe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICB0aGlzLmxhYmVsQmFubmVyLnN0cmluZyA9IGJhbm5lcjtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8qIyMjIyNcclxuICAgICogc2V0dGluZzEg5bGA5pWwICAoMCB8IDEgfCAyIClcclxuICAgICogc2V0dGluZzIg5Lq65pWwICAoMCB8IDEgfCAyIHwgMylcclxuICAgICogc2V0dGluZzMg546p5rOVICAoMCB8IDEgfCAyIHwgMyB8IDQpXHJcbiAgICAqIHNldHRpbmc0IEFB5Yi25pS25Y+W5oi/6LS5ICAoMCB8IDEgfCAyIClcclxuICAgICogc2V0dGluZzUg5YW25LuWICAoMClcclxuICAgICogc2V0dGluZzYgIFxyXG4gICAgKiBzZXR0aW5nN1xyXG4gICAgKiAqL1xyXG4gICAgY3JlYXRlRG9uZUFjdGlvbjpmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgaW5mbyA9IHt9O1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIga2V5ID0gWydzZXR0aW5nMScsJ3NldHRpbmcyJywnc2V0dGluZzQnLCdzZXR0aW5nNSddO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50c1NpbmdsZVNlbGVjdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgdHNJbmRleCA9IHNlbGYudHNTaW5nbGVTZWxlY3RbaV0uZ2V0Q29tcG9uZW50KCdzaW5nbGVTZWxlY3QnKS5zZWxlY3RlZEluZGV4O1xyXG4gICAgICAgICAgICBpbmZvW2tleVtpXV0gPSB0c0luZGV4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpbmZvWydzZXR0aW5nMyddID0gdGhpcy5zZWxlY3RNb1NoaS5nZXRDb21wb25lbnQoJ3NlbGVjdE1vU2hpJykuX3NlbGVjdDtcclxuICAgICAgICBpbmZvWydzZXR0aW5nNiddID0gdGhpcy5vdmVyVGltZS5nZXRDb21wb25lbnQoJ292ZXJUaW1lJykuX3NlbGVjdGVkO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coIGluZm9bJ3NldHRpbmc2J10gKTtcclxuICAgICAgICBpZiggIWluZm9bJ3NldHRpbmczJ11bM10gKXsgICAvLyDnjqnms5UgW+eWr+eLguWcuizprLzniYws5q+U6Iqx6ImyLOWdkOW6hCzpqazniYxdIGluZm9bJ3NldHRpbmczJ11bM13nrKzkuInpobnooajnpLrlnZDluoTmqKHlvI/vvIzpnZ7lnZDluoTmqKHlvI/nmoTlgI3njofmmK8x5YCNXHJcbiAgICAgICAgICAgIGluZm9bJ3NldHRpbmc1J10gPSAwOyAgICAgLy8g5YCN546HICgwfjEpID09ICgxfjPlgI0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGluZm9bJ3NldHRpbmc4J10gPSBudWxsO1xyXG4gICAgIFxyXG4gICAgICAgIGluZm9bJ3NldHRpbmc3J10gPSB0aGlzLnNlbGVjdE1vU2hpLmdldENvbXBvbmVudCgnY2hhbmdlX21hcGFpJykuX2NhcmRzO1xyXG4gICAgICAgIGNjLnNldCA9IGluZm87XHJcbiAgICAgICAgaW5mb1sndXNlcklkJ10gPSB0aGlzLnNvY2tldC51c2VySW5mby5pZDsgICAgICAvL+eUqOaIt0lkXHJcbiAgICAgICAgdGhpcy5zb2NrZXQuc2VuZE1lc3NhZ2UoJ2NyZWF0ZURlc2snLGluZm8pO1xyXG5cclxuICAgICAgICB0aGlzLmNyZWF0ZU5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuXHJcbiAgICAgICAgLy9sZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zaG93V2FpdGluZ01lc3NhZ2UoJ+WIm+W7uuS4rS4uLicpO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLmhpZGRlbldhaXRpbmdNZXNzYWdlKCk7XHJcbiAgICAgICAgfSwgMi4wKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g6ZqP5py65Zy6XHJcbiAgICAvKmNsaWNrUmFuZFJvb206IGZ1bmN0aW9uICgpIHtcclxuICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdyYW5kUm9vbScpO1xyXG4gICAgfSwqL1xyXG5cclxuICAgIGNsaWNrUmVjb3JkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLnJlY29yZE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIGNvbXAuYWxlcnQoKTtcclxuICAgICAgICBTb2NrZXQuc2VuZEdldFJlY3JvZChTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tQbGF5UnVsZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdydWxlJyk7XHJcbiAgICAgICAgdGhpcy5oZWxwID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiaGVscFwiKTtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMuaGVscC5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgY29tcC5hbGVydCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja1BsYXk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZihjYy5jbGlja091dCkgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8q5YiH5o2i6LSm5Y+3Ki9cclxuICAgIGNsaWNrQ2FuY2VsTGF0aW9uOmZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmxvZ291dE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGxvZ291dEFjdGlvbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy9tYW5hZ2VyLnNldFVzZXJJbmZvKCcnKTtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2xvZ2luJyk7XHJcbiAgICAgICAgaGFsbC5jYWNoZUltYWdlSW5mbyA9IG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIGV4aXRBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgIC8vbWFuYWdlci5zZXRVc2VySW5mbygnJyk7XHJcbiAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XHJcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdsb2dpbicpO1xyXG4gICAgICAgIGhhbGwuY2FjaGVJbWFnZUluZm8gPSBudWxsO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcImV4aXRBcHBcIik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZCBjb20ubGxpbmcucWlhbmppYW5nbHpnXHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJleGl0QXBwXCIsIFwiKClWXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy5kaXJlY3Rvci5lbmQoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8v5o6l5pS25aSE55CG55So5oi35pWw5o2uXHJcbiAgICBfc29ja2V0UmVjZWl2ZVVzZXJJbmZvOmZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYoY2MuaXNSb29tVmlld1Nob3cpe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICBpZiAoIXRoaXMuc29ja2V0LnVzZXJJbmZvKSB7XHJcbiAgICAgICAgY2MuZXJyb3IoXCJ0aGlzLnNvY2tldC51c2VySW5mbyDkuLrnqbohISFcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UsXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0t55So5oi35L+h5oGvXCIpO1xyXG4gICAgICAvL3RoaXMucGhvbmUuc3RyaW5nID0gcmVzcG9uc2UuZGF0YS5waG9uZSA/IHJlc3BvbnNlLmRhdGEucGhvbmUgOiBcIuaXoFwiO1xyXG4gICAgICB0aGlzLnNldHRpbmcuZ2V0Q29tcG9uZW50KCdTZXR0aW5nJykuX3Bob25lID0gcmVzcG9uc2UuZGF0YS5waG9uZT9yZXNwb25zZS5kYXRhLnBob25lOm51bGw7XHJcbiAgICAgIHRoaXMuc2V0dGluZy5nZXRDb21wb25lbnQoJ1NldHRpbmcnKS5waG9uZS5zdHJpbmcgPSByZXNwb25zZS5kYXRhLnBob25lP3Jlc3BvbnNlLmRhdGEucGhvbmU6J+aXoCc7XHJcbiAgICAgIHRoaXMubmlja05hbWVMYWJlbC5zdHJpbmcgPSByZXNwb25zZS5kYXRhLm5pY2tuYW1lOyAgIC8vIOeUqOaIt+WQjVxyXG4gICAgICB0aGlzLnVzZXJJZExhYmVsLnN0cmluZyA9ICdJRDogJyArIHJlc3BvbnNlLmRhdGEuaWQ7ICAvLyBJRFxyXG4gICAgICB0aGlzLmNhcmROdW1iZXJMYWJlbC5zdHJpbmcgPSByZXNwb25zZS5kYXRhLmNhcmROdW1iZXI7XHJcbiAgICAgIHZhciBzcHJpdGUgPSB0aGlzLmF2YXRhck5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6cmVzcG9uc2UuZGF0YS5hdmF0YXJVcmwsdHlwZTpcImpwZ1wifSwgZnVuY3Rpb24gKGVyciwgdGV4KSB7XHJcbiAgICAgICAgICBpZiAoIWVycikge1xyXG4gICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xyXG4gICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZT1mcmFtZTtcclxuICAgICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXREaXNjb25uZWN0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLnNob3dOZXR3b3JrTWVzc2FnZShcIue9kee7nOmTvuaOpeaWreW8gO+8jOmHjeaWsOi/nuaOpeS4rS4uLlwiKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldENvbm5lY3RlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5oaWRkZW5OZXR3b3JrTWVzc2FnZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+abtOaWsOeUqOaIt+S/oeaBr1xyXG4gICAgdXBkYXRlVXNlckluZm86ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGluZm8gPSB0aGlzLnNvY2tldC51c2VySW5mbztcclxuICAgICAgICBpZiAoIWluZm8pIHtcclxuICAgICAgICAgIGNjLmVycm9yKFwidGhpcy5zb2NrZXQudXNlckluZm8g5Li656m6ISEhXCIpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5uaWNrTmFtZUxhYmVsLnN0cmluZyA9IGluZm8ubmlja25hbWU7XHJcbiAgICAgICAgdGhpcy51c2VySWRMYWJlbC5zdHJpbmcgPSAnSUQ6ICcgKyBpbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuY2FyZE51bWJlckxhYmVsLnN0cmluZyA9IGluZm8uY2FyZE51bWJlcjtcclxuXHJcbiAgICAgICAgbGV0IGF2YXRhclVybCA9IGluZm8uYXZhdGFyVXJsICsgXCIuanBnXCI7XHJcbiAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuYXZhdGFyTm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICB2YXIgdGV4dHVyZSA9IGhhbGwuY2FjaGVJbWFnZUluZm9bYXZhdGFyVXJsXTtcclxuICAgICAgICBpZiAodGV4dHVyZSkge1xyXG4gICAgICAgICAgICBsZXQgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4dHVyZSk7XHJcbiAgICAgICAgICAgIGlmIChmcmFtZSkge1xyXG4gICAgICAgICAgICAgICAgLy9jYy5sb2coXCLku47nvJPlrZjkuK3liqDovb3lpLTlg49cIik7XHJcbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBmcmFtZTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2MubG9hZGVyLmxvYWQoe3VybDppbmZvLmF2YXRhclVybCx0eXBlOlwianBnXCJ9LCBmdW5jdGlvbiAoZXJyLCB0ZXgpIHtcclxuICAgICAgICAgICAgaWYgKCFlcnIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lPWZyYW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIGhhbGwuY2FjaGVJbWFnZUluZm9bYXZhdGFyVXJsXSA9IHRleDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKuaPkOS6pOaEj+ingSovXHJcbiAgICBmZWVkYmFja0FjaW9uOmZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHVzZXJJZCA9IHRoaXMuc29ja2V0LnVzZXJJbmZvLmlkO1xyXG4gICAgICB2YXIgdGV4dCA9IHRoaXMuZmVlZGJhY2tFZGl0Qm94LnN0cmluZztcclxuICAgICAgaWYgKHRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHRoaXMuZmVlZGJhY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgU29ja2V0LnNlbmRGZWVkYmFjayh1c2VySWQsdGV4dCk7XHJcbiAgICAgICAgdGhpcy5mZWVkYmFja0VkaXRCb3guc3RyaW5nID0gJyc7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc2hvd1dhaXRpbmdNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xyXG4gICAgICBpZiAodGhpcy53YWl0aW5nTm9kZSAhPSBudWxsICYmIGNjLnN5cy5pc05hdGl2ZSAmJiBjYy5zeXMuaXNPYmplY3RWYWxpZCh0aGlzLndhaXRpbmdOb2RlKSkge1xyXG4gICAgICAgICAgdGhpcy53YWl0aW5nTm9kZS5kZXN0b3J5KCk7XHJcbiAgICAgICAgICB0aGlzLndhaXRpbmdOb2RlID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLndhaXRpbmdOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcclxuICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMud2FpdGluZ05vZGUpO1xyXG4gICAgICB2YXIgY29tcCA9IHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgY29tcC5hbGVydCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBoaWRkZW5XYWl0aW5nTWVzc2FnZTpmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgdGhpcy53YWl0aW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vbmV0d29ya1xyXG4gICAgc2hvd05ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xyXG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICYmIHRoaXMubmV0d29ya05vZGUuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIGxldCBhbGVydCA9IHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgICAgICBpZiAoYWxlcnQuZ2V0TWVzc2FnZSgpID09IG1zZykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVTZWxmQWN0aW9uID0gY2MucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLm5ldHdvcmtOb2RlKTtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYubmV0d29ya05vZGUgPSBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICAgICAgY29tcC5hbGVydCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBoaWRkZW5OZXR3b3JrTWVzc2FnZTpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vY2hlY2tOb2RlXHJcbiAgICBzaG93Q2hlY2tNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xyXG4gICAgICAgIGlmICghKHRoaXMuY2hlY2tOb2RlICYmIHRoaXMuY2hlY2tOb2RlLmFjdGl2ZSkpIHtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgYWxlcnQgPSB0aGlzLmNoZWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgICAgIGlmIChhbGVydC5nZXRNZXNzYWdlKCkgPT0gbXNnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tOb2RlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIHJlbW92ZVNlbGZBY3Rpb24gPSBjYy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoZWNrTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMuY2hlY2tOb2RlKTtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMuY2hlY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLmNoZWNrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgICBjb21wLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGRlbkNoZWNrTWVzc2FnZTpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5jaGVja05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkJ0bkNsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZih0aGlzLl9idXR0b25zLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25zLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25zLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gaGFsbDtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8qc3ByaXRlczoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5TcHJpdGVBdGxhc1xyXG4gICAgICAgIH0sKi9cclxuICAgICAgICBwbGF5X21ldGhvZF9iZWZvcmU6Y2MuTm9kZSwgIC8v546p5rOV5LuL57uNXHJcbiAgICAgICAgcGxheV9tZXRob2RfY29udGVudF9sYWJlbDpjYy5Ob2RlLCAgLy/njqnms5Xku4vnu43lhoXlrrlcclxuICAgICAgICBpbnRyb2R1Y2VfcGFpX2JlZm9yZTpjYy5Ob2RlLC8v54mM5Z6L5LuL57uNXHJcbiAgICAgICAgZGV0YWlsczpjYy5Ob2RlLCAgIC8v54mM5Z6L5LuL57uN5YaF5a65XHJcbiAgICAgICAgY2FvenVvX2JlZm9yZTpjYy5Ob2RlLCAgICAgLy/mk43kvZzku4vnu41cclxuICAgICAgICBjYW96dW9fY29udGVudDpjYy5Ob2RlLCAgLy/mk43kvZzku4vnu43lhoXlrrlcclxuICAgICAgICBfYnRuOm51bGwsXHJcbiAgICAgICAgX2NvbnRlbnQ6bnVsbCxcclxuICAgICAgICBfYnV0dG9uQ29tOm51bGwsXHJcbiAgICAgICAgX3BsYXlfbWV0aG9kX2J1dHRvbjpudWxsLFxyXG4gICAgICAgIF9pbnRyb2R1Y2VfcGFpX2J1dHRvbjpudWxsLFxyXG4gICAgICAgIF9jYW96dW9fYnV0dG9uOm51bGxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL3RoaXMuX3BsYXlfbWV0aG9kX2J1dHRvbiA9IHRoaXMucGxheV9tZXRob2RfYmVmb3JlLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xyXG4gICAgICAgIC8vdGhpcy5faW50cm9kdWNlX3BhaV9idXR0b24gPSB0aGlzLmludHJvZHVjZV9wYWlfYmVmb3JlLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xyXG4gICAgICAgIC8vdGhpcy5fY2FvenVvX2J1dHRvbiA9IHRoaXMuY2FvenVvX2JlZm9yZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICAvL3RoaXMuX2J0biA9IFt0aGlzLnBsYXlfbWV0aG9kX2JlZm9yZSx0aGlzLmludHJvZHVjZV9wYWlfYmVmb3JlLHRoaXMuY2FvenVvX2JlZm9yZV07XHJcbiAgICAgICAgLy90aGlzLl9jb250ZW50ID0gW3RoaXMucGxheV9tZXRob2RfY29udGVudF9sYWJlbCx0aGlzLmRldGFpbHMsdGhpcy5jYW96dW9fY29udGVudF07XHJcbiAgICAgICAgLy90aGlzLl9idXR0b25Db20gPSBbdGhpcy5fcGxheV9tZXRob2RfYnV0dG9uLHRoaXMuX2ludHJvZHVjZV9wYWlfYnV0dG9uLHRoaXMuX2Nhb3p1b19idXR0b25dO1xyXG4gICAgICAgIC8vLy/liJrlvIDlp4vniYzlnovku4vnu43nmoTmjInpkq7kuI3lj6/nlKhcclxuICAgICAgICAvL3RoaXMuX2J1dHRvbkNvbVsxXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICAvLyDngrnlh7vnjqnms5Xku4vnu41cclxuICAgIG9uQnRuUGxheU1ldGhvZENsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL2Zvcih2YXIgaT0wO2k8MztpKyspe1xyXG4gICAgICAgIC8vICAgIC8v5omA5pyJ5oyJ6ZKu6K6+572u5Li65Y+v55SoXHJcbiAgICAgICAgLy8gICAgdGhpcy5fYnV0dG9uQ29tW2ldLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgLy/miYDmnInnmoTlhoXlrrnpg73pmpDol4/mjolcclxuICAgICAgICAvLyAgICB0aGlzLl9jb250ZW50W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLy/lvZPliY3ngrnlh7vnmoTorr7nva7kuLrkuI3lj6/nlKhcclxuICAgICAgICAvL3RoaXMuX2J1dHRvbkNvbVswXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAvLy8v5b2T5YmN54K55Ye755qE5a+55bqU55qE5YaF5a655Y+v6KeBXHJcbiAgICAgICAgdGhpcy5fY29udGVudFswXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIC8v54K55Ye754mM5Z6L5LuL57uNXHJcbiAgICBvbkJ0bkludHJvZHVjZVBhaUNsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL2Zvcih2YXIgaT0wO2k8MztpKyspe1xyXG4gICAgICAgIC8vICAgIC8v5omA5pyJ5oyJ6ZKu6K6+572u5Li65Y+v55SoXHJcbiAgICAgICAgLy8gICAgdGhpcy5fYnV0dG9uQ29tW2ldLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgLy/miYDmnInnmoTlhoXlrrnpg73pmpDol4/mjolcclxuICAgICAgICAvLyAgICB0aGlzLl9jb250ZW50W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLy/lvZPliY3ngrnlh7vnmoTorr7nva7kuLrkuI3lj6/nlKhcclxuICAgICAgICAvL3RoaXMuX2J1dHRvbkNvbVsxXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAvLy8v5b2T5YmN54K55Ye755qE5a+55bqU55qE5YaF5a655Y+v6KeBXHJcbiAgICAgICAgLy90aGlzLl9jb250ZW50WzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgLy/ngrnlh7vmk43kvZzku4vnu41cclxuICAgIG9uQnRuQ2FvenVvQ2xpY2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vZm9yKHZhciBpPTA7aTwzO2krKyl7XHJcbiAgICAgICAgLy8gICAgLy/miYDmnInmjInpkq7orr7nva7kuLrlj6/nlKhcclxuICAgICAgICAvLyAgICB0aGlzLl9idXR0b25Db21baV0uaW50ZXJhY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICAvL+aJgOacieeahOWGheWuuemDvemakOiXj+aOiVxyXG4gICAgICAgIC8vICAgIHRoaXMuX2NvbnRlbnRbaV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vL+W9k+WJjeeCueWHu+eahOiuvue9ruS4uuS4jeWPr+eUqFxyXG4gICAgICAgIC8vdGhpcy5fYnV0dG9uQ29tWzJdLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vLy/lvZPliY3ngrnlh7vnmoTlr7nlupTnmoTlhoXlrrnlj6/op4FcclxuICAgICAgICAvL3RoaXMuX2NvbnRlbnRbMl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCIvKipcclxuICog6YKA6K+356CBXHJcbiAqIEBhdXRob3JzIOm7hOaIkCh5b3VAZXhhbXBsZS5vcmcpXHJcbiAqIEBkYXRlICAgIDIwMTctMDYtMTYgMDk6NDQ6MTBcclxuICogQHZlcnNpb24gJElkJFxyXG4gKi9cclxuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbGFiZWxOdW1iZXJzOiBbY2MuTGFiZWxdLFxyXG4gICAgICAgIGNhbGxiYWNrSW52aXRlQ29kZTogJycsXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNsaWNrQ2xlYXIoKTsgLy/muIXpmaTmlbDlrZdcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tDbGVhcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmxhYmVsTnVtYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xyXG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja051bWJlcjogZnVuY3Rpb24gKGV2ZW50LCBudW1iZXIpIHtcclxuICAgICAgdmFyIGxhYmVsID0gdGhpcy5fbGFzdEVtcHR5TGFiZWwoKTtcclxuICAgICAgaWYgKGxhYmVsKSB7XHJcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gbnVtYmVyO1xyXG4gICAgICAgXHQvL2NjLmxvZyhsYWJlbC5zdHJpbmcgLFwiLS0tLS0tLS0tLS0tLS0tLVwiKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgbGV0IGlzQ29tcGxldGUgPSAodGhpcy5fbGFzdEVtcHR5TGFiZWwoKSA9PSBudWxsKTtcclxuICAgICAgLy9jYy5sb2coXCJpc0NvbXBsZXRlLS0tLS0tLS0tLS0tLVwiLCB0aGlzLmNhbGxiYWNrSW52aXRlQ29kZSk7XHJcbiAgICAgIGxldCBpbnZpdGVOdW1iZXIgPSB0aGlzLl9pbnZpdGVOdW1iZXIoKTtcclxuXHJcbiAgICAgIGlmICggaW52aXRlTnVtYmVyLmxlbmd0aCA9PSA2ICl7XHJcbiAgICAgICAgLy9jYy5sb2coaW52aXRlTnVtYmVyLFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0zOFwiKTsgLy/pgoDor7fnoIFcclxuICAgICAgICBsZXQgdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIC8vU29ja2V0LnNlbmRJbnZpdGVDb2RlKGludml0ZU51bWJlciwgdXNlcklkKTtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrSW52aXRlQ29kZSA9IGludml0ZU51bWJlcjtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNlbmRDb2RlIDpmdW5jdGlvbigpeyAgLy/lj5HpgIHpgoDor7fnoIFcclxuICAgICAgbGV0IHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcclxuICAgICAgbGV0IGludml0ZU51bWJlciA9IHRoaXMuY2FsbGJhY2tJbnZpdGVDb2RlO1xyXG4gICAgICAvL2NjLmxvZyhpbnZpdGVOdW1iZXIsXCItLS0tLS0tLS0tLS0tLS0tLS0tLTM4XCIpXHJcbiAgICAgIGlmKCBpbnZpdGVOdW1iZXIgJiYgaW52aXRlTnVtYmVyLmxlbmd0aD09Nil7ICBcclxuICAgICAgICBTb2NrZXQuc2VuZEludml0ZUNvZGUoaW52aXRlTnVtYmVyLCB1c2VySWQpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tJbnZpdGVDb2RlID0gJyc7ICAgLy/muIXnqbrpgoDor7fnoIFcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsaWNrRGVsZXRlT25lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBsYWJlbCA9IHRoaXMuX2xhc3ROdW1iZXJMYWJlbCgpO1xyXG4gICAgICBpZiAobGFiZWwpIHtcclxuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9sYXN0RW1wdHlMYWJlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBmb3IgKHZhciBpbmRleCBpbiB0aGlzLmxhYmVsTnVtYmVycykge1xyXG4gICAgICAgIHZhciBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcclxuICAgICAgICBpZiAobGFiZWwuc3RyaW5nID09IG51bGxcclxuICAgICAgICB8fCBsYWJlbC5zdHJpbmcubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgIHJldHVybiBsYWJlbDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9sYXN0TnVtYmVyTGFiZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgZm9yICh2YXIgaW5kZXggPSB0aGlzLmxhYmVsTnVtYmVycy5sZW5ndGggLSAxOyBpbmRleCA+PSAwOyAtLWluZGV4KSB7XHJcbiAgICAgICAgbGV0IGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xyXG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgJiYgbGFiZWwuc3RyaW5nLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIHJldHVybiBsYWJlbDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaW52aXRlTnVtYmVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmxhYmVsTnVtYmVycy5yZWR1Y2UoZnVuY3Rpb24gKGludml0ZU51bWJlciwgbGFiZWwpIHtcclxuICAgICAgICAvL2NjLmxvZyhpbnZpdGVOdW1iZXIsXCItLS0tLS0tLS0tLS0tLS0tLVwiKTtcclxuICAgICAgICByZXR1cm4gaW52aXRlTnVtYmVyICsgKGxhYmVsLnN0cmluZyB8fCBcIlwiKTtcclxuICAgICAgfSwgXCJcIik7XHJcbiAgICB9LFxyXG59KSIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbGFiZWxOdW1iZXJzOiBbY2MuTGFiZWxdLFxyXG4gICAgICAgIGNhbGxiYWNrSm9pblJvb206IG51bGwsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuY2xpY2tDbGVhcigpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja051bWJlcjogZnVuY3Rpb24gKGV2ZW50LCBudW1iZXIpIHtcclxuICAgICAgdmFyIGxhYmVsID0gdGhpcy5fbGFzdEVtcHR5TGFiZWwoKTtcclxuICAgICAgaWYgKGxhYmVsKSB7XHJcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gbnVtYmVyO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IGlzQ29tcGxldGUgPSAodGhpcy5fbGFzdEVtcHR5TGFiZWwoKSA9PSBudWxsKTtcclxuICAgICAgaWYgKGlzQ29tcGxldGUgJiYgdGhpcy5jYWxsYmFja0pvaW5Sb29tKSB7XHJcbiAgICAgICAgbGV0IHJvb21OdW1iZXIgPSB0aGlzLl9yb29tTnVtYmVyKCk7XHJcbiAgICAgICAgLy8gY2MubG9nKFwi6KaB5Yqg5YWl55qE5oi/6Ze05Y+35piv77yaXCIsIHJvb21OdW1iZXIpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tKb2luUm9vbShyb29tTnVtYmVyKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0NsZWFyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubGFiZWxOdW1iZXJzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7XHJcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gXCJcIjtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrRGVsZXRlT25lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBsYWJlbCA9IHRoaXMuX2xhc3ROdW1iZXJMYWJlbCgpO1xyXG4gICAgICBpZiAobGFiZWwpIHtcclxuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9sYXN0RW1wdHlMYWJlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBmb3IgKHZhciBpbmRleCBpbiB0aGlzLmxhYmVsTnVtYmVycykge1xyXG4gICAgICAgIHZhciBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcclxuICAgICAgICBpZiAobGFiZWwuc3RyaW5nID09IG51bGxcclxuICAgICAgICB8fCBsYWJlbC5zdHJpbmcubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgIHJldHVybiBsYWJlbDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9sYXN0TnVtYmVyTGFiZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgZm9yICh2YXIgaW5kZXggPSB0aGlzLmxhYmVsTnVtYmVycy5sZW5ndGggLSAxOyBpbmRleCA+PSAwOyAtLWluZGV4KSB7XHJcbiAgICAgICAgbGV0IGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xyXG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgJiYgbGFiZWwuc3RyaW5nLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIHJldHVybiBsYWJlbDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcm9vbU51bWJlcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5sYWJlbE51bWJlcnMucmVkdWNlKGZ1bmN0aW9uIChyb29tTnVtYmVyLCBsYWJlbCkge1xyXG4gICAgICAgIHJldHVybiByb29tTnVtYmVyICsgKGxhYmVsLnN0cmluZyB8fCBcIlwiKTtcclxuICAgICAgfSwgXCJcIik7XHJcbiAgICB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnbG9naW4nKTtcclxuICAgICAgICB9LCAwLjUpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwidmFyIG1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XHJcbmNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xyXG5jb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY29uc3QgS1FDYXJkRmluZFR5cGVFeHRlbnNpb24gPSByZXF1aXJlKCdLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbicpO1xyXG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xyXG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcclxuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xyXG5jb25zdCBLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyID0gcmVxdWlyZSgnS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlcicpO1xyXG5cclxudmFyIEFQUElEID0gJ3d4ZTg5OTNmNDY4YjE2ZmE1ZCc7XHJcbnZhciBST09NSUQgPSAnJztcclxuLy/mjojmnYPlnLDlnYBcclxuLy/mraPlvI/lnLDlnYBcclxuLy8gdmFyIFJFRElSRUNUX1VSSSA9IFwiaHR0cCUzQSUyRiUyRnd3dy5ob25nZ2VmZW5nLmNuJTJGc3N6V2ViJTJGaW5kZXgucGhwXCI7XHJcbi8vIOa1i+ivleWcsOWdgFxyXG52YXIgUkVESVJFQ1RfVVJJID0gXCJodHRwJTNhJTJmJTJmbzFvMi5jblwiO1xyXG5cclxubGV0IEhSRUYgPSBcImh0dHBzOi8vb3Blbi53ZWl4aW4ucXEuY29tL2Nvbm5lY3Qvb2F1dGgyL2F1dGhvcml6ZT9hcHBpZD1cIitBUFBJRCtcIiZyZWRpcmVjdF91cmk9XCIrUkVESVJFQ1RfVVJJK1wiJnJlc3BvbnNlX3R5cGU9Y29kZSZzY29wZT1zbnNhcGlfdXNlcmluZm8mc3RhdGU9U1RBVEUjd2VjaGF0X3JlZGlyZWN0XCI7XHJcblxyXG5cclxuY2MuQ2xhc3Moe1xyXG5cclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvL3NlbGVjdE5vZGU6Y2MuTm9kZSxcclxuICAgICAgICBhbGVydFByZWZhYjpjYy5QcmVmYWIsXHJcbiAgICAgICAgY2FudmFzTm9kZTpjYy5Ob2RlLFxyXG4gICAgICAgIGxvYWRpbmdOb2RlOmNjLk5vZGUsXHJcbiAgICAgICAgLy9lcnI6Y2MuTm9kZSxcclxuICAgICAgICB3YWl0aW5nUHJlZmFiOmNjLlByZWZhYixcclxuICAgICAgICByZWNvcmRJbmZvOmNjLlByZWZhYixcclxuICAgICAgICBsYWJlbDpjYy5MYWJlbCxcclxuICAgIH0sXHJcblxyXG4gICAgZ29VcGRhdGVBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcIkFwcENvbnRyb2xsZXJcIixcImRvd25sb2FkTmV3VmVyc2lvbjpcIix0aGlzLmlvc1VybCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Ugey8vQW5kcm9pZFxyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL2dvbmdwYS9zc3ovQXBwQWN0aXZpdHlcIiwgXCJkb3dubG9hZE5ld1ZlcnNpb25cIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgdGhpcy5hbmRyb2lkVXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGNoZWNrVmVyc2lvbjpmdW5jdGlvbih2RGF0YSkge1xyXG4gICAgICAgIC8vdmFyIHZlcnNpb24gPSB2RGF0YS52ZXJzaW9uO1xyXG4gICAgICAgIGNjLmluZm8xID0gdkRhdGEudmVyc2lvbjtcclxuICAgICAgICB0aGlzLmlvc1VybCA9IHZEYXRhLmlvc1VybDtcclxuICAgICAgICB0aGlzLmFuZHJvaWRVcmwgPSB2RGF0YS5hbmRyb2lkVXJsO1xyXG4gICAgICAgIC8vaWYgKG1hbmFnZXIudmVyc2lvbiAhPSB2ZXJzaW9uKSB7Ly/mm7TmlrDniYjmnKxcclxuICAgICAgICAvLyAgICB0aGlzLnZlcnNpb25FbmFibGUgPSBmYWxzZTtcclxuICAgICAgICAvLyAgICB0aGlzLmdvVXBkYXRlQWN0aW9uKCk7XHJcbiAgICAgICAgLy8gICAgLy90aGlzLnZlcnNpb25MYWJlbC5zdHJpbmcgPSAn6K+35Yiw5pyN5Yqh5Zmo5pu05paw5Yiw5pyA5paw54mI5pysJztcclxuICAgICAgICAvL31cclxuICAgICAgICAvL2Vsc2Uge1xyXG4gICAgICAgICAgICAvL3RoaXMudmVyc2lvbkxhYmVsLnN0cmluZyA9ICflvZPliY3niYjmnKwgJyArIG1hbmFnZXIudmVyc2lvbjtcclxuICAgICAgICAgICAgaWYoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYoaW9zVmVyc2lvbiAhPSBtYW5hZ2VyLnZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLnZlcnNpb25FbmFibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB2YXIgdXBkYXRlQWxlcnQgPSBjYy5maW5kKFwiQ2FudmFzL3VwZGF0ZVwiKS5nZXRDb21wb25lbnQoXCJhbGVydFwiKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB1cGRhdGVBbGVydC5hbGVydCgpO1xyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgLy8gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52ZXJzaW9uRW5hYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9naW5FbmFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2dpbkFjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwwLjUpO1xyXG4gICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYoYW5kcm9pZFZlcnNpb24gIT0gbWFuYWdlci52ZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy52ZXJzaW9uRW5hYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdmFyIHVwZGF0ZUFsZXJ0ID0gY2MuZmluZChcIkNhbnZhcy91cGRhdGVcIikuZ2V0Q29tcG9uZW50KFwiYWxlcnRcIik7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdXBkYXRlQWxlcnQuYWxlcnQoKTtcclxuICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgIC8vIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmVyc2lvbkVuYWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9naW5FbmFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2luRW5hYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9naW5BY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sMC41KTtcclxuICAgICAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgdGhpcy52ZXJzaW9uRW5hYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgLy8gdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XHJcbiAgICAgICAgICAgICAgLy8gaWYgKGluZm8ubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAvLyAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY29yZElkID0gc2VsZi5nZXRRdWVyeVN0cmluZygncmVjb3JkSWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgIGlmKHJlY29yZElkKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU29ja2V0LnNlbmRHZXRSZWNyb2RGcm9tSWQocmVjb3JkSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgcm9vbUlkID0gc2VsZi5nZXRRdWVyeVN0cmluZyhcInJvb21JZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgIGlmKHJvb21JZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWRhdGEuZXJyY29kZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VuZExvZ2luUmVxdWVzdChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZ2V0X0hSRUYocm9vbUlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFkYXRhIHx8IGRhdGEuZXJyY29kZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dpbkVuYWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2luQWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gc2VsZi5nZXRRdWVyeVN0cmluZyhcImNvZGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByb29tSWQgPSBzZWxmLmdldFF1ZXJ5U3RyaW5nKFwicm9vbUlkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggcm9vbUlkICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighZGF0YS5lcnJjb2RlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbmRMb2dpblJlcXVlc3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2dldF9IUkVGKHJvb21JZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGNvZGUgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7ICAvLyBYTUxIdHRwUmVxdWVzdOWvueixoeeUqOS6juWcqOWQjuWPsOS4juacjeWKoeWZqOS6pOaNouaVsOaNrlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBcIi4vZ2V0X3Rva2VuLnBocFwiOyAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoub3BlbihcIlBPU1RcIiwgdXJsLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmouc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtdHlwZVwiLCBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiKTsgIC8vIOa3u+WKoGh0dHDlpLTvvIzlj5HpgIHkv6Hmga/oh7PmnI3liqHlmajml7blhoXlrrnnvJbnoIHnsbvlnotcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqLnJlYWR5U3RhdGUgPT0gNCAmJiAob2JqLnN0YXR1cyA9PSAyMDAgfHwgb2JqLnN0YXR1cyA9PSAzMDQpKSB7ICAvLyAzMDTmnKrkv67mlLlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KG9iai5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZSggb2JqLnJlc3BvbnNlVGV4dCApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFkYXRhLmVycmNvZGUpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKCBvYmoucmVzcG9uc2VUZXh0ICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VuZExvZ2luUmVxdWVzdCggZGF0YSApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5zZW5kKFwiY29kZT1cIitjb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1jYXRjaChlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSwwLjUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgLy99XHJcbiAgICB9LFxyXG4gICAga2V5QmFja0xpc3RlbjpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX0RPV04sZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT0gY2MuS0VZLmJhY2spIHtcclxuICAgICAgICAgICAgICAgIGlmKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKXtcclxuICAgICAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiYmFja1RvRGVza1wiLCBcIigpVlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sdGhpcyk7XHJcbiAgICB9LFxyXG4gICAgLy/pmo/mnLrnlJ/miJAgbnVtIOS9jSDnmoTpmo/mnLrmlbAg5ZCr5aSn5bCP5YaZ5a2X5q+N5Y+K5pWw5a2XXHJcbiAgICBnZXRSYW5kb21BY2NvdW50OmZ1bmN0aW9uKG51bSlcclxuICAgIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDov5Tlm57kuIDkuKrlrZfmr41cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBnZXRDaGFyYWN0ZXIoZmxhZyl7XHJcbiAgICAgICAgICAgIHZhciBjaGFyYWN0ZXIgPSBcIlwiO1xyXG4gICAgICAgICAgICBpZihmbGFnID09PSBcImxvd2VyXCIpe1xyXG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyID0gU3RyaW5nLmZyb21DaGFyQ29kZShNYXRoLmZsb29yKCBNYXRoLnJhbmRvbSgpICogMjYpICsgXCJhXCIuY2hhckNvZGVBdCgwKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoZmxhZyA9PT0gXCJ1cHBlclwiKXtcclxuICAgICAgICAgICAgICAgIGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoTWF0aC5mbG9vciggTWF0aC5yYW5kb20oKSAqIDI2KSArIFwiQVwiLmNoYXJDb2RlQXQoMCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjaGFyYWN0ZXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgc3RyID0gXCJcIjtcclxuICAgICAgICBmb3IodmFyIGk9MDtpPG51bTtpKyspXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgZmxhZyA9IFwibG93ZXJcIiA7XHJcbiAgICAgICAgICAgIHZhciByYW5kb20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzKTtcclxuICAgICAgICAgICAgaWYocmFuZG9tID09IDApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGZsYWcgPSBcInVwcGVyXCIgO1xyXG4gICAgICAgICAgICAgICAgc3RyICs9IGdldENoYXJhY3RlcihmbGFnKTtcclxuICAgICAgICAgICAgfWVsc2UgaWYocmFuZG9tID09IDEpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0ciArPSBnZXRDaGFyYWN0ZXIoZmxhZyk7XHJcbiAgICAgICAgICAgIH1lbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0ciArPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgIH0sXHJcbiAgICBnZXRHdWVzdFVzZXJJbmZvOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgbGV0IHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XHJcbiAgICAgICAgdmFyIG9wZW5pZCA9IFwiZ3Vlc3RfXCIgKyB0aGlzLmdldFJhbmRvbUFjY291bnQoOCk7XHJcbiAgICAgICAgdmFyIHVuaW9uaWQgPSAnZ3Vlc3RfJyArIHRoaXMuZ2V0UmFuZG9tQWNjb3VudCg4KTtcclxuICAgICAgICB2YXIgbmlja25hbWUgPSB0aGlzLmdldFJhbmRvbUFjY291bnQoOCk7XHJcbiAgICAgICAgdmFyIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcclxuICAgICAgICByZXR1cm4gdGVzdERhdGE7XHJcbiAgICB9LFxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5rZXlCYWNrTGlzdGVuKCk7XHJcbiAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSAmJiBjYy5zeXMuaXNNb2JpbGUpe1xyXG4gICAgICAgICAgICB2YXIgY2FudmFzID0gY2MuZmluZChcIkNhbnZhc1wiKTtcclxuICAgICAgICAgICAgdmFyIGN2cyA9IGNhbnZhcy5nZXRDb21wb25lbnQoY2MuQ2FudmFzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlci5zdGFydCgpO1xyXG4gICAgICAgIHRoaXMuc29ja2V0ID0gY2MuZmluZCgnR2FtZVNvY2tldCcpLmdldENvbXBvbmVudCgnc29ja2V0Jyk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubG9naW5FbmFibGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNvY2tldC5yZWNldmljZU1lc3NhZ2UgPSBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpXHJcbiAgICAgICAgICAgIGlmIChkYXRhLmFjdGlvbiA9PSAnY2hlY2tWZXJzaW9uJykge1xyXG4gICAgICAgICAgICAgIHRyeXtcclxuICAgICAgICAgICAgICAgIHNlbGYuY2hlY2tWZXJzaW9uKGRhdGEuZGF0YSk7XHJcbiAgICAgICAgICAgICAgfWNhdGNoKGUpe1xyXG4gICAgICAgICAgICAgICAgLy90aGlzLmVyci5zdHJpbmcgPSBlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChkYXRhLmFjdGlvbiA9PSAnbG9naW4nKSB7XHJcbiAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3VsdCkgey8v5oiQ5YqfXHJcbiAgICAgICAgICAgICAgICAgICBzZWxmLnNvY2tldC51c2VySW5mbyA9IGRhdGEuZGF0YTsvL+i/kOihjOaXtuaAgeS/oeaBr1xyXG4gICAgICAgICAgICAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgcm9vbUlkID0gc2VsZi5nZXRRdWVyeVN0cmluZyhcInJvb21JZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocm9vbUlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgIGlmKHJvb21JZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhLmRhdGEuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleGl0SW5Sb29tID0gZGF0YS5kYXRhLnJvb21JZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZXhpdEluUm9vbSAhPSBcIlwiKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICByb29tSWQgPSBleGl0SW5Sb29tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNvY2tldC5zZW5kTG9naW5Kb2luKHJvb21JZCwgdXNlcklkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9sb2FkaW5nTGFiZWwoXCLnmbvlvZXkuK1cIik7XHJcbiAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhLnJvb21JZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xyXG4gICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAvLyBzZWxmLmFsZXJ0TWVzc2FnZSgn55m75b2V5aSx6LSlIScpO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJTb2NrZXRFdmVudCgpO1xyXG5cclxuICAgICAgICB0aGlzLnNvY2tldC5nZXRXeEluZm8gPSBmdW5jdGlvbihpbmZvKSB7XHJcbiAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyhpbmZvKTsvL+S/neWtmOacrOWcsFxyXG4gICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShpbmZvKTsvL3N0ciAtPiBqc29uKG9iailcclxuICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbigpey8v5bu26L+f5omn6KGMIDFzXHJcbiAgICAgICAgICAgICAgIHNlbGYuc2VuZExvZ2luUmVxdWVzdChkYXRhKTsvL+eZu+W9leivt+axglxyXG4gICAgICAgICAgIH0sMSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldE9ubHlVc2VySW5mb0J5QnJvd3NlcigpO1xyXG4gICAgICAgIC8vY2Muc3lzLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwidXNlcmluZm9cIik7XHJcbiAgICAgICAgLy8gbGV0IHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XHJcbiAgICAgICAgLy8gdmFyIG9wZW5pZCA9IFwiSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TU16b3dPQ2M9XCI7XHJcbiAgICAgICAgLy8gdmFyIHVuaW9uaWQgPSAnOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHYnO1xyXG4gICAgICAgIC8vIHZhciBuaWNrbmFtZSA9IFwi5ZOH5ZOI5ZOIXCI7XHJcblxyXG5cclxuICAgICAgICAvL3ZhciBvcGVuaWQgPSBcIkp6SXdNVGN2Tmk4eE5pRGt1SXJsallneE1Nem93T0NjPVwiO1xyXG4gICAgICAgIC8vdmFyIG9wZW5pZCA9IFwiZ3Vlc3RfXCIgKyB0aGlzLmdldFJhbmRvbUFjY291bnQoOCk7XHJcbiAgICAgICAgLy92YXIgdW5pb25pZCA9ICc4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9Mdic7XHJcbiAgICAgICAgLy92YXIgdW5pb25pZCA9ICdndWVzdF8nICsgdGhpcy5nZXRSYW5kb21BY2NvdW50KDgpO1xyXG4gICAgICAgIC8vdmFyIG5pY2tuYW1lID0gdGhpcy5nZXRSYW5kb21BY2NvdW50KDgpO1xyXG5cclxuXHJcbiAgICAgICAgIC8vaWYgKHNlYXJjaCkge1xyXG4gICAgICAgICAvLyAgICB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcclxuICAgICAgICAgLy8gICAgdmFyIGxvYyA9IHVybC5zdWJzdHJpbmcodXJsLmxhc3RJbmRleE9mKCc9JykgKyAxLCB1cmwubGVuZ3RoKTtcclxuICAgICAgICAgLy8gICAgaWYgKGxvYyA9PSAxKSB7XHJcbiAgICAgICAgIC8vICAgICAgICBvcGVuaWQgPSAnSnpJd01UY3ROaTB4TmlBd09UbzBOVG8xT1NjPSc7XHJcbiAgICAgICAgIC8vICAgICAgICB1bmlvbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvMU9TYyc7XHJcbiAgICAgICAgIC8vICAgICAgICBuaWNrbmFtZSA9IGxvYztcclxuICAgICAgICAgLy8gICAgfVxyXG4gICAgICAgICAvLyAgICBlbHNlIGlmIChsb2MgPT0gMikge1xyXG4gICAgICAgICAvLyAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN2Tmk4eE5pRGt1SXJsallnNU9qTTRPak16Snc9PSc7XHJcbiAgICAgICAgIC8vICAgICAgICB1bmlvbmlkID0gJ0p6SXdNVGN2Tmk4eE5pRGt1SXJsallnNU9qTTRPak16SncnO1xyXG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XHJcbiAgICAgICAgIC8vICAgIH1cclxuICAgICAgICAgLy8gICAgZWxzZSBpZiAobG9jID09IDMpIHtcclxuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdE5pMHhOaUF3T1RvME5Ub2M9JztcclxuICAgICAgICAgLy8gICAgICAgIHVuaW9uaWQgPSAnOGRPdEFjRGljNVNpY2h2M2x4dE1YWW11blRMT0x2JztcclxuICAgICAgICAgLy8gICAgICAgIG5pY2tuYW1lID0gbG9jO1xyXG4gICAgICAgICAvLyAgICB9XHJcbiAgICAgICAgIC8vICAgIGVsc2UgaWYgKGxvYyA9PSA0KSB7XHJcbiAgICAgICAgIC8vICAgICAgICBvcGVuaWQgPSAnb3psWEl3Z3ZfUUpUMHlrZFVpaGFBQm1zV3AyQSc7XHJcbiAgICAgICAgIC8vICAgICAgICB1bmlvbmlkID0gJ28tMzkxMXFXc1FzVzN3VW9kcUZmVXRic0FlTmsnO1xyXG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XHJcbiAgICAgICAgIC8vICAgIH1cclxuICAgICAgICAgLy8gICAgZWxzZSBpZiAobG9jID09IDUpIHtcclxuICAgICAgICAgLy8gICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZ3hNRG93TXpvd09DYz0nO1xyXG4gICAgICAgICAvLyAgICAgICAgIHVuaW9uaWQgPSAnby1Kekl3TVRjdk5pOHhOaURrdUlybGpZZ3hNRG93TSc7XHJcbiAgICAgICAgIC8vICAgICAgICBuaWNrbmFtZSA9IGxvYztcclxuICAgICAgICAgLy8gICAgfWVsc2UgaWYobG9jID09IDYpe1xyXG4gICAgICAgICAvLyAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN2Tmk4eE5pRGt1SXJsallneE1Nem9jPSc7XHJcbiAgICAgICAgIC8vICAgICAgICAgdW5pb25pZCA9ICdvLXpJd01UY3ZOaTh4TmlEa3VJcmwnO1xyXG4gICAgICAgICAvLyAgICAgICAgbmlja25hbWUgPSBsb2M7XHJcbiAgICAgICAgIC8vICAgIH1cclxuICAgICAgICAgLy9cclxuICAgICAgICAgLy99XHJcbiAgICAgICAgLy8gdmFyIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcclxuXHJcblxyXG4gICAgICAgICAvL2lmICghY2Muc3lzLmlzTmF0aXZlKXtcclxuICAgICAgICAgLy8gICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XHJcbiAgICAgICAgIC8vICAgIGlmIChpbmZvLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgLy8gICAgICAgIC8vdGhpcy5zaG93V2FpdGluZ01lc3NhZ2UoJ+W3suWtmOaciei0puWPtz09PT09Jyk7XHJcbiAgICAgICAgIC8vICAgICAgICAvL3JldHVybjtcclxuICAgICAgICAgLy8gICAgfWVsc2VcclxuICAgICAgICAgLy8gICAge1xyXG4gICAgICAgICAvLyAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5paw6LSm5Y+3PT09PT0nKTtcclxuICAgICAgICAgLy8gICAgICAgIHZhciB1c2VySW5mbyA9IHRoaXMuZ2V0R3Vlc3RVc2VySW5mbygpO1xyXG4gICAgICAgICAvLyAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyh1c2VySW5mbyk7XHJcbiAgICAgICAgIC8vICAgIH1cclxuICAgICAgICAgLy99XHJcbiAgICB9LFxyXG5cclxuICAgIGdldE9ubHlVc2VySW5mb0J5QnJvd3NlcjpmdW5jdGlvbigpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIG9wZW5pZCA9IFwiXCI7XHJcbiAgICAgICAgdmFyIHVuaW9uaWQgPSBcIlwiO1xyXG4gICAgICAgIHZhciBuaWNrbmFtZSA9IFwiXCI7XHJcblxyXG4gICAgICAgIHZhciB0ZXN0RGF0YSA9IFwiXCI7XHJcbiAgICAgICAgdmFyIHVzZXJJbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xyXG5cclxuICAgICAgICBsZXQgc2VhcmNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcclxuICAgICAgICBpZih1c2VySW5mby5sZW5ndGggPiAwKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgb3BlbmlkID0gdXNlckluZm8ub3BlbklkO1xyXG4gICAgICAgICAgICB1bmlvbmlkID0gdXNlckluZm8udW5pb25pZDtcclxuICAgICAgICAgICAgbmlja25hbWUgPSB1c2VySW5mby5uaWNrbmFtZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChzZWFyY2gpIHtcclxuICAgICAgICAgICAgdmFyIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XHJcbiAgICAgICAgICAgIHZhciBsb2MgPSB1cmwuc3Vic3RyaW5nKHVybC5sYXN0SW5kZXhPZignPScpICsgMSwgdXJsLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIGlmIChsb2MgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvMU9TYz0nO1xyXG4gICAgICAgICAgICAgICAgdW5pb25pZCA9ICdKekl3TVRjdE5pMHhOaUF3T1RvME5UbzFPU2MnO1xyXG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzFcIjtcclxuICAgICAgICAgICAgICAgIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChsb2MgPT0gMikge1xyXG4gICAgICAgICAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN2Tmk4eE5pRGt1SXJsallnNU9qTTRPak16Snc9PSc7XHJcbiAgICAgICAgICAgICAgICB1bmlvbmlkID0gJ0p6SXdNVGN2Tmk4eE5pRGt1SXJsallnNU9qTTRPak16SncnO1xyXG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzJcIjtcclxuICAgICAgICAgICAgICAgIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChsb2MgPT0gMykge1xyXG4gICAgICAgICAgICAgICAgb3BlbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvYz0nO1xyXG4gICAgICAgICAgICAgICAgdW5pb25pZCA9ICc4ZE90QWNEaWM1U2ljaHYzbHh0TVhZbXVuVExPTHYnO1xyXG4gICAgICAgICAgICAgICAgbmlja25hbWUgPSBcImd1ZXN0XzNcIjtcclxuICAgICAgICAgICAgICAgIHRlc3REYXRhID0gJ3tcIm9wZW5pZFwiOlwiJytvcGVuaWQrJ1wiLFwibmlja25hbWVcIjpcIicrbmlja25hbWUrJ1wiLFwidW5pb25pZFwiOlwiJyt1bmlvbmlkKydcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvOEQ4ZE90QWNEaWM1U2ljaHYzbHh0TVhZSmdtdW5UTE9MdlRUNUFGTTR6YXFLRXRoWmlidjh4ZFdrZ2pOOVliNEFRbnd2U3VyejI3VUIyOXh4ODFYT1J3eDU1WGFueHFjdGREXFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChsb2MgPT0gNCkge1xyXG4gICAgICAgICAgICAgICAgb3BlbmlkID0gJ296bFhJd2d2X1FKVDB5a2RVaWhhQUJtc1dwMkEnO1xyXG4gICAgICAgICAgICAgICAgdW5pb25pZCA9ICdvLTM5MTFxV3NRc1czd1VvZHFGZlV0YnNBZU5rJztcclxuICAgICAgICAgICAgICAgIG5pY2tuYW1lID0gXCJndWVzdF80XCI7XHJcbiAgICAgICAgICAgICAgICB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCInK25pY2tuYW1lKydcIixcInVuaW9uaWRcIjpcIicrdW5pb25pZCsnXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAobG9jID09IDUpIHtcclxuICAgICAgICAgICAgICAgIG9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZ3hNRG93TXpvd09DYz0nO1xyXG4gICAgICAgICAgICAgICAgIHVuaW9uaWQgPSAnby1Kekl3TVRjdk5pOHhOaURrdUlybGpZZ3hNRG93TSc7XHJcbiAgICAgICAgICAgICAgICBuaWNrbmFtZSA9IFwiZ3Vlc3RfNVwiO1xyXG4gICAgICAgICAgICAgICAgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwiJytuaWNrbmFtZSsnXCIsXCJ1bmlvbmlkXCI6XCInK3VuaW9uaWQrJ1wiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC84RDhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2VFQ1QUZNNHphcUtFdGhaaWJ2OHhkV2tnak45WWI0QVFud3ZTdXJ6MjdVQjI5eHg4MVhPUnd4NTVYYW54cWN0ZERcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xyXG4gICAgICAgICAgICB9ZWxzZSBpZihsb2MgPT0gNil7XHJcbiAgICAgICAgICAgICAgICBvcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TU16b2M9JztcclxuICAgICAgICAgICAgICAgICB1bmlvbmlkID0gJ28tekl3TVRjdk5pOHhOaURrdUlybCc7XHJcbiAgICAgICAgICAgICAgICBuaWNrbmFtZSA9IFwiZ3Vlc3RfNlwiO1xyXG4gICAgICAgICAgICAgICAgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwiJytuaWNrbmFtZSsnXCIsXCJ1bmlvbmlkXCI6XCInK3VuaW9uaWQrJ1wiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC84RDhkT3RBY0RpYzVTaWNodjNseHRNWFlKZ211blRMT0x2VFQ1QUZNNHphcUtFdGhaaWJ2OHhkV2tnak45WWI0QVFud3ZTdXJ6MjdVQjI5eHg4MVhPUnd4NTVYYW54cWN0ZERcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgICBpZih0ZXN0RGF0YSAmJiB0ZXN0RGF0YS5sZW5ndGggPiAwKVxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyh0ZXN0RGF0YSk7XHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBfcmVnaXN0ZXJTb2NrZXRFdmVudDpmdW5jdGlvbigpe1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVMb2dpbkpvaW4sIHRoaXMuX0xvZ2luSm9pbiwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVJlY29yZElkLCB0aGlzLl9SZWNlaXZlUmVjb3JkSWQsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVOb1Vpb25pZCwgdGhpcy5fUmVjZWl2ZU5vVWlvbmlkLCB0aGlzKTtcclxuICAgIH0sIFxyXG4gICAgX2dldF9IUkVGOmZ1bmN0aW9uKHJvb21JZCl7XHJcbiAgICAgIGlmKHJvb21JZCAhPSBST09NSUQpe1xyXG4gICAgICAgIFJPT01JRCA9IHJvb21JZDtcclxuICAgICAgICByb29tSWQgPSBcIiUzZnJvb21JZCUzZFwiK3Jvb21JZCA7XHJcbiAgICAgICAgUkVESVJFQ1RfVVJJID0gUkVESVJFQ1RfVVJJK3Jvb21JZDtcclxuICAgICAgICBIUkVGID0gXCJodHRwczovL29wZW4ud2VpeGluLnFxLmNvbS9jb25uZWN0L29hdXRoMi9hdXRob3JpemU/YXBwaWQ9XCIrQVBQSUQrXCImcmVkaXJlY3RfdXJpPVwiK1JFRElSRUNUX1VSSStcIiZyZXNwb25zZV90eXBlPWNvZGUmc2NvcGU9c25zYXBpX3VzZXJpbmZvJnN0YXRlPVNUQVRFI3dlY2hhdF9yZWRpcmVjdFwiO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgX1JlY2VpdmVOb1Vpb25pZDpmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oXCJcIik7XHJcbiAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgdmFyIHJvb21JZCA9IHRoaXMuZ2V0UXVlcnlTdHJpbmcoXCJyb29tSWRcIik7XHJcbiAgICAgIGlmKHJvb21JZCl7XHJcbiAgICAgICAgLy9yb29tSWQgPSBcIiUzZnJvb21JZCUzZFwiK3Jvb21JZCA7XHJcbiAgICAgICAgLy9SRURJUkVDVF9VUkkgPSBSRURJUkVDVF9VUkkrcm9vbUlkO1xyXG4gICAgICAgIHRoaXMuX2dldF9IUkVGKHJvb21JZCk7XHJcbiAgICAgIH1cclxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgIHNlbGYubG9hZGluZ05vZGUucGFyZW50LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHNlbGYubG9hZGluZ05vZGUuc3RvcEFsbEFjdGlvbnMoKTtcclxuICAgICAgfSwyMDAwKVxyXG4gICAgICB0aGlzLl9sb2FkaW5nTGFiZWwoXCLnmbvlvZXlpLHotKXvvIzor7fph43mlrDnmbvlvZVcIik7XHJcbiAgICB9LFxyXG4gICAgX1JlY2VpdmVSZWNvcmRJZDpmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIGlmKGRhdGEucmVjb3JkTXNnLmxlbmd0aD4wKXtcclxuICAgICAgICAgIHZhciByZWNvcmQgPSBkYXRhLnJlY29yZE1zZ1swXTtcclxuICAgICAgICAgIHZhciBwbGF5ZXJzSW5mbyA9IEpTT04ucGFyc2UocmVjb3JkLnBsYXllcnNJbmZvKS5wbGF5ZXJzO1xyXG4gICAgICAgICAgdmFyIHJlY29yZE5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnJlY29yZEluZm8pO1xyXG4gICAgICAgICAgbGV0IHRvdGFsR2FtZVJlc3VsdCA9IHJlY29yZE5vZGUuZ2V0Q29tcG9uZW50KFwiVG90YWxHYW1lUmVzdWx0XCIpO1xyXG4gICAgICAgICAgcGxheWVyc0luZm8uc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBiLnRvdGFsU2NvcmUtYS50b3RhbFNjb3JlfSk7ICAvLyDmjpLluo9cclxuICAgICAgICAgIHRvdGFsR2FtZVJlc3VsdC5zZXRQbGF5ZXJJbmZvcyhwbGF5ZXJzSW5mbyxyZWNvcmQpO1xyXG4gICAgICAgICAgdG90YWxHYW1lUmVzdWx0Ll9jbGlja0J0bigpO1xyXG4gICAgICAgICAgcmVjb3JkTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcclxuICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChyZWNvcmROb2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgX0xvZ2luSm9pbjogZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdMYWJlbChcIui/m+WFpeaIv+mXtO+8jOato+WcqOS4uuaCqOivt+axguaVsOaNrlwiKTtcclxuICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0KXtcclxuICAgICAgICAgICAgaWYoY2MuZnJvbSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjYy5mcm9tID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MuZnJvbS5tYSA9IHJlc3BvbnNlLmRhdGEubWFQYWk7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNjLmpvaW5EZXNrID0ge307XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgICAgICBsZXQgcmVhc29uSW5mbyA9IHRoaXMuX2pvaW5SZWFzb25NYXAocmVzcG9uc2UuZGF0YS5yZWFzb24pO1xyXG4gICAgICAgICAgICBjYy5qb2luRGVzay5yZXN1bHQgPSByZXNwb25zZS5yZXN1bHQ7XHJcbiAgICAgICAgICAgIGNjLmpvaW5EZXNrLnJlYXNvbiA9IHJlYXNvbkluZm87XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIF9qb2luUmVhc29uTWFwOiBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgIGxldCByZWFzb25JbmZvID0ge1xyXG4gICAgICAgIG5vdEV4aXN0OiBcIuaIv+mXtOS4jeWtmOWcqCFcIixcclxuICAgICAgICBjYXJkTnVtYmVyOiBcIuaCqOaIv+WNoeS4jei2syFcIixcclxuICAgICAgfTtcclxuICAgICAgbGV0IGluZm8gPSByZWFzb25JbmZvW3JlYXNvbl0gfHwgXCLmiL/pl7Tlt7Lmu6EhXCI7XHJcbiAgICAgIHJldHVybiBpbmZvO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRRdWVyeVN0cmluZzogZnVuY3Rpb24obmFtZSl7XHJcbiAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoXnwmKVwiICsgbmFtZSArIFwiPShbXiZdKikoJnwkKVwiLCBcImlcIik7IFxyXG4gICAgICAgIHZhciByID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSkubWF0Y2gocmVnKTsgXHJcbiAgICAgICAgaWYgKHIgIT0gbnVsbCkgcmV0dXJuIHVuZXNjYXBlKHJbMl0pOyByZXR1cm4gbnVsbDsgXHJcbiAgICB9LFxyXG5cclxuICAgIGFncmVlbWVudHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmFncmVlbWVudE5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL3RoaXMuYWdyZWVtZW50TGFiZWwuc3RyaW5nID0gY2MuaW5mbzE7XHJcbiAgICAgICAgdGhpcy5hZ3JlZW1lbnRMYWJlbC5ub2RlLnkgPSAwO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5zb2NrZXQucmVjZXZpY2VNZXNzYWdlID0gZnVuY3Rpb24gKCkge307XHJcbiAgICB9LFxyXG5cclxuICAgIF9sb2FkaW5nTGFiZWw6ZnVuY3Rpb24obGFiZWwpe1xyXG4gICAgICAgIHRoaXMubGFiZWwuc3RyaW5nID0gbGFiZWw7XHJcbiAgICB9LFxyXG5cclxuICAgIHNlbmRMb2dpblJlcXVlc3Q6ZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIC8vdGhpcy5zaG93V2FpdGluZ01lc3NhZ2UoJ+eZu+W9leS4rS4uLicpO1xyXG4gICAgICAgIHRoaXMubG9hZGluZ05vZGUucGFyZW50LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5sb2FkaW5nTm9kZS5ydW5BY3Rpb24oY2MucmVwZWF0Rm9yZXZlcihjYy5yb3RhdGVCeSgyLCAzNjApKSk7XHJcbiAgICAgICAgLy9yZXR1cm47XHJcbiAgICAgICAgdGhpcy5zb2NrZXQuc2VuZE1lc3NhZ2UoJ2xvZ2luJyxkYXRhKTtcclxuICAgIH0sXHJcblxyXG4gICAgbG9naW5BY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICB2YXIgaW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcclxuICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgLy90aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5bey5a2Y5pyJ6LSm5Y+3PT09PT0nKTtcclxuICAgICAgICAgICAgICAgIC8vcmV0dXJuO1xyXG4gICAgICAgICAgICB9ZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMuc2hvd1dhaXRpbmdNZXNzYWdlKCfmlrDotKblj7c9PT09PScpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJbmZvID0gdGhpcy5nZXRHdWVzdFVzZXJJbmZvKCk7XHJcbiAgICAgICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKHVzZXJJbmZvKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XHJcbiAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pO1xyXG4gICAgICAgICAgdGhpcy5zZW5kTG9naW5SZXF1ZXN0KGRhdGEpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgIC8vIGNjLnN5cy5vcGVuVVJMKEhSRUYpO1xyXG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IEhSRUY7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4TG9naW5cIik7Ly9JT1NcclxuICAgICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4TG9naW5cIiwgXCIoKVZcIik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICBjaGFuZ2VHdWVzdFVzZXJJbmZvOmZ1bmN0aW9uKClcclxuICAgIHtcclxuICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKCcnKTtcclxuICAgICAgICB0aGlzLmxvZ2luQWN0aW9uKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGxvZ2luWWtBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy92YXIgY29tcCA9IHRoaXMuc2VsZWN0Tm9kZS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xyXG4gICAgICAgIC8vaWYgKCFjb21wLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgLy8gICAgdGhpcy5zaG93TXNnID0gY2MuaW5zdGFudGlhdGUodGhpcy5hbGVydFByZWZhYik7XHJcbiAgICAgICAgLy8gICAgdGhpcy5jYW52YXNOb2RlLmFkZENoaWxkKHRoaXMuc2hvd01zZyk7XHJcbiAgICAgICAgLy8gICAgbGV0IGNvbXAgPSB0aGlzLnNob3dNc2cuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIC8vICAgIGNvbXAuc2V0TWVzc2FnZSgn6K+35ZCM5oSP55So5oi35Y2P6K6uJyk7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIHZhciB0ZXN0RGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgdmFyIHRpbWUgPSBcIidcIit0ZXN0RGF0ZS50b0xvY2FsZVN0cmluZygpK1wiJ1wiO1xyXG4gICAgICAgIHZhciBvcGVuaWQgPSBuZXcgQnVmZmVyKHRpbWUpLnRvU3RyaW5nKCdiYXNlNjQnKTtcclxuICAgICAgICB2YXIgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwi5ri45a6iXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcL0JWeXo0UjhxNnB1SmliRXYxaHJzYVRtSUtRaGthVFM5Rnl2Y2V2dkM1aGx4Rm5mT3VzcERqaWNHMEd0enlKWE9oTlQ3ZzFXWkRlQ0RRaG5SZEVPZ3ozUU1uUDBGOWlib1FHeVxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHRlc3REYXRhKTtcclxuICAgICAgICB0aGlzLnNlbmRMb2dpblJlcXVlc3QoZGF0YSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzaG93V2FpdGluZ01lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XHJcbiAgICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCAmJiBjYy5zeXMuaXNOYXRpdmUgJiYgY2MuaXNWYWxpZCh0aGlzLndhaXRpbmdOb2RlKSkge1xyXG4gICAgICAgICAgaWYgKG1zZyA9PSB0aGlzLndhaXRpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5nZXRNZXNzYWdlKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLndhaXRpbmdOb2RlLnJlbW92ZUZyb21QYXJlbnQoKTtcclxuICAgICAgICAgICAgdGhpcy53YWl0aW5nTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMud2FpdGluZ05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xyXG4gICAgICAgIHRoaXMuY2FudmFzTm9kZS5hZGRDaGlsZCh0aGlzLndhaXRpbmdOb2RlKTtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coY29tcCk7XHJcblxyXG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgIGNvbXAuYWxlcnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgaGlkZGVuV2FpdGluZ01lc3NhZ2U6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLndhaXRpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBwcm90b2NvbEFjdGlvbjpmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy5sb2coJ3Byb3RvY29sIGFjdGlvbicpO1xyXG4gICAgfSxcclxufSk7XHJcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbWFQYWlTcHJpdGU6W2NjLlNwcml0ZUZyYW1lXSxcclxuICAgICAgICBzcHJpdGVOb2RlOmNjLlNwcml0ZSxcclxuICAgICAgICBsYWJlbE5vZGU6Y2MuTm9kZVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICBcclxufSk7XHJcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgdmVyc2lvbjondjEuMC4wJyxcclxuXHJcbiAgICBzZXRVc2VySW5mbzpmdW5jdGlvbihzdHIpIHtcclxuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJpbmZvJywgc3RyKTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0VXNlckluZm86ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyaW5mbycpO1xyXG4gICAgICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH0sXHJcblxyXG4gICAgc2V0TXVzaWNWYWx1ZTpmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbXVzaWNWb2x1bW4nLHZhbHVlKTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0TXVzaWNWYWx1ZTpmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgdmFsdWUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ211c2ljVm9sdW1uJyk7XHJcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRNdXNpY0VmZmVjdFZhbHVlOmZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdtdXNpY0VmZmVjdFZvbHVtbicsdmFsdWUpO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRNdXNpY0VmZmVjdFZhbHVlOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbXVzaWNFZmZlY3RWb2x1bW4nKTtcclxuICAgICAgICBpZiAoIXZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9LFxyXG59O1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIG5vZGVzOltjYy5Ob2RlXSxcclxuICAgICAgICAvL3NlbGVjdGVkSW5kZXg6IDAsXHJcbiAgICAgICAgIF9zZWxlY3RlZDoxLFxyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMqL1xyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX3NlbGVjdCA9IHRydWU7IFxyXG4gICAgICAgIHZhciBvdmVyVGltZSA9IDA7XHJcbiAgICAgICAgaWYoY2Muc2V0KXtcclxuICAgICAgICAgICAgb3ZlclRpbWUgPSBjYy5zZXQuc2V0dGluZzY7XHJcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdGVkID0gdGhpcy5fc2VsZWN0ID0gb3ZlclRpbWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgYWN0aXZlID0gdGhpcy5fc2VsZWN0O1xyXG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RlZCA9IHRoaXMuX3NlbGVjdDtcclxuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKGFjdGl2ZSk7XHJcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMubm9kZXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XHJcbiAgICAgICAgICAgIGlmKCBzZWxmLl9zZWxlY3QgKXtcclxuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0Q29tcCA9IHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcclxuICAgICAgICAgICAgdENvbXAuaW5kZXggPSBpO1xyXG4gICAgICAgICAgICB0Q29tcC5jbGlja0FjdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZCggc2VsZi5fc2VsZWN0ZWQgPSBzZWxmLl9zZWxlY3QgPSAhc2VsZi5fc2VsZWN0ICk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0aXRsZVwiKTtcclxuICAgICAgICAgICAgICAgIGlmKCBzZWxmLl9zZWxlY3QgKXtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlbGYub25TZWxlY3RDaGFuZ2UodGhpcy5pbmRleCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJvcmRlcnNcIiAmJiBjYy5zZXQpe1xyXG4gICAgICAgICAgICAvL3RoaXMucmVtZW1iZXJfc2V0KG92ZXJUaW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgcmVtZW1iZXJfc2V0OmZ1bmN0aW9uKG9iail7XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jykuc2V0U2VsZWN0ZWQob2JqKTtcclxuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XHJcbiAgICAgICAgICAgIGlmKCBvYmogKXtcclxuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMubm9kZXNbMF0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJyk7XHJcbiAgICAgICAgICAgICAgICB0aXRsZS5jb2xvciA9IG5ldyBjYy5Db2xvcigxMywyMTAsMjIyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgb25TZWxlY3RDaGFuZ2U6IGZ1bmN0aW9uIChzZWxlY3RJbmRleCkge1xyXG4gICAgICAgIC8vY2MubG9nKHNlbGVjdEluZGV4KTtcclxuICAgIH0sXHJcbiAgICBcclxufSk7XHJcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xyXG5jb25zdCBBcnJheUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0FycmF5RXh0ZW5zaW9uJyk7XHJcbmNvbnN0IE1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XHJcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xyXG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XHJcbmNvbnN0IFVzZXJNb2RlbEhlbHBlciA9IHJlcXVpcmUoJ1VzZXJNb2RlbEhlbHBlcicpO1xyXG5jb25zdCBQbGF5YmFjayA9IHJlcXVpcmUoJ1BsYXliYWNrJyk7XHJcbmNvbnN0IGZlY2hhID0gcmVxdWlyZSgnZmVjaGEnKTtcclxudmFyIG1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XHJcbi8qIyMjIyMqL1xyXG5jb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcclxuLyoqL1xyXG5jb25zdCBQbGF5ZXIgPSByZXF1aXJlKCdQbGF5ZXInKTtcclxuLyoqL1xyXG4vL2NvbnN0IGlzVGVTaHVQYWkgPSByZXF1aXJlKCdpc1RlU2h1UGFpJyk7IFxyXG4vL+eJueauiueJjOexu+Wei1xyXG52YXIgVEVTSFVQQUlUWVBFID0ge1xyXG4gICAgaXNUZVNodVBhaTpmYWxzZSxcclxuICAgIGlzTGl1RHVpQmFuOmZhbHNlLFxyXG4gICAgaXNTYW5TaHVuWmk6ZmFsc2UsXHJcbiAgICBpc1NhblRhb0h1YTpmYWxzZSxcclxuXHJcbiAgICBpc1FpbmdMb25nOmZhbHNlLFxyXG4gICAgaXNZaVRpYW9Mb25nOmZhbHNlLFxyXG4gICAgaXNTYW5Ub25nSHVhU2h1bjpmYWxzZSxcclxuICAgIGlzU2FuRmVuVGlhblhpYTpmYWxzZSxcclxuICAgIGlzQ291WWlTZTpmYWxzZSxcclxuICAgIGlzU2lUYW9TYW5UaWFvOmZhbHNlLFxyXG4gICAgaXNXdUR1aVNhblRpYW86ZmFsc2VcclxufTtcclxuXHJcbmxldCBHQU1FU1RBVFVTID0ge1xyXG4gICAgV0FJVF9QRU9QTEU6IDAsICAgIC8vIOetieS6ulxyXG4gICAgV0FJVF9SRUFEWTogMSwgICAgIC8vIOetieW+heS7luS6uuWHhuWkh1xyXG4gICAgUExBWUlORzogMiwgICAgICAgIC8vIOato+WcqOeOqea4uOaIj1xyXG59O1xyXG52YXIgc1RpdGxlID0gJyc7XHJcbnZhciBzRGVzY3JpcHRpb24gPSAnJztcclxudmFyIHNJZCA9ICcnO1xyXG4vLyDluIPlsYBcclxuLy8gICAgICAgICAgMlxyXG4vLyAgIDMgICAgICAgICAgICAxXHJcbi8vICAgICBzZWxmIDBcclxubGV0IFBsYXkgPSBjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHBsYXllck5vZGVzOiBbY2MuTm9kZV0sXHJcbiAgICAgICAgLy9wbGF5c0NvaW5zOiBbY2MuTm9kZV0sXHJcbiAgICAgICAgY2hhdE5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lTm9kZTogY2MuTm9kZSxcclxuICAgICAgICB0eXBlQnV0dG9uc05vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgcGhvbmU6Y2MuTGFiZWwsXHJcbiAgICAgICAgbGFiZWxSb29tTnVtYmVyOiBjYy5MYWJlbCxcclxuICAgICAgICBsYWJlbE92ZXJ2aWV3OiBjYy5MYWJlbCxcclxuICAgICAgICBsYWJlbFJlbWFpblRpbWU6IGNjLkxhYmVsLFxyXG4gICAgICAgIGJ0blNoYXJlOiBjYy5CdXR0b24sXHJcbiAgICAgICAgYnRuUmVhZHk6IGNjLkJ1dHRvbiwgICAgICAgICAgICAvLyDlh4blpIfmjInpkq5cclxuICAgICAgICBidG5TdGFydEdhbWU6IGNjLkJ1dHRvbiwgICAgICAgIC8vIOW8gOWni+aMiemSrlxyXG4gICAgICAgIGJlaWx2OmNjLk5vZGUsICAgICAgICAgICAgICAgICAgLy8g6YCJ5oup5YCN546H6IqC54K5XHJcbiAgICAgICAgYnRuQ2hhdFZvaWNlOiBjYy5CdXR0b24sXHJcbiAgICAgICAgYnRuQ2hhdFRleHQ6IGNjLkJ1dHRvbixcclxuICAgICAgICBhZ2FpbkJ0bjpjYy5Ob2RlLFxyXG5cclxuICAgICAgICBzdGFydENvbXBhcmVDYXJkc05vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgc2V0dGluZ05vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgVm9pY2VNc2dCZzpjYy5Ob2RlLFxyXG4gICAgICAgIGV4aXQ6Y2MuTm9kZSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g56a75byA5oi/6Ze06IqC54K5XHJcbiAgICAgICAgRGlzc29sdmU6Y2MuTm9kZSwgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDop6PmlaPmiL/pl7ToioLngrlcclxuICAgICAgICBzaGFyZUJnOmNjLk5vZGUsICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWIhuS6q+iDjOaZr1xyXG4gICAgICAgIHRvdGFsR2FtZVJlc3VsdDogY2MuTm9kZSwgICAgICAgICAgICAgICAgICAgLy8g57uT5p6c6IqC54K5XHJcbiAgICAgICAgYWxlcnRSZXF1ZXN0RXhpdE5vZGU6IGNjLk5vZGUsICAgICAgICAgICAgICAvLyDnlLPor7fpgIDlh7ogTm9kZVxyXG4gICAgICAgIGRpc3NvbHZlQWx0ZXI6IGNjLk5vZGUsICAgICAgICAgICAgICAgICAgICAgLy8g55Sz6K+36YCA5Ye6IE5vZGVcclxuICAgICAgICBhbGVydFJlcXVlc3RFeGl0Q291bnRkb3duTm9kZTogY2MuTm9kZSwgICAgIC8vIOeUs+ivt+mAgOWHuuWAkuiuoeaXtiBOb2RlXHJcbiAgICAgICAgYWxlcnRBbnNvd2VyRXhpdE5vZGU6IGNjLk5vZGUsICAgICAgICAgICAgICAvLyDlm57nrZTnlLPor7fpgIDlh7ogIE5vZGVcclxuICAgICAgICBjb250ZW50QW5zb3dlckV4aXROb2RlOiBjYy5Ob2RlLCAgICAgICAgICAgIC8vIOWbnuetlOeUs+ivt+mAgOWHuuWktOWDjyAgTm9kZVxyXG4gICAgICAgIGFsZXJ0QW5zb3dlckV4aXRSZXN1bHQ6IGNjLk5vZGUsICAgICAgICAgICAgLy8g5Zue562U55Sz6K+36YCA5Ye657uT5p6cICBOb2RlXHJcbiAgICAgICAgYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGU6IGNjLk5vZGUsICAgICAvLyDlm57nrZTku6XkuIror7fpgIDlh7rnmoTlgJLorqHml7ZcclxuICAgICAgICBDb3VudGRvd246Y2MuTm9kZSwgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWAkuiuoeaXtlxyXG4gICAgICAgIGxhYmVsVGltZTpjYy5MYWJlbCxcclxuICAgICAgICBuZWVkQ2FyZDpjYy5MYWJlbCxcclxuICAgICAgICBhbGVydDogY2MuTm9kZSxcclxuICAgICAgICBjb2luc0NvbnRhaW5lck5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgYnRuQWxlcnRSZXF1ZXN0RXhpdENvbmZpcm1CdXR0b246IGNjLkJ1dHRvbixcclxuICAgICAgICBidG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uOiBjYy5CdXR0b24sXHJcblxyXG4gICAgICAgIGF1dG9UaXNoaTpjYy5QcmVmYWIsXHJcbiAgICAgICAgd2FpdGluZ1ByZWZhYjogY2MuUHJlZmFiLFxyXG4gICAgICAgIGNvaW5zUHJlZmFiOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgcGxheWVyQ29tcHM6IFtQbGF5ZXJdLFxyXG5cclxuICAgICAgICBnb25nWGlOaTpjYy5Ob2RlLFxyXG4gICAgICAgIHRlU2h1UGFpOmNjLk5vZGUsXHJcblxyXG4gICAgICAgIGNhcmRTcHJpdGVBdGxhczpjYy5TcHJpdGVBdGxhcyxcclxuICAgICAgICBkYW9TcHJpdGVBdGxhczpjYy5TcHJpdGVBdGxhcyxcclxuXHJcbiAgICAgICAgX2xpdUR1aUJhbjpmYWxzZSxcclxuICAgICAgICBfc2FuU2h1blppOmZhbHNlLFxyXG4gICAgICAgIF9zYW5Ub25nSHVhOmZhbHNlLFxyXG4gICAgICAgIF95aVRpYW9Mb25nOmZhbHNlLFxyXG5cclxuICAgICAgICBfUWluZ0xvbmc6ZmFsc2UsXHJcbiAgICAgICAgX1NhblRvbmdIdWFTaHVuOmZhbHNlLFxyXG4gICAgICAgIF9TYW5GZW5UaWFuWGlhOmZhbHNlLFxyXG4gICAgICAgIF9Db3VZaVNlOmZhbHNlLFxyXG4gICAgICAgIF9TaVRhb1NhblRpYW86ZmFsc2UsXHJcbiAgICAgICAgX1d1RHVpU2FuVGlhbzpmYWxzZSxcclxuXHJcbiAgICAgICAgX3BsYXllckNvbXBvbmVudHM6IG51bGwsXHJcbiAgICAgICAgX21zZ0NvbnRyb2w6IG51bGwsXHJcbiAgICAgICAgX25vd1RpbWVBZ2FpbjowLFxyXG5cclxuICAgICAgICBfc29ja2V0OiBudWxsLFxyXG4gICAgICAgIF91c2VySWQ6IDAsXHJcbiAgICAgICAgX3BsYXllckluZm9zOiBudWxsLFxyXG4gICAgICAgIF9kZXNrSW5mbzogbnVsbCwgICAvLyBjcmVhdGVUaW1lIOWIm+W7uuaXtumXtCAgaXNEaXNzb2x2aW5nIOihqOekuuaYr+WQpuato+WcqOino+aVoyBkaXNzb2x2ZUxlZnRUaW1lIOemu+ino+aVo+WJqeS9meWkmumVv+aXtumXtCBkaXNzb2x2ZUFuc3dlckluZm8gW+WkhOeQhui/h+eahOS6uueahOS/oeaBr11cclxuICAgICAgICBfZ2FtZVN0YXR1czogR0FNRVNUQVRVUy5XQUlUX1BFT1BMRSxcclxuICAgICAgICBfZW50ZXJUaW1lOiBudWxsLFxyXG4gICAgICAgIF9iaWdSZWNvcmRJbmZvOm51bGwsXHJcbiAgICAgICAgX3BsYXllcnM6bnVsbCxcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgX2lzQ29tcGFyaW5nQ2FyZHNOb3c6IGZhbHNlLCAvLyDmmK/lkKbmraPlnKjmr5TniYxcclxuICAgICAgICBfcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzOiBbXSwgLy8g5bey57uP5pKt5pS+6L+H5q+U54mM55qE5bGA5pWwXHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIGZhcGFpTm9kZTogY2MuUHJlZmFiLFxyXG4gICAgICAgIGxpdWR1aWJhbjpjYy5QcmVmYWIsXHJcbiAgICAgICAgc2FudG9uZ2h1YTpjYy5QcmVmYWIsXHJcbiAgICAgICAgc2Fuc2h1bnppOmNjLlByZWZhYixcclxuICAgICAgICBxdWFubGVpZGE6Y2MuUHJlZmFiLFxyXG4gICAgfSxcclxuICAgIGtleUJhY2tMaXN0ZW46ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgY2Muc3lzdGVtRXZlbnQub24oY2MuU3lzdGVtRXZlbnQuRXZlbnRUeXBlLktFWV9ET1dOLGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgaWYoZS5rZXlDb2RlID09IGNjLktFWS5iYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBpZighS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSl7XHJcbiAgICAgICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImJhY2tUb0Rlc2tcIiwgXCIoKVZcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LHRoaXMpO1xyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5rZXlCYWNrTGlzdGVuKCk7XHJcbiAgICAgICAgdGhpcy5oZWFkQ2FyZFRpbWUgPSAwLjg1O1xyXG4gICAgICAgIHZhciBiZyA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInJvb21fYmdcIik7XHJcbiAgICAgICAgdmFyIHdpbmRvd1AgPSBjYy5kaXJlY3Rvci5nZXRXaW5TaXplSW5QaXhlbHMoKTtcclxuICAgICAgICB2YXIgc2NhbGVYID0gd2luZG93UC53aWR0aC9iZy53aWR0aDtcclxuICAgICAgICB2YXIgc2NhbGVZID0gd2luZG93UC5oZWlnaHQvYmcuaGVpZ2h0O1xyXG4gICAgICAgIHZhciBzY2FsZSA9IE1hdGgubWF4KHNjYWxlWCxzY2FsZVkpO1xyXG4gICAgICAgIGJnLnNjYWxlWCA9IHNjYWxlO1xyXG4gICAgICAgIGJnLnNjYWxlWSA9IHNjYWxlO1xyXG5cclxuICAgICAgICB0aGlzLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmdldENvbXBvbmVudChcIkNhcmRUeXBlQ29tYmluZVwiKS5CdG5DbGlja0dvbmdYaU5pQ29tZmlybTtcclxuICAgICAgICB0aGlzLl9lbnRlclRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgICB0aGlzLnBsYXllckNvbXBzLmZvckVhY2gocGxheWVyQ29tcCA9PiB7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzID0gdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgICAvKkF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5RGVza011c2ljKCk7Ki9cclxuXHJcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnN0b3BIYWxsTXVzaWMoKTtcclxuICAgICAgICB2YXIgYmdTb3VuZCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImJnU291bmRcIik7XHJcbiAgICAgICAgaWYoYmdTb3VuZCA9PSAwKXtcclxuICAgICAgICAgICAgdmFyIGF1ZGlvTWFuYWdlciA9IGNjLmZpbmQoJ0F1ZGlvTWFuYWdlcicpO1xyXG4gICAgICAgICAgICBhdWRpb01hbmFnZXIgPSBhdWRpb01hbmFnZXIuZ2V0Q29tcG9uZW50KCdBdWRpb01hbmFnZXInKTtcclxuICAgICAgICAgICAgYXVkaW9NYW5hZ2VyLnNldEVmZmVjdE11c2ljVm9sdW0oYmdTb3VuZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9pbml0UGxheWVyQ29tcG9uZW50cygpO1xyXG4gICAgICAgIHRoaXMuX2luaXRTZWxlY3RDYXJkTm9kZSgpO1xyXG4gICAgICAgIHRoaXMuX2luaXRPbmVHYW1lUmVzdWx0KCk7XHJcbiAgICAgICAgdGhpcy5fcmVtYWluVGltZVN0YXJ0VXBkYXRlKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcclxuICAgICAgICB0aGlzLl9tc2dDb250cm9sID0gdGhpcy5jaGF0Tm9kZS5nZXRDb21wb25lbnQoJ01zZ0NvbnRyb2wnKTtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XHJcbiAgICAgICAgdGhpcy5iZWlsdi5nZXRDb21wb25lbnQoXCJzZWxlY3RiZWlsdlwiKS5fdXNlcmlkID0gdGhpcy5fdXNlcklkO1xyXG4gICAgICAgIC8vdGhpcy5zZXR0aW5nTm9kZS5nZXRDb21wb25lbnQoXCJTZXR0aW5nXCIpLmhpZGVTd2l0Y2goKTtcclxuICAgICAgICB0aGlzLmxhYmVsUm9vbU51bWJlci5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyVm9pY2VOb2RlRXZlbnRzKCk7XHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJTb2NrZXRFdmVudCgpO1xyXG5cclxuICAgICAgICBQbGF5Lmluc3RhbmNlcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KGZhbHNlKTtcclxuICAgICAgICBpZiAoUGxheWJhY2suaW5zdGFuY2UuaXNDb250YWluUGxheWJhY2tEYXRhcygpKSB7XHJcbiAgICAgICAgICAgIFBsYXliYWNrLmluc3RhbmNlLnN0YXJ0UGxheWJhY2soKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5YmFja05vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5idG5DaGF0Vm9pY2Uubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy90aGlzLmNhcmRzRnJvbUFycmF5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fbG9hZERlc2tJbmZvKCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy5fc29ja2V0ID0gU29ja2V0Lmluc3RhbmNlO1xyXG5cclxuXHJcbiAgICAgICAgY2MuZGlyZWN0b3IucHJlbG9hZFNjZW5lKCdoYWxsJyxmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ2xvZ2luJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNjLmNsaWNrT3V0ID0gZmFsc2U7XHJcbiAgICAgICAgLy90aGlzLnRpbWVTdGFydCg1KTtcclxuICAgIH0sXHJcblxyXG4gICAgdGltZVN0YXJ0OiBmdW5jdGlvbiAoZHVyYXRpb24sYWN0aW9uKSB7XHJcbiAgICAgICAgY2MuYXNzZXJ0KGR1cmF0aW9uID4gMCk7XHJcbiAgICAgICAgdGhpcy50aW1lU3RvcCgpO1xyXG4gICAgICAgIHRoaXMuQ291bnRkb3duLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgaWYoYWN0aW9uICE9IFwicmVhZHlcIil7XHJcbiAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ0aW1lc3RhbXBcIik7ICAvLyDojrflj5bmnKzlnLDlrZjlgqjnmoTml7bpl7TmiLNcclxuICAgICAgICAgICAgaWYodGltZXN0YW1wKXsgIC8vIOWmguaenOacieWImeivgeaYjueOqeWutuaYr+mHjeaWsOi/m+adpeS6hueahFxyXG4gICAgICAgICAgICAgICAgdmFyIG5vdyA9IERhdGUucGFyc2UobmV3IERhdGUoKSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGltZSA9IGR1cmF0aW9uKjEwMDA7XHJcbiAgICAgICAgICAgICAgICBpZihub3cgLSB0aW1lc3RhbXAgPiB0aW1lKXsgLy8g6LaF5pe2XHJcbiAgICAgICAgICAgICAgICAgICAgaWYobm93IC0gdGltZXN0YW1wIDwgMip0aW1lKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb24gPSA1OyAgLy8g546p5a625Y+v6IO95Ye65LqO5YW25LuW5Y6f5Zug6YCA5Ye65ri45oiP5a+86Ie06LaF5pe277yM5Li65YW25o+Q5L6bNeenkuaXtumXtOaVtOeQhueJjOWei++8iOi/meW3sue7j+aYr+W+iOS7geaFiOeahOS6hu+8ieOAglxyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ0aW1lc3RhbXBcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb24gPSBNYXRoLmZsb29yKCBkdXJhdGlvbiAtIChub3cgLSB0aW1lc3RhbXApLzEwMDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9ZWxzZXsgIC8vIOWmguaenOayoeacieaXtumXtOaIs++8jOWImeS/neWtmO+8jOS4uueOqeWutumAgOWHuua4uOaIj+S/neeVmeivgeaNru+8m1xyXG4gICAgICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IERhdGUucGFyc2UobmV3IERhdGUoKSk7ICAgICBcclxuICAgICAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGltZXN0YW1wJyx0aW1lc3RhbXApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA9IGR1cmF0aW9uO1xyXG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IFN0cmluZyhkdXJhdGlvbik7XHJcbiAgICAgICAgdGhpcy5Db3VudGRvd24uZ2V0Q29tcG9uZW50KFwidGltZVwiKS5zZXRUaW1lKGR1cmF0aW9uICogMC41KTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFjayA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHNlbGYuX3RpbWVNZXRob2QoYWN0aW9uKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMuY2FsbGJhY2ssIDEsIGR1cmF0aW9uKTtcclxuICAgIH0sXHJcblxyXG4gICAgdGltZVN0b3A6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5jYWxsYmFjayk7XHJcbiAgICAgICAgdGhpcy5Db3VudGRvd24uYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIF90aW1lTWV0aG9kOiBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uID0gdGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uIC0gMTtcclxuXHJcbiAgICAgICAgdmFyIHJlbWFpbiA9IE1hdGgubWF4KHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiwgMCk7XHJcbiAgICAgICAgdGhpcy5sYWJlbFRpbWUuc3RyaW5nID0gKHJlbWFpbiA8IDEwICYmIHJlbWFpbiA+IDApID8gKCcwJyArIHJlbWFpbikgOiByZW1haW47XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gPD0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XHJcbiAgICAgICAgICAgIGlmKGFjdGlvbiA9PSBcInJlYWR5XCIpe1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY0luZGV4PjApe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tSZWFkeSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRpbWVzdGFtcFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBcclxuICAgIF9nbG9iYWxNc2c6ZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgLy9pZighY2Muc3lzLmlzTmF0aXZlKXtcclxuICAgICAgICB2YXIgcm9vbUlkID0gZGF0YS5yb29tSWQ7XHJcbiAgICAgICAgdmFyIHdmID0gZGF0YS5zZXR0aW5nMzsgIC8vL1vnlq/ni4LlnLos6ay854mMLOavlOiKseiJsizlnZDluoQs6ams54mMXVxyXG4gICAgICAgIHZhciByb29tID0gXCLmiL/lj7fvvJpcIityb29tSWQ7XHJcbiAgICAgICAgdmFyIGZrID0gd2ZbMF0/XCLnlq/ni4LlnLogXCI6XCLmma7pgJrlnLogXCI7ICAgICAgICAgLy8g55av54uC5Zy6XHJcbiAgICAgICAgdmFyIGdwID0gd2ZbMV0/XCLprLzniYwgXCI6XCLml6DprLwgXCI7ICAgICAgICAgICAgIC8vIOmsvOeJjFxyXG4gICAgICAgIHZhciBocyA9IHdmWzJdP1wi5q+U6Iqx6ImyIFwiOlwi5LiN5q+U6Iqx6ImyIFwiOyAgICAgICAvLyDmr5ToirHoibJcclxuICAgICAgICB2YXIgemogPSB3ZlszXT9cIuWdkOW6hCBcIjpcIuS4jeWdkOW6hCBcIjsgICAgICAgICAgIC8vIOW6hOWutlxyXG4gICAgICAgIHZhciBtcCA9IHdmWzRdP1wi5Lmw6amsIFwiOlwi5LiN5Lmw6amsIFwiOyAgICAgICAgICAgLy8g6ams54mMXHJcbiAgICAgICAgdmFyIHNmID0gXCLmiL/otLk6XCIrKGRhdGEuc2V0dGluZzQ/KChkYXRhLnNldHRpbmc0PT0xKT9cIui1ouiAheaJoyBcIjpcIuaIv+S4u+aJoyBcIik6XCLlubPmkYogXCIpOyAgLy/mlLbotLlcclxuICAgICAgICB2YXIgc2hhcmVUaXRsZSA9IHJvb20rXCIg5qih5byPOlwiK3pqK3NmO1xyXG5cclxuICAgICAgICB2YXIgcGogPSBbXCI15bGAIFwiLFwiMTDlsYAgXCIsXCIyMOWxgCBcIl07ICAvL+eJjOWxgFxyXG4gICAgICAgIHZhciBkcyA9IFtcIjTkurrkuI3liqDoibIgXCIsXCI15Lq65Yqg5LiA6ImyIFwiLFwiNuS6uuS6jOiJsiBcIixcIjfkurrliqDkuInoibIgXCJdOyAgLy/lpJroibJcclxuICAgICAgICB2YXIgcnMgPSBkc1tkYXRhLnNldHRpbmcyXStcIlwiO1xyXG4gICAgICAgIHZhciBqcyA9IHBqW2RhdGEuc2V0dGluZzEtMl07XHJcbiAgICAgICAgdmFyIGRlc2MgPSAnW+Wkp+S8l+WNgeS4ieawtF0gJyt6aitmayttcCtncCtzZitycytqcytcIiDngrnlh7vnm7TmjqXov5vlhaXmiL/pl7RcIjtcclxuXHJcbiAgICAgICAgc1RpdGxlID0gc2hhcmVUaXRsZTtcclxuICAgICAgICBzRGVzY3JpcHRpb24gPSBkZXNjO1xyXG4gICAgICAgIHNJZCA9ICdyb29tSWQ9Jytyb29tSWQ7XHJcblxyXG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncm9vbUlkJyxyb29tSWQpO1xyXG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2hhcmVUaXRsZScsc2hhcmVUaXRsZSk7XHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdkZXNjJyxkZXNjKTtcclxuXHJcbiAgICAgICAgaWYoY2Muc3lzLmlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICBpZih3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1RpbWVMaW5lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYod2luZG93LnNoYXJlVG9TZXNzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVUb1Nlc3Npb24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvL31cclxuICAgIH0sXHJcblxyXG5cclxuXHJcbiAgICAvKiMjIyMjKi9cclxuICAgIC8q5pi+56S66ams54mMKi9cclxuICAgIF9pbml0TWFQYWk6ZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX2luaXRQbGF5ZXJDb21wb25lbnRzOiBmdW5jdGlvbiAocGxheWVySW5kZXgpIHtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzID0gdGhpcy5wbGF5ZXJOb2Rlcy5tYXAoZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5vZGUuZ2V0Q29tcG9uZW50KCdQbGF5ZXInKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYoIXBsYXllckluZGV4KSB7XHJcbiAgICAgICAgICAgIHBsYXllckluZGV4ID0gWzAsMSwyLDMsNCw1XTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBhID0gdGhpcy5fcGxheWVyQ29tcG9uZW50cy5zcGxpY2UoMSw3KTtcclxuXHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHBsYXllckluZGV4Lmxlbmd0aCAtIDE7IGkrKyl7XHJcbiAgICAgICAgICAgIHZhciBpbmRleDEgPSBwbGF5ZXJJbmRleFtpXTtcclxuICAgICAgICAgICAgdmFyIGluZGV4MiA9IHBsYXllckluZGV4W2kgKyAxXTtcclxuICAgICAgICAgICAgdmFyIHRtcCA9IG51bGw7XHJcbiAgICAgICAgICAgIHRtcCA9IGFbaW5kZXgxXTtcclxuICAgICAgICAgICAgYVtpbmRleDFdID0gYVtpbmRleDJdO1xyXG4gICAgICAgICAgICBhW2luZGV4Ml0gPSB0bXAgO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYS5mb3JFYWNoKGZ1bmN0aW9uKG5vZGUpe3RoaXMuX3BsYXllckNvbXBvbmVudHMucHVzaChub2RlKTt9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICBpZih0aGlzLnBsYXlzQ29pbnMgJiYgdGhpcy5wbGF5c0NvaW5zLmxlbmd0aCA+IDApe1xyXG4gICAgICAgICAgICB0aGlzLnBsYXlzQ29pbnMuZm9yRWFjaChmdW5jdGlvbihub2RlKXtcclxuICAgICAgICAgICAgICAgIG5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnBsYXlzQ29pbnMgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXlzLGkpe1xyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IFwiY29pbnNcIiArIGk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbm9kZSA9IG5ldyBjYy5Ob2RlKCk7XHJcblxyXG4gICAgICAgICAgICBub2RlLm5hbWUgPSBuYW1lO1xyXG5cclxuICAgICAgICAgICAgbm9kZS54ID0gcGxheXMubm9kZS54O1xyXG5cclxuICAgICAgICAgICAgbm9kZS55ID0gcGxheXMubm9kZS55O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKG5vZGUpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5wbGF5c0NvaW5zLnB1c2gobm9kZSk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdFNlbGVjdENhcmROb2RlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGxldCBjYXJkVHlwZUNvbWJpbmVDb21wID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVDb21iaW5lJyk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lQ29tcC5zZXRGaW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKGZ1bmN0aW9uIChzZXJ2ZXJDYXJkc0luZm8pIHtcclxuICAgICAgICAgICAgY2FyZFR5cGVDb21iaW5lQ29tcC5yZXNldCgpO1xyXG4gICAgICAgICAgICBTb2NrZXQuc2VuZFBsYXlDYXJkKHNlbGYuX3VzZXJJZCwgc2VydmVyQ2FyZHNJbmZvKTtcclxuICAgICAgICAgICAgc2VsZi5jYXJkVHlwZUNvbWJpbmVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKiovXHJcbiAgICBfaW5pdE9uZUdhbWVSZXN1bHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICAvLyB0aGlzLm9uZUdhbWVSZXN1bHQuc2V0Q2xvc2VDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyAgICAgaWYgKHNlbGYuX2lzUmFuZG9tUm9vbSgpKSB7XHJcbiAgICAgICAgLy8gICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgIC8vIH07XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9mZlRhcmdldCh0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tMZWF2ZURlc2s6ZnVuY3Rpb24oKXsgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOeCueWHu+emu+W8gOahjOWtkFxyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gMCkgeyAgICAgICAgICAgICAgIC8vIOi/mOayoeW8gOWni+WPr+S7pemAgOWHuuaIv+mXtFxyXG4gICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpe1xyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgU29ja2V0LnNlbmRMZWF2ZURlc2sodGhpcy5fdXNlcklkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjbGlja0Rpc3NvbHZlRGVzayA6ZnVuY3Rpb24oKXsgICAgICAgICAgICAgICAgICAgICAgLy8g54K55Ye76Kej5pWj5qGM5a2QXHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gdGhpcy5fdXNlcklkKXsgICAgLy8g5Y+q5pyJ5oi/5Li75omN6IO96Kej5pWj5qGM5a2QXHJcbiAgICAgICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENhbmNlbEJ1dHRvbi5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENvbmZpcm1CdXR0b24ubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBsZXQgYWxlcnQgPSB0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICAgICAgYWxlcnQudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgICAgICBhbGVydC5zZXRNZXNzYWdlKFwi5piv5ZCm6KaB6Kej5pWj5oi/6Ze0XCIpO1xyXG4gICAgICAgICAgICBhbGVydC5hbGVydCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tFeGl0T3V0OmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgU29ja2V0LnNlbmREaXNzb2x2ZURlc2sodGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/op6PmlaPpgIDlh7rmiL/pl7RcclxuICAgIGNsaWNrRXhpdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mbyAmJiB0aGlzLl9kZXNrSW5mby5pc0Rlc2tPdmVyKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdykge1xyXG4gICAgICAgICAgICAgICAgLy8g5aaC5p6c5oi/6Ze05bey57uT5p2f77yM5bm25LiU5LiN5piv5q2j5Zyo5pKt5pS+5omT54mM5Yqo55S7LCDliJnnm7TmjqXnprvlvIDmiL/pl7RcclxuICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIC8vaWYgKHRoaXMuX2lzUmFuZG9tUm9vbSgpKSB7XHJcbiAgICAgICAgLy8gICAgdGhpcy5hbGVydEZvcmNlRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gMCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYWxlcnQxID0gdGhpcy5kaXNzb2x2ZUFsdGVyLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICAgICAgICAgIGFsZXJ0MS5hbGVydCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgU29ja2V0LnNlbmRMZWF2ZURlc2sodGhpcy5fdXNlcklkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENhbmNlbEJ1dHRvbi5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q29uZmlybUJ1dHRvbi5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIGxldCBhbGVydCA9IHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIGFsZXJ0LnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICBhbGVydC5zZXRNZXNzYWdlKFwi5piv5ZCm6Kej5pWj5oi/6Ze077yfXCIpO1xyXG4gICAgICAgIGFsZXJ0LmFsZXJ0KCk7XHJcblxyXG4gICAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdG9wKCk7XHJcbiAgICB9LFxyXG4gICAgLy/kuI3op6PmlaPpgIDlh7rmiL/pl7RcclxuICAgIGNsaWNrT3V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgICAgIGNjLmNsaWNrT3V0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgU29ja2V0LnNlbmRMZWF2ZURlc2sodGhpcy5fdXNlcklkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrU2hhcmVCZzpmdW5jdGlvbigpe1xyXG4gICAgICAgIGNjLmZpbmQoXCJDYW52YXMvc2hhcmVCZ1wiKS5hY3RpdmUgPSBmYWxzZTsgXHJcbiAgICAgICAgdGhpcy5zaGFyZUJnLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgICBndWFuemh1OmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy8gdmFyIHVybCA9IFwiaHR0cDovL3d3dy5ob25nZ2VmZW5nLmNuL2d6aC9pbmRleC5odG1sXCI7XHJcbiAgICAgICAgLy8gY2Muc3lzLm9wZW5VUkwodXJsKVxyXG4gICAgfSxcclxuICAgIHJlY29yZFNoYXJlOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8ucmVjb3JkSWQpe1xyXG4gICAgICAgICAgICB2YXIgc2hhcmVUaXRsZSA9IFwiW+Wkp+S8l+WNgeS4ieawtF3miJjnu6lcIjtcclxuICAgICAgICAgICAgdmFyIHJvb21JZCA9XCLmiL/pl7Tlj7fvvJpcIit0aGlzLl9kZXNrSW5mby5yb29tSWQ7XHJcbiAgICAgICAgICAgIHZhciBwaiA9IFtcIjUgXCIsXCIxMCBcIixcIjIwIFwiXTsgIC8v54mM5bGAXHJcbiAgICAgICAgICAgIHZhciBqcyA9IFwi5bGA5pWw77yaXCIrcGpbdGhpcy5fZGVza0luZm8uc2V0dGluZzEtMl07XHJcbiAgICAgICAgICAgIHZhciB0aW1lID0gXCLml7bpl7TvvJpcIit0aGlzLl9kZXNrSW5mby5jcmVhdGVUaW1lIDtcclxuICAgICAgICAgICAgdmFyIGRlc2MgPSByb29tSWQranMrdGltZStcIueCueWHu+afpeeci+ivpuaDhVwiO1xyXG5cclxuICAgICAgICAgICAgdmFyIHJlY29yZElkID0gdGhpcy5fZGVza0luZm8ucmVjb3JkSWQ7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInNoYXJlVGl0bGVcIixzaGFyZVRpdGxlKTtcclxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiZGVzY1wiLGRlc2MpO1xyXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJyZWNvcmRJZFwiLHJlY29yZElkKTtcclxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicm9vbUlkXCIsJycpO1xyXG5cclxuICAgICAgICAgICAgc1RpdGxlID0gc2hhcmVUaXRsZTtcclxuICAgICAgICAgICAgc0Rlc2NyaXB0aW9uID0gZGVzYztcclxuICAgICAgICAgICAgc0lkID0gJ3Jvb21JZD0nK3Jvb21JZDtcclxuICAgICAgICAgICAgaWYocmVjb3JkSWQpe1xyXG4gICAgICAgICAgICAgICAgc0lkID0gJ3JlY29yZElkPScrcmVjb3JkSWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKGNjLnN5cy5pc0Jyb3dzZXIpe1xyXG4gICAgICAgICAgICAgICAgaWYod2luZG93LnNoYXJlVG9UaW1lTGluZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvVGltZUxpbmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKHdpbmRvdy5zaGFyZVRvU2Vzc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZVRvU2Vzc2lvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcclxuICAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvc2hhcmVCZ1wiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNjcmVlblNoYXJlRnJpZW5kXCIsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHsvL0FuZHJvaWRcclxuICAgICAgICAgICAgICAgIEtRTmF0aXZlSW52b2tlLnNjcmVlbnNob3RTaGFyZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8vIOeCueWHu+ahjOmdouWIhuS6q1xyXG4gICAgY2xpY2tEZXNrU2hhcmUgOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy90aGlzLl9nbG9iYWxNc2codGhpcy5fZGVza0luZm8pO1xyXG4gICAgICAgIGlmKCFjYy5zeXMuaXNOYXRpdmUpe1xyXG4gICAgICAgICAgICB2YXIgc2hhcmVCZyA9IGNjLmZpbmQoXCJDYW52YXMvc2hhcmVCZ1wiKTsgXHJcbiAgICAgICAgICAgIHNoYXJlQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy92YXIgd3hCZyA9IHRoaXMuc2hhcmVCZy5nZXRDaGlsZEJ5TmFtZShcInd4XCIpO1xyXG4gICAgICAgICAgICAvL3ZhciBweXFCZyA9IHRoaXMuc2hhcmVCZy5nZXRDaGlsZEJ5TmFtZShcIlBZUVwiKTtcclxuICAgICAgICAgICAgLy93eEJnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vcHlxQmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5zaGFyZUJnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpZD1zSWQ7XHJcbiAgICAgICAgdmFyIHRpdGxlID0gc1RpdGxlO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IHNEZXNjcmlwdGlvbjtcclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVGcmllbmQ6ZGVzY3JpcHRpb246XCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLHN0ciwgaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/ngrnlh7vliIbkuqvmjInpkq5cclxuICAgIGNsaWNrU2hhcmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL3RoaXMuX2dsb2JhbE1zZyh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgaWYoIWNjLnN5cy5pc05hdGl2ZSl7XHJcbiAgICAgICAgICAgIHZhciB3eEJnID0gdGhpcy5zaGFyZUJnLmdldENoaWxkQnlOYW1lKFwid3hcIik7XHJcbiAgICAgICAgICAgIHZhciBweXFCZyA9IHRoaXMuc2hhcmVCZy5nZXRDaGlsZEJ5TmFtZShcIlBZUVwiKTtcclxuICAgICAgICAgICAgd3hCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBweXFCZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5zaGFyZUJnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpZD1zSWQ7XHJcbiAgICAgICAgdmFyIHRpdGxlID0gc1RpdGxlO1xyXG4gICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IHNEZXNjcmlwdGlvbjtcclxuXHJcbiAgICAgICAgLy8gbGV0IHJvb21JZCA9IFN0cmluZyh0aGlzLl9kZXNrSW5mby5yb29tSWQpO1xyXG4gICAgICAgIC8vIHZhciBkZXNjcmlwdGlvbiA9IFwi5aSn5LyX5Y2B5LiJ5rC0IOeOqeazlTpcIlxyXG4gICAgICAgIC8vIGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gKyBcIiBcIiArIHRoaXMuX2Rlc2tJbmZvTnVtYmVyT2ZQZW9wbGUoKTtcclxuICAgICAgICAvLyBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uICsgXCIsXCIgKyB0aGlzLl9kZXNrSW5mb1BheUluZm8oKTtcclxuICAgICAgICAvLyBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uICsgXCIgXCIgKyB0aGlzLl9kZXNrSW5mb051bWJlck9mR2FtZSgpO1xyXG5cclxuXHJcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNoYXJlRnJpZW5kOmRlc2NyaXB0aW9uOlwiLGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZFxyXG4gICAgICAgICAgICB2YXIgc3RyID0gXCIoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVZcIjtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVGcmllbmRcIixzdHIsIGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvL+WIhuS6q+WIsOaci+WPi+WciFxyXG4gICAgc2hhcmVIYWxsVGltZWxpbmU6ZnVuY3Rpb24oKXtcclxuICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcclxuICAgICAgICAgICAgdmFyIHd4QmcgPSB0aGlzLnNoYXJlQmcuZ2V0Q2hpbGRCeU5hbWUoXCJ3eFwiKTtcclxuICAgICAgICAgICAgdmFyIHB5cUJnID0gdGhpcy5zaGFyZUJnLmdldENoaWxkQnlOYW1lKFwiUFlRXCIpO1xyXG4gICAgICAgICAgICB3eEJnLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBweXFCZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnNoYXJlQmcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdmFyIGlkPXNJZDtcclxuICAgICAgICAgICAgdmFyIHRpdGxlID0gc1RpdGxlO1xyXG4gICAgICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBzRGVzY3JpcHRpb247XHJcblxyXG4gICAgICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNoYXJlSGFsbFRpbWVsaW5lXCIsaWQsIGRlc2NyaXB0aW9uLHRpdGxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHsvL0FuZHJvaWRcclxuICAgICAgICAgICAgICAgIHZhciBzdHIgPSBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiO1xyXG4gICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVIYWxsVGltZWxpbmVcIiwgc3RyLGlkLCBkZXNjcmlwdGlvbix0aXRsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8v54K55Ye75YeG5aSH5oyJ6ZKuXHJcbiAgICBjbGlja1JlYWR5OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XHJcbiAgICAgICAgU29ja2V0LnNlbmRSZWFkeSh0aGlzLl91c2VySWQpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+eCueWHu+W8gOWni+aMiemSrlxyXG4gICAgY2xpY2tTdGFydEdhbWU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgU29ja2V0LnNlbmRTdGFydEdhbWUodGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlUm9vbU51bWJlcjogZnVuY3Rpb24gKHJvb21OdW1iZXIpIHtcclxuICAgICAgICBsZXQgZ2FtZU51bWJlclN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxICE9IDAgJiYgdGhpcy5fZGVza0luZm8uc2V0dGluZzEgIT0gMSkge1xyXG4gICAgICAgICAgICBnYW1lTnVtYmVyU3RyaW5nID0gXCLlsYDmlbAgOiBcIiArIFwiXCIgKyB0aGlzLl9kZXNrSW5mby5jSW5kZXggKyBcIi9cIiArIHRoaXMuX2Rlc2tJbmZvLm1NYXg7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSA9PSAwKSB7XHJcbiAgICAgICAgICAgIGdhbWVOdW1iZXJTdHJpbmcgPSBcIuWxgOaVsCA6IDEw5bGAXCI7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSA9PSAxKSB7XHJcbiAgICAgICAgICAgIGdhbWVOdW1iZXJTdHJpbmcgPSBcIuWxgOaVsCA6IDIw5bGAXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubGFiZWxSb29tTnVtYmVyLnN0cmluZyA9IFwi5oi/5Y+3IDogXCIgKyBcIlwiICsgcm9vbU51bWJlciArIFwiICAgIFwiICsgZ2FtZU51bWJlclN0cmluZztcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlR2FtZVN0YXR1czogZnVuY3Rpb24gKHN0YXR1cyA9IEdBTUVTVEFUVVMuV0FJVF9QRU9QTEUpIHtcclxuICAgICAgICB0aGlzLl9nYW1lU3RhdHVzID0gc3RhdHVzO1xyXG5cclxuICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gKHN0YXR1cyA9PSBHQU1FU1RBVFVTLldBSVRfUEVPUExFKTtcclxuICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gKHN0YXR1cyA9PSBHQU1FU1RBVFVTLldBSVRfUkVBRFkpO1xyXG4gICAgICAgIHRoaXMuaXNSZWFkeVN0YXR1cygpO1xyXG4gICAgfSxcclxuXHJcbiAgICBnYW1lU3RhdHVzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dhbWVTdGF0dXM7XHJcbiAgICB9LFxyXG4gICAgaXNSZWFkeVN0YXR1czogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKHRoaXMuX3BsYXllckluZm9zICYmIHRoaXMuX3BsYXllckluZm9zLmxlbmd0aD4wKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckluZm9zLmZvckVhY2goZnVuY3Rpb24ocGxheWVySW5mbyl7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlckluZm9TZWxmPWNjLmZpbmQoJ0NhbnZhcy9wbGF5U2VsZi91c2VySW5mb1NlbGYnKTtcclxuICAgICAgICAgICAgICAgIGlmKHBsYXllckluZm8uaWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXBsYXllckluZm8ucmVhZHlTdGF0dXMgJiYgIXRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgJiYgIVBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSAmJiAhUGxheWJhY2suaW5zdGFuY2UuaXNDb250YWluUGxheWJhY2tEYXRhcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJbmZvU2VsZi5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gMCkgey8v5LiA5bGA6L+Y5rKh5byA5aeLXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGVza0luZm8ucGxheWVycy5sZW5ndGggPCB0aGlzLl9kZXNrSW5mby5tYXhOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5wbGF5ZXJzLmxlbmd0aCA+PSAyICYmIHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHRoaXMuX3VzZXJJZCl7Ly/mmK/lkKbmmK/miL/kuLtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZighdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlckluZm9TZWxmLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRSZWFkeU5vZGVWaXNpYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJDb21wKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJDb21wLmhpZGVSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cpXHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwi5YeG5aSH54q25oCBLS0tLS0tLS1cIilcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cpIHsvL1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJDb21wKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyQ29tcC5oaWRlUmVhZHlTdGF0dXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGlzR2FtZVN0YXJ0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7Ly/kuIDlsYDov5jmsqHlvIDlp4tcclxuICAgICAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gdGhpcy5fdXNlcklkKXsvL+aYr+WQpuaYr+aIv+S4u1xyXG4gICAgICAgICAgICAgICAgaWYoIXRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgJiYgIVBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgICYmICFQbGF5YmFjay5pbnN0YW5jZS5pc0NvbnRhaW5QbGF5YmFja0RhdGFzKCkgJiYgdGhpcy5fZGVza0luZm8ucGxheWVycy5sZW5ndGggPj0gMil7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TdGFydEdhbWUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnRuU3RhcnRHYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMubGVuZ3RoIDwgdGhpcy5fZGVza0luZm8ubWF4TnVtYmVyKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLmJ0blN0YXJ0R2FtZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLy8g5ri45oiP5Yqo55S7XHJcbiAgICBfc3RhcnRHYW1lOiBmdW5jdGlvbiAocGxheU11c2ljKSB7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmdhbWVTdGF0dXMoKSA9PSBHQU1FU1RBVFVTLlBMQVlJTkcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL3RoaXMuX3BsYXllckluZm9zID0gcGxheWVycztcclxuICAgICAgICAvL3RoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL30pO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLnJlc2V0KCk7ICAvLyMjIyMjXHJcbiAgICAgICAgICAgIHBsYXllckNvbXAuaGlkZVJlYWR5U3RhdHVzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy50ZVNodVBhaS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcblxyXG4gICAgICAgIHRoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vKXtpZihubykgbm8ucmVtb3ZlQWxsQ2hpbGRyZW4oKTt9KTtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXlzLGkpe1xyXG5cclxuICAgICAgICAgICAgdmFyIG5hbWUgPSBcImNvaW5zXCIgKyBpO1xyXG5cclxuICAgICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUobmFtZSk7XHJcblxyXG4gICAgICAgICAgICBpZihub2RlKXtcclxuICAgICAgICAgICAgICAgIG5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5yZW1vdmVDaGlsZChub2RlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIC8vIGNjLmxvZyh0aGlzLm5vZGUpXHJcbiAgICAgICAgLy8gY2MubG9nKCctLS0tLS03MDknKVxyXG4gICAgICAgIHRoaXMuX3VwZGF0ZVVzZXJJbmZvcyh0aGlzLl9wbGF5ZXJJbmZvcyk7XHJcbiAgICAgICAgdGhpcy5zaG93Q29tcGFyZUNhcmQoKTtcclxuICAgICAgICB0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUdhbWVTdGF0dXMoR0FNRVNUQVRVUy5QTEFZSU5HKTtcclxuICAgICAgICB0aGlzLl9wbGF5RmFQYWlBbmltYXRpb24ocGxheU11c2ljKTtcclxuXHJcbiAgICAgICAgbGV0IGNhcmRUeXBlQ29tYmluZSA9IHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlQ29tYmluZScpO1xyXG5cclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUucmVzZXQoKTtcclxuXHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmICghVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZCh0aGlzLl91c2VySWQpKSkge1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiYW5pbWF0aW9uXCIpLmZhcGFpQW5pbWF0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Nob3dDYXJkVHlwZUNvbWJpbmUoKTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCAxLjkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9wbGF5RmFQYWlBbmltYXRpb246IGZ1bmN0aW9uIChwbGF5TXVzaWMpIHtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcil7XHJcbiAgICAgICAgICAgIHBsYXllci5wbGF5RmFQYWlBbmltYXRpb24oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZihwbGF5TXVzaWMpe1xyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUZhUGFpKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMjKi9cclxuICAgIC8v5piv5ZCm54m55q6K54mMXHJcbiAgICBpc1RlU2h1UGFpOiBmdW5jdGlvbihjYXJkcyl7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1RlU2h1UGFpKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNUZVNodVBhaSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1RlU2h1UGFpID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbkuIDmnaHpvplcclxuICAgIGlzWWlUaWFvTG9uZzogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzWWlUaWFvTG9uZyhjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzWWlUaWFvTG9uZyA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1lpVGlhb0xvbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuWFreWvueWNilxyXG4gICAgaXNMaXVEdWlCYW46IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc0xpdUR1aUJhbihjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzTGl1RHVpQmFuID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzTGl1RHVpQmFuID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5LiJ6aG65a2QXHJcbiAgICBpc1NhblNodW5aaTogZnVuY3Rpb24oY2FyZHMpe1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNTYW5TaHVuWmkoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblNodW5aaSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblNodW5aaSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuS4ieWQjOiKsVxyXG4gICAgaXNTYW5Ub25nSHVhOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNTYW5Ub25nSHVhKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5UYW9IdWEgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5UYW9IdWEgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbkuInlkIzoirHpobpcclxuICAgIGlzU2FuVG9uZ0h1YVNodW46IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1NhblRvbmdIdWFTaHVuKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5Ub25nSHVhU2h1biA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblRvbmdIdWFTaHVuID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5piv5riF6b6ZXHJcbiAgICBpc1FpbmdMb25nOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNRaW5nTG9uZyhjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzUWluZ0xvbmcgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNRaW5nTG9uZyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuaYryDigJzkuInliIblpKnkuIvigJ1cclxuICAgIGlzU2FuRmVuVGlhblhpYTogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzU2FuRmVuVGlhblhpYShjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuRmVuVGlhblhpYSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhbkZlblRpYW5YaWEgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmK8g4oCc5Zub5aWX5LiJ5p2h4oCdXHJcbiAgICBpc1NpVGFvU2FuVGlhbzogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzU2lUYW9TYW5UaWFvKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTaVRhb1NhblRpYW8gPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTaVRhb1NhblRpYW8gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmK/kupTlr7nkuInmnaFcclxuICAgIGlzV3VEdWlTYW5UaWFvOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNXdUR1aVNhblRpYW8oY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1d1RHVpU2FuVGlhbyA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1d1RHVpU2FuVGlhbyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuaYr+WHkeS4gOiJslxyXG4gICAgaXNDb3VZaVNlOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNDb3VZaVNlKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNDb3VZaVNlID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzQ291WWlTZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvKiMjIyMjKi9cclxuXHJcbiAgICAvKuaYvuekuumFjeeJjOmhtemdoiovXHJcbiAgICBfc2hvd0NhcmRUeXBlQ29tYmluZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnN0YXJ0Q29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBjYy50ZVNodVBhaUNhcmRzID0gbnVsbDtcclxuXHJcbiAgICAgICAgbGV0IGNhcmRUeXBlQ29tYmluZSA9IHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlQ29tYmluZScpO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZXNldCgpO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZWxvYWRDYXJkcyhbXSk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUudGltZVN0YXJ0KDYwKTtcclxuICAgICAgICB0aGlzLnRpbWVTdGFydCg2MCxcIlwiKTtcclxuICAgICAgICB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuc2NhbGUgPSAxO1xyXG5cclxuICAgICAgICBsZXQgY2FyZHMgPSB0aGlzLl9maW5kQ2FyZHNCeVVzZXJJZCh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgIC8vXCIxXzlcIlwiM185XCJcIjJfOVwiXHJcbiAgICAgICAgLy8gXCIyXzdcIlwiMV83XCJcIjNfM1wiXCIyXzEyXCJcclxuICAgICAgICAvL1wiMV8xXCJcIjFfM1wiXCIyXzZcIlwiMV8xMVwiXCIyXzFcIlwiM180XCIvL1xyXG4gICAgICAgIC8vIGlmKHRoaXMuX3VzZXJJZCA9PSAyKXtcclxuICAgICAgICAvLyAgICAgY2FyZHMgPSBbe3N1aXQ6IFwiZFwiLCBudW1iZXI6Mn0se3N1aXQ6IFwiZFwiLCBudW1iZXI6Mn0sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjJ9LC8v6Z2S6b6ZXHJcblxyXG4gICAgICAgIC8vICAgICAgICAge3N1aXQ6IFwiaFwiLCBudW1iZXI6Mn0sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjJ9LFxyXG4gICAgICAgIC8vICAgICAgICAge3N1aXQ6IFwiY1wiLCBudW1iZXI6M30sIHtzdWl0OiBcImNcIiwgbnVtYmVyOjN9LCB7c3VpdDogXCJjXCIsIG51bWJlcjozfSxcclxuXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjozfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6NH0sXHJcbiAgICAgICAgLy8gICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjo0fSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6NH0sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjR9XTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgLy9pZih0aGlzLl91c2VySWQgPT0gMSl7ZFxyXG4gICAgICAgIC8vICAgIGNhcmRzID0gW3tzdWl0OiBcImNcIiwgbnVtYmVyOjF9LHtzdWl0OiBcImhcIiwgbnVtYmVyOjF9LCB7c3VpdDogXCJzXCIsIG51bWJlcjoxfSwvL+mdkum+mVxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgICAgIHtzdWl0OiBcImhcIiwgbnVtYmVyOjh9LCB7c3VpdDogXCJjXCIsIG51bWJlcjoyfSxcclxuICAgICAgICAvLyAgICAgICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6OH0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjh9LCB7c3VpdDogXCJkXCIsIG51bWJlcjoyMH0sXHJcbiAgICAgICAgLy8gICAgICAgIHtzdWl0OiBcImhcIiwgbnVtYmVyOjl9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo5fSxcclxuICAgICAgICAvLyAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6OX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjl9LCB7c3VpdDogXCJoXCIsIG51bWJlcjo5fV07XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8gZWxzZSBpZih0aGlzLl91c2VySWQgPT0gNil7XHJcbiAgICAgICAgLy8gICAgIGNhcmRzID0gW3tzdWl0OiBcImRcIiwgbnVtYmVyOjExfSx7c3VpdDogXCJkXCIsIG51bWJlcjoxM30sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjExfSwvL+mdkum+mVxyXG4gICAgICAgIC8vICAgICAgICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6MX0sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjF9LFxyXG4gICAgICAgIC8vICAgICAgICAge3N1aXQ6IFwiaFwiLCBudW1iZXI6Mn0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjR9LCB7c3VpdDogXCJoXCIsIG51bWJlcjo5fSxcclxuICAgICAgICAvLyAgICAgICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjd9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo3fSxcclxuICAgICAgICAvLyAgICAgICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjV9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo1fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6NX0sXTtcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl91c2VySWQgPT0gMyl7XHJcbiAgICAgICAgLy8gICAgY2FyZHMgPSBbe3N1aXQ6IFwiZFwiLCBudW1iZXI6NH0se3N1aXQ6IFwiZFwiLCBudW1iZXI6MTN9LCB7c3VpdDogXCJzXCIsIG51bWJlcjoxM30sLy/pnZLpvplcclxuICAgICAgICAvLyAgICAgICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6Nn0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjd9LFxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjo4fSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6OX0sIHtzdWl0OiBcImNcIiwgbnVtYmVyOjEwfSxcclxuICAgICAgICAvLyAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6MX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjN9LFxyXG4gICAgICAgIC8vICAgICAgICB7c3VpdDogXCJzXCIsIG51bWJlcjoxMH0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjh9LCB7c3VpdDogXCJzXCIsIG51bWJlcjoxMn0sXTtcclxuICAgICAgICAvL31cclxuICAgICAgICBjYy5tb3NoaSA9IDA7XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGNhcmRzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgdmFyIHMgPSBjYXJkc1tpXS5udW1iZXI7XHJcbiAgICAgICAgICAgIGlmKHMgPj0gMjApe1xyXG4gICAgICAgICAgICAgICAgY2MubW9zaGkgPSAxO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGNhcmROYW1lcyA9IHRoaXMuX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzKGNhcmRzKTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUucmVsb2FkQ2FyZHMoY2FyZE5hbWVzKTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUuYWRkQ2FyZE1vZGVzKGNhcmROYW1lcyk7XHJcblxyXG4gICAgICAgIC8vY2MuZnJvbS5tb3NoaSA9PSAw6YCJ5oup5LqG5bqE5a625qih5byPXHJcblxyXG4gICAgICAgIGlmKGNjLm1vc2hpICE9IDEpe1xyXG4gICAgICAgICAgICB0aGlzLmlzVGVTaHVQYWkoY2FyZHMpO1xyXG4gICAgICAgICAgICB0aGlzLmlzUWluZ0xvbmcoY2FyZHMpO1xyXG4gICAgICAgICAgICB0aGlzLmlzWWlUaWFvTG9uZyhjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNMaXVEdWlCYW4oY2FyZHMpO1xyXG4gICAgICAgICAgICB0aGlzLmlzU2FuU2h1blppKGNhcmRzKTtcclxuICAgICAgICAgICAgdGhpcy5pc1NhblRvbmdIdWEoY2FyZHMpO1xyXG4gICAgICAgICAgICBpZihURVNIVVBBSVRZUEUuaXNUZVNodVBhaSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuc2NhbGUgPSAwO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5nb25nWGlOaS5nZXRDaGlsZEJ5TmFtZShcImJnXCIpO1xyXG4gICAgICAgICAgICAgICAgbm9kZXMub3BhY2l0eSA9IDI0MDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL3RoaXMuaXNTYW5Ub25nSHVhU2h1bihjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc1NhbkZlblRpYW5YaWEoY2FyZHMpO1xyXG4gICAgICAgICAgICAvL3RoaXMuaXNTaVRhb1NhblRpYW8oY2FyZHMpO1xyXG4gICAgICAgICAgICAvL3RoaXMuaXNXdUR1aVNhblRpYW8oY2FyZHMpO1xyXG4gICAgICAgICAgICAvL3RoaXMuaXNDb3VZaVNlKGNhcmRzKTtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0dvbmdYaU5pQW5kQnRuVGVTaHVQYWkoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLmNhY2xlQXV0b1NlbGVjdGVkQ2FyZHMyKCk7XHJcblxyXG4gICAgICAgIGlmKGNjLm1vc2hpID09IDEpIGNjLnRlU2h1UGFpQ2FyZHMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLnJlc2V0KCk7ICAvLyMjIyMjXHJcbiAgICAgICAgICAgIHBsYXllckNvbXAuaGlkZVJlYWR5U3RhdHVzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldElzVGVTaHVQYWk6IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICB2YXIgY2FyZHMgPSB0aGlzLl9maW5kQ2FyZHNCeVVzZXJJZCh1c2VySWQpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmlzVGVTaHVQYWkoY2FyZHMpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMj5qOA5rWL54m55q6K54mM57G75Z6L77yM5pi+56S655u45a+55bqU55qE5oGt5Zac5L2g6aG16Z2i5ZKM54m55q6K54mM57K+54G1Ki9cclxuICAgIF9zaG93R29uZ1hpTmlBbmRCdG5UZVNodVBhaTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8q5aaC5p6c5pyJ54m55q6K54mMKi9cclxuICAgICAgICBpZihURVNIVVBBSVRZUEUuaXNUZVNodVBhaSl7XHJcbiAgICAgICAgICAgIGlmKFRFU0hVUEFJVFlQRS5pc1FpbmdMb25nKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlLCBcIuWQjOiKseWNgeS4ieawtFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NhblRvbmdIdWEgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYoVEVTSFVQQUlUWVBFLmlzWWlUaWFvTG9uZyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSwgXCLljYHkuInmsLRcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl95aVRpYW9Mb25nID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKFRFU0hVUEFJVFlQRS5pc0xpdUR1aUJhbil7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSwgXCLlha3lr7nljYpcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9saXVEdWlCYW4gPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYoVEVTSFVQQUlUWVBFLmlzU2FuU2h1blppKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlLCBcIuS4iemhuuWtkFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NhblNodW5aaSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTYW5UYW9IdWEpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUsIFwi5LiJ5ZCM6IqxXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2FuVG9uZ0h1YSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1NhblRvbmdIdWFTaHVuKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9TYW5Ub25nSHVhU2h1biA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzU2FuRmVuVGlhblhpYSl7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fU2FuRmVuVGlhblhpYSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzQ291WWlTZSl7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fQ291WWlTZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzU2lUYW9TYW5UaWFvKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9TaVRhb1NhblRpYW8gPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1d1RHVpU2FuVGlhbyl7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fV3VEdWlTYW5UaWFvID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nb25nWGlOaVNob3coZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdGhpcy5faW5pdFRlU2h1UGFpU3ByaXRlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qIyMjIyPmjqfliLbnibnmrorniYznsr7ngbXnmoTmmL7npLoqL1xyXG4gICAgX2luaXRUZVNodVBhaVNwcml0ZTpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLyrmiormiYDmnInnmoTnibnmrorniYznsr7ngbXpg73pmpDol4/mjokqL1xyXG4gICAgICAgIC8vZm9yKHZhciBpPTA7aTx0aGlzLnRlc2h1cGFpX21pbi5sZW5ndGg7aSsrKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pbltpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFtpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiA5p2h6b6Z77yM5bCx5pi+56S65LiA5p2h6b6Z55qE57K+54G1Ki9cclxuICAgICAgICAvL2lmKHRoaXMuX3lpVGlhb0xvbmcpe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzNdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbM10uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5YWt5a+55Y2K5bCx5pi+56S65YWt5a+55Y2K55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fbGl1RHVpQmFuKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pblswXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzBdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4iemhuuWtkOWwseaYvuekuuS4iemhuuWtkOeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX3NhblNodW5aaSl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bMV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFsxXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9zYW5Ub25nSHVhKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pblsyXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzJdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX1FpbmdMb25nKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pbls0XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzRdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99X2dvbmdYaU5pU2hvd1xyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9TYW5Ub25nSHVhU2h1bil7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bNV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFs1XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8vLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9TYW5GZW5UaWFuWGlhKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pbls2XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzZdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX0NvdVlpU2Upe1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWluWzddLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9tYXhbN10uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL31cclxuICAgICAgICAvLy8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICAvL2Vsc2UgaWYodGhpcy5fU2lUYW9TYW5UaWFvKXtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21pbls4XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGVzaHVwYWlfbWF4WzhdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX1d1RHVpU2FuVGlhbyl7XHJcbiAgICAgICAgLy8gICAgdGhpcy50ZXNodXBhaV9taW5bOV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICB0aGlzLnRlc2h1cGFpX21heFs5XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMjKi9cclxuICAgIC8v5pi+56S6Z29uZ1hpTmkg6aG16Z2i5ZKMdGVTaHVQYWlcclxuICAgIGNsaWNrR29uZ1hpTmlTaG93OmZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuc2NhbGUgPSAxO1xyXG4gICAgICAgIHZhciBub2RlcyA9IHRoaXMuZ29uZ1hpTmkuZ2V0Q2hpbGRCeU5hbWUoXCJiZ1wiKTtcclxuICAgICAgICBub2Rlcy5vcGFjaXR5ID0gMDtcclxuICAgIH0sXHJcblxyXG4gICAgX2dvbmdYaU5pU2hvdzpmdW5jdGlvbiAoc3RhdHVlcywgdGVzdCA9IFwiXCIpIHtcclxuICAgICAgICAvL3ZhciBhbHRlckNvbSA9IHRoaXMuZ29uZ1hpTmkuZ2V0Q29tcG9uZW50KFwiYWxlcnRcIik7XHJcbiAgICAgICAgbGV0IGFsdGVyQ29tID0gdGhpcy5nb25nWGlOaS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgYWx0ZXJDb20udW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIHRlc3QgPSBcIuaYr+WQpuaMieeJueauiueJjOWei1tcIiArIHRlc3QgKyBcIl3lh7rniYzvvJ9cIiArXCJcXG5cIisgXCIo5Y+W5raI5ZCO54K55Ye75bem5LiL6KeS5Y+v5YaN5oql6YGTKVwiO1xyXG4gICAgICAgIGFsdGVyQ29tLnNldE1lc3NhZ2UodGVzdCk7XHJcbiAgICAgICAgaWYoc3RhdHVlcyl7XHJcbiAgICAgICAgICAgIGFsdGVyQ29tLmFsZXJ0KCk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGFsdGVyQ29tLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50ZVNodVBhaS5hY3RpdmUgPSBzdGF0dWVzO1xyXG4gICAgICAgIHZhciBub2RlcyA9IHRoaXMudGVTaHVQYWkuZ2V0Q2hpbGRCeU5hbWUoXCJidG5UZXNodXBhaVwiKTtcclxuICAgICAgICBub2Rlcy5jaGlsZHJlblswXS5ydW5BY3Rpb24oY2MucmVwZWF0Rm9yZXZlcihjYy5yb3RhdGVCeSgxLCAtMzYwKSkpO1xyXG4gICAgICAgIG5vZGVzLmNoaWxkcmVuWzFdLnJ1bkFjdGlvbihjYy5yZXBlYXRGb3JldmVyKGNjLnJvdGF0ZUJ5KDEsIDM2MCkpKTtcclxuICAgIH0sXHJcbiAgICAvKiMjIyMjKi9cclxuXHJcbiAgICAvLyAg57uT5p6c55u45YWzXHJcbiAgICAvLyDmmL7npLrkuIDlsYDnu5PmnpxcclxuICAgIF9zaG93T25lR2FtZVJlc3VsdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgICB0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ID0gZmFsc2U7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMudXBkYXRlR2FtZVN0YXR1cyhHQU1FU1RBVFVTLldBSVRfUEVPUExFKTtcclxuICAgICAgICAvL2xldCBvbmVHYW1lUmVzdWx0ID0gdGhpcy5vbmVHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnR2FtZVJlc3VsdCcpO1xyXG4gICAgICAgIC8vb25lR2FtZVJlc3VsdC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgLy9vbmVHYW1lUmVzdWx0LnNob3dSZXN1bHRzKHRoaXMuX2Rlc2tJbmZvLCB0aGlzLl91c2VySWQpO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZVVzZXJTY29yZXMoKTtcclxuICAgICAgICAvL3RoaXMuX3VwZGF0ZUJhbmtlcigpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvL3NlbGYuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgICAvLyAgLy9wbGF5ZXJDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIC8vICAvL3BsYXllckNvbXAucmVzZXQyKCk7ICAvLyMjIyMjXHJcbiAgICAgICAgICAgIC8vfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXNlbGYuX2lzUmFuZG9tUm9vbSgpKSB7XHJcbiAgICAgICAgICAgICAgICAvL2lmIChzZWxmLl9kZXNrSW5mby5jSW5kZXggPT0gMCkgey8v5LiA5bGA6L+Y5rKh5byA5aeLXHJcbiAgICAgICAgICAgICAgICAvLyAgICBzZWxmLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuX2lzVG90YWxHYW1lT3ZlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2hvd1RvdGFsR2FtZVJlc3VsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgMC41KTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2lzUmFuZG9tUm9vbSgpIHx8IFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBvbmVHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICAgICAgfSwgMik7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5pi+56S65oC757uT5p6cXHJcbiAgICBfc2hvd1RvdGFsR2FtZVJlc3VsdDogZnVuY3Rpb24gKHNob3dEZWxheSA9IDIpIHtcclxuICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XHJcbiAgICAgICAgLy9jYy5maW5kKFwiQ2FudmFzL3Nob3dfcmVzdWx0XCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSB0aGlzLl9kZXNrSW5mby5tTWF4KXtcclxuICAgICAgICAgICAgdGhpcy5hZ2FpbkJ0bi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLmFnYWluQnRuLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHRvdGFsR2FtZVJlc3VsdENvbXAgPSB0aGlzLnRvdGFsR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ1RvdGFsR2FtZVJlc3VsdCcpO1xyXG4gICAgICAgIGlmKCB0b3RhbEdhbWVSZXN1bHRDb21wLm5vZGUuYWN0aXZlICl7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IFxyXG5cclxuICAgICAgICBpZih0aGlzLl9iaWdSZWNvcmRJbmZvID09IG51bGwpe1xyXG4gICAgICAgICAgICB0aGlzLl9iaWdSZWNvcmRJbmZvID0gdGhpcy5fZGVza0luZm8ucGxheWVycztcclxuICAgICAgICB9XHJcbiAgICAgICAgdG90YWxHYW1lUmVzdWx0Q29tcC5zZXRQbGF5ZXJJbmZvcyh0aGlzLl9iaWdSZWNvcmRJbmZvLCB0aGlzLl9kZXNrSW5mbyk7XHJcblxyXG4gICAgICAgIGxldCBhbGVydCA9IHRoaXMudG90YWxHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vdGhpcy5vbmVHYW1lUmVzdWx0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL2FsZXJ0LmFsZXJ0KCk7XHJcbiAgICAgICAgICAgIC8qKi9cclxuICAgICAgICAgICAgaWYgKCF0aGlzLnRvdGFsR2FtZVJlc3VsdC5hY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0LmFsZXJ0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLyoqL1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSwgc2hvd0RlbGF5KTtcclxuXHJcbiAgICAgICAgYWxlcnQuc2V0RGlzbWlzc0NhbGxiYWNrKGZ1bmN0aW9uICgpe1xyXG4gICAgICAgICAgICBTb2NrZXQuc2VuZE9uY2VBZ2FpbignZmFsc2UnLHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgICAgIC8vY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgY2xpY2tBZ2FpbjpmdW5jdGlvbigpe1xyXG4gICAgICAgIFNvY2tldC5zZW5kT25jZUFnYWluKCd0cnVlJyx0aGlzLl91c2VySWQpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiBTb2NrZXQg55u45YWzXHJcbiAgICBfbG9hZERlc2tJbmZvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgU29ja2V0LnNlbmRHZXREZXNja0luZm8odGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcbiAgICBfcmVnaXN0ZXJTb2NrZXRFdmVudDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEZXNrSW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZURlc2tJbmZvLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlT25saW5lU3RhdHVzLCB0aGlzLl9zb2NrZXRSZWNpdmVPbmxpbmVTdGF0dXMsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVDaGF0VGV4dCwgdGhpcy5fc29ja2V0UmVjaXZlQ2hhdFRleHRNZXNzYWdlLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlQ2hhdEVtb2ppLCB0aGlzLl9zb2NrZXRSZWNpdmVDaGF0RW1vamlNZXNzYWdlLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlUmVxdWVzdERpc3NvbHZlLCB0aGlzLl9zb2NrZXRSZWNlaXZlUmVxdWVzdEV4aXRNZXNzYWdlLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlUmVxdWVzdERpc3NvbHZlUmVzdWx0LCB0aGlzLl9zb2NrZXRSZWNlaXZlUmVxdWVzdEV4aXRSZXN1bHRNZXNzYWdlLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlQXVkaW9NZXNzYWdlLCB0aGlzLl9zb2NrZXRSZWNlaXZlQXVkaW9NZXNzYWdlLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlUGxheUNhcmQsIHRoaXMuX3NvY2tldFJlY2VpdmVQbGF5Q2FyZCwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUdhbWVPdmVyLCB0aGlzLl9zb2NrZXRSZWNlaXZlR2FtZU92ZXIsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVGYVBhaSwgdGhpcy5fc29ja2V0UmVjaXZlRmFQYWksIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVSZWFkeSwgdGhpcy5fc29ja2V0UmVjaXZlUmVhZHksIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEaXNzb2x2ZURlc2ssIHRoaXMuX3NvY2tldFJlY2VpdmVEaXNzb2x2ZURlc2ssIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVMZWF2ZURlc2ssIHRoaXMuX3NvY2tldExlYXZlRGVzaywgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0RGlzY29ubmVjdCwgdGhpcy5fcmVjZWl2ZVNvY2tldENvbm5lY3RFcnJvciwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcy5fcmVjZWl2ZVNvY2tldENvbm5lY3RTdWNjZXNzZWQsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVQYXVzZSwgdGhpcy5fc29ja2V0UmVjZWl2ZVBhdXNlLCB0aGlzKTtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlU2VsZWN0QmVpTHYsIHRoaXMuX1JlY2VpdmVTZWxlY3RCZWlMdiwgdGhpcyk7XHJcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUJlaUx2LCB0aGlzLl9SZWNlaXZlQmVpTHYsIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVRaW5nTGksIHRoaXMuX1JlY2VpdmVRaW5nTGksIHRoaXMpO1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVPbmNlQWdhaW4sIHRoaXMuX1JlY2VpdmVPbmNlQWdhaW4sIHRoaXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfUmVjZWl2ZU9uY2VBZ2FpbjpmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5YaN5p2l5LiA5bGAXHJcbiAgICAgICAgICog5oC757uT5p6c6KaB6ZqQ6JeP5o6JXHJcbiAgICAgICAgICog5q+U54mM6KaB6ZqQ6JeP5o6JXHJcbiAgICAgICAgICog5Y+R54mM6KaB5pi+56S6XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzID0gW107XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJDb21wcy5mb3JFYWNoKHBsYXllckNvbXAgPT4ge1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLnBsYXllZENvbXBhcmVDYXJkc0luZGV4cyA9IHRoaXMuX3BsYXllZENvbXBhcmVDYXJkc0luZGV4cztcclxuICAgIH0pO1xyXG4gICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICBpZighZGF0YS5yZWFzb24pe1xyXG4gICAgICAgICAgICB0aGlzLnRvdGFsR2FtZVJlc3VsdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5zdGFydENvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyQ29tcC5yZXNldCgpOyAgLy8jIyMjI1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5fc29ja2V0UmVjZWl2ZURlc2tJbmZvKHJlc3BvbnNlKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdmFyIG5vdyA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgIGlmKG5vdyAtIHRoaXMuX25vd1RpbWVBZ2FpbiA+IDE1MDApe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbm93VGltZUFnYWluID0gbm93O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0LnkgPSAtMTQzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0Lm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQuY2hpbGRyZW5bMF0uZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSAn5oi/5Y2h5LiN6LazJztcclxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBjYy5zcGF3bihjYy5tb3ZlVG8oMC4zLCBjYy5wKDAsIDIwKSksIGNjLmZhZGVPdXQoMC4zKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRSZXN1bHQucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLm1vdmVUbygxLCBjYy5wKDAsIDApKSwgYWN0aW9uKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBfUmVjZWl2ZVNlbGVjdEJlaUx2OmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgIT0gdGhpcy5fdXNlcklkKXtcclxuICAgICAgICAgICAgdGhpcy5iZWlsdi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB2YXIgQjMgPSB0aGlzLmJlaWx2LmdldENoaWxkQnlOYW1lKCdiZycpLmdldENoaWxkQnlOYW1lKCdidG4zJykuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc1PT0xKXtcclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICog5bqE5a626YCJ5oup5Lik5YCN55qE5pe25YCZIDPlgI3mjInpkq7mmK/kuI3og73lk43lupTnmoRcclxuICAgICAgICAgICAgICAgICAqIOmAieaLqeS4ieWAjeS4jeeUqOeuoe+8jOWFqOmDqOaYvuekuu+8jFxyXG4gICAgICAgICAgICAgICAgICog6YCJ5oup5LiA5YCN5Lmf5LiN55So566h77yM55u05o6l5Y+R54mM77yMXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIEIzLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBzZWxlY3RCbCA9IHRoaXMuYmVpbHYuZ2V0Q29tcG9uZW50KCdzZWxlY3RCZWlsdicpO1xyXG4gICAgICAgICAgICBzZWxlY3RCbC5fdXNlcmlkID0gdGhpcy5fdXNlcmlkO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgX1JlY2VpdmVCZWlMdjpmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICAgIGxldCBibCA9IHJlc3BvbnNlLmRhdGEuYmVpbHY7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyLnNob3dCZWlsdih1c2VySWQsYmwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfUmVjZWl2ZVFpbmdMaTpmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgdmFyIGxlYXZlSWQgPSByZXNwb25zZS5kYXRhLmxlYXZlSWQ7XHJcbiAgICAgICAgaWYobGVhdmVJZCA9PSB0aGlzLl91c2VySWQpe1xyXG4gICAgICAgICAgICBpZihjYy5xaW5nbGkgPT0gbnVsbCl7XHJcbiAgICAgICAgICAgICAgICB2YXIgcWwgPSByZXNwb25zZS5hY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjYy5xaW5nbGkgPSAnJztcclxuICAgICAgICAgICAgICAgIGNjLnFpbmdsaSA9IHFsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlRGVza0luZm86IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGNjLmVycm9yKFwi6ZSZ6K+v77yaXCIsIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcblxyXG4gICAgICAgIHRoaXMuX2luaXRQbGF5ZXJDb21wb25lbnRzKGRhdGEucGxheWVyc0luZGV4QXl5KTtcclxuICAgICAgICAvKiMjIyMj5re75Yqg5LqU5ZCM5oyJ6ZKuKi9cclxuICAgICAgICAvLyBjYy5tb3NoaSA9IDA7XHJcblxyXG4gICAgICAgIC8vIGlmKGRhdGEuc2V0dGluZzNbMV0gPT0gdHJ1ZSkgY2MubW9zaGkgPSAxOyAgLy8gIO+8n++8n++8n1xyXG5cclxuICAgICAgICBjYy5tYVBhaSA9IG51bGw7XHJcblxyXG4gICAgICAgIGlmKGRhdGEubWFQYWkubGVuZ3RoID09IDIpIGNjLm1hUGFpID0gZGF0YS5tYVBhaVswXSArIFwiX1wiICsgZGF0YS5tYVBhaVsxXTtcclxuXHJcbiAgICAgICAgY2MuaHVhU2UgPSBkYXRhLnNldHRpbmczWzJdO1xyXG5cclxuICAgICAgICBjYy5jaGFvU2hpQ2h1UGFpID0gZGF0YS5zZXR0aW5nNjtcclxuXHJcbiAgICAgICAgY2MuZHVvWWlTZSA9IHJlc3BvbnNlLmRhdGEuc2V0dGluZzI7ICAgLy9zZXR0aW5nMuS4uiA0fjcg5Lq677yIMH4z77yJXHJcblxyXG4gICAgICAgIHRoaXMuX2Rlc2tJbmZvID0gZGF0YTtcclxuICAgICAgICB0aGlzLl9nbG9iYWxNc2coZGF0YSk7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRHYW1lT3ZlcnZpZXcodGhpcy5fZGVza0luZm8pO1xyXG4gICAgICAgIHRoaXMudXBkYXRlUm9vbU51bWJlcihkYXRhLnJvb21JZCk7XHJcbiAgICAgICAgdGhpcy5uZWVkQ2FyZC5zdHJpbmcgPSAgZGF0YS5uZWVkQ2FyZDsgICAgICAgICAvLyDlvIDmlL7pnIDopoHnmoTmiL/ljaFcclxuICAgICAgICBsZXQgcGxheWVySW5kZXhzID0gZGF0YS5wbGF5ZXJzSW5kZXg7ICAgLy8gWzEwMDA0OV1cclxuICAgICAgICB0aGlzLl9pbmplY3RVc2VySWRUb1BsYXllckNvbXBvbmVudHMocGxheWVySW5kZXhzKTtcclxuXHJcbiAgICAgICAgbGV0IHBsYXllcnMgPSBkYXRhLnBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSBwbGF5ZXJzO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZVVzZXJJbmZvcyhwbGF5ZXJzKTtcclxuICAgICAgICB0aGlzLl91cGRhdGVVc2VyU2NvcmVzKCk7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlQmFua2VyKCk7XHJcbiAgICAgICAgdGhpcy5fbXNnQ29udHJvbC5hZGRQbGF5ZXJJbmZvcyh0aGlzLl9wbGF5ZXJJbmZvcyk7XHJcblxyXG4gICAgICAgIGxldCBjdXJyZW50VXNlckluZm8gPSBwbGF5ZXJzLmZpbmQoZnVuY3Rpb24gKHBsYXllckluZm8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHBsYXllckluZm8uaWQgPT0gdGhpcy5fdXNlcklkO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIGlmKGRhdGEuY3JlYXRlSWQgPT0gdGhpcy5fdXNlcklkKXtcclxuICAgICAgICAgICAgaWYoZGF0YS5jSW5kZXg+MCl7ICAvLyDlvIDlp4vmuLjmiI/kuobvvIzor7fnprvmjInpkq7lhajpg6jpmpDol49cclxuICAgICAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGxheWVyLnNob3dRaW5nbGkoZmFsc2UsZGF0YS5jSW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfWVsc2V7ICAgICAgICAgICAgICAvLyDmuLjmiI/msqHlvIDlp4vvvIzmiL/kuLvnmoTor7fnprvmjInpkq7kuI3mmL7npLpcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS5jcmVhdGVJZCA9PSBwbGF5ZXIudXNlcklkICl7ICAvLyDmiJHmmK/miL/kuLvvvIzkuI3mmL7npLrmiJHnmoTor7fnprvmjInpkq5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLnNob3dRaW5nbGkodHJ1ZSxkYXRhLmNJbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5zaG93UWluZ2xpKGZhbHNlLGRhdGEuY0luZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICBpZihkYXRhLmNyZWF0ZUlkID09IHBsYXllci51c2VySWQpey8v5pi+56S65oi/5Li7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd0ZhbmdaaHVTdGF0dXMoZGF0YS5jcmVhdGVJZCx0cnVlKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd0ZhbmdaaHVTdGF0dXMocGxheWVyLnVzZXJJZCxmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkICE9IHRoaXMuX3VzZXJJZCApeyAgLy8g6Z2e5bqE5a62XHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwICl7ICAgICAgICAgICAgLy8g5aaC5p6c6L+Y5rKh5byA5aeL5ri45oiP77yM5pi+56S66YCA5Ye65oyJ6ZKu77yM6ZqQ6JeP6Kej5pWj5oyJ6ZKuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4aXQuYWN0aXZlID0gIHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkRpc3NvbHZlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9ZWxzZXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWPjeS5i1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leGl0LmFjdGl2ZSA9ICBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuRGlzc29sdmUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOW6hOWutlxyXG4gICAgICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5jSW5kZXggPiAwICl7ICAgICAgICAgICAgIC8vIOW8gOWxgOS6hiDpmpDol4/pgIDlh7rmjInpkq5cclxuICAgICAgICAgICAgICAgIHRoaXMuZXhpdC5hY3RpdmUgPSAgZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkRpc3NvbHZlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOayoeW8gOWxgCDkuKTkuKrpg73mmL7npLpcclxuICAgICAgICAgICAgICAgIHRoaXMuZXhpdC5hY3RpdmUgPSAgdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuRGlzc29sdmUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLl9kZXNrSW5mby5pc0NCZWdpbikge1xyXG4gICAgICAgICAgICB0aGlzLl9nYW1lU3RhdHVzID0gR0FNRVNUQVRVUy5XQUlUX1JFQURZO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IodmFyIGk9MDtpPHBsYXllcnMubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIHZhciBzID0gcGxheWVyc1tpXTtcclxuICAgICAgICAgICAgdmFyIGlzID0gcy5yZWFkeVN0YXR1czsvL3RydWUvZmFsc2VcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IHMuaWQ7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICBpZighdGhpcy5fZGVza0luZm8uaXNDQmVnaW4pIHBsYXllci5zaG93UmVhZHlTdGF0dXModXNlcklkLGlzKTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGN1cnJlbnRVc2VySW5mbyAmJiBjdXJyZW50VXNlckluZm8uY2FyZHMubGVuZ3RoID4gMCAmJiB0aGlzLl9kZXNrSW5mby5pc0NCZWdpbikge1xyXG4gICAgICAgICAgICBpZighY3VycmVudFVzZXJJbmZvLmNhcmRJbmZvLmxlbmd0aCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFydEdhbWUodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhcnRHYW1lKGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyhjdXJyZW50VXNlckluZm8pICYmICF0aGlzLl9kZXNrSW5mby5pc0NCZWdpbikge1xyXG4gICAgICAgICAgICB0aGlzLl9zb2NrZXRSZWNlaXZlR2FtZU92ZXIocmVzcG9uc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzUmVhZHlTdGF0dXMoKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVVcGRhdGVEZXNrSW5mb0Fib3V0RXhpdFJvb20odGhpcy5fZGVza0luZm8pO1xyXG4gICAgICAgIHRoaXMuc2hvd0NvbXBhcmVDYXJkKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dDb21wYXJlQ2FyZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwIHx8IHRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luIHx8XHJcbiAgICAgICAgICAgICF0aGlzLl9kZXNrSW5mby5wbGF5ZXJzIHx8IHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMubGVuZ3RoIDw9IDAgfHwgdGhpcy5fZGVza0luZm8ucGxheWVyc1swXS5jYXJkSW5mbyA8PSAwKXtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5wbGF5c0NvaW5zLmZvckVhY2goZnVuY3Rpb24obm8pe2lmKG5vKSBuby5yZW1vdmVBbGxDaGlsZHJlbigpO30pO1xyXG5cclxuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuXHJcbiAgICAgICAgdGhpcy5ub2RlLnN0b3BBbGxBY3Rpb25zKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge3BsYXllckNvbXAucmVhZHlUb0NvbXBhcmVDYXJkcygpO30pO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG5cclxuICAgICAgICAgICAgaWYocGxheWVyLm5vZGUuYWN0aXZlKXBsYXllci5zaG93QWxsQ29tcGFyZUNhcmRzKHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMpO1xyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICB0aGlzLnN0YXJ0Q29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmlzUmVhZHlTdGF0dXMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzVG90YWxHYW1lT3ZlcigpKSB0aGlzLl9zaG93VG90YWxHYW1lUmVzdWx0KCk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSwgMC41KTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNpdmVGYVBhaTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgLy8gIOWPkeeJjOS6huW8gOWni+avlOeJjOmakOiXj+aOiVxyXG4gICAgICAgIHRoaXMuc3RhcnRDb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcclxuICAgICAgICB0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9nYW1lU3RhdHVzID0gR0FNRVNUQVRVUy5XQUlUX1JFQURZO1xyXG4gICAgICAgIHRoaXMuX3NvY2tldFJlY2VpdmVEZXNrSW5mbyhyZXNwb25zZSk7XHJcbiAgICB9LFxyXG4gICAgbG9nb3V0QWN0aW9uOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2xvZ2luJyk7XHJcbiAgICAgICAgLy9tYW5hZ2VyLnNldFVzZXJJbmZvKCcnKTtcclxuICAgICAgICAvL2hhbGwuY2FjaGVJbWFnZUluZm8gPSBudWxsO1xyXG4gICAgfSxcclxuICAgIF9zb2NrZXRSZWNpdmVPbmxpbmVTdGF0dXM6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIC8ve1wiYWN0aW9uXCI6XCJzZW5kT25saW5lU3RhdHVzXCIsXCJyZXN1bHRcIjp0cnVlLFwiZGF0YVwiOntcInVzZXJJZFwiOjEwMDA0OSxcInN0YXR1c1wiOjF9fVxyXG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGNjLmVycm9yKFwi6ZSZ6K+v77yaXCIsIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIGxldCB1c2VySWQgPSBkYXRhLnVzZXJJZDtcclxuICAgICAgICBsZXQgc3RhdHVzID0gZGF0YS5zdGF0dXM7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5zZXRVc2VyT25saW5lU3RhdHVzKHVzZXJJZCwgc3RhdHVzKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2l2ZUNoYXRUZXh0TWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICAgIGxldCBtZXNzYWdlID0gcmVzcG9uc2UuZGF0YS5tc2c7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5zaG93Q2hhdFRleHQodXNlcklkLCBtZXNzYWdlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5fbXNnQ29udHJvbC5hZGRDaGF0VGV4dE1lc3NhZ2UodXNlcklkLCBtZXNzYWdlKTtcclxuXHJcbiAgICAgICAgbGV0IHNleCA9IHRoaXMuX3BsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVzZXIuaWQgPT0gdXNlcklkO1xyXG4gICAgICAgIH0pLnNleDtcclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNoYXRBdWRpbyhzZXgsIG1lc3NhZ2UpO1xyXG4gICAgfSxcclxuICAgIF9zb2NrZXRSZWNpdmVDaGF0RW1vamlNZXNzYWdlIDpmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICAgIGxldCBlbW9qaSA9IHJlc3BvbnNlLmRhdGEuZW1vamk7XHJcblxyXG4gICAgICAgIC8vdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAvLyAgICBwbGF5ZXIuc2hvd0NoYXRUZXh0KHVzZXJJZCwgZW1vamkpO1xyXG4gICAgICAgIC8vfSk7XHJcbiAgICAgICAgLy90aGlzLl9tc2dDb250cm9sLmFkZENoYXRFbW9qaU1lc3NhZ2UodXNlcklkLCBlbW9qaSk7XHJcbiAgICAgICAgdGhpcy5fbXNnQ29udHJvbC5fbG9hZEVtb2ppRnJhbWUoZW1vamksZnVuY3Rpb24oZnJhbWUpe1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICAgICAgaWYocGxheWVyLnVzZXJJZCA9PSB1c2VySWQpIHBsYXllci5jaGF0TWVzc2FnZU5vZGUuZ2V0Q29tcG9uZW50KCdDaGF0TWVzc2FnZScpLnNob3dFbW9qaShmcmFtZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSlcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVSZXF1ZXN0RXhpdE1lc3NhZ2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIC8vaWYgKHJlc3BvbnNlLmRhdGEudXNlcklkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgIC8vICAgIHJldHVybjtcclxuICAgICAgICAvL31cclxuXHJcblxyXG4gICAgICAgIHZhciBhbGVydF9iZyA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJhbGVydF9iZ1wiKTtcclxuXHJcbiAgICAgICAgdmFyIGJ0bkFncmVlID0gYWxlcnRfYmcuZ2V0Q2hpbGRCeU5hbWUoXCJidG5BZ3JlZVwiKTtcclxuXHJcbiAgICAgICAgdmFyIGJ0bkRpc2FncmVlID0gYWxlcnRfYmcuZ2V0Q2hpbGRCeU5hbWUoXCJidG5EaXNhZ3JlZVwiKTtcclxuXHJcbiAgICAgICAgYnRuQWdyZWUuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgYnRuRGlzYWdyZWUuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdmFyIGRhdGFJbmZvcyA9IHJlc3BvbnNlLmRhdGEuaW5mbztcclxuXHJcbiAgICAgICAgaWYoIXRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuYWN0aXZlKXtcclxuXHJcbiAgICAgICAgICAgIGxldCBhbGVydENvbXAgPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuXHJcbiAgICAgICAgICAgIGFsZXJ0Q29tcC5hbGVydCgpO1xyXG5cclxuICAgICAgICAgICAgYWxlcnRDb21wLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY29udGVudEFuc293ZXJFeGl0Tm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGkpe2kuYWN0aXZlID0gZmFsc2U7fSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllckluZm8saW5kZXgpe1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBwbGF5ID0gdGhpcy5jb250ZW50QW5zb3dlckV4aXROb2RlLmNoaWxkcmVuW2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IHBsYXkuZ2V0Q2hpbGRCeU5hbWUoXCJuaWNrbmFtZVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgYmFjayA9IHBsYXkuZ2V0Q2hpbGRCeU5hbWUoXCJmYW56aHVcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGltZyA9IHBsYXkuZ2V0Q2hpbGRCeU5hbWUoXCJhdmF0YXJfYmdcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgcGxheS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgIG5hbWUuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBwbGF5ZXJJbmZvLm5pY2tuYW1lO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHBsYXllckluZm8uaWQpey8v5pi+56S65oi/5Li7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJhY2suYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2V7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJhY2suYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY2MubG9hZGVyLmxvYWQoe3VybDpwbGF5ZXJJbmZvLmF2YXRhclVybCx0eXBlOlwianBnXCJ9LCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKGRhdGEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpbWcuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBmcmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgY291bnRkb3duID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpO1xyXG5cclxuICAgICAgICAgICAgY291bnRkb3duLnN0YXJ0Q291bnRkb3duKDYwLCBmdW5jdGlvbihpc1RpbWVvdXQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaXNUaW1lb3V0KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tBZ3JlZU90aGVyUGxheWVyRXhpdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zLmZvckVhY2goZnVuY3Rpb24ocGxheWVySW5mbyxpbmRleCl7XHJcblxyXG4gICAgICAgICAgICB2YXIgZGF0YUluZm8gPSBkYXRhSW5mb3NbaW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgdmFyIHBsYXkgPSB0aGlzLmNvbnRlbnRBbnNvd2VyRXhpdE5vZGUuY2hpbGRyZW5baW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgdmFyIHN0ciA9IHBsYXkuZ2V0Q2hpbGRCeU5hbWUoXCJpZFwiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBkYXRhSW5mbyA9IGRhdGFJbmZvc1tpbmRleF07XHJcblxyXG4gICAgICAgICAgICBpZihkYXRhSW5mbyA9PSAxKXtcclxuXHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLl91c2VySWQgPT0gcGxheWVySW5mby5pZCl7Ly/mmL7npLrmiL/kuLtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnRuQWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJ0bkRpc2FncmVlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHN0ci5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi5ZCM5oSPXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuXHJcbiAgICAgICAgICAgICAgICBzdHIuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjZWl2ZVJlcXVlc3RFeGl0UmVzdWx0TWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdGhpcy5faGlkZVJlcWVzdEV4aXROb2RlKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0b3AoKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgLy8g6Kej5pWj5oiQ5YqfXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICAgICAgICBsZXQgbmlja25hbWUgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHVzZXJJZCkubmlja25hbWU7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdFJlc3VsdC55ID0gLTE0MztcclxuICAgICAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0UmVzdWx0Lm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdFJlc3VsdC5jaGlsZHJlblswXS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IG5pY2tuYW1lICsgJ+S4jeWQjOaEj+mAgOWHuic7XHJcbiAgICAgICAgICAgIHZhciBhY3Rpb24gPSBjYy5zcGF3bihjYy5tb3ZlVG8oLjMsIGNjLnAoMCwgMjApKSwgY2MuZmFkZU91dCh0aGlzLmNhcmRUaW1lKSk7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdFJlc3VsdC5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2MubW92ZVRvKDEsIGNjLnAoMCwgMCkpLCBhY3Rpb24pKTtcclxuXHJcbiAgICAgICAgICAgIC8vdGhpcy5zaG93QWxlcnRNZXNzYWdlKCfop6PmlaPlpLHotKXvvIzlm6DkuLonICsgbmlja25hbWUgKyAn5LiN5ZCM5oSP6YCA5Ye6Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjZWl2ZUF1ZGlvTWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICAgIHRoaXMucGxheVNwZWFrQW5pbWF0aW9uKHVzZXJJZCk7XHJcblxyXG4gICAgICAgIGlmICh1c2VySWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCB1cmwgPSByZXNwb25zZS5kYXRhLnVybDtcclxuICAgICAgICB0aGlzLnBsYXlBdWRpb1VybCh1cmwpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjZWl2ZVBsYXlDYXJkOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAvLyDmnInnlKjmiLflt7Lnu4/lh4blpIflpb3kuobniYxcclxuICAgICAgICB2YXIgdXNlcklkID0gcmVzcG9uc2UuZGF0YVswXS51c2VySWQ7XHJcbiAgICAgICAgdmFyIGNhcmRJbmZvID0gcmVzcG9uc2UuZGF0YVsxXS5jYXJkO1xyXG4gICAgICAgIHRoaXMuX2Rlc2tJbmZvID0gcmVzcG9uc2UuZGF0YVsyXS5zO1xyXG4gICAgICAgIGxldCBwbGF5ZXJzID0gcmVzcG9uc2UuZGF0YVsyXS5zLnBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSBwbGF5ZXJzO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZVVzZXJJbmZvcyhwbGF5ZXJzKTtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICBwbGF5ZXIucGxheUNhcmQodXNlcklkLGNhcmRJbmZvKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHVzZXJJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBfZ2V0U2VsZlJlYWR5U3RhdHVzOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZCh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgIHJldHVybiBzZWxmLnJlYWR5U3RhdHVzO1xyXG4gICAgfSxcclxuICAgIF9zb2NrZXRSZWNpdmVSZWFkeTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIGlmKCF0aGlzLl9kZXNrSW5mby5pc0NCZWdpbikgcGxheWVyLnNob3dSZWFkeVN0YXR1cyh1c2VySWQpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8v5pS25Yiw5ri45oiP57uT5p2fXHJcbiAgICBfc29ja2V0UmVjZWl2ZUdhbWVPdmVyOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XHJcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwidGltZXN0YW1wXCIpO1xyXG5cclxuICAgICAgICB0aGlzLl9oaWRlUmVxZXN0RXhpdE5vZGUoKTtcclxuXHJcbiAgICAgICAgLy8g5LiA5bGA5ri45oiP57uT5p2fXHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgY2MuZXJyb3IoXCLplJnor6/vvJpcIiwgcmVzcG9uc2UpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKi9cclxuICAgICAgICBjb25zdCBkZXNrSW5mbyA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgaWYgKHJlc3BvbnNlLmFjdGlvbiA9PSAnZ2FtZU92ZXInICYmIGRlc2tJbmZvLmlzRGVza092ZXIpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kRGlkUmVjZWl2ZUdhbWVPdmVyQWN0aW9uKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKi9cclxuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IHJlc3BvbnNlLmRhdGE7XHJcblxyXG4gICAgICAgIC8vIOWmguaenOaYr+W8uuWItuino+aVo+aIv+mXtO+8jOWImeebtOaOpeaYvuekuuaAu+aIkOe7qVxyXG4gICAgICAgIGlmICh0aGlzLl9pc0Rpc3N2bGVkUm9vbSgpICYmICFQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd1RvdGFsR2FtZVJlc3VsdCgwLjEpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgaWYgKERhdGUubm93KCkgLSB0aGlzLl9lbnRlclRpbWUgPCAxMDAwICogNCkge1xyXG4gICAgICAgICAgICAvLyDliJrov5vmnaXnmoTor53vvIzkuI3lsZXnpLrmr5TniYzliqjnlLtcclxuICAgICAgICAgICAgLy8gIGxldCBvbmVHYW1lUmVzdWx0ID0gdGhpcy5vbmVHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnR2FtZVJlc3VsdCcpO1xyXG4gICAgICAgICAgICAvLyAgb25lR2FtZVJlc3VsdC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgICAgIC8vICBvbmVHYW1lUmVzdWx0LnNob3dSZXN1bHRzKHRoaXMuX2Rlc2tJbmZvLCB0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB0aGlzLmlzUmVhZHlTdGF0dXMoKTtcclxuICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvKiovXHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllZENvbXBhcmVDYXJkc0luZGV4cy5wdXNoKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCk7XHJcbiAgICAgICAgICAgIC8qKi9cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIHRoaXMuX2Rlc2tJbmZvID0gZGF0YTtcclxuICAgICAgICB0aGlzLl9iaWdSZWNvcmRJbmZvID0gZGF0YS5iaWdSZWNvcmRJbmZvXHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzA5XCIpO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0R2FtZU92ZXJ2aWV3KHRoaXMuX2Rlc2tJbmZvKTtcclxuICAgICAgICAvL2xldCBwbGF5ZXJJbmRleHMgPSBkYXRhLnBsYXllcnNJbmRleDsgLy8gWzEwMDA0OV1cclxuXHJcbiAgICAgICAgbGV0IHBsYXllcnMgPSBkYXRhLnBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSBwbGF5ZXJzO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZVVzZXJJbmZvcyhwbGF5ZXJzKTtcclxuICAgICAgICAvL3RoaXMuX3VwZGF0ZVJlY29yZEluZm8ocGxheWVycyk7XHJcblxyXG4gICAgICAgIGlmIChVc2VyTW9kZWxIZWxwZXIuaXNVc2VyUmVhZHkodGhpcy5fZmluZEN1cnJlbnRVc2VySW5mbygpKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fc3RhcnRDb21wYXJlQ2FyZHMocmVzcG9uc2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKERhdGUubm93KCkgLSB0aGlzLl9lbnRlclRpbWUgPCAxMDAwICogNCkge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dDb21wYXJlQ2FyZCgpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8vIF91cGRhdGVSZWNvcmRJbmZvOmZ1bmN0aW9uKHBsYXllcnMpe1xyXG5cclxuICAgIC8vICAgICAvLyB0aGlzLl9iaWdSZWNvcmRJbmZvLnB1c2goKTtcclxuICAgIC8vIH0sXHJcbiAgICBfc29ja2V0UmVjZWl2ZURpc3NvbHZlRGVzazogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcblxyXG4gICAgICAgIC8vIHRoaXMuYWxlcnQuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnNldFdpbGxEaXNtaXNzQ2FsbGJhY2soZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgLy8gICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAvLyB9KTtcclxuXHJcbiAgICAgICAgLy8gbGV0IG1lc3NhZ2UgPSBcIuaIv+S4u+W3suino+aVo+aIv+mXtFwiO1xyXG4gICAgICAgIC8vIGlmICh0aGlzLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgICAgIC8vICAgbWVzc2FnZSA9IFwi5pyJ546p5a625bey5by65Yi26YCA5Ye65oi/6Ze077yM5ri45oiP57uT5p2f44CC5pys5bGA5ri45oiP5LiN5Lya5omj6Zmk5oKo55qE6ZK755+z44CCXCI7XHJcbiAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAvLyB0aGlzLnNob3dBbGVydE1lc3NhZ2UobWVzc2FnZSwgZmFsc2UpO1xyXG4gICAgfSxcclxuICAgIC8qKi9cclxuICAgIF9zb2NrZXRMZWF2ZURlc2s6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5pc0Rlc2tPdmVyKSB7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOaIv+mXtOW3sue7k+adn++8jOS5n+S4jeeUqOWGjeiHquWKqOmAgOWbnuWIsOWkp+WOheS6hlxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICAvLyBzb2NrZXQg5pS25Yiw5pyJ5Lq65omL5py66L+b5YWl5ZCO5Y+w5raI5oGvXHJcbiAgICBfc29ja2V0UmVjZWl2ZVBhdXNlOiBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCB1c2VySWQgPSByZXNwb25zZS5kYXRhLnVzZXJJZDtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheWVyKSB7XHJcbiAgICAgICAgICAgIGlmIChwbGF5ZXIudXNlcklkID09IHVzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLnNldFVzZXJPbmxpbmVTdGF0dXModXNlcklkLCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcmVjZWl2ZVNvY2tldENvbm5lY3RFcnJvcjogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLnNob3dOZXR3b3JrTWVzc2FnZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcmVjZWl2ZVNvY2tldENvbm5lY3RTdWNjZXNzZWQ6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdGhpcy5oaWRkZW5OZXR3b3JrTWVzc2FnZSgpO1xyXG5cclxuICAgICAgICBpZiAoIVBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9sb2FkRGVza0luZm8oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyoqL1xyXG4gICAgLy8gTUFSSzog5pu05paw5oi/6Ze05L+h5oGvXHJcbiAgICB1cGRhdGVEZXNrSW5mbzogZnVuY3Rpb24gKGRlc2tJbmZvKSB7XHJcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcclxuICAgICAgICB0aGlzLl91cGRhdEdhbWVPdmVydmlldyh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVSb29tTnVtYmVyKGRlc2tJbmZvLnJvb21JZCk7XHJcblxyXG4gICAgICAgIGxldCBwbGF5ZXJJbmRleHMgPSBkZXNrSW5mby5wbGF5ZXJzSW5kZXg7IC8vIFsxMDAwNDldXHJcbiAgICAgICAgdGhpcy5faW5qZWN0VXNlcklkVG9QbGF5ZXJDb21wb25lbnRzKHBsYXllckluZGV4cyk7XHJcblxyXG4gICAgICAgIGxldCBwbGF5ZXJzID0gZGVza0luZm8ucGxheWVycztcclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHBsYXllcnMpO1xyXG4gICAgICAgIHRoaXMuX21zZ0NvbnRyb2wuYWRkUGxheWVySW5mb3ModGhpcy5fcGxheWVySW5mb3MpO1xyXG4gICAgICAgIGlmIChkZXNrSW5mby5jSW5kZXggPT0gMCAmJiB0aGlzLl9kZXNrSW5mby5wbGF5ZXJzLmxlbmd0aCA8IHRoaXMuX2Rlc2tJbmZvLm1heE51bWJlcikge1xyXG4gICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyoqL1xyXG4gICAgX2luamVjdFVzZXJJZFRvUGxheWVyQ29tcG9uZW50czogZnVuY3Rpb24gKHBsYXllckluZGV4cykge1xyXG4gICAgICAgIGxldCBjdXJyZW50VXNlcklkSW5kZXggPSBwbGF5ZXJJbmRleHMuZmluZEluZGV4KGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVzZXJJZCA9PSB0aGlzLl91c2VySWQ7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgbGV0IGZpeGVkUGxheWVySW5kZXhzID0gcGxheWVySW5kZXhzLnRyYW5zbGF0aW9uV2l0aFN0YXJ0SW5kZXgoY3VycmVudFVzZXJJZEluZGV4KTtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXBvbmVudCwgaW5kZXgpIHtcclxuICAgICAgICAgICAgbGV0IHVzZXJJZCA9IGZpeGVkUGxheWVySW5kZXhzLmxlbmd0aCA+IGluZGV4ID8gZml4ZWRQbGF5ZXJJbmRleHNbaW5kZXhdIDogbnVsbDtcclxuICAgICAgICAgICAgcGxheWVyQ29tcG9uZW50LnVzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX3VwZGF0ZVVzZXJJbmZvczogZnVuY3Rpb24gKHVzZXJJbmZvcykge1xyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXBvbmVudCwgaW5kZXgpIHtcclxuICAgICAgICAgICAgLy9wbGF5ZXJDb21wb25lbnQuc2V0RGVza0luZm8oc2VsZi5fZGVza0luZm8pO1xyXG4gICAgICAgICAgICAvKiovXHJcbiAgICAgICAgICAgIHBsYXllckNvbXBvbmVudC51cGRhdGVEZXNrSW5mbyhzZWxmLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgICAgIC8qKi9cclxuICAgICAgICAgICAgcGxheWVyQ29tcG9uZW50LnVwZGF0ZVVzZXJJbmZvV2l0aFVzZXJzKHVzZXJJbmZvcyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vdGhpcy5faGFuZGxlVGhlU2FtZU9mSVBBZHJlc3ModXNlckluZm9zKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3VwZGF0ZVVzZXJTY29yZXM6IGZ1bmN0aW9uKHVzZXJJbmZvcykge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyLnVwZGF0ZVNjb3JlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBfdXBkYXRlQmFua2VyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheWVyKSB7XHJcbiAgICAgICAgICAgIHBsYXllci51cGRhdGVCYW5rZXIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g56eB5pyJ5pa55rOVXHJcbiAgICBfZmluZENhcmRzQnlVc2VySWQ6IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICBsZXQgcGxheWVyID0gdGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZCh1c2VySWQpO1xyXG5cclxuICAgICAgICByZXR1cm4gKHBsYXllciAhPSBudWxsKSA/IHBsYXllci5jYXJkcyA6IG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9maW5kUGxheWVySW5mb0J5VXNlcklkOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgbGV0IHBsYXllciA9ICh0aGlzLl9wbGF5ZXJJbmZvcyB8fCBbXSkuZmluZChmdW5jdGlvbiAocGxheWVySW5mbykge1xyXG4gICAgICAgICAgICByZXR1cm4gdXNlcklkID09IHBsYXllckluZm8uaWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBwbGF5ZXI7XHJcbiAgICB9LFxyXG5cclxuICAgIF9maW5kUGxheWVySW5kZXhCeVVzZXJJZDogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIC8vbGV0IGluZGV4ID0gdGhpcy5fcGxheWVyQ29tcG9uZW50cy5maW5kSW5kZXgoZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAvLyAgICByZXR1cm4gcGxheWVyQ29tcC51c2VySWQgPT0gdXNlcklkO1xyXG4gICAgICAgIC8vfSk7XHJcbiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5wbGF5ZXJOb2Rlcy5maW5kSW5kZXgoZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5vZGUuZ2V0Q29tcG9uZW50KCdQbGF5ZXInKS51c2VySWQgPT0gdXNlcklkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBpbmRleDtcclxuICAgIH0sXHJcblxyXG4gICAgX2ZpbmRDdXJyZW50VXNlckluZm86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZCh0aGlzLl91c2VySWQpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfY29udmVydENhcmRzVG9DYXJkTmFtZXM6IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgICAgIC8vIFt7XCJzdWl0XCI6XCJzXCIsXCJudW1iZXJcIjoxMH1dXHJcbiAgICAgICAgbGV0IHN1aXRDb2xvck1hcCA9IHtcclxuICAgICAgICAgICAgczogNCxcclxuICAgICAgICAgICAgaDogMyxcclxuICAgICAgICAgICAgYzogMixcclxuICAgICAgICAgICAgZDogMSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICAgICAgdmFyIGNhcmROdW1iZXIgPSBjYXJkLm51bWJlcjtcclxuXHJcbiAgICAgICAgICAgIC8vIOacjeWKoeWZqOS4reeahCAxNCDmmK8gQVxyXG4gICAgICAgICAgICBpZiAoY2FyZC5udW1iZXIgPT0gMTQpIHtcclxuICAgICAgICAgICAgICAgIGNhcmROdW1iZXIgPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBjb2xvciA9IHN1aXRDb2xvck1hcFtjYXJkLnN1aXRdO1xyXG4gICAgICAgICAgICBsZXQgbnVtYmVyID0gTWF0aC5tYXgoTWF0aC5taW4oY2FyZE51bWJlciwgMjEpLCAxKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbG9yICsgXCJfXCIgKyBudW1iZXI7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOabtOaWsOa4uOaIj+aAu+iniOS/oeaBr1xyXG4gICAgX3VwZGF0R2FtZU92ZXJ2aWV3OiBmdW5jdGlvbiAoZGVza0luZm8pIHtcclxuICAgICAgICBpZiAoUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWxPdmVydmlldy5zdHJpbmcgPSBcIuWbnuaUvlwiO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5sYWJlbE92ZXJ2aWV3LnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGJpaHVhc2UgPSBcIuS4jeavlOiKseiJsiBcIjtcclxuICAgICAgICB2YXIgenVvemh1YW5nID0gXCLkuI3lnZDluoQgXCI7XHJcbiAgICAgICAgdmFyIHB1dG9uZyAgPSBcIuaZrumAmuWcuiBcIjtcclxuICAgICAgICB2YXIgd3VndWkgPSAgXCLml6DprLwgXCI7XHJcbiAgICAgICAgdmFyIG1hUGFpID0gJ+S4jeS5sOmprCAnO1xyXG4gICAgICAgIHZhciByZW5zaHUgPSBcIjTkurrkuI3liqDoibIgXCI7XHJcbiAgICAgICAgdmFyIGNhcmQgPSBcIuW5s+aRilwiO1xyXG5cclxuICAgICAgICAvL1vnlq/ni4LlnLos6ay854mMLOavlOiKseiJsizlnZDluoQs6ams54mMXVxyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmczWzJdKXtcclxuICAgICAgICAgICAgYmlodWFzZSA9IFwi5q+U6Iqx6ImyICBcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzNbM10pe1xyXG4gICAgICAgICAgICB6dW96aHVhbmcgPSBcIuWdkOW6hCBcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzNbMF0pe1xyXG4gICAgICAgICAgICBwdXRvbmcgPSBcIueWr+eLguWcuiAgXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmczWzFdKXtcclxuICAgICAgICAgICAgd3VndWkgPSBcIuaciemsvCAgXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmczWzRdKXtcclxuICAgICAgICAgICAgbWFQYWkgPSBcIuS5sOmprFwiO1xyXG4gICAgICAgICAgICB2YXIgaHVhU2UgPSBcIuaWueWdl1wiO1xyXG4gICAgICAgICAgICB2YXIgZGlhblNodSA9IDFcclxuICAgICAgICAgICAgc3dpdGNoKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc3WzBdKXsgLy9zZXR0aW5nNyBbMX40LDF+MTNdIOihqOekuiBb6Iqx6Imy77yM54K55pWwXVxyXG4gICAgICAgICAgICAgICAgY2FzZSAxOiBodWFTZSA9IFwi5pa55Z2XXCI7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6IGh1YVNlID0gXCLmooXoirFcIjticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMzogaHVhU2UgPSBcIue6ouW/g1wiO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBodWFTZSA9IFwi6buR5qGDXCI7YnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3dpdGNoKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc3WzFdKXtcclxuICAgICAgICAgICAgICAgIGNhc2UgMTogZGlhblNodSA9ICdBJzticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMjogZGlhblNodSA9IDI7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6IGRpYW5TaHUgPSAzO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBkaWFuU2h1ID0gNDticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogZGlhblNodSA9IDU7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDY6IGRpYW5TaHUgPSA2O2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBkaWFuU2h1ID0gNzticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgODogZGlhblNodSA9IDg7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDk6IGRpYW5TaHUgPSA5O2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxMDogZGlhblNodSA9IDEwO2JyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxMTogZGlhblNodSA9ICdKJzticmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMTI6IGRpYW5TaHUgPSAnUSc7YnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDEzOiBkaWFuU2h1ID0gJ0snO2JyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG1hUGFpID0gaHVhU2UrZGlhblNodSttYVBhaTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcyID09IDEpe1xyXG4gICAgICAgICAgICByZW5zaHUgPSBcIjXkurrliqDkuIDoibIgXCI7XHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzIgPT0gMil7XHJcbiAgICAgICAgICAgIHJlbnNodSA9IFwiNuS6uuWKoOS6jOiJsiBcIjtcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nMiA9PSAzKXtcclxuICAgICAgICAgICAgcmVuc2h1ID0gXCI35Lq65Yqg5LiJ6ImyIFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nNCA9PSAxKXtcclxuICAgICAgICAgICAgY2FyZCA9IFwi6LWi6ICF5omjIFwiO1xyXG4gICAgICAgIH1lbHNlIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc0ID09IDIpe1xyXG4gICAgICAgICAgICBjYXJkID0gXCLmiL/kuLvmiaMgXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmxhYmVsT3ZlcnZpZXcuc3RyaW5nID0gXCLmqKHlvI8gOiBcIitiaWh1YXNlK3p1b3podWFuZytwdXRvbmcrd3VndWkrbWFQYWkrXCJcXG5cIitcIuWFtuS7lu+8mlwiK3JlbnNodStjYXJkO1xyXG4gICAgICAgIC8vdGhpcy5sYWJlbE92ZXJ2aWV3LnN0cmluZyA9IFwi5qih5byPIDogXCIgKyBcIlwiICsgZGVza0luZm8ubWF4TnVtYmVyICsgXCLkurpcIiArYmlodWFzZSt6dW96aHVhbmcrcHV0b25nK3d1Z3VpK21hUGFpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmmK/lkKbmmK/pmo/mnLrmiL9cclxuICAgIF9pc1JhbmRvbVJvb206IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9kZXNrSW5mby5pc1JhbmRvbURlc2s7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaYr+WQpuaJgOacieWxgOaVsOmDveeUqOWujOS6hlxyXG4gICAgX2lzVG90YWxHYW1lT3ZlcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mbyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5pc0Rlc2tPdmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rlc2tJbmZvLm1NYXggPD0gdGhpcy5fZGVza0luZm8uY0luZGV4O1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmmK/lkKblt7Lop6PmlaPmiL/pl7RcclxuICAgIF9pc0Rpc3N2bGVkUm9vbTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mbykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZGVza0luZm8uZGlzc29sdmVTdGF0dXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBfc3RhcnRDb21wYXJlQ2FyZHM6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KGZhbHNlKTtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJzID0gZGF0YS5kYXRhLnBsYXllcnM7XHJcbiAgICAgICAgbGV0IHVzZXIgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgaWYoIXRoaXMudG90YWxHYW1lUmVzdWx0LmFjdGl2ZSl7XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5U3RhcnRDb21wYXJlKHVzZXIuc2V4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zdGFydENvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7cGxheWVyQ29tcC5yZWFkeVRvQ29tcGFyZUNhcmRzKCk7fSk7XHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0Q29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0NvbXBhcmVDYXJkRGV0YWlscyhkYXRhKTtcclxuICAgICAgICB9LmJpbmQodGhpcyksIDEuMCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zaG93Q29tcGFyZUNhcmREZXRhaWxzOiBmdW5jdGlvbiAoZGF0YSkge1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5yZXNldCgpO1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLnJlYWR5VG9Db21wYXJlQ2FyZHMoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGNhcmRUeXBlQ29tYmluZSA9IHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlQ29tYmluZScpO1xyXG5cclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUucmVzZXQoKTtcclxuXHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGxldCBjb21wYXJlUGxheWVyczEgPSB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZpbHRlcihmdW5jdGlvbiAocGxheWVyKSB7XHJcblxyXG4gICAgICAgICAgICBpZihwbGF5ZXIubm9kZS5hY3RpdmUpe1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB1c2VyID0gcGxheWVyLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlcjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZighdXNlci5pc0NvbnRhaW5FeHRyYSkgcmV0dXJuIHBsYXllci5ub2RlLmFjdGl2ZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IHRlU2h1UGxheWVycyA9IHRoaXMuX3BsYXllckNvbXBvbmVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuXHJcbiAgICAgICAgICAgIGlmKHBsYXllci5ub2RlLmFjdGl2ZSl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXIgPSBwbGF5ZXIuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHVzZXIuaXNDb250YWluRXh0cmEpIHJldHVybiBwbGF5ZXIubm9kZS5hY3RpdmU7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBkdXJhdGlvbiA9IHRoaXMuX3Nob3dDb21wYXJlQ2FyZFN0ZXAoMCwgY29tcGFyZVBsYXllcnMxKTtcclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge3NlbGYuX3Nob3dDb21wYXJlQ2FyZFN0ZXAoMCwgY29tcGFyZVBsYXllcnMxKTt9LCBkdXJhdGlvbik7XHJcblxyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtzZWxmLl9zaG93Q29tcGFyZUNhcmRTdGVwKDAsIGNvbXBhcmVQbGF5ZXJzMSk7fSwgZHVyYXRpb24gKiAyKTtcclxuXHJcbiAgICAgICAgaWYodGVTaHVQbGF5ZXJzLmxlbmd0aCA+IDApe1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7c2VsZi5fc2hvd0NvbXBhcmVDYXJkU3RlcCgwLCB0ZVNodVBsYXllcnMsIHRydWUpO30sIGR1cmF0aW9uICogMyk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbiAqIDMgKyAwLjU7XHJcblxyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0ZVNodVBsYXllcnMubGVuZ3RoOyBpKyspe1xyXG5cclxuICAgICAgICAgICAgdmFyIHVzZXIgPSB0ZVNodVBsYXllcnNbaV0uY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyO1xyXG5cclxuICAgICAgICAgICAgaWYodXNlci5pc0NvbnRhaW5FeHRyYSlkdXJhdGlvbiA9IGR1cmF0aW9uICsgMi41XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHNob290RHVyYXRpb24gPSB0aGlzLmhlYWRDYXJkVGltZTtcclxuXHJcbiAgICAgICAgbGV0IHNob290RGF0YXMgPSB0aGlzLl9zaG9vdERhdGFzKCkgfHwgW107XHJcblxyXG4gICAgICAgIGxldCBzaG90RGF0YSA9IHRoaXMuX3Nob3REYXRhKCkgfHwgW107XHJcblxyXG4gICAgICAgIGxldCBob21lUnVuVXNlcklkID0gdGhpcy5faG9tZVJ1blVzZXJJZCgpO1xyXG5cclxuICAgICAgICB2YXIgc2hvdERhdGFUaW1lcyA9IDA7XHJcblxyXG4gICAgICAgIHNob3REYXRhLmZvckVhY2goZnVuY3Rpb24gKGRhdGEsIGluZGV4KSB7XHJcblxyXG4gICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5wbGF5U2hvb3QoZGF0YS5mcm9tVXNlcklkLCBkYXRhLnRvVXNlcklkKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGR1cmF0aW9uICsgaW5kZXggKiBzaG9vdER1cmF0aW9uKTtcclxuXHJcbiAgICAgICAgICAgIHNob3REYXRhVGltZXMgKz0gc2VsZi5oZWFkQ2FyZFRpbWU7XHJcblxyXG4gICAgICAgICAgICBkdXJhdGlvbiArPSBzZWxmLmhlYWRDYXJkVGltZTtcclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmKGhvbWVSdW5Vc2VySWQubGVuZ3RoID49IDEpe1xyXG5cclxuICAgICAgICAgICAgc2hvb3REYXRhcy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhLCBpbmRleCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wbGF5U2hvb3QoZGF0YS5mcm9tVXNlcklkLCBkYXRhLnRvVXNlcklkKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9LCBkdXJhdGlvbiArIChpbmRleCArIHNob3REYXRhVGltZXMpICogc2hvb3REdXJhdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gKz0gc2VsZi5oZWFkQ2FyZFRpbWU7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uICsgc2hvb3REYXRhcy5sZW5ndGggKiBzaG9vdER1cmF0aW9uICsgc2hvdERhdGEubGVuZ3RoICogc2hvb3REdXJhdGlvbjtcclxuXHJcbiAgICAgICAgaWYgKGhvbWVSdW5Vc2VySWQgPiAwKSB7XHJcblxyXG4gICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7c2VsZi5wbGF5SG9tZVJ1bihob21lUnVuVXNlcklkKTt9LCBkdXJhdGlvbik7XHJcblxyXG4gICAgICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uICsgMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChob21lUnVuVXNlcklkKSB7XHJcbiAgICAgICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy90aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7dGhpcy5famluQmlBY3Rpb24oKTt9LmJpbmQodGhpcyksIGR1cmF0aW9uKTsvL+aYvuekuue7k+eul+mHkeW4gS8v5pi+56S657uT5p6cXHJcbiAgICAgICAgdGhpcy5famluQmlBY3Rpb24oZHVyYXRpb24pO1xyXG4gICAgICAgIC8vdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7cGxheWVyQ29tcC5zaG93U2NvcmVSZXN1bHQoKTt9KTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgIHNlbGYuX3Nob3dDb21wYXJlQ2FyZEZpbmlzaGVkKCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL30uYmluZCh0aGlzKSwgZHVyYXRpb24pO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX2ppbkJpQWN0aW9uOiBmdW5jdGlvbiAoZHVyYXRpb24pIHtcclxuICAgICAgICB2YXIgY29tcGFyZVBsYXllcnMxID0gdGhpcy5fcGxheWVyQ29tcG9uZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYXllcikge3JldHVybiBwbGF5ZXIubm9kZS5hY3RpdmU7fSk7XHJcblxyXG4gICAgICAgIHZhciBuZXh0VGltZSA9IDA7Ly/kuIvkuIDkuKrliqjkvZzlvIDlp4vnmoTml7bpl7RcclxuXHJcbiAgICAgICAgdmFyIHpUaW1lID0gMDsvL+S4i+S4i+S4gOS4quWKqOS9nOW8gOWni+eahOaXtumXtFxyXG5cclxuICAgICAgICB2YXIgc3RhcnQgPSAwO1xyXG5cclxuICAgICAgICB2YXIgZW5kID0gMDtcclxuXHJcbiAgICAgICAgdmFyIGNvaW5zQ29udGFpbmVyQXl5ID0gW107IC8v5omA5pyJ55qE55So5oi355qE6YeR5biBIOS4gOS4queUqOaIt+S4gOS4quaVsOe7hFxyXG5cclxuICAgICAgICB2YXIgY29pbnNBeXkgPSBbXTsgLy/miYDmnInnmoTph5HluIHvvIzkuIDkuKrmlbDnu4RcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5c0NvaW5zLmZvckVhY2goZnVuY3Rpb24obm8pe2lmKG5vKSBuby5yZW1vdmVBbGxDaGlsZHJlbigpO30pO1xyXG5cclxuICAgICAgICBjb21wYXJlUGxheWVyczEuZm9yRWFjaChmdW5jdGlvbihwbGF5cywgaW5kZXgpey8v5qC55o2u56ev5YiG5Yib5bu66YeR5biBXHJcblxyXG4gICAgICAgICAgICB2YXIgY1Njb3JlID0gcGxheXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLl91c2VyLmNTY29yZTtcclxuXHJcbiAgICAgICAgICAgIGlmKGNTY29yZSA8IDApe1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBjU2NvcmUgKj0gLTE7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBuZXcgY2MuTm9kZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIG5vZGUubmFtZSA9IFwiY29pbnNDb250YWluZXJcIjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbnVtU2NvcmUgPSAgY1Njb3JlID4gMzAgPyAzMDpjU2NvcmU7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwIDtpIDwgbnVtU2NvcmUgO2krKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlSmluQmlQcmVmYWIobm9kZSwgbm9kZSk7Ly/moLnmja7np6/liIbliJvlu7rph5HluIFcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXlzQ29pbnNbaW5kZXhdLmFkZENoaWxkKG5vZGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvaW5zQ29udGFpbmVyQXl5LnB1c2gobm9kZS5jaGlsZHJlbik7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIHRoaXMucGxheXNDb2lucy5mb3JFYWNoKGZ1bmN0aW9uKG5vKXtpZihubykgbm8uYWN0aXZlID0gZmFsc2U7fSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkgey8v5pi+56S657uT5p6cXHJcblxyXG4gICAgICAgICAgICB0aGlzLnBsYXlzQ29pbnMuZm9yRWFjaChmdW5jdGlvbihubyl7aWYobm8pIG5vLmFjdGl2ZSA9IHRydWU7fSk7XHJcblxyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UuY29pbkluY29tZSgpO1xyXG5cclxuICAgICAgICAgICAgY29pbnNDb250YWluZXJBeXkuZm9yRWFjaChmdW5jdGlvbihjb2luc0F5eXMpey8v5oqK6YeR5biB56e75Yqo5Yiw5a655ZmoXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGluaXRUaW1lID0gMDtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSAwLjAwMjtcclxuXHJcbiAgICAgICAgICAgICAgICBjb2luc0F5eXMuZm9yRWFjaChmdW5jdGlvbihjb2lucyl7Ly/miorph5HluIHnp7vliqjliLDlrrnlmahcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkpID09IDAgPyAtMSA6IDE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMzgpICogeTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkpID09IDAgPyAtMSA6IDE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMzgpICogeDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmRCYWNrV29ybGRTcGFjZTEgPSB0aGlzLm5vZGUuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLnYyKHgsIHkpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHYyID0gY29pbnMuY29udmVydFRvTm9kZVNwYWNlQVIoY2FyZEJhY2tXb3JsZFNwYWNlMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29pbnMucnVuQWN0aW9uKGNjLm1vdmVCeSgwLjIsIHYyKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGluaXRUaW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaW5pdFRpbWUgPSBpbml0VGltZSArIGludGVydmFsO1xyXG5cclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgbmV4dFRpbWUgPSBpbml0VGltZTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb2luc0F5eSA9IGNvaW5zQXl5LmNvbmNhdChjb2luc0F5eXMpOy8v5oqK6YeR5biB6ZuG5ZCI5Yiw5LiA5Liq5pWw57uEXHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHpjU2NvcmUgPSAwO1xyXG5cclxuICAgICAgICAgICAgY29tcGFyZVBsYXllcnMxLmZvckVhY2goZnVuY3Rpb24ocGxheXMpey8v6K6h566X6YeR5biBXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNTY29yZSA9IHBsYXlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlci5jU2NvcmU7XHJcblxyXG4gICAgICAgICAgICAgICAgY1Njb3JlID0gIGNTY29yZSA+IDMwID8gMzA6Y1Njb3JlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGNTY29yZSA+IDApIHpjU2NvcmUgKz0gY1Njb3JlICogMTtcclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY29pbnNBeXkxID0gY29pbnNBeXkuc3BsaWNlKHpjU2NvcmUsIGNvaW5zQXl5Lmxlbmd0aCk7XHJcblxyXG4gICAgICAgICAgICBjb2luc0F5eTEuZm9yRWFjaChmdW5jdGlvbihub2RlKXtub2RlLnBhcmVudC5yZW1vdmVDaGlsZChub2RlKTt9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbXBhcmVQbGF5ZXJzMS5mb3JFYWNoKGZ1bmN0aW9uKHBsYXlzKXsvL+aKiumHkeW4geWIsOeUqOaIt+WktOWDj+mZhOi/kVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjU2NvcmUgPSBwbGF5cy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuX3VzZXIuY1Njb3JlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGNTY29yZSA+IDApe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSAwLjAwMjU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbml0VGltZSA9IG5leHRUaW1lICsgMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG51bVNjb3JlID0gIGNTY29yZSA+IDMwID8gMzA6Y1Njb3JlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL2VuZCArPSBudW1TY29yZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29pbnNBeXkuc3BsaWNlKDAsIG51bVNjb3JlKS5mb3JFYWNoKGZ1bmN0aW9uKGNvaW5zTm9kZSl7Ly/miorph5HluIHliLDnlKjmiLflpLTlg4/pmYTov5FcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v6I635Y+W6IqC54K555qE5LiW55WM5Z2Q5qCHXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZEJhY2tXb3JsZFNwYWNlMSA9IHBsYXlzLm5vZGUuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLnYyKDAsIDApKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v6I635Y+W55u45a+554i26IqC54K55omA5Zyo55qE5Z2Q5qCHXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGV0YWlsID0gY29pbnNOb2RlLmNvbnZlcnRUb05vZGVTcGFjZUFSKGNhcmRCYWNrV29ybGRTcGFjZTEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb3ZlQnkgPSBjYy5tb3ZlQnkoMC4yNSwgZGV0YWlsKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dEZhZGVJbiA9IGNjLmZhZGVPdXQoMC4xMyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vdmVTZXEgPWNjLnNlcXVlbmNlKG1vdmVCeSxuZXh0RmFkZUluKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2luc05vZGUucnVuQWN0aW9uKG1vdmVTZXEpIDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGluaXRUaW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRUaW1lID0gaW5pdFRpbWUgKyBpbnRlcnZhbDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9zdGFydCArPSBjU2NvcmU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHpUaW1lID0gaW5pdFRpbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkgey8v5pi+56S657uT5p6cXHJcblxyXG4gICAgICAgICAgICAgICAgLy90aGlzLnBsYXlzQ29pbnMuZm9yRWFjaChmdW5jdGlvbihubyl7aWYobm8pIG5vLmFjdGl2ZSA9IGZhbHNlO30pO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuX3Nob3dDb21wYXJlQ2FyZEZpbmlzaGVkKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29tcGFyZVBsYXllcnMxLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtwbGF5ZXJDb21wLnNob3dTY29yZVJlc3VsdCgpO30pO1xyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCB6VGltZSk7XHJcblxyXG5cclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7Ly/mmL7npLrnu5PmnpxcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXlzQ29pbnMuZm9yRWFjaChmdW5jdGlvbihubyl7aWYobm8pIG5vLnJlbW92ZUFsbENoaWxkcmVuKCk7fSk7XHJcblxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIHpUaW1lICsgNSk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSwgZHVyYXRpb24pO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX2NyZWF0ZUppbkJpUHJlZmFiOiBmdW5jdGlvbiAobm9kZSx2Mk5vZGUpIHtcclxuXHJcbiAgICAgICAgdmFyIG5vZGVzID0gY2MuaW5zdGFudGlhdGUodGhpcy5jb2luc1ByZWZhYik7XHJcblxyXG4gICAgICAgIHZhciB5ID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSA9PSAwID8gLTEgOiAxO1xyXG5cclxuICAgICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjM4KSAqIHkgKyB2Mk5vZGUueTtcclxuXHJcbiAgICAgICAgdmFyIHggPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkpID09IDAgPyAtMSA6IDE7XHJcblxyXG4gICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMzgpICogeCArIHYyTm9kZS54O1xyXG5cclxuICAgICAgICBub2Rlcy54ID0geDtcclxuXHJcbiAgICAgICAgbm9kZXMueSA9IHk7XHJcblxyXG4gICAgICAgIG5vZGUuYWRkQ2hpbGQobm9kZXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc2hvd0NvbXBhcmVDYXJkU3RlcDogZnVuY3Rpb24gKHN0YXJ0VGltZSA9IDAsIGNvbXBhcmVQbGF5ZXJzID0gW10sIGlzQ29udGFpbkV4dHJhID0gZmFsc2UpIHtcclxuICAgICAgICB2YXIgZHVyYXRpb24gPSBzdGFydFRpbWU7XHJcbiAgICAgICAgbGV0IGludGVydmFsID0gdGhpcy5oZWFkQ2FyZFRpbWU7XHJcbiAgICAgICAgbGV0IHRlc2h1VGltZSA9IDA7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICBjb21wYXJlUGxheWVycyA9IGNvbXBhcmVQbGF5ZXJzLnNvcnQoZnVuY3Rpb24gKHBsYXllcjEsIHBsYXllcjIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHBsYXllcjEubmV4dENvbXBhcmVTY29yZSgpIC0gcGxheWVyMi5uZXh0Q29tcGFyZVNjb3JlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBjbz1jb21wYXJlUGxheWVycztcclxuICAgICAgICAvL2NvbnNvbGUubG9nKGNvKVxyXG4gICAgICAgIC8vY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS3miafooYzkuoblh6DmrKEnKVxyXG5cclxuICAgICAgICBjby5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuXHJcbiAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHBsYXllci5zaG93TmV4dENvbXBhcmVDYXJkcygpO1xyXG4gICAgICAgICAgICB9LCBkdXJhdGlvbiArIHRlc2h1VGltZSk7XHJcblxyXG4gICAgICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uICsgaW50ZXJ2YWw7XHJcbiAgICAgICAgICAgIHZhciB1c2VyID0gcGxheWVyLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5fdXNlcjtcclxuICAgICAgICAgICAgaWYodXNlci5pc0NvbnRhaW5FeHRyYSl7XHJcbiAgICAgICAgICAgICAgICBpZih1c2VyLmNhcmRJbmZvWzBdLnR5cGUgPT0gMTApe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7dGhpcy5ub2RlLmdldENvbXBvbmVudChcImFuaW1hdGlvblwiKS5fc2FudG9uZ2h1YUFuaW1hdGlvbigpO30sZHVyYXRpb24gLSAxICsgdGVzaHVUaW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGVzaHVUaW1lICs9IDIuNTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKHVzZXIuY2FyZEluZm9bMF0udHlwZSA9PSAxMSl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHt0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiYW5pbWF0aW9uXCIpLl9zYW5zaHVuemlBbmltYXRpb24oKTsgfSwgZHVyYXRpb24gLSAxICsgdGVzaHVUaW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGVzaHVUaW1lICs9IDIuNTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKHVzZXIuY2FyZEluZm9bMF0udHlwZSA9PSAxMil7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHt0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiYW5pbWF0aW9uXCIpLl9saXVkdWliYW5BbmltYXRpb24oKTt9LCBkdXJhdGlvbiAtIDEgKyB0ZXNodVRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0ZXNodVRpbWUgKz0gMi41O1xyXG5cclxuICAgICAgICAgICAgICAgIH1lbHNlIGlmKHVzZXIuY2FyZEluZm9bMF0udHlwZSA9PSAxOCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHt0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwiYW5pbWF0aW9uXCIpLl9xaW5nbG9uZ0FuaWFtdGlvbignbG9uZycpO30sIGR1cmF0aW9uIC0gMSArIHRlc2h1VGltZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRlc2h1VGltZSArPSAyLjU7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZih1c2VyLmNhcmRJbmZvWzBdLnR5cGUgPT0gMTkpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7dGhpcy5ub2RlLmdldENvbXBvbmVudChcImFuaW1hdGlvblwiKS5fcWluZ2xvbmdBbmlhbXRpb24oXCJxbFwiKTt9LCBkdXJhdGlvbiAtIDEgKyB0ZXNodVRpbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0ZXNodVRpbWUgKz0gMi41O1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZihpc0NvbnRhaW5FeHRyYSl7XHJcblxyXG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgY28ubGVuZ3RoOyBpKyspIGR1cmF0aW9uID0gZHVyYXRpb24gKyAyLjVcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICBpZihwbGF5ZXIubm9kZS5hY3RpdmUpe1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLnNob3dOZXh0Q29tcGFyZVNjb3JlKGlzQ29udGFpbkV4dHJhKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBkdXJhdGlvbiAtIGludGVydmFsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjby5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuc2hvd05leHRDb21wYXJlU2NvcmUoKTtcclxuICAgICAgICAgICAgICAgIH0sIGR1cmF0aW9uIC0gaW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBkdXJhdGlvbiArIHRlc2h1VGltZTtcclxuICAgIH0sXHJcblxyXG4gICAgX2lzR2FtZU92ZXI6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOavlOeJjOWujOaIkOWQjuS8muiwg+eUqOeahOaWueazlVxyXG4gICAgX3Nob3dDb21wYXJlQ2FyZEZpbmlzaGVkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy50aW1lU3RhcnQoNSxcInJlYWR5XCIpO1xyXG4gICAgICAgIHRoaXMuX3Nob3dPbmVHYW1lUmVzdWx0KCk7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMuX3BsYXllZENvbXBhcmVDYXJkc0luZGV4cy5wdXNoKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCk7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgfSxcclxuXHJcbiAgICAvL25ldHdvcmtcclxuICAgIHNob3dOZXR3b3JrTWVzc2FnZTpmdW5jdGlvbihtc2cgPSBcIue9kee7nOmTvuaOpeaWreW8gO+8jOmHjeaWsOi/nuaOpeS4rS4uLlwiKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgJiYgdGhpcy5uZXR3b3JrTm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZS5ydW5BY3Rpb24ocmVtb3ZlU2VsZkFjdGlvbik7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5ldHdvcmtOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5uZXR3b3JrTm9kZSk7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLm5ldHdvcmtOb2RlID0gbnVsbDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgIGNvbXAuYWxlcnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgaGlkZGVuTmV0d29ya01lc3NhZ2U6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBzaG93QWxlcnRNZXNzYWdlOiBmdW5jdGlvbihtc2csIGF1dG9EaXNtaXNzKSB7XHJcbiAgICAgICAgbGV0IGFsZXJ0Q29tcCA9IHRoaXMuYWxlcnQuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIGlmICghdGhpcy5hbGVydC5hY3RpdmUpIHtcclxuICAgICAgICAgICAgYWxlcnRDb21wLmFsZXJ0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhbGVydENvbXAuc2V0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgIGFsZXJ0Q29tcC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgaWYgKGF1dG9EaXNtaXNzKSB7XHJcbiAgICAgICAgICAgIGFsZXJ0Q29tcC5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgYWxlcnRDb21wLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICAgICAgfSwgNSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvL2NoZWNrTm9kZVxyXG4gICAgc2hvd0NoZWNrTWVzc2FnZTpmdW5jdGlvbihtc2cgPSAn5qOA5p+l572R57uc5LitLi4uJykge1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVTZWxmQWN0aW9uID0gY2MucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZS5ydW5BY3Rpb24ocmVtb3ZlU2VsZkFjdGlvbik7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGVja05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLmNoZWNrTm9kZSk7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLmNoZWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGNvbXAub25EaXNtaXNzQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc2VsZi5jaGVja05vZGUgPSBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICAgICAgY29tcC5hbGVydCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBoaWRkZW5DaGVja01lc3NhZ2U6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tOb2RlICE9IG51bGwgJiYgdGhpcy5jaGVja05vZGUuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLy8vLyAg6IGK5aSp6K+t6Z+z6YC76L6RXHJcbiAgICAvLyBfcmVnaXN0ZXJWb2ljZU5vZGVFdmVudHM6IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAvLyAgICAgbGV0IGNoYXRWb2ljZU5vZGUgPSB0aGlzLmJ0bkNoYXRWb2ljZS5ub2RlO1xyXG4gICAgLy8gICAgIHRoaXMuZW5kUmVjb3JkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAvLyAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCxmdW5jdGlvbihldmVudCkge1xyXG4gICAgLy8gICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHNlbGYuZW5kUmVjb3JkVGltZSA+PSAxMDAwKSB7XHJcbiAgICAvLyAgICAgICAgICAgICBzZWxmLm5hdGl2ZVJlY29yZEFjdGlvbigpO1xyXG4gICAgLy8gICAgICAgICAgICAgLy9zZWxmLnZvaWNlUmVjb3JkQW5pbWF0aW9uTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgIC8vICAgICAgICAgICAgIGxldCBhY3Rpb24gPSBjYy5zY2FsZVRvKDAuMTIsIDEuMik7XHJcbiAgICAvLyAgICAgICAgICAgICBzZWxmLmJ0bkNoYXRWb2ljZS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG5cclxuICAgIC8vICAgICAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gdHJ1ZTtcclxuICAgIC8vICAgICAgICAgfVxyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIGNoYXRWb2ljZU5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAvLyAgICAgICAgIGlmIChzZWxmLl9pc1JlY29yZGluZykge1xyXG4gICAgLy8gICAgICAgICAgICAgc2VsZi5lbmRSZWNvcmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIC8vICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICBzZWxmLl9pc1JlY29yZGluZyA9IGZhbHNlO1xyXG5cclxuICAgIC8vICAgICAgICAgc2VsZi5uYXRpdmVFbmRSZWNvcmRBY3Rpb24oKTtcclxuICAgIC8vICAgICAgICAgLy9zZWxmLnZvaWNlUmVjb3JkQW5pbWF0aW9uTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAvLyAgICAgICAgIGxldCBhY3Rpb24gPSBjYy5zY2FsZVRvKDAuMTIsIDEpO1xyXG4gICAgLy8gICAgICAgICBzZWxmLmJ0bkNoYXRWb2ljZS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIGNoYXRWb2ljZU5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAvLyAgICAgICAgIGlmIChzZWxmLl9pc1JlY29yZGluZykge1xyXG4gICAgLy8gICAgICAgICAgICAgc2VsZi5lbmRSZWNvcmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIC8vICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICBzZWxmLl9pc1JlY29yZGluZyA9IGZhbHNlO1xyXG5cclxuICAgIC8vICAgICAgICAgc2VsZi5uYXRpdmVFbmRSZWNvcmRBY3Rpb24oKTtcclxuICAgIC8vICAgICAgICAgLy9zZWxmLnZvaWNlUmVjb3JkQW5pbWF0aW9uTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAvLyAgICAgICAgIGxldCBhY3Rpb24gPSBjYy5zY2FsZVRvKDAuMTIsIDEpO1xyXG4gICAgLy8gICAgICAgICBzZWxmLmJ0bkNoYXRWb2ljZS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIFNvY2tldC5pbnN0YW5jZS51cGxvYWRGaW5pc2ggPSBmdW5jdGlvbih1cmwpIHtcclxuICAgIC8vICAgICAgICAgbGV0IHVzZXJJZCA9IHNlbGYuX3VzZXJJZDtcclxuICAgIC8vICAgICAgICAgU29ja2V0LnNlbmRBdWRpb01lc3NhZ2UodXNlcklkLCB1cmwpO1xyXG4gICAgLy8gICAgICAgICBzZWxmLnBsYXlTcGVha0FuaW1hdGlvbihzZWxmLl91c2VySWQpO1xyXG4gICAgLy8gICAgIH07XHJcbiAgICAvLyB9LFxyXG5cclxuICAgIF9yZWdpc3RlclZvaWNlTm9kZUV2ZW50czogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICBsZXQgY2hhdFZvaWNlTm9kZSA9IHRoaXMuYnRuQ2hhdFZvaWNlLm5vZGU7XHJcbiAgICAgICAgdGhpcy5lbmRSZWNvcmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICBjaGF0Vm9pY2VOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIC8vIHNlbGYuVm9pY2VNc2dCZ0FuaW1hdGlvbigpO1xyXG4gICAgICAgICAgICBpZighY2Muc3lzLmlzTmF0aXZlKXtcclxuICAgICAgICAgICAgICAgIHZhciBydW5UaW1lID0gMC4zXHJcbiAgICAgICAgICAgICAgICB2YXIgdGlzaGkgPSBjYy5pbnN0YW50aWF0ZShzZWxmLmF1dG9UaXNoaSk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuYWRkQ2hpbGQodGlzaGkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGNjLnNwYXduKCBjYy5tb3ZlVG8oMC4zLCBjYy52MigwLCAwKSksY2MuZmFkZUluKDAuMykpO1xyXG4gICAgICAgICAgICAgICAgdGlzaGkucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmlzaGVkID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIHRpc2hpLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGNjLnNlcXVlbmNlKCBjYy5zcGF3bihjYy5mYWRlT3V0KHJ1blRpbWUpLGNjLm1vdmVUbyhydW5UaW1lLGNjLnYyKDAsIDUwKSkpLGZpbmlzaGVkKTtcclxuICAgICAgICAgICAgICAgICAgICB0aXNoaS5ydW5BY3Rpb24oIGFjdGlvbiApO1xyXG4gICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcyksIDEuNSk7XHJcbiAgICAgICAgICAgICAgICAvL3ZhciB1cmwgPSBcInd3dy5iYWlkdS5jb21cIjtcclxuICAgICAgICAgICAgICAgIC8vbGV0IHVzZXJJZCA9IHNlbGYuX3VzZXJJZDtcclxuICAgICAgICAgICAgICAgIC8vU29ja2V0LnNlbmRBdWRpb01lc3NhZ2UodXNlcklkLCB1cmwpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gc2VsZi5lbmRSZWNvcmRUaW1lID49IDEwMDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLlZvaWNlTXNnQmdBbmltYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLm5hdGl2ZVJlY29yZEFjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBhY3Rpb24gPSBjYy5zY2FsZVRvKDAuMTIsIDEuMik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5idG5DaGF0Vm9pY2Uubm9kZS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9pc1JlY29yZGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjaGF0Vm9pY2VOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCxmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBzZWxmLlZvaWNlTXNnQmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLl9pc1JlY29yZGluZykge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5lbmRSZWNvcmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWxmLl9pc1JlY29yZGluZyA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgc2VsZi5uYXRpdmVFbmRSZWNvcmRBY3Rpb24oKTtcclxuICAgICAgICAgICAgLy9zZWxmLnZvaWNlUmVjb3JkQW5pbWF0aW9uTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGxldCBhY3Rpb24gPSBjYy5zY2FsZVRvKDAuMTIsIDEpO1xyXG4gICAgICAgICAgICBzZWxmLmJ0bkNoYXRWb2ljZS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNoYXRWb2ljZU5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHNlbGYuVm9pY2VNc2dCZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHNlbGYuX2lzUmVjb3JkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBzZWxmLm5hdGl2ZUVuZFJlY29yZEFjdGlvbigpO1xyXG4gICAgICAgICAgICAvL3NlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMSk7XHJcbiAgICAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgU29ja2V0Lmluc3RhbmNlLnVwbG9hZEZpbmlzaCA9IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgICAgICBsZXQgdXNlcklkID0gc2VsZi5fdXNlcklkO1xyXG4gICAgICAgICAgICBTb2NrZXQuc2VuZEF1ZGlvTWVzc2FnZSh1c2VySWQsIHVybCk7XHJcbiAgICAgICAgICAgIHNlbGYucGxheVNwZWFrQW5pbWF0aW9uKHNlbGYuX3VzZXJJZCk7XHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcbiAgICBWb2ljZU1zZ0JnQW5pbWF0aW9uOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdGhpcy5Wb2ljZU1zZ0JnLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdmFyIHdoaWxlTGF5b3V0ID0gdGhpcy5Wb2ljZU1zZ0JnLmdldENoaWxkQnlOYW1lKFwid2hpbGVMYXlvdXRcIik7XHJcbiAgICAgICAgdmFyIGNoaWxkV2hpbGUgPSB3aGlsZUxheW91dC5nZXRDaGlsZEJ5TmFtZShcImNoaWxkV2hpbGVcIik7XHJcbiAgICAgICAgaWYoIHRoaXMud2hpbGVMYXlvdXRJbnRlcnZhbCApe1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMud2hpbGVMYXlvdXRJbnRlcnZhbCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLndoaWxlTGF5b3V0SW50ZXJ2YWwgPSAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdmFyIG5vZGUgPSBjYy5pbnN0YW50aWF0ZShjaGlsZFdoaWxlKTtcclxuICAgICAgICAgICAgaWYod2hpbGVMYXlvdXQuY2hpbGRyZW4ubGVuZ3RoPjUpe1xyXG4gICAgICAgICAgICAgICAgd2hpbGVMYXlvdXQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB3aGlsZUxheW91dC5hZGRDaGlsZChub2RlKTtcclxuICAgICAgICB9LDIwMClcclxuXHJcbiAgICAgICAgdmFyIGxheW91dCA9IHRoaXMuVm9pY2VNc2dCZy5nZXRDaGlsZEJ5TmFtZShcImxheW91dFwiKTtcclxuICAgICAgICB2YXIgY1doaWxlID0gbGF5b3V0LmdldENoaWxkQnlOYW1lKFwid2hpbGVcIik7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmxheW91dEludGVydmFsICl7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5sYXlvdXRJbnRlcnZhbCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmxheW91dEludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdmFyIG5vZGUgPSBjYy5pbnN0YW50aWF0ZShjV2hpbGUpO1xyXG4gICAgICAgICAgICBpZihsYXlvdXQuY2hpbGRyZW4ubGVuZ3RoPjMpe1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0LnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGF5b3V0LmFkZENoaWxkKG5vZGUpO1xyXG4gICAgICAgIH0sMzAwKVxyXG4gICAgfSxcclxuICAgIG5hdGl2ZVJlY29yZEFjdGlvbjpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInJlY29yZFwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkIGNvbS5sbGluZy5xaWFuamlhbmdsemdcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInJlY29yZFwiLCBcIigpVlwiKTtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhdXNlTXVzaWMoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIG5hdGl2ZUVuZFJlY29yZEFjdGlvbjpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcImVuZFJlY29yZFwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJlbmRSZWNvcmRcIiwgXCIoKVZcIik7XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5yZXN1bWVNdXNpYygpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgcGxheUF1ZGlvVXJsOmZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0yNTUzXCIpO1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwicGxheVVybDpcIix1cmwpO1xyXG4gICAgICAgIH0gZWxzZSBpZihLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZFxyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwicGxheVVybFwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCB1cmwpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8gTUFSSzogIOmAgOWHuua4uOaIj+mAu+i+kVxyXG4gICAgX2hhbmRsZVVwZGF0ZURlc2tJbmZvQWJvdXRFeGl0Um9vbTogZnVuY3Rpb24oZGVza0luZm8pIHtcclxuICAgICAgICBpZiAoIWRlc2tJbmZvLmlzRGlzc29sdmluZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBkYXRhSW5mb3MgPSBkZXNrSW5mby5kaXNzb2x2ZUFuc3dlckluZm87XHJcblxyXG4gICAgICAgIGxldCBhbGVydENvbXAgPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuXHJcbiAgICAgICAgYWxlcnRDb21wLmFsZXJ0KCk7XHJcblxyXG4gICAgICAgIGFsZXJ0Q29tcC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuY29udGVudEFuc293ZXJFeGl0Tm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uKGkpe2kuYWN0aXZlID0gZmFsc2U7fSk7XHJcblxyXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zLmZvckVhY2goZnVuY3Rpb24ocGxheWVySW5mbyxpbmRleCl7XHJcblxyXG4gICAgICAgICAgICB2YXIgcGxheSA9IHRoaXMuY29udGVudEFuc293ZXJFeGl0Tm9kZS5jaGlsZHJlbltpbmRleF07XHJcblxyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IHBsYXkuZ2V0Q2hpbGRCeU5hbWUoXCJuaWNrbmFtZVwiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBiYWNrID0gcGxheS5nZXRDaGlsZEJ5TmFtZShcImZhbnpodVwiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBpbWcgPSBwbGF5LmdldENoaWxkQnlOYW1lKFwiYXZhdGFyX2JnXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHN0ciA9IHBsYXkuZ2V0Q2hpbGRCeU5hbWUoXCJpZFwiKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBkYXRhSW5mbyA9IGRhdGFJbmZvc1tpbmRleF07XHJcblxyXG4gICAgICAgICAgICBwbGF5LmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICBuYW1lLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gcGxheWVySW5mby5uaWNrbmFtZTtcclxuXHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHBsYXllckluZm8uaWQpey8v5pi+56S65oi/5Li7XHJcblxyXG4gICAgICAgICAgICAgICAgYmFjay5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7XHJcblxyXG4gICAgICAgICAgICAgICAgYmFjay5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2MubG9hZGVyLmxvYWQoe3VybDpwbGF5ZXJJbmZvLmF2YXRhclVybCx0eXBlOlwianBnXCJ9LCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGVycikgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZShkYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpbWcuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBmcmFtZTtcclxuXHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICBpZihkYXRhSW5mbyA9PSAxKXtcclxuXHJcbiAgICAgICAgICAgICAgICBzdHIuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIuWQjOaEj1wiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7XHJcblxyXG4gICAgICAgICAgICAgICAgc3RyLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICBsZXQgZGlzc29sdmVMZWZ0VGltZSA9IGRlc2tJbmZvLmRpc3NvbHZlTGVmdFRpbWUgfHwgNjA7XHJcblxyXG4gICAgICAgIGxldCBjb3VudGRvd24gPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJyk7XHJcblxyXG4gICAgICAgIGNvdW50ZG93bi5zdGFydENvdW50ZG93bihkaXNzb2x2ZUxlZnRUaW1lLCBmdW5jdGlvbihpc1RpbWVvdXQpIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChpc1RpbWVvdXQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tBZ3JlZU90aGVyUGxheWVyRXhpdCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIGxldCBkaXNzb2x2ZVVzZXJJZCA9IGRlc2tJbmZvLmRpc3NvbHZlVXNlcklkO1xyXG5cclxuICAgICAgICBpZiAoZGlzc29sdmVVc2VySWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgYWxlcnRfYmcgPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENoaWxkQnlOYW1lKFwiYWxlcnRfYmdcIik7XHJcblxyXG4gICAgICAgICAgICB2YXIgYnRuQWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkFncmVlXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGJ0bkRpc2FncmVlID0gYWxlcnRfYmcuZ2V0Q2hpbGRCeU5hbWUoXCJidG5EaXNhZ3JlZVwiKTtcclxuXHJcbiAgICAgICAgICAgIGJ0bkFncmVlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgYnRuRGlzYWdyZWUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL3RoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENhbmNlbEJ1dHRvbi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL3RoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENvbmZpcm1CdXR0b24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy9sZXQgYWxlcnQgPSB0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICAgICAgLy9hbGVydC5zZXRNZXNzYWdlKFwi5oKo5q2j5Zyo55Sz6K+35Y2P5ZWG6YCA5Ye677yM562J5b6F5YW25LuW546p5a625ZCM5oSPXCIpO1xyXG4gICAgICAgICAgICAvL3RoaXMuYWxlcnRSZXF1ZXN0RXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdGFydENvdW50ZG93bihkaXNzb2x2ZUxlZnRUaW1lKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIC8vbGV0IGRpc3NvbHZlQW5zd2VySW5mb3MgPSBkZXNrSW5mby5kaXNzb2x2ZUFuc3dlckluZm87XHJcbiAgICAgICAgLy9sZXQgY3VycmVudFVzZXJJZEluZGV4ID0gZGVza0luZm8ucGxheWVyc0luZGV4LmZpbmRJbmRleChmdW5jdGlvbih1c2VySWQpIHtcclxuICAgICAgICAvLyAgICByZXR1cm4gdGhpcy5fdXNlcklkID09IHVzZXJJZDtcclxuICAgICAgICAvL30uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL2xldCBhbnN3ZXJSZXN1bHQgPSBkaXNzb2x2ZUFuc3dlckluZm9zW2N1cnJlbnRVc2VySWRJbmRleF07XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL2lmIChhbnN3ZXJSZXN1bHQgPT0gLTEpIHtcclxuICAgICAgICAvLyAgICAvLyAtMSDooajnpLrmnKrlpITnkIYgIDAg6KGo56S65ouS57udICAx6KGo56S65ZCM5oSPXHJcbiAgICAgICAgLy8gICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgbGV0IGNvdW50ZG93biA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgIGNvdW50ZG93bi5zdGFydENvdW50ZG93bihkaXNzb2x2ZUxlZnRUaW1lLCBmdW5jdGlvbihpc1RpbWVvdXQpIHtcclxuICAgICAgICAvLyAgICAgICAgaWYgKGlzVGltZW91dCkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy5jbGlja0FncmVlT3RoZXJQbGF5ZXJFeGl0KCk7XHJcbiAgICAgICAgLy8gICAgICAgIH1cclxuICAgICAgICAvLyAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy99XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICAvLyDnoa7lrpropoHlvLrliLbpgIDlh7rmuLjmiI9cclxuICAgIGNsaWNrQ29uZmlybUZvcmNlRXhpdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgU29ja2V0LnNlbmRGb3JjZUV4aXRSb29tKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOehruiupOivt+axgumAgOWHuua4uOaIj1xyXG4gICAgY2xpY2tDb25maXJtUmVxdWVzdEV4aXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDYW5jZWxCdXR0b24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDb25maXJtQnV0dG9uLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgaWYodGhpcy5fZGVza0luZm8uY0luZGV4PjApe1xyXG4gICAgICAgICAgICBhbGVydC5zZXRNZXNzYWdlKFwi5oKo5q2j5Zyo55Sz6K+35Y2P5ZWG6YCA5Ye677yM562J5b6F5YW25LuW546p5a625ZCM5oSPXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RhcnRDb3VudGRvd24oNjApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBTb2NrZXQuc2VuZExlYXZlRGVzayh0aGlzLl91c2VySWQpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDlkIzmhI/ku5bkurrpgIDlh7pcclxuICAgIGNsaWNrQWdyZWVPdGhlclBsYXllckV4aXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL3RoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICAvL3RoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICAvL3RoaXMuYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdG9wKCk7XHJcbiAgICAgICAgdmFyIGFsZXJ0X2JnID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDaGlsZEJ5TmFtZShcImFsZXJ0X2JnXCIpO1xyXG4gICAgICAgIHZhciBidG5BZ3JlZSA9IGFsZXJ0X2JnLmdldENoaWxkQnlOYW1lKFwiYnRuQWdyZWVcIik7XHJcbiAgICAgICAgdmFyIGJ0bkRpc2FncmVlID0gYWxlcnRfYmcuZ2V0Q2hpbGRCeU5hbWUoXCJidG5EaXNhZ3JlZVwiKTtcclxuICAgICAgICBidG5BZ3JlZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBidG5EaXNhZ3JlZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBTb2NrZXQuc2VuZEFuc3dlckRpc3NvbHZlKHRoaXMuX3VzZXJJZCwgMSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOS4jeWQjOaEj+S7luS6uumAgOWHulxyXG4gICAgY2xpY2tEaXNhZ3JlZU90aGVyUGxheWVyRXhpdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIC8vdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIC8vdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0b3AoKTtcclxuICAgICAgICB2YXIgYWxlcnRfYmcgPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENoaWxkQnlOYW1lKFwiYWxlcnRfYmdcIik7XHJcbiAgICAgICAgdmFyIGJ0bkFncmVlID0gYWxlcnRfYmcuZ2V0Q2hpbGRCeU5hbWUoXCJidG5BZ3JlZVwiKTtcclxuICAgICAgICB2YXIgYnRuRGlzYWdyZWUgPSBhbGVydF9iZy5nZXRDaGlsZEJ5TmFtZShcImJ0bkRpc2FncmVlXCIpO1xyXG4gICAgICAgIGJ0bkFncmVlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGJ0bkRpc2FncmVlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIFNvY2tldC5zZW5kQW5zd2VyRGlzc29sdmUodGhpcy5fdXNlcklkLCAwKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g6ZqQ6JeP6K+35rGC6YCA5Ye6IE5vZGVcclxuICAgIF9oaWRlUmVxZXN0RXhpdE5vZGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0b3AoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8vLyDmiZPmnqpcclxuICAgIHBsYXlTaG9vdDogZnVuY3Rpb24gKGZyb21Vc2VySWQsIHRvVXNlcklkKSB7XHJcbiAgICAgICAgbGV0IHVzZXIgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKGZyb21Vc2VySWQpO1xyXG4gICAgICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5SHVtYW5EYVFpYW5nKHVzZXIuc2V4KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCB0b1VzZXJJbmRleCA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmRleEJ5VXNlcklkKHRvVXNlcklkKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgaWYodGhpcy5fdXNlcklkID09IGZyb21Vc2VySWQgfHwgdGhpcy5fdXNlcklkID09IHRvVXNlcklkKSBwbGF5ZXIuc2hvd05leHRDb21wYXJlU2NvcmUoKTtcclxuICAgICAgICAgICAgcGxheWVyLnBsYXlTaG9vdEFuaW1hdGlvbihmcm9tVXNlcklkLCB0b1VzZXJJbmRleCk7XHJcbiAgICAgICAgICAgIHBsYXllci5wbGF5QnVsbGV0SG9sZUFuaW1hdGlvbih0b1VzZXJJZCk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5pKt5pS+5YWo5Z6S5omT5Yqo5pWIXHJcbiAgICBwbGF5SG9tZVJ1bjogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIGxldCB1c2VyID0gdGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZCh1c2VySWQpO1xyXG4gICAgICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5SG9tZVJ1bih1c2VyLnNleCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJhbmltYXRpb25cIikuX3F1YW5sZWlkYUFuaW1hdGlvbignbG9uZycpO1xyXG5cclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG5cclxuICAgICAgICAgICAgcGxheWVyLnNob3dOZXh0Q29tcGFyZVNjb3JlKCk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBwbGF5U3BlYWtBbmltYXRpb246IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICBwbGF5ZXIucGxheVNwZWFrQW5pbWF0aW9uKHVzZXJJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zaG9vdERhdGFzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IGhvbWVSdW5Vc2VySWQgPSB0aGlzLl9ob21lUnVuVXNlcklkKCk7IC8vIOWFqOWekuaJk1xyXG4gICAgICAgIGxldCBzaG9vdERhdGFzID0gdGhpcy5fZGVza0luZm8uc2hvdERhdGEuZmlsdGVyKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmZyb21Vc2VySWQgPT0gaG9tZVJ1blVzZXJJZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2hvb3REYXRhcztcclxuICAgIH0sXHJcblxyXG4gICAgX3Nob3REYXRhOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IGhvbWVSdW5Vc2VySWQgPSB0aGlzLl9ob21lUnVuVXNlcklkKCk7IC8vIOaJk+aeqlxyXG4gICAgICAgIGxldCBzaG90RGF0YSA9IHRoaXMuX2Rlc2tJbmZvLnNob3REYXRhLmZpbHRlcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YS5mcm9tVXNlcklkICE9IGhvbWVSdW5Vc2VySWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHNob3REYXRhO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaG9tZVJ1blVzZXJJZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kZXNrSW5mby5hbGxTaG90RGF0YTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gTUFSSzog5oi/6Ze05L+h5oGv6YOo5YiGXHJcblxyXG4gICAgLy8g6I635Y+W5oi/6Ze055qE546p5rOVXHJcbiAgICBfZGVza0luZm9HYW1lV2F5OiBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgc2V0dGluZyA9IHRoaXMuX2Rlc2tJbmZvLnNldHRpbmczO1xyXG4gICAgICAgIGlmKHNldHRpbmcgPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbmFtZXMgPSBbXCLluoTlrrbmqKHlvI9cIiwgXCLml6DnibnmrorniYxcIixcIuaZrumAmuaooeW8j1wiXTtcclxuICAgICAgICByZXR1cm4gbmFtZXNbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIF9kZXNrSW5mb051bWJlck9mR2FtZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHNldHRpbmcgPSB0aGlzLl9kZXNrSW5mby5zZXR0aW5nMTtcclxuICAgICAgICBsZXQgaW5mb3MgPSBbJzEw5bGAJywgJzIw5bGAJywgJzQw5bGAJywgJzXlsYAnXTtcclxuICAgICAgICAvKmlmIChzZXR0aW5nIDw9IDEpIHtcclxuICAgICAgICAgcmV0dXJuICfmnaHmlbDvvJonICsgaW5mb3Nbc2V0dGluZ107XHJcbiAgICAgICAgIH0qL1xyXG4gICAgICAgIGlmKHNldHRpbmcgPT0gMil7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHNldHRpbmcgPT0gMyl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHNldHRpbmcgPT0gNCl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHNldHRpbmcgPT0gNSl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAzO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gJ+WxgOaVsO+8micgKyBpbmZvc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rlc2tJbmZvTnVtYmVyT2ZQZW9wbGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzI7XHJcbiAgICAgICAgbGV0IGluZm9zID0gWycy5Lq6JywgJzPkuronLCAnNOS6uicsICc15Lq6J107XHJcbiAgICAgICAgcmV0dXJuIGluZm9zW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGVza0luZm9QYXlJbmZvOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgc2V0dGluZyA9IHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc0O1xyXG4gICAgICAgIGlmKHNldHRpbmcgPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihzZXR0aW5nID09IDApe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGluZm9zID0gWyfmiL/kuLvpnLjkuLvluoQnLCAn5oi/6LS5QUEnXTtcclxuICAgICAgICByZXR1cm4gaW5mb3Nbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIF9kZXNrSW5mb0ppYVlpU2VJbmZvOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgc2V0dGluZyA9IHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc3ID09IDAgPyAxIDogMDtcclxuICAgICAgICBsZXQgaW5mb3MgPSBbJ+aXoOWkmuS4gOiJsicsICflpJrkuIDoibInXTtcclxuICAgICAgICByZXR1cm4gaW5mb3Nbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIF9kZXNrSW5mb0d1aVBhaUluZm86IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZXR0aW5nO1xyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc4ID09IG51bGwpe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nOCA9PSAwKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzggPT0gMSl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaW5mb3MgPSBbJ+aXoOeOi+eJjCcsICfkuKTlvKDnjovniYwnLCAn5Zub5byg546L54mMJ107XHJcbiAgICAgICAgcmV0dXJuIGluZm9zW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiDliankvZnml7bpl7RcclxuICAgIF9yZW1haW5UaW1lU3RhcnRVcGRhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vdGhpcy5zY2hlZHVsZSh0aGlzLl9yZW1haW5UaW1lVXBkYXRlLCAxLjAsIGNjLm1hY3JvLlJFUEVBVF9GT1JFVkVSKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3JlbWFpblRpbWVVcGRhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9pc1JhbmRvbVJvb20oKSB8fCBQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvID09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGlzVGFvU2h1ID0gKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxID09IDApIHx8ICh0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSA9PSAxKTtcclxuICAgICAgICBpZiAoaXNUYW9TaHUpIHtcclxuICAgICAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLl9kZXNrSW5mby5jcmVhdGVUaW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBsZXQgY3JlYXRlVGltZSA9IGZlY2hhLnBhcnNlKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZVRpbWUsICdZWVlZLU1NLUREIEhIOm1tOnNzJykuZ2V0VGltZSgpO1xyXG4gICAgICAgIGxldCBvbmVIb3VyID0gNjAgKiA2MDtcclxuICAgICAgICBsZXQgcmVtYWluID0gKERhdGUubm93KCkgLSBjcmVhdGVUaW1lKSAvIDEwMDA7XHJcbiAgICAgICAgcmVtYWluID0gTWF0aC5tYXgob25lSG91ciAtIHJlbWFpbiwgMCk7XHJcblxyXG4gICAgICAgIGxldCBtaW5zID0gTWF0aC5mbG9vcihyZW1haW4gLyA2MCk7XHJcbiAgICAgICAgbGV0IHNlY3MgPSBNYXRoLmZsb29yKHJlbWFpbiAlIDYwKTtcclxuICAgICAgICBpZiAobWlucyA9PSAwICYmIHNlY3MgPT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbWluc1N0cmluZyA9IFwiXCIgKyBtaW5zO1xyXG4gICAgICAgIGlmIChtaW5zU3RyaW5nLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICAgICAgbWluc1N0cmluZyA9IFwiMFwiICsgbWluc1N0cmluZztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBzZWNzU3RyaW5nID0gXCJcIiArIHNlY3M7XHJcbiAgICAgICAgaWYgKHNlY3NTdHJpbmcubGVuZ3RoIDwgMikge1xyXG4gICAgICAgICAgICBzZWNzU3RyaW5nID0gXCIwXCIgKyBzZWNzU3RyaW5nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHN0cmluZyA9IFwi5Ymp5L2Z5pe26Ze077yaMDA6XCIgKyBtaW5zU3RyaW5nICsgXCI6XCIgKyBzZWNzU3RyaW5nO1xyXG4gICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLnN0cmluZyA9IHN0cmluZztcclxuICAgIH0sXHJcblxyXG4gICAgLy8gTUFSSzog5aSE55CG5ZCMIElQIOeahOeUqOaIt1xyXG4gICAgX2hhbmRsZVRoZVNhbWVPZklQQWRyZXNzOiBmdW5jdGlvbih1c2VySW5mb3MpIHtcclxuICAgICAgICBpZiAoIXVzZXJJbmZvcyB8fCB1c2VySW5mb3MubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGlwVXNlckluZm9zID0gdXNlckluZm9zLnJlZHVjZShmdW5jdGlvbihpcHMsIHVzZXJJbmZvKSB7XHJcbiAgICAgICAgICAgIGxldCB1c2VycyA9IGlwc1t1c2VySW5mby5pcEFkZHJlc3NdIHx8IFtdO1xyXG4gICAgICAgICAgICB1c2Vycy5wdXNoKHVzZXJJbmZvKTtcclxuXHJcbiAgICAgICAgICAgIGlwc1t1c2VySW5mby5pcEFkZHJlc3NdID0gdXNlcnM7XHJcbiAgICAgICAgICAgIHJldHVybiBpcHM7XHJcbiAgICAgICAgfSwge30pO1xyXG5cclxuICAgICAgICBsZXQgc2FtZUlwVXNlcnMgPSBudWxsO1xyXG4gICAgICAgIGZvciAobGV0IGlwIGluIGlwVXNlckluZm9zKSB7XHJcbiAgICAgICAgICAgIGxldCB1c2VycyA9IGlwVXNlckluZm9zW2lwXTtcclxuICAgICAgICAgICAgaWYgKHVzZXJzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgIHNhbWVJcFVzZXJzID0gdXNlcnM7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHNhbWVJcFVzZXJzID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fYWxlcnRTYW1lSXBVc2VySW5mb3Moc2FtZUlwVXNlcnMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfYWxlcnRTYW1lSXBVc2VySW5mb3M6IGZ1bmN0aW9uKHVzZXJzKSB7XHJcbiAgICAgICAgbGV0IG1lc3NhZ2UgPSBcIlwiO1xyXG4gICAgICAgIGxldCB1c2VySWRzID0gXCJcIjtcclxuICAgICAgICB1c2Vycy5mb3JFYWNoKGZ1bmN0aW9uKHVzZXIsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlICsgKGluZGV4ID4gMCA/ICcg5ZKMICcgOiAnJykgKyB1c2VyLm5pY2tuYW1lO1xyXG4gICAgICAgICAgICB1c2VySWRzID0gdXNlcklkcyArIHVzZXIuaWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UgKyAnIOWcqOWQjOS4gCBJUCDkuIvvvIEnO1xyXG5cclxuICAgICAgICB0aGlzLl9kaWRBbGVydFNhbWVJcE1lc3NhZ2UgPSB0aGlzLl9kaWRBbGVydFNhbWVJcE1lc3NhZ2UgfHwge307XHJcbiAgICAgICAgaWYgKHRoaXMuX2RpZEFsZXJ0U2FtZUlwTWVzc2FnZVt1c2VySWRzXSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNob3dBbGVydE1lc3NhZ2UobWVzc2FnZSwgdHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5fZGlkQWxlcnRTYW1lSXBNZXNzYWdlW3VzZXJJZHNdID0gdHJ1ZTtcclxuICAgIH0sXHJcblxyXG59KTtcclxuUGxheS5nb25nWGlOaVNob3cgPSBmdW5jdGlvbiAodHlwZSkge1xyXG4gICAgdGhpcy5pbnN0YW5jZXMuX2dvbmdYaU5pU2hvdyh0eXBlKTtcclxufTtcclxubW9kdWxlLmV4cG9ydHMgPSBQbGF5O1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgcHJvZHVjdElkOicnLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcbiAgICBcclxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMub25DbGlja0FjdGlvbih0aGlzLnByb2R1Y3RJZCk7ICAgICAgICBcclxuICAgIH0sXHJcbiAgICBcclxuICAgIG9uQ2xpY2tBY3Rpb246ZnVuY3Rpb24ocHJvZHVjdElkKSB7XHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcclxuXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbWF0Y2hpbmdMYWJlbDpjYy5MYWJlbCxcclxuICAgICAgICB0aW1lTm9kZTpjYy5Ob2RlLFxyXG4gICAgICAgIG1hdGNoaW5nTm9kZTpjYy5Ob2RlLFxyXG4gICAgICAgIHdhaXRpbmdQcmVmYWI6IGNjLlByZWZhYixcclxuICAgICAgICBhbGVydFByZWZhYjogY2MuUHJlZmFiLFxyXG5cclxuICAgICAgICB0aXNoaTpjYy5Ob2RlLFxyXG5cclxuICAgICAgICBfdXNlcklkOiBudWxsLFxyXG4gICAgICAgIF9yZXNwb25zZTogbnVsbCxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICBjYy5pc1Jvb21WaWV3U2hvdyA9IHRydWU7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEZXNrSW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZURlc2tJbmZvICx0aGlzKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0RGlzY29ubmVjdCwgdGhpcy5fc29ja2V0RGlzY29ubmVjdCwgdGhpcyk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RTdWNjZXNzZWQsIHRoaXMuX3NvY2tldENvbm5lY3RlZCwgdGhpcyk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVJbnRlclJhbmRvbSwgdGhpcy5fc29ja2V0UmVjZWl2ZUludGVyUmFuZG9tLCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVEZXNrSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3BsYXknKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVJbnRlclJhbmRvbTogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAvL+acjeWKoeWZqOWPkemAgSAgeydhY3Rpb24nOidpbnRlclJhbmRvbScsJ3Jlc3VsdCc6ZmFsc2UsJ2RhdGEnOnsncmVhc29uJzpyZWFzb259fVxyXG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gcmVzcG9uc2U7XHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuX3RpbWVvdXRSYW5kb21BY3Rpb24pO1xyXG4gICAgICAgIC8vIOWkhOeQhumaj+acuuWcuuWMuemFjeS4jeaIkOWKn+eahOaDheWGtVxyXG4gICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHJlYXNvbiA9IHJlc3BvbnNlLmRhdGEucmVhc29uIHx8IFwi5Yqg5YWl6ZqP5py65Zy65aSx6LSlXCI7XHJcbiAgICAgICAgdGhpcy5zaG93QWxlcnRNZXNzYWdlKHJlYXNvbik7XHJcblxyXG4gICAgICAgIGlmIChyZWFzb24gPT0gJ+S9oOW3sue7j+WcqOWMuemFjemYn+WIlycpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd01hdGNoaW5nKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZU1hdGNoaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0RGlzY29ubmVjdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgIC8vIOi/nuaOpeW3suaWreW8gFxyXG4gICAgICB0aGlzLm1hdGNoaW5nTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgdGhpcy5zaG93TmV0d29ya01lc3NhZ2UoJ+e9kee7nOmTvuaOpeaWreW8gO+8jOmHjeaWsOi/nuaOpeS4rS4uLicpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0Q29ubmVjdGVkOiBmdW5jdGlvbigpIHtcclxuICAgICAgdGhpcy5oaWRkZW5OZXR3b3JrTWVzc2FnZSgpO1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub2ZmVGFyZ2V0KHRoaXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0V4aXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tTdGFydDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBTb2NrZXQuc2VuZEVudGVyUmFuZG9tKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgIHRoaXMuX3Nob3dNYXRjaGluZygpO1xyXG5cclxuICAgICAgLyojIyMjI2JlZ2luKi9cclxuICAgICAgLy9yZWFzb27mmK/mnI3liqHlmajlj5HpgIHlm57mnaXnmoRcclxuICAgICAgLyppZih0aGlzLl9yZXNwb25zZS5kYXRhLnJlYXNvbiA9PSBcIuS9oOeahOmSu+efs+S4jei2s1wiKXtcclxuICAgICAgICAgIHRoaXMudGlzaGkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgfSovXHJcbiAgICAgIC8qIyMjIyNlbmQqL1xyXG5cclxuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbiwgNSk7XHJcbiAgICB9LFxyXG4gICAgLyojIyMjI+eCueWHu+epuueZveWcsOaWue+8jOegluefs+S4jei2s+aPkOekuua2iOWksSovXHJcbiAgICAvKm9uQnRuS29uZzpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYodGhpcy50aXNoaS5hY3RpdmUpe1xyXG4gICAgICAgICAgICB0aGlzLnRpc2hpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAvL+S7gOS5iOS5n+S4jeWBmlxyXG4gICAgICAgIH1cclxuICAgIH0sKi9cclxuICAgIC8q5Y+W5raI5Yy56YWNKi9cclxuICAgIGNsaWNrQ2FuY2VsOmZ1bmN0aW9uICgpIHtcclxuICAgICAgU29ja2V0LnNlbmRDYW5jZWxSYW5kb20odGhpcy5fdXNlcklkKTtcclxuXHJcbiAgICAgIHRoaXMuX2hpZGVNYXRjaGluZygpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfdGltZW91dFJhbmRvbUFjdGlvbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5faGlkZU1hdGNoaW5nKCk7XHJcbiAgICAgICAgdGhpcy5zaG93QWxlcnRNZXNzYWdlKCfov5vlhaXljLnphY3lpLHotKUnKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3Nob3dNYXRjaGluZzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm1hdGNoaW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgY29tcC5hbGVydCgpO1xyXG4gICAgICAgIHRoaXMubWF0Y2hpbmdMYWJlbC5zdHJpbmcgPSAn5q2j5Zyo5Yy56YWN5Lit77yM6K+356iN5ZCOLi4uJztcclxuICAgICAgICBsZXQgbnVtID0gMDtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBudW0gPSBudW0gKyAwLjU7XHJcbiAgICAgICAgICAgIHRoaXMudGltZU5vZGUucm90YXRpb24gPSBudW07XHJcbiAgICAgICAgIH0sIDAuMDEpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaGlkZU1hdGNoaW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMubWF0Y2hpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBjb21wLmRpc21pc3NBY3Rpb24oKTtcclxuICAgIH0sXHJcblxyXG4gICAgIHNob3dOZXR3b3JrTWVzc2FnZTpmdW5jdGlvbihtc2cpIHtcclxuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbik7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIHJlbW92ZVNlbGZBY3Rpb24gPSBjYy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUucnVuQWN0aW9uKHJlbW92ZVNlbGZBY3Rpb24pO1xyXG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMubmV0d29ya05vZGUpO1xyXG4gICAgICAgIHZhciBjb21wID0gdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGNvbXAub25EaXNtaXNzQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc2VsZi5uZXR3b3JrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcclxuICAgICAgICBjb21wLmFsZXJ0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGRlbk5ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc2hvd0FsZXJ0TWVzc2FnZTogZnVuY3Rpb24obXNnKSB7XHJcbiAgICAgICAgaWYgKCFtc2cpIHtcclxuICAgICAgICAgICAgY2MuZXJyb3IoXCLkuI3og73mmL7npLrkuLrnqbrnmoTkv6Hmga9cIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5hbGVydE1lc3NhZ2VOb2RlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYWxlcnRQcmVmYWIpO1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5hbGVydE1lc3NhZ2VOb2RlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jykuc2V0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcclxuICAgIH0sXHJcbn0pO1xyXG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xyXG5jb25zdCByZWNvcmQgPSByZXF1aXJlKCdyZWNvcmQnKTtcclxuXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgdGltZUxhYmVsOmNjLkxhYmVsLCAgIC8vIOaXtumXtFxyXG4gICAgICAgIGp1c2h1TGFiZWw6Y2MuTGFiZWwsICAvLyDlsYDmlbBcclxuICAgICAgICBjcmVhdGVVc2VyOmNjLk5vZGUsICAgLy8g5oi/5Li7XHJcbiAgICAgICAgcm9vbUlkOmNjLkxhYmVsLCAgICAgIC8vIOaIv+mXtOWPt1xyXG4gICAgICAgIGppZmVuOmNjLkxhYmVsLCAgICAgICAvLyDnp6/liIZcclxuICAgICAgICBpZDpjYy5MYWJlbCxcclxuICAgICAgICBhdmF0YXJOb2RlOmNjLk5vZGUsICAgLy8g5aS05YOPXHJcbiAgICAgICAgY3JlYXRvckltZzpjYy5Ob2RlLCAgIC8vIOWIm+aIv+WktOWDj1xyXG4gICAgICAgIG5pY2tuYW1lTGFiZWxzOmNjLkxhYmVsLFxyXG4gICAgICAgIHNjb3JlTGFiZWxzOltjYy5MYWJlbF0sXHJcbiAgICAgICAgLy9udW1Ob2RlOmNjLkxhYmVsLFxyXG4gICAgICAgIF9wYXJlbnRJZDogbnVsbCxcclxuICAgICAgICAvL3BsYXliYWNrTm9kZTpjYy5Ob2RlLC8v5Zue5pS+5oyJ6ZKuXHJcbiAgICAgICAgLy93YXRjaE5vZGU6Y2MuTm9kZSwvL+afpeeci+aMiemSrlxyXG4gICAgICAgIHJlb3JkSW5mbzpjYy5Ob2RlLFxyXG4gICAgICAgIF9yZWNvcmRJdGVtSW5mbzogbnVsbCxcclxuICAgICAgICB0b3RhbEdhbWVSZXN1bHQ6Y2MuTm9kZSxcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy50b3RhbEdhbWVSZXN1bHQgPSBjYy5maW5kKFwiQ2FudmFzL3JlY29yZEluZm9cIik7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldEluZm86IGZ1bmN0aW9uIChyZWNvcmRJbmZvKSB7XHJcbiAgICAgICAgdGhpcy5fcGFyZW50SWQgPSByZWNvcmRJbmZvLmlkO1xyXG4gICAgICAgIC8vdGhpcy53YXRjaE5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL3RoaXMucGxheWJhY2tOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChyZWNvcmRJbmZvLnBsYXllcnNJbmZvLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBwbGF5ZXJzSW5mbyA9IEpTT04ucGFyc2UocmVjb3JkSW5mby5wbGF5ZXJzSW5mbyk7XHJcbiAgICAgICAgcmVjb3JkSW5mby5zY29yZXMgPSBKU09OLnBhcnNlKCByZWNvcmRJbmZvLnNjb3JlcyApO1xyXG5cclxuICAgICAgICB2YXIgZmVuID0gcmVjb3JkSW5mby5zY29yZXNbIHRoaXMuZmVuKHJlY29yZEluZm8udXNlcmlkLHBsYXllcnNJbmZvLnBsYXllcnNJbmRleCkgXSA7XHJcbiAgICAgICAgLy9jYy5sb2coZmVuKVxyXG4gICAgICAgIC8vY2MubG9nKHJlY29yZEluZm8uc2NvcmVzKVxyXG4gICAgICAgIC8vY2MubG9nKHRoaXMuZmVuKHJlY29yZEluZm8udXNlcmlkLHBsYXllcnNJbmZvLnBsYXllcnNJbmRleCkpXHJcbiAgICAgICAgLy9jYy5sb2cocmVjb3JkSW5mby51c2VyaWQpXHJcbiAgICAgICAgLy9jYy5sb2cocGxheWVyc0luZm8ucGxheWVyc0luZGV4KVxyXG4gICAgICAgIC8vY2MubG9nKHJlY29yZEluZm8pXHJcbiAgICAgICAgLy9jYy5sb2cocGxheWVyc0luZm8pXHJcbiAgICAgICAgLy9jYy5sb2coJy0tLS00NycpXHJcbiAgICAgICAgdGhpcy5qaWZlbi5zdHJpbmcgPSAoZmVuID49IDA/XCIrXCIrZmVuIDpmZW4pO1xyXG5cclxuICAgICAgICB2YXIgaGVhZFVybCA9IHBsYXllcnNJbmZvLnBsYXllcnNbIHRoaXMuY3JlYXRvcihyZWNvcmRJbmZvLmNyZWF0ZVVzZXJJZCxwbGF5ZXJzSW5mby5wbGF5ZXJzSW5kZXgpIF0uYXZhdGFyVXJsOyAvLyDlpLTlg49VUkxcclxuICAgICAgICB2YXIgc3ByaXRlID0gdGhpcy5hdmF0YXJOb2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6aGVhZFVybCx0eXBlOlwianBnXCJ9LCBmdW5jdGlvbiAoZXJyLCB0ZXgpIHtcclxuICAgICAgICAgICAgaWYgKCFlcnIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lPWZyYW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMucm9vbUlkLnN0cmluZyA9IFwi5oi/5Y+377yaXCIrIHBsYXllcnNJbmZvLnJvb21JZDtcclxuICAgICAgICB0aGlzLnRpbWVMYWJlbC5zdHJpbmcgPSBcIuaXtumXtO+8mlwiICsgcGxheWVyc0luZm8udGltZS5zdWJzdHIoNSwxMSk7XHJcbiAgICAgICAgdGhpcy5qdXNodUxhYmVsLnN0cmluZyA9IFwi5bGA5pWw77yaXCIrIHRoaXMuanMocGxheWVyc0luZm8uc2V0dGluZzEtMik7XHJcblxyXG4gICAgICAgICAvL2ZvciAodmFyIGkgPSAwO2kgPCBwbGF5ZXJzSW5mby5wbGF5ZXJzLmxlbmd0aDtpKyspIHtcclxuICAgICAgICAgLy8gIHRoaXMubmlja25hbWVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc0luZm8ucGxheWVyc1tpXS5uaWNrbmFtZTtcclxuICAgICAgICAgLy8gIHRoaXMuc2NvcmVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc0luZm8ucGxheWVyc1tpXS50b3RhbFNjb3JlO1xyXG4gICAgICAgICAvL31cclxuICAgIH0sXHJcbiAgICBqczogZnVuY3Rpb24oc2V0dGluZzIpe1xyXG4gICAgICAgIHZhciBqdXNodSA9IDU7XHJcbiAgICAgICAgc3dpdGNoKHNldHRpbmcyKXtcclxuICAgICAgICAgICAgY2FzZSAwOiBqdXNodSA9IDU7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDE6IGp1c2h1ID0gMTA7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDI6IGp1c2h1ID0gMjA7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM6IGp1c2h1ID0gMzA7IGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ganVzaHU7XHJcbiAgICB9LFxyXG5cclxuICAgIGZlbjpmdW5jdGlvbih1c2VyaWQscGxheWVycyl7ICAgICAgICAgLy8g5om+56ev5YiGXHJcbiAgICAgICAgZm9yKHZhciBpID0wOyBpPHBsYXllcnMubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIGlmKHBsYXllcnNbaV0gPT0gdXNlcmlkKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNyZWF0b3IgOmZ1bmN0aW9uKGNyZWF0b3IscGxheWVycyl7ICAgIC8v5Yib5oi/6ICFXHJcbiAgICAgICAgZm9yKHZhciBpID0wOyBpPHBsYXllcnMubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIGlmKHBsYXllcnNbaV0gPT0gY3JlYXRvcil7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tBY3Rpb246IGZ1bmN0aW9uKCBldmVudCwgZGF0YSApIHtcclxuICAgICAgICBsZXQgcGxheWVyc0luZm8gPSBKU09OLnBhcnNlKGRhdGEucGxheWVyc0luZm8pO1xyXG4gICAgICAgIGxldCB0b3RhbEdhbWVSZXN1bHRDb21wID0gdGhpcy50b3RhbEdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdUb3RhbEdhbWVSZXN1bHQnKTtcclxuICAgICAgICB0b3RhbEdhbWVSZXN1bHRDb21wLnNldFBsYXllckluZm9zKHBsYXllcnNJbmZvLnBsYXllcnMsIGRhdGEpO1xyXG4gICAgICAgIHRvdGFsR2FtZVJlc3VsdENvbXAuX2NsaWNrQnRuKCk7XHJcbiAgICAgICAgdGhpcy50b3RhbEdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XHJcblxyXG4gICAgICAgIC8vaWYgKHRoaXMuX3JlY29yZEl0ZW1JbmZvKSB7XHJcbiAgICAgICAgLy8gIHRoaXMuX3N0YXJ0UGxheWJhY2sodGhpcy5fcmVjb3JkSXRlbUluZm8uX2luZm84QXJyYXkpO1xyXG4gICAgICAgIC8vICByZXR1cm47XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vL1NvY2tldC5zZW5kR2V0SXRlbVJlY29yZChTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQsdGhpcy5fcGFyZW50SWQpO1xyXG4gICAgICAgIC8vU29ja2V0LnNlbmRHZXRJdGVtUmVjb3JkKFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZCwtLWluZGV4KTtcclxuICAgIH0sXHJcblxyXG4gICAgX3N0YXJ0UGxheWJhY2s6IGZ1bmN0aW9uIChwbGF5QmFja0luZm8pIHtcclxuICAgICAgICAvL1BsYXliYWNrLmluc3RhbmNlLnNldFBsYXliYWNrRGF0YXMocGxheUJhY2tJbmZvKTtcclxuICAgICAgICAvL2NjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xyXG4gICAgfSxcclxuXHJcbiAgICBkZXRhaWxBY3Rpb246IGZ1bmN0aW9uKHJlY29yZEl0ZW1JbmZvLCBpbmRleCkge1xyXG4gICAgICAgIC8vdGhpcy5fcmVjb3JkSXRlbUluZm8gPSByZWNvcmRJdGVtSW5mbztcclxuICAgICAgICAvLy8vdGhpcy5wbGF5YmFja05vZGUuYWN0aXZlID0gdHJ1ZVxyXG4gICAgICAgIC8vLy9jb25zb2xlLmxvZygpO1xyXG4gICAgICAgIC8vLy90aGlzLm51bU5vZGUuc3RyaW5nID0gXCLnrKxcIiArIChpbmRleCArIDEpICsgXCLlsYBcIjtcclxuICAgICAgICAvL3RoaXMudGltZUxhYmVsLnN0cmluZyA9IHJlY29yZEl0ZW1JbmZvLmNyZWF0QXQuc3Vic3RyKDUsMTEpO1xyXG4gICAgICAgIC8vbGV0IG9iakFycmF5ID0gSlNPTi5wYXJzZShyZWNvcmRJdGVtSW5mby5pbmZvOCk7XHJcbiAgICAgICAgLy90aGlzLl9yZWNvcmRJdGVtSW5mby5faW5mbzhBcnJheSA9IG9iakFycmF5O1xyXG4gICAgICAgIC8vbGV0IHBsYXllcnNBcnJheSA9IG9iakFycmF5Lm1hcChmdW5jdGlvbihzdHIpe1xyXG4gICAgICAgIC8vICByZXR1cm4gSlNPTi5wYXJzZShzdHIpO1xyXG4gICAgICAgIC8vfSk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvL3ZhciBwbGF5ZXJzID0gcGxheWVyc0FycmF5W3BsYXllcnNBcnJheS5sZW5ndGgtMV0uZGF0YS5wbGF5ZXJzO1xyXG4gICAgICAgIC8vZm9yICh2YXIgaSA9IDA7aSA8IHBsYXllcnMubGVuZ3RoO2krKykge1xyXG4gICAgICAgIC8vICAgIHRoaXMubmlja25hbWVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc1tpXS5uaWNrbmFtZTtcclxuICAgICAgICAvLyAgICB0aGlzLnNjb3JlTGFiZWxzW2ldLnN0cmluZyA9IHBsYXllcnNbaV0uY1Njb3JlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgfSxcclxuICAgIHJlY29yZHM6ZnVuY3Rpb24oKXtcclxuXHJcbiAgICB9LFxyXG5cclxuXHJcbn0pOyIsImNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XHJcbmNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHNjcm9sbFZpZXc6Y2MuTm9kZSxcclxuICAgICAgICByZWNvcmRJdGVtOmNjLlByZWZhYixcclxuICAgICAgICAvL3N1YlNjcm9sbFZpZXc6Y2MuTm9kZSxcclxuICAgICAgICAvL3N1YlJlY29yZEl0ZW06Y2MuTm9kZSxcclxuICAgICAgICAvL3NwbGFzaDpjYy5QcmVmYWIsXHJcbiAgICAgICAgLy9yZW9yZEluZm86Y2MuTm9kZSxcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vamlmZW46Y2MuTGFiZWwsXHJcbiAgICAgICAgLy9oZWFkOmNjLk5vZGUsXHJcbiAgICAgICAgLy9pZDpjYy5MYWJlbCxcclxuICAgICAgICAvL25pY2tuYW1lOmNjLkxhYmVsLFxyXG4gICAgICAgIC8vY3JlYXQ6Y2MuTGFiZWwsICAgICAgICAvLyDliJvmiL/kurpcclxuICAgICAgICAvL2NyZWF0ZVVzZXI6Y2MuTm9kZSwgICAgIC8vICDlpLTlg49cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vdGltZUxhYmVsOmNjLkxhYmVsLCAgIC8vIOaXtumXtFxyXG4gICAgICAgIC8vanVzaHVMYWJlbDpjYy5MYWJlbCwgIC8vIOWxgOaVsFxyXG4gICAgICAgIC8vLy9jcmVhdGVVc2VyOmNjLk5vZGUsICAgLy8g5oi/5Li7XHJcbiAgICAgICAgLy9yb29tSWQ6Y2MuTGFiZWwsICAgICAgLy8g5oi/6Ze05Y+3XHJcbiAgICAgICAgLy9fcmVjb3JkczpudWxsLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vdGhpcy5pc1N1YlBhZ2UgPSBmYWxzZTtcclxuICAgICAgICAvL3RoaXMuc3ViU2Nyb2xsVmlldy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudCA9IHRoaXMuc3ViU2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKCB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50ICk7XHJcbiAgICAgICAgLy90aGlzLnJlY29yZEluZm8gPSB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50LmNoaWxkcmVuWzBdO1xyXG4gICAgICAgIC8vdGhpcy5yZW9yZHMgPSB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50LmNoaWxkcmVuWzBdLmNoaWxkcmVuWzNdO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsVmlld0NvbnRlbnQgPSB0aGlzLnNjcm9sbFZpZXcuZ2V0Q29tcG9uZW50KGNjLlNjcm9sbFZpZXcpLmNvbnRlbnQ7XHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJTb2NrZXRFdmVudCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcmVnaXN0ZXJTb2NrZXRFdmVudDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5HZXRSZWNvcmQsIHRoaXMuX1JlY2VpdmVSZWNvcmRJbmZvLCB0aGlzKTtcclxuICAgICAgLy9LUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5HZXRJdGVtUmVjb3JkLCB0aGlzLl9SZWNlaXZlUmVjb3JkSXRlbSwgdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9SZWNlaXZlUmVjb3JkSW5mbzpmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIC8vY2MubG9nKHJlc3BvbnNlKVxyXG4gICAgICAgIC8vY2MubG9nKCctLS0tLS03OCcpXHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcbiAgICAgICAgLy90aGlzLl9yZWNvcmRzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAvL3RoaXMuaXNTdWJQYWdlID0gZmFsc2U7XHJcbiAgICAgICAgLy90aGlzLnN1YlNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLy90aGlzLnNjcm9sbFZpZXcuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5zY3JvbGxWaWV3Q29udGVudC5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgIHZhciBpbmRleCA9IDA7XHJcbiAgICAgICAgcmVzcG9uc2UuZGF0YS5maWx0ZXIoIGZ1bmN0aW9uIChyZWNvcmQpIHtyZXR1cm4gcmVjb3JkLnBsYXllcnNJbmZvLmxlbmd0aCA+IDA7fSkuZm9yRWFjaChmdW5jdGlvbiAocmVjb3JkSW5mbykge1xyXG4gICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgICAgICB2YXIgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMucmVjb3JkSXRlbSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVmlld0NvbnRlbnQuYWRkQ2hpbGQoaXRlbSk7XHJcbiAgICAgICAgICAgIHZhciBjb21wID0gaXRlbS5nZXRDb21wb25lbnQoJ3JlY29yZEluZm8nKTtcclxuICAgICAgICAgICAgY29tcC5zZXRJbmZvKHJlY29yZEluZm8pO1xyXG4gICAgICAgICAgICB2YXIgcmVjb3JkQnRuID0gaXRlbS5jaGlsZHJlbls3XS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICAgICAgcmVjb3JkQnRuLmNsaWNrRXZlbnRzWzBdLmN1c3RvbUV2ZW50RGF0YSA9IHJlY29yZEluZm87XHJcbiAgICAgICAgICAgIC8vIHZhciBldmVudEhhbmRsZXIgPSBuZXcgY2MuQ29tcG9uZW50LkV2ZW50SGFuZGxlcigpO1xyXG4gICAgICAgICAgICAvLyBldmVudEhhbmRsZXIudGFyZ2V0ID0gY29tcC5ub2RlLmNoaWxkcmVuWzddO1xyXG4gICAgICAgICAgICAvLyBldmVudEhhbmRsZXIuY29tcG9uZW50ID0gXCJidG5cIjtcclxuICAgICAgICAgICAgLy8gZXZlbnRIYW5kbGVyLmhhbmRsZXIgPSBcImNsaWNrQWN0aW9uXCI7XHJcbiAgICAgICAgICAgIC8vZXZlbnRIYW5kbGVyLmN1c3RvbUV2ZW50RGF0YSA9IFwibXkgZGF0YVwiO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGNvbXAubm9kZS5jaGlsZHJlbls3XSk7XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xvc2VBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNTdWJQYWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNTdWJQYWdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuc3ViU2Nyb2xsVmlldy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxWaWV3LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAvKiBjbGlja0FjdGlvbjpmdW5jdGlvbiggaW5kZXggKXtcclxuICAgICAgICAvL19SZWNlaXZlUmVjb3JkSXRlbSgpXHJcbiAgICB9LFxyXG4gICAgX1JlY2VpdmVSZWNvcmRJdGVtOmZ1bmN0aW9uKFJlY29yZEl0ZW1JbmZvKSB7XHJcbiAgICAgICAgY2MubG9nKFJlY29yZEl0ZW1JbmZvKVxyXG4gICAgICAgIGNjLmxvZygnLS0tLS0tNzgnKVxyXG4gICAgICAgIC8vY29uc29sZS5sb2coUmVjb3JkSXRlbUluZm8pO3JldHVybjtcclxuICAgICAgICB2YXIgaW5kZXggPSBSZWNvcmRJdGVtSW5mby5kYXRhXHJcbiAgICAgICAgdmFyIHBsYXllcnNJbmZvID0gSlNPTi5wYXJzZSh0aGlzLl9yZWNvcmRzW2luZGV4XS5wbGF5ZXJzSW5mbyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIHBsYXllcnMgPSBwbGF5ZXJzSW5mby5wbGF5ZXJzOyAgICAgICAgICAgICAgICAgIC8vIOeOqeWutuS/oeaBr1xyXG4gICAgICAgIHZhciBwbGF5ZXJzSW5kZXggPSBwbGF5ZXJzSW5mby5wbGF5ZXJzSW5kZXg7ICAgICAgICAvLyDnjqnlrrbnmoTkvY3nva5cclxuICAgICAgICB2YXIgY3JlYXRlVXNlcklkID0gdGhpcy5fcmVjb3Jkc1tpbmRleF0uY3JlYXRlVXNlcklkOyAgIC8vIOWIm+aIv0lEXHJcbiAgICAgICAgdmFyIHNlbmRVc2VySWQgPSB0aGlzLl9yZWNvcmRzW2luZGV4XS51c2VyaWQ7ICAgICAgICAgICAvLyDlj5HpgIHkurpJRFxyXG5cclxuICAgICAgICB0aGlzLmlzU3ViUGFnZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zY3JvbGxWaWV3LmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnRpbWVMYWJlbC5zdHJpbmcgPSAodGhpcy5fcmVjb3Jkc1tpbmRleF0uY3JlYXRlQXQpLnN1YnN0cig1LDExKTsgICAgICAgICAgICAgICAvLyDml7bpl7RcclxuICAgICAgICB0aGlzLmp1c2h1TGFiZWwuc3RyaW5nID0gdGhpcy5qcyhKU09OLnBhcnNlKHRoaXMuX3JlY29yZHNbaW5kZXhdLnNldHRpbmcyKSk7ICAgICAgICAvLyDlsYDmlbBcclxuICAgICAgICB0aGlzLnJvb21JZC5zdHJpbmcgPSB0aGlzLl9yZWNvcmRzW2luZGV4XS5yb29tSWQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmiL/pl7Tlj7dcclxuICAgICAgICB0aGlzLmNyZWF0LnN0cmluZyA9IHRoaXMuZmluZENyZWF0b3IodGhpcy5fcmVjb3Jkc1tpbmRleF0uY3JlYXRlVXNlcklkLHBsYXllcnMpOyAgICAvLyDmiL/kuLtcclxuXHJcbiAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudCA9IHRoaXMuc3ViU2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcclxuICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50LnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcblxyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwbGF5ZXJzLmxlbmd0aDsgaSsrICl7XHJcbiAgICAgICAgICAgIHZhciBpdGVtID0gY2MuaW5zdGFudGlhdGUodGhpcy5zcGxhc2gpO1xyXG4gICAgICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50LmFkZENoaWxkKGl0ZW0pO1xyXG4gICAgICAgICAgICB2YXIgY29tcCA9IGl0ZW0uZ2V0Q29tcG9uZW50KCdyZWNvcmRJbmZvJyk7XHJcbiAgICAgICAgICAgIHZhciBjcmVhdG9yID0gMDsgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gMDsgICAgICAgLy8g6KGo56S66Ieq5bex77yM6KaB5a+56Ieq5bex55qE5q+U54mM6K6w5b2V6IOM5pmv5YGa5aSE55CGXHJcbiAgICAgICAgICAgIGlmKGNyZWF0ZVVzZXJJZCA9PSBwbGF5ZXJzW2ldLmlkKXtcclxuICAgICAgICAgICAgICAgIGNyZWF0b3IgPTE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoIHNlbmRVc2VySWQgPT0gcGxheWVyc1tpXS5pZCl7XHJcbiAgICAgICAgICAgICAgICBzZWxmID0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnJlY29yZHMoY29tcCxpLGNyZWF0b3Isc2VsZixpbmRleCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcbiAgICByZWNvcmRzOmZ1bmN0aW9uKGluZm8saSxjcmVhdG9yLHNlbGYsaW5kZXgpe1xyXG4gICAgICAgIGlmKHNlbGYpe1xyXG4gICAgICAgICAgICBpbmZvLm5vZGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTI1LCAxMjYsIDIwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLmxvZyhpbmZvKVxyXG4gICAgICAgIGNjLmxvZygnLS0tLTExOScpXHJcbiAgICAgICAgdmFyIHBsYXllcnMgPSBKU09OLnBhcnNlKHRoaXMuX3JlY29yZHNbaW5kZXhdLnBsYXllcnNJbmZvKS5wbGF5ZXJzO1xyXG4gICAgICAgIHZhciBzY29yZXMgPSB0aGlzLl9yZWNvcmRzW2luZGV4XS5zY29yZXMgO1xyXG4gICAgICAgIGluZm8ubmlja25hbWVMYWJlbHMuc3RyaW5nID0gcGxheWVyc1tpXS5uaWNrbmFtZTtcclxuICAgICAgICBpbmZvLmlkLnN0cmluZyA9IHBsYXllcnNbaV0uaWQ7XHJcbiAgICAgICAgaW5mby5qaWZlbi5zdHJpbmcgPSBzY29yZXNbaV07XHJcblxyXG4gICAgICAgIHZhciBoZWFkVXJsID0gcGxheWVyc1tpXS5hdmF0YXJVcmw7ICAgLy/lpLTlg4/ov57mjqVcclxuICAgICAgICB2YXIgc3ByaXRlID0gaW5mby5hdmF0YXJOb2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgIGNjLmxvYWRlci5sb2FkKGhlYWRVcmwrXCIuanBnXCIsIGZ1bmN0aW9uIChlcnIsIHRleCkge1xyXG4gICAgICAgICAgaWYgKCFlcnIpIHtcclxuICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4KTtcclxuICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWU9ZnJhbWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaW5mby5jcmVhdG9ySW1nLmFjdGl2ZSA9IGNyZWF0b3I7XHJcbiAgICB9LFxyXG4gICAgZmluZENyZWF0b3I6ZnVuY3Rpb24oY3JlYXRlSWQscGxheWVycyl7IC8v5om+5oi/5Li7XHJcbiAgICAgICAgZm9yKHZhciBpPTA7IGk8cGxheWVycy5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgaWYoY3JlYXRlSWQgPT0gcGxheWVyc1tpXS5pZCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGxheWVyc1tpXS5uaWNrbmFtZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBqczpmdW5jdGlvbihudW0pe1xyXG4gICAgICAgIHZhciBKID0gNTtcclxuICAgICAgICBzd2l0Y2gobnVtKXtcclxuICAgICAgICAgICAgY2FzZSAwOiBKID0gNTticmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiBKID0gMTA7YnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjogSiA9IDIwO2JyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM6IEogPSAzMDticmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEo7XHJcbiAgICB9LCovXHJcblxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgfSxcclxufSk7XHJcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgY29udGVudDpjYy5Ob2RlXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB2aXNpYmxlU2l6ZSA9IGNjLmRpcmVjdG9yLmdldFZpc2libGVTaXplKCk7XHJcbiAgICAgICAgdmFyIGNvbnRlbnRTaXplID0ge307XHJcbiAgICAgICAgY29udGVudFNpemUud2lkdGggPSB0aGlzLm5vZGUud2lkdGg7XHJcbiAgICAgICAgY29udGVudFNpemUuaGVpZ2h0ID0gdGhpcy5ub2RlLmhlaWdodDtcclxuICAgICAgICB2YXIgc2NhbGVYID0gdmlzaWJsZVNpemUud2lkdGgvY29udGVudFNpemUud2lkdGg7XHJcbiAgICAgICAgdmFyIHNjYWxlWSA9IHZpc2libGVTaXplLmhlaWdodC9jb250ZW50U2l6ZS5oZWlnaHQ7XHJcbiAgICAgICAgdmFyIHNjYWxlID0gTWF0aC5taW4oc2NhbGVYLHNjYWxlWSkudG9GaXhlZCgyKTtcclxuICAgICAgICB0aGlzLm5vZGUuc2NhbGVYID0gc2NhbGU7XHJcbiAgICAgICAgdGhpcy5ub2RlLnNjYWxlWSA9IHNjYWxlO1xyXG4gICAgfVxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBub2RlczpbY2MuTm9kZV0sXHJcbiAgICAgICAgc2VsZWN0ZWRJbmRleDogMCxcclxuICAgICAgICBfc2VsZWN0OltdLFxyXG4gICAgICAgIF9zZWxlY3RlZDowLFxyXG4gICAgICAgIGJlaWx2OmNjLk5vZGUsICAvLyDlgI3njodcclxuICAgICAgICBfYmxTaG93OjAsICAgICAgLy8g5YCN546H55qE5pi+56S654q25oCBXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYmVpbHYuYWN0aXZlID0gdGhpcy5fYmxTaG93O1xyXG4gICAgICAgIHRoaXMuX3NlbGVjdCA9IFsxLDEsMSwwLDBdOyBcclxuICAgICAgICBpZihjYy5zZXQpeyAgLy8g6K6w5b2V5LiK5LiA5Y+l55qE5oi/6Ze05oOF5Ya1XHJcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdCA9IGNjLnNldFsnc2V0dGluZzMnXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgYWN0aXZlID0gdGhpcy5fc2VsZWN0W2ldO1xyXG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jykuc2V0U2VsZWN0ZWQoYWN0aXZlKTtcclxuICAgICAgICAgICAgdmFyIHRpdGxlID0gdGhpcy5ub2Rlc1tpXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKTtcclxuICAgICAgICAgICAgaWYodGhpcy5fc2VsZWN0W2ldKXtcclxuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihpPT0zKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmVpbHYuYWN0aXZlID0gKHRoaXMuX2JsU2hvdyA9IHRoaXMuX3NlbGVjdFszXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgdENvbXAgPSB0aGlzLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XHJcbiAgICAgICAgICAgIHRDb21wLmluZGV4ID0gaTtcclxuICAgICAgICAgICAgdENvbXAuY2xpY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuaW5kZXg7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYubm9kZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcCA9IHNlbGYubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWQoIHNlbGYuX3NlbGVjdFtpbmRleF0gPSAhc2VsZi5fc2VsZWN0W2luZGV4XSApO1xyXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMuaW5kZXggPT0gMyApeyAgICAgICAgICAgICAgICAgICAgICAvLyDnrKzkuInkuKrmmK/luoTlrrbmqKHlvI/vvIzluoTlrrbmqKHlvI/mmL7npLrlgI3njodcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmJlaWx2LmFjdGl2ZSA9ICh0aGlzLl9ibFNob3cgPSBzZWxmLl9zZWxlY3RbM10pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHNlbGYuX3NlbGVjdFtpbmRleF0gPSBzZWxmLl9zZWxlY3RbaW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZEluZGV4ID0gaW5kZXg7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm9uU2VsZWN0Q2hhbmdlKGluZGV4KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLm5vZGUuY2hpbGRyZW5bMF07XHJcbiAgICAgICAgICAgICAgICBpZiggc2VsZi5fc2VsZWN0W2luZGV4XSApeyAgICAgICAgICAgICAvLyDlpoLmnpzlvZPliY3pgInpobnkuLpUUlVFIOWImeaYvuekuumdkuiJslxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlj43kuYsg55m96ImyXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LDI1NSwyNTUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvblNlbGVjdENoYW5nZTogZnVuY3Rpb24gKHNlbGVjdEluZGV4KSB7XHJcbiAgICAgICAgLy9jYy5sb2coc2VsZWN0SW5kZXgpO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2codGhpcy5fc2VsZWN0KTtcclxuICAgIH0sXHJcblxyXG5cclxuXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgcGFpOmNjLk5vZGUsXHJcbiAgICAgICAgbWFwYWk6e1xyXG4gICAgICAgICAgICBkZWZhdWx0OltdLFxyXG4gICAgICAgICAgICB0eXBlOmNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RNYSA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJzZWxlY3RfbWFcIik7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RNYS5vbkxvYWQoKTtcclxuICAgICAgICB0aGlzLmNvbSA9IHRoaXMucGFpLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgY2xpY2tCdG5Db21maXJtOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuY29tLnNwcml0ZUZyYW1lID0gdGhpcy5tYXBhaVtjYy5mcm9tLm1hXTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuY29tLnNwcml0ZUZyYW1lKTtcclxuICAgIH0sXHJcbiAgICBcclxuXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICByaWdodEljb246W2NjLk5vZGVdLFxyXG4gICAgICAgIG1hcGFpUmlnaHQ6Y2MuTm9kZVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKGNjLmZyb20gPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIGNjLmZyb20gPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy/lpoLmnpzkuI3luKbpqazvvIzliJnpqazniYzkuLrnqbpcclxuICAgICAgICBpZih0aGlzLm1hcGFpUmlnaHQuYWN0aXZlID09IGZhbHNlKXtcclxuICAgICAgICAgICAgY2MuZnJvbS5pc1VzZU1hID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSBudWxsO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjYy5mcm9tLmlzVXNlTWEgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL+WQpuWImemprOeJjOm7mOiupOS4uuesrDDkuKrvvIzljbPpu5HmoYM1XHJcbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IodmFyIGk9MDtpPHRoaXMucmlnaHRJY29uLmxlbmd0aDtpKyspIHtcclxuICAgICAgICAgICAgaWYoaT09MCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodEljb25baV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNjLmZyb20ubWEgPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QgPSB0aGlzLnJpZ2h0SWNvbltpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRJY29uW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuICAgIG9uTWFQYWlDbGljazpmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldE5hbWUgPSBlLnRhcmdldC5uYW1lO1xyXG4gICAgICAgIC8vY2MubG9nKHRhcmdldE5hbWUpXHJcbiAgICAgICAgaWYodGFyZ2V0TmFtZSAhPSB0aGlzLnNlbGVjdC5wYXJlbnQubmFtZSkge1xyXG4gICAgICAgICAgICBpZih0YXJnZXROYW1lID09IFwic2VsZWN0X2t1YW5nMVwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMucmlnaHRJY29uWzJdO1xyXG4gICAgICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih0YXJnZXROYW1lID09IFwic2VsZWN0X2t1YW5nMlwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMucmlnaHRJY29uWzFdO1xyXG4gICAgICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih0YXJnZXROYW1lID09IFwic2VsZWN0X2t1YW5nM1wiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMucmlnaHRJY29uWzBdO1xyXG4gICAgICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLnJpZ2h0SWNvbi5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRJY29uW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vY29uc29sZS5sb2coY2MuZnJvbS5tYSk7XHJcbiAgICB9XHJcblxyXG5cclxufSk7XHJcbiIsImNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XHJcbmNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIF91c2VyaWQgOiAwLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcbiAgICBjbGlja0JlaUx2OmZ1bmN0aW9uKGV2ZW50LG51bSl7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIFNvY2tldC5zZW5kQmVpTHYobnVtLHRoaXMuX3VzZXJpZCk7XHJcbiAgICB9LFxyXG4gICBcclxufSk7XHJcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgYmdOb2RlOmNjLk5vZGUsICAgLy/pgInmi6nmoYZcclxuICAgICAgICBzZWxlY3RlZE5vZGU6Y2MuTm9kZSwgIC8v5a+55Y+3XHJcbiAgICAgICAgcGFpOmNjLk5vZGUsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLm5vZGUpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coY2Muc2V0KTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhdGhpcy5zZWxlY3RlZDtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0aGlzLnNlbGVjdGVkO1xyXG4gICAgICBcclxuICAgIH0sXHJcbiAgICBcclxuICAgIHNldFNlbGVjdGVkOmZ1bmN0aW9uKHNlbGVjdGVkKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHNlbGVjdGVkO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRoaXMuc2VsZWN0ZWQ7XHJcbiAgICB9LFxyXG4gICAgLyojIyMjIyovXHJcbiAgICBjbGlja1NlbGVjdEt1YW5nOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhdGhpcy5zZWxlY3RlZDtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0aGlzLnNlbGVjdGVkO1xyXG4gICAgICAgIGNjLmZyb20uaXNVc2VNYSA9IHRoaXMuc2VsZWN0ZWQ7XHJcbiAgICAgICAgdmFyIG1hcGFpQ29tID0gdGhpcy5wYWkuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XHJcbiAgICAgICAgaWYodGhpcy5zZWxlY3RlZE5vZGUuYWN0aXZlID09PSBmYWxzZSl7XHJcbiAgICAgICAgICAgIG1hcGFpQ29tLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBtYXBhaUNvbS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIG5vZGVzOltjYy5Ob2RlXSxcclxuICAgICAgICBzZWxlY3RlZEluZGV4OiAwLFxyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMqL1xyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBycyA9IDA7XHJcbiAgICAgICAgdmFyIGpzID0gMDtcclxuICAgICAgICB2YXIgc2YgPSAwO1xyXG4gICAgICAgIHZhciBibCA9IDA7XHJcbiAgICAgICAgaWYoY2Muc2V0KXtcclxuICAgICAgICAgICAganMgPSBjYy5zZXQuc2V0dGluZzE7XHJcbiAgICAgICAgICAgIHJzID0gY2Muc2V0LnNldHRpbmcyO1xyXG4gICAgICAgICAgICBzZiA9IGNjLnNldC5zZXR0aW5nNDtcclxuICAgICAgICAgICAgYmwgPSBjYy5zZXQuc2V0dGluZzU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgaXNTZWxlY3RlZCA9ICh0aGlzLnNlbGVjdGVkSW5kZXggPT0gaSk7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKS5zZXRTZWxlY3RlZChpc1NlbGVjdGVkKTtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gMDtcclxuICAgICAgICAgICAgdmFyIHNlbGVjdEluZGV4ID0gdGhpcy5zZWxlY3RlZEluZGV4IDtcclxuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDaGlsZEJ5TmFtZSgndGl0bGUnKS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsMjU1LDI1NSk7XHJcbiAgICAgICAgICAgIGlmKCBzZWxlY3RJbmRleCA9PSBpKXtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZXNbc2VsZWN0SW5kZXhdLmdldENoaWxkQnlOYW1lKFwidGl0bGVcIikuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0Q29tcCA9IHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcclxuICAgICAgICAgICAgdENvbXAuaW5kZXggPSBpO1xyXG5cclxuICAgICAgICAgICAgdENvbXAuY2xpY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5ub2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wID0gc2VsZi5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0U2VsZWN0ZWQoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIFBlZXJzID0gdGhpcy5ub2RlLnBhcmVudC5jaGlsZHJlbjsgIC8vIOWQjOi+iOiKgueCuVxyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgYT0wOyBhPFBlZXJzLmxlbmd0aDsgYSsrKXtcclxuICAgICAgICAgICAgICAgICAgICBpZiggUGVlcnNbYV0uY2hpbGRyZW4ubGVuZ3RoPjAgKXsgICAgICAgICAgICAvLyDlpoLmnpzlkIzovojmnInlrZDoioLngrkg5aSE55CG5a2Q6IqC54K55paH5a2X55qE6aKc6ImyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IFBlZXJzW2FdLmdldENoaWxkQnlOYW1lKFwidGl0bGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJykuY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMubm9kZS5jaGlsZHJlbltpbmRleF0uY29sb3IgPSBuZXcgY2MuQ29sb3IoMTMsMjEwLDIyMik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZEluZGV4ID0gdGhpcy5pbmRleDtcclxuICAgICAgICAgICAgICAgIHNlbGYub25TZWxlY3RDaGFuZ2UodGhpcy5pbmRleCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJyZW5zaHVcIiAmJiBjYy5zZXQgKXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocnMpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbWVtYmVyX3NldChycyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJqdXNodVwiICYmIGNjLnNldCApe1xyXG4gICAgICAgICAgICB0aGlzLnJlbWVtYmVyX3NldChqcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJjYXJkc1wiICYmIGNjLnNldCApe1xyXG4gICAgICAgICAgICB0aGlzLnJlbWVtYmVyX3NldChzZik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCB0aGlzLm5vZGUuX25hbWUgPT0gXCJiZWlMdlwiICYmIGNjLnNldCApe1xyXG4gICAgICAgICAgICB0aGlzLnJlbWVtYmVyX3NldChibCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHJlbWVtYmVyX3NldDpmdW5jdGlvbihudW0pe1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IG51bTtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgIGxldCBpc1NlbGVjdGVkID0gKG51bSA9PSBpKTtcclxuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKGlzU2VsZWN0ZWQpO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLm5vZGVzW2ldLmdldENoaWxkQnlOYW1lKCd0aXRsZScpLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwyNTUsMjU1KTtcclxuICAgICAgICAgICAgaWYoIG51bSA9PSBpKXtcclxuICAgICAgICAgICAgICAgIC8vIGlmKCB0aGlzLm5vZGVzW251bV0uY2hpbGRyZW5bMF0ubmFtZSA9PSBcInRpdGxlXCIgKXtcclxuICAgICAgICAgICAgICAgIC8vICAgICBpbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICAvLyB9ZWxzZSBpZih0aGlzLm5vZGVzW251bV0uY2hpbGRyZW5bMV0ubmFtZSA9PSBcInRpdGxlXCIpe1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGluZGV4ID0xO1xyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2Rlc1tudW1dLmdldENoaWxkQnlOYW1lKCd0aXRsZScpLmNvbG9yID0gbmV3IGNjLkNvbG9yKDEzLDIxMCwyMjIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgb25TZWxlY3RDaGFuZ2U6IGZ1bmN0aW9uIChzZWxlY3RJbmRleCkge1xyXG5cclxuXHJcbiAgICB9LFxyXG4gICAgXHJcbn0pO1xyXG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGluZGljYXRvck5vZGU6Y2MuTm9kZSxcclxuICAgICAgICBiYWNrZ3JvdW5kTm9kZTpjYy5Ob2RlLFxyXG4gICAgICAgIHNlbGVjdGVkTm9kZTpjYy5Ob2RlLFxyXG5cclxuICAgICAgICB2YWx1ZTowLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX01PVkUsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIHB0ID0gc2VsZi5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZShjYy52MihldmVudC5nZXRMb2NhdGlvblgoKSxldmVudC5nZXRMb2NhdGlvblkoKSkpO1xyXG4gICAgICAgICAgICBzZWxmLnVwZGF0ZVNsaWRlcihwdCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCxmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICB2YXIgcHQgPSBzZWxmLm5vZGUuY29udmVydFRvTm9kZVNwYWNlKGNjLnYyKGV2ZW50LmdldExvY2F0aW9uWCgpLGV2ZW50LmdldExvY2F0aW9uWSgpKSk7XHJcbiAgICAgICAgICAgIHNlbGYudXBkYXRlU2xpZGVyKHB0KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBwdCA9IHNlbGYubm9kZS5jb252ZXJ0VG9Ob2RlU3BhY2UoY2MudjIoZXZlbnQuZ2V0TG9jYXRpb25YKCksZXZlbnQuZ2V0TG9jYXRpb25ZKCkpKTtcclxuICAgICAgICAgICAgc2VsZi51cGRhdGVTbGlkZXIocHQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL3RoaXMubWF4V2lkdGggPSB0aGlzLm5vZGUud2lkdGggLSA0MDtcclxuICAgICAgICB0aGlzLm1heFdpZHRoID0gdGhpcy5ub2RlLndpZHRoLTI4O1xyXG4gICAgICAgIHRoaXMuc2V0VmFsdWUodGhpcy52YWx1ZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZVNsaWRlcjpmdW5jdGlvbihwdCkge1xyXG4gICAgICAgIHZhciB4ID0gcHQueDtcclxuICAgICAgICBpZiAoeCA8IDApIHtcclxuICAgICAgICAgICAgeCA9IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoeCA+IHRoaXMubWF4V2lkdGgpIHtcclxuICAgICAgICAgICAgeCA9IHRoaXMubWF4V2lkdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0VmFsdWUoeC90aGlzLm1heFdpZHRoKTtcclxuICAgICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UodGhpcy52YWx1ZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qMCAtIDEqL1xyXG4gICAgc2V0VmFsdWU6ZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPCAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy52YWx1ZSA+IDEpIHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdGhpcy5tYXhXaWR0aCA9IHRoaXMubm9kZS53aWR0aCAtIDM4O1xyXG4gICAgICAgIHRoaXMubWF4V2lkdGggPSB0aGlzLm5vZGUud2lkdGgtMjg7XHJcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLnggPSB0aGlzLnZhbHVlICogdGhpcy5tYXhXaWR0aCsxMDtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS53aWR0aCA9IHRoaXMudmFsdWUgKiB0aGlzLm1heFdpZHRoICsgdGhpcy5pbmRpY2F0b3JOb2RlLndpZHRoLzI7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uVmFsdWVDaGFuZ2U6ZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICBjYy5sb2codmFsdWUpO1xyXG4gICAgfSxcclxufSk7XHJcbiIsInZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xyXG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xyXG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XHJcblxyXG5sZXQgU29ja2V0Q29uc3RhbnQgPSB7XHJcbiAgTWF4UmVjb25uZWN0Q2hlY2tJbnRlcnZhbDogNSwgLy8g6YeN6L+e5qOA5rWL5pe26Ze054mHXHJcbn07XHJcblxyXG4vKipcclxuICog6L+Z5piv5a+5IFdlYlNvY2tldCDnmoTkuIDkuKrlsIHoo4VcclxuICogXHJcbiAqIOmHjOmdouWMheWQq+iHquWKqOmHjei/nueahOWKn+iDvVxyXG4gKi9cclxubGV0IFNvY2tldCA9IGNjLkNsYXNzKHtcclxuICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gIHByb3BlcnRpZXM6IHtcclxuICAgIF9sYXN0UmVjZWl2ZU1zZ1RpbWU6IDAsIC8vIOacgOWQjuS4gOasoeaUtuWIsOa2iOaBr+aXtumXtCjmr6vnp5IpXHJcbiAgICBfdGltZW91dDogOCwgLy8g6LaF5pe25pe26ZW/IO+8iOenku+8iVxyXG4gIH0sXHJcblxyXG4gIHN0YXRpY3M6IHtcclxuICAgIGluc3RhbmNlOiBudWxsLFxyXG4gICAgLy8gdXJsOlwid3M6Ly8xODIuMTguMjYuMTM6NTA0MVwiLFxyXG4gICAgLy91cmw6XCJ3czovLzEyMy41Ni4yMC4xNjQ6NTA0MVwiLC8v5L+u5pS55YmNXHJcbiAgICB1cmw6XCJ3czovLzEyNy4wLjAuMTo1MDQxXCIsXHJcbiAgICAvLyB1cmw6XCJ3czovLzE5Mi4xNjguMC4xMDg6NTA0MVwiLFxyXG4gICAgLy91cmw6XCJ3czovLzE4My4zLjIwNS4xNDk6NTAwMlwiLFxyXG4gIH0sXHJcblxyXG4gIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgU29ja2V0Lmluc3RhbmNlID0gdGhpcztcclxuXHJcbiAgICB0aGlzLm5hbWUgPSBcInNvY2tldFwiO1xyXG5cclxuICAgIGNjLmdhbWUuYWRkUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSk7XHJcbiAgICBpZiAoY2MuZ2FtZS5pc1BlcnNpc3RSb290Tm9kZSh0aGlzLm5vZGUpKSB7XHJcbiAgICAgIGNjLmxvZygn5re75Yqg5YWo5bGA6IqC54K5IFNvY2tldCDmiJDlip8nKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9yZWdpc3RlckFwcEFjdGl2ZUNoYW5nZSgpO1xyXG5cclxuICAgIHRoaXMuaXNDcmVhdGluZyA9IGZhbHNlO1xyXG4gICAgdGhpcy5jcmVhdGVJbmRleCA9IDA7XHJcbiAgICB0aGlzLmNyZWF0ZVNvY2tldCgpO1xyXG5cclxuICAgIHRoaXMuc2NoZWR1bGUoZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNoZWNrQ29ubmVjdGlvbigpO1xyXG4gICAgfSwgNSk7XHJcblxyXG4gICAgdGhpcy5yZWN2VGltZSA9IERhdGUubm93KCk7IC8v5o6l5pS25Yiw5pyA5paw5LiA5p2h5pyN5Yqh5Zmo55qE5L+h5oGv55qE5pe26Ze0XHJcbiAgICAvL2NjLmxvZyhtYW5hZ2VyLnZlcnNpb24pO1xyXG5cclxuICAgIHRoaXMuX2NoZWNrU29ja2V0KCk7XHJcbiAgfSxcclxuXHJcbiAgY2hlY2tDb25uZWN0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAvL+WuouaIt+err+WumuaXtue7meacjeWKoeerr+WPkemAgeeCueaVsOaNru+8jOmYsuatoui/nuaOpeeUseS6jumVv+aXtumXtOayoeaciemAmuiur+iAjOiiq+afkOS6m+iKgueCueeahOmYsueBq+WimeWFs+mXreWvvOiHtOi/nuaOpeaWreW8gOeahOaDheWGteOAglxyXG4gICAgdGhpcy5zZW5kTWVzc2FnZSgnY2hlY2tBY3Rpb24nLCAnJyk7XHJcbiAgfSxcclxuXHJcbiAgY3JlYXRlU29ja2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB0aGlzLmNyZWF0ZUluZGV4Kys7IC8v5Yib5bu65qyh5pWw5YqgMVxyXG4gICAgaWYgKHRoaXMuY3JlYXRlSW5kZXggPiA1KSB7XHJcbiAgICAgIHRoaXMubmV0d29ya0Vycm9yKCk7XHJcbiAgICAgIEtRTmF0aXZlSW52b2tlLmZvcmNlRXhpdEFwcCgpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmlzQ3JlYXRpbmcgPSB0cnVlO1xyXG5cclxuICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdGluZyk7XHJcbiAgICB0aGlzLndzID0gbmV3IFdlYlNvY2tldChTb2NrZXQudXJsKTtcclxuICAgIGlmICh0aGlzLndzID09PSBudWxsKSB7XHJcbiAgICAgIHRoaXMubmV0d29ya0Vycm9yKCk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdEVycm9yLCB7J2RhdGEnOiAnU29ja2V0IOWIm+W7uuWksei0pSd9KTtcclxuICAgICAgS1FOYXRpdmVJbnZva2UuZm9yY2VFeGl0QXBwKCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuc29ja2V0RXJyb3IgPSBmYWxzZTtcclxuXHJcbiAgICAvLyBzb2NrZXQg6L+e5o6l5oiQ5YqfXHJcbiAgICB0aGlzLndzLm9ub3BlbiA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDov57mjqXmiJDlip/vvJpcIiwgZXZlbnQpO1xyXG4gICAgICBcclxuICAgICAgc2VsZi5fbGFzdFJlY2VpdmVNc2dUaW1lID0gY2Muc3lzLm5vdygpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RTdWNjZXNzZWQsIGV2ZW50KTtcclxuXHJcbiAgICAgIHNlbGYuaXNDcmVhdGluZyA9IGZhbHNlO1xyXG4gICAgICBzZWxmLnNvY2tldEVycm9yID0gZmFsc2U7XHJcbiAgICAgIHNlbGYuY3JlYXRlSW5kZXggPSAwO1xyXG4gICAgICBzZWxmLmNvbm5lY3Rpb25TdWNjZXNzKCk7XHJcbiAgICAgIHNlbGYuc2VuZFJlY29ubmVjdEluZm8oKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gc29ja2V0IOaOpeaUtuWIsOa2iOaBr1xyXG4gICAgdGhpcy53cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgc2VsZi5fbGFzdFJlY2VpdmVNc2dUaW1lID0gY2Muc3lzLm5vdygpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldFJlY2VpdmVNZXNzYWdlLCBldmVudC5kYXRhKTtcclxuXHJcbiAgICAgIHNlbGYuaXNDcmVhdGluZyA9IGZhbHNlO1xyXG4gICAgICBzZWxmLnNvY2tldEVycm9yID0gZmFsc2U7XHJcbiAgICAgIHNlbGYucmVjZXZpY2VNZXNzYWdlKGV2ZW50LmRhdGEpO1xyXG4gICAgICBzZWxmLl9kaXNwYXRjaFJlc3BvbnNlKGV2ZW50LmRhdGEpO1xyXG4gICAgICBzZWxmLnJlY3ZUaW1lID0gRGF0ZS5ub3coKTsgLy/mjqXmlLbmnIDmlrDkuIDmnaHkv6Hmga/nmoTml7bpl7RcclxuXHJcbiAgICAgIC8qKi9cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBzb2NrZXQg5Y+R55Sf6ZSZ6K+vXHJcbiAgICAgKiBcclxuICAgICAqIHNvY2tldCDmnKzouqvmnIkgYG9uZXJyb3JgIOWbnuiwg++8jOS9huS6i+WunuivgeaYju+8jOWFtuS4jemdoOiwse+8jFxyXG4gICAgICog5pyJ5b6I5aSn55qE5py6546H5pyJ6K+v5oql55qE6KGM5Li677yM5bi45bi45Zyo5rKh5pyJ6ZSZ6K+v5pe277yM5Lya57uZ6ZSZ6K+v5Zue6LCD44CCXHJcbiAgICAgKiDkuJTkuI3og73lrprliLbotoXml7bml7bplb9cclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2UgXHJcbiAgICAgKi9cclxuICAgIHRoaXMud3MuX2txX29uZXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xyXG4gICAgICBjYy5lcnJvcihgV2ViU29ja2V0IOi/nuaOpemUmeivr++8miR7bWVzc2FnZX1gKTtcclxuXHJcbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdEVycm9yLCB7ZGF0YTogbWVzc2FnZX0pO1xyXG4gICAgICBzZWxmLndzLmNsb3NlKCk7XHJcbiAgICAgIGlmICghc2VsZi53cykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g6Jm954S26LCD55So5LqGIHdlYnNvY2tldCDnmoQgY2xvc2Ug5pa55rOV77yM5L2G5pivXHJcbiAgICAgIC8vIOWug+W5tuS8mueri+WNs+iwg+eUqCBvbmNsb3NlIOWbnuiwg++8jOiAjOaYr+WcqOacquadpeeahOafkFxyXG4gICAgICAvLyDkuIDml7bpl7Tlho3lm57osIMgb25jbG9zZe+8m+S9hui/memHjOaYjuaYvuWPr+S7peebtOaOpeWbnuiwg+S6huOAglxyXG4gICAgICBsZXQgd3MgPSBzZWxmLndzO1xyXG5cclxuICAgICAgc2VsZi53cy5vbmNsb3NlKCk7XHJcbiAgICAgIHdzLm9uY2xvc2UgPSBmdW5jdGlvbigpe307XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIHNvY2tlIOW3suWFs+mXrVxyXG4gICAgdGhpcy53cy5vbmNsb3NlID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgIC8vY2MubG9nKCdXZWJTb2NrZXQg5bey5YWz6ZetIGNsb3NlIHRpbWU9JyArIERhdGUubm93KCkgKyBcIiBldmVudDogXCIgKyBldmVudCk7XHJcblxyXG5cclxuICAgICAgc2VsZi5pc0NyZWF0aW5nID0gZmFsc2U7XHJcbiAgICAgIHNlbGYuc29ja2V0RXJyb3IgPSB0cnVlO1xyXG4gICAgICBzZWxmLndzID0gbnVsbDtcclxuICAgICAgc2VsZi5jb25uZWN0aW9uRGlzY29ubmVjdCgpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldERpc2Nvbm5lY3QsIGV2ZW50KTtcclxuICAgICAgLy9jYy5sb2coJ3NvY2tldCBjbG9zZScrSlNPTi5zdHJpbmdpZnkoZXZlbnQpKTtcclxuICAgIH07XHJcbiAgfSxcclxuXHJcbiAgcmVjb25uZWN0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGlmICghc2VsZi5pc0NyZWF0aW5nICYmIHNlbGYuc29ja2V0RXJyb3IpIHtcclxuICAgICAgICBzZWxmLmNyZWF0ZVNvY2tldCgpO1xyXG4gICAgICB9XHJcbiAgICB9LCAyKTtcclxuICB9LFxyXG5cclxuICBzZW5kUmVjb25uZWN0SW5mbzogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAodGhpcy51c2VySW5mbyAhPSBudWxsKSB7XHJcbiAgICAgICAgdmFyIHVzZXJJZCA9IHNlbGYudXNlckluZm8udXNlcl9pZCB8fCBzZWxmLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIHNlbGYuc2VuZE1lc3NhZ2UoJ3JlY29ubmVjdCcsIHtcclxuICAgICAgICAgICd1c2VySWQnOiB1c2VySWRcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSwgMSk7XHJcbiAgfSxcclxuXHJcbiAgcmVjZXZpY2VNZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuXHJcbiAgfSxcclxuXHJcbiAgY29ubmVjdGlvbkRpc2Nvbm5lY3Q6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgfSxcclxuXHJcbiAgY29ubmVjdGlvblN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgfSxcclxuXHJcbiAgbmV0d29ya0Vycm9yOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIGNoZWNrTmV0d29ya1N0YXJ0OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIGNoZWNrTmV0d29ya0VuZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICB9LFxyXG5cclxuICBfZGlzcGF0Y2hSZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlU3RyaW5nKSB7XHJcbiAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDmjqXmlLbliLDmnI3liqHlmajmtojmga/vvJpcIiwgcmVzcG9uc2VTdHJpbmcpO1xyXG4gICAgbGV0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShyZXNwb25zZVN0cmluZyk7XHJcbiAgICBsZXQgYWN0aW9uID0gcmVzcG9uc2VbXCJhY3Rpb25cIl07XHJcbiAgICBpZiAoYWN0aW9uKSB7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChhY3Rpb24sIHJlc3BvbnNlKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICAvLyBNQVJLOiDliY3lkI7lj7Dmk43kvZxcclxuICBfcmVnaXN0ZXJBcHBBY3RpdmVDaGFuZ2U6IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vY2MubG9nKFwiV2ViU29ja2V0IOazqOWGjOW6lOeUqOi/m+WFpeWJjeOAgeWQjuWPsOS6i+S7tlwiKTtcclxuICAgIGNjLmdhbWUub24oY2MuZ2FtZS5FVkVOVF9ISURFLCB0aGlzLl9hcHBFbnRlckJhY2tncm91bmQsIHRoaXMpO1xyXG4gICAgY2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX1NIT1csIHRoaXMuX2FwcEJlY29tQWN0aXZlLCB0aGlzKTtcclxuICB9LFxyXG5cclxuICAvKipcclxuICAgKiDov5vlhaXlkI7lj7BcclxuICAgKi9cclxuICBfYXBwRW50ZXJCYWNrZ3JvdW5kOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xyXG4gICAgaWYgKG5vdyAtIHRoaXMuX2xhc3RBcHBFbnRlckJhY2tncm91bmRUaW1lIDwgMTAwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuX2xhc3RBcHBFbnRlckJhY2tncm91bmRUaW1lID0gbm93O1xyXG4gICAgXHJcbiAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDmo4DmtYvliLDlupTnlKjov5vlhaXlkI7lj7DvvJpcIiwgbmV3IERhdGUoKSk7XHJcbiAgICBsZXQgaWQgPSB0aGlzLnVzZXJJbmZvID8gdGhpcy51c2VySW5mby5pZCA6IHVuZGVmaW5lZDtcclxuICAgIFNvY2tldC5zZW5kQXBwUGF1c2UoaWQpO1xyXG4gICAgdGhpcy5fY2FuY2VsQ2hlY2tTb2NrZXQoKTtcclxuICB9LFxyXG5cclxuICAvKipcclxuICAgKiDov5vlhaXliY3lj7AgXHJcbiAgICovXHJcbiAgX2FwcEJlY29tQWN0aXZlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xyXG4gICAgaWYgKG5vdyAtIHRoaXMuX2xhc3RBcHBCZWNvbUFjdGl2ZVRpbWUgPCAxMDApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fbGFzdEFwcEJlY29tQWN0aXZlVGltZSA9IG5vdztcclxuXHJcbiAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDmo4DmtYvliLDlupTnlKjov5vlhaXliY3lj7DvvJpcIiwgbmV3IERhdGUoKSk7XHJcbiAgICBsZXQgaWQgPSB0aGlzLnVzZXJJbmZvID8gdGhpcy51c2VySW5mby5pZCA6IHVuZGVmaW5lZDtcclxuICAgIFNvY2tldC5zZW5kQXBwQWN0aXZlKGlkKTtcclxuICAgIHRoaXMuX2NoZWNrU29ja2V0KCk7XHJcblxyXG4gICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgIHRoaXMuX2NoZWNrU29ja2V0RXhlY3V0ZSgpO1xyXG4gICAgfS5iaW5kKHRoaXMpLCAxLjUpO1xyXG4gIH0sXHJcblxyXG4gIC8v6L+b5YWl5ZCO5Y+w5pON5L2cXHJcbiAgZW50ZXJiYWNrZ3JvdWRBY3Rpb246IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuX2FwcEVudGVyQmFja2dyb3VuZCgpO1xyXG4gIH0sXHJcblxyXG4gIC8v6L+b5YWl5YmN5Y+w5pON5L2cXHJcbiAgcmVzdW1lQWN0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAvL+ajgOafpee9kee7nFxyXG4gICAgdGhpcy5fY2hlY2tOZXR3b3JrKCk7XHJcbiAgICB0aGlzLl9hcHBCZWNvbUFjdGl2ZSgpO1xyXG4gIH0sXHJcblxyXG4gIHNlbmRNZXNzYWdlOiBmdW5jdGlvbiAoYWN0aW9uLCBkYXRhKSB7XHJcbiAgICBkYXRhID0gdGhpcy5fc3Ryb25nVmVyaWZ5RGF0YShkYXRhKTtcclxuXHJcbiAgICBpZiAodGhpcy5zb2NrZXRFcnJvcikge1xyXG4gICAgICBjYy5lcnJvcihcInNvY2tldCDov57mjqXplJnor6/vvJpcIiArIHRoaXMuc29ja2V0RXJyb3IpO1xyXG4gICAgICB0aGlzLnJlY29ubmVjdCgpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICAvL2NjLmxvZygnV2ViU29ja2V0IOWPkemAgea2iOaBr++8micgKyBhY3Rpb24sIGRhdGEpO1xyXG4gICAgaWYgKGNjLnN5cy5pc09iamVjdFZhbGlkKHRoaXMud3MpKSB7XHJcbiAgICAgIGlmICh0aGlzLndzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7XHJcbiAgICAgICAgdGhpcy53cy5zZW5kKHRoaXMuX2NvbnZlcnRQYXJhbWV0ZXJUb1N0cmluZyhhY3Rpb24sIGRhdGEpKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5jb25uZWN0aW9uRGlzY29ubmVjdCgpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIF9zdHJvbmdWZXJpZnlEYXRhOiBmdW5jdGlvbihkYXRhID0ge30pIHtcclxuICAgIGlmICgodHlwZW9mIGRhdGEpID09ICdzdHJpbmcnKSB7XHJcbiAgICAgIGRhdGEgPSB7XCJzdHJpbmdcIjogZGF0YX07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGRhdGEgPT0gbnVsbCkge1xyXG4gICAgICBkYXRhID0ge307XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFkYXRhW1widXNlcklkXCJdKSB7XHJcbiAgICAgIGlmICh0aGlzLnVzZXJJbmZvICYmICh0eXBlb2YgdGhpcy51c2VySW5mbykgPT0gJ29iamVjdCcgJiYgdGhpcy51c2VySW5mby5pZCkge1xyXG4gICAgICAgIGRhdGFbXCJ1c2VySWRcIl0gPSB0aGlzLnVzZXJJbmZvLmlkO1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGE7XHJcbiAgfSxcclxuXHJcbiAgX2NvbnZlcnRQYXJhbWV0ZXJUb1N0cmluZzogZnVuY3Rpb24gKGFjdGlvbiwgZGF0YSA9IHt9KSB7XHJcbiAgICB2YXIgb2JqID0ge307XHJcbiAgICBvYmouYWN0aW9uID0gYWN0aW9uO1xyXG4gICAgb2JqLmRhdGEgPSBkYXRhO1xyXG4gICAgXHJcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqKTtcclxuICB9LFxyXG5cclxuICAvLyDmo4Dmn6XnvZHnu5xcclxuICBfY2hlY2tOZXR3b3JrOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAodGhpcy5jaGVja05ldHdvcmtOb3cpIHtcclxuICAgICAgdGhpcy5jaGVja05ldHdvcmtOb3coKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnNob3VsZENoZWNrID0gdHJ1ZTtcclxuICAgIGlmICghdGhpcy5zb2NrZXRFcnJvcikge1xyXG4gICAgICB0aGlzLnJlY3ZUaW1lID0gMDtcclxuICAgICAgdGhpcy5zZW5kTWVzc2FnZSgnY2hlY2tBY3Rpb24nLCAnJyk7XHJcbiAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmNoZWNrTmV0d29ya0VuZCgpO1xyXG4gICAgICAgIHRoaXMuc2hvdWxkQ2hlY2sgPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5yZWN2VGltZSA9PT0gMCkge1xyXG4gICAgICAgICAgdGhpcy5jb25uZWN0aW9uRGlzY29ubmVjdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgMi41KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuY29ubmVjdGlvbkRpc2Nvbm5lY3QoKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICAvLyBNQVJLOiBzb2NrZXQg5o6J57q/5bC95pep56Gu6K6kXHJcbiAgX2NoZWNrU29ja2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLnNjaGVkdWxlKHRoaXMuX2NoZWNrU29ja2V0RXhlY3V0ZSwgU29ja2V0Q29uc3RhbnQuTWF4UmVjb25uZWN0Q2hlY2tJbnRlcnZhbCwgY2MubWFjcm8uUkVQRUFUX0ZPUkVWRVIpO1xyXG4gIH0sXHJcblxyXG4gIF9jYW5jZWxDaGVja1NvY2tldDogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuX2NoZWNrU29ja2V0RXhlY3V0ZSk7XHJcbiAgfSxcclxuXHJcbiAgX2NoZWNrU29ja2V0RXhlY3V0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzU29ja2V0VGltZW91dCgpICYmIHRoaXMud3MpIHtcclxuICAgICAgdGhpcy53cy5fa3Ffb25lcnJvcign6L+e5o6l6LaF5pe2Jyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICAvLyBzb2NrZXQg5piv5ZCm5bey6LaF5pe2XHJcbiAgX2lzU29ja2V0VGltZW91dDogZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xhc3RSZWNlaXZlTWVzc2FnZUludGVydmFsKCkgPj0gdGhpcy5fdGltZW91dDtcclxuICB9LFxyXG5cclxuICAvLyDkuIrkuIDmrKHmlLbliLDmtojmga/liLDnjrDlnKjnmoTml7bpl7Tpl7TpmpRcclxuICBfbGFzdFJlY2VpdmVNZXNzYWdlSW50ZXJ2YWw6IGZ1bmN0aW9uICgpIHtcclxuICAgIGxldCBub3cgPSBjYy5zeXMubm93KCk7XHJcbiAgICBsZXQgaW50ZXJ2YWwgPSAobm93IC0gdGhpcy5fbGFzdFJlY2VpdmVNc2dUaW1lKSAvIDEwMDA7XHJcbiAgICAvL2NjLmxvZyhgV2ViU29ja2V0IOeOsOWcqOi3neS4iuS4gOadoeaUtuWIsOa2iOaBr+eahOaXtumXtOmXtOmalOaYr++8miR7aW50ZXJ2YWx9IOenkmApO1xyXG4gICAgcmV0dXJuIGludGVydmFsO1xyXG4gIH0sXHJcblxyXG59KTtcclxuXHJcbi8vIE1BUks6IFNvY2tldCDkuovku7blrprkuYlcclxuU29ja2V0LkV2ZW50ID0ge1xyXG4gIFNvY2tldENvbm5lY3Rpbmc6IFwiU29ja2V0Q29ubmVjdGluZ1wiLCAgICAgICAgICAgICAvLyBTb2NrZXQg5q2j5Zyo6L+e5o6lXHJcbiAgU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZDogXCJTb2NrZXRDb25uZWN0U3VjY2Vzc2VkXCIsIC8vIOi/nuaOpeaIkOWKn1xyXG4gIFNvY2tldERpc2Nvbm5lY3Q6IFwiU29ja2V0RGlzY29ubmVjdFwiLCAgICAgICAgIC8vIFNvY2tldCDmlq3lvIDov57mjqVcclxuICBTb2NrZXRDb25uZWN0RXJyb3I6IFwiU29ja2V0Q29ubmVjdEVycm9yXCIsICAgICAvLyBTb2NrZXQg6L+e5o6l6ZSZ6K+vXHJcbiAgU29ja2V0UmVjZWl2ZU1lc3NhZ2U6IFwiU29ja2V0UmVjZWl2ZU1lc3NhZ2VcIiwgLy8gU29ja2V0IOaOpeaUtuWIsOa2iOaBr1xyXG5cclxuICBMb2dpbkpvaW46XCJsb2dpbkpvaW5cIiwgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBIOS7jueZu+mZhueVjOmdouiOt+WPluaIv+mXtOWPt+i/m+WFpea4uOaIj1xyXG4gIFJlY29yZElkOlwicmVjb3JkSWRcIiwgICAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgIFxyXG4gIE9uY2VBZ2FpbjpcIm9uY2VBZ2FpblwiLCAgICAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSAgXHJcbiAgQmVpTHY6IFwiYmVpTHZcIiwgICAgICAgICAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSAgXHJcbiAgSW52aXRlQ29kZTogXCJpbnZpdGVDb2RlXCIsICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSAgIOmCgOivt+eggVxyXG4gIEpvaW5EZXNrOiBcImpvaW5EZXNrXCIsICAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcclxuICBDcmVhdGVEZXNrOiBcImNyZWF0ZURlc2tcIiwgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXHJcbiAgTGVhdmVEZXNrOiBcImxlYXZlRGVza1wiLCAgICAgICAgICAgICAgIC8vIOemu+W8gOahjOWtkFxyXG4gIERpc3NvbHZlRGVzazogXCJkaXNzb2x2ZURlc2tcIiwgICAgICAgICAvLyDop6PmlaPmoYzlrZBcclxuICBBbnN3ZXJEaXNzb2x2ZTogXCJhbnN3ZXJEaXNzb2x2ZVwiLCAgICAgLy8g5Zue562U6K+35rGC6YCA5Ye65ZG95LukXHJcbiAgR2V0RGVza0luZm86IFwiZ2V0RGVza0luZm9cIiwgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxyXG4gIFNlbmRJbWFnZTogXCJzZW5kSW1hZ2VcIiwgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcclxuICBTZW5kVGV4dDogXCJzZW5kVGV4dFwiLCAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXHJcbiAgU2VuZEVtb2ppOiBcInNlbmRFbW9qaVwiLCAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxyXG4gIENoYW5nZUluZm86XCJjaGFuZ2VJbmZvXCIsICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcclxuICBTZW5kQXVkaW9NZXNzYWdlOiBcInNlbmRBdWRpb01lc3NhZ2VcIiwgLy8g5a6i5oi356uv5Y+R6YCBICDlj5HpgIHor63pn7Pmtojmga9cclxuICBHZXRSZWNvcmQ6IFwiZ2V0UmVjb3JkXCIsICAgICAgICAgICAgICAgLy8g6I635Y+W5oiY57up5L+h5oGvXHJcbiAgR2V0SXRlbVJlY29yZDogXCJnZXRJdGVtUmVjb3JkXCIsICAgICAgIC8vIOiOt+WPluaImOe7qeS/oeaBr1xyXG4gIFBsYXlDYXJkOiBcInBsYXlDYXJkXCIsICAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIHvvIznlKjmiLfmiZPlh7rniYxcclxuICBUaW1lb3V0RGlzc29sdmU6IFwidGltZW91dERpc3NvbHZlXCIsICAgLy8g6K+35rGC6YCA5Ye66LaF5pe25pe277yM6ZyA6KaB5Y+R5Ye655qE5raI5oGvXHJcbiAgRmVlZGJhY2s6IFwiZmVlZGJhY2tcIiwgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgIOWPjemmiOS/oeaBr1xyXG4gIFNoYXJlUG5nOiBcInNoYXJlUG5nXCIsICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBICDliIbkuqvpooblj5bnoJbnn7NcclxuICBFbnRlclJhbmRvbTogXCJpbnRlclJhbmRvbVwiLCAgIC8vIOWuouaIt+err+WPkemAgSAg6L+b5YWl6ZqP5py65Zy6XHJcbiAgQ2FuY2VsUmFuZG9tOiBcImNhbmNlbFJhbmRvbVwiLCAvLyDlrqLmiLfnq6/lj5HpgIEgIOWPlua2iOi/m+WFpemaj+acuuWculxyXG4gIEZvcmNlRXhpdFJhbmRvbTogXCJkaXNzb2x2ZVwiLCAgLy8g5a6i5oi356uv5Y+R6YCBIOW8uuWItumAgOWHuumaj+acuuWculxyXG4gIFJlYWR5OiBcInJlYWR5XCIsICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBIOWHhuWkh1xyXG4gIFN0YXJ0R2FtZTogXCJzdGFydEdhbWVcIiwgLy8g5a6i5oi356uv5Y+R6YCBIOW8gOWni+a4uOaIj1xyXG4gIEdldEhhbGxJbmZvOiBcImdldEhhbGxJbmZvXCIsICAgLy8g5a6i5oi356uv5Y+R6YCBIOiOt+WPluWkp+WOheS/oeaBr1xyXG4gIEdldFVzZXJJbmZvOiBcImdldFVzZXJJbmZvXCIsICAgLy8g5a6i5oi356uv5Y+R6YCBIOiOt+WPlueUqOaIt+S/oeaBr1xyXG4gIENoZWNrQWN0aW9uOiBcImNoZWNrQWN0aW9uXCIsICAgLy8g5a6i5oi356uv5Y+R6YCB77yM55So5p2l5qOA5rWL5LiO5pyN5Yqh5Zmo55qE6L+e6YCa5oCnXHJcbiAgUGF1c2U6IFwicGF1c2VcIiwgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/ov5vlhaXlkI7lj7Dml7bopoHlj5HpgIHnmoTmtojmga9cclxuICBBY3RpdmU6IFwiYWN0aXZlXCIsICAgICAgICAgICAgIC8vIOWuouaIt+err+WbnuWIsOWJjeWPsOaXtuimgeWPkemAgeeahOa2iOaBr1xyXG4gIFFpbmdsaTogXCJxaW5nbGlcIiwgICAgICAgICAgICAgLy8g5a6i5oi356uv5Zue5Yiw5YmN5Y+w5pe26KaB5Y+R6YCB55qE5raI5oGvXHJcblxyXG4gIFJlY2VpdmVSZXF1ZXN0RGlzc29sdmU6IFwicmVxdWVzdERpc3NvbHZlXCIsIC8vIOivt+axguino+aVo+ahjOWtkCDmnI3liqHlmajlj5HpgIFcclxuICBSZWNlaXZlUmVxdWVzdERpc3NvbHZlUmVzdWx0OiBcInJlcXVlc3REaXNzb2x2ZVJlc3VsdFwiLCAvLyDor7fmsYLop6PmlaPmoYzlrZDnu5PmnpxcclxuICBSZWNlaXZlQ2hhdFRleHQ6IFwic2VuZFRleHRcIiwgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXHJcbiAgUmVjZWl2ZUNoYXRFbW9qaTogXCJzZW5kRW1vamlcIiwgIC8vIOacjeWKoeWZqOWPkemAgVxyXG4gIFJlY2VpdmVEZXNrSW5mbzogXCJkZXNrSW5mb1wiLCAgICAvLyDmnI3liqHlmajlj5HpgIFcclxuICBSZWNlaXZlR2FtZU92ZXI6IFwiZ2FtZU92ZXJcIiwgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXHJcbiAgUmVjZWl2ZUZhUGFpOiBcImZhcGFpXCIsICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgVxyXG4gIFJlY2VpdmVTaGFyZVBuZzogXCJzaGFyZVBuZ3NcIiwgICAvLyDmnI3liqHlmajlj5HpgIFcclxuICBSZWNlaXZlT25saW5lU3RhdHVzOiBcInNlbmRPbmxpbmVTdGF0dXNcIiwgIC8vIOacjeWKoeWZqOWPkemAgVxyXG4gIFJlY2VpdmVPbkNoYW5nZUluZm86IFwiY2hhbmdlSW5mb1wiLCAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBXHJcbiAgUmVjZWl2ZUF1ZGlvTWVzc2FnZTogXCJzZW5kQXVkaW9NZXNzYWdlXCIsICAvLyDmnI3liqHlmajlj5HpgIHvvIzmjqXmlLbliLDnlKjmiLflj5HpgIHkuobor63pn7Pmtojmga9cclxuICBSZWNlaXZlUGxheUNhcmQ6IFwicGxheUNhcmRcIiwgICAgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOacieeUqOaIt+W3sue7j+WHhuWkh+WlveeJjFxyXG4gIFJlY2VpdmVDcmVhdGVEZXNrOiBcImNyZWF0ZURlc2tcIiwgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5Yib5bu65oi/6Ze055qE5Zue6LCDXHJcbiAgUmVjZWl2ZVJlYWR5OiBcInJlYWR5XCIsICAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmnInnlKjmiLfngrnlh7vkuoblh4blpIdcclxuICBSZWNlaXZlSGFsbEluZm86IFwiZ2V0SGFsbEluZm9cIiwgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgVxyXG4gIFJlY2VpdmVHZXRVc2VySW5mbzogXCJnZXRVc2VySW5mb1wiLCAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBIOiOt+WPlueUqOaIt+S/oeaBr1xyXG4gIFJlY2VpdmVDaGVja0FjdGlvbjogXCJjaGVja0FjdGlvblwiLCAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBICDnlKjmnaXnoa7orqQgU29ja2V0IOi/mOWcqOi/nuedgFxyXG4gIFJlY2VpdmVGb3JjZUV4aXQ6IFwiZm9yY2VFeGl0XCIsICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBICDnlKjmnaXkvb/lrqLmiLfnq6/lvLrpgIBcclxuICBSZWNlaXZlRGlzc29sdmVEZXNrOiBcImRpc3NvbHZlRGVza1wiLCAgICAgIC8vIOacjeWKoeWZqOWPkemAgSAgIOW9k+aIv+S4u+mAgOWHuuaXtu+8jOino+aVo+ahjOWtkFxyXG4gIFJlY2VpdmVJbnRlclJhbmRvbTogXCJpbnRlclJhbmRvbVwiLCAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBICAg6L+b5YWl6ZqP5py65Zy655qE5Y+N6aaIXHJcbiAgUmVjZWl2ZVBhdXNlOiBcInBhdXNlXCIsICAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIEgICDlvZPmnInnlKjmiLforr7lpIfov5vlhaXlkI7lj7Dml7bvvIzkvJrmlLbliLDov5nmnaHmtojmga9cclxuICBSZWNlaXZlSW52aXRlQ29kZTogJ2ludml0ZUNvZGUnLCAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDpgoDor7fnoIHnmoTmtojmga9cclxuICBSZWNlaXZlTGVhdmVEZXNrOiAnbGVhdmVEZXNrJywgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDpnIDopoHnprvlvIDmoYzlrZDnmoTmtojmga9cclxuICBSZWNlaXZlU2VsZWN0QmVpTHY6ICdzZWxlY3RCZWlMdicsICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDpgInmi6nlgI3njofnmoTmtojmga9cclxuICBSZWNlaXZlQmVpTHY6J2JlaUx2JywgICAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDlgI3njofnmoTmtojmga9cclxuICBSZWNlaXZlUWluZ0xpOidxaW5nbGknLCAgICAgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDor7fnprtcclxuICBSZWNlaXZlUmVjb3JkSWQ6J3JlY29yZElkJywgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDmiJjnu6nkv6Hmga9cclxuICBSZWNlaXZlTG9naW5Kb2luOidsb2dpbkpvaW4nLCAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDku47pobXpnaLov5vlhaXmiL/pl7Tkv6Hmga9cclxuICBSZWNlaXZlT25jZUFnYWluOidvbmNlQWdhaW4nLCAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDlho3mnaXkuIDlsYDkv6Hmga9cclxuICBSZWNlaXZlTm9VaW9uaWQ6J25vVWlvbmlkJywgICAgICAgICAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pS25Yiw5rKh5pyJdW5pb25JROS/oeWPt1xyXG59O1xyXG5cclxuXHJcbi8vIE1BUks6IFNvY2tldCDmj5DkvpvnmoTlj6/lj5Hnu5nmnI3liqHlmajmtojmga/nmoTmlrnms5VcclxuXHJcblNvY2tldC5zZW5kQ2hlY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ2hlY2tBY3Rpb24sIG51bGwpO1xyXG59O1xyXG4vKiovXHJcblNvY2tldC5zZW5kRGlkUmVjZWl2ZUdhbWVPdmVyQWN0aW9uID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gIGNvbnN0IHBhcmFtID0gdXNlcklkID8ge1widXNlcklkXCI6IHVzZXJJZH0gOiBudWxsO1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UoU29ja2V0LkV2ZW50LkRpZFJlY2VpdmVHYW1lT3ZlckFjdGlvbiwgcGFyYW0pO1xyXG59O1xyXG4vKiovXHJcblxyXG5cclxuLyoqXHJcbiAqIOW9kyBBUFAg6L+b5YWl5ZCO5Y+w5pe26KaB5Y+R6YCB55qE5raI5oGvXHJcbiAqL1xyXG5Tb2NrZXQuc2VuZEFwcFBhdXNlID0gZnVuY3Rpb24odXNlcklkKSB7XHJcbiAgbGV0IHBhcmFtID0gdXNlcklkID8ge1widXNlcklkXCI6IHVzZXJJZH0gOiBudWxsO1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5QYXVzZSwgcGFyYW0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIOW9kyBBUFAg6L+b5YWl5YmN5Y+w5pe25Y+R6YCB55qE5raI5oGvXHJcbiAqL1xyXG5Tb2NrZXQuc2VuZEFwcEFjdGl2ZSA9IGZ1bmN0aW9uKHVzZXJJZCkge1xyXG4gIGxldCBwYXJhbSA9IHVzZXJJZCA/IHtcInVzZXJJZFwiOiB1c2VySWR9IDogbnVsbDtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQWN0aXZlLCBwYXJhbSk7XHJcbn07XHJcblxyXG4vLyDlvIDmiL9cclxuU29ja2V0LnNlbmRDcmVhdGVEZXNrID0gZnVuY3Rpb24gKGNyZWF0ZURlc2NJbmZvLCB1c2VySWQpIHtcclxuICBjYy5hc3NlcnQoY3JlYXRlRGVzY0luZm8pO1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG5cclxuICBjcmVhdGVEZXNjSW5mb1tcInVzZXJJZFwiXSA9IHVzZXJJZDtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ3JlYXRlRGVzaywgY3JlYXRlRGVzY0luZm8pO1xyXG59O1xyXG5cclxuU29ja2V0LnNlbmRRaW5nbGkgPSBmdW5jdGlvbihsZWF2ZUlkLHVzZXJJZCl7XHJcbiBsZXQgcGFyYW0gPSB7XHJcbiAgICBcImxlYXZlSWRcIjogbGVhdmVJZCxcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5RaW5nbGksIHBhcmFtKTtcclxufTtcclxuLy8g5LuO55m76ZmG6aG16Z2i5Yqg5YWl5oi/6Ze0XHJcblNvY2tldC5zZW5kTG9naW5Kb2luID0gZnVuY3Rpb24gKHJvb21JZCwgdXNlcklkKSB7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJyb29tSWRcIjogcm9vbUlkLFxyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gIH07XHJcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkxvZ2luSm9pbiwgcGFyYW0pO1xyXG59O1xyXG4vLyDlho3mnaXkuIDlsYBcclxuU29ja2V0LnNlbmRPbmNlQWdhaW4gPSBmdW5jdGlvbiAoYWdhaW4sdXNlcklkKSB7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gICAgXCJhZ2FpblwiOmFnYWluLFxyXG4gIH07XHJcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50Lk9uY2VBZ2FpbiwgcGFyYW0pO1xyXG59O1xyXG4vLyDliqDlhaXmiL/pl7RcclxuU29ja2V0LnNlbmRKb2luRGVzayA9IGZ1bmN0aW9uIChyb29tSWQsIHVzZXJJZCkge1xyXG4gIGNjLmFzc2VydChyb29tSWQpO1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG5cclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInJvb21JZFwiOiByb29tSWQsXHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuSm9pbkRlc2ssIHBhcmFtKTtcclxufTtcclxuLy8g5ZCR5pyN5Yqh56uv5Y+R6YCB5oiR6YCJ5oup55qE5YCN546HXHJcblNvY2tldC5zZW5kQmVpTHYgPSBmdW5jdGlvbihiZWlsdix1c2VySWQpe1xyXG4gIGxldCBwYXJhbSA9IHtcclxuICAgIFwiYmVpbHZcIjogYmVpbHYsXHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQmVpTHYsIHBhcmFtKTtcclxufTtcclxuLy8g5Y+R6YCB6YKA6K+356CBXHJcblNvY2tldC5zZW5kSW52aXRlQ29kZSA9IGZ1bmN0aW9uKGludml0ZUNvZGUsdXNlcklkKXtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcImludml0ZUNvZGVcIjogaW52aXRlQ29kZSxcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5JbnZpdGVDb2RlLCBwYXJhbSk7XHJcbn07XHJcblxyXG4vLyDojrflj5bmiL/pl7Tkv6Hmga9cclxuU29ja2V0LnNlbmRHZXREZXNja0luZm8gPSBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gIH07XHJcblxyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXREZXNrSW5mbywgcGFyYW0pO1xyXG59O1xyXG5cclxuU29ja2V0LnNlbmRUZXh0ID0gZnVuY3Rpb24gKHVzZXJJZCwgdGV4dCkge1xyXG4gIC8vY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgLy9jYy5hc3NlcnQodGV4dCk7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJtc2dcIjogdGV4dCxcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TZW5kVGV4dCwgcGFyYW0pO1xyXG59O1xyXG5Tb2NrZXQuc2VuZEVtb2ppID0gZnVuY3Rpb24odXNlcklkLGVtb2ppKXtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcImVtb2ppXCI6IGVtb2ppLFxyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gIH07XHJcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlNlbmRFbW9qaSwgcGFyYW0pO1xyXG59O1xyXG5Tb2NrZXQuc2VuZENoYW5nZUluZm8gPSBmdW5jdGlvbih1c2VySWQsSW5mbyl7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJjaGFuZ2VJbmZvXCI6IEluZm8sXHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ2hhbmdlSW5mbywgcGFyYW0pO1xyXG59O1xyXG5Tb2NrZXQuc2VuZEF1ZGlvTWVzc2FnZSA9IGZ1bmN0aW9uICh1c2VySWQsIHVybCA9IFwiXCIpIHtcclxuICBjYy5hc3NlcnQodXNlcklkKTtcclxuICBjYy5hc3NlcnQodXJsLmxlbmd0aCA+IDApO1xyXG5cclxuICBpZiAodXJsLmxlbmd0aCA9PSAwKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInVybFwiOiB1cmwsXHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU2VuZEF1ZGlvTWVzc2FnZSwgcGFyYW0pO1xyXG59O1xyXG5cclxuU29ja2V0LnNlbmRJbWFnZSA9IGZ1bmN0aW9uICh1c2VySWQsIGltYWdlKSB7XHJcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgY2MuYXNzZXJ0KGltYWdlKTtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcIm1zZ1wiOiBpbWFnZSxcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TZW5kSW1hZ2UsIHBhcmFtKTtcclxufTtcclxuXHJcblNvY2tldC5zZW5kR2V0UmVjcm9kID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gIGxldCBwYXJhbSA9IHtcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXRSZWNvcmQsIHBhcmFtKTtcclxufTtcclxuXHJcblNvY2tldC5zZW5kR2V0UmVjcm9kRnJvbUlkID0gZnVuY3Rpb24ocmVjb3JkSWQpe1xyXG4gIGxldCBwYXJhbSA9IHtcclxuICAgIFwicmVjb3JkSWRcIjpyZWNvcmRJZCxcclxuICB9O1xyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5SZWNvcmRJZCxwYXJhbSk7XHJcbn07XHJcblxyXG5Tb2NrZXQuc2VuZERpc3NvbHZlRGVzayA9IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICBjYy5hc3NlcnQodXNlcklkKTtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuRGlzc29sdmVEZXNrLCBwYXJhbSk7XHJcbn07XHJcblxyXG5Tb2NrZXQuc2VuZEdldEl0ZW1SZWNvcmQgPSBmdW5jdGlvbiAodXNlcklkLCBwYXJlbnRJZCkge1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gIGNjLmFzc2VydChwYXJlbnRJZCk7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gICAgXCJwYXJlbnRJZFwiOiBwYXJlbnRJZCxcclxuICB9O1xyXG5cclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuR2V0SXRlbVJlY29yZCwgcGFyYW0pO1xyXG59O1xyXG5cclxuU29ja2V0LnNlbmRMZWF2ZURlc2sgPSBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICBjYy5hc3NlcnQodXNlcklkKTtcclxuICAgIGxldCBwYXJhbSA9IHtcclxuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuTGVhdmVEZXNrLCBwYXJhbSk7XHJcbn0sXHJcblxyXG4vKipcclxuICog5Zue562U6YCA5oi/6K+35rGCXHJcbiAqIFxyXG4gKiBAcGFyYW0gIHtOdW1iZXJ9IHVzZXJJZCDlvZPliY3nlKjmiLcgaWRcclxuICogQHBhcmFtICB7TlVtYmVyfSBhbnN3ZXI9MSDlm57nrZTjgIIxIOihqOekuuWQjOaEj++8myAwIOihqOekuuaLkue7ne+8myAtMSDooajnpLrmnKrpgInmi6lcclxuICovXHJcblNvY2tldC5zZW5kQW5zd2VyRGlzc29sdmUgPSBmdW5jdGlvbiAodXNlcklkLCBhbnN3ZXIgPSAwKSB7XHJcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gICAgXCJhbnN3ZXJcIjogYW5zd2VyXHJcbiAgfTtcclxuXHJcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkFuc3dlckRpc3NvbHZlLCBwYXJhbSk7XHJcbn0sXHJcblxyXG4gIFNvY2tldC5zZW5kRm9yY2VFeGl0Um9vbSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gICAgbGV0IHBhcmFtID0ge1xyXG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5EaXNzb2x2ZURlc2ssIHBhcmFtKTtcclxuICB9LFxyXG5cclxuICAvLyDljYHkuInlvKDkuK1cclxuICAvLyBjYXJkSW5mbyDnsbvkvLzkuo7vvJpcclxuICAvLyBbe1xyXG4gIC8vICAgICAgICAgJ2NhcmRzJzpbeydzdWl0JzpzdWl0LCdudW1iZXInOm51bWJlcn0se31dLC8v54m55q6K54mM5LiN55So5LygXHJcbiAgLy8gICAgICAgICAndHlwZSc6MCxcclxuICAvLyAgICAgICAgICd2YWx1ZSc6NCxcclxuICAvLyAgICAgICAgICdpc0NvbnRhaW5FeHRyYSc6dHJ1ZSwvLyDnibnmrorniYzmmK/lkKbljIXlkKvnibnmrorniYxcclxuICAvLyAgICAgfSxcclxuICAvLyAgICAge1xyXG4gIC8vICAgICAgICAgJ2NhcmRzJzpbeydzdWl0JzpzdWl0LCdudW1iZXInOm51bWJlcn0se31dLFxyXG4gIC8vICAgICAgICAgJ3R5cGUnOjAsXHJcbiAgLy8gICAgICAgICAndmFsdWUnOjRcclxuICAvLyAgICAgfV1cclxuU29ja2V0LnNlbmRQbGF5Q2FyZCA9IGZ1bmN0aW9uICh1c2VySWQsIGNhcmRJbmZvKSB7XHJcbiAgICBjYy5hc3NlcnQodXNlcklkKTtcclxuICAgIGxldCBwYXJhbSA9IHtcclxuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gICAgICBcImNhcmRcIjogY2FyZEluZm9cclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlBsYXlDYXJkLCBwYXJhbSk7XHJcbn07XHJcblxyXG5Tb2NrZXQuc2VuZFRpbWVvdXREaXNzb2x2ZSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICBjYy5hc3NlcnQodXNlcklkKTtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuXHJcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlRpbWVvdXREaXNzb2x2ZSwgcGFyYW0pO1xyXG59O1xyXG5cclxuU29ja2V0LnNlbmRGZWVkYmFjayA9IGZ1bmN0aW9uICh1c2VySWQsIHRleHQpIHtcclxuICBjYy5hc3NlcnQodXNlcklkKTtcclxuICBjYy5hc3NlcnQodGV4dCk7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gICAgXCJ0ZXh0XCI6IHRleHRcclxuICB9O1xyXG5cclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuRmVlZGJhY2ssIHBhcmFtKTtcclxufVxyXG5cclxuU29ja2V0LnNlbmRTaGFyZVBuZyA9IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICBjYy5hc3NlcnQodXNlcklkKTtcclxuICBsZXQgcGFyYW0gPSB7XHJcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgfTtcclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU2hhcmVQbmcsIHBhcmFtKTtcclxufTtcclxuLy8g5byA5aeL5Yy56YWN6ZqP5py65Zy6XHJcblNvY2tldC5zZW5kRW50ZXJSYW5kb20gPSBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgbGV0IHBhcmFtID0ge1xyXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gIH07XHJcblxyXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5FbnRlclJhbmRvbSwgcGFyYW0pO1xyXG59O1xyXG5cclxuLy8g5Y+W5raI5Yy56YWN6ZqP5py65Zy6XHJcblNvY2tldC5zZW5kQ2FuY2VsUmFuZG9tID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gIGxldCBwYXJhbSA9IHtcclxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcclxuICB9O1xyXG5cclxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ2FuY2VsUmFuZG9tLCBwYXJhbSk7XHJcbn07XHJcblxyXG4vLyDlh4blpIdcclxuU29ja2V0LnNlbmRSZWFkeSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgIGNjLmFzc2VydCh1c2VySWQpO1xyXG4gICAgbGV0IHBhcmFtID0ge1xyXG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5SZWFkeSwgcGFyYW0pO1xyXG4gIH0sXHJcbiAgICBTb2NrZXQuc2VuZFN0YXJ0R2FtZSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgY2MuYXNzZXJ0KHVzZXJJZCk7XHJcbiAgICAgIGxldCBwYXJhbSA9IHtcclxuICAgICAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgICAgIH07XHJcbiAgICAgIGNjLmxvZyh0aGlzLkV2ZW50LlN0YXJ0R2FtZSlcclxuICAgICAgY2MubG9nKClcclxuICAgICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlN0YXJ0R2FtZSwgcGFyYW0pO1xyXG4gICAgfSxcclxuXHJcbi8vIOiOt+WPluWkp+WOheS/oeaBr1xyXG5Tb2NrZXQuc2VuZEdldEhhbGxJbmZvID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgbGV0IHBhcmFtID0ge1xyXG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXRIYWxsSW5mbywgcGFyYW0pO1xyXG59LFxyXG5cclxuLy8g6I635Y+W55So5oi35L+h5oGvXHJcblNvY2tldC5zZW5kR2V0VXNlckluZm8gPSBmdW5jdGlvbiAodXNlcklkLCBvcGVuSWQpIHtcclxuICAgIGxldCBwYXJhbSA9IHtcclxuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxyXG4gICAgICBcIm9wZW5JZFwiOiBvcGVuSWQsXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXRVc2VySW5mbywgcGFyYW0pO1xyXG59LFxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBTb2NrZXQ7IiwidGhpcy5fY2hhbmdlQ2FyZFNjb3JzID0gZnVuY3Rpb24oY2FyZE1vZGVsKSB7XHJcblxyXG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge2NhcmQuc2NvcmVzID0gY2FyZC5udW1iZXI7fSk7XHJcblxyXG4gICAgY2FyZE1vZGVsID0gdGhpcy5fY29udmVydE9uZVRvQShjYXJkTW9kZWwpO1xyXG5cclxuICAgIHZhciBpczE0ID0gdHJ1ZTsvL+aYr0EgSyBRIEogMTAgO1xyXG5cclxuICAgIHZhciBpczEgPSB0cnVlOy8v5pivMSAyIDMgNCA1XHJcblxyXG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge2lmIChjYXJkLnNjb3JlcyA8IDEwKSBpczE0ID0gZmFsc2U7fSk7Ly/kuI3mmK9BIEsgUSBKIDEwXHJcblxyXG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge2lmICgoY2FyZC5zY29yZXMgPiA1IHx8IGNhcmQuc2NvcmVzID09IDE0KSAmJiBjYXJkLnNjb3JlcyAhPSAyMClpczEgPSBmYWxzZX0pOy8v5LiN5pivMSAyIDMgNCA1fSk7XHJcblxyXG4gICAgaWYgKGlzMTQpIHsgLy/mmK9BIEsgUSBKIDEwIDtcclxuXHJcbiAgICAgICAgY2FyZE1vZGVsLnNvcnQoZnVuY3Rpb24oYTEsIGEyKSB7cmV0dXJuIGEyLnNjb3JlcyAtIGExLnNjb3Jlczt9KTtcclxuXHJcbiAgICAgICAgdmFyIG51bSA9IDE0LFxyXG4gICAgICAgICAgICBzY29yZXNBeXkgPSBbXTsgLy/kuIDlia/niYznmoTliIbmlbBcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgIHNjb3Jlc0F5eS5wdXNoKG51bSk7XHJcblxyXG4gICAgICAgICAgICBudW0gLT0gMTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNjb3Jlc0F5eS5sZW5ndGg7IGorKykge1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkTW9kZWwubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkgc2NvcmVzQXl5LnNwbGljZShqLCAxKTsgLy/liKDpmaTkuI3mmK/prLzniYznmoTliIZcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHsgaWYgKGNhcmQuc2NvcmVzID49IDIwKSBjYXJkLnNjb3JlcyA9IHNjb3Jlc0F5eS5zcGxpY2UoMCwgMSlbMF07fSk7Ly/mib7lh7rpgInkuK3nmoTniYxcclxuICAgIH1cclxuXHJcbiAgICBlbHNlIGlmIChpczEpIHsgLy/mmK8xIDIgMyA0IDVcclxuXHJcbiAgICAgICAgY2FyZE1vZGVsLnNvcnQoZnVuY3Rpb24oYTEsIGEyKSB7cmV0dXJuIGEyLnNjb3JlcyAtIGExLnNjb3Jlczt9KTtcclxuXHJcbiAgICAgICAgdmFyIG51bSA9IDUsXHJcbiAgICAgICAgICAgIHNjb3Jlc0F5eSA9IFtdOyAvL+S4gOWJr+eJjOeahOWIhuaVsFxyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgc2NvcmVzQXl5LnB1c2gobnVtKTtcclxuXHJcbiAgICAgICAgICAgIG51bSAtPSAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzY29yZXNBeXkubGVuZ3RoOyBqKyspIHtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRTY29yZXMgPSBjYXJkTW9kZWxbaV0uc2NvcmVzO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7aWYgKGNhcmQuc2NvcmVzID49IDIwKSBjYXJkLnNjb3JlcyA9IHNjb3Jlc0F5eS5zcGxpY2UoMCwgMSlbMF07fSk7Ly/mib7lh7rpgInkuK3nmoTniYxcclxuICAgIH1cclxuXHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtyZXR1cm4gYTEuc2NvcmVzIC0gYTIuc2NvcmVzO30pO1xyXG5cclxuICAgICAgICB2YXIgc2NvcmVzQXl5ID0gW107IC8v55So5p2l6KOF6ay854mM5YiG5pWwXHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgcyA9IHBhcnNlSW50KGNhcmRNb2RlbFswXS5zY29yZXMpICsgaTsgLy/mnIDlsI/nmoTniYznmoTliIbmlbBcclxuXHJcbiAgICAgICAgICAgIHNjb3Jlc0F5eS5wdXNoKHMpOy8v5LiA5Ymv54mM55qE5YiG5pWwXHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzY29yZXNBeXkubGVuZ3RoOyBqKyspIHtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRTY29yZXMgPSBjYXJkTW9kZWxbaV0uc2NvcmVzO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtpZiAoY2FyZC5zY29yZXMgPj0gMjApIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLDEpWzBdO30pOyAvL+aUueWPmOeJjOeahOWIhuaVsFxyXG4gICAgfVxyXG5cclxuICAgIGNhcmRNb2RlbCA9IHRoaXMuX2NvbnZlcnRPbmVUb0EoY2FyZE1vZGVsKTtcclxuXHJcbiAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtyZXR1cm4gYTEuc2NvcmVzIC0gYTIuc2NvcmVzO30pO1xyXG4gICAgcmV0dXJuIGNhcmRNb2RlbDtcclxufTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGxlZnROb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIFJpZ3RoTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBfdGltZTpudWxsLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG5cclxuICAgIHNldFRpbWU6IGZ1bmN0aW9uICh0aW1lKSB7XHJcblxyXG4gICAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG5cclxuICAgICAgICB0aGlzLl90aW1lID0gdGltZTtcclxuXHJcbiAgICAgICAgdGhpcy5sZWZ0Tm9kZS5yb3RhdGlvbiA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuUmlndGhOb2RlLnJvdGF0aW9uID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5SaWd0aE5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5sZWZ0Tm9kZS5zdG9wQWxsQWN0aW9ucygpO1xyXG5cclxuICAgICAgICB0aGlzLmxlZnROb2RlLnJ1bkFjdGlvbiggY2Mucm90YXRlQnkgKHRoaXMuX3RpbWUsLTE4MCkgKTtcclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgdGhpcy5SaWd0aE5vZGUucnVuQWN0aW9uKCBjYy5yb3RhdGVCeSAodGhpcy5fdGltZSwxODApICk7XHJcblxyXG4gICAgICAgIH0uYmluZCh0aGlzKSwgdGhpcy5fdGltZSk7XHJcblxyXG4gICAgfSxcclxuXHJcblxyXG5cclxufSk7XHJcbiIsImNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xyXG5jb25zdCBQbGF5YmFjayA9IHJlcXVpcmUoJ1BsYXliYWNrJyk7XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHNwcml0ZUF2YXRhcjogY2MuU3ByaXRlLFxyXG4gICAgICAgIGxhYmVsTmlja25hbWU6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxhYmVsU2NvcmU6IGNjLkxhYmVsLFxyXG4gICAgICAgIHNwcml0ZU9mZmxpbmU6IGNjLlNwcml0ZSxcclxuICAgICAgICB2b2ljZU5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgaG9tZVJ1bk5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgcmVhZHlOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIGJlaWx2OmNjLkxhYmVsLFxyXG4gICAgICAgIHNob290Tm9kZXM6IFtjYy5Ob2RlXSxcclxuICAgICAgICBiYW5rZXJOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIGZhbmdaaHVOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIHFpbmdsaTpjYy5Ob2RlLFxyXG4gICAgICAgIGlkOmNjLkxhYmVsLFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnVwZGF0ZVNjb3JlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldHFpbmdsaSA6ZnVuY3Rpb24odmlzaWJsZSA9IGZhbHNlKXtcclxuICAgICAgdGhpcy5xaW5nbGkuYWN0aXZlID0gKHZpc2libGUgIT0gZmFsc2UpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRSZWFkeU5vZGVWaXNpYmxlOiBmdW5jdGlvbiAodmlzaWJsZSA9IGZhbHNlKSB7XHJcbiAgICAgIHRoaXMucmVhZHlOb2RlLmFjdGl2ZSA9ICh2aXNpYmxlICE9IGZhbHNlKTtcclxuICAgIH0sXHJcbiAgICBzZXRCZWlsdkxhYmVsIDpmdW5jdGlvbihibCl7XHJcbiAgICAgIC8vdGhpcy5iZWlsdi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICB0aGlzLmJlaWx2LnN0cmluZyA9IGJsP2JsK1wi5YCNXCI6Jyc7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldEZhbmdaaHVOb2RlVmlzaWJsZTogZnVuY3Rpb24gKHZpc2libGUgPSBmYWxzZSkge1xyXG4gICAgICAgIHRoaXMuZmFuZ1podU5vZGUuYWN0aXZlID0gKHZpc2libGUgIT0gZmFsc2UpO1xyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVTY29yZTogZnVuY3Rpb24gKHNjb3JlID0gMCkge1xyXG4gICAgICAgIGlmKHNjb3JlID49IDApIHtcclxuICAgICAgICAgICAgdGhpcy5sYWJlbFNjb3JlLnN0cmluZyA9IFwiK1wiICsgc2NvcmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsU2NvcmUuc3RyaW5nID0gXCJcIitzY29yZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlVXNlcklkOmZ1bmN0aW9uKGlkKXtcclxuICAgICAgdGhpcy5pZC5zdHJpbmcgPSBpZCA/IChcIklEOlwiK2lkKTpcIlwiO1xyXG4gICAgfSxcclxuICAgIHVwZGF0ZU5pY2tuYW1lOiBmdW5jdGlvbihuaWNrbmFtZSA9IFwiXCIpIHtcclxuICAgICAgdGhpcy5sYWJlbE5pY2tuYW1lLnN0cmluZyA9IG5pY2tuYW1lO1xyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVBdmF0YXI6IGZ1bmN0aW9uIChhdmF0YXIpIHtcclxuICAgICAgaWYgKGF2YXRhci5lbmRzV2l0aChcInBuZ1wiKVxyXG4gICAgICB8fCBhdmF0YXIuZW5kc1dpdGgoXCJqcGdcIilcclxuICAgICAgfHwgYXZhdGFyLmVuZHNXaXRoKFwiZ2lmXCIpKSB7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vYXZhdGFyID0gYXZhdGFyICsgXCIucG5nXCI7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNjLmxvYWRlci5sb2FkKHt1cmw6YXZhdGFyLHR5cGU6XCJqcGdcIn0sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcclxuICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUoZGF0YSk7XHJcbiAgICAgICAgdGhpcy5zcHJpdGVBdmF0YXIuc3ByaXRlRnJhbWUgPSBmcmFtZTtcclxuICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2V0T2ZmbGluZVZpc2libGU6IGZ1bmN0aW9uICh2aXNpYmxlID0gZmFsc2UpIHtcclxuICAgICAgaWYgKFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgIC8vIOWmguaenOaYr+WkhOeQhuWbnuaUvueKtuaAge+8jOWwseS4jeeUqOWGjeWkhOeQhuemu+e6v+a2iOaBr+S6hlxyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5zcHJpdGVPZmZsaW5lLm5vZGUuYWN0aXZlID0gdmlzaWJsZTtcclxuICAgIH0sXHJcblxyXG4gICAgc2V0SXNCYW5rZXI6IGZ1bmN0aW9uKGlzQmFua2VyID0gZmFsc2UpIHtcclxuICAgICAgdGhpcy5iYW5rZXJOb2RlLmFjdGl2ZSA9IGlzQmFua2VyO1xyXG4gICAgfSxcclxuXHJcbiAgICBwbGF5U2hvb3RBbmltYXRpb246IGZ1bmN0aW9uICh0b0luZGV4ID0gMCkge1xyXG4gICAgICAvL2xldCBzaG9vdE5vZGUgPSB0aGlzLnNob290Tm9kZXNbdG9JbmRleF07XHJcbiAgICAgIC8vc2hvb3ROb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgIC8vbGV0IGFuaW0gPSBzaG9vdE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgIC8vYW5pbS5wbGF5KCdzaG9vdCcpLm9uKCdmaW5pc2hlZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgLy8gIHNob290Tm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgLy99LCB0aGlzKTtcclxuXHJcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5RGFRaWFuZygpO1xyXG4gICAgfSxcclxuXHJcbiAgICBwbGF5QnVsbGV0SG9sZUFuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgYnVsbGV0SG9sZU5vZGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ2J1bGxldEhvbGUnKTtcclxuICAgICAgYnVsbGV0SG9sZU5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgbGV0IGFuaW0gPSBidWxsZXRIb2xlTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcclxuICAgICAgYW5pbS5wbGF5KCdidWxsZXRIb2xlJykub24oJ2ZpbmlzaGVkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGJ1bGxldEhvbGVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB9LCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgcGxheVNwZWFrQW5pbWF0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMudm9pY2VOb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnZvaWNlTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgfS5iaW5kKHRoaXMpLCA0KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5pKt5pS+5YWo5Z6S5omT5Yqo55S7XHJcbiAgICBwbGF5SG9tZVJ1bkFpbWF0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIC8vbGV0IGFsZXJ0ID0gdGhpcy5ob21lUnVuTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgIC8vYWxlcnQuYWxlcnQoKTtcclxuICAgICAgLy90aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgIC8vICB0aGlzLmhvbWVSdW5Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAvL30uYmluZCh0aGlzKSwgMik7XHJcbiAgICB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICB6aHVhbk51bUxhYmVsOmNjLkxhYmVsLFxyXG4gICAgICAgIGp1c2h1OmNjLk5vZGUsXHJcbiAgICAgICAgQUE6Y2MuTm9kZSxcclxuICAgICAgICBfc2VsZWN0ZWRQZW9wbGVJbmRleDpudWxsLFxyXG4gICAgICAgIF9zZWxlY3RlZEp1c2h1SW5kZXg6bnVsbCxcclxuICAgICAgICBfc2VsZWN0ZWRBQUluZGV4Om51bGxcclxuICAgIH0sXHJcblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fY3RybCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja1Blb3BsZUFjdGlvbjpmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9jdHJsKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrQUFBY3Rpb246IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9jdHJsKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrSnVzaHVBY3Rpb246ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX2N0cmwoKTtcclxuICAgIH0sXHJcblxyXG4gICAgIF9jdHJsOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChcInNpbmdsZVNlbGVjdFwiKS5zZWxlY3RlZEluZGV4O1xyXG4gICAgICAgIHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9IHRoaXMuanVzaHUuZ2V0Q29tcG9uZW50KFwic2luZ2xlU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XHJcbiAgICAgICAgdGhpcy5fc2VsZWN0ZWRBQUluZGV4ID0gdGhpcy5BQS5nZXRDb21wb25lbnQoXCJjaGVja1NlbGVjdFwiKS5zZWxlY3RlZEluZGV4O1xyXG4gICAgICAgIC8v5Lq65pWw6YCJMuS6uuaXtuS4lOayoemAieS4ikFB5Yi25pS26LS5XHJcbiAgICAgICAgIHZhciByZW5TaHUgPSAyO1xyXG4gICAgICAgICBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDApe1xyXG4gICAgICAgICAgICAgcmVuU2h1ID0gMjtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMSl7XHJcbiAgICAgICAgICAgICByZW5TaHUgPSAzO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9PSAyKXtcclxuICAgICAgICAgICAgIHJlblNodSA9IDQ7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDMpe1xyXG4gICAgICAgICAgICAgcmVuU2h1ID0gNTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgemh1YW5nU2hpID0gMjA7XHJcbiAgICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcclxuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IDIwO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xyXG4gICAgICAgICAgICAgemh1YW5nU2hpID0gNDA7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XHJcbiAgICAgICAgICAgICB6aHVhbmdTaGkgPSA4MDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAzKXtcclxuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IDEwO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIC8vQUFcclxuICAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRBQUluZGV4ICE9IG51bGwpe1xyXG4gICAgICAgICAgICAgemh1YW5nU2hpID0gTWF0aC5jZWlsKHpodWFuZ1NoaSAvIHJlblNodSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IHpodWFuZ1NoaTtcclxuICAgICAgICAvL2lmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMCl7XHJcbiAgICAgICAgLy8gICAgaWYodGhpcy5fc2VsZWN0ZWRBQUluZGV4ID09IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxyXG4gICAgICAgICAgICAgICAgLy9pZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XHJcbiAgICAgICAgICAgICAgICAvLyAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIxMFwiO1xyXG4gICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICAvLy8v5bGA5pWw6YCJMjDlsYDml7ZcclxuICAgICAgICAgICAgICAgIC8vaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xyXG4gICAgICAgICAgICAgICAgLy8gICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMzBcIjtcclxuICAgICAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAgICAgLy8vL+WxgOaVsOmAiTMw5bGA5pe2XHJcbiAgICAgICAgICAgICAgICAvL2lmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcclxuICAgICAgICAgICAgICAgIC8vICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjgwXCI7XHJcbiAgICAgICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgLy8gICAgZWxzZXtcclxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxyXG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI4XCI7XHJcbiAgICAgICAgLy8gICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxyXG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIxNVwiO1xyXG4gICAgICAgIC8vICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcclxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDIpe1xyXG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjNcIjtcclxuICAgICAgICAvLyAgICAgICAgfVxyXG4gICAgICAgIC8vICAgIH1cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8v5Lq65pWw6YCJM+S6ulxyXG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDEpe1xyXG4gICAgICAgIC8vICAgIC8v5rKh6YCJ5LiKQUHliLbmlLbotLlcclxuICAgICAgICAvLyAgICBpZih0aGlzLl9zZWxlY3RlZEFBSW5kZXggPT0gbnVsbCl7XHJcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcclxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xyXG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjFcIjtcclxuICAgICAgICAvLyAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XHJcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcclxuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjQyXCI7XHJcbiAgICAgICAgLy8gICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkzMOWxgOaXtlxyXG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI2MFwiO1xyXG4gICAgICAgIC8vICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vICAgIC8v6YCJ5LqGQUHmlLbotLlcclxuICAgICAgICAvLyAgICBlbHNle1xyXG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XHJcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcclxuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjdcIjtcclxuICAgICAgICAvLyAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XHJcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcclxuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjE0XCI7XHJcbiAgICAgICAgLy8gICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkzMOWxgOaXtlxyXG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyMFwiO1xyXG4gICAgICAgIC8vICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLy8vL+S6uuaVsOmAiTTkurrkuJTmsqHpgInkuIpBQeWItuaUtui0uVxyXG4gICAgICAgIC8vZWxzZXtcclxuICAgICAgICAvLyAgICBpZih0aGlzLl9zZWxlY3RlZEFBSW5kZXggPT0gbnVsbCl7XHJcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcclxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xyXG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjhcIjtcclxuICAgICAgICAvLyAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XHJcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcclxuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjU2XCI7XHJcbiAgICAgICAgLy8gICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkzMOWxgOaXtlxyXG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI4NFwiO1xyXG4gICAgICAgIC8vICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vICAgIC8vQUHliLbmlLbotLnpgInkuIrkuoZcclxuICAgICAgICAvLyAgICBlbHNle1xyXG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XHJcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcclxuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjdcIjtcclxuICAgICAgICAvLyAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XHJcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcclxuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjE0XCI7XHJcbiAgICAgICAgLy8gICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkzMOWxgOaXtlxyXG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyMVwiO1xyXG4gICAgICAgIC8vICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vfVxyXG4gICAgfSxcclxufSk7XHJcbiJdfQ==